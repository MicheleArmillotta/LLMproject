[
  {
    "function_name": "getContainerEnd",
    "container": "IniSection",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "1201-1204",
    "snippet": "IniIterator IniSection::getContainerEnd ()\n{\n    return container.end ();\n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "container.end",
          "args": [],
          "line": 1203
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "43-47",
          "snippet": "YCPMapIterator\nYCPMapRep::end() const\n{\n    return stl_map.end();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::end() const\n  {\n      return stl_map.end();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  IniIterator IniSection::getContainerEnd ()\n  {\n      return container.end ();\n  }\n}"
  },
  {
    "function_name": "getContainerBegin",
    "container": "IniSection",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "1196-1199",
    "snippet": "IniIterator IniSection::getContainerBegin ()\n{\n    return container.begin ();\n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "container.begin",
          "args": [],
          "line": 1198
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "36-40",
          "snippet": "YCPMapIterator\nYCPMapRep::begin() const\n{\n    return stl_map.begin();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::begin() const\n  {\n      return stl_map.begin();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  IniIterator IniSection::getContainerBegin ()\n  {\n      return container.begin ();\n  }\n}"
  },
  {
    "function_name": "clean",
    "container": "IniSection",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "1179-1194",
    "snippet": "void IniSection::clean()\n{\n    dirty = false;\n    IniIterator i = container.begin (), e = container.end ();\n    for (; i != e; ++i)\n    {\n\tif (i->t () == SECTION)\n\t{\n\t    i->s ().clean ();\n\t}\n\telse\n\t{\n\t    i->e ().clean ();\n\t}\n    }\n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "i->e",
          "args": [],
          "line": 1191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->e",
          "args": [],
          "line": 1191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->s",
          "args": [],
          "line": 1187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->s",
          "args": [],
          "line": 1187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->t",
          "args": [],
          "line": 1185
        },
        "resolved": true,
        "details": {
          "function_name": "t",
          "container": "IniContainerElement",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.h",
          "lines": "610-610",
          "snippet": "IniType t () const { return _t; }",
          "includes": [
            "#include <YCP.h>",
            "#include <vector>",
            "#include <list>",
            "#include <map>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <YCP.h>\n#include <vector>\n#include <list>\n#include <map>\n#include <string>\n\nIniContainerElement {\n  IniType t () const { return _t; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "container.end",
          "args": [],
          "line": 1182
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "43-47",
          "snippet": "YCPMapIterator\nYCPMapRep::end() const\n{\n    return stl_map.end();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::end() const\n  {\n      return stl_map.end();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "container.begin",
          "args": [],
          "line": 1182
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "36-40",
          "snippet": "YCPMapIterator\nYCPMapRep::begin() const\n{\n    return stl_map.begin();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::begin() const\n  {\n      return stl_map.begin();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  void IniSection::clean()\n  {\n      dirty = false;\n      IniIterator i = container.begin (), e = container.end ();\n      for (; i != e; ++i)\n      {\n  \tif (i->t () == SECTION)\n  \t{\n  \t    i->s ().clean ();\n  \t}\n  \telse\n  \t{\n  \t    i->e ().clean ();\n  \t}\n      }\n  }\n}"
  },
  {
    "function_name": "isDirty",
    "container": "IniSection",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "1165-1178",
    "snippet": "bool IniSection::isDirty ()\n{\n    if (dirty)\n\treturn true;\n    // every write dirtyfies not only value but section too\n    // so it is enough for us to find the first dirty section\n    IniSectionIdxIterator xi = isections.begin (), xe = isections. end ();\n    for (; xi != xe; ++xi)\n    {\n\tif (xi->second->s ().isDirty ())\n\t  return true;\n    }\n    return false;\n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xi->second->s",
          "args": [],
          "line": 1174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xi->second->s",
          "args": [],
          "line": 1174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isections. end",
          "args": [],
          "line": 1171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isections.begin",
          "args": [],
          "line": 1171
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "36-40",
          "snippet": "YCPMapIterator\nYCPMapRep::begin() const\n{\n    return stl_map.begin();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::begin() const\n  {\n      return stl_map.begin();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  bool IniSection::isDirty ()\n  {\n      if (dirty)\n  \treturn true;\n      // every write dirtyfies not only value but section too\n      // so it is enough for us to find the first dirty section\n      IniSectionIdxIterator xi = isections.begin (), xe = isections. end ();\n      for (; xi != xe; ++xi)\n      {\n  \tif (xi->second->s ().isDirty ())\n  \t  return true;\n      }\n      return false;\n  }\n}"
  },
  {
    "function_name": "setEndComment",
    "container": "IniSection",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "1158-1164",
    "snippet": "void IniSection::setEndComment (const char*c)\n{\n    if (comment.empty () && container.empty ())\n\tcomment = c;\n    else\n\tend_comment = c;\n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "container.empty",
          "args": [],
          "line": 1160
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pathname",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
          "lines": "66-66",
          "snippet": "bool empty()    const { return !name_t.size(); }",
          "includes": [
            "#include <string>",
            "#include <iosfwd>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string>\n#include <iosfwd>\n\nPathname {\n  bool empty()    const { return !name_t.size(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  void IniSection::setEndComment (const char*c)\n  {\n      if (comment.empty () && container.empty ())\n  \tcomment = c;\n      else\n  \tend_comment = c;\n  }\n}"
  },
  {
    "function_name": "getSubSectionRewriteBy",
    "container": "IniSection",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "1131-1142",
    "snippet": "int IniSection::getSubSectionRewriteBy (const char*name)\n{\n    pair <IniSectionIdxIterator, IniSectionIdxIterator> r =\n\tisections.equal_range (name);\n    IniSectionIdxIterator xi = r.first, xe = r.second;\n\n    if (xi == xe)\n    {\n\treturn -1;\n    }\n    return (--xe)->second->s ().getRewriteBy ();\n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 1141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 1141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isections.equal_range",
          "args": [
            "name"
          ],
          "line": 1134
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::getSubSectionRewriteBy (const char*name)\n  {\n      pair <IniSectionIdxIterator, IniSectionIdxIterator> r =\n  \tisections.equal_range (name);\n      IniSectionIdxIterator xi = r.first, xe = r.second;\n  \n      if (xi == xe)\n      {\n  \treturn -1;\n      }\n      return (--xe)->second->s ().getRewriteBy ();\n  }\n}"
  },
  {
    "function_name": "dirHelper",
    "container": "IniSection",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "1093-1116",
    "snippet": "int IniSection::dirHelper (const YCPPath&p, YCPList&out,int get_sect,int depth)\n{\n    if (depth >= p->length())\n    {\n\treturn myDir (out, get_sect? SECTION: VALUE);\n    }\n\n    // recurse\n    string k = ip->changeCase (p->component_str (depth));\n\n    pair <IniSectionIdxIterator, IniSectionIdxIterator> r =\n\tisections.equal_range (k);\n    IniSectionIdxIterator xi = r.first, xe = r.second;\n\n    if (xi != xe)\n    {\n\t// there's something\n\tIniSection& s = (--xe)->second->s ();\n\treturn s.dirHelper (p, out, get_sect, depth+1);\n    }\n    //error\n    y2debug (\"Dir: Invalid path %s [%d]\", p->toString().c_str(), depth);\n    return -1;\n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Dir: Invalid path %s [%d]\"",
            "p->toString().c_str()",
            "depth"
          ],
          "line": 1114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p->toString",
          "args": [],
          "line": 1114
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "YBreakpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YBreakpoint.cc",
          "lines": "87-91",
          "snippet": "string\nYBreakpoint::toString() const\n{\n    return m_code->toString ();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YBreakpoint.h\"",
            "#include <debugger/Debugger.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YBreakpoint.h\"\n#include <debugger/Debugger.h>\n#include <libintl.h>\n\nYBreakpoint {\n  string\n  YBreakpoint::toString() const\n  {\n      return m_code->toString ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "s.dirHelper",
          "args": [
            "p",
            "out",
            "get_sect",
            "depth+1"
          ],
          "line": 1111
        },
        "resolved": true,
        "details": {
          "function_name": "dirHelper",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "1093-1116",
          "snippet": "int IniSection::dirHelper (const YCPPath&p, YCPList&out,int get_sect,int depth)\n{\n    if (depth >= p->length())\n    {\n\treturn myDir (out, get_sect? SECTION: VALUE);\n    }\n\n    // recurse\n    string k = ip->changeCase (p->component_str (depth));\n\n    pair <IniSectionIdxIterator, IniSectionIdxIterator> r =\n\tisections.equal_range (k);\n    IniSectionIdxIterator xi = r.first, xe = r.second;\n\n    if (xi != xe)\n    {\n\t// there's something\n\tIniSection& s = (--xe)->second->s ();\n\treturn s.dirHelper (p, out, get_sect, depth+1);\n    }\n    //error\n    y2debug (\"Dir: Invalid path %s [%d]\", p->toString().c_str(), depth);\n    return -1;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 1110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isections.equal_range",
          "args": [
            "k"
          ],
          "line": 1104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip->changeCase",
          "args": [
            "p->component_str (depth)"
          ],
          "line": 1101
        },
        "resolved": true,
        "details": {
          "function_name": "changeCase",
          "container": "IniParser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.cc",
          "lines": "1098-1120",
          "snippet": "string IniParser::changeCase (const string&str) const\n{\n    string tmp = str;\n    if (!ignore_case)\n      return tmp;\n    if (prefer_uppercase)\n    {\n\tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n\t    *it = toupper (*it);\n    }\n    else\n    {\n\tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n\t    *it = tolower (*it);\n\tif (first_upper)\n\t{\n\tstring::iterator it = tmp.begin ();\n\tif (it != tmp.end ())\n\t    *it = toupper (*it);\n\t}\t    \n    }\n    return tmp;\n}",
          "includes": [
            "#include \"IniFile.h\"",
            "#include \"IniParser.h\"",
            "#include <cassert>",
            "#include <glob.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <errno.h>",
            "#include <set>",
            "#include <vector>",
            "#include <ycp/y2log.h>",
            "#include <y2util/PathInfo.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include \"IniParser.h\"\n#include <cassert>\n#include <glob.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <errno.h>\n#include <set>\n#include <vector>\n#include <ycp/y2log.h>\n#include <y2util/PathInfo.h>\n#include \"config.h\"\n\nIniParser {\n  string IniParser::changeCase (const string&str) const\n  {\n      string tmp = str;\n      if (!ignore_case)\n        return tmp;\n      if (prefer_uppercase)\n      {\n  \tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n  \t    *it = toupper (*it);\n      }\n      else\n      {\n  \tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n  \t    *it = tolower (*it);\n  \tif (first_upper)\n  \t{\n  \tstring::iterator it = tmp.begin ();\n  \tif (it != tmp.end ())\n  \t    *it = toupper (*it);\n  \t}\t    \n      }\n      return tmp;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "p->component_str",
          "args": [
            "depth"
          ],
          "line": 1101
        },
        "resolved": true,
        "details": {
          "function_name": "component_str",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "161-165",
          "snippet": "string\nYCPPathRep::component_str(long index) const\n{\n    return components[index].component.asString();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  string\n  YCPPathRep::component_str(long index) const\n  {\n      return components[index].component.asString();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "myDir",
          "args": [
            "out",
            "get_sect? SECTION: VALUE"
          ],
          "line": 1097
        },
        "resolved": true,
        "details": {
          "function_name": "myDir",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "982-996",
          "snippet": "int IniSection::myDir (YCPList& l, IniType what)\n{\n    IniIterator i = container.begin (), e = container.end ();\n    for (; i != e; ++i)\n    {\n\tif (i->t () == what)\n\t{\n\t    string n = (what == SECTION) ?\n\t\ti->s ().getName () :\n\t\ti->e ().getName ();\n\t    l->add (YCPString (n));\n\t}\n    }\n    return 0;\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::myDir (YCPList& l, IniType what)\n  {\n      IniIterator i = container.begin (), e = container.end ();\n      for (; i != e; ++i)\n      {\n  \tif (i->t () == what)\n  \t{\n  \t    string n = (what == SECTION) ?\n  \t\ti->s ().getName () :\n  \t\ti->e ().getName ();\n  \t    l->add (YCPString (n));\n  \t}\n      }\n      return 0;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "p->length",
          "args": [],
          "line": 1095
        },
        "resolved": true,
        "details": {
          "function_name": "length",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "124-128",
          "snippet": "long\nYCPPathRep::length() const\n{\n    return components.size();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  long\n  YCPPathRep::length() const\n  {\n      return components.size();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::dirHelper (const YCPPath&p, YCPList&out,int get_sect,int depth)\n  {\n      if (depth >= p->length())\n      {\n  \treturn myDir (out, get_sect? SECTION: VALUE);\n      }\n  \n      // recurse\n      string k = ip->changeCase (p->component_str (depth));\n  \n      pair <IniSectionIdxIterator, IniSectionIdxIterator> r =\n  \tisections.equal_range (k);\n      IniSectionIdxIterator xi = r.first, xe = r.second;\n  \n      if (xi != xe)\n      {\n  \t// there's something\n  \tIniSection& s = (--xe)->second->s ();\n  \treturn s.dirHelper (p, out, get_sect, depth+1);\n      }\n      //error\n      y2debug (\"Dir: Invalid path %s [%d]\", p->toString().c_str(), depth);\n      return -1;\n  }\n}"
  },
  {
    "function_name": "Dir",
    "container": "IniSection",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "1073-1092",
    "snippet": "int IniSection::Dir (const YCPPath&p, YCPList&l)\n{\n    if (ip->isFlat ())\n\treturn dirValueFlat (p, l);\n    if (p->length()<1)\n\t{\n\t    l.add (YCPString (\"section\"));\n\t    l.add (YCPString (\"value\"));\n\t    return 0;\n\t}\n\n    string s = p->component_str(0);\n    if (s == \"v\" || s == \"value\")\n\treturn dirHelper (p, l, 0, 1);\n    else if (s == \"s\" || s == \"section\")\n\treturn dirHelper (p, l, 1, 1);\n\n    y2error (\"I do not know what to dir from %s.\", p->toString().c_str());\n    return -1;\n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "y2error",
          "args": [
            "\"I do not know what to dir from %s.\"",
            "p->toString().c_str()"
          ],
          "line": 1090
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p->toString",
          "args": [],
          "line": 1090
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "YBreakpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YBreakpoint.cc",
          "lines": "87-91",
          "snippet": "string\nYBreakpoint::toString() const\n{\n    return m_code->toString ();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YBreakpoint.h\"",
            "#include <debugger/Debugger.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YBreakpoint.h\"\n#include <debugger/Debugger.h>\n#include <libintl.h>\n\nYBreakpoint {\n  string\n  YBreakpoint::toString() const\n  {\n      return m_code->toString ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dirHelper",
          "args": [
            "p",
            "l",
            "1",
            "1"
          ],
          "line": 1088
        },
        "resolved": true,
        "details": {
          "function_name": "dirHelper",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "1093-1116",
          "snippet": "int IniSection::dirHelper (const YCPPath&p, YCPList&out,int get_sect,int depth)\n{\n    if (depth >= p->length())\n    {\n\treturn myDir (out, get_sect? SECTION: VALUE);\n    }\n\n    // recurse\n    string k = ip->changeCase (p->component_str (depth));\n\n    pair <IniSectionIdxIterator, IniSectionIdxIterator> r =\n\tisections.equal_range (k);\n    IniSectionIdxIterator xi = r.first, xe = r.second;\n\n    if (xi != xe)\n    {\n\t// there's something\n\tIniSection& s = (--xe)->second->s ();\n\treturn s.dirHelper (p, out, get_sect, depth+1);\n    }\n    //error\n    y2debug (\"Dir: Invalid path %s [%d]\", p->toString().c_str(), depth);\n    return -1;\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::dirHelper (const YCPPath&p, YCPList&out,int get_sect,int depth)\n  {\n      if (depth >= p->length())\n      {\n  \treturn myDir (out, get_sect? SECTION: VALUE);\n      }\n  \n      // recurse\n      string k = ip->changeCase (p->component_str (depth));\n  \n      pair <IniSectionIdxIterator, IniSectionIdxIterator> r =\n  \tisections.equal_range (k);\n      IniSectionIdxIterator xi = r.first, xe = r.second;\n  \n      if (xi != xe)\n      {\n  \t// there's something\n  \tIniSection& s = (--xe)->second->s ();\n  \treturn s.dirHelper (p, out, get_sect, depth+1);\n      }\n      //error\n      y2debug (\"Dir: Invalid path %s [%d]\", p->toString().c_str(), depth);\n      return -1;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "p->component_str",
          "args": [
            "0"
          ],
          "line": 1084
        },
        "resolved": true,
        "details": {
          "function_name": "component_str",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "161-165",
          "snippet": "string\nYCPPathRep::component_str(long index) const\n{\n    return components[index].component.asString();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  string\n  YCPPathRep::component_str(long index) const\n  {\n      return components[index].component.asString();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "l.add",
          "args": [
            "YCPString (\"value\")"
          ],
          "line": 1080
        },
        "resolved": true,
        "details": {
          "function_name": "add",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "141-145",
          "snippet": "void\nYCPTermRep::add (const YCPValue& value)\n{\n    l->add(value);\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  void\n  YCPTermRep::add (const YCPValue& value)\n  {\n      l->add(value);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPString",
          "args": [
            "\"value\""
          ],
          "line": 1080
        },
        "resolved": true,
        "details": {
          "function_name": "isYCPStringPair",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.cc",
          "lines": "92-102",
          "snippet": "bool isYCPStringPair (const YCPValue &v)\n{\n    if (!v->isList ())\n\treturn false;\n    YCPList l = v->asList ();\n    if (l->size () != 2)\n\treturn false;\n    return\n\tl->value (0)->isString () &&\n\tl->value (1)->isString ();\n}",
          "includes": [
            "#include \"IniFile.h\"",
            "#include \"IniParser.h\"",
            "#include <cassert>",
            "#include <glob.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <errno.h>",
            "#include <set>",
            "#include <vector>",
            "#include <ycp/y2log.h>",
            "#include <y2util/PathInfo.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include \"IniParser.h\"\n#include <cassert>\n#include <glob.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <errno.h>\n#include <set>\n#include <vector>\n#include <ycp/y2log.h>\n#include <y2util/PathInfo.h>\n#include \"config.h\"\n\nbool isYCPStringPair (const YCPValue &v)\n{\n    if (!v->isList ())\n\treturn false;\n    YCPList l = v->asList ();\n    if (l->size () != 2)\n\treturn false;\n    return\n\tl->value (0)->isString () &&\n\tl->value (1)->isString ();\n}"
        }
      },
      {
        "call_info": {
          "callee": "p->length",
          "args": [],
          "line": 1077
        },
        "resolved": true,
        "details": {
          "function_name": "length",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "124-128",
          "snippet": "long\nYCPPathRep::length() const\n{\n    return components.size();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  long\n  YCPPathRep::length() const\n  {\n      return components.size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dirValueFlat",
          "args": [
            "p",
            "l"
          ],
          "line": 1076
        },
        "resolved": true,
        "details": {
          "function_name": "dirValueFlat",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "998-1011",
          "snippet": "int IniSection::dirValueFlat (const YCPPath&p, YCPList&l)\n{\n    // This function used to discard p and always return Dir (.)\n    // #21574\n    if (p->length () != 0)\n    {\n\t// Leave l empty.\n\t// Maybe we should differentiate between Dir (.existing_value)\n\t// and Dir (.bogus) ?\n\treturn 0;\n    }\n\n    return myDir (l, VALUE);\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::dirValueFlat (const YCPPath&p, YCPList&l)\n  {\n      // This function used to discard p and always return Dir (.)\n      // #21574\n      if (p->length () != 0)\n      {\n  \t// Leave l empty.\n  \t// Maybe we should differentiate between Dir (.existing_value)\n  \t// and Dir (.bogus) ?\n  \treturn 0;\n      }\n  \n      return myDir (l, VALUE);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ip->isFlat",
          "args": [],
          "line": 1075
        },
        "resolved": true,
        "details": {
          "function_name": "isFlat",
          "container": "IniParser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.h",
          "lines": "460-460",
          "snippet": "bool isFlat () const { return flat; }",
          "includes": [
            "#include \"IniFile.h\"",
            "#include <set>",
            "#include <vector>",
            "#include <string>",
            "#include <fstream>",
            "#include <iosfwd>",
            "#include <YCP.h>",
            "#include <y2util/RepDef.h>",
            "#include <locale.h>",
            "#include <regex.h>",
            "#include <stdio.h>",
            "#include <ctype.h>",
            "#include <unistd.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include <set>\n#include <vector>\n#include <string>\n#include <fstream>\n#include <iosfwd>\n#include <YCP.h>\n#include <y2util/RepDef.h>\n#include <locale.h>\n#include <regex.h>\n#include <stdio.h>\n#include <ctype.h>\n#include <unistd.h>\n\nIniParser {\n  bool isFlat () const { return flat; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::Dir (const YCPPath&p, YCPList&l)\n  {\n      if (ip->isFlat ())\n  \treturn dirValueFlat (p, l);\n      if (p->length()<1)\n  \t{\n  \t    l.add (YCPString (\"section\"));\n  \t    l.add (YCPString (\"value\"));\n  \t    return 0;\n  \t}\n  \n      string s = p->component_str(0);\n      if (s == \"v\" || s == \"value\")\n  \treturn dirHelper (p, l, 0, 1);\n      else if (s == \"s\" || s == \"section\")\n  \treturn dirHelper (p, l, 1, 1);\n  \n      y2error (\"I do not know what to dir from %s.\", p->toString().c_str());\n      return -1;\n  }\n}"
  },
  {
    "function_name": "Read",
    "container": "IniSection",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "1043-1072",
    "snippet": "int IniSection::Read (const YCPPath&p, YCPValue&out, bool rewrite)\n{\n    if (ip->isFlat ())\n\treturn getValueFlat (p, out);\n\n    if (p->length() >= 1 && p->component_str (0) == \"all\")\n    {\n\treturn getAll (p, out, 1);\n    }\n\n    if (p->length()<2)\n\t{\n\t    y2error (\"I do not know what to read from %s.\", p->toString().c_str());\n\t    return -1;\n\t}\n    string s = p->component_str(0);\n    if (s == \"v\" || s == \"value\")\n\treturn getValue (p, out, 0, 1);\n    else if (s == \"vc\" || s == \"value_comment\" || s == \"valuecomment\")\n\treturn getValue (p, out, 1, 1);\n    else if (s == \"vt\" || s == \"value_type\" || s == \"valuetype\")\n\treturn getValue (p, out, 2, 1);\n    else if (s == \"sc\" || s == \"section_comment\" || s == \"sectioncomment\")\n\treturn getSectionProp (p, out, 0, 1);\n    else if (s == \"st\" || s == \"section_type\" || s == \"sectiontype\")\n\treturn getSectionProp (p, out, rewrite? 1:2, 1);\n\n    y2error (\"I do not know what to read from %s.\", p->toString().c_str());\n    return -1;\n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "y2error",
          "args": [
            "\"I do not know what to read from %s.\"",
            "p->toString().c_str()"
          ],
          "line": 1070
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p->toString",
          "args": [],
          "line": 1070
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "YBreakpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YBreakpoint.cc",
          "lines": "87-91",
          "snippet": "string\nYBreakpoint::toString() const\n{\n    return m_code->toString ();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YBreakpoint.h\"",
            "#include <debugger/Debugger.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YBreakpoint.h\"\n#include <debugger/Debugger.h>\n#include <libintl.h>\n\nYBreakpoint {\n  string\n  YBreakpoint::toString() const\n  {\n      return m_code->toString ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getSectionProp",
          "args": [
            "p",
            "out",
            "rewrite? 1:2",
            "1"
          ],
          "line": 1068
        },
        "resolved": true,
        "details": {
          "function_name": "getSectionProp",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "332-387",
          "snippet": "int IniSection::getSectionProp (const YCPPath&p, YCPValue&out, int what, int depth)\n{\n    string k = ip->changeCase (p->component_str (depth));\n    // Find the matching sections.\n    // If we need to recurse, choose one\n    // Otherwise gather properties of all of the leaf sections\n\n    pair <IniSectionIdxIterator, IniSectionIdxIterator> r =\n\tisections.equal_range (k);\n    IniSectionIdxIterator xi = r.first, xe = r.second;\n\n    if (depth + 1 < p->length())\n    {\n\t// recurse\n\tif (xi != xe)\n\t{\n\t    // there's something\n\t    IniSection& s = (--xe)->second->s ();\n\t    return s.getSectionProp (p, out, what, depth+1);\n\t}\n\t//error\n    }\n    else\n    {\n\t// bottom level, take all\n\tYCPList results;\n\tbool found = false;\n\tfor (; xi != xe; ++xi)\n\t{\n\t    found = true;\n\t    IniSection& s = xi->second->s ();\n\t    if (what == 0)\n\t\tout = YCPString (s.comment);\n\t    else if (what == 1)\n\t\tout = YCPInteger (s.rewrite_by);\n\t    else\n\t\tout = YCPInteger (s.read_by);\n\t    results->add (out);\n\t}\n\n\tif (ip->repeatNames ())\n\t{\n\t    out = results;\n\t    return 0;\n\t}\n\telse if (found)\n\t{\n\t    // nonempty range, the cycle ran once, out has the right value\n\t    return 0;\n\t}\n\t// empty range, no such key\n    }\n\n    y2debug (\"Read: Invalid path %s [%d]\", p->toString().c_str(), depth);\n    return -1;\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::getSectionProp (const YCPPath&p, YCPValue&out, int what, int depth)\n  {\n      string k = ip->changeCase (p->component_str (depth));\n      // Find the matching sections.\n      // If we need to recurse, choose one\n      // Otherwise gather properties of all of the leaf sections\n  \n      pair <IniSectionIdxIterator, IniSectionIdxIterator> r =\n  \tisections.equal_range (k);\n      IniSectionIdxIterator xi = r.first, xe = r.second;\n  \n      if (depth + 1 < p->length())\n      {\n  \t// recurse\n  \tif (xi != xe)\n  \t{\n  \t    // there's something\n  \t    IniSection& s = (--xe)->second->s ();\n  \t    return s.getSectionProp (p, out, what, depth+1);\n  \t}\n  \t//error\n      }\n      else\n      {\n  \t// bottom level, take all\n  \tYCPList results;\n  \tbool found = false;\n  \tfor (; xi != xe; ++xi)\n  \t{\n  \t    found = true;\n  \t    IniSection& s = xi->second->s ();\n  \t    if (what == 0)\n  \t\tout = YCPString (s.comment);\n  \t    else if (what == 1)\n  \t\tout = YCPInteger (s.rewrite_by);\n  \t    else\n  \t\tout = YCPInteger (s.read_by);\n  \t    results->add (out);\n  \t}\n  \n  \tif (ip->repeatNames ())\n  \t{\n  \t    out = results;\n  \t    return 0;\n  \t}\n  \telse if (found)\n  \t{\n  \t    // nonempty range, the cycle ran once, out has the right value\n  \t    return 0;\n  \t}\n  \t// empty range, no such key\n      }\n  \n      y2debug (\"Read: Invalid path %s [%d]\", p->toString().c_str(), depth);\n      return -1;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getValue",
          "args": [
            "p",
            "out",
            "2",
            "1"
          ],
          "line": 1064
        },
        "resolved": true,
        "details": {
          "function_name": "getValue",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "308-329",
          "snippet": "int IniSection::getValue (const YCPPath&p, YCPValue&out,int what, int depth)\n{\n    string k = ip->changeCase (p->component_str (depth));\n    if (depth + 1 < p->length())\n    {\n\t// it must be a section\n\t// Get any section of that name\n\tIniSectionIdxIterator sxi = isections.find (k);\n\tif (sxi != isections.end())\n\t{\n\t    return sxi->second->s ().getValue (p, out, what, depth+1);\n\t}\n\t// else error\n    }\n    else\n\t{   //We are in THE section. Find value here\n\t    return getMyValue (p, out, what, depth);\n\t}\n\n    y2debug (\"Read: Invalid path %s [%d]\", p->toString().c_str(), depth);\n    return -1;\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::getValue (const YCPPath&p, YCPValue&out,int what, int depth)\n  {\n      string k = ip->changeCase (p->component_str (depth));\n      if (depth + 1 < p->length())\n      {\n  \t// it must be a section\n  \t// Get any section of that name\n  \tIniSectionIdxIterator sxi = isections.find (k);\n  \tif (sxi != isections.end())\n  \t{\n  \t    return sxi->second->s ().getValue (p, out, what, depth+1);\n  \t}\n  \t// else error\n      }\n      else\n  \t{   //We are in THE section. Find value here\n  \t    return getMyValue (p, out, what, depth);\n  \t}\n  \n      y2debug (\"Read: Invalid path %s [%d]\", p->toString().c_str(), depth);\n      return -1;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "p->component_str",
          "args": [
            "0"
          ],
          "line": 1058
        },
        "resolved": true,
        "details": {
          "function_name": "component_str",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "161-165",
          "snippet": "string\nYCPPathRep::component_str(long index) const\n{\n    return components[index].component.asString();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  string\n  YCPPathRep::component_str(long index) const\n  {\n      return components[index].component.asString();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2error",
          "args": [
            "\"I do not know what to read from %s.\"",
            "p->toString().c_str()"
          ],
          "line": 1055
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p->length",
          "args": [],
          "line": 1053
        },
        "resolved": true,
        "details": {
          "function_name": "length",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "124-128",
          "snippet": "long\nYCPPathRep::length() const\n{\n    return components.size();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  long\n  YCPPathRep::length() const\n  {\n      return components.size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getAll",
          "args": [
            "p",
            "out",
            "1"
          ],
          "line": 1050
        },
        "resolved": true,
        "details": {
          "function_name": "getAll",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "389-411",
          "snippet": "int IniSection::getAll (const YCPPath&p, YCPValue&out, int depth)\n{\n    if (depth < p->length ())\n    {\n\t// recurse to find the starting section\n\t// Get any section of that name\n\tstring k = ip->changeCase (p->component_str (depth));\n\tIniSectionIdxIterator sxi = isections.find (k);\n\tif (sxi != isections.end())\n\t{\n\t    return sxi->second->s ().getAll (p, out, depth+1);\n\t}\n\t// else error\n    }\n    else\n    {\n\tout = getAllDoIt ();\n\treturn 0;\n    }\n\n    y2error (\"Read: Invalid path %s [%d]\", p->toString().c_str(), depth);\n    return -1;\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::getAll (const YCPPath&p, YCPValue&out, int depth)\n  {\n      if (depth < p->length ())\n      {\n  \t// recurse to find the starting section\n  \t// Get any section of that name\n  \tstring k = ip->changeCase (p->component_str (depth));\n  \tIniSectionIdxIterator sxi = isections.find (k);\n  \tif (sxi != isections.end())\n  \t{\n  \t    return sxi->second->s ().getAll (p, out, depth+1);\n  \t}\n  \t// else error\n      }\n      else\n      {\n  \tout = getAllDoIt ();\n  \treturn 0;\n      }\n  \n      y2error (\"Read: Invalid path %s [%d]\", p->toString().c_str(), depth);\n      return -1;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getValueFlat",
          "args": [
            "p",
            "out"
          ],
          "line": 1046
        },
        "resolved": true,
        "details": {
          "function_name": "getValueFlat",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "1013-1021",
          "snippet": "int IniSection::getValueFlat (const YCPPath&p, YCPValue&out)\n{\n    if (!p->length ())\n\treturn -1;\n    string k = ip->changeCase (p->component_str (0));\n    bool want_comment = p->length()>1 && p->component_str(1)==\"comment\";\n\n    return getMyValue (p, out, want_comment, 0);\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::getValueFlat (const YCPPath&p, YCPValue&out)\n  {\n      if (!p->length ())\n  \treturn -1;\n      string k = ip->changeCase (p->component_str (0));\n      bool want_comment = p->length()>1 && p->component_str(1)==\"comment\";\n  \n      return getMyValue (p, out, want_comment, 0);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ip->isFlat",
          "args": [],
          "line": 1045
        },
        "resolved": true,
        "details": {
          "function_name": "isFlat",
          "container": "IniParser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.h",
          "lines": "460-460",
          "snippet": "bool isFlat () const { return flat; }",
          "includes": [
            "#include \"IniFile.h\"",
            "#include <set>",
            "#include <vector>",
            "#include <string>",
            "#include <fstream>",
            "#include <iosfwd>",
            "#include <YCP.h>",
            "#include <y2util/RepDef.h>",
            "#include <locale.h>",
            "#include <regex.h>",
            "#include <stdio.h>",
            "#include <ctype.h>",
            "#include <unistd.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include <set>\n#include <vector>\n#include <string>\n#include <fstream>\n#include <iosfwd>\n#include <YCP.h>\n#include <y2util/RepDef.h>\n#include <locale.h>\n#include <regex.h>\n#include <stdio.h>\n#include <ctype.h>\n#include <unistd.h>\n\nIniParser {\n  bool isFlat () const { return flat; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::Read (const YCPPath&p, YCPValue&out, bool rewrite)\n  {\n      if (ip->isFlat ())\n  \treturn getValueFlat (p, out);\n  \n      if (p->length() >= 1 && p->component_str (0) == \"all\")\n      {\n  \treturn getAll (p, out, 1);\n      }\n  \n      if (p->length()<2)\n  \t{\n  \t    y2error (\"I do not know what to read from %s.\", p->toString().c_str());\n  \t    return -1;\n  \t}\n      string s = p->component_str(0);\n      if (s == \"v\" || s == \"value\")\n  \treturn getValue (p, out, 0, 1);\n      else if (s == \"vc\" || s == \"value_comment\" || s == \"valuecomment\")\n  \treturn getValue (p, out, 1, 1);\n      else if (s == \"vt\" || s == \"value_type\" || s == \"valuetype\")\n  \treturn getValue (p, out, 2, 1);\n      else if (s == \"sc\" || s == \"section_comment\" || s == \"sectioncomment\")\n  \treturn getSectionProp (p, out, 0, 1);\n      else if (s == \"st\" || s == \"section_type\" || s == \"sectiontype\")\n  \treturn getSectionProp (p, out, rewrite? 1:2, 1);\n  \n      y2error (\"I do not know what to read from %s.\", p->toString().c_str());\n      return -1;\n  }\n}"
  },
  {
    "function_name": "setValueFlat",
    "container": "IniSection",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "1033-1041",
    "snippet": "int IniSection::setValueFlat (const YCPPath&p, const YCPValue &in)\n{\n    if (!p->length ())\n\treturn -1;\n    string k = ip->changeCase (p->component_str (0));\n    bool want_comment = p->length()>1 && p->component_str(1)==\"comment\";\n\n    return setMyValue (p, in, want_comment, 0);\n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setMyValue",
          "args": [
            "p",
            "in",
            "want_comment",
            "0"
          ],
          "line": 1040
        },
        "resolved": true,
        "details": {
          "function_name": "setMyValue",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "784-883",
          "snippet": "int IniSection::setMyValue (const YCPPath &p, const YCPValue&in, int what, int depth)\n{\n    // assert (depth == p->length ()); //not, it can have a .comment suffix\n    string k = ip->changeCase (p->component_str (depth));\n    pair <IniEntryIdxIterator, IniEntryIdxIterator> r =\n\tivalues.equal_range (k);\n    IniEntryIdxIterator xi = r.first, xe = r.second;\n\n    // make sure we have a list of values\n    YCPList props;\n    if (ip->repeatNames ())\n    {\n\tprops = as_list (in, \"section with repeat_names\");\n\tif (props.isNull())\n\t    return -1;\n    }\n    else\n    {\n\tprops->add (in);\n    }\n    int pi = 0, pe = props->size ();\n\n    // Go simultaneously through the found values\n    // and the list of parameters, while _either_ lasts\n    // Fewer values-> add them, more values-> delete them\n    while (pi != pe || xi != xe)\n    {\n\t// watch out for validity of iterators!\n\n\tif (pi == pe)\n\t{\n\t    // deleting a value\n\t    delValue1 (xi++);\n\t    // no ++pi\n\t}\n\telse\n\t{\n\t    YCPValue prop = props->value (pi);\n\t    IniIterator ei;\n\t    if (xi == xe)\n\t    {\n\t\t///need to add a value ...\n\t\ty2debug (\"Adding value %s = %s\",\n\t\t\t p->toString ().c_str (), prop->toString().c_str ());\n\t\tif (what)\n\t\t{\n\t\t    y2error (\"You must add value before changing comment/type. %s\",\n\t\t\t     p->toString ().c_str ());\n\t\t    return -1;\n\t\t}\n\t\t// prepare it to have its property set\n\t\t// create it\n\t\tIniEntry e;\n\t\t// need to set its name\n\t\te.setName (k);\n\n\t\t// insert and index\n\t\tcontainer.push_back (IniContainerElement (e));\n\t\tivalues.insert (IniEntryIndex::value_type (k, --container.end ()));\n\t\tei = --container.end ();\n\t    }\n\t    else\n\t    {\n\t\tei = xi->second;\n\t    }\n\n\t    // set a value's property\n\t    IniEntry & e = ei->e ();\n\t    switch (what)\n\t    {\n\t\tcase 0:\n\t\t    e.setValue (to_string (prop));\n\t\t    break;\n\t\tcase 1: {\n\t\t    YCPString s = as_string (prop, \"comment\");\n\t\t    if (s.isNull())\n\t\t\treturn -1;\n\t\t    e.setComment (s->value());\n\t\t    break;\n\t\t}\n\t\tdefault: {\n\t\t    YCPInteger i = as_integer (prop, \"value_type\");\n\t\t    if (i.isNull())\n\t\t\treturn -1;\n\t\t    e.setReadBy (i->value());\n\t\t    break;\n\t\t}\n\t    }\n\n\t    if (xi != xe)\n\t    {\n\t\t++xi;\n\t    }\n\t    ++pi;\n\t}\n\t// iterators have been advanced already\n    }\n    dirty = true;\n    return 0;\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::setMyValue (const YCPPath &p, const YCPValue&in, int what, int depth)\n  {\n      // assert (depth == p->length ()); //not, it can have a .comment suffix\n      string k = ip->changeCase (p->component_str (depth));\n      pair <IniEntryIdxIterator, IniEntryIdxIterator> r =\n  \tivalues.equal_range (k);\n      IniEntryIdxIterator xi = r.first, xe = r.second;\n  \n      // make sure we have a list of values\n      YCPList props;\n      if (ip->repeatNames ())\n      {\n  \tprops = as_list (in, \"section with repeat_names\");\n  \tif (props.isNull())\n  \t    return -1;\n      }\n      else\n      {\n  \tprops->add (in);\n      }\n      int pi = 0, pe = props->size ();\n  \n      // Go simultaneously through the found values\n      // and the list of parameters, while _either_ lasts\n      // Fewer values-> add them, more values-> delete them\n      while (pi != pe || xi != xe)\n      {\n  \t// watch out for validity of iterators!\n  \n  \tif (pi == pe)\n  \t{\n  \t    // deleting a value\n  \t    delValue1 (xi++);\n  \t    // no ++pi\n  \t}\n  \telse\n  \t{\n  \t    YCPValue prop = props->value (pi);\n  \t    IniIterator ei;\n  \t    if (xi == xe)\n  \t    {\n  \t\t///need to add a value ...\n  \t\ty2debug (\"Adding value %s = %s\",\n  \t\t\t p->toString ().c_str (), prop->toString().c_str ());\n  \t\tif (what)\n  \t\t{\n  \t\t    y2error (\"You must add value before changing comment/type. %s\",\n  \t\t\t     p->toString ().c_str ());\n  \t\t    return -1;\n  \t\t}\n  \t\t// prepare it to have its property set\n  \t\t// create it\n  \t\tIniEntry e;\n  \t\t// need to set its name\n  \t\te.setName (k);\n  \n  \t\t// insert and index\n  \t\tcontainer.push_back (IniContainerElement (e));\n  \t\tivalues.insert (IniEntryIndex::value_type (k, --container.end ()));\n  \t\tei = --container.end ();\n  \t    }\n  \t    else\n  \t    {\n  \t\tei = xi->second;\n  \t    }\n  \n  \t    // set a value's property\n  \t    IniEntry & e = ei->e ();\n  \t    switch (what)\n  \t    {\n  \t\tcase 0:\n  \t\t    e.setValue (to_string (prop));\n  \t\t    break;\n  \t\tcase 1: {\n  \t\t    YCPString s = as_string (prop, \"comment\");\n  \t\t    if (s.isNull())\n  \t\t\treturn -1;\n  \t\t    e.setComment (s->value());\n  \t\t    break;\n  \t\t}\n  \t\tdefault: {\n  \t\t    YCPInteger i = as_integer (prop, \"value_type\");\n  \t\t    if (i.isNull())\n  \t\t\treturn -1;\n  \t\t    e.setReadBy (i->value());\n  \t\t    break;\n  \t\t}\n  \t    }\n  \n  \t    if (xi != xe)\n  \t    {\n  \t\t++xi;\n  \t    }\n  \t    ++pi;\n  \t}\n  \t// iterators have been advanced already\n      }\n      dirty = true;\n      return 0;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "p->component_str",
          "args": [
            "1"
          ],
          "line": 1038
        },
        "resolved": true,
        "details": {
          "function_name": "component_str",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "161-165",
          "snippet": "string\nYCPPathRep::component_str(long index) const\n{\n    return components[index].component.asString();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  string\n  YCPPathRep::component_str(long index) const\n  {\n      return components[index].component.asString();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "p->length",
          "args": [],
          "line": 1038
        },
        "resolved": true,
        "details": {
          "function_name": "length",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "124-128",
          "snippet": "long\nYCPPathRep::length() const\n{\n    return components.size();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  long\n  YCPPathRep::length() const\n  {\n      return components.size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ip->changeCase",
          "args": [
            "p->component_str (0)"
          ],
          "line": 1037
        },
        "resolved": true,
        "details": {
          "function_name": "changeCase",
          "container": "IniParser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.cc",
          "lines": "1098-1120",
          "snippet": "string IniParser::changeCase (const string&str) const\n{\n    string tmp = str;\n    if (!ignore_case)\n      return tmp;\n    if (prefer_uppercase)\n    {\n\tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n\t    *it = toupper (*it);\n    }\n    else\n    {\n\tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n\t    *it = tolower (*it);\n\tif (first_upper)\n\t{\n\tstring::iterator it = tmp.begin ();\n\tif (it != tmp.end ())\n\t    *it = toupper (*it);\n\t}\t    \n    }\n    return tmp;\n}",
          "includes": [
            "#include \"IniFile.h\"",
            "#include \"IniParser.h\"",
            "#include <cassert>",
            "#include <glob.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <errno.h>",
            "#include <set>",
            "#include <vector>",
            "#include <ycp/y2log.h>",
            "#include <y2util/PathInfo.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include \"IniParser.h\"\n#include <cassert>\n#include <glob.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <errno.h>\n#include <set>\n#include <vector>\n#include <ycp/y2log.h>\n#include <y2util/PathInfo.h>\n#include \"config.h\"\n\nIniParser {\n  string IniParser::changeCase (const string&str) const\n  {\n      string tmp = str;\n      if (!ignore_case)\n        return tmp;\n      if (prefer_uppercase)\n      {\n  \tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n  \t    *it = toupper (*it);\n      }\n      else\n      {\n  \tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n  \t    *it = tolower (*it);\n  \tif (first_upper)\n  \t{\n  \tstring::iterator it = tmp.begin ();\n  \tif (it != tmp.end ())\n  \t    *it = toupper (*it);\n  \t}\t    \n      }\n      return tmp;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::setValueFlat (const YCPPath&p, const YCPValue &in)\n  {\n      if (!p->length ())\n  \treturn -1;\n      string k = ip->changeCase (p->component_str (0));\n      bool want_comment = p->length()>1 && p->component_str(1)==\"comment\";\n  \n      return setMyValue (p, in, want_comment, 0);\n  }\n}"
  },
  {
    "function_name": "delValueFlat",
    "container": "IniSection",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "1023-1031",
    "snippet": "int IniSection::delValueFlat (const YCPPath&p)\n{\n    if (!p->length ())\n\treturn -1;\n    string k = ip->changeCase (p->component_str (0));\n\n    delMyValue (k);\n    return 0;\n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "delMyValue",
          "args": [
            "k"
          ],
          "line": 1029
        },
        "resolved": true,
        "details": {
          "function_name": "delMyValue",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "934-948",
          "snippet": "void IniSection::delMyValue (const string &k)\n{\n    pair <IniEntryIdxIterator, IniEntryIdxIterator> r =\n\tivalues.equal_range (k);\n    IniEntryIdxIterator xi = r.first, xe = r.second;\n\n    if (xi == xe)\n    {\n\ty2debug (\"Can not delete %s. Key does not exist.\", k.c_str());\n    }\n    while (xi != xe)\n    {\n\tdelValue1 (xi++);\n    }\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  void IniSection::delMyValue (const string &k)\n  {\n      pair <IniEntryIdxIterator, IniEntryIdxIterator> r =\n  \tivalues.equal_range (k);\n      IniEntryIdxIterator xi = r.first, xe = r.second;\n  \n      if (xi == xe)\n      {\n  \ty2debug (\"Can not delete %s. Key does not exist.\", k.c_str());\n      }\n      while (xi != xe)\n      {\n  \tdelValue1 (xi++);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ip->changeCase",
          "args": [
            "p->component_str (0)"
          ],
          "line": 1027
        },
        "resolved": true,
        "details": {
          "function_name": "changeCase",
          "container": "IniParser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.cc",
          "lines": "1098-1120",
          "snippet": "string IniParser::changeCase (const string&str) const\n{\n    string tmp = str;\n    if (!ignore_case)\n      return tmp;\n    if (prefer_uppercase)\n    {\n\tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n\t    *it = toupper (*it);\n    }\n    else\n    {\n\tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n\t    *it = tolower (*it);\n\tif (first_upper)\n\t{\n\tstring::iterator it = tmp.begin ();\n\tif (it != tmp.end ())\n\t    *it = toupper (*it);\n\t}\t    \n    }\n    return tmp;\n}",
          "includes": [
            "#include \"IniFile.h\"",
            "#include \"IniParser.h\"",
            "#include <cassert>",
            "#include <glob.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <errno.h>",
            "#include <set>",
            "#include <vector>",
            "#include <ycp/y2log.h>",
            "#include <y2util/PathInfo.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include \"IniParser.h\"\n#include <cassert>\n#include <glob.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <errno.h>\n#include <set>\n#include <vector>\n#include <ycp/y2log.h>\n#include <y2util/PathInfo.h>\n#include \"config.h\"\n\nIniParser {\n  string IniParser::changeCase (const string&str) const\n  {\n      string tmp = str;\n      if (!ignore_case)\n        return tmp;\n      if (prefer_uppercase)\n      {\n  \tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n  \t    *it = toupper (*it);\n      }\n      else\n      {\n  \tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n  \t    *it = tolower (*it);\n  \tif (first_upper)\n  \t{\n  \tstring::iterator it = tmp.begin ();\n  \tif (it != tmp.end ())\n  \t    *it = toupper (*it);\n  \t}\t    \n      }\n      return tmp;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "p->component_str",
          "args": [
            "0"
          ],
          "line": 1027
        },
        "resolved": true,
        "details": {
          "function_name": "component_str",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "161-165",
          "snippet": "string\nYCPPathRep::component_str(long index) const\n{\n    return components[index].component.asString();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  string\n  YCPPathRep::component_str(long index) const\n  {\n      return components[index].component.asString();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "p->length",
          "args": [],
          "line": 1025
        },
        "resolved": true,
        "details": {
          "function_name": "length",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "124-128",
          "snippet": "long\nYCPPathRep::length() const\n{\n    return components.size();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  long\n  YCPPathRep::length() const\n  {\n      return components.size();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::delValueFlat (const YCPPath&p)\n  {\n      if (!p->length ())\n  \treturn -1;\n      string k = ip->changeCase (p->component_str (0));\n  \n      delMyValue (k);\n      return 0;\n  }\n}"
  },
  {
    "function_name": "getValueFlat",
    "container": "IniSection",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "1013-1021",
    "snippet": "int IniSection::getValueFlat (const YCPPath&p, YCPValue&out)\n{\n    if (!p->length ())\n\treturn -1;\n    string k = ip->changeCase (p->component_str (0));\n    bool want_comment = p->length()>1 && p->component_str(1)==\"comment\";\n\n    return getMyValue (p, out, want_comment, 0);\n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "getMyValue",
          "args": [
            "p",
            "out",
            "want_comment",
            "0"
          ],
          "line": 1020
        },
        "resolved": true,
        "details": {
          "function_name": "getMyValue",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "270-306",
          "snippet": "int IniSection::getMyValue (const YCPPath &p, YCPValue &out, int what, int depth)\n{\n    string k = ip->changeCase (p->component_str (depth));\n    // Find all values and return them according to repeat_names\n    YCPList results;\n    bool found = false;\n    pair <IniEntryIdxIterator, IniEntryIdxIterator> r =\n\tivalues.equal_range (k);\n    IniEntryIdxIterator xi = r.first, xe = r.second;\n    for (; xi != xe; ++xi)\n    {\n\tfound = true;\n\tIniEntry& e = xi->second-> e ();\n\tswitch (what)\n\t{\n\t    case 0:  out = YCPString (e.getValue ());  break;\n\t    case 1:  out = YCPString (e.getComment()); break;\n\t    default: out = YCPInteger(e.getReadBy ()); break;\n\t}\n\tresults->add (out);\n    }\n\n    if (ip->repeatNames ())\n    {\n\tout = results;\n\treturn 0;\n    }\n    else if (found)\n    {\n\t// nonempty range, the cycle ran once, out has the right value\n\treturn 0;\n    }\n    // empty range, no such key\n\n    y2debug (\"Read: Invalid path %s [%d]\", p->toString ().c_str(), depth);\n    return -1;\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::getMyValue (const YCPPath &p, YCPValue &out, int what, int depth)\n  {\n      string k = ip->changeCase (p->component_str (depth));\n      // Find all values and return them according to repeat_names\n      YCPList results;\n      bool found = false;\n      pair <IniEntryIdxIterator, IniEntryIdxIterator> r =\n  \tivalues.equal_range (k);\n      IniEntryIdxIterator xi = r.first, xe = r.second;\n      for (; xi != xe; ++xi)\n      {\n  \tfound = true;\n  \tIniEntry& e = xi->second-> e ();\n  \tswitch (what)\n  \t{\n  \t    case 0:  out = YCPString (e.getValue ());  break;\n  \t    case 1:  out = YCPString (e.getComment()); break;\n  \t    default: out = YCPInteger(e.getReadBy ()); break;\n  \t}\n  \tresults->add (out);\n      }\n  \n      if (ip->repeatNames ())\n      {\n  \tout = results;\n  \treturn 0;\n      }\n      else if (found)\n      {\n  \t// nonempty range, the cycle ran once, out has the right value\n  \treturn 0;\n      }\n      // empty range, no such key\n  \n      y2debug (\"Read: Invalid path %s [%d]\", p->toString ().c_str(), depth);\n      return -1;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "p->component_str",
          "args": [
            "1"
          ],
          "line": 1018
        },
        "resolved": true,
        "details": {
          "function_name": "component_str",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "161-165",
          "snippet": "string\nYCPPathRep::component_str(long index) const\n{\n    return components[index].component.asString();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  string\n  YCPPathRep::component_str(long index) const\n  {\n      return components[index].component.asString();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "p->length",
          "args": [],
          "line": 1018
        },
        "resolved": true,
        "details": {
          "function_name": "length",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "124-128",
          "snippet": "long\nYCPPathRep::length() const\n{\n    return components.size();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  long\n  YCPPathRep::length() const\n  {\n      return components.size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ip->changeCase",
          "args": [
            "p->component_str (0)"
          ],
          "line": 1017
        },
        "resolved": true,
        "details": {
          "function_name": "changeCase",
          "container": "IniParser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.cc",
          "lines": "1098-1120",
          "snippet": "string IniParser::changeCase (const string&str) const\n{\n    string tmp = str;\n    if (!ignore_case)\n      return tmp;\n    if (prefer_uppercase)\n    {\n\tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n\t    *it = toupper (*it);\n    }\n    else\n    {\n\tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n\t    *it = tolower (*it);\n\tif (first_upper)\n\t{\n\tstring::iterator it = tmp.begin ();\n\tif (it != tmp.end ())\n\t    *it = toupper (*it);\n\t}\t    \n    }\n    return tmp;\n}",
          "includes": [
            "#include \"IniFile.h\"",
            "#include \"IniParser.h\"",
            "#include <cassert>",
            "#include <glob.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <errno.h>",
            "#include <set>",
            "#include <vector>",
            "#include <ycp/y2log.h>",
            "#include <y2util/PathInfo.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include \"IniParser.h\"\n#include <cassert>\n#include <glob.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <errno.h>\n#include <set>\n#include <vector>\n#include <ycp/y2log.h>\n#include <y2util/PathInfo.h>\n#include \"config.h\"\n\nIniParser {\n  string IniParser::changeCase (const string&str) const\n  {\n      string tmp = str;\n      if (!ignore_case)\n        return tmp;\n      if (prefer_uppercase)\n      {\n  \tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n  \t    *it = toupper (*it);\n      }\n      else\n      {\n  \tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n  \t    *it = tolower (*it);\n  \tif (first_upper)\n  \t{\n  \tstring::iterator it = tmp.begin ();\n  \tif (it != tmp.end ())\n  \t    *it = toupper (*it);\n  \t}\t    \n      }\n      return tmp;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::getValueFlat (const YCPPath&p, YCPValue&out)\n  {\n      if (!p->length ())\n  \treturn -1;\n      string k = ip->changeCase (p->component_str (0));\n      bool want_comment = p->length()>1 && p->component_str(1)==\"comment\";\n  \n      return getMyValue (p, out, want_comment, 0);\n  }\n}"
  },
  {
    "function_name": "dirValueFlat",
    "container": "IniSection",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "998-1011",
    "snippet": "int IniSection::dirValueFlat (const YCPPath&p, YCPList&l)\n{\n    // This function used to discard p and always return Dir (.)\n    // #21574\n    if (p->length () != 0)\n    {\n\t// Leave l empty.\n\t// Maybe we should differentiate between Dir (.existing_value)\n\t// and Dir (.bogus) ?\n\treturn 0;\n    }\n\n    return myDir (l, VALUE);\n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "myDir",
          "args": [
            "l",
            "VALUE"
          ],
          "line": 1010
        },
        "resolved": true,
        "details": {
          "function_name": "myDir",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "982-996",
          "snippet": "int IniSection::myDir (YCPList& l, IniType what)\n{\n    IniIterator i = container.begin (), e = container.end ();\n    for (; i != e; ++i)\n    {\n\tif (i->t () == what)\n\t{\n\t    string n = (what == SECTION) ?\n\t\ti->s ().getName () :\n\t\ti->e ().getName ();\n\t    l->add (YCPString (n));\n\t}\n    }\n    return 0;\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::myDir (YCPList& l, IniType what)\n  {\n      IniIterator i = container.begin (), e = container.end ();\n      for (; i != e; ++i)\n      {\n  \tif (i->t () == what)\n  \t{\n  \t    string n = (what == SECTION) ?\n  \t\ti->s ().getName () :\n  \t\ti->e ().getName ();\n  \t    l->add (YCPString (n));\n  \t}\n      }\n      return 0;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "p->length",
          "args": [],
          "line": 1002
        },
        "resolved": true,
        "details": {
          "function_name": "length",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "124-128",
          "snippet": "long\nYCPPathRep::length() const\n{\n    return components.size();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  long\n  YCPPathRep::length() const\n  {\n      return components.size();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::dirValueFlat (const YCPPath&p, YCPList&l)\n  {\n      // This function used to discard p and always return Dir (.)\n      // #21574\n      if (p->length () != 0)\n      {\n  \t// Leave l empty.\n  \t// Maybe we should differentiate between Dir (.existing_value)\n  \t// and Dir (.bogus) ?\n  \treturn 0;\n      }\n  \n      return myDir (l, VALUE);\n  }\n}"
  },
  {
    "function_name": "myDir",
    "container": "IniSection",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "982-996",
    "snippet": "int IniSection::myDir (YCPList& l, IniType what)\n{\n    IniIterator i = container.begin (), e = container.end ();\n    for (; i != e; ++i)\n    {\n\tif (i->t () == what)\n\t{\n\t    string n = (what == SECTION) ?\n\t\ti->s ().getName () :\n\t\ti->e ().getName ();\n\t    l->add (YCPString (n));\n\t}\n    }\n    return 0;\n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "l->add",
          "args": [
            "YCPString (n)"
          ],
          "line": 992
        },
        "resolved": true,
        "details": {
          "function_name": "add",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "141-145",
          "snippet": "void\nYCPTermRep::add (const YCPValue& value)\n{\n    l->add(value);\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  void\n  YCPTermRep::add (const YCPValue& value)\n  {\n      l->add(value);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPString",
          "args": [
            "n"
          ],
          "line": 992
        },
        "resolved": true,
        "details": {
          "function_name": "isYCPStringPair",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.cc",
          "lines": "92-102",
          "snippet": "bool isYCPStringPair (const YCPValue &v)\n{\n    if (!v->isList ())\n\treturn false;\n    YCPList l = v->asList ();\n    if (l->size () != 2)\n\treturn false;\n    return\n\tl->value (0)->isString () &&\n\tl->value (1)->isString ();\n}",
          "includes": [
            "#include \"IniFile.h\"",
            "#include \"IniParser.h\"",
            "#include <cassert>",
            "#include <glob.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <errno.h>",
            "#include <set>",
            "#include <vector>",
            "#include <ycp/y2log.h>",
            "#include <y2util/PathInfo.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include \"IniParser.h\"\n#include <cassert>\n#include <glob.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <errno.h>\n#include <set>\n#include <vector>\n#include <ycp/y2log.h>\n#include <y2util/PathInfo.h>\n#include \"config.h\"\n\nbool isYCPStringPair (const YCPValue &v)\n{\n    if (!v->isList ())\n\treturn false;\n    YCPList l = v->asList ();\n    if (l->size () != 2)\n\treturn false;\n    return\n\tl->value (0)->isString () &&\n\tl->value (1)->isString ();\n}"
        }
      },
      {
        "call_info": {
          "callee": "i->e",
          "args": [],
          "line": 991
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->e",
          "args": [],
          "line": 991
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->s",
          "args": [],
          "line": 990
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->s",
          "args": [],
          "line": 990
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->t",
          "args": [],
          "line": 987
        },
        "resolved": true,
        "details": {
          "function_name": "t",
          "container": "IniContainerElement",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.h",
          "lines": "610-610",
          "snippet": "IniType t () const { return _t; }",
          "includes": [
            "#include <YCP.h>",
            "#include <vector>",
            "#include <list>",
            "#include <map>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <YCP.h>\n#include <vector>\n#include <list>\n#include <map>\n#include <string>\n\nIniContainerElement {\n  IniType t () const { return _t; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "container.end",
          "args": [],
          "line": 984
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "43-47",
          "snippet": "YCPMapIterator\nYCPMapRep::end() const\n{\n    return stl_map.end();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::end() const\n  {\n      return stl_map.end();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "container.begin",
          "args": [],
          "line": 984
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "36-40",
          "snippet": "YCPMapIterator\nYCPMapRep::begin() const\n{\n    return stl_map.begin();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::begin() const\n  {\n      return stl_map.begin();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::myDir (YCPList& l, IniType what)\n  {\n      IniIterator i = container.begin (), e = container.end ();\n      for (; i != e; ++i)\n      {\n  \tif (i->t () == what)\n  \t{\n  \t    string n = (what == SECTION) ?\n  \t\ti->s ().getName () :\n  \t\ti->e ().getName ();\n  \t    l->add (YCPString (n));\n  \t}\n      }\n      return 0;\n  }\n}"
  },
  {
    "function_name": "delValue",
    "container": "IniSection",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "950-980",
    "snippet": "int IniSection::delValue (const YCPPath&p, int depth)\n{\n    string k = ip->changeCase (p->component_str (depth));\n    // Find the matching sections.\n    // If we need to recurse, choose one\n    // Otherwise kill all values of the name\n\n    if (depth + 1 < p->length())\n    {\n\t// recurse\n\tpair <IniSectionIdxIterator, IniSectionIdxIterator> r =\n\t    isections.equal_range (k);\n\tIniSectionIdxIterator xi = r.first, xe = r.second;\n\n\tif (xi != xe)\n\t{\n\t    // there's something\n\t    IniSection& s = (--xe)->second->s ();\n\t    return s.delValue (p, depth+1);\n\t}\n\t//error\n\ty2error (\"Delete: Invalid path %s [%d]\", p->toString().c_str(), depth);\n\treturn -1;\n    }\n    else\n    {\n\t// bottom level, massacre begins\n\tdelMyValue (k);\n    }\n    return 0;\n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "delMyValue",
          "args": [
            "k"
          ],
          "line": 977
        },
        "resolved": true,
        "details": {
          "function_name": "delMyValue",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "934-948",
          "snippet": "void IniSection::delMyValue (const string &k)\n{\n    pair <IniEntryIdxIterator, IniEntryIdxIterator> r =\n\tivalues.equal_range (k);\n    IniEntryIdxIterator xi = r.first, xe = r.second;\n\n    if (xi == xe)\n    {\n\ty2debug (\"Can not delete %s. Key does not exist.\", k.c_str());\n    }\n    while (xi != xe)\n    {\n\tdelValue1 (xi++);\n    }\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  void IniSection::delMyValue (const string &k)\n  {\n      pair <IniEntryIdxIterator, IniEntryIdxIterator> r =\n  \tivalues.equal_range (k);\n      IniEntryIdxIterator xi = r.first, xe = r.second;\n  \n      if (xi == xe)\n      {\n  \ty2debug (\"Can not delete %s. Key does not exist.\", k.c_str());\n      }\n      while (xi != xe)\n      {\n  \tdelValue1 (xi++);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2error",
          "args": [
            "\"Delete: Invalid path %s [%d]\"",
            "p->toString().c_str()",
            "depth"
          ],
          "line": 971
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p->toString",
          "args": [],
          "line": 971
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "YBreakpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YBreakpoint.cc",
          "lines": "87-91",
          "snippet": "string\nYBreakpoint::toString() const\n{\n    return m_code->toString ();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YBreakpoint.h\"",
            "#include <debugger/Debugger.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YBreakpoint.h\"\n#include <debugger/Debugger.h>\n#include <libintl.h>\n\nYBreakpoint {\n  string\n  YBreakpoint::toString() const\n  {\n      return m_code->toString ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "s.delValue",
          "args": [
            "p",
            "depth+1"
          ],
          "line": 968
        },
        "resolved": true,
        "details": {
          "function_name": "delValue",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "950-980",
          "snippet": "int IniSection::delValue (const YCPPath&p, int depth)\n{\n    string k = ip->changeCase (p->component_str (depth));\n    // Find the matching sections.\n    // If we need to recurse, choose one\n    // Otherwise kill all values of the name\n\n    if (depth + 1 < p->length())\n    {\n\t// recurse\n\tpair <IniSectionIdxIterator, IniSectionIdxIterator> r =\n\t    isections.equal_range (k);\n\tIniSectionIdxIterator xi = r.first, xe = r.second;\n\n\tif (xi != xe)\n\t{\n\t    // there's something\n\t    IniSection& s = (--xe)->second->s ();\n\t    return s.delValue (p, depth+1);\n\t}\n\t//error\n\ty2error (\"Delete: Invalid path %s [%d]\", p->toString().c_str(), depth);\n\treturn -1;\n    }\n    else\n    {\n\t// bottom level, massacre begins\n\tdelMyValue (k);\n    }\n    return 0;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 967
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isections.equal_range",
          "args": [
            "k"
          ],
          "line": 961
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p->length",
          "args": [],
          "line": 957
        },
        "resolved": true,
        "details": {
          "function_name": "length",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "124-128",
          "snippet": "long\nYCPPathRep::length() const\n{\n    return components.size();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  long\n  YCPPathRep::length() const\n  {\n      return components.size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ip->changeCase",
          "args": [
            "p->component_str (depth)"
          ],
          "line": 952
        },
        "resolved": true,
        "details": {
          "function_name": "changeCase",
          "container": "IniParser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.cc",
          "lines": "1098-1120",
          "snippet": "string IniParser::changeCase (const string&str) const\n{\n    string tmp = str;\n    if (!ignore_case)\n      return tmp;\n    if (prefer_uppercase)\n    {\n\tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n\t    *it = toupper (*it);\n    }\n    else\n    {\n\tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n\t    *it = tolower (*it);\n\tif (first_upper)\n\t{\n\tstring::iterator it = tmp.begin ();\n\tif (it != tmp.end ())\n\t    *it = toupper (*it);\n\t}\t    \n    }\n    return tmp;\n}",
          "includes": [
            "#include \"IniFile.h\"",
            "#include \"IniParser.h\"",
            "#include <cassert>",
            "#include <glob.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <errno.h>",
            "#include <set>",
            "#include <vector>",
            "#include <ycp/y2log.h>",
            "#include <y2util/PathInfo.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include \"IniParser.h\"\n#include <cassert>\n#include <glob.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <errno.h>\n#include <set>\n#include <vector>\n#include <ycp/y2log.h>\n#include <y2util/PathInfo.h>\n#include \"config.h\"\n\nIniParser {\n  string IniParser::changeCase (const string&str) const\n  {\n      string tmp = str;\n      if (!ignore_case)\n        return tmp;\n      if (prefer_uppercase)\n      {\n  \tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n  \t    *it = toupper (*it);\n      }\n      else\n      {\n  \tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n  \t    *it = tolower (*it);\n  \tif (first_upper)\n  \t{\n  \tstring::iterator it = tmp.begin ();\n  \tif (it != tmp.end ())\n  \t    *it = toupper (*it);\n  \t}\t    \n      }\n      return tmp;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "p->component_str",
          "args": [
            "depth"
          ],
          "line": 952
        },
        "resolved": true,
        "details": {
          "function_name": "component_str",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "161-165",
          "snippet": "string\nYCPPathRep::component_str(long index) const\n{\n    return components[index].component.asString();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  string\n  YCPPathRep::component_str(long index) const\n  {\n      return components[index].component.asString();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::delValue (const YCPPath&p, int depth)\n  {\n      string k = ip->changeCase (p->component_str (depth));\n      // Find the matching sections.\n      // If we need to recurse, choose one\n      // Otherwise kill all values of the name\n  \n      if (depth + 1 < p->length())\n      {\n  \t// recurse\n  \tpair <IniSectionIdxIterator, IniSectionIdxIterator> r =\n  \t    isections.equal_range (k);\n  \tIniSectionIdxIterator xi = r.first, xe = r.second;\n  \n  \tif (xi != xe)\n  \t{\n  \t    // there's something\n  \t    IniSection& s = (--xe)->second->s ();\n  \t    return s.delValue (p, depth+1);\n  \t}\n  \t//error\n  \ty2error (\"Delete: Invalid path %s [%d]\", p->toString().c_str(), depth);\n  \treturn -1;\n      }\n      else\n      {\n  \t// bottom level, massacre begins\n  \tdelMyValue (k);\n      }\n      return 0;\n  }\n}"
  },
  {
    "function_name": "delMyValue",
    "container": "IniSection",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "934-948",
    "snippet": "void IniSection::delMyValue (const string &k)\n{\n    pair <IniEntryIdxIterator, IniEntryIdxIterator> r =\n\tivalues.equal_range (k);\n    IniEntryIdxIterator xi = r.first, xe = r.second;\n\n    if (xi == xe)\n    {\n\ty2debug (\"Can not delete %s. Key does not exist.\", k.c_str());\n    }\n    while (xi != xe)\n    {\n\tdelValue1 (xi++);\n    }\n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "delValue1",
          "args": [
            "xi++"
          ],
          "line": 946
        },
        "resolved": true,
        "details": {
          "function_name": "delValue1",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "926-932",
          "snippet": "void IniSection::delValue1 (IniEntryIdxIterator exi)\n{\n    dirty = true;\n    IniIterator ei = exi->second;\n    container.erase (ei);\n    ivalues.erase (exi);\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  void IniSection::delValue1 (IniEntryIdxIterator exi)\n  {\n      dirty = true;\n      IniIterator ei = exi->second;\n      container.erase (ei);\n      ivalues.erase (exi);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Can not delete %s. Key does not exist.\"",
            "k.c_str()"
          ],
          "line": 942
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "k.c_str",
          "args": [],
          "line": 942
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ivalues.equal_range",
          "args": [
            "k"
          ],
          "line": 937
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  void IniSection::delMyValue (const string &k)\n  {\n      pair <IniEntryIdxIterator, IniEntryIdxIterator> r =\n  \tivalues.equal_range (k);\n      IniEntryIdxIterator xi = r.first, xe = r.second;\n  \n      if (xi == xe)\n      {\n  \ty2debug (\"Can not delete %s. Key does not exist.\", k.c_str());\n      }\n      while (xi != xe)\n      {\n  \tdelValue1 (xi++);\n      }\n  }\n}"
  },
  {
    "function_name": "delValue1",
    "container": "IniSection",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "926-932",
    "snippet": "void IniSection::delValue1 (IniEntryIdxIterator exi)\n{\n    dirty = true;\n    IniIterator ei = exi->second;\n    container.erase (ei);\n    ivalues.erase (exi);\n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ivalues.erase",
          "args": [
            "exi"
          ],
          "line": 931
        },
        "resolved": true,
        "details": {
          "function_name": "erase",
          "container": "PathInfo",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
          "lines": "683-695",
          "snippet": "int PathInfo::erase( const Pathname & path )\n{\n  int res = 0;\n  PathInfo p( path, LSTAT );\n  if ( p.isExist() )\n    {\n      if ( p.isDir() )\n        res = PathInfo::recursive_rmdir( path );\n      else\n        res = PathInfo::unlink( path );\n    }\n  return res;\n}",
          "includes": [
            "#include <y2util/PathInfo.h>",
            "#include <y2util/ExternalProgram.h>",
            "#include <y2util/stringutil.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <iomanip>",
            "#include <fstream>",
            "#include <iostream>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  int PathInfo::erase( const Pathname & path )\n  {\n    int res = 0;\n    PathInfo p( path, LSTAT );\n    if ( p.isExist() )\n      {\n        if ( p.isDir() )\n          res = PathInfo::recursive_rmdir( path );\n        else\n          res = PathInfo::unlink( path );\n      }\n    return res;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  void IniSection::delValue1 (IniEntryIdxIterator exi)\n  {\n      dirty = true;\n      IniIterator ei = exi->second;\n      container.erase (ei);\n      ivalues.erase (exi);\n  }\n}"
  },
  {
    "function_name": "setValue",
    "container": "IniSection",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "885-924",
    "snippet": "int IniSection::setValue (const YCPPath&p,const YCPValue&in,int what, int depth)\n{\n    string k = ip->changeCase (p->component_str (depth));\n    // Find the matching sections.\n    // If we need to recurse, choose one, creating if necessary\n    // Otherwise set all the matching values\n    //  creating and deleting if the number of them does not match\n\n    if (depth + 1 < p->length())\n    {\n\t// recurse\n\tpair <IniSectionIdxIterator, IniSectionIdxIterator> r =\n\t    isections.equal_range (k);\n\tIniSectionIdxIterator xi = r.first, xe = r.second;\n\n\tIniIterator si;\n\tif (xi == xe)\n\t{\n\t    // not found, need to add it;\n\t    y2debug (\"Write: adding recursively %s to %s\", k.c_str (), p->toString().c_str());\n\n\t    IniSection s (ip, k);\n\t    container.push_back (IniContainerElement (s));\n\t    isections.insert (IniSectionIndex::value_type (k, --container.end ()));\n\n\t    si = --container.end ();\n\t}\n\telse\n\t{\n\t    // there's something, choose last\n\t    si = (--xe)->second;\n\t}\n\treturn si->s ().setValue (p, in, what, depth+1);\n    }\n    else\n    {\n\t// bottom level\n\treturn setMyValue (p, in, what, depth);\n    }\n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setMyValue",
          "args": [
            "p",
            "in",
            "what",
            "depth"
          ],
          "line": 922
        },
        "resolved": true,
        "details": {
          "function_name": "setMyValue",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "784-883",
          "snippet": "int IniSection::setMyValue (const YCPPath &p, const YCPValue&in, int what, int depth)\n{\n    // assert (depth == p->length ()); //not, it can have a .comment suffix\n    string k = ip->changeCase (p->component_str (depth));\n    pair <IniEntryIdxIterator, IniEntryIdxIterator> r =\n\tivalues.equal_range (k);\n    IniEntryIdxIterator xi = r.first, xe = r.second;\n\n    // make sure we have a list of values\n    YCPList props;\n    if (ip->repeatNames ())\n    {\n\tprops = as_list (in, \"section with repeat_names\");\n\tif (props.isNull())\n\t    return -1;\n    }\n    else\n    {\n\tprops->add (in);\n    }\n    int pi = 0, pe = props->size ();\n\n    // Go simultaneously through the found values\n    // and the list of parameters, while _either_ lasts\n    // Fewer values-> add them, more values-> delete them\n    while (pi != pe || xi != xe)\n    {\n\t// watch out for validity of iterators!\n\n\tif (pi == pe)\n\t{\n\t    // deleting a value\n\t    delValue1 (xi++);\n\t    // no ++pi\n\t}\n\telse\n\t{\n\t    YCPValue prop = props->value (pi);\n\t    IniIterator ei;\n\t    if (xi == xe)\n\t    {\n\t\t///need to add a value ...\n\t\ty2debug (\"Adding value %s = %s\",\n\t\t\t p->toString ().c_str (), prop->toString().c_str ());\n\t\tif (what)\n\t\t{\n\t\t    y2error (\"You must add value before changing comment/type. %s\",\n\t\t\t     p->toString ().c_str ());\n\t\t    return -1;\n\t\t}\n\t\t// prepare it to have its property set\n\t\t// create it\n\t\tIniEntry e;\n\t\t// need to set its name\n\t\te.setName (k);\n\n\t\t// insert and index\n\t\tcontainer.push_back (IniContainerElement (e));\n\t\tivalues.insert (IniEntryIndex::value_type (k, --container.end ()));\n\t\tei = --container.end ();\n\t    }\n\t    else\n\t    {\n\t\tei = xi->second;\n\t    }\n\n\t    // set a value's property\n\t    IniEntry & e = ei->e ();\n\t    switch (what)\n\t    {\n\t\tcase 0:\n\t\t    e.setValue (to_string (prop));\n\t\t    break;\n\t\tcase 1: {\n\t\t    YCPString s = as_string (prop, \"comment\");\n\t\t    if (s.isNull())\n\t\t\treturn -1;\n\t\t    e.setComment (s->value());\n\t\t    break;\n\t\t}\n\t\tdefault: {\n\t\t    YCPInteger i = as_integer (prop, \"value_type\");\n\t\t    if (i.isNull())\n\t\t\treturn -1;\n\t\t    e.setReadBy (i->value());\n\t\t    break;\n\t\t}\n\t    }\n\n\t    if (xi != xe)\n\t    {\n\t\t++xi;\n\t    }\n\t    ++pi;\n\t}\n\t// iterators have been advanced already\n    }\n    dirty = true;\n    return 0;\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::setMyValue (const YCPPath &p, const YCPValue&in, int what, int depth)\n  {\n      // assert (depth == p->length ()); //not, it can have a .comment suffix\n      string k = ip->changeCase (p->component_str (depth));\n      pair <IniEntryIdxIterator, IniEntryIdxIterator> r =\n  \tivalues.equal_range (k);\n      IniEntryIdxIterator xi = r.first, xe = r.second;\n  \n      // make sure we have a list of values\n      YCPList props;\n      if (ip->repeatNames ())\n      {\n  \tprops = as_list (in, \"section with repeat_names\");\n  \tif (props.isNull())\n  \t    return -1;\n      }\n      else\n      {\n  \tprops->add (in);\n      }\n      int pi = 0, pe = props->size ();\n  \n      // Go simultaneously through the found values\n      // and the list of parameters, while _either_ lasts\n      // Fewer values-> add them, more values-> delete them\n      while (pi != pe || xi != xe)\n      {\n  \t// watch out for validity of iterators!\n  \n  \tif (pi == pe)\n  \t{\n  \t    // deleting a value\n  \t    delValue1 (xi++);\n  \t    // no ++pi\n  \t}\n  \telse\n  \t{\n  \t    YCPValue prop = props->value (pi);\n  \t    IniIterator ei;\n  \t    if (xi == xe)\n  \t    {\n  \t\t///need to add a value ...\n  \t\ty2debug (\"Adding value %s = %s\",\n  \t\t\t p->toString ().c_str (), prop->toString().c_str ());\n  \t\tif (what)\n  \t\t{\n  \t\t    y2error (\"You must add value before changing comment/type. %s\",\n  \t\t\t     p->toString ().c_str ());\n  \t\t    return -1;\n  \t\t}\n  \t\t// prepare it to have its property set\n  \t\t// create it\n  \t\tIniEntry e;\n  \t\t// need to set its name\n  \t\te.setName (k);\n  \n  \t\t// insert and index\n  \t\tcontainer.push_back (IniContainerElement (e));\n  \t\tivalues.insert (IniEntryIndex::value_type (k, --container.end ()));\n  \t\tei = --container.end ();\n  \t    }\n  \t    else\n  \t    {\n  \t\tei = xi->second;\n  \t    }\n  \n  \t    // set a value's property\n  \t    IniEntry & e = ei->e ();\n  \t    switch (what)\n  \t    {\n  \t\tcase 0:\n  \t\t    e.setValue (to_string (prop));\n  \t\t    break;\n  \t\tcase 1: {\n  \t\t    YCPString s = as_string (prop, \"comment\");\n  \t\t    if (s.isNull())\n  \t\t\treturn -1;\n  \t\t    e.setComment (s->value());\n  \t\t    break;\n  \t\t}\n  \t\tdefault: {\n  \t\t    YCPInteger i = as_integer (prop, \"value_type\");\n  \t\t    if (i.isNull())\n  \t\t\treturn -1;\n  \t\t    e.setReadBy (i->value());\n  \t\t    break;\n  \t\t}\n  \t    }\n  \n  \t    if (xi != xe)\n  \t    {\n  \t\t++xi;\n  \t    }\n  \t    ++pi;\n  \t}\n  \t// iterators have been advanced already\n      }\n      dirty = true;\n      return 0;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "si->s",
          "args": [
            "p",
            "in",
            "what",
            "depth+1"
          ],
          "line": 917
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "si->s",
          "args": [],
          "line": 917
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container.end",
          "args": [],
          "line": 910
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "43-47",
          "snippet": "YCPMapIterator\nYCPMapRep::end() const\n{\n    return stl_map.end();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::end() const\n  {\n      return stl_map.end();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "isections.insert",
          "args": [
            "IniSectionIndex::value_type (k, --container.end ())"
          ],
          "line": 908
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IniSectionIndex::value_type",
          "args": [
            "k",
            "--container.end ()"
          ],
          "line": 908
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container.push_back",
          "args": [
            "IniContainerElement (s)"
          ],
          "line": 907
        },
        "resolved": true,
        "details": {
          "function_name": "push_back",
          "container": "YCPListRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPList.cc",
          "lines": "70-74",
          "snippet": "void\nYCPListRep::push_back(const YCPValue& value)\n{\n    elements.push_back(value);\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/YCPCodeCompare.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include <algorithm>",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"YCP.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/YCPCodeCompare.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include <algorithm>\n#include \"ycp/YCPList.h\"\n#include \"ycp/y2log.h\"\n#include \"YCP.h\"\n\nYCPListRep {\n  void\n  YCPListRep::push_back(const YCPValue& value)\n  {\n      elements.push_back(value);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IniContainerElement",
          "args": [
            "s"
          ],
          "line": 907
        },
        "resolved": true,
        "details": {
          "function_name": "IniContainerElement",
          "container": "IniContainerElement",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.h",
          "lines": "632-636",
          "snippet": "IniContainerElement (const IniContainerElement& c) :\n\t_t (c._t),\n\t_e (c._e),\n\t_s (c._s)\n\t{}",
          "includes": [
            "#include <YCP.h>",
            "#include <vector>",
            "#include <list>",
            "#include <map>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <YCP.h>\n#include <vector>\n#include <list>\n#include <map>\n#include <string>\n\nIniContainerElement {\n  IniContainerElement (const IniContainerElement& c) :\n  \t_t (c._t),\n  \t_e (c._e),\n  \t_s (c._s)\n  \t{}\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Write: adding recursively %s to %s\"",
            "k.c_str ()",
            "p->toString().c_str()"
          ],
          "line": 904
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p->toString",
          "args": [],
          "line": 904
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "YBreakpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YBreakpoint.cc",
          "lines": "87-91",
          "snippet": "string\nYBreakpoint::toString() const\n{\n    return m_code->toString ();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YBreakpoint.h\"",
            "#include <debugger/Debugger.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YBreakpoint.h\"\n#include <debugger/Debugger.h>\n#include <libintl.h>\n\nYBreakpoint {\n  string\n  YBreakpoint::toString() const\n  {\n      return m_code->toString ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "k.c_str",
          "args": [],
          "line": 904
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isections.equal_range",
          "args": [
            "k"
          ],
          "line": 897
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p->length",
          "args": [],
          "line": 893
        },
        "resolved": true,
        "details": {
          "function_name": "length",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "124-128",
          "snippet": "long\nYCPPathRep::length() const\n{\n    return components.size();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  long\n  YCPPathRep::length() const\n  {\n      return components.size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ip->changeCase",
          "args": [
            "p->component_str (depth)"
          ],
          "line": 887
        },
        "resolved": true,
        "details": {
          "function_name": "changeCase",
          "container": "IniParser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.cc",
          "lines": "1098-1120",
          "snippet": "string IniParser::changeCase (const string&str) const\n{\n    string tmp = str;\n    if (!ignore_case)\n      return tmp;\n    if (prefer_uppercase)\n    {\n\tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n\t    *it = toupper (*it);\n    }\n    else\n    {\n\tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n\t    *it = tolower (*it);\n\tif (first_upper)\n\t{\n\tstring::iterator it = tmp.begin ();\n\tif (it != tmp.end ())\n\t    *it = toupper (*it);\n\t}\t    \n    }\n    return tmp;\n}",
          "includes": [
            "#include \"IniFile.h\"",
            "#include \"IniParser.h\"",
            "#include <cassert>",
            "#include <glob.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <errno.h>",
            "#include <set>",
            "#include <vector>",
            "#include <ycp/y2log.h>",
            "#include <y2util/PathInfo.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include \"IniParser.h\"\n#include <cassert>\n#include <glob.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <errno.h>\n#include <set>\n#include <vector>\n#include <ycp/y2log.h>\n#include <y2util/PathInfo.h>\n#include \"config.h\"\n\nIniParser {\n  string IniParser::changeCase (const string&str) const\n  {\n      string tmp = str;\n      if (!ignore_case)\n        return tmp;\n      if (prefer_uppercase)\n      {\n  \tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n  \t    *it = toupper (*it);\n      }\n      else\n      {\n  \tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n  \t    *it = tolower (*it);\n  \tif (first_upper)\n  \t{\n  \tstring::iterator it = tmp.begin ();\n  \tif (it != tmp.end ())\n  \t    *it = toupper (*it);\n  \t}\t    \n      }\n      return tmp;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "p->component_str",
          "args": [
            "depth"
          ],
          "line": 887
        },
        "resolved": true,
        "details": {
          "function_name": "component_str",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "161-165",
          "snippet": "string\nYCPPathRep::component_str(long index) const\n{\n    return components[index].component.asString();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  string\n  YCPPathRep::component_str(long index) const\n  {\n      return components[index].component.asString();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::setValue (const YCPPath&p,const YCPValue&in,int what, int depth)\n  {\n      string k = ip->changeCase (p->component_str (depth));\n      // Find the matching sections.\n      // If we need to recurse, choose one, creating if necessary\n      // Otherwise set all the matching values\n      //  creating and deleting if the number of them does not match\n  \n      if (depth + 1 < p->length())\n      {\n  \t// recurse\n  \tpair <IniSectionIdxIterator, IniSectionIdxIterator> r =\n  \t    isections.equal_range (k);\n  \tIniSectionIdxIterator xi = r.first, xe = r.second;\n  \n  \tIniIterator si;\n  \tif (xi == xe)\n  \t{\n  \t    // not found, need to add it;\n  \t    y2debug (\"Write: adding recursively %s to %s\", k.c_str (), p->toString().c_str());\n  \n  \t    IniSection s (ip, k);\n  \t    container.push_back (IniContainerElement (s));\n  \t    isections.insert (IniSectionIndex::value_type (k, --container.end ()));\n  \n  \t    si = --container.end ();\n  \t}\n  \telse\n  \t{\n  \t    // there's something, choose last\n  \t    si = (--xe)->second;\n  \t}\n  \treturn si->s ().setValue (p, in, what, depth+1);\n      }\n      else\n      {\n  \t// bottom level\n  \treturn setMyValue (p, in, what, depth);\n      }\n  }\n}"
  },
  {
    "function_name": "setMyValue",
    "container": "IniSection",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "784-883",
    "snippet": "int IniSection::setMyValue (const YCPPath &p, const YCPValue&in, int what, int depth)\n{\n    // assert (depth == p->length ()); //not, it can have a .comment suffix\n    string k = ip->changeCase (p->component_str (depth));\n    pair <IniEntryIdxIterator, IniEntryIdxIterator> r =\n\tivalues.equal_range (k);\n    IniEntryIdxIterator xi = r.first, xe = r.second;\n\n    // make sure we have a list of values\n    YCPList props;\n    if (ip->repeatNames ())\n    {\n\tprops = as_list (in, \"section with repeat_names\");\n\tif (props.isNull())\n\t    return -1;\n    }\n    else\n    {\n\tprops->add (in);\n    }\n    int pi = 0, pe = props->size ();\n\n    // Go simultaneously through the found values\n    // and the list of parameters, while _either_ lasts\n    // Fewer values-> add them, more values-> delete them\n    while (pi != pe || xi != xe)\n    {\n\t// watch out for validity of iterators!\n\n\tif (pi == pe)\n\t{\n\t    // deleting a value\n\t    delValue1 (xi++);\n\t    // no ++pi\n\t}\n\telse\n\t{\n\t    YCPValue prop = props->value (pi);\n\t    IniIterator ei;\n\t    if (xi == xe)\n\t    {\n\t\t///need to add a value ...\n\t\ty2debug (\"Adding value %s = %s\",\n\t\t\t p->toString ().c_str (), prop->toString().c_str ());\n\t\tif (what)\n\t\t{\n\t\t    y2error (\"You must add value before changing comment/type. %s\",\n\t\t\t     p->toString ().c_str ());\n\t\t    return -1;\n\t\t}\n\t\t// prepare it to have its property set\n\t\t// create it\n\t\tIniEntry e;\n\t\t// need to set its name\n\t\te.setName (k);\n\n\t\t// insert and index\n\t\tcontainer.push_back (IniContainerElement (e));\n\t\tivalues.insert (IniEntryIndex::value_type (k, --container.end ()));\n\t\tei = --container.end ();\n\t    }\n\t    else\n\t    {\n\t\tei = xi->second;\n\t    }\n\n\t    // set a value's property\n\t    IniEntry & e = ei->e ();\n\t    switch (what)\n\t    {\n\t\tcase 0:\n\t\t    e.setValue (to_string (prop));\n\t\t    break;\n\t\tcase 1: {\n\t\t    YCPString s = as_string (prop, \"comment\");\n\t\t    if (s.isNull())\n\t\t\treturn -1;\n\t\t    e.setComment (s->value());\n\t\t    break;\n\t\t}\n\t\tdefault: {\n\t\t    YCPInteger i = as_integer (prop, \"value_type\");\n\t\t    if (i.isNull())\n\t\t\treturn -1;\n\t\t    e.setReadBy (i->value());\n\t\t    break;\n\t\t}\n\t    }\n\n\t    if (xi != xe)\n\t    {\n\t\t++xi;\n\t    }\n\t    ++pi;\n\t}\n\t// iterators have been advanced already\n    }\n    dirty = true;\n    return 0;\n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "e.setReadBy",
          "args": [
            "i->value()"
          ],
          "line": 868
        },
        "resolved": true,
        "details": {
          "function_name": "setReadBy",
          "container": "IniBase",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.h",
          "lines": "69-69",
          "snippet": "void setReadBy(int r)\t    { dirty = true; read_by = r; }",
          "includes": [
            "#include <YCP.h>",
            "#include <vector>",
            "#include <list>",
            "#include <map>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <YCP.h>\n#include <vector>\n#include <list>\n#include <map>\n#include <string>\n\nIniBase {\n  void setReadBy(int r)\t    { dirty = true; read_by = r; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "i->value",
          "args": [],
          "line": 868
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "YCPStringRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPString.cc",
          "lines": "44-48",
          "snippet": "string\nYCPStringRep::value() const\n{\n    return v;\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"y2string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/y2log.h\"\n#include \"y2string.h\"\n\nYCPStringRep {\n  string\n  YCPStringRep::value() const\n  {\n      return v;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "i.isNull",
          "args": [],
          "line": 866
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "as_integer",
          "args": [
            "prop",
            "\"value_type\""
          ],
          "line": 865
        },
        "resolved": true,
        "details": {
          "function_name": "as_integer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "68-76",
          "snippet": "static\nYCPInteger as_integer (const YCPValue& v, const char * context)\n{\n    if (v->isInteger ())\n\treturn v->asInteger ();\n    ycp2error (\"Expected an integer for %s, got %s %s\",\n\t       context, v->valuetype_str(), v->toString().c_str());\n    return YCPNull ();\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nstatic\nYCPInteger as_integer (const YCPValue& v, const char * context)\n{\n    if (v->isInteger ())\n\treturn v->asInteger ();\n    ycp2error (\"Expected an integer for %s, got %s %s\",\n\t       context, v->valuetype_str(), v->toString().c_str());\n    return YCPNull ();\n}"
        }
      },
      {
        "call_info": {
          "callee": "e.setComment",
          "args": [
            "s->value()"
          ],
          "line": 861
        },
        "resolved": true,
        "details": {
          "function_name": "setComment",
          "container": "IniBase",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.h",
          "lines": "67-67",
          "snippet": "void setComment(const string&c) { dirty = true; comment = c; }",
          "includes": [
            "#include <YCP.h>",
            "#include <vector>",
            "#include <list>",
            "#include <map>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <YCP.h>\n#include <vector>\n#include <list>\n#include <map>\n#include <string>\n\nIniBase {\n  void setComment(const string&c) { dirty = true; comment = c; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "s->value",
          "args": [],
          "line": 861
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "YConst",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCode.cc",
          "lines": "342-346",
          "snippet": "YCPValue\nYConst::value() const\n{\n    return m_value;\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YBreakpoint.h\"",
            "#include \"ycp/YBlock.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/YCode.h\"",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YBreakpoint.h\"\n#include \"ycp/YBlock.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/YCode.h\"\n#include <libintl.h>\n\nYConst {\n  YCPValue\n  YConst::value() const\n  {\n      return m_value;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "s.isNull",
          "args": [],
          "line": 859
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "as_string",
          "args": [
            "prop",
            "\"comment\""
          ],
          "line": 858
        },
        "resolved": true,
        "details": {
          "function_name": "as_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "55-63",
          "snippet": "static\nYCPString as_string (const YCPValue& v, const char * context)\n{\n    if (v->isString ())\n\treturn v->asString ();\n    ycp2error (\"Expected a string for %s, got %s %s\",\n\t       context, v->valuetype_str(), v->toString().c_str());\n    return YCPNull ();\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nstatic\nYCPString as_string (const YCPValue& v, const char * context)\n{\n    if (v->isString ())\n\treturn v->asString ();\n    ycp2error (\"Expected a string for %s, got %s %s\",\n\t       context, v->valuetype_str(), v->toString().c_str());\n    return YCPNull ();\n}"
        }
      },
      {
        "call_info": {
          "callee": "e.setValue",
          "args": [
            "to_string (prop)"
          ],
          "line": 855
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "IniEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.h",
          "lines": "155-155",
          "snippet": "void setValue(const string&c)   { dirty = true; val = c;     }",
          "includes": [
            "#include <YCP.h>",
            "#include <vector>",
            "#include <list>",
            "#include <map>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <YCP.h>\n#include <vector>\n#include <list>\n#include <map>\n#include <string>\n\nIniEntry {\n  void setValue(const string&c)   { dirty = true; val = c;     }\n}"
        }
      },
      {
        "call_info": {
          "callee": "to_string",
          "args": [
            "prop"
          ],
          "line": 855
        },
        "resolved": true,
        "details": {
          "function_name": "to_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "29-37",
          "snippet": "string to_string (const YCPValue&v)\n{\n    string s;\n    if (v->isString ())\n\ts = v->asString ()->value ();\n    else\n\ts = v->toString ();\n    return s;\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nstring to_string (const YCPValue&v)\n{\n    string s;\n    if (v->isString ())\n\ts = v->asString ()->value ();\n    else\n\ts = v->toString ();\n    return s;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ei->e",
          "args": [],
          "line": 851
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container.end",
          "args": [],
          "line": 843
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "43-47",
          "snippet": "YCPMapIterator\nYCPMapRep::end() const\n{\n    return stl_map.end();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::end() const\n  {\n      return stl_map.end();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ivalues.insert",
          "args": [
            "IniEntryIndex::value_type (k, --container.end ())"
          ],
          "line": 842
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IniEntryIndex::value_type",
          "args": [
            "k",
            "--container.end ()"
          ],
          "line": 842
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container.push_back",
          "args": [
            "IniContainerElement (e)"
          ],
          "line": 841
        },
        "resolved": true,
        "details": {
          "function_name": "push_back",
          "container": "YCPListRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPList.cc",
          "lines": "70-74",
          "snippet": "void\nYCPListRep::push_back(const YCPValue& value)\n{\n    elements.push_back(value);\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/YCPCodeCompare.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include <algorithm>",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"YCP.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/YCPCodeCompare.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include <algorithm>\n#include \"ycp/YCPList.h\"\n#include \"ycp/y2log.h\"\n#include \"YCP.h\"\n\nYCPListRep {\n  void\n  YCPListRep::push_back(const YCPValue& value)\n  {\n      elements.push_back(value);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IniContainerElement",
          "args": [
            "e"
          ],
          "line": 841
        },
        "resolved": true,
        "details": {
          "function_name": "IniContainerElement",
          "container": "IniContainerElement",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.h",
          "lines": "632-636",
          "snippet": "IniContainerElement (const IniContainerElement& c) :\n\t_t (c._t),\n\t_e (c._e),\n\t_s (c._s)\n\t{}",
          "includes": [
            "#include <YCP.h>",
            "#include <vector>",
            "#include <list>",
            "#include <map>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <YCP.h>\n#include <vector>\n#include <list>\n#include <map>\n#include <string>\n\nIniContainerElement {\n  IniContainerElement (const IniContainerElement& c) :\n  \t_t (c._t),\n  \t_e (c._e),\n  \t_s (c._s)\n  \t{}\n}"
        }
      },
      {
        "call_info": {
          "callee": "e.setName",
          "args": [
            "k"
          ],
          "line": 838
        },
        "resolved": true,
        "details": {
          "function_name": "setName",
          "container": "IniBase",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.h",
          "lines": "65-65",
          "snippet": "void setName(const string&c)    { dirty = true; name = c;    }",
          "includes": [
            "#include <YCP.h>",
            "#include <vector>",
            "#include <list>",
            "#include <map>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <YCP.h>\n#include <vector>\n#include <list>\n#include <map>\n#include <string>\n\nIniBase {\n  void setName(const string&c)    { dirty = true; name = c;    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2error",
          "args": [
            "\"You must add value before changing comment/type. %s\"",
            "p->toString ().c_str ()"
          ],
          "line": 830
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p->toString",
          "args": [],
          "line": 831
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "YBreakpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YBreakpoint.cc",
          "lines": "87-91",
          "snippet": "string\nYBreakpoint::toString() const\n{\n    return m_code->toString ();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YBreakpoint.h\"",
            "#include <debugger/Debugger.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YBreakpoint.h\"\n#include <debugger/Debugger.h>\n#include <libintl.h>\n\nYBreakpoint {\n  string\n  YBreakpoint::toString() const\n  {\n      return m_code->toString ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Adding value %s = %s\"",
            "p->toString ().c_str ()",
            "prop->toString().c_str ()"
          ],
          "line": 826
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "props->value",
          "args": [
            "pi"
          ],
          "line": 821
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "125-129",
          "snippet": "YCPValue\nYCPTermRep::value (int n) const\n{\n    return l->value(n);\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  YCPValue\n  YCPTermRep::value (int n) const\n  {\n      return l->value(n);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "delValue1",
          "args": [
            "xi++"
          ],
          "line": 816
        },
        "resolved": true,
        "details": {
          "function_name": "delValue1",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "926-932",
          "snippet": "void IniSection::delValue1 (IniEntryIdxIterator exi)\n{\n    dirty = true;\n    IniIterator ei = exi->second;\n    container.erase (ei);\n    ivalues.erase (exi);\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  void IniSection::delValue1 (IniEntryIdxIterator exi)\n  {\n      dirty = true;\n      IniIterator ei = exi->second;\n      container.erase (ei);\n      ivalues.erase (exi);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "props->size",
          "args": [],
          "line": 804
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "109-113",
          "snippet": "int\nYCPTermRep::size() const\n{\n    return l->size();\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  int\n  YCPTermRep::size() const\n  {\n      return l->size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "props->add",
          "args": [
            "in"
          ],
          "line": 802
        },
        "resolved": true,
        "details": {
          "function_name": "add",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "141-145",
          "snippet": "void\nYCPTermRep::add (const YCPValue& value)\n{\n    l->add(value);\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  void\n  YCPTermRep::add (const YCPValue& value)\n  {\n      l->add(value);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "props.isNull",
          "args": [],
          "line": 797
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "as_list",
          "args": [
            "in",
            "\"section with repeat_names\""
          ],
          "line": 796
        },
        "resolved": true,
        "details": {
          "function_name": "as_list",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "42-50",
          "snippet": "static\nYCPList as_list (const YCPValue& v, const char * context)\n{\n    if (v->isList ())\n\treturn v->asList ();\n    ycp2error (\"Expected a list for %s, got %s %s\",\n\t       context, v->valuetype_str(), v->toString().c_str());\n    return YCPNull ();\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nstatic\nYCPList as_list (const YCPValue& v, const char * context)\n{\n    if (v->isList ())\n\treturn v->asList ();\n    ycp2error (\"Expected a list for %s, got %s %s\",\n\t       context, v->valuetype_str(), v->toString().c_str());\n    return YCPNull ();\n}"
        }
      },
      {
        "call_info": {
          "callee": "ip->repeatNames",
          "args": [],
          "line": 794
        },
        "resolved": true,
        "details": {
          "function_name": "repeatNames",
          "container": "IniParser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.h",
          "lines": "458-458",
          "snippet": "bool repeatNames () const { return repeat_names; }",
          "includes": [
            "#include \"IniFile.h\"",
            "#include <set>",
            "#include <vector>",
            "#include <string>",
            "#include <fstream>",
            "#include <iosfwd>",
            "#include <YCP.h>",
            "#include <y2util/RepDef.h>",
            "#include <locale.h>",
            "#include <regex.h>",
            "#include <stdio.h>",
            "#include <ctype.h>",
            "#include <unistd.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include <set>\n#include <vector>\n#include <string>\n#include <fstream>\n#include <iosfwd>\n#include <YCP.h>\n#include <y2util/RepDef.h>\n#include <locale.h>\n#include <regex.h>\n#include <stdio.h>\n#include <ctype.h>\n#include <unistd.h>\n\nIniParser {\n  bool repeatNames () const { return repeat_names; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ivalues.equal_range",
          "args": [
            "k"
          ],
          "line": 789
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip->changeCase",
          "args": [
            "p->component_str (depth)"
          ],
          "line": 787
        },
        "resolved": true,
        "details": {
          "function_name": "changeCase",
          "container": "IniParser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.cc",
          "lines": "1098-1120",
          "snippet": "string IniParser::changeCase (const string&str) const\n{\n    string tmp = str;\n    if (!ignore_case)\n      return tmp;\n    if (prefer_uppercase)\n    {\n\tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n\t    *it = toupper (*it);\n    }\n    else\n    {\n\tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n\t    *it = tolower (*it);\n\tif (first_upper)\n\t{\n\tstring::iterator it = tmp.begin ();\n\tif (it != tmp.end ())\n\t    *it = toupper (*it);\n\t}\t    \n    }\n    return tmp;\n}",
          "includes": [
            "#include \"IniFile.h\"",
            "#include \"IniParser.h\"",
            "#include <cassert>",
            "#include <glob.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <errno.h>",
            "#include <set>",
            "#include <vector>",
            "#include <ycp/y2log.h>",
            "#include <y2util/PathInfo.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include \"IniParser.h\"\n#include <cassert>\n#include <glob.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <errno.h>\n#include <set>\n#include <vector>\n#include <ycp/y2log.h>\n#include <y2util/PathInfo.h>\n#include \"config.h\"\n\nIniParser {\n  string IniParser::changeCase (const string&str) const\n  {\n      string tmp = str;\n      if (!ignore_case)\n        return tmp;\n      if (prefer_uppercase)\n      {\n  \tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n  \t    *it = toupper (*it);\n      }\n      else\n      {\n  \tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n  \t    *it = tolower (*it);\n  \tif (first_upper)\n  \t{\n  \tstring::iterator it = tmp.begin ();\n  \tif (it != tmp.end ())\n  \t    *it = toupper (*it);\n  \t}\t    \n      }\n      return tmp;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "p->component_str",
          "args": [
            "depth"
          ],
          "line": 787
        },
        "resolved": true,
        "details": {
          "function_name": "component_str",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "161-165",
          "snippet": "string\nYCPPathRep::component_str(long index) const\n{\n    return components[index].component.asString();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  string\n  YCPPathRep::component_str(long index) const\n  {\n      return components[index].component.asString();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::setMyValue (const YCPPath &p, const YCPValue&in, int what, int depth)\n  {\n      // assert (depth == p->length ()); //not, it can have a .comment suffix\n      string k = ip->changeCase (p->component_str (depth));\n      pair <IniEntryIdxIterator, IniEntryIdxIterator> r =\n  \tivalues.equal_range (k);\n      IniEntryIdxIterator xi = r.first, xe = r.second;\n  \n      // make sure we have a list of values\n      YCPList props;\n      if (ip->repeatNames ())\n      {\n  \tprops = as_list (in, \"section with repeat_names\");\n  \tif (props.isNull())\n  \t    return -1;\n      }\n      else\n      {\n  \tprops->add (in);\n      }\n      int pi = 0, pe = props->size ();\n  \n      // Go simultaneously through the found values\n      // and the list of parameters, while _either_ lasts\n      // Fewer values-> add them, more values-> delete them\n      while (pi != pe || xi != xe)\n      {\n  \t// watch out for validity of iterators!\n  \n  \tif (pi == pe)\n  \t{\n  \t    // deleting a value\n  \t    delValue1 (xi++);\n  \t    // no ++pi\n  \t}\n  \telse\n  \t{\n  \t    YCPValue prop = props->value (pi);\n  \t    IniIterator ei;\n  \t    if (xi == xe)\n  \t    {\n  \t\t///need to add a value ...\n  \t\ty2debug (\"Adding value %s = %s\",\n  \t\t\t p->toString ().c_str (), prop->toString().c_str ());\n  \t\tif (what)\n  \t\t{\n  \t\t    y2error (\"You must add value before changing comment/type. %s\",\n  \t\t\t     p->toString ().c_str ());\n  \t\t    return -1;\n  \t\t}\n  \t\t// prepare it to have its property set\n  \t\t// create it\n  \t\tIniEntry e;\n  \t\t// need to set its name\n  \t\te.setName (k);\n  \n  \t\t// insert and index\n  \t\tcontainer.push_back (IniContainerElement (e));\n  \t\tivalues.insert (IniEntryIndex::value_type (k, --container.end ()));\n  \t\tei = --container.end ();\n  \t    }\n  \t    else\n  \t    {\n  \t\tei = xi->second;\n  \t    }\n  \n  \t    // set a value's property\n  \t    IniEntry & e = ei->e ();\n  \t    switch (what)\n  \t    {\n  \t\tcase 0:\n  \t\t    e.setValue (to_string (prop));\n  \t\t    break;\n  \t\tcase 1: {\n  \t\t    YCPString s = as_string (prop, \"comment\");\n  \t\t    if (s.isNull())\n  \t\t\treturn -1;\n  \t\t    e.setComment (s->value());\n  \t\t    break;\n  \t\t}\n  \t\tdefault: {\n  \t\t    YCPInteger i = as_integer (prop, \"value_type\");\n  \t\t    if (i.isNull())\n  \t\t\treturn -1;\n  \t\t    e.setReadBy (i->value());\n  \t\t    break;\n  \t\t}\n  \t    }\n  \n  \t    if (xi != xe)\n  \t    {\n  \t\t++xi;\n  \t    }\n  \t    ++pi;\n  \t}\n  \t// iterators have been advanced already\n      }\n      dirty = true;\n      return 0;\n  }\n}"
  },
  {
    "function_name": "setAllDoIt",
    "container": "IniSection",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "684-782",
    "snippet": "int IniSection::setAllDoIt (const YCPMap &in)\n{\n    int ret = IniBase::setAllDoIt (in);\n    if (ret != 0)\n    {\n\treturn ret;\n    }\n\n    string kind;\n    if (!getMapString (in, \"kind\", kind) || kind != \"section\")\n    {\n\ty2error (\"Kind should be 'section'\");\n\treturn -1;\n    }\n\n    if (!getMapInteger (in, \"file\", rewrite_by))\n    {\n\treturn -1;\n    }\n\n    YCPValue v = in->value (YCPString (\"value\"));\n    if (v.isNull () || !v->isList ())\n    {\n\ty2error (\"Missing in Write (.all): %s\", \"value\");\n\treturn -1;\n    }\n    YCPList l = v->asList ();\n\n    container.clear ();\t\t// bye, old data\n    int i, len = l->size ();\n    for (i = 0; i < len; ++i)\n    {\n\tYCPValue item = l->value (i);\n\tif (!item->isMap ())\n\t{\n\t    y2error (\"Item in Write (.all) not a map\");\n\t    ret = -1;\n\t    break;\n\t}\n\tYCPMap mitem = item->asMap ();\n\n\tif (!getMapString (mitem, \"kind\", kind))\n\t{\n\t    y2error (\"Item in Write (.all) of unspecified kind\");\n\t    ret = -1;\n\t    break;\n\t}\n\n\tif (kind == \"section\")\n\t{\n\t    // check whether we are deleting a file-section\n\t    YCPValue mv = mitem->value (YCPString (\"value\"));\n\t    if (mv->isVoid ())\n\t    {\n\t\tstring del_name;\n\t\tint del_rb;\t\t\n\t\tif (!getMapString (mitem, \"name\", del_name) ||\n\t\t    !getMapInteger (mitem, \"file\", del_rb))\n\t\t{\n\t\t    ret = -1;\n\t\t    break;\n\t\t}\n\t\tconst_cast<IniParser *>(ip)->deleted_sections.insert (\n\t\t    ip->getFileName (del_name, del_rb)\n\t\t    );\n\t    }\n\t    else\n\t    {\n\t\tIniSection s (ip);\n\t\tret = s.setAllDoIt (mitem);\n\t\tif (ret != 0)\n\t\t{\n\t\t    break;\n\t\t}\n\t\tcontainer.push_back (IniContainerElement (s));\n\t    }\n\t}\n\telse if (kind == \"value\")\n\t{\n\t    IniEntry e;\n// FIXME ret =\n\t    e.setAllDoIt (mitem);\n\t    if (ret != 0)\n\t    {\n\t\tbreak;\n\t    }\n\t    container.push_back (IniContainerElement (e));\n\t}\n\telse\n\t{\n\t    y2error (\"Item in Write (.all) of unrecognized kind %s\", kind.c_str ());\n\t    ret = -1;\n\t    break;\n\t}\n    }\n\n    reindex ();\n    return ret;\n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reindex",
          "args": [],
          "line": 780
        },
        "resolved": true,
        "details": {
          "function_name": "reindex",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "245-268",
          "snippet": "void IniSection::reindex ()\n{\n    IniIterator\n\tci = getContainerBegin (),\n\tce = getContainerEnd ();\n\n    ivalues.clear ();\n    isections.clear ();\n\n    for (;ci != ce; ++ci)\n    {\n\n\tif (ci->t () == VALUE)\n\t{\n\t    string k = ip->changeCase (ci->e ().getName ());\n\t    ivalues.insert (IniEntryIndex::value_type (k, ci));\n\t}\n\telse\n\t{\n\t    string k = ip->changeCase (ci->s ().getName ());\n\t    isections.insert (IniSectionIndex::value_type (k, ci));\n\t}\n    }    \n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  void IniSection::reindex ()\n  {\n      IniIterator\n  \tci = getContainerBegin (),\n  \tce = getContainerEnd ();\n  \n      ivalues.clear ();\n      isections.clear ();\n  \n      for (;ci != ce; ++ci)\n      {\n  \n  \tif (ci->t () == VALUE)\n  \t{\n  \t    string k = ip->changeCase (ci->e ().getName ());\n  \t    ivalues.insert (IniEntryIndex::value_type (k, ci));\n  \t}\n  \telse\n  \t{\n  \t    string k = ip->changeCase (ci->s ().getName ());\n  \t    isections.insert (IniSectionIndex::value_type (k, ci));\n  \t}\n      }    \n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2error",
          "args": [
            "\"Item in Write (.all) of unrecognized kind %s\"",
            "kind.c_str ()"
          ],
          "line": 774
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kind.c_str",
          "args": [],
          "line": 774
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container.push_back",
          "args": [
            "IniContainerElement (e)"
          ],
          "line": 770
        },
        "resolved": true,
        "details": {
          "function_name": "push_back",
          "container": "YCPListRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPList.cc",
          "lines": "70-74",
          "snippet": "void\nYCPListRep::push_back(const YCPValue& value)\n{\n    elements.push_back(value);\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/YCPCodeCompare.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include <algorithm>",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"YCP.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/YCPCodeCompare.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include <algorithm>\n#include \"ycp/YCPList.h\"\n#include \"ycp/y2log.h\"\n#include \"YCP.h\"\n\nYCPListRep {\n  void\n  YCPListRep::push_back(const YCPValue& value)\n  {\n      elements.push_back(value);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IniContainerElement",
          "args": [
            "e"
          ],
          "line": 770
        },
        "resolved": true,
        "details": {
          "function_name": "IniContainerElement",
          "container": "IniContainerElement",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.h",
          "lines": "632-636",
          "snippet": "IniContainerElement (const IniContainerElement& c) :\n\t_t (c._t),\n\t_e (c._e),\n\t_s (c._s)\n\t{}",
          "includes": [
            "#include <YCP.h>",
            "#include <vector>",
            "#include <list>",
            "#include <map>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <YCP.h>\n#include <vector>\n#include <list>\n#include <map>\n#include <string>\n\nIniContainerElement {\n  IniContainerElement (const IniContainerElement& c) :\n  \t_t (c._t),\n  \t_e (c._e),\n  \t_s (c._s)\n  \t{}\n}"
        }
      },
      {
        "call_info": {
          "callee": "e.setAllDoIt",
          "args": [
            "mitem"
          ],
          "line": 765
        },
        "resolved": true,
        "details": {
          "function_name": "setAllDoIt",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "684-782",
          "snippet": "int IniSection::setAllDoIt (const YCPMap &in)\n{\n    int ret = IniBase::setAllDoIt (in);\n    if (ret != 0)\n    {\n\treturn ret;\n    }\n\n    string kind;\n    if (!getMapString (in, \"kind\", kind) || kind != \"section\")\n    {\n\ty2error (\"Kind should be 'section'\");\n\treturn -1;\n    }\n\n    if (!getMapInteger (in, \"file\", rewrite_by))\n    {\n\treturn -1;\n    }\n\n    YCPValue v = in->value (YCPString (\"value\"));\n    if (v.isNull () || !v->isList ())\n    {\n\ty2error (\"Missing in Write (.all): %s\", \"value\");\n\treturn -1;\n    }\n    YCPList l = v->asList ();\n\n    container.clear ();\t\t// bye, old data\n    int i, len = l->size ();\n    for (i = 0; i < len; ++i)\n    {\n\tYCPValue item = l->value (i);\n\tif (!item->isMap ())\n\t{\n\t    y2error (\"Item in Write (.all) not a map\");\n\t    ret = -1;\n\t    break;\n\t}\n\tYCPMap mitem = item->asMap ();\n\n\tif (!getMapString (mitem, \"kind\", kind))\n\t{\n\t    y2error (\"Item in Write (.all) of unspecified kind\");\n\t    ret = -1;\n\t    break;\n\t}\n\n\tif (kind == \"section\")\n\t{\n\t    // check whether we are deleting a file-section\n\t    YCPValue mv = mitem->value (YCPString (\"value\"));\n\t    if (mv->isVoid ())\n\t    {\n\t\tstring del_name;\n\t\tint del_rb;\t\t\n\t\tif (!getMapString (mitem, \"name\", del_name) ||\n\t\t    !getMapInteger (mitem, \"file\", del_rb))\n\t\t{\n\t\t    ret = -1;\n\t\t    break;\n\t\t}\n\t\tconst_cast<IniParser *>(ip)->deleted_sections.insert (\n\t\t    ip->getFileName (del_name, del_rb)\n\t\t    );\n\t    }\n\t    else\n\t    {\n\t\tIniSection s (ip);\n\t\tret = s.setAllDoIt (mitem);\n\t\tif (ret != 0)\n\t\t{\n\t\t    break;\n\t\t}\n\t\tcontainer.push_back (IniContainerElement (s));\n\t    }\n\t}\n\telse if (kind == \"value\")\n\t{\n\t    IniEntry e;\n// FIXME ret =\n\t    e.setAllDoIt (mitem);\n\t    if (ret != 0)\n\t    {\n\t\tbreak;\n\t    }\n\t    container.push_back (IniContainerElement (e));\n\t}\n\telse\n\t{\n\t    y2error (\"Item in Write (.all) of unrecognized kind %s\", kind.c_str ());\n\t    ret = -1;\n\t    break;\n\t}\n    }\n\n    reindex ();\n    return ret;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "const_cast<IniParser *>",
          "args": [
            "ip->getFileName (del_name, del_rb)"
          ],
          "line": 746
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip->getFileName",
          "args": [
            "del_name",
            "del_rb"
          ],
          "line": 747
        },
        "resolved": true,
        "details": {
          "function_name": "getFileName",
          "container": "IniParser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.cc",
          "lines": "1078-1091",
          "snippet": "string IniParser::getFileName (const string&sec, int rb) const\n{\n    string file = sec;\n    if (-1 != rb && (int) rewrites.size () > rb)\n    {\n\tint max = rewrites[rb].out.length () + sec.length () + 1;\n\tchar*buf = new char[max + 1];\n\tsnprintf (buf, max, rewrites[rb].out.c_str (), sec.c_str());\n\ty2debug (\"Rewriting %s to %s\", sec.c_str(), buf);\n\tfile = buf;\n\tdelete [] buf;\n    }\n    return file;\n}",
          "includes": [
            "#include \"IniFile.h\"",
            "#include \"IniParser.h\"",
            "#include <cassert>",
            "#include <glob.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <errno.h>",
            "#include <set>",
            "#include <vector>",
            "#include <ycp/y2log.h>",
            "#include <y2util/PathInfo.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include \"IniParser.h\"\n#include <cassert>\n#include <glob.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <errno.h>\n#include <set>\n#include <vector>\n#include <ycp/y2log.h>\n#include <y2util/PathInfo.h>\n#include \"config.h\"\n\nIniParser {\n  string IniParser::getFileName (const string&sec, int rb) const\n  {\n      string file = sec;\n      if (-1 != rb && (int) rewrites.size () > rb)\n      {\n  \tint max = rewrites[rb].out.length () + sec.length () + 1;\n  \tchar*buf = new char[max + 1];\n  \tsnprintf (buf, max, rewrites[rb].out.c_str (), sec.c_str());\n  \ty2debug (\"Rewriting %s to %s\", sec.c_str(), buf);\n  \tfile = buf;\n  \tdelete [] buf;\n      }\n      return file;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "const_cast<IniParser *>",
          "args": [
            "ip"
          ],
          "line": 746
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getMapInteger",
          "args": [
            "mitem",
            "\"file\"",
            "del_rb"
          ],
          "line": 741
        },
        "resolved": true,
        "details": {
          "function_name": "getMapInteger",
          "container": "IniBase",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.h",
          "lines": "117-126",
          "snippet": "bool getMapInteger (const YCPMap &in, const string &k, int &i) {\n\tYCPValue v = in->value (YCPString (k));\n\tif (v.isNull () || !v->isInteger ())\n\t{\n\t    y2error (\"Missing in Write (.all): %s\", k.c_str ());\n\t    return false;\n\t}\n\ti = v->asInteger ()->value ();\n\treturn true;\n    }",
          "includes": [
            "#include <YCP.h>",
            "#include <vector>",
            "#include <list>",
            "#include <map>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <YCP.h>\n#include <vector>\n#include <list>\n#include <map>\n#include <string>\n\nIniBase {\n  bool getMapInteger (const YCPMap &in, const string &k, int &i) {\n  \tYCPValue v = in->value (YCPString (k));\n  \tif (v.isNull () || !v->isInteger ())\n  \t{\n  \t    y2error (\"Missing in Write (.all): %s\", k.c_str ());\n  \t    return false;\n  \t}\n  \ti = v->asInteger ()->value ();\n  \treturn true;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getMapString",
          "args": [
            "mitem",
            "\"name\"",
            "del_name"
          ],
          "line": 740
        },
        "resolved": true,
        "details": {
          "function_name": "getMapString",
          "container": "IniBase",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.h",
          "lines": "105-114",
          "snippet": "bool getMapString (const YCPMap &in, const string &k, string &s) {\n\tYCPValue v = in->value (YCPString (k));\n\tif (v.isNull () || !v->isString ())\n\t{\n\t    y2error (\"Missing in Write (.all): %s\", k.c_str ());\n\t    return false;\n\t}\n\ts = v->asString ()->value ();\n\treturn true;\n    }",
          "includes": [
            "#include <YCP.h>",
            "#include <vector>",
            "#include <list>",
            "#include <map>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <YCP.h>\n#include <vector>\n#include <list>\n#include <map>\n#include <string>\n\nIniBase {\n  bool getMapString (const YCPMap &in, const string &k, string &s) {\n  \tYCPValue v = in->value (YCPString (k));\n  \tif (v.isNull () || !v->isString ())\n  \t{\n  \t    y2error (\"Missing in Write (.all): %s\", k.c_str ());\n  \t    return false;\n  \t}\n  \ts = v->asString ()->value ();\n  \treturn true;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mv->isVoid",
          "args": [],
          "line": 736
        },
        "resolved": true,
        "details": {
          "function_name": "isVoid",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "60-61",
          "snippet": "bool YCPValueRep::isVoid()        const { return valuetype() == YT_VOID \n\t\t\t\t\t\t|| valuetype() == YT_RETURN; }",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  bool YCPValueRep::isVoid()        const { return valuetype() == YT_VOID \n  \t\t\t\t\t\t|| valuetype() == YT_RETURN; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mitem->value",
          "args": [
            "YCPString (\"value\")"
          ],
          "line": 735
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "125-129",
          "snippet": "YCPValue\nYCPTermRep::value (int n) const\n{\n    return l->value(n);\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  YCPValue\n  YCPTermRep::value (int n) const\n  {\n      return l->value(n);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPString",
          "args": [
            "\"value\""
          ],
          "line": 735
        },
        "resolved": true,
        "details": {
          "function_name": "isYCPStringPair",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.cc",
          "lines": "92-102",
          "snippet": "bool isYCPStringPair (const YCPValue &v)\n{\n    if (!v->isList ())\n\treturn false;\n    YCPList l = v->asList ();\n    if (l->size () != 2)\n\treturn false;\n    return\n\tl->value (0)->isString () &&\n\tl->value (1)->isString ();\n}",
          "includes": [
            "#include \"IniFile.h\"",
            "#include \"IniParser.h\"",
            "#include <cassert>",
            "#include <glob.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <errno.h>",
            "#include <set>",
            "#include <vector>",
            "#include <ycp/y2log.h>",
            "#include <y2util/PathInfo.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include \"IniParser.h\"\n#include <cassert>\n#include <glob.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <errno.h>\n#include <set>\n#include <vector>\n#include <ycp/y2log.h>\n#include <y2util/PathInfo.h>\n#include \"config.h\"\n\nbool isYCPStringPair (const YCPValue &v)\n{\n    if (!v->isList ())\n\treturn false;\n    YCPList l = v->asList ();\n    if (l->size () != 2)\n\treturn false;\n    return\n\tl->value (0)->isString () &&\n\tl->value (1)->isString ();\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2error",
          "args": [
            "\"Item in Write (.all) of unspecified kind\""
          ],
          "line": 727
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "item->asMap",
          "args": [],
          "line": 723
        },
        "resolved": true,
        "details": {
          "function_name": "asMap",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "203-213",
          "snippet": "YCPMap\nYCPValueRep::asMap() const\n{\n    if (!isMap())\n    {\n\tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not Map!\",\n\t      toString().c_str());\n\tabort();\n    }\n    return YCPMap (static_cast<const YCPMapRep *>(this));\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  YCPMap\n  YCPValueRep::asMap() const\n  {\n      if (!isMap())\n      {\n  \tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not Map!\",\n  \t      toString().c_str());\n  \tabort();\n      }\n      return YCPMap (static_cast<const YCPMapRep *>(this));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2error",
          "args": [
            "\"Item in Write (.all) not a map\""
          ],
          "line": 719
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "item->isMap",
          "args": [],
          "line": 717
        },
        "resolved": true,
        "details": {
          "function_name": "isMap",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "71-71",
          "snippet": "bool YCPValueRep::isMap()         const { return valuetype() == YT_MAP; }",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  bool YCPValueRep::isMap()         const { return valuetype() == YT_MAP; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "l->size",
          "args": [],
          "line": 713
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "YCPByteblockRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPByteblock.cc",
          "lines": "59-63",
          "snippet": "long\nYCPByteblockRep::size() const\n{\n    return len;\n}",
          "includes": [
            "#include \"Xmlcode.h\"",
            "#include \"Bytecode.h\"",
            "#include \"YCPByteblock.h\"",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"Xmlcode.h\"\n#include \"Bytecode.h\"\n#include \"YCPByteblock.h\"\n#include <ycp/y2log.h>\n\nYCPByteblockRep {\n  long\n  YCPByteblockRep::size() const\n  {\n      return len;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "container.clear",
          "args": [],
          "line": 712
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/PathInfo.h",
          "lines": "461-461",
          "snippet": "void clear() { _devino.clear(); }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <map>",
            "#include <set>",
            "#include <list>",
            "#include <iosfwd>",
            "#include <cerrno>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <map>\n#include <set>\n#include <list>\n#include <iosfwd>\n#include <cerrno>\n#include <dirent.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nvoid clear() { _devino.clear(); }"
        }
      },
      {
        "call_info": {
          "callee": "v->asList",
          "args": [],
          "line": 710
        },
        "resolved": true,
        "details": {
          "function_name": "asList",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "179-189",
          "snippet": "YCPList\nYCPValueRep::asList() const\n{\n    if (!isList())\n    {\n\tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not List!\",\n\t      toString().c_str());\n\tabort();\n    }\n    return YCPList (static_cast<const YCPListRep *>(this));\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  YCPList\n  YCPValueRep::asList() const\n  {\n      if (!isList())\n      {\n  \tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not List!\",\n  \t      toString().c_str());\n  \tabort();\n      }\n      return YCPList (static_cast<const YCPListRep *>(this));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2error",
          "args": [
            "\"Missing in Write (.all): %s\"",
            "\"value\""
          ],
          "line": 707
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v->isList",
          "args": [],
          "line": 705
        },
        "resolved": true,
        "details": {
          "function_name": "isList",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "69-69",
          "snippet": "bool YCPValueRep::isList()        const { return valuetype() == YT_LIST; }",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  bool YCPValueRep::isList()        const { return valuetype() == YT_LIST; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "v.isNull",
          "args": [],
          "line": 705
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2error",
          "args": [
            "\"Kind should be 'section'\""
          ],
          "line": 695
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::setAllDoIt (const YCPMap &in)\n  {\n      int ret = IniBase::setAllDoIt (in);\n      if (ret != 0)\n      {\n  \treturn ret;\n      }\n  \n      string kind;\n      if (!getMapString (in, \"kind\", kind) || kind != \"section\")\n      {\n  \ty2error (\"Kind should be 'section'\");\n  \treturn -1;\n      }\n  \n      if (!getMapInteger (in, \"file\", rewrite_by))\n      {\n  \treturn -1;\n      }\n  \n      YCPValue v = in->value (YCPString (\"value\"));\n      if (v.isNull () || !v->isList ())\n      {\n  \ty2error (\"Missing in Write (.all): %s\", \"value\");\n  \treturn -1;\n      }\n      YCPList l = v->asList ();\n  \n      container.clear ();\t\t// bye, old data\n      int i, len = l->size ();\n      for (i = 0; i < len; ++i)\n      {\n  \tYCPValue item = l->value (i);\n  \tif (!item->isMap ())\n  \t{\n  \t    y2error (\"Item in Write (.all) not a map\");\n  \t    ret = -1;\n  \t    break;\n  \t}\n  \tYCPMap mitem = item->asMap ();\n  \n  \tif (!getMapString (mitem, \"kind\", kind))\n  \t{\n  \t    y2error (\"Item in Write (.all) of unspecified kind\");\n  \t    ret = -1;\n  \t    break;\n  \t}\n  \n  \tif (kind == \"section\")\n  \t{\n  \t    // check whether we are deleting a file-section\n  \t    YCPValue mv = mitem->value (YCPString (\"value\"));\n  \t    if (mv->isVoid ())\n  \t    {\n  \t\tstring del_name;\n  \t\tint del_rb;\t\t\n  \t\tif (!getMapString (mitem, \"name\", del_name) ||\n  \t\t    !getMapInteger (mitem, \"file\", del_rb))\n  \t\t{\n  \t\t    ret = -1;\n  \t\t    break;\n  \t\t}\n  \t\tconst_cast<IniParser *>(ip)->deleted_sections.insert (\n  \t\t    ip->getFileName (del_name, del_rb)\n  \t\t    );\n  \t    }\n  \t    else\n  \t    {\n  \t\tIniSection s (ip);\n  \t\tret = s.setAllDoIt (mitem);\n  \t\tif (ret != 0)\n  \t\t{\n  \t\t    break;\n  \t\t}\n  \t\tcontainer.push_back (IniContainerElement (s));\n  \t    }\n  \t}\n  \telse if (kind == \"value\")\n  \t{\n  \t    IniEntry e;\n  // FIXME ret =\n  \t    e.setAllDoIt (mitem);\n  \t    if (ret != 0)\n  \t    {\n  \t\tbreak;\n  \t    }\n  \t    container.push_back (IniContainerElement (e));\n  \t}\n  \telse\n  \t{\n  \t    y2error (\"Item in Write (.all) of unrecognized kind %s\", kind.c_str ());\n  \t    ret = -1;\n  \t    break;\n  \t}\n      }\n  \n      reindex ();\n      return ret;\n  }\n}"
  },
  {
    "function_name": "setAll",
    "container": "IniSection",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "661-682",
    "snippet": "int IniSection::setAll (const YCPPath&p, const YCPValue& in, int depth)\n{\n    if (depth < p->length ())\n    {\n\t// recurse to find the starting section\n\t// Get any section of that name\n\tstring k = ip->changeCase (p->component_str (depth));\n\tIniSectionIdxIterator sxi = isections.find (k);\n\tif (sxi != isections.end())\n\t{\n\t    return sxi->second->s ().setAll (p, in, depth+1);\n\t}\n\t// else error\n    }\n    else\n    {\n\treturn setAllDoIt (in->asMap ());\n    }\n\n    y2debug (\"Write: Invalid path %s [%d]\", p->toString().c_str(), depth);\n    return -1;\n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Write: Invalid path %s [%d]\"",
            "p->toString().c_str()",
            "depth"
          ],
          "line": 680
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p->toString",
          "args": [],
          "line": 680
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "YBreakpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YBreakpoint.cc",
          "lines": "87-91",
          "snippet": "string\nYBreakpoint::toString() const\n{\n    return m_code->toString ();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YBreakpoint.h\"",
            "#include <debugger/Debugger.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YBreakpoint.h\"\n#include <debugger/Debugger.h>\n#include <libintl.h>\n\nYBreakpoint {\n  string\n  YBreakpoint::toString() const\n  {\n      return m_code->toString ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "setAllDoIt",
          "args": [
            "in->asMap ()"
          ],
          "line": 677
        },
        "resolved": true,
        "details": {
          "function_name": "setAllDoIt",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "684-782",
          "snippet": "int IniSection::setAllDoIt (const YCPMap &in)\n{\n    int ret = IniBase::setAllDoIt (in);\n    if (ret != 0)\n    {\n\treturn ret;\n    }\n\n    string kind;\n    if (!getMapString (in, \"kind\", kind) || kind != \"section\")\n    {\n\ty2error (\"Kind should be 'section'\");\n\treturn -1;\n    }\n\n    if (!getMapInteger (in, \"file\", rewrite_by))\n    {\n\treturn -1;\n    }\n\n    YCPValue v = in->value (YCPString (\"value\"));\n    if (v.isNull () || !v->isList ())\n    {\n\ty2error (\"Missing in Write (.all): %s\", \"value\");\n\treturn -1;\n    }\n    YCPList l = v->asList ();\n\n    container.clear ();\t\t// bye, old data\n    int i, len = l->size ();\n    for (i = 0; i < len; ++i)\n    {\n\tYCPValue item = l->value (i);\n\tif (!item->isMap ())\n\t{\n\t    y2error (\"Item in Write (.all) not a map\");\n\t    ret = -1;\n\t    break;\n\t}\n\tYCPMap mitem = item->asMap ();\n\n\tif (!getMapString (mitem, \"kind\", kind))\n\t{\n\t    y2error (\"Item in Write (.all) of unspecified kind\");\n\t    ret = -1;\n\t    break;\n\t}\n\n\tif (kind == \"section\")\n\t{\n\t    // check whether we are deleting a file-section\n\t    YCPValue mv = mitem->value (YCPString (\"value\"));\n\t    if (mv->isVoid ())\n\t    {\n\t\tstring del_name;\n\t\tint del_rb;\t\t\n\t\tif (!getMapString (mitem, \"name\", del_name) ||\n\t\t    !getMapInteger (mitem, \"file\", del_rb))\n\t\t{\n\t\t    ret = -1;\n\t\t    break;\n\t\t}\n\t\tconst_cast<IniParser *>(ip)->deleted_sections.insert (\n\t\t    ip->getFileName (del_name, del_rb)\n\t\t    );\n\t    }\n\t    else\n\t    {\n\t\tIniSection s (ip);\n\t\tret = s.setAllDoIt (mitem);\n\t\tif (ret != 0)\n\t\t{\n\t\t    break;\n\t\t}\n\t\tcontainer.push_back (IniContainerElement (s));\n\t    }\n\t}\n\telse if (kind == \"value\")\n\t{\n\t    IniEntry e;\n// FIXME ret =\n\t    e.setAllDoIt (mitem);\n\t    if (ret != 0)\n\t    {\n\t\tbreak;\n\t    }\n\t    container.push_back (IniContainerElement (e));\n\t}\n\telse\n\t{\n\t    y2error (\"Item in Write (.all) of unrecognized kind %s\", kind.c_str ());\n\t    ret = -1;\n\t    break;\n\t}\n    }\n\n    reindex ();\n    return ret;\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::setAllDoIt (const YCPMap &in)\n  {\n      int ret = IniBase::setAllDoIt (in);\n      if (ret != 0)\n      {\n  \treturn ret;\n      }\n  \n      string kind;\n      if (!getMapString (in, \"kind\", kind) || kind != \"section\")\n      {\n  \ty2error (\"Kind should be 'section'\");\n  \treturn -1;\n      }\n  \n      if (!getMapInteger (in, \"file\", rewrite_by))\n      {\n  \treturn -1;\n      }\n  \n      YCPValue v = in->value (YCPString (\"value\"));\n      if (v.isNull () || !v->isList ())\n      {\n  \ty2error (\"Missing in Write (.all): %s\", \"value\");\n  \treturn -1;\n      }\n      YCPList l = v->asList ();\n  \n      container.clear ();\t\t// bye, old data\n      int i, len = l->size ();\n      for (i = 0; i < len; ++i)\n      {\n  \tYCPValue item = l->value (i);\n  \tif (!item->isMap ())\n  \t{\n  \t    y2error (\"Item in Write (.all) not a map\");\n  \t    ret = -1;\n  \t    break;\n  \t}\n  \tYCPMap mitem = item->asMap ();\n  \n  \tif (!getMapString (mitem, \"kind\", kind))\n  \t{\n  \t    y2error (\"Item in Write (.all) of unspecified kind\");\n  \t    ret = -1;\n  \t    break;\n  \t}\n  \n  \tif (kind == \"section\")\n  \t{\n  \t    // check whether we are deleting a file-section\n  \t    YCPValue mv = mitem->value (YCPString (\"value\"));\n  \t    if (mv->isVoid ())\n  \t    {\n  \t\tstring del_name;\n  \t\tint del_rb;\t\t\n  \t\tif (!getMapString (mitem, \"name\", del_name) ||\n  \t\t    !getMapInteger (mitem, \"file\", del_rb))\n  \t\t{\n  \t\t    ret = -1;\n  \t\t    break;\n  \t\t}\n  \t\tconst_cast<IniParser *>(ip)->deleted_sections.insert (\n  \t\t    ip->getFileName (del_name, del_rb)\n  \t\t    );\n  \t    }\n  \t    else\n  \t    {\n  \t\tIniSection s (ip);\n  \t\tret = s.setAllDoIt (mitem);\n  \t\tif (ret != 0)\n  \t\t{\n  \t\t    break;\n  \t\t}\n  \t\tcontainer.push_back (IniContainerElement (s));\n  \t    }\n  \t}\n  \telse if (kind == \"value\")\n  \t{\n  \t    IniEntry e;\n  // FIXME ret =\n  \t    e.setAllDoIt (mitem);\n  \t    if (ret != 0)\n  \t    {\n  \t\tbreak;\n  \t    }\n  \t    container.push_back (IniContainerElement (e));\n  \t}\n  \telse\n  \t{\n  \t    y2error (\"Item in Write (.all) of unrecognized kind %s\", kind.c_str ());\n  \t    ret = -1;\n  \t    break;\n  \t}\n      }\n  \n      reindex ();\n      return ret;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "in->asMap",
          "args": [],
          "line": 677
        },
        "resolved": true,
        "details": {
          "function_name": "asMap",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "203-213",
          "snippet": "YCPMap\nYCPValueRep::asMap() const\n{\n    if (!isMap())\n    {\n\tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not Map!\",\n\t      toString().c_str());\n\tabort();\n    }\n    return YCPMap (static_cast<const YCPMapRep *>(this));\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  YCPMap\n  YCPValueRep::asMap() const\n  {\n      if (!isMap())\n      {\n  \tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not Map!\",\n  \t      toString().c_str());\n  \tabort();\n      }\n      return YCPMap (static_cast<const YCPMapRep *>(this));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "sxi->second->s",
          "args": [
            "p",
            "in",
            "depth+1"
          ],
          "line": 671
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sxi->second->s",
          "args": [],
          "line": 671
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isections.end",
          "args": [],
          "line": 669
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "43-47",
          "snippet": "YCPMapIterator\nYCPMapRep::end() const\n{\n    return stl_map.end();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::end() const\n  {\n      return stl_map.end();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "isections.find",
          "args": [
            "k"
          ],
          "line": 668
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip->changeCase",
          "args": [
            "p->component_str (depth)"
          ],
          "line": 667
        },
        "resolved": true,
        "details": {
          "function_name": "changeCase",
          "container": "IniParser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.cc",
          "lines": "1098-1120",
          "snippet": "string IniParser::changeCase (const string&str) const\n{\n    string tmp = str;\n    if (!ignore_case)\n      return tmp;\n    if (prefer_uppercase)\n    {\n\tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n\t    *it = toupper (*it);\n    }\n    else\n    {\n\tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n\t    *it = tolower (*it);\n\tif (first_upper)\n\t{\n\tstring::iterator it = tmp.begin ();\n\tif (it != tmp.end ())\n\t    *it = toupper (*it);\n\t}\t    \n    }\n    return tmp;\n}",
          "includes": [
            "#include \"IniFile.h\"",
            "#include \"IniParser.h\"",
            "#include <cassert>",
            "#include <glob.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <errno.h>",
            "#include <set>",
            "#include <vector>",
            "#include <ycp/y2log.h>",
            "#include <y2util/PathInfo.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include \"IniParser.h\"\n#include <cassert>\n#include <glob.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <errno.h>\n#include <set>\n#include <vector>\n#include <ycp/y2log.h>\n#include <y2util/PathInfo.h>\n#include \"config.h\"\n\nIniParser {\n  string IniParser::changeCase (const string&str) const\n  {\n      string tmp = str;\n      if (!ignore_case)\n        return tmp;\n      if (prefer_uppercase)\n      {\n  \tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n  \t    *it = toupper (*it);\n      }\n      else\n      {\n  \tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n  \t    *it = tolower (*it);\n  \tif (first_upper)\n  \t{\n  \tstring::iterator it = tmp.begin ();\n  \tif (it != tmp.end ())\n  \t    *it = toupper (*it);\n  \t}\t    \n      }\n      return tmp;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "p->component_str",
          "args": [
            "depth"
          ],
          "line": 667
        },
        "resolved": true,
        "details": {
          "function_name": "component_str",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "161-165",
          "snippet": "string\nYCPPathRep::component_str(long index) const\n{\n    return components[index].component.asString();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  string\n  YCPPathRep::component_str(long index) const\n  {\n      return components[index].component.asString();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "p->length",
          "args": [],
          "line": 663
        },
        "resolved": true,
        "details": {
          "function_name": "length",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "124-128",
          "snippet": "long\nYCPPathRep::length() const\n{\n    return components.size();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  long\n  YCPPathRep::length() const\n  {\n      return components.size();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::setAll (const YCPPath&p, const YCPValue& in, int depth)\n  {\n      if (depth < p->length ())\n      {\n  \t// recurse to find the starting section\n  \t// Get any section of that name\n  \tstring k = ip->changeCase (p->component_str (depth));\n  \tIniSectionIdxIterator sxi = isections.find (k);\n  \tif (sxi != isections.end())\n  \t{\n  \t    return sxi->second->s ().setAll (p, in, depth+1);\n  \t}\n  \t// else error\n      }\n      else\n      {\n  \treturn setAllDoIt (in->asMap ());\n      }\n  \n      y2debug (\"Write: Invalid path %s [%d]\", p->toString().c_str(), depth);\n      return -1;\n  }\n}"
  },
  {
    "function_name": "delSection",
    "container": "IniSection",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "621-659",
    "snippet": "int IniSection::delSection(const YCPPath&p, int depth)\n{\n    string k = ip->changeCase (p->component_str (depth));\n\n    // Find the matching sections.\n    // If we need to recurse, choose one\n    // Otherwise kill them all\n\n    pair <IniSectionIdxIterator, IniSectionIdxIterator> r =\n\tisections.equal_range (k);\n    IniSectionIdxIterator xi = r.first, xe = r.second;\n\n    if (depth + 1 < p->length())\n    {\n\t// recurse\n\tif (xi != xe)\n\t{\n\t    // there's something\n\t    IniSection& s = (--xe)->second->s ();\n\t    return s.delSection (p, depth+1);\n\t}\n\t//error\n\ty2error (\"Delete: Invalid path %s [%d]\", p->toString().c_str(), depth);\n\treturn -1;\n    }\n    else\n    {\n\t// bottom level, massacre begins\n\tif (xi == xe)\n\t{\n\t    y2debug (\"Can not delete %s. Key does not exist.\", p->toString().c_str());\n\t}\n\twhile (xi != xe)\n\t{\n\t    delSection1 (xi++);\n\t}\n    }\n    return 0;\n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "delSection1",
          "args": [
            "xi++"
          ],
          "line": 655
        },
        "resolved": true,
        "details": {
          "function_name": "delSection1",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "613-619",
          "snippet": "void IniSection::delSection1 (IniSectionIdxIterator sxi)\n{\n    dirty = true;\n    IniIterator si = sxi->second;\n    container.erase (si);\n    isections.erase (sxi);\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  void IniSection::delSection1 (IniSectionIdxIterator sxi)\n  {\n      dirty = true;\n      IniIterator si = sxi->second;\n      container.erase (si);\n      isections.erase (sxi);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Can not delete %s. Key does not exist.\"",
            "p->toString().c_str()"
          ],
          "line": 651
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p->toString",
          "args": [],
          "line": 651
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "YBreakpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YBreakpoint.cc",
          "lines": "87-91",
          "snippet": "string\nYBreakpoint::toString() const\n{\n    return m_code->toString ();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YBreakpoint.h\"",
            "#include <debugger/Debugger.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YBreakpoint.h\"\n#include <debugger/Debugger.h>\n#include <libintl.h>\n\nYBreakpoint {\n  string\n  YBreakpoint::toString() const\n  {\n      return m_code->toString ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2error",
          "args": [
            "\"Delete: Invalid path %s [%d]\"",
            "p->toString().c_str()",
            "depth"
          ],
          "line": 643
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s.delSection",
          "args": [
            "p",
            "depth+1"
          ],
          "line": 640
        },
        "resolved": true,
        "details": {
          "function_name": "delSection",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "621-659",
          "snippet": "int IniSection::delSection(const YCPPath&p, int depth)\n{\n    string k = ip->changeCase (p->component_str (depth));\n\n    // Find the matching sections.\n    // If we need to recurse, choose one\n    // Otherwise kill them all\n\n    pair <IniSectionIdxIterator, IniSectionIdxIterator> r =\n\tisections.equal_range (k);\n    IniSectionIdxIterator xi = r.first, xe = r.second;\n\n    if (depth + 1 < p->length())\n    {\n\t// recurse\n\tif (xi != xe)\n\t{\n\t    // there's something\n\t    IniSection& s = (--xe)->second->s ();\n\t    return s.delSection (p, depth+1);\n\t}\n\t//error\n\ty2error (\"Delete: Invalid path %s [%d]\", p->toString().c_str(), depth);\n\treturn -1;\n    }\n    else\n    {\n\t// bottom level, massacre begins\n\tif (xi == xe)\n\t{\n\t    y2debug (\"Can not delete %s. Key does not exist.\", p->toString().c_str());\n\t}\n\twhile (xi != xe)\n\t{\n\t    delSection1 (xi++);\n\t}\n    }\n    return 0;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 639
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p->length",
          "args": [],
          "line": 633
        },
        "resolved": true,
        "details": {
          "function_name": "length",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "124-128",
          "snippet": "long\nYCPPathRep::length() const\n{\n    return components.size();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  long\n  YCPPathRep::length() const\n  {\n      return components.size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "isections.equal_range",
          "args": [
            "k"
          ],
          "line": 630
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip->changeCase",
          "args": [
            "p->component_str (depth)"
          ],
          "line": 623
        },
        "resolved": true,
        "details": {
          "function_name": "changeCase",
          "container": "IniParser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.cc",
          "lines": "1098-1120",
          "snippet": "string IniParser::changeCase (const string&str) const\n{\n    string tmp = str;\n    if (!ignore_case)\n      return tmp;\n    if (prefer_uppercase)\n    {\n\tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n\t    *it = toupper (*it);\n    }\n    else\n    {\n\tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n\t    *it = tolower (*it);\n\tif (first_upper)\n\t{\n\tstring::iterator it = tmp.begin ();\n\tif (it != tmp.end ())\n\t    *it = toupper (*it);\n\t}\t    \n    }\n    return tmp;\n}",
          "includes": [
            "#include \"IniFile.h\"",
            "#include \"IniParser.h\"",
            "#include <cassert>",
            "#include <glob.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <errno.h>",
            "#include <set>",
            "#include <vector>",
            "#include <ycp/y2log.h>",
            "#include <y2util/PathInfo.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include \"IniParser.h\"\n#include <cassert>\n#include <glob.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <errno.h>\n#include <set>\n#include <vector>\n#include <ycp/y2log.h>\n#include <y2util/PathInfo.h>\n#include \"config.h\"\n\nIniParser {\n  string IniParser::changeCase (const string&str) const\n  {\n      string tmp = str;\n      if (!ignore_case)\n        return tmp;\n      if (prefer_uppercase)\n      {\n  \tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n  \t    *it = toupper (*it);\n      }\n      else\n      {\n  \tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n  \t    *it = tolower (*it);\n  \tif (first_upper)\n  \t{\n  \tstring::iterator it = tmp.begin ();\n  \tif (it != tmp.end ())\n  \t    *it = toupper (*it);\n  \t}\t    \n      }\n      return tmp;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "p->component_str",
          "args": [
            "depth"
          ],
          "line": 623
        },
        "resolved": true,
        "details": {
          "function_name": "component_str",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "161-165",
          "snippet": "string\nYCPPathRep::component_str(long index) const\n{\n    return components[index].component.asString();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  string\n  YCPPathRep::component_str(long index) const\n  {\n      return components[index].component.asString();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::delSection(const YCPPath&p, int depth)\n  {\n      string k = ip->changeCase (p->component_str (depth));\n  \n      // Find the matching sections.\n      // If we need to recurse, choose one\n      // Otherwise kill them all\n  \n      pair <IniSectionIdxIterator, IniSectionIdxIterator> r =\n  \tisections.equal_range (k);\n      IniSectionIdxIterator xi = r.first, xe = r.second;\n  \n      if (depth + 1 < p->length())\n      {\n  \t// recurse\n  \tif (xi != xe)\n  \t{\n  \t    // there's something\n  \t    IniSection& s = (--xe)->second->s ();\n  \t    return s.delSection (p, depth+1);\n  \t}\n  \t//error\n  \ty2error (\"Delete: Invalid path %s [%d]\", p->toString().c_str(), depth);\n  \treturn -1;\n      }\n      else\n      {\n  \t// bottom level, massacre begins\n  \tif (xi == xe)\n  \t{\n  \t    y2debug (\"Can not delete %s. Key does not exist.\", p->toString().c_str());\n  \t}\n  \twhile (xi != xe)\n  \t{\n  \t    delSection1 (xi++);\n  \t}\n      }\n      return 0;\n  }\n}"
  },
  {
    "function_name": "delSection1",
    "container": "IniSection",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "613-619",
    "snippet": "void IniSection::delSection1 (IniSectionIdxIterator sxi)\n{\n    dirty = true;\n    IniIterator si = sxi->second;\n    container.erase (si);\n    isections.erase (sxi);\n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "isections.erase",
          "args": [
            "sxi"
          ],
          "line": 618
        },
        "resolved": true,
        "details": {
          "function_name": "erase",
          "container": "PathInfo",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
          "lines": "683-695",
          "snippet": "int PathInfo::erase( const Pathname & path )\n{\n  int res = 0;\n  PathInfo p( path, LSTAT );\n  if ( p.isExist() )\n    {\n      if ( p.isDir() )\n        res = PathInfo::recursive_rmdir( path );\n      else\n        res = PathInfo::unlink( path );\n    }\n  return res;\n}",
          "includes": [
            "#include <y2util/PathInfo.h>",
            "#include <y2util/ExternalProgram.h>",
            "#include <y2util/stringutil.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <iomanip>",
            "#include <fstream>",
            "#include <iostream>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  int PathInfo::erase( const Pathname & path )\n  {\n    int res = 0;\n    PathInfo p( path, LSTAT );\n    if ( p.isExist() )\n      {\n        if ( p.isDir() )\n          res = PathInfo::recursive_rmdir( path );\n        else\n          res = PathInfo::unlink( path );\n      }\n    return res;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  void IniSection::delSection1 (IniSectionIdxIterator sxi)\n  {\n      dirty = true;\n      IniIterator si = sxi->second;\n      container.erase (si);\n      isections.erase (sxi);\n  }\n}"
  },
  {
    "function_name": "setSectionProp",
    "container": "IniSection",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "492-611",
    "snippet": "int IniSection::setSectionProp (const YCPPath&p,const YCPValue&in, int what, int depth)\n{\n    string k = ip->changeCase (p->component_str (depth));\n    // Find the matching sections.\n    // If we need to recurse, choose one, creating if necessary\n    // Otherwise set properties of all of the leaf sections,\n    //  creating and deleting if the number of them does not match\n\n    pair <IniSectionIdxIterator, IniSectionIdxIterator> r =\n\tisections.equal_range (k);\n    IniSectionIdxIterator xi = r.first, xe = r.second;\n\n    if (depth + 1 < p->length())\n    {\n\t// recurse\n\tIniIterator si;\n\tif (xi == xe)\n\t{\n\t    // not found, need to add it;\n\t    y2debug (\"Write: adding recursively %s to %s\", k.c_str (), p->toString().c_str());\n\n\t    IniSection s (ip, k);\n\t    container.push_back (IniContainerElement (s));\n\t    isections.insert (IniSectionIndex::value_type (k, --container.end ()));\n\n\t    si = --container.end ();\n\t}\n\telse\n\t{\n\t    // there's something, choose last\n\t    si = (--xe)->second;\n\t}\n\treturn si->s ().setSectionProp (p, in, what, depth+1);\n    }\n    else\n    {\n\t// bottom level\n\n\t// make sure we have a list of values\n\tYCPList props;\n\tif (ip->repeatNames ())\n\t{\n\t    props = as_list (in, \"property of section with repeat_names\");\n\t    if (props.isNull())\n\t\treturn -1;\n\t}\n\telse\n\t{\n\t    props->add (in);\n\t}\n\tint pi = 0, pe = props->size ();\n\n\t// Go simultaneously through the found sections\n\t// and the list of parameters, while _either_ lasts\n\t// Fewer sections-> add them, more sections-> delete them\n\n\twhile (pi != pe || xi != xe)\n\t{\n\t    // watch out for validity of iterators!\n\n\t    if (pi == pe)\n\t    {\n\t\t// deleting a section\n\t\tdelSection1 (xi++);\n\t\t// no ++pi\n\t    }\n\t    else\n\t    {\n\t\tYCPValue prop = props->value (pi);\n\t\tIniIterator si;\n\t\tif (xi == xe)\n\t\t{\n\t\t    ///need to add a section ...\n\t\t    y2debug (\"Adding section %s\", p->toString().c_str());\n\t\t    // prepare it to have its property set\n\t\t    // create it\n\t\t    IniSection s (ip, k);\n\t\t    s.dirty = true;\n\t\t    // insert and index\n\t\t    container.push_back (IniContainerElement (s));\n\t\t    isections.insert (IniSectionIndex::value_type (k, --container.end ()));\n\t\t    si = --container.end ();\n\t\t}\n\t\telse\n\t\t{\n\t\t    si = xi->second;\n\t\t}\n\n\t\t// set a section's property\n\t\tIniSection & s = si->s ();\n\t\tif (what == 0) {\n\t\t    YCPString str = as_string (prop, \"section_comment\");\n\t\t    if (str.isNull())\n\t\t\treturn -1;\n\t\t    s.setComment (str->value_cstr());\n\t\t}\n\t\telse if (what == 1) {\n\t\t    YCPInteger i = as_integer (prop, \"section_rewrite\");\n\t\t    if (i.isNull())\n\t\t\treturn -1;\n\t\t    s.setRewriteBy (i->value());\n\t\t}\n\t\telse {\n\t\t    YCPInteger i = as_integer (prop, \"section_type\");\n\t\t    if (i.isNull())\n\t\t\treturn -1;\n\t\t    s.setReadBy (i->value());\n\t\t}\n\n\t\tif (xi != xe)\n\t\t{\n\t\t    ++xi;\n\t\t}\n\t\t++pi;\n\t    }\n\t    // iterators have been advanced already\n\t}\n\treturn 0;\n    }\n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "s.setReadBy",
          "args": [
            "i->value()"
          ],
          "line": 598
        },
        "resolved": true,
        "details": {
          "function_name": "setReadBy",
          "container": "IniBase",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.h",
          "lines": "69-69",
          "snippet": "void setReadBy(int r)\t    { dirty = true; read_by = r; }",
          "includes": [
            "#include <YCP.h>",
            "#include <vector>",
            "#include <list>",
            "#include <map>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <YCP.h>\n#include <vector>\n#include <list>\n#include <map>\n#include <string>\n\nIniBase {\n  void setReadBy(int r)\t    { dirty = true; read_by = r; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "i->value",
          "args": [],
          "line": 598
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "YCPStringRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPString.cc",
          "lines": "44-48",
          "snippet": "string\nYCPStringRep::value() const\n{\n    return v;\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"y2string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/y2log.h\"\n#include \"y2string.h\"\n\nYCPStringRep {\n  string\n  YCPStringRep::value() const\n  {\n      return v;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "i.isNull",
          "args": [],
          "line": 596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "as_integer",
          "args": [
            "prop",
            "\"section_type\""
          ],
          "line": 595
        },
        "resolved": true,
        "details": {
          "function_name": "as_integer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "68-76",
          "snippet": "static\nYCPInteger as_integer (const YCPValue& v, const char * context)\n{\n    if (v->isInteger ())\n\treturn v->asInteger ();\n    ycp2error (\"Expected an integer for %s, got %s %s\",\n\t       context, v->valuetype_str(), v->toString().c_str());\n    return YCPNull ();\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nstatic\nYCPInteger as_integer (const YCPValue& v, const char * context)\n{\n    if (v->isInteger ())\n\treturn v->asInteger ();\n    ycp2error (\"Expected an integer for %s, got %s %s\",\n\t       context, v->valuetype_str(), v->toString().c_str());\n    return YCPNull ();\n}"
        }
      },
      {
        "call_info": {
          "callee": "s.setRewriteBy",
          "args": [
            "i->value()"
          ],
          "line": 592
        },
        "resolved": true,
        "details": {
          "function_name": "setRewriteBy",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.h",
          "lines": "506-506",
          "snippet": "void setRewriteBy (int c) \t     \t{ dirty = true; rewrite_by = c; }",
          "includes": [
            "#include <YCP.h>",
            "#include <vector>",
            "#include <list>",
            "#include <map>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <YCP.h>\n#include <vector>\n#include <list>\n#include <map>\n#include <string>\n\nIniSection {\n  void setRewriteBy (int c) \t     \t{ dirty = true; rewrite_by = c; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "i.isNull",
          "args": [],
          "line": 590
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s.setComment",
          "args": [
            "str->value_cstr()"
          ],
          "line": 586
        },
        "resolved": true,
        "details": {
          "function_name": "setComment",
          "container": "IniBase",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.h",
          "lines": "67-67",
          "snippet": "void setComment(const string&c) { dirty = true; comment = c; }",
          "includes": [
            "#include <YCP.h>",
            "#include <vector>",
            "#include <list>",
            "#include <map>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <YCP.h>\n#include <vector>\n#include <list>\n#include <map>\n#include <string>\n\nIniBase {\n  void setComment(const string&c) { dirty = true; comment = c; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "str->value_cstr",
          "args": [],
          "line": 586
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str.isNull",
          "args": [],
          "line": 584
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "as_string",
          "args": [
            "prop",
            "\"section_comment\""
          ],
          "line": 583
        },
        "resolved": true,
        "details": {
          "function_name": "as_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "55-63",
          "snippet": "static\nYCPString as_string (const YCPValue& v, const char * context)\n{\n    if (v->isString ())\n\treturn v->asString ();\n    ycp2error (\"Expected a string for %s, got %s %s\",\n\t       context, v->valuetype_str(), v->toString().c_str());\n    return YCPNull ();\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nstatic\nYCPString as_string (const YCPValue& v, const char * context)\n{\n    if (v->isString ())\n\treturn v->asString ();\n    ycp2error (\"Expected a string for %s, got %s %s\",\n\t       context, v->valuetype_str(), v->toString().c_str());\n    return YCPNull ();\n}"
        }
      },
      {
        "call_info": {
          "callee": "si->s",
          "args": [],
          "line": 581
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container.end",
          "args": [],
          "line": 573
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "43-47",
          "snippet": "YCPMapIterator\nYCPMapRep::end() const\n{\n    return stl_map.end();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::end() const\n  {\n      return stl_map.end();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "isections.insert",
          "args": [
            "IniSectionIndex::value_type (k, --container.end ())"
          ],
          "line": 572
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IniSectionIndex::value_type",
          "args": [
            "k",
            "--container.end ()"
          ],
          "line": 572
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container.push_back",
          "args": [
            "IniContainerElement (s)"
          ],
          "line": 571
        },
        "resolved": true,
        "details": {
          "function_name": "push_back",
          "container": "YCPListRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPList.cc",
          "lines": "70-74",
          "snippet": "void\nYCPListRep::push_back(const YCPValue& value)\n{\n    elements.push_back(value);\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/YCPCodeCompare.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include <algorithm>",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"YCP.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/YCPCodeCompare.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include <algorithm>\n#include \"ycp/YCPList.h\"\n#include \"ycp/y2log.h\"\n#include \"YCP.h\"\n\nYCPListRep {\n  void\n  YCPListRep::push_back(const YCPValue& value)\n  {\n      elements.push_back(value);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IniContainerElement",
          "args": [
            "s"
          ],
          "line": 571
        },
        "resolved": true,
        "details": {
          "function_name": "IniContainerElement",
          "container": "IniContainerElement",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.h",
          "lines": "632-636",
          "snippet": "IniContainerElement (const IniContainerElement& c) :\n\t_t (c._t),\n\t_e (c._e),\n\t_s (c._s)\n\t{}",
          "includes": [
            "#include <YCP.h>",
            "#include <vector>",
            "#include <list>",
            "#include <map>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <YCP.h>\n#include <vector>\n#include <list>\n#include <map>\n#include <string>\n\nIniContainerElement {\n  IniContainerElement (const IniContainerElement& c) :\n  \t_t (c._t),\n  \t_e (c._e),\n  \t_s (c._s)\n  \t{}\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Adding section %s\"",
            "p->toString().c_str()"
          ],
          "line": 565
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p->toString",
          "args": [],
          "line": 565
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "YBreakpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YBreakpoint.cc",
          "lines": "87-91",
          "snippet": "string\nYBreakpoint::toString() const\n{\n    return m_code->toString ();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YBreakpoint.h\"",
            "#include <debugger/Debugger.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YBreakpoint.h\"\n#include <debugger/Debugger.h>\n#include <libintl.h>\n\nYBreakpoint {\n  string\n  YBreakpoint::toString() const\n  {\n      return m_code->toString ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "props->value",
          "args": [
            "pi"
          ],
          "line": 560
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "125-129",
          "snippet": "YCPValue\nYCPTermRep::value (int n) const\n{\n    return l->value(n);\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  YCPValue\n  YCPTermRep::value (int n) const\n  {\n      return l->value(n);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "delSection1",
          "args": [
            "xi++"
          ],
          "line": 555
        },
        "resolved": true,
        "details": {
          "function_name": "delSection1",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "613-619",
          "snippet": "void IniSection::delSection1 (IniSectionIdxIterator sxi)\n{\n    dirty = true;\n    IniIterator si = sxi->second;\n    container.erase (si);\n    isections.erase (sxi);\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  void IniSection::delSection1 (IniSectionIdxIterator sxi)\n  {\n      dirty = true;\n      IniIterator si = sxi->second;\n      container.erase (si);\n      isections.erase (sxi);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "props->size",
          "args": [],
          "line": 542
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "109-113",
          "snippet": "int\nYCPTermRep::size() const\n{\n    return l->size();\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  int\n  YCPTermRep::size() const\n  {\n      return l->size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "props->add",
          "args": [
            "in"
          ],
          "line": 540
        },
        "resolved": true,
        "details": {
          "function_name": "add",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "141-145",
          "snippet": "void\nYCPTermRep::add (const YCPValue& value)\n{\n    l->add(value);\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  void\n  YCPTermRep::add (const YCPValue& value)\n  {\n      l->add(value);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "props.isNull",
          "args": [],
          "line": 535
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "as_list",
          "args": [
            "in",
            "\"property of section with repeat_names\""
          ],
          "line": 534
        },
        "resolved": true,
        "details": {
          "function_name": "as_list",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "42-50",
          "snippet": "static\nYCPList as_list (const YCPValue& v, const char * context)\n{\n    if (v->isList ())\n\treturn v->asList ();\n    ycp2error (\"Expected a list for %s, got %s %s\",\n\t       context, v->valuetype_str(), v->toString().c_str());\n    return YCPNull ();\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nstatic\nYCPList as_list (const YCPValue& v, const char * context)\n{\n    if (v->isList ())\n\treturn v->asList ();\n    ycp2error (\"Expected a list for %s, got %s %s\",\n\t       context, v->valuetype_str(), v->toString().c_str());\n    return YCPNull ();\n}"
        }
      },
      {
        "call_info": {
          "callee": "ip->repeatNames",
          "args": [],
          "line": 532
        },
        "resolved": true,
        "details": {
          "function_name": "repeatNames",
          "container": "IniParser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.h",
          "lines": "458-458",
          "snippet": "bool repeatNames () const { return repeat_names; }",
          "includes": [
            "#include \"IniFile.h\"",
            "#include <set>",
            "#include <vector>",
            "#include <string>",
            "#include <fstream>",
            "#include <iosfwd>",
            "#include <YCP.h>",
            "#include <y2util/RepDef.h>",
            "#include <locale.h>",
            "#include <regex.h>",
            "#include <stdio.h>",
            "#include <ctype.h>",
            "#include <unistd.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include <set>\n#include <vector>\n#include <string>\n#include <fstream>\n#include <iosfwd>\n#include <YCP.h>\n#include <y2util/RepDef.h>\n#include <locale.h>\n#include <regex.h>\n#include <stdio.h>\n#include <ctype.h>\n#include <unistd.h>\n\nIniParser {\n  bool repeatNames () const { return repeat_names; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "si->s",
          "args": [
            "p",
            "in",
            "what",
            "depth+1"
          ],
          "line": 524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "si->s",
          "args": [],
          "line": 524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isections.insert",
          "args": [
            "IniSectionIndex::value_type (k, --container.end ())"
          ],
          "line": 515
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IniSectionIndex::value_type",
          "args": [
            "k",
            "--container.end ()"
          ],
          "line": 515
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Write: adding recursively %s to %s\"",
            "k.c_str ()",
            "p->toString().c_str()"
          ],
          "line": 511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "k.c_str",
          "args": [],
          "line": 511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p->length",
          "args": [],
          "line": 504
        },
        "resolved": true,
        "details": {
          "function_name": "length",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "124-128",
          "snippet": "long\nYCPPathRep::length() const\n{\n    return components.size();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  long\n  YCPPathRep::length() const\n  {\n      return components.size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "isections.equal_range",
          "args": [
            "k"
          ],
          "line": 501
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip->changeCase",
          "args": [
            "p->component_str (depth)"
          ],
          "line": 494
        },
        "resolved": true,
        "details": {
          "function_name": "changeCase",
          "container": "IniParser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.cc",
          "lines": "1098-1120",
          "snippet": "string IniParser::changeCase (const string&str) const\n{\n    string tmp = str;\n    if (!ignore_case)\n      return tmp;\n    if (prefer_uppercase)\n    {\n\tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n\t    *it = toupper (*it);\n    }\n    else\n    {\n\tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n\t    *it = tolower (*it);\n\tif (first_upper)\n\t{\n\tstring::iterator it = tmp.begin ();\n\tif (it != tmp.end ())\n\t    *it = toupper (*it);\n\t}\t    \n    }\n    return tmp;\n}",
          "includes": [
            "#include \"IniFile.h\"",
            "#include \"IniParser.h\"",
            "#include <cassert>",
            "#include <glob.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <errno.h>",
            "#include <set>",
            "#include <vector>",
            "#include <ycp/y2log.h>",
            "#include <y2util/PathInfo.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include \"IniParser.h\"\n#include <cassert>\n#include <glob.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <errno.h>\n#include <set>\n#include <vector>\n#include <ycp/y2log.h>\n#include <y2util/PathInfo.h>\n#include \"config.h\"\n\nIniParser {\n  string IniParser::changeCase (const string&str) const\n  {\n      string tmp = str;\n      if (!ignore_case)\n        return tmp;\n      if (prefer_uppercase)\n      {\n  \tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n  \t    *it = toupper (*it);\n      }\n      else\n      {\n  \tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n  \t    *it = tolower (*it);\n  \tif (first_upper)\n  \t{\n  \tstring::iterator it = tmp.begin ();\n  \tif (it != tmp.end ())\n  \t    *it = toupper (*it);\n  \t}\t    \n      }\n      return tmp;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "p->component_str",
          "args": [
            "depth"
          ],
          "line": 494
        },
        "resolved": true,
        "details": {
          "function_name": "component_str",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "161-165",
          "snippet": "string\nYCPPathRep::component_str(long index) const\n{\n    return components[index].component.asString();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  string\n  YCPPathRep::component_str(long index) const\n  {\n      return components[index].component.asString();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::setSectionProp (const YCPPath&p,const YCPValue&in, int what, int depth)\n  {\n      string k = ip->changeCase (p->component_str (depth));\n      // Find the matching sections.\n      // If we need to recurse, choose one, creating if necessary\n      // Otherwise set properties of all of the leaf sections,\n      //  creating and deleting if the number of them does not match\n  \n      pair <IniSectionIdxIterator, IniSectionIdxIterator> r =\n  \tisections.equal_range (k);\n      IniSectionIdxIterator xi = r.first, xe = r.second;\n  \n      if (depth + 1 < p->length())\n      {\n  \t// recurse\n  \tIniIterator si;\n  \tif (xi == xe)\n  \t{\n  \t    // not found, need to add it;\n  \t    y2debug (\"Write: adding recursively %s to %s\", k.c_str (), p->toString().c_str());\n  \n  \t    IniSection s (ip, k);\n  \t    container.push_back (IniContainerElement (s));\n  \t    isections.insert (IniSectionIndex::value_type (k, --container.end ()));\n  \n  \t    si = --container.end ();\n  \t}\n  \telse\n  \t{\n  \t    // there's something, choose last\n  \t    si = (--xe)->second;\n  \t}\n  \treturn si->s ().setSectionProp (p, in, what, depth+1);\n      }\n      else\n      {\n  \t// bottom level\n  \n  \t// make sure we have a list of values\n  \tYCPList props;\n  \tif (ip->repeatNames ())\n  \t{\n  \t    props = as_list (in, \"property of section with repeat_names\");\n  \t    if (props.isNull())\n  \t\treturn -1;\n  \t}\n  \telse\n  \t{\n  \t    props->add (in);\n  \t}\n  \tint pi = 0, pe = props->size ();\n  \n  \t// Go simultaneously through the found sections\n  \t// and the list of parameters, while _either_ lasts\n  \t// Fewer sections-> add them, more sections-> delete them\n  \n  \twhile (pi != pe || xi != xe)\n  \t{\n  \t    // watch out for validity of iterators!\n  \n  \t    if (pi == pe)\n  \t    {\n  \t\t// deleting a section\n  \t\tdelSection1 (xi++);\n  \t\t// no ++pi\n  \t    }\n  \t    else\n  \t    {\n  \t\tYCPValue prop = props->value (pi);\n  \t\tIniIterator si;\n  \t\tif (xi == xe)\n  \t\t{\n  \t\t    ///need to add a section ...\n  \t\t    y2debug (\"Adding section %s\", p->toString().c_str());\n  \t\t    // prepare it to have its property set\n  \t\t    // create it\n  \t\t    IniSection s (ip, k);\n  \t\t    s.dirty = true;\n  \t\t    // insert and index\n  \t\t    container.push_back (IniContainerElement (s));\n  \t\t    isections.insert (IniSectionIndex::value_type (k, --container.end ()));\n  \t\t    si = --container.end ();\n  \t\t}\n  \t\telse\n  \t\t{\n  \t\t    si = xi->second;\n  \t\t}\n  \n  \t\t// set a section's property\n  \t\tIniSection & s = si->s ();\n  \t\tif (what == 0) {\n  \t\t    YCPString str = as_string (prop, \"section_comment\");\n  \t\t    if (str.isNull())\n  \t\t\treturn -1;\n  \t\t    s.setComment (str->value_cstr());\n  \t\t}\n  \t\telse if (what == 1) {\n  \t\t    YCPInteger i = as_integer (prop, \"section_rewrite\");\n  \t\t    if (i.isNull())\n  \t\t\treturn -1;\n  \t\t    s.setRewriteBy (i->value());\n  \t\t}\n  \t\telse {\n  \t\t    YCPInteger i = as_integer (prop, \"section_type\");\n  \t\t    if (i.isNull())\n  \t\t\treturn -1;\n  \t\t    s.setReadBy (i->value());\n  \t\t}\n  \n  \t\tif (xi != xe)\n  \t\t{\n  \t\t    ++xi;\n  \t\t}\n  \t\t++pi;\n  \t    }\n  \t    // iterators have been advanced already\n  \t}\n  \treturn 0;\n      }\n  }\n}"
  },
  {
    "function_name": "Write",
    "container": "IniSection",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "463-490",
    "snippet": "int IniSection::Write (const YCPPath&p, const YCPValue&v, bool rewrite)\n{\n    if (ip->isFlat ())\n\treturn setValueFlat (p, v);\n\n    if (p->length() >= 1 && p->component_str (0) == \"all\")\n    {\n\treturn setAll (p, v, 1);\n    }\n\n    if (p->length() < 2)\n    {\n\ty2error (\"I do not know what to write to %s.\", p->toString().c_str());\n\treturn -1;\n    }\n    string s = p->component_str (0);\n    if (s == \"v\" || s == \"value\")\n\treturn setValue (p, v, 0, 1);\n    if (s == \"vc\" || s == \"value_comment\" || s == \"valuecomment\")\n      return setValue (p, v, 1, 1);\n    if (s == \"vt\" || s == \"value_type\" || s == \"valuetype\")\n      return setValue (p, v, 2, 1);\n    if (s == \"s\" || s == \"section\" || s == \"sc\" || s == \"section_comment\" || s == \"sectioncomment\")\n      return setSectionProp (p, v, 0, 1);\n    if (s == \"st\" || s == \"section_type\" || s == \"sectiontype\")\n      return setSectionProp (p, v, rewrite? 1:2, 1);\n    return -1;\n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setSectionProp",
          "args": [
            "p",
            "v",
            "rewrite? 1:2",
            "1"
          ],
          "line": 488
        },
        "resolved": true,
        "details": {
          "function_name": "setSectionProp",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "492-611",
          "snippet": "int IniSection::setSectionProp (const YCPPath&p,const YCPValue&in, int what, int depth)\n{\n    string k = ip->changeCase (p->component_str (depth));\n    // Find the matching sections.\n    // If we need to recurse, choose one, creating if necessary\n    // Otherwise set properties of all of the leaf sections,\n    //  creating and deleting if the number of them does not match\n\n    pair <IniSectionIdxIterator, IniSectionIdxIterator> r =\n\tisections.equal_range (k);\n    IniSectionIdxIterator xi = r.first, xe = r.second;\n\n    if (depth + 1 < p->length())\n    {\n\t// recurse\n\tIniIterator si;\n\tif (xi == xe)\n\t{\n\t    // not found, need to add it;\n\t    y2debug (\"Write: adding recursively %s to %s\", k.c_str (), p->toString().c_str());\n\n\t    IniSection s (ip, k);\n\t    container.push_back (IniContainerElement (s));\n\t    isections.insert (IniSectionIndex::value_type (k, --container.end ()));\n\n\t    si = --container.end ();\n\t}\n\telse\n\t{\n\t    // there's something, choose last\n\t    si = (--xe)->second;\n\t}\n\treturn si->s ().setSectionProp (p, in, what, depth+1);\n    }\n    else\n    {\n\t// bottom level\n\n\t// make sure we have a list of values\n\tYCPList props;\n\tif (ip->repeatNames ())\n\t{\n\t    props = as_list (in, \"property of section with repeat_names\");\n\t    if (props.isNull())\n\t\treturn -1;\n\t}\n\telse\n\t{\n\t    props->add (in);\n\t}\n\tint pi = 0, pe = props->size ();\n\n\t// Go simultaneously through the found sections\n\t// and the list of parameters, while _either_ lasts\n\t// Fewer sections-> add them, more sections-> delete them\n\n\twhile (pi != pe || xi != xe)\n\t{\n\t    // watch out for validity of iterators!\n\n\t    if (pi == pe)\n\t    {\n\t\t// deleting a section\n\t\tdelSection1 (xi++);\n\t\t// no ++pi\n\t    }\n\t    else\n\t    {\n\t\tYCPValue prop = props->value (pi);\n\t\tIniIterator si;\n\t\tif (xi == xe)\n\t\t{\n\t\t    ///need to add a section ...\n\t\t    y2debug (\"Adding section %s\", p->toString().c_str());\n\t\t    // prepare it to have its property set\n\t\t    // create it\n\t\t    IniSection s (ip, k);\n\t\t    s.dirty = true;\n\t\t    // insert and index\n\t\t    container.push_back (IniContainerElement (s));\n\t\t    isections.insert (IniSectionIndex::value_type (k, --container.end ()));\n\t\t    si = --container.end ();\n\t\t}\n\t\telse\n\t\t{\n\t\t    si = xi->second;\n\t\t}\n\n\t\t// set a section's property\n\t\tIniSection & s = si->s ();\n\t\tif (what == 0) {\n\t\t    YCPString str = as_string (prop, \"section_comment\");\n\t\t    if (str.isNull())\n\t\t\treturn -1;\n\t\t    s.setComment (str->value_cstr());\n\t\t}\n\t\telse if (what == 1) {\n\t\t    YCPInteger i = as_integer (prop, \"section_rewrite\");\n\t\t    if (i.isNull())\n\t\t\treturn -1;\n\t\t    s.setRewriteBy (i->value());\n\t\t}\n\t\telse {\n\t\t    YCPInteger i = as_integer (prop, \"section_type\");\n\t\t    if (i.isNull())\n\t\t\treturn -1;\n\t\t    s.setReadBy (i->value());\n\t\t}\n\n\t\tif (xi != xe)\n\t\t{\n\t\t    ++xi;\n\t\t}\n\t\t++pi;\n\t    }\n\t    // iterators have been advanced already\n\t}\n\treturn 0;\n    }\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::setSectionProp (const YCPPath&p,const YCPValue&in, int what, int depth)\n  {\n      string k = ip->changeCase (p->component_str (depth));\n      // Find the matching sections.\n      // If we need to recurse, choose one, creating if necessary\n      // Otherwise set properties of all of the leaf sections,\n      //  creating and deleting if the number of them does not match\n  \n      pair <IniSectionIdxIterator, IniSectionIdxIterator> r =\n  \tisections.equal_range (k);\n      IniSectionIdxIterator xi = r.first, xe = r.second;\n  \n      if (depth + 1 < p->length())\n      {\n  \t// recurse\n  \tIniIterator si;\n  \tif (xi == xe)\n  \t{\n  \t    // not found, need to add it;\n  \t    y2debug (\"Write: adding recursively %s to %s\", k.c_str (), p->toString().c_str());\n  \n  \t    IniSection s (ip, k);\n  \t    container.push_back (IniContainerElement (s));\n  \t    isections.insert (IniSectionIndex::value_type (k, --container.end ()));\n  \n  \t    si = --container.end ();\n  \t}\n  \telse\n  \t{\n  \t    // there's something, choose last\n  \t    si = (--xe)->second;\n  \t}\n  \treturn si->s ().setSectionProp (p, in, what, depth+1);\n      }\n      else\n      {\n  \t// bottom level\n  \n  \t// make sure we have a list of values\n  \tYCPList props;\n  \tif (ip->repeatNames ())\n  \t{\n  \t    props = as_list (in, \"property of section with repeat_names\");\n  \t    if (props.isNull())\n  \t\treturn -1;\n  \t}\n  \telse\n  \t{\n  \t    props->add (in);\n  \t}\n  \tint pi = 0, pe = props->size ();\n  \n  \t// Go simultaneously through the found sections\n  \t// and the list of parameters, while _either_ lasts\n  \t// Fewer sections-> add them, more sections-> delete them\n  \n  \twhile (pi != pe || xi != xe)\n  \t{\n  \t    // watch out for validity of iterators!\n  \n  \t    if (pi == pe)\n  \t    {\n  \t\t// deleting a section\n  \t\tdelSection1 (xi++);\n  \t\t// no ++pi\n  \t    }\n  \t    else\n  \t    {\n  \t\tYCPValue prop = props->value (pi);\n  \t\tIniIterator si;\n  \t\tif (xi == xe)\n  \t\t{\n  \t\t    ///need to add a section ...\n  \t\t    y2debug (\"Adding section %s\", p->toString().c_str());\n  \t\t    // prepare it to have its property set\n  \t\t    // create it\n  \t\t    IniSection s (ip, k);\n  \t\t    s.dirty = true;\n  \t\t    // insert and index\n  \t\t    container.push_back (IniContainerElement (s));\n  \t\t    isections.insert (IniSectionIndex::value_type (k, --container.end ()));\n  \t\t    si = --container.end ();\n  \t\t}\n  \t\telse\n  \t\t{\n  \t\t    si = xi->second;\n  \t\t}\n  \n  \t\t// set a section's property\n  \t\tIniSection & s = si->s ();\n  \t\tif (what == 0) {\n  \t\t    YCPString str = as_string (prop, \"section_comment\");\n  \t\t    if (str.isNull())\n  \t\t\treturn -1;\n  \t\t    s.setComment (str->value_cstr());\n  \t\t}\n  \t\telse if (what == 1) {\n  \t\t    YCPInteger i = as_integer (prop, \"section_rewrite\");\n  \t\t    if (i.isNull())\n  \t\t\treturn -1;\n  \t\t    s.setRewriteBy (i->value());\n  \t\t}\n  \t\telse {\n  \t\t    YCPInteger i = as_integer (prop, \"section_type\");\n  \t\t    if (i.isNull())\n  \t\t\treturn -1;\n  \t\t    s.setReadBy (i->value());\n  \t\t}\n  \n  \t\tif (xi != xe)\n  \t\t{\n  \t\t    ++xi;\n  \t\t}\n  \t\t++pi;\n  \t    }\n  \t    // iterators have been advanced already\n  \t}\n  \treturn 0;\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "setValue",
          "args": [
            "p",
            "v",
            "2",
            "1"
          ],
          "line": 484
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "885-924",
          "snippet": "int IniSection::setValue (const YCPPath&p,const YCPValue&in,int what, int depth)\n{\n    string k = ip->changeCase (p->component_str (depth));\n    // Find the matching sections.\n    // If we need to recurse, choose one, creating if necessary\n    // Otherwise set all the matching values\n    //  creating and deleting if the number of them does not match\n\n    if (depth + 1 < p->length())\n    {\n\t// recurse\n\tpair <IniSectionIdxIterator, IniSectionIdxIterator> r =\n\t    isections.equal_range (k);\n\tIniSectionIdxIterator xi = r.first, xe = r.second;\n\n\tIniIterator si;\n\tif (xi == xe)\n\t{\n\t    // not found, need to add it;\n\t    y2debug (\"Write: adding recursively %s to %s\", k.c_str (), p->toString().c_str());\n\n\t    IniSection s (ip, k);\n\t    container.push_back (IniContainerElement (s));\n\t    isections.insert (IniSectionIndex::value_type (k, --container.end ()));\n\n\t    si = --container.end ();\n\t}\n\telse\n\t{\n\t    // there's something, choose last\n\t    si = (--xe)->second;\n\t}\n\treturn si->s ().setValue (p, in, what, depth+1);\n    }\n    else\n    {\n\t// bottom level\n\treturn setMyValue (p, in, what, depth);\n    }\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::setValue (const YCPPath&p,const YCPValue&in,int what, int depth)\n  {\n      string k = ip->changeCase (p->component_str (depth));\n      // Find the matching sections.\n      // If we need to recurse, choose one, creating if necessary\n      // Otherwise set all the matching values\n      //  creating and deleting if the number of them does not match\n  \n      if (depth + 1 < p->length())\n      {\n  \t// recurse\n  \tpair <IniSectionIdxIterator, IniSectionIdxIterator> r =\n  \t    isections.equal_range (k);\n  \tIniSectionIdxIterator xi = r.first, xe = r.second;\n  \n  \tIniIterator si;\n  \tif (xi == xe)\n  \t{\n  \t    // not found, need to add it;\n  \t    y2debug (\"Write: adding recursively %s to %s\", k.c_str (), p->toString().c_str());\n  \n  \t    IniSection s (ip, k);\n  \t    container.push_back (IniContainerElement (s));\n  \t    isections.insert (IniSectionIndex::value_type (k, --container.end ()));\n  \n  \t    si = --container.end ();\n  \t}\n  \telse\n  \t{\n  \t    // there's something, choose last\n  \t    si = (--xe)->second;\n  \t}\n  \treturn si->s ().setValue (p, in, what, depth+1);\n      }\n      else\n      {\n  \t// bottom level\n  \treturn setMyValue (p, in, what, depth);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "p->component_str",
          "args": [
            "0"
          ],
          "line": 478
        },
        "resolved": true,
        "details": {
          "function_name": "component_str",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "161-165",
          "snippet": "string\nYCPPathRep::component_str(long index) const\n{\n    return components[index].component.asString();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  string\n  YCPPathRep::component_str(long index) const\n  {\n      return components[index].component.asString();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2error",
          "args": [
            "\"I do not know what to write to %s.\"",
            "p->toString().c_str()"
          ],
          "line": 475
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p->toString",
          "args": [],
          "line": 475
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "YBreakpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YBreakpoint.cc",
          "lines": "87-91",
          "snippet": "string\nYBreakpoint::toString() const\n{\n    return m_code->toString ();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YBreakpoint.h\"",
            "#include <debugger/Debugger.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YBreakpoint.h\"\n#include <debugger/Debugger.h>\n#include <libintl.h>\n\nYBreakpoint {\n  string\n  YBreakpoint::toString() const\n  {\n      return m_code->toString ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "p->length",
          "args": [],
          "line": 473
        },
        "resolved": true,
        "details": {
          "function_name": "length",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "124-128",
          "snippet": "long\nYCPPathRep::length() const\n{\n    return components.size();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  long\n  YCPPathRep::length() const\n  {\n      return components.size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "setAll",
          "args": [
            "p",
            "v",
            "1"
          ],
          "line": 470
        },
        "resolved": true,
        "details": {
          "function_name": "setAll",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "661-682",
          "snippet": "int IniSection::setAll (const YCPPath&p, const YCPValue& in, int depth)\n{\n    if (depth < p->length ())\n    {\n\t// recurse to find the starting section\n\t// Get any section of that name\n\tstring k = ip->changeCase (p->component_str (depth));\n\tIniSectionIdxIterator sxi = isections.find (k);\n\tif (sxi != isections.end())\n\t{\n\t    return sxi->second->s ().setAll (p, in, depth+1);\n\t}\n\t// else error\n    }\n    else\n    {\n\treturn setAllDoIt (in->asMap ());\n    }\n\n    y2debug (\"Write: Invalid path %s [%d]\", p->toString().c_str(), depth);\n    return -1;\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::setAll (const YCPPath&p, const YCPValue& in, int depth)\n  {\n      if (depth < p->length ())\n      {\n  \t// recurse to find the starting section\n  \t// Get any section of that name\n  \tstring k = ip->changeCase (p->component_str (depth));\n  \tIniSectionIdxIterator sxi = isections.find (k);\n  \tif (sxi != isections.end())\n  \t{\n  \t    return sxi->second->s ().setAll (p, in, depth+1);\n  \t}\n  \t// else error\n      }\n      else\n      {\n  \treturn setAllDoIt (in->asMap ());\n      }\n  \n      y2debug (\"Write: Invalid path %s [%d]\", p->toString().c_str(), depth);\n      return -1;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "setValueFlat",
          "args": [
            "p",
            "v"
          ],
          "line": 466
        },
        "resolved": true,
        "details": {
          "function_name": "setValueFlat",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "1033-1041",
          "snippet": "int IniSection::setValueFlat (const YCPPath&p, const YCPValue &in)\n{\n    if (!p->length ())\n\treturn -1;\n    string k = ip->changeCase (p->component_str (0));\n    bool want_comment = p->length()>1 && p->component_str(1)==\"comment\";\n\n    return setMyValue (p, in, want_comment, 0);\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::setValueFlat (const YCPPath&p, const YCPValue &in)\n  {\n      if (!p->length ())\n  \treturn -1;\n      string k = ip->changeCase (p->component_str (0));\n      bool want_comment = p->length()>1 && p->component_str(1)==\"comment\";\n  \n      return setMyValue (p, in, want_comment, 0);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ip->isFlat",
          "args": [],
          "line": 465
        },
        "resolved": true,
        "details": {
          "function_name": "isFlat",
          "container": "IniParser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.h",
          "lines": "460-460",
          "snippet": "bool isFlat () const { return flat; }",
          "includes": [
            "#include \"IniFile.h\"",
            "#include <set>",
            "#include <vector>",
            "#include <string>",
            "#include <fstream>",
            "#include <iosfwd>",
            "#include <YCP.h>",
            "#include <y2util/RepDef.h>",
            "#include <locale.h>",
            "#include <regex.h>",
            "#include <stdio.h>",
            "#include <ctype.h>",
            "#include <unistd.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include <set>\n#include <vector>\n#include <string>\n#include <fstream>\n#include <iosfwd>\n#include <YCP.h>\n#include <y2util/RepDef.h>\n#include <locale.h>\n#include <regex.h>\n#include <stdio.h>\n#include <ctype.h>\n#include <unistd.h>\n\nIniParser {\n  bool isFlat () const { return flat; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::Write (const YCPPath&p, const YCPValue&v, bool rewrite)\n  {\n      if (ip->isFlat ())\n  \treturn setValueFlat (p, v);\n  \n      if (p->length() >= 1 && p->component_str (0) == \"all\")\n      {\n  \treturn setAll (p, v, 1);\n      }\n  \n      if (p->length() < 2)\n      {\n  \ty2error (\"I do not know what to write to %s.\", p->toString().c_str());\n  \treturn -1;\n      }\n      string s = p->component_str (0);\n      if (s == \"v\" || s == \"value\")\n  \treturn setValue (p, v, 0, 1);\n      if (s == \"vc\" || s == \"value_comment\" || s == \"valuecomment\")\n        return setValue (p, v, 1, 1);\n      if (s == \"vt\" || s == \"value_type\" || s == \"valuetype\")\n        return setValue (p, v, 2, 1);\n      if (s == \"s\" || s == \"section\" || s == \"sc\" || s == \"section_comment\" || s == \"sectioncomment\")\n        return setSectionProp (p, v, 0, 1);\n      if (s == \"st\" || s == \"section_type\" || s == \"sectiontype\")\n        return setSectionProp (p, v, rewrite? 1:2, 1);\n      return -1;\n  }\n}"
  },
  {
    "function_name": "Delete",
    "container": "IniSection",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "446-461",
    "snippet": "int IniSection::Delete (const YCPPath&p)\n{\n    if (ip->isFlat ())\n\treturn delValueFlat (p);\n    if (p->length() < 2)\n    {\n\ty2error (\"I do not know what to delete at %s.\", p->toString().c_str());\n\treturn -1;\n    }\n    string s = p->component_str (0);\n    if (s == \"v\" || s == \"value\")\n\treturn delValue (p, 1);\n    if (s == \"s\" || s == \"section\")\n      return delSection (p, 1);\n    return -1;\n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "delSection",
          "args": [
            "p",
            "1"
          ],
          "line": 459
        },
        "resolved": true,
        "details": {
          "function_name": "delSection",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "621-659",
          "snippet": "int IniSection::delSection(const YCPPath&p, int depth)\n{\n    string k = ip->changeCase (p->component_str (depth));\n\n    // Find the matching sections.\n    // If we need to recurse, choose one\n    // Otherwise kill them all\n\n    pair <IniSectionIdxIterator, IniSectionIdxIterator> r =\n\tisections.equal_range (k);\n    IniSectionIdxIterator xi = r.first, xe = r.second;\n\n    if (depth + 1 < p->length())\n    {\n\t// recurse\n\tif (xi != xe)\n\t{\n\t    // there's something\n\t    IniSection& s = (--xe)->second->s ();\n\t    return s.delSection (p, depth+1);\n\t}\n\t//error\n\ty2error (\"Delete: Invalid path %s [%d]\", p->toString().c_str(), depth);\n\treturn -1;\n    }\n    else\n    {\n\t// bottom level, massacre begins\n\tif (xi == xe)\n\t{\n\t    y2debug (\"Can not delete %s. Key does not exist.\", p->toString().c_str());\n\t}\n\twhile (xi != xe)\n\t{\n\t    delSection1 (xi++);\n\t}\n    }\n    return 0;\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::delSection(const YCPPath&p, int depth)\n  {\n      string k = ip->changeCase (p->component_str (depth));\n  \n      // Find the matching sections.\n      // If we need to recurse, choose one\n      // Otherwise kill them all\n  \n      pair <IniSectionIdxIterator, IniSectionIdxIterator> r =\n  \tisections.equal_range (k);\n      IniSectionIdxIterator xi = r.first, xe = r.second;\n  \n      if (depth + 1 < p->length())\n      {\n  \t// recurse\n  \tif (xi != xe)\n  \t{\n  \t    // there's something\n  \t    IniSection& s = (--xe)->second->s ();\n  \t    return s.delSection (p, depth+1);\n  \t}\n  \t//error\n  \ty2error (\"Delete: Invalid path %s [%d]\", p->toString().c_str(), depth);\n  \treturn -1;\n      }\n      else\n      {\n  \t// bottom level, massacre begins\n  \tif (xi == xe)\n  \t{\n  \t    y2debug (\"Can not delete %s. Key does not exist.\", p->toString().c_str());\n  \t}\n  \twhile (xi != xe)\n  \t{\n  \t    delSection1 (xi++);\n  \t}\n      }\n      return 0;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "delValue",
          "args": [
            "p",
            "1"
          ],
          "line": 457
        },
        "resolved": true,
        "details": {
          "function_name": "delValue",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "950-980",
          "snippet": "int IniSection::delValue (const YCPPath&p, int depth)\n{\n    string k = ip->changeCase (p->component_str (depth));\n    // Find the matching sections.\n    // If we need to recurse, choose one\n    // Otherwise kill all values of the name\n\n    if (depth + 1 < p->length())\n    {\n\t// recurse\n\tpair <IniSectionIdxIterator, IniSectionIdxIterator> r =\n\t    isections.equal_range (k);\n\tIniSectionIdxIterator xi = r.first, xe = r.second;\n\n\tif (xi != xe)\n\t{\n\t    // there's something\n\t    IniSection& s = (--xe)->second->s ();\n\t    return s.delValue (p, depth+1);\n\t}\n\t//error\n\ty2error (\"Delete: Invalid path %s [%d]\", p->toString().c_str(), depth);\n\treturn -1;\n    }\n    else\n    {\n\t// bottom level, massacre begins\n\tdelMyValue (k);\n    }\n    return 0;\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::delValue (const YCPPath&p, int depth)\n  {\n      string k = ip->changeCase (p->component_str (depth));\n      // Find the matching sections.\n      // If we need to recurse, choose one\n      // Otherwise kill all values of the name\n  \n      if (depth + 1 < p->length())\n      {\n  \t// recurse\n  \tpair <IniSectionIdxIterator, IniSectionIdxIterator> r =\n  \t    isections.equal_range (k);\n  \tIniSectionIdxIterator xi = r.first, xe = r.second;\n  \n  \tif (xi != xe)\n  \t{\n  \t    // there's something\n  \t    IniSection& s = (--xe)->second->s ();\n  \t    return s.delValue (p, depth+1);\n  \t}\n  \t//error\n  \ty2error (\"Delete: Invalid path %s [%d]\", p->toString().c_str(), depth);\n  \treturn -1;\n      }\n      else\n      {\n  \t// bottom level, massacre begins\n  \tdelMyValue (k);\n      }\n      return 0;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "p->component_str",
          "args": [
            "0"
          ],
          "line": 455
        },
        "resolved": true,
        "details": {
          "function_name": "component_str",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "161-165",
          "snippet": "string\nYCPPathRep::component_str(long index) const\n{\n    return components[index].component.asString();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  string\n  YCPPathRep::component_str(long index) const\n  {\n      return components[index].component.asString();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2error",
          "args": [
            "\"I do not know what to delete at %s.\"",
            "p->toString().c_str()"
          ],
          "line": 452
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p->toString",
          "args": [],
          "line": 452
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "YBreakpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YBreakpoint.cc",
          "lines": "87-91",
          "snippet": "string\nYBreakpoint::toString() const\n{\n    return m_code->toString ();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YBreakpoint.h\"",
            "#include <debugger/Debugger.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YBreakpoint.h\"\n#include <debugger/Debugger.h>\n#include <libintl.h>\n\nYBreakpoint {\n  string\n  YBreakpoint::toString() const\n  {\n      return m_code->toString ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "p->length",
          "args": [],
          "line": 450
        },
        "resolved": true,
        "details": {
          "function_name": "length",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "124-128",
          "snippet": "long\nYCPPathRep::length() const\n{\n    return components.size();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  long\n  YCPPathRep::length() const\n  {\n      return components.size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "delValueFlat",
          "args": [
            "p"
          ],
          "line": 449
        },
        "resolved": true,
        "details": {
          "function_name": "delValueFlat",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "1023-1031",
          "snippet": "int IniSection::delValueFlat (const YCPPath&p)\n{\n    if (!p->length ())\n\treturn -1;\n    string k = ip->changeCase (p->component_str (0));\n\n    delMyValue (k);\n    return 0;\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::delValueFlat (const YCPPath&p)\n  {\n      if (!p->length ())\n  \treturn -1;\n      string k = ip->changeCase (p->component_str (0));\n  \n      delMyValue (k);\n      return 0;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ip->isFlat",
          "args": [],
          "line": 448
        },
        "resolved": true,
        "details": {
          "function_name": "isFlat",
          "container": "IniParser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.h",
          "lines": "460-460",
          "snippet": "bool isFlat () const { return flat; }",
          "includes": [
            "#include \"IniFile.h\"",
            "#include <set>",
            "#include <vector>",
            "#include <string>",
            "#include <fstream>",
            "#include <iosfwd>",
            "#include <YCP.h>",
            "#include <y2util/RepDef.h>",
            "#include <locale.h>",
            "#include <regex.h>",
            "#include <stdio.h>",
            "#include <ctype.h>",
            "#include <unistd.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include <set>\n#include <vector>\n#include <string>\n#include <fstream>\n#include <iosfwd>\n#include <YCP.h>\n#include <y2util/RepDef.h>\n#include <locale.h>\n#include <regex.h>\n#include <stdio.h>\n#include <ctype.h>\n#include <unistd.h>\n\nIniParser {\n  bool isFlat () const { return flat; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::Delete (const YCPPath&p)\n  {\n      if (ip->isFlat ())\n  \treturn delValueFlat (p);\n      if (p->length() < 2)\n      {\n  \ty2error (\"I do not know what to delete at %s.\", p->toString().c_str());\n  \treturn -1;\n      }\n      string s = p->component_str (0);\n      if (s == \"v\" || s == \"value\")\n  \treturn delValue (p, 1);\n      if (s == \"s\" || s == \"section\")\n        return delSection (p, 1);\n      return -1;\n  }\n}"
  },
  {
    "function_name": "getAllDoIt",
    "container": "IniSection",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "413-444",
    "snippet": "YCPMap IniSection::getAllDoIt ()\n{\n    YCPMap m = IniBase::getAllDoIt ();\n\n    m->add (YCPString (\"kind\"), YCPString (\"section\"));\n    m->add (YCPString (\"file\"), YCPInteger (rewrite_by));\n\n    YCPList v;\n    IniIterator\n\tci = getContainerBegin (),\n\tce = getContainerEnd ();\n\n    for (;ci != ce; ++ci)\n    {\n\t// the method is virtual,\n\t// but the container does not exploit the polymorphism\n\tYCPMap vm;\n\tIniType t = ci->t ();\n\tif (t == VALUE)\n\t{\n\t    vm = ci->e ().getAllDoIt ();\n\t}\n\telse //if (t == SECTION)\n\t{\n\t    vm = ci->s ().getAllDoIt ();\n\t}\n\tv->add (vm);\n    }\n\n    m->add (YCPString (\"value\"), v);\n    return m;\n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m->add",
          "args": [
            "YCPString (\"value\")",
            "v"
          ],
          "line": 442
        },
        "resolved": true,
        "details": {
          "function_name": "add",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "50-76",
          "snippet": "void\nYCPMapRep::add (const YCPValue& key, const YCPValue& value)\n{\n    if (!key->isString()\n\t&& !key->isInteger()\n\t&& !key->isSymbol())\n    {\n\tycp2error (\"Only integer, string, or symbol constant allowed as key in map\");\n\treturn;\n    }\n\n    // Note: 'stl_map[key] = value' would create a temporary object using the\n    // default constructor for YCPValue. See Scott Meyers, Effective STL, Item\n    // 24.\n\n    YCPMap::iterator pos = stl_map.lower_bound(key);\n    if (pos != stl_map.end() && !YCPMap::key_compare()(key, pos->first))\n    {\n\tpos->second = value;\n    }\n    else\n    {\n\t// pos is just a hint but can avoid a second search through the map\n\tstl_map.insert(pos, YCPMap::value_type(key, value));\n    }\n\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  void\n  YCPMapRep::add (const YCPValue& key, const YCPValue& value)\n  {\n      if (!key->isString()\n  \t&& !key->isInteger()\n  \t&& !key->isSymbol())\n      {\n  \tycp2error (\"Only integer, string, or symbol constant allowed as key in map\");\n  \treturn;\n      }\n  \n      // Note: 'stl_map[key] = value' would create a temporary object using the\n      // default constructor for YCPValue. See Scott Meyers, Effective STL, Item\n      // 24.\n  \n      YCPMap::iterator pos = stl_map.lower_bound(key);\n      if (pos != stl_map.end() && !YCPMap::key_compare()(key, pos->first))\n      {\n  \tpos->second = value;\n      }\n      else\n      {\n  \t// pos is just a hint but can avoid a second search through the map\n  \tstl_map.insert(pos, YCPMap::value_type(key, value));\n      }\n  \n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPString",
          "args": [
            "\"value\""
          ],
          "line": 442
        },
        "resolved": true,
        "details": {
          "function_name": "isYCPStringPair",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.cc",
          "lines": "92-102",
          "snippet": "bool isYCPStringPair (const YCPValue &v)\n{\n    if (!v->isList ())\n\treturn false;\n    YCPList l = v->asList ();\n    if (l->size () != 2)\n\treturn false;\n    return\n\tl->value (0)->isString () &&\n\tl->value (1)->isString ();\n}",
          "includes": [
            "#include \"IniFile.h\"",
            "#include \"IniParser.h\"",
            "#include <cassert>",
            "#include <glob.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <errno.h>",
            "#include <set>",
            "#include <vector>",
            "#include <ycp/y2log.h>",
            "#include <y2util/PathInfo.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include \"IniParser.h\"\n#include <cassert>\n#include <glob.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <errno.h>\n#include <set>\n#include <vector>\n#include <ycp/y2log.h>\n#include <y2util/PathInfo.h>\n#include \"config.h\"\n\nbool isYCPStringPair (const YCPValue &v)\n{\n    if (!v->isList ())\n\treturn false;\n    YCPList l = v->asList ();\n    if (l->size () != 2)\n\treturn false;\n    return\n\tl->value (0)->isString () &&\n\tl->value (1)->isString ();\n}"
        }
      },
      {
        "call_info": {
          "callee": "v->add",
          "args": [
            "vm"
          ],
          "line": 439
        },
        "resolved": true,
        "details": {
          "function_name": "add",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "141-145",
          "snippet": "void\nYCPTermRep::add (const YCPValue& value)\n{\n    l->add(value);\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  void\n  YCPTermRep::add (const YCPValue& value)\n  {\n      l->add(value);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ci->s",
          "args": [],
          "line": 437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ci->s",
          "args": [],
          "line": 437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ci->e",
          "args": [],
          "line": 433
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ci->e",
          "args": [],
          "line": 433
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ci->t",
          "args": [],
          "line": 430
        },
        "resolved": true,
        "details": {
          "function_name": "t",
          "container": "IniContainerElement",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.h",
          "lines": "610-610",
          "snippet": "IniType t () const { return _t; }",
          "includes": [
            "#include <YCP.h>",
            "#include <vector>",
            "#include <list>",
            "#include <map>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <YCP.h>\n#include <vector>\n#include <list>\n#include <map>\n#include <string>\n\nIniContainerElement {\n  IniType t () const { return _t; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getContainerEnd",
          "args": [],
          "line": 423
        },
        "resolved": true,
        "details": {
          "function_name": "getContainerEnd",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "1201-1204",
          "snippet": "IniIterator IniSection::getContainerEnd ()\n{\n    return container.end ();\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  IniIterator IniSection::getContainerEnd ()\n  {\n      return container.end ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getContainerBegin",
          "args": [],
          "line": 422
        },
        "resolved": true,
        "details": {
          "function_name": "getContainerBegin",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "1196-1199",
          "snippet": "IniIterator IniSection::getContainerBegin ()\n{\n    return container.begin ();\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  IniIterator IniSection::getContainerBegin ()\n  {\n      return container.begin ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPInteger",
          "args": [
            "rewrite_by"
          ],
          "line": 418
        },
        "resolved": true,
        "details": {
          "function_name": "YCPInteger",
          "container": "YCPInteger",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPInteger.cc",
          "lines": "142-145",
          "snippet": "YCPInteger::YCPInteger (bytecodeistream & str)\n    : YCPValue (new YCPIntegerRep (fromStream (str)))\n{\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/y2log.h\"\n\nYCPInteger {\n  YCPInteger::YCPInteger (bytecodeistream & str)\n      : YCPValue (new YCPIntegerRep (fromStream (str)))\n  {\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IniBase::getAllDoIt",
          "args": [],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "getAllDoIt",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "413-444",
          "snippet": "YCPMap IniSection::getAllDoIt ()\n{\n    YCPMap m = IniBase::getAllDoIt ();\n\n    m->add (YCPString (\"kind\"), YCPString (\"section\"));\n    m->add (YCPString (\"file\"), YCPInteger (rewrite_by));\n\n    YCPList v;\n    IniIterator\n\tci = getContainerBegin (),\n\tce = getContainerEnd ();\n\n    for (;ci != ce; ++ci)\n    {\n\t// the method is virtual,\n\t// but the container does not exploit the polymorphism\n\tYCPMap vm;\n\tIniType t = ci->t ();\n\tif (t == VALUE)\n\t{\n\t    vm = ci->e ().getAllDoIt ();\n\t}\n\telse //if (t == SECTION)\n\t{\n\t    vm = ci->s ().getAllDoIt ();\n\t}\n\tv->add (vm);\n    }\n\n    m->add (YCPString (\"value\"), v);\n    return m;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  YCPMap IniSection::getAllDoIt ()\n  {\n      YCPMap m = IniBase::getAllDoIt ();\n  \n      m->add (YCPString (\"kind\"), YCPString (\"section\"));\n      m->add (YCPString (\"file\"), YCPInteger (rewrite_by));\n  \n      YCPList v;\n      IniIterator\n  \tci = getContainerBegin (),\n  \tce = getContainerEnd ();\n  \n      for (;ci != ce; ++ci)\n      {\n  \t// the method is virtual,\n  \t// but the container does not exploit the polymorphism\n  \tYCPMap vm;\n  \tIniType t = ci->t ();\n  \tif (t == VALUE)\n  \t{\n  \t    vm = ci->e ().getAllDoIt ();\n  \t}\n  \telse //if (t == SECTION)\n  \t{\n  \t    vm = ci->s ().getAllDoIt ();\n  \t}\n  \tv->add (vm);\n      }\n  \n      m->add (YCPString (\"value\"), v);\n      return m;\n  }\n}"
  },
  {
    "function_name": "getAll",
    "container": "IniSection",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "389-411",
    "snippet": "int IniSection::getAll (const YCPPath&p, YCPValue&out, int depth)\n{\n    if (depth < p->length ())\n    {\n\t// recurse to find the starting section\n\t// Get any section of that name\n\tstring k = ip->changeCase (p->component_str (depth));\n\tIniSectionIdxIterator sxi = isections.find (k);\n\tif (sxi != isections.end())\n\t{\n\t    return sxi->second->s ().getAll (p, out, depth+1);\n\t}\n\t// else error\n    }\n    else\n    {\n\tout = getAllDoIt ();\n\treturn 0;\n    }\n\n    y2error (\"Read: Invalid path %s [%d]\", p->toString().c_str(), depth);\n    return -1;\n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "y2error",
          "args": [
            "\"Read: Invalid path %s [%d]\"",
            "p->toString().c_str()",
            "depth"
          ],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p->toString",
          "args": [],
          "line": 409
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "YBreakpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YBreakpoint.cc",
          "lines": "87-91",
          "snippet": "string\nYBreakpoint::toString() const\n{\n    return m_code->toString ();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YBreakpoint.h\"",
            "#include <debugger/Debugger.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YBreakpoint.h\"\n#include <debugger/Debugger.h>\n#include <libintl.h>\n\nYBreakpoint {\n  string\n  YBreakpoint::toString() const\n  {\n      return m_code->toString ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getAllDoIt",
          "args": [],
          "line": 405
        },
        "resolved": true,
        "details": {
          "function_name": "getAllDoIt",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "413-444",
          "snippet": "YCPMap IniSection::getAllDoIt ()\n{\n    YCPMap m = IniBase::getAllDoIt ();\n\n    m->add (YCPString (\"kind\"), YCPString (\"section\"));\n    m->add (YCPString (\"file\"), YCPInteger (rewrite_by));\n\n    YCPList v;\n    IniIterator\n\tci = getContainerBegin (),\n\tce = getContainerEnd ();\n\n    for (;ci != ce; ++ci)\n    {\n\t// the method is virtual,\n\t// but the container does not exploit the polymorphism\n\tYCPMap vm;\n\tIniType t = ci->t ();\n\tif (t == VALUE)\n\t{\n\t    vm = ci->e ().getAllDoIt ();\n\t}\n\telse //if (t == SECTION)\n\t{\n\t    vm = ci->s ().getAllDoIt ();\n\t}\n\tv->add (vm);\n    }\n\n    m->add (YCPString (\"value\"), v);\n    return m;\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  YCPMap IniSection::getAllDoIt ()\n  {\n      YCPMap m = IniBase::getAllDoIt ();\n  \n      m->add (YCPString (\"kind\"), YCPString (\"section\"));\n      m->add (YCPString (\"file\"), YCPInteger (rewrite_by));\n  \n      YCPList v;\n      IniIterator\n  \tci = getContainerBegin (),\n  \tce = getContainerEnd ();\n  \n      for (;ci != ce; ++ci)\n      {\n  \t// the method is virtual,\n  \t// but the container does not exploit the polymorphism\n  \tYCPMap vm;\n  \tIniType t = ci->t ();\n  \tif (t == VALUE)\n  \t{\n  \t    vm = ci->e ().getAllDoIt ();\n  \t}\n  \telse //if (t == SECTION)\n  \t{\n  \t    vm = ci->s ().getAllDoIt ();\n  \t}\n  \tv->add (vm);\n      }\n  \n      m->add (YCPString (\"value\"), v);\n      return m;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "sxi->second->s",
          "args": [
            "p",
            "out",
            "depth+1"
          ],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sxi->second->s",
          "args": [],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isections.end",
          "args": [],
          "line": 397
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "43-47",
          "snippet": "YCPMapIterator\nYCPMapRep::end() const\n{\n    return stl_map.end();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::end() const\n  {\n      return stl_map.end();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "isections.find",
          "args": [
            "k"
          ],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip->changeCase",
          "args": [
            "p->component_str (depth)"
          ],
          "line": 395
        },
        "resolved": true,
        "details": {
          "function_name": "changeCase",
          "container": "IniParser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.cc",
          "lines": "1098-1120",
          "snippet": "string IniParser::changeCase (const string&str) const\n{\n    string tmp = str;\n    if (!ignore_case)\n      return tmp;\n    if (prefer_uppercase)\n    {\n\tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n\t    *it = toupper (*it);\n    }\n    else\n    {\n\tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n\t    *it = tolower (*it);\n\tif (first_upper)\n\t{\n\tstring::iterator it = tmp.begin ();\n\tif (it != tmp.end ())\n\t    *it = toupper (*it);\n\t}\t    \n    }\n    return tmp;\n}",
          "includes": [
            "#include \"IniFile.h\"",
            "#include \"IniParser.h\"",
            "#include <cassert>",
            "#include <glob.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <errno.h>",
            "#include <set>",
            "#include <vector>",
            "#include <ycp/y2log.h>",
            "#include <y2util/PathInfo.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include \"IniParser.h\"\n#include <cassert>\n#include <glob.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <errno.h>\n#include <set>\n#include <vector>\n#include <ycp/y2log.h>\n#include <y2util/PathInfo.h>\n#include \"config.h\"\n\nIniParser {\n  string IniParser::changeCase (const string&str) const\n  {\n      string tmp = str;\n      if (!ignore_case)\n        return tmp;\n      if (prefer_uppercase)\n      {\n  \tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n  \t    *it = toupper (*it);\n      }\n      else\n      {\n  \tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n  \t    *it = tolower (*it);\n  \tif (first_upper)\n  \t{\n  \tstring::iterator it = tmp.begin ();\n  \tif (it != tmp.end ())\n  \t    *it = toupper (*it);\n  \t}\t    \n      }\n      return tmp;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "p->component_str",
          "args": [
            "depth"
          ],
          "line": 395
        },
        "resolved": true,
        "details": {
          "function_name": "component_str",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "161-165",
          "snippet": "string\nYCPPathRep::component_str(long index) const\n{\n    return components[index].component.asString();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  string\n  YCPPathRep::component_str(long index) const\n  {\n      return components[index].component.asString();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "p->length",
          "args": [],
          "line": 391
        },
        "resolved": true,
        "details": {
          "function_name": "length",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "124-128",
          "snippet": "long\nYCPPathRep::length() const\n{\n    return components.size();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  long\n  YCPPathRep::length() const\n  {\n      return components.size();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::getAll (const YCPPath&p, YCPValue&out, int depth)\n  {\n      if (depth < p->length ())\n      {\n  \t// recurse to find the starting section\n  \t// Get any section of that name\n  \tstring k = ip->changeCase (p->component_str (depth));\n  \tIniSectionIdxIterator sxi = isections.find (k);\n  \tif (sxi != isections.end())\n  \t{\n  \t    return sxi->second->s ().getAll (p, out, depth+1);\n  \t}\n  \t// else error\n      }\n      else\n      {\n  \tout = getAllDoIt ();\n  \treturn 0;\n      }\n  \n      y2error (\"Read: Invalid path %s [%d]\", p->toString().c_str(), depth);\n      return -1;\n  }\n}"
  },
  {
    "function_name": "getSectionProp",
    "container": "IniSection",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "332-387",
    "snippet": "int IniSection::getSectionProp (const YCPPath&p, YCPValue&out, int what, int depth)\n{\n    string k = ip->changeCase (p->component_str (depth));\n    // Find the matching sections.\n    // If we need to recurse, choose one\n    // Otherwise gather properties of all of the leaf sections\n\n    pair <IniSectionIdxIterator, IniSectionIdxIterator> r =\n\tisections.equal_range (k);\n    IniSectionIdxIterator xi = r.first, xe = r.second;\n\n    if (depth + 1 < p->length())\n    {\n\t// recurse\n\tif (xi != xe)\n\t{\n\t    // there's something\n\t    IniSection& s = (--xe)->second->s ();\n\t    return s.getSectionProp (p, out, what, depth+1);\n\t}\n\t//error\n    }\n    else\n    {\n\t// bottom level, take all\n\tYCPList results;\n\tbool found = false;\n\tfor (; xi != xe; ++xi)\n\t{\n\t    found = true;\n\t    IniSection& s = xi->second->s ();\n\t    if (what == 0)\n\t\tout = YCPString (s.comment);\n\t    else if (what == 1)\n\t\tout = YCPInteger (s.rewrite_by);\n\t    else\n\t\tout = YCPInteger (s.read_by);\n\t    results->add (out);\n\t}\n\n\tif (ip->repeatNames ())\n\t{\n\t    out = results;\n\t    return 0;\n\t}\n\telse if (found)\n\t{\n\t    // nonempty range, the cycle ran once, out has the right value\n\t    return 0;\n\t}\n\t// empty range, no such key\n    }\n\n    y2debug (\"Read: Invalid path %s [%d]\", p->toString().c_str(), depth);\n    return -1;\n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Read: Invalid path %s [%d]\"",
            "p->toString().c_str()",
            "depth"
          ],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p->toString",
          "args": [],
          "line": 385
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "YBreakpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YBreakpoint.cc",
          "lines": "87-91",
          "snippet": "string\nYBreakpoint::toString() const\n{\n    return m_code->toString ();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YBreakpoint.h\"",
            "#include <debugger/Debugger.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YBreakpoint.h\"\n#include <debugger/Debugger.h>\n#include <libintl.h>\n\nYBreakpoint {\n  string\n  YBreakpoint::toString() const\n  {\n      return m_code->toString ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ip->repeatNames",
          "args": [],
          "line": 372
        },
        "resolved": true,
        "details": {
          "function_name": "repeatNames",
          "container": "IniParser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.h",
          "lines": "458-458",
          "snippet": "bool repeatNames () const { return repeat_names; }",
          "includes": [
            "#include \"IniFile.h\"",
            "#include <set>",
            "#include <vector>",
            "#include <string>",
            "#include <fstream>",
            "#include <iosfwd>",
            "#include <YCP.h>",
            "#include <y2util/RepDef.h>",
            "#include <locale.h>",
            "#include <regex.h>",
            "#include <stdio.h>",
            "#include <ctype.h>",
            "#include <unistd.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include <set>\n#include <vector>\n#include <string>\n#include <fstream>\n#include <iosfwd>\n#include <YCP.h>\n#include <y2util/RepDef.h>\n#include <locale.h>\n#include <regex.h>\n#include <stdio.h>\n#include <ctype.h>\n#include <unistd.h>\n\nIniParser {\n  bool repeatNames () const { return repeat_names; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "results->add",
          "args": [
            "out"
          ],
          "line": 369
        },
        "resolved": true,
        "details": {
          "function_name": "add",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "141-145",
          "snippet": "void\nYCPTermRep::add (const YCPValue& value)\n{\n    l->add(value);\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  void\n  YCPTermRep::add (const YCPValue& value)\n  {\n      l->add(value);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPInteger",
          "args": [
            "s.read_by"
          ],
          "line": 368
        },
        "resolved": true,
        "details": {
          "function_name": "YCPInteger",
          "container": "YCPInteger",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPInteger.cc",
          "lines": "142-145",
          "snippet": "YCPInteger::YCPInteger (bytecodeistream & str)\n    : YCPValue (new YCPIntegerRep (fromStream (str)))\n{\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/y2log.h\"\n\nYCPInteger {\n  YCPInteger::YCPInteger (bytecodeistream & str)\n      : YCPValue (new YCPIntegerRep (fromStream (str)))\n  {\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPString",
          "args": [
            "s.comment"
          ],
          "line": 364
        },
        "resolved": true,
        "details": {
          "function_name": "isYCPStringPair",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.cc",
          "lines": "92-102",
          "snippet": "bool isYCPStringPair (const YCPValue &v)\n{\n    if (!v->isList ())\n\treturn false;\n    YCPList l = v->asList ();\n    if (l->size () != 2)\n\treturn false;\n    return\n\tl->value (0)->isString () &&\n\tl->value (1)->isString ();\n}",
          "includes": [
            "#include \"IniFile.h\"",
            "#include \"IniParser.h\"",
            "#include <cassert>",
            "#include <glob.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <errno.h>",
            "#include <set>",
            "#include <vector>",
            "#include <ycp/y2log.h>",
            "#include <y2util/PathInfo.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include \"IniParser.h\"\n#include <cassert>\n#include <glob.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <errno.h>\n#include <set>\n#include <vector>\n#include <ycp/y2log.h>\n#include <y2util/PathInfo.h>\n#include \"config.h\"\n\nbool isYCPStringPair (const YCPValue &v)\n{\n    if (!v->isList ())\n\treturn false;\n    YCPList l = v->asList ();\n    if (l->size () != 2)\n\treturn false;\n    return\n\tl->value (0)->isString () &&\n\tl->value (1)->isString ();\n}"
        }
      },
      {
        "call_info": {
          "callee": "xi->second->s",
          "args": [],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s.getSectionProp",
          "args": [
            "p",
            "out",
            "what",
            "depth+1"
          ],
          "line": 350
        },
        "resolved": true,
        "details": {
          "function_name": "getSectionProp",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "332-387",
          "snippet": "int IniSection::getSectionProp (const YCPPath&p, YCPValue&out, int what, int depth)\n{\n    string k = ip->changeCase (p->component_str (depth));\n    // Find the matching sections.\n    // If we need to recurse, choose one\n    // Otherwise gather properties of all of the leaf sections\n\n    pair <IniSectionIdxIterator, IniSectionIdxIterator> r =\n\tisections.equal_range (k);\n    IniSectionIdxIterator xi = r.first, xe = r.second;\n\n    if (depth + 1 < p->length())\n    {\n\t// recurse\n\tif (xi != xe)\n\t{\n\t    // there's something\n\t    IniSection& s = (--xe)->second->s ();\n\t    return s.getSectionProp (p, out, what, depth+1);\n\t}\n\t//error\n    }\n    else\n    {\n\t// bottom level, take all\n\tYCPList results;\n\tbool found = false;\n\tfor (; xi != xe; ++xi)\n\t{\n\t    found = true;\n\t    IniSection& s = xi->second->s ();\n\t    if (what == 0)\n\t\tout = YCPString (s.comment);\n\t    else if (what == 1)\n\t\tout = YCPInteger (s.rewrite_by);\n\t    else\n\t\tout = YCPInteger (s.read_by);\n\t    results->add (out);\n\t}\n\n\tif (ip->repeatNames ())\n\t{\n\t    out = results;\n\t    return 0;\n\t}\n\telse if (found)\n\t{\n\t    // nonempty range, the cycle ran once, out has the right value\n\t    return 0;\n\t}\n\t// empty range, no such key\n    }\n\n    y2debug (\"Read: Invalid path %s [%d]\", p->toString().c_str(), depth);\n    return -1;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p->length",
          "args": [],
          "line": 343
        },
        "resolved": true,
        "details": {
          "function_name": "length",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "124-128",
          "snippet": "long\nYCPPathRep::length() const\n{\n    return components.size();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  long\n  YCPPathRep::length() const\n  {\n      return components.size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "isections.equal_range",
          "args": [
            "k"
          ],
          "line": 340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip->changeCase",
          "args": [
            "p->component_str (depth)"
          ],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "changeCase",
          "container": "IniParser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.cc",
          "lines": "1098-1120",
          "snippet": "string IniParser::changeCase (const string&str) const\n{\n    string tmp = str;\n    if (!ignore_case)\n      return tmp;\n    if (prefer_uppercase)\n    {\n\tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n\t    *it = toupper (*it);\n    }\n    else\n    {\n\tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n\t    *it = tolower (*it);\n\tif (first_upper)\n\t{\n\tstring::iterator it = tmp.begin ();\n\tif (it != tmp.end ())\n\t    *it = toupper (*it);\n\t}\t    \n    }\n    return tmp;\n}",
          "includes": [
            "#include \"IniFile.h\"",
            "#include \"IniParser.h\"",
            "#include <cassert>",
            "#include <glob.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <errno.h>",
            "#include <set>",
            "#include <vector>",
            "#include <ycp/y2log.h>",
            "#include <y2util/PathInfo.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include \"IniParser.h\"\n#include <cassert>\n#include <glob.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <errno.h>\n#include <set>\n#include <vector>\n#include <ycp/y2log.h>\n#include <y2util/PathInfo.h>\n#include \"config.h\"\n\nIniParser {\n  string IniParser::changeCase (const string&str) const\n  {\n      string tmp = str;\n      if (!ignore_case)\n        return tmp;\n      if (prefer_uppercase)\n      {\n  \tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n  \t    *it = toupper (*it);\n      }\n      else\n      {\n  \tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n  \t    *it = tolower (*it);\n  \tif (first_upper)\n  \t{\n  \tstring::iterator it = tmp.begin ();\n  \tif (it != tmp.end ())\n  \t    *it = toupper (*it);\n  \t}\t    \n      }\n      return tmp;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "p->component_str",
          "args": [
            "depth"
          ],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "component_str",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "161-165",
          "snippet": "string\nYCPPathRep::component_str(long index) const\n{\n    return components[index].component.asString();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  string\n  YCPPathRep::component_str(long index) const\n  {\n      return components[index].component.asString();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::getSectionProp (const YCPPath&p, YCPValue&out, int what, int depth)\n  {\n      string k = ip->changeCase (p->component_str (depth));\n      // Find the matching sections.\n      // If we need to recurse, choose one\n      // Otherwise gather properties of all of the leaf sections\n  \n      pair <IniSectionIdxIterator, IniSectionIdxIterator> r =\n  \tisections.equal_range (k);\n      IniSectionIdxIterator xi = r.first, xe = r.second;\n  \n      if (depth + 1 < p->length())\n      {\n  \t// recurse\n  \tif (xi != xe)\n  \t{\n  \t    // there's something\n  \t    IniSection& s = (--xe)->second->s ();\n  \t    return s.getSectionProp (p, out, what, depth+1);\n  \t}\n  \t//error\n      }\n      else\n      {\n  \t// bottom level, take all\n  \tYCPList results;\n  \tbool found = false;\n  \tfor (; xi != xe; ++xi)\n  \t{\n  \t    found = true;\n  \t    IniSection& s = xi->second->s ();\n  \t    if (what == 0)\n  \t\tout = YCPString (s.comment);\n  \t    else if (what == 1)\n  \t\tout = YCPInteger (s.rewrite_by);\n  \t    else\n  \t\tout = YCPInteger (s.read_by);\n  \t    results->add (out);\n  \t}\n  \n  \tif (ip->repeatNames ())\n  \t{\n  \t    out = results;\n  \t    return 0;\n  \t}\n  \telse if (found)\n  \t{\n  \t    // nonempty range, the cycle ran once, out has the right value\n  \t    return 0;\n  \t}\n  \t// empty range, no such key\n      }\n  \n      y2debug (\"Read: Invalid path %s [%d]\", p->toString().c_str(), depth);\n      return -1;\n  }\n}"
  },
  {
    "function_name": "getValue",
    "container": "IniSection",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "308-329",
    "snippet": "int IniSection::getValue (const YCPPath&p, YCPValue&out,int what, int depth)\n{\n    string k = ip->changeCase (p->component_str (depth));\n    if (depth + 1 < p->length())\n    {\n\t// it must be a section\n\t// Get any section of that name\n\tIniSectionIdxIterator sxi = isections.find (k);\n\tif (sxi != isections.end())\n\t{\n\t    return sxi->second->s ().getValue (p, out, what, depth+1);\n\t}\n\t// else error\n    }\n    else\n\t{   //We are in THE section. Find value here\n\t    return getMyValue (p, out, what, depth);\n\t}\n\n    y2debug (\"Read: Invalid path %s [%d]\", p->toString().c_str(), depth);\n    return -1;\n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Read: Invalid path %s [%d]\"",
            "p->toString().c_str()",
            "depth"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p->toString",
          "args": [],
          "line": 327
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "YBreakpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YBreakpoint.cc",
          "lines": "87-91",
          "snippet": "string\nYBreakpoint::toString() const\n{\n    return m_code->toString ();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YBreakpoint.h\"",
            "#include <debugger/Debugger.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YBreakpoint.h\"\n#include <debugger/Debugger.h>\n#include <libintl.h>\n\nYBreakpoint {\n  string\n  YBreakpoint::toString() const\n  {\n      return m_code->toString ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getMyValue",
          "args": [
            "p",
            "out",
            "what",
            "depth"
          ],
          "line": 324
        },
        "resolved": true,
        "details": {
          "function_name": "getMyValue",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "270-306",
          "snippet": "int IniSection::getMyValue (const YCPPath &p, YCPValue &out, int what, int depth)\n{\n    string k = ip->changeCase (p->component_str (depth));\n    // Find all values and return them according to repeat_names\n    YCPList results;\n    bool found = false;\n    pair <IniEntryIdxIterator, IniEntryIdxIterator> r =\n\tivalues.equal_range (k);\n    IniEntryIdxIterator xi = r.first, xe = r.second;\n    for (; xi != xe; ++xi)\n    {\n\tfound = true;\n\tIniEntry& e = xi->second-> e ();\n\tswitch (what)\n\t{\n\t    case 0:  out = YCPString (e.getValue ());  break;\n\t    case 1:  out = YCPString (e.getComment()); break;\n\t    default: out = YCPInteger(e.getReadBy ()); break;\n\t}\n\tresults->add (out);\n    }\n\n    if (ip->repeatNames ())\n    {\n\tout = results;\n\treturn 0;\n    }\n    else if (found)\n    {\n\t// nonempty range, the cycle ran once, out has the right value\n\treturn 0;\n    }\n    // empty range, no such key\n\n    y2debug (\"Read: Invalid path %s [%d]\", p->toString ().c_str(), depth);\n    return -1;\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::getMyValue (const YCPPath &p, YCPValue &out, int what, int depth)\n  {\n      string k = ip->changeCase (p->component_str (depth));\n      // Find all values and return them according to repeat_names\n      YCPList results;\n      bool found = false;\n      pair <IniEntryIdxIterator, IniEntryIdxIterator> r =\n  \tivalues.equal_range (k);\n      IniEntryIdxIterator xi = r.first, xe = r.second;\n      for (; xi != xe; ++xi)\n      {\n  \tfound = true;\n  \tIniEntry& e = xi->second-> e ();\n  \tswitch (what)\n  \t{\n  \t    case 0:  out = YCPString (e.getValue ());  break;\n  \t    case 1:  out = YCPString (e.getComment()); break;\n  \t    default: out = YCPInteger(e.getReadBy ()); break;\n  \t}\n  \tresults->add (out);\n      }\n  \n      if (ip->repeatNames ())\n      {\n  \tout = results;\n  \treturn 0;\n      }\n      else if (found)\n      {\n  \t// nonempty range, the cycle ran once, out has the right value\n  \treturn 0;\n      }\n      // empty range, no such key\n  \n      y2debug (\"Read: Invalid path %s [%d]\", p->toString ().c_str(), depth);\n      return -1;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "sxi->second->s",
          "args": [
            "p",
            "out",
            "what",
            "depth+1"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sxi->second->s",
          "args": [],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isections.end",
          "args": [],
          "line": 316
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "43-47",
          "snippet": "YCPMapIterator\nYCPMapRep::end() const\n{\n    return stl_map.end();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::end() const\n  {\n      return stl_map.end();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "isections.find",
          "args": [
            "k"
          ],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p->length",
          "args": [],
          "line": 311
        },
        "resolved": true,
        "details": {
          "function_name": "length",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "124-128",
          "snippet": "long\nYCPPathRep::length() const\n{\n    return components.size();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  long\n  YCPPathRep::length() const\n  {\n      return components.size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ip->changeCase",
          "args": [
            "p->component_str (depth)"
          ],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "changeCase",
          "container": "IniParser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.cc",
          "lines": "1098-1120",
          "snippet": "string IniParser::changeCase (const string&str) const\n{\n    string tmp = str;\n    if (!ignore_case)\n      return tmp;\n    if (prefer_uppercase)\n    {\n\tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n\t    *it = toupper (*it);\n    }\n    else\n    {\n\tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n\t    *it = tolower (*it);\n\tif (first_upper)\n\t{\n\tstring::iterator it = tmp.begin ();\n\tif (it != tmp.end ())\n\t    *it = toupper (*it);\n\t}\t    \n    }\n    return tmp;\n}",
          "includes": [
            "#include \"IniFile.h\"",
            "#include \"IniParser.h\"",
            "#include <cassert>",
            "#include <glob.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <errno.h>",
            "#include <set>",
            "#include <vector>",
            "#include <ycp/y2log.h>",
            "#include <y2util/PathInfo.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include \"IniParser.h\"\n#include <cassert>\n#include <glob.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <errno.h>\n#include <set>\n#include <vector>\n#include <ycp/y2log.h>\n#include <y2util/PathInfo.h>\n#include \"config.h\"\n\nIniParser {\n  string IniParser::changeCase (const string&str) const\n  {\n      string tmp = str;\n      if (!ignore_case)\n        return tmp;\n      if (prefer_uppercase)\n      {\n  \tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n  \t    *it = toupper (*it);\n      }\n      else\n      {\n  \tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n  \t    *it = tolower (*it);\n  \tif (first_upper)\n  \t{\n  \tstring::iterator it = tmp.begin ();\n  \tif (it != tmp.end ())\n  \t    *it = toupper (*it);\n  \t}\t    \n      }\n      return tmp;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "p->component_str",
          "args": [
            "depth"
          ],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "component_str",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "161-165",
          "snippet": "string\nYCPPathRep::component_str(long index) const\n{\n    return components[index].component.asString();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  string\n  YCPPathRep::component_str(long index) const\n  {\n      return components[index].component.asString();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::getValue (const YCPPath&p, YCPValue&out,int what, int depth)\n  {\n      string k = ip->changeCase (p->component_str (depth));\n      if (depth + 1 < p->length())\n      {\n  \t// it must be a section\n  \t// Get any section of that name\n  \tIniSectionIdxIterator sxi = isections.find (k);\n  \tif (sxi != isections.end())\n  \t{\n  \t    return sxi->second->s ().getValue (p, out, what, depth+1);\n  \t}\n  \t// else error\n      }\n      else\n  \t{   //We are in THE section. Find value here\n  \t    return getMyValue (p, out, what, depth);\n  \t}\n  \n      y2debug (\"Read: Invalid path %s [%d]\", p->toString().c_str(), depth);\n      return -1;\n  }\n}"
  },
  {
    "function_name": "getMyValue",
    "container": "IniSection",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "270-306",
    "snippet": "int IniSection::getMyValue (const YCPPath &p, YCPValue &out, int what, int depth)\n{\n    string k = ip->changeCase (p->component_str (depth));\n    // Find all values and return them according to repeat_names\n    YCPList results;\n    bool found = false;\n    pair <IniEntryIdxIterator, IniEntryIdxIterator> r =\n\tivalues.equal_range (k);\n    IniEntryIdxIterator xi = r.first, xe = r.second;\n    for (; xi != xe; ++xi)\n    {\n\tfound = true;\n\tIniEntry& e = xi->second-> e ();\n\tswitch (what)\n\t{\n\t    case 0:  out = YCPString (e.getValue ());  break;\n\t    case 1:  out = YCPString (e.getComment()); break;\n\t    default: out = YCPInteger(e.getReadBy ()); break;\n\t}\n\tresults->add (out);\n    }\n\n    if (ip->repeatNames ())\n    {\n\tout = results;\n\treturn 0;\n    }\n    else if (found)\n    {\n\t// nonempty range, the cycle ran once, out has the right value\n\treturn 0;\n    }\n    // empty range, no such key\n\n    y2debug (\"Read: Invalid path %s [%d]\", p->toString ().c_str(), depth);\n    return -1;\n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Read: Invalid path %s [%d]\"",
            "p->toString ().c_str()",
            "depth"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p->toString",
          "args": [],
          "line": 304
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "YBreakpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YBreakpoint.cc",
          "lines": "87-91",
          "snippet": "string\nYBreakpoint::toString() const\n{\n    return m_code->toString ();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YBreakpoint.h\"",
            "#include <debugger/Debugger.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YBreakpoint.h\"\n#include <debugger/Debugger.h>\n#include <libintl.h>\n\nYBreakpoint {\n  string\n  YBreakpoint::toString() const\n  {\n      return m_code->toString ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ip->repeatNames",
          "args": [],
          "line": 292
        },
        "resolved": true,
        "details": {
          "function_name": "repeatNames",
          "container": "IniParser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.h",
          "lines": "458-458",
          "snippet": "bool repeatNames () const { return repeat_names; }",
          "includes": [
            "#include \"IniFile.h\"",
            "#include <set>",
            "#include <vector>",
            "#include <string>",
            "#include <fstream>",
            "#include <iosfwd>",
            "#include <YCP.h>",
            "#include <y2util/RepDef.h>",
            "#include <locale.h>",
            "#include <regex.h>",
            "#include <stdio.h>",
            "#include <ctype.h>",
            "#include <unistd.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include <set>\n#include <vector>\n#include <string>\n#include <fstream>\n#include <iosfwd>\n#include <YCP.h>\n#include <y2util/RepDef.h>\n#include <locale.h>\n#include <regex.h>\n#include <stdio.h>\n#include <ctype.h>\n#include <unistd.h>\n\nIniParser {\n  bool repeatNames () const { return repeat_names; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "results->add",
          "args": [
            "out"
          ],
          "line": 289
        },
        "resolved": true,
        "details": {
          "function_name": "add",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "141-145",
          "snippet": "void\nYCPTermRep::add (const YCPValue& value)\n{\n    l->add(value);\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  void\n  YCPTermRep::add (const YCPValue& value)\n  {\n      l->add(value);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPInteger",
          "args": [
            "e.getReadBy ()"
          ],
          "line": 287
        },
        "resolved": true,
        "details": {
          "function_name": "YCPInteger",
          "container": "YCPInteger",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPInteger.cc",
          "lines": "142-145",
          "snippet": "YCPInteger::YCPInteger (bytecodeistream & str)\n    : YCPValue (new YCPIntegerRep (fromStream (str)))\n{\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/y2log.h\"\n\nYCPInteger {\n  YCPInteger::YCPInteger (bytecodeistream & str)\n      : YCPValue (new YCPIntegerRep (fromStream (str)))\n  {\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "e.getReadBy",
          "args": [],
          "line": 287
        },
        "resolved": true,
        "details": {
          "function_name": "getReadBy",
          "container": "IniBase",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.h",
          "lines": "59-59",
          "snippet": "int getReadBy()          const { return read_by;   }",
          "includes": [
            "#include <YCP.h>",
            "#include <vector>",
            "#include <list>",
            "#include <map>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <YCP.h>\n#include <vector>\n#include <list>\n#include <map>\n#include <string>\n\nIniBase {\n  int getReadBy()          const { return read_by;   }\n}"
        }
      },
      {
        "call_info": {
          "callee": "YCPString",
          "args": [
            "e.getComment()"
          ],
          "line": 286
        },
        "resolved": true,
        "details": {
          "function_name": "isYCPStringPair",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.cc",
          "lines": "92-102",
          "snippet": "bool isYCPStringPair (const YCPValue &v)\n{\n    if (!v->isList ())\n\treturn false;\n    YCPList l = v->asList ();\n    if (l->size () != 2)\n\treturn false;\n    return\n\tl->value (0)->isString () &&\n\tl->value (1)->isString ();\n}",
          "includes": [
            "#include \"IniFile.h\"",
            "#include \"IniParser.h\"",
            "#include <cassert>",
            "#include <glob.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <errno.h>",
            "#include <set>",
            "#include <vector>",
            "#include <ycp/y2log.h>",
            "#include <y2util/PathInfo.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include \"IniParser.h\"\n#include <cassert>\n#include <glob.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <errno.h>\n#include <set>\n#include <vector>\n#include <ycp/y2log.h>\n#include <y2util/PathInfo.h>\n#include \"config.h\"\n\nbool isYCPStringPair (const YCPValue &v)\n{\n    if (!v->isList ())\n\treturn false;\n    YCPList l = v->asList ();\n    if (l->size () != 2)\n\treturn false;\n    return\n\tl->value (0)->isString () &&\n\tl->value (1)->isString ();\n}"
        }
      },
      {
        "call_info": {
          "callee": "e.getComment",
          "args": [],
          "line": 286
        },
        "resolved": true,
        "details": {
          "function_name": "getComment",
          "container": "ModuleEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-modules/src/ModulesConf.cc",
          "lines": "81-86",
          "snippet": "ModuleEntry::EntryCom ModuleEntry::getComment() const {\n\n    return (comment.length () ?\n            (comment.find_last_of (\"\\n\") + 1 == comment.length () ? comment : comment + \"\\n\") :\n            comment);\n}",
          "includes": [
            "#include \"Y2Logger.h\"",
            "#include \"ModulesConf.h\"",
            "#include <Y2.h>",
            "#include <fstream>",
            "#include <iostream>",
            "#include <stdio.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <errno.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"Y2Logger.h\"\n#include \"ModulesConf.h\"\n#include <Y2.h>\n#include <fstream>\n#include <iostream>\n#include <stdio.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <errno.h>\n#include \"config.h\"\n\nModuleEntry {\n  ModuleEntry::EntryCom ModuleEntry::getComment() const {\n  \n      return (comment.length () ?\n              (comment.find_last_of (\"\\n\") + 1 == comment.length () ? comment : comment + \"\\n\") :\n              comment);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "e.getValue",
          "args": [],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xi->second-> e",
          "args": [],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ivalues.equal_range",
          "args": [
            "k"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip->changeCase",
          "args": [
            "p->component_str (depth)"
          ],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "changeCase",
          "container": "IniParser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.cc",
          "lines": "1098-1120",
          "snippet": "string IniParser::changeCase (const string&str) const\n{\n    string tmp = str;\n    if (!ignore_case)\n      return tmp;\n    if (prefer_uppercase)\n    {\n\tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n\t    *it = toupper (*it);\n    }\n    else\n    {\n\tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n\t    *it = tolower (*it);\n\tif (first_upper)\n\t{\n\tstring::iterator it = tmp.begin ();\n\tif (it != tmp.end ())\n\t    *it = toupper (*it);\n\t}\t    \n    }\n    return tmp;\n}",
          "includes": [
            "#include \"IniFile.h\"",
            "#include \"IniParser.h\"",
            "#include <cassert>",
            "#include <glob.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <errno.h>",
            "#include <set>",
            "#include <vector>",
            "#include <ycp/y2log.h>",
            "#include <y2util/PathInfo.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include \"IniParser.h\"\n#include <cassert>\n#include <glob.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <errno.h>\n#include <set>\n#include <vector>\n#include <ycp/y2log.h>\n#include <y2util/PathInfo.h>\n#include \"config.h\"\n\nIniParser {\n  string IniParser::changeCase (const string&str) const\n  {\n      string tmp = str;\n      if (!ignore_case)\n        return tmp;\n      if (prefer_uppercase)\n      {\n  \tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n  \t    *it = toupper (*it);\n      }\n      else\n      {\n  \tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n  \t    *it = tolower (*it);\n  \tif (first_upper)\n  \t{\n  \tstring::iterator it = tmp.begin ();\n  \tif (it != tmp.end ())\n  \t    *it = toupper (*it);\n  \t}\t    \n      }\n      return tmp;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "p->component_str",
          "args": [
            "depth"
          ],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "component_str",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "161-165",
          "snippet": "string\nYCPPathRep::component_str(long index) const\n{\n    return components[index].component.asString();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  string\n  YCPPathRep::component_str(long index) const\n  {\n      return components[index].component.asString();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::getMyValue (const YCPPath &p, YCPValue &out, int what, int depth)\n  {\n      string k = ip->changeCase (p->component_str (depth));\n      // Find all values and return them according to repeat_names\n      YCPList results;\n      bool found = false;\n      pair <IniEntryIdxIterator, IniEntryIdxIterator> r =\n  \tivalues.equal_range (k);\n      IniEntryIdxIterator xi = r.first, xe = r.second;\n      for (; xi != xe; ++xi)\n      {\n  \tfound = true;\n  \tIniEntry& e = xi->second-> e ();\n  \tswitch (what)\n  \t{\n  \t    case 0:  out = YCPString (e.getValue ());  break;\n  \t    case 1:  out = YCPString (e.getComment()); break;\n  \t    default: out = YCPInteger(e.getReadBy ()); break;\n  \t}\n  \tresults->add (out);\n      }\n  \n      if (ip->repeatNames ())\n      {\n  \tout = results;\n  \treturn 0;\n      }\n      else if (found)\n      {\n  \t// nonempty range, the cycle ran once, out has the right value\n  \treturn 0;\n      }\n      // empty range, no such key\n  \n      y2debug (\"Read: Invalid path %s [%d]\", p->toString ().c_str(), depth);\n      return -1;\n  }\n}"
  },
  {
    "function_name": "reindex",
    "container": "IniSection",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "245-268",
    "snippet": "void IniSection::reindex ()\n{\n    IniIterator\n\tci = getContainerBegin (),\n\tce = getContainerEnd ();\n\n    ivalues.clear ();\n    isections.clear ();\n\n    for (;ci != ce; ++ci)\n    {\n\n\tif (ci->t () == VALUE)\n\t{\n\t    string k = ip->changeCase (ci->e ().getName ());\n\t    ivalues.insert (IniEntryIndex::value_type (k, ci));\n\t}\n\telse\n\t{\n\t    string k = ip->changeCase (ci->s ().getName ());\n\t    isections.insert (IniSectionIndex::value_type (k, ci));\n\t}\n    }    \n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "isections.insert",
          "args": [
            "IniSectionIndex::value_type (k, ci)"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IniSectionIndex::value_type",
          "args": [
            "k",
            "ci"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip->changeCase",
          "args": [
            "ci->s ().getName ()"
          ],
          "line": 264
        },
        "resolved": true,
        "details": {
          "function_name": "changeCase",
          "container": "IniParser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.cc",
          "lines": "1098-1120",
          "snippet": "string IniParser::changeCase (const string&str) const\n{\n    string tmp = str;\n    if (!ignore_case)\n      return tmp;\n    if (prefer_uppercase)\n    {\n\tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n\t    *it = toupper (*it);\n    }\n    else\n    {\n\tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n\t    *it = tolower (*it);\n\tif (first_upper)\n\t{\n\tstring::iterator it = tmp.begin ();\n\tif (it != tmp.end ())\n\t    *it = toupper (*it);\n\t}\t    \n    }\n    return tmp;\n}",
          "includes": [
            "#include \"IniFile.h\"",
            "#include \"IniParser.h\"",
            "#include <cassert>",
            "#include <glob.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <errno.h>",
            "#include <set>",
            "#include <vector>",
            "#include <ycp/y2log.h>",
            "#include <y2util/PathInfo.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include \"IniParser.h\"\n#include <cassert>\n#include <glob.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <errno.h>\n#include <set>\n#include <vector>\n#include <ycp/y2log.h>\n#include <y2util/PathInfo.h>\n#include \"config.h\"\n\nIniParser {\n  string IniParser::changeCase (const string&str) const\n  {\n      string tmp = str;\n      if (!ignore_case)\n        return tmp;\n      if (prefer_uppercase)\n      {\n  \tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n  \t    *it = toupper (*it);\n      }\n      else\n      {\n  \tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n  \t    *it = tolower (*it);\n  \tif (first_upper)\n  \t{\n  \tstring::iterator it = tmp.begin ();\n  \tif (it != tmp.end ())\n  \t    *it = toupper (*it);\n  \t}\t    \n      }\n      return tmp;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ci->s",
          "args": [],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ci->s",
          "args": [],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ivalues.insert",
          "args": [
            "IniEntryIndex::value_type (k, ci)"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IniEntryIndex::value_type",
          "args": [
            "k",
            "ci"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ci->e",
          "args": [],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ci->e",
          "args": [],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ci->t",
          "args": [],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "t",
          "container": "IniContainerElement",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.h",
          "lines": "610-610",
          "snippet": "IniType t () const { return _t; }",
          "includes": [
            "#include <YCP.h>",
            "#include <vector>",
            "#include <list>",
            "#include <map>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <YCP.h>\n#include <vector>\n#include <list>\n#include <map>\n#include <string>\n\nIniContainerElement {\n  IniType t () const { return _t; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "isections.clear",
          "args": [],
          "line": 252
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/PathInfo.h",
          "lines": "461-461",
          "snippet": "void clear() { _devino.clear(); }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <map>",
            "#include <set>",
            "#include <list>",
            "#include <iosfwd>",
            "#include <cerrno>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <map>\n#include <set>\n#include <list>\n#include <iosfwd>\n#include <cerrno>\n#include <dirent.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nvoid clear() { _devino.clear(); }"
        }
      },
      {
        "call_info": {
          "callee": "getContainerEnd",
          "args": [],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "getContainerEnd",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "1201-1204",
          "snippet": "IniIterator IniSection::getContainerEnd ()\n{\n    return container.end ();\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  IniIterator IniSection::getContainerEnd ()\n  {\n      return container.end ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getContainerBegin",
          "args": [],
          "line": 248
        },
        "resolved": true,
        "details": {
          "function_name": "getContainerBegin",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "1196-1199",
          "snippet": "IniIterator IniSection::getContainerBegin ()\n{\n    return container.begin ();\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  IniIterator IniSection::getContainerBegin ()\n  {\n      return container.begin ();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  void IniSection::reindex ()\n  {\n      IniIterator\n  \tci = getContainerBegin (),\n  \tce = getContainerEnd ();\n  \n      ivalues.clear ();\n      isections.clear ();\n  \n      for (;ci != ce; ++ci)\n      {\n  \n  \tif (ci->t () == VALUE)\n  \t{\n  \t    string k = ip->changeCase (ci->e ().getName ());\n  \t    ivalues.insert (IniEntryIndex::value_type (k, ci));\n  \t}\n  \telse\n  \t{\n  \t    string k = ip->changeCase (ci->s ().getName ());\n  \t    isections.insert (IniSectionIndex::value_type (k, ci));\n  \t}\n      }    \n  }\n}"
  },
  {
    "function_name": "Dump",
    "container": "IniSection",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "194-243",
    "snippet": "void IniSection::Dump ()\n{\n    printf(\"%s<%s>\\n\", comment.c_str(), name.c_str());\n\n    printf (\"{Natural order}\\n\");\n    IniIterator\n\tci = getContainerBegin (),\n\tce = getContainerEnd ();\n\n    for (;ci != ce; ++ci)\n    {\n\tprintf (\"{@%p}\\n\", &*ci);\n\tIniType t = ci->t ();\n\tif (t == VALUE)\n\t{\n\t    IniEntry &v = ci->e ();\n\t    printf (\"%s%s = %s\\n\", v.getComment (), v.getName (), v.getValue ());\n\t}\n\telse if (t == SECTION)\n\t{\n\t    ci->s ().Dump ();\n\t}\n\telse\n\t{\n\t    printf (\"{Unknown type %u}\\n\", t);\n\t}\n    }\n\n    printf (\"{Sections}\\n\");\n    IniSectionIdxIterator\n\tsxi = isections.begin (),\n\tsxe = isections.end ();\n\n    for (; sxi != sxe; ++sxi)\n    {\n\tprintf (\"{%s @%p}\\n\", sxi->first.c_str (), &*sxi->second);\t\n    }\n\n    printf (\"{Values}\\n\");\n    IniEntryIdxIterator\n\texi = ivalues.begin (),\n\texe = ivalues.end ();\n\n    for (; exi != exe; ++exi)\n    {\n\tprintf (\"{%s @%p}\\n\", exi->first.c_str (), &*exi->second);\t\n    }\n\n    printf(\"</%s>\\n\", name.c_str());\n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"</%s>\\n\"",
            "name.c_str()"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "name.c_str",
          "args": [],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"{%s @%p}\\n\"",
            "exi->first.c_str ()",
            "&*exi->second"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exi->first.c_str",
          "args": [],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ivalues.end",
          "args": [],
          "line": 235
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "43-47",
          "snippet": "YCPMapIterator\nYCPMapRep::end() const\n{\n    return stl_map.end();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::end() const\n  {\n      return stl_map.end();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ivalues.begin",
          "args": [],
          "line": 234
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "36-40",
          "snippet": "YCPMapIterator\nYCPMapRep::begin() const\n{\n    return stl_map.begin();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::begin() const\n  {\n      return stl_map.begin();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"{Values}\\n\""
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"{%s @%p}\\n\"",
            "sxi->first.c_str ()",
            "&*sxi->second"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sxi->first.c_str",
          "args": [],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"{Sections}\\n\""
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"{Unknown type %u}\\n\"",
            "t"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ci->s",
          "args": [],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ci->s",
          "args": [],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s%s = %s\\n\"",
            "v.getComment ()",
            "v.getName ()",
            "v.getValue ()"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v.getValue",
          "args": [],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v.getName",
          "args": [],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v.getComment",
          "args": [],
          "line": 210
        },
        "resolved": true,
        "details": {
          "function_name": "getComment",
          "container": "ModuleEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-modules/src/ModulesConf.cc",
          "lines": "81-86",
          "snippet": "ModuleEntry::EntryCom ModuleEntry::getComment() const {\n\n    return (comment.length () ?\n            (comment.find_last_of (\"\\n\") + 1 == comment.length () ? comment : comment + \"\\n\") :\n            comment);\n}",
          "includes": [
            "#include \"Y2Logger.h\"",
            "#include \"ModulesConf.h\"",
            "#include <Y2.h>",
            "#include <fstream>",
            "#include <iostream>",
            "#include <stdio.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <errno.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"Y2Logger.h\"\n#include \"ModulesConf.h\"\n#include <Y2.h>\n#include <fstream>\n#include <iostream>\n#include <stdio.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <errno.h>\n#include \"config.h\"\n\nModuleEntry {\n  ModuleEntry::EntryCom ModuleEntry::getComment() const {\n  \n      return (comment.length () ?\n              (comment.find_last_of (\"\\n\") + 1 == comment.length () ? comment : comment + \"\\n\") :\n              comment);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ci->e",
          "args": [],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ci->t",
          "args": [],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "t",
          "container": "IniContainerElement",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.h",
          "lines": "610-610",
          "snippet": "IniType t () const { return _t; }",
          "includes": [
            "#include <YCP.h>",
            "#include <vector>",
            "#include <list>",
            "#include <map>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <YCP.h>\n#include <vector>\n#include <list>\n#include <map>\n#include <string>\n\nIniContainerElement {\n  IniType t () const { return _t; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"{@%p}\\n\"",
            "&*ci"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getContainerEnd",
          "args": [],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "getContainerEnd",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "1201-1204",
          "snippet": "IniIterator IniSection::getContainerEnd ()\n{\n    return container.end ();\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  IniIterator IniSection::getContainerEnd ()\n  {\n      return container.end ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getContainerBegin",
          "args": [],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "getContainerBegin",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "1196-1199",
          "snippet": "IniIterator IniSection::getContainerBegin ()\n{\n    return container.begin ();\n}",
          "includes": [
            "#include \"IniParser.h\"",
            "#include \"IniFile.h\"",
            "#include <cassert>",
            "#include <set>",
            "#include <ctype.h>",
            "#include <stdio.h>",
            "#include <ycp/y2log.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  IniIterator IniSection::getContainerBegin ()\n  {\n      return container.begin ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"{Natural order}\\n\""
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s<%s>\\n\"",
            "comment.c_str()",
            "name.c_str()"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "name.c_str",
          "args": [],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "comment.c_str",
          "args": [],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  void IniSection::Dump ()\n  {\n      printf(\"%s<%s>\\n\", comment.c_str(), name.c_str());\n  \n      printf (\"{Natural order}\\n\");\n      IniIterator\n  \tci = getContainerBegin (),\n  \tce = getContainerEnd ();\n  \n      for (;ci != ce; ++ci)\n      {\n  \tprintf (\"{@%p}\\n\", &*ci);\n  \tIniType t = ci->t ();\n  \tif (t == VALUE)\n  \t{\n  \t    IniEntry &v = ci->e ();\n  \t    printf (\"%s%s = %s\\n\", v.getComment (), v.getName (), v.getValue ());\n  \t}\n  \telse if (t == SECTION)\n  \t{\n  \t    ci->s ().Dump ();\n  \t}\n  \telse\n  \t{\n  \t    printf (\"{Unknown type %u}\\n\", t);\n  \t}\n      }\n  \n      printf (\"{Sections}\\n\");\n      IniSectionIdxIterator\n  \tsxi = isections.begin (),\n  \tsxe = isections.end ();\n  \n      for (; sxi != sxe; ++sxi)\n      {\n  \tprintf (\"{%s @%p}\\n\", sxi->first.c_str (), &*sxi->second);\t\n      }\n  \n      printf (\"{Values}\\n\");\n      IniEntryIdxIterator\n  \texi = ivalues.begin (),\n  \texe = ivalues.end ();\n  \n      for (; exi != exe; ++exi)\n      {\n  \tprintf (\"{%s @%p}\\n\", exi->first.c_str (), &*exi->second);\t\n      }\n  \n      printf(\"</%s>\\n\", name.c_str());\n  }\n}"
  },
  {
    "function_name": "findEndFromUp",
    "container": "IniSection",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "161-192",
    "snippet": "int IniSection::findEndFromUp (const vector<string>&path, int wanted, int found, int from)\n{\n/*\n    y2internal (\"read_by (mine: %d, wanted %d) found: %d from: %d \"\n\t\t\"path[from]: %s iam: %s\",\n\t\tread_by, wanted, found, from,\n\t\t(from < (int)path.size()) ? path[from].c_str() : \"*NONE*\", name.c_str());\n*/\n\n    if (read_by == wanted)\n    {\n\tfound = from;\n//\ty2internal (\"%s\", \" match\");\n    }\n\n    if (from < (int)path.size())\n    {\n\tstring k = ip->changeCase (path[from]);\n\t// find the _last_ section with key k\n\tpair <IniSectionIdxIterator, IniSectionIdxIterator> r =\n\t    isections.equal_range (k);\n\tif (r.first == r.second) // empty range = not found\n\t{\n\t    y2error (\"Internal error. Value %s not found. This can't happen.\\n\", path[from].c_str());\n\t    abort ();\n\t}\n\tIniSection&  s = (--r.second)->second->s ();\n\tfound = s.findEndFromUp (path, wanted, found, from + 1);\n    }\n//    y2internal (\"return %d\", found);\n    return found;\n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "s.findEndFromUp",
          "args": [
            "path",
            "wanted",
            "found",
            "from + 1"
          ],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "findEndFromUp",
          "container": "IniSection",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
          "lines": "161-192",
          "snippet": "int IniSection::findEndFromUp (const vector<string>&path, int wanted, int found, int from)\n{\n/*\n    y2internal (\"read_by (mine: %d, wanted %d) found: %d from: %d \"\n\t\t\"path[from]: %s iam: %s\",\n\t\tread_by, wanted, found, from,\n\t\t(from < (int)path.size()) ? path[from].c_str() : \"*NONE*\", name.c_str());\n*/\n\n    if (read_by == wanted)\n    {\n\tfound = from;\n//\ty2internal (\"%s\", \" match\");\n    }\n\n    if (from < (int)path.size())\n    {\n\tstring k = ip->changeCase (path[from]);\n\t// find the _last_ section with key k\n\tpair <IniSectionIdxIterator, IniSectionIdxIterator> r =\n\t    isections.equal_range (k);\n\tif (r.first == r.second) // empty range = not found\n\t{\n\t    y2error (\"Internal error. Value %s not found. This can't happen.\\n\", path[from].c_str());\n\t    abort ();\n\t}\n\tIniSection&  s = (--r.second)->second->s ();\n\tfound = s.findEndFromUp (path, wanted, found, from + 1);\n    }\n//    y2internal (\"return %d\", found);\n    return found;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "abort",
          "args": [],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2error",
          "args": [
            "\"Internal error. Value %s not found. This can't happen.\\n\"",
            "path[from].c_str()"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path[from].c_str",
          "args": [],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isections.equal_range",
          "args": [
            "k"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip->changeCase",
          "args": [
            "path[from]"
          ],
          "line": 178
        },
        "resolved": true,
        "details": {
          "function_name": "changeCase",
          "container": "IniParser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.cc",
          "lines": "1098-1120",
          "snippet": "string IniParser::changeCase (const string&str) const\n{\n    string tmp = str;\n    if (!ignore_case)\n      return tmp;\n    if (prefer_uppercase)\n    {\n\tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n\t    *it = toupper (*it);\n    }\n    else\n    {\n\tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n\t    *it = tolower (*it);\n\tif (first_upper)\n\t{\n\tstring::iterator it = tmp.begin ();\n\tif (it != tmp.end ())\n\t    *it = toupper (*it);\n\t}\t    \n    }\n    return tmp;\n}",
          "includes": [
            "#include \"IniFile.h\"",
            "#include \"IniParser.h\"",
            "#include <cassert>",
            "#include <glob.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <errno.h>",
            "#include <set>",
            "#include <vector>",
            "#include <ycp/y2log.h>",
            "#include <y2util/PathInfo.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include \"IniParser.h\"\n#include <cassert>\n#include <glob.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <errno.h>\n#include <set>\n#include <vector>\n#include <ycp/y2log.h>\n#include <y2util/PathInfo.h>\n#include \"config.h\"\n\nIniParser {\n  string IniParser::changeCase (const string&str) const\n  {\n      string tmp = str;\n      if (!ignore_case)\n        return tmp;\n      if (prefer_uppercase)\n      {\n  \tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n  \t    *it = toupper (*it);\n      }\n      else\n      {\n  \tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n  \t    *it = tolower (*it);\n  \tif (first_upper)\n  \t{\n  \tstring::iterator it = tmp.begin ();\n  \tif (it != tmp.end ())\n  \t    *it = toupper (*it);\n  \t}\t    \n      }\n      return tmp;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "path.size",
          "args": [],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "109-113",
          "snippet": "int\nYCPTermRep::size() const\n{\n    return l->size();\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  int\n  YCPTermRep::size() const\n  {\n      return l->size();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  int IniSection::findEndFromUp (const vector<string>&path, int wanted, int found, int from)\n  {\n  /*\n      y2internal (\"read_by (mine: %d, wanted %d) found: %d from: %d \"\n  \t\t\"path[from]: %s iam: %s\",\n  \t\tread_by, wanted, found, from,\n  \t\t(from < (int)path.size()) ? path[from].c_str() : \"*NONE*\", name.c_str());\n  */\n  \n      if (read_by == wanted)\n      {\n  \tfound = from;\n  //\ty2internal (\"%s\", \" match\");\n      }\n  \n      if (from < (int)path.size())\n      {\n  \tstring k = ip->changeCase (path[from]);\n  \t// find the _last_ section with key k\n  \tpair <IniSectionIdxIterator, IniSectionIdxIterator> r =\n  \t    isections.equal_range (k);\n  \tif (r.first == r.second) // empty range = not found\n  \t{\n  \t    y2error (\"Internal error. Value %s not found. This can't happen.\\n\", path[from].c_str());\n  \t    abort ();\n  \t}\n  \tIniSection&  s = (--r.second)->second->s ();\n  \tfound = s.findEndFromUp (path, wanted, found, from + 1);\n      }\n  //    y2internal (\"return %d\", found);\n      return found;\n  }\n}"
  },
  {
    "function_name": "initValue",
    "container": "IniSection",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "78-107",
    "snippet": "void IniSection::initValue (const string&key,const string&val,const string&comment,int rb)\n{\n    string k = ip->changeCase (key);\n    IniEntry e;\n    IniEntryIdxIterator exi;\n    if (!ip->repeatNames () && (exi = ivalues.find (k)) != ivalues.end ())\n\t{\n\t    IniIterator ei = exi->second;\n\t    // update existing value\n\t    // copy the old value\n\t    e = ei->e ();\n\t    // remove and unindex the old value\n\t    // This means that container needs to be a list, not vector,\n\t    // so that iterators kept in ivalues are still valid\n\t    container.erase (ei);\n\t    ivalues.erase (exi);\n\t}\n    else\n\t{\n\t    // nothing\n\t}\n    // create new value\n    e.init (k, comment, rb, val);\n    // insert it\n    IniContainerElement ce (e);\n    container.push_back (ce);\n    // index it\n    ivalues.insert (IniEntryIndex::value_type (k, --container.end ()));\n\n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ivalues.insert",
          "args": [
            "IniEntryIndex::value_type (k, --container.end ())"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IniEntryIndex::value_type",
          "args": [
            "k",
            "--container.end ()"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container.end",
          "args": [],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "43-47",
          "snippet": "YCPMapIterator\nYCPMapRep::end() const\n{\n    return stl_map.end();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::end() const\n  {\n      return stl_map.end();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "container.push_back",
          "args": [
            "ce"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "push_back",
          "container": "YCPListRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPList.cc",
          "lines": "70-74",
          "snippet": "void\nYCPListRep::push_back(const YCPValue& value)\n{\n    elements.push_back(value);\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/YCPCodeCompare.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include <algorithm>",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"YCP.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/YCPCodeCompare.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include <algorithm>\n#include \"ycp/YCPList.h\"\n#include \"ycp/y2log.h\"\n#include \"YCP.h\"\n\nYCPListRep {\n  void\n  YCPListRep::push_back(const YCPValue& value)\n  {\n      elements.push_back(value);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "e.init",
          "args": [
            "k",
            "comment",
            "rb",
            "val"
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "init",
          "container": "IniEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.h",
          "lines": "163-170",
          "snippet": "void init(const string &n, const string &c, int rb, const string &v)\n\t    {\n\t\tif (!dirty)\n\t\t    {\n\t\t\tval = v;\n\t\t\tIniBase::init (n, c, rb);\n\t\t    }\n\t    }",
          "includes": [
            "#include <YCP.h>",
            "#include <vector>",
            "#include <list>",
            "#include <map>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <YCP.h>\n#include <vector>\n#include <list>\n#include <map>\n#include <string>\n\nIniEntry {\n  void init(const string &n, const string &c, int rb, const string &v)\n  \t    {\n  \t\tif (!dirty)\n  \t\t    {\n  \t\t\tval = v;\n  \t\t\tIniBase::init (n, c, rb);\n  \t\t    }\n  \t    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ivalues.erase",
          "args": [
            "exi"
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "erase",
          "container": "PathInfo",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/PathInfo.cc",
          "lines": "683-695",
          "snippet": "int PathInfo::erase( const Pathname & path )\n{\n  int res = 0;\n  PathInfo p( path, LSTAT );\n  if ( p.isExist() )\n    {\n      if ( p.isDir() )\n        res = PathInfo::recursive_rmdir( path );\n      else\n        res = PathInfo::unlink( path );\n    }\n  return res;\n}",
          "includes": [
            "#include <y2util/PathInfo.h>",
            "#include <y2util/ExternalProgram.h>",
            "#include <y2util/stringutil.h>",
            "#include <y2util/Y2SLog.h>",
            "#include <iomanip>",
            "#include <fstream>",
            "#include <iostream>",
            "#include <string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/PathInfo.h>\n#include <y2util/ExternalProgram.h>\n#include <y2util/stringutil.h>\n#include <y2util/Y2SLog.h>\n#include <iomanip>\n#include <fstream>\n#include <iostream>\n#include <string.h>\n\nPathInfo {\n  int PathInfo::erase( const Pathname & path )\n  {\n    int res = 0;\n    PathInfo p( path, LSTAT );\n    if ( p.isExist() )\n      {\n        if ( p.isDir() )\n          res = PathInfo::recursive_rmdir( path );\n        else\n          res = PathInfo::unlink( path );\n      }\n    return res;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ei->e",
          "args": [],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ivalues.find",
          "args": [
            "k"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ip->repeatNames",
          "args": [],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "repeatNames",
          "container": "IniParser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.h",
          "lines": "458-458",
          "snippet": "bool repeatNames () const { return repeat_names; }",
          "includes": [
            "#include \"IniFile.h\"",
            "#include <set>",
            "#include <vector>",
            "#include <string>",
            "#include <fstream>",
            "#include <iosfwd>",
            "#include <YCP.h>",
            "#include <y2util/RepDef.h>",
            "#include <locale.h>",
            "#include <regex.h>",
            "#include <stdio.h>",
            "#include <ctype.h>",
            "#include <unistd.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include <set>\n#include <vector>\n#include <string>\n#include <fstream>\n#include <iosfwd>\n#include <YCP.h>\n#include <y2util/RepDef.h>\n#include <locale.h>\n#include <regex.h>\n#include <stdio.h>\n#include <ctype.h>\n#include <unistd.h>\n\nIniParser {\n  bool repeatNames () const { return repeat_names; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ip->changeCase",
          "args": [
            "key"
          ],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "changeCase",
          "container": "IniParser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniParser.cc",
          "lines": "1098-1120",
          "snippet": "string IniParser::changeCase (const string&str) const\n{\n    string tmp = str;\n    if (!ignore_case)\n      return tmp;\n    if (prefer_uppercase)\n    {\n\tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n\t    *it = toupper (*it);\n    }\n    else\n    {\n\tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n\t    *it = tolower (*it);\n\tif (first_upper)\n\t{\n\tstring::iterator it = tmp.begin ();\n\tif (it != tmp.end ())\n\t    *it = toupper (*it);\n\t}\t    \n    }\n    return tmp;\n}",
          "includes": [
            "#include \"IniFile.h\"",
            "#include \"IniParser.h\"",
            "#include <cassert>",
            "#include <glob.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <errno.h>",
            "#include <set>",
            "#include <vector>",
            "#include <ycp/y2log.h>",
            "#include <y2util/PathInfo.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"IniFile.h\"\n#include \"IniParser.h\"\n#include <cassert>\n#include <glob.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <errno.h>\n#include <set>\n#include <vector>\n#include <ycp/y2log.h>\n#include <y2util/PathInfo.h>\n#include \"config.h\"\n\nIniParser {\n  string IniParser::changeCase (const string&str) const\n  {\n      string tmp = str;\n      if (!ignore_case)\n        return tmp;\n      if (prefer_uppercase)\n      {\n  \tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n  \t    *it = toupper (*it);\n      }\n      else\n      {\n  \tfor (string::iterator it = tmp.begin(); it != tmp.end(); ++it)\n  \t    *it = tolower (*it);\n  \tif (first_upper)\n  \t{\n  \tstring::iterator it = tmp.begin ();\n  \tif (it != tmp.end ())\n  \t    *it = toupper (*it);\n  \t}\t    \n      }\n      return tmp;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nIniSection {\n  void IniSection::initValue (const string&key,const string&val,const string&comment,int rb)\n  {\n      string k = ip->changeCase (key);\n      IniEntry e;\n      IniEntryIdxIterator exi;\n      if (!ip->repeatNames () && (exi = ivalues.find (k)) != ivalues.end ())\n  \t{\n  \t    IniIterator ei = exi->second;\n  \t    // update existing value\n  \t    // copy the old value\n  \t    e = ei->e ();\n  \t    // remove and unindex the old value\n  \t    // This means that container needs to be a list, not vector,\n  \t    // so that iterators kept in ivalues are still valid\n  \t    container.erase (ei);\n  \t    ivalues.erase (exi);\n  \t}\n      else\n  \t{\n  \t    // nothing\n  \t}\n      // create new value\n      e.init (k, comment, rb, val);\n      // insert it\n      IniContainerElement ce (e);\n      container.push_back (ce);\n      // index it\n      ivalues.insert (IniEntryIndex::value_type (k, --container.end ()));\n  \n  }\n}"
  },
  {
    "function_name": "as_integer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "68-76",
    "snippet": "static\nYCPInteger as_integer (const YCPValue& v, const char * context)\n{\n    if (v->isInteger ())\n\treturn v->asInteger ();\n    ycp2error (\"Expected an integer for %s, got %s %s\",\n\t       context, v->valuetype_str(), v->toString().c_str());\n    return YCPNull ();\n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "YCPNull",
          "args": [],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ycp2error",
          "args": [
            "\"Expected an integer for %s, got %s %s\"",
            "context",
            "v->valuetype_str()",
            "v->toString().c_str()"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v->toString",
          "args": [],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "YBreakpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YBreakpoint.cc",
          "lines": "87-91",
          "snippet": "string\nYBreakpoint::toString() const\n{\n    return m_code->toString ();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YBreakpoint.h\"",
            "#include <debugger/Debugger.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YBreakpoint.h\"\n#include <debugger/Debugger.h>\n#include <libintl.h>\n\nYBreakpoint {\n  string\n  YBreakpoint::toString() const\n  {\n      return m_code->toString ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "v->valuetype_str",
          "args": [],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v->asInteger",
          "args": [],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "asInteger",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "106-116",
          "snippet": "YCPInteger\nYCPValueRep::asInteger() const\n{\n    if (!isInteger())\n    {\n\tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not Integer!\",\n\t      toString().c_str());\n\tabort();\n    }\n    return YCPInteger (static_cast<const YCPIntegerRep *>(this));\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  YCPInteger\n  YCPValueRep::asInteger() const\n  {\n      if (!isInteger())\n      {\n  \tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not Integer!\",\n  \t      toString().c_str());\n  \tabort();\n      }\n      return YCPInteger (static_cast<const YCPIntegerRep *>(this));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "v->isInteger",
          "args": [],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "isInteger",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "63-63",
          "snippet": "bool YCPValueRep::isInteger()     const { return valuetype() == YT_INTEGER; }",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  bool YCPValueRep::isInteger()     const { return valuetype() == YT_INTEGER; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nstatic\nYCPInteger as_integer (const YCPValue& v, const char * context)\n{\n    if (v->isInteger ())\n\treturn v->asInteger ();\n    ycp2error (\"Expected an integer for %s, got %s %s\",\n\t       context, v->valuetype_str(), v->toString().c_str());\n    return YCPNull ();\n}"
  },
  {
    "function_name": "as_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "55-63",
    "snippet": "static\nYCPString as_string (const YCPValue& v, const char * context)\n{\n    if (v->isString ())\n\treturn v->asString ();\n    ycp2error (\"Expected a string for %s, got %s %s\",\n\t       context, v->valuetype_str(), v->toString().c_str());\n    return YCPNull ();\n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "YCPNull",
          "args": [],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ycp2error",
          "args": [
            "\"Expected a string for %s, got %s %s\"",
            "context",
            "v->valuetype_str()",
            "v->toString().c_str()"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v->toString",
          "args": [],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "YBreakpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YBreakpoint.cc",
          "lines": "87-91",
          "snippet": "string\nYBreakpoint::toString() const\n{\n    return m_code->toString ();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YBreakpoint.h\"",
            "#include <debugger/Debugger.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YBreakpoint.h\"\n#include <debugger/Debugger.h>\n#include <libintl.h>\n\nYBreakpoint {\n  string\n  YBreakpoint::toString() const\n  {\n      return m_code->toString ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "v->valuetype_str",
          "args": [],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v->asString",
          "args": [],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "asString",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "130-140",
          "snippet": "YCPString\nYCPValueRep::asString() const\n{\n    if (!isString())\n    {\n\tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n\t      toString().c_str());\n\tabort();\n    }\n    return YCPString (static_cast<const YCPStringRep *>(this));\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  YCPString\n  YCPValueRep::asString() const\n  {\n      if (!isString())\n      {\n  \tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n  \t      toString().c_str());\n  \tabort();\n      }\n      return YCPString (static_cast<const YCPStringRep *>(this));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "v->isString",
          "args": [],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "isString",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "65-65",
          "snippet": "bool YCPValueRep::isString()      const { return valuetype() == YT_STRING; }",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  bool YCPValueRep::isString()      const { return valuetype() == YT_STRING; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nstatic\nYCPString as_string (const YCPValue& v, const char * context)\n{\n    if (v->isString ())\n\treturn v->asString ();\n    ycp2error (\"Expected a string for %s, got %s %s\",\n\t       context, v->valuetype_str(), v->toString().c_str());\n    return YCPNull ();\n}"
  },
  {
    "function_name": "as_list",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "42-50",
    "snippet": "static\nYCPList as_list (const YCPValue& v, const char * context)\n{\n    if (v->isList ())\n\treturn v->asList ();\n    ycp2error (\"Expected a list for %s, got %s %s\",\n\t       context, v->valuetype_str(), v->toString().c_str());\n    return YCPNull ();\n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "YCPNull",
          "args": [],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ycp2error",
          "args": [
            "\"Expected a list for %s, got %s %s\"",
            "context",
            "v->valuetype_str()",
            "v->toString().c_str()"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v->toString",
          "args": [],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "YBreakpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YBreakpoint.cc",
          "lines": "87-91",
          "snippet": "string\nYBreakpoint::toString() const\n{\n    return m_code->toString ();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YBreakpoint.h\"",
            "#include <debugger/Debugger.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YBreakpoint.h\"\n#include <debugger/Debugger.h>\n#include <libintl.h>\n\nYBreakpoint {\n  string\n  YBreakpoint::toString() const\n  {\n      return m_code->toString ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "v->valuetype_str",
          "args": [],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v->asList",
          "args": [],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "asList",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "179-189",
          "snippet": "YCPList\nYCPValueRep::asList() const\n{\n    if (!isList())\n    {\n\tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not List!\",\n\t      toString().c_str());\n\tabort();\n    }\n    return YCPList (static_cast<const YCPListRep *>(this));\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  YCPList\n  YCPValueRep::asList() const\n  {\n      if (!isList())\n      {\n  \tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not List!\",\n  \t      toString().c_str());\n  \tabort();\n      }\n      return YCPList (static_cast<const YCPListRep *>(this));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "v->isList",
          "args": [],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "isList",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "69-69",
          "snippet": "bool YCPValueRep::isList()        const { return valuetype() == YT_LIST; }",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  bool YCPValueRep::isList()        const { return valuetype() == YT_LIST; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nstatic\nYCPList as_list (const YCPValue& v, const char * context)\n{\n    if (v->isList ())\n\treturn v->asList ();\n    ycp2error (\"Expected a list for %s, got %s %s\",\n\t       context, v->valuetype_str(), v->toString().c_str());\n    return YCPNull ();\n}"
  },
  {
    "function_name": "to_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/agent-ini/src/IniFile.cc",
    "lines": "29-37",
    "snippet": "string to_string (const YCPValue&v)\n{\n    string s;\n    if (v->isString ())\n\ts = v->asString ()->value ();\n    else\n\ts = v->toString ();\n    return s;\n}",
    "includes": [
      "#include \"IniParser.h\"",
      "#include \"IniFile.h\"",
      "#include <cassert>",
      "#include <set>",
      "#include <ctype.h>",
      "#include <stdio.h>",
      "#include <ycp/y2log.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "v->toString",
          "args": [],
          "line": 35
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "YBreakpoint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YBreakpoint.cc",
          "lines": "87-91",
          "snippet": "string\nYBreakpoint::toString() const\n{\n    return m_code->toString ();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YBreakpoint.h\"",
            "#include <debugger/Debugger.h>",
            "#include <libintl.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YBreakpoint.h\"\n#include <debugger/Debugger.h>\n#include <libintl.h>\n\nYBreakpoint {\n  string\n  YBreakpoint::toString() const\n  {\n      return m_code->toString ();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "v->asString",
          "args": [],
          "line": 33
        },
        "resolved": true,
        "details": {
          "function_name": "asString",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "130-140",
          "snippet": "YCPString\nYCPValueRep::asString() const\n{\n    if (!isString())\n    {\n\tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n\t      toString().c_str());\n\tabort();\n    }\n    return YCPString (static_cast<const YCPStringRep *>(this));\n}",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  YCPString\n  YCPValueRep::asString() const\n  {\n      if (!isString())\n      {\n  \tycp2error(\"Invalid cast of YCP value '%s'! Should be but is not String!\",\n  \t      toString().c_str());\n  \tabort();\n      }\n      return YCPString (static_cast<const YCPStringRep *>(this));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "v->isString",
          "args": [],
          "line": 32
        },
        "resolved": true,
        "details": {
          "function_name": "isString",
          "container": "YCPValueRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPValue.cc",
          "lines": "65-65",
          "snippet": "bool YCPValueRep::isString()      const { return valuetype() == YT_STRING; }",
          "includes": [
            "#include \"ycp/YCPExternal.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPSymbol.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/YCPByteblock.h\"",
            "#include \"ycp/YCPString.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/YCPExternal.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPSymbol.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/YCPByteblock.h\"\n#include \"ycp/YCPString.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/y2log.h\"\n\nYCPValueRep {\n  bool YCPValueRep::isString()      const { return valuetype() == YT_STRING; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"IniParser.h\"\n#include \"IniFile.h\"\n#include <cassert>\n#include <set>\n#include <ctype.h>\n#include <stdio.h>\n#include <ycp/y2log.h>\n\nstring to_string (const YCPValue&v)\n{\n    string s;\n    if (v->isString ())\n\ts = v->asString ()->value ();\n    else\n\ts = v->toString ();\n    return s;\n}"
  }
]