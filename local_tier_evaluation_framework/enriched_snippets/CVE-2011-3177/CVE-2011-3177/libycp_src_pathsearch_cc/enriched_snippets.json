[
  {
    "function_name": "bytecodeForFile",
    "container": "YCPPathSearch",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
    "lines": "370-414",
    "snippet": "string\nYCPPathSearch::bytecodeForFile (string filename)\n{\n    y2debug (\"Testing existence of bytecode for %s\", filename.c_str() );\n    string ybc;\n    \n    // check the YCP extension\n    if (filename.find_last_of (\"ycp\") == filename.length ()-1)\n    {\n\tybc = filename;\n\tybc[ filename.length()-2 ] = 'b';\n\tybc[ filename.length()-1 ] = 'c';\n    }\n    else\n    {\n\t// no extension, no ybc lookup\n\treturn \"\";\n    }\n    \n    // check the modification times\n    struct stat file_stat;\n    if (stat (ybc.c_str (), &file_stat) != 0 || ! S_ISREG(file_stat.st_mode))\n    {\n\t// return empty file\n\treturn \"\";\n    }\n    time_t ybc_time = file_stat.st_mtime;\n    \n    if (stat (filename.c_str (), &file_stat) != 0 || ! S_ISREG(file_stat.st_mode))\n    {\n\t// return empty file\n\treturn \"\";\n    }\n    \n    time_t ycp_time = file_stat.st_mtime;\n    \n    // compare the times\n    if (ycp_time > ybc_time)\n    {\n\t// too new\n\treturn \"\";\n    }\n    \n    return ybc;\n}",
    "includes": [
      "#include \"pathsearch.h\"",
      "#include <ycp/y2log.h>",
      "#include <boost/algorithm/string.hpp>",
      "#include <unistd.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "S_ISREG",
          "args": [
            "file_stat.st_mode"
          ],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stat",
          "args": [
            "filename.c_str ()",
            "&file_stat"
          ],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filename.c_str",
          "args": [],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISREG",
          "args": [
            "file_stat.st_mode"
          ],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stat",
          "args": [
            "ybc.c_str ()",
            "&file_stat"
          ],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ybc.c_str",
          "args": [],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filename.length",
          "args": [],
          "line": 381
        },
        "resolved": true,
        "details": {
          "function_name": "length",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "124-128",
          "snippet": "long\nYCPPathRep::length() const\n{\n    return components.size();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  long\n  YCPPathRep::length() const\n  {\n      return components.size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "filename.find_last_of",
          "args": [
            "\"ycp\""
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Testing existence of bytecode for %s\"",
            "filename.c_str()"
          ],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filename.c_str",
          "args": [],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nYCPPathSearch {\n  string\n  YCPPathSearch::bytecodeForFile (string filename)\n  {\n      y2debug (\"Testing existence of bytecode for %s\", filename.c_str() );\n      string ybc;\n      \n      // check the YCP extension\n      if (filename.find_last_of (\"ycp\") == filename.length ()-1)\n      {\n  \tybc = filename;\n  \tybc[ filename.length()-2 ] = 'b';\n  \tybc[ filename.length()-1 ] = 'c';\n      }\n      else\n      {\n  \t// no extension, no ybc lookup\n  \treturn \"\";\n      }\n      \n      // check the modification times\n      struct stat file_stat;\n      if (stat (ybc.c_str (), &file_stat) != 0 || ! S_ISREG(file_stat.st_mode))\n      {\n  \t// return empty file\n  \treturn \"\";\n      }\n      time_t ybc_time = file_stat.st_mtime;\n      \n      if (stat (filename.c_str (), &file_stat) != 0 || ! S_ISREG(file_stat.st_mode))\n      {\n  \t// return empty file\n  \treturn \"\";\n      }\n      \n      time_t ycp_time = file_stat.st_mtime;\n      \n      // compare the times\n      if (ycp_time > ybc_time)\n      {\n  \t// too new\n  \treturn \"\";\n      }\n      \n      return ybc;\n  }\n}"
  },
  {
    "function_name": " searchListEnd",
    "container": "YCPPathSearch",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
    "lines": "364-368",
    "snippet": "std::list<string>::const_iterator\nYCPPathSearch:: searchListEnd (Kind kind)\n{\n    return searchList[kind].end ();\n}",
    "includes": [
      "#include \"pathsearch.h\"",
      "#include <ycp/y2log.h>",
      "#include <boost/algorithm/string.hpp>",
      "#include <unistd.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "std::list<string> YCPPathSearch::searchList[YCPPathSearch::num_Kind];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "searchList[kind].end",
          "args": [],
          "line": 367
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "43-47",
          "snippet": "YCPMapIterator\nYCPMapRep::end() const\n{\n    return stl_map.end();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::end() const\n  {\n      return stl_map.end();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nstd::list<string> YCPPathSearch::searchList[YCPPathSearch::num_Kind];\n\nYCPPathSearch {\n  std::list<string>::const_iterator\n  YCPPathSearch:: searchListEnd (Kind kind)\n  {\n      return searchList[kind].end ();\n  }\n}"
  },
  {
    "function_name": " searchListBegin",
    "container": "YCPPathSearch",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
    "lines": "358-362",
    "snippet": "std::list<string>::const_iterator\nYCPPathSearch:: searchListBegin (Kind kind)\n{\n    return searchList[kind].begin ();\n}",
    "includes": [
      "#include \"pathsearch.h\"",
      "#include <ycp/y2log.h>",
      "#include <boost/algorithm/string.hpp>",
      "#include <unistd.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "std::list<string> YCPPathSearch::searchList[YCPPathSearch::num_Kind];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "searchList[kind].begin",
          "args": [],
          "line": 361
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "36-40",
          "snippet": "YCPMapIterator\nYCPMapRep::begin() const\n{\n    return stl_map.begin();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::begin() const\n  {\n      return stl_map.begin();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nstd::list<string> YCPPathSearch::searchList[YCPPathSearch::num_Kind];\n\nYCPPathSearch {\n  std::list<string>::const_iterator\n  YCPPathSearch:: searchListBegin (Kind kind)\n  {\n      return searchList[kind].begin ();\n  }\n}"
  },
  {
    "function_name": "clearPaths",
    "container": "YCPPathSearch",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
    "lines": "352-356",
    "snippet": "void\nYCPPathSearch::clearPaths (Kind kind)\n{\n    searchList[kind].clear();\n}",
    "includes": [
      "#include \"pathsearch.h\"",
      "#include <ycp/y2log.h>",
      "#include <boost/algorithm/string.hpp>",
      "#include <unistd.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "std::list<string> YCPPathSearch::searchList[YCPPathSearch::num_Kind];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "searchList[kind].clear",
          "args": [],
          "line": 355
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/PathInfo.h",
          "lines": "461-461",
          "snippet": "void clear() { _devino.clear(); }",
          "includes": [
            "#include <y2util/Pathname.h>",
            "#include <map>",
            "#include <set>",
            "#include <list>",
            "#include <iosfwd>",
            "#include <cerrno>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/Pathname.h>\n#include <map>\n#include <set>\n#include <list>\n#include <iosfwd>\n#include <cerrno>\n#include <dirent.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n\nvoid clear() { _devino.clear(); }"
        }
      }
    ],
    "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nstd::list<string> YCPPathSearch::searchList[YCPPathSearch::num_Kind];\n\nYCPPathSearch {\n  void\n  YCPPathSearch::clearPaths (Kind kind)\n  {\n      searchList[kind].clear();\n  }\n}"
  },
  {
    "function_name": "addPath",
    "container": "YCPPathSearch",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
    "lines": "343-349",
    "snippet": "void\nYCPPathSearch::addPath (Kind kind, const string& path)\n{\n    std::list<string>& l = searchList[kind];\n    if (std::find(l.begin(), l.end(), path) == l.end())\n\tl.push_front(path);\n}",
    "includes": [
      "#include \"pathsearch.h\"",
      "#include <ycp/y2log.h>",
      "#include <boost/algorithm/string.hpp>",
      "#include <unistd.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "std::list<string> YCPPathSearch::searchList[YCPPathSearch::num_Kind];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "l.push_front",
          "args": [
            "path"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "l.end",
          "args": [],
          "line": 347
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "43-47",
          "snippet": "YCPMapIterator\nYCPMapRep::end() const\n{\n    return stl_map.end();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::end() const\n  {\n      return stl_map.end();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::find",
          "args": [
            "l.begin()",
            "l.end()",
            "path"
          ],
          "line": 347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "l.begin",
          "args": [],
          "line": 347
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "36-40",
          "snippet": "YCPMapIterator\nYCPMapRep::begin() const\n{\n    return stl_map.begin();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::begin() const\n  {\n      return stl_map.begin();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nstd::list<string> YCPPathSearch::searchList[YCPPathSearch::num_Kind];\n\nYCPPathSearch {\n  void\n  YCPPathSearch::addPath (Kind kind, const string& path)\n  {\n      std::list<string>& l = searchList[kind];\n      if (std::find(l.begin(), l.end(), path) == l.end())\n  \tl.push_front(path);\n  }\n}"
  },
  {
    "function_name": "findModule",
    "container": "YCPPathSearch",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
    "lines": "331-340",
    "snippet": "string\nYCPPathSearch::findModule (string name, bool the_source)\n{\n    string extension = (the_source ? \".ycp\" : \".ybc\");\n    if (!boost::ends_with(name, extension))\n    {\n\tname += extension;\n    }\n    return find (Module, name);\n}",
    "includes": [
      "#include \"pathsearch.h\"",
      "#include <ycp/y2log.h>",
      "#include <boost/algorithm/string.hpp>",
      "#include <unistd.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "find",
          "args": [
            "Module",
            "name"
          ],
          "line": 339
        },
        "resolved": true,
        "details": {
          "function_name": "findModule",
          "container": "YCPPathSearch",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
          "lines": "331-340",
          "snippet": "string\nYCPPathSearch::findModule (string name, bool the_source)\n{\n    string extension = (the_source ? \".ycp\" : \".ybc\");\n    if (!boost::ends_with(name, extension))\n    {\n\tname += extension;\n    }\n    return find (Module, name);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "boost::ends_with",
          "args": [
            "name",
            "extension"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nYCPPathSearch {\n  string\n  YCPPathSearch::findModule (string name, bool the_source)\n  {\n      string extension = (the_source ? \".ycp\" : \".ybc\");\n      if (!boost::ends_with(name, extension))\n      {\n  \tname += extension;\n      }\n      return find (Module, name);\n  }\n}"
  },
  {
    "function_name": "findInclude",
    "container": "YCPPathSearch",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
    "lines": "324-328",
    "snippet": "string\nYCPPathSearch::findInclude (const string& name)\n{\n    return find (Include, name);\n}",
    "includes": [
      "#include \"pathsearch.h\"",
      "#include <ycp/y2log.h>",
      "#include <boost/algorithm/string.hpp>",
      "#include <unistd.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "find",
          "args": [
            "Include",
            "name"
          ],
          "line": 327
        },
        "resolved": true,
        "details": {
          "function_name": "findModule",
          "container": "YCPPathSearch",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
          "lines": "331-340",
          "snippet": "string\nYCPPathSearch::findModule (string name, bool the_source)\n{\n    string extension = (the_source ? \".ycp\" : \".ybc\");\n    if (!boost::ends_with(name, extension))\n    {\n\tname += extension;\n    }\n    return find (Module, name);\n}",
          "includes": [
            "#include \"pathsearch.h\"",
            "#include <ycp/y2log.h>",
            "#include <boost/algorithm/string.hpp>",
            "#include <unistd.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nYCPPathSearch {\n  string\n  YCPPathSearch::findModule (string name, bool the_source)\n  {\n      string extension = (the_source ? \".ycp\" : \".ybc\");\n      if (!boost::ends_with(name, extension))\n      {\n  \tname += extension;\n      }\n      return find (Module, name);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nYCPPathSearch {\n  string\n  YCPPathSearch::findInclude (const string& name)\n  {\n      return find (Include, name);\n  }\n}"
  },
  {
    "function_name": "find",
    "container": "YCPPathSearch",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
    "lines": "287-321",
    "snippet": "string\nYCPPathSearch::find (Kind kind, const string& name)\n{\n    if (name[0] == '.'\n\t&& name[1] == '/')\n    {\n\tif (access (name.c_str(), R_OK) == 0)\n\t{\n\t    return name;\n\t}\n\treturn \"\";\n    }\n\n    initialize ();\n\n    std::list<string>& kindList = searchList[kind];\n    std::list<string>::iterator i = kindList.begin (), e = kindList.end ();\n    while (i != e)\n    {\n\tstring pathname = completeFilename (*i + '/' + name);\n\ty2debug (\"trying %s\", pathname.c_str ());\n\tif (access (pathname.c_str(), R_OK) == 0)\n\t{\n\t    y2debug (\"... success\");\n\t    // FIXME: this check is different for clients and for modules - see findy2\n\t    if( searchPrefixWarn && *i != kindList.back () ) {\n\t\ty2warning( \"Using special search prefix '%s' for '%s'\", i->c_str(), pathname.c_str() );\n\t    }\n\t    return pathname;\n\t}\n\n\t++i;\n    }\n    return \"\";\n}",
    "includes": [
      "#include \"pathsearch.h\"",
      "#include <ycp/y2log.h>",
      "#include <boost/algorithm/string.hpp>",
      "#include <unistd.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "bool Y2PathSearch::searchPrefixWarn = true;",
      "std::list<string> YCPPathSearch::searchList[YCPPathSearch::num_Kind];"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "y2warning",
          "args": [
            "\"Using special search prefix '%s' for '%s'\"",
            "i->c_str()",
            "pathname.c_str()"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pathname.c_str",
          "args": [],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->c_str",
          "args": [],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kindList.back",
          "args": [],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"... success\""
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "access",
          "args": [
            "pathname.c_str()",
            "R_OK"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pathname.c_str",
          "args": [],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"trying %s\"",
            "pathname.c_str ()"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pathname.c_str",
          "args": [],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "completeFilename",
          "args": [
            "*i + '/' + name"
          ],
          "line": 306
        },
        "resolved": true,
        "details": {
          "function_name": "completeFilename",
          "container": "Y2PathSearch",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
          "lines": "131-139",
          "snippet": "string\nY2PathSearch::completeFilename (const string& fname)\n{\n    string slashes = boost::replace_all_copy(fname, \"::\", \"/\");\n    char* cfn = canonicalize_file_name (slashes.c_str ());\n    string ret = cfn ? string (cfn) : fname;\n    free (cfn);\n    return ret;\n}",
          "includes": [
            "#include \"pathsearch.h\"",
            "#include <ycp/y2log.h>",
            "#include <boost/algorithm/string.hpp>",
            "#include <unistd.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nY2PathSearch {\n  string\n  Y2PathSearch::completeFilename (const string& fname)\n  {\n      string slashes = boost::replace_all_copy(fname, \"::\", \"/\");\n      char* cfn = canonicalize_file_name (slashes.c_str ());\n      string ret = cfn ? string (cfn) : fname;\n      free (cfn);\n      return ret;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kindList.end",
          "args": [],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "43-47",
          "snippet": "YCPMapIterator\nYCPMapRep::end() const\n{\n    return stl_map.end();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::end() const\n  {\n      return stl_map.end();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kindList.begin",
          "args": [],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "36-40",
          "snippet": "YCPMapIterator\nYCPMapRep::begin() const\n{\n    return stl_map.begin();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::begin() const\n  {\n      return stl_map.begin();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "initialize",
          "args": [],
          "line": 300
        },
        "resolved": true,
        "details": {
          "function_name": "initialize",
          "container": "YCPPathSearch",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
          "lines": "274-284",
          "snippet": "void\nYCPPathSearch::initialize ()\n{\n    if (! initialized)\n    {\n\tinitialize (Client, \"/clients\");\n\tinitialize (Include, \"/include\");\n\tinitialize (Module, \"/modules\");\n\tinitialized = true;\n    }\n}",
          "includes": [
            "#include \"pathsearch.h\"",
            "#include <ycp/y2log.h>",
            "#include <boost/algorithm/string.hpp>",
            "#include <unistd.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "bool YCPPathSearch::initialized = false;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nbool YCPPathSearch::initialized = false;\n\nYCPPathSearch {\n  void\n  YCPPathSearch::initialize ()\n  {\n      if (! initialized)\n      {\n  \tinitialize (Client, \"/clients\");\n  \tinitialize (Include, \"/include\");\n  \tinitialize (Module, \"/modules\");\n  \tinitialized = true;\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "access",
          "args": [
            "name.c_str()",
            "R_OK"
          ],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "name.c_str",
          "args": [],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nbool Y2PathSearch::searchPrefixWarn = true;\nstd::list<string> YCPPathSearch::searchList[YCPPathSearch::num_Kind];\n\nYCPPathSearch {\n  string\n  YCPPathSearch::find (Kind kind, const string& name)\n  {\n      if (name[0] == '.'\n  \t&& name[1] == '/')\n      {\n  \tif (access (name.c_str(), R_OK) == 0)\n  \t{\n  \t    return name;\n  \t}\n  \treturn \"\";\n      }\n  \n      initialize ();\n  \n      std::list<string>& kindList = searchList[kind];\n      std::list<string>::iterator i = kindList.begin (), e = kindList.end ();\n      while (i != e)\n      {\n  \tstring pathname = completeFilename (*i + '/' + name);\n  \ty2debug (\"trying %s\", pathname.c_str ());\n  \tif (access (pathname.c_str(), R_OK) == 0)\n  \t{\n  \t    y2debug (\"... success\");\n  \t    // FIXME: this check is different for clients and for modules - see findy2\n  \t    if( searchPrefixWarn && *i != kindList.back () ) {\n  \t\ty2warning( \"Using special search prefix '%s' for '%s'\", i->c_str(), pathname.c_str() );\n  \t    }\n  \t    return pathname;\n  \t}\n  \n  \t++i;\n      }\n      return \"\";\n  }\n}"
  },
  {
    "function_name": "initialize",
    "container": "YCPPathSearch",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
    "lines": "274-284",
    "snippet": "void\nYCPPathSearch::initialize ()\n{\n    if (! initialized)\n    {\n\tinitialize (Client, \"/clients\");\n\tinitialize (Include, \"/include\");\n\tinitialize (Module, \"/modules\");\n\tinitialized = true;\n    }\n}",
    "includes": [
      "#include \"pathsearch.h\"",
      "#include <ycp/y2log.h>",
      "#include <boost/algorithm/string.hpp>",
      "#include <unistd.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "bool YCPPathSearch::initialized = false;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "initialize",
          "args": [
            "Module",
            "\"/modules\""
          ],
          "line": 281
        },
        "resolved": true,
        "details": {
          "function_name": "initialize",
          "container": "YCPPathSearch",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
          "lines": "263-271",
          "snippet": "void\nYCPPathSearch::initialize (Kind kind, const char *suffix)\n{\n    searchPrefixWarn = (getenv (\"Y2SILENTSEARCH\") == NULL);\n\n    vector<string> paths = getPaths();\n    for (vector<string>::const_reverse_iterator it = paths.rbegin(); it != paths.rend(); ++it)\n\taddPath(kind, *it + suffix);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nbool YCPPathSearch::initialized = false;\n\nYCPPathSearch {\n  void\n  YCPPathSearch::initialize ()\n  {\n      if (! initialized)\n      {\n  \tinitialize (Client, \"/clients\");\n  \tinitialize (Include, \"/include\");\n  \tinitialize (Module, \"/modules\");\n  \tinitialized = true;\n      }\n  }\n}"
  },
  {
    "function_name": "initialize",
    "container": "YCPPathSearch",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
    "lines": "263-271",
    "snippet": "void\nYCPPathSearch::initialize (Kind kind, const char *suffix)\n{\n    searchPrefixWarn = (getenv (\"Y2SILENTSEARCH\") == NULL);\n\n    vector<string> paths = getPaths();\n    for (vector<string>::const_reverse_iterator it = paths.rbegin(); it != paths.rend(); ++it)\n\taddPath(kind, *it + suffix);\n}",
    "includes": [
      "#include \"pathsearch.h\"",
      "#include <ycp/y2log.h>",
      "#include <boost/algorithm/string.hpp>",
      "#include <unistd.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "bool Y2PathSearch::searchPrefixWarn = true;",
      "vector<string> Y2PathSearch::paths;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "addPath",
          "args": [
            "kind",
            "*it + suffix"
          ],
          "line": 270
        },
        "resolved": true,
        "details": {
          "function_name": "addPath",
          "container": "YCPPathSearch",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
          "lines": "343-349",
          "snippet": "void\nYCPPathSearch::addPath (Kind kind, const string& path)\n{\n    std::list<string>& l = searchList[kind];\n    if (std::find(l.begin(), l.end(), path) == l.end())\n\tl.push_front(path);\n}",
          "includes": [
            "#include \"pathsearch.h\"",
            "#include <ycp/y2log.h>",
            "#include <boost/algorithm/string.hpp>",
            "#include <unistd.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "std::list<string> YCPPathSearch::searchList[YCPPathSearch::num_Kind];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nstd::list<string> YCPPathSearch::searchList[YCPPathSearch::num_Kind];\n\nYCPPathSearch {\n  void\n  YCPPathSearch::addPath (Kind kind, const string& path)\n  {\n      std::list<string>& l = searchList[kind];\n      if (std::find(l.begin(), l.end(), path) == l.end())\n  \tl.push_front(path);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "paths.rend",
          "args": [],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "paths.rbegin",
          "args": [],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getPaths",
          "args": [],
          "line": 268
        },
        "resolved": true,
        "details": {
          "function_name": "getPaths",
          "container": "Y2PathSearch",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
          "lines": "41-71",
          "snippet": "vector<string>\nY2PathSearch::getPaths()\n{\n    vector<string> ret;\n\n    ret.push_back(string(\"/y2update\"));\n\n    const char* y2dir = getenv(\"Y2DIR\");\n    if (y2dir)\n    {\n\tvector<string> y2dirs;\n\tboost::split(y2dirs, y2dir, boost::is_any_of(\":\"));\n\tfor (vector<string>::const_iterator it = y2dirs.begin(); it != y2dirs.end(); ++it)\n\t{\n\t    if (*it != YAST2DIR)\t\t// prevent path duplication\n\t\tret.push_back(*it);\n\t}\n    }\n\n    const char* home = getenv(\"HOME\");\n    if (home)\n    {\n\tret.push_back(string(home) + \"/.yast2\");\n    }\n\n    ret.push_back(string(YAST2DIR));\n\n    y2debug(\"getPaths %s\", boost::join(ret, \" \").c_str());\n\n    return ret;\n}",
          "includes": [
            "#include \"pathsearch.h\"",
            "#include <ycp/y2log.h>",
            "#include <boost/algorithm/string.hpp>",
            "#include <unistd.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nY2PathSearch {\n  vector<string>\n  Y2PathSearch::getPaths()\n  {\n      vector<string> ret;\n  \n      ret.push_back(string(\"/y2update\"));\n  \n      const char* y2dir = getenv(\"Y2DIR\");\n      if (y2dir)\n      {\n  \tvector<string> y2dirs;\n  \tboost::split(y2dirs, y2dir, boost::is_any_of(\":\"));\n  \tfor (vector<string>::const_iterator it = y2dirs.begin(); it != y2dirs.end(); ++it)\n  \t{\n  \t    if (*it != YAST2DIR)\t\t// prevent path duplication\n  \t\tret.push_back(*it);\n  \t}\n      }\n  \n      const char* home = getenv(\"HOME\");\n      if (home)\n      {\n  \tret.push_back(string(home) + \"/.yast2\");\n      }\n  \n      ret.push_back(string(YAST2DIR));\n  \n      y2debug(\"getPaths %s\", boost::join(ret, \" \").c_str());\n  \n      return ret;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"Y2SILENTSEARCH\""
          ],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nbool Y2PathSearch::searchPrefixWarn = true;\nvector<string> Y2PathSearch::paths;\n\nYCPPathSearch {\n  void\n  YCPPathSearch::initialize (Kind kind, const char *suffix)\n  {\n      searchPrefixWarn = (getenv (\"Y2SILENTSEARCH\") == NULL);\n  \n      vector<string> paths = getPaths();\n      for (vector<string>::const_reverse_iterator it = paths.rbegin(); it != paths.rend(); ++it)\n  \taddPath(kind, *it + suffix);\n  }\n}"
  },
  {
    "function_name": "currentComponentLevel",
    "container": "Y2PathSearch",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
    "lines": "244-255",
    "snippet": "int\nY2PathSearch::currentComponentLevel ()\n{\n    // Determine current component level\n    int current_level = defaultComponentLevel ();\n    const char* levelstring = getenv (\"Y2LEVEL\");\n    if (levelstring)\n    {\n\tcurrent_level = atoi (levelstring);\n    }\n    return current_level;\n}",
    "includes": [
      "#include \"pathsearch.h\"",
      "#include <ycp/y2log.h>",
      "#include <boost/algorithm/string.hpp>",
      "#include <unistd.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atoi",
          "args": [
            "levelstring"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"Y2LEVEL\""
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "defaultComponentLevel",
          "args": [],
          "line": 248
        },
        "resolved": true,
        "details": {
          "function_name": "defaultComponentLevel",
          "container": "Y2PathSearch",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
          "lines": "226-241",
          "snippet": "int\nY2PathSearch::defaultComponentLevel ()\n{\n    initializePaths();\n\n    int levels = paths.size();\n    for (int i = 0; i < levels; i++)\n    {\n\tif (searchPath (GENERIC, i) == YAST2DIR)\n\t{\n\t    return i;\n\t}\n    }\n    /* NOTREACHED */\n    return levels - 1;\n}",
          "includes": [
            "#include \"pathsearch.h\"",
            "#include <ycp/y2log.h>",
            "#include <boost/algorithm/string.hpp>",
            "#include <unistd.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "vector<string> Y2PathSearch::paths;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nvector<string> Y2PathSearch::paths;\n\nY2PathSearch {\n  int\n  Y2PathSearch::defaultComponentLevel ()\n  {\n      initializePaths();\n  \n      int levels = paths.size();\n      for (int i = 0; i < levels; i++)\n      {\n  \tif (searchPath (GENERIC, i) == YAST2DIR)\n  \t{\n  \t    return i;\n  \t}\n      }\n      /* NOTREACHED */\n      return levels - 1;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nY2PathSearch {\n  int\n  Y2PathSearch::currentComponentLevel ()\n  {\n      // Determine current component level\n      int current_level = defaultComponentLevel ();\n      const char* levelstring = getenv (\"Y2LEVEL\");\n      if (levelstring)\n      {\n  \tcurrent_level = atoi (levelstring);\n      }\n      return current_level;\n  }\n}"
  },
  {
    "function_name": "defaultComponentLevel",
    "container": "Y2PathSearch",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
    "lines": "226-241",
    "snippet": "int\nY2PathSearch::defaultComponentLevel ()\n{\n    initializePaths();\n\n    int levels = paths.size();\n    for (int i = 0; i < levels; i++)\n    {\n\tif (searchPath (GENERIC, i) == YAST2DIR)\n\t{\n\t    return i;\n\t}\n    }\n    /* NOTREACHED */\n    return levels - 1;\n}",
    "includes": [
      "#include \"pathsearch.h\"",
      "#include <ycp/y2log.h>",
      "#include <boost/algorithm/string.hpp>",
      "#include <unistd.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "vector<string> Y2PathSearch::paths;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "searchPath",
          "args": [
            "GENERIC",
            "i"
          ],
          "line": 234
        },
        "resolved": true,
        "details": {
          "function_name": "searchPath",
          "container": "Y2PathSearch",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
          "lines": "93-128",
          "snippet": "string\nY2PathSearch::searchPath (WHAT what, int level)\n{\n    initializePaths();\n\n    int levels = paths.size();\n\n    switch (what)\n    {\n\tcase EXECCOMP:\n\t    if (level == levels - 1) // FIXME\n\t    {\n\t\treturn EXECCOMPDIR;\n\t    }\n\t    else\n\t    {\n\t\treturn paths[level];\n\t    }\n\tbreak;\n\n\tcase PLUGIN:\n\t    if (level == levels - 1) // FIXME\n\t    {\n\t\treturn PLUGINDIR;\n\t    }\n\t    else\n\t    {\n\t\treturn paths[level] + \"/plugin\";\n\t    }\n\tbreak;\n\n\tdefault:\n\tbreak;\n    }\n    return paths[level];\n}",
          "includes": [
            "#include \"pathsearch.h\"",
            "#include <ycp/y2log.h>",
            "#include <boost/algorithm/string.hpp>",
            "#include <unistd.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "vector<string> Y2PathSearch::paths;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nvector<string> Y2PathSearch::paths;\n\nY2PathSearch {\n  string\n  Y2PathSearch::searchPath (WHAT what, int level)\n  {\n      initializePaths();\n  \n      int levels = paths.size();\n  \n      switch (what)\n      {\n  \tcase EXECCOMP:\n  \t    if (level == levels - 1) // FIXME\n  \t    {\n  \t\treturn EXECCOMPDIR;\n  \t    }\n  \t    else\n  \t    {\n  \t\treturn paths[level];\n  \t    }\n  \tbreak;\n  \n  \tcase PLUGIN:\n  \t    if (level == levels - 1) // FIXME\n  \t    {\n  \t\treturn PLUGINDIR;\n  \t    }\n  \t    else\n  \t    {\n  \t\treturn paths[level] + \"/plugin\";\n  \t    }\n  \tbreak;\n  \n  \tdefault:\n  \tbreak;\n      }\n      return paths[level];\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "paths.size",
          "args": [],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "109-113",
          "snippet": "int\nYCPTermRep::size() const\n{\n    return l->size();\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  int\n  YCPTermRep::size() const\n  {\n      return l->size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "initializePaths",
          "args": [],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "initializePaths",
          "container": "Y2PathSearch",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
          "lines": "77-82",
          "snippet": "void\nY2PathSearch::initializePaths()\n{\n    if (paths.empty())\n\tpaths = getPaths();\n}",
          "includes": [
            "#include \"pathsearch.h\"",
            "#include <ycp/y2log.h>",
            "#include <boost/algorithm/string.hpp>",
            "#include <unistd.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "vector<string> Y2PathSearch::paths;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nvector<string> Y2PathSearch::paths;\n\nY2PathSearch {\n  void\n  Y2PathSearch::initializePaths()\n  {\n      if (paths.empty())\n  \tpaths = getPaths();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nvector<string> Y2PathSearch::paths;\n\nY2PathSearch {\n  int\n  Y2PathSearch::defaultComponentLevel ()\n  {\n      initializePaths();\n  \n      int levels = paths.size();\n      for (int i = 0; i < levels; i++)\n      {\n  \tif (searchPath (GENERIC, i) == YAST2DIR)\n  \t{\n  \t    return i;\n  \t}\n      }\n      /* NOTREACHED */\n      return levels - 1;\n  }\n}"
  },
  {
    "function_name": "findy2plugin",
    "container": "Y2PathSearch",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
    "lines": "205-223",
    "snippet": "string\nY2PathSearch::findy2plugin (string name, int level)\n{\n    // All plugins must follow this naming convention.\n    string filename = searchPath (PLUGIN, level) + \"/libpy2\" + name + \".so.2\";\n    \n    y2debug (\"Testing existence of plugin %s\", filename.c_str ());\n\n    // Check if it is a regular file.\n    struct stat buf;\n    if (stat (filename.c_str (), &buf) == 0)\n    {\n\tif (S_ISREG (buf.st_mode))\n\t{\n\t    return filename;\n\t}\n    }\n    return \"\";\n}",
    "includes": [
      "#include \"pathsearch.h\"",
      "#include <ycp/y2log.h>",
      "#include <boost/algorithm/string.hpp>",
      "#include <unistd.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "S_ISREG",
          "args": [
            "buf.st_mode"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stat",
          "args": [
            "filename.c_str ()",
            "&buf"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filename.c_str",
          "args": [],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Testing existence of plugin %s\"",
            "filename.c_str ()"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filename.c_str",
          "args": [],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "searchPath",
          "args": [
            "PLUGIN",
            "level"
          ],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "searchPath",
          "container": "Y2PathSearch",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
          "lines": "93-128",
          "snippet": "string\nY2PathSearch::searchPath (WHAT what, int level)\n{\n    initializePaths();\n\n    int levels = paths.size();\n\n    switch (what)\n    {\n\tcase EXECCOMP:\n\t    if (level == levels - 1) // FIXME\n\t    {\n\t\treturn EXECCOMPDIR;\n\t    }\n\t    else\n\t    {\n\t\treturn paths[level];\n\t    }\n\tbreak;\n\n\tcase PLUGIN:\n\t    if (level == levels - 1) // FIXME\n\t    {\n\t\treturn PLUGINDIR;\n\t    }\n\t    else\n\t    {\n\t\treturn paths[level] + \"/plugin\";\n\t    }\n\tbreak;\n\n\tdefault:\n\tbreak;\n    }\n    return paths[level];\n}",
          "includes": [
            "#include \"pathsearch.h\"",
            "#include <ycp/y2log.h>",
            "#include <boost/algorithm/string.hpp>",
            "#include <unistd.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "vector<string> Y2PathSearch::paths;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nvector<string> Y2PathSearch::paths;\n\nY2PathSearch {\n  string\n  Y2PathSearch::searchPath (WHAT what, int level)\n  {\n      initializePaths();\n  \n      int levels = paths.size();\n  \n      switch (what)\n      {\n  \tcase EXECCOMP:\n  \t    if (level == levels - 1) // FIXME\n  \t    {\n  \t\treturn EXECCOMPDIR;\n  \t    }\n  \t    else\n  \t    {\n  \t\treturn paths[level];\n  \t    }\n  \tbreak;\n  \n  \tcase PLUGIN:\n  \t    if (level == levels - 1) // FIXME\n  \t    {\n  \t\treturn PLUGINDIR;\n  \t    }\n  \t    else\n  \t    {\n  \t\treturn paths[level] + \"/plugin\";\n  \t    }\n  \tbreak;\n  \n  \tdefault:\n  \tbreak;\n      }\n      return paths[level];\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nY2PathSearch {\n  string\n  Y2PathSearch::findy2plugin (string name, int level)\n  {\n      // All plugins must follow this naming convention.\n      string filename = searchPath (PLUGIN, level) + \"/libpy2\" + name + \".so.2\";\n      \n      y2debug (\"Testing existence of plugin %s\", filename.c_str ());\n  \n      // Check if it is a regular file.\n      struct stat buf;\n      if (stat (filename.c_str (), &buf) == 0)\n      {\n  \tif (S_ISREG (buf.st_mode))\n  \t{\n  \t    return filename;\n  \t}\n      }\n      return \"\";\n  }\n}"
  },
  {
    "function_name": "findy2exe",
    "container": "Y2PathSearch",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
    "lines": "173-202",
    "snippet": "string\nY2PathSearch::findy2exe (string root, string compname, bool server,\n\t\t\t bool non_y2, int level)\n{\n    string subdir;\n    if (server)\n    {\n\tsubdir = (non_y2 ? \"/servers_non_y2/\" : \"/servers/\");\n    }\n    else\n    {\n\tsubdir = (non_y2 ? \"/clients_non_y2/\" : \"/clients/\");\n    }\n    string pathname = root + searchPath (EXECCOMP, level) + subdir + compname;\n    \n    y2debug (\"Trying file %s\", pathname.c_str ());\n    \n    struct stat buf;\n    if (stat (pathname.c_str (), &buf) == 0)\n    {\n\t// Check at least if it is executable (for others) and\n\t// if it is a regular file.\n\tif (S_ISREG (buf.st_mode) && (buf.st_mode & S_IXOTH == S_IXOTH))\n\t{\n\t    return pathname;\n\t}\n    }\n\n    return \"\";\n}",
    "includes": [
      "#include \"pathsearch.h\"",
      "#include <ycp/y2log.h>",
      "#include <boost/algorithm/string.hpp>",
      "#include <unistd.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "S_ISREG",
          "args": [
            "buf.st_mode"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stat",
          "args": [
            "pathname.c_str ()",
            "&buf"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pathname.c_str",
          "args": [],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"Trying file %s\"",
            "pathname.c_str ()"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pathname.c_str",
          "args": [],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "searchPath",
          "args": [
            "EXECCOMP",
            "level"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "searchPath",
          "container": "Y2PathSearch",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
          "lines": "93-128",
          "snippet": "string\nY2PathSearch::searchPath (WHAT what, int level)\n{\n    initializePaths();\n\n    int levels = paths.size();\n\n    switch (what)\n    {\n\tcase EXECCOMP:\n\t    if (level == levels - 1) // FIXME\n\t    {\n\t\treturn EXECCOMPDIR;\n\t    }\n\t    else\n\t    {\n\t\treturn paths[level];\n\t    }\n\tbreak;\n\n\tcase PLUGIN:\n\t    if (level == levels - 1) // FIXME\n\t    {\n\t\treturn PLUGINDIR;\n\t    }\n\t    else\n\t    {\n\t\treturn paths[level] + \"/plugin\";\n\t    }\n\tbreak;\n\n\tdefault:\n\tbreak;\n    }\n    return paths[level];\n}",
          "includes": [
            "#include \"pathsearch.h\"",
            "#include <ycp/y2log.h>",
            "#include <boost/algorithm/string.hpp>",
            "#include <unistd.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "vector<string> Y2PathSearch::paths;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nvector<string> Y2PathSearch::paths;\n\nY2PathSearch {\n  string\n  Y2PathSearch::searchPath (WHAT what, int level)\n  {\n      initializePaths();\n  \n      int levels = paths.size();\n  \n      switch (what)\n      {\n  \tcase EXECCOMP:\n  \t    if (level == levels - 1) // FIXME\n  \t    {\n  \t\treturn EXECCOMPDIR;\n  \t    }\n  \t    else\n  \t    {\n  \t\treturn paths[level];\n  \t    }\n  \tbreak;\n  \n  \tcase PLUGIN:\n  \t    if (level == levels - 1) // FIXME\n  \t    {\n  \t\treturn PLUGINDIR;\n  \t    }\n  \t    else\n  \t    {\n  \t\treturn paths[level] + \"/plugin\";\n  \t    }\n  \tbreak;\n  \n  \tdefault:\n  \tbreak;\n      }\n      return paths[level];\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nY2PathSearch {\n  string\n  Y2PathSearch::findy2exe (string root, string compname, bool server,\n  \t\t\t bool non_y2, int level)\n  {\n      string subdir;\n      if (server)\n      {\n  \tsubdir = (non_y2 ? \"/servers_non_y2/\" : \"/servers/\");\n      }\n      else\n      {\n  \tsubdir = (non_y2 ? \"/clients_non_y2/\" : \"/clients/\");\n      }\n      string pathname = root + searchPath (EXECCOMP, level) + subdir + compname;\n      \n      y2debug (\"Trying file %s\", pathname.c_str ());\n      \n      struct stat buf;\n      if (stat (pathname.c_str (), &buf) == 0)\n      {\n  \t// Check at least if it is executable (for others) and\n  \t// if it is a regular file.\n  \tif (S_ISREG (buf.st_mode) && (buf.st_mode & S_IXOTH == S_IXOTH))\n  \t{\n  \t    return pathname;\n  \t}\n      }\n  \n      return \"\";\n  }\n}"
  },
  {
    "function_name": "findy2",
    "container": "Y2PathSearch",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
    "lines": "142-170",
    "snippet": "string\nY2PathSearch::findy2 (string filename, int mode, int level)\n{\n    initializePaths();\n\n    int levels = paths.size();\n    for (int i = 0; i < levels; i++)\n    {\n\t// for level == -1, all levels are scanned\n\tif ((level >= 0) && (i != level))\n\t{\n\t    continue;\n\t}\n\n\tstring pathname (searchPath (GENERIC, i));\n\tif (pathname[pathname.length()-1] != '/') pathname += \"/\";\n\tpathname = completeFilename (pathname + filename);\n\tif (access (pathname.c_str(), mode) == 0)\n\t{\n\t    // FIXME: this check is different for clients and for modules - see find\n\t    if( searchPrefixWarn && i != levels - 1 )\n\t    {\n\t\ty2warning( \"Using special search prefix '%s' for '%s'\",searchPath (GENERIC, i).c_str(), pathname.c_str() );\n\t    }\n\t    return pathname;\n\t}\n    }\n    return \"\";\n}",
    "includes": [
      "#include \"pathsearch.h\"",
      "#include <ycp/y2log.h>",
      "#include <boost/algorithm/string.hpp>",
      "#include <unistd.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "bool Y2PathSearch::searchPrefixWarn = true;",
      "vector<string> Y2PathSearch::paths;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "y2warning",
          "args": [
            "\"Using special search prefix '%s' for '%s'\"",
            "searchPath (GENERIC, i).c_str()",
            "pathname.c_str()"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pathname.c_str",
          "args": [],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "searchPath",
          "args": [],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "searchPath",
          "args": [
            "GENERIC",
            "i"
          ],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "searchPath",
          "container": "Y2PathSearch",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
          "lines": "93-128",
          "snippet": "string\nY2PathSearch::searchPath (WHAT what, int level)\n{\n    initializePaths();\n\n    int levels = paths.size();\n\n    switch (what)\n    {\n\tcase EXECCOMP:\n\t    if (level == levels - 1) // FIXME\n\t    {\n\t\treturn EXECCOMPDIR;\n\t    }\n\t    else\n\t    {\n\t\treturn paths[level];\n\t    }\n\tbreak;\n\n\tcase PLUGIN:\n\t    if (level == levels - 1) // FIXME\n\t    {\n\t\treturn PLUGINDIR;\n\t    }\n\t    else\n\t    {\n\t\treturn paths[level] + \"/plugin\";\n\t    }\n\tbreak;\n\n\tdefault:\n\tbreak;\n    }\n    return paths[level];\n}",
          "includes": [
            "#include \"pathsearch.h\"",
            "#include <ycp/y2log.h>",
            "#include <boost/algorithm/string.hpp>",
            "#include <unistd.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "vector<string> Y2PathSearch::paths;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nvector<string> Y2PathSearch::paths;\n\nY2PathSearch {\n  string\n  Y2PathSearch::searchPath (WHAT what, int level)\n  {\n      initializePaths();\n  \n      int levels = paths.size();\n  \n      switch (what)\n      {\n  \tcase EXECCOMP:\n  \t    if (level == levels - 1) // FIXME\n  \t    {\n  \t\treturn EXECCOMPDIR;\n  \t    }\n  \t    else\n  \t    {\n  \t\treturn paths[level];\n  \t    }\n  \tbreak;\n  \n  \tcase PLUGIN:\n  \t    if (level == levels - 1) // FIXME\n  \t    {\n  \t\treturn PLUGINDIR;\n  \t    }\n  \t    else\n  \t    {\n  \t\treturn paths[level] + \"/plugin\";\n  \t    }\n  \tbreak;\n  \n  \tdefault:\n  \tbreak;\n      }\n      return paths[level];\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "access",
          "args": [
            "pathname.c_str()",
            "mode"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pathname.c_str",
          "args": [],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "completeFilename",
          "args": [
            "pathname + filename"
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "completeFilename",
          "container": "Y2PathSearch",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
          "lines": "131-139",
          "snippet": "string\nY2PathSearch::completeFilename (const string& fname)\n{\n    string slashes = boost::replace_all_copy(fname, \"::\", \"/\");\n    char* cfn = canonicalize_file_name (slashes.c_str ());\n    string ret = cfn ? string (cfn) : fname;\n    free (cfn);\n    return ret;\n}",
          "includes": [
            "#include \"pathsearch.h\"",
            "#include <ycp/y2log.h>",
            "#include <boost/algorithm/string.hpp>",
            "#include <unistd.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nY2PathSearch {\n  string\n  Y2PathSearch::completeFilename (const string& fname)\n  {\n      string slashes = boost::replace_all_copy(fname, \"::\", \"/\");\n      char* cfn = canonicalize_file_name (slashes.c_str ());\n      string ret = cfn ? string (cfn) : fname;\n      free (cfn);\n      return ret;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "pathname.length",
          "args": [],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "length",
          "container": "YCPPathRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPPath.cc",
          "lines": "124-128",
          "snippet": "long\nYCPPathRep::length() const\n{\n    return components.size();\n}",
          "includes": [
            "#include <ctype.h>",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPPath.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ctype.h>\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPPath.h\"\n#include \"ycp/y2log.h\"\n\nYCPPathRep {\n  long\n  YCPPathRep::length() const\n  {\n      return components.size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "paths.size",
          "args": [],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "109-113",
          "snippet": "int\nYCPTermRep::size() const\n{\n    return l->size();\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  int\n  YCPTermRep::size() const\n  {\n      return l->size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "initializePaths",
          "args": [],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "initializePaths",
          "container": "Y2PathSearch",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
          "lines": "77-82",
          "snippet": "void\nY2PathSearch::initializePaths()\n{\n    if (paths.empty())\n\tpaths = getPaths();\n}",
          "includes": [
            "#include \"pathsearch.h\"",
            "#include <ycp/y2log.h>",
            "#include <boost/algorithm/string.hpp>",
            "#include <unistd.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "vector<string> Y2PathSearch::paths;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nvector<string> Y2PathSearch::paths;\n\nY2PathSearch {\n  void\n  Y2PathSearch::initializePaths()\n  {\n      if (paths.empty())\n  \tpaths = getPaths();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nbool Y2PathSearch::searchPrefixWarn = true;\nvector<string> Y2PathSearch::paths;\n\nY2PathSearch {\n  string\n  Y2PathSearch::findy2 (string filename, int mode, int level)\n  {\n      initializePaths();\n  \n      int levels = paths.size();\n      for (int i = 0; i < levels; i++)\n      {\n  \t// for level == -1, all levels are scanned\n  \tif ((level >= 0) && (i != level))\n  \t{\n  \t    continue;\n  \t}\n  \n  \tstring pathname (searchPath (GENERIC, i));\n  \tif (pathname[pathname.length()-1] != '/') pathname += \"/\";\n  \tpathname = completeFilename (pathname + filename);\n  \tif (access (pathname.c_str(), mode) == 0)\n  \t{\n  \t    // FIXME: this check is different for clients and for modules - see find\n  \t    if( searchPrefixWarn && i != levels - 1 )\n  \t    {\n  \t\ty2warning( \"Using special search prefix '%s' for '%s'\",searchPath (GENERIC, i).c_str(), pathname.c_str() );\n  \t    }\n  \t    return pathname;\n  \t}\n      }\n      return \"\";\n  }\n}"
  },
  {
    "function_name": "completeFilename",
    "container": "Y2PathSearch",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
    "lines": "131-139",
    "snippet": "string\nY2PathSearch::completeFilename (const string& fname)\n{\n    string slashes = boost::replace_all_copy(fname, \"::\", \"/\");\n    char* cfn = canonicalize_file_name (slashes.c_str ());\n    string ret = cfn ? string (cfn) : fname;\n    free (cfn);\n    return ret;\n}",
    "includes": [
      "#include \"pathsearch.h\"",
      "#include <ycp/y2log.h>",
      "#include <boost/algorithm/string.hpp>",
      "#include <unistd.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "cfn"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "string",
          "args": [
            "cfn"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "compare_op_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YExpression.cc",
          "lines": "435-450",
          "snippet": "static string\ncompare_op_string( YECompare::c_op op )\n{\n    switch (op)\n    {\n\tcase YECompare::C_EQ:  return \"==\"; break;\n\tcase YECompare::C_NEQ: return \"!=\"; break;\n\tcase YECompare::C_LT:  return \"<\";  break;\n\tcase YECompare::C_GE:  return \">=\"; break;\n\tcase YECompare::C_LE:  return \"<=\"; break;\n\tcase YECompare::C_GT:  return \">\";  break;\n\tdefault:\n\t\tbreak;\n    }\n    return \"?compare?\";\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/SymbolTable.h\"",
            "#include \"ycp/YExpression.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YBlock.h\"",
            "#include \"ycp/YStatement.h\"",
            "#include \"ycp/StaticDeclaration.h\"",
            "#include \"ycp/y2log.h\"",
            "#include <libintl.h>\t// for dngettext"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/SymbolTable.h\"\n#include \"ycp/YExpression.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YBlock.h\"\n#include \"ycp/YStatement.h\"\n#include \"ycp/StaticDeclaration.h\"\n#include \"ycp/y2log.h\"\n#include <libintl.h>\t// for dngettext\n\nstatic string\ncompare_op_string( YECompare::c_op op )\n{\n    switch (op)\n    {\n\tcase YECompare::C_EQ:  return \"==\"; break;\n\tcase YECompare::C_NEQ: return \"!=\"; break;\n\tcase YECompare::C_LT:  return \"<\";  break;\n\tcase YECompare::C_GE:  return \">=\"; break;\n\tcase YECompare::C_LE:  return \"<=\"; break;\n\tcase YECompare::C_GT:  return \">\";  break;\n\tdefault:\n\t\tbreak;\n    }\n    return \"?compare?\";\n}"
        }
      },
      {
        "call_info": {
          "callee": "canonicalize_file_name",
          "args": [
            "slashes.c_str ()"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slashes.c_str",
          "args": [],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boost::replace_all_copy",
          "args": [
            "fname",
            "\"::\"",
            "\"/\""
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nY2PathSearch {\n  string\n  Y2PathSearch::completeFilename (const string& fname)\n  {\n      string slashes = boost::replace_all_copy(fname, \"::\", \"/\");\n      char* cfn = canonicalize_file_name (slashes.c_str ());\n      string ret = cfn ? string (cfn) : fname;\n      free (cfn);\n      return ret;\n  }\n}"
  },
  {
    "function_name": "searchPath",
    "container": "Y2PathSearch",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
    "lines": "93-128",
    "snippet": "string\nY2PathSearch::searchPath (WHAT what, int level)\n{\n    initializePaths();\n\n    int levels = paths.size();\n\n    switch (what)\n    {\n\tcase EXECCOMP:\n\t    if (level == levels - 1) // FIXME\n\t    {\n\t\treturn EXECCOMPDIR;\n\t    }\n\t    else\n\t    {\n\t\treturn paths[level];\n\t    }\n\tbreak;\n\n\tcase PLUGIN:\n\t    if (level == levels - 1) // FIXME\n\t    {\n\t\treturn PLUGINDIR;\n\t    }\n\t    else\n\t    {\n\t\treturn paths[level] + \"/plugin\";\n\t    }\n\tbreak;\n\n\tdefault:\n\tbreak;\n    }\n    return paths[level];\n}",
    "includes": [
      "#include \"pathsearch.h\"",
      "#include <ycp/y2log.h>",
      "#include <boost/algorithm/string.hpp>",
      "#include <unistd.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "vector<string> Y2PathSearch::paths;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "paths.size",
          "args": [],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "109-113",
          "snippet": "int\nYCPTermRep::size() const\n{\n    return l->size();\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  int\n  YCPTermRep::size() const\n  {\n      return l->size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "initializePaths",
          "args": [],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "initializePaths",
          "container": "Y2PathSearch",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
          "lines": "77-82",
          "snippet": "void\nY2PathSearch::initializePaths()\n{\n    if (paths.empty())\n\tpaths = getPaths();\n}",
          "includes": [
            "#include \"pathsearch.h\"",
            "#include <ycp/y2log.h>",
            "#include <boost/algorithm/string.hpp>",
            "#include <unistd.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "vector<string> Y2PathSearch::paths;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nvector<string> Y2PathSearch::paths;\n\nY2PathSearch {\n  void\n  Y2PathSearch::initializePaths()\n  {\n      if (paths.empty())\n  \tpaths = getPaths();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nvector<string> Y2PathSearch::paths;\n\nY2PathSearch {\n  string\n  Y2PathSearch::searchPath (WHAT what, int level)\n  {\n      initializePaths();\n  \n      int levels = paths.size();\n  \n      switch (what)\n      {\n  \tcase EXECCOMP:\n  \t    if (level == levels - 1) // FIXME\n  \t    {\n  \t\treturn EXECCOMPDIR;\n  \t    }\n  \t    else\n  \t    {\n  \t\treturn paths[level];\n  \t    }\n  \tbreak;\n  \n  \tcase PLUGIN:\n  \t    if (level == levels - 1) // FIXME\n  \t    {\n  \t\treturn PLUGINDIR;\n  \t    }\n  \t    else\n  \t    {\n  \t\treturn paths[level] + \"/plugin\";\n  \t    }\n  \tbreak;\n  \n  \tdefault:\n  \tbreak;\n      }\n      return paths[level];\n  }\n}"
  },
  {
    "function_name": "numberOfComponentLevels",
    "container": "Y2PathSearch",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
    "lines": "85-90",
    "snippet": "int\nY2PathSearch::numberOfComponentLevels()\n{\n    initializePaths();\n    return paths.size();\n}",
    "includes": [
      "#include \"pathsearch.h\"",
      "#include <ycp/y2log.h>",
      "#include <boost/algorithm/string.hpp>",
      "#include <unistd.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "vector<string> Y2PathSearch::paths;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "paths.size",
          "args": [],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "YCPTermRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPTerm.cc",
          "lines": "109-113",
          "snippet": "int\nYCPTermRep::size() const\n{\n    return l->size();\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/y2log.h\"\n\nYCPTermRep {\n  int\n  YCPTermRep::size() const\n  {\n      return l->size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "initializePaths",
          "args": [],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "initializePaths",
          "container": "Y2PathSearch",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
          "lines": "77-82",
          "snippet": "void\nY2PathSearch::initializePaths()\n{\n    if (paths.empty())\n\tpaths = getPaths();\n}",
          "includes": [
            "#include \"pathsearch.h\"",
            "#include <ycp/y2log.h>",
            "#include <boost/algorithm/string.hpp>",
            "#include <unistd.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "vector<string> Y2PathSearch::paths;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nvector<string> Y2PathSearch::paths;\n\nY2PathSearch {\n  void\n  Y2PathSearch::initializePaths()\n  {\n      if (paths.empty())\n  \tpaths = getPaths();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nvector<string> Y2PathSearch::paths;\n\nY2PathSearch {\n  int\n  Y2PathSearch::numberOfComponentLevels()\n  {\n      initializePaths();\n      return paths.size();\n  }\n}"
  },
  {
    "function_name": "initializePaths",
    "container": "Y2PathSearch",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
    "lines": "77-82",
    "snippet": "void\nY2PathSearch::initializePaths()\n{\n    if (paths.empty())\n\tpaths = getPaths();\n}",
    "includes": [
      "#include \"pathsearch.h\"",
      "#include <ycp/y2log.h>",
      "#include <boost/algorithm/string.hpp>",
      "#include <unistd.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "vector<string> Y2PathSearch::paths;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "getPaths",
          "args": [],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "getPaths",
          "container": "Y2PathSearch",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
          "lines": "41-71",
          "snippet": "vector<string>\nY2PathSearch::getPaths()\n{\n    vector<string> ret;\n\n    ret.push_back(string(\"/y2update\"));\n\n    const char* y2dir = getenv(\"Y2DIR\");\n    if (y2dir)\n    {\n\tvector<string> y2dirs;\n\tboost::split(y2dirs, y2dir, boost::is_any_of(\":\"));\n\tfor (vector<string>::const_iterator it = y2dirs.begin(); it != y2dirs.end(); ++it)\n\t{\n\t    if (*it != YAST2DIR)\t\t// prevent path duplication\n\t\tret.push_back(*it);\n\t}\n    }\n\n    const char* home = getenv(\"HOME\");\n    if (home)\n    {\n\tret.push_back(string(home) + \"/.yast2\");\n    }\n\n    ret.push_back(string(YAST2DIR));\n\n    y2debug(\"getPaths %s\", boost::join(ret, \" \").c_str());\n\n    return ret;\n}",
          "includes": [
            "#include \"pathsearch.h\"",
            "#include <ycp/y2log.h>",
            "#include <boost/algorithm/string.hpp>",
            "#include <unistd.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nY2PathSearch {\n  vector<string>\n  Y2PathSearch::getPaths()\n  {\n      vector<string> ret;\n  \n      ret.push_back(string(\"/y2update\"));\n  \n      const char* y2dir = getenv(\"Y2DIR\");\n      if (y2dir)\n      {\n  \tvector<string> y2dirs;\n  \tboost::split(y2dirs, y2dir, boost::is_any_of(\":\"));\n  \tfor (vector<string>::const_iterator it = y2dirs.begin(); it != y2dirs.end(); ++it)\n  \t{\n  \t    if (*it != YAST2DIR)\t\t// prevent path duplication\n  \t\tret.push_back(*it);\n  \t}\n      }\n  \n      const char* home = getenv(\"HOME\");\n      if (home)\n      {\n  \tret.push_back(string(home) + \"/.yast2\");\n      }\n  \n      ret.push_back(string(YAST2DIR));\n  \n      y2debug(\"getPaths %s\", boost::join(ret, \" \").c_str());\n  \n      return ret;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "paths.empty",
          "args": [],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pathname",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/include/y2util/Pathname.h",
          "lines": "66-66",
          "snippet": "bool empty()    const { return !name_t.size(); }",
          "includes": [
            "#include <string>",
            "#include <iosfwd>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string>\n#include <iosfwd>\n\nPathname {\n  bool empty()    const { return !name_t.size(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nvector<string> Y2PathSearch::paths;\n\nY2PathSearch {\n  void\n  Y2PathSearch::initializePaths()\n  {\n      if (paths.empty())\n  \tpaths = getPaths();\n  }\n}"
  },
  {
    "function_name": "getPaths",
    "container": "Y2PathSearch",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/pathsearch.cc",
    "lines": "41-71",
    "snippet": "vector<string>\nY2PathSearch::getPaths()\n{\n    vector<string> ret;\n\n    ret.push_back(string(\"/y2update\"));\n\n    const char* y2dir = getenv(\"Y2DIR\");\n    if (y2dir)\n    {\n\tvector<string> y2dirs;\n\tboost::split(y2dirs, y2dir, boost::is_any_of(\":\"));\n\tfor (vector<string>::const_iterator it = y2dirs.begin(); it != y2dirs.end(); ++it)\n\t{\n\t    if (*it != YAST2DIR)\t\t// prevent path duplication\n\t\tret.push_back(*it);\n\t}\n    }\n\n    const char* home = getenv(\"HOME\");\n    if (home)\n    {\n\tret.push_back(string(home) + \"/.yast2\");\n    }\n\n    ret.push_back(string(YAST2DIR));\n\n    y2debug(\"getPaths %s\", boost::join(ret, \" \").c_str());\n\n    return ret;\n}",
    "includes": [
      "#include \"pathsearch.h\"",
      "#include <ycp/y2log.h>",
      "#include <boost/algorithm/string.hpp>",
      "#include <unistd.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "y2debug",
          "args": [
            "\"getPaths %s\"",
            "boost::join(ret, \" \").c_str()"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boost::join",
          "args": [],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boost::join",
          "args": [
            "ret",
            "\" \""
          ],
          "line": 68
        },
        "resolved": true,
        "details": {
          "function_name": "join",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/liby2util-r/src/stringutil.cc",
          "lines": "128-141",
          "snippet": "std::string join( const std::vector<std::string> & words_r,\n\t\t  const std::string & sep_r )\n{\n  if ( words_r.empty() )\n    return \"\";\n\n  string ret( words_r[0] );\n\n  for ( unsigned i = 1; i < words_r.size(); ++i ) {\n    ret += sep_r + words_r[i];\n  }\n\n  return ret;\n}",
          "includes": [
            "#include <y2util/stringutil.h>",
            "#include <fstream>",
            "#include <iostream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <y2util/stringutil.h>\n#include <fstream>\n#include <iostream>\n\nstd::string join( const std::vector<std::string> & words_r,\n\t\t  const std::string & sep_r )\n{\n  if ( words_r.empty() )\n    return \"\";\n\n  string ret( words_r[0] );\n\n  for ( unsigned i = 1; i < words_r.size(); ++i ) {\n    ret += sep_r + words_r[i];\n  }\n\n  return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ret.push_back",
          "args": [
            "string(YAST2DIR)"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "push_back",
          "container": "YCPListRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPList.cc",
          "lines": "70-74",
          "snippet": "void\nYCPListRep::push_back(const YCPValue& value)\n{\n    elements.push_back(value);\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/YCPCodeCompare.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include <algorithm>",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/y2log.h\"",
            "#include \"YCP.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/YCPCodeCompare.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include <algorithm>\n#include \"ycp/YCPList.h\"\n#include \"ycp/y2log.h\"\n#include \"YCP.h\"\n\nYCPListRep {\n  void\n  YCPListRep::push_back(const YCPValue& value)\n  {\n      elements.push_back(value);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "string",
          "args": [
            "YAST2DIR"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "compare_op_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YExpression.cc",
          "lines": "435-450",
          "snippet": "static string\ncompare_op_string( YECompare::c_op op )\n{\n    switch (op)\n    {\n\tcase YECompare::C_EQ:  return \"==\"; break;\n\tcase YECompare::C_NEQ: return \"!=\"; break;\n\tcase YECompare::C_LT:  return \"<\";  break;\n\tcase YECompare::C_GE:  return \">=\"; break;\n\tcase YECompare::C_LE:  return \"<=\"; break;\n\tcase YECompare::C_GT:  return \">\";  break;\n\tdefault:\n\t\tbreak;\n    }\n    return \"?compare?\";\n}",
          "includes": [
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/SymbolTable.h\"",
            "#include \"ycp/YExpression.h\"",
            "#include \"ycp/YCPVoid.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/YCPList.h\"",
            "#include \"ycp/YCPFloat.h\"",
            "#include \"ycp/YCPInteger.h\"",
            "#include \"ycp/YCPBoolean.h\"",
            "#include \"ycp/YCPTerm.h\"",
            "#include \"ycp/YCPCode.h\"",
            "#include \"ycp/YBlock.h\"",
            "#include \"ycp/YStatement.h\"",
            "#include \"ycp/StaticDeclaration.h\"",
            "#include \"ycp/y2log.h\"",
            "#include <libintl.h>\t// for dngettext"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/SymbolTable.h\"\n#include \"ycp/YExpression.h\"\n#include \"ycp/YCPVoid.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/YCPList.h\"\n#include \"ycp/YCPFloat.h\"\n#include \"ycp/YCPInteger.h\"\n#include \"ycp/YCPBoolean.h\"\n#include \"ycp/YCPTerm.h\"\n#include \"ycp/YCPCode.h\"\n#include \"ycp/YBlock.h\"\n#include \"ycp/YStatement.h\"\n#include \"ycp/StaticDeclaration.h\"\n#include \"ycp/y2log.h\"\n#include <libintl.h>\t// for dngettext\n\nstatic string\ncompare_op_string( YECompare::c_op op )\n{\n    switch (op)\n    {\n\tcase YECompare::C_EQ:  return \"==\"; break;\n\tcase YECompare::C_NEQ: return \"!=\"; break;\n\tcase YECompare::C_LT:  return \"<\";  break;\n\tcase YECompare::C_GE:  return \">=\"; break;\n\tcase YECompare::C_LE:  return \"<=\"; break;\n\tcase YECompare::C_GT:  return \">\";  break;\n\tdefault:\n\t\tbreak;\n    }\n    return \"?compare?\";\n}"
        }
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"HOME\""
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "y2dirs.end",
          "args": [],
          "line": 53
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "43-47",
          "snippet": "YCPMapIterator\nYCPMapRep::end() const\n{\n    return stl_map.end();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::end() const\n  {\n      return stl_map.end();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "y2dirs.begin",
          "args": [],
          "line": 53
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "YCPMapRep",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2011-3177/repo/libycp/src/YCPMap.cc",
          "lines": "36-40",
          "snippet": "YCPMapIterator\nYCPMapRep::begin() const\n{\n    return stl_map.begin();\n}",
          "includes": [
            "#include \"ycp/ExecutionEnvironment.h\"",
            "#include \"ycp/Xmlcode.h\"",
            "#include \"ycp/Bytecode.h\"",
            "#include \"ycp/YCPMap.h\"",
            "#include \"ycp/y2log.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ycp/ExecutionEnvironment.h\"\n#include \"ycp/Xmlcode.h\"\n#include \"ycp/Bytecode.h\"\n#include \"ycp/YCPMap.h\"\n#include \"ycp/y2log.h\"\n\nYCPMapRep {\n  YCPMapIterator\n  YCPMapRep::begin() const\n  {\n      return stl_map.begin();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "boost::split",
          "args": [
            "y2dirs",
            "y2dir",
            "boost::is_any_of(\":\")"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boost::is_any_of",
          "args": [
            "\":\""
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"Y2DIR\""
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pathsearch.h\"\n#include <ycp/y2log.h>\n#include <boost/algorithm/string.hpp>\n#include <unistd.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n\nY2PathSearch {\n  vector<string>\n  Y2PathSearch::getPaths()\n  {\n      vector<string> ret;\n  \n      ret.push_back(string(\"/y2update\"));\n  \n      const char* y2dir = getenv(\"Y2DIR\");\n      if (y2dir)\n      {\n  \tvector<string> y2dirs;\n  \tboost::split(y2dirs, y2dir, boost::is_any_of(\":\"));\n  \tfor (vector<string>::const_iterator it = y2dirs.begin(); it != y2dirs.end(); ++it)\n  \t{\n  \t    if (*it != YAST2DIR)\t\t// prevent path duplication\n  \t\tret.push_back(*it);\n  \t}\n      }\n  \n      const char* home = getenv(\"HOME\");\n      if (home)\n      {\n  \tret.push_back(string(home) + \"/.yast2\");\n      }\n  \n      ret.push_back(string(YAST2DIR));\n  \n      y2debug(\"getPaths %s\", boost::join(ret, \" \").c_str());\n  \n      return ret;\n  }\n}"
  }
]