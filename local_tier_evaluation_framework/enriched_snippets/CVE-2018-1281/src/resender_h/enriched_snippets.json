[
  {
    "function_name": "Monitoring",
    "container": "Resender",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2018-1281/repo/src/resender.h",
    "lines": "111-131",
    "snippet": "void Monitoring() {\n    while (!exit_) {\n      std::this_thread::sleep_for(Time(timeout_));\n      std::vector<Message> resend;\n      Time now = Now();\n      mu_.lock();\n      for (auto& it : send_buff_) {\n        if (it.second.send + Time(timeout_) * (1+it.second.num_retry) < now) {\n          resend.push_back(it.second.msg);\n          ++it.second.num_retry;\n          LOG(WARNING) << van_->my_node().ShortDebugString()\n                       << \": Timeout to get the ACK message. Resend (retry=\"\n                       << it.second.num_retry << \") \" << it.second.msg.DebugString();\n          CHECK_LT(it.second.num_retry, max_num_retry_);\n        }\n      }\n      mu_.unlock();\n\n      for (const auto& msg : resend) van_->Send(msg);\n    }\n  }",
    "includes": [
      "#include <unordered_map>",
      "#include <unordered_set>",
      "#include <vector>",
      "#include <chrono>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "van_->Send",
          "args": [
            "msg"
          ],
          "line": 129
        },
        "resolved": true,
        "details": {
          "function_name": "Send",
          "container": "Van",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2018-1281/repo/src/van.cc",
          "lines": "130-139",
          "snippet": "int Van::Send(const Message& msg) {\n  int send_bytes = SendMsg(msg);\n  CHECK_NE(send_bytes, -1);\n  send_bytes_ += send_bytes;\n  if (resender_) resender_->AddOutgoing(msg);\n  if (Postoffice::Get()->verbose() >= 2) {\n    PS_VLOG(2) << msg.DebugString();\n  }\n  return send_bytes;\n}",
          "includes": [
            "#include \"./resender.h\"",
            "#include \"./zmq_van.h\"",
            "#include \"./meta.pb.h\"",
            "#include \"./network_utils.h\"",
            "#include \"ps/internal/customer.h\"",
            "#include \"ps/internal/postoffice.h\"",
            "#include \"ps/sarray.h\"",
            "#include \"ps/base.h\"",
            "#include <chrono>",
            "#include <thread>",
            "#include \"ps/internal/van.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"./resender.h\"\n#include \"./zmq_van.h\"\n#include \"./meta.pb.h\"\n#include \"./network_utils.h\"\n#include \"ps/internal/customer.h\"\n#include \"ps/internal/postoffice.h\"\n#include \"ps/sarray.h\"\n#include \"ps/base.h\"\n#include <chrono>\n#include <thread>\n#include \"ps/internal/van.h\"\n\nVan {\n  int Van::Send(const Message& msg) {\n    int send_bytes = SendMsg(msg);\n    CHECK_NE(send_bytes, -1);\n    send_bytes_ += send_bytes;\n    if (resender_) resender_->AddOutgoing(msg);\n    if (Postoffice::Get()->verbose() >= 2) {\n      PS_VLOG(2) << msg.DebugString();\n    }\n    return send_bytes;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mu_.unlock",
          "args": [],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CHECK_LT",
          "args": [
            "it.second.num_retry",
            "max_num_retry_"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "it.second.msg.DebugString",
          "args": [],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "van_->my_node",
          "args": [],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "van_->my_node",
          "args": [],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOG",
          "args": [
            "WARNING"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "resend.push_back",
          "args": [
            "it.second.msg"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Time",
          "args": [
            "timeout_"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mu_.lock",
          "args": [],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Now",
          "args": [],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "Now",
          "container": "Resender",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2018-1281/repo/src/resender.h",
          "lines": "106-109",
          "snippet": "Time Now() {\n    return std::chrono::duration_cast<Time>(\n        std::chrono::high_resolution_clock::now().time_since_epoch());\n  }",
          "includes": [
            "#include <unordered_map>",
            "#include <unordered_set>",
            "#include <vector>",
            "#include <chrono>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unordered_map>\n#include <unordered_set>\n#include <vector>\n#include <chrono>\n\nResender {\n  Time Now() {\n      return std::chrono::duration_cast<Time>(\n          std::chrono::high_resolution_clock::now().time_since_epoch());\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::this_thread::sleep_for",
          "args": [
            "Time(timeout_)"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Time",
          "args": [
            "timeout_"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unordered_map>\n#include <unordered_set>\n#include <vector>\n#include <chrono>\n\nResender {\n  void Monitoring() {\n      while (!exit_) {\n        std::this_thread::sleep_for(Time(timeout_));\n        std::vector<Message> resend;\n        Time now = Now();\n        mu_.lock();\n        for (auto& it : send_buff_) {\n          if (it.second.send + Time(timeout_) * (1+it.second.num_retry) < now) {\n            resend.push_back(it.second.msg);\n            ++it.second.num_retry;\n            LOG(WARNING) << van_->my_node().ShortDebugString()\n                         << \": Timeout to get the ACK message. Resend (retry=\"\n                         << it.second.num_retry << \") \" << it.second.msg.DebugString();\n            CHECK_LT(it.second.num_retry, max_num_retry_);\n          }\n        }\n        mu_.unlock();\n  \n        for (const auto& msg : resend) van_->Send(msg);\n      }\n    }\n}"
  },
  {
    "function_name": "Now",
    "container": "Resender",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2018-1281/repo/src/resender.h",
    "lines": "106-109",
    "snippet": "Time Now() {\n    return std::chrono::duration_cast<Time>(\n        std::chrono::high_resolution_clock::now().time_since_epoch());\n  }",
    "includes": [
      "#include <unordered_map>",
      "#include <unordered_set>",
      "#include <vector>",
      "#include <chrono>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::chrono::duration_cast<Time>",
          "args": [
            "std::chrono::high_resolution_clock::now().time_since_epoch()"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::chrono::high_resolution_clock::now",
          "args": [],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::chrono::high_resolution_clock::now",
          "args": [],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unordered_map>\n#include <unordered_set>\n#include <vector>\n#include <chrono>\n\nResender {\n  Time Now() {\n      return std::chrono::duration_cast<Time>(\n          std::chrono::high_resolution_clock::now().time_since_epoch());\n    }\n}"
  },
  {
    "function_name": "GetKey",
    "container": "Resender",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2018-1281/repo/src/resender.h",
    "lines": "95-105",
    "snippet": "uint64_t GetKey(const Message& msg) {\n    CHECK_NE(msg.meta.timestamp, Meta::kEmpty) << msg.DebugString();\n    uint16_t id = msg.meta.customer_id;\n    uint8_t sender = msg.meta.sender == Node::kEmpty ?\n                     van_->my_node().id : msg.meta.sender;\n    uint8_t recver = msg.meta.recver;\n    return (static_cast<uint64_t>(id) << 48) |\n        (static_cast<uint64_t>(sender) << 40) |\n        (static_cast<uint64_t>(recver) << 32) |\n        (msg.meta.timestamp << 1) | msg.meta.request;\n  }",
    "includes": [
      "#include <unordered_map>",
      "#include <unordered_set>",
      "#include <vector>",
      "#include <chrono>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "static_cast<uint64_t>",
          "args": [
            "recver"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<uint64_t>",
          "args": [
            "sender"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<uint64_t>",
          "args": [
            "id"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "van_->my_node",
          "args": [],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "msg.DebugString",
          "args": [],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CHECK_NE",
          "args": [
            "msg.meta.timestamp",
            "Meta::kEmpty"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unordered_map>\n#include <unordered_set>\n#include <vector>\n#include <chrono>\n\nResender {\n  uint64_t GetKey(const Message& msg) {\n      CHECK_NE(msg.meta.timestamp, Meta::kEmpty) << msg.DebugString();\n      uint16_t id = msg.meta.customer_id;\n      uint8_t sender = msg.meta.sender == Node::kEmpty ?\n                       van_->my_node().id : msg.meta.sender;\n      uint8_t recver = msg.meta.recver;\n      return (static_cast<uint64_t>(id) << 48) |\n          (static_cast<uint64_t>(sender) << 40) |\n          (static_cast<uint64_t>(recver) << 32) |\n          (msg.meta.timestamp << 1) | msg.meta.request;\n    }\n}"
  },
  {
    "function_name": "AddIncomming",
    "container": "Resender",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2018-1281/repo/src/resender.h",
    "lines": "54-83",
    "snippet": "bool AddIncomming(const Message& msg) {\n    // a message can be received by multiple times\n    if (msg.meta.control.cmd == Control::TERMINATE) {\n      return false;\n    } else if (msg.meta.control.cmd == Control::ACK) {\n      mu_.lock();\n      auto key = msg.meta.control.msg_sig;\n      auto it = send_buff_.find(key);\n      if (it != send_buff_.end()) send_buff_.erase(it);\n      mu_.unlock();\n      return true;\n    } else {\n      mu_.lock();\n      auto key = GetKey(msg);\n      auto it = acked_.find(key);\n      bool duplicated = it != acked_.end();\n      if (!duplicated) acked_.insert(key);\n      mu_.unlock();\n      // send back ack message (even if it is duplicated)\n      Message ack;\n      ack.meta.recver = msg.meta.sender;\n      ack.meta.sender = msg.meta.recver;\n      ack.meta.control.cmd = Control::ACK;\n      ack.meta.control.msg_sig = key;\n      van_->Send(ack);\n      // warning\n      if (duplicated) LOG(WARNING) << \"Duplicated message: \" << msg.DebugString();\n      return duplicated;\n    }\n  }",
    "includes": [
      "#include <unordered_map>",
      "#include <unordered_set>",
      "#include <vector>",
      "#include <chrono>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "msg.DebugString",
          "args": [],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOG",
          "args": [
            "WARNING"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "van_->Send",
          "args": [
            "ack"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "Send",
          "container": "Van",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2018-1281/repo/src/van.cc",
          "lines": "130-139",
          "snippet": "int Van::Send(const Message& msg) {\n  int send_bytes = SendMsg(msg);\n  CHECK_NE(send_bytes, -1);\n  send_bytes_ += send_bytes;\n  if (resender_) resender_->AddOutgoing(msg);\n  if (Postoffice::Get()->verbose() >= 2) {\n    PS_VLOG(2) << msg.DebugString();\n  }\n  return send_bytes;\n}",
          "includes": [
            "#include \"./resender.h\"",
            "#include \"./zmq_van.h\"",
            "#include \"./meta.pb.h\"",
            "#include \"./network_utils.h\"",
            "#include \"ps/internal/customer.h\"",
            "#include \"ps/internal/postoffice.h\"",
            "#include \"ps/sarray.h\"",
            "#include \"ps/base.h\"",
            "#include <chrono>",
            "#include <thread>",
            "#include \"ps/internal/van.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"./resender.h\"\n#include \"./zmq_van.h\"\n#include \"./meta.pb.h\"\n#include \"./network_utils.h\"\n#include \"ps/internal/customer.h\"\n#include \"ps/internal/postoffice.h\"\n#include \"ps/sarray.h\"\n#include \"ps/base.h\"\n#include <chrono>\n#include <thread>\n#include \"ps/internal/van.h\"\n\nVan {\n  int Van::Send(const Message& msg) {\n    int send_bytes = SendMsg(msg);\n    CHECK_NE(send_bytes, -1);\n    send_bytes_ += send_bytes;\n    if (resender_) resender_->AddOutgoing(msg);\n    if (Postoffice::Get()->verbose() >= 2) {\n      PS_VLOG(2) << msg.DebugString();\n    }\n    return send_bytes;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mu_.unlock",
          "args": [],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "acked_.insert",
          "args": [
            "key"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "acked_.end",
          "args": [],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "acked_.find",
          "args": [
            "key"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetKey",
          "args": [
            "msg"
          ],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "GetKey",
          "container": "Resender",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2018-1281/repo/src/resender.h",
          "lines": "95-105",
          "snippet": "uint64_t GetKey(const Message& msg) {\n    CHECK_NE(msg.meta.timestamp, Meta::kEmpty) << msg.DebugString();\n    uint16_t id = msg.meta.customer_id;\n    uint8_t sender = msg.meta.sender == Node::kEmpty ?\n                     van_->my_node().id : msg.meta.sender;\n    uint8_t recver = msg.meta.recver;\n    return (static_cast<uint64_t>(id) << 48) |\n        (static_cast<uint64_t>(sender) << 40) |\n        (static_cast<uint64_t>(recver) << 32) |\n        (msg.meta.timestamp << 1) | msg.meta.request;\n  }",
          "includes": [
            "#include <unordered_map>",
            "#include <unordered_set>",
            "#include <vector>",
            "#include <chrono>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unordered_map>\n#include <unordered_set>\n#include <vector>\n#include <chrono>\n\nResender {\n  uint64_t GetKey(const Message& msg) {\n      CHECK_NE(msg.meta.timestamp, Meta::kEmpty) << msg.DebugString();\n      uint16_t id = msg.meta.customer_id;\n      uint8_t sender = msg.meta.sender == Node::kEmpty ?\n                       van_->my_node().id : msg.meta.sender;\n      uint8_t recver = msg.meta.recver;\n      return (static_cast<uint64_t>(id) << 48) |\n          (static_cast<uint64_t>(sender) << 40) |\n          (static_cast<uint64_t>(recver) << 32) |\n          (msg.meta.timestamp << 1) | msg.meta.request;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mu_.lock",
          "args": [],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mu_.unlock",
          "args": [],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "send_buff_.erase",
          "args": [
            "it"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "send_buff_.end",
          "args": [],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "send_buff_.find",
          "args": [
            "key"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mu_.lock",
          "args": [],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unordered_map>\n#include <unordered_set>\n#include <vector>\n#include <chrono>\n\nResender {\n  bool AddIncomming(const Message& msg) {\n      // a message can be received by multiple times\n      if (msg.meta.control.cmd == Control::TERMINATE) {\n        return false;\n      } else if (msg.meta.control.cmd == Control::ACK) {\n        mu_.lock();\n        auto key = msg.meta.control.msg_sig;\n        auto it = send_buff_.find(key);\n        if (it != send_buff_.end()) send_buff_.erase(it);\n        mu_.unlock();\n        return true;\n      } else {\n        mu_.lock();\n        auto key = GetKey(msg);\n        auto it = acked_.find(key);\n        bool duplicated = it != acked_.end();\n        if (!duplicated) acked_.insert(key);\n        mu_.unlock();\n        // send back ack message (even if it is duplicated)\n        Message ack;\n        ack.meta.recver = msg.meta.sender;\n        ack.meta.sender = msg.meta.recver;\n        ack.meta.control.cmd = Control::ACK;\n        ack.meta.control.msg_sig = key;\n        van_->Send(ack);\n        // warning\n        if (duplicated) LOG(WARNING) << \"Duplicated message: \" << msg.DebugString();\n        return duplicated;\n      }\n    }\n}"
  },
  {
    "function_name": "AddOutgoing",
    "container": "Resender",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2018-1281/repo/src/resender.h",
    "lines": "36-48",
    "snippet": "void AddOutgoing(const Message& msg) {\n    if (msg.meta.control.cmd == Control::ACK) return;\n    CHECK_NE(msg.meta.timestamp, Meta::kEmpty) << msg.DebugString();\n    auto key = GetKey(msg);\n    std::lock_guard<std::mutex> lk(mu_);\n    // already buffered, which often due to call Send by the monitor thread\n    if (send_buff_.find(key) != send_buff_.end()) return;\n\n    auto& ent = send_buff_[key];\n    ent.msg = msg;\n    ent.send = Now();\n    ent.num_retry = 0;\n  }",
    "includes": [
      "#include <unordered_map>",
      "#include <unordered_set>",
      "#include <vector>",
      "#include <chrono>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Now",
          "args": [],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "Now",
          "container": "Resender",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2018-1281/repo/src/resender.h",
          "lines": "106-109",
          "snippet": "Time Now() {\n    return std::chrono::duration_cast<Time>(\n        std::chrono::high_resolution_clock::now().time_since_epoch());\n  }",
          "includes": [
            "#include <unordered_map>",
            "#include <unordered_set>",
            "#include <vector>",
            "#include <chrono>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unordered_map>\n#include <unordered_set>\n#include <vector>\n#include <chrono>\n\nResender {\n  Time Now() {\n      return std::chrono::duration_cast<Time>(\n          std::chrono::high_resolution_clock::now().time_since_epoch());\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "send_buff_.end",
          "args": [],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "send_buff_.find",
          "args": [
            "key"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetKey",
          "args": [
            "msg"
          ],
          "line": 39
        },
        "resolved": true,
        "details": {
          "function_name": "GetKey",
          "container": "Resender",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2018-1281/repo/src/resender.h",
          "lines": "95-105",
          "snippet": "uint64_t GetKey(const Message& msg) {\n    CHECK_NE(msg.meta.timestamp, Meta::kEmpty) << msg.DebugString();\n    uint16_t id = msg.meta.customer_id;\n    uint8_t sender = msg.meta.sender == Node::kEmpty ?\n                     van_->my_node().id : msg.meta.sender;\n    uint8_t recver = msg.meta.recver;\n    return (static_cast<uint64_t>(id) << 48) |\n        (static_cast<uint64_t>(sender) << 40) |\n        (static_cast<uint64_t>(recver) << 32) |\n        (msg.meta.timestamp << 1) | msg.meta.request;\n  }",
          "includes": [
            "#include <unordered_map>",
            "#include <unordered_set>",
            "#include <vector>",
            "#include <chrono>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unordered_map>\n#include <unordered_set>\n#include <vector>\n#include <chrono>\n\nResender {\n  uint64_t GetKey(const Message& msg) {\n      CHECK_NE(msg.meta.timestamp, Meta::kEmpty) << msg.DebugString();\n      uint16_t id = msg.meta.customer_id;\n      uint8_t sender = msg.meta.sender == Node::kEmpty ?\n                       van_->my_node().id : msg.meta.sender;\n      uint8_t recver = msg.meta.recver;\n      return (static_cast<uint64_t>(id) << 48) |\n          (static_cast<uint64_t>(sender) << 40) |\n          (static_cast<uint64_t>(recver) << 32) |\n          (msg.meta.timestamp << 1) | msg.meta.request;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "msg.DebugString",
          "args": [],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CHECK_NE",
          "args": [
            "msg.meta.timestamp",
            "Meta::kEmpty"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unordered_map>\n#include <unordered_set>\n#include <vector>\n#include <chrono>\n\nResender {\n  void AddOutgoing(const Message& msg) {\n      if (msg.meta.control.cmd == Control::ACK) return;\n      CHECK_NE(msg.meta.timestamp, Meta::kEmpty) << msg.DebugString();\n      auto key = GetKey(msg);\n      std::lock_guard<std::mutex> lk(mu_);\n      // already buffered, which often due to call Send by the monitor thread\n      if (send_buff_.find(key) != send_buff_.end()) return;\n  \n      auto& ent = send_buff_[key];\n      ent.msg = msg;\n      ent.send = Now();\n      ent.num_retry = 0;\n    }\n}"
  },
  {
    "function_name": "Resender",
    "container": "Resender",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2018-1281/repo/src/resender.h",
    "lines": "20-25",
    "snippet": "Resender(int timeout, int max_num_retry, Van* van) {\n    timeout_ = timeout;\n    max_num_retry_ = max_num_retry;\n    van_ = van;\n    monitor_ = new std::thread(&Resender::Monitoring, this);\n  }",
    "includes": [
      "#include <unordered_map>",
      "#include <unordered_set>",
      "#include <vector>",
      "#include <chrono>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <unordered_map>\n#include <unordered_set>\n#include <vector>\n#include <chrono>\n\nResender {\n  Resender(int timeout, int max_num_retry, Van* van) {\n      timeout_ = timeout;\n      max_num_retry_ = max_num_retry;\n      van_ = van;\n      monitor_ = new std::thread(&Resender::Monitoring, this);\n    }\n}"
  }
]