[
  {
    "function_name": "memcached_array_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/array.cc",
    "lines": "78-84",
    "snippet": "size_t memcached_array_size(memcached_array_st *array) {\n  if (array) {\n    return array->size;\n  }\n\n  return 0;\n}",
    "includes": [
      "#include <cassert>",
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <cassert>\n#include \"libmemcached/common.h\"\n\nsize_t memcached_array_size(memcached_array_st *array) {\n  if (array) {\n    return array->size;\n  }\n\n  return 0;\n}"
  },
  {
    "function_name": "memcached_array_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/array.cc",
    "lines": "71-76",
    "snippet": "void memcached_array_free(memcached_array_st *array) {\n  if (array) {\n    WATCHPOINT_ASSERT(array->root);\n    libmemcached_free(array->root, array);\n  }\n}",
    "includes": [
      "#include <cassert>",
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "libmemcached_free",
          "args": [
            "array->root",
            "array"
          ],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "libmemcached_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/memory.h",
          "lines": "30-40",
          "snippet": "static inline void libmemcached_free(const memcached_st *self, void *mem) {\n  if (self) {\n    self->allocators.free(self, mem, self->allocators.context);\n  } else if (mem) {\n#ifdef __cplusplus\n    std::free(mem);\n#else\n    free(mem);\n#endif\n  }\n}",
          "includes": [
            "#  include <stdlib.h>",
            "#  include <stddef.h>",
            "#  include <cstdlib>",
            "#  include <cstddef>",
            "#include \"libmemcached/common.h\"",
            "#include \"mem_config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#  include <stdlib.h>\n#  include <stddef.h>\n#  include <cstdlib>\n#  include <cstddef>\n#include \"libmemcached/common.h\"\n#include \"mem_config.h\"\n\nstatic inline void libmemcached_free(const memcached_st *self, void *mem) {\n  if (self) {\n    self->allocators.free(self, mem, self->allocators.context);\n  } else if (mem) {\n#ifdef __cplusplus\n    std::free(mem);\n#else\n    free(mem);\n#endif\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "WATCHPOINT_ASSERT",
          "args": [
            "array->root"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cassert>\n#include \"libmemcached/common.h\"\n\nvoid memcached_array_free(memcached_array_st *array) {\n  if (array) {\n    WATCHPOINT_ASSERT(array->root);\n    libmemcached_free(array->root, array);\n  }\n}"
  },
  {
    "function_name": "memcached_array_to_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/array.cc",
    "lines": "60-69",
    "snippet": "memcached_string_t memcached_array_to_string(memcached_array_st *array) {\n  assert(array);\n  assert(array->c_str);\n  assert(array->size);\n  memcached_string_t tmp;\n  tmp.c_str = array->c_str;\n  tmp.size = array->size;\n\n  return tmp;\n}",
    "includes": [
      "#include <cassert>",
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "array->size"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "array->c_str"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "array"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cassert>\n#include \"libmemcached/common.h\"\n\nmemcached_string_t memcached_array_to_string(memcached_array_st *array) {\n  assert(array);\n  assert(array->c_str);\n  assert(array->size);\n  memcached_string_t tmp;\n  tmp.c_str = array->c_str;\n  tmp.size = array->size;\n\n  return tmp;\n}"
  },
  {
    "function_name": "memcached_array_is_null",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/array.cc",
    "lines": "52-58",
    "snippet": "bool memcached_array_is_null(memcached_array_st *array) {\n  if (array) {\n    return false;\n  }\n\n  return true;\n}",
    "includes": [
      "#include <cassert>",
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <cassert>\n#include \"libmemcached/common.h\"\n\nbool memcached_array_is_null(memcached_array_st *array) {\n  if (array) {\n    return false;\n  }\n\n  return true;\n}"
  }
]