[
  {
    "function_name": "libmemcached_util_getpid2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcachedutil/pid.cc",
    "lines": "61-116",
    "snippet": "pid_t libmemcached_util_getpid2(const char *hostname, in_port_t port, const char *username,\n                                const char *password, memcached_return_t *ret) {\n  if (username == NULL) {\n    return libmemcached_util_getpid(hostname, port, ret);\n  }\n\n  pid_t pid = -1;\n\n  memcached_return_t unused;\n  if (not ret)\n    ret = &unused;\n\n  if (LIBMEMCACHED_WITH_SASL_SUPPORT == 0) {\n    *ret = MEMCACHED_NOT_SUPPORTED;\n    return pid;\n  }\n\n  memcached_st *memc_ptr = memcached_create(NULL);\n  if (not memc_ptr) {\n    *ret = MEMCACHED_MEMORY_ALLOCATION_FAILURE;\n    return -1;\n  }\n\n  if (memcached_failed(*ret = memcached_set_sasl_auth_data(memc_ptr, username, password))) {\n    memcached_free(memc_ptr);\n    return false;\n  }\n\n  memcached_return_t rc = memcached_server_add(memc_ptr, hostname, port);\n  if (memcached_success(rc)) {\n    memcached_stat_st *stat = memcached_stat(memc_ptr, NULL, &rc);\n    if (memcached_success(rc) and stat and stat->pid != -1) {\n      pid = stat->pid;\n    } else if (memcached_success(rc)) {\n      rc = MEMCACHED_UNKNOWN_STAT_KEY;      // Something went wrong if this happens\n    } else if (rc == MEMCACHED_SOME_ERRORS) // Generic answer, we will now find the specific reason\n                                            // (if one exists)\n    {\n      const memcached_instance_st *instance = memcached_server_instance_by_position(memc_ptr, 0);\n\n#if 0\n      assert_msg(instance and instance->error_messages, \" \");\n#endif\n      if (instance and memcached_server_error(instance)) {\n        rc = memcached_server_error_return(instance);\n      }\n    }\n\n    memcached_stat_free(memc_ptr, stat);\n  }\n  memcached_free(memc_ptr);\n\n  *ret = rc;\n\n  return pid;\n}",
    "includes": [
      "#include \"libmemcachedutil/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcached_free",
          "args": [
            "memc_ptr"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/memcached.cc",
          "lines": "257-261",
          "snippet": "void memcached_free(memcached_st *ptr) {\n  if (ptr) {\n    memcached_free_ex(ptr, true);\n  }\n}",
          "includes": [
            "#include \"libmemcached/virtual_bucket.h\"",
            "#include \"libmemcached/options.hpp\"",
            "#include \"libmemcached/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"libmemcached/virtual_bucket.h\"\n#include \"libmemcached/options.hpp\"\n#include \"libmemcached/common.h\"\n\nvoid memcached_free(memcached_st *ptr) {\n  if (ptr) {\n    memcached_free_ex(ptr, true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcached_stat_free",
          "args": [
            "memc_ptr",
            "stat"
          ],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_stat_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/stats.cc",
          "lines": "594-599",
          "snippet": "void memcached_stat_free(const memcached_st *, memcached_stat_st *memc_stat) {\n  WATCHPOINT_ASSERT(memc_stat); // Be polite, but when debugging catch this as an error\n  if (memc_stat) {\n    libmemcached_free(memc_stat->root, memc_stat);\n  }\n}",
          "includes": [
            "#include \"libmemcached/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"libmemcached/common.h\"\n\nvoid memcached_stat_free(const memcached_st *, memcached_stat_st *memc_stat) {\n  WATCHPOINT_ASSERT(memc_stat); // Be polite, but when debugging catch this as an error\n  if (memc_stat) {\n    libmemcached_free(memc_stat->root, memc_stat);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcached_server_error_return",
          "args": [
            "instance"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_server_error_return",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/error.cc",
          "lines": "541-551",
          "snippet": "memcached_return_t memcached_server_error_return(const memcached_instance_st *ptr) {\n  if (ptr == NULL) {\n    return MEMCACHED_INVALID_ARGUMENTS;\n  }\n\n  if (ptr->error_messages) {\n    return ptr->error_messages->rc;\n  }\n\n  return MEMCACHED_SUCCESS;\n}",
          "includes": [
            "#include <cstdio>",
            "#include <cstdarg>",
            "#include <cerrno>",
            "#include \"libmemcached/assert.hpp\"",
            "#include \"libmemcached/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstdio>\n#include <cstdarg>\n#include <cerrno>\n#include \"libmemcached/assert.hpp\"\n#include \"libmemcached/common.h\"\n\nmemcached_return_t memcached_server_error_return(const memcached_instance_st *ptr) {\n  if (ptr == NULL) {\n    return MEMCACHED_INVALID_ARGUMENTS;\n  }\n\n  if (ptr->error_messages) {\n    return ptr->error_messages->rc;\n  }\n\n  return MEMCACHED_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert_msg",
          "args": [
            "instance and instance->error_messages",
            "\" \""
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcached_server_instance_by_position",
          "args": [
            "memc_ptr",
            "0"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcached_success",
          "args": [
            "rc"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcached_success",
          "args": [
            "rc"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcached_stat",
          "args": [
            "memc_ptr",
            "NULL",
            "&rc"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcached_success",
          "args": [
            "rc"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcached_server_add",
          "args": [
            "memc_ptr",
            "hostname",
            "port"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_server_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/hosts.cc",
          "lines": "458-460",
          "snippet": "memcached_return_t memcached_server_add(memcached_st *shell, const char *hostname, in_port_t port) {\n  return memcached_server_add_with_weight(shell, hostname, port, 0);\n}",
          "includes": [
            "#include <cmath>",
            "#include \"p9y/random.hpp\"",
            "#include \"p9y/gettimeofday.hpp\"",
            "#include \"libmemcached/assert.hpp\"",
            "#include \"libmemcached/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cmath>\n#include \"p9y/random.hpp\"\n#include \"p9y/gettimeofday.hpp\"\n#include \"libmemcached/assert.hpp\"\n#include \"libmemcached/common.h\"\n\nmemcached_return_t memcached_server_add(memcached_st *shell, const char *hostname, in_port_t port) {\n  return memcached_server_add_with_weight(shell, hostname, port, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcached_failed",
          "args": [
            "*ret = memcached_set_sasl_auth_data(memc_ptr, username, password)"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcached_set_sasl_auth_data",
          "args": [
            "memc_ptr",
            "username",
            "password"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_set_sasl_auth_data",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/sasl.cc",
          "lines": "466-468",
          "snippet": "memcached_return_t memcached_set_sasl_auth_data(memcached_st *, const char *, const char *) {\n  return MEMCACHED_NOT_SUPPORTED;\n}",
          "includes": [
            "#  include <pthread.h>",
            "#    include <sasl/sasl.h>",
            "#include <atomic>",
            "#include <cassert>",
            "#include \"libmemcached/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#  include <pthread.h>\n#    include <sasl/sasl.h>\n#include <atomic>\n#include <cassert>\n#include \"libmemcached/common.h\"\n\nmemcached_return_t memcached_set_sasl_auth_data(memcached_st *, const char *, const char *) {\n  return MEMCACHED_NOT_SUPPORTED;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcached_create",
          "args": [
            "NULL"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "libmemcached_util_getpid",
          "args": [
            "hostname",
            "port",
            "ret"
          ],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "libmemcached_util_getpid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcachedutil/pid.cc",
          "lines": "20-59",
          "snippet": "pid_t libmemcached_util_getpid(const char *hostname, in_port_t port, memcached_return_t *ret) {\n  pid_t pid = -1;\n\n  memcached_return_t unused;\n  if (ret == NULL) {\n    ret = &unused;\n  }\n\n  memcached_st *memc_ptr = memcached_create(NULL);\n  if (memc_ptr == NULL) {\n    *ret = MEMCACHED_MEMORY_ALLOCATION_FAILURE;\n    return -1;\n  }\n\n  memcached_return_t rc = memcached_server_add(memc_ptr, hostname, port);\n  if (memcached_success(rc)) {\n    memcached_stat_st *stat = memcached_stat(memc_ptr, NULL, &rc);\n    if (memcached_success(rc) and stat and stat->pid != -1) {\n      pid = stat->pid;\n    } else if (memcached_success(rc)) {\n      rc = MEMCACHED_UNKNOWN_STAT_KEY;      // Something went wrong if this happens\n    } else if (rc == MEMCACHED_SOME_ERRORS) // Generic answer, we will now find the specific reason\n                                            // (if one exists)\n    {\n      const memcached_instance_st *instance = memcached_server_instance_by_position(memc_ptr, 0);\n\n      assert_msg(instance and memcached_server_error(instance), \" \");\n      if (instance and memcached_server_error(instance)) {\n        rc = memcached_server_error_return(instance);\n      }\n    }\n\n    memcached_stat_free(memc_ptr, stat);\n  }\n  memcached_free(memc_ptr);\n\n  *ret = rc;\n\n  return pid;\n}",
          "includes": [
            "#include \"libmemcachedutil/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"libmemcachedutil/common.h\"\n\npid_t libmemcached_util_getpid(const char *hostname, in_port_t port, memcached_return_t *ret) {\n  pid_t pid = -1;\n\n  memcached_return_t unused;\n  if (ret == NULL) {\n    ret = &unused;\n  }\n\n  memcached_st *memc_ptr = memcached_create(NULL);\n  if (memc_ptr == NULL) {\n    *ret = MEMCACHED_MEMORY_ALLOCATION_FAILURE;\n    return -1;\n  }\n\n  memcached_return_t rc = memcached_server_add(memc_ptr, hostname, port);\n  if (memcached_success(rc)) {\n    memcached_stat_st *stat = memcached_stat(memc_ptr, NULL, &rc);\n    if (memcached_success(rc) and stat and stat->pid != -1) {\n      pid = stat->pid;\n    } else if (memcached_success(rc)) {\n      rc = MEMCACHED_UNKNOWN_STAT_KEY;      // Something went wrong if this happens\n    } else if (rc == MEMCACHED_SOME_ERRORS) // Generic answer, we will now find the specific reason\n                                            // (if one exists)\n    {\n      const memcached_instance_st *instance = memcached_server_instance_by_position(memc_ptr, 0);\n\n      assert_msg(instance and memcached_server_error(instance), \" \");\n      if (instance and memcached_server_error(instance)) {\n        rc = memcached_server_error_return(instance);\n      }\n    }\n\n    memcached_stat_free(memc_ptr, stat);\n  }\n  memcached_free(memc_ptr);\n\n  *ret = rc;\n\n  return pid;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"libmemcachedutil/common.h\"\n\npid_t libmemcached_util_getpid2(const char *hostname, in_port_t port, const char *username,\n                                const char *password, memcached_return_t *ret) {\n  if (username == NULL) {\n    return libmemcached_util_getpid(hostname, port, ret);\n  }\n\n  pid_t pid = -1;\n\n  memcached_return_t unused;\n  if (not ret)\n    ret = &unused;\n\n  if (LIBMEMCACHED_WITH_SASL_SUPPORT == 0) {\n    *ret = MEMCACHED_NOT_SUPPORTED;\n    return pid;\n  }\n\n  memcached_st *memc_ptr = memcached_create(NULL);\n  if (not memc_ptr) {\n    *ret = MEMCACHED_MEMORY_ALLOCATION_FAILURE;\n    return -1;\n  }\n\n  if (memcached_failed(*ret = memcached_set_sasl_auth_data(memc_ptr, username, password))) {\n    memcached_free(memc_ptr);\n    return false;\n  }\n\n  memcached_return_t rc = memcached_server_add(memc_ptr, hostname, port);\n  if (memcached_success(rc)) {\n    memcached_stat_st *stat = memcached_stat(memc_ptr, NULL, &rc);\n    if (memcached_success(rc) and stat and stat->pid != -1) {\n      pid = stat->pid;\n    } else if (memcached_success(rc)) {\n      rc = MEMCACHED_UNKNOWN_STAT_KEY;      // Something went wrong if this happens\n    } else if (rc == MEMCACHED_SOME_ERRORS) // Generic answer, we will now find the specific reason\n                                            // (if one exists)\n    {\n      const memcached_instance_st *instance = memcached_server_instance_by_position(memc_ptr, 0);\n\n#if 0\n      assert_msg(instance and instance->error_messages, \" \");\n#endif\n      if (instance and memcached_server_error(instance)) {\n        rc = memcached_server_error_return(instance);\n      }\n    }\n\n    memcached_stat_free(memc_ptr, stat);\n  }\n  memcached_free(memc_ptr);\n\n  *ret = rc;\n\n  return pid;\n}"
  },
  {
    "function_name": "libmemcached_util_getpid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcachedutil/pid.cc",
    "lines": "20-59",
    "snippet": "pid_t libmemcached_util_getpid(const char *hostname, in_port_t port, memcached_return_t *ret) {\n  pid_t pid = -1;\n\n  memcached_return_t unused;\n  if (ret == NULL) {\n    ret = &unused;\n  }\n\n  memcached_st *memc_ptr = memcached_create(NULL);\n  if (memc_ptr == NULL) {\n    *ret = MEMCACHED_MEMORY_ALLOCATION_FAILURE;\n    return -1;\n  }\n\n  memcached_return_t rc = memcached_server_add(memc_ptr, hostname, port);\n  if (memcached_success(rc)) {\n    memcached_stat_st *stat = memcached_stat(memc_ptr, NULL, &rc);\n    if (memcached_success(rc) and stat and stat->pid != -1) {\n      pid = stat->pid;\n    } else if (memcached_success(rc)) {\n      rc = MEMCACHED_UNKNOWN_STAT_KEY;      // Something went wrong if this happens\n    } else if (rc == MEMCACHED_SOME_ERRORS) // Generic answer, we will now find the specific reason\n                                            // (if one exists)\n    {\n      const memcached_instance_st *instance = memcached_server_instance_by_position(memc_ptr, 0);\n\n      assert_msg(instance and memcached_server_error(instance), \" \");\n      if (instance and memcached_server_error(instance)) {\n        rc = memcached_server_error_return(instance);\n      }\n    }\n\n    memcached_stat_free(memc_ptr, stat);\n  }\n  memcached_free(memc_ptr);\n\n  *ret = rc;\n\n  return pid;\n}",
    "includes": [
      "#include \"libmemcachedutil/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcached_free",
          "args": [
            "memc_ptr"
          ],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/memcached.cc",
          "lines": "257-261",
          "snippet": "void memcached_free(memcached_st *ptr) {\n  if (ptr) {\n    memcached_free_ex(ptr, true);\n  }\n}",
          "includes": [
            "#include \"libmemcached/virtual_bucket.h\"",
            "#include \"libmemcached/options.hpp\"",
            "#include \"libmemcached/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"libmemcached/virtual_bucket.h\"\n#include \"libmemcached/options.hpp\"\n#include \"libmemcached/common.h\"\n\nvoid memcached_free(memcached_st *ptr) {\n  if (ptr) {\n    memcached_free_ex(ptr, true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcached_stat_free",
          "args": [
            "memc_ptr",
            "stat"
          ],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_stat_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/stats.cc",
          "lines": "594-599",
          "snippet": "void memcached_stat_free(const memcached_st *, memcached_stat_st *memc_stat) {\n  WATCHPOINT_ASSERT(memc_stat); // Be polite, but when debugging catch this as an error\n  if (memc_stat) {\n    libmemcached_free(memc_stat->root, memc_stat);\n  }\n}",
          "includes": [
            "#include \"libmemcached/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"libmemcached/common.h\"\n\nvoid memcached_stat_free(const memcached_st *, memcached_stat_st *memc_stat) {\n  WATCHPOINT_ASSERT(memc_stat); // Be polite, but when debugging catch this as an error\n  if (memc_stat) {\n    libmemcached_free(memc_stat->root, memc_stat);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcached_server_error_return",
          "args": [
            "instance"
          ],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_server_error_return",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/error.cc",
          "lines": "541-551",
          "snippet": "memcached_return_t memcached_server_error_return(const memcached_instance_st *ptr) {\n  if (ptr == NULL) {\n    return MEMCACHED_INVALID_ARGUMENTS;\n  }\n\n  if (ptr->error_messages) {\n    return ptr->error_messages->rc;\n  }\n\n  return MEMCACHED_SUCCESS;\n}",
          "includes": [
            "#include <cstdio>",
            "#include <cstdarg>",
            "#include <cerrno>",
            "#include \"libmemcached/assert.hpp\"",
            "#include \"libmemcached/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstdio>\n#include <cstdarg>\n#include <cerrno>\n#include \"libmemcached/assert.hpp\"\n#include \"libmemcached/common.h\"\n\nmemcached_return_t memcached_server_error_return(const memcached_instance_st *ptr) {\n  if (ptr == NULL) {\n    return MEMCACHED_INVALID_ARGUMENTS;\n  }\n\n  if (ptr->error_messages) {\n    return ptr->error_messages->rc;\n  }\n\n  return MEMCACHED_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert_msg",
          "args": [
            "instance and memcached_server_error(instance)",
            "\" \""
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcached_server_instance_by_position",
          "args": [
            "memc_ptr",
            "0"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcached_success",
          "args": [
            "rc"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcached_success",
          "args": [
            "rc"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcached_stat",
          "args": [
            "memc_ptr",
            "NULL",
            "&rc"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcached_success",
          "args": [
            "rc"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcached_server_add",
          "args": [
            "memc_ptr",
            "hostname",
            "port"
          ],
          "line": 34
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_server_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/hosts.cc",
          "lines": "458-460",
          "snippet": "memcached_return_t memcached_server_add(memcached_st *shell, const char *hostname, in_port_t port) {\n  return memcached_server_add_with_weight(shell, hostname, port, 0);\n}",
          "includes": [
            "#include <cmath>",
            "#include \"p9y/random.hpp\"",
            "#include \"p9y/gettimeofday.hpp\"",
            "#include \"libmemcached/assert.hpp\"",
            "#include \"libmemcached/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cmath>\n#include \"p9y/random.hpp\"\n#include \"p9y/gettimeofday.hpp\"\n#include \"libmemcached/assert.hpp\"\n#include \"libmemcached/common.h\"\n\nmemcached_return_t memcached_server_add(memcached_st *shell, const char *hostname, in_port_t port) {\n  return memcached_server_add_with_weight(shell, hostname, port, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcached_create",
          "args": [
            "NULL"
          ],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"libmemcachedutil/common.h\"\n\npid_t libmemcached_util_getpid(const char *hostname, in_port_t port, memcached_return_t *ret) {\n  pid_t pid = -1;\n\n  memcached_return_t unused;\n  if (ret == NULL) {\n    ret = &unused;\n  }\n\n  memcached_st *memc_ptr = memcached_create(NULL);\n  if (memc_ptr == NULL) {\n    *ret = MEMCACHED_MEMORY_ALLOCATION_FAILURE;\n    return -1;\n  }\n\n  memcached_return_t rc = memcached_server_add(memc_ptr, hostname, port);\n  if (memcached_success(rc)) {\n    memcached_stat_st *stat = memcached_stat(memc_ptr, NULL, &rc);\n    if (memcached_success(rc) and stat and stat->pid != -1) {\n      pid = stat->pid;\n    } else if (memcached_success(rc)) {\n      rc = MEMCACHED_UNKNOWN_STAT_KEY;      // Something went wrong if this happens\n    } else if (rc == MEMCACHED_SOME_ERRORS) // Generic answer, we will now find the specific reason\n                                            // (if one exists)\n    {\n      const memcached_instance_st *instance = memcached_server_instance_by_position(memc_ptr, 0);\n\n      assert_msg(instance and memcached_server_error(instance), \" \");\n      if (instance and memcached_server_error(instance)) {\n        rc = memcached_server_error_return(instance);\n      }\n    }\n\n    memcached_stat_free(memc_ptr, stat);\n  }\n  memcached_free(memc_ptr);\n\n  *ret = rc;\n\n  return pid;\n}"
  }
]