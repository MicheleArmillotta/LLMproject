[
  {
    "function_name": "libmemcached_util_flush",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcachedutil/flush.cc",
    "lines": "18-33",
    "snippet": "bool libmemcached_util_flush(const char *hostname, in_port_t port, memcached_return_t *ret) {\n  memcached_st *memc_ptr = memcached_create(NULL);\n\n  memcached_return_t rc = memcached_server_add(memc_ptr, hostname, port);\n  if (memcached_success(rc)) {\n    rc = memcached_flush(memc_ptr, 0);\n  }\n\n  memcached_free(memc_ptr);\n\n  if (ret) {\n    *ret = rc;\n  }\n\n  return memcached_success(rc);\n}",
    "includes": [
      "#include \"libmemcachedutil/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcached_success",
          "args": [
            "rc"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcached_free",
          "args": [
            "memc_ptr"
          ],
          "line": 26
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/memcached.cc",
          "lines": "257-261",
          "snippet": "void memcached_free(memcached_st *ptr) {\n  if (ptr) {\n    memcached_free_ex(ptr, true);\n  }\n}",
          "includes": [
            "#include \"libmemcached/virtual_bucket.h\"",
            "#include \"libmemcached/options.hpp\"",
            "#include \"libmemcached/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"libmemcached/virtual_bucket.h\"\n#include \"libmemcached/options.hpp\"\n#include \"libmemcached/common.h\"\n\nvoid memcached_free(memcached_st *ptr) {\n  if (ptr) {\n    memcached_free_ex(ptr, true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcached_flush",
          "args": [
            "memc_ptr",
            "0"
          ],
          "line": 23
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_flush",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/flush.cc",
          "lines": "104-122",
          "snippet": "memcached_return_t memcached_flush(memcached_st *shell, time_t expiration) {\n  Memcached *ptr = memcached2Memcached(shell);\n  memcached_return_t rc;\n  if (memcached_failed(rc = initialize_query(ptr, true))) {\n    return rc;\n  }\n\n  bool reply = memcached_is_replying(ptr);\n\n  LIBMEMCACHED_MEMCACHED_FLUSH_START();\n  if (memcached_is_binary(ptr)) {\n    rc = memcached_flush_binary(ptr, expiration, reply);\n  } else {\n    rc = memcached_flush_textual(ptr, expiration, reply);\n  }\n  LIBMEMCACHED_MEMCACHED_FLUSH_END();\n\n  return rc;\n}",
          "includes": [
            "#include \"libmemcached/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"libmemcached/common.h\"\n\nmemcached_return_t memcached_flush(memcached_st *shell, time_t expiration) {\n  Memcached *ptr = memcached2Memcached(shell);\n  memcached_return_t rc;\n  if (memcached_failed(rc = initialize_query(ptr, true))) {\n    return rc;\n  }\n\n  bool reply = memcached_is_replying(ptr);\n\n  LIBMEMCACHED_MEMCACHED_FLUSH_START();\n  if (memcached_is_binary(ptr)) {\n    rc = memcached_flush_binary(ptr, expiration, reply);\n  } else {\n    rc = memcached_flush_textual(ptr, expiration, reply);\n  }\n  LIBMEMCACHED_MEMCACHED_FLUSH_END();\n\n  return rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcached_success",
          "args": [
            "rc"
          ],
          "line": 22
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcached_server_add",
          "args": [
            "memc_ptr",
            "hostname",
            "port"
          ],
          "line": 21
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_server_add",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/hosts.cc",
          "lines": "458-460",
          "snippet": "memcached_return_t memcached_server_add(memcached_st *shell, const char *hostname, in_port_t port) {\n  return memcached_server_add_with_weight(shell, hostname, port, 0);\n}",
          "includes": [
            "#include <cmath>",
            "#include \"p9y/random.hpp\"",
            "#include \"p9y/gettimeofday.hpp\"",
            "#include \"libmemcached/assert.hpp\"",
            "#include \"libmemcached/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cmath>\n#include \"p9y/random.hpp\"\n#include \"p9y/gettimeofday.hpp\"\n#include \"libmemcached/assert.hpp\"\n#include \"libmemcached/common.h\"\n\nmemcached_return_t memcached_server_add(memcached_st *shell, const char *hostname, in_port_t port) {\n  return memcached_server_add_with_weight(shell, hostname, port, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcached_create",
          "args": [
            "NULL"
          ],
          "line": 19
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"libmemcachedutil/common.h\"\n\nbool libmemcached_util_flush(const char *hostname, in_port_t port, memcached_return_t *ret) {\n  memcached_st *memc_ptr = memcached_create(NULL);\n\n  memcached_return_t rc = memcached_server_add(memc_ptr, hostname, port);\n  if (memcached_success(rc)) {\n    rc = memcached_flush(memc_ptr, 0);\n  }\n\n  memcached_free(memc_ptr);\n\n  if (ret) {\n    *ret = rc;\n  }\n\n  return memcached_success(rc);\n}"
  }
]