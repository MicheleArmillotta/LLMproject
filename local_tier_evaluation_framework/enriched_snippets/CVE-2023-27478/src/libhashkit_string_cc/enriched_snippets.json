[
  {
    "function_name": "hashkit_string_set_length",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libhashkit/string.cc",
    "lines": "190-195",
    "snippet": "void hashkit_string_set_length(hashkit_string_st *self, size_t length) {\n  assert(self);\n  if (self and _string_check(self, length)) {\n    self->end = self->string + length;\n  }\n}",
    "includes": [
      "#include <cstring>",
      "#include <cassert>",
      "#include \"libhashkit/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_string_check",
          "args": [
            "self",
            "length"
          ],
          "line": 192
        },
        "resolved": true,
        "details": {
          "function_name": "_string_check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libhashkit/string.cc",
          "lines": "29-58",
          "snippet": "inline static bool _string_check(hashkit_string_st *string, size_t need) {\n  if (need and need > (size_t)(string->current_size - (size_t)(string->end - string->string))) {\n    size_t current_offset = (size_t)(string->end - string->string);\n\n    /* This is the block multiplier. To keep it larger and surive division errors we must round it\n     * up */\n    size_t adjust = (need - (size_t)(string->current_size - (size_t)(string->end - string->string)))\n        / HASHKIT_BLOCK_SIZE;\n    adjust++;\n\n    size_t new_size = sizeof(char) * (size_t)((adjust * HASHKIT_BLOCK_SIZE) + string->current_size);\n    /* Test for overflow */\n    if (new_size < need) {\n      return false;\n    }\n\n    char *new_value = (char *) realloc(string->string, new_size);\n\n    if (new_value == NULL) {\n      return false;\n    }\n\n    string->string = new_value;\n    string->end = string->string + current_offset;\n\n    string->current_size += (HASHKIT_BLOCK_SIZE * adjust);\n  }\n\n  return true;\n}",
          "includes": [
            "#include <cstring>",
            "#include <cassert>",
            "#include \"libhashkit/common.h\""
          ],
          "macros_used": [
            "#define HASHKIT_BLOCK_SIZE 1024"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <cassert>\n#include \"libhashkit/common.h\"\n\n#define HASHKIT_BLOCK_SIZE 1024\n\ninline static bool _string_check(hashkit_string_st *string, size_t need) {\n  if (need and need > (size_t)(string->current_size - (size_t)(string->end - string->string))) {\n    size_t current_offset = (size_t)(string->end - string->string);\n\n    /* This is the block multiplier. To keep it larger and surive division errors we must round it\n     * up */\n    size_t adjust = (need - (size_t)(string->current_size - (size_t)(string->end - string->string)))\n        / HASHKIT_BLOCK_SIZE;\n    adjust++;\n\n    size_t new_size = sizeof(char) * (size_t)((adjust * HASHKIT_BLOCK_SIZE) + string->current_size);\n    /* Test for overflow */\n    if (new_size < need) {\n      return false;\n    }\n\n    char *new_value = (char *) realloc(string->string, new_size);\n\n    if (new_value == NULL) {\n      return false;\n    }\n\n    string->string = new_value;\n    string->end = string->string + current_offset;\n\n    string->current_size += (HASHKIT_BLOCK_SIZE * adjust);\n  }\n\n  return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "self"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <cassert>\n#include \"libhashkit/common.h\"\n\nvoid hashkit_string_set_length(hashkit_string_st *self, size_t length) {\n  assert(self);\n  if (self and _string_check(self, length)) {\n    self->end = self->string + length;\n  }\n}"
  },
  {
    "function_name": "hashkit_string_max_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libhashkit/string.cc",
    "lines": "158-160",
    "snippet": "size_t hashkit_string_max_size(const hashkit_string_st *self) {\n  return self->current_size;\n}",
    "includes": [
      "#include <cstring>",
      "#include <cassert>",
      "#include \"libhashkit/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <cstring>\n#include <cassert>\n#include \"libhashkit/common.h\"\n\nsize_t hashkit_string_max_size(const hashkit_string_st *self) {\n  return self->current_size;\n}"
  },
  {
    "function_name": "hashkit_string_length",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libhashkit/string.cc",
    "lines": "154-156",
    "snippet": "size_t hashkit_string_length(const hashkit_string_st *self) {\n  return size_t(self->end - self->string);\n}",
    "includes": [
      "#include <cstring>",
      "#include <cassert>",
      "#include \"libhashkit/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "size_t",
          "args": [
            "self->end - self->string"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <cassert>\n#include \"libhashkit/common.h\"\n\nsize_t hashkit_string_length(const hashkit_string_st *self) {\n  return size_t(self->end - self->string);\n}"
  },
  {
    "function_name": "hashkit_string_resize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libhashkit/string.cc",
    "lines": "150-152",
    "snippet": "bool hashkit_string_resize(hashkit_string_st &string, const size_t need) {\n  return _string_check(&string, need);\n}",
    "includes": [
      "#include <cstring>",
      "#include <cassert>",
      "#include \"libhashkit/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_string_check",
          "args": [
            "&string",
            "need"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "_string_check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libhashkit/string.cc",
          "lines": "29-58",
          "snippet": "inline static bool _string_check(hashkit_string_st *string, size_t need) {\n  if (need and need > (size_t)(string->current_size - (size_t)(string->end - string->string))) {\n    size_t current_offset = (size_t)(string->end - string->string);\n\n    /* This is the block multiplier. To keep it larger and surive division errors we must round it\n     * up */\n    size_t adjust = (need - (size_t)(string->current_size - (size_t)(string->end - string->string)))\n        / HASHKIT_BLOCK_SIZE;\n    adjust++;\n\n    size_t new_size = sizeof(char) * (size_t)((adjust * HASHKIT_BLOCK_SIZE) + string->current_size);\n    /* Test for overflow */\n    if (new_size < need) {\n      return false;\n    }\n\n    char *new_value = (char *) realloc(string->string, new_size);\n\n    if (new_value == NULL) {\n      return false;\n    }\n\n    string->string = new_value;\n    string->end = string->string + current_offset;\n\n    string->current_size += (HASHKIT_BLOCK_SIZE * adjust);\n  }\n\n  return true;\n}",
          "includes": [
            "#include <cstring>",
            "#include <cassert>",
            "#include \"libhashkit/common.h\""
          ],
          "macros_used": [
            "#define HASHKIT_BLOCK_SIZE 1024"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <cassert>\n#include \"libhashkit/common.h\"\n\n#define HASHKIT_BLOCK_SIZE 1024\n\ninline static bool _string_check(hashkit_string_st *string, size_t need) {\n  if (need and need > (size_t)(string->current_size - (size_t)(string->end - string->string))) {\n    size_t current_offset = (size_t)(string->end - string->string);\n\n    /* This is the block multiplier. To keep it larger and surive division errors we must round it\n     * up */\n    size_t adjust = (need - (size_t)(string->current_size - (size_t)(string->end - string->string)))\n        / HASHKIT_BLOCK_SIZE;\n    adjust++;\n\n    size_t new_size = sizeof(char) * (size_t)((adjust * HASHKIT_BLOCK_SIZE) + string->current_size);\n    /* Test for overflow */\n    if (new_size < need) {\n      return false;\n    }\n\n    char *new_value = (char *) realloc(string->string, new_size);\n\n    if (new_value == NULL) {\n      return false;\n    }\n\n    string->string = new_value;\n    string->end = string->string + current_offset;\n\n    string->current_size += (HASHKIT_BLOCK_SIZE * adjust);\n  }\n\n  return true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <cassert>\n#include \"libhashkit/common.h\"\n\nbool hashkit_string_resize(hashkit_string_st &string, const size_t need) {\n  return _string_check(&string, need);\n}"
  },
  {
    "function_name": "hashkit_string_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libhashkit/string.cc",
    "lines": "139-148",
    "snippet": "void hashkit_string_free(hashkit_string_st *ptr) {\n  if (ptr == NULL) {\n    return;\n  }\n\n  if (ptr->string) {\n    free(ptr->string);\n  }\n  free(ptr);\n}",
    "includes": [
      "#include <cstring>",
      "#include <cassert>",
      "#include \"libhashkit/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "ptr"
          ],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "hashkit_string_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libhashkit/string.cc",
          "lines": "139-148",
          "snippet": "void hashkit_string_free(hashkit_string_st *ptr) {\n  if (ptr == NULL) {\n    return;\n  }\n\n  if (ptr->string) {\n    free(ptr->string);\n  }\n  free(ptr);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <cassert>\n#include \"libhashkit/common.h\"\n\nvoid hashkit_string_free(hashkit_string_st *ptr) {\n  if (ptr == NULL) {\n    return;\n  }\n\n  if (ptr->string) {\n    free(ptr->string);\n  }\n  free(ptr);\n}"
  },
  {
    "function_name": "hashkit_string_reset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libhashkit/string.cc",
    "lines": "135-137",
    "snippet": "void hashkit_string_reset(hashkit_string_st *string) {\n  string->end = string->string;\n}",
    "includes": [
      "#include <cstring>",
      "#include <cassert>",
      "#include \"libhashkit/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <cstring>\n#include <cassert>\n#include \"libhashkit/common.h\"\n\nvoid hashkit_string_reset(hashkit_string_st *string) {\n  string->end = string->string;\n}"
  },
  {
    "function_name": "hashkit_string_append",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libhashkit/string.cc",
    "lines": "104-117",
    "snippet": "bool hashkit_string_append(hashkit_string_st *string, const char *value, size_t length) {\n  if (_string_check(string, length) == false) {\n    return false;\n  }\n\n  assert(length <= string->current_size);\n  assert(string->string);\n  assert(string->end >= string->string);\n\n  memcpy(string->end, value, length);\n  string->end += length;\n\n  return true;\n}",
    "includes": [
      "#include <cstring>",
      "#include <cassert>",
      "#include \"libhashkit/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "string->end",
            "value",
            "length"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "string->end >= string->string"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "string->string"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "length <= string->current_size"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_string_check",
          "args": [
            "string",
            "length"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "_string_check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libhashkit/string.cc",
          "lines": "29-58",
          "snippet": "inline static bool _string_check(hashkit_string_st *string, size_t need) {\n  if (need and need > (size_t)(string->current_size - (size_t)(string->end - string->string))) {\n    size_t current_offset = (size_t)(string->end - string->string);\n\n    /* This is the block multiplier. To keep it larger and surive division errors we must round it\n     * up */\n    size_t adjust = (need - (size_t)(string->current_size - (size_t)(string->end - string->string)))\n        / HASHKIT_BLOCK_SIZE;\n    adjust++;\n\n    size_t new_size = sizeof(char) * (size_t)((adjust * HASHKIT_BLOCK_SIZE) + string->current_size);\n    /* Test for overflow */\n    if (new_size < need) {\n      return false;\n    }\n\n    char *new_value = (char *) realloc(string->string, new_size);\n\n    if (new_value == NULL) {\n      return false;\n    }\n\n    string->string = new_value;\n    string->end = string->string + current_offset;\n\n    string->current_size += (HASHKIT_BLOCK_SIZE * adjust);\n  }\n\n  return true;\n}",
          "includes": [
            "#include <cstring>",
            "#include <cassert>",
            "#include \"libhashkit/common.h\""
          ],
          "macros_used": [
            "#define HASHKIT_BLOCK_SIZE 1024"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <cassert>\n#include \"libhashkit/common.h\"\n\n#define HASHKIT_BLOCK_SIZE 1024\n\ninline static bool _string_check(hashkit_string_st *string, size_t need) {\n  if (need and need > (size_t)(string->current_size - (size_t)(string->end - string->string))) {\n    size_t current_offset = (size_t)(string->end - string->string);\n\n    /* This is the block multiplier. To keep it larger and surive division errors we must round it\n     * up */\n    size_t adjust = (need - (size_t)(string->current_size - (size_t)(string->end - string->string)))\n        / HASHKIT_BLOCK_SIZE;\n    adjust++;\n\n    size_t new_size = sizeof(char) * (size_t)((adjust * HASHKIT_BLOCK_SIZE) + string->current_size);\n    /* Test for overflow */\n    if (new_size < need) {\n      return false;\n    }\n\n    char *new_value = (char *) realloc(string->string, new_size);\n\n    if (new_value == NULL) {\n      return false;\n    }\n\n    string->string = new_value;\n    string->end = string->string + current_offset;\n\n    string->current_size += (HASHKIT_BLOCK_SIZE * adjust);\n  }\n\n  return true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <cassert>\n#include \"libhashkit/common.h\"\n\nbool hashkit_string_append(hashkit_string_st *string, const char *value, size_t length) {\n  if (_string_check(string, length) == false) {\n    return false;\n  }\n\n  assert(length <= string->current_size);\n  assert(string->string);\n  assert(string->end >= string->string);\n\n  memcpy(string->end, value, length);\n  string->end += length;\n\n  return true;\n}"
  },
  {
    "function_name": "hashkit_string_append_character",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libhashkit/string.cc",
    "lines": "93-102",
    "snippet": "bool hashkit_string_append_character(hashkit_string_st *string, char character) {\n  if (_string_check(string, 1) == false) {\n    return false;\n  }\n\n  *string->end = character;\n  string->end++;\n\n  return true;\n}",
    "includes": [
      "#include <cstring>",
      "#include <cassert>",
      "#include \"libhashkit/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_string_check",
          "args": [
            "string",
            "1"
          ],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "_string_check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libhashkit/string.cc",
          "lines": "29-58",
          "snippet": "inline static bool _string_check(hashkit_string_st *string, size_t need) {\n  if (need and need > (size_t)(string->current_size - (size_t)(string->end - string->string))) {\n    size_t current_offset = (size_t)(string->end - string->string);\n\n    /* This is the block multiplier. To keep it larger and surive division errors we must round it\n     * up */\n    size_t adjust = (need - (size_t)(string->current_size - (size_t)(string->end - string->string)))\n        / HASHKIT_BLOCK_SIZE;\n    adjust++;\n\n    size_t new_size = sizeof(char) * (size_t)((adjust * HASHKIT_BLOCK_SIZE) + string->current_size);\n    /* Test for overflow */\n    if (new_size < need) {\n      return false;\n    }\n\n    char *new_value = (char *) realloc(string->string, new_size);\n\n    if (new_value == NULL) {\n      return false;\n    }\n\n    string->string = new_value;\n    string->end = string->string + current_offset;\n\n    string->current_size += (HASHKIT_BLOCK_SIZE * adjust);\n  }\n\n  return true;\n}",
          "includes": [
            "#include <cstring>",
            "#include <cassert>",
            "#include \"libhashkit/common.h\""
          ],
          "macros_used": [
            "#define HASHKIT_BLOCK_SIZE 1024"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <cassert>\n#include \"libhashkit/common.h\"\n\n#define HASHKIT_BLOCK_SIZE 1024\n\ninline static bool _string_check(hashkit_string_st *string, size_t need) {\n  if (need and need > (size_t)(string->current_size - (size_t)(string->end - string->string))) {\n    size_t current_offset = (size_t)(string->end - string->string);\n\n    /* This is the block multiplier. To keep it larger and surive division errors we must round it\n     * up */\n    size_t adjust = (need - (size_t)(string->current_size - (size_t)(string->end - string->string)))\n        / HASHKIT_BLOCK_SIZE;\n    adjust++;\n\n    size_t new_size = sizeof(char) * (size_t)((adjust * HASHKIT_BLOCK_SIZE) + string->current_size);\n    /* Test for overflow */\n    if (new_size < need) {\n      return false;\n    }\n\n    char *new_value = (char *) realloc(string->string, new_size);\n\n    if (new_value == NULL) {\n      return false;\n    }\n\n    string->string = new_value;\n    string->end = string->string + current_offset;\n\n    string->current_size += (HASHKIT_BLOCK_SIZE * adjust);\n  }\n\n  return true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <cassert>\n#include \"libhashkit/common.h\"\n\nbool hashkit_string_append_character(hashkit_string_st *string, char character) {\n  if (_string_check(string, 1) == false) {\n    return false;\n  }\n\n  *string->end = character;\n  string->end++;\n\n  return true;\n}"
  },
  {
    "function_name": "hashkit_string_append_null",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libhashkit/string.cc",
    "lines": "80-90",
    "snippet": "static bool hashkit_string_append_null(hashkit_string_st *string)\n{\n  if (_string_check(string, 1) == false)\n  {\n    return false;\n  }\n\n  *string->end= 0;\n\n  return true;\n}",
    "includes": [
      "#include <cstring>",
      "#include <cassert>",
      "#include \"libhashkit/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_string_check",
          "args": [
            "string",
            "1"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "_string_check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libhashkit/string.cc",
          "lines": "29-58",
          "snippet": "inline static bool _string_check(hashkit_string_st *string, size_t need) {\n  if (need and need > (size_t)(string->current_size - (size_t)(string->end - string->string))) {\n    size_t current_offset = (size_t)(string->end - string->string);\n\n    /* This is the block multiplier. To keep it larger and surive division errors we must round it\n     * up */\n    size_t adjust = (need - (size_t)(string->current_size - (size_t)(string->end - string->string)))\n        / HASHKIT_BLOCK_SIZE;\n    adjust++;\n\n    size_t new_size = sizeof(char) * (size_t)((adjust * HASHKIT_BLOCK_SIZE) + string->current_size);\n    /* Test for overflow */\n    if (new_size < need) {\n      return false;\n    }\n\n    char *new_value = (char *) realloc(string->string, new_size);\n\n    if (new_value == NULL) {\n      return false;\n    }\n\n    string->string = new_value;\n    string->end = string->string + current_offset;\n\n    string->current_size += (HASHKIT_BLOCK_SIZE * adjust);\n  }\n\n  return true;\n}",
          "includes": [
            "#include <cstring>",
            "#include <cassert>",
            "#include \"libhashkit/common.h\""
          ],
          "macros_used": [
            "#define HASHKIT_BLOCK_SIZE 1024"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <cassert>\n#include \"libhashkit/common.h\"\n\n#define HASHKIT_BLOCK_SIZE 1024\n\ninline static bool _string_check(hashkit_string_st *string, size_t need) {\n  if (need and need > (size_t)(string->current_size - (size_t)(string->end - string->string))) {\n    size_t current_offset = (size_t)(string->end - string->string);\n\n    /* This is the block multiplier. To keep it larger and surive division errors we must round it\n     * up */\n    size_t adjust = (need - (size_t)(string->current_size - (size_t)(string->end - string->string)))\n        / HASHKIT_BLOCK_SIZE;\n    adjust++;\n\n    size_t new_size = sizeof(char) * (size_t)((adjust * HASHKIT_BLOCK_SIZE) + string->current_size);\n    /* Test for overflow */\n    if (new_size < need) {\n      return false;\n    }\n\n    char *new_value = (char *) realloc(string->string, new_size);\n\n    if (new_value == NULL) {\n      return false;\n    }\n\n    string->string = new_value;\n    string->end = string->string + current_offset;\n\n    string->current_size += (HASHKIT_BLOCK_SIZE * adjust);\n  }\n\n  return true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <cassert>\n#include \"libhashkit/common.h\"\n\nstatic bool hashkit_string_append_null(hashkit_string_st *string)\n{\n  if (_string_check(string, 1) == false)\n  {\n    return false;\n  }\n\n  *string->end= 0;\n\n  return true;\n}"
  },
  {
    "function_name": "_init_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libhashkit/string.cc",
    "lines": "60-63",
    "snippet": "static inline void _init_string(hashkit_string_st *self) {\n  self->current_size = 0;\n  self->end = self->string = NULL;\n}",
    "includes": [
      "#include <cstring>",
      "#include <cassert>",
      "#include \"libhashkit/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <cstring>\n#include <cassert>\n#include \"libhashkit/common.h\"\n\nstatic inline void _init_string(hashkit_string_st *self) {\n  self->current_size = 0;\n  self->end = self->string = NULL;\n}"
  },
  {
    "function_name": "_string_check",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libhashkit/string.cc",
    "lines": "29-58",
    "snippet": "inline static bool _string_check(hashkit_string_st *string, size_t need) {\n  if (need and need > (size_t)(string->current_size - (size_t)(string->end - string->string))) {\n    size_t current_offset = (size_t)(string->end - string->string);\n\n    /* This is the block multiplier. To keep it larger and surive division errors we must round it\n     * up */\n    size_t adjust = (need - (size_t)(string->current_size - (size_t)(string->end - string->string)))\n        / HASHKIT_BLOCK_SIZE;\n    adjust++;\n\n    size_t new_size = sizeof(char) * (size_t)((adjust * HASHKIT_BLOCK_SIZE) + string->current_size);\n    /* Test for overflow */\n    if (new_size < need) {\n      return false;\n    }\n\n    char *new_value = (char *) realloc(string->string, new_size);\n\n    if (new_value == NULL) {\n      return false;\n    }\n\n    string->string = new_value;\n    string->end = string->string + current_offset;\n\n    string->current_size += (HASHKIT_BLOCK_SIZE * adjust);\n  }\n\n  return true;\n}",
    "includes": [
      "#include <cstring>",
      "#include <cassert>",
      "#include \"libhashkit/common.h\""
    ],
    "macros_used": [
      "#define HASHKIT_BLOCK_SIZE 1024"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "realloc",
          "args": [
            "string->string",
            "new_size"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <cassert>\n#include \"libhashkit/common.h\"\n\n#define HASHKIT_BLOCK_SIZE 1024\n\ninline static bool _string_check(hashkit_string_st *string, size_t need) {\n  if (need and need > (size_t)(string->current_size - (size_t)(string->end - string->string))) {\n    size_t current_offset = (size_t)(string->end - string->string);\n\n    /* This is the block multiplier. To keep it larger and surive division errors we must round it\n     * up */\n    size_t adjust = (need - (size_t)(string->current_size - (size_t)(string->end - string->string)))\n        / HASHKIT_BLOCK_SIZE;\n    adjust++;\n\n    size_t new_size = sizeof(char) * (size_t)((adjust * HASHKIT_BLOCK_SIZE) + string->current_size);\n    /* Test for overflow */\n    if (new_size < need) {\n      return false;\n    }\n\n    char *new_value = (char *) realloc(string->string, new_size);\n\n    if (new_value == NULL) {\n      return false;\n    }\n\n    string->string = new_value;\n    string->end = string->string + current_offset;\n\n    string->current_size += (HASHKIT_BLOCK_SIZE * adjust);\n  }\n\n  return true;\n}"
  }
]