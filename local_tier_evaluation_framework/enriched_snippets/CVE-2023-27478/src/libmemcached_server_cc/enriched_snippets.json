[
  {
    "function_name": "memcached_server_micro_version",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/server.cc",
    "lines": "221-227",
    "snippet": "uint8_t memcached_server_micro_version(const memcached_instance_st *instance) {\n  if (instance) {\n    return instance->micro_version;\n  }\n\n  return UINT8_MAX;\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nuint8_t memcached_server_micro_version(const memcached_instance_st *instance) {\n  if (instance) {\n    return instance->micro_version;\n  }\n\n  return UINT8_MAX;\n}"
  },
  {
    "function_name": "memcached_server_minor_version",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/server.cc",
    "lines": "213-219",
    "snippet": "uint8_t memcached_server_minor_version(const memcached_instance_st *instance) {\n  if (instance) {\n    return instance->minor_version;\n  }\n\n  return UINT8_MAX;\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nuint8_t memcached_server_minor_version(const memcached_instance_st *instance) {\n  if (instance) {\n    return instance->minor_version;\n  }\n\n  return UINT8_MAX;\n}"
  },
  {
    "function_name": "memcached_server_major_version",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/server.cc",
    "lines": "205-211",
    "snippet": "uint8_t memcached_server_major_version(const memcached_instance_st *instance) {\n  if (instance) {\n    return instance->major_version;\n  }\n\n  return UINT8_MAX;\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nuint8_t memcached_server_major_version(const memcached_instance_st *instance) {\n  if (instance) {\n    return instance->major_version;\n  }\n\n  return UINT8_MAX;\n}"
  },
  {
    "function_name": "memcached_server_response_count",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/server.cc",
    "lines": "179-186",
    "snippet": "uint32_t memcached_server_response_count(const memcached_instance_st *self) {\n  WATCHPOINT_ASSERT(self);\n  if (self == NULL) {\n    return 0;\n  }\n\n  return self->cursor_active_;\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WATCHPOINT_ASSERT",
          "args": [
            "self"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nuint32_t memcached_server_response_count(const memcached_instance_st *self) {\n  WATCHPOINT_ASSERT(self);\n  if (self == NULL) {\n    return 0;\n  }\n\n  return self->cursor_active_;\n}"
  },
  {
    "function_name": "memcached_server_srcport",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/server.cc",
    "lines": "162-177",
    "snippet": "in_port_t memcached_server_srcport(const memcached_instance_st *self) {\n  WATCHPOINT_ASSERT(self);\n  if (self == NULL || self->fd == INVALID_SOCKET\n      || (self->type != MEMCACHED_CONNECTION_TCP && self->type != MEMCACHED_CONNECTION_UDP))\n  {\n    return 0;\n  }\n\n  struct sockaddr_in sin;\n  socklen_t addrlen = sizeof(sin);\n  if (getsockname(self->fd, (struct sockaddr *) &sin, &addrlen) != -1) {\n    return ntohs(sin.sin_port);\n  }\n\n  return -1;\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ntohs",
          "args": [
            "sin.sin_port"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getsockname",
          "args": [
            "self->fd",
            "(struct sockaddr *) &sin",
            "&addrlen"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WATCHPOINT_ASSERT",
          "args": [
            "self"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nin_port_t memcached_server_srcport(const memcached_instance_st *self) {\n  WATCHPOINT_ASSERT(self);\n  if (self == NULL || self->fd == INVALID_SOCKET\n      || (self->type != MEMCACHED_CONNECTION_TCP && self->type != MEMCACHED_CONNECTION_UDP))\n  {\n    return 0;\n  }\n\n  struct sockaddr_in sin;\n  socklen_t addrlen = sizeof(sin);\n  if (getsockname(self->fd, (struct sockaddr *) &sin, &addrlen) != -1) {\n    return ntohs(sin.sin_port);\n  }\n\n  return -1;\n}"
  },
  {
    "function_name": "memcached_server_port",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/server.cc",
    "lines": "153-160",
    "snippet": "in_port_t memcached_server_port(const memcached_instance_st *self) {\n  WATCHPOINT_ASSERT(self);\n  if (self == NULL) {\n    return 0;\n  }\n\n  return self->port();\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "self->port",
          "args": [],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "port",
          "container": "memcached_instance_st",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/instance.hpp",
          "lines": "40-40",
          "snippet": "in_port_t port() const { return port_; }",
          "includes": [
            "#include \"libmemcached/string.hpp\"",
            "#    include <netdb.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"libmemcached/string.hpp\"\n#    include <netdb.h>\n\nmemcached_instance_st {\n  in_port_t port() const { return port_; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "WATCHPOINT_ASSERT",
          "args": [
            "self"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nin_port_t memcached_server_port(const memcached_instance_st *self) {\n  WATCHPOINT_ASSERT(self);\n  if (self == NULL) {\n    return 0;\n  }\n\n  return self->port();\n}"
  },
  {
    "function_name": "memcached_server_count",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/server.cc",
    "lines": "136-142",
    "snippet": "uint32_t memcached_server_count(const memcached_st *self) {\n  WATCHPOINT_ASSERT(self);\n  if (self == NULL)\n    return 0;\n\n  return self->number_of_hosts;\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WATCHPOINT_ASSERT",
          "args": [
            "self"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nuint32_t memcached_server_count(const memcached_st *self) {\n  WATCHPOINT_ASSERT(self);\n  if (self == NULL)\n    return 0;\n\n  return self->number_of_hosts;\n}"
  },
  {
    "function_name": "memcached_servers_set_count",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/server.cc",
    "lines": "127-134",
    "snippet": "uint32_t memcached_servers_set_count(memcached_server_st *servers, uint32_t count) {\n  WATCHPOINT_ASSERT(servers);\n  if (servers == NULL) {\n    return 0;\n  }\n\n  return servers->number_of_hosts = count;\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WATCHPOINT_ASSERT",
          "args": [
            "servers"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nuint32_t memcached_servers_set_count(memcached_server_st *servers, uint32_t count) {\n  WATCHPOINT_ASSERT(servers);\n  if (servers == NULL) {\n    return 0;\n  }\n\n  return servers->number_of_hosts = count;\n}"
  },
  {
    "function_name": "memcached_server_error_reset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/server.cc",
    "lines": "118-125",
    "snippet": "void memcached_server_error_reset(memcached_server_st *self) {\n  WATCHPOINT_ASSERT(self);\n  if (self == NULL) {\n    return;\n  }\n\n  memcached_error_free(*self);\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcached_error_free",
          "args": [
            "*self"
          ],
          "line": 124
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_error_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/error.cc",
          "lines": "447-450",
          "snippet": "void memcached_error_free(memcached_server_st &self) {\n  _error_free(self.error_messages);\n  self.error_messages = NULL;\n}",
          "includes": [
            "#include <cstdio>",
            "#include <cstdarg>",
            "#include <cerrno>",
            "#include \"libmemcached/assert.hpp\"",
            "#include \"libmemcached/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstdio>\n#include <cstdarg>\n#include <cerrno>\n#include \"libmemcached/assert.hpp\"\n#include \"libmemcached/common.h\"\n\nvoid memcached_error_free(memcached_server_st &self) {\n  _error_free(self.error_messages);\n  self.error_messages = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "WATCHPOINT_ASSERT",
          "args": [
            "self"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nvoid memcached_server_error_reset(memcached_server_st *self) {\n  WATCHPOINT_ASSERT(self);\n  if (self == NULL) {\n    return;\n  }\n\n  memcached_error_free(*self);\n}"
  },
  {
    "function_name": "memcached_server_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/server.cc",
    "lines": "105-116",
    "snippet": "void memcached_server_free(memcached_server_st *self) {\n  if (self == NULL) {\n    return;\n  }\n\n  if (memcached_server_list_count(self)) {\n    memcached_server_list_free(self);\n    return;\n  }\n\n  server_free(self);\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "server_free",
          "args": [
            "self"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_server_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/server.cc",
          "lines": "105-116",
          "snippet": "void memcached_server_free(memcached_server_st *self) {\n  if (self == NULL) {\n    return;\n  }\n\n  if (memcached_server_list_count(self)) {\n    memcached_server_list_free(self);\n    return;\n  }\n\n  server_free(self);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "memcached_server_list_free",
          "args": [
            "self"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_server_list_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/server_list.cc",
          "lines": "98-109",
          "snippet": "void memcached_server_list_free(memcached_server_list_st self) {\n  if (self) {\n    for (uint32_t x = 0; x < memcached_server_list_count(self); x++) {\n      assert_msg(not memcached_is_allocated(&self[x]),\n                 \"You have called memcached_server_list_free(), but you did not pass it a valid \"\n                 \"memcached_server_list_st\");\n      server_free(&self[x]);\n    }\n\n    libmemcached_free(self->root, self);\n  }\n}",
          "includes": [
            "#include \"libmemcached/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"libmemcached/common.h\"\n\nvoid memcached_server_list_free(memcached_server_list_st self) {\n  if (self) {\n    for (uint32_t x = 0; x < memcached_server_list_count(self); x++) {\n      assert_msg(not memcached_is_allocated(&self[x]),\n                 \"You have called memcached_server_list_free(), but you did not pass it a valid \"\n                 \"memcached_server_list_st\");\n      server_free(&self[x]);\n    }\n\n    libmemcached_free(self->root, self);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcached_server_list_count",
          "args": [
            "self"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_server_list_count",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/server_list.cc",
          "lines": "83-85",
          "snippet": "uint32_t memcached_server_list_count(const memcached_server_list_st self) {\n  return (self == NULL) ? 0 : self->number_of_hosts;\n}",
          "includes": [
            "#include \"libmemcached/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"libmemcached/common.h\"\n\nuint32_t memcached_server_list_count(const memcached_server_list_st self) {\n  return (self == NULL) ? 0 : self->number_of_hosts;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nvoid memcached_server_free(memcached_server_st *self) {\n  if (self == NULL) {\n    return;\n  }\n\n  if (memcached_server_list_count(self)) {\n    memcached_server_list_free(self);\n    return;\n  }\n\n  server_free(self);\n}"
  },
  {
    "function_name": "server_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/server.cc",
    "lines": "95-103",
    "snippet": "void server_free(memcached_server_st *self) {\n  memcached_error_free(*self);\n\n  if (memcached_is_allocated(self)) {\n    libmemcached_free(self->root, self);\n  } else {\n    self->options.is_initialized = false;\n  }\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "libmemcached_free",
          "args": [
            "self->root",
            "self"
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "libmemcached_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/memory.h",
          "lines": "30-40",
          "snippet": "static inline void libmemcached_free(const memcached_st *self, void *mem) {\n  if (self) {\n    self->allocators.free(self, mem, self->allocators.context);\n  } else if (mem) {\n#ifdef __cplusplus\n    std::free(mem);\n#else\n    free(mem);\n#endif\n  }\n}",
          "includes": [
            "#  include <stdlib.h>",
            "#  include <stddef.h>",
            "#  include <cstdlib>",
            "#  include <cstddef>",
            "#include \"libmemcached/common.h\"",
            "#include \"mem_config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#  include <stdlib.h>\n#  include <stddef.h>\n#  include <cstdlib>\n#  include <cstddef>\n#include \"libmemcached/common.h\"\n#include \"mem_config.h\"\n\nstatic inline void libmemcached_free(const memcached_st *self, void *mem) {\n  if (self) {\n    self->allocators.free(self, mem, self->allocators.context);\n  } else if (mem) {\n#ifdef __cplusplus\n    std::free(mem);\n#else\n    free(mem);\n#endif\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcached_is_allocated",
          "args": [
            "self"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcached_error_free",
          "args": [
            "*self"
          ],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_error_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/error.cc",
          "lines": "447-450",
          "snippet": "void memcached_error_free(memcached_server_st &self) {\n  _error_free(self.error_messages);\n  self.error_messages = NULL;\n}",
          "includes": [
            "#include <cstdio>",
            "#include <cstdarg>",
            "#include <cerrno>",
            "#include \"libmemcached/assert.hpp\"",
            "#include \"libmemcached/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstdio>\n#include <cstdarg>\n#include <cerrno>\n#include \"libmemcached/assert.hpp\"\n#include \"libmemcached/common.h\"\n\nvoid memcached_error_free(memcached_server_st &self) {\n  _error_free(self.error_messages);\n  self.error_messages = NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nvoid server_free(memcached_server_st *self) {\n  memcached_error_free(*self);\n\n  if (memcached_is_allocated(self)) {\n    libmemcached_free(self->root, self);\n  } else {\n    self->options.is_initialized = false;\n  }\n}"
  },
  {
    "function_name": "_server_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/server.cc",
    "lines": "18-55",
    "snippet": "static inline void _server_init(memcached_server_st *self, Memcached *root,\n                                const memcached_string_t &hostname, in_port_t port, uint32_t weight,\n                                memcached_connection_t type) {\n  self->options.is_shutting_down = false;\n  self->options.is_dead = false;\n  self->number_of_hosts = 0;\n  self->cursor_active = 0;\n  self->port = port;\n  self->io_bytes_sent = 0;\n  self->request_id = 0;\n  self->server_failure_counter = 0;\n  self->server_failure_counter_query_id = 0;\n  self->server_timeout_counter = 0;\n  self->server_timeout_counter_query_id = 0;\n  self->weight = weight ? weight : 1; // 1 is the default weight value\n  self->io_wait_count.read = 0;\n  self->io_wait_count.write = 0;\n  self->io_wait_count.timeouts = 0;\n  self->io_wait_count._bytes_read = 0;\n  self->major_version = UINT8_MAX;\n  self->micro_version = UINT8_MAX;\n  self->minor_version = UINT8_MAX;\n  self->type = type;\n  self->error_messages = NULL;\n\n  self->state = MEMCACHED_SERVER_STATE_NEW;\n  self->next_retry = 0;\n\n  self->root = root;\n  if (root) {\n    self->version = ++root->server_info.version;\n  } else {\n    self->version = UINT_MAX;\n  }\n  self->limit_maxbytes = 0;\n  memcpy(self->hostname, hostname.c_str, hostname.size);\n  self->hostname[hostname.size] = 0;\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "self->hostname",
            "hostname.c_str",
            "hostname.size"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nstatic inline void _server_init(memcached_server_st *self, Memcached *root,\n                                const memcached_string_t &hostname, in_port_t port, uint32_t weight,\n                                memcached_connection_t type) {\n  self->options.is_shutting_down = false;\n  self->options.is_dead = false;\n  self->number_of_hosts = 0;\n  self->cursor_active = 0;\n  self->port = port;\n  self->io_bytes_sent = 0;\n  self->request_id = 0;\n  self->server_failure_counter = 0;\n  self->server_failure_counter_query_id = 0;\n  self->server_timeout_counter = 0;\n  self->server_timeout_counter_query_id = 0;\n  self->weight = weight ? weight : 1; // 1 is the default weight value\n  self->io_wait_count.read = 0;\n  self->io_wait_count.write = 0;\n  self->io_wait_count.timeouts = 0;\n  self->io_wait_count._bytes_read = 0;\n  self->major_version = UINT8_MAX;\n  self->micro_version = UINT8_MAX;\n  self->minor_version = UINT8_MAX;\n  self->type = type;\n  self->error_messages = NULL;\n\n  self->state = MEMCACHED_SERVER_STATE_NEW;\n  self->next_retry = 0;\n\n  self->root = root;\n  if (root) {\n    self->version = ++root->server_info.version;\n  } else {\n    self->version = UINT_MAX;\n  }\n  self->limit_maxbytes = 0;\n  memcpy(self->hostname, hostname.c_str, hostname.size);\n  self->hostname[hostname.size] = 0;\n}"
  }
]