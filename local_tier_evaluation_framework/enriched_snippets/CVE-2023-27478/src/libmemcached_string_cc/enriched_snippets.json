[
  {
    "function_name": "memcached_string_set_length",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/string.cc",
    "lines": "254-263",
    "snippet": "void memcached_string_set_length(memcached_string_st &self, const size_t length) {\n  assert(self.current_size >= length);\n  size_t set_length = length;\n  if (self.current_size > length) {\n    if (memcached_failed(_string_check(&self, length))) {\n      set_length = self.current_size;\n    }\n  }\n  self.end = self.string + set_length;\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcached_failed",
          "args": [
            "_string_check(&self, length)"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_string_check",
          "args": [
            "&self",
            "length"
          ],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_string_check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/string.cc",
          "lines": "195-197",
          "snippet": "memcached_return_t memcached_string_check(memcached_string_st *string, size_t need) {\n  return _string_check(string, need);\n}",
          "includes": [
            "#include \"libmemcached/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"libmemcached/common.h\"\n\nmemcached_return_t memcached_string_check(memcached_string_st *string, size_t need) {\n  return _string_check(string, need);\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "self.current_size >= length"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nvoid memcached_string_set_length(memcached_string_st &self, const size_t length) {\n  assert(self.current_size >= length);\n  size_t set_length = length;\n  if (self.current_size > length) {\n    if (memcached_failed(_string_check(&self, length))) {\n      set_length = self.current_size;\n    }\n  }\n  self.end = self.string + set_length;\n}"
  },
  {
    "function_name": "memcached_string_set_length",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/string.cc",
    "lines": "250-252",
    "snippet": "void memcached_string_set_length(memcached_string_st *self, size_t length) {\n  self->end = self->string + length;\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nvoid memcached_string_set_length(memcached_string_st *self, size_t length) {\n  self->end = self->string + length;\n}"
  },
  {
    "function_name": "memcached_string_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/string.cc",
    "lines": "211-213",
    "snippet": "size_t memcached_string_size(const memcached_string_st *self) {\n  return self->current_size;\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nsize_t memcached_string_size(const memcached_string_st *self) {\n  return self->current_size;\n}"
  },
  {
    "function_name": "memcached_string_length",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/string.cc",
    "lines": "207-209",
    "snippet": "size_t memcached_string_length(const memcached_string_st &self) {\n  return size_t(self.end - self.string);\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "size_t",
          "args": [
            "self.end - self.string"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nsize_t memcached_string_length(const memcached_string_st &self) {\n  return size_t(self.end - self.string);\n}"
  },
  {
    "function_name": "memcached_string_length",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/string.cc",
    "lines": "203-205",
    "snippet": "size_t memcached_string_length(const memcached_string_st *self) {\n  return size_t(self->end - self->string);\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "size_t",
          "args": [
            "self->end - self->string"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nsize_t memcached_string_length(const memcached_string_st *self) {\n  return size_t(self->end - self->string);\n}"
  },
  {
    "function_name": "memcached_string_resize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/string.cc",
    "lines": "199-201",
    "snippet": "bool memcached_string_resize(memcached_string_st &string, const size_t need) {\n  return memcached_success(_string_check(&string, need));\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcached_success",
          "args": [
            "_string_check(&string, need)"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_string_check",
          "args": [
            "&string",
            "need"
          ],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_string_check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/string.cc",
          "lines": "195-197",
          "snippet": "memcached_return_t memcached_string_check(memcached_string_st *string, size_t need) {\n  return _string_check(string, need);\n}",
          "includes": [
            "#include \"libmemcached/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"libmemcached/common.h\"\n\nmemcached_return_t memcached_string_check(memcached_string_st *string, size_t need) {\n  return _string_check(string, need);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nbool memcached_string_resize(memcached_string_st &string, const size_t need) {\n  return memcached_success(_string_check(&string, need));\n}"
  },
  {
    "function_name": "memcached_string_check",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/string.cc",
    "lines": "195-197",
    "snippet": "memcached_return_t memcached_string_check(memcached_string_st *string, size_t need) {\n  return _string_check(string, need);\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_string_check",
          "args": [
            "string",
            "need"
          ],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_string_check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/string.cc",
          "lines": "195-197",
          "snippet": "memcached_return_t memcached_string_check(memcached_string_st *string, size_t need) {\n  return _string_check(string, need);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nmemcached_return_t memcached_string_check(memcached_string_st *string, size_t need) {\n  return _string_check(string, need);\n}"
  },
  {
    "function_name": "memcached_string_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/string.cc",
    "lines": "179-193",
    "snippet": "void memcached_string_free(memcached_string_st *ptr) {\n  if (ptr == NULL) {\n    return;\n  }\n\n  if (ptr->string) {\n    libmemcached_free(ptr->root, ptr->string);\n  }\n\n  if (memcached_is_allocated(ptr)) {\n    libmemcached_free(ptr->root, ptr);\n  } else {\n    ptr->options.is_initialized = false;\n  }\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "libmemcached_free",
          "args": [
            "ptr->root",
            "ptr"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "libmemcached_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/memory.h",
          "lines": "30-40",
          "snippet": "static inline void libmemcached_free(const memcached_st *self, void *mem) {\n  if (self) {\n    self->allocators.free(self, mem, self->allocators.context);\n  } else if (mem) {\n#ifdef __cplusplus\n    std::free(mem);\n#else\n    free(mem);\n#endif\n  }\n}",
          "includes": [
            "#  include <stdlib.h>",
            "#  include <stddef.h>",
            "#  include <cstdlib>",
            "#  include <cstddef>",
            "#include \"libmemcached/common.h\"",
            "#include \"mem_config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#  include <stdlib.h>\n#  include <stddef.h>\n#  include <cstdlib>\n#  include <cstddef>\n#include \"libmemcached/common.h\"\n#include \"mem_config.h\"\n\nstatic inline void libmemcached_free(const memcached_st *self, void *mem) {\n  if (self) {\n    self->allocators.free(self, mem, self->allocators.context);\n  } else if (mem) {\n#ifdef __cplusplus\n    std::free(mem);\n#else\n    free(mem);\n#endif\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcached_is_allocated",
          "args": [
            "ptr"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nvoid memcached_string_free(memcached_string_st *ptr) {\n  if (ptr == NULL) {\n    return;\n  }\n\n  if (ptr->string) {\n    libmemcached_free(ptr->root, ptr->string);\n  }\n\n  if (memcached_is_allocated(ptr)) {\n    libmemcached_free(ptr->root, ptr);\n  } else {\n    ptr->options.is_initialized = false;\n  }\n}"
  },
  {
    "function_name": "memcached_string_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/string.cc",
    "lines": "175-177",
    "snippet": "void memcached_string_free(memcached_string_st &ptr) {\n  memcached_string_free(&ptr);\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcached_string_free",
          "args": [
            "&ptr"
          ],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_string_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/string.cc",
          "lines": "179-193",
          "snippet": "void memcached_string_free(memcached_string_st *ptr) {\n  if (ptr == NULL) {\n    return;\n  }\n\n  if (ptr->string) {\n    libmemcached_free(ptr->root, ptr->string);\n  }\n\n  if (memcached_is_allocated(ptr)) {\n    libmemcached_free(ptr->root, ptr);\n  } else {\n    ptr->options.is_initialized = false;\n  }\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nvoid memcached_string_free(memcached_string_st &ptr) {\n  memcached_string_free(&ptr);\n}"
  },
  {
    "function_name": "memcached_string_reset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/string.cc",
    "lines": "171-173",
    "snippet": "void memcached_string_reset(memcached_string_st *string) {\n  string->end = string->string;\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nvoid memcached_string_reset(memcached_string_st *string) {\n  string->end = string->string;\n}"
  },
  {
    "function_name": "memcached_string_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/string.cc",
    "lines": "161-169",
    "snippet": "bool memcached_string_set(memcached_string_st &string, const char *value, size_t length) {\n  memcached_string_reset(&string);\n  if (memcached_success(memcached_string_append(&string, value, length))) {\n    memcached_string_append_null(string);\n    return true;\n  }\n\n  return false;\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcached_string_append_null",
          "args": [
            "string"
          ],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_string_append_null",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/string.cc",
          "lines": "106-114",
          "snippet": "static memcached_return_t memcached_string_append_null(memcached_string_st *string) {\n  if (memcached_failed(_string_check(string, 1))) {\n    return MEMCACHED_MEMORY_ALLOCATION_FAILURE;\n  }\n\n  *string->end = 0;\n\n  return MEMCACHED_SUCCESS;\n}",
          "includes": [
            "#include \"libmemcached/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"libmemcached/common.h\"\n\nstatic memcached_return_t memcached_string_append_null(memcached_string_st *string) {\n  if (memcached_failed(_string_check(string, 1))) {\n    return MEMCACHED_MEMORY_ALLOCATION_FAILURE;\n  }\n\n  *string->end = 0;\n\n  return MEMCACHED_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcached_success",
          "args": [
            "memcached_string_append(&string, value, length)"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcached_string_append",
          "args": [
            "&string",
            "value",
            "length"
          ],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_string_append",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/string.cc",
          "lines": "127-141",
          "snippet": "memcached_return_t memcached_string_append(memcached_string_st *string, const char *value,\n                                           size_t length) {\n  if (memcached_failed(_string_check(string, length))) {\n    return MEMCACHED_MEMORY_ALLOCATION_FAILURE;\n  }\n\n  WATCHPOINT_ASSERT(length <= string->current_size);\n  WATCHPOINT_ASSERT(string->string);\n  WATCHPOINT_ASSERT(string->end >= string->string);\n\n  memcpy(string->end, value, length);\n  string->end += length;\n\n  return MEMCACHED_SUCCESS;\n}",
          "includes": [
            "#include \"libmemcached/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"libmemcached/common.h\"\n\nmemcached_return_t memcached_string_append(memcached_string_st *string, const char *value,\n                                           size_t length) {\n  if (memcached_failed(_string_check(string, length))) {\n    return MEMCACHED_MEMORY_ALLOCATION_FAILURE;\n  }\n\n  WATCHPOINT_ASSERT(length <= string->current_size);\n  WATCHPOINT_ASSERT(string->string);\n  WATCHPOINT_ASSERT(string->end >= string->string);\n\n  memcpy(string->end, value, length);\n  string->end += length;\n\n  return MEMCACHED_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcached_string_reset",
          "args": [
            "&string"
          ],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_string_reset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/string.cc",
          "lines": "171-173",
          "snippet": "void memcached_string_reset(memcached_string_st *string) {\n  string->end = string->string;\n}",
          "includes": [
            "#include \"libmemcached/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"libmemcached/common.h\"\n\nvoid memcached_string_reset(memcached_string_st *string) {\n  string->end = string->string;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nbool memcached_string_set(memcached_string_st &string, const char *value, size_t length) {\n  memcached_string_reset(&string);\n  if (memcached_success(memcached_string_append(&string, value, length))) {\n    memcached_string_append_null(string);\n    return true;\n  }\n\n  return false;\n}"
  },
  {
    "function_name": "memcached_string_append",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/string.cc",
    "lines": "127-141",
    "snippet": "memcached_return_t memcached_string_append(memcached_string_st *string, const char *value,\n                                           size_t length) {\n  if (memcached_failed(_string_check(string, length))) {\n    return MEMCACHED_MEMORY_ALLOCATION_FAILURE;\n  }\n\n  WATCHPOINT_ASSERT(length <= string->current_size);\n  WATCHPOINT_ASSERT(string->string);\n  WATCHPOINT_ASSERT(string->end >= string->string);\n\n  memcpy(string->end, value, length);\n  string->end += length;\n\n  return MEMCACHED_SUCCESS;\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "string->end",
            "value",
            "length"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WATCHPOINT_ASSERT",
          "args": [
            "string->end >= string->string"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WATCHPOINT_ASSERT",
          "args": [
            "string->string"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WATCHPOINT_ASSERT",
          "args": [
            "length <= string->current_size"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcached_failed",
          "args": [
            "_string_check(string, length)"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_string_check",
          "args": [
            "string",
            "length"
          ],
          "line": 129
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_string_check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/string.cc",
          "lines": "195-197",
          "snippet": "memcached_return_t memcached_string_check(memcached_string_st *string, size_t need) {\n  return _string_check(string, need);\n}",
          "includes": [
            "#include \"libmemcached/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"libmemcached/common.h\"\n\nmemcached_return_t memcached_string_check(memcached_string_st *string, size_t need) {\n  return _string_check(string, need);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nmemcached_return_t memcached_string_append(memcached_string_st *string, const char *value,\n                                           size_t length) {\n  if (memcached_failed(_string_check(string, length))) {\n    return MEMCACHED_MEMORY_ALLOCATION_FAILURE;\n  }\n\n  WATCHPOINT_ASSERT(length <= string->current_size);\n  WATCHPOINT_ASSERT(string->string);\n  WATCHPOINT_ASSERT(string->end >= string->string);\n\n  memcpy(string->end, value, length);\n  string->end += length;\n\n  return MEMCACHED_SUCCESS;\n}"
  },
  {
    "function_name": "memcached_string_append_character",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/string.cc",
    "lines": "116-125",
    "snippet": "memcached_return_t memcached_string_append_character(memcached_string_st *string, char character) {\n  if (memcached_failed(_string_check(string, 1))) {\n    return MEMCACHED_MEMORY_ALLOCATION_FAILURE;\n  }\n\n  *string->end = character;\n  string->end++;\n\n  return MEMCACHED_SUCCESS;\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcached_failed",
          "args": [
            "_string_check(string, 1)"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_string_check",
          "args": [
            "string",
            "1"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_string_check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/string.cc",
          "lines": "195-197",
          "snippet": "memcached_return_t memcached_string_check(memcached_string_st *string, size_t need) {\n  return _string_check(string, need);\n}",
          "includes": [
            "#include \"libmemcached/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"libmemcached/common.h\"\n\nmemcached_return_t memcached_string_check(memcached_string_st *string, size_t need) {\n  return _string_check(string, need);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nmemcached_return_t memcached_string_append_character(memcached_string_st *string, char character) {\n  if (memcached_failed(_string_check(string, 1))) {\n    return MEMCACHED_MEMORY_ALLOCATION_FAILURE;\n  }\n\n  *string->end = character;\n  string->end++;\n\n  return MEMCACHED_SUCCESS;\n}"
  },
  {
    "function_name": "memcached_string_append_null",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/string.cc",
    "lines": "106-114",
    "snippet": "static memcached_return_t memcached_string_append_null(memcached_string_st *string) {\n  if (memcached_failed(_string_check(string, 1))) {\n    return MEMCACHED_MEMORY_ALLOCATION_FAILURE;\n  }\n\n  *string->end = 0;\n\n  return MEMCACHED_SUCCESS;\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcached_failed",
          "args": [
            "_string_check(string, 1)"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_string_check",
          "args": [
            "string",
            "1"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_string_check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/string.cc",
          "lines": "195-197",
          "snippet": "memcached_return_t memcached_string_check(memcached_string_st *string, size_t need) {\n  return _string_check(string, need);\n}",
          "includes": [
            "#include \"libmemcached/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"libmemcached/common.h\"\n\nmemcached_return_t memcached_string_check(memcached_string_st *string, size_t need) {\n  return _string_check(string, need);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nstatic memcached_return_t memcached_string_append_null(memcached_string_st *string) {\n  if (memcached_failed(_string_check(string, 1))) {\n    return MEMCACHED_MEMORY_ALLOCATION_FAILURE;\n  }\n\n  *string->end = 0;\n\n  return MEMCACHED_SUCCESS;\n}"
  },
  {
    "function_name": "memcached_string_append_null",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/string.cc",
    "lines": "96-104",
    "snippet": "static memcached_return_t memcached_string_append_null(memcached_string_st &string) {\n  if (memcached_failed(_string_check(&string, 1))) {\n    return MEMCACHED_MEMORY_ALLOCATION_FAILURE;\n  }\n\n  *string.end = 0;\n\n  return MEMCACHED_SUCCESS;\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcached_failed",
          "args": [
            "_string_check(&string, 1)"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_string_check",
          "args": [
            "&string",
            "1"
          ],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_string_check",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/string.cc",
          "lines": "195-197",
          "snippet": "memcached_return_t memcached_string_check(memcached_string_st *string, size_t need) {\n  return _string_check(string, need);\n}",
          "includes": [
            "#include \"libmemcached/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"libmemcached/common.h\"\n\nmemcached_return_t memcached_string_check(memcached_string_st *string, size_t need) {\n  return _string_check(string, need);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nstatic memcached_return_t memcached_string_append_null(memcached_string_st &string) {\n  if (memcached_failed(_string_check(&string, 1))) {\n    return MEMCACHED_MEMORY_ALLOCATION_FAILURE;\n  }\n\n  *string.end = 0;\n\n  return MEMCACHED_SUCCESS;\n}"
  },
  {
    "function_name": "_init_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/string.cc",
    "lines": "54-57",
    "snippet": "static inline void _init_string(memcached_string_st *self) {\n  self->current_size = 0;\n  self->end = self->string = NULL;\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nstatic inline void _init_string(memcached_string_st *self) {\n  self->current_size = 0;\n  self->end = self->string = NULL;\n}"
  },
  {
    "function_name": "_string_check",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/string.cc",
    "lines": "18-52",
    "snippet": "inline static memcached_return_t _string_check(memcached_string_st *string, size_t need) {\n  if (need && need > (size_t)(string->current_size - (size_t)(string->end - string->string))) {\n    size_t current_offset = (size_t)(string->end - string->string);\n\n    /* This is the block multiplier. To keep it larger and surive division errors we must round it\n     * up */\n    size_t adjust = (need - (size_t)(string->current_size - (size_t)(string->end - string->string)))\n        / MEMCACHED_BLOCK_SIZE;\n    adjust++;\n\n    size_t new_size =\n        sizeof(char) * (size_t)((adjust * MEMCACHED_BLOCK_SIZE) + string->current_size);\n    /* Test for overflow */\n    if (new_size < need) {\n      char error_message[1024];\n      int error_message_length = snprintf(error_message, sizeof(error_message),\n                                          \"Needed %ld, got %ld\", (long) need, (long) new_size);\n      return memcached_set_error(*string->root, MEMCACHED_MEMORY_ALLOCATION_FAILURE, MEMCACHED_AT,\n                                 error_message, error_message_length);\n    }\n\n    char *new_value = libmemcached_xrealloc(string->root, string->string, new_size, char);\n\n    if (new_value == NULL) {\n      return memcached_set_error(*string->root, MEMCACHED_MEMORY_ALLOCATION_FAILURE, MEMCACHED_AT);\n    }\n\n    string->string = new_value;\n    string->end = string->string + current_offset;\n\n    string->current_size += (MEMCACHED_BLOCK_SIZE * adjust);\n  }\n\n  return MEMCACHED_SUCCESS;\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcached_set_error",
          "args": [
            "*string->root",
            "MEMCACHED_MEMORY_ALLOCATION_FAILURE",
            "MEMCACHED_AT"
          ],
          "line": 42
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_set_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/error.cc",
          "lines": "293-303",
          "snippet": "memcached_return_t memcached_set_error(Memcached &self, memcached_return_t rc, const char *at) {\n  assert_msg(rc != MEMCACHED_ERRNO,\n             \"Programmer error, MEMCACHED_ERRNO was set to be returned to client\");\n  if (memcached_fatal(rc) == false) {\n    return rc;\n  }\n\n  _set(self, NULL, rc, at);\n\n  return rc;\n}",
          "includes": [
            "#include <cstdio>",
            "#include <cstdarg>",
            "#include <cerrno>",
            "#include \"libmemcached/assert.hpp\"",
            "#include \"libmemcached/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstdio>\n#include <cstdarg>\n#include <cerrno>\n#include \"libmemcached/assert.hpp\"\n#include \"libmemcached/common.h\"\n\nmemcached_return_t memcached_set_error(Memcached &self, memcached_return_t rc, const char *at) {\n  assert_msg(rc != MEMCACHED_ERRNO,\n             \"Programmer error, MEMCACHED_ERRNO was set to be returned to client\");\n  if (memcached_fatal(rc) == false) {\n    return rc;\n  }\n\n  _set(self, NULL, rc, at);\n\n  return rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "libmemcached_xrealloc",
          "args": [
            "string->root",
            "string->string",
            "new_size, char"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "error_message",
            "sizeof(error_message)",
            "\"Needed %ld, got %ld\"",
            "(long) need",
            "(long) new_size"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\ninline static memcached_return_t _string_check(memcached_string_st *string, size_t need) {\n  if (need && need > (size_t)(string->current_size - (size_t)(string->end - string->string))) {\n    size_t current_offset = (size_t)(string->end - string->string);\n\n    /* This is the block multiplier. To keep it larger and surive division errors we must round it\n     * up */\n    size_t adjust = (need - (size_t)(string->current_size - (size_t)(string->end - string->string)))\n        / MEMCACHED_BLOCK_SIZE;\n    adjust++;\n\n    size_t new_size =\n        sizeof(char) * (size_t)((adjust * MEMCACHED_BLOCK_SIZE) + string->current_size);\n    /* Test for overflow */\n    if (new_size < need) {\n      char error_message[1024];\n      int error_message_length = snprintf(error_message, sizeof(error_message),\n                                          \"Needed %ld, got %ld\", (long) need, (long) new_size);\n      return memcached_set_error(*string->root, MEMCACHED_MEMORY_ALLOCATION_FAILURE, MEMCACHED_AT,\n                                 error_message, error_message_length);\n    }\n\n    char *new_value = libmemcached_xrealloc(string->root, string->string, new_size, char);\n\n    if (new_value == NULL) {\n      return memcached_set_error(*string->root, MEMCACHED_MEMORY_ALLOCATION_FAILURE, MEMCACHED_AT);\n    }\n\n    string->string = new_value;\n    string->end = string->string + current_offset;\n\n    string->current_size += (MEMCACHED_BLOCK_SIZE * adjust);\n  }\n\n  return MEMCACHED_SUCCESS;\n}"
  }
]