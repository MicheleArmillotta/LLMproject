[
  {
    "function_name": "MurmurHash3_x86_32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libhashkit/murmur3.cc",
    "lines": "63-117",
    "snippet": "void MurmurHash3_x86_32(const void *key, int len, uint32_t seed, void *out) {\n  const uint8_t *data = (const uint8_t *) key;\n  const int nblocks = len / 4;\n  int i;\n\n  uint32_t h1 = seed;\n\n  uint32_t c1 = 0xcc9e2d51;\n  uint32_t c2 = 0x1b873593;\n\n  //----------\n  // body\n\n  const uint32_t *blocks = (const uint32_t *) (data + nblocks * 4);\n\n  for (i = -nblocks; i; i++) {\n    uint32_t k1 = getblock(blocks, i);\n#if WORDS_BIGENDIAN\n    k1 = BYTESWAP_32(k1);\n#endif\n\n    k1 *= c1;\n    k1 = ROTL32(k1, 15);\n    k1 *= c2;\n\n    h1 ^= k1;\n    h1 = ROTL32(h1, 13);\n    h1 = h1 * 5 + 0xe6546b64;\n  }\n\n  //----------\n  // tail\n\n  const uint8_t *tail = (const uint8_t *) (data + nblocks * 4);\n\n  uint32_t k1 = 0;\n  memcpy(&k1, tail, len & 3);\n#if WORDS_BIGENDIAN\n  k1 = BYTESWAP_32(k1);\n#endif\n\n  k1 *= c1;\n  k1 = ROTL32(k1, 15);\n  k1 *= c2;\n  h1 ^= k1;\n\n  //----------\n  // finalization\n\n  h1 ^= len;\n\n  h1 = fmix32(h1);\n\n  *(uint32_t *) out = h1;\n}",
    "includes": [
      "#include <cstring>",
      "#include <cassert>",
      "#include \"libhashkit/murmur3.h\"",
      "#include \"libhashkit/hashkitcon.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fmix32",
          "args": [
            "h1"
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "fmix32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libhashkit/murmur3.cc",
          "lines": "51-59",
          "snippet": "static FORCE_INLINE uint32_t fmix32(uint32_t h) {\n  h ^= h >> 16;\n  h *= 0x85ebca6b;\n  h ^= h >> 13;\n  h *= 0xc2b2ae35;\n  h ^= h >> 16;\n\n  return h;\n}",
          "includes": [
            "#include <cstring>",
            "#include <cassert>",
            "#include \"libhashkit/murmur3.h\"",
            "#include \"libhashkit/hashkitcon.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <cassert>\n#include \"libhashkit/murmur3.h\"\n#include \"libhashkit/hashkitcon.h\"\n\nstatic FORCE_INLINE uint32_t fmix32(uint32_t h) {\n  h ^= h >> 16;\n  h *= 0x85ebca6b;\n  h ^= h >> 13;\n  h *= 0xc2b2ae35;\n  h ^= h >> 16;\n\n  return h;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ROTL32",
          "args": [
            "k1",
            "15"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BYTESWAP_32",
          "args": [
            "k1"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&k1",
            "tail",
            "len & 3"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ROTL32",
          "args": [
            "h1",
            "13"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ROTL32",
          "args": [
            "k1",
            "15"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BYTESWAP_32",
          "args": [
            "k1"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getblock",
          "args": [
            "blocks",
            "i"
          ],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "getblock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libhashkit/murmur3.cc",
          "lines": "42-46",
          "snippet": "static inline T getblock(const T *blocks, int i) {\n  T b;\n  memcpy(&b, ((const uint8_t *) blocks) + i * sizeof(T), sizeof(T));\n  return b;\n}",
          "includes": [
            "#include <cstring>",
            "#include <cassert>",
            "#include \"libhashkit/murmur3.h\"",
            "#include \"libhashkit/hashkitcon.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <cassert>\n#include \"libhashkit/murmur3.h\"\n#include \"libhashkit/hashkitcon.h\"\n\nstatic inline T getblock(const T *blocks, int i) {\n  T b;\n  memcpy(&b, ((const uint8_t *) blocks) + i * sizeof(T), sizeof(T));\n  return b;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <cassert>\n#include \"libhashkit/murmur3.h\"\n#include \"libhashkit/hashkitcon.h\"\n\nvoid MurmurHash3_x86_32(const void *key, int len, uint32_t seed, void *out) {\n  const uint8_t *data = (const uint8_t *) key;\n  const int nblocks = len / 4;\n  int i;\n\n  uint32_t h1 = seed;\n\n  uint32_t c1 = 0xcc9e2d51;\n  uint32_t c2 = 0x1b873593;\n\n  //----------\n  // body\n\n  const uint32_t *blocks = (const uint32_t *) (data + nblocks * 4);\n\n  for (i = -nblocks; i; i++) {\n    uint32_t k1 = getblock(blocks, i);\n#if WORDS_BIGENDIAN\n    k1 = BYTESWAP_32(k1);\n#endif\n\n    k1 *= c1;\n    k1 = ROTL32(k1, 15);\n    k1 *= c2;\n\n    h1 ^= k1;\n    h1 = ROTL32(h1, 13);\n    h1 = h1 * 5 + 0xe6546b64;\n  }\n\n  //----------\n  // tail\n\n  const uint8_t *tail = (const uint8_t *) (data + nblocks * 4);\n\n  uint32_t k1 = 0;\n  memcpy(&k1, tail, len & 3);\n#if WORDS_BIGENDIAN\n  k1 = BYTESWAP_32(k1);\n#endif\n\n  k1 *= c1;\n  k1 = ROTL32(k1, 15);\n  k1 *= c2;\n  h1 ^= k1;\n\n  //----------\n  // finalization\n\n  h1 ^= len;\n\n  h1 = fmix32(h1);\n\n  *(uint32_t *) out = h1;\n}"
  },
  {
    "function_name": "fmix32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libhashkit/murmur3.cc",
    "lines": "51-59",
    "snippet": "static FORCE_INLINE uint32_t fmix32(uint32_t h) {\n  h ^= h >> 16;\n  h *= 0x85ebca6b;\n  h ^= h >> 13;\n  h *= 0xc2b2ae35;\n  h ^= h >> 16;\n\n  return h;\n}",
    "includes": [
      "#include <cstring>",
      "#include <cassert>",
      "#include \"libhashkit/murmur3.h\"",
      "#include \"libhashkit/hashkitcon.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <cstring>\n#include <cassert>\n#include \"libhashkit/murmur3.h\"\n#include \"libhashkit/hashkitcon.h\"\n\nstatic FORCE_INLINE uint32_t fmix32(uint32_t h) {\n  h ^= h >> 16;\n  h *= 0x85ebca6b;\n  h ^= h >> 13;\n  h *= 0xc2b2ae35;\n  h ^= h >> 16;\n\n  return h;\n}"
  },
  {
    "function_name": "getblock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libhashkit/murmur3.cc",
    "lines": "42-46",
    "snippet": "static inline T getblock(const T *blocks, int i) {\n  T b;\n  memcpy(&b, ((const uint8_t *) blocks) + i * sizeof(T), sizeof(T));\n  return b;\n}",
    "includes": [
      "#include <cstring>",
      "#include <cassert>",
      "#include \"libhashkit/murmur3.h\"",
      "#include \"libhashkit/hashkitcon.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&b",
            "((const uint8_t *) blocks) + i * sizeof(T)",
            "sizeof(T)"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <cassert>\n#include \"libhashkit/murmur3.h\"\n#include \"libhashkit/hashkitcon.h\"\n\nstatic inline T getblock(const T *blocks, int i) {\n  T b;\n  memcpy(&b, ((const uint8_t *) blocks) + i * sizeof(T), sizeof(T));\n  return b;\n}"
  },
  {
    "function_name": "rotl32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libhashkit/murmur3.cc",
    "lines": "29-31",
    "snippet": "static FORCE_INLINE uint32_t rotl32(uint32_t x, int8_t r) {\n  return (x << r) | (x >> (32 - r));\n}",
    "includes": [
      "#include <cstring>",
      "#include <cassert>",
      "#include \"libhashkit/murmur3.h\"",
      "#include \"libhashkit/hashkitcon.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <cstring>\n#include <cassert>\n#include \"libhashkit/murmur3.h\"\n#include \"libhashkit/hashkitcon.h\"\n\nstatic FORCE_INLINE uint32_t rotl32(uint32_t x, int8_t r) {\n  return (x << r) | (x >> (32 - r));\n}"
  }
]