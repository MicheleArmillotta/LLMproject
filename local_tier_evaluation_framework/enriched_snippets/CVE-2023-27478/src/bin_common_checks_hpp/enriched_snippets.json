[
  {
    "function_name": "check_return",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/bin/common/checks.hpp",
    "lines": "73-90",
    "snippet": "bool check_return(const client_options &opt, memcached_st &memc, const char *key,\n                  memcached_return_t rc) {\n  if (!memcached_success(rc)) {\n    if (!opt.isset(\"quiet\")) {\n      if (MEMCACHED_NOTFOUND == rc) {\n        if (opt.isset(\"verbose\")) {\n          std::cerr << \"Could not find key '\" << key\n                    << \"': \" << memcached_strerror(&memc, rc) << \"\\n\";;\n        }\n      } else {\n        std::cerr << \"Fatal error for key '\" << key\n                  << \"': \" << memcached_last_error_message(&memc) << \"\\n\";\n      }\n    }\n    return false;\n  }\n  return true;\n}",
    "includes": [
      "#include <fstream>",
      "#include <cstring>",
      "#include <cerrno>",
      "#include \"libmemcached/common.h\"",
      "#include \"options.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcached_last_error_message",
          "args": [
            "&memc"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcached_strerror",
          "args": [
            "&memc",
            "rc"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "opt.isset",
          "args": [
            "\"verbose\""
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "isset",
          "container": "client_options",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/bin/common/options.hpp",
          "lines": "289-291",
          "snippet": "bool isset(int c) const {\n    return has(c) && get(c).set;\n  }",
          "includes": [
            "#include \"p9y/getopt.hpp\"",
            "#include \"libmemcached/common.h\"",
            "#include <vector>",
            "#include <string>",
            "#include <iostream>",
            "#include <functional>",
            "#include <climits>",
            "#include <cstdint>",
            "#include <algorithm>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"p9y/getopt.hpp\"\n#include \"libmemcached/common.h\"\n#include <vector>\n#include <string>\n#include <iostream>\n#include <functional>\n#include <climits>\n#include <cstdint>\n#include <algorithm>\n\nclient_options {\n  bool isset(int c) const {\n      return has(c) && get(c).set;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcached_success",
          "args": [
            "rc"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <fstream>\n#include <cstring>\n#include <cerrno>\n#include \"libmemcached/common.h\"\n#include \"options.hpp\"\n\nbool check_return(const client_options &opt, memcached_st &memc, const char *key,\n                  memcached_return_t rc) {\n  if (!memcached_success(rc)) {\n    if (!opt.isset(\"quiet\")) {\n      if (MEMCACHED_NOTFOUND == rc) {\n        if (opt.isset(\"verbose\")) {\n          std::cerr << \"Could not find key '\" << key\n                    << \"': \" << memcached_strerror(&memc, rc) << \"\\n\";;\n        }\n      } else {\n        std::cerr << \"Fatal error for key '\" << key\n                  << \"': \" << memcached_last_error_message(&memc) << \"\\n\";\n      }\n    }\n    return false;\n  }\n  return true;\n}"
  },
  {
    "function_name": "check_return",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/bin/common/checks.hpp",
    "lines": "57-71",
    "snippet": "bool check_return(const client_options &opt, memcached_st &memc, memcached_return_t rc) {\n  if (!memcached_success(rc)) {\n    if (!opt.isset(\"quiet\")) {\n      if (!memcached_fatal(rc)) {\n        if (opt.isset(\"verbose\")) {\n          std::cerr << \"Failed: \" << memcached_strerror(&memc, rc) << \"\\n\";;\n        }\n      } else {\n        std::cerr << \"Fatal error: \" << memcached_last_error_message(&memc) << \"\\n\";\n      }\n    }\n    return false;\n  }\n  return true;\n}",
    "includes": [
      "#include <fstream>",
      "#include <cstring>",
      "#include <cerrno>",
      "#include \"libmemcached/common.h\"",
      "#include \"options.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcached_last_error_message",
          "args": [
            "&memc"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcached_strerror",
          "args": [
            "&memc",
            "rc"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "opt.isset",
          "args": [
            "\"verbose\""
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "isset",
          "container": "client_options",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/bin/common/options.hpp",
          "lines": "289-291",
          "snippet": "bool isset(int c) const {\n    return has(c) && get(c).set;\n  }",
          "includes": [
            "#include \"p9y/getopt.hpp\"",
            "#include \"libmemcached/common.h\"",
            "#include <vector>",
            "#include <string>",
            "#include <iostream>",
            "#include <functional>",
            "#include <climits>",
            "#include <cstdint>",
            "#include <algorithm>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"p9y/getopt.hpp\"\n#include \"libmemcached/common.h\"\n#include <vector>\n#include <string>\n#include <iostream>\n#include <functional>\n#include <climits>\n#include <cstdint>\n#include <algorithm>\n\nclient_options {\n  bool isset(int c) const {\n      return has(c) && get(c).set;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcached_fatal",
          "args": [
            "rc"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcached_success",
          "args": [
            "rc"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <fstream>\n#include <cstring>\n#include <cerrno>\n#include \"libmemcached/common.h\"\n#include \"options.hpp\"\n\nbool check_return(const client_options &opt, memcached_st &memc, memcached_return_t rc) {\n  if (!memcached_success(rc)) {\n    if (!opt.isset(\"quiet\")) {\n      if (!memcached_fatal(rc)) {\n        if (opt.isset(\"verbose\")) {\n          std::cerr << \"Failed: \" << memcached_strerror(&memc, rc) << \"\\n\";;\n        }\n      } else {\n        std::cerr << \"Fatal error: \" << memcached_last_error_message(&memc) << \"\\n\";\n      }\n    }\n    return false;\n  }\n  return true;\n}"
  },
  {
    "function_name": "check_memcached",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/bin/common/checks.hpp",
    "lines": "47-55",
    "snippet": "bool check_memcached(const client_options &opt, memcached_st &memc) {\n  if (!memcached_create(&memc)) {\n    if (!opt.isset(\"quiet\")) {\n      std::cerr << \"Failed to initialize memcached client.\\n\";\n    }\n    return false;\n  }\n  return true;\n}",
    "includes": [
      "#include <fstream>",
      "#include <cstring>",
      "#include <cerrno>",
      "#include \"libmemcached/common.h\"",
      "#include \"options.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "opt.isset",
          "args": [
            "\"quiet\""
          ],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "isset",
          "container": "client_options",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/bin/common/options.hpp",
          "lines": "289-291",
          "snippet": "bool isset(int c) const {\n    return has(c) && get(c).set;\n  }",
          "includes": [
            "#include \"p9y/getopt.hpp\"",
            "#include \"libmemcached/common.h\"",
            "#include <vector>",
            "#include <string>",
            "#include <iostream>",
            "#include <functional>",
            "#include <climits>",
            "#include <cstdint>",
            "#include <algorithm>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"p9y/getopt.hpp\"\n#include \"libmemcached/common.h\"\n#include <vector>\n#include <string>\n#include <iostream>\n#include <functional>\n#include <climits>\n#include <cstdint>\n#include <algorithm>\n\nclient_options {\n  bool isset(int c) const {\n      return has(c) && get(c).set;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcached_create",
          "args": [
            "&memc"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <fstream>\n#include <cstring>\n#include <cerrno>\n#include \"libmemcached/common.h\"\n#include \"options.hpp\"\n\nbool check_memcached(const client_options &opt, memcached_st &memc) {\n  if (!memcached_create(&memc)) {\n    if (!opt.isset(\"quiet\")) {\n      std::cerr << \"Failed to initialize memcached client.\\n\";\n    }\n    return false;\n  }\n  return true;\n}"
  },
  {
    "function_name": "check_argp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/bin/common/checks.hpp",
    "lines": "37-45",
    "snippet": "bool check_argp(const client_options &opt, char **argp, const char *error_msg) {\n  if (argp && *argp) {\n    return true;\n  }\n  if (!opt.isset(\"quiet\")) {\n    std::cerr << error_msg << \"\\n\";\n  }\n  return false;\n}",
    "includes": [
      "#include <fstream>",
      "#include <cstring>",
      "#include <cerrno>",
      "#include \"libmemcached/common.h\"",
      "#include \"options.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "opt.isset",
          "args": [
            "\"quiet\""
          ],
          "line": 41
        },
        "resolved": true,
        "details": {
          "function_name": "isset",
          "container": "client_options",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/bin/common/options.hpp",
          "lines": "289-291",
          "snippet": "bool isset(int c) const {\n    return has(c) && get(c).set;\n  }",
          "includes": [
            "#include \"p9y/getopt.hpp\"",
            "#include \"libmemcached/common.h\"",
            "#include <vector>",
            "#include <string>",
            "#include <iostream>",
            "#include <functional>",
            "#include <climits>",
            "#include <cstdint>",
            "#include <algorithm>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"p9y/getopt.hpp\"\n#include \"libmemcached/common.h\"\n#include <vector>\n#include <string>\n#include <iostream>\n#include <functional>\n#include <climits>\n#include <cstdint>\n#include <algorithm>\n\nclient_options {\n  bool isset(int c) const {\n      return has(c) && get(c).set;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <fstream>\n#include <cstring>\n#include <cerrno>\n#include \"libmemcached/common.h\"\n#include \"options.hpp\"\n\nbool check_argp(const client_options &opt, char **argp, const char *error_msg) {\n  if (argp && *argp) {\n    return true;\n  }\n  if (!opt.isset(\"quiet\")) {\n    std::cerr << error_msg << \"\\n\";\n  }\n  return false;\n}"
  },
  {
    "function_name": "check_buffering",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/bin/common/checks.hpp",
    "lines": "25-35",
    "snippet": "bool check_buffering(const client_options &opt, memcached_st &memc) {\n  if (opt.isset(\"buffer\")) {\n    if (MEMCACHED_SUCCESS != memcached_flush_buffers(&memc)) {\n      if (!opt.isset(\"quiet\")) {\n        std::cerr << memcached_last_error_message(&memc) << \"\\n\";\n      }\n      return false;\n    }\n  }\n  return true;\n}",
    "includes": [
      "#include <fstream>",
      "#include <cstring>",
      "#include <cerrno>",
      "#include \"libmemcached/common.h\"",
      "#include \"options.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcached_last_error_message",
          "args": [
            "&memc"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "opt.isset",
          "args": [
            "\"quiet\""
          ],
          "line": 28
        },
        "resolved": true,
        "details": {
          "function_name": "isset",
          "container": "client_options",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/bin/common/options.hpp",
          "lines": "289-291",
          "snippet": "bool isset(int c) const {\n    return has(c) && get(c).set;\n  }",
          "includes": [
            "#include \"p9y/getopt.hpp\"",
            "#include \"libmemcached/common.h\"",
            "#include <vector>",
            "#include <string>",
            "#include <iostream>",
            "#include <functional>",
            "#include <climits>",
            "#include <cstdint>",
            "#include <algorithm>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"p9y/getopt.hpp\"\n#include \"libmemcached/common.h\"\n#include <vector>\n#include <string>\n#include <iostream>\n#include <functional>\n#include <climits>\n#include <cstdint>\n#include <algorithm>\n\nclient_options {\n  bool isset(int c) const {\n      return has(c) && get(c).set;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcached_flush_buffers",
          "args": [
            "&memc"
          ],
          "line": 27
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_flush_buffers",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/flush_buffers.cc",
          "lines": "18-43",
          "snippet": "memcached_return_t memcached_flush_buffers(memcached_st *shell) {\n  Memcached *memc = memcached2Memcached(shell);\n  if (memc) {\n    memcached_return_t ret = MEMCACHED_SUCCESS;\n\n    for (uint32_t x = 0; x < memcached_server_count(memc); ++x) {\n      memcached_instance_st *instance = memcached_instance_fetch(memc, x);\n\n      if (instance->write_buffer_offset) {\n        if (instance->fd == INVALID_SOCKET\n            and (ret = memcached_connect(instance)) != MEMCACHED_SUCCESS) {\n          WATCHPOINT_ERROR(ret);\n          return ret;\n        }\n\n        if (memcached_io_write(instance) == false) {\n          ret = MEMCACHED_SOME_ERRORS;\n        }\n      }\n    }\n\n    return ret;\n  }\n\n  return MEMCACHED_INVALID_ARGUMENTS;\n}",
          "includes": [
            "#include \"libmemcached/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"libmemcached/common.h\"\n\nmemcached_return_t memcached_flush_buffers(memcached_st *shell) {\n  Memcached *memc = memcached2Memcached(shell);\n  if (memc) {\n    memcached_return_t ret = MEMCACHED_SUCCESS;\n\n    for (uint32_t x = 0; x < memcached_server_count(memc); ++x) {\n      memcached_instance_st *instance = memcached_instance_fetch(memc, x);\n\n      if (instance->write_buffer_offset) {\n        if (instance->fd == INVALID_SOCKET\n            and (ret = memcached_connect(instance)) != MEMCACHED_SUCCESS) {\n          WATCHPOINT_ERROR(ret);\n          return ret;\n        }\n\n        if (memcached_io_write(instance) == false) {\n          ret = MEMCACHED_SOME_ERRORS;\n        }\n      }\n    }\n\n    return ret;\n  }\n\n  return MEMCACHED_INVALID_ARGUMENTS;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <fstream>\n#include <cstring>\n#include <cerrno>\n#include \"libmemcached/common.h\"\n#include \"options.hpp\"\n\nbool check_buffering(const client_options &opt, memcached_st &memc) {\n  if (opt.isset(\"buffer\")) {\n    if (MEMCACHED_SUCCESS != memcached_flush_buffers(&memc)) {\n      if (!opt.isset(\"quiet\")) {\n        std::cerr << memcached_last_error_message(&memc) << \"\\n\";\n      }\n      return false;\n    }\n  }\n  return true;\n}"
  }
]