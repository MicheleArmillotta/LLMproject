[
  {
    "function_name": "memcached_fetch_execute",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/fetch.cc",
    "lines": "200-237",
    "snippet": "memcached_return_t memcached_fetch_execute(memcached_st *shell, memcached_execute_fn *callback,\n                                           void *context, uint32_t number_of_callbacks) {\n  Memcached *ptr = memcached2Memcached(shell);\n  memcached_result_st *result = &ptr->result;\n  memcached_return_t rc;\n  bool some_errors = false;\n\n  while ((result = memcached_fetch_result(ptr, result, &rc))) {\n    if (memcached_failed(rc) and rc == MEMCACHED_NOTFOUND) {\n      continue;\n    } else if (memcached_failed(rc)) {\n      memcached_set_error(*ptr, rc, MEMCACHED_AT);\n      some_errors = true;\n      continue;\n    }\n\n    for (uint32_t x = 0; x < number_of_callbacks; x++) {\n      memcached_return_t ret = (*callback[x])(ptr, result, context);\n      if (memcached_failed(ret)) {\n        some_errors = true;\n        memcached_set_error(*ptr, ret, MEMCACHED_AT);\n        break;\n      }\n    }\n  }\n\n  if (some_errors) {\n    return MEMCACHED_SOME_ERRORS;\n  }\n\n  // If we were able to run all keys without issue we return\n  // MEMCACHED_SUCCESS\n  if (memcached_success(rc)) {\n    return MEMCACHED_SUCCESS;\n  }\n\n  return rc;\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcached_success",
          "args": [
            "rc"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcached_set_error",
          "args": [
            "*ptr",
            "ret",
            "MEMCACHED_AT"
          ],
          "line": 220
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_set_error",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/error.cc",
          "lines": "293-303",
          "snippet": "memcached_return_t memcached_set_error(Memcached &self, memcached_return_t rc, const char *at) {\n  assert_msg(rc != MEMCACHED_ERRNO,\n             \"Programmer error, MEMCACHED_ERRNO was set to be returned to client\");\n  if (memcached_fatal(rc) == false) {\n    return rc;\n  }\n\n  _set(self, NULL, rc, at);\n\n  return rc;\n}",
          "includes": [
            "#include <cstdio>",
            "#include <cstdarg>",
            "#include <cerrno>",
            "#include \"libmemcached/assert.hpp\"",
            "#include \"libmemcached/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstdio>\n#include <cstdarg>\n#include <cerrno>\n#include \"libmemcached/assert.hpp\"\n#include \"libmemcached/common.h\"\n\nmemcached_return_t memcached_set_error(Memcached &self, memcached_return_t rc, const char *at) {\n  assert_msg(rc != MEMCACHED_ERRNO,\n             \"Programmer error, MEMCACHED_ERRNO was set to be returned to client\");\n  if (memcached_fatal(rc) == false) {\n    return rc;\n  }\n\n  _set(self, NULL, rc, at);\n\n  return rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcached_failed",
          "args": [
            "ret"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "ptr",
            "result",
            "context"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcached_failed",
          "args": [
            "rc"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcached_failed",
          "args": [
            "rc"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcached_fetch_result",
          "args": [
            "ptr",
            "result",
            "&rc"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcached2Memcached",
          "args": [
            "shell"
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nmemcached_return_t memcached_fetch_execute(memcached_st *shell, memcached_execute_fn *callback,\n                                           void *context, uint32_t number_of_callbacks) {\n  Memcached *ptr = memcached2Memcached(shell);\n  memcached_result_st *result = &ptr->result;\n  memcached_return_t rc;\n  bool some_errors = false;\n\n  while ((result = memcached_fetch_result(ptr, result, &rc))) {\n    if (memcached_failed(rc) and rc == MEMCACHED_NOTFOUND) {\n      continue;\n    } else if (memcached_failed(rc)) {\n      memcached_set_error(*ptr, rc, MEMCACHED_AT);\n      some_errors = true;\n      continue;\n    }\n\n    for (uint32_t x = 0; x < number_of_callbacks; x++) {\n      memcached_return_t ret = (*callback[x])(ptr, result, context);\n      if (memcached_failed(ret)) {\n        some_errors = true;\n        memcached_set_error(*ptr, ret, MEMCACHED_AT);\n        break;\n      }\n    }\n  }\n\n  if (some_errors) {\n    return MEMCACHED_SOME_ERRORS;\n  }\n\n  // If we were able to run all keys without issue we return\n  // MEMCACHED_SUCCESS\n  if (memcached_success(rc)) {\n    return MEMCACHED_SUCCESS;\n  }\n\n  return rc;\n}"
  }
]