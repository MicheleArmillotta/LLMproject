[
  {
    "function_name": "memcached_analyze_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/analyze.cc",
    "lines": "106-108",
    "snippet": "void memcached_analyze_free(memcached_analysis_st *ptr) {\n  libmemcached_free(ptr->root, ptr);\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "libmemcached_free",
          "args": [
            "ptr->root",
            "ptr"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "libmemcached_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/memory.h",
          "lines": "30-40",
          "snippet": "static inline void libmemcached_free(const memcached_st *self, void *mem) {\n  if (self) {\n    self->allocators.free(self, mem, self->allocators.context);\n  } else if (mem) {\n#ifdef __cplusplus\n    std::free(mem);\n#else\n    free(mem);\n#endif\n  }\n}",
          "includes": [
            "#  include <stdlib.h>",
            "#  include <stddef.h>",
            "#  include <cstdlib>",
            "#  include <cstddef>",
            "#include \"libmemcached/common.h\"",
            "#include \"mem_config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#  include <stdlib.h>\n#  include <stddef.h>\n#  include <cstdlib>\n#  include <cstddef>\n#include \"libmemcached/common.h\"\n#include \"mem_config.h\"\n\nstatic inline void libmemcached_free(const memcached_st *self, void *mem) {\n  if (self) {\n    self->allocators.free(self, mem, self->allocators.context);\n  } else if (mem) {\n#ifdef __cplusplus\n    std::free(mem);\n#else\n    free(mem);\n#endif\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nvoid memcached_analyze_free(memcached_analysis_st *ptr) {\n  libmemcached_free(ptr->root, ptr);\n}"
  },
  {
    "function_name": "calc_hit_ratio",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/analyze.cc",
    "lines": "51-60",
    "snippet": "static void calc_hit_ratio(memcached_analysis_st *result, const uint64_t total_get_hits,\n                           const uint64_t total_get_cmds) {\n  if (total_get_hits == 0 || total_get_cmds == 0) {\n    result->pool_hit_ratio = 0;\n    return;\n  }\n\n  double temp = double(total_get_hits) / total_get_cmds;\n  result->pool_hit_ratio = temp * 100;\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "double",
          "args": [
            "total_get_hits"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nstatic void calc_hit_ratio(memcached_analysis_st *result, const uint64_t total_get_hits,\n                           const uint64_t total_get_cmds) {\n  if (total_get_hits == 0 || total_get_cmds == 0) {\n    result->pool_hit_ratio = 0;\n    return;\n  }\n\n  double temp = double(total_get_hits) / total_get_cmds;\n  result->pool_hit_ratio = temp * 100;\n}"
  },
  {
    "function_name": "calc_average_item_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/analyze.cc",
    "lines": "44-49",
    "snippet": "static void calc_average_item_size(memcached_analysis_st *result, const uint64_t total_items,\n                                   const uint64_t total_bytes) {\n  if (total_items > 0 && total_bytes > 0) {\n    result->average_item_size = (uint32_t)(total_bytes / total_items);\n  }\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nstatic void calc_average_item_size(memcached_analysis_st *result, const uint64_t total_items,\n                                   const uint64_t total_bytes) {\n  if (total_items > 0 && total_bytes > 0) {\n    result->average_item_size = (uint32_t)(total_bytes / total_items);\n  }\n}"
  },
  {
    "function_name": "calc_least_free_node",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/analyze.cc",
    "lines": "34-42",
    "snippet": "static void calc_least_free_node(memcached_analysis_st *result, const uint32_t server_num,\n                                 const uint64_t max_allowed_bytes, const uint64_t used_bytes) {\n  uint64_t remaining_bytes = max_allowed_bytes - used_bytes;\n\n  if (result->least_remaining_bytes == 0 || remaining_bytes < result->least_remaining_bytes) {\n    result->least_remaining_bytes = remaining_bytes;\n    result->least_free_server = server_num;\n  }\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nstatic void calc_least_free_node(memcached_analysis_st *result, const uint32_t server_num,\n                                 const uint64_t max_allowed_bytes, const uint64_t used_bytes) {\n  uint64_t remaining_bytes = max_allowed_bytes - used_bytes;\n\n  if (result->least_remaining_bytes == 0 || remaining_bytes < result->least_remaining_bytes) {\n    result->least_remaining_bytes = remaining_bytes;\n    result->least_free_server = server_num;\n  }\n}"
  },
  {
    "function_name": "calc_oldest_node",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/analyze.cc",
    "lines": "26-32",
    "snippet": "static void calc_oldest_node(memcached_analysis_st *result, const uint32_t server_num,\n                             const uint32_t uptime) {\n  if (result->longest_uptime < uptime) {\n    result->longest_uptime = uptime;\n    result->oldest_server = server_num;\n  }\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nstatic void calc_oldest_node(memcached_analysis_st *result, const uint32_t server_num,\n                             const uint32_t uptime) {\n  if (result->longest_uptime < uptime) {\n    result->longest_uptime = uptime;\n    result->oldest_server = server_num;\n  }\n}"
  },
  {
    "function_name": "calc_largest_consumption",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/analyze.cc",
    "lines": "18-24",
    "snippet": "static void calc_largest_consumption(memcached_analysis_st *result, const uint32_t server_num,\n                                     const uint64_t nbytes) {\n  if (result->most_used_bytes < nbytes) {\n    result->most_used_bytes = nbytes;\n    result->most_consumed_server = server_num;\n  }\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nstatic void calc_largest_consumption(memcached_analysis_st *result, const uint32_t server_num,\n                                     const uint64_t nbytes) {\n  if (result->most_used_bytes < nbytes) {\n    result->most_used_bytes = nbytes;\n    result->most_consumed_server = server_num;\n  }\n}"
  }
]