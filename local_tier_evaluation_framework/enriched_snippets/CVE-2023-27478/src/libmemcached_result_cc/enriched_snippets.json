[
  {
    "function_name": "memcached_result_set_expiration",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/result.cc",
    "lines": "132-134",
    "snippet": "void memcached_result_set_expiration(memcached_result_st *self, time_t expiration) {\n  self->item_expiration = expiration;\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nvoid memcached_result_set_expiration(memcached_result_st *self, time_t expiration) {\n  self->item_expiration = expiration;\n}"
  },
  {
    "function_name": "memcached_result_set_flags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/result.cc",
    "lines": "128-130",
    "snippet": "void memcached_result_set_flags(memcached_result_st *self, uint32_t flags) {\n  self->item_flags = flags;\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nvoid memcached_result_set_flags(memcached_result_st *self, uint32_t flags) {\n  self->item_flags = flags;\n}"
  },
  {
    "function_name": "memcached_result_cas",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/result.cc",
    "lines": "124-126",
    "snippet": "uint64_t memcached_result_cas(const memcached_result_st *self) {\n  return self->item_cas;\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nuint64_t memcached_result_cas(const memcached_result_st *self) {\n  return self->item_cas;\n}"
  },
  {
    "function_name": "memcached_result_flags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/result.cc",
    "lines": "120-122",
    "snippet": "uint32_t memcached_result_flags(const memcached_result_st *self) {\n  return self->item_flags;\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nuint32_t memcached_result_flags(const memcached_result_st *self) {\n  return self->item_flags;\n}"
  },
  {
    "function_name": "memcached_result_length",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/result.cc",
    "lines": "110-113",
    "snippet": "size_t memcached_result_length(const memcached_result_st *self) {\n  const memcached_string_st *sptr = &self->value;\n  return memcached_string_length(sptr);\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcached_string_length",
          "args": [
            "sptr"
          ],
          "line": 112
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_string_length",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/string.cc",
          "lines": "207-209",
          "snippet": "size_t memcached_string_length(const memcached_string_st &self) {\n  return size_t(self.end - self.string);\n}",
          "includes": [
            "#include \"libmemcached/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"libmemcached/common.h\"\n\nsize_t memcached_string_length(const memcached_string_st &self) {\n  return size_t(self.end - self.string);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nsize_t memcached_result_length(const memcached_result_st *self) {\n  const memcached_string_st *sptr = &self->value;\n  return memcached_string_length(sptr);\n}"
  },
  {
    "function_name": "memcached_result_key_length",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/result.cc",
    "lines": "101-103",
    "snippet": "size_t memcached_result_key_length(const memcached_result_st *self) {\n  return self->key_length;\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nsize_t memcached_result_key_length(const memcached_result_st *self) {\n  return self->key_length;\n}"
  },
  {
    "function_name": "memcached_result_set_value",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/result.cc",
    "lines": "88-95",
    "snippet": "memcached_return_t memcached_result_set_value(memcached_result_st *ptr, const char *value,\n                                              size_t length) {\n  if (memcached_failed(memcached_string_append(&ptr->value, value, length))) {\n    return memcached_set_errno(*ptr->root, errno, MEMCACHED_AT);\n  }\n\n  return MEMCACHED_SUCCESS;\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcached_set_errno",
          "args": [
            "*ptr->root",
            "errno",
            "MEMCACHED_AT"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_set_errno",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/error.cc",
          "lines": "378-398",
          "snippet": "memcached_return_t memcached_set_errno(memcached_instance_st &self, int local_errno,\n                                       const char *at) {\n  if (local_errno == 0) {\n    return MEMCACHED_SUCCESS;\n  }\n\n  char hostname_port_message[MAX_ERROR_LENGTH];\n  size_t size = append_host_to_string(self, hostname_port_message, sizeof(hostname_port_message));\n\n  memcached_string_t error_host = {hostname_port_message, size};\n\n  memcached_return_t rc = MEMCACHED_ERRNO;\n  if (self.root == NULL) {\n    return rc;\n  }\n\n  _set(*self.root, &error_host, rc, at, local_errno);\n  _set(self, (*self.root));\n\n  return rc;\n}",
          "includes": [
            "#include <cstdio>",
            "#include <cstdarg>",
            "#include <cerrno>",
            "#include \"libmemcached/assert.hpp\"",
            "#include \"libmemcached/common.h\""
          ],
          "macros_used": [
            "#define MAX_ERROR_LENGTH 2048"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstdio>\n#include <cstdarg>\n#include <cerrno>\n#include \"libmemcached/assert.hpp\"\n#include \"libmemcached/common.h\"\n\n#define MAX_ERROR_LENGTH 2048\n\nmemcached_return_t memcached_set_errno(memcached_instance_st &self, int local_errno,\n                                       const char *at) {\n  if (local_errno == 0) {\n    return MEMCACHED_SUCCESS;\n  }\n\n  char hostname_port_message[MAX_ERROR_LENGTH];\n  size_t size = append_host_to_string(self, hostname_port_message, sizeof(hostname_port_message));\n\n  memcached_string_t error_host = {hostname_port_message, size};\n\n  memcached_return_t rc = MEMCACHED_ERRNO;\n  if (self.root == NULL) {\n    return rc;\n  }\n\n  _set(*self.root, &error_host, rc, at, local_errno);\n  _set(self, (*self.root));\n\n  return rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcached_failed",
          "args": [
            "memcached_string_append(&ptr->value, value, length)"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcached_string_append",
          "args": [
            "&ptr->value",
            "value",
            "length"
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_string_append",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/string.cc",
          "lines": "127-141",
          "snippet": "memcached_return_t memcached_string_append(memcached_string_st *string, const char *value,\n                                           size_t length) {\n  if (memcached_failed(_string_check(string, length))) {\n    return MEMCACHED_MEMORY_ALLOCATION_FAILURE;\n  }\n\n  WATCHPOINT_ASSERT(length <= string->current_size);\n  WATCHPOINT_ASSERT(string->string);\n  WATCHPOINT_ASSERT(string->end >= string->string);\n\n  memcpy(string->end, value, length);\n  string->end += length;\n\n  return MEMCACHED_SUCCESS;\n}",
          "includes": [
            "#include \"libmemcached/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"libmemcached/common.h\"\n\nmemcached_return_t memcached_string_append(memcached_string_st *string, const char *value,\n                                           size_t length) {\n  if (memcached_failed(_string_check(string, length))) {\n    return MEMCACHED_MEMORY_ALLOCATION_FAILURE;\n  }\n\n  WATCHPOINT_ASSERT(length <= string->current_size);\n  WATCHPOINT_ASSERT(string->string);\n  WATCHPOINT_ASSERT(string->end >= string->string);\n\n  memcpy(string->end, value, length);\n  string->end += length;\n\n  return MEMCACHED_SUCCESS;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nmemcached_return_t memcached_result_set_value(memcached_result_st *ptr, const char *value,\n                                              size_t length) {\n  if (memcached_failed(memcached_string_append(&ptr->value, value, length))) {\n    return memcached_set_errno(*ptr->root, errno, MEMCACHED_AT);\n  }\n\n  return MEMCACHED_SUCCESS;\n}"
  },
  {
    "function_name": "memcached_result_reset_value",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/result.cc",
    "lines": "84-86",
    "snippet": "void memcached_result_reset_value(memcached_result_st *ptr) {\n  memcached_string_reset(&ptr->value);\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcached_string_reset",
          "args": [
            "&ptr->value"
          ],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_string_reset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/string.cc",
          "lines": "171-173",
          "snippet": "void memcached_string_reset(memcached_string_st *string) {\n  string->end = string->string;\n}",
          "includes": [
            "#include \"libmemcached/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"libmemcached/common.h\"\n\nvoid memcached_string_reset(memcached_string_st *string) {\n  string->end = string->string;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nvoid memcached_result_reset_value(memcached_result_st *ptr) {\n  memcached_string_reset(&ptr->value);\n}"
  },
  {
    "function_name": "memcached_result_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/result.cc",
    "lines": "66-82",
    "snippet": "void memcached_result_free(memcached_result_st *ptr) {\n  if (ptr == NULL) {\n    return;\n  }\n\n  memcached_string_free(&ptr->value);\n  ptr->numeric_value = UINT64_MAX;\n\n  if (memcached_is_allocated(ptr)) {\n    WATCHPOINT_ASSERT(\n        ptr->root); // Without a root, that means that result was not properly initialized.\n    libmemcached_free(ptr->root, ptr);\n  } else {\n    ptr->count = 0;\n    ptr->options.is_initialized = false;\n  }\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "libmemcached_free",
          "args": [
            "ptr->root",
            "ptr"
          ],
          "line": 77
        },
        "resolved": true,
        "details": {
          "function_name": "libmemcached_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/memory.h",
          "lines": "30-40",
          "snippet": "static inline void libmemcached_free(const memcached_st *self, void *mem) {\n  if (self) {\n    self->allocators.free(self, mem, self->allocators.context);\n  } else if (mem) {\n#ifdef __cplusplus\n    std::free(mem);\n#else\n    free(mem);\n#endif\n  }\n}",
          "includes": [
            "#  include <stdlib.h>",
            "#  include <stddef.h>",
            "#  include <cstdlib>",
            "#  include <cstddef>",
            "#include \"libmemcached/common.h\"",
            "#include \"mem_config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#  include <stdlib.h>\n#  include <stddef.h>\n#  include <cstdlib>\n#  include <cstddef>\n#include \"libmemcached/common.h\"\n#include \"mem_config.h\"\n\nstatic inline void libmemcached_free(const memcached_st *self, void *mem) {\n  if (self) {\n    self->allocators.free(self, mem, self->allocators.context);\n  } else if (mem) {\n#ifdef __cplusplus\n    std::free(mem);\n#else\n    free(mem);\n#endif\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "WATCHPOINT_ASSERT",
          "args": [
            "ptr->root"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcached_is_allocated",
          "args": [
            "ptr"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcached_string_free",
          "args": [
            "&ptr->value"
          ],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_string_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/string.cc",
          "lines": "179-193",
          "snippet": "void memcached_string_free(memcached_string_st *ptr) {\n  if (ptr == NULL) {\n    return;\n  }\n\n  if (ptr->string) {\n    libmemcached_free(ptr->root, ptr->string);\n  }\n\n  if (memcached_is_allocated(ptr)) {\n    libmemcached_free(ptr->root, ptr);\n  } else {\n    ptr->options.is_initialized = false;\n  }\n}",
          "includes": [
            "#include \"libmemcached/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"libmemcached/common.h\"\n\nvoid memcached_string_free(memcached_string_st *ptr) {\n  if (ptr == NULL) {\n    return;\n  }\n\n  if (ptr->string) {\n    libmemcached_free(ptr->root, ptr->string);\n  }\n\n  if (memcached_is_allocated(ptr)) {\n    libmemcached_free(ptr->root, ptr);\n  } else {\n    ptr->options.is_initialized = false;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nvoid memcached_result_free(memcached_result_st *ptr) {\n  if (ptr == NULL) {\n    return;\n  }\n\n  memcached_string_free(&ptr->value);\n  ptr->numeric_value = UINT64_MAX;\n\n  if (memcached_is_allocated(ptr)) {\n    WATCHPOINT_ASSERT(\n        ptr->root); // Without a root, that means that result was not properly initialized.\n    libmemcached_free(ptr->root, ptr);\n  } else {\n    ptr->count = 0;\n    ptr->options.is_initialized = false;\n  }\n}"
  },
  {
    "function_name": "memcached_result_reset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/result.cc",
    "lines": "57-64",
    "snippet": "void memcached_result_reset(memcached_result_st *ptr) {\n  ptr->key_length = 0;\n  memcached_string_reset(&ptr->value);\n  ptr->item_flags = 0;\n  ptr->item_cas = 0;\n  ptr->item_expiration = 0;\n  ptr->numeric_value = UINT64_MAX;\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcached_string_reset",
          "args": [
            "&ptr->value"
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_string_reset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/string.cc",
          "lines": "171-173",
          "snippet": "void memcached_string_reset(memcached_string_st *string) {\n  string->end = string->string;\n}",
          "includes": [
            "#include \"libmemcached/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"libmemcached/common.h\"\n\nvoid memcached_string_reset(memcached_string_st *string) {\n  string->end = string->string;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nvoid memcached_result_reset(memcached_result_st *ptr) {\n  ptr->key_length = 0;\n  memcached_string_reset(&ptr->value);\n  ptr->item_flags = 0;\n  ptr->item_cas = 0;\n  ptr->item_expiration = 0;\n  ptr->numeric_value = UINT64_MAX;\n}"
  },
  {
    "function_name": "_result_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/result.cc",
    "lines": "18-27",
    "snippet": "static inline void _result_init(memcached_result_st *self, Memcached *memc) {\n  self->item_flags = 0;\n  self->item_expiration = 0;\n  self->key_length = 0;\n  self->item_cas = 0;\n  self->root = memc;\n  self->numeric_value = UINT64_MAX;\n  self->count = 0;\n  self->item_key[0] = 0;\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nstatic inline void _result_init(memcached_result_st *self, Memcached *memc) {\n  self->item_flags = 0;\n  self->item_expiration = 0;\n  self->key_length = 0;\n  self->item_cas = 0;\n  self->root = memc;\n  self->numeric_value = UINT64_MAX;\n  self->count = 0;\n  self->item_key[0] = 0;\n}"
  }
]