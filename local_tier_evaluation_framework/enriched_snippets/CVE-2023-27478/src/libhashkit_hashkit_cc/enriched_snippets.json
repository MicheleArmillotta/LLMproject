[
  {
    "function_name": "hashkit_compare",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libhashkit/hashkit.cc",
    "lines": "87-101",
    "snippet": "bool hashkit_compare(const hashkit_st *first, const hashkit_st *second) {\n  if (not first or not second)\n    return false;\n\n  if (first->base_hash.function == second->base_hash.function\n      and first->base_hash.context == second->base_hash.context\n      and first->distribution_hash.function == second->distribution_hash.function\n      and first->distribution_hash.context == second->distribution_hash.context\n      and first->flags.is_base_same_distributed == second->flags.is_base_same_distributed)\n  {\n    return true;\n  }\n\n  return false;\n}",
    "includes": [
      "#include \"libhashkit/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"libhashkit/common.h\"\n\nbool hashkit_compare(const hashkit_st *first, const hashkit_st *second) {\n  if (not first or not second)\n    return false;\n\n  if (first->base_hash.function == second->base_hash.function\n      and first->base_hash.context == second->base_hash.context\n      and first->distribution_hash.function == second->distribution_hash.function\n      and first->distribution_hash.context == second->distribution_hash.context\n      and first->flags.is_base_same_distributed == second->flags.is_base_same_distributed)\n  {\n    return true;\n  }\n\n  return false;\n}"
  },
  {
    "function_name": "hashkit_free",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libhashkit/hashkit.cc",
    "lines": "55-64",
    "snippet": "void hashkit_free(hashkit_st *self) {\n  if (self and self->_key) {\n    aes_free_key((aes_key_t *) self->_key);\n    self->_key = NULL;\n  }\n\n  if (hashkit_is_allocated(self)) {\n    free(self);\n  }\n}",
    "includes": [
      "#include \"libhashkit/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "self"
          ],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "hashkit_free",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libhashkit/hashkit.cc",
          "lines": "55-64",
          "snippet": "void hashkit_free(hashkit_st *self) {\n  if (self and self->_key) {\n    aes_free_key((aes_key_t *) self->_key);\n    self->_key = NULL;\n  }\n\n  if (hashkit_is_allocated(self)) {\n    free(self);\n  }\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "hashkit_is_allocated",
          "args": [
            "self"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aes_free_key",
          "args": [
            "(aes_key_t *) self->_key"
          ],
          "line": 57
        },
        "resolved": true,
        "details": {
          "function_name": "aes_free_key",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libhashkit/aes.cc",
          "lines": "286-290",
          "snippet": "void aes_free_key(aes_key_t *key) {\n  if (key) {\n    free(key);\n  }\n}",
          "includes": [
            "#  include \"libhashkit/rijndael.hpp\"",
            "#include <openssl/evp.h>",
            "#include <cstring>",
            "#include \"libhashkit/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#  include \"libhashkit/rijndael.hpp\"\n#include <openssl/evp.h>\n#include <cstring>\n#include \"libhashkit/common.h\"\n\nvoid aes_free_key(aes_key_t *key) {\n  if (key) {\n    free(key);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"libhashkit/common.h\"\n\nvoid hashkit_free(hashkit_st *self) {\n  if (self and self->_key) {\n    aes_free_key((aes_key_t *) self->_key);\n    self->_key = NULL;\n  }\n\n  if (hashkit_is_allocated(self)) {\n    free(self);\n  }\n}"
  },
  {
    "function_name": "_hashkit_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libhashkit/hashkit.cc",
    "lines": "18-27",
    "snippet": "static inline void _hashkit_init(hashkit_st *self) {\n  self->base_hash.function = hashkit_one_at_a_time;\n  self->base_hash.context = NULL;\n\n  self->distribution_hash.function = hashkit_one_at_a_time;\n  self->distribution_hash.context = NULL;\n\n  self->flags.is_base_same_distributed = true;\n  self->_key = NULL;\n}",
    "includes": [
      "#include \"libhashkit/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"libhashkit/common.h\"\n\nstatic inline void _hashkit_init(hashkit_st *self) {\n  self->base_hash.function = hashkit_one_at_a_time;\n  self->base_hash.context = NULL;\n\n  self->distribution_hash.function = hashkit_one_at_a_time;\n  self->distribution_hash.context = NULL;\n\n  self->flags.is_base_same_distributed = true;\n  self->_key = NULL;\n}"
  }
]