[
  {
    "function_name": "memcached_flush_buffers",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/flush_buffers.cc",
    "lines": "18-43",
    "snippet": "memcached_return_t memcached_flush_buffers(memcached_st *shell) {\n  Memcached *memc = memcached2Memcached(shell);\n  if (memc) {\n    memcached_return_t ret = MEMCACHED_SUCCESS;\n\n    for (uint32_t x = 0; x < memcached_server_count(memc); ++x) {\n      memcached_instance_st *instance = memcached_instance_fetch(memc, x);\n\n      if (instance->write_buffer_offset) {\n        if (instance->fd == INVALID_SOCKET\n            and (ret = memcached_connect(instance)) != MEMCACHED_SUCCESS) {\n          WATCHPOINT_ERROR(ret);\n          return ret;\n        }\n\n        if (memcached_io_write(instance) == false) {\n          ret = MEMCACHED_SOME_ERRORS;\n        }\n      }\n    }\n\n    return ret;\n  }\n\n  return MEMCACHED_INVALID_ARGUMENTS;\n}",
    "includes": [
      "#include \"libmemcached/common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcached_io_write",
          "args": [
            "instance"
          ],
          "line": 33
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_io_write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/io.cc",
          "lines": "592-595",
          "snippet": "bool memcached_io_write(memcached_instance_st *instance) {\n  size_t written;\n  return _io_write(instance, NULL, 0, true, written);\n}",
          "includes": [
            "#include \"p9y/clock_gettime.hpp\"",
            "#include \"p9y/poll.hpp\"",
            "#include \"libmemcached/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"p9y/clock_gettime.hpp\"\n#include \"p9y/poll.hpp\"\n#include \"libmemcached/common.h\"\n\nbool memcached_io_write(memcached_instance_st *instance) {\n  size_t written;\n  return _io_write(instance, NULL, 0, true, written);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WATCHPOINT_ERROR",
          "args": [
            "ret"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcached_connect",
          "args": [
            "instance"
          ],
          "line": 28
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_connect",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/connect.cc",
          "lines": "598-600",
          "snippet": "memcached_return_t memcached_connect(memcached_instance_st *server) {\n  return _memcached_connect(server, true);\n}",
          "includes": [
            "#include <cassert>",
            "#include \"p9y/poll.hpp\"",
            "#include \"libmemcached/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cassert>\n#include \"p9y/poll.hpp\"\n#include \"libmemcached/common.h\"\n\nmemcached_return_t memcached_connect(memcached_instance_st *server) {\n  return _memcached_connect(server, true);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcached_instance_fetch",
          "args": [
            "memc",
            "x"
          ],
          "line": 24
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcached_server_count",
          "args": [
            "memc"
          ],
          "line": 23
        },
        "resolved": true,
        "details": {
          "function_name": "memcached_server_count",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2023-27478/repo/src/libmemcached/server.cc",
          "lines": "136-142",
          "snippet": "uint32_t memcached_server_count(const memcached_st *self) {\n  WATCHPOINT_ASSERT(self);\n  if (self == NULL)\n    return 0;\n\n  return self->number_of_hosts;\n}",
          "includes": [
            "#include \"libmemcached/common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"libmemcached/common.h\"\n\nuint32_t memcached_server_count(const memcached_st *self) {\n  WATCHPOINT_ASSERT(self);\n  if (self == NULL)\n    return 0;\n\n  return self->number_of_hosts;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcached2Memcached",
          "args": [
            "shell"
          ],
          "line": 19
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"libmemcached/common.h\"\n\nmemcached_return_t memcached_flush_buffers(memcached_st *shell) {\n  Memcached *memc = memcached2Memcached(shell);\n  if (memc) {\n    memcached_return_t ret = MEMCACHED_SUCCESS;\n\n    for (uint32_t x = 0; x < memcached_server_count(memc); ++x) {\n      memcached_instance_st *instance = memcached_instance_fetch(memc, x);\n\n      if (instance->write_buffer_offset) {\n        if (instance->fd == INVALID_SOCKET\n            and (ret = memcached_connect(instance)) != MEMCACHED_SUCCESS) {\n          WATCHPOINT_ERROR(ret);\n          return ret;\n        }\n\n        if (memcached_io_write(instance) == false) {\n          ret = MEMCACHED_SOME_ERRORS;\n        }\n      }\n    }\n\n    return ret;\n  }\n\n  return MEMCACHED_INVALID_ARGUMENTS;\n}"
  }
]