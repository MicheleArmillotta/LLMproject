[
  {
    "function_name": "IsSmallerThan",
    "container": "EbmlFloat",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlFloat.cpp",
    "lines": "149-155",
    "snippet": "bool EbmlFloat::IsSmallerThan(const EbmlElement *Cmp) const\n{\n  if (EbmlId(*this) == EbmlId(*Cmp))\n    return this->Value < static_cast<const EbmlFloat *>(Cmp)->Value;\n  else\n    return false;\n}",
    "includes": [
      "#include \"ebml/EbmlFloat.h\"",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "static_cast<const EbmlFloat *>",
          "args": [
            "Cmp"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EbmlId",
          "args": [
            "*Cmp"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EbmlId",
          "args": [
            "*this"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/EbmlFloat.h\"\n#include <cassert>\n\nEbmlFloat {\n  bool EbmlFloat::IsSmallerThan(const EbmlElement *Cmp) const\n  {\n    if (EbmlId(*this) == EbmlId(*Cmp))\n      return this->Value < static_cast<const EbmlFloat *>(Cmp)->Value;\n    else\n      return false;\n  }\n}"
  },
  {
    "function_name": "ReadData",
    "container": "EbmlFloat",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlFloat.cpp",
    "lines": "120-147",
    "snippet": "filepos_t EbmlFloat::ReadData(IOCallback & input, ScopeMode ReadFully)\n{\n  if (ReadFully != SCOPE_NO_DATA) {\n    binary Buffer[20];\n    assert(GetSize() <= 20);\n    input.readFully(Buffer, GetSize());\n\n    if (GetSize() == 4) {\n      big_int32 TmpRead;\n      TmpRead.Eval(Buffer);\n      int32 tmpp = int32(TmpRead);\n      float val;\n      memcpy(&val, &tmpp, 4);\n      Value = val;\n      SetValueIsSet();\n    } else if (GetSize() == 8) {\n      big_int64 TmpRead;\n      TmpRead.Eval(Buffer);\n      int64 tmpp = int64(TmpRead);\n      double val;\n      memcpy(&val, &tmpp, 8);\n      Value = val;\n      SetValueIsSet();\n    }\n  }\n\n  return GetSize();\n}",
    "includes": [
      "#include \"ebml/EbmlFloat.h\"",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetSize",
          "args": [],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "GetSize",
          "container": "SafeReadIOCallback",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/SafeReadIOCallback.cpp",
          "lines": "88-92",
          "snippet": "size_t\nSafeReadIOCallback::GetSize()\n  const {\n  return mSize;\n}",
          "includes": [
            "#include \"ebml/SafeReadIOCallback.h\"",
            "#include \"ebml/MemReadIOCallback.h\"",
            "#include \"ebml/EbmlBinary.h\"",
            "#include <cstring>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/SafeReadIOCallback.h\"\n#include \"ebml/MemReadIOCallback.h\"\n#include \"ebml/EbmlBinary.h\"\n#include <cstring>\n\nSafeReadIOCallback {\n  size_t\n  SafeReadIOCallback::GetSize()\n    const {\n    return mSize;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SetValueIsSet",
          "args": [],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&val",
            "&tmpp",
            "8"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "int64",
          "args": [
            "TmpRead"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TmpRead.Eval",
          "args": [
            "Buffer"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SetValueIsSet",
          "args": [],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&val",
            "&tmpp",
            "4"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "int32",
          "args": [
            "TmpRead"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TmpRead.Eval",
          "args": [
            "Buffer"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "input.readFully",
          "args": [
            "Buffer",
            "GetSize()"
          ],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "readFully",
          "container": "IOCallback",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/IOCallback.cpp",
          "lines": "67-79",
          "snippet": "void IOCallback::readFully(void*Buffer,size_t Size)\n{\n  if(Buffer == NULL)\n    throw;\n\n  if(read(Buffer,Size) != Size) {\n#if !defined(__GNUC__) || (__GNUC__ > 2)\n    stringstream Msg;\n    Msg<<\"EOF in readFully(\"<<Buffer<<\",\"<<Size<<\")\";\n    throw runtime_error(Msg.str());\n#endif // GCC2\n  }\n}",
          "includes": [
            "#include \"ebml/IOCallback.h\"",
            "#include <stdexcept>",
            "#include <sstream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/IOCallback.h\"\n#include <stdexcept>\n#include <sstream>\n\nIOCallback {\n  void IOCallback::readFully(void*Buffer,size_t Size)\n  {\n    if(Buffer == NULL)\n      throw;\n  \n    if(read(Buffer,Size) != Size) {\n  #if !defined(__GNUC__) || (__GNUC__ > 2)\n      stringstream Msg;\n      Msg<<\"EOF in readFully(\"<<Buffer<<\",\"<<Size<<\")\";\n      throw runtime_error(Msg.str());\n  #endif // GCC2\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "GetSize() <= 20"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/EbmlFloat.h\"\n#include <cassert>\n\nEbmlFloat {\n  filepos_t EbmlFloat::ReadData(IOCallback & input, ScopeMode ReadFully)\n  {\n    if (ReadFully != SCOPE_NO_DATA) {\n      binary Buffer[20];\n      assert(GetSize() <= 20);\n      input.readFully(Buffer, GetSize());\n  \n      if (GetSize() == 4) {\n        big_int32 TmpRead;\n        TmpRead.Eval(Buffer);\n        int32 tmpp = int32(TmpRead);\n        float val;\n        memcpy(&val, &tmpp, 4);\n        Value = val;\n        SetValueIsSet();\n      } else if (GetSize() == 8) {\n        big_int64 TmpRead;\n        TmpRead.Eval(Buffer);\n        int64 tmpp = int64(TmpRead);\n        double val;\n        memcpy(&val, &tmpp, 8);\n        Value = val;\n        SetValueIsSet();\n      }\n    }\n  \n    return GetSize();\n  }\n}"
  },
  {
    "function_name": "UpdateSize",
    "container": "EbmlFloat",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlFloat.cpp",
    "lines": "110-115",
    "snippet": "uint64 EbmlFloat::UpdateSize(bool bWithDefault, bool  /* bForceRender */)\n{\n  if (!bWithDefault && IsDefaultValue())\n    return 0;\n  return GetSize();\n}",
    "includes": [
      "#include \"ebml/EbmlFloat.h\"",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetSize",
          "args": [],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "GetSize",
          "container": "SafeReadIOCallback",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/SafeReadIOCallback.cpp",
          "lines": "88-92",
          "snippet": "size_t\nSafeReadIOCallback::GetSize()\n  const {\n  return mSize;\n}",
          "includes": [
            "#include \"ebml/SafeReadIOCallback.h\"",
            "#include \"ebml/MemReadIOCallback.h\"",
            "#include \"ebml/EbmlBinary.h\"",
            "#include <cstring>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/SafeReadIOCallback.h\"\n#include \"ebml/MemReadIOCallback.h\"\n#include \"ebml/EbmlBinary.h\"\n#include <cstring>\n\nSafeReadIOCallback {\n  size_t\n  SafeReadIOCallback::GetSize()\n    const {\n    return mSize;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IsDefaultValue",
          "args": [],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/EbmlFloat.h\"\n#include <cassert>\n\nEbmlFloat {\n  uint64 EbmlFloat::UpdateSize(bool bWithDefault, bool  /* bForceRender */)\n  {\n    if (!bWithDefault && IsDefaultValue())\n      return 0;\n    return GetSize();\n  }\n}"
  },
  {
    "function_name": "RenderData",
    "container": "EbmlFloat",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlFloat.cpp",
    "lines": "89-108",
    "snippet": "filepos_t EbmlFloat::RenderData(IOCallback & output, bool /* bForceRender */, bool /* bWithDefault */)\n{\n  assert(GetSize() == 4 || GetSize() == 8);\n\n  if (GetSize() == 4) {\n    float val = Value;\n    int Tmp;\n    memcpy(&Tmp, &val, 4);\n    big_int32 TmpToWrite(Tmp);\n    output.writeFully(&TmpToWrite.endian(), GetSize());\n  } else if (GetSize() == 8) {\n    double val = Value;\n    int64 Tmp;\n    memcpy(&Tmp, &val, 8);\n    big_int64 TmpToWrite(Tmp);\n    output.writeFully(&TmpToWrite.endian(), GetSize());\n  }\n\n  return GetSize();\n}",
    "includes": [
      "#include \"ebml/EbmlFloat.h\"",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetSize",
          "args": [],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "GetSize",
          "container": "SafeReadIOCallback",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/SafeReadIOCallback.cpp",
          "lines": "88-92",
          "snippet": "size_t\nSafeReadIOCallback::GetSize()\n  const {\n  return mSize;\n}",
          "includes": [
            "#include \"ebml/SafeReadIOCallback.h\"",
            "#include \"ebml/MemReadIOCallback.h\"",
            "#include \"ebml/EbmlBinary.h\"",
            "#include <cstring>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/SafeReadIOCallback.h\"\n#include \"ebml/MemReadIOCallback.h\"\n#include \"ebml/EbmlBinary.h\"\n#include <cstring>\n\nSafeReadIOCallback {\n  size_t\n  SafeReadIOCallback::GetSize()\n    const {\n    return mSize;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "output.writeFully",
          "args": [
            "&TmpToWrite.endian()",
            "GetSize()"
          ],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "writeFully",
          "container": "IOCallback",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/IOCallback.cpp",
          "lines": "46-63",
          "snippet": "START_LIBEBML_NAMESPACE\n\nvoid IOCallback::writeFully(const void*Buffer,size_t Size)\n{\n  if (Size == 0)\n    return;\n\n  if (Buffer == NULL)\n    throw;\n\n  if(write(Buffer,Size) != Size) {\n#if !defined(__GNUC__) || (__GNUC__ > 2)\n    stringstream Msg;\n    Msg<<\"EOF in writeFully(\"<<Buffer<<\",\"<<Size<<\")\";\n    throw runtime_error(Msg.str());\n#endif // GCC2\n  }\n}",
          "includes": [
            "#include \"ebml/IOCallback.h\"",
            "#include <stdexcept>",
            "#include <sstream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/IOCallback.h\"\n#include <stdexcept>\n#include <sstream>\n\nIOCallback {\n  START_LIBEBML_NAMESPACE\n  \n  void IOCallback::writeFully(const void*Buffer,size_t Size)\n  {\n    if (Size == 0)\n      return;\n  \n    if (Buffer == NULL)\n      throw;\n  \n    if(write(Buffer,Size) != Size) {\n  #if !defined(__GNUC__) || (__GNUC__ > 2)\n      stringstream Msg;\n      Msg<<\"EOF in writeFully(\"<<Buffer<<\",\"<<Size<<\")\";\n      throw runtime_error(Msg.str());\n  #endif // GCC2\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "TmpToWrite.endian",
          "args": [],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&Tmp",
            "&val",
            "8"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TmpToWrite.endian",
          "args": [],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&Tmp",
            "&val",
            "4"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "GetSize() == 4 || GetSize() == 8"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/EbmlFloat.h\"\n#include <cassert>\n\nEbmlFloat {\n  filepos_t EbmlFloat::RenderData(IOCallback & output, bool /* bForceRender */, bool /* bWithDefault */)\n  {\n    assert(GetSize() == 4 || GetSize() == 8);\n  \n    if (GetSize() == 4) {\n      float val = Value;\n      int Tmp;\n      memcpy(&Tmp, &val, 4);\n      big_int32 TmpToWrite(Tmp);\n      output.writeFully(&TmpToWrite.endian(), GetSize());\n    } else if (GetSize() == 8) {\n      double val = Value;\n      int64 Tmp;\n      memcpy(&Tmp, &val, 8);\n      big_int64 TmpToWrite(Tmp);\n      output.writeFully(&TmpToWrite.endian(), GetSize());\n    }\n  \n    return GetSize();\n  }\n}"
  },
  {
    "function_name": "GetValue",
    "container": "EbmlFloat",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlFloat.cpp",
    "lines": "79-79",
    "snippet": "double EbmlFloat::GetValue() const {return Value;}",
    "includes": [
      "#include \"ebml/EbmlFloat.h\"",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ebml/EbmlFloat.h\"\n#include <cassert>\n\nEbmlFloat {\n  double EbmlFloat::GetValue() const {return Value;}\n}"
  },
  {
    "function_name": "DefaultVal",
    "container": "EbmlFloat",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlFloat.cpp",
    "lines": "70-74",
    "snippet": "double EbmlFloat::DefaultVal() const\n{\n  assert(DefaultISset());\n  return DefaultValue;\n}",
    "includes": [
      "#include \"ebml/EbmlFloat.h\"",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "DefaultISset()"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DefaultISset",
          "args": [],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/EbmlFloat.h\"\n#include <cassert>\n\nEbmlFloat {\n  double EbmlFloat::DefaultVal() const\n  {\n    assert(DefaultISset());\n    return DefaultValue;\n  }\n}"
  },
  {
    "function_name": "SetDefaultValue",
    "container": "EbmlFloat",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlFloat.cpp",
    "lines": "63-68",
    "snippet": "void EbmlFloat::SetDefaultValue(double aValue)\n{\n  assert(!DefaultISset());\n  DefaultValue = aValue;\n  SetDefaultIsSet();\n}",
    "includes": [
      "#include \"ebml/EbmlFloat.h\"",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetDefaultIsSet",
          "args": [],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "!DefaultISset()"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DefaultISset",
          "args": [],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/EbmlFloat.h\"\n#include <cassert>\n\nEbmlFloat {\n  void EbmlFloat::SetDefaultValue(double aValue)\n  {\n    assert(!DefaultISset());\n    DefaultValue = aValue;\n    SetDefaultIsSet();\n  }\n}"
  },
  {
    "function_name": "EbmlFloat",
    "container": "EbmlFloat",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlFloat.cpp",
    "lines": "56-61",
    "snippet": "EbmlFloat::EbmlFloat(const EbmlFloat & ElementToClone)\n  :EbmlElement(ElementToClone)\n  ,Value(ElementToClone.Value)\n  ,DefaultValue(ElementToClone.DefaultValue)\n{\n}",
    "includes": [
      "#include \"ebml/EbmlFloat.h\"",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ebml/EbmlFloat.h\"\n#include <cassert>\n\nEbmlFloat {\n  EbmlFloat::EbmlFloat(const EbmlFloat & ElementToClone)\n    :EbmlElement(ElementToClone)\n    ,Value(ElementToClone.Value)\n    ,DefaultValue(ElementToClone.DefaultValue)\n  {\n  }\n}"
  },
  {
    "function_name": "EbmlFloat",
    "container": "EbmlFloat",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlFloat.cpp",
    "lines": "49-54",
    "snippet": "EbmlFloat::EbmlFloat(const double aDefaultValue, const EbmlFloat::Precision prec)\n  :EbmlElement(0, true), Value(aDefaultValue), DefaultValue(aDefaultValue)\n{\n  SetDefaultIsSet();\n  SetPrecision(prec);\n}",
    "includes": [
      "#include \"ebml/EbmlFloat.h\"",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [
      "START_LIBEBML_NAMESPACE\n\nEbmlFloat::EbmlFloat(const EbmlFloat::Precision prec)\n  :EbmlElement(0, false)\n{\n  SetPrecision(prec);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetPrecision",
          "args": [
            "prec"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SetDefaultIsSet",
          "args": [],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/EbmlFloat.h\"\n#include <cassert>\n\nSTART_LIBEBML_NAMESPACE\n\nEbmlFloat::EbmlFloat(const EbmlFloat::Precision prec)\n  :EbmlElement(0, false)\n{\n  SetPrecision(prec);\n\nEbmlFloat {\n  EbmlFloat::EbmlFloat(const double aDefaultValue, const EbmlFloat::Precision prec)\n    :EbmlElement(0, true), Value(aDefaultValue), DefaultValue(aDefaultValue)\n  {\n    SetDefaultIsSet();\n    SetPrecision(prec);\n  }\n}"
  }
]