[
  {
    "function_name": "unsetDebugFile",
    "container": "ADbg",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/Debug.cpp",
    "lines": "220-236",
    "snippet": "bool ADbg::unsetDebugFile() {\n  bool result = (hFile == NULL);\n  if (result)\n    return true;\n\n#ifdef WIN32\n  result = (CloseHandle(hFile) != 0);\n#else\n  result = (fclose(hFile) == 0);\n#endif\n\n  if (result) {\n    OutPut(-1,\"Debug hFile Closing succeeded\");\n    hFile = NULL;\n  }\n  return result;\n}",
    "includes": [
      "#include \"ebml/Debug.h\"",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <windows.h> // For OutputDebugString",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "OutPut",
          "args": [
            "-1",
            "\"Debug hFile Closing succeeded\""
          ],
          "line": 232
        },
        "resolved": true,
        "details": {
          "function_name": "OutPut",
          "container": "ADbg",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/Debug.cpp",
          "lines": "162-176",
          "snippet": "int ADbg::OutPut(int forLevel, const char * format,...) const\n{\n  int result=0;\n\n  if (forLevel >= my_level) {\n    va_list tstlist;\n\n    va_start(tstlist, format);\n\n    result = _OutPut(format,tstlist);\n\n  }\n\n  return result;\n}",
          "includes": [
            "#include \"ebml/Debug.h\"",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <windows.h> // For OutputDebugString",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/Debug.h\"\n#include <sys/time.h>\n#include <time.h>\n#include <windows.h> // For OutputDebugString\n#include <stdio.h>\n\nADbg {\n  int ADbg::OutPut(int forLevel, const char * format,...) const\n  {\n    int result=0;\n  \n    if (forLevel >= my_level) {\n      va_list tstlist;\n  \n      va_start(tstlist, format);\n  \n      result = _OutPut(format,tstlist);\n  \n    }\n  \n    return result;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "fclose",
          "args": [
            "hFile"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CloseHandle",
          "args": [
            "hFile"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/Debug.h\"\n#include <sys/time.h>\n#include <time.h>\n#include <windows.h> // For OutputDebugString\n#include <stdio.h>\n\nADbg {\n  bool ADbg::unsetDebugFile() {\n    bool result = (hFile == NULL);\n    if (result)\n      return true;\n  \n  #ifdef WIN32\n    result = (CloseHandle(hFile) != 0);\n  #else\n    result = (fclose(hFile) == 0);\n  #endif\n  \n    if (result) {\n      OutPut(-1,\"Debug hFile Closing succeeded\");\n      hFile = NULL;\n    }\n    return result;\n  }\n}"
  },
  {
    "function_name": "setDebugFile",
    "container": "ADbg",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/Debug.cpp",
    "lines": "187-218",
    "snippet": "bool ADbg::setDebugFile(const char * NewFilename) {\n  bool result;\n  result = unsetDebugFile();\n\n  if (!result)\n    return false;\n\n  result = false;\n\n#ifdef WIN32\n  hFile = CreateFileA(NewFilename, GENERIC_WRITE, FILE_SHARE_WRITE|FILE_SHARE_READ, NULL, OPEN_ALWAYS, FILE_ATTRIBUTE_NORMAL, NULL );\n\n  if (hFile != INVALID_HANDLE_VALUE) {\n    SetFilePointer( hFile, 0, 0, FILE_END );\n\n    result = true;\n  }\n#else\n  hFile = fopen(NewFilename, \"w+\");\n  if (hFile != NULL) {\n    fseek(hFile, 0, SEEK_END);\n    result = true;\n  }\n#endif\n  if (result)\n    OutPut(-1,\"Debug hFile Opening succeeded\");\n\n  else\n    OutPut(-1,\"Debug hFile %s Opening failed\",NewFilename);\n\n  return result;\n}",
    "includes": [
      "#include \"ebml/Debug.h\"",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <windows.h> // For OutputDebugString",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "OutPut",
          "args": [
            "-1",
            "\"Debug hFile %s Opening failed\"",
            "NewFilename"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OutPut",
          "args": [
            "-1",
            "\"Debug hFile Opening succeeded\""
          ],
          "line": 212
        },
        "resolved": true,
        "details": {
          "function_name": "OutPut",
          "container": "ADbg",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/Debug.cpp",
          "lines": "162-176",
          "snippet": "int ADbg::OutPut(int forLevel, const char * format,...) const\n{\n  int result=0;\n\n  if (forLevel >= my_level) {\n    va_list tstlist;\n\n    va_start(tstlist, format);\n\n    result = _OutPut(format,tstlist);\n\n  }\n\n  return result;\n}",
          "includes": [
            "#include \"ebml/Debug.h\"",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <windows.h> // For OutputDebugString",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/Debug.h\"\n#include <sys/time.h>\n#include <time.h>\n#include <windows.h> // For OutputDebugString\n#include <stdio.h>\n\nADbg {\n  int ADbg::OutPut(int forLevel, const char * format,...) const\n  {\n    int result=0;\n  \n    if (forLevel >= my_level) {\n      va_list tstlist;\n  \n      va_start(tstlist, format);\n  \n      result = _OutPut(format,tstlist);\n  \n    }\n  \n    return result;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "fseek",
          "args": [
            "hFile",
            "0",
            "SEEK_END"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "NewFilename",
            "\"w+\""
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SetFilePointer",
          "args": [
            "hFile",
            "0",
            "0",
            "FILE_END"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CreateFileA",
          "args": [
            "NewFilename",
            "GENERIC_WRITE",
            "FILE_SHARE_WRITE|FILE_SHARE_READ",
            "NULL",
            "OPEN_ALWAYS",
            "FILE_ATTRIBUTE_NORMAL",
            "NULL"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unsetDebugFile",
          "args": [],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "unsetDebugFile",
          "container": "ADbg",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/Debug.cpp",
          "lines": "220-236",
          "snippet": "bool ADbg::unsetDebugFile() {\n  bool result = (hFile == NULL);\n  if (result)\n    return true;\n\n#ifdef WIN32\n  result = (CloseHandle(hFile) != 0);\n#else\n  result = (fclose(hFile) == 0);\n#endif\n\n  if (result) {\n    OutPut(-1,\"Debug hFile Closing succeeded\");\n    hFile = NULL;\n  }\n  return result;\n}",
          "includes": [
            "#include \"ebml/Debug.h\"",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <windows.h> // For OutputDebugString",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/Debug.h\"\n#include <sys/time.h>\n#include <time.h>\n#include <windows.h> // For OutputDebugString\n#include <stdio.h>\n\nADbg {\n  bool ADbg::unsetDebugFile() {\n    bool result = (hFile == NULL);\n    if (result)\n      return true;\n  \n  #ifdef WIN32\n    result = (CloseHandle(hFile) != 0);\n  #else\n    result = (fclose(hFile) == 0);\n  #endif\n  \n    if (result) {\n      OutPut(-1,\"Debug hFile Closing succeeded\");\n      hFile = NULL;\n    }\n    return result;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ebml/Debug.h\"\n#include <sys/time.h>\n#include <time.h>\n#include <windows.h> // For OutputDebugString\n#include <stdio.h>\n\nADbg {\n  bool ADbg::setDebugFile(const char * NewFilename) {\n    bool result;\n    result = unsetDebugFile();\n  \n    if (!result)\n      return false;\n  \n    result = false;\n  \n  #ifdef WIN32\n    hFile = CreateFileA(NewFilename, GENERIC_WRITE, FILE_SHARE_WRITE|FILE_SHARE_READ, NULL, OPEN_ALWAYS, FILE_ATTRIBUTE_NORMAL, NULL );\n  \n    if (hFile != INVALID_HANDLE_VALUE) {\n      SetFilePointer( hFile, 0, 0, FILE_END );\n  \n      result = true;\n    }\n  #else\n    hFile = fopen(NewFilename, \"w+\");\n    if (hFile != NULL) {\n      fseek(hFile, 0, SEEK_END);\n      result = true;\n    }\n  #endif\n    if (result)\n      OutPut(-1,\"Debug hFile Opening succeeded\");\n  \n    else\n      OutPut(-1,\"Debug hFile %s Opening failed\",NewFilename);\n  \n    return result;\n  }\n}"
  },
  {
    "function_name": "OutPut",
    "container": "ADbg",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/Debug.cpp",
    "lines": "178-185",
    "snippet": "int ADbg::OutPut(const char * format,...) const\n{\n  va_list tstlist;\n\n  va_start(tstlist, format);\n\n  return _OutPut(format,tstlist);\n}",
    "includes": [
      "#include \"ebml/Debug.h\"",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <windows.h> // For OutputDebugString",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_OutPut",
          "args": [
            "format",
            "tstlist"
          ],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "_OutPut",
          "container": "ADbg",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/Debug.cpp",
          "lines": "75-160",
          "snippet": "inline int ADbg::_OutPut(const char * format,va_list params) const\n{\n  int result;\n\n  char tst[1000];\n  char myformat[256];\n\n#ifdef WIN32\n  if (my_time_included) {\n    SYSTEMTIME time;\n    GetSystemTime(&time);\n    if (prefix[0] == '\\0')\n      wsprintfA(myformat,\"%04d/%02d/%02d %02d:%02d:%02d.%03d UTC : %s\\r\\n\",\n                time.wYear,\n                time.wMonth,\n                time.wDay,\n                time.wHour,\n                time.wMinute,\n                time.wSecond,\n                time.wMilliseconds,\n                format);\n    else\n      wsprintfA(myformat,\"%04d/%02d/%02d %02d:%02d:%02d.%03d UTC : %s - %s\\r\\n\",\n                time.wYear,\n                time.wMonth,\n                time.wDay,\n                time.wHour,\n                time.wMinute,\n                time.wSecond,\n                time.wMilliseconds,\n                prefix,\n                format);\n  } else {\n    if (prefix[0] == '\\0')\n      wsprintfA( myformat, \"%s\\r\\n\", format);\n    else\n      wsprintfA( myformat, \"%s - %s\\r\\n\", prefix, format);\n  }\n  result = vsprintf(tst,myformat,params);\n\n  if (my_debug_output)\n    OutputDebugStringA(tst);\n\n  if (my_use_file && (hFile != NULL)) {\n    SetFilePointer( hFile, 0, 0, FILE_END );\n    DWORD written;\n    WriteFile( hFile, tst, lstrlenA(tst), &written, NULL );\n  }\n#else\n  if (my_time_included) {\n    time_t nowSecs;\n    struct tm *now;\n    struct timeval tv;\n\n    nowSecs = time(NULL);\n    gettimeofday(&tv, NULL);\n    now = gmtime(&nowSecs);\n    if (prefix[0] == '\\0')\n      sprintf(myformat,\"%04d/%02d/%02d %02d:%02d:%02ld.%03ld UTC : %s\\r\\n\",\n              now->tm_year, now->tm_mon, now->tm_mday,\n              now->tm_hour, now->tm_min, tv.tv_sec,\n              (long)tv.tv_usec / 1000, format);\n    else\n      sprintf(myformat,\"%04d/%02d/%02d %02d:%02d:%02ld.%03ld UTC : %s - %s\\r\\n\",\n              now->tm_year, now->tm_mon, now->tm_mday,\n              now->tm_hour, now->tm_min, tv.tv_sec,\n              (long)tv.tv_usec / 1000, prefix, format);\n\n  } else {\n    if (prefix[0] == '\\0')\n      sprintf( myformat, \"%s\\r\\n\", format);\n    else\n      sprintf( myformat, \"%s - %s\\r\\n\", prefix, format);\n  }\n\n  result = vsprintf(tst,myformat,params);\n\n  if (my_debug_output)\n    fputs(tst, stderr);\n\n  if (my_use_file && (hFile != NULL))\n    fputs(tst, hFile);\n#endif\n\n  return result;\n}",
          "includes": [
            "#include \"ebml/Debug.h\"",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <windows.h> // For OutputDebugString",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/Debug.h\"\n#include <sys/time.h>\n#include <time.h>\n#include <windows.h> // For OutputDebugString\n#include <stdio.h>\n\nADbg {\n  inline int ADbg::_OutPut(const char * format,va_list params) const\n  {\n    int result;\n  \n    char tst[1000];\n    char myformat[256];\n  \n  #ifdef WIN32\n    if (my_time_included) {\n      SYSTEMTIME time;\n      GetSystemTime(&time);\n      if (prefix[0] == '\\0')\n        wsprintfA(myformat,\"%04d/%02d/%02d %02d:%02d:%02d.%03d UTC : %s\\r\\n\",\n                  time.wYear,\n                  time.wMonth,\n                  time.wDay,\n                  time.wHour,\n                  time.wMinute,\n                  time.wSecond,\n                  time.wMilliseconds,\n                  format);\n      else\n        wsprintfA(myformat,\"%04d/%02d/%02d %02d:%02d:%02d.%03d UTC : %s - %s\\r\\n\",\n                  time.wYear,\n                  time.wMonth,\n                  time.wDay,\n                  time.wHour,\n                  time.wMinute,\n                  time.wSecond,\n                  time.wMilliseconds,\n                  prefix,\n                  format);\n    } else {\n      if (prefix[0] == '\\0')\n        wsprintfA( myformat, \"%s\\r\\n\", format);\n      else\n        wsprintfA( myformat, \"%s - %s\\r\\n\", prefix, format);\n    }\n    result = vsprintf(tst,myformat,params);\n  \n    if (my_debug_output)\n      OutputDebugStringA(tst);\n  \n    if (my_use_file && (hFile != NULL)) {\n      SetFilePointer( hFile, 0, 0, FILE_END );\n      DWORD written;\n      WriteFile( hFile, tst, lstrlenA(tst), &written, NULL );\n    }\n  #else\n    if (my_time_included) {\n      time_t nowSecs;\n      struct tm *now;\n      struct timeval tv;\n  \n      nowSecs = time(NULL);\n      gettimeofday(&tv, NULL);\n      now = gmtime(&nowSecs);\n      if (prefix[0] == '\\0')\n        sprintf(myformat,\"%04d/%02d/%02d %02d:%02d:%02ld.%03ld UTC : %s\\r\\n\",\n                now->tm_year, now->tm_mon, now->tm_mday,\n                now->tm_hour, now->tm_min, tv.tv_sec,\n                (long)tv.tv_usec / 1000, format);\n      else\n        sprintf(myformat,\"%04d/%02d/%02d %02d:%02d:%02ld.%03ld UTC : %s - %s\\r\\n\",\n                now->tm_year, now->tm_mon, now->tm_mday,\n                now->tm_hour, now->tm_min, tv.tv_sec,\n                (long)tv.tv_usec / 1000, prefix, format);\n  \n    } else {\n      if (prefix[0] == '\\0')\n        sprintf( myformat, \"%s\\r\\n\", format);\n      else\n        sprintf( myformat, \"%s - %s\\r\\n\", prefix, format);\n    }\n  \n    result = vsprintf(tst,myformat,params);\n  \n    if (my_debug_output)\n      fputs(tst, stderr);\n  \n    if (my_use_file && (hFile != NULL))\n      fputs(tst, hFile);\n  #endif\n  \n    return result;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "tstlist",
            "format"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/Debug.h\"\n#include <sys/time.h>\n#include <time.h>\n#include <windows.h> // For OutputDebugString\n#include <stdio.h>\n\nADbg {\n  int ADbg::OutPut(const char * format,...) const\n  {\n    va_list tstlist;\n  \n    va_start(tstlist, format);\n  \n    return _OutPut(format,tstlist);\n  }\n}"
  },
  {
    "function_name": "OutPut",
    "container": "ADbg",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/Debug.cpp",
    "lines": "162-176",
    "snippet": "int ADbg::OutPut(int forLevel, const char * format,...) const\n{\n  int result=0;\n\n  if (forLevel >= my_level) {\n    va_list tstlist;\n\n    va_start(tstlist, format);\n\n    result = _OutPut(format,tstlist);\n\n  }\n\n  return result;\n}",
    "includes": [
      "#include \"ebml/Debug.h\"",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <windows.h> // For OutputDebugString",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_OutPut",
          "args": [
            "format",
            "tstlist"
          ],
          "line": 171
        },
        "resolved": true,
        "details": {
          "function_name": "_OutPut",
          "container": "ADbg",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/Debug.cpp",
          "lines": "75-160",
          "snippet": "inline int ADbg::_OutPut(const char * format,va_list params) const\n{\n  int result;\n\n  char tst[1000];\n  char myformat[256];\n\n#ifdef WIN32\n  if (my_time_included) {\n    SYSTEMTIME time;\n    GetSystemTime(&time);\n    if (prefix[0] == '\\0')\n      wsprintfA(myformat,\"%04d/%02d/%02d %02d:%02d:%02d.%03d UTC : %s\\r\\n\",\n                time.wYear,\n                time.wMonth,\n                time.wDay,\n                time.wHour,\n                time.wMinute,\n                time.wSecond,\n                time.wMilliseconds,\n                format);\n    else\n      wsprintfA(myformat,\"%04d/%02d/%02d %02d:%02d:%02d.%03d UTC : %s - %s\\r\\n\",\n                time.wYear,\n                time.wMonth,\n                time.wDay,\n                time.wHour,\n                time.wMinute,\n                time.wSecond,\n                time.wMilliseconds,\n                prefix,\n                format);\n  } else {\n    if (prefix[0] == '\\0')\n      wsprintfA( myformat, \"%s\\r\\n\", format);\n    else\n      wsprintfA( myformat, \"%s - %s\\r\\n\", prefix, format);\n  }\n  result = vsprintf(tst,myformat,params);\n\n  if (my_debug_output)\n    OutputDebugStringA(tst);\n\n  if (my_use_file && (hFile != NULL)) {\n    SetFilePointer( hFile, 0, 0, FILE_END );\n    DWORD written;\n    WriteFile( hFile, tst, lstrlenA(tst), &written, NULL );\n  }\n#else\n  if (my_time_included) {\n    time_t nowSecs;\n    struct tm *now;\n    struct timeval tv;\n\n    nowSecs = time(NULL);\n    gettimeofday(&tv, NULL);\n    now = gmtime(&nowSecs);\n    if (prefix[0] == '\\0')\n      sprintf(myformat,\"%04d/%02d/%02d %02d:%02d:%02ld.%03ld UTC : %s\\r\\n\",\n              now->tm_year, now->tm_mon, now->tm_mday,\n              now->tm_hour, now->tm_min, tv.tv_sec,\n              (long)tv.tv_usec / 1000, format);\n    else\n      sprintf(myformat,\"%04d/%02d/%02d %02d:%02d:%02ld.%03ld UTC : %s - %s\\r\\n\",\n              now->tm_year, now->tm_mon, now->tm_mday,\n              now->tm_hour, now->tm_min, tv.tv_sec,\n              (long)tv.tv_usec / 1000, prefix, format);\n\n  } else {\n    if (prefix[0] == '\\0')\n      sprintf( myformat, \"%s\\r\\n\", format);\n    else\n      sprintf( myformat, \"%s - %s\\r\\n\", prefix, format);\n  }\n\n  result = vsprintf(tst,myformat,params);\n\n  if (my_debug_output)\n    fputs(tst, stderr);\n\n  if (my_use_file && (hFile != NULL))\n    fputs(tst, hFile);\n#endif\n\n  return result;\n}",
          "includes": [
            "#include \"ebml/Debug.h\"",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <windows.h> // For OutputDebugString",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/Debug.h\"\n#include <sys/time.h>\n#include <time.h>\n#include <windows.h> // For OutputDebugString\n#include <stdio.h>\n\nADbg {\n  inline int ADbg::_OutPut(const char * format,va_list params) const\n  {\n    int result;\n  \n    char tst[1000];\n    char myformat[256];\n  \n  #ifdef WIN32\n    if (my_time_included) {\n      SYSTEMTIME time;\n      GetSystemTime(&time);\n      if (prefix[0] == '\\0')\n        wsprintfA(myformat,\"%04d/%02d/%02d %02d:%02d:%02d.%03d UTC : %s\\r\\n\",\n                  time.wYear,\n                  time.wMonth,\n                  time.wDay,\n                  time.wHour,\n                  time.wMinute,\n                  time.wSecond,\n                  time.wMilliseconds,\n                  format);\n      else\n        wsprintfA(myformat,\"%04d/%02d/%02d %02d:%02d:%02d.%03d UTC : %s - %s\\r\\n\",\n                  time.wYear,\n                  time.wMonth,\n                  time.wDay,\n                  time.wHour,\n                  time.wMinute,\n                  time.wSecond,\n                  time.wMilliseconds,\n                  prefix,\n                  format);\n    } else {\n      if (prefix[0] == '\\0')\n        wsprintfA( myformat, \"%s\\r\\n\", format);\n      else\n        wsprintfA( myformat, \"%s - %s\\r\\n\", prefix, format);\n    }\n    result = vsprintf(tst,myformat,params);\n  \n    if (my_debug_output)\n      OutputDebugStringA(tst);\n  \n    if (my_use_file && (hFile != NULL)) {\n      SetFilePointer( hFile, 0, 0, FILE_END );\n      DWORD written;\n      WriteFile( hFile, tst, lstrlenA(tst), &written, NULL );\n    }\n  #else\n    if (my_time_included) {\n      time_t nowSecs;\n      struct tm *now;\n      struct timeval tv;\n  \n      nowSecs = time(NULL);\n      gettimeofday(&tv, NULL);\n      now = gmtime(&nowSecs);\n      if (prefix[0] == '\\0')\n        sprintf(myformat,\"%04d/%02d/%02d %02d:%02d:%02ld.%03ld UTC : %s\\r\\n\",\n                now->tm_year, now->tm_mon, now->tm_mday,\n                now->tm_hour, now->tm_min, tv.tv_sec,\n                (long)tv.tv_usec / 1000, format);\n      else\n        sprintf(myformat,\"%04d/%02d/%02d %02d:%02d:%02ld.%03ld UTC : %s - %s\\r\\n\",\n                now->tm_year, now->tm_mon, now->tm_mday,\n                now->tm_hour, now->tm_min, tv.tv_sec,\n                (long)tv.tv_usec / 1000, prefix, format);\n  \n    } else {\n      if (prefix[0] == '\\0')\n        sprintf( myformat, \"%s\\r\\n\", format);\n      else\n        sprintf( myformat, \"%s - %s\\r\\n\", prefix, format);\n    }\n  \n    result = vsprintf(tst,myformat,params);\n  \n    if (my_debug_output)\n      fputs(tst, stderr);\n  \n    if (my_use_file && (hFile != NULL))\n      fputs(tst, hFile);\n  #endif\n  \n    return result;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "tstlist",
            "format"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/Debug.h\"\n#include <sys/time.h>\n#include <time.h>\n#include <windows.h> // For OutputDebugString\n#include <stdio.h>\n\nADbg {\n  int ADbg::OutPut(int forLevel, const char * format,...) const\n  {\n    int result=0;\n  \n    if (forLevel >= my_level) {\n      va_list tstlist;\n  \n      va_start(tstlist, format);\n  \n      result = _OutPut(format,tstlist);\n  \n    }\n  \n    return result;\n  }\n}"
  },
  {
    "function_name": "_OutPut",
    "container": "ADbg",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/Debug.cpp",
    "lines": "75-160",
    "snippet": "inline int ADbg::_OutPut(const char * format,va_list params) const\n{\n  int result;\n\n  char tst[1000];\n  char myformat[256];\n\n#ifdef WIN32\n  if (my_time_included) {\n    SYSTEMTIME time;\n    GetSystemTime(&time);\n    if (prefix[0] == '\\0')\n      wsprintfA(myformat,\"%04d/%02d/%02d %02d:%02d:%02d.%03d UTC : %s\\r\\n\",\n                time.wYear,\n                time.wMonth,\n                time.wDay,\n                time.wHour,\n                time.wMinute,\n                time.wSecond,\n                time.wMilliseconds,\n                format);\n    else\n      wsprintfA(myformat,\"%04d/%02d/%02d %02d:%02d:%02d.%03d UTC : %s - %s\\r\\n\",\n                time.wYear,\n                time.wMonth,\n                time.wDay,\n                time.wHour,\n                time.wMinute,\n                time.wSecond,\n                time.wMilliseconds,\n                prefix,\n                format);\n  } else {\n    if (prefix[0] == '\\0')\n      wsprintfA( myformat, \"%s\\r\\n\", format);\n    else\n      wsprintfA( myformat, \"%s - %s\\r\\n\", prefix, format);\n  }\n  result = vsprintf(tst,myformat,params);\n\n  if (my_debug_output)\n    OutputDebugStringA(tst);\n\n  if (my_use_file && (hFile != NULL)) {\n    SetFilePointer( hFile, 0, 0, FILE_END );\n    DWORD written;\n    WriteFile( hFile, tst, lstrlenA(tst), &written, NULL );\n  }\n#else\n  if (my_time_included) {\n    time_t nowSecs;\n    struct tm *now;\n    struct timeval tv;\n\n    nowSecs = time(NULL);\n    gettimeofday(&tv, NULL);\n    now = gmtime(&nowSecs);\n    if (prefix[0] == '\\0')\n      sprintf(myformat,\"%04d/%02d/%02d %02d:%02d:%02ld.%03ld UTC : %s\\r\\n\",\n              now->tm_year, now->tm_mon, now->tm_mday,\n              now->tm_hour, now->tm_min, tv.tv_sec,\n              (long)tv.tv_usec / 1000, format);\n    else\n      sprintf(myformat,\"%04d/%02d/%02d %02d:%02d:%02ld.%03ld UTC : %s - %s\\r\\n\",\n              now->tm_year, now->tm_mon, now->tm_mday,\n              now->tm_hour, now->tm_min, tv.tv_sec,\n              (long)tv.tv_usec / 1000, prefix, format);\n\n  } else {\n    if (prefix[0] == '\\0')\n      sprintf( myformat, \"%s\\r\\n\", format);\n    else\n      sprintf( myformat, \"%s - %s\\r\\n\", prefix, format);\n  }\n\n  result = vsprintf(tst,myformat,params);\n\n  if (my_debug_output)\n    fputs(tst, stderr);\n\n  if (my_use_file && (hFile != NULL))\n    fputs(tst, hFile);\n#endif\n\n  return result;\n}",
    "includes": [
      "#include \"ebml/Debug.h\"",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <windows.h> // For OutputDebugString",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fputs",
          "args": [
            "tst",
            "hFile"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fputs",
          "args": [
            "tst",
            "stderr"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vsprintf",
          "args": [
            "tst",
            "myformat",
            "params"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "myformat",
            "\"%s - %s\\r\\n\"",
            "prefix",
            "format"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "myformat",
            "\"%s\\r\\n\"",
            "format"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "myformat",
            "\"%04d/%02d/%02d %02d:%02d:%02ld.%03ld UTC : %s - %s\\r\\n\"",
            "now->tm_year",
            "now->tm_mon",
            "now->tm_mday",
            "now->tm_hour",
            "now->tm_min",
            "tv.tv_sec",
            "(long)tv.tv_usec / 1000",
            "prefix",
            "format"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "myformat",
            "\"%04d/%02d/%02d %02d:%02d:%02ld.%03ld UTC : %s\\r\\n\"",
            "now->tm_year",
            "now->tm_mon",
            "now->tm_mday",
            "now->tm_hour",
            "now->tm_min",
            "tv.tv_sec",
            "(long)tv.tv_usec / 1000",
            "format"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gmtime",
          "args": [
            "&nowSecs"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gettimeofday",
          "args": [
            "&tv",
            "NULL"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "time",
          "args": [
            "NULL"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WriteFile",
          "args": [
            "hFile",
            "tst",
            "lstrlenA(tst)",
            "&written",
            "NULL"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lstrlenA",
          "args": [
            "tst"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SetFilePointer",
          "args": [
            "hFile",
            "0",
            "0",
            "FILE_END"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OutputDebugStringA",
          "args": [
            "tst"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vsprintf",
          "args": [
            "tst",
            "myformat",
            "params"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wsprintfA",
          "args": [
            "myformat",
            "\"%s - %s\\r\\n\"",
            "prefix",
            "format"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wsprintfA",
          "args": [
            "myformat",
            "\"%s\\r\\n\"",
            "format"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wsprintfA",
          "args": [
            "myformat",
            "\"%04d/%02d/%02d %02d:%02d:%02d.%03d UTC : %s - %s\\r\\n\"",
            "time.wYear",
            "time.wMonth",
            "time.wDay",
            "time.wHour",
            "time.wMinute",
            "time.wSecond",
            "time.wMilliseconds",
            "prefix",
            "format"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wsprintfA",
          "args": [
            "myformat",
            "\"%04d/%02d/%02d %02d:%02d:%02d.%03d UTC : %s\\r\\n\"",
            "time.wYear",
            "time.wMonth",
            "time.wDay",
            "time.wHour",
            "time.wMinute",
            "time.wSecond",
            "time.wMilliseconds",
            "format"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetSystemTime",
          "args": [
            "&time"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/Debug.h\"\n#include <sys/time.h>\n#include <time.h>\n#include <windows.h> // For OutputDebugString\n#include <stdio.h>\n\nADbg {\n  inline int ADbg::_OutPut(const char * format,va_list params) const\n  {\n    int result;\n  \n    char tst[1000];\n    char myformat[256];\n  \n  #ifdef WIN32\n    if (my_time_included) {\n      SYSTEMTIME time;\n      GetSystemTime(&time);\n      if (prefix[0] == '\\0')\n        wsprintfA(myformat,\"%04d/%02d/%02d %02d:%02d:%02d.%03d UTC : %s\\r\\n\",\n                  time.wYear,\n                  time.wMonth,\n                  time.wDay,\n                  time.wHour,\n                  time.wMinute,\n                  time.wSecond,\n                  time.wMilliseconds,\n                  format);\n      else\n        wsprintfA(myformat,\"%04d/%02d/%02d %02d:%02d:%02d.%03d UTC : %s - %s\\r\\n\",\n                  time.wYear,\n                  time.wMonth,\n                  time.wDay,\n                  time.wHour,\n                  time.wMinute,\n                  time.wSecond,\n                  time.wMilliseconds,\n                  prefix,\n                  format);\n    } else {\n      if (prefix[0] == '\\0')\n        wsprintfA( myformat, \"%s\\r\\n\", format);\n      else\n        wsprintfA( myformat, \"%s - %s\\r\\n\", prefix, format);\n    }\n    result = vsprintf(tst,myformat,params);\n  \n    if (my_debug_output)\n      OutputDebugStringA(tst);\n  \n    if (my_use_file && (hFile != NULL)) {\n      SetFilePointer( hFile, 0, 0, FILE_END );\n      DWORD written;\n      WriteFile( hFile, tst, lstrlenA(tst), &written, NULL );\n    }\n  #else\n    if (my_time_included) {\n      time_t nowSecs;\n      struct tm *now;\n      struct timeval tv;\n  \n      nowSecs = time(NULL);\n      gettimeofday(&tv, NULL);\n      now = gmtime(&nowSecs);\n      if (prefix[0] == '\\0')\n        sprintf(myformat,\"%04d/%02d/%02d %02d:%02d:%02ld.%03ld UTC : %s\\r\\n\",\n                now->tm_year, now->tm_mon, now->tm_mday,\n                now->tm_hour, now->tm_min, tv.tv_sec,\n                (long)tv.tv_usec / 1000, format);\n      else\n        sprintf(myformat,\"%04d/%02d/%02d %02d:%02d:%02ld.%03ld UTC : %s - %s\\r\\n\",\n                now->tm_year, now->tm_mon, now->tm_mday,\n                now->tm_hour, now->tm_min, tv.tv_sec,\n                (long)tv.tv_usec / 1000, prefix, format);\n  \n    } else {\n      if (prefix[0] == '\\0')\n        sprintf( myformat, \"%s\\r\\n\", format);\n      else\n        sprintf( myformat, \"%s - %s\\r\\n\", prefix, format);\n    }\n  \n    result = vsprintf(tst,myformat,params);\n  \n    if (my_debug_output)\n      fputs(tst, stderr);\n  \n    if (my_use_file && (hFile != NULL))\n      fputs(tst, hFile);\n  #endif\n  \n    return result;\n  }\n}"
  },
  {
    "function_name": "~ADbg",
    "container": "ADbg",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/Debug.cpp",
    "lines": "69-73",
    "snippet": "ADbg::~ADbg()\n{\n  unsetDebugFile();\n  OutPut(-1,\"ADbg Deletion (0x%08X)\",this);\n}",
    "includes": [
      "#include \"ebml/Debug.h\"",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <windows.h> // For OutputDebugString",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "OutPut",
          "args": [
            "-1",
            "\"ADbg Deletion (0x%08X)\"",
            "this"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unsetDebugFile",
          "args": [],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "unsetDebugFile",
          "container": "ADbg",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/Debug.cpp",
          "lines": "220-236",
          "snippet": "bool ADbg::unsetDebugFile() {\n  bool result = (hFile == NULL);\n  if (result)\n    return true;\n\n#ifdef WIN32\n  result = (CloseHandle(hFile) != 0);\n#else\n  result = (fclose(hFile) == 0);\n#endif\n\n  if (result) {\n    OutPut(-1,\"Debug hFile Closing succeeded\");\n    hFile = NULL;\n  }\n  return result;\n}",
          "includes": [
            "#include \"ebml/Debug.h\"",
            "#include <sys/time.h>",
            "#include <time.h>",
            "#include <windows.h> // For OutputDebugString",
            "#include <stdio.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/Debug.h\"\n#include <sys/time.h>\n#include <time.h>\n#include <windows.h> // For OutputDebugString\n#include <stdio.h>\n\nADbg {\n  bool ADbg::unsetDebugFile() {\n    bool result = (hFile == NULL);\n    if (result)\n      return true;\n  \n  #ifdef WIN32\n    result = (CloseHandle(hFile) != 0);\n  #else\n    result = (fclose(hFile) == 0);\n  #endif\n  \n    if (result) {\n      OutPut(-1,\"Debug hFile Closing succeeded\");\n      hFile = NULL;\n    }\n    return result;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ebml/Debug.h\"\n#include <sys/time.h>\n#include <time.h>\n#include <windows.h> // For OutputDebugString\n#include <stdio.h>\n\nADbg {\n  ADbg::~ADbg()\n  {\n    unsetDebugFile();\n    OutPut(-1,\"ADbg Deletion (0x%08X)\",this);\n  }\n}"
  },
  {
    "function_name": "ADbg",
    "container": "ADbg",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/Debug.cpp",
    "lines": "58-67",
    "snippet": "ADbg::ADbg(int level)\n  :my_level(level)\n  ,my_time_included(false)\n  ,my_use_file(false)\n  ,my_debug_output(true)\n  ,hFile(NULL)\n{\n  prefix[0] = '\\0';\n  OutPut(-1,\"ADbg Creation at debug level = %d (0x%08X)\",my_level,this);\n}",
    "includes": [
      "#include \"ebml/Debug.h\"",
      "#include <sys/time.h>",
      "#include <time.h>",
      "#include <windows.h> // For OutputDebugString",
      "#include <stdio.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "OutPut",
          "args": [
            "-1",
            "\"ADbg Creation at debug level = %d (0x%08X)\"",
            "my_level",
            "this"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/Debug.h\"\n#include <sys/time.h>\n#include <time.h>\n#include <windows.h> // For OutputDebugString\n#include <stdio.h>\n\nADbg {\n  ADbg::ADbg(int level)\n    :my_level(level)\n    ,my_time_included(false)\n    ,my_use_file(false)\n    ,my_debug_output(true)\n    ,hFile(NULL)\n  {\n    prefix[0] = '\\0';\n    OutPut(-1,\"ADbg Creation at debug level = %d (0x%08X)\",my_level,this);\n  }\n}"
  }
]