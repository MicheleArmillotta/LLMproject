[
  {
    "function_name": "setFilePointer",
    "container": "MemReadIOCallback",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/MemReadIOCallback.cpp",
    "lines": "81-90",
    "snippet": "void\nMemReadIOCallback::setFilePointer(int64 Offset,\n                                  seek_mode Mode) {\n  int64 NewPosition = Mode == seek_beginning ? Offset\n                    : Mode == seek_end       ? static_cast<int64>(mEnd - mStart) + Offset\n                    :                          static_cast<int64>(mPtr - mStart) + Offset;\n\n  NewPosition = std::min<int64>(std::max<int64>(NewPosition, 0), mEnd - mStart);\n  mPtr = mStart + NewPosition;\n}",
    "includes": [
      "#include \"ebml/MemReadIOCallback.h\"",
      "#include \"ebml/EbmlBinary.h\"",
      "#include <cstring>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::min<int64>",
          "args": [
            "std::max<int64>(NewPosition, 0)",
            "mEnd - mStart"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::max<int64>",
          "args": [
            "NewPosition",
            "0"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<int64>",
          "args": [
            "mPtr - mStart"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<int64>",
          "args": [
            "mEnd - mStart"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/MemReadIOCallback.h\"\n#include \"ebml/EbmlBinary.h\"\n#include <cstring>\n\nMemReadIOCallback {\n  void\n  MemReadIOCallback::setFilePointer(int64 Offset,\n                                    seek_mode Mode) {\n    int64 NewPosition = Mode == seek_beginning ? Offset\n                      : Mode == seek_end       ? static_cast<int64>(mEnd - mStart) + Offset\n                      :                          static_cast<int64>(mPtr - mStart) + Offset;\n  \n    NewPosition = std::min<int64>(std::max<int64>(NewPosition, 0), mEnd - mStart);\n    mPtr = mStart + NewPosition;\n  }\n}"
  },
  {
    "function_name": "read",
    "container": "MemReadIOCallback",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/MemReadIOCallback.cpp",
    "lines": "68-79",
    "snippet": "uint32\nMemReadIOCallback::read(void *Buffer,\n                        size_t Size) {\n  size_t RemainingBytes = mEnd - mPtr;\n  if (RemainingBytes < Size)\n    Size = RemainingBytes;\n\n  std::memcpy(Buffer, mPtr, Size);\n  mPtr += Size;\n\n  return Size;\n}",
    "includes": [
      "#include \"ebml/MemReadIOCallback.h\"",
      "#include \"ebml/EbmlBinary.h\"",
      "#include <cstring>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::memcpy",
          "args": [
            "Buffer",
            "mPtr",
            "Size"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/MemReadIOCallback.h\"\n#include \"ebml/EbmlBinary.h\"\n#include <cstring>\n\nMemReadIOCallback {\n  uint32\n  MemReadIOCallback::read(void *Buffer,\n                          size_t Size) {\n    size_t RemainingBytes = mEnd - mPtr;\n    if (RemainingBytes < Size)\n      Size = RemainingBytes;\n  \n    std::memcpy(Buffer, mPtr, Size);\n    mPtr += Size;\n  \n    return Size;\n  }\n}"
  },
  {
    "function_name": "Init",
    "container": "MemReadIOCallback",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/MemReadIOCallback.cpp",
    "lines": "60-66",
    "snippet": "void\nMemReadIOCallback::Init(void const *Ptr,\n                        size_t Size) {\n  mStart = reinterpret_cast<uint8 const *>(Ptr);\n  mEnd   = mStart + Size;\n  mPtr   = mStart;\n}",
    "includes": [
      "#include \"ebml/MemReadIOCallback.h\"",
      "#include \"ebml/EbmlBinary.h\"",
      "#include <cstring>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reinterpret_cast<uint8 const *>",
          "args": [
            "Ptr"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/MemReadIOCallback.h\"\n#include \"ebml/EbmlBinary.h\"\n#include <cstring>\n\nMemReadIOCallback {\n  void\n  MemReadIOCallback::Init(void const *Ptr,\n                          size_t Size) {\n    mStart = reinterpret_cast<uint8 const *>(Ptr);\n    mEnd   = mStart + Size;\n    mPtr   = mStart;\n  }\n}"
  },
  {
    "function_name": "~MemReadIOCallback",
    "container": "MemReadIOCallback",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/MemReadIOCallback.cpp",
    "lines": "57-58",
    "snippet": "MemReadIOCallback::~MemReadIOCallback() {\n}",
    "includes": [
      "#include \"ebml/MemReadIOCallback.h\"",
      "#include \"ebml/EbmlBinary.h\"",
      "#include <cstring>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ebml/MemReadIOCallback.h\"\n#include \"ebml/EbmlBinary.h\"\n#include <cstring>\n\nMemReadIOCallback {\n  MemReadIOCallback::~MemReadIOCallback() {\n  }\n}"
  },
  {
    "function_name": "MemReadIOCallback",
    "container": "MemReadIOCallback",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/MemReadIOCallback.cpp",
    "lines": "53-55",
    "snippet": "MemReadIOCallback::MemReadIOCallback(MemReadIOCallback const &Mem) {\n  Init(Mem.mPtr, Mem.mEnd - Mem.mPtr);\n}",
    "includes": [
      "#include \"ebml/MemReadIOCallback.h\"",
      "#include \"ebml/EbmlBinary.h\"",
      "#include <cstring>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Init",
          "args": [
            "Mem.mPtr",
            "Mem.mEnd - Mem.mPtr"
          ],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "Init",
          "container": "MemReadIOCallback",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/MemReadIOCallback.cpp",
          "lines": "60-66",
          "snippet": "void\nMemReadIOCallback::Init(void const *Ptr,\n                        size_t Size) {\n  mStart = reinterpret_cast<uint8 const *>(Ptr);\n  mEnd   = mStart + Size;\n  mPtr   = mStart;\n}",
          "includes": [
            "#include \"ebml/MemReadIOCallback.h\"",
            "#include \"ebml/EbmlBinary.h\"",
            "#include <cstring>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/MemReadIOCallback.h\"\n#include \"ebml/EbmlBinary.h\"\n#include <cstring>\n\nMemReadIOCallback {\n  void\n  MemReadIOCallback::Init(void const *Ptr,\n                          size_t Size) {\n    mStart = reinterpret_cast<uint8 const *>(Ptr);\n    mEnd   = mStart + Size;\n    mPtr   = mStart;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ebml/MemReadIOCallback.h\"\n#include \"ebml/EbmlBinary.h\"\n#include <cstring>\n\nMemReadIOCallback {\n  MemReadIOCallback::MemReadIOCallback(MemReadIOCallback const &Mem) {\n    Init(Mem.mPtr, Mem.mEnd - Mem.mPtr);\n  }\n}"
  },
  {
    "function_name": "MemReadIOCallback",
    "container": "MemReadIOCallback",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/MemReadIOCallback.cpp",
    "lines": "49-51",
    "snippet": "MemReadIOCallback::MemReadIOCallback(EbmlBinary const &Binary) {\n  Init(Binary.GetBuffer(), Binary.GetSize());\n}",
    "includes": [
      "#include \"ebml/MemReadIOCallback.h\"",
      "#include \"ebml/EbmlBinary.h\"",
      "#include <cstring>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Init",
          "args": [
            "Binary.GetBuffer()",
            "Binary.GetSize()"
          ],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "Init",
          "container": "MemReadIOCallback",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/MemReadIOCallback.cpp",
          "lines": "60-66",
          "snippet": "void\nMemReadIOCallback::Init(void const *Ptr,\n                        size_t Size) {\n  mStart = reinterpret_cast<uint8 const *>(Ptr);\n  mEnd   = mStart + Size;\n  mPtr   = mStart;\n}",
          "includes": [
            "#include \"ebml/MemReadIOCallback.h\"",
            "#include \"ebml/EbmlBinary.h\"",
            "#include <cstring>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/MemReadIOCallback.h\"\n#include \"ebml/EbmlBinary.h\"\n#include <cstring>\n\nMemReadIOCallback {\n  void\n  MemReadIOCallback::Init(void const *Ptr,\n                          size_t Size) {\n    mStart = reinterpret_cast<uint8 const *>(Ptr);\n    mEnd   = mStart + Size;\n    mPtr   = mStart;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Binary.GetSize",
          "args": [],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "GetSize",
          "container": "SafeReadIOCallback",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/SafeReadIOCallback.cpp",
          "lines": "88-92",
          "snippet": "size_t\nSafeReadIOCallback::GetSize()\n  const {\n  return mSize;\n}",
          "includes": [
            "#include \"ebml/SafeReadIOCallback.h\"",
            "#include \"ebml/MemReadIOCallback.h\"",
            "#include \"ebml/EbmlBinary.h\"",
            "#include <cstring>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/SafeReadIOCallback.h\"\n#include \"ebml/MemReadIOCallback.h\"\n#include \"ebml/EbmlBinary.h\"\n#include <cstring>\n\nSafeReadIOCallback {\n  size_t\n  SafeReadIOCallback::GetSize()\n    const {\n    return mSize;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Binary.GetBuffer",
          "args": [],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/MemReadIOCallback.h\"\n#include \"ebml/EbmlBinary.h\"\n#include <cstring>\n\nMemReadIOCallback {\n  MemReadIOCallback::MemReadIOCallback(EbmlBinary const &Binary) {\n    Init(Binary.GetBuffer(), Binary.GetSize());\n  }\n}"
  },
  {
    "function_name": "MemReadIOCallback",
    "container": "MemReadIOCallback",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/MemReadIOCallback.cpp",
    "lines": "42-47",
    "snippet": "START_LIBEBML_NAMESPACE\n\nMemReadIOCallback::MemReadIOCallback(void const *Ptr,\n                                     size_t Size) {\n  Init(Ptr, Size);\n}",
    "includes": [
      "#include \"ebml/MemReadIOCallback.h\"",
      "#include \"ebml/EbmlBinary.h\"",
      "#include <cstring>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Init",
          "args": [
            "Ptr",
            "Size"
          ],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "Init",
          "container": "MemReadIOCallback",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/MemReadIOCallback.cpp",
          "lines": "60-66",
          "snippet": "void\nMemReadIOCallback::Init(void const *Ptr,\n                        size_t Size) {\n  mStart = reinterpret_cast<uint8 const *>(Ptr);\n  mEnd   = mStart + Size;\n  mPtr   = mStart;\n}",
          "includes": [
            "#include \"ebml/MemReadIOCallback.h\"",
            "#include \"ebml/EbmlBinary.h\"",
            "#include <cstring>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/MemReadIOCallback.h\"\n#include \"ebml/EbmlBinary.h\"\n#include <cstring>\n\nMemReadIOCallback {\n  void\n  MemReadIOCallback::Init(void const *Ptr,\n                          size_t Size) {\n    mStart = reinterpret_cast<uint8 const *>(Ptr);\n    mEnd   = mStart + Size;\n    mPtr   = mStart;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ebml/MemReadIOCallback.h\"\n#include \"ebml/EbmlBinary.h\"\n#include <cstring>\n\nMemReadIOCallback {\n  START_LIBEBML_NAMESPACE\n  \n  MemReadIOCallback::MemReadIOCallback(void const *Ptr,\n                                       size_t Size) {\n    Init(Ptr, Size);\n  }\n}"
  }
]