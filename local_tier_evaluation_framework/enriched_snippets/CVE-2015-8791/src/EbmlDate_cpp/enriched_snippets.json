[
  {
    "function_name": "IsSmallerThan",
    "container": "EbmlDate",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlDate.cpp",
    "lines": "78-84",
    "snippet": "bool EbmlDate::IsSmallerThan(const EbmlElement *Cmp) const\n{\n  if (EbmlId(*this) == EbmlId(*Cmp))\n    return this->myDate < static_cast<const EbmlDate *>(Cmp)->myDate;\n  else\n    return false;\n}",
    "includes": [
      "#include \"ebml/EbmlDate.h\"",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "static_cast<const EbmlDate *>",
          "args": [
            "Cmp"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EbmlId",
          "args": [
            "*Cmp"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EbmlId",
          "args": [
            "*this"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/EbmlDate.h\"\n#include <cassert>\n\nEbmlDate {\n  bool EbmlDate::IsSmallerThan(const EbmlElement *Cmp) const\n  {\n    if (EbmlId(*this) == EbmlId(*Cmp))\n      return this->myDate < static_cast<const EbmlDate *>(Cmp)->myDate;\n    else\n      return false;\n  }\n}"
  },
  {
    "function_name": "RenderData",
    "container": "EbmlDate",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlDate.cpp",
    "lines": "66-76",
    "snippet": "filepos_t EbmlDate::RenderData(IOCallback & output, bool /* bForceRender */, bool  /* bWithDefault */)\n{\n  if (GetSize() != 0) {\n    assert(GetSize() == 8);\n    big_int64 b64(myDate);\n\n    output.writeFully(&b64.endian(),GetSize());\n  }\n\n  return GetSize();\n}",
    "includes": [
      "#include \"ebml/EbmlDate.h\"",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetSize",
          "args": [],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "GetSize",
          "container": "SafeReadIOCallback",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/SafeReadIOCallback.cpp",
          "lines": "88-92",
          "snippet": "size_t\nSafeReadIOCallback::GetSize()\n  const {\n  return mSize;\n}",
          "includes": [
            "#include \"ebml/SafeReadIOCallback.h\"",
            "#include \"ebml/MemReadIOCallback.h\"",
            "#include \"ebml/EbmlBinary.h\"",
            "#include <cstring>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/SafeReadIOCallback.h\"\n#include \"ebml/MemReadIOCallback.h\"\n#include \"ebml/EbmlBinary.h\"\n#include <cstring>\n\nSafeReadIOCallback {\n  size_t\n  SafeReadIOCallback::GetSize()\n    const {\n    return mSize;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "output.writeFully",
          "args": [
            "&b64.endian()",
            "GetSize()"
          ],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "writeFully",
          "container": "IOCallback",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/IOCallback.cpp",
          "lines": "46-63",
          "snippet": "START_LIBEBML_NAMESPACE\n\nvoid IOCallback::writeFully(const void*Buffer,size_t Size)\n{\n  if (Size == 0)\n    return;\n\n  if (Buffer == NULL)\n    throw;\n\n  if(write(Buffer,Size) != Size) {\n#if !defined(__GNUC__) || (__GNUC__ > 2)\n    stringstream Msg;\n    Msg<<\"EOF in writeFully(\"<<Buffer<<\",\"<<Size<<\")\";\n    throw runtime_error(Msg.str());\n#endif // GCC2\n  }\n}",
          "includes": [
            "#include \"ebml/IOCallback.h\"",
            "#include <stdexcept>",
            "#include <sstream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/IOCallback.h\"\n#include <stdexcept>\n#include <sstream>\n\nIOCallback {\n  START_LIBEBML_NAMESPACE\n  \n  void IOCallback::writeFully(const void*Buffer,size_t Size)\n  {\n    if (Size == 0)\n      return;\n  \n    if (Buffer == NULL)\n      throw;\n  \n    if(write(Buffer,Size) != Size) {\n  #if !defined(__GNUC__) || (__GNUC__ > 2)\n      stringstream Msg;\n      Msg<<\"EOF in writeFully(\"<<Buffer<<\",\"<<Size<<\")\";\n      throw runtime_error(Msg.str());\n  #endif // GCC2\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "b64.endian",
          "args": [],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "GetSize() == 8"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/EbmlDate.h\"\n#include <cassert>\n\nEbmlDate {\n  filepos_t EbmlDate::RenderData(IOCallback & output, bool /* bForceRender */, bool  /* bWithDefault */)\n  {\n    if (GetSize() != 0) {\n      assert(GetSize() == 8);\n      big_int64 b64(myDate);\n  \n      output.writeFully(&b64.endian(),GetSize());\n    }\n  \n    return GetSize();\n  }\n}"
  },
  {
    "function_name": "ReadData",
    "container": "EbmlDate",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlDate.cpp",
    "lines": "48-64",
    "snippet": "filepos_t EbmlDate::ReadData(IOCallback & input, ScopeMode ReadFully)\n{\n  if ((ReadFully == SCOPE_NO_DATA) || (GetSize() == 0))\n    return GetSize();\n\n  assert(GetSize() == 8);\n  binary Buffer[8];\n  input.readFully(Buffer, GetSize());\n\n  big_int64 b64;\n  b64.Eval(Buffer);\n\n  myDate = b64;\n  SetValueIsSet();\n\n  return GetSize();\n}",
    "includes": [
      "#include \"ebml/EbmlDate.h\"",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetSize",
          "args": [],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "GetSize",
          "container": "SafeReadIOCallback",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/SafeReadIOCallback.cpp",
          "lines": "88-92",
          "snippet": "size_t\nSafeReadIOCallback::GetSize()\n  const {\n  return mSize;\n}",
          "includes": [
            "#include \"ebml/SafeReadIOCallback.h\"",
            "#include \"ebml/MemReadIOCallback.h\"",
            "#include \"ebml/EbmlBinary.h\"",
            "#include <cstring>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/SafeReadIOCallback.h\"\n#include \"ebml/MemReadIOCallback.h\"\n#include \"ebml/EbmlBinary.h\"\n#include <cstring>\n\nSafeReadIOCallback {\n  size_t\n  SafeReadIOCallback::GetSize()\n    const {\n    return mSize;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SetValueIsSet",
          "args": [],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "b64.Eval",
          "args": [
            "Buffer"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "input.readFully",
          "args": [
            "Buffer",
            "GetSize()"
          ],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "readFully",
          "container": "IOCallback",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/IOCallback.cpp",
          "lines": "67-79",
          "snippet": "void IOCallback::readFully(void*Buffer,size_t Size)\n{\n  if(Buffer == NULL)\n    throw;\n\n  if(read(Buffer,Size) != Size) {\n#if !defined(__GNUC__) || (__GNUC__ > 2)\n    stringstream Msg;\n    Msg<<\"EOF in readFully(\"<<Buffer<<\",\"<<Size<<\")\";\n    throw runtime_error(Msg.str());\n#endif // GCC2\n  }\n}",
          "includes": [
            "#include \"ebml/IOCallback.h\"",
            "#include <stdexcept>",
            "#include <sstream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/IOCallback.h\"\n#include <stdexcept>\n#include <sstream>\n\nIOCallback {\n  void IOCallback::readFully(void*Buffer,size_t Size)\n  {\n    if(Buffer == NULL)\n      throw;\n  \n    if(read(Buffer,Size) != Size) {\n  #if !defined(__GNUC__) || (__GNUC__ > 2)\n      stringstream Msg;\n      Msg<<\"EOF in readFully(\"<<Buffer<<\",\"<<Size<<\")\";\n      throw runtime_error(Msg.str());\n  #endif // GCC2\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "GetSize() == 8"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/EbmlDate.h\"\n#include <cassert>\n\nEbmlDate {\n  filepos_t EbmlDate::ReadData(IOCallback & input, ScopeMode ReadFully)\n  {\n    if ((ReadFully == SCOPE_NO_DATA) || (GetSize() == 0))\n      return GetSize();\n  \n    assert(GetSize() == 8);\n    binary Buffer[8];\n    input.readFully(Buffer, GetSize());\n  \n    big_int64 b64;\n    b64.Eval(Buffer);\n  \n    myDate = b64;\n    SetValueIsSet();\n  \n    return GetSize();\n  }\n}"
  },
  {
    "function_name": "EbmlDate",
    "container": "EbmlDate",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlDate.cpp",
    "lines": "42-46",
    "snippet": "EbmlDate::EbmlDate(const EbmlDate & ElementToClone)\n:EbmlElement(ElementToClone)\n{\n  myDate = ElementToClone.myDate;\n}",
    "includes": [
      "#include \"ebml/EbmlDate.h\"",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ebml/EbmlDate.h\"\n#include <cassert>\n\nEbmlDate {\n  EbmlDate::EbmlDate(const EbmlDate & ElementToClone)\n  :EbmlElement(ElementToClone)\n  {\n    myDate = ElementToClone.myDate;\n  }\n}"
  }
]