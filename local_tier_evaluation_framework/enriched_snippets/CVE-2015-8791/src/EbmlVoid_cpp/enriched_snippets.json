[
  {
    "function_name": "Overwrite",
    "container": "EbmlVoid",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlVoid.cpp",
    "lines": "99-135",
    "snippet": "uint64 EbmlVoid::Overwrite(const EbmlElement & EltToVoid, IOCallback & output, bool ComeBackAfterward, bool bWithDefault)\n{\n  //  EltToVoid.UpdateSize(bWithDefault);\n  if (EltToVoid.GetElementPosition() == 0) {\n    // this element has never been written\n    return 0;\n  }\n  if (EltToVoid.GetSize() + EltToVoid.HeadSize() <2) {\n    // the element can't be written here !\n    return 0;\n  }\n\n  uint64 CurrentPosition = output.getFilePointer();\n\n  output.setFilePointer(EltToVoid.GetElementPosition());\n\n  // compute the size of the voided data based on the original one\n  SetSize(EltToVoid.GetSize() + EltToVoid.HeadSize() - 1); // 1 for the ID\n  SetSize(GetSize() - CodedSizeLength(GetSize(), GetSizeLength(), IsFiniteSize()));\n  // make sure we handle even the strange cases\n  //uint32 A1 = GetSize() + HeadSize();\n  //uint32 A2 = EltToVoid.GetSize() + EltToVoid.HeadSize();\n  if (GetSize() + HeadSize() != EltToVoid.GetSize() + EltToVoid.HeadSize()) {\n    SetSize(GetSize()-1);\n    SetSizeLength(CodedSizeLength(GetSize(), GetSizeLength(), IsFiniteSize()) + 1);\n  }\n\n  if (GetSize() != 0) {\n    RenderHead(output, false, bWithDefault); // the rest of the data is not rewritten\n  }\n\n  if (ComeBackAfterward) {\n    output.setFilePointer(CurrentPosition);\n  }\n\n  return EltToVoid.GetSize() + EltToVoid.HeadSize();\n}",
    "includes": [
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlVoid.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EltToVoid.HeadSize",
          "args": [],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EltToVoid.GetSize",
          "args": [],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "GetSize",
          "container": "SafeReadIOCallback",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/SafeReadIOCallback.cpp",
          "lines": "88-92",
          "snippet": "size_t\nSafeReadIOCallback::GetSize()\n  const {\n  return mSize;\n}",
          "includes": [
            "#include \"ebml/SafeReadIOCallback.h\"",
            "#include \"ebml/MemReadIOCallback.h\"",
            "#include \"ebml/EbmlBinary.h\"",
            "#include <cstring>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/SafeReadIOCallback.h\"\n#include \"ebml/MemReadIOCallback.h\"\n#include \"ebml/EbmlBinary.h\"\n#include <cstring>\n\nSafeReadIOCallback {\n  size_t\n  SafeReadIOCallback::GetSize()\n    const {\n    return mSize;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "output.setFilePointer",
          "args": [
            "CurrentPosition"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RenderHead",
          "args": [
            "output",
            "false",
            "bWithDefault"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SetSizeLength",
          "args": [
            "CodedSizeLength(GetSize(), GetSizeLength(), IsFiniteSize()) + 1"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CodedSizeLength",
          "args": [
            "GetSize()",
            "GetSizeLength()",
            "IsFiniteSize()"
          ],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "CodedSizeLength",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlElement.cpp",
          "lines": "45-83",
          "snippet": "START_LIBEBML_NAMESPACE\n\n/*!\n  \\todo handle more than CodedSize of 5\n*/\nint CodedSizeLength(uint64 Length, unsigned int SizeLength, bool bSizeFinite)\n{\n  unsigned int CodedSize;\n  if (bSizeFinite) {\n    // prepare the head of the size (000...01xxxxxx)\n    // optimal size\n    if (Length < 127) // 2^7 - 1\n      CodedSize = 1;\n    else if (Length < 16383) // 2^14 - 1\n      CodedSize = 2;\n    else if (Length < 2097151L) // 2^21 - 1\n      CodedSize = 3;\n    else if (Length < 268435455L) // 2^28 - 1\n      CodedSize = 4;\n    else CodedSize = 5;\n  } else {\n    if (Length <= 127) // 2^7 - 1\n      CodedSize = 1;\n    else if (Length <= 16383) // 2^14 - 1\n      CodedSize = 2;\n    else if (Length <= 2097151L) // 2^21 - 1\n      CodedSize = 3;\n    else if (Length <= 268435455L) // 2^28 - 1\n      CodedSize = 4;\n    else CodedSize = 5;\n  }\n\n  if (SizeLength > 0 && CodedSize < SizeLength) {\n    // defined size\n    CodedSize = SizeLength;\n  }\n\n  return CodedSize;\n}",
          "includes": [
            "#include \"ebml/EbmlContexts.h\"",
            "#include \"ebml/EbmlDummy.h\"",
            "#include \"ebml/EbmlVoid.h\"",
            "#include \"ebml/EbmlStream.h\"",
            "#include \"ebml/EbmlMaster.h\"",
            "#include \"ebml/EbmlElement.h\"",
            "#include <cstring>",
            "#include <cassert>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlDummy.h\"\n#include \"ebml/EbmlVoid.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include \"ebml/EbmlElement.h\"\n#include <cstring>\n#include <cassert>\n\nSTART_LIBEBML_NAMESPACE\n\n/*!\n  \\todo handle more than CodedSize of 5\n*/\nint CodedSizeLength(uint64 Length, unsigned int SizeLength, bool bSizeFinite)\n{\n  unsigned int CodedSize;\n  if (bSizeFinite) {\n    // prepare the head of the size (000...01xxxxxx)\n    // optimal size\n    if (Length < 127) // 2^7 - 1\n      CodedSize = 1;\n    else if (Length < 16383) // 2^14 - 1\n      CodedSize = 2;\n    else if (Length < 2097151L) // 2^21 - 1\n      CodedSize = 3;\n    else if (Length < 268435455L) // 2^28 - 1\n      CodedSize = 4;\n    else CodedSize = 5;\n  } else {\n    if (Length <= 127) // 2^7 - 1\n      CodedSize = 1;\n    else if (Length <= 16383) // 2^14 - 1\n      CodedSize = 2;\n    else if (Length <= 2097151L) // 2^21 - 1\n      CodedSize = 3;\n    else if (Length <= 268435455L) // 2^28 - 1\n      CodedSize = 4;\n    else CodedSize = 5;\n  }\n\n  if (SizeLength > 0 && CodedSize < SizeLength) {\n    // defined size\n    CodedSize = SizeLength;\n  }\n\n  return CodedSize;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IsFiniteSize",
          "args": [],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetSizeLength",
          "args": [],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SetSize",
          "args": [
            "GetSize()-1"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EltToVoid.HeadSize",
          "args": [],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HeadSize",
          "args": [],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SetSize",
          "args": [
            "GetSize() - CodedSizeLength(GetSize(), GetSizeLength(), IsFiniteSize())"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IsFiniteSize",
          "args": [],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetSizeLength",
          "args": [],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SetSize",
          "args": [
            "EltToVoid.GetSize() + EltToVoid.HeadSize() - 1"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EltToVoid.HeadSize",
          "args": [],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "output.setFilePointer",
          "args": [
            "EltToVoid.GetElementPosition()"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EltToVoid.GetElementPosition",
          "args": [],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "output.getFilePointer",
          "args": [],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "getFilePointer",
          "container": "StdIOCallback",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/StdIOCallback.cpp",
          "lines": "159-175",
          "snippet": "uint64 StdIOCallback::getFilePointer()\n{\n  assert(File!=0);\n\n#if 0\n  long Result=ftell(File);\n  if(Result<0) {\n#if !defined(__GNUC__) || (__GNUC__ > 2)\n    stringstream Msg;\n    Msg<<\"Can't tell the current file pointer position for \"<<File;\n    throw CRTError(Msg.str());\n#endif // GCC2\n  }\n#endif\n\n  return mCurrentPosition;\n}",
          "includes": [
            "#include \"ebml/EbmlConfig.h\"",
            "#include \"ebml/Debug.h\"",
            "#include \"ebml/StdIOCallback.h\"",
            "#include <sstream>",
            "#include <climits>",
            "#include <cassert>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/EbmlConfig.h\"\n#include \"ebml/Debug.h\"\n#include \"ebml/StdIOCallback.h\"\n#include <sstream>\n#include <climits>\n#include <cassert>\n\nStdIOCallback {\n  uint64 StdIOCallback::getFilePointer()\n  {\n    assert(File!=0);\n  \n  #if 0\n    long Result=ftell(File);\n    if(Result<0) {\n  #if !defined(__GNUC__) || (__GNUC__ > 2)\n      stringstream Msg;\n      Msg<<\"Can't tell the current file pointer position for \"<<File;\n      throw CRTError(Msg.str());\n  #endif // GCC2\n    }\n  #endif\n  \n    return mCurrentPosition;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EltToVoid.HeadSize",
          "args": [],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EltToVoid.GetElementPosition",
          "args": [],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlVoid.h\"\n\nEbmlVoid {\n  uint64 EbmlVoid::Overwrite(const EbmlElement & EltToVoid, IOCallback & output, bool ComeBackAfterward, bool bWithDefault)\n  {\n    //  EltToVoid.UpdateSize(bWithDefault);\n    if (EltToVoid.GetElementPosition() == 0) {\n      // this element has never been written\n      return 0;\n    }\n    if (EltToVoid.GetSize() + EltToVoid.HeadSize() <2) {\n      // the element can't be written here !\n      return 0;\n    }\n  \n    uint64 CurrentPosition = output.getFilePointer();\n  \n    output.setFilePointer(EltToVoid.GetElementPosition());\n  \n    // compute the size of the voided data based on the original one\n    SetSize(EltToVoid.GetSize() + EltToVoid.HeadSize() - 1); // 1 for the ID\n    SetSize(GetSize() - CodedSizeLength(GetSize(), GetSizeLength(), IsFiniteSize()));\n    // make sure we handle even the strange cases\n    //uint32 A1 = GetSize() + HeadSize();\n    //uint32 A2 = EltToVoid.GetSize() + EltToVoid.HeadSize();\n    if (GetSize() + HeadSize() != EltToVoid.GetSize() + EltToVoid.HeadSize()) {\n      SetSize(GetSize()-1);\n      SetSizeLength(CodedSizeLength(GetSize(), GetSizeLength(), IsFiniteSize()) + 1);\n    }\n  \n    if (GetSize() != 0) {\n      RenderHead(output, false, bWithDefault); // the rest of the data is not rewritten\n    }\n  \n    if (ComeBackAfterward) {\n      output.setFilePointer(CurrentPosition);\n    }\n  \n    return EltToVoid.GetSize() + EltToVoid.HeadSize();\n  }\n}"
  },
  {
    "function_name": "ReplaceWith",
    "container": "EbmlVoid",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlVoid.cpp",
    "lines": "62-97",
    "snippet": "uint64 EbmlVoid::ReplaceWith(EbmlElement & EltToReplaceWith, IOCallback & output, bool ComeBackAfterward, bool bWithDefault)\n{\n  EltToReplaceWith.UpdateSize(bWithDefault);\n  if (HeadSize() + GetSize() < EltToReplaceWith.GetSize() + EltToReplaceWith.HeadSize()) {\n    // the element can't be written here !\n    return INVALID_FILEPOS_T;\n  }\n  if (HeadSize() + GetSize() - EltToReplaceWith.GetSize() - EltToReplaceWith.HeadSize() == 1) {\n    // there is not enough space to put a filling element\n    return INVALID_FILEPOS_T;\n  }\n\n  uint64 CurrentPosition = output.getFilePointer();\n\n  output.setFilePointer(GetElementPosition());\n  EltToReplaceWith.Render(output, bWithDefault);\n\n  if (HeadSize() + GetSize() - EltToReplaceWith.GetSize() - EltToReplaceWith.HeadSize() > 1) {\n    // fill the rest with another void element\n    EbmlVoid aTmp;\n    aTmp.SetSize_(HeadSize() + GetSize() - EltToReplaceWith.GetSize() - EltToReplaceWith.HeadSize() - 1); // 1 is the length of the Void ID\n    int HeadBefore = aTmp.HeadSize();\n    aTmp.SetSize_(aTmp.GetSize() - CodedSizeLength(aTmp.GetSize(), aTmp.GetSizeLength(), aTmp.IsFiniteSize()));\n    int HeadAfter = aTmp.HeadSize();\n    if (HeadBefore != HeadAfter) {\n      aTmp.SetSizeLength(CodedSizeLength(aTmp.GetSize(), aTmp.GetSizeLength(), aTmp.IsFiniteSize()) - (HeadAfter - HeadBefore));\n    }\n    aTmp.RenderHead(output, false, bWithDefault); // the rest of the data is not rewritten\n  }\n\n  if (ComeBackAfterward) {\n    output.setFilePointer(CurrentPosition);\n  }\n\n  return GetSize() + HeadSize();\n}",
    "includes": [
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlVoid.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "HeadSize",
          "args": [],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetSize",
          "args": [],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "GetSize",
          "container": "SafeReadIOCallback",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/SafeReadIOCallback.cpp",
          "lines": "88-92",
          "snippet": "size_t\nSafeReadIOCallback::GetSize()\n  const {\n  return mSize;\n}",
          "includes": [
            "#include \"ebml/SafeReadIOCallback.h\"",
            "#include \"ebml/MemReadIOCallback.h\"",
            "#include \"ebml/EbmlBinary.h\"",
            "#include <cstring>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/SafeReadIOCallback.h\"\n#include \"ebml/MemReadIOCallback.h\"\n#include \"ebml/EbmlBinary.h\"\n#include <cstring>\n\nSafeReadIOCallback {\n  size_t\n  SafeReadIOCallback::GetSize()\n    const {\n    return mSize;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "output.setFilePointer",
          "args": [
            "CurrentPosition"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aTmp.RenderHead",
          "args": [
            "output",
            "false",
            "bWithDefault"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aTmp.SetSizeLength",
          "args": [
            "CodedSizeLength(aTmp.GetSize(), aTmp.GetSizeLength(), aTmp.IsFiniteSize()) - (HeadAfter - HeadBefore)"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CodedSizeLength",
          "args": [
            "aTmp.GetSize()",
            "aTmp.GetSizeLength()",
            "aTmp.IsFiniteSize()"
          ],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "CodedSizeLength",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlElement.cpp",
          "lines": "45-83",
          "snippet": "START_LIBEBML_NAMESPACE\n\n/*!\n  \\todo handle more than CodedSize of 5\n*/\nint CodedSizeLength(uint64 Length, unsigned int SizeLength, bool bSizeFinite)\n{\n  unsigned int CodedSize;\n  if (bSizeFinite) {\n    // prepare the head of the size (000...01xxxxxx)\n    // optimal size\n    if (Length < 127) // 2^7 - 1\n      CodedSize = 1;\n    else if (Length < 16383) // 2^14 - 1\n      CodedSize = 2;\n    else if (Length < 2097151L) // 2^21 - 1\n      CodedSize = 3;\n    else if (Length < 268435455L) // 2^28 - 1\n      CodedSize = 4;\n    else CodedSize = 5;\n  } else {\n    if (Length <= 127) // 2^7 - 1\n      CodedSize = 1;\n    else if (Length <= 16383) // 2^14 - 1\n      CodedSize = 2;\n    else if (Length <= 2097151L) // 2^21 - 1\n      CodedSize = 3;\n    else if (Length <= 268435455L) // 2^28 - 1\n      CodedSize = 4;\n    else CodedSize = 5;\n  }\n\n  if (SizeLength > 0 && CodedSize < SizeLength) {\n    // defined size\n    CodedSize = SizeLength;\n  }\n\n  return CodedSize;\n}",
          "includes": [
            "#include \"ebml/EbmlContexts.h\"",
            "#include \"ebml/EbmlDummy.h\"",
            "#include \"ebml/EbmlVoid.h\"",
            "#include \"ebml/EbmlStream.h\"",
            "#include \"ebml/EbmlMaster.h\"",
            "#include \"ebml/EbmlElement.h\"",
            "#include <cstring>",
            "#include <cassert>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlDummy.h\"\n#include \"ebml/EbmlVoid.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include \"ebml/EbmlElement.h\"\n#include <cstring>\n#include <cassert>\n\nSTART_LIBEBML_NAMESPACE\n\n/*!\n  \\todo handle more than CodedSize of 5\n*/\nint CodedSizeLength(uint64 Length, unsigned int SizeLength, bool bSizeFinite)\n{\n  unsigned int CodedSize;\n  if (bSizeFinite) {\n    // prepare the head of the size (000...01xxxxxx)\n    // optimal size\n    if (Length < 127) // 2^7 - 1\n      CodedSize = 1;\n    else if (Length < 16383) // 2^14 - 1\n      CodedSize = 2;\n    else if (Length < 2097151L) // 2^21 - 1\n      CodedSize = 3;\n    else if (Length < 268435455L) // 2^28 - 1\n      CodedSize = 4;\n    else CodedSize = 5;\n  } else {\n    if (Length <= 127) // 2^7 - 1\n      CodedSize = 1;\n    else if (Length <= 16383) // 2^14 - 1\n      CodedSize = 2;\n    else if (Length <= 2097151L) // 2^21 - 1\n      CodedSize = 3;\n    else if (Length <= 268435455L) // 2^28 - 1\n      CodedSize = 4;\n    else CodedSize = 5;\n  }\n\n  if (SizeLength > 0 && CodedSize < SizeLength) {\n    // defined size\n    CodedSize = SizeLength;\n  }\n\n  return CodedSize;\n}"
        }
      },
      {
        "call_info": {
          "callee": "aTmp.IsFiniteSize",
          "args": [],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aTmp.GetSizeLength",
          "args": [],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aTmp.HeadSize",
          "args": [],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aTmp.SetSize_",
          "args": [
            "aTmp.GetSize() - CodedSizeLength(aTmp.GetSize(), aTmp.GetSizeLength(), aTmp.IsFiniteSize())"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aTmp.IsFiniteSize",
          "args": [],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aTmp.GetSizeLength",
          "args": [],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aTmp.HeadSize",
          "args": [],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aTmp.SetSize_",
          "args": [
            "HeadSize() + GetSize() - EltToReplaceWith.GetSize() - EltToReplaceWith.HeadSize() - 1"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EltToReplaceWith.HeadSize",
          "args": [],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HeadSize",
          "args": [],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EltToReplaceWith.HeadSize",
          "args": [],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HeadSize",
          "args": [],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EltToReplaceWith.Render",
          "args": [
            "output",
            "bWithDefault"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "output.setFilePointer",
          "args": [
            "GetElementPosition()"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetElementPosition",
          "args": [],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "output.getFilePointer",
          "args": [],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "getFilePointer",
          "container": "StdIOCallback",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/StdIOCallback.cpp",
          "lines": "159-175",
          "snippet": "uint64 StdIOCallback::getFilePointer()\n{\n  assert(File!=0);\n\n#if 0\n  long Result=ftell(File);\n  if(Result<0) {\n#if !defined(__GNUC__) || (__GNUC__ > 2)\n    stringstream Msg;\n    Msg<<\"Can't tell the current file pointer position for \"<<File;\n    throw CRTError(Msg.str());\n#endif // GCC2\n  }\n#endif\n\n  return mCurrentPosition;\n}",
          "includes": [
            "#include \"ebml/EbmlConfig.h\"",
            "#include \"ebml/Debug.h\"",
            "#include \"ebml/StdIOCallback.h\"",
            "#include <sstream>",
            "#include <climits>",
            "#include <cassert>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/EbmlConfig.h\"\n#include \"ebml/Debug.h\"\n#include \"ebml/StdIOCallback.h\"\n#include <sstream>\n#include <climits>\n#include <cassert>\n\nStdIOCallback {\n  uint64 StdIOCallback::getFilePointer()\n  {\n    assert(File!=0);\n  \n  #if 0\n    long Result=ftell(File);\n    if(Result<0) {\n  #if !defined(__GNUC__) || (__GNUC__ > 2)\n      stringstream Msg;\n      Msg<<\"Can't tell the current file pointer position for \"<<File;\n      throw CRTError(Msg.str());\n  #endif // GCC2\n    }\n  #endif\n  \n    return mCurrentPosition;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EltToReplaceWith.HeadSize",
          "args": [],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HeadSize",
          "args": [],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EltToReplaceWith.HeadSize",
          "args": [],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HeadSize",
          "args": [],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EltToReplaceWith.UpdateSize",
          "args": [
            "bWithDefault"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlVoid.h\"\n\nEbmlVoid {\n  uint64 EbmlVoid::ReplaceWith(EbmlElement & EltToReplaceWith, IOCallback & output, bool ComeBackAfterward, bool bWithDefault)\n  {\n    EltToReplaceWith.UpdateSize(bWithDefault);\n    if (HeadSize() + GetSize() < EltToReplaceWith.GetSize() + EltToReplaceWith.HeadSize()) {\n      // the element can't be written here !\n      return INVALID_FILEPOS_T;\n    }\n    if (HeadSize() + GetSize() - EltToReplaceWith.GetSize() - EltToReplaceWith.HeadSize() == 1) {\n      // there is not enough space to put a filling element\n      return INVALID_FILEPOS_T;\n    }\n  \n    uint64 CurrentPosition = output.getFilePointer();\n  \n    output.setFilePointer(GetElementPosition());\n    EltToReplaceWith.Render(output, bWithDefault);\n  \n    if (HeadSize() + GetSize() - EltToReplaceWith.GetSize() - EltToReplaceWith.HeadSize() > 1) {\n      // fill the rest with another void element\n      EbmlVoid aTmp;\n      aTmp.SetSize_(HeadSize() + GetSize() - EltToReplaceWith.GetSize() - EltToReplaceWith.HeadSize() - 1); // 1 is the length of the Void ID\n      int HeadBefore = aTmp.HeadSize();\n      aTmp.SetSize_(aTmp.GetSize() - CodedSizeLength(aTmp.GetSize(), aTmp.GetSizeLength(), aTmp.IsFiniteSize()));\n      int HeadAfter = aTmp.HeadSize();\n      if (HeadBefore != HeadAfter) {\n        aTmp.SetSizeLength(CodedSizeLength(aTmp.GetSize(), aTmp.GetSizeLength(), aTmp.IsFiniteSize()) - (HeadAfter - HeadBefore));\n      }\n      aTmp.RenderHead(output, false, bWithDefault); // the rest of the data is not rewritten\n    }\n  \n    if (ComeBackAfterward) {\n      output.setFilePointer(CurrentPosition);\n    }\n  \n    return GetSize() + HeadSize();\n  }\n}"
  },
  {
    "function_name": "RenderData",
    "container": "EbmlVoid",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlVoid.cpp",
    "lines": "48-60",
    "snippet": "filepos_t EbmlVoid::RenderData(IOCallback & output, bool /* bForceRender */, bool /* bWithDefault */)\n{\n  // write dummy data by 4KB chunks\n  static binary DummyBuf[4*1024];\n\n  uint64 SizeToWrite = GetSize();\n  while (SizeToWrite > 4*1024) {\n    output.writeFully(DummyBuf, 4*1024);\n    SizeToWrite -= 4*1024;\n  }\n  output.writeFully(DummyBuf, SizeToWrite);\n  return GetSize();\n}",
    "includes": [
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlVoid.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetSize",
          "args": [],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "GetSize",
          "container": "SafeReadIOCallback",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/SafeReadIOCallback.cpp",
          "lines": "88-92",
          "snippet": "size_t\nSafeReadIOCallback::GetSize()\n  const {\n  return mSize;\n}",
          "includes": [
            "#include \"ebml/SafeReadIOCallback.h\"",
            "#include \"ebml/MemReadIOCallback.h\"",
            "#include \"ebml/EbmlBinary.h\"",
            "#include <cstring>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/SafeReadIOCallback.h\"\n#include \"ebml/MemReadIOCallback.h\"\n#include \"ebml/EbmlBinary.h\"\n#include <cstring>\n\nSafeReadIOCallback {\n  size_t\n  SafeReadIOCallback::GetSize()\n    const {\n    return mSize;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "output.writeFully",
          "args": [
            "DummyBuf",
            "SizeToWrite"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "writeFully",
          "container": "IOCallback",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/IOCallback.cpp",
          "lines": "46-63",
          "snippet": "START_LIBEBML_NAMESPACE\n\nvoid IOCallback::writeFully(const void*Buffer,size_t Size)\n{\n  if (Size == 0)\n    return;\n\n  if (Buffer == NULL)\n    throw;\n\n  if(write(Buffer,Size) != Size) {\n#if !defined(__GNUC__) || (__GNUC__ > 2)\n    stringstream Msg;\n    Msg<<\"EOF in writeFully(\"<<Buffer<<\",\"<<Size<<\")\";\n    throw runtime_error(Msg.str());\n#endif // GCC2\n  }\n}",
          "includes": [
            "#include \"ebml/IOCallback.h\"",
            "#include <stdexcept>",
            "#include <sstream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/IOCallback.h\"\n#include <stdexcept>\n#include <sstream>\n\nIOCallback {\n  START_LIBEBML_NAMESPACE\n  \n  void IOCallback::writeFully(const void*Buffer,size_t Size)\n  {\n    if (Size == 0)\n      return;\n  \n    if (Buffer == NULL)\n      throw;\n  \n    if(write(Buffer,Size) != Size) {\n  #if !defined(__GNUC__) || (__GNUC__ > 2)\n      stringstream Msg;\n      Msg<<\"EOF in writeFully(\"<<Buffer<<\",\"<<Size<<\")\";\n      throw runtime_error(Msg.str());\n  #endif // GCC2\n    }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlVoid.h\"\n\nEbmlVoid {\n  filepos_t EbmlVoid::RenderData(IOCallback & output, bool /* bForceRender */, bool /* bWithDefault */)\n  {\n    // write dummy data by 4KB chunks\n    static binary DummyBuf[4*1024];\n  \n    uint64 SizeToWrite = GetSize();\n    while (SizeToWrite > 4*1024) {\n      output.writeFully(DummyBuf, 4*1024);\n      SizeToWrite -= 4*1024;\n    }\n    output.writeFully(DummyBuf, SizeToWrite);\n    return GetSize();\n  }\n}"
  },
  {
    "function_name": "EbmlVoid",
    "container": "EbmlVoid",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlVoid.cpp",
    "lines": "43-46",
    "snippet": "EbmlVoid::EbmlVoid()\n{\n  SetValueIsSet();\n}",
    "includes": [
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlVoid.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetValueIsSet",
          "args": [],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlVoid.h\"\n\nEbmlVoid {\n  EbmlVoid::EbmlVoid()\n  {\n    SetValueIsSet();\n  }\n}"
  }
]