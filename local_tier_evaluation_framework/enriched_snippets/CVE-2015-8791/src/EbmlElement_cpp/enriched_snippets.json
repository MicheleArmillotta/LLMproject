[
  {
    "function_name": "VoidMe",
    "container": "EbmlElement",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlElement.cpp",
    "lines": "694-702",
    "snippet": "uint64 EbmlElement::VoidMe(IOCallback & output, bool bWithDefault)\n{\n  if (ElementPosition == 0) {\n    return 0; // the element has not been written\n  }\n\n  EbmlVoid Dummy;\n  return Dummy.Overwrite(*this, output, bWithDefault);\n}",
    "includes": [
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlDummy.h\"",
      "#include \"ebml/EbmlVoid.h\"",
      "#include \"ebml/EbmlStream.h\"",
      "#include \"ebml/EbmlMaster.h\"",
      "#include \"ebml/EbmlElement.h\"",
      "#include <cstring>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Dummy.Overwrite",
          "args": [
            "*this",
            "output",
            "bWithDefault"
          ],
          "line": 701
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlDummy.h\"\n#include \"ebml/EbmlVoid.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include \"ebml/EbmlElement.h\"\n#include <cstring>\n#include <cassert>\n\nEbmlElement {\n  uint64 EbmlElement::VoidMe(IOCallback & output, bool bWithDefault)\n  {\n    if (ElementPosition == 0) {\n      return 0; // the element has not been written\n    }\n  \n    EbmlVoid Dummy;\n    return Dummy.Overwrite(*this, output, bWithDefault);\n  }\n}"
  },
  {
    "function_name": "OverwriteHead",
    "container": "EbmlElement",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlElement.cpp",
    "lines": "681-692",
    "snippet": "filepos_t EbmlElement::OverwriteHead(IOCallback & output, bool bKeepPosition)\n{\n  if (ElementPosition == 0) {\n    return 0; // the element has not been written\n  }\n\n  uint64 CurrentPosition = output.getFilePointer();\n  output.setFilePointer(GetElementPosition());\n  filepos_t Result = MakeRenderHead(output, bKeepPosition);\n  output.setFilePointer(CurrentPosition);\n  return Result;\n}",
    "includes": [
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlDummy.h\"",
      "#include \"ebml/EbmlVoid.h\"",
      "#include \"ebml/EbmlStream.h\"",
      "#include \"ebml/EbmlMaster.h\"",
      "#include \"ebml/EbmlElement.h\"",
      "#include <cstring>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "output.setFilePointer",
          "args": [
            "CurrentPosition"
          ],
          "line": 690
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MakeRenderHead",
          "args": [
            "output",
            "bKeepPosition"
          ],
          "line": 689
        },
        "resolved": true,
        "details": {
          "function_name": "MakeRenderHead",
          "container": "EbmlElement",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlElement.cpp",
          "lines": "615-634",
          "snippet": "filepos_t EbmlElement::MakeRenderHead(IOCallback & output, bool bKeepPosition)\n{\n  binary FinalHead[4+8]; // Class D + 64 bits coded size\n  unsigned int FinalHeadSize;\n\n  FinalHeadSize = EBML_ID_LENGTH((const EbmlId&)*this);\n  EbmlId(*this).Fill(FinalHead);\n\n  int CodedSize = CodedSizeLength(Size, SizeLength, bSizeIsFinite);\n  CodedValueLength(Size, CodedSize, &FinalHead[FinalHeadSize]);\n  FinalHeadSize += CodedSize;\n\n  output.writeFully(FinalHead, FinalHeadSize);\n  if (!bKeepPosition) {\n    ElementPosition = output.getFilePointer() - FinalHeadSize;\n    SizePosition = ElementPosition + EBML_ID_LENGTH((const EbmlId&)*this);\n  }\n\n  return FinalHeadSize;\n}",
          "includes": [
            "#include \"ebml/EbmlContexts.h\"",
            "#include \"ebml/EbmlDummy.h\"",
            "#include \"ebml/EbmlVoid.h\"",
            "#include \"ebml/EbmlStream.h\"",
            "#include \"ebml/EbmlMaster.h\"",
            "#include \"ebml/EbmlElement.h\"",
            "#include <cstring>",
            "#include <cassert>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlDummy.h\"\n#include \"ebml/EbmlVoid.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include \"ebml/EbmlElement.h\"\n#include <cstring>\n#include <cassert>\n\nEbmlElement {\n  filepos_t EbmlElement::MakeRenderHead(IOCallback & output, bool bKeepPosition)\n  {\n    binary FinalHead[4+8]; // Class D + 64 bits coded size\n    unsigned int FinalHeadSize;\n  \n    FinalHeadSize = EBML_ID_LENGTH((const EbmlId&)*this);\n    EbmlId(*this).Fill(FinalHead);\n  \n    int CodedSize = CodedSizeLength(Size, SizeLength, bSizeIsFinite);\n    CodedValueLength(Size, CodedSize, &FinalHead[FinalHeadSize]);\n    FinalHeadSize += CodedSize;\n  \n    output.writeFully(FinalHead, FinalHeadSize);\n    if (!bKeepPosition) {\n      ElementPosition = output.getFilePointer() - FinalHeadSize;\n      SizePosition = ElementPosition + EBML_ID_LENGTH((const EbmlId&)*this);\n    }\n  \n    return FinalHeadSize;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "output.setFilePointer",
          "args": [
            "GetElementPosition()"
          ],
          "line": 688
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetElementPosition",
          "args": [],
          "line": 688
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "output.getFilePointer",
          "args": [],
          "line": 687
        },
        "resolved": true,
        "details": {
          "function_name": "getFilePointer",
          "container": "StdIOCallback",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/StdIOCallback.cpp",
          "lines": "159-175",
          "snippet": "uint64 StdIOCallback::getFilePointer()\n{\n  assert(File!=0);\n\n#if 0\n  long Result=ftell(File);\n  if(Result<0) {\n#if !defined(__GNUC__) || (__GNUC__ > 2)\n    stringstream Msg;\n    Msg<<\"Can't tell the current file pointer position for \"<<File;\n    throw CRTError(Msg.str());\n#endif // GCC2\n  }\n#endif\n\n  return mCurrentPosition;\n}",
          "includes": [
            "#include \"ebml/EbmlConfig.h\"",
            "#include \"ebml/Debug.h\"",
            "#include \"ebml/StdIOCallback.h\"",
            "#include <sstream>",
            "#include <climits>",
            "#include <cassert>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/EbmlConfig.h\"\n#include \"ebml/Debug.h\"\n#include \"ebml/StdIOCallback.h\"\n#include <sstream>\n#include <climits>\n#include <cassert>\n\nStdIOCallback {\n  uint64 StdIOCallback::getFilePointer()\n  {\n    assert(File!=0);\n  \n  #if 0\n    long Result=ftell(File);\n    if(Result<0) {\n  #if !defined(__GNUC__) || (__GNUC__ > 2)\n      stringstream Msg;\n      Msg<<\"Can't tell the current file pointer position for \"<<File;\n      throw CRTError(Msg.str());\n  #endif // GCC2\n    }\n  #endif\n  \n    return mCurrentPosition;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlDummy.h\"\n#include \"ebml/EbmlVoid.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include \"ebml/EbmlElement.h\"\n#include <cstring>\n#include <cassert>\n\nEbmlElement {\n  filepos_t EbmlElement::OverwriteHead(IOCallback & output, bool bKeepPosition)\n  {\n    if (ElementPosition == 0) {\n      return 0; // the element has not been written\n    }\n  \n    uint64 CurrentPosition = output.getFilePointer();\n    output.setFilePointer(GetElementPosition());\n    filepos_t Result = MakeRenderHead(output, bKeepPosition);\n    output.setFilePointer(CurrentPosition);\n    return Result;\n  }\n}"
  },
  {
    "function_name": "ForceSize",
    "container": "EbmlElement",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlElement.cpp",
    "lines": "661-679",
    "snippet": "bool EbmlElement::ForceSize(uint64 NewSize)\n{\n  if (bSizeIsFinite) {\n    return false;\n  }\n\n  int OldSizeLen = CodedSizeLength(Size, SizeLength, bSizeIsFinite);\n  uint64 OldSize = Size;\n\n  Size = NewSize;\n\n  if (CodedSizeLength(Size, SizeLength, bSizeIsFinite) == OldSizeLen) {\n    bSizeIsFinite = true;\n    return true;\n  }\n  Size = OldSize;\n\n  return false;\n}",
    "includes": [
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlDummy.h\"",
      "#include \"ebml/EbmlVoid.h\"",
      "#include \"ebml/EbmlStream.h\"",
      "#include \"ebml/EbmlMaster.h\"",
      "#include \"ebml/EbmlElement.h\"",
      "#include <cstring>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CodedSizeLength",
          "args": [
            "Size",
            "SizeLength",
            "bSizeIsFinite"
          ],
          "line": 672
        },
        "resolved": true,
        "details": {
          "function_name": "CodedSizeLength",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlElement.cpp",
          "lines": "45-83",
          "snippet": "START_LIBEBML_NAMESPACE\n\n/*!\n  \\todo handle more than CodedSize of 5\n*/\nint CodedSizeLength(uint64 Length, unsigned int SizeLength, bool bSizeFinite)\n{\n  unsigned int CodedSize;\n  if (bSizeFinite) {\n    // prepare the head of the size (000...01xxxxxx)\n    // optimal size\n    if (Length < 127) // 2^7 - 1\n      CodedSize = 1;\n    else if (Length < 16383) // 2^14 - 1\n      CodedSize = 2;\n    else if (Length < 2097151L) // 2^21 - 1\n      CodedSize = 3;\n    else if (Length < 268435455L) // 2^28 - 1\n      CodedSize = 4;\n    else CodedSize = 5;\n  } else {\n    if (Length <= 127) // 2^7 - 1\n      CodedSize = 1;\n    else if (Length <= 16383) // 2^14 - 1\n      CodedSize = 2;\n    else if (Length <= 2097151L) // 2^21 - 1\n      CodedSize = 3;\n    else if (Length <= 268435455L) // 2^28 - 1\n      CodedSize = 4;\n    else CodedSize = 5;\n  }\n\n  if (SizeLength > 0 && CodedSize < SizeLength) {\n    // defined size\n    CodedSize = SizeLength;\n  }\n\n  return CodedSize;\n}",
          "includes": [
            "#include \"ebml/EbmlContexts.h\"",
            "#include \"ebml/EbmlDummy.h\"",
            "#include \"ebml/EbmlVoid.h\"",
            "#include \"ebml/EbmlStream.h\"",
            "#include \"ebml/EbmlMaster.h\"",
            "#include \"ebml/EbmlElement.h\"",
            "#include <cstring>",
            "#include <cassert>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlDummy.h\"\n#include \"ebml/EbmlVoid.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include \"ebml/EbmlElement.h\"\n#include <cstring>\n#include <cassert>\n\nSTART_LIBEBML_NAMESPACE\n\n/*!\n  \\todo handle more than CodedSize of 5\n*/\nint CodedSizeLength(uint64 Length, unsigned int SizeLength, bool bSizeFinite)\n{\n  unsigned int CodedSize;\n  if (bSizeFinite) {\n    // prepare the head of the size (000...01xxxxxx)\n    // optimal size\n    if (Length < 127) // 2^7 - 1\n      CodedSize = 1;\n    else if (Length < 16383) // 2^14 - 1\n      CodedSize = 2;\n    else if (Length < 2097151L) // 2^21 - 1\n      CodedSize = 3;\n    else if (Length < 268435455L) // 2^28 - 1\n      CodedSize = 4;\n    else CodedSize = 5;\n  } else {\n    if (Length <= 127) // 2^7 - 1\n      CodedSize = 1;\n    else if (Length <= 16383) // 2^14 - 1\n      CodedSize = 2;\n    else if (Length <= 2097151L) // 2^21 - 1\n      CodedSize = 3;\n    else if (Length <= 268435455L) // 2^28 - 1\n      CodedSize = 4;\n    else CodedSize = 5;\n  }\n\n  if (SizeLength > 0 && CodedSize < SizeLength) {\n    // defined size\n    CodedSize = SizeLength;\n  }\n\n  return CodedSize;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlDummy.h\"\n#include \"ebml/EbmlVoid.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include \"ebml/EbmlElement.h\"\n#include <cstring>\n#include <cassert>\n\nEbmlElement {\n  bool EbmlElement::ForceSize(uint64 NewSize)\n  {\n    if (bSizeIsFinite) {\n      return false;\n    }\n  \n    int OldSizeLen = CodedSizeLength(Size, SizeLength, bSizeIsFinite);\n    uint64 OldSize = Size;\n  \n    Size = NewSize;\n  \n    if (CodedSizeLength(Size, SizeLength, bSizeIsFinite) == OldSizeLen) {\n      bSizeIsFinite = true;\n      return true;\n    }\n    Size = OldSize;\n  \n    return false;\n  }\n}"
  },
  {
    "function_name": "Read",
    "container": "EbmlElement",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlElement.cpp",
    "lines": "656-659",
    "snippet": "void EbmlElement::Read(EbmlStream & inDataStream, const EbmlSemanticContext & /* Context */, int & /* UpperEltFound */, EbmlElement * & /* FoundElt */, bool /* AllowDummyElt */, ScopeMode ReadFully)\n{\n  ReadData(inDataStream.I_O(), ReadFully);\n}",
    "includes": [
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlDummy.h\"",
      "#include \"ebml/EbmlVoid.h\"",
      "#include \"ebml/EbmlStream.h\"",
      "#include \"ebml/EbmlMaster.h\"",
      "#include \"ebml/EbmlElement.h\"",
      "#include <cstring>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ReadData",
          "args": [
            "inDataStream.I_O()",
            "ReadFully"
          ],
          "line": 658
        },
        "resolved": true,
        "details": {
          "function_name": "ReadData",
          "container": "EbmlMaster",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlMaster.cpp",
          "lines": "170-174",
          "snippet": "filepos_t EbmlMaster::ReadData(IOCallback & input, ScopeMode /* ReadFully */)\n{\n  input.setFilePointer(GetSize(), seek_current);\n  return GetSize();\n}",
          "includes": [
            "#include \"ebml/MemIOCallback.h\"",
            "#include \"ebml/EbmlContexts.h\"",
            "#include \"ebml/EbmlStream.h\"",
            "#include \"ebml/EbmlMaster.h\"",
            "#include <algorithm>",
            "#include <cassert>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/MemIOCallback.h\"\n#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include <algorithm>\n#include <cassert>\n\nEbmlMaster {\n  filepos_t EbmlMaster::ReadData(IOCallback & input, ScopeMode /* ReadFully */)\n  {\n    input.setFilePointer(GetSize(), seek_current);\n    return GetSize();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "inDataStream.I_O",
          "args": [],
          "line": 658
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlDummy.h\"\n#include \"ebml/EbmlVoid.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include \"ebml/EbmlElement.h\"\n#include <cstring>\n#include <cassert>\n\nEbmlElement {\n  void EbmlElement::Read(EbmlStream & inDataStream, const EbmlSemanticContext & /* Context */, int & /* UpperEltFound */, EbmlElement * & /* FoundElt */, bool /* AllowDummyElt */, ScopeMode ReadFully)\n  {\n    ReadData(inDataStream.I_O(), ReadFully);\n  }\n}"
  },
  {
    "function_name": "CompareElements",
    "container": "EbmlElement",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlElement.cpp",
    "lines": "648-654",
    "snippet": "bool EbmlElement::CompareElements(const EbmlElement *A, const EbmlElement *B)\n{\n  if (EbmlId(*A) == EbmlId(*B))\n    return A->IsSmallerThan(B);\n  else\n    return false;\n}",
    "includes": [
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlDummy.h\"",
      "#include \"ebml/EbmlVoid.h\"",
      "#include \"ebml/EbmlStream.h\"",
      "#include \"ebml/EbmlMaster.h\"",
      "#include \"ebml/EbmlElement.h\"",
      "#include <cstring>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "A->IsSmallerThan",
          "args": [
            "B"
          ],
          "line": 651
        },
        "resolved": true,
        "details": {
          "function_name": "IsSmallerThan",
          "container": "EbmlElement",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlElement.cpp",
          "lines": "643-646",
          "snippet": "bool EbmlElement::IsSmallerThan(const EbmlElement *Cmp) const\n{\n  return EbmlId(*this) == EbmlId(*Cmp);\n}",
          "includes": [
            "#include \"ebml/EbmlContexts.h\"",
            "#include \"ebml/EbmlDummy.h\"",
            "#include \"ebml/EbmlVoid.h\"",
            "#include \"ebml/EbmlStream.h\"",
            "#include \"ebml/EbmlMaster.h\"",
            "#include \"ebml/EbmlElement.h\"",
            "#include <cstring>",
            "#include <cassert>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlDummy.h\"\n#include \"ebml/EbmlVoid.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include \"ebml/EbmlElement.h\"\n#include <cstring>\n#include <cassert>\n\nEbmlElement {\n  bool EbmlElement::IsSmallerThan(const EbmlElement *Cmp) const\n  {\n    return EbmlId(*this) == EbmlId(*Cmp);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EbmlId",
          "args": [
            "*B"
          ],
          "line": 650
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EbmlId",
          "args": [
            "*A"
          ],
          "line": 650
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlDummy.h\"\n#include \"ebml/EbmlVoid.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include \"ebml/EbmlElement.h\"\n#include <cstring>\n#include <cassert>\n\nEbmlElement {\n  bool EbmlElement::CompareElements(const EbmlElement *A, const EbmlElement *B)\n  {\n    if (EbmlId(*A) == EbmlId(*B))\n      return A->IsSmallerThan(B);\n    else\n      return false;\n  }\n}"
  },
  {
    "function_name": "IsSmallerThan",
    "container": "EbmlElement",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlElement.cpp",
    "lines": "643-646",
    "snippet": "bool EbmlElement::IsSmallerThan(const EbmlElement *Cmp) const\n{\n  return EbmlId(*this) == EbmlId(*Cmp);\n}",
    "includes": [
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlDummy.h\"",
      "#include \"ebml/EbmlVoid.h\"",
      "#include \"ebml/EbmlStream.h\"",
      "#include \"ebml/EbmlMaster.h\"",
      "#include \"ebml/EbmlElement.h\"",
      "#include <cstring>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EbmlId",
          "args": [
            "*Cmp"
          ],
          "line": 645
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EbmlId",
          "args": [
            "*this"
          ],
          "line": 645
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlDummy.h\"\n#include \"ebml/EbmlVoid.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include \"ebml/EbmlElement.h\"\n#include <cstring>\n#include <cassert>\n\nEbmlElement {\n  bool EbmlElement::IsSmallerThan(const EbmlElement *Cmp) const\n  {\n    return EbmlId(*this) == EbmlId(*Cmp);\n  }\n}"
  },
  {
    "function_name": "ElementSize",
    "container": "EbmlElement",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlElement.cpp",
    "lines": "636-641",
    "snippet": "uint64 EbmlElement::ElementSize(bool bWithDefault) const\n{\n  if (!bWithDefault && IsDefaultValue())\n    return 0; // won't be saved\n  return Size + EBML_ID_LENGTH((const EbmlId&)*this) + CodedSizeLength(Size, SizeLength, bSizeIsFinite);\n}",
    "includes": [
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlDummy.h\"",
      "#include \"ebml/EbmlVoid.h\"",
      "#include \"ebml/EbmlStream.h\"",
      "#include \"ebml/EbmlMaster.h\"",
      "#include \"ebml/EbmlElement.h\"",
      "#include <cstring>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CodedSizeLength",
          "args": [
            "Size",
            "SizeLength",
            "bSizeIsFinite"
          ],
          "line": 640
        },
        "resolved": true,
        "details": {
          "function_name": "CodedSizeLength",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlElement.cpp",
          "lines": "45-83",
          "snippet": "START_LIBEBML_NAMESPACE\n\n/*!\n  \\todo handle more than CodedSize of 5\n*/\nint CodedSizeLength(uint64 Length, unsigned int SizeLength, bool bSizeFinite)\n{\n  unsigned int CodedSize;\n  if (bSizeFinite) {\n    // prepare the head of the size (000...01xxxxxx)\n    // optimal size\n    if (Length < 127) // 2^7 - 1\n      CodedSize = 1;\n    else if (Length < 16383) // 2^14 - 1\n      CodedSize = 2;\n    else if (Length < 2097151L) // 2^21 - 1\n      CodedSize = 3;\n    else if (Length < 268435455L) // 2^28 - 1\n      CodedSize = 4;\n    else CodedSize = 5;\n  } else {\n    if (Length <= 127) // 2^7 - 1\n      CodedSize = 1;\n    else if (Length <= 16383) // 2^14 - 1\n      CodedSize = 2;\n    else if (Length <= 2097151L) // 2^21 - 1\n      CodedSize = 3;\n    else if (Length <= 268435455L) // 2^28 - 1\n      CodedSize = 4;\n    else CodedSize = 5;\n  }\n\n  if (SizeLength > 0 && CodedSize < SizeLength) {\n    // defined size\n    CodedSize = SizeLength;\n  }\n\n  return CodedSize;\n}",
          "includes": [
            "#include \"ebml/EbmlContexts.h\"",
            "#include \"ebml/EbmlDummy.h\"",
            "#include \"ebml/EbmlVoid.h\"",
            "#include \"ebml/EbmlStream.h\"",
            "#include \"ebml/EbmlMaster.h\"",
            "#include \"ebml/EbmlElement.h\"",
            "#include <cstring>",
            "#include <cassert>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlDummy.h\"\n#include \"ebml/EbmlVoid.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include \"ebml/EbmlElement.h\"\n#include <cstring>\n#include <cassert>\n\nSTART_LIBEBML_NAMESPACE\n\n/*!\n  \\todo handle more than CodedSize of 5\n*/\nint CodedSizeLength(uint64 Length, unsigned int SizeLength, bool bSizeFinite)\n{\n  unsigned int CodedSize;\n  if (bSizeFinite) {\n    // prepare the head of the size (000...01xxxxxx)\n    // optimal size\n    if (Length < 127) // 2^7 - 1\n      CodedSize = 1;\n    else if (Length < 16383) // 2^14 - 1\n      CodedSize = 2;\n    else if (Length < 2097151L) // 2^21 - 1\n      CodedSize = 3;\n    else if (Length < 268435455L) // 2^28 - 1\n      CodedSize = 4;\n    else CodedSize = 5;\n  } else {\n    if (Length <= 127) // 2^7 - 1\n      CodedSize = 1;\n    else if (Length <= 16383) // 2^14 - 1\n      CodedSize = 2;\n    else if (Length <= 2097151L) // 2^21 - 1\n      CodedSize = 3;\n    else if (Length <= 268435455L) // 2^28 - 1\n      CodedSize = 4;\n    else CodedSize = 5;\n  }\n\n  if (SizeLength > 0 && CodedSize < SizeLength) {\n    // defined size\n    CodedSize = SizeLength;\n  }\n\n  return CodedSize;\n}"
        }
      },
      {
        "call_info": {
          "callee": "EBML_ID_LENGTH",
          "args": [
            "(const EbmlId&)*this"
          ],
          "line": 640
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IsDefaultValue",
          "args": [],
          "line": 638
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlDummy.h\"\n#include \"ebml/EbmlVoid.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include \"ebml/EbmlElement.h\"\n#include <cstring>\n#include <cassert>\n\nEbmlElement {\n  uint64 EbmlElement::ElementSize(bool bWithDefault) const\n  {\n    if (!bWithDefault && IsDefaultValue())\n      return 0; // won't be saved\n    return Size + EBML_ID_LENGTH((const EbmlId&)*this) + CodedSizeLength(Size, SizeLength, bSizeIsFinite);\n  }\n}"
  },
  {
    "function_name": "MakeRenderHead",
    "container": "EbmlElement",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlElement.cpp",
    "lines": "615-634",
    "snippet": "filepos_t EbmlElement::MakeRenderHead(IOCallback & output, bool bKeepPosition)\n{\n  binary FinalHead[4+8]; // Class D + 64 bits coded size\n  unsigned int FinalHeadSize;\n\n  FinalHeadSize = EBML_ID_LENGTH((const EbmlId&)*this);\n  EbmlId(*this).Fill(FinalHead);\n\n  int CodedSize = CodedSizeLength(Size, SizeLength, bSizeIsFinite);\n  CodedValueLength(Size, CodedSize, &FinalHead[FinalHeadSize]);\n  FinalHeadSize += CodedSize;\n\n  output.writeFully(FinalHead, FinalHeadSize);\n  if (!bKeepPosition) {\n    ElementPosition = output.getFilePointer() - FinalHeadSize;\n    SizePosition = ElementPosition + EBML_ID_LENGTH((const EbmlId&)*this);\n  }\n\n  return FinalHeadSize;\n}",
    "includes": [
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlDummy.h\"",
      "#include \"ebml/EbmlVoid.h\"",
      "#include \"ebml/EbmlStream.h\"",
      "#include \"ebml/EbmlMaster.h\"",
      "#include \"ebml/EbmlElement.h\"",
      "#include <cstring>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EBML_ID_LENGTH",
          "args": [
            "(const EbmlId&)*this"
          ],
          "line": 630
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "output.getFilePointer",
          "args": [],
          "line": 629
        },
        "resolved": true,
        "details": {
          "function_name": "getFilePointer",
          "container": "StdIOCallback",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/StdIOCallback.cpp",
          "lines": "159-175",
          "snippet": "uint64 StdIOCallback::getFilePointer()\n{\n  assert(File!=0);\n\n#if 0\n  long Result=ftell(File);\n  if(Result<0) {\n#if !defined(__GNUC__) || (__GNUC__ > 2)\n    stringstream Msg;\n    Msg<<\"Can't tell the current file pointer position for \"<<File;\n    throw CRTError(Msg.str());\n#endif // GCC2\n  }\n#endif\n\n  return mCurrentPosition;\n}",
          "includes": [
            "#include \"ebml/EbmlConfig.h\"",
            "#include \"ebml/Debug.h\"",
            "#include \"ebml/StdIOCallback.h\"",
            "#include <sstream>",
            "#include <climits>",
            "#include <cassert>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/EbmlConfig.h\"\n#include \"ebml/Debug.h\"\n#include \"ebml/StdIOCallback.h\"\n#include <sstream>\n#include <climits>\n#include <cassert>\n\nStdIOCallback {\n  uint64 StdIOCallback::getFilePointer()\n  {\n    assert(File!=0);\n  \n  #if 0\n    long Result=ftell(File);\n    if(Result<0) {\n  #if !defined(__GNUC__) || (__GNUC__ > 2)\n      stringstream Msg;\n      Msg<<\"Can't tell the current file pointer position for \"<<File;\n      throw CRTError(Msg.str());\n  #endif // GCC2\n    }\n  #endif\n  \n    return mCurrentPosition;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "output.writeFully",
          "args": [
            "FinalHead",
            "FinalHeadSize"
          ],
          "line": 627
        },
        "resolved": true,
        "details": {
          "function_name": "writeFully",
          "container": "IOCallback",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/IOCallback.cpp",
          "lines": "46-63",
          "snippet": "START_LIBEBML_NAMESPACE\n\nvoid IOCallback::writeFully(const void*Buffer,size_t Size)\n{\n  if (Size == 0)\n    return;\n\n  if (Buffer == NULL)\n    throw;\n\n  if(write(Buffer,Size) != Size) {\n#if !defined(__GNUC__) || (__GNUC__ > 2)\n    stringstream Msg;\n    Msg<<\"EOF in writeFully(\"<<Buffer<<\",\"<<Size<<\")\";\n    throw runtime_error(Msg.str());\n#endif // GCC2\n  }\n}",
          "includes": [
            "#include \"ebml/IOCallback.h\"",
            "#include <stdexcept>",
            "#include <sstream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/IOCallback.h\"\n#include <stdexcept>\n#include <sstream>\n\nIOCallback {\n  START_LIBEBML_NAMESPACE\n  \n  void IOCallback::writeFully(const void*Buffer,size_t Size)\n  {\n    if (Size == 0)\n      return;\n  \n    if (Buffer == NULL)\n      throw;\n  \n    if(write(Buffer,Size) != Size) {\n  #if !defined(__GNUC__) || (__GNUC__ > 2)\n      stringstream Msg;\n      Msg<<\"EOF in writeFully(\"<<Buffer<<\",\"<<Size<<\")\";\n      throw runtime_error(Msg.str());\n  #endif // GCC2\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CodedValueLength",
          "args": [
            "Size",
            "CodedSize",
            "&FinalHead[FinalHeadSize]"
          ],
          "line": 624
        },
        "resolved": true,
        "details": {
          "function_name": "CodedValueLengthSigned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlElement.cpp",
          "lines": "125-137",
          "snippet": "int CodedValueLengthSigned(int64 Length, int CodedSize, binary * OutBuffer)\n{\n  if (Length > -64 && Length < 64) // 2^6\n    Length += 63;\n  else if (Length > -8192 && Length < 8192) // 2^13\n    Length += 8191;\n  else if (Length > -1048576L && Length < 1048576L) // 2^20\n    Length += 1048575L;\n  else if (Length > -134217728L && Length < 134217728L) // 2^27\n    Length += 134217727L;\n\n  return CodedValueLength(Length, CodedSize, OutBuffer);\n}",
          "includes": [
            "#include \"ebml/EbmlContexts.h\"",
            "#include \"ebml/EbmlDummy.h\"",
            "#include \"ebml/EbmlVoid.h\"",
            "#include \"ebml/EbmlStream.h\"",
            "#include \"ebml/EbmlMaster.h\"",
            "#include \"ebml/EbmlElement.h\"",
            "#include <cstring>",
            "#include <cassert>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlDummy.h\"\n#include \"ebml/EbmlVoid.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include \"ebml/EbmlElement.h\"\n#include <cstring>\n#include <cassert>\n\nint CodedValueLengthSigned(int64 Length, int CodedSize, binary * OutBuffer)\n{\n  if (Length > -64 && Length < 64) // 2^6\n    Length += 63;\n  else if (Length > -8192 && Length < 8192) // 2^13\n    Length += 8191;\n  else if (Length > -1048576L && Length < 1048576L) // 2^20\n    Length += 1048575L;\n  else if (Length > -134217728L && Length < 134217728L) // 2^27\n    Length += 134217727L;\n\n  return CodedValueLength(Length, CodedSize, OutBuffer);\n}"
        }
      },
      {
        "call_info": {
          "callee": "CodedSizeLength",
          "args": [
            "Size",
            "SizeLength",
            "bSizeIsFinite"
          ],
          "line": 623
        },
        "resolved": true,
        "details": {
          "function_name": "CodedSizeLength",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlElement.cpp",
          "lines": "45-83",
          "snippet": "START_LIBEBML_NAMESPACE\n\n/*!\n  \\todo handle more than CodedSize of 5\n*/\nint CodedSizeLength(uint64 Length, unsigned int SizeLength, bool bSizeFinite)\n{\n  unsigned int CodedSize;\n  if (bSizeFinite) {\n    // prepare the head of the size (000...01xxxxxx)\n    // optimal size\n    if (Length < 127) // 2^7 - 1\n      CodedSize = 1;\n    else if (Length < 16383) // 2^14 - 1\n      CodedSize = 2;\n    else if (Length < 2097151L) // 2^21 - 1\n      CodedSize = 3;\n    else if (Length < 268435455L) // 2^28 - 1\n      CodedSize = 4;\n    else CodedSize = 5;\n  } else {\n    if (Length <= 127) // 2^7 - 1\n      CodedSize = 1;\n    else if (Length <= 16383) // 2^14 - 1\n      CodedSize = 2;\n    else if (Length <= 2097151L) // 2^21 - 1\n      CodedSize = 3;\n    else if (Length <= 268435455L) // 2^28 - 1\n      CodedSize = 4;\n    else CodedSize = 5;\n  }\n\n  if (SizeLength > 0 && CodedSize < SizeLength) {\n    // defined size\n    CodedSize = SizeLength;\n  }\n\n  return CodedSize;\n}",
          "includes": [
            "#include \"ebml/EbmlContexts.h\"",
            "#include \"ebml/EbmlDummy.h\"",
            "#include \"ebml/EbmlVoid.h\"",
            "#include \"ebml/EbmlStream.h\"",
            "#include \"ebml/EbmlMaster.h\"",
            "#include \"ebml/EbmlElement.h\"",
            "#include <cstring>",
            "#include <cassert>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlDummy.h\"\n#include \"ebml/EbmlVoid.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include \"ebml/EbmlElement.h\"\n#include <cstring>\n#include <cassert>\n\nSTART_LIBEBML_NAMESPACE\n\n/*!\n  \\todo handle more than CodedSize of 5\n*/\nint CodedSizeLength(uint64 Length, unsigned int SizeLength, bool bSizeFinite)\n{\n  unsigned int CodedSize;\n  if (bSizeFinite) {\n    // prepare the head of the size (000...01xxxxxx)\n    // optimal size\n    if (Length < 127) // 2^7 - 1\n      CodedSize = 1;\n    else if (Length < 16383) // 2^14 - 1\n      CodedSize = 2;\n    else if (Length < 2097151L) // 2^21 - 1\n      CodedSize = 3;\n    else if (Length < 268435455L) // 2^28 - 1\n      CodedSize = 4;\n    else CodedSize = 5;\n  } else {\n    if (Length <= 127) // 2^7 - 1\n      CodedSize = 1;\n    else if (Length <= 16383) // 2^14 - 1\n      CodedSize = 2;\n    else if (Length <= 2097151L) // 2^21 - 1\n      CodedSize = 3;\n    else if (Length <= 268435455L) // 2^28 - 1\n      CodedSize = 4;\n    else CodedSize = 5;\n  }\n\n  if (SizeLength > 0 && CodedSize < SizeLength) {\n    // defined size\n    CodedSize = SizeLength;\n  }\n\n  return CodedSize;\n}"
        }
      },
      {
        "call_info": {
          "callee": "EbmlId",
          "args": [
            "FinalHead"
          ],
          "line": 621
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EbmlId",
          "args": [
            "*this"
          ],
          "line": 621
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBML_ID_LENGTH",
          "args": [
            "(const EbmlId&)*this"
          ],
          "line": 620
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlDummy.h\"\n#include \"ebml/EbmlVoid.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include \"ebml/EbmlElement.h\"\n#include <cstring>\n#include <cassert>\n\nEbmlElement {\n  filepos_t EbmlElement::MakeRenderHead(IOCallback & output, bool bKeepPosition)\n  {\n    binary FinalHead[4+8]; // Class D + 64 bits coded size\n    unsigned int FinalHeadSize;\n  \n    FinalHeadSize = EBML_ID_LENGTH((const EbmlId&)*this);\n    EbmlId(*this).Fill(FinalHead);\n  \n    int CodedSize = CodedSizeLength(Size, SizeLength, bSizeIsFinite);\n    CodedValueLength(Size, CodedSize, &FinalHead[FinalHeadSize]);\n    FinalHeadSize += CodedSize;\n  \n    output.writeFully(FinalHead, FinalHeadSize);\n    if (!bKeepPosition) {\n      ElementPosition = output.getFilePointer() - FinalHeadSize;\n      SizePosition = ElementPosition + EBML_ID_LENGTH((const EbmlId&)*this);\n    }\n  \n    return FinalHeadSize;\n  }\n}"
  },
  {
    "function_name": "RenderHead",
    "container": "EbmlElement",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlElement.cpp",
    "lines": "605-613",
    "snippet": "filepos_t EbmlElement::RenderHead(IOCallback & output, bool bForceRender, bool bWithDefault, bool bKeepPosition)\n{\n  if (EBML_ID_LENGTH((const EbmlId&)*this) <= 0 || EBML_ID_LENGTH((const EbmlId&)*this) > 4)\n    return 0;\n\n  UpdateSize(bWithDefault, bForceRender);\n\n  return MakeRenderHead(output, bKeepPosition);\n}",
    "includes": [
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlDummy.h\"",
      "#include \"ebml/EbmlVoid.h\"",
      "#include \"ebml/EbmlStream.h\"",
      "#include \"ebml/EbmlMaster.h\"",
      "#include \"ebml/EbmlElement.h\"",
      "#include <cstring>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "MakeRenderHead",
          "args": [
            "output",
            "bKeepPosition"
          ],
          "line": 612
        },
        "resolved": true,
        "details": {
          "function_name": "MakeRenderHead",
          "container": "EbmlElement",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlElement.cpp",
          "lines": "615-634",
          "snippet": "filepos_t EbmlElement::MakeRenderHead(IOCallback & output, bool bKeepPosition)\n{\n  binary FinalHead[4+8]; // Class D + 64 bits coded size\n  unsigned int FinalHeadSize;\n\n  FinalHeadSize = EBML_ID_LENGTH((const EbmlId&)*this);\n  EbmlId(*this).Fill(FinalHead);\n\n  int CodedSize = CodedSizeLength(Size, SizeLength, bSizeIsFinite);\n  CodedValueLength(Size, CodedSize, &FinalHead[FinalHeadSize]);\n  FinalHeadSize += CodedSize;\n\n  output.writeFully(FinalHead, FinalHeadSize);\n  if (!bKeepPosition) {\n    ElementPosition = output.getFilePointer() - FinalHeadSize;\n    SizePosition = ElementPosition + EBML_ID_LENGTH((const EbmlId&)*this);\n  }\n\n  return FinalHeadSize;\n}",
          "includes": [
            "#include \"ebml/EbmlContexts.h\"",
            "#include \"ebml/EbmlDummy.h\"",
            "#include \"ebml/EbmlVoid.h\"",
            "#include \"ebml/EbmlStream.h\"",
            "#include \"ebml/EbmlMaster.h\"",
            "#include \"ebml/EbmlElement.h\"",
            "#include <cstring>",
            "#include <cassert>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlDummy.h\"\n#include \"ebml/EbmlVoid.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include \"ebml/EbmlElement.h\"\n#include <cstring>\n#include <cassert>\n\nEbmlElement {\n  filepos_t EbmlElement::MakeRenderHead(IOCallback & output, bool bKeepPosition)\n  {\n    binary FinalHead[4+8]; // Class D + 64 bits coded size\n    unsigned int FinalHeadSize;\n  \n    FinalHeadSize = EBML_ID_LENGTH((const EbmlId&)*this);\n    EbmlId(*this).Fill(FinalHead);\n  \n    int CodedSize = CodedSizeLength(Size, SizeLength, bSizeIsFinite);\n    CodedValueLength(Size, CodedSize, &FinalHead[FinalHeadSize]);\n    FinalHeadSize += CodedSize;\n  \n    output.writeFully(FinalHead, FinalHeadSize);\n    if (!bKeepPosition) {\n      ElementPosition = output.getFilePointer() - FinalHeadSize;\n      SizePosition = ElementPosition + EBML_ID_LENGTH((const EbmlId&)*this);\n    }\n  \n    return FinalHeadSize;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "UpdateSize",
          "args": [
            "bWithDefault",
            "bForceRender"
          ],
          "line": 610
        },
        "resolved": true,
        "details": {
          "function_name": "UpdateSize",
          "container": "EbmlMaster",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlMaster.cpp",
          "lines": "130-159",
          "snippet": "uint64 EbmlMaster::UpdateSize(bool bWithDefault, bool bForceRender)\n{\n  SetSize_(0);\n\n  if (!IsFiniteSize())\n    return (0-1);\n\n  if (!bForceRender) {\n    assert(CheckMandatory());\n    }\n\n  size_t Index;\n\n  for (Index = 0; Index < ElementList.size(); Index++) {\n    if (!bWithDefault && (ElementList[Index])->IsDefaultValue())\n      continue;\n    (ElementList[Index])->UpdateSize(bWithDefault, bForceRender);\n    uint64 SizeToAdd = (ElementList[Index])->ElementSize(bWithDefault);\n#if defined(LIBEBML_DEBUG)\n    if (static_cast<int64>(SizeToAdd) == (0-1))\n      return (0-1);\n#endif // LIBEBML_DEBUG\n    SetSize_(GetSize() + SizeToAdd);\n  }\n  if (bChecksumUsed) {\n    SetSize_(GetSize() + Checksum.ElementSize());\n  }\n\n  return GetSize();\n}",
          "includes": [
            "#include \"ebml/MemIOCallback.h\"",
            "#include \"ebml/EbmlContexts.h\"",
            "#include \"ebml/EbmlStream.h\"",
            "#include \"ebml/EbmlMaster.h\"",
            "#include <algorithm>",
            "#include <cassert>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/MemIOCallback.h\"\n#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include <algorithm>\n#include <cassert>\n\nEbmlMaster {\n  uint64 EbmlMaster::UpdateSize(bool bWithDefault, bool bForceRender)\n  {\n    SetSize_(0);\n  \n    if (!IsFiniteSize())\n      return (0-1);\n  \n    if (!bForceRender) {\n      assert(CheckMandatory());\n      }\n  \n    size_t Index;\n  \n    for (Index = 0; Index < ElementList.size(); Index++) {\n      if (!bWithDefault && (ElementList[Index])->IsDefaultValue())\n        continue;\n      (ElementList[Index])->UpdateSize(bWithDefault, bForceRender);\n      uint64 SizeToAdd = (ElementList[Index])->ElementSize(bWithDefault);\n  #if defined(LIBEBML_DEBUG)\n      if (static_cast<int64>(SizeToAdd) == (0-1))\n        return (0-1);\n  #endif // LIBEBML_DEBUG\n      SetSize_(GetSize() + SizeToAdd);\n    }\n    if (bChecksumUsed) {\n      SetSize_(GetSize() + Checksum.ElementSize());\n    }\n  \n    return GetSize();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EBML_ID_LENGTH",
          "args": [
            "(const EbmlId&)*this"
          ],
          "line": 607
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBML_ID_LENGTH",
          "args": [
            "(const EbmlId&)*this"
          ],
          "line": 607
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlDummy.h\"\n#include \"ebml/EbmlVoid.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include \"ebml/EbmlElement.h\"\n#include <cstring>\n#include <cassert>\n\nEbmlElement {\n  filepos_t EbmlElement::RenderHead(IOCallback & output, bool bForceRender, bool bWithDefault, bool bKeepPosition)\n  {\n    if (EBML_ID_LENGTH((const EbmlId&)*this) <= 0 || EBML_ID_LENGTH((const EbmlId&)*this) > 4)\n      return 0;\n  \n    UpdateSize(bWithDefault, bForceRender);\n  \n    return MakeRenderHead(output, bKeepPosition);\n  }\n}"
  },
  {
    "function_name": "Render",
    "container": "EbmlElement",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlElement.cpp",
    "lines": "580-598",
    "snippet": "filepos_t EbmlElement::Render(IOCallback & output, bool bWithDefault, bool bKeepPosition, bool bForceRender)\n{\n  assert(bValueIsSet || (bWithDefault && DefaultISset())); // an element is been rendered without a value set !!!\n  // it may be a mandatory element without a default value\n  if (!bWithDefault && IsDefaultValue()) {\n    return 0;\n  }\n#if defined(LIBEBML_DEBUG)\n  uint64 SupposedSize = UpdateSize(bWithDefault, bForceRender);\n#endif // LIBEBML_DEBUG\n  filepos_t result = RenderHead(output, bForceRender, bWithDefault, bKeepPosition);\n  uint64 WrittenSize = RenderData(output, bForceRender, bWithDefault);\n#if defined(LIBEBML_DEBUG)\n  if (static_cast<int64>(SupposedSize) != (0-1))\n    assert(WrittenSize == SupposedSize);\n#endif // LIBEBML_DEBUG\n  result += WrittenSize;\n  return result;\n}",
    "includes": [
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlDummy.h\"",
      "#include \"ebml/EbmlVoid.h\"",
      "#include \"ebml/EbmlStream.h\"",
      "#include \"ebml/EbmlMaster.h\"",
      "#include \"ebml/EbmlElement.h\"",
      "#include <cstring>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "WrittenSize == SupposedSize"
          ],
          "line": 594
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<int64>",
          "args": [
            "SupposedSize"
          ],
          "line": 593
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RenderData",
          "args": [
            "output",
            "bForceRender",
            "bWithDefault"
          ],
          "line": 591
        },
        "resolved": true,
        "details": {
          "function_name": "RenderData",
          "container": "EbmlMaster",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlMaster.cpp",
          "lines": "90-119",
          "snippet": "filepos_t EbmlMaster::RenderData(IOCallback & output, bool bForceRender, bool bWithDefault)\n{\n  filepos_t Result = 0;\n  size_t Index;\n\n  if (!bForceRender) {\n    assert(CheckMandatory());\n  }\n\n  if (!bChecksumUsed) { // old school\n    for (Index = 0; Index < ElementList.size(); Index++) {\n      if (!bWithDefault && (ElementList[Index])->IsDefaultValue())\n        continue;\n      Result += (ElementList[Index])->Render(output, bWithDefault, false ,bForceRender);\n    }\n  } else { // new school\n    MemIOCallback TmpBuf(GetSize() - 6);\n    for (Index = 0; Index < ElementList.size(); Index++) {\n      if (!bWithDefault && (ElementList[Index])->IsDefaultValue())\n        continue;\n      (ElementList[Index])->Render(TmpBuf, bWithDefault, false ,bForceRender);\n    }\n    Checksum.FillCRC32(TmpBuf.GetDataBuffer(), TmpBuf.GetDataBufferSize());\n    Result += Checksum.Render(output, true, false ,bForceRender);\n    output.writeFully(TmpBuf.GetDataBuffer(), TmpBuf.GetDataBufferSize());\n    Result += TmpBuf.GetDataBufferSize();\n  }\n\n  return Result;\n}",
          "includes": [
            "#include \"ebml/MemIOCallback.h\"",
            "#include \"ebml/EbmlContexts.h\"",
            "#include \"ebml/EbmlStream.h\"",
            "#include \"ebml/EbmlMaster.h\"",
            "#include <algorithm>",
            "#include <cassert>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/MemIOCallback.h\"\n#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include <algorithm>\n#include <cassert>\n\nEbmlMaster {\n  filepos_t EbmlMaster::RenderData(IOCallback & output, bool bForceRender, bool bWithDefault)\n  {\n    filepos_t Result = 0;\n    size_t Index;\n  \n    if (!bForceRender) {\n      assert(CheckMandatory());\n    }\n  \n    if (!bChecksumUsed) { // old school\n      for (Index = 0; Index < ElementList.size(); Index++) {\n        if (!bWithDefault && (ElementList[Index])->IsDefaultValue())\n          continue;\n        Result += (ElementList[Index])->Render(output, bWithDefault, false ,bForceRender);\n      }\n    } else { // new school\n      MemIOCallback TmpBuf(GetSize() - 6);\n      for (Index = 0; Index < ElementList.size(); Index++) {\n        if (!bWithDefault && (ElementList[Index])->IsDefaultValue())\n          continue;\n        (ElementList[Index])->Render(TmpBuf, bWithDefault, false ,bForceRender);\n      }\n      Checksum.FillCRC32(TmpBuf.GetDataBuffer(), TmpBuf.GetDataBufferSize());\n      Result += Checksum.Render(output, true, false ,bForceRender);\n      output.writeFully(TmpBuf.GetDataBuffer(), TmpBuf.GetDataBufferSize());\n      Result += TmpBuf.GetDataBufferSize();\n    }\n  \n    return Result;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "RenderHead",
          "args": [
            "output",
            "bForceRender",
            "bWithDefault",
            "bKeepPosition"
          ],
          "line": 590
        },
        "resolved": true,
        "details": {
          "function_name": "RenderHead",
          "container": "EbmlElement",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlElement.cpp",
          "lines": "605-613",
          "snippet": "filepos_t EbmlElement::RenderHead(IOCallback & output, bool bForceRender, bool bWithDefault, bool bKeepPosition)\n{\n  if (EBML_ID_LENGTH((const EbmlId&)*this) <= 0 || EBML_ID_LENGTH((const EbmlId&)*this) > 4)\n    return 0;\n\n  UpdateSize(bWithDefault, bForceRender);\n\n  return MakeRenderHead(output, bKeepPosition);\n}",
          "includes": [
            "#include \"ebml/EbmlContexts.h\"",
            "#include \"ebml/EbmlDummy.h\"",
            "#include \"ebml/EbmlVoid.h\"",
            "#include \"ebml/EbmlStream.h\"",
            "#include \"ebml/EbmlMaster.h\"",
            "#include \"ebml/EbmlElement.h\"",
            "#include <cstring>",
            "#include <cassert>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlDummy.h\"\n#include \"ebml/EbmlVoid.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include \"ebml/EbmlElement.h\"\n#include <cstring>\n#include <cassert>\n\nEbmlElement {\n  filepos_t EbmlElement::RenderHead(IOCallback & output, bool bForceRender, bool bWithDefault, bool bKeepPosition)\n  {\n    if (EBML_ID_LENGTH((const EbmlId&)*this) <= 0 || EBML_ID_LENGTH((const EbmlId&)*this) > 4)\n      return 0;\n  \n    UpdateSize(bWithDefault, bForceRender);\n  \n    return MakeRenderHead(output, bKeepPosition);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "UpdateSize",
          "args": [
            "bWithDefault",
            "bForceRender"
          ],
          "line": 588
        },
        "resolved": true,
        "details": {
          "function_name": "UpdateSize",
          "container": "EbmlMaster",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlMaster.cpp",
          "lines": "130-159",
          "snippet": "uint64 EbmlMaster::UpdateSize(bool bWithDefault, bool bForceRender)\n{\n  SetSize_(0);\n\n  if (!IsFiniteSize())\n    return (0-1);\n\n  if (!bForceRender) {\n    assert(CheckMandatory());\n    }\n\n  size_t Index;\n\n  for (Index = 0; Index < ElementList.size(); Index++) {\n    if (!bWithDefault && (ElementList[Index])->IsDefaultValue())\n      continue;\n    (ElementList[Index])->UpdateSize(bWithDefault, bForceRender);\n    uint64 SizeToAdd = (ElementList[Index])->ElementSize(bWithDefault);\n#if defined(LIBEBML_DEBUG)\n    if (static_cast<int64>(SizeToAdd) == (0-1))\n      return (0-1);\n#endif // LIBEBML_DEBUG\n    SetSize_(GetSize() + SizeToAdd);\n  }\n  if (bChecksumUsed) {\n    SetSize_(GetSize() + Checksum.ElementSize());\n  }\n\n  return GetSize();\n}",
          "includes": [
            "#include \"ebml/MemIOCallback.h\"",
            "#include \"ebml/EbmlContexts.h\"",
            "#include \"ebml/EbmlStream.h\"",
            "#include \"ebml/EbmlMaster.h\"",
            "#include <algorithm>",
            "#include <cassert>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/MemIOCallback.h\"\n#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include <algorithm>\n#include <cassert>\n\nEbmlMaster {\n  uint64 EbmlMaster::UpdateSize(bool bWithDefault, bool bForceRender)\n  {\n    SetSize_(0);\n  \n    if (!IsFiniteSize())\n      return (0-1);\n  \n    if (!bForceRender) {\n      assert(CheckMandatory());\n      }\n  \n    size_t Index;\n  \n    for (Index = 0; Index < ElementList.size(); Index++) {\n      if (!bWithDefault && (ElementList[Index])->IsDefaultValue())\n        continue;\n      (ElementList[Index])->UpdateSize(bWithDefault, bForceRender);\n      uint64 SizeToAdd = (ElementList[Index])->ElementSize(bWithDefault);\n  #if defined(LIBEBML_DEBUG)\n      if (static_cast<int64>(SizeToAdd) == (0-1))\n        return (0-1);\n  #endif // LIBEBML_DEBUG\n      SetSize_(GetSize() + SizeToAdd);\n    }\n    if (bChecksumUsed) {\n      SetSize_(GetSize() + Checksum.ElementSize());\n    }\n  \n    return GetSize();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IsDefaultValue",
          "args": [],
          "line": 584
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "bValueIsSet || (bWithDefault && DefaultISset())"
          ],
          "line": 582
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DefaultISset",
          "args": [],
          "line": 582
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlDummy.h\"\n#include \"ebml/EbmlVoid.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include \"ebml/EbmlElement.h\"\n#include <cstring>\n#include <cassert>\n\nEbmlElement {\n  filepos_t EbmlElement::Render(IOCallback & output, bool bWithDefault, bool bKeepPosition, bool bForceRender)\n  {\n    assert(bValueIsSet || (bWithDefault && DefaultISset())); // an element is been rendered without a value set !!!\n    // it may be a mandatory element without a default value\n    if (!bWithDefault && IsDefaultValue()) {\n      return 0;\n    }\n  #if defined(LIBEBML_DEBUG)\n    uint64 SupposedSize = UpdateSize(bWithDefault, bForceRender);\n  #endif // LIBEBML_DEBUG\n    filepos_t result = RenderHead(output, bForceRender, bWithDefault, bKeepPosition);\n    uint64 WrittenSize = RenderData(output, bForceRender, bWithDefault);\n  #if defined(LIBEBML_DEBUG)\n    if (static_cast<int64>(SupposedSize) != (0-1))\n      assert(WrittenSize == SupposedSize);\n  #endif // LIBEBML_DEBUG\n    result += WrittenSize;\n    return result;\n  }\n}"
  },
  {
    "function_name": "~EbmlElement",
    "container": "EbmlElement",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlElement.cpp",
    "lines": "250-253",
    "snippet": "EbmlElement::~EbmlElement()\n{\n  assert(!bLocked);\n}",
    "includes": [
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlDummy.h\"",
      "#include \"ebml/EbmlVoid.h\"",
      "#include \"ebml/EbmlStream.h\"",
      "#include \"ebml/EbmlMaster.h\"",
      "#include \"ebml/EbmlElement.h\"",
      "#include <cstring>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "!bLocked"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlDummy.h\"\n#include \"ebml/EbmlVoid.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include \"ebml/EbmlElement.h\"\n#include <cstring>\n#include <cassert>\n\nEbmlElement {\n  EbmlElement::~EbmlElement()\n  {\n    assert(!bLocked);\n  }\n}"
  },
  {
    "function_name": "EbmlElement",
    "container": "EbmlElement",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlElement.cpp",
    "lines": "237-248",
    "snippet": "EbmlElement::EbmlElement(const EbmlElement & ElementToClone)\n  :Size(ElementToClone.Size)\n  ,DefaultSize(ElementToClone.DefaultSize)\n  ,SizeLength(ElementToClone.SizeLength)\n  ,bSizeIsFinite(ElementToClone.bSizeIsFinite)\n  ,ElementPosition(ElementToClone.ElementPosition)\n  ,SizePosition(ElementToClone.SizePosition)\n  ,bValueIsSet(ElementToClone.bValueIsSet)\n  ,DefaultIsSet(ElementToClone.DefaultIsSet)\n  ,bLocked(ElementToClone.bLocked)\n{\n}",
    "includes": [
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlDummy.h\"",
      "#include \"ebml/EbmlVoid.h\"",
      "#include \"ebml/EbmlStream.h\"",
      "#include \"ebml/EbmlMaster.h\"",
      "#include \"ebml/EbmlElement.h\"",
      "#include <cstring>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlDummy.h\"\n#include \"ebml/EbmlVoid.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include \"ebml/EbmlElement.h\"\n#include <cstring>\n#include <cassert>\n\nEbmlElement {\n  EbmlElement::EbmlElement(const EbmlElement & ElementToClone)\n    :Size(ElementToClone.Size)\n    ,DefaultSize(ElementToClone.DefaultSize)\n    ,SizeLength(ElementToClone.SizeLength)\n    ,bSizeIsFinite(ElementToClone.bSizeIsFinite)\n    ,ElementPosition(ElementToClone.ElementPosition)\n    ,SizePosition(ElementToClone.SizePosition)\n    ,bValueIsSet(ElementToClone.bValueIsSet)\n    ,DefaultIsSet(ElementToClone.DefaultIsSet)\n    ,bLocked(ElementToClone.bLocked)\n  {\n  }\n}"
  },
  {
    "function_name": "EbmlElement",
    "container": "EbmlElement",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlElement.cpp",
    "lines": "224-235",
    "snippet": "EbmlElement::EbmlElement(uint64 aDefaultSize, bool bValueSet)\n  :DefaultSize(aDefaultSize)\n  ,SizeLength(0) ///< write optimal size by default\n  ,bSizeIsFinite(true)\n  ,ElementPosition(0)\n  ,SizePosition(0)\n  ,bValueIsSet(bValueSet)\n  ,DefaultIsSet(false)\n  ,bLocked(false)\n{\n  Size = DefaultSize;\n}",
    "includes": [
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlDummy.h\"",
      "#include \"ebml/EbmlVoid.h\"",
      "#include \"ebml/EbmlStream.h\"",
      "#include \"ebml/EbmlMaster.h\"",
      "#include \"ebml/EbmlElement.h\"",
      "#include <cstring>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlDummy.h\"\n#include \"ebml/EbmlVoid.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include \"ebml/EbmlElement.h\"\n#include <cstring>\n#include <cassert>\n\nEbmlElement {\n  EbmlElement::EbmlElement(uint64 aDefaultSize, bool bValueSet)\n    :DefaultSize(aDefaultSize)\n    ,SizeLength(0) ///< write optimal size by default\n    ,bSizeIsFinite(true)\n    ,ElementPosition(0)\n    ,SizePosition(0)\n    ,bValueIsSet(bValueSet)\n    ,DefaultIsSet(false)\n    ,bLocked(false)\n  {\n    Size = DefaultSize;\n  }\n}"
  },
  {
    "function_name": "EbmlCallbacks",
    "container": "EbmlCallbacks",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlElement.cpp",
    "lines": "205-212",
    "snippet": "EbmlCallbacks::EbmlCallbacks(EbmlElement & (*Creator)(), const EbmlId & aGlobalId, const char * aDebugName, const EbmlSemanticContext & aContext)\n  :Create(Creator)\n  ,GlobalId(aGlobalId)\n  ,DebugName(aDebugName)\n  ,Context(aContext)\n{\n  assert((Create!=NULL) || !strcmp(aDebugName, \"DummyElement\"));\n}",
    "includes": [
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlDummy.h\"",
      "#include \"ebml/EbmlVoid.h\"",
      "#include \"ebml/EbmlStream.h\"",
      "#include \"ebml/EbmlMaster.h\"",
      "#include \"ebml/EbmlElement.h\"",
      "#include <cstring>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "(Create!=NULL) || !strcmp(aDebugName, \"DummyElement\")"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "aDebugName",
            "\"DummyElement\""
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlDummy.h\"\n#include \"ebml/EbmlVoid.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include \"ebml/EbmlElement.h\"\n#include <cstring>\n#include <cassert>\n\nEbmlCallbacks {\n  EbmlCallbacks::EbmlCallbacks(EbmlElement & (*Creator)(), const EbmlId & aGlobalId, const char * aDebugName, const EbmlSemanticContext & aContext)\n    :Create(Creator)\n    ,GlobalId(aGlobalId)\n    ,DebugName(aDebugName)\n    ,Context(aContext)\n  {\n    assert((Create!=NULL) || !strcmp(aDebugName, \"DummyElement\"));\n  }\n}"
  },
  {
    "function_name": "ReadCodedSizeSignedValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlElement.cpp",
    "lines": "180-202",
    "snippet": "int64 ReadCodedSizeSignedValue(const binary * InBuffer, uint32 & BufferSize, uint64 & SizeUnknown)\n{\n  int64 Result = ReadCodedSizeValue(InBuffer, BufferSize, SizeUnknown);\n\n  if (BufferSize != 0) {\n    switch (BufferSize) {\n      case 1:\n        Result -= 63;\n        break;\n      case 2:\n        Result -= 8191;\n        break;\n      case 3:\n        Result -= 1048575L;\n        break;\n      case 4:\n        Result -= 134217727L;\n        break;\n    }\n  }\n\n  return Result;\n}",
    "includes": [
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlDummy.h\"",
      "#include \"ebml/EbmlVoid.h\"",
      "#include \"ebml/EbmlStream.h\"",
      "#include \"ebml/EbmlMaster.h\"",
      "#include \"ebml/EbmlElement.h\"",
      "#include <cstring>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ReadCodedSizeValue",
          "args": [
            "InBuffer",
            "BufferSize",
            "SizeUnknown"
          ],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "ReadCodedSizeValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlElement.cpp",
          "lines": "139-178",
          "snippet": "uint64 ReadCodedSizeValue(const binary * InBuffer, uint32 & BufferSize, uint64 & SizeUnknown)\n{\n  binary SizeBitMask = 1 << 7;\n  uint64 Result = 0x7F;\n  unsigned int SizeIdx, PossibleSizeLength = 0;\n  binary PossibleSize[8];\n  memset(PossibleSize, 0, 8);\n\n  SizeUnknown = 0x7F; // the last bit is discarded when computing the size\n  for (SizeIdx = 0; SizeIdx < BufferSize && SizeIdx < 8; SizeIdx++) {\n    if (InBuffer[0] & (SizeBitMask >> SizeIdx)) {\n      // ID found\n      PossibleSizeLength = SizeIdx + 1;\n      SizeBitMask >>= SizeIdx;\n      for (SizeIdx = 0; SizeIdx < PossibleSizeLength; SizeIdx++) {\n        PossibleSize[SizeIdx] = InBuffer[SizeIdx];\n      }\n      for (SizeIdx = 0; SizeIdx < PossibleSizeLength - 1; SizeIdx++) {\n        Result <<= 7;\n        Result |= 0xFF;\n      }\n\n      Result = 0;\n      Result |= PossibleSize[0] & ~SizeBitMask;\n      for (unsigned int i = 1; i<PossibleSizeLength; i++) {\n        Result <<= 8;\n        Result |= PossibleSize[i];\n      }\n\n      BufferSize = PossibleSizeLength;\n\n      return Result;\n    }\n    SizeUnknown <<= 7;\n    SizeUnknown |= 0xFF;\n  }\n\n  BufferSize = 0;\n  return 0;\n}",
          "includes": [
            "#include \"ebml/EbmlContexts.h\"",
            "#include \"ebml/EbmlDummy.h\"",
            "#include \"ebml/EbmlVoid.h\"",
            "#include \"ebml/EbmlStream.h\"",
            "#include \"ebml/EbmlMaster.h\"",
            "#include \"ebml/EbmlElement.h\"",
            "#include <cstring>",
            "#include <cassert>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlDummy.h\"\n#include \"ebml/EbmlVoid.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include \"ebml/EbmlElement.h\"\n#include <cstring>\n#include <cassert>\n\nuint64 ReadCodedSizeValue(const binary * InBuffer, uint32 & BufferSize, uint64 & SizeUnknown)\n{\n  binary SizeBitMask = 1 << 7;\n  uint64 Result = 0x7F;\n  unsigned int SizeIdx, PossibleSizeLength = 0;\n  binary PossibleSize[8];\n  memset(PossibleSize, 0, 8);\n\n  SizeUnknown = 0x7F; // the last bit is discarded when computing the size\n  for (SizeIdx = 0; SizeIdx < BufferSize && SizeIdx < 8; SizeIdx++) {\n    if (InBuffer[0] & (SizeBitMask >> SizeIdx)) {\n      // ID found\n      PossibleSizeLength = SizeIdx + 1;\n      SizeBitMask >>= SizeIdx;\n      for (SizeIdx = 0; SizeIdx < PossibleSizeLength; SizeIdx++) {\n        PossibleSize[SizeIdx] = InBuffer[SizeIdx];\n      }\n      for (SizeIdx = 0; SizeIdx < PossibleSizeLength - 1; SizeIdx++) {\n        Result <<= 7;\n        Result |= 0xFF;\n      }\n\n      Result = 0;\n      Result |= PossibleSize[0] & ~SizeBitMask;\n      for (unsigned int i = 1; i<PossibleSizeLength; i++) {\n        Result <<= 8;\n        Result |= PossibleSize[i];\n      }\n\n      BufferSize = PossibleSizeLength;\n\n      return Result;\n    }\n    SizeUnknown <<= 7;\n    SizeUnknown |= 0xFF;\n  }\n\n  BufferSize = 0;\n  return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlDummy.h\"\n#include \"ebml/EbmlVoid.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include \"ebml/EbmlElement.h\"\n#include <cstring>\n#include <cassert>\n\nint64 ReadCodedSizeSignedValue(const binary * InBuffer, uint32 & BufferSize, uint64 & SizeUnknown)\n{\n  int64 Result = ReadCodedSizeValue(InBuffer, BufferSize, SizeUnknown);\n\n  if (BufferSize != 0) {\n    switch (BufferSize) {\n      case 1:\n        Result -= 63;\n        break;\n      case 2:\n        Result -= 8191;\n        break;\n      case 3:\n        Result -= 1048575L;\n        break;\n      case 4:\n        Result -= 134217727L;\n        break;\n    }\n  }\n\n  return Result;\n}"
  },
  {
    "function_name": "ReadCodedSizeValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlElement.cpp",
    "lines": "139-178",
    "snippet": "uint64 ReadCodedSizeValue(const binary * InBuffer, uint32 & BufferSize, uint64 & SizeUnknown)\n{\n  binary SizeBitMask = 1 << 7;\n  uint64 Result = 0x7F;\n  unsigned int SizeIdx, PossibleSizeLength = 0;\n  binary PossibleSize[8];\n  memset(PossibleSize, 0, 8);\n\n  SizeUnknown = 0x7F; // the last bit is discarded when computing the size\n  for (SizeIdx = 0; SizeIdx < BufferSize && SizeIdx < 8; SizeIdx++) {\n    if (InBuffer[0] & (SizeBitMask >> SizeIdx)) {\n      // ID found\n      PossibleSizeLength = SizeIdx + 1;\n      SizeBitMask >>= SizeIdx;\n      for (SizeIdx = 0; SizeIdx < PossibleSizeLength; SizeIdx++) {\n        PossibleSize[SizeIdx] = InBuffer[SizeIdx];\n      }\n      for (SizeIdx = 0; SizeIdx < PossibleSizeLength - 1; SizeIdx++) {\n        Result <<= 7;\n        Result |= 0xFF;\n      }\n\n      Result = 0;\n      Result |= PossibleSize[0] & ~SizeBitMask;\n      for (unsigned int i = 1; i<PossibleSizeLength; i++) {\n        Result <<= 8;\n        Result |= PossibleSize[i];\n      }\n\n      BufferSize = PossibleSizeLength;\n\n      return Result;\n    }\n    SizeUnknown <<= 7;\n    SizeUnknown |= 0xFF;\n  }\n\n  BufferSize = 0;\n  return 0;\n}",
    "includes": [
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlDummy.h\"",
      "#include \"ebml/EbmlVoid.h\"",
      "#include \"ebml/EbmlStream.h\"",
      "#include \"ebml/EbmlMaster.h\"",
      "#include \"ebml/EbmlElement.h\"",
      "#include <cstring>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "PossibleSize",
            "0",
            "8"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlDummy.h\"\n#include \"ebml/EbmlVoid.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include \"ebml/EbmlElement.h\"\n#include <cstring>\n#include <cassert>\n\nuint64 ReadCodedSizeValue(const binary * InBuffer, uint32 & BufferSize, uint64 & SizeUnknown)\n{\n  binary SizeBitMask = 1 << 7;\n  uint64 Result = 0x7F;\n  unsigned int SizeIdx, PossibleSizeLength = 0;\n  binary PossibleSize[8];\n  memset(PossibleSize, 0, 8);\n\n  SizeUnknown = 0x7F; // the last bit is discarded when computing the size\n  for (SizeIdx = 0; SizeIdx < BufferSize && SizeIdx < 8; SizeIdx++) {\n    if (InBuffer[0] & (SizeBitMask >> SizeIdx)) {\n      // ID found\n      PossibleSizeLength = SizeIdx + 1;\n      SizeBitMask >>= SizeIdx;\n      for (SizeIdx = 0; SizeIdx < PossibleSizeLength; SizeIdx++) {\n        PossibleSize[SizeIdx] = InBuffer[SizeIdx];\n      }\n      for (SizeIdx = 0; SizeIdx < PossibleSizeLength - 1; SizeIdx++) {\n        Result <<= 7;\n        Result |= 0xFF;\n      }\n\n      Result = 0;\n      Result |= PossibleSize[0] & ~SizeBitMask;\n      for (unsigned int i = 1; i<PossibleSizeLength; i++) {\n        Result <<= 8;\n        Result |= PossibleSize[i];\n      }\n\n      BufferSize = PossibleSizeLength;\n\n      return Result;\n    }\n    SizeUnknown <<= 7;\n    SizeUnknown |= 0xFF;\n  }\n\n  BufferSize = 0;\n  return 0;\n}"
  },
  {
    "function_name": "CodedValueLengthSigned",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlElement.cpp",
    "lines": "125-137",
    "snippet": "int CodedValueLengthSigned(int64 Length, int CodedSize, binary * OutBuffer)\n{\n  if (Length > -64 && Length < 64) // 2^6\n    Length += 63;\n  else if (Length > -8192 && Length < 8192) // 2^13\n    Length += 8191;\n  else if (Length > -1048576L && Length < 1048576L) // 2^20\n    Length += 1048575L;\n  else if (Length > -134217728L && Length < 134217728L) // 2^27\n    Length += 134217727L;\n\n  return CodedValueLength(Length, CodedSize, OutBuffer);\n}",
    "includes": [
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlDummy.h\"",
      "#include \"ebml/EbmlVoid.h\"",
      "#include \"ebml/EbmlStream.h\"",
      "#include \"ebml/EbmlMaster.h\"",
      "#include \"ebml/EbmlElement.h\"",
      "#include <cstring>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CodedValueLength",
          "args": [
            "Length",
            "CodedSize",
            "OutBuffer"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "CodedValueLengthSigned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlElement.cpp",
          "lines": "125-137",
          "snippet": "int CodedValueLengthSigned(int64 Length, int CodedSize, binary * OutBuffer)\n{\n  if (Length > -64 && Length < 64) // 2^6\n    Length += 63;\n  else if (Length > -8192 && Length < 8192) // 2^13\n    Length += 8191;\n  else if (Length > -1048576L && Length < 1048576L) // 2^20\n    Length += 1048575L;\n  else if (Length > -134217728L && Length < 134217728L) // 2^27\n    Length += 134217727L;\n\n  return CodedValueLength(Length, CodedSize, OutBuffer);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlDummy.h\"\n#include \"ebml/EbmlVoid.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include \"ebml/EbmlElement.h\"\n#include <cstring>\n#include <cassert>\n\nint CodedValueLengthSigned(int64 Length, int CodedSize, binary * OutBuffer)\n{\n  if (Length > -64 && Length < 64) // 2^6\n    Length += 63;\n  else if (Length > -8192 && Length < 8192) // 2^13\n    Length += 8191;\n  else if (Length > -1048576L && Length < 1048576L) // 2^20\n    Length += 1048575L;\n  else if (Length > -134217728L && Length < 134217728L) // 2^27\n    Length += 134217727L;\n\n  return CodedValueLength(Length, CodedSize, OutBuffer);\n}"
  },
  {
    "function_name": "CodedValueLength",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlElement.cpp",
    "lines": "111-123",
    "snippet": "int CodedValueLength(uint64 Length, int CodedSize, binary * OutBuffer)\n{\n  int _SizeMask = 0xFF;\n  OutBuffer[0] = 1 << (8 - CodedSize);\n  for (int i=1; i<CodedSize; i++) {\n    OutBuffer[CodedSize-i] = Length & 0xFF;\n    Length >>= 8;\n    _SizeMask >>= 1;\n  }\n  // first one use a OR with the \"EBML size head\"\n  OutBuffer[0] |= Length & 0xFF & _SizeMask;\n  return CodedSize;\n}",
    "includes": [
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlDummy.h\"",
      "#include \"ebml/EbmlVoid.h\"",
      "#include \"ebml/EbmlStream.h\"",
      "#include \"ebml/EbmlMaster.h\"",
      "#include \"ebml/EbmlElement.h\"",
      "#include <cstring>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlDummy.h\"\n#include \"ebml/EbmlVoid.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include \"ebml/EbmlElement.h\"\n#include <cstring>\n#include <cassert>\n\nint CodedValueLength(uint64 Length, int CodedSize, binary * OutBuffer)\n{\n  int _SizeMask = 0xFF;\n  OutBuffer[0] = 1 << (8 - CodedSize);\n  for (int i=1; i<CodedSize; i++) {\n    OutBuffer[CodedSize-i] = Length & 0xFF;\n    Length >>= 8;\n    _SizeMask >>= 1;\n  }\n  // first one use a OR with the \"EBML size head\"\n  OutBuffer[0] |= Length & 0xFF & _SizeMask;\n  return CodedSize;\n}"
  },
  {
    "function_name": "CodedSizeLengthSigned",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlElement.cpp",
    "lines": "88-109",
    "snippet": "int CodedSizeLengthSigned(int64 Length, unsigned int SizeLength)\n{\n  unsigned int CodedSize;\n  // prepare the head of the size (000...01xxxxxx)\n  // optimal size\n  if (Length > -64 && Length < 64) // 2^6\n    CodedSize = 1;\n  else if (Length > -8192 && Length < 8192) // 2^13\n    CodedSize = 2;\n  else if (Length > -1048576L && Length < 1048576L) // 2^20\n    CodedSize = 3;\n  else if (Length > -134217728L && Length < 134217728L) // 2^27\n    CodedSize = 4;\n  else CodedSize = 5;\n\n  if (SizeLength > 0 && CodedSize < SizeLength) {\n    // defined size\n    CodedSize = SizeLength;\n  }\n\n  return CodedSize;\n}",
    "includes": [
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlDummy.h\"",
      "#include \"ebml/EbmlVoid.h\"",
      "#include \"ebml/EbmlStream.h\"",
      "#include \"ebml/EbmlMaster.h\"",
      "#include \"ebml/EbmlElement.h\"",
      "#include <cstring>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlDummy.h\"\n#include \"ebml/EbmlVoid.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include \"ebml/EbmlElement.h\"\n#include <cstring>\n#include <cassert>\n\nint CodedSizeLengthSigned(int64 Length, unsigned int SizeLength)\n{\n  unsigned int CodedSize;\n  // prepare the head of the size (000...01xxxxxx)\n  // optimal size\n  if (Length > -64 && Length < 64) // 2^6\n    CodedSize = 1;\n  else if (Length > -8192 && Length < 8192) // 2^13\n    CodedSize = 2;\n  else if (Length > -1048576L && Length < 1048576L) // 2^20\n    CodedSize = 3;\n  else if (Length > -134217728L && Length < 134217728L) // 2^27\n    CodedSize = 4;\n  else CodedSize = 5;\n\n  if (SizeLength > 0 && CodedSize < SizeLength) {\n    // defined size\n    CodedSize = SizeLength;\n  }\n\n  return CodedSize;\n}"
  },
  {
    "function_name": "CodedSizeLength",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8791/repo/src/EbmlElement.cpp",
    "lines": "45-83",
    "snippet": "START_LIBEBML_NAMESPACE\n\n/*!\n  \\todo handle more than CodedSize of 5\n*/\nint CodedSizeLength(uint64 Length, unsigned int SizeLength, bool bSizeFinite)\n{\n  unsigned int CodedSize;\n  if (bSizeFinite) {\n    // prepare the head of the size (000...01xxxxxx)\n    // optimal size\n    if (Length < 127) // 2^7 - 1\n      CodedSize = 1;\n    else if (Length < 16383) // 2^14 - 1\n      CodedSize = 2;\n    else if (Length < 2097151L) // 2^21 - 1\n      CodedSize = 3;\n    else if (Length < 268435455L) // 2^28 - 1\n      CodedSize = 4;\n    else CodedSize = 5;\n  } else {\n    if (Length <= 127) // 2^7 - 1\n      CodedSize = 1;\n    else if (Length <= 16383) // 2^14 - 1\n      CodedSize = 2;\n    else if (Length <= 2097151L) // 2^21 - 1\n      CodedSize = 3;\n    else if (Length <= 268435455L) // 2^28 - 1\n      CodedSize = 4;\n    else CodedSize = 5;\n  }\n\n  if (SizeLength > 0 && CodedSize < SizeLength) {\n    // defined size\n    CodedSize = SizeLength;\n  }\n\n  return CodedSize;\n}",
    "includes": [
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlDummy.h\"",
      "#include \"ebml/EbmlVoid.h\"",
      "#include \"ebml/EbmlStream.h\"",
      "#include \"ebml/EbmlMaster.h\"",
      "#include \"ebml/EbmlElement.h\"",
      "#include <cstring>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlDummy.h\"\n#include \"ebml/EbmlVoid.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include \"ebml/EbmlElement.h\"\n#include <cstring>\n#include <cassert>\n\nSTART_LIBEBML_NAMESPACE\n\n/*!\n  \\todo handle more than CodedSize of 5\n*/\nint CodedSizeLength(uint64 Length, unsigned int SizeLength, bool bSizeFinite)\n{\n  unsigned int CodedSize;\n  if (bSizeFinite) {\n    // prepare the head of the size (000...01xxxxxx)\n    // optimal size\n    if (Length < 127) // 2^7 - 1\n      CodedSize = 1;\n    else if (Length < 16383) // 2^14 - 1\n      CodedSize = 2;\n    else if (Length < 2097151L) // 2^21 - 1\n      CodedSize = 3;\n    else if (Length < 268435455L) // 2^28 - 1\n      CodedSize = 4;\n    else CodedSize = 5;\n  } else {\n    if (Length <= 127) // 2^7 - 1\n      CodedSize = 1;\n    else if (Length <= 16383) // 2^14 - 1\n      CodedSize = 2;\n    else if (Length <= 2097151L) // 2^21 - 1\n      CodedSize = 3;\n    else if (Length <= 268435455L) // 2^28 - 1\n      CodedSize = 4;\n    else CodedSize = 5;\n  }\n\n  if (SizeLength > 0 && CodedSize < SizeLength) {\n    // defined size\n    CodedSize = SizeLength;\n  }\n\n  return CodedSize;\n}"
  }
]