[
  {
    "function_name": "get_program_invocation",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "1182-1193",
    "snippet": "std::string get_program_invocation(const std::string &program_name)\n{\n\tconst std::string real_program_name(program_name\n#ifdef DEBUG\n\t\t+ \"-debug\"\n#endif\n#ifdef _WIN32\n\t\t+ \".exe\"\n#endif\n\t);\n\treturn (path(game_config::wesnoth_program_dir) / real_program_name).string();\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 1192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path",
          "args": [
            "game_config::wesnoth_program_dir"
          ],
          "line": 1192
        },
        "resolved": true,
        "details": {
          "function_name": "get_independent_image_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "1164-1180",
          "snippet": "std::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstd::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstd::string get_program_invocation(const std::string &program_name)\n{\n\tconst std::string real_program_name(program_name\n#ifdef DEBUG\n\t\t+ \"-debug\"\n#endif\n#ifdef _WIN32\n\t\t+ \".exe\"\n#endif\n\t);\n\treturn (path(game_config::wesnoth_program_dir) / real_program_name).string();\n}"
  },
  {
    "function_name": "get_independent_image_path",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "1164-1180",
    "snippet": "std::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "full_path.string",
          "args": [],
          "line": 1179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "partial.string",
          "args": [],
          "line": 1177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "partial.empty",
          "args": [],
          "line": 1176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "subtract_path",
          "args": [
            "full_path",
            "game_config::path"
          ],
          "line": 1175
        },
        "resolved": true,
        "details": {
          "function_name": "subtract_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "1130-1147",
          "snippet": "static path subtract_path(const path &full, const path &prefix)\n{\n\tpath::iterator fi = full.begin()\n\t             , fe = full.end()\n\t             , pi = prefix.begin()\n\t             , pe = prefix.end();\n\twhile (fi != fe && pi != pe && *fi == *pi) {\n\t\t++fi;\n\t\t++pi;\n\t}\n\tpath rest;\n\tif (pi == pe)\n\t\twhile (fi != fe) {\n\t\t\trest /= *fi;\n\t\t\t++fi;\n\t\t}\n\treturn rest;\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstatic path subtract_path(const path &full, const path &prefix)\n{\n\tpath::iterator fi = full.begin()\n\t             , fe = full.end()\n\t             , pi = prefix.begin()\n\t             , pe = prefix.end();\n\twhile (fi != fe && pi != pe && *fi == *pi) {\n\t\t++fi;\n\t\t++pi;\n\t}\n\tpath rest;\n\tif (pi == pe)\n\t\twhile (fi != fe) {\n\t\t\trest /= *fi;\n\t\t\t++fi;\n\t\t}\n\treturn rest;\n}"
        }
      },
      {
        "call_info": {
          "callee": "partial.string",
          "args": [],
          "line": 1173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "partial.empty",
          "args": [],
          "line": 1172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_user_data_path",
          "args": [],
          "line": 1171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "full_path.string",
          "args": [],
          "line": 1169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "full_path.empty",
          "args": [],
          "line": 1168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_binary_file_location",
          "args": [
            "\"images\"",
            "filename"
          ],
          "line": 1166
        },
        "resolved": true,
        "details": {
          "function_name": "get_binary_file_location",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "1046-1074",
          "snippet": "std::string get_binary_file_location(const std::string& type, const std::string& filename)\n{\n\t// We define \"..\" as \"remove everything before\" this is needed becasue \n\t// on the one hand allowing \"..\" would be a security risk but \n\t// especialy for terrains the c++ engine puts a hardcoded \"terrain/\" before filename\n\t// and there would be no way to \"escape\" from \"terrain/\" otherwise. This is not the \n\t// best solution but we cannot remove it without another solution (subtypes maybe?).\n\t\n\t// using 'for' instead 'if' to allow putting delcaration and check into the brackets\n\tfor(std::string::size_type pos = filename.rfind(\"../\"); pos != std::string::npos;)\n\t\treturn get_binary_file_location(type, filename.substr(pos + 3));\n\n\tif (!is_legal_file(filename))\n\t\treturn std::string();\n\n\tBOOST_FOREACH(const std::string &bp, get_binary_paths(type))\n\t{\n\t\tpath bpath(bp);\n\t\tbpath /= filename;\n\t\tDBG_FS << \"  checking '\" << bp << \"'\\n\";\n\t\tif (file_exists(bpath)) {\n\t\t\tDBG_FS << \"  found at '\" << bpath.string() << \"'\\n\";\n\t\t\treturn bpath.string();\n\t\t}\n\t}\n\n\tDBG_FS << \"  not found\\n\";\n\treturn std::string();\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [
            "#define DBG_FS LOG_STREAM(debug, log_filesystem)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\n#define DBG_FS LOG_STREAM(debug, log_filesystem)\n\nstd::string get_binary_file_location(const std::string& type, const std::string& filename)\n{\n\t// We define \"..\" as \"remove everything before\" this is needed becasue \n\t// on the one hand allowing \"..\" would be a security risk but \n\t// especialy for terrains the c++ engine puts a hardcoded \"terrain/\" before filename\n\t// and there would be no way to \"escape\" from \"terrain/\" otherwise. This is not the \n\t// best solution but we cannot remove it without another solution (subtypes maybe?).\n\t\n\t// using 'for' instead 'if' to allow putting delcaration and check into the brackets\n\tfor(std::string::size_type pos = filename.rfind(\"../\"); pos != std::string::npos;)\n\t\treturn get_binary_file_location(type, filename.substr(pos + 3));\n\n\tif (!is_legal_file(filename))\n\t\treturn std::string();\n\n\tBOOST_FOREACH(const std::string &bp, get_binary_paths(type))\n\t{\n\t\tpath bpath(bp);\n\t\tbpath /= filename;\n\t\tDBG_FS << \"  checking '\" << bp << \"'\\n\";\n\t\tif (file_exists(bpath)) {\n\t\t\tDBG_FS << \"  found at '\" << bpath.string() << \"'\\n\";\n\t\t\treturn bpath.string();\n\t\t}\n\t}\n\n\tDBG_FS << \"  not found\\n\";\n\treturn std::string();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstd::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}"
  },
  {
    "function_name": "get_short_wml_path",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "1149-1162",
    "snippet": "std::string get_short_wml_path(const std::string &filename)\n{\n\tpath full_path(filename);\n\n\tpath partial = subtract_path(full_path, get_user_data_path() / \"data\");\n\tif (!partial.empty())\n\t\treturn \"~\" + partial.string();\n\n\tpartial = subtract_path(full_path, path(game_config::path) / \"data\");\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn filename;\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "partial.string",
          "args": [],
          "line": 1159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "partial.empty",
          "args": [],
          "line": 1158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "subtract_path",
          "args": [
            "full_path",
            "path(game_config::path) / \"data\""
          ],
          "line": 1157
        },
        "resolved": true,
        "details": {
          "function_name": "subtract_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "1130-1147",
          "snippet": "static path subtract_path(const path &full, const path &prefix)\n{\n\tpath::iterator fi = full.begin()\n\t             , fe = full.end()\n\t             , pi = prefix.begin()\n\t             , pe = prefix.end();\n\twhile (fi != fe && pi != pe && *fi == *pi) {\n\t\t++fi;\n\t\t++pi;\n\t}\n\tpath rest;\n\tif (pi == pe)\n\t\twhile (fi != fe) {\n\t\t\trest /= *fi;\n\t\t\t++fi;\n\t\t}\n\treturn rest;\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstatic path subtract_path(const path &full, const path &prefix)\n{\n\tpath::iterator fi = full.begin()\n\t             , fe = full.end()\n\t             , pi = prefix.begin()\n\t             , pe = prefix.end();\n\twhile (fi != fe && pi != pe && *fi == *pi) {\n\t\t++fi;\n\t\t++pi;\n\t}\n\tpath rest;\n\tif (pi == pe)\n\t\twhile (fi != fe) {\n\t\t\trest /= *fi;\n\t\t\t++fi;\n\t\t}\n\treturn rest;\n}"
        }
      },
      {
        "call_info": {
          "callee": "path",
          "args": [
            "game_config::path"
          ],
          "line": 1157
        },
        "resolved": true,
        "details": {
          "function_name": "get_independent_image_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "1164-1180",
          "snippet": "std::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstd::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}"
        }
      },
      {
        "call_info": {
          "callee": "partial.string",
          "args": [],
          "line": 1155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "partial.empty",
          "args": [],
          "line": 1154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_user_data_path",
          "args": [],
          "line": 1153
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstd::string get_short_wml_path(const std::string &filename)\n{\n\tpath full_path(filename);\n\n\tpath partial = subtract_path(full_path, get_user_data_path() / \"data\");\n\tif (!partial.empty())\n\t\treturn \"~\" + partial.string();\n\n\tpartial = subtract_path(full_path, path(game_config::path) / \"data\");\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn filename;\n}"
  },
  {
    "function_name": "subtract_path",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "1130-1147",
    "snippet": "static path subtract_path(const path &full, const path &prefix)\n{\n\tpath::iterator fi = full.begin()\n\t             , fe = full.end()\n\t             , pi = prefix.begin()\n\t             , pe = prefix.end();\n\twhile (fi != fe && pi != pe && *fi == *pi) {\n\t\t++fi;\n\t\t++pi;\n\t}\n\tpath rest;\n\tif (pi == pe)\n\t\twhile (fi != fe) {\n\t\t\trest /= *fi;\n\t\t\t++fi;\n\t\t}\n\treturn rest;\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "prefix.end",
          "args": [],
          "line": 1135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prefix.begin",
          "args": [],
          "line": 1134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "full.end",
          "args": [],
          "line": 1133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "full.begin",
          "args": [],
          "line": 1132
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstatic path subtract_path(const path &full, const path &prefix)\n{\n\tpath::iterator fi = full.begin()\n\t             , fe = full.end()\n\t             , pi = prefix.begin()\n\t             , pe = prefix.end();\n\twhile (fi != fe && pi != pe && *fi == *pi) {\n\t\t++fi;\n\t\t++pi;\n\t}\n\tpath rest;\n\tif (pi == pe)\n\t\twhile (fi != fe) {\n\t\t\trest /= *fi;\n\t\t\t++fi;\n\t\t}\n\treturn rest;\n}"
  },
  {
    "function_name": "get_wml_location",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "1096-1128",
    "snippet": "std::string get_wml_location(const std::string &filename, const std::string &current_dir)\n{\n\tif (!is_legal_file(filename))\n\t\treturn std::string();\n\n\tassert(game_config::path.empty() == false);\n\n\tpath fpath(filename);\n\tpath result;\n\n\tif (filename[0] == '~')\n\t{\n\t\tresult /= get_user_data_path() / \"data\" / filename.substr(1);\n\t\tDBG_FS << \"  trying '\" << result.string() << \"'\\n\";\n\t} else if (*fpath.begin() == \".\") {\n\t\tif (!current_dir.empty()) {\n\t\t\tresult /= path(current_dir);\n\t\t} else {\n\t\t\tresult /= path(game_config::path) / \"data\";\n\t\t}\n\n\t\tresult /= filename;\n\t} else if (!game_config::path.empty()) {\n\t\tresult /= path(game_config::path) / \"data\" / filename;\n\t}\n\tif (result.empty() || !file_exists(result)) {\n\t\tDBG_FS << \"  not found\\n\";\n\t\tresult.clear();\n\t} else\n\t\tDBG_FS << \"  found: '\" << result.string() << \"'\\n\";\n\n\treturn result.string();\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [
      "#define DBG_FS LOG_STREAM(debug, log_filesystem)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "result.string",
          "args": [],
          "line": 1127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result.string",
          "args": [],
          "line": 1125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result.clear",
          "args": [],
          "line": 1123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file_exists",
          "args": [
            "result"
          ],
          "line": 1121
        },
        "resolved": true,
        "details": {
          "function_name": "file_exists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "831-834",
          "snippet": "bool file_exists(const std::string& name)\n{\n\treturn file_exists(path(name));\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nbool file_exists(const std::string& name)\n{\n\treturn file_exists(path(name));\n}"
        }
      },
      {
        "call_info": {
          "callee": "result.empty",
          "args": [],
          "line": 1121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path",
          "args": [
            "game_config::path"
          ],
          "line": 1119
        },
        "resolved": true,
        "details": {
          "function_name": "get_independent_image_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "1164-1180",
          "snippet": "std::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstd::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}"
        }
      },
      {
        "call_info": {
          "callee": "game_config::path.empty",
          "args": [],
          "line": 1118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_dir.empty",
          "args": [],
          "line": 1111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fpath.begin",
          "args": [],
          "line": 1110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result.string",
          "args": [],
          "line": 1109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filename.substr",
          "args": [
            "1"
          ],
          "line": 1108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_user_data_path",
          "args": [],
          "line": 1108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "game_config::path.empty() == false"
          ],
          "line": 1101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "game_config::path.empty",
          "args": [],
          "line": 1101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [],
          "line": 1099
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_legal_file",
          "args": [
            "filename"
          ],
          "line": 1098
        },
        "resolved": true,
        "details": {
          "function_name": "is_legal_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "989-1004",
          "snippet": "static bool is_legal_file(const std::string &filename)\n{\n\tDBG_FS << \"Looking for '\" << filename << \"'.\\n\";\n\n\tif (filename.empty()) {\n\t\tLOG_FS << \"  invalid filename\\n\";\n\t\treturn false;\n\t}\n\n\tif (filename.find(\"..\") != std::string::npos) {\n\t\tERR_FS << \"Illegal path '\" << filename << \"' (\\\"..\\\" not allowed).\\n\";\n\t\treturn false;\n\t}\n\n\treturn true;\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [
            "#define ERR_FS LOG_STREAM(err, log_filesystem)",
            "#define LOG_FS LOG_STREAM(info, log_filesystem)",
            "#define DBG_FS LOG_STREAM(debug, log_filesystem)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\n#define ERR_FS LOG_STREAM(err, log_filesystem)\n#define LOG_FS LOG_STREAM(info, log_filesystem)\n#define DBG_FS LOG_STREAM(debug, log_filesystem)\n\nstatic bool is_legal_file(const std::string &filename)\n{\n\tDBG_FS << \"Looking for '\" << filename << \"'.\\n\";\n\n\tif (filename.empty()) {\n\t\tLOG_FS << \"  invalid filename\\n\";\n\t\treturn false;\n\t}\n\n\tif (filename.find(\"..\") != std::string::npos) {\n\t\tERR_FS << \"Illegal path '\" << filename << \"' (\\\"..\\\" not allowed).\\n\";\n\t\treturn false;\n\t}\n\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\n#define DBG_FS LOG_STREAM(debug, log_filesystem)\n\nstd::string get_wml_location(const std::string &filename, const std::string &current_dir)\n{\n\tif (!is_legal_file(filename))\n\t\treturn std::string();\n\n\tassert(game_config::path.empty() == false);\n\n\tpath fpath(filename);\n\tpath result;\n\n\tif (filename[0] == '~')\n\t{\n\t\tresult /= get_user_data_path() / \"data\" / filename.substr(1);\n\t\tDBG_FS << \"  trying '\" << result.string() << \"'\\n\";\n\t} else if (*fpath.begin() == \".\") {\n\t\tif (!current_dir.empty()) {\n\t\t\tresult /= path(current_dir);\n\t\t} else {\n\t\t\tresult /= path(game_config::path) / \"data\";\n\t\t}\n\n\t\tresult /= filename;\n\t} else if (!game_config::path.empty()) {\n\t\tresult /= path(game_config::path) / \"data\" / filename;\n\t}\n\tif (result.empty() || !file_exists(result)) {\n\t\tDBG_FS << \"  not found\\n\";\n\t\tresult.clear();\n\t} else\n\t\tDBG_FS << \"  found: '\" << result.string() << \"'\\n\";\n\n\treturn result.string();\n}"
  },
  {
    "function_name": "get_binary_dir_location",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "1076-1094",
    "snippet": "std::string get_binary_dir_location(const std::string &type, const std::string &filename)\n{\n\tif (!is_legal_file(filename))\n\t\treturn std::string();\n\n\tBOOST_FOREACH(const std::string &bp, get_binary_paths(type))\n\t{\n\t\tpath bpath(bp);\n\t\tbpath /= filename;\n\t\tDBG_FS << \"  checking '\" << bp << \"'\\n\";\n\t\tif (is_directory_internal(bpath)) {\n\t\t\tDBG_FS << \"  found at '\" << bpath.string() << \"'\\n\";\n\t\t\treturn bpath.string();\n\t\t}\n\t}\n\n\tDBG_FS << \"  not found\\n\";\n\treturn std::string();\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [
      "#define DBG_FS LOG_STREAM(debug, log_filesystem)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::string",
          "args": [],
          "line": 1093
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bpath.string",
          "args": [],
          "line": 1088
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bpath.string",
          "args": [],
          "line": 1087
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_directory_internal",
          "args": [
            "bpath"
          ],
          "line": 1086
        },
        "resolved": true,
        "details": {
          "function_name": "is_directory_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "216-224",
          "snippet": "static bool is_directory_internal(const path &fpath)\n{\n\terror_code ec;\n\tbool is_dir = bfs::is_directory(fpath, ec);\n\tif (error_except_not_found(ec)) {\n\t\tLOG_FS << \"Failed to check if \" << fpath.string() << \" is a directory: \" << ec.message() << '\\n';\n\t}\n\treturn is_dir;\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [
            "#define LOG_FS LOG_STREAM(info, log_filesystem)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\n#define LOG_FS LOG_STREAM(info, log_filesystem)\n\nstatic bool is_directory_internal(const path &fpath)\n{\n\terror_code ec;\n\tbool is_dir = bfs::is_directory(fpath, ec);\n\tif (error_except_not_found(ec)) {\n\t\tLOG_FS << \"Failed to check if \" << fpath.string() << \" is a directory: \" << ec.message() << '\\n';\n\t}\n\treturn is_dir;\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [],
          "line": 1079
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_legal_file",
          "args": [
            "filename"
          ],
          "line": 1078
        },
        "resolved": true,
        "details": {
          "function_name": "is_legal_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "989-1004",
          "snippet": "static bool is_legal_file(const std::string &filename)\n{\n\tDBG_FS << \"Looking for '\" << filename << \"'.\\n\";\n\n\tif (filename.empty()) {\n\t\tLOG_FS << \"  invalid filename\\n\";\n\t\treturn false;\n\t}\n\n\tif (filename.find(\"..\") != std::string::npos) {\n\t\tERR_FS << \"Illegal path '\" << filename << \"' (\\\"..\\\" not allowed).\\n\";\n\t\treturn false;\n\t}\n\n\treturn true;\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [
            "#define ERR_FS LOG_STREAM(err, log_filesystem)",
            "#define LOG_FS LOG_STREAM(info, log_filesystem)",
            "#define DBG_FS LOG_STREAM(debug, log_filesystem)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\n#define ERR_FS LOG_STREAM(err, log_filesystem)\n#define LOG_FS LOG_STREAM(info, log_filesystem)\n#define DBG_FS LOG_STREAM(debug, log_filesystem)\n\nstatic bool is_legal_file(const std::string &filename)\n{\n\tDBG_FS << \"Looking for '\" << filename << \"'.\\n\";\n\n\tif (filename.empty()) {\n\t\tLOG_FS << \"  invalid filename\\n\";\n\t\treturn false;\n\t}\n\n\tif (filename.find(\"..\") != std::string::npos) {\n\t\tERR_FS << \"Illegal path '\" << filename << \"' (\\\"..\\\" not allowed).\\n\";\n\t\treturn false;\n\t}\n\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\n#define DBG_FS LOG_STREAM(debug, log_filesystem)\n\nstd::string get_binary_dir_location(const std::string &type, const std::string &filename)\n{\n\tif (!is_legal_file(filename))\n\t\treturn std::string();\n\n\tBOOST_FOREACH(const std::string &bp, get_binary_paths(type))\n\t{\n\t\tpath bpath(bp);\n\t\tbpath /= filename;\n\t\tDBG_FS << \"  checking '\" << bp << \"'\\n\";\n\t\tif (is_directory_internal(bpath)) {\n\t\t\tDBG_FS << \"  found at '\" << bpath.string() << \"'\\n\";\n\t\t\treturn bpath.string();\n\t\t}\n\t}\n\n\tDBG_FS << \"  not found\\n\";\n\treturn std::string();\n}"
  },
  {
    "function_name": "get_binary_file_location",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "1046-1074",
    "snippet": "std::string get_binary_file_location(const std::string& type, const std::string& filename)\n{\n\t// We define \"..\" as \"remove everything before\" this is needed becasue \n\t// on the one hand allowing \"..\" would be a security risk but \n\t// especialy for terrains the c++ engine puts a hardcoded \"terrain/\" before filename\n\t// and there would be no way to \"escape\" from \"terrain/\" otherwise. This is not the \n\t// best solution but we cannot remove it without another solution (subtypes maybe?).\n\t\n\t// using 'for' instead 'if' to allow putting delcaration and check into the brackets\n\tfor(std::string::size_type pos = filename.rfind(\"../\"); pos != std::string::npos;)\n\t\treturn get_binary_file_location(type, filename.substr(pos + 3));\n\n\tif (!is_legal_file(filename))\n\t\treturn std::string();\n\n\tBOOST_FOREACH(const std::string &bp, get_binary_paths(type))\n\t{\n\t\tpath bpath(bp);\n\t\tbpath /= filename;\n\t\tDBG_FS << \"  checking '\" << bp << \"'\\n\";\n\t\tif (file_exists(bpath)) {\n\t\t\tDBG_FS << \"  found at '\" << bpath.string() << \"'\\n\";\n\t\t\treturn bpath.string();\n\t\t}\n\t}\n\n\tDBG_FS << \"  not found\\n\";\n\treturn std::string();\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [
      "#define DBG_FS LOG_STREAM(debug, log_filesystem)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::string",
          "args": [],
          "line": 1073
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bpath.string",
          "args": [],
          "line": 1068
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bpath.string",
          "args": [],
          "line": 1067
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file_exists",
          "args": [
            "bpath"
          ],
          "line": 1066
        },
        "resolved": true,
        "details": {
          "function_name": "file_exists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "831-834",
          "snippet": "bool file_exists(const std::string& name)\n{\n\treturn file_exists(path(name));\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nbool file_exists(const std::string& name)\n{\n\treturn file_exists(path(name));\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [],
          "line": 1059
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_legal_file",
          "args": [
            "filename"
          ],
          "line": 1058
        },
        "resolved": true,
        "details": {
          "function_name": "is_legal_file",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "989-1004",
          "snippet": "static bool is_legal_file(const std::string &filename)\n{\n\tDBG_FS << \"Looking for '\" << filename << \"'.\\n\";\n\n\tif (filename.empty()) {\n\t\tLOG_FS << \"  invalid filename\\n\";\n\t\treturn false;\n\t}\n\n\tif (filename.find(\"..\") != std::string::npos) {\n\t\tERR_FS << \"Illegal path '\" << filename << \"' (\\\"..\\\" not allowed).\\n\";\n\t\treturn false;\n\t}\n\n\treturn true;\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [
            "#define ERR_FS LOG_STREAM(err, log_filesystem)",
            "#define LOG_FS LOG_STREAM(info, log_filesystem)",
            "#define DBG_FS LOG_STREAM(debug, log_filesystem)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\n#define ERR_FS LOG_STREAM(err, log_filesystem)\n#define LOG_FS LOG_STREAM(info, log_filesystem)\n#define DBG_FS LOG_STREAM(debug, log_filesystem)\n\nstatic bool is_legal_file(const std::string &filename)\n{\n\tDBG_FS << \"Looking for '\" << filename << \"'.\\n\";\n\n\tif (filename.empty()) {\n\t\tLOG_FS << \"  invalid filename\\n\";\n\t\treturn false;\n\t}\n\n\tif (filename.find(\"..\") != std::string::npos) {\n\t\tERR_FS << \"Illegal path '\" << filename << \"' (\\\"..\\\" not allowed).\\n\";\n\t\treturn false;\n\t}\n\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_binary_file_location",
          "args": [
            "type",
            "filename.substr(pos + 3)"
          ],
          "line": 1056
        },
        "resolved": true,
        "details": {
          "function_name": "get_binary_file_location",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "1046-1074",
          "snippet": "std::string get_binary_file_location(const std::string& type, const std::string& filename)\n{\n\t// We define \"..\" as \"remove everything before\" this is needed becasue \n\t// on the one hand allowing \"..\" would be a security risk but \n\t// especialy for terrains the c++ engine puts a hardcoded \"terrain/\" before filename\n\t// and there would be no way to \"escape\" from \"terrain/\" otherwise. This is not the \n\t// best solution but we cannot remove it without another solution (subtypes maybe?).\n\t\n\t// using 'for' instead 'if' to allow putting delcaration and check into the brackets\n\tfor(std::string::size_type pos = filename.rfind(\"../\"); pos != std::string::npos;)\n\t\treturn get_binary_file_location(type, filename.substr(pos + 3));\n\n\tif (!is_legal_file(filename))\n\t\treturn std::string();\n\n\tBOOST_FOREACH(const std::string &bp, get_binary_paths(type))\n\t{\n\t\tpath bpath(bp);\n\t\tbpath /= filename;\n\t\tDBG_FS << \"  checking '\" << bp << \"'\\n\";\n\t\tif (file_exists(bpath)) {\n\t\t\tDBG_FS << \"  found at '\" << bpath.string() << \"'\\n\";\n\t\t\treturn bpath.string();\n\t\t}\n\t}\n\n\tDBG_FS << \"  not found\\n\";\n\treturn std::string();\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "filename.substr",
          "args": [
            "pos + 3"
          ],
          "line": 1056
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filename.rfind",
          "args": [
            "\"../\""
          ],
          "line": 1055
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\n#define DBG_FS LOG_STREAM(debug, log_filesystem)\n\nstd::string get_binary_file_location(const std::string& type, const std::string& filename)\n{\n\t// We define \"..\" as \"remove everything before\" this is needed becasue \n\t// on the one hand allowing \"..\" would be a security risk but \n\t// especialy for terrains the c++ engine puts a hardcoded \"terrain/\" before filename\n\t// and there would be no way to \"escape\" from \"terrain/\" otherwise. This is not the \n\t// best solution but we cannot remove it without another solution (subtypes maybe?).\n\t\n\t// using 'for' instead 'if' to allow putting delcaration and check into the brackets\n\tfor(std::string::size_type pos = filename.rfind(\"../\"); pos != std::string::npos;)\n\t\treturn get_binary_file_location(type, filename.substr(pos + 3));\n\n\tif (!is_legal_file(filename))\n\t\treturn std::string();\n\n\tBOOST_FOREACH(const std::string &bp, get_binary_paths(type))\n\t{\n\t\tpath bpath(bp);\n\t\tbpath /= filename;\n\t\tDBG_FS << \"  checking '\" << bp << \"'\\n\";\n\t\tif (file_exists(bpath)) {\n\t\t\tDBG_FS << \"  found at '\" << bpath.string() << \"'\\n\";\n\t\t\treturn bpath.string();\n\t\t}\n\t}\n\n\tDBG_FS << \"  not found\\n\";\n\treturn std::string();\n}"
  },
  {
    "function_name": "is_legal_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "989-1004",
    "snippet": "static bool is_legal_file(const std::string &filename)\n{\n\tDBG_FS << \"Looking for '\" << filename << \"'.\\n\";\n\n\tif (filename.empty()) {\n\t\tLOG_FS << \"  invalid filename\\n\";\n\t\treturn false;\n\t}\n\n\tif (filename.find(\"..\") != std::string::npos) {\n\t\tERR_FS << \"Illegal path '\" << filename << \"' (\\\"..\\\" not allowed).\\n\";\n\t\treturn false;\n\t}\n\n\treturn true;\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [
      "#define ERR_FS LOG_STREAM(err, log_filesystem)",
      "#define LOG_FS LOG_STREAM(info, log_filesystem)",
      "#define DBG_FS LOG_STREAM(debug, log_filesystem)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "filename.find",
          "args": [
            "\"..\""
          ],
          "line": 998
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filename.empty",
          "args": [],
          "line": 993
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\n#define ERR_FS LOG_STREAM(err, log_filesystem)\n#define LOG_FS LOG_STREAM(info, log_filesystem)\n#define DBG_FS LOG_STREAM(debug, log_filesystem)\n\nstatic bool is_legal_file(const std::string &filename)\n{\n\tDBG_FS << \"Looking for '\" << filename << \"'.\\n\";\n\n\tif (filename.empty()) {\n\t\tLOG_FS << \"  invalid filename\\n\";\n\t\treturn false;\n\t}\n\n\tif (filename.find(\"..\") != std::string::npos) {\n\t\tERR_FS << \"Illegal path '\" << filename << \"' (\\\"..\\\" not allowed).\\n\";\n\t\treturn false;\n\t}\n\n\treturn true;\n}"
  },
  {
    "function_name": "clear_binary_paths_cache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "984-987",
    "snippet": "void clear_binary_paths_cache()\n{\n\tbinary_paths_cache.clear();\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "binary_paths_cache.clear",
          "args": [],
          "line": 986
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nvoid clear_binary_paths_cache()\n{\n\tbinary_paths_cache.clear();\n}"
  },
  {
    "function_name": "cleanup",
    "container": "binary_paths_manager",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "974-981",
    "snippet": "void binary_paths_manager::cleanup()\n{\n\tbinary_paths_cache.clear();\n\n\tfor(std::vector<std::string>::const_iterator i = paths_.begin(); i != paths_.end(); ++i) {\n\t\tbinary_paths.erase(*i);\n\t}\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "binary_paths.erase",
          "args": [
            "*i"
          ],
          "line": 979
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "paths_.end",
          "args": [],
          "line": 978
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "paths_.begin",
          "args": [],
          "line": 978
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "binary_paths_cache.clear",
          "args": [],
          "line": 976
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nbinary_paths_manager {\n  void binary_paths_manager::cleanup()\n  {\n  \tbinary_paths_cache.clear();\n  \n  \tfor(std::vector<std::string>::const_iterator i = paths_.begin(); i != paths_.end(); ++i) {\n  \t\tbinary_paths.erase(*i);\n  \t}\n  }\n}"
  },
  {
    "function_name": "set_paths",
    "container": "binary_paths_manager",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "954-972",
    "snippet": "void binary_paths_manager::set_paths(const config& cfg)\n{\n\tcleanup();\n\tinit_binary_paths();\n\n\tBOOST_FOREACH(const config &bp, cfg.child_range(\"binary_path\"))\n\t{\n\t\tstd::string path = bp[\"path\"].str();\n\t\tif (path.find(\"..\") != std::string::npos) {\n\t\t\tERR_FS << \"Invalid binary path '\" << path << \"'\\n\";\n\t\t\tcontinue;\n\t\t}\n\t\tif (!path.empty() && path[path.size()-1] != '/') path += \"/\";\n\t\tif(binary_paths.count(path) == 0) {\n\t\t\tbinary_paths.insert(path);\n\t\t\tpaths_.push_back(path);\n\t\t}\n\t}\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [
      "#define ERR_FS LOG_STREAM(err, log_filesystem)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "paths_.push_back",
          "args": [
            "path"
          ],
          "line": 969
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "binary_paths.insert",
          "args": [
            "path"
          ],
          "line": 968
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "binary_paths.count",
          "args": [
            "path"
          ],
          "line": 967
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path.size",
          "args": [],
          "line": 966
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path.empty",
          "args": [],
          "line": 966
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path.find",
          "args": [
            "\"..\""
          ],
          "line": 962
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bp[\"path\"].str",
          "args": [],
          "line": 961
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_binary_paths",
          "args": [],
          "line": 957
        },
        "resolved": true,
        "details": {
          "function_name": "init_binary_paths",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "934-939",
          "snippet": "static void init_binary_paths()\n{\n\tif(binary_paths.empty()) {\n\t\tbinary_paths.insert(\"\");\n\t}\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstatic void init_binary_paths()\n{\n\tif(binary_paths.empty()) {\n\t\tbinary_paths.insert(\"\");\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "cleanup",
          "args": [],
          "line": 956
        },
        "resolved": true,
        "details": {
          "function_name": "cleanup",
          "container": "binary_paths_manager",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "974-981",
          "snippet": "void binary_paths_manager::cleanup()\n{\n\tbinary_paths_cache.clear();\n\n\tfor(std::vector<std::string>::const_iterator i = paths_.begin(); i != paths_.end(); ++i) {\n\t\tbinary_paths.erase(*i);\n\t}\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nbinary_paths_manager {\n  void binary_paths_manager::cleanup()\n  {\n  \tbinary_paths_cache.clear();\n  \n  \tfor(std::vector<std::string>::const_iterator i = paths_.begin(); i != paths_.end(); ++i) {\n  \t\tbinary_paths.erase(*i);\n  \t}\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\n#define ERR_FS LOG_STREAM(err, log_filesystem)\n\nbinary_paths_manager {\n  void binary_paths_manager::set_paths(const config& cfg)\n  {\n  \tcleanup();\n  \tinit_binary_paths();\n  \n  \tBOOST_FOREACH(const config &bp, cfg.child_range(\"binary_path\"))\n  \t{\n  \t\tstd::string path = bp[\"path\"].str();\n  \t\tif (path.find(\"..\") != std::string::npos) {\n  \t\t\tERR_FS << \"Invalid binary path '\" << path << \"'\\n\";\n  \t\t\tcontinue;\n  \t\t}\n  \t\tif (!path.empty() && path[path.size()-1] != '/') path += \"/\";\n  \t\tif(binary_paths.count(path) == 0) {\n  \t\t\tbinary_paths.insert(path);\n  \t\t\tpaths_.push_back(path);\n  \t\t}\n  \t}\n  }\n}"
  },
  {
    "function_name": "~binary_paths_manager",
    "container": "binary_paths_manager",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "949-952",
    "snippet": "binary_paths_manager::~binary_paths_manager()\n{\n\tcleanup();\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cleanup",
          "args": [],
          "line": 951
        },
        "resolved": true,
        "details": {
          "function_name": "cleanup",
          "container": "binary_paths_manager",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "974-981",
          "snippet": "void binary_paths_manager::cleanup()\n{\n\tbinary_paths_cache.clear();\n\n\tfor(std::vector<std::string>::const_iterator i = paths_.begin(); i != paths_.end(); ++i) {\n\t\tbinary_paths.erase(*i);\n\t}\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nbinary_paths_manager {\n  void binary_paths_manager::cleanup()\n  {\n  \tbinary_paths_cache.clear();\n  \n  \tfor(std::vector<std::string>::const_iterator i = paths_.begin(); i != paths_.end(); ++i) {\n  \t\tbinary_paths.erase(*i);\n  \t}\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nbinary_paths_manager {\n  binary_paths_manager::~binary_paths_manager()\n  {\n  \tcleanup();\n  }\n}"
  },
  {
    "function_name": "binary_paths_manager",
    "container": "binary_paths_manager",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "944-947",
    "snippet": "binary_paths_manager::binary_paths_manager(const config& cfg) : paths_()\n{\n\tset_paths(cfg);\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_paths",
          "args": [
            "cfg"
          ],
          "line": 946
        },
        "resolved": true,
        "details": {
          "function_name": "set_paths",
          "container": "binary_paths_manager",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "954-972",
          "snippet": "void binary_paths_manager::set_paths(const config& cfg)\n{\n\tcleanup();\n\tinit_binary_paths();\n\n\tBOOST_FOREACH(const config &bp, cfg.child_range(\"binary_path\"))\n\t{\n\t\tstd::string path = bp[\"path\"].str();\n\t\tif (path.find(\"..\") != std::string::npos) {\n\t\t\tERR_FS << \"Invalid binary path '\" << path << \"'\\n\";\n\t\t\tcontinue;\n\t\t}\n\t\tif (!path.empty() && path[path.size()-1] != '/') path += \"/\";\n\t\tif(binary_paths.count(path) == 0) {\n\t\t\tbinary_paths.insert(path);\n\t\t\tpaths_.push_back(path);\n\t\t}\n\t}\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [
            "#define ERR_FS LOG_STREAM(err, log_filesystem)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\n#define ERR_FS LOG_STREAM(err, log_filesystem)\n\nbinary_paths_manager {\n  void binary_paths_manager::set_paths(const config& cfg)\n  {\n  \tcleanup();\n  \tinit_binary_paths();\n  \n  \tBOOST_FOREACH(const config &bp, cfg.child_range(\"binary_path\"))\n  \t{\n  \t\tstd::string path = bp[\"path\"].str();\n  \t\tif (path.find(\"..\") != std::string::npos) {\n  \t\t\tERR_FS << \"Invalid binary path '\" << path << \"'\\n\";\n  \t\t\tcontinue;\n  \t\t}\n  \t\tif (!path.empty() && path[path.size()-1] != '/') path += \"/\";\n  \t\tif(binary_paths.count(path) == 0) {\n  \t\t\tbinary_paths.insert(path);\n  \t\t\tpaths_.push_back(path);\n  \t\t}\n  \t}\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nbinary_paths_manager {\n  binary_paths_manager::binary_paths_manager(const config& cfg) : paths_()\n  {\n  \tset_paths(cfg);\n  }\n}"
  },
  {
    "function_name": "binary_paths_manager",
    "container": "binary_paths_manager",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "941-942",
    "snippet": "binary_paths_manager::binary_paths_manager() : paths_()\n{}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nbinary_paths_manager {\n  binary_paths_manager::binary_paths_manager() : paths_()\n  {}\n}"
  },
  {
    "function_name": "init_binary_paths",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "934-939",
    "snippet": "static void init_binary_paths()\n{\n\tif(binary_paths.empty()) {\n\t\tbinary_paths.insert(\"\");\n\t}\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "binary_paths.insert",
          "args": [
            "\"\""
          ],
          "line": 937
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "binary_paths.empty",
          "args": [],
          "line": 936
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstatic void init_binary_paths()\n{\n\tif(binary_paths.empty()) {\n\t\tbinary_paths.insert(\"\");\n\t}\n}"
  },
  {
    "function_name": "normalize_path",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "904-911",
    "snippet": "std::string normalize_path(const std::string &fpath)\n{\n\tif (fpath.empty()) {\n\t\treturn fpath;\n\t}\n\n\treturn bfs::absolute(fpath).string();\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bfs::absolute",
          "args": [],
          "line": 910
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bfs::absolute",
          "args": [
            "fpath"
          ],
          "line": 910
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fpath.empty",
          "args": [],
          "line": 906
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstd::string normalize_path(const std::string &fpath)\n{\n\tif (fpath.empty()) {\n\t\treturn fpath;\n\t}\n\n\treturn bfs::absolute(fpath).string();\n}"
  },
  {
    "function_name": "is_path_sep",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "898-903",
    "snippet": "bool is_path_sep(char c)\n{\n\tstatic const path sep = path(\"/\").make_preferred();\n\tconst std::string s = std::string(1, c);\n\treturn sep == path(s).make_preferred();\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "path",
          "args": [],
          "line": 902
        },
        "resolved": true,
        "details": {
          "function_name": "clear_binary_paths_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "984-987",
          "snippet": "void clear_binary_paths_cache()\n{\n\tbinary_paths_cache.clear();\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nvoid clear_binary_paths_cache()\n{\n\tbinary_paths_cache.clear();\n}"
        }
      },
      {
        "call_info": {
          "callee": "path",
          "args": [
            "s"
          ],
          "line": 902
        },
        "resolved": true,
        "details": {
          "function_name": "get_independent_image_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "1164-1180",
          "snippet": "std::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstd::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "1",
            "c"
          ],
          "line": 901
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nbool is_path_sep(char c)\n{\n\tstatic const path sep = path(\"/\").make_preferred();\n\tconst std::string s = std::string(1, c);\n\treturn sep == path(s).make_preferred();\n}"
  },
  {
    "function_name": "directory_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "894-897",
    "snippet": "std::string directory_name(const std::string& file)\n{\n\treturn path(file).parent_path().string();\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "path",
          "args": [],
          "line": 896
        },
        "resolved": true,
        "details": {
          "function_name": "clear_binary_paths_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "984-987",
          "snippet": "void clear_binary_paths_cache()\n{\n\tbinary_paths_cache.clear();\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nvoid clear_binary_paths_cache()\n{\n\tbinary_paths_cache.clear();\n}"
        }
      },
      {
        "call_info": {
          "callee": "path",
          "args": [
            "file"
          ],
          "line": 896
        },
        "resolved": true,
        "details": {
          "function_name": "get_independent_image_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "1164-1180",
          "snippet": "std::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstd::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstd::string directory_name(const std::string& file)\n{\n\treturn path(file).parent_path().string();\n}"
  },
  {
    "function_name": "base_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "889-892",
    "snippet": "std::string base_name(const std::string& file)\n{\n\treturn path(file).filename().string();\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "path",
          "args": [],
          "line": 891
        },
        "resolved": true,
        "details": {
          "function_name": "clear_binary_paths_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "984-987",
          "snippet": "void clear_binary_paths_cache()\n{\n\tbinary_paths_cache.clear();\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nvoid clear_binary_paths_cache()\n{\n\tbinary_paths_cache.clear();\n}"
        }
      },
      {
        "call_info": {
          "callee": "path",
          "args": [
            "file"
          ],
          "line": 891
        },
        "resolved": true,
        "details": {
          "function_name": "get_independent_image_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "1164-1180",
          "snippet": "std::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstd::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstd::string base_name(const std::string& file)\n{\n\treturn path(file).filename().string();\n}"
  },
  {
    "function_name": "dir_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "869-887",
    "snippet": "int dir_size(const std::string& pname)\n{\n\tbfs::path p(pname);\n\tuintmax_t size_sum = 0;\n\terror_code ec;\n\tfor ( bfs::recursive_directory_iterator i(p), end; i != end && !ec; ++i ) {\n\t\tif(bfs::is_regular_file(i->path())) {\n\t\t\tsize_sum += bfs::file_size(i->path(), ec);\n\t\t}\n\t}\n\tif (ec) {\n\t\tLOG_FS << \"Failed to read directorysize of \" << pname << \": \" << ec.message() << '\\n';\n\t\treturn -1;\n\t}\n\telse if (size_sum > INT_MAX)\n\t\treturn INT_MAX;\n\telse\n\t\treturn size_sum;\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [
      "#define LOG_FS LOG_STREAM(info, log_filesystem)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ec.message",
          "args": [],
          "line": 880
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bfs::file_size",
          "args": [
            "i->path()",
            "ec"
          ],
          "line": 876
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->path",
          "args": [],
          "line": 876
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bfs::is_regular_file",
          "args": [
            "i->path()"
          ],
          "line": 875
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->path",
          "args": [],
          "line": 875
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\n#define LOG_FS LOG_STREAM(info, log_filesystem)\n\nint dir_size(const std::string& pname)\n{\n\tbfs::path p(pname);\n\tuintmax_t size_sum = 0;\n\terror_code ec;\n\tfor ( bfs::recursive_directory_iterator i(p), end; i != end && !ec; ++i ) {\n\t\tif(bfs::is_regular_file(i->path())) {\n\t\t\tsize_sum += bfs::file_size(i->path(), ec);\n\t\t}\n\t}\n\tif (ec) {\n\t\tLOG_FS << \"Failed to read directorysize of \" << pname << \": \" << ec.message() << '\\n';\n\t\treturn -1;\n\t}\n\telse if (size_sum > INT_MAX)\n\t\treturn INT_MAX;\n\telse\n\t\treturn size_sum;\n}"
  },
  {
    "function_name": "file_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "856-867",
    "snippet": "int file_size(const std::string& fname)\n{\n\terror_code ec;\n\tuintmax_t size = bfs::file_size(path(fname), ec);\n\tif (ec) {\n\t\tLOG_FS << \"Failed to read filesize of \" << fname << \": \" << ec.message() << '\\n';\n\t\treturn -1;\n\t} else if (size > INT_MAX)\n\t\treturn INT_MAX;\n\telse\n\t\treturn size;\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [
      "#define LOG_FS LOG_STREAM(info, log_filesystem)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ec.message",
          "args": [],
          "line": 861
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bfs::file_size",
          "args": [
            "path(fname)",
            "ec"
          ],
          "line": 859
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path",
          "args": [
            "fname"
          ],
          "line": 859
        },
        "resolved": true,
        "details": {
          "function_name": "get_independent_image_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "1164-1180",
          "snippet": "std::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstd::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\n#define LOG_FS LOG_STREAM(info, log_filesystem)\n\nint file_size(const std::string& fname)\n{\n\terror_code ec;\n\tuintmax_t size = bfs::file_size(path(fname), ec);\n\tif (ec) {\n\t\tLOG_FS << \"Failed to read filesize of \" << fname << \": \" << ec.message() << '\\n';\n\t\treturn -1;\n\t} else if (size > INT_MAX)\n\t\treturn INT_MAX;\n\telse\n\t\treturn size;\n}"
  },
  {
    "function_name": "is_bzip2_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "851-854",
    "snippet": "bool is_bzip2_file(const std::string& filename)\n{\n\treturn path(filename).extension() == \".bz2\";\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "path",
          "args": [],
          "line": 853
        },
        "resolved": true,
        "details": {
          "function_name": "clear_binary_paths_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "984-987",
          "snippet": "void clear_binary_paths_cache()\n{\n\tbinary_paths_cache.clear();\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nvoid clear_binary_paths_cache()\n{\n\tbinary_paths_cache.clear();\n}"
        }
      },
      {
        "call_info": {
          "callee": "path",
          "args": [
            "filename"
          ],
          "line": 853
        },
        "resolved": true,
        "details": {
          "function_name": "get_independent_image_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "1164-1180",
          "snippet": "std::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstd::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nbool is_bzip2_file(const std::string& filename)\n{\n\treturn path(filename).extension() == \".bz2\";\n}"
  },
  {
    "function_name": "is_gzip_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "846-849",
    "snippet": "bool is_gzip_file(const std::string& filename)\n{\n\treturn path(filename).extension() == \".gz\";\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "path",
          "args": [],
          "line": 848
        },
        "resolved": true,
        "details": {
          "function_name": "clear_binary_paths_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "984-987",
          "snippet": "void clear_binary_paths_cache()\n{\n\tbinary_paths_cache.clear();\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nvoid clear_binary_paths_cache()\n{\n\tbinary_paths_cache.clear();\n}"
        }
      },
      {
        "call_info": {
          "callee": "path",
          "args": [
            "filename"
          ],
          "line": 848
        },
        "resolved": true,
        "details": {
          "function_name": "get_independent_image_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "1164-1180",
          "snippet": "std::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstd::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nbool is_gzip_file(const std::string& filename)\n{\n\treturn path(filename).extension() == \".gz\";\n}"
  },
  {
    "function_name": "file_modified_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "836-844",
    "snippet": "time_t file_modified_time(const std::string& fname)\n{\n\terror_code ec;\n\tstd::time_t mtime = bfs::last_write_time(path(fname), ec);\n\tif (ec) {\n\t\tLOG_FS << \"Failed to read modification time of \" << fname << \": \" << ec.message() << '\\n';\n\t}\n\treturn mtime;\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [
      "#define LOG_FS LOG_STREAM(info, log_filesystem)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ec.message",
          "args": [],
          "line": 841
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bfs::last_write_time",
          "args": [
            "path(fname)",
            "ec"
          ],
          "line": 839
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path",
          "args": [
            "fname"
          ],
          "line": 839
        },
        "resolved": true,
        "details": {
          "function_name": "get_independent_image_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "1164-1180",
          "snippet": "std::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstd::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\n#define LOG_FS LOG_STREAM(info, log_filesystem)\n\ntime_t file_modified_time(const std::string& fname)\n{\n\terror_code ec;\n\tstd::time_t mtime = bfs::last_write_time(path(fname), ec);\n\tif (ec) {\n\t\tLOG_FS << \"Failed to read modification time of \" << fname << \": \" << ec.message() << '\\n';\n\t}\n\treturn mtime;\n}"
  },
  {
    "function_name": "file_exists",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "831-834",
    "snippet": "bool file_exists(const std::string& name)\n{\n\treturn file_exists(path(name));\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "file_exists",
          "args": [
            "path(name)"
          ],
          "line": 833
        },
        "resolved": true,
        "details": {
          "function_name": "file_exists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "831-834",
          "snippet": "bool file_exists(const std::string& name)\n{\n\treturn file_exists(path(name));\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "path",
          "args": [
            "name"
          ],
          "line": 833
        },
        "resolved": true,
        "details": {
          "function_name": "get_independent_image_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "1164-1180",
          "snippet": "std::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstd::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nbool file_exists(const std::string& name)\n{\n\treturn file_exists(path(name));\n}"
  },
  {
    "function_name": "is_directory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "826-829",
    "snippet": "bool is_directory(const std::string& fname)\n{\n\treturn is_directory_internal(path(fname));\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "is_directory_internal",
          "args": [
            "path(fname)"
          ],
          "line": 828
        },
        "resolved": true,
        "details": {
          "function_name": "is_directory_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "216-224",
          "snippet": "static bool is_directory_internal(const path &fpath)\n{\n\terror_code ec;\n\tbool is_dir = bfs::is_directory(fpath, ec);\n\tif (error_except_not_found(ec)) {\n\t\tLOG_FS << \"Failed to check if \" << fpath.string() << \" is a directory: \" << ec.message() << '\\n';\n\t}\n\treturn is_dir;\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [
            "#define LOG_FS LOG_STREAM(info, log_filesystem)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\n#define LOG_FS LOG_STREAM(info, log_filesystem)\n\nstatic bool is_directory_internal(const path &fpath)\n{\n\terror_code ec;\n\tbool is_dir = bfs::is_directory(fpath, ec);\n\tif (error_except_not_found(ec)) {\n\t\tLOG_FS << \"Failed to check if \" << fpath.string() << \" is a directory: \" << ec.message() << '\\n';\n\t}\n\treturn is_dir;\n}"
        }
      },
      {
        "call_info": {
          "callee": "path",
          "args": [
            "fname"
          ],
          "line": 828
        },
        "resolved": true,
        "details": {
          "function_name": "get_independent_image_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "1164-1180",
          "snippet": "std::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstd::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nbool is_directory(const std::string& fname)\n{\n\treturn is_directory_internal(path(fname));\n}"
  },
  {
    "function_name": "create_directory_if_missing_recursive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "821-824",
    "snippet": "bool create_directory_if_missing_recursive(const std::string& dirname)\n{\n\treturn create_directory_if_missing_recursive(path(dirname));\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "create_directory_if_missing_recursive",
          "args": [
            "path(dirname)"
          ],
          "line": 823
        },
        "resolved": true,
        "details": {
          "function_name": "create_directory_if_missing_recursive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "821-824",
          "snippet": "bool create_directory_if_missing_recursive(const std::string& dirname)\n{\n\treturn create_directory_if_missing_recursive(path(dirname));\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "path",
          "args": [
            "dirname"
          ],
          "line": 823
        },
        "resolved": true,
        "details": {
          "function_name": "get_independent_image_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "1164-1180",
          "snippet": "std::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstd::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nbool create_directory_if_missing_recursive(const std::string& dirname)\n{\n\treturn create_directory_if_missing_recursive(path(dirname));\n}"
  },
  {
    "function_name": "create_directory_if_missing",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "817-820",
    "snippet": "bool create_directory_if_missing(const std::string& dirname)\n{\n\treturn create_directory_if_missing(path(dirname));\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "create_directory_if_missing",
          "args": [
            "path(dirname)"
          ],
          "line": 819
        },
        "resolved": true,
        "details": {
          "function_name": "create_directory_if_missing_recursive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "821-824",
          "snippet": "bool create_directory_if_missing_recursive(const std::string& dirname)\n{\n\treturn create_directory_if_missing_recursive(path(dirname));\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nbool create_directory_if_missing_recursive(const std::string& dirname)\n{\n\treturn create_directory_if_missing_recursive(path(dirname));\n}"
        }
      },
      {
        "call_info": {
          "callee": "path",
          "args": [
            "dirname"
          ],
          "line": 819
        },
        "resolved": true,
        "details": {
          "function_name": "get_independent_image_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "1164-1180",
          "snippet": "std::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstd::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nbool create_directory_if_missing(const std::string& dirname)\n{\n\treturn create_directory_if_missing(path(dirname));\n}"
  },
  {
    "function_name": "write_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "799-815",
    "snippet": "void write_file(const std::string& fname, const std::string& data)\n{\n\tscoped_ostream os = ostream_file(fname);\n\tos->exceptions(std::ios_base::goodbit);\n\n\tconst size_t block_size = 4096;\n\tchar buf[block_size];\n\n\tfor(size_t i = 0; i < data.size(); i += block_size) {\n\t\tconst size_t bytes = std::min<size_t>(block_size,data.size() - i);\n\t\tstd::copy(data.begin() + i, data.begin() + i + bytes,buf);\n\n\t\tos->write(buf, bytes);\n\t\tif (os->bad())\n\t\t\tthrow io_exception(\"Error writing to file: '\" + fname + \"'\");\n\t}\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "io_exception",
          "args": [
            "\"Error writing to file: '\" + fname + \"'\""
          ],
          "line": 813
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "os->bad",
          "args": [],
          "line": 812
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "os->write",
          "args": [
            "buf",
            "bytes"
          ],
          "line": 811
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::copy",
          "args": [
            "data.begin() + i",
            "data.begin() + i + bytes",
            "buf"
          ],
          "line": 809
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "data.begin",
          "args": [],
          "line": 809
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "data.begin",
          "args": [],
          "line": 809
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::min<size_t>",
          "args": [
            "block_size",
            "data.size() - i"
          ],
          "line": 808
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "data.size",
          "args": [],
          "line": 808
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "data.size",
          "args": [],
          "line": 807
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "os->exceptions",
          "args": [
            "std::ios_base::goodbit"
          ],
          "line": 802
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ostream_file",
          "args": [
            "fname"
          ],
          "line": 801
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nvoid write_file(const std::string& fname, const std::string& data)\n{\n\tscoped_ostream os = ostream_file(fname);\n\tos->exceptions(std::ios_base::goodbit);\n\n\tconst size_t block_size = 4096;\n\tchar buf[block_size];\n\n\tfor(size_t i = 0; i < data.size(); i += block_size) {\n\t\tconst size_t bytes = std::min<size_t>(block_size,data.size() - i);\n\t\tstd::copy(data.begin() + i, data.begin() + i + bytes,buf);\n\n\t\tos->write(buf, bytes);\n\t\tif (os->bad())\n\t\t\tthrow io_exception(\"Error writing to file: '\" + fname + \"'\");\n\t}\n}"
  },
  {
    "function_name": "external_file_string",
    "container": "iostream_path",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "737-740",
    "snippet": "external_string_type external_file_string() const\n\t{\n\t\treturn path_.native();\n\t}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "path_.native",
          "args": [],
          "line": 739
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\niostream_path {\n  external_string_type external_file_string() const\n  \t{\n  \t\treturn path_.native();\n  \t}\n}"
  },
  {
    "function_name": "iostream_path",
    "container": "iostream_path",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "731-735",
    "snippet": "iostream_path(const stringtype& s)\n\t\t: path_(s)\n\t{\n\n\t}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\niostream_path {\n  iostream_path(const stringtype& s)\n  \t\t: path_(s)\n  \t{\n  \n  \t}\n}"
  },
  {
    "function_name": "read_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "718-724",
    "snippet": "std::string read_file(const std::string &fname)\n{\n\tscoped_istream is = istream_file(fname);\n\tstd::stringstream ss;\n\tss << is->rdbuf();\n\treturn ss.str();\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ss.str",
          "args": [],
          "line": 723
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is->rdbuf",
          "args": [],
          "line": 722
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "istream_file",
          "args": [
            "fname"
          ],
          "line": 720
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstd::string read_file(const std::string &fname)\n{\n\tscoped_istream is = istream_file(fname);\n\tstd::stringstream ss;\n\tss << is->rdbuf();\n\treturn ss.str();\n}"
  },
  {
    "function_name": "delete_file",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "708-716",
    "snippet": "bool delete_file(const std::string &filename)\n{\n\terror_code ec;\n\tbool ret = bfs::remove(path(filename), ec);\n\tif (ec) {\n\t\tERR_FS << \"Could not delete file \" << filename << \": \" << ec.message() << '\\n';\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [
      "#define ERR_FS LOG_STREAM(err, log_filesystem)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ec.message",
          "args": [],
          "line": 713
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bfs::remove",
          "args": [
            "path(filename)",
            "ec"
          ],
          "line": 711
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path",
          "args": [
            "filename"
          ],
          "line": 711
        },
        "resolved": true,
        "details": {
          "function_name": "get_independent_image_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "1164-1180",
          "snippet": "std::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstd::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\n#define ERR_FS LOG_STREAM(err, log_filesystem)\n\nbool delete_file(const std::string &filename)\n{\n\terror_code ec;\n\tbool ret = bfs::remove(path(filename), ec);\n\tif (ec) {\n\t\tERR_FS << \"Could not delete file \" << filename << \": \" << ec.message() << '\\n';\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "delete_directory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "670-706",
    "snippet": "bool delete_directory(const std::string& dirname, const bool keep_pbl)\n{\n\tbool ret = true;\n\tstd::vector<std::string> files;\n\tstd::vector<std::string> dirs;\n\terror_code ec;\n\n\tget_files_in_dir(dirname, &files, &dirs, ENTIRE_FILE_PATH, keep_pbl ? SKIP_PBL_FILES : NO_FILTER);\n\n\tif(!files.empty()) {\n\t\tfor(std::vector<std::string>::const_iterator i = files.begin(); i != files.end(); ++i) {\n\t\t\tbfs::remove(path(*i), ec);\n\t\t\tif (ec) {\n\t\t\t\tLOG_FS << \"remove(\" << (*i) << \"): \" << ec.message() << '\\n';\n\t\t\t\tret = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tif(!dirs.empty()) {\n\t\tfor(std::vector<std::string>::const_iterator j = dirs.begin(); j != dirs.end(); ++j) {\n\t\t\t//TODO: this does not preserve any other PBL files\n\t\t\t// filesystem.cpp does this too, so this might be intentional\n\t\t\tif(!delete_directory(*j))\n\t\t\t\tret = false;\n\t\t}\n\t}\n\n\tif (ret) {\n\t\tbfs::remove(path(dirname), ec);\n\t\tif (ec) {\n\t\t\tLOG_FS << \"remove(\" << dirname << \"): \" << ec.message() << '\\n';\n\t\t\tret = false;\n\t\t}\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [
      "#define LOG_FS LOG_STREAM(info, log_filesystem)"
    ],
    "globals_used": [
      "static lg::log_domain log_filesystem(\"filesystem\");"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ec.message",
          "args": [],
          "line": 701
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bfs::remove",
          "args": [
            "path(dirname)",
            "ec"
          ],
          "line": 699
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path",
          "args": [
            "dirname"
          ],
          "line": 699
        },
        "resolved": true,
        "details": {
          "function_name": "get_independent_image_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "1164-1180",
          "snippet": "std::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstd::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}"
        }
      },
      {
        "call_info": {
          "callee": "delete_directory",
          "args": [
            "*j"
          ],
          "line": 693
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dirs.end",
          "args": [],
          "line": 690
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dirs.begin",
          "args": [],
          "line": 690
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dirs.empty",
          "args": [],
          "line": 689
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ec.message",
          "args": [],
          "line": 683
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bfs::remove",
          "args": [
            "path(*i)",
            "ec"
          ],
          "line": 681
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "files.end",
          "args": [],
          "line": 680
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "files.begin",
          "args": [],
          "line": 680
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "files.empty",
          "args": [],
          "line": 679
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_files_in_dir",
          "args": [
            "dirname",
            "&files",
            "&dirs",
            "ENTIRE_FILE_PATH",
            "keep_pbl ? SKIP_PBL_FILES : NO_FILTER"
          ],
          "line": 677
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\n#define LOG_FS LOG_STREAM(info, log_filesystem)\n\nstatic lg::log_domain log_filesystem(\"filesystem\");\n\nbool delete_directory(const std::string& dirname, const bool keep_pbl)\n{\n\tbool ret = true;\n\tstd::vector<std::string> files;\n\tstd::vector<std::string> dirs;\n\terror_code ec;\n\n\tget_files_in_dir(dirname, &files, &dirs, ENTIRE_FILE_PATH, keep_pbl ? SKIP_PBL_FILES : NO_FILTER);\n\n\tif(!files.empty()) {\n\t\tfor(std::vector<std::string>::const_iterator i = files.begin(); i != files.end(); ++i) {\n\t\t\tbfs::remove(path(*i), ec);\n\t\t\tif (ec) {\n\t\t\t\tLOG_FS << \"remove(\" << (*i) << \"): \" << ec.message() << '\\n';\n\t\t\t\tret = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tif(!dirs.empty()) {\n\t\tfor(std::vector<std::string>::const_iterator j = dirs.begin(); j != dirs.end(); ++j) {\n\t\t\t//TODO: this does not preserve any other PBL files\n\t\t\t// filesystem.cpp does this too, so this might be intentional\n\t\t\tif(!delete_directory(*j))\n\t\t\t\tret = false;\n\t\t}\n\t}\n\n\tif (ret) {\n\t\tbfs::remove(path(dirname), ec);\n\t\tif (ec) {\n\t\t\tLOG_FS << \"remove(\" << dirname << \"): \" << ec.message() << '\\n';\n\t\t\tret = false;\n\t\t}\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "make_directory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "661-669",
    "snippet": "bool make_directory(const std::string& dirname)\n{\n\terror_code ec;\n\tbool created = bfs::create_directory(path(dirname), ec);\n\tif (ec) {\n\t\tERR_FS << \"Failed to create directory \" << dirname << \": \" << ec.message() << '\\n';\n\t}\n\treturn created;\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [
      "#define ERR_FS LOG_STREAM(err, log_filesystem)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ec.message",
          "args": [],
          "line": 666
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bfs::create_directory",
          "args": [
            "path(dirname)",
            "ec"
          ],
          "line": 664
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path",
          "args": [
            "dirname"
          ],
          "line": 664
        },
        "resolved": true,
        "details": {
          "function_name": "get_independent_image_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "1164-1180",
          "snippet": "std::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstd::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\n#define ERR_FS LOG_STREAM(err, log_filesystem)\n\nbool make_directory(const std::string& dirname)\n{\n\terror_code ec;\n\tbool created = bfs::create_directory(path(dirname), ec);\n\tif (ec) {\n\t\tERR_FS << \"Failed to create directory \" << dirname << \": \" << ec.message() << '\\n';\n\t}\n\treturn created;\n}"
  },
  {
    "function_name": "get_exe_dir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "645-659",
    "snippet": "std::string get_exe_dir()\n{\n#ifndef _WIN32\n\tpath self_exe(\"/proc/self/exe\");\n\terror_code ec;\n\tpath exe = bfs::read_symlink(self_exe, ec);\n\tif (ec) {\n\t\treturn std::string();\n\t}\n\n\treturn exe.parent_path().string();\n#else\n\treturn get_cwd();\n#endif\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_cwd",
          "args": [],
          "line": 657
        },
        "resolved": true,
        "details": {
          "function_name": "get_cwd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "635-644",
          "snippet": "std::string get_cwd()\n{\n\terror_code ec;\n\tpath cwd = bfs::current_path(ec);\n\tif (ec) {\n\t\tERR_FS << \"Failed to get current directory: \" << ec.message() << '\\n';\n\t\treturn \"\";\n\t}\n\treturn cwd.generic_string();\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [
            "#define ERR_FS LOG_STREAM(err, log_filesystem)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\n#define ERR_FS LOG_STREAM(err, log_filesystem)\n\nstd::string get_cwd()\n{\n\terror_code ec;\n\tpath cwd = bfs::current_path(ec);\n\tif (ec) {\n\t\tERR_FS << \"Failed to get current directory: \" << ec.message() << '\\n';\n\t\treturn \"\";\n\t}\n\treturn cwd.generic_string();\n}"
        }
      },
      {
        "call_info": {
          "callee": "exe.parent_path",
          "args": [],
          "line": 655
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exe.parent_path",
          "args": [],
          "line": 655
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [],
          "line": 652
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bfs::read_symlink",
          "args": [
            "self_exe",
            "ec"
          ],
          "line": 650
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstd::string get_exe_dir()\n{\n#ifndef _WIN32\n\tpath self_exe(\"/proc/self/exe\");\n\terror_code ec;\n\tpath exe = bfs::read_symlink(self_exe, ec);\n\tif (ec) {\n\t\treturn std::string();\n\t}\n\n\treturn exe.parent_path().string();\n#else\n\treturn get_cwd();\n#endif\n}"
  },
  {
    "function_name": "get_cwd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "635-644",
    "snippet": "std::string get_cwd()\n{\n\terror_code ec;\n\tpath cwd = bfs::current_path(ec);\n\tif (ec) {\n\t\tERR_FS << \"Failed to get current directory: \" << ec.message() << '\\n';\n\t\treturn \"\";\n\t}\n\treturn cwd.generic_string();\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [
      "#define ERR_FS LOG_STREAM(err, log_filesystem)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cwd.generic_string",
          "args": [],
          "line": 643
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ec.message",
          "args": [],
          "line": 640
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bfs::current_path",
          "args": [
            "ec"
          ],
          "line": 638
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\n#define ERR_FS LOG_STREAM(err, log_filesystem)\n\nstd::string get_cwd()\n{\n\terror_code ec;\n\tpath cwd = bfs::current_path(ec);\n\tif (ec) {\n\t\tERR_FS << \"Failed to get current directory: \" << ec.message() << '\\n';\n\t\treturn \"\";\n\t}\n\treturn cwd.generic_string();\n}"
  },
  {
    "function_name": "get_cache_dir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "611-633",
    "snippet": "std::string get_cache_dir()\n{\n\tif (cache_dir.empty())\n\t{\n#if defined(_X11) && !defined(PREFERENCES_DIR)\n\t\tchar const *xdg_cache = getenv(\"XDG_CACHE_HOME\");\n\t\tif (!xdg_cache || xdg_cache[0] == '\\0') {\n\t\t\txdg_cache = getenv(\"HOME\");\n\t\t\tif (!xdg_cache) {\n\t\t\t\tcache_dir = get_dir(get_user_data_path() / \"cache\");\n\t\t\t\treturn cache_dir.string();\n\t\t\t}\n\t\t\tcache_dir = xdg_cache;\n\t\t\tcache_dir /= \".cache\";\n\t\t} else cache_dir = xdg_cache;\n\t\tcache_dir /= \"wesnoth\";\n\t\tcreate_directory_if_missing_recursive(cache_dir);\n#else\n\t\tcache_dir = get_dir(get_user_data_path() / \"cache\");\n#endif\n\t}\n\treturn cache_dir.string();\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache_dir.string",
          "args": [],
          "line": 632
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_dir",
          "args": [
            "get_user_data_path() / \"cache\""
          ],
          "line": 629
        },
        "resolved": true,
        "details": {
          "function_name": "get_dir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "421-424",
          "snippet": "std::string get_dir(const std::string &dir)\n{\n\treturn get_dir(path(dir)).string();\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstd::string get_dir(const std::string &dir)\n{\n\treturn get_dir(path(dir)).string();\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_user_data_path",
          "args": [],
          "line": 629
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "create_directory_if_missing_recursive",
          "args": [
            "cache_dir"
          ],
          "line": 627
        },
        "resolved": true,
        "details": {
          "function_name": "create_directory_if_missing_recursive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "821-824",
          "snippet": "bool create_directory_if_missing_recursive(const std::string& dirname)\n{\n\treturn create_directory_if_missing_recursive(path(dirname));\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nbool create_directory_if_missing_recursive(const std::string& dirname)\n{\n\treturn create_directory_if_missing_recursive(path(dirname));\n}"
        }
      },
      {
        "call_info": {
          "callee": "cache_dir.string",
          "args": [],
          "line": 621
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_user_data_path",
          "args": [],
          "line": 620
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"HOME\""
          ],
          "line": 618
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"XDG_CACHE_HOME\""
          ],
          "line": 616
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_dir.empty",
          "args": [],
          "line": 613
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstd::string get_cache_dir()\n{\n\tif (cache_dir.empty())\n\t{\n#if defined(_X11) && !defined(PREFERENCES_DIR)\n\t\tchar const *xdg_cache = getenv(\"XDG_CACHE_HOME\");\n\t\tif (!xdg_cache || xdg_cache[0] == '\\0') {\n\t\t\txdg_cache = getenv(\"HOME\");\n\t\t\tif (!xdg_cache) {\n\t\t\t\tcache_dir = get_dir(get_user_data_path() / \"cache\");\n\t\t\t\treturn cache_dir.string();\n\t\t\t}\n\t\t\tcache_dir = xdg_cache;\n\t\t\tcache_dir /= \".cache\";\n\t\t} else cache_dir = xdg_cache;\n\t\tcache_dir /= \"wesnoth\";\n\t\tcreate_directory_if_missing_recursive(cache_dir);\n#else\n\t\tcache_dir = get_dir(get_user_data_path() / \"cache\");\n#endif\n\t}\n\treturn cache_dir.string();\n}"
  },
  {
    "function_name": "get_user_data_dir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "607-610",
    "snippet": "std::string get_user_data_dir()\n{\n\treturn get_user_data_path().string();\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_user_data_path",
          "args": [],
          "line": 609
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_user_data_path",
          "args": [],
          "line": 609
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstd::string get_user_data_dir()\n{\n\treturn get_user_data_path().string();\n}"
  },
  {
    "function_name": "get_user_config_dir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "584-606",
    "snippet": "std::string get_user_config_dir()\n{\n\tif (user_config_dir.empty())\n\t{\n#if defined(_X11) && !defined(PREFERENCES_DIR)\n\t\tchar const *xdg_config = getenv(\"XDG_CONFIG_HOME\");\n\t\tif (!xdg_config || xdg_config[0] == '\\0') {\n\t\t\txdg_config = getenv(\"HOME\");\n\t\t\tif (!xdg_config) {\n\t\t\t\tuser_config_dir = get_user_data_path();\n\t\t\t\treturn user_config_dir.string();\n\t\t\t}\n\t\t\tuser_config_dir = xdg_config;\n\t\t\tuser_config_dir /= \".config\";\n\t\t} else user_config_dir = xdg_config;\n\t\tuser_config_dir /= \"wesnoth\";\n\t\tset_user_config_path(user_config_dir);\n#else\n\t\tuser_config_dir = get_user_data_path();\n#endif\n\t}\n\treturn user_config_dir.string();\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "user_config_dir.string",
          "args": [],
          "line": 605
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_user_data_path",
          "args": [],
          "line": 602
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_user_config_path",
          "args": [
            "user_config_dir"
          ],
          "line": 600
        },
        "resolved": true,
        "details": {
          "function_name": "set_user_config_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "561-567",
          "snippet": "static void set_user_config_path(path newconfig)\n{\n\tuser_config_dir = newconfig;\n\tif (!create_directory_if_missing_recursive(user_config_dir)) {\n\t\tERR_FS << \"could not open or create user config directory at \" << user_config_dir.string() << '\\n';\n\t}\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [
            "#define ERR_FS LOG_STREAM(err, log_filesystem)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\n#define ERR_FS LOG_STREAM(err, log_filesystem)\n\nstatic void set_user_config_path(path newconfig)\n{\n\tuser_config_dir = newconfig;\n\tif (!create_directory_if_missing_recursive(user_config_dir)) {\n\t\tERR_FS << \"could not open or create user config directory at \" << user_config_dir.string() << '\\n';\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "user_config_dir.string",
          "args": [],
          "line": 594
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_user_data_path",
          "args": [],
          "line": 593
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"HOME\""
          ],
          "line": 591
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"XDG_CONFIG_HOME\""
          ],
          "line": 589
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "user_config_dir.empty",
          "args": [],
          "line": 586
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstd::string get_user_config_dir()\n{\n\tif (user_config_dir.empty())\n\t{\n#if defined(_X11) && !defined(PREFERENCES_DIR)\n\t\tchar const *xdg_config = getenv(\"XDG_CONFIG_HOME\");\n\t\tif (!xdg_config || xdg_config[0] == '\\0') {\n\t\t\txdg_config = getenv(\"HOME\");\n\t\t\tif (!xdg_config) {\n\t\t\t\tuser_config_dir = get_user_data_path();\n\t\t\t\treturn user_config_dir.string();\n\t\t\t}\n\t\t\tuser_config_dir = xdg_config;\n\t\t\tuser_config_dir /= \".config\";\n\t\t} else user_config_dir = xdg_config;\n\t\tuser_config_dir /= \"wesnoth\";\n\t\tset_user_config_path(user_config_dir);\n#else\n\t\tuser_config_dir = get_user_data_path();\n#endif\n\t}\n\treturn user_config_dir.string();\n}"
  },
  {
    "function_name": "set_user_config_dir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "569-572",
    "snippet": "void set_user_config_dir(std::string newconfigdir)\n{\n\tset_user_config_path(newconfigdir);\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_user_config_path",
          "args": [
            "newconfigdir"
          ],
          "line": 571
        },
        "resolved": true,
        "details": {
          "function_name": "set_user_config_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "561-567",
          "snippet": "static void set_user_config_path(path newconfig)\n{\n\tuser_config_dir = newconfig;\n\tif (!create_directory_if_missing_recursive(user_config_dir)) {\n\t\tERR_FS << \"could not open or create user config directory at \" << user_config_dir.string() << '\\n';\n\t}\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [
            "#define ERR_FS LOG_STREAM(err, log_filesystem)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\n#define ERR_FS LOG_STREAM(err, log_filesystem)\n\nstatic void set_user_config_path(path newconfig)\n{\n\tuser_config_dir = newconfig;\n\tif (!create_directory_if_missing_recursive(user_config_dir)) {\n\t\tERR_FS << \"could not open or create user config directory at \" << user_config_dir.string() << '\\n';\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nvoid set_user_config_dir(std::string newconfigdir)\n{\n\tset_user_config_path(newconfigdir);\n}"
  },
  {
    "function_name": "set_user_config_path",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "561-567",
    "snippet": "static void set_user_config_path(path newconfig)\n{\n\tuser_config_dir = newconfig;\n\tif (!create_directory_if_missing_recursive(user_config_dir)) {\n\t\tERR_FS << \"could not open or create user config directory at \" << user_config_dir.string() << '\\n';\n\t}\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [
      "#define ERR_FS LOG_STREAM(err, log_filesystem)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "user_config_dir.string",
          "args": [],
          "line": 565
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "create_directory_if_missing_recursive",
          "args": [
            "user_config_dir"
          ],
          "line": 564
        },
        "resolved": true,
        "details": {
          "function_name": "create_directory_if_missing_recursive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "821-824",
          "snippet": "bool create_directory_if_missing_recursive(const std::string& dirname)\n{\n\treturn create_directory_if_missing_recursive(path(dirname));\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nbool create_directory_if_missing_recursive(const std::string& dirname)\n{\n\treturn create_directory_if_missing_recursive(path(dirname));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\n#define ERR_FS LOG_STREAM(err, log_filesystem)\n\nstatic void set_user_config_path(path newconfig)\n{\n\tuser_config_dir = newconfig;\n\tif (!create_directory_if_missing_recursive(user_config_dir)) {\n\t\tERR_FS << \"could not open or create user config directory at \" << user_config_dir.string() << '\\n';\n\t}\n}"
  },
  {
    "function_name": "set_user_data_dir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "483-559",
    "snippet": "void set_user_data_dir(std::string newprefdir)\n{\n#ifdef _WIN32\n\tif(newprefdir.empty()) {\n\t\tuser_data_dir = path(get_cwd()) / \"userdata\";\n\t} else if (newprefdir.size() > 2 && newprefdir[1] == ':') {\n\t\t//allow absolute path override\n\t\tuser_data_dir = newprefdir;\n\t} else {\n\t\ttypedef BOOL (WINAPI *SHGSFPAddress)(HWND, LPWSTR, int, BOOL);\n\t\tSHGSFPAddress SHGetSpecialFolderPathW;\n\t\tHMODULE module = LoadLibraryA(\"shell32\");\n\t\tSHGetSpecialFolderPathW = reinterpret_cast<SHGSFPAddress>(GetProcAddress(module, \"SHGetSpecialFolderPathW\"));\n\t\tif(SHGetSpecialFolderPathW) {\n\t\t\tLOG_FS << \"Using SHGetSpecialFolderPath to find My Documents\\n\";\n\t\t\twchar_t my_documents_path[MAX_PATH];\n\t\t\tif(SHGetSpecialFolderPathW(NULL, my_documents_path, 5, 1)) {\n\t\t\t\tpath mygames_path = path(my_documents_path) / \"My Games\";\n\t\t\t\tcreate_directory_if_missing(mygames_path);\n\t\t\t\tuser_data_dir = mygames_path / newprefdir;\n\t\t\t} else {\n\t\t\t\tWRN_FS << \"SHGetSpecialFolderPath failed\\n\";\n\t\t\t\tuser_data_dir = path(get_cwd()) / newprefdir;\n\t\t\t}\n\t\t} else {\n\t\t\tLOG_FS << \"Failed to load SHGetSpecialFolderPath function\\n\";\n\t\t\tuser_data_dir = path(get_cwd()) / newprefdir;\n\t\t}\n\t}\n\n#else /*_WIN32*/\n\n#ifdef PREFERENCES_DIR\n\tif (newprefdir.empty()) newprefdir = PREFERENCES_DIR;\n#endif\n\n\tstd::string backupprefdir = \".wesnoth\" + get_version_path_suffix();\n\n#ifdef _X11\n\tconst char *home_str = getenv(\"HOME\");\n\n\tif (newprefdir.empty()) {\n\t\tchar const *xdg_data = getenv(\"XDG_DATA_HOME\");\n\t\tif (!xdg_data || xdg_data[0] == '\\0') {\n\t\t\tif (!home_str) {\n\t\t\t\tnewprefdir = backupprefdir;\n\t\t\t\tgoto other;\n\t\t\t}\n\t\t\tuser_data_dir = home_str;\n\t\t\tuser_data_dir /= \".local/share\";\n\t\t} else user_data_dir = xdg_data;\n\t\tuser_data_dir /= \"wesnoth\";\n\t\tuser_data_dir /= get_version_path_suffix();\n\t} else {\n\t\tother:\n\t\tpath home = home_str ? home_str : \".\";\n\n\t\tif (newprefdir[0] == '/')\n\t\t\tuser_data_dir = newprefdir;\n\t\telse\n\t\t\tuser_data_dir = home / newprefdir;\n\t}\n#else\n\tif (newprefdir.empty()) newprefdir = backupprefdir;\n\n\tconst char* home_str = getenv(\"HOME\");\n\tpath home = home_str ? home_str : \".\";\n\n\tif (newprefdir[0] == '/')\n\t\tuser_data_dir = newprefdir;\n\telse\n\t\tuser_data_dir = home / newprefdir;\n#endif\n\n#endif /*_WIN32*/\n\tsetup_user_data_dir();\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [
      "#define WRN_FS LOG_STREAM(warn, log_filesystem)",
      "#define LOG_FS LOG_STREAM(info, log_filesystem)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setup_user_data_dir",
          "args": [],
          "line": 558
        },
        "resolved": true,
        "details": {
          "function_name": "setup_user_data_dir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "466-482",
          "snippet": "static void setup_user_data_dir()\n{\n\tif (!create_directory_if_missing_recursive(user_data_dir)) {\n\t\tERR_FS << \"could not open or create user data directory at \" << user_data_dir.string() << '\\n';\n\t\treturn;\n\t}\n\t// TODO: this may not print the error message if the directory exists but we don't have the proper permissions\n\n\t// Create user data and add-on directories\n\tcreate_directory_if_missing(user_data_dir / \"editor\");\n\tcreate_directory_if_missing(user_data_dir / \"editor\" / \"maps\");\n\tcreate_directory_if_missing(user_data_dir / \"editor\" / \"scenarios\");\n\tcreate_directory_if_missing(user_data_dir / \"data\");\n\tcreate_directory_if_missing(user_data_dir / \"data\" / \"add-ons\");\n\tcreate_directory_if_missing(user_data_dir / \"saves\");\n\tcreate_directory_if_missing(user_data_dir / \"persist\");\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [
            "#define ERR_FS LOG_STREAM(err, log_filesystem)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\n#define ERR_FS LOG_STREAM(err, log_filesystem)\n\nstatic void setup_user_data_dir()\n{\n\tif (!create_directory_if_missing_recursive(user_data_dir)) {\n\t\tERR_FS << \"could not open or create user data directory at \" << user_data_dir.string() << '\\n';\n\t\treturn;\n\t}\n\t// TODO: this may not print the error message if the directory exists but we don't have the proper permissions\n\n\t// Create user data and add-on directories\n\tcreate_directory_if_missing(user_data_dir / \"editor\");\n\tcreate_directory_if_missing(user_data_dir / \"editor\" / \"maps\");\n\tcreate_directory_if_missing(user_data_dir / \"editor\" / \"scenarios\");\n\tcreate_directory_if_missing(user_data_dir / \"data\");\n\tcreate_directory_if_missing(user_data_dir / \"data\" / \"add-ons\");\n\tcreate_directory_if_missing(user_data_dir / \"saves\");\n\tcreate_directory_if_missing(user_data_dir / \"persist\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"HOME\""
          ],
          "line": 548
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "newprefdir.empty",
          "args": [],
          "line": 546
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_version_path_suffix",
          "args": [],
          "line": 535
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"XDG_DATA_HOME\""
          ],
          "line": 525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "newprefdir.empty",
          "args": [],
          "line": 524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"HOME\""
          ],
          "line": 522
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_version_path_suffix",
          "args": [],
          "line": 519
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "newprefdir.empty",
          "args": [],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path",
          "args": [
            "get_cwd()"
          ],
          "line": 509
        },
        "resolved": true,
        "details": {
          "function_name": "get_independent_image_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "1164-1180",
          "snippet": "std::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstd::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_cwd",
          "args": [],
          "line": 509
        },
        "resolved": true,
        "details": {
          "function_name": "get_cwd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "635-644",
          "snippet": "std::string get_cwd()\n{\n\terror_code ec;\n\tpath cwd = bfs::current_path(ec);\n\tif (ec) {\n\t\tERR_FS << \"Failed to get current directory: \" << ec.message() << '\\n';\n\t\treturn \"\";\n\t}\n\treturn cwd.generic_string();\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [
            "#define ERR_FS LOG_STREAM(err, log_filesystem)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\n#define ERR_FS LOG_STREAM(err, log_filesystem)\n\nstd::string get_cwd()\n{\n\terror_code ec;\n\tpath cwd = bfs::current_path(ec);\n\tif (ec) {\n\t\tERR_FS << \"Failed to get current directory: \" << ec.message() << '\\n';\n\t\treturn \"\";\n\t}\n\treturn cwd.generic_string();\n}"
        }
      },
      {
        "call_info": {
          "callee": "create_directory_if_missing",
          "args": [
            "mygames_path"
          ],
          "line": 501
        },
        "resolved": true,
        "details": {
          "function_name": "create_directory_if_missing_recursive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "821-824",
          "snippet": "bool create_directory_if_missing_recursive(const std::string& dirname)\n{\n\treturn create_directory_if_missing_recursive(path(dirname));\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nbool create_directory_if_missing_recursive(const std::string& dirname)\n{\n\treturn create_directory_if_missing_recursive(path(dirname));\n}"
        }
      },
      {
        "call_info": {
          "callee": "SHGetSpecialFolderPathW",
          "args": [
            "NULL",
            "my_documents_path",
            "5",
            "1"
          ],
          "line": 499
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<SHGSFPAddress>",
          "args": [
            "GetProcAddress(module, \"SHGetSpecialFolderPathW\")"
          ],
          "line": 495
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetProcAddress",
          "args": [
            "module",
            "\"SHGetSpecialFolderPathW\""
          ],
          "line": 495
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LoadLibraryA",
          "args": [
            "\"shell32\""
          ],
          "line": 494
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "newprefdir.size",
          "args": [],
          "line": 488
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "newprefdir.empty",
          "args": [],
          "line": 486
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\n#define WRN_FS LOG_STREAM(warn, log_filesystem)\n#define LOG_FS LOG_STREAM(info, log_filesystem)\n\nvoid set_user_data_dir(std::string newprefdir)\n{\n#ifdef _WIN32\n\tif(newprefdir.empty()) {\n\t\tuser_data_dir = path(get_cwd()) / \"userdata\";\n\t} else if (newprefdir.size() > 2 && newprefdir[1] == ':') {\n\t\t//allow absolute path override\n\t\tuser_data_dir = newprefdir;\n\t} else {\n\t\ttypedef BOOL (WINAPI *SHGSFPAddress)(HWND, LPWSTR, int, BOOL);\n\t\tSHGSFPAddress SHGetSpecialFolderPathW;\n\t\tHMODULE module = LoadLibraryA(\"shell32\");\n\t\tSHGetSpecialFolderPathW = reinterpret_cast<SHGSFPAddress>(GetProcAddress(module, \"SHGetSpecialFolderPathW\"));\n\t\tif(SHGetSpecialFolderPathW) {\n\t\t\tLOG_FS << \"Using SHGetSpecialFolderPath to find My Documents\\n\";\n\t\t\twchar_t my_documents_path[MAX_PATH];\n\t\t\tif(SHGetSpecialFolderPathW(NULL, my_documents_path, 5, 1)) {\n\t\t\t\tpath mygames_path = path(my_documents_path) / \"My Games\";\n\t\t\t\tcreate_directory_if_missing(mygames_path);\n\t\t\t\tuser_data_dir = mygames_path / newprefdir;\n\t\t\t} else {\n\t\t\t\tWRN_FS << \"SHGetSpecialFolderPath failed\\n\";\n\t\t\t\tuser_data_dir = path(get_cwd()) / newprefdir;\n\t\t\t}\n\t\t} else {\n\t\t\tLOG_FS << \"Failed to load SHGetSpecialFolderPath function\\n\";\n\t\t\tuser_data_dir = path(get_cwd()) / newprefdir;\n\t\t}\n\t}\n\n#else /*_WIN32*/\n\n#ifdef PREFERENCES_DIR\n\tif (newprefdir.empty()) newprefdir = PREFERENCES_DIR;\n#endif\n\n\tstd::string backupprefdir = \".wesnoth\" + get_version_path_suffix();\n\n#ifdef _X11\n\tconst char *home_str = getenv(\"HOME\");\n\n\tif (newprefdir.empty()) {\n\t\tchar const *xdg_data = getenv(\"XDG_DATA_HOME\");\n\t\tif (!xdg_data || xdg_data[0] == '\\0') {\n\t\t\tif (!home_str) {\n\t\t\t\tnewprefdir = backupprefdir;\n\t\t\t\tgoto other;\n\t\t\t}\n\t\t\tuser_data_dir = home_str;\n\t\t\tuser_data_dir /= \".local/share\";\n\t\t} else user_data_dir = xdg_data;\n\t\tuser_data_dir /= \"wesnoth\";\n\t\tuser_data_dir /= get_version_path_suffix();\n\t} else {\n\t\tother:\n\t\tpath home = home_str ? home_str : \".\";\n\n\t\tif (newprefdir[0] == '/')\n\t\t\tuser_data_dir = newprefdir;\n\t\telse\n\t\t\tuser_data_dir = home / newprefdir;\n\t}\n#else\n\tif (newprefdir.empty()) newprefdir = backupprefdir;\n\n\tconst char* home_str = getenv(\"HOME\");\n\tpath home = home_str ? home_str : \".\";\n\n\tif (newprefdir[0] == '/')\n\t\tuser_data_dir = newprefdir;\n\telse\n\t\tuser_data_dir = home / newprefdir;\n#endif\n\n#endif /*_WIN32*/\n\tsetup_user_data_dir();\n}"
  },
  {
    "function_name": "setup_user_data_dir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "466-482",
    "snippet": "static void setup_user_data_dir()\n{\n\tif (!create_directory_if_missing_recursive(user_data_dir)) {\n\t\tERR_FS << \"could not open or create user data directory at \" << user_data_dir.string() << '\\n';\n\t\treturn;\n\t}\n\t// TODO: this may not print the error message if the directory exists but we don't have the proper permissions\n\n\t// Create user data and add-on directories\n\tcreate_directory_if_missing(user_data_dir / \"editor\");\n\tcreate_directory_if_missing(user_data_dir / \"editor\" / \"maps\");\n\tcreate_directory_if_missing(user_data_dir / \"editor\" / \"scenarios\");\n\tcreate_directory_if_missing(user_data_dir / \"data\");\n\tcreate_directory_if_missing(user_data_dir / \"data\" / \"add-ons\");\n\tcreate_directory_if_missing(user_data_dir / \"saves\");\n\tcreate_directory_if_missing(user_data_dir / \"persist\");\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [
      "#define ERR_FS LOG_STREAM(err, log_filesystem)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "create_directory_if_missing",
          "args": [
            "user_data_dir / \"persist\""
          ],
          "line": 481
        },
        "resolved": true,
        "details": {
          "function_name": "create_directory_if_missing_recursive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "821-824",
          "snippet": "bool create_directory_if_missing_recursive(const std::string& dirname)\n{\n\treturn create_directory_if_missing_recursive(path(dirname));\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nbool create_directory_if_missing_recursive(const std::string& dirname)\n{\n\treturn create_directory_if_missing_recursive(path(dirname));\n}"
        }
      },
      {
        "call_info": {
          "callee": "user_data_dir.string",
          "args": [],
          "line": 469
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\n#define ERR_FS LOG_STREAM(err, log_filesystem)\n\nstatic void setup_user_data_dir()\n{\n\tif (!create_directory_if_missing_recursive(user_data_dir)) {\n\t\tERR_FS << \"could not open or create user data directory at \" << user_data_dir.string() << '\\n';\n\t\treturn;\n\t}\n\t// TODO: this may not print the error message if the directory exists but we don't have the proper permissions\n\n\t// Create user data and add-on directories\n\tcreate_directory_if_missing(user_data_dir / \"editor\");\n\tcreate_directory_if_missing(user_data_dir / \"editor\" / \"maps\");\n\tcreate_directory_if_missing(user_data_dir / \"editor\" / \"scenarios\");\n\tcreate_directory_if_missing(user_data_dir / \"data\");\n\tcreate_directory_if_missing(user_data_dir / \"data\" / \"add-ons\");\n\tcreate_directory_if_missing(user_data_dir / \"saves\");\n\tcreate_directory_if_missing(user_data_dir / \"persist\");\n}"
  },
  {
    "function_name": "get_next_filename",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "426-443",
    "snippet": "std::string get_next_filename(const std::string& name, const std::string& extension)\n{\n\tstd::string next_filename;\n\tint counter = 0;\n\n\tdo {\n\t\tstd::stringstream filename;\n\n\t\tfilename << name;\n\t\tfilename.width(3);\n\t\tfilename.fill('0');\n\t\tfilename.setf(std::ios_base::right);\n\t\tfilename << counter << extension;\n\t\tcounter++;\n\t\tnext_filename = filename.str();\n\t} while(file_exists(next_filename) && counter < 1000);\n\treturn next_filename;\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "file_exists",
          "args": [
            "next_filename"
          ],
          "line": 441
        },
        "resolved": true,
        "details": {
          "function_name": "file_exists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "831-834",
          "snippet": "bool file_exists(const std::string& name)\n{\n\treturn file_exists(path(name));\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nbool file_exists(const std::string& name)\n{\n\treturn file_exists(path(name));\n}"
        }
      },
      {
        "call_info": {
          "callee": "filename.str",
          "args": [],
          "line": 440
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filename.setf",
          "args": [
            "std::ios_base::right"
          ],
          "line": 437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filename.fill",
          "args": [
            "'0'"
          ],
          "line": 436
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filename.width",
          "args": [
            "3"
          ],
          "line": 435
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstd::string get_next_filename(const std::string& name, const std::string& extension)\n{\n\tstd::string next_filename;\n\tint counter = 0;\n\n\tdo {\n\t\tstd::stringstream filename;\n\n\t\tfilename << name;\n\t\tfilename.width(3);\n\t\tfilename.fill('0');\n\t\tfilename.setf(std::ios_base::right);\n\t\tfilename << counter << extension;\n\t\tcounter++;\n\t\tnext_filename = filename.str();\n\t} while(file_exists(next_filename) && counter < 1000);\n\treturn next_filename;\n}"
  },
  {
    "function_name": "get_dir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "421-424",
    "snippet": "std::string get_dir(const std::string &dir)\n{\n\treturn get_dir(path(dir)).string();\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_dir",
          "args": [],
          "line": 423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_dir",
          "args": [
            "path(dir)"
          ],
          "line": 423
        },
        "resolved": true,
        "details": {
          "function_name": "get_dir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "421-424",
          "snippet": "std::string get_dir(const std::string &dir)\n{\n\treturn get_dir(path(dir)).string();\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "path",
          "args": [
            "dir"
          ],
          "line": 423
        },
        "resolved": true,
        "details": {
          "function_name": "get_independent_image_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "1164-1180",
          "snippet": "std::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstd::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstd::string get_dir(const std::string &dir)\n{\n\treturn get_dir(path(dir)).string();\n}"
  },
  {
    "function_name": "get_files_in_dir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "300-419",
    "snippet": "void get_files_in_dir(const std::string &dir,\n                      std::vector<std::string>* files,\n                      std::vector<std::string>* dirs,\n                      file_name_option mode,\n                      file_filter_option filter,\n                      file_reorder_option reorder,\n                      file_tree_checksum* checksum) {\n\tif(path(dir).is_relative() && !game_config::path.empty()) {\n\t\tpath absolute_dir(game_config::path);\n\t\tabsolute_dir /= dir;\n\t\tif(is_directory_internal(absolute_dir)) {\n\t\t\tget_files_in_dir(absolute_dir.string(), files, dirs, mode, filter, reorder, checksum);\n\t\t\treturn;\n\t\t}\n\t}\n\n\tconst path dirpath(dir);\n\n\tif (reorder == DO_REORDER) {\n\t\tLOG_FS << \"searching for _main.cfg in directory \" << dir << '\\n';\n\t\tconst path maincfg = dirpath / maincfg_filename;\n\n\t\tif (file_exists(maincfg)) {\n\t\t\tLOG_FS << \"_main.cfg found : \" << maincfg << '\\n';\n\t\t\tpush_if_exists(files, maincfg, mode == ENTIRE_FILE_PATH);\n\t\t\treturn;\n\t\t}\n\t}\n\n\terror_code ec;\n\tbfs::directory_iterator di(dirpath, ec);\n\tbfs::directory_iterator end;\n\tif (ec) {\n\t\t// Probably not a directory, let the caller deal with it.\n\t\treturn;\n\t}\n\tfor(; di != end; ++di) {\n\t\tbfs::file_status st = di->status(ec);\n\t\tif (ec) {\n\t\t\tLOG_FS << \"Failed to get file status of \" << di->path().string() << \": \" << ec.message() << '\\n';\n\t\t\tcontinue;\n\t\t}\n\t\tif (st.type() == bfs::regular_file) {\n\t\t\t{\n\t\t\t\tstd::string basename = di->path().filename().string();\n\t\t\t\tif (filter == SKIP_PBL_FILES && looks_like_pbl(basename))\n\t\t\t\t\tcontinue;\n\t\t\t\tif(!basename.empty() && basename[0] == '.' )\n\t\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tpush_if_exists(files, di->path(), mode == ENTIRE_FILE_PATH);\n\n\t\t\tif (checksum != NULL) {\n\t\t\t\tstd::time_t mtime = bfs::last_write_time(di->path(), ec);\n\t\t\t\tif (ec) {\n\t\t\t\t\tLOG_FS << \"Failed to read modification time of \" << di->path().string() << \": \" << ec.message() << '\\n';\n\t\t\t\t} else if (mtime > checksum->modified) {\n\t\t\t\t\tchecksum->modified = mtime;\n\t\t\t\t}\n\n\t\t\t\tuintmax_t size = bfs::file_size(di->path(), ec);\n\t\t\t\tif (ec) {\n\t\t\t\t\tLOG_FS << \"Failed to read filesize of \" << di->path().string() << \": \" << ec.message() << '\\n';\n\t\t\t\t} else {\n\t\t\t\t\tchecksum->sum_size += size;\n\t\t\t\t}\n\t\t\t\tchecksum->nfiles++;\n\t\t\t}\n\t\t} else if (st.type() == bfs::directory_file) {\n\t\t\tstd::string basename = di->path().filename().string();\n\t\t\t\n\t\t\tif(!basename.empty() && basename[0] == '.' )\n\t\t\t\tcontinue;\n\t\t\tif (filter == SKIP_MEDIA_DIR\n\t\t\t\t&& (basename == \"images\" || basename == \"sounds\"))\n\t\t\t\tcontinue;\n\n\t\t\tconst path inner_main(di->path() / maincfg_filename);\n\t\t\tbfs::file_status main_st = bfs::status(inner_main, ec);\n\t\t\tif (error_except_not_found(ec)) {\n\t\t\t\tLOG_FS << \"Failed to get file status of \" << inner_main.string() << \": \" << ec.message() << '\\n';\n\t\t\t} else if (reorder == DO_REORDER && main_st.type() == bfs::regular_file) {\n\t\t\t\tLOG_FS << \"_main.cfg found : \" << (mode == ENTIRE_FILE_PATH ? inner_main.string() : inner_main.filename().string()) << '\\n';\n\t\t\t\tpush_if_exists(files, inner_main, mode == ENTIRE_FILE_PATH);\n\t\t\t} else {\n\t\t\t\tpush_if_exists(dirs, di->path(), mode == ENTIRE_FILE_PATH);\n\t\t\t}\n\t\t}\n\t}\n\n\tif (files != NULL)\n\t\tstd::sort(files->begin(),files->end());\n\n\tif (dirs != NULL)\n\t\tstd::sort(dirs->begin(),dirs->end());\n\n\tif (files != NULL && reorder == DO_REORDER) {\n\t\t// move finalcfg_filename, if present, to the end of the vector\n\t\tfor (unsigned int i = 0; i < files->size(); i++) {\n\t\t\tif (ends_with((*files)[i], \"/\" + finalcfg_filename)) {\n\t\t\t\tfiles->push_back((*files)[i]);\n\t\t\t\tfiles->erase(files->begin()+i);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\t// move initialcfg_filename, if present, to the beginning of the vector\n\t\tint foundit = -1;\n\t\tfor (unsigned int i = 0; i < files->size(); i++)\n\t\t\tif (ends_with((*files)[i], \"/\" + initialcfg_filename)) {\n\t\t\t\tfoundit = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\tif (foundit > 0) {\n\t\t\tstd::string initialcfg = (*files)[foundit];\n\t\t\tfor (unsigned int i = foundit; i > 0; i--)\n\t\t\t\t(*files)[i] = (*files)[i-1];\n\t\t\t(*files)[0] = initialcfg;\n\t\t}\n\t}\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [
      "#define LOG_FS LOG_STREAM(info, log_filesystem)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ends_with",
          "args": [
            "(*files)[i]",
            "\"/\" + initialcfg_filename"
          ],
          "line": 408
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "files->size",
          "args": [],
          "line": 407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "files->erase",
          "args": [
            "files->begin()+i"
          ],
          "line": 401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "files->begin",
          "args": [],
          "line": 401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "files->push_back",
          "args": [
            "(*files)[i]"
          ],
          "line": 400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ends_with",
          "args": [
            "(*files)[i]",
            "\"/\" + finalcfg_filename"
          ],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "files->size",
          "args": [],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::sort",
          "args": [
            "dirs->begin()",
            "dirs->end()"
          ],
          "line": 394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dirs->end",
          "args": [],
          "line": 394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dirs->begin",
          "args": [],
          "line": 394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::sort",
          "args": [
            "files->begin()",
            "files->end()"
          ],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "files->end",
          "args": [],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "files->begin",
          "args": [],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "push_if_exists",
          "args": [
            "dirs",
            "di->path()",
            "mode == ENTIRE_FILE_PATH"
          ],
          "line": 385
        },
        "resolved": true,
        "details": {
          "function_name": "push_if_exists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "197-204",
          "snippet": "static void push_if_exists(std::vector<std::string> *vec, const path &file, bool full) {\n\tif (vec != NULL) {\n\t\tif (full)\n\t\t\tvec->push_back(file.generic_string());\n\t\telse\n\t\t\tvec->push_back(file.filename().generic_string());\n\t}\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstatic void push_if_exists(std::vector<std::string> *vec, const path &file, bool full) {\n\tif (vec != NULL) {\n\t\tif (full)\n\t\t\tvec->push_back(file.generic_string());\n\t\telse\n\t\t\tvec->push_back(file.filename().generic_string());\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "di->path",
          "args": [],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inner_main.filename",
          "args": [],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inner_main.filename",
          "args": [],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inner_main.string",
          "args": [],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "main_st.type",
          "args": [],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ec.message",
          "args": [],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inner_main.string",
          "args": [],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error_except_not_found",
          "args": [
            "ec"
          ],
          "line": 379
        },
        "resolved": true,
        "details": {
          "function_name": "error_except_not_found",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "206-214",
          "snippet": "static inline bool error_except_not_found(const error_code &ec)\n{\n\treturn (ec\n\t\t&& ec.value() != boost::system::errc::no_such_file_or_directory\n#ifdef _WIN32\n\t\t&& ec.value() != boost::system::windows_error::path_not_found\n#endif /*_WIN32*/\n\t\t);\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstatic inline bool error_except_not_found(const error_code &ec)\n{\n\treturn (ec\n\t\t&& ec.value() != boost::system::errc::no_such_file_or_directory\n#ifdef _WIN32\n\t\t&& ec.value() != boost::system::windows_error::path_not_found\n#endif /*_WIN32*/\n\t\t);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bfs::status",
          "args": [
            "inner_main",
            "ec"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "di->path",
          "args": [],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "basename.empty",
          "args": [],
          "line": 371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "di->path",
          "args": [],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "di->path",
          "args": [],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "di->path",
          "args": [],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st.type",
          "args": [],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ec.message",
          "args": [],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "di->path",
          "args": [],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "di->path",
          "args": [],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bfs::file_size",
          "args": [
            "di->path()",
            "ec"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "di->path",
          "args": [],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ec.message",
          "args": [],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "di->path",
          "args": [],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "di->path",
          "args": [],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bfs::last_write_time",
          "args": [
            "di->path()",
            "ec"
          ],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "di->path",
          "args": [],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "di->path",
          "args": [],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "basename.empty",
          "args": [],
          "line": 347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "looks_like_pbl",
          "args": [
            "basename"
          ],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "di->path",
          "args": [],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "di->path",
          "args": [],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "di->path",
          "args": [],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "st.type",
          "args": [],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ec.message",
          "args": [],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "di->path",
          "args": [],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "di->path",
          "args": [],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "di->status",
          "args": [
            "ec"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file_exists",
          "args": [
            "maincfg"
          ],
          "line": 322
        },
        "resolved": true,
        "details": {
          "function_name": "file_exists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "831-834",
          "snippet": "bool file_exists(const std::string& name)\n{\n\treturn file_exists(path(name));\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nbool file_exists(const std::string& name)\n{\n\treturn file_exists(path(name));\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_files_in_dir",
          "args": [
            "absolute_dir.string()",
            "files",
            "dirs",
            "mode",
            "filter",
            "reorder",
            "checksum"
          ],
          "line": 311
        },
        "resolved": true,
        "details": {
          "function_name": "get_files_in_dir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "300-419",
          "snippet": "void get_files_in_dir(const std::string &dir,\n                      std::vector<std::string>* files,\n                      std::vector<std::string>* dirs,\n                      file_name_option mode,\n                      file_filter_option filter,\n                      file_reorder_option reorder,\n                      file_tree_checksum* checksum) {\n\tif(path(dir).is_relative() && !game_config::path.empty()) {\n\t\tpath absolute_dir(game_config::path);\n\t\tabsolute_dir /= dir;\n\t\tif(is_directory_internal(absolute_dir)) {\n\t\t\tget_files_in_dir(absolute_dir.string(), files, dirs, mode, filter, reorder, checksum);\n\t\t\treturn;\n\t\t}\n\t}\n\n\tconst path dirpath(dir);\n\n\tif (reorder == DO_REORDER) {\n\t\tLOG_FS << \"searching for _main.cfg in directory \" << dir << '\\n';\n\t\tconst path maincfg = dirpath / maincfg_filename;\n\n\t\tif (file_exists(maincfg)) {\n\t\t\tLOG_FS << \"_main.cfg found : \" << maincfg << '\\n';\n\t\t\tpush_if_exists(files, maincfg, mode == ENTIRE_FILE_PATH);\n\t\t\treturn;\n\t\t}\n\t}\n\n\terror_code ec;\n\tbfs::directory_iterator di(dirpath, ec);\n\tbfs::directory_iterator end;\n\tif (ec) {\n\t\t// Probably not a directory, let the caller deal with it.\n\t\treturn;\n\t}\n\tfor(; di != end; ++di) {\n\t\tbfs::file_status st = di->status(ec);\n\t\tif (ec) {\n\t\t\tLOG_FS << \"Failed to get file status of \" << di->path().string() << \": \" << ec.message() << '\\n';\n\t\t\tcontinue;\n\t\t}\n\t\tif (st.type() == bfs::regular_file) {\n\t\t\t{\n\t\t\t\tstd::string basename = di->path().filename().string();\n\t\t\t\tif (filter == SKIP_PBL_FILES && looks_like_pbl(basename))\n\t\t\t\t\tcontinue;\n\t\t\t\tif(!basename.empty() && basename[0] == '.' )\n\t\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tpush_if_exists(files, di->path(), mode == ENTIRE_FILE_PATH);\n\n\t\t\tif (checksum != NULL) {\n\t\t\t\tstd::time_t mtime = bfs::last_write_time(di->path(), ec);\n\t\t\t\tif (ec) {\n\t\t\t\t\tLOG_FS << \"Failed to read modification time of \" << di->path().string() << \": \" << ec.message() << '\\n';\n\t\t\t\t} else if (mtime > checksum->modified) {\n\t\t\t\t\tchecksum->modified = mtime;\n\t\t\t\t}\n\n\t\t\t\tuintmax_t size = bfs::file_size(di->path(), ec);\n\t\t\t\tif (ec) {\n\t\t\t\t\tLOG_FS << \"Failed to read filesize of \" << di->path().string() << \": \" << ec.message() << '\\n';\n\t\t\t\t} else {\n\t\t\t\t\tchecksum->sum_size += size;\n\t\t\t\t}\n\t\t\t\tchecksum->nfiles++;\n\t\t\t}\n\t\t} else if (st.type() == bfs::directory_file) {\n\t\t\tstd::string basename = di->path().filename().string();\n\t\t\t\n\t\t\tif(!basename.empty() && basename[0] == '.' )\n\t\t\t\tcontinue;\n\t\t\tif (filter == SKIP_MEDIA_DIR\n\t\t\t\t&& (basename == \"images\" || basename == \"sounds\"))\n\t\t\t\tcontinue;\n\n\t\t\tconst path inner_main(di->path() / maincfg_filename);\n\t\t\tbfs::file_status main_st = bfs::status(inner_main, ec);\n\t\t\tif (error_except_not_found(ec)) {\n\t\t\t\tLOG_FS << \"Failed to get file status of \" << inner_main.string() << \": \" << ec.message() << '\\n';\n\t\t\t} else if (reorder == DO_REORDER && main_st.type() == bfs::regular_file) {\n\t\t\t\tLOG_FS << \"_main.cfg found : \" << (mode == ENTIRE_FILE_PATH ? inner_main.string() : inner_main.filename().string()) << '\\n';\n\t\t\t\tpush_if_exists(files, inner_main, mode == ENTIRE_FILE_PATH);\n\t\t\t} else {\n\t\t\t\tpush_if_exists(dirs, di->path(), mode == ENTIRE_FILE_PATH);\n\t\t\t}\n\t\t}\n\t}\n\n\tif (files != NULL)\n\t\tstd::sort(files->begin(),files->end());\n\n\tif (dirs != NULL)\n\t\tstd::sort(dirs->begin(),dirs->end());\n\n\tif (files != NULL && reorder == DO_REORDER) {\n\t\t// move finalcfg_filename, if present, to the end of the vector\n\t\tfor (unsigned int i = 0; i < files->size(); i++) {\n\t\t\tif (ends_with((*files)[i], \"/\" + finalcfg_filename)) {\n\t\t\t\tfiles->push_back((*files)[i]);\n\t\t\t\tfiles->erase(files->begin()+i);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\t// move initialcfg_filename, if present, to the beginning of the vector\n\t\tint foundit = -1;\n\t\tfor (unsigned int i = 0; i < files->size(); i++)\n\t\t\tif (ends_with((*files)[i], \"/\" + initialcfg_filename)) {\n\t\t\t\tfoundit = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\tif (foundit > 0) {\n\t\t\tstd::string initialcfg = (*files)[foundit];\n\t\t\tfor (unsigned int i = foundit; i > 0; i--)\n\t\t\t\t(*files)[i] = (*files)[i-1];\n\t\t\t(*files)[0] = initialcfg;\n\t\t}\n\t}\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "absolute_dir.string",
          "args": [],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_directory_internal",
          "args": [
            "absolute_dir"
          ],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "is_directory_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "216-224",
          "snippet": "static bool is_directory_internal(const path &fpath)\n{\n\terror_code ec;\n\tbool is_dir = bfs::is_directory(fpath, ec);\n\tif (error_except_not_found(ec)) {\n\t\tLOG_FS << \"Failed to check if \" << fpath.string() << \" is a directory: \" << ec.message() << '\\n';\n\t}\n\treturn is_dir;\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [
            "#define LOG_FS LOG_STREAM(info, log_filesystem)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\n#define LOG_FS LOG_STREAM(info, log_filesystem)\n\nstatic bool is_directory_internal(const path &fpath)\n{\n\terror_code ec;\n\tbool is_dir = bfs::is_directory(fpath, ec);\n\tif (error_except_not_found(ec)) {\n\t\tLOG_FS << \"Failed to check if \" << fpath.string() << \" is a directory: \" << ec.message() << '\\n';\n\t}\n\treturn is_dir;\n}"
        }
      },
      {
        "call_info": {
          "callee": "game_config::path.empty",
          "args": [],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path",
          "args": [],
          "line": 307
        },
        "resolved": true,
        "details": {
          "function_name": "clear_binary_paths_cache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "984-987",
          "snippet": "void clear_binary_paths_cache()\n{\n\tbinary_paths_cache.clear();\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nvoid clear_binary_paths_cache()\n{\n\tbinary_paths_cache.clear();\n}"
        }
      },
      {
        "call_info": {
          "callee": "path",
          "args": [
            "dir"
          ],
          "line": 307
        },
        "resolved": true,
        "details": {
          "function_name": "get_independent_image_path",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "1164-1180",
          "snippet": "std::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstd::string get_independent_image_path(const std::string &filename)\n{\n\tpath full_path(get_binary_file_location(\"images\", filename));\n\n\tif (full_path.empty())\n\t\treturn full_path.string();\n\n\tpath partial = subtract_path(full_path, get_user_data_path());\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\tpartial = subtract_path(full_path, game_config::path);\n\tif (!partial.empty())\n\t\treturn partial.string();\n\n\treturn full_path.string();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\n#define LOG_FS LOG_STREAM(info, log_filesystem)\n\nvoid get_files_in_dir(const std::string &dir,\n                      std::vector<std::string>* files,\n                      std::vector<std::string>* dirs,\n                      file_name_option mode,\n                      file_filter_option filter,\n                      file_reorder_option reorder,\n                      file_tree_checksum* checksum) {\n\tif(path(dir).is_relative() && !game_config::path.empty()) {\n\t\tpath absolute_dir(game_config::path);\n\t\tabsolute_dir /= dir;\n\t\tif(is_directory_internal(absolute_dir)) {\n\t\t\tget_files_in_dir(absolute_dir.string(), files, dirs, mode, filter, reorder, checksum);\n\t\t\treturn;\n\t\t}\n\t}\n\n\tconst path dirpath(dir);\n\n\tif (reorder == DO_REORDER) {\n\t\tLOG_FS << \"searching for _main.cfg in directory \" << dir << '\\n';\n\t\tconst path maincfg = dirpath / maincfg_filename;\n\n\t\tif (file_exists(maincfg)) {\n\t\t\tLOG_FS << \"_main.cfg found : \" << maincfg << '\\n';\n\t\t\tpush_if_exists(files, maincfg, mode == ENTIRE_FILE_PATH);\n\t\t\treturn;\n\t\t}\n\t}\n\n\terror_code ec;\n\tbfs::directory_iterator di(dirpath, ec);\n\tbfs::directory_iterator end;\n\tif (ec) {\n\t\t// Probably not a directory, let the caller deal with it.\n\t\treturn;\n\t}\n\tfor(; di != end; ++di) {\n\t\tbfs::file_status st = di->status(ec);\n\t\tif (ec) {\n\t\t\tLOG_FS << \"Failed to get file status of \" << di->path().string() << \": \" << ec.message() << '\\n';\n\t\t\tcontinue;\n\t\t}\n\t\tif (st.type() == bfs::regular_file) {\n\t\t\t{\n\t\t\t\tstd::string basename = di->path().filename().string();\n\t\t\t\tif (filter == SKIP_PBL_FILES && looks_like_pbl(basename))\n\t\t\t\t\tcontinue;\n\t\t\t\tif(!basename.empty() && basename[0] == '.' )\n\t\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tpush_if_exists(files, di->path(), mode == ENTIRE_FILE_PATH);\n\n\t\t\tif (checksum != NULL) {\n\t\t\t\tstd::time_t mtime = bfs::last_write_time(di->path(), ec);\n\t\t\t\tif (ec) {\n\t\t\t\t\tLOG_FS << \"Failed to read modification time of \" << di->path().string() << \": \" << ec.message() << '\\n';\n\t\t\t\t} else if (mtime > checksum->modified) {\n\t\t\t\t\tchecksum->modified = mtime;\n\t\t\t\t}\n\n\t\t\t\tuintmax_t size = bfs::file_size(di->path(), ec);\n\t\t\t\tif (ec) {\n\t\t\t\t\tLOG_FS << \"Failed to read filesize of \" << di->path().string() << \": \" << ec.message() << '\\n';\n\t\t\t\t} else {\n\t\t\t\t\tchecksum->sum_size += size;\n\t\t\t\t}\n\t\t\t\tchecksum->nfiles++;\n\t\t\t}\n\t\t} else if (st.type() == bfs::directory_file) {\n\t\t\tstd::string basename = di->path().filename().string();\n\t\t\t\n\t\t\tif(!basename.empty() && basename[0] == '.' )\n\t\t\t\tcontinue;\n\t\t\tif (filter == SKIP_MEDIA_DIR\n\t\t\t\t&& (basename == \"images\" || basename == \"sounds\"))\n\t\t\t\tcontinue;\n\n\t\t\tconst path inner_main(di->path() / maincfg_filename);\n\t\t\tbfs::file_status main_st = bfs::status(inner_main, ec);\n\t\t\tif (error_except_not_found(ec)) {\n\t\t\t\tLOG_FS << \"Failed to get file status of \" << inner_main.string() << \": \" << ec.message() << '\\n';\n\t\t\t} else if (reorder == DO_REORDER && main_st.type() == bfs::regular_file) {\n\t\t\t\tLOG_FS << \"_main.cfg found : \" << (mode == ENTIRE_FILE_PATH ? inner_main.string() : inner_main.filename().string()) << '\\n';\n\t\t\t\tpush_if_exists(files, inner_main, mode == ENTIRE_FILE_PATH);\n\t\t\t} else {\n\t\t\t\tpush_if_exists(dirs, di->path(), mode == ENTIRE_FILE_PATH);\n\t\t\t}\n\t\t}\n\t}\n\n\tif (files != NULL)\n\t\tstd::sort(files->begin(),files->end());\n\n\tif (dirs != NULL)\n\t\tstd::sort(dirs->begin(),dirs->end());\n\n\tif (files != NULL && reorder == DO_REORDER) {\n\t\t// move finalcfg_filename, if present, to the end of the vector\n\t\tfor (unsigned int i = 0; i < files->size(); i++) {\n\t\t\tif (ends_with((*files)[i], \"/\" + finalcfg_filename)) {\n\t\t\t\tfiles->push_back((*files)[i]);\n\t\t\t\tfiles->erase(files->begin()+i);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\t// move initialcfg_filename, if present, to the beginning of the vector\n\t\tint foundit = -1;\n\t\tfor (unsigned int i = 0; i < files->size(); i++)\n\t\t\tif (ends_with((*files)[i], \"/\" + initialcfg_filename)) {\n\t\t\t\tfoundit = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\tif (foundit > 0) {\n\t\t\tstd::string initialcfg = (*files)[foundit];\n\t\t\tfor (unsigned int i = foundit; i > 0; i--)\n\t\t\t\t(*files)[i] = (*files)[i-1];\n\t\t\t(*files)[0] = initialcfg;\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "create_directory_if_missing_recursive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "275-298",
    "snippet": "static bool create_directory_if_missing_recursive(const path& dirpath)\n{\n\tDBG_FS << \"creating recursive directory: \" << dirpath.string() << '\\n';\n\n\tif (dirpath.empty())\n\t\treturn false;\n\terror_code ec;\n\tbfs::file_status fs = bfs::status(dirpath);\n\tif (error_except_not_found(ec)) {\n\t\tERR_FS << \"Failed to retrieve file status for \" << dirpath.string() << \": \" << ec.message() << '\\n';\n\t\treturn false;\n\t} else if (bfs::is_directory(fs)) {\n\t\treturn true;\n\t} else if (bfs::exists(fs)) {\n\t\treturn false;\n\t}\n\n\tif (!dirpath.has_parent_path() || create_directory_if_missing_recursive(dirpath.parent_path())) {\n\t\treturn create_directory_if_missing(dirpath);\n\t} else {\n\t\tERR_FS << \"Could not create parents to \" << dirpath.string() << '\\n';\n\t\treturn false;\n\t}\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [
      "#define ERR_FS LOG_STREAM(err, log_filesystem)",
      "#define DBG_FS LOG_STREAM(debug, log_filesystem)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dirpath.string",
          "args": [],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "create_directory_if_missing",
          "args": [
            "dirpath"
          ],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "create_directory_if_missing_recursive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "821-824",
          "snippet": "bool create_directory_if_missing_recursive(const std::string& dirname)\n{\n\treturn create_directory_if_missing_recursive(path(dirname));\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "dirpath.parent_path",
          "args": [],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dirpath.has_parent_path",
          "args": [],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bfs::exists",
          "args": [
            "fs"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bfs::is_directory",
          "args": [
            "fs"
          ],
          "line": 286
        },
        "resolved": true,
        "details": {
          "function_name": "is_directory",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "826-829",
          "snippet": "bool is_directory(const std::string& fname)\n{\n\treturn is_directory_internal(path(fname));\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nbool is_directory(const std::string& fname)\n{\n\treturn is_directory_internal(path(fname));\n}"
        }
      },
      {
        "call_info": {
          "callee": "ec.message",
          "args": [],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dirpath.string",
          "args": [],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error_except_not_found",
          "args": [
            "ec"
          ],
          "line": 283
        },
        "resolved": true,
        "details": {
          "function_name": "error_except_not_found",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "206-214",
          "snippet": "static inline bool error_except_not_found(const error_code &ec)\n{\n\treturn (ec\n\t\t&& ec.value() != boost::system::errc::no_such_file_or_directory\n#ifdef _WIN32\n\t\t&& ec.value() != boost::system::windows_error::path_not_found\n#endif /*_WIN32*/\n\t\t);\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstatic inline bool error_except_not_found(const error_code &ec)\n{\n\treturn (ec\n\t\t&& ec.value() != boost::system::errc::no_such_file_or_directory\n#ifdef _WIN32\n\t\t&& ec.value() != boost::system::windows_error::path_not_found\n#endif /*_WIN32*/\n\t\t);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bfs::status",
          "args": [
            "dirpath"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dirpath.empty",
          "args": [],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dirpath.string",
          "args": [],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\n#define ERR_FS LOG_STREAM(err, log_filesystem)\n#define DBG_FS LOG_STREAM(debug, log_filesystem)\n\nstatic bool create_directory_if_missing_recursive(const path& dirpath)\n{\n\tDBG_FS << \"creating recursive directory: \" << dirpath.string() << '\\n';\n\n\tif (dirpath.empty())\n\t\treturn false;\n\terror_code ec;\n\tbfs::file_status fs = bfs::status(dirpath);\n\tif (error_except_not_found(ec)) {\n\t\tERR_FS << \"Failed to retrieve file status for \" << dirpath.string() << \": \" << ec.message() << '\\n';\n\t\treturn false;\n\t} else if (bfs::is_directory(fs)) {\n\t\treturn true;\n\t} else if (bfs::exists(fs)) {\n\t\treturn false;\n\t}\n\n\tif (!dirpath.has_parent_path() || create_directory_if_missing_recursive(dirpath.parent_path())) {\n\t\treturn create_directory_if_missing(dirpath);\n\t} else {\n\t\tERR_FS << \"Could not create parents to \" << dirpath.string() << '\\n';\n\t\treturn false;\n\t}\n}"
  },
  {
    "function_name": "create_directory_if_missing",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "254-274",
    "snippet": "static bool create_directory_if_missing(const path &dirpath)\n{\n\terror_code ec;\n\tbfs::file_status fs = bfs::status(dirpath, ec);\n\tif (error_except_not_found(ec)) {\n\t\tERR_FS << \"Failed to retrieve file status for \" << dirpath.string() << \": \" << ec.message() << '\\n';\n\t\treturn false;\n\t} else if (bfs::is_directory(fs)) {\n\t\tDBG_FS << \"directory \" << dirpath.string() << \" exists, not creating\\n\";\n\t\treturn true;\n\t} else if (bfs::exists(fs)) {\n\t\tERR_FS << \"cannot create directory \" << dirpath.string() << \"; file exists\\n\";\n\t\treturn false;\n\t}\n\n\tbool created = bfs::create_directory(dirpath, ec);\n\tif (ec) {\n\t\tERR_FS << \"Failed to create directory \" << dirpath.string() << \": \" << ec.message() << '\\n';\n\t}\n\treturn created;\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [
      "#define ERR_FS LOG_STREAM(err, log_filesystem)",
      "#define DBG_FS LOG_STREAM(debug, log_filesystem)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ec.message",
          "args": [],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dirpath.string",
          "args": [],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bfs::create_directory",
          "args": [
            "dirpath",
            "ec"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dirpath.string",
          "args": [],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bfs::exists",
          "args": [
            "fs"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dirpath.string",
          "args": [],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bfs::is_directory",
          "args": [
            "fs"
          ],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "is_directory",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "826-829",
          "snippet": "bool is_directory(const std::string& fname)\n{\n\treturn is_directory_internal(path(fname));\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nbool is_directory(const std::string& fname)\n{\n\treturn is_directory_internal(path(fname));\n}"
        }
      },
      {
        "call_info": {
          "callee": "ec.message",
          "args": [],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dirpath.string",
          "args": [],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error_except_not_found",
          "args": [
            "ec"
          ],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "error_except_not_found",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "206-214",
          "snippet": "static inline bool error_except_not_found(const error_code &ec)\n{\n\treturn (ec\n\t\t&& ec.value() != boost::system::errc::no_such_file_or_directory\n#ifdef _WIN32\n\t\t&& ec.value() != boost::system::windows_error::path_not_found\n#endif /*_WIN32*/\n\t\t);\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstatic inline bool error_except_not_found(const error_code &ec)\n{\n\treturn (ec\n\t\t&& ec.value() != boost::system::errc::no_such_file_or_directory\n#ifdef _WIN32\n\t\t&& ec.value() != boost::system::windows_error::path_not_found\n#endif /*_WIN32*/\n\t\t);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bfs::status",
          "args": [
            "dirpath",
            "ec"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\n#define ERR_FS LOG_STREAM(err, log_filesystem)\n#define DBG_FS LOG_STREAM(debug, log_filesystem)\n\nstatic bool create_directory_if_missing(const path &dirpath)\n{\n\terror_code ec;\n\tbfs::file_status fs = bfs::status(dirpath, ec);\n\tif (error_except_not_found(ec)) {\n\t\tERR_FS << \"Failed to retrieve file status for \" << dirpath.string() << \": \" << ec.message() << '\\n';\n\t\treturn false;\n\t} else if (bfs::is_directory(fs)) {\n\t\tDBG_FS << \"directory \" << dirpath.string() << \" exists, not creating\\n\";\n\t\treturn true;\n\t} else if (bfs::exists(fs)) {\n\t\tERR_FS << \"cannot create directory \" << dirpath.string() << \"; file exists\\n\";\n\t\treturn false;\n\t}\n\n\tbool created = bfs::create_directory(dirpath, ec);\n\tif (ec) {\n\t\tERR_FS << \"Failed to create directory \" << dirpath.string() << \": \" << ec.message() << '\\n';\n\t}\n\treturn created;\n}"
  },
  {
    "function_name": "get_dir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "235-253",
    "snippet": "static path get_dir(const path &dirpath)\n{\n\tbool is_dir = is_directory_internal(dirpath);\n\tif (!is_dir) {\n\t\terror_code ec;\n\t\tbfs::create_directory(dirpath, ec);\n\t\tif (ec) {\n\t\t\tERR_FS << \"Failed to create directory \" << dirpath.string() << \": \" << ec.message() << '\\n';\n\t\t}\n\t\t// This is probably redundant\n\t\tis_dir = is_directory_internal(dirpath);\n\t}\n\tif (!is_dir) {\n\t\tERR_FS << \"Could not open or create directory \" << dirpath.string() << '\\n';\n\t\treturn std::string();\n\t}\n\n\treturn dirpath;\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [
      "#define ERR_FS LOG_STREAM(err, log_filesystem)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::string",
          "args": [],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dirpath.string",
          "args": [],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_directory_internal",
          "args": [
            "dirpath"
          ],
          "line": 245
        },
        "resolved": true,
        "details": {
          "function_name": "is_directory_internal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "216-224",
          "snippet": "static bool is_directory_internal(const path &fpath)\n{\n\terror_code ec;\n\tbool is_dir = bfs::is_directory(fpath, ec);\n\tif (error_except_not_found(ec)) {\n\t\tLOG_FS << \"Failed to check if \" << fpath.string() << \" is a directory: \" << ec.message() << '\\n';\n\t}\n\treturn is_dir;\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [
            "#define LOG_FS LOG_STREAM(info, log_filesystem)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\n#define LOG_FS LOG_STREAM(info, log_filesystem)\n\nstatic bool is_directory_internal(const path &fpath)\n{\n\terror_code ec;\n\tbool is_dir = bfs::is_directory(fpath, ec);\n\tif (error_except_not_found(ec)) {\n\t\tLOG_FS << \"Failed to check if \" << fpath.string() << \" is a directory: \" << ec.message() << '\\n';\n\t}\n\treturn is_dir;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ec.message",
          "args": [],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dirpath.string",
          "args": [],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bfs::create_directory",
          "args": [
            "dirpath",
            "ec"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\n#define ERR_FS LOG_STREAM(err, log_filesystem)\n\nstatic path get_dir(const path &dirpath)\n{\n\tbool is_dir = is_directory_internal(dirpath);\n\tif (!is_dir) {\n\t\terror_code ec;\n\t\tbfs::create_directory(dirpath, ec);\n\t\tif (ec) {\n\t\t\tERR_FS << \"Failed to create directory \" << dirpath.string() << \": \" << ec.message() << '\\n';\n\t\t}\n\t\t// This is probably redundant\n\t\tis_dir = is_directory_internal(dirpath);\n\t}\n\tif (!is_dir) {\n\t\tERR_FS << \"Could not open or create directory \" << dirpath.string() << '\\n';\n\t\treturn std::string();\n\t}\n\n\treturn dirpath;\n}"
  },
  {
    "function_name": "file_exists",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "226-234",
    "snippet": "static bool file_exists(const path &fpath)\n{\n\terror_code ec;\n\tbool exists = bfs::exists(fpath, ec);\n\tif (error_except_not_found(ec)) {\n\t\tERR_FS << \"Failed to check existence of file \" << fpath.string() << \": \" << ec.message() << '\\n';\n\t}\n\treturn exists;\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [
      "#define ERR_FS LOG_STREAM(err, log_filesystem)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ec.message",
          "args": [],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fpath.string",
          "args": [],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error_except_not_found",
          "args": [
            "ec"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "error_except_not_found",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "206-214",
          "snippet": "static inline bool error_except_not_found(const error_code &ec)\n{\n\treturn (ec\n\t\t&& ec.value() != boost::system::errc::no_such_file_or_directory\n#ifdef _WIN32\n\t\t&& ec.value() != boost::system::windows_error::path_not_found\n#endif /*_WIN32*/\n\t\t);\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstatic inline bool error_except_not_found(const error_code &ec)\n{\n\treturn (ec\n\t\t&& ec.value() != boost::system::errc::no_such_file_or_directory\n#ifdef _WIN32\n\t\t&& ec.value() != boost::system::windows_error::path_not_found\n#endif /*_WIN32*/\n\t\t);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bfs::exists",
          "args": [
            "fpath",
            "ec"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\n#define ERR_FS LOG_STREAM(err, log_filesystem)\n\nstatic bool file_exists(const path &fpath)\n{\n\terror_code ec;\n\tbool exists = bfs::exists(fpath, ec);\n\tif (error_except_not_found(ec)) {\n\t\tERR_FS << \"Failed to check existence of file \" << fpath.string() << \": \" << ec.message() << '\\n';\n\t}\n\treturn exists;\n}"
  },
  {
    "function_name": "is_directory_internal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "216-224",
    "snippet": "static bool is_directory_internal(const path &fpath)\n{\n\terror_code ec;\n\tbool is_dir = bfs::is_directory(fpath, ec);\n\tif (error_except_not_found(ec)) {\n\t\tLOG_FS << \"Failed to check if \" << fpath.string() << \" is a directory: \" << ec.message() << '\\n';\n\t}\n\treturn is_dir;\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [
      "#define LOG_FS LOG_STREAM(info, log_filesystem)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ec.message",
          "args": [],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fpath.string",
          "args": [],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error_except_not_found",
          "args": [
            "ec"
          ],
          "line": 220
        },
        "resolved": true,
        "details": {
          "function_name": "error_except_not_found",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "206-214",
          "snippet": "static inline bool error_except_not_found(const error_code &ec)\n{\n\treturn (ec\n\t\t&& ec.value() != boost::system::errc::no_such_file_or_directory\n#ifdef _WIN32\n\t\t&& ec.value() != boost::system::windows_error::path_not_found\n#endif /*_WIN32*/\n\t\t);\n}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstatic inline bool error_except_not_found(const error_code &ec)\n{\n\treturn (ec\n\t\t&& ec.value() != boost::system::errc::no_such_file_or_directory\n#ifdef _WIN32\n\t\t&& ec.value() != boost::system::windows_error::path_not_found\n#endif /*_WIN32*/\n\t\t);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bfs::is_directory",
          "args": [
            "fpath",
            "ec"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\n#define LOG_FS LOG_STREAM(info, log_filesystem)\n\nstatic bool is_directory_internal(const path &fpath)\n{\n\terror_code ec;\n\tbool is_dir = bfs::is_directory(fpath, ec);\n\tif (error_except_not_found(ec)) {\n\t\tLOG_FS << \"Failed to check if \" << fpath.string() << \" is a directory: \" << ec.message() << '\\n';\n\t}\n\treturn is_dir;\n}"
  },
  {
    "function_name": "error_except_not_found",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "206-214",
    "snippet": "static inline bool error_except_not_found(const error_code &ec)\n{\n\treturn (ec\n\t\t&& ec.value() != boost::system::errc::no_such_file_or_directory\n#ifdef _WIN32\n\t\t&& ec.value() != boost::system::windows_error::path_not_found\n#endif /*_WIN32*/\n\t\t);\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ec.value",
          "args": [],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ec.value",
          "args": [],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstatic inline bool error_except_not_found(const error_code &ec)\n{\n\treturn (ec\n\t\t&& ec.value() != boost::system::errc::no_such_file_or_directory\n#ifdef _WIN32\n\t\t&& ec.value() != boost::system::windows_error::path_not_found\n#endif /*_WIN32*/\n\t\t);\n}"
  },
  {
    "function_name": "push_if_exists",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "197-204",
    "snippet": "static void push_if_exists(std::vector<std::string> *vec, const path &file, bool full) {\n\tif (vec != NULL) {\n\t\tif (full)\n\t\t\tvec->push_back(file.generic_string());\n\t\telse\n\t\t\tvec->push_back(file.filename().generic_string());\n\t}\n}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vec->push_back",
          "args": [
            "file.filename().generic_string()"
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file.filename",
          "args": [],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file.filename",
          "args": [],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vec->push_back",
          "args": [
            "file.generic_string()"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file.generic_string",
          "args": [],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstatic void push_if_exists(std::vector<std::string> *vec, const path &file, bool full) {\n\tif (vec != NULL) {\n\t\tif (full)\n\t\t\tvec->push_back(file.generic_string());\n\t\telse\n\t\t\tvec->push_back(file.filename().generic_string());\n\t}\n}"
  },
  {
    "function_name": "static_runner",
    "container": "static_runner",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "181-187",
    "snippet": "static_runner() {\n\t\t\t// Boost uses the current locale to generate a UTF-8 one\n\t\t\tstd::locale utf8_loc = boost::locale::generator().generate(\"\");\n\t\t\t// use a custom locale becasue we want to use out log.hpp functions in case of an invalid string.\n\t\t\tutf8_loc = std::locale(utf8_loc, new customcodecvt());\n\t\t\tboost::filesystem::path::imbue(utf8_loc);\n\t\t}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [
      "static lg::log_domain log_filesystem(\"filesystem\");"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "boost::filesystem::path::imbue",
          "args": [
            "utf8_loc"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::locale",
          "args": [
            "utf8_loc",
            "new customcodecvt()"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boost::locale::generator",
          "args": [
            "\"\""
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boost::locale::generator",
          "args": [],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstatic lg::log_domain log_filesystem(\"filesystem\");\n\nstatic_runner {\n  static_runner() {\n  \t\t\t// Boost uses the current locale to generate a UTF-8 one\n  \t\t\tstd::locale utf8_loc = boost::locale::generator().generate(\"\");\n  \t\t\t// use a custom locale becasue we want to use out log.hpp functions in case of an invalid string.\n  \t\t\tutf8_loc = std::locale(utf8_loc, new customcodecvt());\n  \t\t\tboost::filesystem::path::imbue(utf8_loc);\n  \t\t}\n}"
  },
  {
    "function_name": "do_out",
    "container": "customcodecvt",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "157-175",
    "snippet": "std::codecvt_base::result do_out( std::mbstate_t& state,\n\t\t\tconst wchar_t* from,\n\t\t\tconst wchar_t* from_end,\n\t\t\tconst wchar_t*& from_next,\n\t\t\tchar* to,\n\t\t\tchar* to_end,\n\t\t\tchar*& to_next ) const\n\t\t{\n\t\t\ttry\n\t\t\t{\n\t\t\t\tcustomcodecvt_do_conversion<wchar_t, char>(state, from, from_end, from_next, to, to_end, to_next);\n\t\t\t}\n\t\t\tcatch(...)\n\t\t\t{\n\t\t\t\tERR_FS << \"Invalid UTF-16 string\" << std::endl;\n\t\t\t\treturn std::codecvt_base::error;\t\n\t\t\t}\n\t\t\treturn std::codecvt_base::ok;\n\t\t}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [
      "#define ERR_FS LOG_STREAM(err, log_filesystem)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "customcodecvt_do_conversion<wchar_t, char>",
          "args": [
            "state",
            "from",
            "from_end",
            "from_next",
            "to",
            "to_end",
            "to_next"
          ],
          "line": 167
        },
        "resolved": true,
        "details": {
          "function_name": "customcodecvt_do_conversion",
          "container": "customcodecvt",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "92-110",
          "snippet": "static void customcodecvt_do_conversion( std::mbstate_t& /*state*/,\n\t\t\tconst char_t_from* from,\n\t\t\tconst char_t_from* from_end,\n\t\t\tconst char_t_from*& from_next,\n\t\t\tchar_t_to* to,\n\t\t\tchar_t_to* to_end,\n\t\t\tchar_t_to*& to_next )\n\t\t{\n\t\t\ttypedef typename ucs4_convert_impl::convert_impl<char_t_from>::type impl_type_from;\n\t\t\ttypedef typename ucs4_convert_impl::convert_impl<char_t_to>::type impl_type_to;\n\n\t\t\tfrom_next = from;\n\t\t\tto_next = to;\n\t\t\tcustomcodecvt_do_conversion_writer<char_t_to> writer(to_next, to_end);\n\t\t\twhile(from_next != from_end)\n\t\t\t{\n\t\t\t\timpl_type_to::write(writer, impl_type_from::read(from_next, from_end));\n\t\t\t}\n\t\t}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\ncustomcodecvt {\n  static void customcodecvt_do_conversion( std::mbstate_t& /*state*/,\n  \t\t\tconst char_t_from* from,\n  \t\t\tconst char_t_from* from_end,\n  \t\t\tconst char_t_from*& from_next,\n  \t\t\tchar_t_to* to,\n  \t\t\tchar_t_to* to_end,\n  \t\t\tchar_t_to*& to_next )\n  \t\t{\n  \t\t\ttypedef typename ucs4_convert_impl::convert_impl<char_t_from>::type impl_type_from;\n  \t\t\ttypedef typename ucs4_convert_impl::convert_impl<char_t_to>::type impl_type_to;\n  \n  \t\t\tfrom_next = from;\n  \t\t\tto_next = to;\n  \t\t\tcustomcodecvt_do_conversion_writer<char_t_to> writer(to_next, to_end);\n  \t\t\twhile(from_next != from_end)\n  \t\t\t{\n  \t\t\t\timpl_type_to::write(writer, impl_type_from::read(from_next, from_end));\n  \t\t\t}\n  \t\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\n#define ERR_FS LOG_STREAM(err, log_filesystem)\n\ncustomcodecvt {\n  std::codecvt_base::result do_out( std::mbstate_t& state,\n  \t\t\tconst wchar_t* from,\n  \t\t\tconst wchar_t* from_end,\n  \t\t\tconst wchar_t*& from_next,\n  \t\t\tchar* to,\n  \t\t\tchar* to_end,\n  \t\t\tchar*& to_next ) const\n  \t\t{\n  \t\t\ttry\n  \t\t\t{\n  \t\t\t\tcustomcodecvt_do_conversion<wchar_t, char>(state, from, from_end, from_next, to, to_end, to_next);\n  \t\t\t}\n  \t\t\tcatch(...)\n  \t\t\t{\n  \t\t\t\tERR_FS << \"Invalid UTF-16 string\" << std::endl;\n  \t\t\t\treturn std::codecvt_base::error;\t\n  \t\t\t}\n  \t\t\treturn std::codecvt_base::ok;\n  \t\t}\n}"
  },
  {
    "function_name": "do_in",
    "container": "customcodecvt",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "137-155",
    "snippet": "std::codecvt_base::result do_in( std::mbstate_t& state,\n\t\t\tconst char* from,\n\t\t\tconst char* from_end,\n\t\t\tconst char*& from_next,\n\t\t\twchar_t* to,\n\t\t\twchar_t* to_end,\n\t\t\twchar_t*& to_next ) const\n\t\t{\n\t\t\ttry\n\t\t\t{\n\t\t\t\tcustomcodecvt_do_conversion<char, wchar_t>(state, from, from_end, from_next, to, to_end, to_next);\n\t\t\t}\n\t\t\tcatch(...)\n\t\t\t{\n\t\t\t\tERR_FS << \"Invalid UTF-8 string'\" << std::string(from, from_end) << \"' \" << std::endl;\n\t\t\t\treturn std::codecvt_base::error;\n\t\t\t}\n\t\t\treturn std::codecvt_base::ok;\n\t\t}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [
      "#define ERR_FS LOG_STREAM(err, log_filesystem)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "from",
            "from_end"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "customcodecvt_do_conversion<char, wchar_t>",
          "args": [
            "state",
            "from",
            "from_end",
            "from_next",
            "to",
            "to_end",
            "to_next"
          ],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "customcodecvt_do_conversion",
          "container": "customcodecvt",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
          "lines": "92-110",
          "snippet": "static void customcodecvt_do_conversion( std::mbstate_t& /*state*/,\n\t\t\tconst char_t_from* from,\n\t\t\tconst char_t_from* from_end,\n\t\t\tconst char_t_from*& from_next,\n\t\t\tchar_t_to* to,\n\t\t\tchar_t_to* to_end,\n\t\t\tchar_t_to*& to_next )\n\t\t{\n\t\t\ttypedef typename ucs4_convert_impl::convert_impl<char_t_from>::type impl_type_from;\n\t\t\ttypedef typename ucs4_convert_impl::convert_impl<char_t_to>::type impl_type_to;\n\n\t\t\tfrom_next = from;\n\t\t\tto_next = to;\n\t\t\tcustomcodecvt_do_conversion_writer<char_t_to> writer(to_next, to_end);\n\t\t\twhile(from_next != from_end)\n\t\t\t{\n\t\t\t\timpl_type_to::write(writer, impl_type_from::read(from_next, from_end));\n\t\t\t}\n\t\t}",
          "includes": [
            "#include \"version.hpp\"",
            "#include \"util.hpp\"",
            "#include \"log.hpp\"",
            "#include \"game_config.hpp\"",
            "#include \"config.hpp\"",
            "#include <windows.h>",
            "#include <boost/locale.hpp>",
            "#include <set>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/device/file_descriptor.hpp>",
            "#include <boost/system/windows_error.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include \"serialization/unicode.hpp\"",
            "#include \"filesystem.hpp\"",
            "#include \"global.hpp\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\ncustomcodecvt {\n  static void customcodecvt_do_conversion( std::mbstate_t& /*state*/,\n  \t\t\tconst char_t_from* from,\n  \t\t\tconst char_t_from* from_end,\n  \t\t\tconst char_t_from*& from_next,\n  \t\t\tchar_t_to* to,\n  \t\t\tchar_t_to* to_end,\n  \t\t\tchar_t_to*& to_next )\n  \t\t{\n  \t\t\ttypedef typename ucs4_convert_impl::convert_impl<char_t_from>::type impl_type_from;\n  \t\t\ttypedef typename ucs4_convert_impl::convert_impl<char_t_to>::type impl_type_to;\n  \n  \t\t\tfrom_next = from;\n  \t\t\tto_next = to;\n  \t\t\tcustomcodecvt_do_conversion_writer<char_t_to> writer(to_next, to_end);\n  \t\t\twhile(from_next != from_end)\n  \t\t\t{\n  \t\t\t\timpl_type_to::write(writer, impl_type_from::read(from_next, from_end));\n  \t\t\t}\n  \t\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\n#define ERR_FS LOG_STREAM(err, log_filesystem)\n\ncustomcodecvt {\n  std::codecvt_base::result do_in( std::mbstate_t& state,\n  \t\t\tconst char* from,\n  \t\t\tconst char* from_end,\n  \t\t\tconst char*& from_next,\n  \t\t\twchar_t* to,\n  \t\t\twchar_t* to_end,\n  \t\t\twchar_t*& to_next ) const\n  \t\t{\n  \t\t\ttry\n  \t\t\t{\n  \t\t\t\tcustomcodecvt_do_conversion<char, wchar_t>(state, from, from_end, from_next, to, to_end, to_next);\n  \t\t\t}\n  \t\t\tcatch(...)\n  \t\t\t{\n  \t\t\t\tERR_FS << \"Invalid UTF-8 string'\" << std::string(from, from_end) << \"' \" << std::endl;\n  \t\t\t\treturn std::codecvt_base::error;\n  \t\t\t}\n  \t\t\treturn std::codecvt_base::ok;\n  \t\t}\n}"
  },
  {
    "function_name": "unshift",
    "container": "customcodecvt",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "127-134",
    "snippet": "std::codecvt_base::result unshift( std::mbstate_t& /*state*/,\n\t\t\tchar* /*to*/,\n\t\t\tchar* /*to_end*/,\n\t\t\tchar*& /*to_next*/) const\n\t\t{\n\t\t\t//Not used by boost filesystem\n\t\t\tthrow \"Not supported\";\n\t\t}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [
      "static lg::log_domain log_filesystem(\"filesystem\");"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstatic lg::log_domain log_filesystem(\"filesystem\");\n\ncustomcodecvt {\n  std::codecvt_base::result unshift( std::mbstate_t& /*state*/,\n  \t\t\tchar* /*to*/,\n  \t\t\tchar* /*to_end*/,\n  \t\t\tchar*& /*to_next*/) const\n  \t\t{\n  \t\t\t//Not used by boost filesystem\n  \t\t\tthrow \"Not supported\";\n  \t\t}\n}"
  },
  {
    "function_name": "do_length",
    "container": "customcodecvt",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "118-125",
    "snippet": "int do_length( std::mbstate_t& /*state*/,\n\t\t\tconst char* /*from*/,\n\t\t\tconst char* /*from_end*/,\n\t\t\tstd::size_t /*max*/ ) const\n\t\t{\n\t\t\t//Not used by boost filesystem\n\t\t\tthrow \"Not supported\";\n\t\t}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [
      "static lg::log_domain log_filesystem(\"filesystem\");"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\nstatic lg::log_domain log_filesystem(\"filesystem\");\n\ncustomcodecvt {\n  int do_length( std::mbstate_t& /*state*/,\n  \t\t\tconst char* /*from*/,\n  \t\t\tconst char* /*from_end*/,\n  \t\t\tstd::size_t /*max*/ ) const\n  \t\t{\n  \t\t\t//Not used by boost filesystem\n  \t\t\tthrow \"Not supported\";\n  \t\t}\n}"
  },
  {
    "function_name": "do_always_noconv",
    "container": "customcodecvt",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "117-117",
    "snippet": "bool do_always_noconv() const throw() { return false; }",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\ncustomcodecvt {\n  bool do_always_noconv() const throw() { return false; }\n}"
  },
  {
    "function_name": "do_encoding",
    "container": "customcodecvt",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "115-115",
    "snippet": "int do_encoding() const throw() { return 0; }",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\ncustomcodecvt {\n  int do_encoding() const throw() { return 0; }\n}"
  },
  {
    "function_name": "customcodecvt_do_conversion",
    "container": "customcodecvt",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "92-110",
    "snippet": "static void customcodecvt_do_conversion( std::mbstate_t& /*state*/,\n\t\t\tconst char_t_from* from,\n\t\t\tconst char_t_from* from_end,\n\t\t\tconst char_t_from*& from_next,\n\t\t\tchar_t_to* to,\n\t\t\tchar_t_to* to_end,\n\t\t\tchar_t_to*& to_next )\n\t\t{\n\t\t\ttypedef typename ucs4_convert_impl::convert_impl<char_t_from>::type impl_type_from;\n\t\t\ttypedef typename ucs4_convert_impl::convert_impl<char_t_to>::type impl_type_to;\n\n\t\t\tfrom_next = from;\n\t\t\tto_next = to;\n\t\t\tcustomcodecvt_do_conversion_writer<char_t_to> writer(to_next, to_end);\n\t\t\twhile(from_next != from_end)\n\t\t\t{\n\t\t\t\timpl_type_to::write(writer, impl_type_from::read(from_next, from_end));\n\t\t\t}\n\t\t}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "impl_type_to::write",
          "args": [
            "writer",
            "impl_type_from::read(from_next, from_end)"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "impl_type_from::read",
          "args": [
            "from_next",
            "from_end"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\ncustomcodecvt {\n  static void customcodecvt_do_conversion( std::mbstate_t& /*state*/,\n  \t\t\tconst char_t_from* from,\n  \t\t\tconst char_t_from* from_end,\n  \t\t\tconst char_t_from*& from_next,\n  \t\t\tchar_t_to* to,\n  \t\t\tchar_t_to* to_end,\n  \t\t\tchar_t_to*& to_next )\n  \t\t{\n  \t\t\ttypedef typename ucs4_convert_impl::convert_impl<char_t_from>::type impl_type_from;\n  \t\t\ttypedef typename ucs4_convert_impl::convert_impl<char_t_to>::type impl_type_to;\n  \n  \t\t\tfrom_next = from;\n  \t\t\tto_next = to;\n  \t\t\tcustomcodecvt_do_conversion_writer<char_t_to> writer(to_next, to_end);\n  \t\t\twhile(from_next != from_end)\n  \t\t\t{\n  \t\t\t\timpl_type_to::write(writer, impl_type_from::read(from_next, from_end));\n  \t\t\t}\n  \t\t}\n}"
  },
  {
    "function_name": "push",
    "container": "customcodecvt::customcodecvt_do_conversion_writer",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "84-88",
    "snippet": "void push(char_t_to val)\n\t\t\t{\n\t\t\t\tassert(to_next != to_end);\n\t\t\t\t*to_next++  = val;\n\t\t\t}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "to_next != to_end"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\ncustomcodecvt {\n  customcodecvt_do_conversion_writer {\n    void push(char_t_to val)\n    \t\t\t{\n    \t\t\t\tassert(to_next != to_end);\n    \t\t\t\t*to_next++  = val;\n    \t\t\t}\n  }\n}"
  },
  {
    "function_name": "can_push",
    "container": "customcodecvt::customcodecvt_do_conversion_writer",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "79-82",
    "snippet": "bool can_push(size_t count)\n\t\t\t{\n\t\t\t\treturn static_cast<size_t>(to_end - to_next) > count;\n\t\t\t}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "static_cast<size_t>",
          "args": [
            "to_end - to_next"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\ncustomcodecvt {\n  customcodecvt_do_conversion_writer {\n    bool can_push(size_t count)\n    \t\t\t{\n    \t\t\t\treturn static_cast<size_t>(to_end - to_next) > count;\n    \t\t\t}\n  }\n}"
  },
  {
    "function_name": "customcodecvt_do_conversion_writer",
    "container": "customcodecvt::customcodecvt_do_conversion_writer",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-5069/snippet_2/code_before.cpp",
    "lines": "72-75",
    "snippet": "customcodecvt_do_conversion_writer(char_t_to*& _to_next, char_t_to* _to_end) :\n\t\t\t\tto_next(_to_next),\n\t\t\t\tto_end(_to_end)\n\t\t\t{}",
    "includes": [
      "#include \"version.hpp\"",
      "#include \"util.hpp\"",
      "#include \"log.hpp\"",
      "#include \"game_config.hpp\"",
      "#include \"config.hpp\"",
      "#include <windows.h>",
      "#include <boost/locale.hpp>",
      "#include <set>",
      "#include <boost/iostreams/stream.hpp>",
      "#include <boost/iostreams/device/file_descriptor.hpp>",
      "#include <boost/system/windows_error.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <boost/filesystem/fstream.hpp>",
      "#include <boost/filesystem.hpp>",
      "#include \"serialization/unicode.hpp\"",
      "#include \"filesystem.hpp\"",
      "#include \"global.hpp\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"version.hpp\"\n#include \"util.hpp\"\n#include \"log.hpp\"\n#include \"game_config.hpp\"\n#include \"config.hpp\"\n#include <windows.h>\n#include <boost/locale.hpp>\n#include <set>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/device/file_descriptor.hpp>\n#include <boost/system/windows_error.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include \"serialization/unicode.hpp\"\n#include \"filesystem.hpp\"\n#include \"global.hpp\"\n\ncustomcodecvt {\n  customcodecvt_do_conversion_writer {\n    customcodecvt_do_conversion_writer(char_t_to*& _to_next, char_t_to* _to_end) :\n    \t\t\t\tto_next(_to_next),\n    \t\t\t\tto_end(_to_end)\n    \t\t\t{}\n  }\n}"
  }
]