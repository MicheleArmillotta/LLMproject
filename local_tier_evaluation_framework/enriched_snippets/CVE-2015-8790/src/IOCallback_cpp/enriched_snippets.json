[
  {
    "function_name": "IOCallback::readFully",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/IOCallback.cpp",
    "lines": "67-79",
    "snippet": "void IOCallback::readFully(void*Buffer,size_t Size)\n{\n  if(Buffer == NULL)\n    throw;\n\n  if(read(Buffer,Size) != Size) {\n#if !defined(__GNUC__) || (__GNUC__ > 2)\n    stringstream Msg;\n    Msg<<\"EOF in readFully(\"<<Buffer<<\",\"<<Size<<\")\";\n    throw runtime_error(Msg.str());\n#endif // GCC2\n  }\n}",
    "includes": [
      "#include \"ebml/IOCallback.h\"",
      "#include <stdexcept>",
      "#include <sstream>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "runtime_error",
          "args": [
            "Msg.str()"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Msg.str",
          "args": [],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "read",
          "args": [
            "Buffer",
            "Size"
          ],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "StdIOCallback::read",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/StdIOCallback.cpp",
          "lines": "104-111",
          "snippet": "uint32 StdIOCallback::read(void*Buffer,size_t Size)\n{\n  assert(File!=0);\n\n  size_t result = fread(Buffer, 1, Size, File);\n  mCurrentPosition += result;\n  return result;\n}",
          "includes": [
            "#include \"ebml/EbmlConfig.h\"",
            "#include \"ebml/Debug.h\"",
            "#include \"ebml/StdIOCallback.h\"",
            "#include <sstream>",
            "#include <climits>",
            "#include <cassert>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/EbmlConfig.h\"\n#include \"ebml/Debug.h\"\n#include \"ebml/StdIOCallback.h\"\n#include <sstream>\n#include <climits>\n#include <cassert>\n\nuint32 StdIOCallback::read(void*Buffer,size_t Size)\n{\n  assert(File!=0);\n\n  size_t result = fread(Buffer, 1, Size, File);\n  mCurrentPosition += result;\n  return result;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ebml/IOCallback.h\"\n#include <stdexcept>\n#include <sstream>\n\nvoid IOCallback::readFully(void*Buffer,size_t Size)\n{\n  if(Buffer == NULL)\n    throw;\n\n  if(read(Buffer,Size) != Size) {\n#if !defined(__GNUC__) || (__GNUC__ > 2)\n    stringstream Msg;\n    Msg<<\"EOF in readFully(\"<<Buffer<<\",\"<<Size<<\")\";\n    throw runtime_error(Msg.str());\n#endif // GCC2\n  }\n}"
  },
  {
    "function_name": "IOCallback::writeFully",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/IOCallback.cpp",
    "lines": "46-63",
    "snippet": "START_LIBEBML_NAMESPACE\n\nvoid IOCallback::writeFully(const void*Buffer,size_t Size)\n{\n  if (Size == 0)\n    return;\n\n  if (Buffer == NULL)\n    throw;\n\n  if(write(Buffer,Size) != Size) {\n#if !defined(__GNUC__) || (__GNUC__ > 2)\n    stringstream Msg;\n    Msg<<\"EOF in writeFully(\"<<Buffer<<\",\"<<Size<<\")\";\n    throw runtime_error(Msg.str());\n#endif // GCC2\n  }\n}",
    "includes": [
      "#include \"ebml/IOCallback.h\"",
      "#include <stdexcept>",
      "#include <sstream>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "runtime_error",
          "args": [
            "Msg.str()"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Msg.str",
          "args": [],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "write",
          "args": [
            "Buffer",
            "Size"
          ],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "StdIOCallback::write",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/StdIOCallback.cpp",
          "lines": "151-157",
          "snippet": "size_t StdIOCallback::write(const void*Buffer,size_t Size)\n{\n  assert(File!=0);\n  uint32 Result = fwrite(Buffer,1,Size,File);\n  mCurrentPosition += Result;\n  return Result;\n}",
          "includes": [
            "#include \"ebml/EbmlConfig.h\"",
            "#include \"ebml/Debug.h\"",
            "#include \"ebml/StdIOCallback.h\"",
            "#include <sstream>",
            "#include <climits>",
            "#include <cassert>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/EbmlConfig.h\"\n#include \"ebml/Debug.h\"\n#include \"ebml/StdIOCallback.h\"\n#include <sstream>\n#include <climits>\n#include <cassert>\n\nsize_t StdIOCallback::write(const void*Buffer,size_t Size)\n{\n  assert(File!=0);\n  uint32 Result = fwrite(Buffer,1,Size,File);\n  mCurrentPosition += Result;\n  return Result;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ebml/IOCallback.h\"\n#include <stdexcept>\n#include <sstream>\n\nSTART_LIBEBML_NAMESPACE\n\nvoid IOCallback::writeFully(const void*Buffer,size_t Size)\n{\n  if (Size == 0)\n    return;\n\n  if (Buffer == NULL)\n    throw;\n\n  if(write(Buffer,Size) != Size) {\n#if !defined(__GNUC__) || (__GNUC__ > 2)\n    stringstream Msg;\n    Msg<<\"EOF in writeFully(\"<<Buffer<<\",\"<<Size<<\")\";\n    throw runtime_error(Msg.str());\n#endif // GCC2\n  }\n}"
  }
]