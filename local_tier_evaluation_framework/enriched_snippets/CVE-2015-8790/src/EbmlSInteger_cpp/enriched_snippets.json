[
  {
    "function_name": "EbmlSInteger::IsSmallerThan",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlSInteger.cpp",
    "lines": "145-151",
    "snippet": "bool EbmlSInteger::IsSmallerThan(const EbmlElement *Cmp) const\n{\n  if (EbmlId(*this) == EbmlId(*Cmp))\n    return this->Value < static_cast<const EbmlSInteger *>(Cmp)->Value;\n  else\n    return false;\n}",
    "includes": [
      "#include \"ebml/EbmlSInteger.h\"",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "static_cast<const EbmlSInteger *>",
          "args": [
            "Cmp"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EbmlId",
          "args": [
            "*Cmp"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EbmlId",
          "args": [
            "*this"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/EbmlSInteger.h\"\n#include <cassert>\n\nbool EbmlSInteger::IsSmallerThan(const EbmlElement *Cmp) const\n{\n  if (EbmlId(*this) == EbmlId(*Cmp))\n    return this->Value < static_cast<const EbmlSInteger *>(Cmp)->Value;\n  else\n    return false;\n}"
  },
  {
    "function_name": "EbmlSInteger::ReadData",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlSInteger.cpp",
    "lines": "124-143",
    "snippet": "filepos_t EbmlSInteger::ReadData(IOCallback & input, ScopeMode ReadFully)\n{\n  if (ReadFully != SCOPE_NO_DATA) {\n    binary Buffer[8];\n    input.readFully(Buffer, GetSize());\n\n    if (Buffer[0] & 0x80)\n      Value = -1; // this is a negative value\n    else\n      Value = 0; // this is a positive value\n\n    for (unsigned int i=0; i<GetSize(); i++) {\n      Value <<= 8;\n      Value |= Buffer[i];\n    }\n    SetValueIsSet();\n  }\n\n  return GetSize();\n}",
    "includes": [
      "#include \"ebml/EbmlSInteger.h\"",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetSize",
          "args": [],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "SafeReadIOCallback::GetSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/SafeReadIOCallback.cpp",
          "lines": "88-92",
          "snippet": "size_t\nSafeReadIOCallback::GetSize()\n  const {\n  return mSize;\n}",
          "includes": [
            "#include \"ebml/SafeReadIOCallback.h\"",
            "#include \"ebml/MemReadIOCallback.h\"",
            "#include \"ebml/EbmlBinary.h\"",
            "#include <cstring>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/SafeReadIOCallback.h\"\n#include \"ebml/MemReadIOCallback.h\"\n#include \"ebml/EbmlBinary.h\"\n#include <cstring>\n\nsize_t\nSafeReadIOCallback::GetSize()\n  const {\n  return mSize;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SetValueIsSet",
          "args": [],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "input.readFully",
          "args": [
            "Buffer",
            "GetSize()"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/EbmlSInteger.h\"\n#include <cassert>\n\nfilepos_t EbmlSInteger::ReadData(IOCallback & input, ScopeMode ReadFully)\n{\n  if (ReadFully != SCOPE_NO_DATA) {\n    binary Buffer[8];\n    input.readFully(Buffer, GetSize());\n\n    if (Buffer[0] & 0x80)\n      Value = -1; // this is a negative value\n    else\n      Value = 0; // this is a positive value\n\n    for (unsigned int i=0; i<GetSize(); i++) {\n      Value <<= 8;\n      Value |= Buffer[i];\n    }\n    SetValueIsSet();\n  }\n\n  return GetSize();\n}"
  },
  {
    "function_name": "EbmlSInteger::UpdateSize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlSInteger.cpp",
    "lines": "91-122",
    "snippet": "uint64 EbmlSInteger::UpdateSize(bool bWithDefault, bool /* bForceRender */)\n{\n  if (!bWithDefault && IsDefaultValue())\n    return 0;\n\n  if (Value <= 0x7F && Value >= (-0x80)) {\n    SetSize_(1);\n  } else if (Value <= 0x7FFF && Value >= (-0x8000)) {\n    SetSize_(2);\n  } else if (Value <= 0x7FFFFF && Value >= (-0x800000)) {\n    SetSize_(3);\n  } else if (Value <= EBML_PRETTYLONGINT(0x7FFFFFFF) && Value >= (EBML_PRETTYLONGINT(-0x80000000))) {\n    SetSize_(4);\n  } else if (Value <= EBML_PRETTYLONGINT(0x7FFFFFFFFF) &&\n             Value >= EBML_PRETTYLONGINT(-0x8000000000)) {\n    SetSize_(5);\n  } else if (Value <= EBML_PRETTYLONGINT(0x7FFFFFFFFFFF) &&\n             Value >= EBML_PRETTYLONGINT(-0x800000000000)) {\n    SetSize_(6);\n  } else if (Value <= EBML_PRETTYLONGINT(0x7FFFFFFFFFFFFF) &&\n             Value >= EBML_PRETTYLONGINT(-0x80000000000000)) {\n    SetSize_(7);\n  } else {\n    SetSize_(8);\n  }\n\n  if (GetDefaultSize() > GetSize()) {\n    SetSize_(GetDefaultSize());\n  }\n\n  return GetSize();\n}",
    "includes": [
      "#include \"ebml/EbmlSInteger.h\"",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetSize",
          "args": [],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "SafeReadIOCallback::GetSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/SafeReadIOCallback.cpp",
          "lines": "88-92",
          "snippet": "size_t\nSafeReadIOCallback::GetSize()\n  const {\n  return mSize;\n}",
          "includes": [
            "#include \"ebml/SafeReadIOCallback.h\"",
            "#include \"ebml/MemReadIOCallback.h\"",
            "#include \"ebml/EbmlBinary.h\"",
            "#include <cstring>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/SafeReadIOCallback.h\"\n#include \"ebml/MemReadIOCallback.h\"\n#include \"ebml/EbmlBinary.h\"\n#include <cstring>\n\nsize_t\nSafeReadIOCallback::GetSize()\n  const {\n  return mSize;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SetSize_",
          "args": [
            "GetDefaultSize()"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetDefaultSize",
          "args": [],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetDefaultSize",
          "args": [],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SetSize_",
          "args": [
            "8"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SetSize_",
          "args": [
            "7"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBML_PRETTYLONGINT",
          "args": [
            "-0x80000000000000"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBML_PRETTYLONGINT",
          "args": [
            "0x7FFFFFFFFFFFFF"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SetSize_",
          "args": [
            "6"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBML_PRETTYLONGINT",
          "args": [
            "-0x800000000000"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBML_PRETTYLONGINT",
          "args": [
            "0x7FFFFFFFFFFF"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SetSize_",
          "args": [
            "5"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBML_PRETTYLONGINT",
          "args": [
            "-0x8000000000"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBML_PRETTYLONGINT",
          "args": [
            "0x7FFFFFFFFF"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SetSize_",
          "args": [
            "4"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBML_PRETTYLONGINT",
          "args": [
            "-0x80000000"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBML_PRETTYLONGINT",
          "args": [
            "0x7FFFFFFF"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SetSize_",
          "args": [
            "3"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SetSize_",
          "args": [
            "2"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SetSize_",
          "args": [
            "1"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IsDefaultValue",
          "args": [],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/EbmlSInteger.h\"\n#include <cassert>\n\nuint64 EbmlSInteger::UpdateSize(bool bWithDefault, bool /* bForceRender */)\n{\n  if (!bWithDefault && IsDefaultValue())\n    return 0;\n\n  if (Value <= 0x7F && Value >= (-0x80)) {\n    SetSize_(1);\n  } else if (Value <= 0x7FFF && Value >= (-0x8000)) {\n    SetSize_(2);\n  } else if (Value <= 0x7FFFFF && Value >= (-0x800000)) {\n    SetSize_(3);\n  } else if (Value <= EBML_PRETTYLONGINT(0x7FFFFFFF) && Value >= (EBML_PRETTYLONGINT(-0x80000000))) {\n    SetSize_(4);\n  } else if (Value <= EBML_PRETTYLONGINT(0x7FFFFFFFFF) &&\n             Value >= EBML_PRETTYLONGINT(-0x8000000000)) {\n    SetSize_(5);\n  } else if (Value <= EBML_PRETTYLONGINT(0x7FFFFFFFFFFF) &&\n             Value >= EBML_PRETTYLONGINT(-0x800000000000)) {\n    SetSize_(6);\n  } else if (Value <= EBML_PRETTYLONGINT(0x7FFFFFFFFFFFFF) &&\n             Value >= EBML_PRETTYLONGINT(-0x80000000000000)) {\n    SetSize_(7);\n  } else {\n    SetSize_(8);\n  }\n\n  if (GetDefaultSize() > GetSize()) {\n    SetSize_(GetDefaultSize());\n  }\n\n  return GetSize();\n}"
  },
  {
    "function_name": "EbmlSInteger::RenderData",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlSInteger.cpp",
    "lines": "72-89",
    "snippet": "filepos_t EbmlSInteger::RenderData(IOCallback & output, bool /* bForceRender */, bool /* bWithDefault */)\n{\n  binary FinalData[8]; // we don't handle more than 64 bits integers\n  unsigned int i;\n\n  if (GetSizeLength() > 8)\n    return 0; // integer bigger coded on more than 64 bits are not supported\n\n  int64 TempValue = Value;\n  for (i=0; i<GetSize();i++) {\n    FinalData[GetSize()-i-1] = binary(TempValue & 0xFF);\n    TempValue >>= 8;\n  }\n\n  output.writeFully(FinalData,GetSize());\n\n  return GetSize();\n}",
    "includes": [
      "#include \"ebml/EbmlSInteger.h\"",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetSize",
          "args": [],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "SafeReadIOCallback::GetSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/SafeReadIOCallback.cpp",
          "lines": "88-92",
          "snippet": "size_t\nSafeReadIOCallback::GetSize()\n  const {\n  return mSize;\n}",
          "includes": [
            "#include \"ebml/SafeReadIOCallback.h\"",
            "#include \"ebml/MemReadIOCallback.h\"",
            "#include \"ebml/EbmlBinary.h\"",
            "#include <cstring>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/SafeReadIOCallback.h\"\n#include \"ebml/MemReadIOCallback.h\"\n#include \"ebml/EbmlBinary.h\"\n#include <cstring>\n\nsize_t\nSafeReadIOCallback::GetSize()\n  const {\n  return mSize;\n}"
        }
      },
      {
        "call_info": {
          "callee": "output.writeFully",
          "args": [
            "FinalData",
            "GetSize()"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "binary",
          "args": [
            "TempValue & 0xFF"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetSizeLength",
          "args": [],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/EbmlSInteger.h\"\n#include <cassert>\n\nfilepos_t EbmlSInteger::RenderData(IOCallback & output, bool /* bForceRender */, bool /* bWithDefault */)\n{\n  binary FinalData[8]; // we don't handle more than 64 bits integers\n  unsigned int i;\n\n  if (GetSizeLength() > 8)\n    return 0; // integer bigger coded on more than 64 bits are not supported\n\n  int64 TempValue = Value;\n  for (i=0; i<GetSize();i++) {\n    FinalData[GetSize()-i-1] = binary(TempValue & 0xFF);\n    TempValue >>= 8;\n  }\n\n  output.writeFully(FinalData,GetSize());\n\n  return GetSize();\n}"
  },
  {
    "function_name": "EbmlSInteger::GetValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlSInteger.cpp",
    "lines": "63-63",
    "snippet": "int64 EbmlSInteger::GetValue() const {return Value;}",
    "includes": [
      "#include \"ebml/EbmlSInteger.h\"",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ebml/EbmlSInteger.h\"\n#include <cassert>\n\nint64 EbmlSInteger::GetValue() const {return Value;}"
  },
  {
    "function_name": "EbmlSInteger::EbmlSInteger",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlSInteger.cpp",
    "lines": "51-56",
    "snippet": "EbmlSInteger::EbmlSInteger(const EbmlSInteger & ElementToClone)\n  :EbmlElement(ElementToClone)\n  ,Value(ElementToClone.Value)\n  ,DefaultValue(ElementToClone.DefaultValue)\n{\n}",
    "includes": [
      "#include \"ebml/EbmlSInteger.h\"",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ebml/EbmlSInteger.h\"\n#include <cassert>\n\nEbmlSInteger::EbmlSInteger(const EbmlSInteger & ElementToClone)\n  :EbmlElement(ElementToClone)\n  ,Value(ElementToClone.Value)\n  ,DefaultValue(ElementToClone.DefaultValue)\n{\n}"
  },
  {
    "function_name": "EbmlSInteger::EbmlSInteger",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlSInteger.cpp",
    "lines": "45-49",
    "snippet": "EbmlSInteger::EbmlSInteger(int64 aDefaultValue)\n  :EbmlElement(DEFAULT_INT_SIZE, true), Value(aDefaultValue)\n{\n  SetDefaultIsSet();\n}",
    "includes": [
      "#include \"ebml/EbmlSInteger.h\"",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetDefaultIsSet",
          "args": [],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/EbmlSInteger.h\"\n#include <cassert>\n\nEbmlSInteger::EbmlSInteger(int64 aDefaultValue)\n  :EbmlElement(DEFAULT_INT_SIZE, true), Value(aDefaultValue)\n{\n  SetDefaultIsSet();\n}"
  },
  {
    "function_name": "EbmlElement",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlSInteger.cpp",
    "lines": "39-43",
    "snippet": "START_LIBEBML_NAMESPACE\n\nEbmlSInteger::EbmlSInteger()\n  :EbmlElement(DEFAULT_INT_SIZE, false)\n{}",
    "includes": [
      "#include \"ebml/EbmlSInteger.h\"",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"ebml/EbmlSInteger.h\"\n#include <cassert>\n\nSTART_LIBEBML_NAMESPACE\n\nEbmlSInteger::EbmlSInteger()\n  :EbmlElement(DEFAULT_INT_SIZE, false)\n{}"
  }
]