[
  {
    "function_name": "operator==",
    "container": "EbmlBinary",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlBinary.cpp",
    "lines": "101-104",
    "snippet": "bool EbmlBinary::operator==(const EbmlBinary & ElementToCompare) const\n{\n  return ((GetSize() == ElementToCompare.GetSize()) && !memcmp(Data, ElementToCompare.Data, GetSize()));\n}",
    "includes": [
      "#include \"ebml/StdIOCallback.h\"",
      "#include \"ebml/EbmlBinary.h\"",
      "#include <string>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "Data",
            "ElementToCompare.Data",
            "GetSize()"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetSize",
          "args": [],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "GetSize",
          "container": "SafeReadIOCallback",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/SafeReadIOCallback.cpp",
          "lines": "88-92",
          "snippet": "size_t\nSafeReadIOCallback::GetSize()\n  const {\n  return mSize;\n}",
          "includes": [
            "#include \"ebml/SafeReadIOCallback.h\"",
            "#include \"ebml/MemReadIOCallback.h\"",
            "#include \"ebml/EbmlBinary.h\"",
            "#include <cstring>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/SafeReadIOCallback.h\"\n#include \"ebml/MemReadIOCallback.h\"\n#include \"ebml/EbmlBinary.h\"\n#include <cstring>\n\nSafeReadIOCallback {\n  size_t\n  SafeReadIOCallback::GetSize()\n    const {\n    return mSize;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ebml/StdIOCallback.h\"\n#include \"ebml/EbmlBinary.h\"\n#include <string>\n#include <cassert>\n\nEbmlBinary {\n  bool EbmlBinary::operator==(const EbmlBinary & ElementToCompare) const\n  {\n    return ((GetSize() == ElementToCompare.GetSize()) && !memcmp(Data, ElementToCompare.Data, GetSize()));\n  }\n}"
  },
  {
    "function_name": "ReadData",
    "container": "EbmlBinary",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlBinary.cpp",
    "lines": "84-99",
    "snippet": "filepos_t EbmlBinary::ReadData(IOCallback & input, ScopeMode ReadFully)\n{\n  if (Data != NULL)\n    free(Data);\n\n  if (ReadFully == SCOPE_NO_DATA || !GetSize()) {\n    Data = NULL;\n    return GetSize();\n  }\n\n  Data = (binary *)malloc(GetSize());\n  if (Data == NULL)\n    throw CRTError(std::string(\"Error allocating data\"));\n  SetValueIsSet();\n  return input.read(Data, GetSize());\n}",
    "includes": [
      "#include \"ebml/StdIOCallback.h\"",
      "#include \"ebml/EbmlBinary.h\"",
      "#include <string>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [
      "START_LIBEBML_NAMESPACE\n\nEbmlBinary::EbmlBinary()\n  :EbmlElement(0, false), Data(NULL)"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "input.read",
          "args": [
            "Data",
            "GetSize()"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "read",
          "container": "StdIOCallback",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/StdIOCallback.cpp",
          "lines": "104-111",
          "snippet": "uint32 StdIOCallback::read(void*Buffer,size_t Size)\n{\n  assert(File!=0);\n\n  size_t result = fread(Buffer, 1, Size, File);\n  mCurrentPosition += result;\n  return result;\n}",
          "includes": [
            "#include \"ebml/EbmlConfig.h\"",
            "#include \"ebml/Debug.h\"",
            "#include \"ebml/StdIOCallback.h\"",
            "#include <sstream>",
            "#include <climits>",
            "#include <cassert>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/EbmlConfig.h\"\n#include \"ebml/Debug.h\"\n#include \"ebml/StdIOCallback.h\"\n#include <sstream>\n#include <climits>\n#include <cassert>\n\nStdIOCallback {\n  uint32 StdIOCallback::read(void*Buffer,size_t Size)\n  {\n    assert(File!=0);\n  \n    size_t result = fread(Buffer, 1, Size, File);\n    mCurrentPosition += result;\n    return result;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetSize",
          "args": [],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "GetSize",
          "container": "SafeReadIOCallback",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/SafeReadIOCallback.cpp",
          "lines": "88-92",
          "snippet": "size_t\nSafeReadIOCallback::GetSize()\n  const {\n  return mSize;\n}",
          "includes": [
            "#include \"ebml/SafeReadIOCallback.h\"",
            "#include \"ebml/MemReadIOCallback.h\"",
            "#include \"ebml/EbmlBinary.h\"",
            "#include <cstring>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/SafeReadIOCallback.h\"\n#include \"ebml/MemReadIOCallback.h\"\n#include \"ebml/EbmlBinary.h\"\n#include <cstring>\n\nSafeReadIOCallback {\n  size_t\n  SafeReadIOCallback::GetSize()\n    const {\n    return mSize;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SetValueIsSet",
          "args": [],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CRTError",
          "args": [
            "std::string(\"Error allocating data\")"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"Error allocating data\""
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "GetSize()"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "Data"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/StdIOCallback.h\"\n#include \"ebml/EbmlBinary.h\"\n#include <string>\n#include <cassert>\n\nSTART_LIBEBML_NAMESPACE\n\nEbmlBinary::EbmlBinary()\n  :EbmlElement(0, false), Data(NULL);\n\nEbmlBinary {\n  filepos_t EbmlBinary::ReadData(IOCallback & input, ScopeMode ReadFully)\n  {\n    if (Data != NULL)\n      free(Data);\n  \n    if (ReadFully == SCOPE_NO_DATA || !GetSize()) {\n      Data = NULL;\n      return GetSize();\n    }\n  \n    Data = (binary *)malloc(GetSize());\n    if (Data == NULL)\n      throw CRTError(std::string(\"Error allocating data\"));\n    SetValueIsSet();\n    return input.read(Data, GetSize());\n  }\n}"
  },
  {
    "function_name": "UpdateSize",
    "container": "EbmlBinary",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlBinary.cpp",
    "lines": "79-82",
    "snippet": "uint64 EbmlBinary::UpdateSize(bool /* bWithDefault */, bool /* bForceRender */)\n{\n  return GetSize();\n}",
    "includes": [
      "#include \"ebml/StdIOCallback.h\"",
      "#include \"ebml/EbmlBinary.h\"",
      "#include <string>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetSize",
          "args": [],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "GetSize",
          "container": "SafeReadIOCallback",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/SafeReadIOCallback.cpp",
          "lines": "88-92",
          "snippet": "size_t\nSafeReadIOCallback::GetSize()\n  const {\n  return mSize;\n}",
          "includes": [
            "#include \"ebml/SafeReadIOCallback.h\"",
            "#include \"ebml/MemReadIOCallback.h\"",
            "#include \"ebml/EbmlBinary.h\"",
            "#include <cstring>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/SafeReadIOCallback.h\"\n#include \"ebml/MemReadIOCallback.h\"\n#include \"ebml/EbmlBinary.h\"\n#include <cstring>\n\nSafeReadIOCallback {\n  size_t\n  SafeReadIOCallback::GetSize()\n    const {\n    return mSize;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ebml/StdIOCallback.h\"\n#include \"ebml/EbmlBinary.h\"\n#include <string>\n#include <cassert>\n\nEbmlBinary {\n  uint64 EbmlBinary::UpdateSize(bool /* bWithDefault */, bool /* bForceRender */)\n  {\n    return GetSize();\n  }\n}"
  },
  {
    "function_name": "RenderData",
    "container": "EbmlBinary",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlBinary.cpp",
    "lines": "69-74",
    "snippet": "filepos_t EbmlBinary::RenderData(IOCallback & output, bool /* bForceRender */, bool /* bWithDefault */)\n{\n  output.writeFully(Data,GetSize());\n\n  return GetSize();\n}",
    "includes": [
      "#include \"ebml/StdIOCallback.h\"",
      "#include \"ebml/EbmlBinary.h\"",
      "#include <string>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetSize",
          "args": [],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "GetSize",
          "container": "SafeReadIOCallback",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/SafeReadIOCallback.cpp",
          "lines": "88-92",
          "snippet": "size_t\nSafeReadIOCallback::GetSize()\n  const {\n  return mSize;\n}",
          "includes": [
            "#include \"ebml/SafeReadIOCallback.h\"",
            "#include \"ebml/MemReadIOCallback.h\"",
            "#include \"ebml/EbmlBinary.h\"",
            "#include <cstring>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/SafeReadIOCallback.h\"\n#include \"ebml/MemReadIOCallback.h\"\n#include \"ebml/EbmlBinary.h\"\n#include <cstring>\n\nSafeReadIOCallback {\n  size_t\n  SafeReadIOCallback::GetSize()\n    const {\n    return mSize;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "output.writeFully",
          "args": [
            "Data",
            "GetSize()"
          ],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "writeFully",
          "container": "IOCallback",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/IOCallback.cpp",
          "lines": "46-63",
          "snippet": "START_LIBEBML_NAMESPACE\n\nvoid IOCallback::writeFully(const void*Buffer,size_t Size)\n{\n  if (Size == 0)\n    return;\n\n  if (Buffer == NULL)\n    throw;\n\n  if(write(Buffer,Size) != Size) {\n#if !defined(__GNUC__) || (__GNUC__ > 2)\n    stringstream Msg;\n    Msg<<\"EOF in writeFully(\"<<Buffer<<\",\"<<Size<<\")\";\n    throw runtime_error(Msg.str());\n#endif // GCC2\n  }\n}",
          "includes": [
            "#include \"ebml/IOCallback.h\"",
            "#include <stdexcept>",
            "#include <sstream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/IOCallback.h\"\n#include <stdexcept>\n#include <sstream>\n\nIOCallback {\n  START_LIBEBML_NAMESPACE\n  \n  void IOCallback::writeFully(const void*Buffer,size_t Size)\n  {\n    if (Size == 0)\n      return;\n  \n    if (Buffer == NULL)\n      throw;\n  \n    if(write(Buffer,Size) != Size) {\n  #if !defined(__GNUC__) || (__GNUC__ > 2)\n      stringstream Msg;\n      Msg<<\"EOF in writeFully(\"<<Buffer<<\",\"<<Size<<\")\";\n      throw runtime_error(Msg.str());\n  #endif // GCC2\n    }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ebml/StdIOCallback.h\"\n#include \"ebml/EbmlBinary.h\"\n#include <string>\n#include <cassert>\n\nEbmlBinary {\n  filepos_t EbmlBinary::RenderData(IOCallback & output, bool /* bForceRender */, bool /* bWithDefault */)\n  {\n    output.writeFully(Data,GetSize());\n  \n    return GetSize();\n  }\n}"
  },
  {
    "function_name": "~EbmlBinary",
    "container": "EbmlBinary",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlBinary.cpp",
    "lines": "61-64",
    "snippet": "EbmlBinary::~EbmlBinary(void) {\n  if(Data)\n    free(Data);\n}",
    "includes": [
      "#include \"ebml/StdIOCallback.h\"",
      "#include \"ebml/EbmlBinary.h\"",
      "#include <string>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "Data"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/StdIOCallback.h\"\n#include \"ebml/EbmlBinary.h\"\n#include <string>\n#include <cassert>\n\nEbmlBinary {\n  EbmlBinary::~EbmlBinary(void) {\n    if(Data)\n      free(Data);\n  }\n}"
  },
  {
    "function_name": "EbmlBinary",
    "container": "EbmlBinary",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlBinary.cpp",
    "lines": "49-59",
    "snippet": "EbmlBinary::EbmlBinary(const EbmlBinary & ElementToClone)\n  :EbmlElement(ElementToClone)\n{\n  if (ElementToClone.Data == NULL)\n    Data = NULL;\n  else {\n    Data = (binary *)malloc(GetSize() * sizeof(binary));\n    assert(Data != NULL);\n    memcpy(Data, ElementToClone.Data, GetSize());\n  }\n}",
    "includes": [
      "#include \"ebml/StdIOCallback.h\"",
      "#include \"ebml/EbmlBinary.h\"",
      "#include <string>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [
      "START_LIBEBML_NAMESPACE\n\nEbmlBinary::EbmlBinary()\n  :EbmlElement(0, false), Data(NULL)"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "Data",
            "ElementToClone.Data",
            "GetSize()"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetSize",
          "args": [],
          "line": 57
        },
        "resolved": true,
        "details": {
          "function_name": "GetSize",
          "container": "SafeReadIOCallback",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/SafeReadIOCallback.cpp",
          "lines": "88-92",
          "snippet": "size_t\nSafeReadIOCallback::GetSize()\n  const {\n  return mSize;\n}",
          "includes": [
            "#include \"ebml/SafeReadIOCallback.h\"",
            "#include \"ebml/MemReadIOCallback.h\"",
            "#include \"ebml/EbmlBinary.h\"",
            "#include <cstring>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/SafeReadIOCallback.h\"\n#include \"ebml/MemReadIOCallback.h\"\n#include \"ebml/EbmlBinary.h\"\n#include <cstring>\n\nSafeReadIOCallback {\n  size_t\n  SafeReadIOCallback::GetSize()\n    const {\n    return mSize;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "Data != NULL"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "GetSize() * sizeof(binary)"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/StdIOCallback.h\"\n#include \"ebml/EbmlBinary.h\"\n#include <string>\n#include <cassert>\n\nSTART_LIBEBML_NAMESPACE\n\nEbmlBinary::EbmlBinary()\n  :EbmlElement(0, false), Data(NULL);\n\nEbmlBinary {\n  EbmlBinary::EbmlBinary(const EbmlBinary & ElementToClone)\n    :EbmlElement(ElementToClone)\n  {\n    if (ElementToClone.Data == NULL)\n      Data = NULL;\n    else {\n      Data = (binary *)malloc(GetSize() * sizeof(binary));\n      assert(Data != NULL);\n      memcpy(Data, ElementToClone.Data, GetSize());\n    }\n  }\n}"
  }
]