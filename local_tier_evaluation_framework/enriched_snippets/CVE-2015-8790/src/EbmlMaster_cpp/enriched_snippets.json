[
  {
    "function_name": "EbmlMaster::InsertElement",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlMaster.cpp",
    "lines": "556-568",
    "snippet": "bool EbmlMaster::InsertElement(EbmlElement & element, const EbmlElement & before)\n{\n  std::vector<EbmlElement *>::iterator Itr = ElementList.begin();\n  while (Itr != ElementList.end() && *Itr != &before)\n  {\n    ++Itr;\n  }\n  if (Itr == ElementList.end())\n    return false;\n\n  ElementList.insert(Itr, &element);\n  return true;\n}",
    "includes": [
      "#include \"ebml/MemIOCallback.h\"",
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlStream.h\"",
      "#include \"ebml/EbmlMaster.h\"",
      "#include <algorithm>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ElementList.insert",
          "args": [
            "Itr",
            "&element"
          ],
          "line": 566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ElementList.end",
          "args": [],
          "line": 563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ElementList.end",
          "args": [],
          "line": 559
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ElementList.begin",
          "args": [],
          "line": 558
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/MemIOCallback.h\"\n#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include <algorithm>\n#include <cassert>\n\nbool EbmlMaster::InsertElement(EbmlElement & element, const EbmlElement & before)\n{\n  std::vector<EbmlElement *>::iterator Itr = ElementList.begin();\n  while (Itr != ElementList.end() && *Itr != &before)\n  {\n    ++Itr;\n  }\n  if (Itr == ElementList.end())\n    return false;\n\n  ElementList.insert(Itr, &element);\n  return true;\n}"
  },
  {
    "function_name": "EbmlMaster::InsertElement",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlMaster.cpp",
    "lines": "542-554",
    "snippet": "bool EbmlMaster::InsertElement(EbmlElement & element, size_t position)\n{\n  std::vector<EbmlElement *>::iterator Itr = ElementList.begin();\n  while (Itr != ElementList.end() && position--)\n  {\n    ++Itr;\n  }\n  if ((Itr == ElementList.end()) && position)\n    return false;\n\n  ElementList.insert(Itr, &element);\n  return true;\n}",
    "includes": [
      "#include \"ebml/MemIOCallback.h\"",
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlStream.h\"",
      "#include \"ebml/EbmlMaster.h\"",
      "#include <algorithm>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ElementList.insert",
          "args": [
            "Itr",
            "&element"
          ],
          "line": 552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ElementList.end",
          "args": [],
          "line": 549
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ElementList.end",
          "args": [],
          "line": 545
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ElementList.begin",
          "args": [],
          "line": 544
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/MemIOCallback.h\"\n#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include <algorithm>\n#include <cassert>\n\nbool EbmlMaster::InsertElement(EbmlElement & element, size_t position)\n{\n  std::vector<EbmlElement *>::iterator Itr = ElementList.begin();\n  while (Itr != ElementList.end() && position--)\n  {\n    ++Itr;\n  }\n  if ((Itr == ElementList.end()) && position)\n    return false;\n\n  ElementList.insert(Itr, &element);\n  return true;\n}"
  },
  {
    "function_name": "EbmlMaster::VerifyChecksum",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlMaster.cpp",
    "lines": "526-540",
    "snippet": "bool EbmlMaster::VerifyChecksum() const\n{\n  if (!bChecksumUsed)\n    return true;\n\n  EbmlCrc32 aChecksum;\n  /// \\todo remove the Checksum if it's in the list\n  /// \\todo find another way when not all default values are saved or (unknown from the reader !!!)\n  MemIOCallback TmpBuf(GetSize() - 6);\n  for (size_t Index = 0; Index < ElementList.size(); Index++) {\n    (ElementList[Index])->Render(TmpBuf, true, false, true);\n  }\n  aChecksum.FillCRC32(TmpBuf.GetDataBuffer(), TmpBuf.GetDataBufferSize());\n  return (aChecksum.GetCrc32() == Checksum.GetCrc32());\n}",
    "includes": [
      "#include \"ebml/MemIOCallback.h\"",
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlStream.h\"",
      "#include \"ebml/EbmlMaster.h\"",
      "#include <algorithm>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Checksum.GetCrc32",
          "args": [],
          "line": 539
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aChecksum.GetCrc32",
          "args": [],
          "line": 539
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aChecksum.FillCRC32",
          "args": [
            "TmpBuf.GetDataBuffer()",
            "TmpBuf.GetDataBufferSize()"
          ],
          "line": 538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TmpBuf.GetDataBufferSize",
          "args": [],
          "line": 538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TmpBuf.GetDataBuffer",
          "args": [],
          "line": 538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "TmpBuf",
            "true",
            "false",
            "true"
          ],
          "line": 536
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ElementList.size",
          "args": [],
          "line": 535
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetSize",
          "args": [],
          "line": 534
        },
        "resolved": true,
        "details": {
          "function_name": "SafeReadIOCallback::GetSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/SafeReadIOCallback.cpp",
          "lines": "88-92",
          "snippet": "size_t\nSafeReadIOCallback::GetSize()\n  const {\n  return mSize;\n}",
          "includes": [
            "#include \"ebml/SafeReadIOCallback.h\"",
            "#include \"ebml/MemReadIOCallback.h\"",
            "#include \"ebml/EbmlBinary.h\"",
            "#include <cstring>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/SafeReadIOCallback.h\"\n#include \"ebml/MemReadIOCallback.h\"\n#include \"ebml/EbmlBinary.h\"\n#include <cstring>\n\nsize_t\nSafeReadIOCallback::GetSize()\n  const {\n  return mSize;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ebml/MemIOCallback.h\"\n#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include <algorithm>\n#include <cassert>\n\nbool EbmlMaster::VerifyChecksum() const\n{\n  if (!bChecksumUsed)\n    return true;\n\n  EbmlCrc32 aChecksum;\n  /// \\todo remove the Checksum if it's in the list\n  /// \\todo find another way when not all default values are saved or (unknown from the reader !!!)\n  MemIOCallback TmpBuf(GetSize() - 6);\n  for (size_t Index = 0; Index < ElementList.size(); Index++) {\n    (ElementList[Index])->Render(TmpBuf, true, false, true);\n  }\n  aChecksum.FillCRC32(TmpBuf.GetDataBuffer(), TmpBuf.GetDataBufferSize());\n  return (aChecksum.GetCrc32() == Checksum.GetCrc32());\n}"
  },
  {
    "function_name": "EbmlMaster::Remove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlMaster.cpp",
    "lines": "521-524",
    "snippet": "void EbmlMaster::Remove(EBML_MASTER_RITERATOR & Itr)\n{\n  ElementList.erase(Itr.base());\n}",
    "includes": [
      "#include \"ebml/MemIOCallback.h\"",
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlStream.h\"",
      "#include \"ebml/EbmlMaster.h\"",
      "#include <algorithm>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ElementList.erase",
          "args": [
            "Itr.base()"
          ],
          "line": 523
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Itr.base",
          "args": [],
          "line": 523
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/MemIOCallback.h\"\n#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include <algorithm>\n#include <cassert>\n\nvoid EbmlMaster::Remove(EBML_MASTER_RITERATOR & Itr)\n{\n  ElementList.erase(Itr.base());\n}"
  },
  {
    "function_name": "EbmlMaster::Remove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlMaster.cpp",
    "lines": "516-519",
    "snippet": "void EbmlMaster::Remove(EBML_MASTER_ITERATOR & Itr)\n{\n  ElementList.erase(Itr);\n}",
    "includes": [
      "#include \"ebml/MemIOCallback.h\"",
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlStream.h\"",
      "#include \"ebml/EbmlMaster.h\"",
      "#include <algorithm>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ElementList.erase",
          "args": [
            "Itr"
          ],
          "line": 518
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/MemIOCallback.h\"\n#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include <algorithm>\n#include <cassert>\n\nvoid EbmlMaster::Remove(EBML_MASTER_ITERATOR & Itr)\n{\n  ElementList.erase(Itr);\n}"
  },
  {
    "function_name": "EbmlMaster::Remove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlMaster.cpp",
    "lines": "504-514",
    "snippet": "void EbmlMaster::Remove(size_t Index)\n{\n  if (Index < ElementList.size()) {\n    std::vector<EbmlElement *>::iterator Itr = ElementList.begin();\n    while (Index-- > 0) {\n      ++Itr;\n    }\n\n    ElementList.erase(Itr);\n  }\n}",
    "includes": [
      "#include \"ebml/MemIOCallback.h\"",
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlStream.h\"",
      "#include \"ebml/EbmlMaster.h\"",
      "#include <algorithm>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ElementList.erase",
          "args": [
            "Itr"
          ],
          "line": 512
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ElementList.begin",
          "args": [],
          "line": 507
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ElementList.size",
          "args": [],
          "line": 506
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/MemIOCallback.h\"\n#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include <algorithm>\n#include <cassert>\n\nvoid EbmlMaster::Remove(size_t Index)\n{\n  if (Index < ElementList.size()) {\n    std::vector<EbmlElement *>::iterator Itr = ElementList.begin();\n    while (Index-- > 0) {\n      ++Itr;\n    }\n\n    ElementList.erase(Itr);\n  }\n}"
  },
  {
    "function_name": "EbmlMaster::Read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlMaster.cpp",
    "lines": "399-502",
    "snippet": "void EbmlMaster::Read(EbmlStream & inDataStream, const EbmlSemanticContext & sContext, int & UpperEltFound, EbmlElement * & FoundElt, bool AllowDummyElt, ScopeMode ReadFully)\n{\n  if (ReadFully != SCOPE_NO_DATA)\n  {\n    EbmlElement * ElementLevelA;\n    // remove all existing elements, including the mandatory ones...\n    size_t Index;\n    for (Index=0; Index<ElementList.size(); Index++) {\n      if (!(*ElementList[Index]).IsLocked()) {\n        delete ElementList[Index];\n      }\n    }\n    ElementList.clear();\n    uint64 MaxSizeToRead;\n\n    if (IsFiniteSize())\n      MaxSizeToRead = GetSize();\n    else\n      MaxSizeToRead = 0x7FFFFFFF;\n\n    // read blocks and discard the ones we don't care about\n    if (MaxSizeToRead > 0)\n    {\n      inDataStream.I_O().setFilePointer(GetSizePosition() + GetSizeLength(), seek_beginning);\n      ElementLevelA = inDataStream.FindNextElement(sContext, UpperEltFound, MaxSizeToRead, AllowDummyElt);\n      while (ElementLevelA != NULL && UpperEltFound <= 0 && MaxSizeToRead > 0) {\n        if (IsFiniteSize() && ElementLevelA->IsFiniteSize())\n          MaxSizeToRead = GetEndPosition() - ElementLevelA->GetEndPosition(); // even if it's the default value\n        if (!AllowDummyElt && ElementLevelA->IsDummy()) {\n          if (ElementLevelA->IsFiniteSize()) {\n            ElementLevelA->SkipData(inDataStream, sContext);\n            delete ElementLevelA; // forget this unknown element\n          } else {\n            delete ElementLevelA; // forget this unknown element\n            break;\n          }\n        } else {\n          ElementLevelA->Read(inDataStream, EBML_CONTEXT(ElementLevelA), UpperEltFound, FoundElt, AllowDummyElt, ReadFully);\n\n          // Discard elements that couldn't be read properly if\n          // SCOPE_ALL_DATA has been requested. This can happen\n          // e.g. if block data is defective.\n          bool DeleteElement = true;\n\n          if (ElementLevelA->ValueIsSet() || (ReadFully != SCOPE_ALL_DATA)) {\n            ElementList.push_back(ElementLevelA);\n            DeleteElement = false;\n          }\n\n          // just in case\n          if (ElementLevelA->IsFiniteSize()) {\n            ElementLevelA->SkipData(inDataStream, EBML_CONTEXT(ElementLevelA));\n            if (DeleteElement)\n              delete ElementLevelA;\n          } else {\n            if (DeleteElement)\n              delete ElementLevelA;\n            break;\n          }\n        }\n\n        if (UpperEltFound > 0) {\n          UpperEltFound--;\n          if (UpperEltFound > 0 || MaxSizeToRead <= 0)\n            goto processCrc;\n          ElementLevelA = FoundElt;\n          continue;\n        }\n\n        if (UpperEltFound < 0) {\n          UpperEltFound++;\n          if (UpperEltFound < 0)\n            goto processCrc;\n        }\n\n        if (MaxSizeToRead <= 0)\n          goto processCrc;// this level is finished\n\n        ElementLevelA = inDataStream.FindNextElement(sContext, UpperEltFound, MaxSizeToRead, AllowDummyElt);\n      }\n      if (UpperEltFound > 0) {\n        FoundElt = ElementLevelA;\n      }\n    }\n  processCrc:\n        EBML_MASTER_ITERATOR Itr, CrcItr;\n        for (Itr = ElementList.begin(); Itr != ElementList.end();) {\n      if ((EbmlId)(*(*Itr)) == EBML_ID(EbmlCrc32)) {\n        bChecksumUsed = true;\n        // remove the element\n        Checksum = *(static_cast<EbmlCrc32*>(*Itr));\n                CrcItr = Itr;\n                break;\n      }\n            ++Itr;\n    }\n        if (bChecksumUsed)\n        {\n        delete *CrcItr;\n        Remove(CrcItr);\n        }\n    SetValueIsSet();\n  }\n}",
    "includes": [
      "#include \"ebml/MemIOCallback.h\"",
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlStream.h\"",
      "#include \"ebml/EbmlMaster.h\"",
      "#include <algorithm>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetValueIsSet",
          "args": [],
          "line": 500
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Remove",
          "args": [
            "CrcItr"
          ],
          "line": 498
        },
        "resolved": true,
        "details": {
          "function_name": "EbmlMaster::Remove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlMaster.cpp",
          "lines": "521-524",
          "snippet": "void EbmlMaster::Remove(EBML_MASTER_RITERATOR & Itr)\n{\n  ElementList.erase(Itr.base());\n}",
          "includes": [
            "#include \"ebml/MemIOCallback.h\"",
            "#include \"ebml/EbmlContexts.h\"",
            "#include \"ebml/EbmlStream.h\"",
            "#include \"ebml/EbmlMaster.h\"",
            "#include <algorithm>",
            "#include <cassert>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/MemIOCallback.h\"\n#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include <algorithm>\n#include <cassert>\n\nvoid EbmlMaster::Remove(EBML_MASTER_RITERATOR & Itr)\n{\n  ElementList.erase(Itr.base());\n}"
        }
      },
      {
        "call_info": {
          "callee": "static_cast<EbmlCrc32*>",
          "args": [
            "*Itr"
          ],
          "line": 489
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBML_ID",
          "args": [
            "EbmlCrc32"
          ],
          "line": 486
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "*(*Itr)"
          ],
          "line": 486
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ElementList.end",
          "args": [],
          "line": 485
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ElementList.begin",
          "args": [],
          "line": 485
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inDataStream.FindNextElement",
          "args": [
            "sContext",
            "UpperEltFound",
            "MaxSizeToRead",
            "AllowDummyElt"
          ],
          "line": 477
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ElementLevelA->SkipData",
          "args": [
            "inDataStream",
            "EBML_CONTEXT(ElementLevelA)"
          ],
          "line": 450
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBML_CONTEXT",
          "args": [
            "ElementLevelA"
          ],
          "line": 450
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ElementLevelA->IsFiniteSize",
          "args": [],
          "line": 449
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ElementList.push_back",
          "args": [
            "ElementLevelA"
          ],
          "line": 444
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ElementLevelA->ValueIsSet",
          "args": [],
          "line": 443
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ElementLevelA->Read",
          "args": [
            "inDataStream",
            "EBML_CONTEXT(ElementLevelA)",
            "UpperEltFound",
            "FoundElt",
            "AllowDummyElt",
            "ReadFully"
          ],
          "line": 436
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBML_CONTEXT",
          "args": [
            "ElementLevelA"
          ],
          "line": 436
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ElementLevelA->SkipData",
          "args": [
            "inDataStream",
            "sContext"
          ],
          "line": 429
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ElementLevelA->IsFiniteSize",
          "args": [],
          "line": 428
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ElementLevelA->IsDummy",
          "args": [],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ElementLevelA->GetEndPosition",
          "args": [],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetEndPosition",
          "args": [],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ElementLevelA->IsFiniteSize",
          "args": [],
          "line": 425
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IsFiniteSize",
          "args": [],
          "line": 425
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inDataStream.FindNextElement",
          "args": [
            "sContext",
            "UpperEltFound",
            "MaxSizeToRead",
            "AllowDummyElt"
          ],
          "line": 423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inDataStream.I_O",
          "args": [
            "GetSizePosition() + GetSizeLength()",
            "seek_beginning"
          ],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetSizeLength",
          "args": [],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetSizePosition",
          "args": [],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inDataStream.I_O",
          "args": [],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetSize",
          "args": [],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "SafeReadIOCallback::GetSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/SafeReadIOCallback.cpp",
          "lines": "88-92",
          "snippet": "size_t\nSafeReadIOCallback::GetSize()\n  const {\n  return mSize;\n}",
          "includes": [
            "#include \"ebml/SafeReadIOCallback.h\"",
            "#include \"ebml/MemReadIOCallback.h\"",
            "#include \"ebml/EbmlBinary.h\"",
            "#include <cstring>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/SafeReadIOCallback.h\"\n#include \"ebml/MemReadIOCallback.h\"\n#include \"ebml/EbmlBinary.h\"\n#include <cstring>\n\nsize_t\nSafeReadIOCallback::GetSize()\n  const {\n  return mSize;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IsFiniteSize",
          "args": [],
          "line": 414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ElementList.clear",
          "args": [],
          "line": 411
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ElementList.size",
          "args": [],
          "line": 406
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/MemIOCallback.h\"\n#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include <algorithm>\n#include <cassert>\n\nvoid EbmlMaster::Read(EbmlStream & inDataStream, const EbmlSemanticContext & sContext, int & UpperEltFound, EbmlElement * & FoundElt, bool AllowDummyElt, ScopeMode ReadFully)\n{\n  if (ReadFully != SCOPE_NO_DATA)\n  {\n    EbmlElement * ElementLevelA;\n    // remove all existing elements, including the mandatory ones...\n    size_t Index;\n    for (Index=0; Index<ElementList.size(); Index++) {\n      if (!(*ElementList[Index]).IsLocked()) {\n        delete ElementList[Index];\n      }\n    }\n    ElementList.clear();\n    uint64 MaxSizeToRead;\n\n    if (IsFiniteSize())\n      MaxSizeToRead = GetSize();\n    else\n      MaxSizeToRead = 0x7FFFFFFF;\n\n    // read blocks and discard the ones we don't care about\n    if (MaxSizeToRead > 0)\n    {\n      inDataStream.I_O().setFilePointer(GetSizePosition() + GetSizeLength(), seek_beginning);\n      ElementLevelA = inDataStream.FindNextElement(sContext, UpperEltFound, MaxSizeToRead, AllowDummyElt);\n      while (ElementLevelA != NULL && UpperEltFound <= 0 && MaxSizeToRead > 0) {\n        if (IsFiniteSize() && ElementLevelA->IsFiniteSize())\n          MaxSizeToRead = GetEndPosition() - ElementLevelA->GetEndPosition(); // even if it's the default value\n        if (!AllowDummyElt && ElementLevelA->IsDummy()) {\n          if (ElementLevelA->IsFiniteSize()) {\n            ElementLevelA->SkipData(inDataStream, sContext);\n            delete ElementLevelA; // forget this unknown element\n          } else {\n            delete ElementLevelA; // forget this unknown element\n            break;\n          }\n        } else {\n          ElementLevelA->Read(inDataStream, EBML_CONTEXT(ElementLevelA), UpperEltFound, FoundElt, AllowDummyElt, ReadFully);\n\n          // Discard elements that couldn't be read properly if\n          // SCOPE_ALL_DATA has been requested. This can happen\n          // e.g. if block data is defective.\n          bool DeleteElement = true;\n\n          if (ElementLevelA->ValueIsSet() || (ReadFully != SCOPE_ALL_DATA)) {\n            ElementList.push_back(ElementLevelA);\n            DeleteElement = false;\n          }\n\n          // just in case\n          if (ElementLevelA->IsFiniteSize()) {\n            ElementLevelA->SkipData(inDataStream, EBML_CONTEXT(ElementLevelA));\n            if (DeleteElement)\n              delete ElementLevelA;\n          } else {\n            if (DeleteElement)\n              delete ElementLevelA;\n            break;\n          }\n        }\n\n        if (UpperEltFound > 0) {\n          UpperEltFound--;\n          if (UpperEltFound > 0 || MaxSizeToRead <= 0)\n            goto processCrc;\n          ElementLevelA = FoundElt;\n          continue;\n        }\n\n        if (UpperEltFound < 0) {\n          UpperEltFound++;\n          if (UpperEltFound < 0)\n            goto processCrc;\n        }\n\n        if (MaxSizeToRead <= 0)\n          goto processCrc;// this level is finished\n\n        ElementLevelA = inDataStream.FindNextElement(sContext, UpperEltFound, MaxSizeToRead, AllowDummyElt);\n      }\n      if (UpperEltFound > 0) {\n        FoundElt = ElementLevelA;\n      }\n    }\n  processCrc:\n        EBML_MASTER_ITERATOR Itr, CrcItr;\n        for (Itr = ElementList.begin(); Itr != ElementList.end();) {\n      if ((EbmlId)(*(*Itr)) == EBML_ID(EbmlCrc32)) {\n        bChecksumUsed = true;\n        // remove the element\n        Checksum = *(static_cast<EbmlCrc32*>(*Itr));\n                CrcItr = Itr;\n                break;\n      }\n            ++Itr;\n    }\n        if (bChecksumUsed)\n        {\n        delete *CrcItr;\n        Remove(CrcItr);\n        }\n    SetValueIsSet();\n  }\n}"
  },
  {
    "function_name": "EbmlMaster::Sort",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlMaster.cpp",
    "lines": "389-392",
    "snippet": "void EbmlMaster::Sort()\n{\n  std::sort(ElementList.begin(), ElementList.end(), EbmlElement::CompareElements);\n}",
    "includes": [
      "#include \"ebml/MemIOCallback.h\"",
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlStream.h\"",
      "#include \"ebml/EbmlMaster.h\"",
      "#include <algorithm>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::sort",
          "args": [
            "ElementList.begin()",
            "ElementList.end()",
            "EbmlElement::CompareElements"
          ],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ElementList.end",
          "args": [],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ElementList.begin",
          "args": [],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/MemIOCallback.h\"\n#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include <algorithm>\n#include <cassert>\n\nvoid EbmlMaster::Sort()\n{\n  std::sort(ElementList.begin(), ElementList.end(), EbmlElement::CompareElements);\n}"
  },
  {
    "function_name": "EbmlMaster::FindAllMissingElements",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlMaster.cpp",
    "lines": "219-261",
    "snippet": "std::vector<std::string> EbmlMaster::FindAllMissingElements()\n{\n  assert(Context.GetSize() != 0);\n\n  std::vector<std::string> missingElements;\n\n  for (size_t ChildElementNo = 0; ChildElementNo < ElementList.size(); ChildElementNo++) {\n       EbmlElement *childElement = ElementList[ChildElementNo];\n    if (!childElement->ValueIsSet()) {\n      std::string missingValue;\n      missingValue = \"The Child Element \\\"\";\n      missingValue.append(EBML_NAME(childElement));\n      missingValue.append(\"\\\" of EbmlMaster \\\"\");\n      missingValue.append(EBML_NAME(this));\n      missingValue.append(\"\\\", does not have a value set.\");\n      missingElements.push_back(missingValue);\n    }\n\n    if (childElement->IsMaster()) {\n      EbmlMaster *childMaster = (EbmlMaster *)childElement;\n\n      std::vector<std::string> childMissingElements = childMaster->FindAllMissingElements();\n      for (size_t s = 0; s < childMissingElements.size(); s++)\n        missingElements.push_back(childMissingElements[s]);\n    }\n  }\n  unsigned int EltIdx;\n  for (EltIdx = 0; EltIdx < EBML_CTX_SIZE(Context); EltIdx++) {\n    if (EBML_CTX_IDX(Context,EltIdx).IsMandatory()) {\n      if (FindElt(EBML_CTX_IDX_INFO(Context,EltIdx)) == NULL) {\n        std::string missingElement;\n        missingElement = \"Missing element \\\"\";\n                missingElement.append(EBML_INFO_NAME(EBML_CTX_IDX_INFO(Context,EltIdx)));\n        missingElement.append(\"\\\" in EbmlMaster \\\"\");\n                missingElement.append(EBML_INFO_NAME(*EBML_CTX_MASTER(Context)));\n        missingElement.append(\"\\\"\");\n        missingElements.push_back(missingElement);\n      }\n    }\n  }\n\n  return missingElements;\n}",
    "includes": [
      "#include \"ebml/MemIOCallback.h\"",
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlStream.h\"",
      "#include \"ebml/EbmlMaster.h\"",
      "#include <algorithm>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "missingElements.push_back",
          "args": [
            "missingElement"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "missingElement.append",
          "args": [
            "\"\\\"\""
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "missingElement.append",
          "args": [
            "EBML_INFO_NAME(*EBML_CTX_MASTER(Context))"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBML_INFO_NAME",
          "args": [
            "*EBML_CTX_MASTER(Context)"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBML_CTX_MASTER",
          "args": [
            "Context"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "missingElement.append",
          "args": [
            "\"\\\" in EbmlMaster \\\"\""
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "missingElement.append",
          "args": [
            "EBML_INFO_NAME(EBML_CTX_IDX_INFO(Context,EltIdx))"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBML_INFO_NAME",
          "args": [
            "EBML_CTX_IDX_INFO(Context,EltIdx)"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBML_CTX_IDX_INFO",
          "args": [
            "Context",
            "EltIdx"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FindElt",
          "args": [
            "EBML_CTX_IDX_INFO(Context,EltIdx)"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBML_CTX_IDX_INFO",
          "args": [
            "Context",
            "EltIdx"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBML_CTX_IDX",
          "args": [],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBML_CTX_IDX",
          "args": [
            "Context",
            "EltIdx"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBML_CTX_SIZE",
          "args": [
            "Context"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "missingElements.push_back",
          "args": [
            "childMissingElements[s]"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "childMissingElements.size",
          "args": [],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "childMaster->FindAllMissingElements",
          "args": [],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "childElement->IsMaster",
          "args": [],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "missingElements.push_back",
          "args": [
            "missingValue"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "missingValue.append",
          "args": [
            "\"\\\", does not have a value set.\""
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "missingValue.append",
          "args": [
            "EBML_NAME(this)"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBML_NAME",
          "args": [
            "this"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "missingValue.append",
          "args": [
            "\"\\\" of EbmlMaster \\\"\""
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "missingValue.append",
          "args": [
            "EBML_NAME(childElement)"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBML_NAME",
          "args": [
            "childElement"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "childElement->ValueIsSet",
          "args": [],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ElementList.size",
          "args": [],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "Context.GetSize() != 0"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Context.GetSize",
          "args": [],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/MemIOCallback.h\"\n#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include <algorithm>\n#include <cassert>\n\nstd::vector<std::string> EbmlMaster::FindAllMissingElements()\n{\n  assert(Context.GetSize() != 0);\n\n  std::vector<std::string> missingElements;\n\n  for (size_t ChildElementNo = 0; ChildElementNo < ElementList.size(); ChildElementNo++) {\n       EbmlElement *childElement = ElementList[ChildElementNo];\n    if (!childElement->ValueIsSet()) {\n      std::string missingValue;\n      missingValue = \"The Child Element \\\"\";\n      missingValue.append(EBML_NAME(childElement));\n      missingValue.append(\"\\\" of EbmlMaster \\\"\");\n      missingValue.append(EBML_NAME(this));\n      missingValue.append(\"\\\", does not have a value set.\");\n      missingElements.push_back(missingValue);\n    }\n\n    if (childElement->IsMaster()) {\n      EbmlMaster *childMaster = (EbmlMaster *)childElement;\n\n      std::vector<std::string> childMissingElements = childMaster->FindAllMissingElements();\n      for (size_t s = 0; s < childMissingElements.size(); s++)\n        missingElements.push_back(childMissingElements[s]);\n    }\n  }\n  unsigned int EltIdx;\n  for (EltIdx = 0; EltIdx < EBML_CTX_SIZE(Context); EltIdx++) {\n    if (EBML_CTX_IDX(Context,EltIdx).IsMandatory()) {\n      if (FindElt(EBML_CTX_IDX_INFO(Context,EltIdx)) == NULL) {\n        std::string missingElement;\n        missingElement = \"Missing element \\\"\";\n                missingElement.append(EBML_INFO_NAME(EBML_CTX_IDX_INFO(Context,EltIdx)));\n        missingElement.append(\"\\\" in EbmlMaster \\\"\");\n                missingElement.append(EBML_INFO_NAME(*EBML_CTX_MASTER(Context)));\n        missingElement.append(\"\\\"\");\n        missingElements.push_back(missingElement);\n      }\n    }\n  }\n\n  return missingElements;\n}"
  },
  {
    "function_name": "EbmlMaster::CheckMandatory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlMaster.cpp",
    "lines": "199-217",
    "snippet": "bool EbmlMaster::CheckMandatory() const\n{\n  assert(Context.GetSize() != 0);\n\n  unsigned int EltIdx;\n  for (EltIdx = 0; EltIdx < EBML_CTX_SIZE(Context); EltIdx++) {\n    if (EBML_CTX_IDX(Context,EltIdx).IsMandatory()) {\n      if (FindElt(EBML_CTX_IDX_INFO(Context,EltIdx)) == NULL) {\n#if defined(LIBEBML_DEBUG)\n        // you are missing this Mandatory element\n//         const char * MissingName = EBML_INFO_NAME(EBML_CTX_IDX_INFO(Context,EltIdx));\n#endif // LIBEBML_DEBUG\n        return false;\n      }\n    }\n  }\n\n  return true;\n}",
    "includes": [
      "#include \"ebml/MemIOCallback.h\"",
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlStream.h\"",
      "#include \"ebml/EbmlMaster.h\"",
      "#include <algorithm>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "FindElt",
          "args": [
            "EBML_CTX_IDX_INFO(Context,EltIdx)"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBML_CTX_IDX_INFO",
          "args": [
            "Context",
            "EltIdx"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBML_CTX_IDX",
          "args": [],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBML_CTX_IDX",
          "args": [
            "Context",
            "EltIdx"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBML_CTX_SIZE",
          "args": [
            "Context"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "Context.GetSize() != 0"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Context.GetSize",
          "args": [],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/MemIOCallback.h\"\n#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include <algorithm>\n#include <cassert>\n\nbool EbmlMaster::CheckMandatory() const\n{\n  assert(Context.GetSize() != 0);\n\n  unsigned int EltIdx;\n  for (EltIdx = 0; EltIdx < EBML_CTX_SIZE(Context); EltIdx++) {\n    if (EBML_CTX_IDX(Context,EltIdx).IsMandatory()) {\n      if (FindElt(EBML_CTX_IDX_INFO(Context,EltIdx)) == NULL) {\n#if defined(LIBEBML_DEBUG)\n        // you are missing this Mandatory element\n//         const char * MissingName = EBML_INFO_NAME(EBML_CTX_IDX_INFO(Context,EltIdx));\n#endif // LIBEBML_DEBUG\n        return false;\n      }\n    }\n  }\n\n  return true;\n}"
  },
  {
    "function_name": "EbmlMaster::ProcessMandatory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlMaster.cpp",
    "lines": "180-197",
    "snippet": "bool EbmlMaster::ProcessMandatory()\n{\n  if (EBML_CTX_SIZE(Context) == 0)\n  {\n    return true;\n  }\n\n  assert(Context.GetSize() != 0);\n\n  unsigned int EltIdx;\n  for (EltIdx = 0; EltIdx < EBML_CTX_SIZE(Context); EltIdx++) {\n    if (EBML_CTX_IDX(Context,EltIdx).IsMandatory() && EBML_CTX_IDX(Context,EltIdx).IsUnique()) {\n//      assert(EBML_CTX_IDX(Context,EltIdx).Create != NULL);\n            PushElement(EBML_SEM_CREATE(EBML_CTX_IDX(Context,EltIdx)));\n    }\n  }\n  return true;\n}",
    "includes": [
      "#include \"ebml/MemIOCallback.h\"",
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlStream.h\"",
      "#include \"ebml/EbmlMaster.h\"",
      "#include <algorithm>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PushElement",
          "args": [
            "EBML_SEM_CREATE(EBML_CTX_IDX(Context,EltIdx))"
          ],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "EbmlMaster::PushElement",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlMaster.cpp",
          "lines": "124-128",
          "snippet": "bool EbmlMaster::PushElement(EbmlElement & element)\n{\n  ElementList.push_back(&element);\n  return true;\n}",
          "includes": [
            "#include \"ebml/MemIOCallback.h\"",
            "#include \"ebml/EbmlContexts.h\"",
            "#include \"ebml/EbmlStream.h\"",
            "#include \"ebml/EbmlMaster.h\"",
            "#include <algorithm>",
            "#include <cassert>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/MemIOCallback.h\"\n#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include <algorithm>\n#include <cassert>\n\nbool EbmlMaster::PushElement(EbmlElement & element)\n{\n  ElementList.push_back(&element);\n  return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "EBML_SEM_CREATE",
          "args": [
            "EBML_CTX_IDX(Context,EltIdx)"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBML_CTX_IDX",
          "args": [
            "Context",
            "EltIdx"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBML_CTX_IDX",
          "args": [],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBML_CTX_IDX",
          "args": [
            "Context",
            "EltIdx"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBML_CTX_IDX",
          "args": [],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBML_CTX_IDX",
          "args": [
            "Context",
            "EltIdx"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBML_CTX_SIZE",
          "args": [
            "Context"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "Context.GetSize() != 0"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Context.GetSize",
          "args": [],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EBML_CTX_SIZE",
          "args": [
            "Context"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/MemIOCallback.h\"\n#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include <algorithm>\n#include <cassert>\n\nbool EbmlMaster::ProcessMandatory()\n{\n  if (EBML_CTX_SIZE(Context) == 0)\n  {\n    return true;\n  }\n\n  assert(Context.GetSize() != 0);\n\n  unsigned int EltIdx;\n  for (EltIdx = 0; EltIdx < EBML_CTX_SIZE(Context); EltIdx++) {\n    if (EBML_CTX_IDX(Context,EltIdx).IsMandatory() && EBML_CTX_IDX(Context,EltIdx).IsUnique()) {\n//      assert(EBML_CTX_IDX(Context,EltIdx).Create != NULL);\n            PushElement(EBML_SEM_CREATE(EBML_CTX_IDX(Context,EltIdx)));\n    }\n  }\n  return true;\n}"
  },
  {
    "function_name": "EbmlMaster::ReadData",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlMaster.cpp",
    "lines": "170-174",
    "snippet": "filepos_t EbmlMaster::ReadData(IOCallback & input, ScopeMode /* ReadFully */)\n{\n  input.setFilePointer(GetSize(), seek_current);\n  return GetSize();\n}",
    "includes": [
      "#include \"ebml/MemIOCallback.h\"",
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlStream.h\"",
      "#include \"ebml/EbmlMaster.h\"",
      "#include <algorithm>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetSize",
          "args": [],
          "line": 173
        },
        "resolved": true,
        "details": {
          "function_name": "SafeReadIOCallback::GetSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/SafeReadIOCallback.cpp",
          "lines": "88-92",
          "snippet": "size_t\nSafeReadIOCallback::GetSize()\n  const {\n  return mSize;\n}",
          "includes": [
            "#include \"ebml/SafeReadIOCallback.h\"",
            "#include \"ebml/MemReadIOCallback.h\"",
            "#include \"ebml/EbmlBinary.h\"",
            "#include <cstring>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/SafeReadIOCallback.h\"\n#include \"ebml/MemReadIOCallback.h\"\n#include \"ebml/EbmlBinary.h\"\n#include <cstring>\n\nsize_t\nSafeReadIOCallback::GetSize()\n  const {\n  return mSize;\n}"
        }
      },
      {
        "call_info": {
          "callee": "input.setFilePointer",
          "args": [
            "GetSize()",
            "seek_current"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/MemIOCallback.h\"\n#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include <algorithm>\n#include <cassert>\n\nfilepos_t EbmlMaster::ReadData(IOCallback & input, ScopeMode /* ReadFully */)\n{\n  input.setFilePointer(GetSize(), seek_current);\n  return GetSize();\n}"
  },
  {
    "function_name": "EbmlMaster::WriteHead",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlMaster.cpp",
    "lines": "161-165",
    "snippet": "filepos_t EbmlMaster::WriteHead(IOCallback & output, int nSizeLength, bool bWithDefault)\n{\n  SetSizeLength(nSizeLength);\n  return RenderHead(output, false, bWithDefault);\n}",
    "includes": [
      "#include \"ebml/MemIOCallback.h\"",
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlStream.h\"",
      "#include \"ebml/EbmlMaster.h\"",
      "#include <algorithm>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "RenderHead",
          "args": [
            "output",
            "false",
            "bWithDefault"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SetSizeLength",
          "args": [
            "nSizeLength"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/MemIOCallback.h\"\n#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include <algorithm>\n#include <cassert>\n\nfilepos_t EbmlMaster::WriteHead(IOCallback & output, int nSizeLength, bool bWithDefault)\n{\n  SetSizeLength(nSizeLength);\n  return RenderHead(output, false, bWithDefault);\n}"
  },
  {
    "function_name": "EbmlMaster::UpdateSize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlMaster.cpp",
    "lines": "130-159",
    "snippet": "uint64 EbmlMaster::UpdateSize(bool bWithDefault, bool bForceRender)\n{\n  SetSize_(0);\n\n  if (!IsFiniteSize())\n    return (0-1);\n\n  if (!bForceRender) {\n    assert(CheckMandatory());\n    }\n\n  size_t Index;\n\n  for (Index = 0; Index < ElementList.size(); Index++) {\n    if (!bWithDefault && (ElementList[Index])->IsDefaultValue())\n      continue;\n    (ElementList[Index])->UpdateSize(bWithDefault, bForceRender);\n    uint64 SizeToAdd = (ElementList[Index])->ElementSize(bWithDefault);\n#if defined(LIBEBML_DEBUG)\n    if (static_cast<int64>(SizeToAdd) == (0-1))\n      return (0-1);\n#endif // LIBEBML_DEBUG\n    SetSize_(GetSize() + SizeToAdd);\n  }\n  if (bChecksumUsed) {\n    SetSize_(GetSize() + Checksum.ElementSize());\n  }\n\n  return GetSize();\n}",
    "includes": [
      "#include \"ebml/MemIOCallback.h\"",
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlStream.h\"",
      "#include \"ebml/EbmlMaster.h\"",
      "#include <algorithm>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetSize",
          "args": [],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "SafeReadIOCallback::GetSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/SafeReadIOCallback.cpp",
          "lines": "88-92",
          "snippet": "size_t\nSafeReadIOCallback::GetSize()\n  const {\n  return mSize;\n}",
          "includes": [
            "#include \"ebml/SafeReadIOCallback.h\"",
            "#include \"ebml/MemReadIOCallback.h\"",
            "#include \"ebml/EbmlBinary.h\"",
            "#include <cstring>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/SafeReadIOCallback.h\"\n#include \"ebml/MemReadIOCallback.h\"\n#include \"ebml/EbmlBinary.h\"\n#include <cstring>\n\nsize_t\nSafeReadIOCallback::GetSize()\n  const {\n  return mSize;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SetSize_",
          "args": [
            "GetSize() + Checksum.ElementSize()"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Checksum.ElementSize",
          "args": [],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SetSize_",
          "args": [
            "GetSize() + SizeToAdd"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<int64>",
          "args": [
            "SizeToAdd"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "bWithDefault"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "bWithDefault",
            "bForceRender"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ElementList.size",
          "args": [],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "CheckMandatory()"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CheckMandatory",
          "args": [],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "EbmlMaster::CheckMandatory",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlMaster.cpp",
          "lines": "199-217",
          "snippet": "bool EbmlMaster::CheckMandatory() const\n{\n  assert(Context.GetSize() != 0);\n\n  unsigned int EltIdx;\n  for (EltIdx = 0; EltIdx < EBML_CTX_SIZE(Context); EltIdx++) {\n    if (EBML_CTX_IDX(Context,EltIdx).IsMandatory()) {\n      if (FindElt(EBML_CTX_IDX_INFO(Context,EltIdx)) == NULL) {\n#if defined(LIBEBML_DEBUG)\n        // you are missing this Mandatory element\n//         const char * MissingName = EBML_INFO_NAME(EBML_CTX_IDX_INFO(Context,EltIdx));\n#endif // LIBEBML_DEBUG\n        return false;\n      }\n    }\n  }\n\n  return true;\n}",
          "includes": [
            "#include \"ebml/MemIOCallback.h\"",
            "#include \"ebml/EbmlContexts.h\"",
            "#include \"ebml/EbmlStream.h\"",
            "#include \"ebml/EbmlMaster.h\"",
            "#include <algorithm>",
            "#include <cassert>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/MemIOCallback.h\"\n#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include <algorithm>\n#include <cassert>\n\nbool EbmlMaster::CheckMandatory() const\n{\n  assert(Context.GetSize() != 0);\n\n  unsigned int EltIdx;\n  for (EltIdx = 0; EltIdx < EBML_CTX_SIZE(Context); EltIdx++) {\n    if (EBML_CTX_IDX(Context,EltIdx).IsMandatory()) {\n      if (FindElt(EBML_CTX_IDX_INFO(Context,EltIdx)) == NULL) {\n#if defined(LIBEBML_DEBUG)\n        // you are missing this Mandatory element\n//         const char * MissingName = EBML_INFO_NAME(EBML_CTX_IDX_INFO(Context,EltIdx));\n#endif // LIBEBML_DEBUG\n        return false;\n      }\n    }\n  }\n\n  return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IsFiniteSize",
          "args": [],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SetSize_",
          "args": [
            "0"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/MemIOCallback.h\"\n#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include <algorithm>\n#include <cassert>\n\nuint64 EbmlMaster::UpdateSize(bool bWithDefault, bool bForceRender)\n{\n  SetSize_(0);\n\n  if (!IsFiniteSize())\n    return (0-1);\n\n  if (!bForceRender) {\n    assert(CheckMandatory());\n    }\n\n  size_t Index;\n\n  for (Index = 0; Index < ElementList.size(); Index++) {\n    if (!bWithDefault && (ElementList[Index])->IsDefaultValue())\n      continue;\n    (ElementList[Index])->UpdateSize(bWithDefault, bForceRender);\n    uint64 SizeToAdd = (ElementList[Index])->ElementSize(bWithDefault);\n#if defined(LIBEBML_DEBUG)\n    if (static_cast<int64>(SizeToAdd) == (0-1))\n      return (0-1);\n#endif // LIBEBML_DEBUG\n    SetSize_(GetSize() + SizeToAdd);\n  }\n  if (bChecksumUsed) {\n    SetSize_(GetSize() + Checksum.ElementSize());\n  }\n\n  return GetSize();\n}"
  },
  {
    "function_name": "EbmlMaster::PushElement",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlMaster.cpp",
    "lines": "124-128",
    "snippet": "bool EbmlMaster::PushElement(EbmlElement & element)\n{\n  ElementList.push_back(&element);\n  return true;\n}",
    "includes": [
      "#include \"ebml/MemIOCallback.h\"",
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlStream.h\"",
      "#include \"ebml/EbmlMaster.h\"",
      "#include <algorithm>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ElementList.push_back",
          "args": [
            "&element"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/MemIOCallback.h\"\n#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include <algorithm>\n#include <cassert>\n\nbool EbmlMaster::PushElement(EbmlElement & element)\n{\n  ElementList.push_back(&element);\n  return true;\n}"
  },
  {
    "function_name": "EbmlMaster::RenderData",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlMaster.cpp",
    "lines": "90-119",
    "snippet": "filepos_t EbmlMaster::RenderData(IOCallback & output, bool bForceRender, bool bWithDefault)\n{\n  filepos_t Result = 0;\n  size_t Index;\n\n  if (!bForceRender) {\n    assert(CheckMandatory());\n  }\n\n  if (!bChecksumUsed) { // old school\n    for (Index = 0; Index < ElementList.size(); Index++) {\n      if (!bWithDefault && (ElementList[Index])->IsDefaultValue())\n        continue;\n      Result += (ElementList[Index])->Render(output, bWithDefault, false ,bForceRender);\n    }\n  } else { // new school\n    MemIOCallback TmpBuf(GetSize() - 6);\n    for (Index = 0; Index < ElementList.size(); Index++) {\n      if (!bWithDefault && (ElementList[Index])->IsDefaultValue())\n        continue;\n      (ElementList[Index])->Render(TmpBuf, bWithDefault, false ,bForceRender);\n    }\n    Checksum.FillCRC32(TmpBuf.GetDataBuffer(), TmpBuf.GetDataBufferSize());\n    Result += Checksum.Render(output, true, false ,bForceRender);\n    output.writeFully(TmpBuf.GetDataBuffer(), TmpBuf.GetDataBufferSize());\n    Result += TmpBuf.GetDataBufferSize();\n  }\n\n  return Result;\n}",
    "includes": [
      "#include \"ebml/MemIOCallback.h\"",
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlStream.h\"",
      "#include \"ebml/EbmlMaster.h\"",
      "#include <algorithm>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "TmpBuf.GetDataBufferSize",
          "args": [],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "output.writeFully",
          "args": [
            "TmpBuf.GetDataBuffer()",
            "TmpBuf.GetDataBufferSize()"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TmpBuf.GetDataBufferSize",
          "args": [],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TmpBuf.GetDataBuffer",
          "args": [],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Checksum.Render",
          "args": [
            "output",
            "true",
            "false",
            "bForceRender"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Checksum.FillCRC32",
          "args": [
            "TmpBuf.GetDataBuffer()",
            "TmpBuf.GetDataBufferSize()"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TmpBuf.GetDataBufferSize",
          "args": [],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TmpBuf.GetDataBuffer",
          "args": [],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "TmpBuf",
            "bWithDefault",
            "false",
            "bForceRender"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ElementList.size",
          "args": [],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetSize",
          "args": [],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "SafeReadIOCallback::GetSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/SafeReadIOCallback.cpp",
          "lines": "88-92",
          "snippet": "size_t\nSafeReadIOCallback::GetSize()\n  const {\n  return mSize;\n}",
          "includes": [
            "#include \"ebml/SafeReadIOCallback.h\"",
            "#include \"ebml/MemReadIOCallback.h\"",
            "#include \"ebml/EbmlBinary.h\"",
            "#include <cstring>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/SafeReadIOCallback.h\"\n#include \"ebml/MemReadIOCallback.h\"\n#include \"ebml/EbmlBinary.h\"\n#include <cstring>\n\nsize_t\nSafeReadIOCallback::GetSize()\n  const {\n  return mSize;\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "output",
            "bWithDefault",
            "false",
            "bForceRender"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ElementList.size",
          "args": [],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "CheckMandatory()"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CheckMandatory",
          "args": [],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "EbmlMaster::CheckMandatory",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlMaster.cpp",
          "lines": "199-217",
          "snippet": "bool EbmlMaster::CheckMandatory() const\n{\n  assert(Context.GetSize() != 0);\n\n  unsigned int EltIdx;\n  for (EltIdx = 0; EltIdx < EBML_CTX_SIZE(Context); EltIdx++) {\n    if (EBML_CTX_IDX(Context,EltIdx).IsMandatory()) {\n      if (FindElt(EBML_CTX_IDX_INFO(Context,EltIdx)) == NULL) {\n#if defined(LIBEBML_DEBUG)\n        // you are missing this Mandatory element\n//         const char * MissingName = EBML_INFO_NAME(EBML_CTX_IDX_INFO(Context,EltIdx));\n#endif // LIBEBML_DEBUG\n        return false;\n      }\n    }\n  }\n\n  return true;\n}",
          "includes": [
            "#include \"ebml/MemIOCallback.h\"",
            "#include \"ebml/EbmlContexts.h\"",
            "#include \"ebml/EbmlStream.h\"",
            "#include \"ebml/EbmlMaster.h\"",
            "#include <algorithm>",
            "#include <cassert>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ebml/MemIOCallback.h\"\n#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include <algorithm>\n#include <cassert>\n\nbool EbmlMaster::CheckMandatory() const\n{\n  assert(Context.GetSize() != 0);\n\n  unsigned int EltIdx;\n  for (EltIdx = 0; EltIdx < EBML_CTX_SIZE(Context); EltIdx++) {\n    if (EBML_CTX_IDX(Context,EltIdx).IsMandatory()) {\n      if (FindElt(EBML_CTX_IDX_INFO(Context,EltIdx)) == NULL) {\n#if defined(LIBEBML_DEBUG)\n        // you are missing this Mandatory element\n//         const char * MissingName = EBML_INFO_NAME(EBML_CTX_IDX_INFO(Context,EltIdx));\n#endif // LIBEBML_DEBUG\n        return false;\n      }\n    }\n  }\n\n  return true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"ebml/MemIOCallback.h\"\n#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include <algorithm>\n#include <cassert>\n\nfilepos_t EbmlMaster::RenderData(IOCallback & output, bool bForceRender, bool bWithDefault)\n{\n  filepos_t Result = 0;\n  size_t Index;\n\n  if (!bForceRender) {\n    assert(CheckMandatory());\n  }\n\n  if (!bChecksumUsed) { // old school\n    for (Index = 0; Index < ElementList.size(); Index++) {\n      if (!bWithDefault && (ElementList[Index])->IsDefaultValue())\n        continue;\n      Result += (ElementList[Index])->Render(output, bWithDefault, false ,bForceRender);\n    }\n  } else { // new school\n    MemIOCallback TmpBuf(GetSize() - 6);\n    for (Index = 0; Index < ElementList.size(); Index++) {\n      if (!bWithDefault && (ElementList[Index])->IsDefaultValue())\n        continue;\n      (ElementList[Index])->Render(TmpBuf, bWithDefault, false ,bForceRender);\n    }\n    Checksum.FillCRC32(TmpBuf.GetDataBuffer(), TmpBuf.GetDataBufferSize());\n    Result += Checksum.Render(output, true, false ,bForceRender);\n    output.writeFully(TmpBuf.GetDataBuffer(), TmpBuf.GetDataBufferSize());\n    Result += TmpBuf.GetDataBufferSize();\n  }\n\n  return Result;\n}"
  },
  {
    "function_name": "EbmlMaster::~EbmlMaster",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlMaster.cpp",
    "lines": "73-84",
    "snippet": "EbmlMaster::~EbmlMaster()\n{\n  assert(!IsLocked()); // you're trying to delete a locked element !!!\n\n  size_t Index;\n\n  for (Index = 0; Index < ElementList.size(); Index++) {\n    if (!(*ElementList[Index]).IsLocked())  {\n      delete ElementList[Index];\n    }\n  }\n}",
    "includes": [
      "#include \"ebml/MemIOCallback.h\"",
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlStream.h\"",
      "#include \"ebml/EbmlMaster.h\"",
      "#include <algorithm>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ElementList.size",
          "args": [],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "!IsLocked()"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IsLocked",
          "args": [],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/MemIOCallback.h\"\n#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include <algorithm>\n#include <cassert>\n\nEbmlMaster::~EbmlMaster()\n{\n  assert(!IsLocked()); // you're trying to delete a locked element !!!\n\n  size_t Index;\n\n  for (Index = 0; Index < ElementList.size(); Index++) {\n    if (!(*ElementList[Index]).IsLocked())  {\n      delete ElementList[Index];\n    }\n  }\n}"
  },
  {
    "function_name": "EbmlMaster::EbmlMaster",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlMaster.cpp",
    "lines": "55-71",
    "snippet": "EbmlMaster::EbmlMaster(const EbmlMaster & ElementToClone)\n :EbmlElement(ElementToClone)\n ,ElementList(ElementToClone.ListSize())\n ,Context(ElementToClone.Context)\n ,bChecksumUsed(ElementToClone.bChecksumUsed)\n ,Checksum(ElementToClone.Checksum)\n{\n  // add a clone of the list\n  std::vector<EbmlElement *>::const_iterator Itr = ElementToClone.ElementList.begin();\n  std::vector<EbmlElement *>::iterator myItr = ElementList.begin();\n  while (Itr != ElementToClone.ElementList.end())\n  {\n    *myItr = (*Itr)->Clone();\n    ++Itr; ++myItr;\n  }\n\n}",
    "includes": [
      "#include \"ebml/MemIOCallback.h\"",
      "#include \"ebml/EbmlContexts.h\"",
      "#include \"ebml/EbmlStream.h\"",
      "#include \"ebml/EbmlMaster.h\"",
      "#include <algorithm>",
      "#include <cassert>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ElementToClone.ElementList.end",
          "args": [],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ElementList.begin",
          "args": [],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ElementToClone.ElementList.begin",
          "args": [],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ElementToClone.ListSize",
          "args": [],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"ebml/MemIOCallback.h\"\n#include \"ebml/EbmlContexts.h\"\n#include \"ebml/EbmlStream.h\"\n#include \"ebml/EbmlMaster.h\"\n#include <algorithm>\n#include <cassert>\n\nEbmlMaster::EbmlMaster(const EbmlMaster & ElementToClone)\n :EbmlElement(ElementToClone)\n ,ElementList(ElementToClone.ListSize())\n ,Context(ElementToClone.Context)\n ,bChecksumUsed(ElementToClone.bChecksumUsed)\n ,Checksum(ElementToClone.Checksum)\n{\n  // add a clone of the list\n  std::vector<EbmlElement *>::const_iterator Itr = ElementToClone.ElementList.begin();\n  std::vector<EbmlElement *>::iterator myItr = ElementList.begin();\n  while (Itr != ElementToClone.ElementList.end())\n  {\n    *myItr = (*Itr)->Clone();\n    ++Itr; ++myItr;\n  }\n\n}"
  }
]