[
  {
    "function_name": "decode",
    "container": "PackageIdJsonHandler",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/id-to-text.h",
    "lines": "68-72",
    "snippet": "void decode(const capnp::JsonCodec& codec, capnp::JsonValue::Reader input,\n              spk::PackageId::Builder output) const override {\n    KJ_REQUIRE(input.isString() && tryParsePackageId(input.getString(), output),\n               \"invalid package ID\");\n  }",
    "includes": [
      "#include <kj/debug.h>",
      "#include <capnp/compat/json.h>",
      "#include <sandstorm/package.capnp.h>",
      "#include <kj/common.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "input.isString() && tryParsePackageId(input.getString(), output)",
            "\"invalid package ID\""
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tryParsePackageId",
          "args": [
            "input.getString()",
            "output"
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "tryParsePackageId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/id-to-text.c++",
          "lines": "198-219",
          "snippet": "bool tryParsePackageId(kj::StringPtr in, kj::ArrayPtr<kj::byte> out) {\n  if (in.size() != PACKAGE_ID_TEXT_SIZE) return false;\n\n  KJ_ASSERT(out.size() == PACKAGE_ID_BYTE_SIZE);\n\n  for (auto i: kj::indices(out)) {\n    byte b = 0;\n    KJ_IF_MAYBE(d, parseHexDigit(in[i*2])) {\n      b = *d << 4;\n    } else {\n      return false;\n    }\n    KJ_IF_MAYBE(d, parseHexDigit(in[i*2+1])) {\n      b |= *d;\n    } else {\n      return false;\n    }\n    out[i] = b;\n  }\n\n  return true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"id-to-text.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"id-to-text.h\"\n\nbool tryParsePackageId(kj::StringPtr in, kj::ArrayPtr<kj::byte> out) {\n  if (in.size() != PACKAGE_ID_TEXT_SIZE) return false;\n\n  KJ_ASSERT(out.size() == PACKAGE_ID_BYTE_SIZE);\n\n  for (auto i: kj::indices(out)) {\n    byte b = 0;\n    KJ_IF_MAYBE(d, parseHexDigit(in[i*2])) {\n      b = *d << 4;\n    } else {\n      return false;\n    }\n    KJ_IF_MAYBE(d, parseHexDigit(in[i*2+1])) {\n      b |= *d;\n    } else {\n      return false;\n    }\n    out[i] = b;\n  }\n\n  return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "input.getString",
          "args": [],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "input.isString",
          "args": [],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include <capnp/compat/json.h>\n#include <sandstorm/package.capnp.h>\n#include <kj/common.h>\n\nPackageIdJsonHandler {\n  void decode(const capnp::JsonCodec& codec, capnp::JsonValue::Reader input,\n                spk::PackageId::Builder output) const override {\n      KJ_REQUIRE(input.isString() && tryParsePackageId(input.getString(), output),\n                 \"invalid package ID\");\n    }\n}"
  },
  {
    "function_name": "encode",
    "container": "PackageIdJsonHandler",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/id-to-text.h",
    "lines": "63-66",
    "snippet": "void encode(const capnp::JsonCodec& codec, spk::PackageId::Reader input,\n              capnp::JsonValue::Builder output) const override {\n    output.setString(packageIdString(input));\n  }",
    "includes": [
      "#include <kj/debug.h>",
      "#include <capnp/compat/json.h>",
      "#include <sandstorm/package.capnp.h>",
      "#include <kj/common.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "output.setString",
          "args": [
            "packageIdString(input)"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "packageIdString",
          "args": [
            "input"
          ],
          "line": 65
        },
        "resolved": true,
        "details": {
          "function_name": "packageIdString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/id-to-text.c++",
          "lines": "189-192",
          "snippet": "kj::String packageIdString(kj::ArrayPtr<const kj::byte> packageId) {\n  KJ_ASSERT(packageId.size() == PACKAGE_ID_BYTE_SIZE);\n  return hexEncode(packageId);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"id-to-text.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"id-to-text.h\"\n\nkj::String packageIdString(kj::ArrayPtr<const kj::byte> packageId) {\n  KJ_ASSERT(packageId.size() == PACKAGE_ID_BYTE_SIZE);\n  return hexEncode(packageId);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include <capnp/compat/json.h>\n#include <sandstorm/package.capnp.h>\n#include <kj/common.h>\n\nPackageIdJsonHandler {\n  void encode(const capnp::JsonCodec& codec, spk::PackageId::Reader input,\n                capnp::JsonValue::Builder output) const override {\n      output.setString(packageIdString(input));\n    }\n}"
  },
  {
    "function_name": "decode",
    "container": "AppIdJsonHandler",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/id-to-text.h",
    "lines": "54-58",
    "snippet": "void decode(const capnp::JsonCodec& codec, capnp::JsonValue::Reader input,\n              spk::AppId::Builder output) const override {\n    KJ_REQUIRE(input.isString() && tryParseAppId(input.getString(), output),\n               \"invalid app ID\");\n  }",
    "includes": [
      "#include <kj/debug.h>",
      "#include <capnp/compat/json.h>",
      "#include <sandstorm/package.capnp.h>",
      "#include <kj/common.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "input.isString() && tryParseAppId(input.getString(), output)",
            "\"invalid app ID\""
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tryParseAppId",
          "args": [
            "input.getString()",
            "output"
          ],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "tryParseAppId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/id-to-text.c++",
          "lines": "180-183",
          "snippet": "bool tryParseAppId(kj::StringPtr in, kj::ArrayPtr<kj::byte> out) {\n  KJ_REQUIRE(out.size() == APP_ID_BYTE_SIZE);\n  return BASE32_DECODER.tryDecode(in, out);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"id-to-text.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"id-to-text.h\"\n\nbool tryParseAppId(kj::StringPtr in, kj::ArrayPtr<kj::byte> out) {\n  KJ_REQUIRE(out.size() == APP_ID_BYTE_SIZE);\n  return BASE32_DECODER.tryDecode(in, out);\n}"
        }
      },
      {
        "call_info": {
          "callee": "input.getString",
          "args": [],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "input.isString",
          "args": [],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include <capnp/compat/json.h>\n#include <sandstorm/package.capnp.h>\n#include <kj/common.h>\n\nAppIdJsonHandler {\n  void decode(const capnp::JsonCodec& codec, capnp::JsonValue::Reader input,\n                spk::AppId::Builder output) const override {\n      KJ_REQUIRE(input.isString() && tryParseAppId(input.getString(), output),\n                 \"invalid app ID\");\n    }\n}"
  },
  {
    "function_name": "encode",
    "container": "AppIdJsonHandler",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/id-to-text.h",
    "lines": "49-52",
    "snippet": "void encode(const capnp::JsonCodec& codec, spk::AppId::Reader input,\n              capnp::JsonValue::Builder output) const override {\n    output.setString(appIdString(input));\n  }",
    "includes": [
      "#include <kj/debug.h>",
      "#include <capnp/compat/json.h>",
      "#include <sandstorm/package.capnp.h>",
      "#include <kj/common.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "output.setString",
          "args": [
            "appIdString(input)"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appIdString",
          "args": [
            "input"
          ],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "appIdString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/id-to-text.c++",
          "lines": "171-174",
          "snippet": "kj::String appIdString(kj::ArrayPtr<const kj::byte> appId) {\n  KJ_REQUIRE(appId.size() == APP_ID_BYTE_SIZE);\n  return base32Encode(appId);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"id-to-text.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"id-to-text.h\"\n\nkj::String appIdString(kj::ArrayPtr<const kj::byte> appId) {\n  KJ_REQUIRE(appId.size() == APP_ID_BYTE_SIZE);\n  return base32Encode(appId);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include <capnp/compat/json.h>\n#include <sandstorm/package.capnp.h>\n#include <kj/common.h>\n\nAppIdJsonHandler {\n  void encode(const capnp::JsonCodec& codec, spk::AppId::Reader input,\n                capnp::JsonValue::Builder output) const override {\n      output.setString(appIdString(input));\n    }\n}"
  }
]