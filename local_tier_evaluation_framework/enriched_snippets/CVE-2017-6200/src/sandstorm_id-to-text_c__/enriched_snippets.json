[
  {
    "function_name": "tryParsePackageId",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/id-to-text.c++",
    "lines": "198-219",
    "snippet": "bool tryParsePackageId(kj::StringPtr in, kj::ArrayPtr<kj::byte> out) {\n  if (in.size() != PACKAGE_ID_TEXT_SIZE) return false;\n\n  KJ_ASSERT(out.size() == PACKAGE_ID_BYTE_SIZE);\n\n  for (auto i: kj::indices(out)) {\n    byte b = 0;\n    KJ_IF_MAYBE(d, parseHexDigit(in[i*2])) {\n      b = *d << 4;\n    } else {\n      return false;\n    }\n    KJ_IF_MAYBE(d, parseHexDigit(in[i*2+1])) {\n      b |= *d;\n    } else {\n      return false;\n    }\n    out[i] = b;\n  }\n\n  return true;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"id-to-text.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::indices",
          "args": [
            "out"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_ASSERT",
          "args": [
            "out.size() == PACKAGE_ID_BYTE_SIZE"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "out.size",
          "args": [],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "StructyMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/util.h",
          "lines": "139-139",
          "snippet": "size_t size() { return pos - bytes; }",
          "includes": [
            "#include <set>",
            "#include <sandstorm/util.capnp.h>",
            "#include <capnp/rpc-twoparty.h>",
            "#include <kj/async.h>",
            "#include <kj/function.h>",
            "#include <unistd.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <kj/one-of.h>",
            "#include <kj/io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <set>\n#include <sandstorm/util.capnp.h>\n#include <capnp/rpc-twoparty.h>\n#include <kj/async.h>\n#include <kj/function.h>\n#include <unistd.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <kj/one-of.h>\n#include <kj/io.h>\n\nStructyMessage {\n  size_t size() { return pos - bytes; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "in.size",
          "args": [],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "MemoryMapping",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/util.h",
          "lines": "100-100",
          "snippet": "inline size_t size() const { return content.size(); }",
          "includes": [
            "#include <set>",
            "#include <sandstorm/util.capnp.h>",
            "#include <capnp/rpc-twoparty.h>",
            "#include <kj/async.h>",
            "#include <kj/function.h>",
            "#include <unistd.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <kj/one-of.h>",
            "#include <kj/io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <set>\n#include <sandstorm/util.capnp.h>\n#include <capnp/rpc-twoparty.h>\n#include <kj/async.h>\n#include <kj/function.h>\n#include <unistd.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <kj/one-of.h>\n#include <kj/io.h>\n\nMemoryMapping {\n  inline size_t size() const { return content.size(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"id-to-text.h\"\n\nbool tryParsePackageId(kj::StringPtr in, kj::ArrayPtr<kj::byte> out) {\n  if (in.size() != PACKAGE_ID_TEXT_SIZE) return false;\n\n  KJ_ASSERT(out.size() == PACKAGE_ID_BYTE_SIZE);\n\n  for (auto i: kj::indices(out)) {\n    byte b = 0;\n    KJ_IF_MAYBE(d, parseHexDigit(in[i*2])) {\n      b = *d << 4;\n    } else {\n      return false;\n    }\n    KJ_IF_MAYBE(d, parseHexDigit(in[i*2+1])) {\n      b |= *d;\n    } else {\n      return false;\n    }\n    out[i] = b;\n  }\n\n  return true;\n}"
  },
  {
    "function_name": "tryParsePackageId",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/id-to-text.c++",
    "lines": "194-196",
    "snippet": "bool tryParsePackageId(kj::StringPtr in, spk::PackageId::Builder out) {\n  return tryParsePackageId(in, capnp::AnyStruct::Builder(kj::mv(out)).getDataSection());\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"id-to-text.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tryParsePackageId",
          "args": [
            "in",
            "capnp::AnyStruct::Builder(kj::mv(out)).getDataSection()"
          ],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "tryParsePackageId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/id-to-text.c++",
          "lines": "198-219",
          "snippet": "bool tryParsePackageId(kj::StringPtr in, kj::ArrayPtr<kj::byte> out) {\n  if (in.size() != PACKAGE_ID_TEXT_SIZE) return false;\n\n  KJ_ASSERT(out.size() == PACKAGE_ID_BYTE_SIZE);\n\n  for (auto i: kj::indices(out)) {\n    byte b = 0;\n    KJ_IF_MAYBE(d, parseHexDigit(in[i*2])) {\n      b = *d << 4;\n    } else {\n      return false;\n    }\n    KJ_IF_MAYBE(d, parseHexDigit(in[i*2+1])) {\n      b |= *d;\n    } else {\n      return false;\n    }\n    out[i] = b;\n  }\n\n  return true;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "capnp::AnyStruct::Builder",
          "args": [],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capnp::AnyStruct::Builder",
          "args": [
            "kj::mv(out)"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "out"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"id-to-text.h\"\n\nbool tryParsePackageId(kj::StringPtr in, spk::PackageId::Builder out) {\n  return tryParsePackageId(in, capnp::AnyStruct::Builder(kj::mv(out)).getDataSection());\n}"
  },
  {
    "function_name": "packageIdString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/id-to-text.c++",
    "lines": "189-192",
    "snippet": "kj::String packageIdString(kj::ArrayPtr<const kj::byte> packageId) {\n  KJ_ASSERT(packageId.size() == PACKAGE_ID_BYTE_SIZE);\n  return hexEncode(packageId);\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"id-to-text.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hexEncode",
          "args": [
            "packageId"
          ],
          "line": 191
        },
        "resolved": true,
        "details": {
          "function_name": "hexEncode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/util.c++",
          "lines": "784-787",
          "snippet": "kj::String hexEncode(kj::ArrayPtr<const byte> input) {\n  const char DIGITS[] = \"0123456789abcdef\";\n  return kj::strArray(KJ_MAP(b, input) { return kj::heapArray<char>({DIGITS[b/16], DIGITS[b%16]}); }, \"\");\n}",
          "includes": [
            "#include <sys/sendfile.h>",
            "#include <sys/socket.h>",
            "#include <sys/mman.h>",
            "#include <map>",
            "#include <sys/wait.h>",
            "#include <signal.h>",
            "#include <syscall.h>",
            "#include <dirent.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <ctype.h>",
            "#include <kj/async-unix.h>",
            "#include <kj/vector.h>",
            "#include <errno.h>",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/sendfile.h>\n#include <sys/socket.h>\n#include <sys/mman.h>\n#include <map>\n#include <sys/wait.h>\n#include <signal.h>\n#include <syscall.h>\n#include <dirent.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <ctype.h>\n#include <kj/async-unix.h>\n#include <kj/vector.h>\n#include <errno.h>\n#include \"util.h\"\n\nkj::String hexEncode(kj::ArrayPtr<const byte> input) {\n  const char DIGITS[] = \"0123456789abcdef\";\n  return kj::strArray(KJ_MAP(b, input) { return kj::heapArray<char>({DIGITS[b/16], DIGITS[b%16]}); }, \"\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "KJ_ASSERT",
          "args": [
            "packageId.size() == PACKAGE_ID_BYTE_SIZE"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "packageId.size",
          "args": [],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "StructyMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/util.h",
          "lines": "139-139",
          "snippet": "size_t size() { return pos - bytes; }",
          "includes": [
            "#include <set>",
            "#include <sandstorm/util.capnp.h>",
            "#include <capnp/rpc-twoparty.h>",
            "#include <kj/async.h>",
            "#include <kj/function.h>",
            "#include <unistd.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <kj/one-of.h>",
            "#include <kj/io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <set>\n#include <sandstorm/util.capnp.h>\n#include <capnp/rpc-twoparty.h>\n#include <kj/async.h>\n#include <kj/function.h>\n#include <unistd.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <kj/one-of.h>\n#include <kj/io.h>\n\nStructyMessage {\n  size_t size() { return pos - bytes; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"id-to-text.h\"\n\nkj::String packageIdString(kj::ArrayPtr<const kj::byte> packageId) {\n  KJ_ASSERT(packageId.size() == PACKAGE_ID_BYTE_SIZE);\n  return hexEncode(packageId);\n}"
  },
  {
    "function_name": "packageIdString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/id-to-text.c++",
    "lines": "185-187",
    "snippet": "kj::String packageIdString(spk::PackageId::Reader packageId) {\n  return packageIdString(capnp::AnyStruct::Reader(packageId).getDataSection());\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"id-to-text.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "packageIdString",
          "args": [
            "capnp::AnyStruct::Reader(packageId).getDataSection()"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "packageIdString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/id-to-text.c++",
          "lines": "189-192",
          "snippet": "kj::String packageIdString(kj::ArrayPtr<const kj::byte> packageId) {\n  KJ_ASSERT(packageId.size() == PACKAGE_ID_BYTE_SIZE);\n  return hexEncode(packageId);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "capnp::AnyStruct::Reader",
          "args": [],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capnp::AnyStruct::Reader",
          "args": [
            "packageId"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"id-to-text.h\"\n\nkj::String packageIdString(spk::PackageId::Reader packageId) {\n  return packageIdString(capnp::AnyStruct::Reader(packageId).getDataSection());\n}"
  },
  {
    "function_name": "tryParseAppId",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/id-to-text.c++",
    "lines": "180-183",
    "snippet": "bool tryParseAppId(kj::StringPtr in, kj::ArrayPtr<kj::byte> out) {\n  KJ_REQUIRE(out.size() == APP_ID_BYTE_SIZE);\n  return BASE32_DECODER.tryDecode(in, out);\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"id-to-text.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BASE32_DECODER.tryDecode",
          "args": [
            "in",
            "out"
          ],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "tryDecode",
          "container": "Base32Decoder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/id-to-text.c++",
          "lines": "115-142",
          "snippet": "bool tryDecode(kj::StringPtr encoded, kj::ArrayPtr<byte> output) const {\n    // We intentionally round the size down.  Leftover bits are presumably zero.\n    size_t expectedBytes = encoded.size() * 5 / 8;\n    if (output.size() != expectedBytes) return false;\n\n    uint buffer = 0;\n    uint bitsLeft = 0;\n    uint count = 0;\n    for (char c: encoded) {\n      byte decoded = decodeTable[(byte)c];\n      if (decoded > 32) return false;\n\n      buffer <<= 5;\n      buffer |= decoded;\n      bitsLeft += 5;\n      if (bitsLeft >= 8) {\n        KJ_ASSERT(count < output.size());\n        bitsLeft -= 8;\n        output[count++] = buffer >> bitsLeft;\n      }\n    }\n    KJ_ASSERT(count == output.size());\n\n    buffer &= (1 << bitsLeft) - 1;\n    if (buffer != 0) return false;  // non-zero leftover bits!\n\n    return true;\n  }",
          "includes": [
            "#include \"util.h\"",
            "#include \"id-to-text.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"id-to-text.h\"\n\nBase32Decoder {\n  bool tryDecode(kj::StringPtr encoded, kj::ArrayPtr<byte> output) const {\n      // We intentionally round the size down.  Leftover bits are presumably zero.\n      size_t expectedBytes = encoded.size() * 5 / 8;\n      if (output.size() != expectedBytes) return false;\n  \n      uint buffer = 0;\n      uint bitsLeft = 0;\n      uint count = 0;\n      for (char c: encoded) {\n        byte decoded = decodeTable[(byte)c];\n        if (decoded > 32) return false;\n  \n        buffer <<= 5;\n        buffer |= decoded;\n        bitsLeft += 5;\n        if (bitsLeft >= 8) {\n          KJ_ASSERT(count < output.size());\n          bitsLeft -= 8;\n          output[count++] = buffer >> bitsLeft;\n        }\n      }\n      KJ_ASSERT(count == output.size());\n  \n      buffer &= (1 << bitsLeft) - 1;\n      if (buffer != 0) return false;  // non-zero leftover bits!\n  \n      return true;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "out.size() == APP_ID_BYTE_SIZE"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "out.size",
          "args": [],
          "line": 181
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "StructyMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/util.h",
          "lines": "139-139",
          "snippet": "size_t size() { return pos - bytes; }",
          "includes": [
            "#include <set>",
            "#include <sandstorm/util.capnp.h>",
            "#include <capnp/rpc-twoparty.h>",
            "#include <kj/async.h>",
            "#include <kj/function.h>",
            "#include <unistd.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <kj/one-of.h>",
            "#include <kj/io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <set>\n#include <sandstorm/util.capnp.h>\n#include <capnp/rpc-twoparty.h>\n#include <kj/async.h>\n#include <kj/function.h>\n#include <unistd.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <kj/one-of.h>\n#include <kj/io.h>\n\nStructyMessage {\n  size_t size() { return pos - bytes; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"id-to-text.h\"\n\nbool tryParseAppId(kj::StringPtr in, kj::ArrayPtr<kj::byte> out) {\n  KJ_REQUIRE(out.size() == APP_ID_BYTE_SIZE);\n  return BASE32_DECODER.tryDecode(in, out);\n}"
  },
  {
    "function_name": "tryParseAppId",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/id-to-text.c++",
    "lines": "176-178",
    "snippet": "bool tryParseAppId(kj::StringPtr in, spk::AppId::Builder out) {\n  return tryParseAppId(in, capnp::AnyStruct::Builder(kj::mv(out)).getDataSection());\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"id-to-text.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tryParseAppId",
          "args": [
            "in",
            "capnp::AnyStruct::Builder(kj::mv(out)).getDataSection()"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "tryParseAppId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/id-to-text.c++",
          "lines": "180-183",
          "snippet": "bool tryParseAppId(kj::StringPtr in, kj::ArrayPtr<kj::byte> out) {\n  KJ_REQUIRE(out.size() == APP_ID_BYTE_SIZE);\n  return BASE32_DECODER.tryDecode(in, out);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "capnp::AnyStruct::Builder",
          "args": [],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capnp::AnyStruct::Builder",
          "args": [
            "kj::mv(out)"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "out"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"id-to-text.h\"\n\nbool tryParseAppId(kj::StringPtr in, spk::AppId::Builder out) {\n  return tryParseAppId(in, capnp::AnyStruct::Builder(kj::mv(out)).getDataSection());\n}"
  },
  {
    "function_name": "appIdString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/id-to-text.c++",
    "lines": "171-174",
    "snippet": "kj::String appIdString(kj::ArrayPtr<const kj::byte> appId) {\n  KJ_REQUIRE(appId.size() == APP_ID_BYTE_SIZE);\n  return base32Encode(appId);\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"id-to-text.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "base32Encode",
          "args": [
            "appId"
          ],
          "line": 173
        },
        "resolved": true,
        "details": {
          "function_name": "base32Encode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/id-to-text.c++",
          "lines": "38-68",
          "snippet": "kj::String base32Encode(kj::ArrayPtr<const byte> data) {\n  // We'll need a character for every 5 bits, rounded up.\n  auto result = kj::heapString((data.size() * 8 + 4) / 5);\n\n  uint count = 0;\n  if (data.size() > 0) {\n    uint buffer = data[0];\n    uint next = 1;\n    uint bitsLeft = 8;\n    while (bitsLeft > 0 || next < data.size()) {\n      if (bitsLeft < 5) {\n        if (next < data.size()) {\n          buffer <<= 8;\n          buffer |= data[next++] & 0xFF;\n          bitsLeft += 8;\n        } else {\n          // No more input; pad with zeros.\n          uint pad = 5 - bitsLeft;\n          buffer <<= pad;\n          bitsLeft += pad;\n        }\n      }\n      uint index = 0x1F & (buffer >> (bitsLeft - 5));\n      bitsLeft -= 5;\n      KJ_ASSERT(count < result.size());\n      result[count++] = BASE32_ENCODE_TABLE[index];\n    }\n  }\n\n  return result;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"id-to-text.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"id-to-text.h\"\n\nkj::String base32Encode(kj::ArrayPtr<const byte> data) {\n  // We'll need a character for every 5 bits, rounded up.\n  auto result = kj::heapString((data.size() * 8 + 4) / 5);\n\n  uint count = 0;\n  if (data.size() > 0) {\n    uint buffer = data[0];\n    uint next = 1;\n    uint bitsLeft = 8;\n    while (bitsLeft > 0 || next < data.size()) {\n      if (bitsLeft < 5) {\n        if (next < data.size()) {\n          buffer <<= 8;\n          buffer |= data[next++] & 0xFF;\n          bitsLeft += 8;\n        } else {\n          // No more input; pad with zeros.\n          uint pad = 5 - bitsLeft;\n          buffer <<= pad;\n          bitsLeft += pad;\n        }\n      }\n      uint index = 0x1F & (buffer >> (bitsLeft - 5));\n      bitsLeft -= 5;\n      KJ_ASSERT(count < result.size());\n      result[count++] = BASE32_ENCODE_TABLE[index];\n    }\n  }\n\n  return result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "appId.size() == APP_ID_BYTE_SIZE"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appId.size",
          "args": [],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "StructyMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/util.h",
          "lines": "139-139",
          "snippet": "size_t size() { return pos - bytes; }",
          "includes": [
            "#include <set>",
            "#include <sandstorm/util.capnp.h>",
            "#include <capnp/rpc-twoparty.h>",
            "#include <kj/async.h>",
            "#include <kj/function.h>",
            "#include <unistd.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <kj/one-of.h>",
            "#include <kj/io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <set>\n#include <sandstorm/util.capnp.h>\n#include <capnp/rpc-twoparty.h>\n#include <kj/async.h>\n#include <kj/function.h>\n#include <unistd.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <kj/one-of.h>\n#include <kj/io.h>\n\nStructyMessage {\n  size_t size() { return pos - bytes; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"id-to-text.h\"\n\nkj::String appIdString(kj::ArrayPtr<const kj::byte> appId) {\n  KJ_REQUIRE(appId.size() == APP_ID_BYTE_SIZE);\n  return base32Encode(appId);\n}"
  },
  {
    "function_name": "appIdString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/id-to-text.c++",
    "lines": "167-169",
    "snippet": "kj::String appIdString(spk::AppId::Reader appId) {\n  return appIdString(capnp::AnyStruct::Reader(appId).getDataSection());\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"id-to-text.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "appIdString",
          "args": [
            "capnp::AnyStruct::Reader(appId).getDataSection()"
          ],
          "line": 168
        },
        "resolved": true,
        "details": {
          "function_name": "appIdString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/id-to-text.c++",
          "lines": "171-174",
          "snippet": "kj::String appIdString(kj::ArrayPtr<const kj::byte> appId) {\n  KJ_REQUIRE(appId.size() == APP_ID_BYTE_SIZE);\n  return base32Encode(appId);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "capnp::AnyStruct::Reader",
          "args": [],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capnp::AnyStruct::Reader",
          "args": [
            "appId"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"id-to-text.h\"\n\nkj::String appIdString(spk::AppId::Reader appId) {\n  return appIdString(capnp::AnyStruct::Reader(appId).getDataSection());\n}"
  },
  {
    "function_name": "parseHexDigit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/id-to-text.c++",
    "lines": "153-163",
    "snippet": "static kj::Maybe<uint> parseHexDigit(char c) {\n  if ('0' <= c && c <= '9') {\n    return static_cast<uint>(c - '0');\n  } else if ('a' <= c && c <= 'f') {\n    return static_cast<uint>(c - 'a') + 0xa;\n  } else if ('A' <= c && c <= 'F') {\n    return static_cast<uint>(c - 'A') + 0xa;\n  } else {\n    return nullptr;\n  }\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"id-to-text.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "static_cast<uint>",
          "args": [
            "c - 'A'"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<uint>",
          "args": [
            "c - 'a'"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<uint>",
          "args": [
            "c - '0'"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"id-to-text.h\"\n\nstatic kj::Maybe<uint> parseHexDigit(char c) {\n  if ('0' <= c && c <= '9') {\n    return static_cast<uint>(c - '0');\n  } else if ('a' <= c && c <= 'f') {\n    return static_cast<uint>(c - 'a') + 0xa;\n  } else if ('A' <= c && c <= 'F') {\n    return static_cast<uint>(c - 'A') + 0xa;\n  } else {\n    return nullptr;\n  }\n}"
  },
  {
    "function_name": "tryDecode",
    "container": "Base32Decoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/id-to-text.c++",
    "lines": "115-142",
    "snippet": "bool tryDecode(kj::StringPtr encoded, kj::ArrayPtr<byte> output) const {\n    // We intentionally round the size down.  Leftover bits are presumably zero.\n    size_t expectedBytes = encoded.size() * 5 / 8;\n    if (output.size() != expectedBytes) return false;\n\n    uint buffer = 0;\n    uint bitsLeft = 0;\n    uint count = 0;\n    for (char c: encoded) {\n      byte decoded = decodeTable[(byte)c];\n      if (decoded > 32) return false;\n\n      buffer <<= 5;\n      buffer |= decoded;\n      bitsLeft += 5;\n      if (bitsLeft >= 8) {\n        KJ_ASSERT(count < output.size());\n        bitsLeft -= 8;\n        output[count++] = buffer >> bitsLeft;\n      }\n    }\n    KJ_ASSERT(count == output.size());\n\n    buffer &= (1 << bitsLeft) - 1;\n    if (buffer != 0) return false;  // non-zero leftover bits!\n\n    return true;\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"id-to-text.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "KJ_ASSERT",
          "args": [
            "count == output.size()"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "output.size",
          "args": [],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "StructyMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/util.h",
          "lines": "139-139",
          "snippet": "size_t size() { return pos - bytes; }",
          "includes": [
            "#include <set>",
            "#include <sandstorm/util.capnp.h>",
            "#include <capnp/rpc-twoparty.h>",
            "#include <kj/async.h>",
            "#include <kj/function.h>",
            "#include <unistd.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <kj/one-of.h>",
            "#include <kj/io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <set>\n#include <sandstorm/util.capnp.h>\n#include <capnp/rpc-twoparty.h>\n#include <kj/async.h>\n#include <kj/function.h>\n#include <unistd.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <kj/one-of.h>\n#include <kj/io.h>\n\nStructyMessage {\n  size_t size() { return pos - bytes; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "KJ_ASSERT",
          "args": [
            "count < output.size()"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"id-to-text.h\"\n\nBase32Decoder {\n  bool tryDecode(kj::StringPtr encoded, kj::ArrayPtr<byte> output) const {\n      // We intentionally round the size down.  Leftover bits are presumably zero.\n      size_t expectedBytes = encoded.size() * 5 / 8;\n      if (output.size() != expectedBytes) return false;\n  \n      uint buffer = 0;\n      uint bitsLeft = 0;\n      uint count = 0;\n      for (char c: encoded) {\n        byte decoded = decodeTable[(byte)c];\n        if (decoded > 32) return false;\n  \n        buffer <<= 5;\n        buffer |= decoded;\n        bitsLeft += 5;\n        if (bitsLeft >= 8) {\n          KJ_ASSERT(count < output.size());\n          bitsLeft -= 8;\n          output[count++] = buffer >> bitsLeft;\n        }\n      }\n      KJ_ASSERT(count == output.size());\n  \n      buffer &= (1 << bitsLeft) - 1;\n      if (buffer != 0) return false;  // non-zero leftover bits!\n  \n      return true;\n    }\n}"
  },
  {
    "function_name": "verifyTable",
    "container": "Base32Decoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/id-to-text.c++",
    "lines": "96-113",
    "snippet": "constexpr bool verifyTable() const {\n    // Verify that all letters and digits have a decoding.\n    //\n    // Oh cool, this can also be done at compile time, and then checked with a static_assert below.\n    //\n    // C++14 is awesome.\n\n    for (unsigned char c = '0'; c <= '9'; c++) {\n      if (decodeTable[c] == 255) return false;\n    }\n    for (unsigned char c = 'a'; c <= 'z'; c++) {\n      if (decodeTable[c] == 255) return false;\n    }\n    for (unsigned char c = 'A'; c <= 'Z'; c++) {\n      if (decodeTable[c] == 255) return false;\n    }\n    return true;\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"id-to-text.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util.h\"\n#include \"id-to-text.h\"\n\nBase32Decoder {\n  constexpr bool verifyTable() const {\n      // Verify that all letters and digits have a decoding.\n      //\n      // Oh cool, this can also be done at compile time, and then checked with a static_assert below.\n      //\n      // C++14 is awesome.\n  \n      for (unsigned char c = '0'; c <= '9'; c++) {\n        if (decodeTable[c] == 255) return false;\n      }\n      for (unsigned char c = 'a'; c <= 'z'; c++) {\n        if (decodeTable[c] == 255) return false;\n      }\n      for (unsigned char c = 'A'; c <= 'Z'; c++) {\n        if (decodeTable[c] == 255) return false;\n      }\n      return true;\n    }\n}"
  },
  {
    "function_name": "Base32Decoder",
    "container": "Base32Decoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/id-to-text.c++",
    "lines": "72-94",
    "snippet": "constexpr Base32Decoder(): decodeTable() {\n    // Cool, we can generate our lookup table at compile time.\n\n    for (byte& b: decodeTable) {\n      b = 255;\n    }\n\n    for (uint i = 0; i < sizeof(BASE32_ENCODE_TABLE) - 1; i++) {\n      unsigned char c = BASE32_ENCODE_TABLE[i];\n      decodeTable[c] = i;\n      if ('a' <= c && c <= 'z') {\n        decodeTable[c - 'a' + 'A'] = i;\n      }\n    }\n\n#pragma GCC diagnostic push\n#pragma GCC diagnostic ignored \"-Wchar-subscripts\"\n    decodeTable['o'] = decodeTable['O'] = 0;\n    decodeTable['i'] = decodeTable['I'] = 1;\n    decodeTable['l'] = decodeTable['L'] = 1;\n    decodeTable['b'] = decodeTable['B'] = 8;\n#pragma GCC diagnostic pop\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"id-to-text.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util.h\"\n#include \"id-to-text.h\"\n\nBase32Decoder {\n  constexpr Base32Decoder(): decodeTable() {\n      // Cool, we can generate our lookup table at compile time.\n  \n      for (byte& b: decodeTable) {\n        b = 255;\n      }\n  \n      for (uint i = 0; i < sizeof(BASE32_ENCODE_TABLE) - 1; i++) {\n        unsigned char c = BASE32_ENCODE_TABLE[i];\n        decodeTable[c] = i;\n        if ('a' <= c && c <= 'z') {\n          decodeTable[c - 'a' + 'A'] = i;\n        }\n      }\n  \n  #pragma GCC diagnostic push\n  #pragma GCC diagnostic ignored \"-Wchar-subscripts\"\n      decodeTable['o'] = decodeTable['O'] = 0;\n      decodeTable['i'] = decodeTable['I'] = 1;\n      decodeTable['l'] = decodeTable['L'] = 1;\n      decodeTable['b'] = decodeTable['B'] = 8;\n  #pragma GCC diagnostic pop\n    }\n}"
  },
  {
    "function_name": "base32Encode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/id-to-text.c++",
    "lines": "38-68",
    "snippet": "kj::String base32Encode(kj::ArrayPtr<const byte> data) {\n  // We'll need a character for every 5 bits, rounded up.\n  auto result = kj::heapString((data.size() * 8 + 4) / 5);\n\n  uint count = 0;\n  if (data.size() > 0) {\n    uint buffer = data[0];\n    uint next = 1;\n    uint bitsLeft = 8;\n    while (bitsLeft > 0 || next < data.size()) {\n      if (bitsLeft < 5) {\n        if (next < data.size()) {\n          buffer <<= 8;\n          buffer |= data[next++] & 0xFF;\n          bitsLeft += 8;\n        } else {\n          // No more input; pad with zeros.\n          uint pad = 5 - bitsLeft;\n          buffer <<= pad;\n          bitsLeft += pad;\n        }\n      }\n      uint index = 0x1F & (buffer >> (bitsLeft - 5));\n      bitsLeft -= 5;\n      KJ_ASSERT(count < result.size());\n      result[count++] = BASE32_ENCODE_TABLE[index];\n    }\n  }\n\n  return result;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"id-to-text.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "KJ_ASSERT",
          "args": [
            "count < result.size()"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result.size",
          "args": [],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "StructyMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/util.h",
          "lines": "139-139",
          "snippet": "size_t size() { return pos - bytes; }",
          "includes": [
            "#include <set>",
            "#include <sandstorm/util.capnp.h>",
            "#include <capnp/rpc-twoparty.h>",
            "#include <kj/async.h>",
            "#include <kj/function.h>",
            "#include <unistd.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <kj/one-of.h>",
            "#include <kj/io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <set>\n#include <sandstorm/util.capnp.h>\n#include <capnp/rpc-twoparty.h>\n#include <kj/async.h>\n#include <kj/function.h>\n#include <unistd.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <kj/one-of.h>\n#include <kj/io.h>\n\nStructyMessage {\n  size_t size() { return pos - bytes; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::heapString",
          "args": [
            "(data.size() * 8 + 4) / 5"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"id-to-text.h\"\n\nkj::String base32Encode(kj::ArrayPtr<const byte> data) {\n  // We'll need a character for every 5 bits, rounded up.\n  auto result = kj::heapString((data.size() * 8 + 4) / 5);\n\n  uint count = 0;\n  if (data.size() > 0) {\n    uint buffer = data[0];\n    uint next = 1;\n    uint bitsLeft = 8;\n    while (bitsLeft > 0 || next < data.size()) {\n      if (bitsLeft < 5) {\n        if (next < data.size()) {\n          buffer <<= 8;\n          buffer |= data[next++] & 0xFF;\n          bitsLeft += 8;\n        } else {\n          // No more input; pad with zeros.\n          uint pad = 5 - bitsLeft;\n          buffer <<= pad;\n          bitsLeft += pad;\n        }\n      }\n      uint index = 0x1F & (buffer >> (bitsLeft - 5));\n      bitsLeft -= 5;\n      KJ_ASSERT(count < result.size());\n      result[count++] = BASE32_ENCODE_TABLE[index];\n    }\n  }\n\n  return result;\n}"
  }
]