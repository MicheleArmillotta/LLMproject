[
  {
    "function_name": "mapFile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "726-787",
    "snippet": "FileMapping mapFile(kj::StringPtr sourceDir, spk::SourceMap::Reader sourceMap, kj::StringPtr name) {\n  kj::Vector<kj::String> matches;\n  kj::Vector<kj::String> virtualChildren;\n\n  for (auto dir: sourceMap.getSearchPath()) {\n    auto virtualPath = dir.getPackagePath();\n    KJ_IF_MAYBE(subPath, tryRemovePathPrefix(name, virtualPath)) {\n      // If the path is some file or subdirectory inside the virtual path...\n      if (subPath->size() > 0) {\n        // ... then check to see if it's hidden.\n        bool hidden = false;\n        for (auto hide: dir.getHidePaths()) {\n          if (tryRemovePathPrefix(*subPath, hide) != nullptr) {\n            hidden = true;\n            break;\n          }\n        }\n        if (hidden) continue;\n      }\n\n      // Not hidden, so now check if this path exists.\n      auto sourcePath = dir.getSourcePath();\n      auto candidate = joinPaths(sourcePath, *subPath);\n\n      // Prepend `sourceDir` to relative paths.\n      candidate = joinPaths(sourceDir, candidate);\n\n      if (faccessat(AT_FDCWD, candidate.cStr(), F_OK, AT_SYMLINK_NOFOLLOW) == 0) {\n        // Found!\n\n        if (name.size() == 0) {\n          // This is a root mapping. In this case we follow symlinks eagerly.\n          struct stat stats;\n          KJ_SYSCALL(lstat(candidate.cStr(), &stats));\n          if (S_ISLNK(stats.st_mode)) {\n            char* real;\n            KJ_SYSCALL(real = realpath(candidate.cStr(), NULL));\n            KJ_DEFER(free(real));\n            candidate = kj::str(real);\n          }\n        }\n\n        matches.add(kj::mv(candidate));\n      }\n    } else {\n      // virtualPath is not a prefix of `name`, but is `name` a prefix of `virtualPath`?\n      KJ_IF_MAYBE(child, tryRemovePathPrefix(virtualPath, name)) {\n        // Yep.\n        KJ_IF_MAYBE(slashPos, child->findFirst('/')) {\n          virtualChildren.add(kj::heapString(child->slice(0, *slashPos)));\n        } else {\n          virtualChildren.add(kj::heapString(*child));\n        }\n      }\n    }\n  }\n\n  return FileMapping {\n    matches.releaseAsArray(),\n    virtualChildren.releaseAsArray()\n  };\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virtualChildren.releaseAsArray",
          "args": [],
          "line": 785
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "matches.releaseAsArray",
          "args": [],
          "line": 784
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virtualChildren.add",
          "args": [
            "kj::heapString(*child)"
          ],
          "line": 777
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::heapString",
          "args": [
            "*child"
          ],
          "line": 777
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virtualChildren.add",
          "args": [
            "kj::heapString(child->slice(0, *slashPos))"
          ],
          "line": 775
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::heapString",
          "args": [
            "child->slice(0, *slashPos)"
          ],
          "line": 775
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "child->slice",
          "args": [
            "0",
            "*slashPos"
          ],
          "line": 775
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_IF_MAYBE",
          "args": [
            "slashPos",
            "child->findFirst('/')"
          ],
          "line": 774
        },
        "resolved": true,
        "details": {
          "function_name": "KJ_IF_MAYBE",
          "container": "BridgeProxy",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/bridge-proxy.c++",
          "lines": "144-150",
          "snippet": "KJ_IF_MAYBE(auth, headers.get(hAuthorization)) {\n      if (auth->startsWith(\"bearer \") || auth->startsWith(\"Bearer \")) {\n        auto token = auth->slice(strlen(\"bearer \"));\n        auto session = getHttpSession(token);\n        return dispatchToSession(kj::mv(session), method, url, headers, requestBody, response);\n      }\n    }",
          "includes": [
            "#include \"util.h\"",
            "#include <kj/debug.h>",
            "#include <capnp/compat/json.h>",
            "#include <sandstorm/bridge-proxy.capnp.h>",
            "#include <sandstorm/api-session.capnp.h>",
            "#include <map>",
            "#include \"bridge-proxy.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <kj/debug.h>\n#include <capnp/compat/json.h>\n#include <sandstorm/bridge-proxy.capnp.h>\n#include <sandstorm/api-session.capnp.h>\n#include <map>\n#include \"bridge-proxy.h\"\n\nBridgeProxy {\n  KJ_IF_MAYBE(auth, headers.get(hAuthorization)) {\n        if (auth->startsWith(\"bearer \") || auth->startsWith(\"Bearer \")) {\n          auto token = auth->slice(strlen(\"bearer \"));\n          auto session = getHttpSession(token);\n          return dispatchToSession(kj::mv(session), method, url, headers, requestBody, response);\n        }\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "child->findFirst",
          "args": [
            "'/'"
          ],
          "line": 774
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tryRemovePathPrefix",
          "args": [
            "virtualPath",
            "name"
          ],
          "line": 772
        },
        "resolved": true,
        "details": {
          "function_name": "tryRemovePathPrefix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
          "lines": "688-724",
          "snippet": "static kj::Maybe<kj::StringPtr> tryRemovePathPrefix(kj::StringPtr path, kj::StringPtr prefix) {\n  // If `prefix` names a parent directory of `path`, then return the remainder of `path` after\n  // removing said parent. Otherwise return null.\n  //\n  // Special rules:\n  // - It can't merely be a string prefix, because the prefix must be a whole node name. E.g.\n  //   \"foo\" is a prefix of \"foo/bar\" but not of \"foobar/baz\".\n  // - An empty `prefix` means \"current directory\" and so is always matched unless `path` is\n  //   absolute.\n  // - An exact match returns an empty string.\n\n  if (!path.startsWith(prefix)) {\n    return nullptr;\n  }\n\n  if (prefix.size() == 0) {\n    // Empty prefix = current dir.\n    if (path.startsWith(\"/\")) {\n      return nullptr;\n    } else {\n      return path;\n    }\n  }\n\n  if (path.size() == prefix.size()) {\n    // Exact match.\n    return kj::StringPtr(\"\");\n  }\n\n  if (path[prefix.size()] == '/') {\n    // Path prefix match. Strip off prefix and slash.\n    return path.slice(prefix.size() + 1);\n  } else {\n    // It's a string prefix match but not a path prefix match.\n    return nullptr;\n  }\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"fuse.h\"",
            "#include <stdlib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/serialize.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include \"union-fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nstatic kj::Maybe<kj::StringPtr> tryRemovePathPrefix(kj::StringPtr path, kj::StringPtr prefix) {\n  // If `prefix` names a parent directory of `path`, then return the remainder of `path` after\n  // removing said parent. Otherwise return null.\n  //\n  // Special rules:\n  // - It can't merely be a string prefix, because the prefix must be a whole node name. E.g.\n  //   \"foo\" is a prefix of \"foo/bar\" but not of \"foobar/baz\".\n  // - An empty `prefix` means \"current directory\" and so is always matched unless `path` is\n  //   absolute.\n  // - An exact match returns an empty string.\n\n  if (!path.startsWith(prefix)) {\n    return nullptr;\n  }\n\n  if (prefix.size() == 0) {\n    // Empty prefix = current dir.\n    if (path.startsWith(\"/\")) {\n      return nullptr;\n    } else {\n      return path;\n    }\n  }\n\n  if (path.size() == prefix.size()) {\n    // Exact match.\n    return kj::StringPtr(\"\");\n  }\n\n  if (path[prefix.size()] == '/') {\n    // Path prefix match. Strip off prefix and slash.\n    return path.slice(prefix.size() + 1);\n  } else {\n    // It's a string prefix match but not a path prefix match.\n    return nullptr;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "matches.add",
          "args": [
            "kj::mv(candidate)"
          ],
          "line": 768
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "candidate"
          ],
          "line": 768
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "real"
          ],
          "line": 764
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_DEFER",
          "args": [
            "free(real)"
          ],
          "line": 763
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "real"
          ],
          "line": 763
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_SYSCALL",
          "args": [
            "real = realpath(candidate.cStr(), NULL)"
          ],
          "line": 762
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "realpath",
          "args": [
            "candidate.cStr()",
            "NULL"
          ],
          "line": 762
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "candidate.cStr",
          "args": [],
          "line": 762
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISLNK",
          "args": [
            "stats.st_mode"
          ],
          "line": 760
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_SYSCALL",
          "args": [
            "lstat(candidate.cStr(), &stats)"
          ],
          "line": 759
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lstat",
          "args": [
            "candidate.cStr()",
            "&stats"
          ],
          "line": 759
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "candidate.cStr",
          "args": [],
          "line": 759
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "name.size",
          "args": [],
          "line": 756
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "StructyMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/util.h",
          "lines": "139-139",
          "snippet": "size_t size() { return pos - bytes; }",
          "includes": [
            "#include <set>",
            "#include <sandstorm/util.capnp.h>",
            "#include <capnp/rpc-twoparty.h>",
            "#include <kj/async.h>",
            "#include <kj/function.h>",
            "#include <unistd.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <kj/one-of.h>",
            "#include <kj/io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <set>\n#include <sandstorm/util.capnp.h>\n#include <capnp/rpc-twoparty.h>\n#include <kj/async.h>\n#include <kj/function.h>\n#include <unistd.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <kj/one-of.h>\n#include <kj/io.h>\n\nStructyMessage {\n  size_t size() { return pos - bytes; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "faccessat",
          "args": [
            "AT_FDCWD",
            "candidate.cStr()",
            "F_OK",
            "AT_SYMLINK_NOFOLLOW"
          ],
          "line": 753
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "candidate.cStr",
          "args": [],
          "line": 753
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "joinPaths",
          "args": [
            "sourceDir",
            "candidate"
          ],
          "line": 751
        },
        "resolved": true,
        "details": {
          "function_name": "joinPaths",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
          "lines": "670-686",
          "snippet": "static kj::String joinPaths(kj::StringPtr a, kj::StringPtr b) {\n  // e.g. joinPaths(\"foo\", \"bar\") -> \"foo/bar\".\n  //\n  // Special rules:\n  // - An empty operand is equivalent to \".\", therefore we return the other operand.\n  // - If the right operand is absolute, we just return it.\n  // - We try to avoid adding redundant slashes, especially for the case where the left operand\n  //   is \"/\".\n\n  if (b.startsWith(\"/\")) return kj::str(b);\n\n  if (a.endsWith(\"/\") || a.size() == 0 || b.size() == 0) {\n    return kj::str(a, b);\n  }\n\n  return kj::str(a, '/', b);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"fuse.h\"",
            "#include <stdlib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/serialize.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include \"union-fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nstatic kj::String joinPaths(kj::StringPtr a, kj::StringPtr b) {\n  // e.g. joinPaths(\"foo\", \"bar\") -> \"foo/bar\".\n  //\n  // Special rules:\n  // - An empty operand is equivalent to \".\", therefore we return the other operand.\n  // - If the right operand is absolute, we just return it.\n  // - We try to avoid adding redundant slashes, especially for the case where the left operand\n  //   is \"/\".\n\n  if (b.startsWith(\"/\")) return kj::str(b);\n\n  if (a.endsWith(\"/\") || a.size() == 0 || b.size() == 0) {\n    return kj::str(a, b);\n  }\n\n  return kj::str(a, '/', b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dir.getSourcePath",
          "args": [],
          "line": 747
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dir.getHidePaths",
          "args": [],
          "line": 737
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dir.getPackagePath",
          "args": [],
          "line": 731
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sourceMap.getSearchPath",
          "args": [],
          "line": 730
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nFileMapping mapFile(kj::StringPtr sourceDir, spk::SourceMap::Reader sourceMap, kj::StringPtr name) {\n  kj::Vector<kj::String> matches;\n  kj::Vector<kj::String> virtualChildren;\n\n  for (auto dir: sourceMap.getSearchPath()) {\n    auto virtualPath = dir.getPackagePath();\n    KJ_IF_MAYBE(subPath, tryRemovePathPrefix(name, virtualPath)) {\n      // If the path is some file or subdirectory inside the virtual path...\n      if (subPath->size() > 0) {\n        // ... then check to see if it's hidden.\n        bool hidden = false;\n        for (auto hide: dir.getHidePaths()) {\n          if (tryRemovePathPrefix(*subPath, hide) != nullptr) {\n            hidden = true;\n            break;\n          }\n        }\n        if (hidden) continue;\n      }\n\n      // Not hidden, so now check if this path exists.\n      auto sourcePath = dir.getSourcePath();\n      auto candidate = joinPaths(sourcePath, *subPath);\n\n      // Prepend `sourceDir` to relative paths.\n      candidate = joinPaths(sourceDir, candidate);\n\n      if (faccessat(AT_FDCWD, candidate.cStr(), F_OK, AT_SYMLINK_NOFOLLOW) == 0) {\n        // Found!\n\n        if (name.size() == 0) {\n          // This is a root mapping. In this case we follow symlinks eagerly.\n          struct stat stats;\n          KJ_SYSCALL(lstat(candidate.cStr(), &stats));\n          if (S_ISLNK(stats.st_mode)) {\n            char* real;\n            KJ_SYSCALL(real = realpath(candidate.cStr(), NULL));\n            KJ_DEFER(free(real));\n            candidate = kj::str(real);\n          }\n        }\n\n        matches.add(kj::mv(candidate));\n      }\n    } else {\n      // virtualPath is not a prefix of `name`, but is `name` a prefix of `virtualPath`?\n      KJ_IF_MAYBE(child, tryRemovePathPrefix(virtualPath, name)) {\n        // Yep.\n        KJ_IF_MAYBE(slashPos, child->findFirst('/')) {\n          virtualChildren.add(kj::heapString(child->slice(0, *slashPos)));\n        } else {\n          virtualChildren.add(kj::heapString(*child));\n        }\n      }\n    }\n  }\n\n  return FileMapping {\n    matches.releaseAsArray(),\n    virtualChildren.releaseAsArray()\n  };\n}"
  },
  {
    "function_name": "tryRemovePathPrefix",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "688-724",
    "snippet": "static kj::Maybe<kj::StringPtr> tryRemovePathPrefix(kj::StringPtr path, kj::StringPtr prefix) {\n  // If `prefix` names a parent directory of `path`, then return the remainder of `path` after\n  // removing said parent. Otherwise return null.\n  //\n  // Special rules:\n  // - It can't merely be a string prefix, because the prefix must be a whole node name. E.g.\n  //   \"foo\" is a prefix of \"foo/bar\" but not of \"foobar/baz\".\n  // - An empty `prefix` means \"current directory\" and so is always matched unless `path` is\n  //   absolute.\n  // - An exact match returns an empty string.\n\n  if (!path.startsWith(prefix)) {\n    return nullptr;\n  }\n\n  if (prefix.size() == 0) {\n    // Empty prefix = current dir.\n    if (path.startsWith(\"/\")) {\n      return nullptr;\n    } else {\n      return path;\n    }\n  }\n\n  if (path.size() == prefix.size()) {\n    // Exact match.\n    return kj::StringPtr(\"\");\n  }\n\n  if (path[prefix.size()] == '/') {\n    // Path prefix match. Strip off prefix and slash.\n    return path.slice(prefix.size() + 1);\n  } else {\n    // It's a string prefix match but not a path prefix match.\n    return nullptr;\n  }\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "path.slice",
          "args": [
            "prefix.size() + 1"
          ],
          "line": 719
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prefix.size",
          "args": [],
          "line": 719
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "StructyMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/util.h",
          "lines": "139-139",
          "snippet": "size_t size() { return pos - bytes; }",
          "includes": [
            "#include <set>",
            "#include <sandstorm/util.capnp.h>",
            "#include <capnp/rpc-twoparty.h>",
            "#include <kj/async.h>",
            "#include <kj/function.h>",
            "#include <unistd.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <kj/one-of.h>",
            "#include <kj/io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <set>\n#include <sandstorm/util.capnp.h>\n#include <capnp/rpc-twoparty.h>\n#include <kj/async.h>\n#include <kj/function.h>\n#include <unistd.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <kj/one-of.h>\n#include <kj/io.h>\n\nStructyMessage {\n  size_t size() { return pos - bytes; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::StringPtr",
          "args": [
            "\"\""
          ],
          "line": 714
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path.startsWith",
          "args": [
            "\"/\""
          ],
          "line": 705
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path.startsWith",
          "args": [
            "prefix"
          ],
          "line": 699
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nstatic kj::Maybe<kj::StringPtr> tryRemovePathPrefix(kj::StringPtr path, kj::StringPtr prefix) {\n  // If `prefix` names a parent directory of `path`, then return the remainder of `path` after\n  // removing said parent. Otherwise return null.\n  //\n  // Special rules:\n  // - It can't merely be a string prefix, because the prefix must be a whole node name. E.g.\n  //   \"foo\" is a prefix of \"foo/bar\" but not of \"foobar/baz\".\n  // - An empty `prefix` means \"current directory\" and so is always matched unless `path` is\n  //   absolute.\n  // - An exact match returns an empty string.\n\n  if (!path.startsWith(prefix)) {\n    return nullptr;\n  }\n\n  if (prefix.size() == 0) {\n    // Empty prefix = current dir.\n    if (path.startsWith(\"/\")) {\n      return nullptr;\n    } else {\n      return path;\n    }\n  }\n\n  if (path.size() == prefix.size()) {\n    // Exact match.\n    return kj::StringPtr(\"\");\n  }\n\n  if (path[prefix.size()] == '/') {\n    // Path prefix match. Strip off prefix and slash.\n    return path.slice(prefix.size() + 1);\n  } else {\n    // It's a string prefix match but not a path prefix match.\n    return nullptr;\n  }\n}"
  },
  {
    "function_name": "joinPaths",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "670-686",
    "snippet": "static kj::String joinPaths(kj::StringPtr a, kj::StringPtr b) {\n  // e.g. joinPaths(\"foo\", \"bar\") -> \"foo/bar\".\n  //\n  // Special rules:\n  // - An empty operand is equivalent to \".\", therefore we return the other operand.\n  // - If the right operand is absolute, we just return it.\n  // - We try to avoid adding redundant slashes, especially for the case where the left operand\n  //   is \"/\".\n\n  if (b.startsWith(\"/\")) return kj::str(b);\n\n  if (a.endsWith(\"/\") || a.size() == 0 || b.size() == 0) {\n    return kj::str(a, b);\n  }\n\n  return kj::str(a, '/', b);\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "a",
            "'/'",
            "b"
          ],
          "line": 685
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "a",
            "b"
          ],
          "line": 682
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "b.size",
          "args": [],
          "line": 681
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "StructyMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/util.h",
          "lines": "139-139",
          "snippet": "size_t size() { return pos - bytes; }",
          "includes": [
            "#include <set>",
            "#include <sandstorm/util.capnp.h>",
            "#include <capnp/rpc-twoparty.h>",
            "#include <kj/async.h>",
            "#include <kj/function.h>",
            "#include <unistd.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <kj/one-of.h>",
            "#include <kj/io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <set>\n#include <sandstorm/util.capnp.h>\n#include <capnp/rpc-twoparty.h>\n#include <kj/async.h>\n#include <kj/function.h>\n#include <unistd.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <kj/one-of.h>\n#include <kj/io.h>\n\nStructyMessage {\n  size_t size() { return pos - bytes; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "a.endsWith",
          "args": [
            "\"/\""
          ],
          "line": 681
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "b"
          ],
          "line": 679
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "b.startsWith",
          "args": [
            "\"/\""
          ],
          "line": 679
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nstatic kj::String joinPaths(kj::StringPtr a, kj::StringPtr b) {\n  // e.g. joinPaths(\"foo\", \"bar\") -> \"foo/bar\".\n  //\n  // Special rules:\n  // - An empty operand is equivalent to \".\", therefore we return the other operand.\n  // - If the right operand is absolute, we just return it.\n  // - We try to avoid adding redundant slashes, especially for the case where the left operand\n  //   is \"/\".\n\n  if (b.startsWith(\"/\")) return kj::str(b);\n\n  if (a.endsWith(\"/\") || a.size() == 0 || b.size() == 0) {\n    return kj::str(a, b);\n  }\n\n  return kj::str(a, '/', b);\n}"
  },
  {
    "function_name": "makeUnionFs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "586-668",
    "snippet": "kj::Own<fuse::Node> makeUnionFs(kj::StringPtr sourceDir, spk::SourceMap::Reader sourceMap,\n                               spk::Manifest::Reader manifest,\n                               spk::BridgeConfig::Reader bridgeConfig, kj::StringPtr bridgePath,\n                               kj::Function<void(kj::StringPtr)>& callback) {\n  auto searchPath = sourceMap.getSearchPath();\n  auto layers = kj::Vector<kj::Own<fuse::Node>>(searchPath.size() + 10);\n\n  {\n    capnp::MallocMessageBuilder manifestCopy(manifest.totalSize().wordCount + 4);\n    manifestCopy.setRoot(manifest);\n    layers.add(kj::refcounted<SingletonNode>(kj::refcounted<SimpleDataNode>(\n        capnp::messageToFlatArray(manifestCopy)), \"sandstorm-manifest\"));\n  }\n\n  {\n    capnp::MallocMessageBuilder bridgeConfigCopy(bridgeConfig.totalSize().wordCount + 4);\n    bridgeConfigCopy.setRoot(bridgeConfig);\n    layers.add(kj::refcounted<SingletonNode>(kj::refcounted<SimpleDataNode>(\n        capnp::messageToFlatArray(bridgeConfigCopy)), \"sandstorm-http-bridge-config\"));\n  }\n\n  layers.add(kj::refcounted<SingletonNode>(\n      newLoopbackFuseNode(bridgePath, kj::maxValue), \"sandstorm-http-bridge\"));\n\n  layers.add(kj::refcounted<SingletonNode>(kj::heap<EmptyNode>(), \"dev\"));\n  layers.add(kj::refcounted<SingletonNode>(kj::heap<EmptyNode>(), \"tmp\"));\n  layers.add(kj::refcounted<SingletonNode>(kj::heap<EmptyNode>(), \"var\"));\n\n  // Empty /proc/cpuinfo will be overmounted by the supervisor.\n  layers.add(kj::refcounted<SingletonNode>(kj::refcounted<SimpleDataNode>(nullptr), \"proc/cpuinfo\"));\n\n  for (auto mapping: searchPath) {\n    kj::StringPtr sourcePath = mapping.getSourcePath();\n    kj::String ownSourcePath;\n    kj::StringPtr packagePath = mapping.getPackagePath();\n\n    // Interpret relative paths against the source dir (if it's not the current directory).\n    if (sourceDir.size() != 0 && !sourcePath.startsWith(\"/\")) {\n      ownSourcePath = kj::str(sourceDir, '/', sourcePath);\n      sourcePath = ownSourcePath;\n    }\n\n    // If this is a symlink mapped to virtual root, follow it, because it makes no sense for\n    // root to be a symlink.\n    if (packagePath.size() == 0) {\n      struct stat stats;\n      KJ_SYSCALL(lstat(sourcePath.cStr(), &stats), sourcePath);\n      if (S_ISLNK(stats.st_mode)) {\n        char* real;\n        KJ_SYSCALL(real = realpath(sourcePath.cStr(), NULL));\n        KJ_DEFER(free(real));\n        ownSourcePath = kj::str(real);\n        sourcePath = ownSourcePath;\n      }\n    }\n\n    // Create the filesystem node.\n    // We set a low TTL here, but note that the spk tool overrides it anyway.\n    kj::Own<fuse::Node> node = newLoopbackFuseNode(sourcePath, 1 * kj::SECONDS);\n\n    // If any contents are hidden, wrap in a hiding node.\n    auto hides = mapping.getHidePaths();\n    if (hides.size() > 0) {\n      std::set<kj::StringPtr> hideSet;\n      for (auto hide: hides) {\n        hideSet.insert(hide);\n      }\n      node = kj::refcounted<HidingNode>(kj::mv(node), kj::mv(hideSet));\n    }\n\n    // If the contents are mapped to a non-root location, wrap in a singleton node.\n    KJ_ASSERT(!packagePath.startsWith(\"/\"),\n              \"`packagePath` in source map should not start with '/'.\");\n    if (packagePath.size() > 0) {\n      node = kj::refcounted<SingletonNode>(kj::mv(node), packagePath);\n    }\n\n    layers.add(kj::mv(node));\n  }\n\n  auto merged = kj::refcounted<UnionNode>(layers.releaseAsArray());\n  return kj::refcounted<TrackingNode>(kj::mv(merged), nullptr, callback);\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::refcounted<TrackingNode>",
          "args": [
            "kj::mv(merged)",
            "nullptr",
            "callback"
          ],
          "line": 667
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "merged"
          ],
          "line": 667
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::refcounted<UnionNode>",
          "args": [
            "layers.releaseAsArray()"
          ],
          "line": 666
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "layers.releaseAsArray",
          "args": [],
          "line": 666
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "layers.add",
          "args": [
            "kj::mv(node)"
          ],
          "line": 663
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "node"
          ],
          "line": 663
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::refcounted<SingletonNode>",
          "args": [
            "kj::mv(node)",
            "packagePath"
          ],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "node"
          ],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "packagePath.size",
          "args": [],
          "line": 659
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "StructyMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/util.h",
          "lines": "139-139",
          "snippet": "size_t size() { return pos - bytes; }",
          "includes": [
            "#include <set>",
            "#include <sandstorm/util.capnp.h>",
            "#include <capnp/rpc-twoparty.h>",
            "#include <kj/async.h>",
            "#include <kj/function.h>",
            "#include <unistd.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <kj/one-of.h>",
            "#include <kj/io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <set>\n#include <sandstorm/util.capnp.h>\n#include <capnp/rpc-twoparty.h>\n#include <kj/async.h>\n#include <kj/function.h>\n#include <unistd.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <kj/one-of.h>\n#include <kj/io.h>\n\nStructyMessage {\n  size_t size() { return pos - bytes; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "KJ_ASSERT",
          "args": [
            "!packagePath.startsWith(\"/\")",
            "\"`packagePath` in source map should not start with '/'.\""
          ],
          "line": 657
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "packagePath.startsWith",
          "args": [
            "\"/\""
          ],
          "line": 657
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::refcounted<HidingNode>",
          "args": [
            "kj::mv(node)",
            "kj::mv(hideSet)"
          ],
          "line": 653
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "hideSet"
          ],
          "line": 653
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "node"
          ],
          "line": 653
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hideSet.insert",
          "args": [
            "hide"
          ],
          "line": 651
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mapping.getHidePaths",
          "args": [],
          "line": 647
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "newLoopbackFuseNode",
          "args": [
            "sourcePath",
            "1 * kj::SECONDS"
          ],
          "line": 644
        },
        "resolved": true,
        "details": {
          "function_name": "newLoopbackFuseNode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/fuse.c++",
          "lines": "1061-1063",
          "snippet": "kj::Own<fuse::Node> newLoopbackFuseNode(kj::StringPtr path, kj::Duration cacheTtl) {\n  return kj::refcounted<NodeImpl>(path, cacheTtl);\n}",
          "includes": [
            "#include <sys/socket.h>",
            "#include <time.h>",
            "#include <sys/wait.h>",
            "#include <stdlib.h>",
            "#include <kj/time.h>",
            "#include <kj/io.h>",
            "#include <sys/uio.h>",
            "#include <kj/async-unix.h>",
            "#include <unistd.h>",
            "#include <dirent.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <unordered_map>",
            "#include <kj/one-of.h>",
            "#include <kj/debug.h>",
            "#include <linux/fuse.h>",
            "#include \"util.h\"",
            "#include \"send-fd.h\"",
            "#include \"fuse.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/socket.h>\n#include <time.h>\n#include <sys/wait.h>\n#include <stdlib.h>\n#include <kj/time.h>\n#include <kj/io.h>\n#include <sys/uio.h>\n#include <kj/async-unix.h>\n#include <unistd.h>\n#include <dirent.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <unordered_map>\n#include <kj/one-of.h>\n#include <kj/debug.h>\n#include <linux/fuse.h>\n#include \"util.h\"\n#include \"send-fd.h\"\n#include \"fuse.h\"\n\nkj::Own<fuse::Node> newLoopbackFuseNode(kj::StringPtr path, kj::Duration cacheTtl) {\n  return kj::refcounted<NodeImpl>(path, cacheTtl);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "real"
          ],
          "line": 637
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_DEFER",
          "args": [
            "free(real)"
          ],
          "line": 636
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "real"
          ],
          "line": 636
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_SYSCALL",
          "args": [
            "real = realpath(sourcePath.cStr(), NULL)"
          ],
          "line": 635
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "realpath",
          "args": [
            "sourcePath.cStr()",
            "NULL"
          ],
          "line": 635
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sourcePath.cStr",
          "args": [],
          "line": 635
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISLNK",
          "args": [
            "stats.st_mode"
          ],
          "line": 633
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_SYSCALL",
          "args": [
            "lstat(sourcePath.cStr(), &stats)",
            "sourcePath"
          ],
          "line": 632
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lstat",
          "args": [
            "sourcePath.cStr()",
            "&stats"
          ],
          "line": 632
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sourcePath.cStr",
          "args": [],
          "line": 632
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "sourceDir",
            "'/'",
            "sourcePath"
          ],
          "line": 624
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sourcePath.startsWith",
          "args": [
            "\"/\""
          ],
          "line": 623
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mapping.getPackagePath",
          "args": [],
          "line": 620
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mapping.getSourcePath",
          "args": [],
          "line": 618
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "layers.add",
          "args": [
            "kj::refcounted<SingletonNode>(kj::refcounted<SimpleDataNode>(nullptr), \"proc/cpuinfo\")"
          ],
          "line": 615
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::refcounted<SingletonNode>",
          "args": [
            "kj::refcounted<SimpleDataNode>(nullptr)",
            "\"proc/cpuinfo\""
          ],
          "line": 615
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::refcounted<SimpleDataNode>",
          "args": [
            "nullptr"
          ],
          "line": 615
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "layers.add",
          "args": [
            "kj::refcounted<SingletonNode>(kj::heap<EmptyNode>(), \"var\")"
          ],
          "line": 612
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::refcounted<SingletonNode>",
          "args": [
            "kj::heap<EmptyNode>()",
            "\"var\""
          ],
          "line": 612
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::heap<EmptyNode>",
          "args": [],
          "line": 612
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "layers.add",
          "args": [
            "kj::refcounted<SingletonNode>(kj::heap<EmptyNode>(), \"tmp\")"
          ],
          "line": 611
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::refcounted<SingletonNode>",
          "args": [
            "kj::heap<EmptyNode>()",
            "\"tmp\""
          ],
          "line": 611
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::heap<EmptyNode>",
          "args": [],
          "line": 611
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "layers.add",
          "args": [
            "kj::refcounted<SingletonNode>(kj::heap<EmptyNode>(), \"dev\")"
          ],
          "line": 610
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::refcounted<SingletonNode>",
          "args": [
            "kj::heap<EmptyNode>()",
            "\"dev\""
          ],
          "line": 610
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::heap<EmptyNode>",
          "args": [],
          "line": 610
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "layers.add",
          "args": [
            "kj::refcounted<SingletonNode>(\n      newLoopbackFuseNode(bridgePath, kj::maxValue), \"sandstorm-http-bridge\")"
          ],
          "line": 607
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::refcounted<SingletonNode>",
          "args": [
            "newLoopbackFuseNode(bridgePath, kj::maxValue)",
            "\"sandstorm-http-bridge\""
          ],
          "line": 607
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "layers.add",
          "args": [
            "kj::refcounted<SingletonNode>(kj::refcounted<SimpleDataNode>(\n        capnp::messageToFlatArray(bridgeConfigCopy)), \"sandstorm-http-bridge-config\")"
          ],
          "line": 603
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::refcounted<SingletonNode>",
          "args": [
            "kj::refcounted<SimpleDataNode>(\n        capnp::messageToFlatArray(bridgeConfigCopy))",
            "\"sandstorm-http-bridge-config\""
          ],
          "line": 603
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::refcounted<SimpleDataNode>",
          "args": [
            "capnp::messageToFlatArray(bridgeConfigCopy)"
          ],
          "line": 603
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capnp::messageToFlatArray",
          "args": [
            "bridgeConfigCopy"
          ],
          "line": 604
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bridgeConfigCopy.setRoot",
          "args": [
            "bridgeConfig"
          ],
          "line": 602
        },
        "resolved": true,
        "details": {
          "function_name": "setRoot",
          "container": "BackupMain",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/backup.c++",
          "lines": "66-69",
          "snippet": "bool BackupMain::setRoot(kj::StringPtr arg) {\n  root = arg;\n  return true;\n}",
          "includes": [
            "#include <sys/capability.h>",
            "#include <sys/prctl.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <sys/syscall.h>",
            "#include <sys/mount.h>",
            "#include <sched.h>",
            "#include <kj/debug.h>",
            "#include \"version.h\"",
            "#include \"util.h\"",
            "#include \"backup.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/capability.h>\n#include <sys/prctl.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <sys/syscall.h>\n#include <sys/mount.h>\n#include <sched.h>\n#include <kj/debug.h>\n#include \"version.h\"\n#include \"util.h\"\n#include \"backup.h\"\n\nBackupMain {\n  bool BackupMain::setRoot(kj::StringPtr arg) {\n    root = arg;\n    return true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "bridgeConfig.totalSize",
          "args": [],
          "line": 601
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "layers.add",
          "args": [
            "kj::refcounted<SingletonNode>(kj::refcounted<SimpleDataNode>(\n        capnp::messageToFlatArray(manifestCopy)), \"sandstorm-manifest\")"
          ],
          "line": 596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::refcounted<SingletonNode>",
          "args": [
            "kj::refcounted<SimpleDataNode>(\n        capnp::messageToFlatArray(manifestCopy))",
            "\"sandstorm-manifest\""
          ],
          "line": 596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::refcounted<SimpleDataNode>",
          "args": [
            "capnp::messageToFlatArray(manifestCopy)"
          ],
          "line": 596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capnp::messageToFlatArray",
          "args": [
            "manifestCopy"
          ],
          "line": 597
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "manifest.totalSize",
          "args": [],
          "line": 594
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::Vector<kj::Own<fuse::Node>>",
          "args": [
            "searchPath.size() + 10"
          ],
          "line": 591
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sourceMap.getSearchPath",
          "args": [],
          "line": 590
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nkj::Own<fuse::Node> makeUnionFs(kj::StringPtr sourceDir, spk::SourceMap::Reader sourceMap,\n                               spk::Manifest::Reader manifest,\n                               spk::BridgeConfig::Reader bridgeConfig, kj::StringPtr bridgePath,\n                               kj::Function<void(kj::StringPtr)>& callback) {\n  auto searchPath = sourceMap.getSearchPath();\n  auto layers = kj::Vector<kj::Own<fuse::Node>>(searchPath.size() + 10);\n\n  {\n    capnp::MallocMessageBuilder manifestCopy(manifest.totalSize().wordCount + 4);\n    manifestCopy.setRoot(manifest);\n    layers.add(kj::refcounted<SingletonNode>(kj::refcounted<SimpleDataNode>(\n        capnp::messageToFlatArray(manifestCopy)), \"sandstorm-manifest\"));\n  }\n\n  {\n    capnp::MallocMessageBuilder bridgeConfigCopy(bridgeConfig.totalSize().wordCount + 4);\n    bridgeConfigCopy.setRoot(bridgeConfig);\n    layers.add(kj::refcounted<SingletonNode>(kj::refcounted<SimpleDataNode>(\n        capnp::messageToFlatArray(bridgeConfigCopy)), \"sandstorm-http-bridge-config\"));\n  }\n\n  layers.add(kj::refcounted<SingletonNode>(\n      newLoopbackFuseNode(bridgePath, kj::maxValue), \"sandstorm-http-bridge\"));\n\n  layers.add(kj::refcounted<SingletonNode>(kj::heap<EmptyNode>(), \"dev\"));\n  layers.add(kj::refcounted<SingletonNode>(kj::heap<EmptyNode>(), \"tmp\"));\n  layers.add(kj::refcounted<SingletonNode>(kj::heap<EmptyNode>(), \"var\"));\n\n  // Empty /proc/cpuinfo will be overmounted by the supervisor.\n  layers.add(kj::refcounted<SingletonNode>(kj::refcounted<SimpleDataNode>(nullptr), \"proc/cpuinfo\"));\n\n  for (auto mapping: searchPath) {\n    kj::StringPtr sourcePath = mapping.getSourcePath();\n    kj::String ownSourcePath;\n    kj::StringPtr packagePath = mapping.getPackagePath();\n\n    // Interpret relative paths against the source dir (if it's not the current directory).\n    if (sourceDir.size() != 0 && !sourcePath.startsWith(\"/\")) {\n      ownSourcePath = kj::str(sourceDir, '/', sourcePath);\n      sourcePath = ownSourcePath;\n    }\n\n    // If this is a symlink mapped to virtual root, follow it, because it makes no sense for\n    // root to be a symlink.\n    if (packagePath.size() == 0) {\n      struct stat stats;\n      KJ_SYSCALL(lstat(sourcePath.cStr(), &stats), sourcePath);\n      if (S_ISLNK(stats.st_mode)) {\n        char* real;\n        KJ_SYSCALL(real = realpath(sourcePath.cStr(), NULL));\n        KJ_DEFER(free(real));\n        ownSourcePath = kj::str(real);\n        sourcePath = ownSourcePath;\n      }\n    }\n\n    // Create the filesystem node.\n    // We set a low TTL here, but note that the spk tool overrides it anyway.\n    kj::Own<fuse::Node> node = newLoopbackFuseNode(sourcePath, 1 * kj::SECONDS);\n\n    // If any contents are hidden, wrap in a hiding node.\n    auto hides = mapping.getHidePaths();\n    if (hides.size() > 0) {\n      std::set<kj::StringPtr> hideSet;\n      for (auto hide: hides) {\n        hideSet.insert(hide);\n      }\n      node = kj::refcounted<HidingNode>(kj::mv(node), kj::mv(hideSet));\n    }\n\n    // If the contents are mapped to a non-root location, wrap in a singleton node.\n    KJ_ASSERT(!packagePath.startsWith(\"/\"),\n              \"`packagePath` in source map should not start with '/'.\");\n    if (packagePath.size() > 0) {\n      node = kj::refcounted<SingletonNode>(kj::mv(node), packagePath);\n    }\n\n    layers.add(kj::mv(node));\n  }\n\n  auto merged = kj::refcounted<UnionNode>(layers.releaseAsArray());\n  return kj::refcounted<TrackingNode>(kj::mv(merged), nullptr, callback);\n}"
  },
  {
    "function_name": "readlink",
    "container": "SimpleDataNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "576-578",
    "snippet": "kj::String readlink() override {\n    KJ_FAIL_REQUIRE(\"not a symlink\");\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "KJ_FAIL_REQUIRE",
          "args": [
            "\"not a symlink\""
          ],
          "line": 577
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nSimpleDataNode {\n  kj::String readlink() override {\n      KJ_FAIL_REQUIRE(\"not a symlink\");\n    }\n}"
  },
  {
    "function_name": "openAsDirectory",
    "container": "SimpleDataNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "572-574",
    "snippet": "kj::Maybe<kj::Own<fuse::Directory>> openAsDirectory() override {\n    return nullptr;\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nSimpleDataNode {\n  kj::Maybe<kj::Own<fuse::Directory>> openAsDirectory() override {\n      return nullptr;\n    }\n}"
  },
  {
    "function_name": "openAsFile",
    "container": "SimpleDataNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "567-570",
    "snippet": "kj::Maybe<kj::Own<fuse::File>> openAsFile() override {\n    kj::Own<fuse::File> result = kj::refcounted<SimpleDataFile>(data);\n    return kj::mv(result);\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "result"
          ],
          "line": 569
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::refcounted<SimpleDataFile>",
          "args": [
            "data"
          ],
          "line": 568
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nSimpleDataNode {\n  kj::Maybe<kj::Own<fuse::File>> openAsFile() override {\n      kj::Own<fuse::File> result = kj::refcounted<SimpleDataFile>(data);\n      return kj::mv(result);\n    }\n}"
  },
  {
    "function_name": "getAttributes",
    "container": "SimpleDataNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "554-565",
    "snippet": "GetAttributesResults getAttributes() override {\n    auto result = GetAttributesResults {};\n    result.ttl = kj::maxValue;\n    auto& attr = result.attributes;\n    attr.inodeNumber = 0;\n    attr.type = fuse::Node::Type::REGULAR;\n    attr.permissions = 0444;\n    attr.linkCount = 1;\n    attr.size = data.size() * sizeof(capnp::word);\n\n    return result;\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "data.size",
          "args": [],
          "line": 562
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "StructyMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/util.h",
          "lines": "139-139",
          "snippet": "size_t size() { return pos - bytes; }",
          "includes": [
            "#include <set>",
            "#include <sandstorm/util.capnp.h>",
            "#include <capnp/rpc-twoparty.h>",
            "#include <kj/async.h>",
            "#include <kj/function.h>",
            "#include <unistd.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <kj/one-of.h>",
            "#include <kj/io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <set>\n#include <sandstorm/util.capnp.h>\n#include <capnp/rpc-twoparty.h>\n#include <kj/async.h>\n#include <kj/function.h>\n#include <unistd.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <kj/one-of.h>\n#include <kj/io.h>\n\nStructyMessage {\n  size_t size() { return pos - bytes; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nSimpleDataNode {\n  GetAttributesResults getAttributes() override {\n      auto result = GetAttributesResults {};\n      result.ttl = kj::maxValue;\n      auto& attr = result.attributes;\n      attr.inodeNumber = 0;\n      attr.type = fuse::Node::Type::REGULAR;\n      attr.permissions = 0444;\n      attr.linkCount = 1;\n      attr.size = data.size() * sizeof(capnp::word);\n  \n      return result;\n    }\n}"
  },
  {
    "function_name": "lookup",
    "container": "SimpleDataNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "550-552",
    "snippet": "kj::Maybe<LookupResults> lookup(kj::StringPtr name) override {\n    return nullptr;\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nSimpleDataNode {\n  kj::Maybe<LookupResults> lookup(kj::StringPtr name) override {\n      return nullptr;\n    }\n}"
  },
  {
    "function_name": "addRef",
    "container": "SimpleDataNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "545-547",
    "snippet": "kj::Own<fuse::Node> addRef() override {\n    return kj::addRef(*this);\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::addRef",
          "args": [
            "*this"
          ],
          "line": 546
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nSimpleDataNode {\n  kj::Own<fuse::Node> addRef() override {\n      return kj::addRef(*this);\n    }\n}"
  },
  {
    "function_name": "SimpleDataNode",
    "container": "SimpleDataNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "543-543",
    "snippet": "SimpleDataNode(kj::Array<capnp::word> data): data(kj::mv(data)) {}",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "data"
          ],
          "line": 543
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nSimpleDataNode {\n  SimpleDataNode(kj::Array<capnp::word> data): data(kj::mv(data)) {}\n}"
  },
  {
    "function_name": "read",
    "container": "SimpleDataFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "529-533",
    "snippet": "kj::Array<uint8_t> read(uint64_t offset0, uint32_t size0) override {\n    auto offset = kj::min(data.size(), offset0);\n    auto size = kj::min(data.size() - offset, size0);\n    return kj::heapArray(data.slice(offset, offset + size));\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::heapArray",
          "args": [
            "data.slice(offset, offset + size)"
          ],
          "line": 532
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "data.slice",
          "args": [
            "offset",
            "offset + size"
          ],
          "line": 532
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::min",
          "args": [
            "data.size() - offset",
            "size0"
          ],
          "line": 531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "data.size",
          "args": [],
          "line": 531
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "StructyMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/util.h",
          "lines": "139-139",
          "snippet": "size_t size() { return pos - bytes; }",
          "includes": [
            "#include <set>",
            "#include <sandstorm/util.capnp.h>",
            "#include <capnp/rpc-twoparty.h>",
            "#include <kj/async.h>",
            "#include <kj/function.h>",
            "#include <unistd.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <kj/one-of.h>",
            "#include <kj/io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <set>\n#include <sandstorm/util.capnp.h>\n#include <capnp/rpc-twoparty.h>\n#include <kj/async.h>\n#include <kj/function.h>\n#include <unistd.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <kj/one-of.h>\n#include <kj/io.h>\n\nStructyMessage {\n  size_t size() { return pos - bytes; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::min",
          "args": [
            "data.size()",
            "offset0"
          ],
          "line": 530
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nSimpleDataFile {\n  kj::Array<uint8_t> read(uint64_t offset0, uint32_t size0) override {\n      auto offset = kj::min(data.size(), offset0);\n      auto size = kj::min(data.size() - offset, size0);\n      return kj::heapArray(data.slice(offset, offset + size));\n    }\n}"
  },
  {
    "function_name": "addRef",
    "container": "SimpleDataFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "524-526",
    "snippet": "kj::Own<fuse::File> addRef() override {\n    return kj::addRef(*this);\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::addRef",
          "args": [
            "*this"
          ],
          "line": 525
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nSimpleDataFile {\n  kj::Own<fuse::File> addRef() override {\n      return kj::addRef(*this);\n    }\n}"
  },
  {
    "function_name": "SimpleDataFile",
    "container": "SimpleDataFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "520-522",
    "snippet": "SimpleDataFile(kj::ArrayPtr<const capnp::word> data)\n      : data(kj::arrayPtr(reinterpret_cast<const kj::byte*>(data.begin()),\n                          data.size() * sizeof(capnp::word))) {}",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::arrayPtr",
          "args": [
            "reinterpret_cast<const kj::byte*>(data.begin())",
            "data.size() * sizeof(capnp::word)"
          ],
          "line": 521
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "data.size",
          "args": [],
          "line": 522
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "StructyMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/util.h",
          "lines": "139-139",
          "snippet": "size_t size() { return pos - bytes; }",
          "includes": [
            "#include <set>",
            "#include <sandstorm/util.capnp.h>",
            "#include <capnp/rpc-twoparty.h>",
            "#include <kj/async.h>",
            "#include <kj/function.h>",
            "#include <unistd.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <kj/one-of.h>",
            "#include <kj/io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <set>\n#include <sandstorm/util.capnp.h>\n#include <capnp/rpc-twoparty.h>\n#include <kj/async.h>\n#include <kj/function.h>\n#include <unistd.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <kj/one-of.h>\n#include <kj/io.h>\n\nStructyMessage {\n  size_t size() { return pos - bytes; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<const kj::byte*>",
          "args": [
            "data.begin()"
          ],
          "line": 521
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "data.begin",
          "args": [],
          "line": 521
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nSimpleDataFile {\n  SimpleDataFile(kj::ArrayPtr<const capnp::word> data)\n        : data(kj::arrayPtr(reinterpret_cast<const kj::byte*>(data.begin()),\n                            data.size() * sizeof(capnp::word))) {}\n}"
  },
  {
    "function_name": "readlink",
    "container": "EmptyNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "513-515",
    "snippet": "kj::String readlink() override {\n    KJ_FAIL_REQUIRE(\"not a symlink\");\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "KJ_FAIL_REQUIRE",
          "args": [
            "\"not a symlink\""
          ],
          "line": 514
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nEmptyNode {\n  kj::String readlink() override {\n      KJ_FAIL_REQUIRE(\"not a symlink\");\n    }\n}"
  },
  {
    "function_name": "openAsDirectory",
    "container": "EmptyNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "508-511",
    "snippet": "kj::Maybe<kj::Own<fuse::Directory>> openAsDirectory() override {\n    kj::Own<fuse::Directory> result = kj::refcounted<EmptyDirectory>();\n    return kj::mv(result);\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "result"
          ],
          "line": 510
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::refcounted<EmptyDirectory>",
          "args": [],
          "line": 509
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nEmptyNode {\n  kj::Maybe<kj::Own<fuse::Directory>> openAsDirectory() override {\n      kj::Own<fuse::Directory> result = kj::refcounted<EmptyDirectory>();\n      return kj::mv(result);\n    }\n}"
  },
  {
    "function_name": "openAsFile",
    "container": "EmptyNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "504-506",
    "snippet": "kj::Maybe<kj::Own<fuse::File>> openAsFile() override {\n    return nullptr;\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nEmptyNode {\n  kj::Maybe<kj::Own<fuse::File>> openAsFile() override {\n      return nullptr;\n    }\n}"
  },
  {
    "function_name": "getAttributes",
    "container": "EmptyNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "491-502",
    "snippet": "GetAttributesResults getAttributes() override {\n    auto results = GetAttributesResults {};\n    results.ttl = kj::maxValue;\n    auto& attr = results.attributes;\n\n    attr.inodeNumber = 0;\n    attr.type = fuse::Node::Type::DIRECTORY;\n    attr.permissions = 0555;\n    attr.linkCount = 1;\n\n    return results;\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nEmptyNode {\n  GetAttributesResults getAttributes() override {\n      auto results = GetAttributesResults {};\n      results.ttl = kj::maxValue;\n      auto& attr = results.attributes;\n  \n      attr.inodeNumber = 0;\n      attr.type = fuse::Node::Type::DIRECTORY;\n      attr.permissions = 0555;\n      attr.linkCount = 1;\n  \n      return results;\n    }\n}"
  },
  {
    "function_name": "lookup",
    "container": "EmptyNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "487-489",
    "snippet": "kj::Maybe<LookupResults> lookup(kj::StringPtr name) override {\n    return nullptr;\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nEmptyNode {\n  kj::Maybe<LookupResults> lookup(kj::StringPtr name) override {\n      return nullptr;\n    }\n}"
  },
  {
    "function_name": "addRef",
    "container": "EmptyNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "482-484",
    "snippet": "kj::Own<fuse::Node> addRef() override {\n    return kj::heap<EmptyNode>();\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::heap<EmptyNode>",
          "args": [],
          "line": 483
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nEmptyNode {\n  kj::Own<fuse::Node> addRef() override {\n      return kj::heap<EmptyNode>();\n    }\n}"
  },
  {
    "function_name": "simpleRead",
    "container": "EmptyDirectory",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "463-472",
    "snippet": "kj::Array<SimpleEntry> simpleRead() override {\n    auto result = kj::heapArray<SimpleEntry>(2);\n\n    result[0].name = kj::str(\".\");\n    result[0].type = fuse::Node::Type::DIRECTORY;\n    result[1].name = kj::str(\"..\");\n    result[1].type = fuse::Node::Type::DIRECTORY;\n\n    return kj::mv(result);\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "result"
          ],
          "line": 471
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "\"..\""
          ],
          "line": 468
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "\".\""
          ],
          "line": 466
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::heapArray<SimpleEntry>",
          "args": [
            "2"
          ],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nEmptyDirectory {\n  kj::Array<SimpleEntry> simpleRead() override {\n      auto result = kj::heapArray<SimpleEntry>(2);\n  \n      result[0].name = kj::str(\".\");\n      result[0].type = fuse::Node::Type::DIRECTORY;\n      result[1].name = kj::str(\"..\");\n      result[1].type = fuse::Node::Type::DIRECTORY;\n  \n      return kj::mv(result);\n    }\n}"
  },
  {
    "function_name": "readlink",
    "container": "SingletonNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "450-452",
    "snippet": "kj::String readlink() override {\n    KJ_FAIL_REQUIRE(\"not a symlink\");\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "KJ_FAIL_REQUIRE",
          "args": [
            "\"not a symlink\""
          ],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nSingletonNode {\n  kj::String readlink() override {\n      KJ_FAIL_REQUIRE(\"not a symlink\");\n    }\n}"
  },
  {
    "function_name": "openAsDirectory",
    "container": "SingletonNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "445-448",
    "snippet": "kj::Maybe<kj::Own<fuse::Directory>> openAsDirectory() override {\n    kj::Own<fuse::Directory> result = kj::refcounted<SingletonDirectory>(path);\n    return kj::mv(result);\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "result"
          ],
          "line": 447
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::refcounted<SingletonDirectory>",
          "args": [
            "path"
          ],
          "line": 446
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nSingletonNode {\n  kj::Maybe<kj::Own<fuse::Directory>> openAsDirectory() override {\n      kj::Own<fuse::Directory> result = kj::refcounted<SingletonDirectory>(path);\n      return kj::mv(result);\n    }\n}"
  },
  {
    "function_name": "openAsFile",
    "container": "SingletonNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "441-443",
    "snippet": "kj::Maybe<kj::Own<fuse::File>> openAsFile() override {\n    return nullptr;\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nSingletonNode {\n  kj::Maybe<kj::Own<fuse::File>> openAsFile() override {\n      return nullptr;\n    }\n}"
  },
  {
    "function_name": "getAttributes",
    "container": "SingletonNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "427-439",
    "snippet": "GetAttributesResults getAttributes() override {\n\n    auto result = GetAttributesResults {};\n    result.ttl = kj::maxValue;\n    auto& attr = result.attributes;\n\n    attr.inodeNumber = 0;\n    attr.type = fuse::Node::Type::DIRECTORY;\n    attr.permissions = 0555;\n    attr.linkCount = 1;\n\n    return result;\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nSingletonNode {\n  GetAttributesResults getAttributes() override {\n  \n      auto result = GetAttributesResults {};\n      result.ttl = kj::maxValue;\n      auto& attr = result.attributes;\n  \n      attr.inodeNumber = 0;\n      attr.type = fuse::Node::Type::DIRECTORY;\n      attr.permissions = 0555;\n      attr.linkCount = 1;\n  \n      return result;\n    }\n}"
  },
  {
    "function_name": "lookup",
    "container": "SingletonNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "412-425",
    "snippet": "kj::Maybe<LookupResults> lookup(kj::StringPtr name) override {\n    if (path.startsWith(name)) {\n      auto sub = path.slice(name.size());\n      if (sub.size() == 0) {\n        // This is the exact path.\n        return LookupResults { member->addRef(), kj::maxValue };\n      } else if (sub.startsWith(\"/\")) {\n        sub = sub.slice(1);\n        return LookupResults { kj::refcounted<SingletonNode>(member->addRef(), sub), kj::maxValue };\n      }\n    }\n\n    return nullptr;\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::refcounted<SingletonNode>",
          "args": [
            "member->addRef()",
            "sub"
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "member->addRef",
          "args": [],
          "line": 420
        },
        "resolved": true,
        "details": {
          "function_name": "addRef",
          "container": "SimpleDataNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
          "lines": "545-547",
          "snippet": "kj::Own<fuse::Node> addRef() override {\n    return kj::addRef(*this);\n  }",
          "includes": [
            "#include \"util.h\"",
            "#include \"fuse.h\"",
            "#include <stdlib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/serialize.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include \"union-fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nSimpleDataNode {\n  kj::Own<fuse::Node> addRef() override {\n      return kj::addRef(*this);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "sub.slice",
          "args": [
            "1"
          ],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sub.startsWith",
          "args": [
            "\"/\""
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sub.size",
          "args": [],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "StructyMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/util.h",
          "lines": "139-139",
          "snippet": "size_t size() { return pos - bytes; }",
          "includes": [
            "#include <set>",
            "#include <sandstorm/util.capnp.h>",
            "#include <capnp/rpc-twoparty.h>",
            "#include <kj/async.h>",
            "#include <kj/function.h>",
            "#include <unistd.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <kj/one-of.h>",
            "#include <kj/io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <set>\n#include <sandstorm/util.capnp.h>\n#include <capnp/rpc-twoparty.h>\n#include <kj/async.h>\n#include <kj/function.h>\n#include <unistd.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <kj/one-of.h>\n#include <kj/io.h>\n\nStructyMessage {\n  size_t size() { return pos - bytes; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "path.slice",
          "args": [
            "name.size()"
          ],
          "line": 414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path.startsWith",
          "args": [
            "name"
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nSingletonNode {\n  kj::Maybe<LookupResults> lookup(kj::StringPtr name) override {\n      if (path.startsWith(name)) {\n        auto sub = path.slice(name.size());\n        if (sub.size() == 0) {\n          // This is the exact path.\n          return LookupResults { member->addRef(), kj::maxValue };\n        } else if (sub.startsWith(\"/\")) {\n          sub = sub.slice(1);\n          return LookupResults { kj::refcounted<SingletonNode>(member->addRef(), sub), kj::maxValue };\n        }\n      }\n  \n      return nullptr;\n    }\n}"
  },
  {
    "function_name": "addRef",
    "container": "SingletonNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "407-409",
    "snippet": "kj::Own<fuse::Node> addRef() override {\n    return kj::addRef(*this);\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::addRef",
          "args": [
            "*this"
          ],
          "line": 408
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nSingletonNode {\n  kj::Own<fuse::Node> addRef() override {\n      return kj::addRef(*this);\n    }\n}"
  },
  {
    "function_name": "SingletonNode",
    "container": "SingletonNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "404-405",
    "snippet": "SingletonNode(kj::Own<fuse::Node> member, kj::StringPtr path)\n      : member(kj::mv(member)), path(path) {}",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "member"
          ],
          "line": 405
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nSingletonNode {\n  SingletonNode(kj::Own<fuse::Node> member, kj::StringPtr path)\n        : member(kj::mv(member)), path(path) {}\n}"
  },
  {
    "function_name": "simpleRead",
    "container": "SingletonDirectory",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "378-390",
    "snippet": "kj::Array<SimpleEntry> simpleRead() override {\n    auto result = kj::heapArray<SimpleEntry>(3);\n\n    result[0].name = kj::str(\".\");\n    result[0].type = fuse::Node::Type::DIRECTORY;\n    result[1].name = kj::str(\"..\");\n    result[1].type = fuse::Node::Type::DIRECTORY;\n\n    KJ_IF_MAYBE(slashPos, path.findFirst('/')) {\n      result[2].name = kj::heapString(path.slice(0, *slashPos));\n    } else {\n      result[2].name = kj::heapString(path);\n    }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::heapString",
          "args": [
            "path"
          ],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::heapString",
          "args": [
            "path.slice(0, *slashPos)"
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path.slice",
          "args": [
            "0",
            "*slashPos"
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_IF_MAYBE",
          "args": [
            "slashPos",
            "path.findFirst('/')"
          ],
          "line": 386
        },
        "resolved": true,
        "details": {
          "function_name": "KJ_IF_MAYBE",
          "container": "BridgeProxy",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/bridge-proxy.c++",
          "lines": "144-150",
          "snippet": "KJ_IF_MAYBE(auth, headers.get(hAuthorization)) {\n      if (auth->startsWith(\"bearer \") || auth->startsWith(\"Bearer \")) {\n        auto token = auth->slice(strlen(\"bearer \"));\n        auto session = getHttpSession(token);\n        return dispatchToSession(kj::mv(session), method, url, headers, requestBody, response);\n      }\n    }",
          "includes": [
            "#include \"util.h\"",
            "#include <kj/debug.h>",
            "#include <capnp/compat/json.h>",
            "#include <sandstorm/bridge-proxy.capnp.h>",
            "#include <sandstorm/api-session.capnp.h>",
            "#include <map>",
            "#include \"bridge-proxy.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include <kj/debug.h>\n#include <capnp/compat/json.h>\n#include <sandstorm/bridge-proxy.capnp.h>\n#include <sandstorm/api-session.capnp.h>\n#include <map>\n#include \"bridge-proxy.h\"\n\nBridgeProxy {\n  KJ_IF_MAYBE(auth, headers.get(hAuthorization)) {\n        if (auth->startsWith(\"bearer \") || auth->startsWith(\"Bearer \")) {\n          auto token = auth->slice(strlen(\"bearer \"));\n          auto session = getHttpSession(token);\n          return dispatchToSession(kj::mv(session), method, url, headers, requestBody, response);\n        }\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "path.findFirst",
          "args": [
            "'/'"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "\"..\""
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "\".\""
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::heapArray<SimpleEntry>",
          "args": [
            "3"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nSingletonDirectory {\n  kj::Array<SimpleEntry> simpleRead() override {\n      auto result = kj::heapArray<SimpleEntry>(3);\n  \n      result[0].name = kj::str(\".\");\n      result[0].type = fuse::Node::Type::DIRECTORY;\n      result[1].name = kj::str(\"..\");\n      result[1].type = fuse::Node::Type::DIRECTORY;\n  \n      KJ_IF_MAYBE(slashPos, path.findFirst('/')) {\n        result[2].name = kj::heapString(path.slice(0, *slashPos));\n      } else {\n        result[2].name = kj::heapString(path);\n      }\n}"
  },
  {
    "function_name": "SingletonDirectory",
    "container": "SingletonDirectory",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "376-376",
    "snippet": "explicit SingletonDirectory(kj::StringPtr path): path(path) {}",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nSingletonDirectory {\n  explicit SingletonDirectory(kj::StringPtr path): path(path) {}\n}"
  },
  {
    "function_name": "markUsed",
    "container": "TrackingNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "364-371",
    "snippet": "void markUsed() {\n    if (!isUsed) {\n      isUsed = true;\n      if (path != nullptr) {\n        callback(path);\n      }\n    }\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "callback",
          "args": [
            "path"
          ],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nTrackingNode {\n  void markUsed() {\n      if (!isUsed) {\n        isUsed = true;\n        if (path != nullptr) {\n          callback(path);\n        }\n      }\n    }\n}"
  },
  {
    "function_name": "readlink",
    "container": "TrackingNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "354-357",
    "snippet": "kj::String readlink() override {\n    markUsed();\n    return DelegatingNode::readlink();\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DelegatingNode::readlink",
          "args": [],
          "line": 356
        },
        "resolved": true,
        "details": {
          "function_name": "readlink",
          "container": "DelegatingNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
          "lines": "63-65",
          "snippet": "kj::String readlink() override {\n    return delegate->readlink();\n  }",
          "includes": [
            "#include \"util.h\"",
            "#include \"fuse.h\"",
            "#include <stdlib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/serialize.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include \"union-fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nDelegatingNode {\n  kj::String readlink() override {\n      return delegate->readlink();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "markUsed",
          "args": [],
          "line": 355
        },
        "resolved": true,
        "details": {
          "function_name": "markUsed",
          "container": "TrackingNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
          "lines": "364-371",
          "snippet": "void markUsed() {\n    if (!isUsed) {\n      isUsed = true;\n      if (path != nullptr) {\n        callback(path);\n      }\n    }\n  }",
          "includes": [
            "#include \"util.h\"",
            "#include \"fuse.h\"",
            "#include <stdlib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/serialize.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include \"union-fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nTrackingNode {\n  void markUsed() {\n      if (!isUsed) {\n        isUsed = true;\n        if (path != nullptr) {\n          callback(path);\n        }\n      }\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nTrackingNode {\n  kj::String readlink() override {\n      markUsed();\n      return DelegatingNode::readlink();\n    }\n}"
  },
  {
    "function_name": "openAsDirectory",
    "container": "TrackingNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "349-352",
    "snippet": "kj::Maybe<kj::Own<fuse::Directory>> openAsDirectory() override {\n    markUsed();\n    return DelegatingNode::openAsDirectory();\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DelegatingNode::openAsDirectory",
          "args": [],
          "line": 351
        },
        "resolved": true,
        "details": {
          "function_name": "openAsDirectory",
          "container": "DelegatingNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
          "lines": "59-61",
          "snippet": "kj::Maybe<kj::Own<fuse::Directory>> openAsDirectory() override {\n    return delegate->openAsDirectory();\n  }",
          "includes": [
            "#include \"util.h\"",
            "#include \"fuse.h\"",
            "#include <stdlib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/serialize.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include \"union-fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nDelegatingNode {\n  kj::Maybe<kj::Own<fuse::Directory>> openAsDirectory() override {\n      return delegate->openAsDirectory();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "markUsed",
          "args": [],
          "line": 350
        },
        "resolved": true,
        "details": {
          "function_name": "markUsed",
          "container": "TrackingNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
          "lines": "364-371",
          "snippet": "void markUsed() {\n    if (!isUsed) {\n      isUsed = true;\n      if (path != nullptr) {\n        callback(path);\n      }\n    }\n  }",
          "includes": [
            "#include \"util.h\"",
            "#include \"fuse.h\"",
            "#include <stdlib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/serialize.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include \"union-fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nTrackingNode {\n  void markUsed() {\n      if (!isUsed) {\n        isUsed = true;\n        if (path != nullptr) {\n          callback(path);\n        }\n      }\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nTrackingNode {\n  kj::Maybe<kj::Own<fuse::Directory>> openAsDirectory() override {\n      markUsed();\n      return DelegatingNode::openAsDirectory();\n    }\n}"
  },
  {
    "function_name": "openAsFile",
    "container": "TrackingNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "344-347",
    "snippet": "kj::Maybe<kj::Own<fuse::File>> openAsFile() override {\n    markUsed();\n    return DelegatingNode::openAsFile();\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DelegatingNode::openAsFile",
          "args": [],
          "line": 346
        },
        "resolved": true,
        "details": {
          "function_name": "openAsFile",
          "container": "DelegatingNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
          "lines": "55-57",
          "snippet": "kj::Maybe<kj::Own<fuse::File>> openAsFile() override {\n    return delegate->openAsFile();\n  }",
          "includes": [
            "#include \"util.h\"",
            "#include \"fuse.h\"",
            "#include <stdlib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/serialize.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include \"union-fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nDelegatingNode {\n  kj::Maybe<kj::Own<fuse::File>> openAsFile() override {\n      return delegate->openAsFile();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "markUsed",
          "args": [],
          "line": 345
        },
        "resolved": true,
        "details": {
          "function_name": "markUsed",
          "container": "TrackingNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
          "lines": "364-371",
          "snippet": "void markUsed() {\n    if (!isUsed) {\n      isUsed = true;\n      if (path != nullptr) {\n        callback(path);\n      }\n    }\n  }",
          "includes": [
            "#include \"util.h\"",
            "#include \"fuse.h\"",
            "#include <stdlib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/serialize.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include \"union-fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nTrackingNode {\n  void markUsed() {\n      if (!isUsed) {\n        isUsed = true;\n        if (path != nullptr) {\n          callback(path);\n        }\n      }\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nTrackingNode {\n  kj::Maybe<kj::Own<fuse::File>> openAsFile() override {\n      markUsed();\n      return DelegatingNode::openAsFile();\n    }\n}"
  },
  {
    "function_name": "getAttributes",
    "container": "TrackingNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "325-342",
    "snippet": "GetAttributesResults getAttributes() override {\n    // Normally, we don't want to mark a file as \"used\" just because it was stat()ed, because it\n    // is normal to stat() every file in a directory when listing that directory, and this doesn't\n    // necessarily mean the file is used by the app. However, we make a special exception for\n    // zero-sized regular files because:\n    // - Their mere presence _probably_ means something, since their content certainly doesn't.\n    // - Since they're zero-size, they won't significantly bloat the package.\n    //\n    // In particular, RubyGems has been observed to care about the presence or absence of zero-size\n    // \".build_complete\" files.\n\n    auto subresult = delegate->getAttributes();\n    auto& attributes = subresult.attributes;\n    if (attributes.type == fuse::Node::Type::REGULAR && attributes.size == 0) {\n      markUsed();\n    }\n    return subresult;\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "markUsed",
          "args": [],
          "line": 339
        },
        "resolved": true,
        "details": {
          "function_name": "markUsed",
          "container": "TrackingNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
          "lines": "364-371",
          "snippet": "void markUsed() {\n    if (!isUsed) {\n      isUsed = true;\n      if (path != nullptr) {\n        callback(path);\n      }\n    }\n  }",
          "includes": [
            "#include \"util.h\"",
            "#include \"fuse.h\"",
            "#include <stdlib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/serialize.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include \"union-fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nTrackingNode {\n  void markUsed() {\n      if (!isUsed) {\n        isUsed = true;\n        if (path != nullptr) {\n          callback(path);\n        }\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "delegate->getAttributes",
          "args": [],
          "line": 336
        },
        "resolved": true,
        "details": {
          "function_name": "getAttributes",
          "container": "SimpleDataNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
          "lines": "554-565",
          "snippet": "GetAttributesResults getAttributes() override {\n    auto result = GetAttributesResults {};\n    result.ttl = kj::maxValue;\n    auto& attr = result.attributes;\n    attr.inodeNumber = 0;\n    attr.type = fuse::Node::Type::REGULAR;\n    attr.permissions = 0444;\n    attr.linkCount = 1;\n    attr.size = data.size() * sizeof(capnp::word);\n\n    return result;\n  }",
          "includes": [
            "#include \"util.h\"",
            "#include \"fuse.h\"",
            "#include <stdlib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/serialize.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include \"union-fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nSimpleDataNode {\n  GetAttributesResults getAttributes() override {\n      auto result = GetAttributesResults {};\n      result.ttl = kj::maxValue;\n      auto& attr = result.attributes;\n      attr.inodeNumber = 0;\n      attr.type = fuse::Node::Type::REGULAR;\n      attr.permissions = 0444;\n      attr.linkCount = 1;\n      attr.size = data.size() * sizeof(capnp::word);\n  \n      return result;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nTrackingNode {\n  GetAttributesResults getAttributes() override {\n      // Normally, we don't want to mark a file as \"used\" just because it was stat()ed, because it\n      // is normal to stat() every file in a directory when listing that directory, and this doesn't\n      // necessarily mean the file is used by the app. However, we make a special exception for\n      // zero-sized regular files because:\n      // - Their mere presence _probably_ means something, since their content certainly doesn't.\n      // - Since they're zero-size, they won't significantly bloat the package.\n      //\n      // In particular, RubyGems has been observed to care about the presence or absence of zero-size\n      // \".build_complete\" files.\n  \n      auto subresult = delegate->getAttributes();\n      auto& attributes = subresult.attributes;\n      if (attributes.type == fuse::Node::Type::REGULAR && attributes.size == 0) {\n        markUsed();\n      }\n      return subresult;\n    }\n}"
  },
  {
    "function_name": "lookup",
    "container": "TrackingNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "311-323",
    "snippet": "kj::Maybe<LookupResults> lookup(kj::StringPtr name) override {\n    auto subPath = path == nullptr ? kj::heapString(name) : kj::str(path, '/', name);\n    auto maybeResponse = delegate->lookup(name);\n    KJ_IF_MAYBE(response, maybeResponse) {\n      auto& callback = this->callback;\n      return LookupResults {\n        kj::refcounted<TrackingNode>(kj::mv(response->node), kj::mv(subPath), callback),\n          response->ttl\n          };\n    } else {\n      return nullptr;\n    }\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::refcounted<TrackingNode>",
          "args": [
            "kj::mv(response->node)",
            "kj::mv(subPath)",
            "callback"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "subPath"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "response->node"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "delegate->lookup",
          "args": [
            "name"
          ],
          "line": 313
        },
        "resolved": true,
        "details": {
          "function_name": "lookup",
          "container": "SimpleDataNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
          "lines": "550-552",
          "snippet": "kj::Maybe<LookupResults> lookup(kj::StringPtr name) override {\n    return nullptr;\n  }",
          "includes": [
            "#include \"util.h\"",
            "#include \"fuse.h\"",
            "#include <stdlib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/serialize.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include \"union-fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nSimpleDataNode {\n  kj::Maybe<LookupResults> lookup(kj::StringPtr name) override {\n      return nullptr;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "path",
            "'/'",
            "name"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::heapString",
          "args": [
            "name"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nTrackingNode {\n  kj::Maybe<LookupResults> lookup(kj::StringPtr name) override {\n      auto subPath = path == nullptr ? kj::heapString(name) : kj::str(path, '/', name);\n      auto maybeResponse = delegate->lookup(name);\n      KJ_IF_MAYBE(response, maybeResponse) {\n        auto& callback = this->callback;\n        return LookupResults {\n          kj::refcounted<TrackingNode>(kj::mv(response->node), kj::mv(subPath), callback),\n            response->ttl\n            };\n      } else {\n        return nullptr;\n      }\n    }\n}"
  },
  {
    "function_name": "TrackingNode",
    "container": "TrackingNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "306-308",
    "snippet": "TrackingNode(kj::Own<fuse::Node> delegate, kj::String path,\n               kj::Function<void(kj::StringPtr)>& callback)\n    : DelegatingNode(kj::mv(delegate)), path(kj::mv(path)), callback(callback) {}",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "path"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "delegate"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nTrackingNode {\n  TrackingNode(kj::Own<fuse::Node> delegate, kj::String path,\n                 kj::Function<void(kj::StringPtr)>& callback)\n      : DelegatingNode(kj::mv(delegate)), path(kj::mv(path)), callback(callback) {}\n}"
  },
  {
    "function_name": "openAsDirectory",
    "container": "HidingNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "288-296",
    "snippet": "kj::Maybe<kj::Own<fuse::Directory>> openAsDirectory() override {\n    KJ_IF_MAYBE(delegate, DelegatingNode::openAsDirectory()) {\n      kj::Own<fuse::Directory> result =\n          kj::refcounted<HidingDirectory>(kj::mv(*delegate), hidePaths);\n      return kj::mv(result);\n    } else {\n      return nullptr;\n    }\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "result"
          ],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::refcounted<HidingDirectory>",
          "args": [
            "kj::mv(*delegate)",
            "hidePaths"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "*delegate"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nHidingNode {\n  kj::Maybe<kj::Own<fuse::Directory>> openAsDirectory() override {\n      KJ_IF_MAYBE(delegate, DelegatingNode::openAsDirectory()) {\n        kj::Own<fuse::Directory> result =\n            kj::refcounted<HidingDirectory>(kj::mv(*delegate), hidePaths);\n        return kj::mv(result);\n      } else {\n        return nullptr;\n      }\n    }\n}"
  },
  {
    "function_name": "lookup",
    "container": "HidingNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "264-286",
    "snippet": "kj::Maybe<LookupResults> lookup(kj::StringPtr name) override {\n    if (hidePaths.count(name) != 0) {\n      return nullptr;\n    }\n\n    auto maybeResult = delegate->lookup(name);\n\n    KJ_IF_MAYBE(result, maybeResult) {\n\n      std::set<kj::StringPtr> subHides;\n      for (auto& hidden: hidePaths) {\n        if (hidden.size() > name.size() &&\n            hidden.startsWith(name) &&\n            hidden[name.size()] == '/') {\n          subHides.insert(hidden.slice(name.size() + 1));\n        }\n      }\n\n      return LookupResults { kj::refcounted<HidingNode>(kj::mv(result->node), kj::mv(subHides)), result->ttl };\n    } else {\n      return nullptr;\n    }\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::refcounted<HidingNode>",
          "args": [
            "kj::mv(result->node)",
            "kj::mv(subHides)"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "subHides"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "result->node"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "subHides.insert",
          "args": [
            "hidden.slice(name.size() + 1)"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hidden.slice",
          "args": [
            "name.size() + 1"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "name.size",
          "args": [],
          "line": 278
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "StructyMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/util.h",
          "lines": "139-139",
          "snippet": "size_t size() { return pos - bytes; }",
          "includes": [
            "#include <set>",
            "#include <sandstorm/util.capnp.h>",
            "#include <capnp/rpc-twoparty.h>",
            "#include <kj/async.h>",
            "#include <kj/function.h>",
            "#include <unistd.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <kj/one-of.h>",
            "#include <kj/io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <set>\n#include <sandstorm/util.capnp.h>\n#include <capnp/rpc-twoparty.h>\n#include <kj/async.h>\n#include <kj/function.h>\n#include <unistd.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <kj/one-of.h>\n#include <kj/io.h>\n\nStructyMessage {\n  size_t size() { return pos - bytes; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "hidden.startsWith",
          "args": [
            "name"
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "delegate->lookup",
          "args": [
            "name"
          ],
          "line": 269
        },
        "resolved": true,
        "details": {
          "function_name": "lookup",
          "container": "SimpleDataNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
          "lines": "550-552",
          "snippet": "kj::Maybe<LookupResults> lookup(kj::StringPtr name) override {\n    return nullptr;\n  }",
          "includes": [
            "#include \"util.h\"",
            "#include \"fuse.h\"",
            "#include <stdlib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/serialize.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include \"union-fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nSimpleDataNode {\n  kj::Maybe<LookupResults> lookup(kj::StringPtr name) override {\n      return nullptr;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "hidePaths.count",
          "args": [
            "name"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nHidingNode {\n  kj::Maybe<LookupResults> lookup(kj::StringPtr name) override {\n      if (hidePaths.count(name) != 0) {\n        return nullptr;\n      }\n  \n      auto maybeResult = delegate->lookup(name);\n  \n      KJ_IF_MAYBE(result, maybeResult) {\n  \n        std::set<kj::StringPtr> subHides;\n        for (auto& hidden: hidePaths) {\n          if (hidden.size() > name.size() &&\n              hidden.startsWith(name) &&\n              hidden[name.size()] == '/') {\n            subHides.insert(hidden.slice(name.size() + 1));\n          }\n        }\n  \n        return LookupResults { kj::refcounted<HidingNode>(kj::mv(result->node), kj::mv(subHides)), result->ttl };\n      } else {\n        return nullptr;\n      }\n    }\n}"
  },
  {
    "function_name": "HidingNode",
    "container": "HidingNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "260-261",
    "snippet": "HidingNode(kj::Own<fuse::Node>&& delegate, std::set<kj::StringPtr> hidePaths)\n    : DelegatingNode(kj::mv(delegate)), hidePaths(kj::mv(hidePaths)) {}",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "hidePaths"
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "delegate"
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nHidingNode {\n  HidingNode(kj::Own<fuse::Node>&& delegate, std::set<kj::StringPtr> hidePaths)\n      : DelegatingNode(kj::mv(delegate)), hidePaths(kj::mv(hidePaths)) {}\n}"
  },
  {
    "function_name": "simpleRead",
    "container": "HidingDirectory",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "238-249",
    "snippet": "kj::Array<SimpleEntry> simpleRead() override {\n    auto entries = readFrom(*delegate);\n    kj::Vector<SimpleEntry> outEntries(entries.size());\n\n    for (auto& entry: entries) {\n      if (hidePaths.count(entry.name) == 0) {\n        outEntries.add(kj::mv(entry));\n      }\n    }\n\n    return outEntries.releaseAsArray();\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "outEntries.releaseAsArray",
          "args": [],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "outEntries.add",
          "args": [
            "kj::mv(entry)"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "entry"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hidePaths.count",
          "args": [
            "entry.name"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "entries.size",
          "args": [],
          "line": 240
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "StructyMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/util.h",
          "lines": "139-139",
          "snippet": "size_t size() { return pos - bytes; }",
          "includes": [
            "#include <set>",
            "#include <sandstorm/util.capnp.h>",
            "#include <capnp/rpc-twoparty.h>",
            "#include <kj/async.h>",
            "#include <kj/function.h>",
            "#include <unistd.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <kj/one-of.h>",
            "#include <kj/io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <set>\n#include <sandstorm/util.capnp.h>\n#include <capnp/rpc-twoparty.h>\n#include <kj/async.h>\n#include <kj/function.h>\n#include <unistd.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <kj/one-of.h>\n#include <kj/io.h>\n\nStructyMessage {\n  size_t size() { return pos - bytes; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "readFrom",
          "args": [
            "*delegate"
          ],
          "line": 239
        },
        "resolved": true,
        "details": {
          "function_name": "readFrom",
          "container": "SimpleDirectory",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
          "lines": "89-113",
          "snippet": "static kj::Array<SimpleEntry> readFrom(\n      fuse::Directory& directory, uint64_t offset = 0,\n      kj::Vector<SimpleEntry>&& alreadyRead = kj::Vector<SimpleEntry>(16)) {\n    // Convenience to read the contents of some other directory. Adds all entries to *alreadyRead.\n\n    static const uint DEFAULT_COUNT = 128;\n    auto entries = directory.read(offset, DEFAULT_COUNT);\n\n    uint64_t newOffset = 0;\n    for (auto& entry: entries) {\n      alreadyRead.add(SimpleEntry {\n          entry.inodeNumber,\n            kj::heapString(entry.name),\n            entry.type\n            });\n        newOffset = entry.nextOffset;\n    }\n\n    if (entries.size() == DEFAULT_COUNT) {\n      // Could be more to read.\n      return readFrom(directory, newOffset, kj::mv(alreadyRead));\n    } else {\n      return alreadyRead.releaseAsArray();\n    }\n  }",
          "includes": [
            "#include \"util.h\"",
            "#include \"fuse.h\"",
            "#include <stdlib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/serialize.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include \"union-fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nSimpleDirectory {\n  static kj::Array<SimpleEntry> readFrom(\n        fuse::Directory& directory, uint64_t offset = 0,\n        kj::Vector<SimpleEntry>&& alreadyRead = kj::Vector<SimpleEntry>(16)) {\n      // Convenience to read the contents of some other directory. Adds all entries to *alreadyRead.\n  \n      static const uint DEFAULT_COUNT = 128;\n      auto entries = directory.read(offset, DEFAULT_COUNT);\n  \n      uint64_t newOffset = 0;\n      for (auto& entry: entries) {\n        alreadyRead.add(SimpleEntry {\n            entry.inodeNumber,\n              kj::heapString(entry.name),\n              entry.type\n              });\n          newOffset = entry.nextOffset;\n      }\n  \n      if (entries.size() == DEFAULT_COUNT) {\n        // Could be more to read.\n        return readFrom(directory, newOffset, kj::mv(alreadyRead));\n      } else {\n        return alreadyRead.releaseAsArray();\n      }\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nHidingDirectory {\n  kj::Array<SimpleEntry> simpleRead() override {\n      auto entries = readFrom(*delegate);\n      kj::Vector<SimpleEntry> outEntries(entries.size());\n  \n      for (auto& entry: entries) {\n        if (hidePaths.count(entry.name) == 0) {\n          outEntries.add(kj::mv(entry));\n        }\n      }\n  \n      return outEntries.releaseAsArray();\n    }\n}"
  },
  {
    "function_name": "HidingDirectory",
    "container": "HidingDirectory",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "235-236",
    "snippet": "HidingDirectory(kj::Own<fuse::Directory> delegate, std::set<kj::StringPtr> hidePaths)\n      : delegate(kj::mv(delegate)), hidePaths(kj::mv(hidePaths)) {}",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "hidePaths"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "delegate"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nHidingDirectory {\n  HidingDirectory(kj::Own<fuse::Directory> delegate, std::set<kj::StringPtr> hidePaths)\n        : delegate(kj::mv(delegate)), hidePaths(kj::mv(hidePaths)) {}\n}"
  },
  {
    "function_name": "openAsDirectory",
    "container": "UnionNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "210-225",
    "snippet": "kj::Maybe<kj::Own<fuse::Directory>> openAsDirectory() override {\n    // Call openAsDirectory() on all children and then return a UnionDirectory of the pipelined\n    // results. No need to wait; if pipelined requests on the layers fail then we simply treat\n    // them as empty directories anyway.\n\n    auto dirLayers = kj::heapArrayBuilder<kj::Own<fuse::Directory>>(layers.size());\n    for (auto& layer: layers) {\n      auto maybeAsDir = layer->openAsDirectory();\n      KJ_IF_MAYBE(asDir, maybeAsDir) {\n        dirLayers.add(kj::mv(*asDir));\n      }\n    }\n\n    kj::Own<fuse::Directory> result = kj::refcounted<UnionDirectory>(dirLayers.finish());\n    return kj::mv(result);\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "result"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::refcounted<UnionDirectory>",
          "args": [
            "dirLayers.finish()"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dirLayers.finish",
          "args": [],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dirLayers.add",
          "args": [
            "kj::mv(*asDir)"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "*asDir"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "layer->openAsDirectory",
          "args": [],
          "line": 217
        },
        "resolved": true,
        "details": {
          "function_name": "openAsDirectory",
          "container": "SimpleDataNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
          "lines": "572-574",
          "snippet": "kj::Maybe<kj::Own<fuse::Directory>> openAsDirectory() override {\n    return nullptr;\n  }",
          "includes": [
            "#include \"util.h\"",
            "#include \"fuse.h\"",
            "#include <stdlib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/serialize.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include \"union-fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nSimpleDataNode {\n  kj::Maybe<kj::Own<fuse::Directory>> openAsDirectory() override {\n      return nullptr;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::heapArrayBuilder<kj::Own<fuse::Directory>>",
          "args": [
            "layers.size()"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "layers.size",
          "args": [],
          "line": 215
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "StructyMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/util.h",
          "lines": "139-139",
          "snippet": "size_t size() { return pos - bytes; }",
          "includes": [
            "#include <set>",
            "#include <sandstorm/util.capnp.h>",
            "#include <capnp/rpc-twoparty.h>",
            "#include <kj/async.h>",
            "#include <kj/function.h>",
            "#include <unistd.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <kj/one-of.h>",
            "#include <kj/io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <set>\n#include <sandstorm/util.capnp.h>\n#include <capnp/rpc-twoparty.h>\n#include <kj/async.h>\n#include <kj/function.h>\n#include <unistd.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <kj/one-of.h>\n#include <kj/io.h>\n\nStructyMessage {\n  size_t size() { return pos - bytes; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nUnionNode {\n  kj::Maybe<kj::Own<fuse::Directory>> openAsDirectory() override {\n      // Call openAsDirectory() on all children and then return a UnionDirectory of the pipelined\n      // results. No need to wait; if pipelined requests on the layers fail then we simply treat\n      // them as empty directories anyway.\n  \n      auto dirLayers = kj::heapArrayBuilder<kj::Own<fuse::Directory>>(layers.size());\n      for (auto& layer: layers) {\n        auto maybeAsDir = layer->openAsDirectory();\n        KJ_IF_MAYBE(asDir, maybeAsDir) {\n          dirLayers.add(kj::mv(*asDir));\n        }\n      }\n  \n      kj::Own<fuse::Directory> result = kj::refcounted<UnionDirectory>(dirLayers.finish());\n      return kj::mv(result);\n    }\n}"
  },
  {
    "function_name": "lookup",
    "container": "UnionNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "189-208",
    "snippet": "kj::Maybe<LookupResults> lookup(kj::StringPtr name) override {\n\n    // Forward the lookup request to each node in our list.\n    kj::Vector<kj::Own<fuse::Node>> outLayers(layers.size());\n    uint64_t ttl = kj::maxValue;\n    for (auto& layer: layers) {\n      auto maybeLayer = layer->lookup(name);\n      KJ_IF_MAYBE(newLayer, maybeLayer) {\n        outLayers.add(newLayer->node->addRef());\n        ttl = kj::min(ttl, newLayer->ttl);\n      }\n\n    }\n\n    if (outLayers.size() == 0) {\n      return nullptr;\n    } else {\n      return LookupResults { kj::refcounted<UnionNode>(outLayers.releaseAsArray()), ttl };\n    }\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::refcounted<UnionNode>",
          "args": [
            "outLayers.releaseAsArray()"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "outLayers.releaseAsArray",
          "args": [],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "outLayers.size",
          "args": [],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "StructyMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/util.h",
          "lines": "139-139",
          "snippet": "size_t size() { return pos - bytes; }",
          "includes": [
            "#include <set>",
            "#include <sandstorm/util.capnp.h>",
            "#include <capnp/rpc-twoparty.h>",
            "#include <kj/async.h>",
            "#include <kj/function.h>",
            "#include <unistd.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <kj/one-of.h>",
            "#include <kj/io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <set>\n#include <sandstorm/util.capnp.h>\n#include <capnp/rpc-twoparty.h>\n#include <kj/async.h>\n#include <kj/function.h>\n#include <unistd.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <kj/one-of.h>\n#include <kj/io.h>\n\nStructyMessage {\n  size_t size() { return pos - bytes; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::min",
          "args": [
            "ttl",
            "newLayer->ttl"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "outLayers.add",
          "args": [
            "newLayer->node->addRef()"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "newLayer->node->addRef",
          "args": [],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "addRef",
          "container": "SimpleDataNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
          "lines": "545-547",
          "snippet": "kj::Own<fuse::Node> addRef() override {\n    return kj::addRef(*this);\n  }",
          "includes": [
            "#include \"util.h\"",
            "#include \"fuse.h\"",
            "#include <stdlib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/serialize.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include \"union-fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nSimpleDataNode {\n  kj::Own<fuse::Node> addRef() override {\n      return kj::addRef(*this);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "layer->lookup",
          "args": [
            "name"
          ],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "lookup",
          "container": "SimpleDataNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
          "lines": "550-552",
          "snippet": "kj::Maybe<LookupResults> lookup(kj::StringPtr name) override {\n    return nullptr;\n  }",
          "includes": [
            "#include \"util.h\"",
            "#include \"fuse.h\"",
            "#include <stdlib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/serialize.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include \"union-fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nSimpleDataNode {\n  kj::Maybe<LookupResults> lookup(kj::StringPtr name) override {\n      return nullptr;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nUnionNode {\n  kj::Maybe<LookupResults> lookup(kj::StringPtr name) override {\n  \n      // Forward the lookup request to each node in our list.\n      kj::Vector<kj::Own<fuse::Node>> outLayers(layers.size());\n      uint64_t ttl = kj::maxValue;\n      for (auto& layer: layers) {\n        auto maybeLayer = layer->lookup(name);\n        KJ_IF_MAYBE(newLayer, maybeLayer) {\n          outLayers.add(newLayer->node->addRef());\n          ttl = kj::min(ttl, newLayer->ttl);\n        }\n  \n      }\n  \n      if (outLayers.size() == 0) {\n        return nullptr;\n      } else {\n        return LookupResults { kj::refcounted<UnionNode>(outLayers.releaseAsArray()), ttl };\n      }\n    }\n}"
  },
  {
    "function_name": "UnionNode",
    "container": "UnionNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "185-186",
    "snippet": "explicit UnionNode(kj::Array<kj::Own<fuse::Node>> layers)\n    : DelegatingNode(layers[0]->addRef()), layers(kj::mv(layers)) {}",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "layers"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "layers[0]->addRef",
          "args": [],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "addRef",
          "container": "SimpleDataNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
          "lines": "545-547",
          "snippet": "kj::Own<fuse::Node> addRef() override {\n    return kj::addRef(*this);\n  }",
          "includes": [
            "#include \"util.h\"",
            "#include \"fuse.h\"",
            "#include <stdlib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/serialize.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include \"union-fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nSimpleDataNode {\n  kj::Own<fuse::Node> addRef() override {\n      return kj::addRef(*this);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nUnionNode {\n  explicit UnionNode(kj::Array<kj::Own<fuse::Node>> layers)\n      : DelegatingNode(layers[0]->addRef()), layers(kj::mv(layers)) {}\n}"
  },
  {
    "function_name": "simpleRead",
    "container": "UnionDirectory",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "159-175",
    "snippet": "kj::Array<SimpleEntry> simpleRead() override {\n    // Read from each delegate.\n    std::map<kj::StringPtr, SimpleEntry> entryMap;\n    for (auto& layer: layers) {\n      auto sublist = readFrom(*layer);\n      for (auto& entry: sublist) {\n        entryMap.insert(std::make_pair(kj::StringPtr(entry.name), kj::mv(entry)));\n      }\n    }\n\n    auto results = kj::heapArrayBuilder<SimpleEntry>(entryMap.size());\n    for (auto& mapEntry: entryMap) {\n      results.add(kj::mv(mapEntry.second));\n    }\n\n    return results.finish();\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "results.finish",
          "args": [],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "results.add",
          "args": [
            "kj::mv(mapEntry.second)"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "mapEntry.second"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::heapArrayBuilder<SimpleEntry>",
          "args": [
            "entryMap.size()"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "entryMap.size",
          "args": [],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "StructyMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/util.h",
          "lines": "139-139",
          "snippet": "size_t size() { return pos - bytes; }",
          "includes": [
            "#include <set>",
            "#include <sandstorm/util.capnp.h>",
            "#include <capnp/rpc-twoparty.h>",
            "#include <kj/async.h>",
            "#include <kj/function.h>",
            "#include <unistd.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <kj/one-of.h>",
            "#include <kj/io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <set>\n#include <sandstorm/util.capnp.h>\n#include <capnp/rpc-twoparty.h>\n#include <kj/async.h>\n#include <kj/function.h>\n#include <unistd.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <kj/one-of.h>\n#include <kj/io.h>\n\nStructyMessage {\n  size_t size() { return pos - bytes; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "entryMap.insert",
          "args": [
            "std::make_pair(kj::StringPtr(entry.name), kj::mv(entry))"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::make_pair",
          "args": [
            "kj::StringPtr(entry.name)",
            "kj::mv(entry)"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "entry"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::StringPtr",
          "args": [
            "entry.name"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "readFrom",
          "args": [
            "*layer"
          ],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "readFrom",
          "container": "SimpleDirectory",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
          "lines": "89-113",
          "snippet": "static kj::Array<SimpleEntry> readFrom(\n      fuse::Directory& directory, uint64_t offset = 0,\n      kj::Vector<SimpleEntry>&& alreadyRead = kj::Vector<SimpleEntry>(16)) {\n    // Convenience to read the contents of some other directory. Adds all entries to *alreadyRead.\n\n    static const uint DEFAULT_COUNT = 128;\n    auto entries = directory.read(offset, DEFAULT_COUNT);\n\n    uint64_t newOffset = 0;\n    for (auto& entry: entries) {\n      alreadyRead.add(SimpleEntry {\n          entry.inodeNumber,\n            kj::heapString(entry.name),\n            entry.type\n            });\n        newOffset = entry.nextOffset;\n    }\n\n    if (entries.size() == DEFAULT_COUNT) {\n      // Could be more to read.\n      return readFrom(directory, newOffset, kj::mv(alreadyRead));\n    } else {\n      return alreadyRead.releaseAsArray();\n    }\n  }",
          "includes": [
            "#include \"util.h\"",
            "#include \"fuse.h\"",
            "#include <stdlib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/serialize.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include \"union-fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nSimpleDirectory {\n  static kj::Array<SimpleEntry> readFrom(\n        fuse::Directory& directory, uint64_t offset = 0,\n        kj::Vector<SimpleEntry>&& alreadyRead = kj::Vector<SimpleEntry>(16)) {\n      // Convenience to read the contents of some other directory. Adds all entries to *alreadyRead.\n  \n      static const uint DEFAULT_COUNT = 128;\n      auto entries = directory.read(offset, DEFAULT_COUNT);\n  \n      uint64_t newOffset = 0;\n      for (auto& entry: entries) {\n        alreadyRead.add(SimpleEntry {\n            entry.inodeNumber,\n              kj::heapString(entry.name),\n              entry.type\n              });\n          newOffset = entry.nextOffset;\n      }\n  \n      if (entries.size() == DEFAULT_COUNT) {\n        // Could be more to read.\n        return readFrom(directory, newOffset, kj::mv(alreadyRead));\n      } else {\n        return alreadyRead.releaseAsArray();\n      }\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nUnionDirectory {\n  kj::Array<SimpleEntry> simpleRead() override {\n      // Read from each delegate.\n      std::map<kj::StringPtr, SimpleEntry> entryMap;\n      for (auto& layer: layers) {\n        auto sublist = readFrom(*layer);\n        for (auto& entry: sublist) {\n          entryMap.insert(std::make_pair(kj::StringPtr(entry.name), kj::mv(entry)));\n        }\n      }\n  \n      auto results = kj::heapArrayBuilder<SimpleEntry>(entryMap.size());\n      for (auto& mapEntry: entryMap) {\n        results.add(kj::mv(mapEntry.second));\n      }\n  \n      return results.finish();\n    }\n}"
  },
  {
    "function_name": "UnionDirectory",
    "container": "UnionDirectory",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "156-157",
    "snippet": "explicit UnionDirectory(kj::Array<kj::Own<fuse::Directory>>&& layers)\n      : layers(kj::mv(layers)) {}",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "layers"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nUnionDirectory {\n  explicit UnionDirectory(kj::Array<kj::Own<fuse::Directory>>&& layers)\n        : layers(kj::mv(layers)) {}\n}"
  },
  {
    "function_name": "fillResponse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "130-149",
    "snippet": "static kj::Array<Entry> fillResponse(uint64_t offset, uint32_t count,\n                                       const kj::Array<SimpleEntry>& entries) {\n    // Slice down to the list we're returning now.\n    auto startOffset = kj::min(entries.size(), offset);\n    auto slice = entries.slice(startOffset, entries.size());\n    slice = slice.slice(0, kj::min(slice.size(), count));\n\n    // Fill in results.\n    kj::Array<Entry> results = kj::heapArray<Entry>(slice.size());\n    for (size_t i: kj::indices(slice)) {\n      auto& entry = slice[i];\n\n      results[i].inodeNumber = entry.inodeNumber;\n      results[i].nextOffset = startOffset + i + 1;\n      results[i].type = entry.type;\n      results[i].name = kj::str(entry.name);\n    }\n\n    return results;\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "entry.name"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::indices",
          "args": [
            "slice"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::heapArray<Entry>",
          "args": [
            "slice.size()"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slice.size",
          "args": [],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "StructyMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/util.h",
          "lines": "139-139",
          "snippet": "size_t size() { return pos - bytes; }",
          "includes": [
            "#include <set>",
            "#include <sandstorm/util.capnp.h>",
            "#include <capnp/rpc-twoparty.h>",
            "#include <kj/async.h>",
            "#include <kj/function.h>",
            "#include <unistd.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <kj/one-of.h>",
            "#include <kj/io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <set>\n#include <sandstorm/util.capnp.h>\n#include <capnp/rpc-twoparty.h>\n#include <kj/async.h>\n#include <kj/function.h>\n#include <unistd.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <kj/one-of.h>\n#include <kj/io.h>\n\nStructyMessage {\n  size_t size() { return pos - bytes; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "slice.slice",
          "args": [
            "0",
            "kj::min(slice.size(), count)"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::min",
          "args": [
            "slice.size()",
            "count"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "entries.slice",
          "args": [
            "startOffset",
            "entries.size()"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::min",
          "args": [
            "entries.size()",
            "offset"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nstatic kj::Array<Entry> fillResponse(uint64_t offset, uint32_t count,\n                                       const kj::Array<SimpleEntry>& entries) {\n    // Slice down to the list we're returning now.\n    auto startOffset = kj::min(entries.size(), offset);\n    auto slice = entries.slice(startOffset, entries.size());\n    slice = slice.slice(0, kj::min(slice.size(), count));\n\n    // Fill in results.\n    kj::Array<Entry> results = kj::heapArray<Entry>(slice.size());\n    for (size_t i: kj::indices(slice)) {\n      auto& entry = slice[i];\n\n      results[i].inodeNumber = entry.inodeNumber;\n      results[i].nextOffset = startOffset + i + 1;\n      results[i].type = entry.type;\n      results[i].name = kj::str(entry.name);\n    }\n\n    return results;\n  }"
  },
  {
    "function_name": "read",
    "container": "SimpleDirectory",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "116-124",
    "snippet": "kj::Array<Entry> read(uint64_t offset, uint32_t count) override {\n    KJ_IF_MAYBE(c, cachedResults) {\n      return fillResponse(offset, count, *c);\n    } else {\n      auto entries = simpleRead();\n      auto result = fillResponse(offset, count, entries);\n      cachedResults = kj::mv(entries);\n      return result;\n    }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "entries"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fillResponse",
          "args": [
            "offset",
            "count",
            "entries"
          ],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "fillResponse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
          "lines": "130-149",
          "snippet": "static kj::Array<Entry> fillResponse(uint64_t offset, uint32_t count,\n                                       const kj::Array<SimpleEntry>& entries) {\n    // Slice down to the list we're returning now.\n    auto startOffset = kj::min(entries.size(), offset);\n    auto slice = entries.slice(startOffset, entries.size());\n    slice = slice.slice(0, kj::min(slice.size(), count));\n\n    // Fill in results.\n    kj::Array<Entry> results = kj::heapArray<Entry>(slice.size());\n    for (size_t i: kj::indices(slice)) {\n      auto& entry = slice[i];\n\n      results[i].inodeNumber = entry.inodeNumber;\n      results[i].nextOffset = startOffset + i + 1;\n      results[i].type = entry.type;\n      results[i].name = kj::str(entry.name);\n    }\n\n    return results;\n  }",
          "includes": [
            "#include \"util.h\"",
            "#include \"fuse.h\"",
            "#include <stdlib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/serialize.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include \"union-fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nstatic kj::Array<Entry> fillResponse(uint64_t offset, uint32_t count,\n                                       const kj::Array<SimpleEntry>& entries) {\n    // Slice down to the list we're returning now.\n    auto startOffset = kj::min(entries.size(), offset);\n    auto slice = entries.slice(startOffset, entries.size());\n    slice = slice.slice(0, kj::min(slice.size(), count));\n\n    // Fill in results.\n    kj::Array<Entry> results = kj::heapArray<Entry>(slice.size());\n    for (size_t i: kj::indices(slice)) {\n      auto& entry = slice[i];\n\n      results[i].inodeNumber = entry.inodeNumber;\n      results[i].nextOffset = startOffset + i + 1;\n      results[i].type = entry.type;\n      results[i].name = kj::str(entry.name);\n    }\n\n    return results;\n  }"
        }
      },
      {
        "call_info": {
          "callee": "simpleRead",
          "args": [],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "simpleRead",
          "container": "EmptyDirectory",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
          "lines": "463-472",
          "snippet": "kj::Array<SimpleEntry> simpleRead() override {\n    auto result = kj::heapArray<SimpleEntry>(2);\n\n    result[0].name = kj::str(\".\");\n    result[0].type = fuse::Node::Type::DIRECTORY;\n    result[1].name = kj::str(\"..\");\n    result[1].type = fuse::Node::Type::DIRECTORY;\n\n    return kj::mv(result);\n  }",
          "includes": [
            "#include \"util.h\"",
            "#include \"fuse.h\"",
            "#include <stdlib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/serialize.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include \"union-fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nEmptyDirectory {\n  kj::Array<SimpleEntry> simpleRead() override {\n      auto result = kj::heapArray<SimpleEntry>(2);\n  \n      result[0].name = kj::str(\".\");\n      result[0].type = fuse::Node::Type::DIRECTORY;\n      result[1].name = kj::str(\"..\");\n      result[1].type = fuse::Node::Type::DIRECTORY;\n  \n      return kj::mv(result);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nSimpleDirectory {\n  kj::Array<Entry> read(uint64_t offset, uint32_t count) override {\n      KJ_IF_MAYBE(c, cachedResults) {\n        return fillResponse(offset, count, *c);\n      } else {\n        auto entries = simpleRead();\n        auto result = fillResponse(offset, count, entries);\n        cachedResults = kj::mv(entries);\n        return result;\n      }\n}"
  },
  {
    "function_name": "readFrom",
    "container": "SimpleDirectory",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "89-113",
    "snippet": "static kj::Array<SimpleEntry> readFrom(\n      fuse::Directory& directory, uint64_t offset = 0,\n      kj::Vector<SimpleEntry>&& alreadyRead = kj::Vector<SimpleEntry>(16)) {\n    // Convenience to read the contents of some other directory. Adds all entries to *alreadyRead.\n\n    static const uint DEFAULT_COUNT = 128;\n    auto entries = directory.read(offset, DEFAULT_COUNT);\n\n    uint64_t newOffset = 0;\n    for (auto& entry: entries) {\n      alreadyRead.add(SimpleEntry {\n          entry.inodeNumber,\n            kj::heapString(entry.name),\n            entry.type\n            });\n        newOffset = entry.nextOffset;\n    }\n\n    if (entries.size() == DEFAULT_COUNT) {\n      // Could be more to read.\n      return readFrom(directory, newOffset, kj::mv(alreadyRead));\n    } else {\n      return alreadyRead.releaseAsArray();\n    }\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "alreadyRead.releaseAsArray",
          "args": [],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "readFrom",
          "args": [
            "directory",
            "newOffset",
            "kj::mv(alreadyRead)"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "alreadyRead"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "entries.size",
          "args": [],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "StructyMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/util.h",
          "lines": "139-139",
          "snippet": "size_t size() { return pos - bytes; }",
          "includes": [
            "#include <set>",
            "#include <sandstorm/util.capnp.h>",
            "#include <capnp/rpc-twoparty.h>",
            "#include <kj/async.h>",
            "#include <kj/function.h>",
            "#include <unistd.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <kj/one-of.h>",
            "#include <kj/io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <set>\n#include <sandstorm/util.capnp.h>\n#include <capnp/rpc-twoparty.h>\n#include <kj/async.h>\n#include <kj/function.h>\n#include <unistd.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <kj/one-of.h>\n#include <kj/io.h>\n\nStructyMessage {\n  size_t size() { return pos - bytes; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "alreadyRead.add",
          "args": [
            "SimpleEntry {\n          entry.inodeNumber,\n            kj::heapString(entry.name),\n            entry.type\n            }"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::heapString",
          "args": [
            "entry.name"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "directory.read",
          "args": [
            "offset",
            "DEFAULT_COUNT"
          ],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "read",
          "container": "SimpleDataFile",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
          "lines": "529-533",
          "snippet": "kj::Array<uint8_t> read(uint64_t offset0, uint32_t size0) override {\n    auto offset = kj::min(data.size(), offset0);\n    auto size = kj::min(data.size() - offset, size0);\n    return kj::heapArray(data.slice(offset, offset + size));\n  }",
          "includes": [
            "#include \"util.h\"",
            "#include \"fuse.h\"",
            "#include <stdlib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/serialize.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include \"union-fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nSimpleDataFile {\n  kj::Array<uint8_t> read(uint64_t offset0, uint32_t size0) override {\n      auto offset = kj::min(data.size(), offset0);\n      auto size = kj::min(data.size() - offset, size0);\n      return kj::heapArray(data.slice(offset, offset + size));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::Vector<SimpleEntry>",
          "args": [
            "16"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nSimpleDirectory {\n  static kj::Array<SimpleEntry> readFrom(\n        fuse::Directory& directory, uint64_t offset = 0,\n        kj::Vector<SimpleEntry>&& alreadyRead = kj::Vector<SimpleEntry>(16)) {\n      // Convenience to read the contents of some other directory. Adds all entries to *alreadyRead.\n  \n      static const uint DEFAULT_COUNT = 128;\n      auto entries = directory.read(offset, DEFAULT_COUNT);\n  \n      uint64_t newOffset = 0;\n      for (auto& entry: entries) {\n        alreadyRead.add(SimpleEntry {\n            entry.inodeNumber,\n              kj::heapString(entry.name),\n              entry.type\n              });\n          newOffset = entry.nextOffset;\n      }\n  \n      if (entries.size() == DEFAULT_COUNT) {\n        // Could be more to read.\n        return readFrom(directory, newOffset, kj::mv(alreadyRead));\n      } else {\n        return alreadyRead.releaseAsArray();\n      }\n    }\n}"
  },
  {
    "function_name": "addRef",
    "container": "SimpleDirectory",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "82-84",
    "snippet": "kj::Own<fuse::Directory> addRef() override {\n    return kj::addRef(*this);\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::addRef",
          "args": [
            "*this"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nSimpleDirectory {\n  kj::Own<fuse::Directory> addRef() override {\n      return kj::addRef(*this);\n    }\n}"
  },
  {
    "function_name": "readlink",
    "container": "DelegatingNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "63-65",
    "snippet": "kj::String readlink() override {\n    return delegate->readlink();\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "delegate->readlink",
          "args": [],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "readlink",
          "container": "SimpleDataNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
          "lines": "576-578",
          "snippet": "kj::String readlink() override {\n    KJ_FAIL_REQUIRE(\"not a symlink\");\n  }",
          "includes": [
            "#include \"util.h\"",
            "#include \"fuse.h\"",
            "#include <stdlib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/serialize.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include \"union-fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nSimpleDataNode {\n  kj::String readlink() override {\n      KJ_FAIL_REQUIRE(\"not a symlink\");\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nDelegatingNode {\n  kj::String readlink() override {\n      return delegate->readlink();\n    }\n}"
  },
  {
    "function_name": "openAsDirectory",
    "container": "DelegatingNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "59-61",
    "snippet": "kj::Maybe<kj::Own<fuse::Directory>> openAsDirectory() override {\n    return delegate->openAsDirectory();\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "delegate->openAsDirectory",
          "args": [],
          "line": 60
        },
        "resolved": true,
        "details": {
          "function_name": "openAsDirectory",
          "container": "SimpleDataNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
          "lines": "572-574",
          "snippet": "kj::Maybe<kj::Own<fuse::Directory>> openAsDirectory() override {\n    return nullptr;\n  }",
          "includes": [
            "#include \"util.h\"",
            "#include \"fuse.h\"",
            "#include <stdlib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/serialize.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include \"union-fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nSimpleDataNode {\n  kj::Maybe<kj::Own<fuse::Directory>> openAsDirectory() override {\n      return nullptr;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nDelegatingNode {\n  kj::Maybe<kj::Own<fuse::Directory>> openAsDirectory() override {\n      return delegate->openAsDirectory();\n    }\n}"
  },
  {
    "function_name": "openAsFile",
    "container": "DelegatingNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "55-57",
    "snippet": "kj::Maybe<kj::Own<fuse::File>> openAsFile() override {\n    return delegate->openAsFile();\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "delegate->openAsFile",
          "args": [],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "openAsFile",
          "container": "SimpleDataNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
          "lines": "567-570",
          "snippet": "kj::Maybe<kj::Own<fuse::File>> openAsFile() override {\n    kj::Own<fuse::File> result = kj::refcounted<SimpleDataFile>(data);\n    return kj::mv(result);\n  }",
          "includes": [
            "#include \"util.h\"",
            "#include \"fuse.h\"",
            "#include <stdlib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/serialize.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include \"union-fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nSimpleDataNode {\n  kj::Maybe<kj::Own<fuse::File>> openAsFile() override {\n      kj::Own<fuse::File> result = kj::refcounted<SimpleDataFile>(data);\n      return kj::mv(result);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nDelegatingNode {\n  kj::Maybe<kj::Own<fuse::File>> openAsFile() override {\n      return delegate->openAsFile();\n    }\n}"
  },
  {
    "function_name": "getAttributes",
    "container": "DelegatingNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "51-53",
    "snippet": "GetAttributesResults getAttributes() override {\n    return delegate->getAttributes();\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "delegate->getAttributes",
          "args": [],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "getAttributes",
          "container": "SimpleDataNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
          "lines": "554-565",
          "snippet": "GetAttributesResults getAttributes() override {\n    auto result = GetAttributesResults {};\n    result.ttl = kj::maxValue;\n    auto& attr = result.attributes;\n    attr.inodeNumber = 0;\n    attr.type = fuse::Node::Type::REGULAR;\n    attr.permissions = 0444;\n    attr.linkCount = 1;\n    attr.size = data.size() * sizeof(capnp::word);\n\n    return result;\n  }",
          "includes": [
            "#include \"util.h\"",
            "#include \"fuse.h\"",
            "#include <stdlib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/serialize.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include \"union-fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nSimpleDataNode {\n  GetAttributesResults getAttributes() override {\n      auto result = GetAttributesResults {};\n      result.ttl = kj::maxValue;\n      auto& attr = result.attributes;\n      attr.inodeNumber = 0;\n      attr.type = fuse::Node::Type::REGULAR;\n      attr.permissions = 0444;\n      attr.linkCount = 1;\n      attr.size = data.size() * sizeof(capnp::word);\n  \n      return result;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nDelegatingNode {\n  GetAttributesResults getAttributes() override {\n      return delegate->getAttributes();\n    }\n}"
  },
  {
    "function_name": "lookup",
    "container": "DelegatingNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "47-49",
    "snippet": "kj::Maybe<LookupResults> lookup(kj::StringPtr name) override {\n    return delegate->lookup(name);\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "delegate->lookup",
          "args": [
            "name"
          ],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "lookup",
          "container": "SimpleDataNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
          "lines": "550-552",
          "snippet": "kj::Maybe<LookupResults> lookup(kj::StringPtr name) override {\n    return nullptr;\n  }",
          "includes": [
            "#include \"util.h\"",
            "#include \"fuse.h\"",
            "#include <stdlib.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/serialize.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include \"union-fs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nSimpleDataNode {\n  kj::Maybe<LookupResults> lookup(kj::StringPtr name) override {\n      return nullptr;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nDelegatingNode {\n  kj::Maybe<LookupResults> lookup(kj::StringPtr name) override {\n      return delegate->lookup(name);\n    }\n}"
  },
  {
    "function_name": "addRef",
    "container": "DelegatingNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "42-44",
    "snippet": "kj::Own<fuse::Node> addRef() override {\n    return kj::addRef(*this);\n  }",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::addRef",
          "args": [
            "*this"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nDelegatingNode {\n  kj::Own<fuse::Node> addRef() override {\n      return kj::addRef(*this);\n    }\n}"
  },
  {
    "function_name": "DelegatingNode",
    "container": "DelegatingNode",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/union-fs.c++",
    "lines": "40-40",
    "snippet": "explicit DelegatingNode(kj::Own<fuse::Node>&& delegate): delegate(kj::mv(delegate)) {}",
    "includes": [
      "#include \"util.h\"",
      "#include \"fuse.h\"",
      "#include <stdlib.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/serialize.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include \"union-fs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "delegate"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"fuse.h\"\n#include <stdlib.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <set>\n#include <map>\n#include <capnp/serialize.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include \"union-fs.h\"\n\nDelegatingNode {\n  explicit DelegatingNode(kj::Own<fuse::Node>&& delegate): delegate(kj::mv(delegate)) {}\n}"
  }
]