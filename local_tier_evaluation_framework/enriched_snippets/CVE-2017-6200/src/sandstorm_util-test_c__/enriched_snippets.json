[
  {
    "function_name": "hasSubstring",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/util-test.c++",
    "lines": "119-128",
    "snippet": "bool hasSubstring(kj::StringPtr haystack, kj::StringPtr needle) {\n  if (needle.size() <= haystack.size()) {\n    for (size_t i = 0; i <= haystack.size() - needle.size(); i++) {\n      if (haystack.slice(i).startsWith(needle)) {\n        return true;\n      }\n    }\n  }\n  return false;\n}",
    "includes": [
      "#include <kj/async-io.h>",
      "#include <sys/wait.h>",
      "#include <kj/test.h>",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "haystack.slice",
          "args": [
            "needle"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "haystack.slice",
          "args": [
            "i"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "needle.size",
          "args": [],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "StructyMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/util.h",
          "lines": "139-139",
          "snippet": "size_t size() { return pos - bytes; }",
          "includes": [
            "#include <set>",
            "#include <sandstorm/util.capnp.h>",
            "#include <capnp/rpc-twoparty.h>",
            "#include <kj/async.h>",
            "#include <kj/function.h>",
            "#include <unistd.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <fcntl.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <kj/one-of.h>",
            "#include <kj/io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <set>\n#include <sandstorm/util.capnp.h>\n#include <capnp/rpc-twoparty.h>\n#include <kj/async.h>\n#include <kj/function.h>\n#include <unistd.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <fcntl.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <kj/one-of.h>\n#include <kj/io.h>\n\nStructyMessage {\n  size_t size() { return pos - bytes; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/async-io.h>\n#include <sys/wait.h>\n#include <kj/test.h>\n#include \"util.h\"\n\nbool hasSubstring(kj::StringPtr haystack, kj::StringPtr needle) {\n  if (needle.size() <= haystack.size()) {\n    for (size_t i = 0; i <= haystack.size() - needle.size(); i++) {\n      if (haystack.slice(i).startsWith(needle)) {\n        return true;\n      }\n    }\n  }\n  return false;\n}"
  },
  {
    "function_name": "makePipe",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6200/repo/src/sandstorm/util-test.c++",
    "lines": "113-117",
    "snippet": "Pipe makePipe() {\n  int fds[2];\n  KJ_SYSCALL(pipe2(fds, O_CLOEXEC));\n  return { kj::AutoCloseFd(fds[0]), kj::AutoCloseFd(fds[1]) };\n}",
    "includes": [
      "#include <kj/async-io.h>",
      "#include <sys/wait.h>",
      "#include <kj/test.h>",
      "#include \"util.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::AutoCloseFd",
          "args": [
            "fds[1]"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::AutoCloseFd",
          "args": [
            "fds[0]"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_SYSCALL",
          "args": [
            "pipe2(fds, O_CLOEXEC)"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pipe2",
          "args": [
            "fds",
            "O_CLOEXEC"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/async-io.h>\n#include <sys/wait.h>\n#include <kj/test.h>\n#include \"util.h\"\n\nPipe makePipe() {\n  int fds[2];\n  KJ_SYSCALL(pipe2(fds, O_CLOEXEC));\n  return { kj::AutoCloseFd(fds[0]), kj::AutoCloseFd(fds[1]) };\n}"
  }
]