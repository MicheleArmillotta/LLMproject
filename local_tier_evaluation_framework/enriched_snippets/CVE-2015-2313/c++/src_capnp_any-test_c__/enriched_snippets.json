[
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any-test.c++",
    "lines": "229-262",
    "snippet": "TEST(Any, AnyStructListCapInSchema) {\n  MallocMessageBuilder builder;\n  auto root = builder.getRoot<test::TestAnyOthers>();\n\n  {\n    initTestMessage(root.initAnyStructFieldAs<TestAllTypes>());\n    AnyStruct::Builder anyStruct = root.getAnyStructField();\n    checkTestMessage(anyStruct.as<TestAllTypes>());\n    checkTestMessage(anyStruct.asReader().as<TestAllTypes>());\n  }\n\n  {\n    List<int>::Builder list = root.initAnyListFieldAs<List<int>>(3);\n    list.set(0, 123);\n    list.set(1, 456);\n    list.set(2, 789);\n\n    AnyList::Builder anyList = root.getAnyListField();\n    checkList(anyList.as<List<int>>(), {123, 456, 789});\n  }\n\n  {\n    kj::EventLoop loop;\n    kj::WaitScope waitScope(loop);\n    int callCount = 0;\n    root.setCapabilityField(kj::heap<TestInterfaceImpl>(callCount));\n    Capability::Client client = root.getCapabilityField();\n    auto req = client.castAs<test::TestInterface>().fooRequest();\n    req.setI(123);\n    req.setJ(true);\n    req.send().wait(waitScope);\n    EXPECT_EQ(1, callCount);\n  }\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include \"message.h\"",
      "#include \"any.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "1",
            "callCount"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "req.send",
          "args": [
            "waitScope"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "send",
          "container": "RpcRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1329-1364",
          "snippet": "RemotePromise<AnyPointer> send() override {\n      if (!connectionState->connection.is<Connected>()) {\n        // Connection is broken.\n        const kj::Exception& e = connectionState->connection.get<Disconnected>();\n        return RemotePromise<AnyPointer>(\n            kj::Promise<Response<AnyPointer>>(kj::cp(e)),\n            AnyPointer::Pipeline(newBrokenPipeline(kj::cp(e))));\n      }\n\n      KJ_IF_MAYBE(redirect, target->writeTarget(callBuilder.getTarget())) {\n        // Whoops, this capability has been redirected while we were building the request!\n        // We'll have to make a new request and do a copy.  Ick.\n\n        auto replacement = redirect->get()->newCall(\n            callBuilder.getInterfaceId(), callBuilder.getMethodId(), paramsBuilder.targetSize());\n        replacement.set(paramsBuilder);\n        return replacement.send();\n      } else {\n        auto sendResult = sendInternal(false);\n\n        auto forkedPromise = sendResult.promise.fork();\n\n        // The pipeline must get notified of resolution before the app does to maintain ordering.\n        auto pipeline = kj::refcounted<RpcPipeline>(\n            *connectionState, kj::mv(sendResult.questionRef), forkedPromise.addBranch());\n\n        auto appPromise = forkedPromise.addBranch().then(\n            [=](kj::Own<RpcResponse>&& response) {\n              auto reader = response->getResults();\n              return Response<AnyPointer>(reader, kj::mv(response));\n            });\n\n        return RemotePromise<AnyPointer>(\n            kj::mv(appPromise),\n            AnyPointer::Pipeline(kj::mv(pipeline)));\n      }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "kj::Maybe<kj::Own<IncomingRpcMessage>> request;",
            "kj::Maybe<kj::Own<RpcServerResponse>> response;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nkj::Maybe<kj::Own<IncomingRpcMessage>> request;\nkj::Maybe<kj::Own<RpcServerResponse>> response;\n\nRpcRequest {\n  RemotePromise<AnyPointer> send() override {\n        if (!connectionState->connection.is<Connected>()) {\n          // Connection is broken.\n          const kj::Exception& e = connectionState->connection.get<Disconnected>();\n          return RemotePromise<AnyPointer>(\n              kj::Promise<Response<AnyPointer>>(kj::cp(e)),\n              AnyPointer::Pipeline(newBrokenPipeline(kj::cp(e))));\n        }\n  \n        KJ_IF_MAYBE(redirect, target->writeTarget(callBuilder.getTarget())) {\n          // Whoops, this capability has been redirected while we were building the request!\n          // We'll have to make a new request and do a copy.  Ick.\n  \n          auto replacement = redirect->get()->newCall(\n              callBuilder.getInterfaceId(), callBuilder.getMethodId(), paramsBuilder.targetSize());\n          replacement.set(paramsBuilder);\n          return replacement.send();\n        } else {\n          auto sendResult = sendInternal(false);\n  \n          auto forkedPromise = sendResult.promise.fork();\n  \n          // The pipeline must get notified of resolution before the app does to maintain ordering.\n          auto pipeline = kj::refcounted<RpcPipeline>(\n              *connectionState, kj::mv(sendResult.questionRef), forkedPromise.addBranch());\n  \n          auto appPromise = forkedPromise.addBranch().then(\n              [=](kj::Own<RpcResponse>&& response) {\n                auto reader = response->getResults();\n                return Response<AnyPointer>(reader, kj::mv(response));\n              });\n  \n          return RemotePromise<AnyPointer>(\n              kj::mv(appPromise),\n              AnyPointer::Pipeline(kj::mv(pipeline)));\n        }\n}"
        }
      },
      {
        "call_info": {
          "callee": "req.send",
          "args": [],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "send",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc-twoparty.c++",
          "lines": "83-95",
          "snippet": "void send() override {\n    network.previousWrite = KJ_ASSERT_NONNULL(network.previousWrite, \"already shut down\")\n        .then([&]() {\n      // Note that if the write fails, all further writes will be skipped due to the exception.\n      // We never actually handle this exception because we assume the read end will fail as well\n      // and it's cleaner to handle the failure there.\n      return writeMessage(network.stream, message);\n    }).attach(kj::addRef(*this))\n      // Note that it's important that the eagerlyEvaluate() come *after* the attach() because\n      // otherwise the message (and any capabilities in it) will not be released until a new\n      // message is written! (Kenton once spent all afternoon tracking this down...)\n      .eagerlyEvaluate(nullptr);\n  }",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"serialize-async.h\"",
            "#include \"rpc-twoparty.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"serialize-async.h\"\n#include \"rpc-twoparty.h\"\n\nvoid send() override {\n    network.previousWrite = KJ_ASSERT_NONNULL(network.previousWrite, \"already shut down\")\n        .then([&]() {\n      // Note that if the write fails, all further writes will be skipped due to the exception.\n      // We never actually handle this exception because we assume the read end will fail as well\n      // and it's cleaner to handle the failure there.\n      return writeMessage(network.stream, message);\n    }).attach(kj::addRef(*this))\n      // Note that it's important that the eagerlyEvaluate() come *after* the attach() because\n      // otherwise the message (and any capabilities in it) will not be released until a new\n      // message is written! (Kenton once spent all afternoon tracking this down...)\n      .eagerlyEvaluate(nullptr);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "req.setJ",
          "args": [
            "true"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "req.setI",
          "args": [
            "123"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "client.castAs<test::TestInterface>",
          "args": [],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "client.castAs<test::TestInterface>",
          "args": [],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getCapabilityField",
          "args": [],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.setCapabilityField",
          "args": [
            "kj::heap<TestInterfaceImpl>(callCount)"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::heap<TestInterfaceImpl>",
          "args": [
            "callCount"
          ],
          "line": 254
        },
        "resolved": true,
        "details": {
          "function_name": "heap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/memory.h",
          "lines": "331-339",
          "snippet": "Own<Decay<T>> heap(T&& orig) {\n  // Allocate a copy (or move) of the argument on the heap.\n  //\n  // The purpose of this overload is to allow you to omit the template parameter as there is only\n  // one argument and the purpose is to copy it.\n\n  typedef Decay<T> T2;\n  return Own<T2>(new T2(kj::fwd<T>(orig)), _::HeapDisposer<T2>::instance);\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nOwn<Decay<T>> heap(T&& orig) {\n  // Allocate a copy (or move) of the argument on the heap.\n  //\n  // The purpose of this overload is to allow you to omit the template parameter as there is only\n  // one argument and the purpose is to copy it.\n\n  typedef Decay<T> T2;\n  return Own<T2>(new T2(kj::fwd<T>(orig)), _::HeapDisposer<T2>::instance);\n}"
        }
      },
      {
        "call_info": {
          "callee": "checkList",
          "args": [
            "anyList.as<List<int>>()",
            "{123, 456, 789}"
          ],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "checkList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic-test.c++",
          "lines": "33-45",
          "snippet": "void checkList(T reader, std::initializer_list<ReaderFor<Element>> expected) {\n  auto list = reader.template as<DynamicList>();\n  ASSERT_EQ(expected.size(), list.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], list[i].template as<Element>());\n  }\n\n  auto typed = reader.template as<List<Element>>();\n  ASSERT_EQ(expected.size(), typed.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], typed[i]);\n  }\n}",
          "includes": [
            "#include \"test-util.h\"",
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"dynamic.h\"\n\nvoid checkList(T reader, std::initializer_list<ReaderFor<Element>> expected) {\n  auto list = reader.template as<DynamicList>();\n  ASSERT_EQ(expected.size(), list.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], list[i].template as<Element>());\n  }\n\n  auto typed = reader.template as<List<Element>>();\n  ASSERT_EQ(expected.size(), typed.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], typed[i]);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "anyList.as<List<int>>",
          "args": [],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyListField",
          "args": [],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list.set",
          "args": [
            "2",
            "789"
          ],
          "line": 244
        },
        "resolved": true,
        "details": {
          "function_name": "set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "872-874",
          "snippet": "static inline void set(PointerBuilder builder, AnyList::Reader value) {\n    builder.setList(value._reader);\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline void set(PointerBuilder builder, AnyList::Reader value) {\n    builder.setList(value._reader);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "root.initAnyListFieldAs<List<int>>",
          "args": [
            "3"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "anyStruct.asReader().as<TestAllTypes>()"
          ],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "anyStruct.asReader",
          "args": [],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      },
      {
        "call_info": {
          "callee": "anyStruct.as<TestAllTypes>",
          "args": [],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "as",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "601-604",
          "snippet": "BuilderFor<T> as() {\n    // T must be List<U>.\n    return BuilderFor<T>(_builder);\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nBuilderFor<T> as() {\n    // T must be List<U>.\n    return BuilderFor<T>(_builder);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "root.getAnyStructField",
          "args": [],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "root.initAnyStructFieldAs<TestAllTypes>()"
          ],
          "line": 234
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "root.initAnyStructFieldAs<TestAllTypes>",
          "args": [],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getRoot<test::TestAnyOthers>",
          "args": [],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "getRoot",
          "container": "RpcRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1322-1324",
          "snippet": "inline AnyPointer::Builder getRoot() {\n      return paramsBuilder;\n    }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nRpcRequest {\n  inline AnyPointer::Builder getRoot() {\n        return paramsBuilder;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include \"message.h\"\n#include \"any.h\"\n\nTEST(Any, AnyStructListCapInSchema) {\n  MallocMessageBuilder builder;\n  auto root = builder.getRoot<test::TestAnyOthers>();\n\n  {\n    initTestMessage(root.initAnyStructFieldAs<TestAllTypes>());\n    AnyStruct::Builder anyStruct = root.getAnyStructField();\n    checkTestMessage(anyStruct.as<TestAllTypes>());\n    checkTestMessage(anyStruct.asReader().as<TestAllTypes>());\n  }\n\n  {\n    List<int>::Builder list = root.initAnyListFieldAs<List<int>>(3);\n    list.set(0, 123);\n    list.set(1, 456);\n    list.set(2, 789);\n\n    AnyList::Builder anyList = root.getAnyListField();\n    checkList(anyList.as<List<int>>(), {123, 456, 789});\n  }\n\n  {\n    kj::EventLoop loop;\n    kj::WaitScope waitScope(loop);\n    int callCount = 0;\n    root.setCapabilityField(kj::heap<TestInterfaceImpl>(callCount));\n    Capability::Client client = root.getCapabilityField();\n    auto req = client.castAs<test::TestInterface>().fooRequest();\n    req.setI(123);\n    req.setJ(true);\n    req.send().wait(waitScope);\n    EXPECT_EQ(1, callCount);\n  }\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any-test.c++",
    "lines": "181-227",
    "snippet": "TEST(Any, AnyList) {\n  MallocMessageBuilder builder;\n  auto root = builder.getRoot<test::TestAnyPointer>();\n  List<TestAllTypes>::Builder b = root.getAnyPointerField().initAs<List<TestAllTypes>>(2);\n  initTestMessage(b[0]);\n\n  auto ptr = root.getAnyPointerField().getAs<AnyList>();\n\n  EXPECT_EQ(2, ptr.size());\n  EXPECT_EQ(48, ptr.as<List<AnyStruct>>()[0].getDataSection().size());\n  EXPECT_EQ(20, ptr.as<List<AnyStruct>>()[0].getPointerSection().size());\n\n  auto readPtr = root.getAnyPointerField().asReader().getAs<AnyList>();\n\n  EXPECT_EQ(2, readPtr.size());\n  EXPECT_EQ(48, readPtr.as<List<AnyStruct>>()[0].getDataSection().size());\n  EXPECT_EQ(20, readPtr.as<List<AnyStruct>>()[0].getPointerSection().size());\n\n  auto alb = toAny(root.getAnyPointerField().getAs<List<TestAllTypes>>());\n  EXPECT_EQ(2, alb.size());\n  EXPECT_EQ(48, alb.as<List<AnyStruct>>()[0].getDataSection().size());\n  EXPECT_EQ(20, alb.as<List<AnyStruct>>()[0].getPointerSection().size());\n\n#if !_MSC_VER  // TODO(msvc): ICE on the necessary constructor; see any.h.\n  alb = root.getAnyPointerField().getAs<List<TestAllTypes>>();\n  EXPECT_EQ(2, alb.size());\n  EXPECT_EQ(48, alb.as<List<AnyStruct>>()[0].getDataSection().size());\n  EXPECT_EQ(20, alb.as<List<AnyStruct>>()[0].getPointerSection().size());\n#endif\n\n  auto alr = toAny(root.getAnyPointerField().getAs<List<TestAllTypes>>().asReader());\n  EXPECT_EQ(2, alr.size());\n  EXPECT_EQ(48, alr.as<List<AnyStruct>>()[0].getDataSection().size());\n  EXPECT_EQ(20, alr.as<List<AnyStruct>>()[0].getPointerSection().size());\n\n  alr = toAny(root.getAnyPointerField().getAs<List<TestAllTypes>>()).asReader();\n  EXPECT_EQ(2, alr.size());\n  EXPECT_EQ(48, alr.as<List<AnyStruct>>()[0].getDataSection().size());\n  EXPECT_EQ(20, alr.as<List<AnyStruct>>()[0].getPointerSection().size());\n\n#if !_MSC_VER  // TODO(msvc): ICE on the necessary constructor; see any.h.\n  alr = root.getAnyPointerField().getAs<List<TestAllTypes>>().asReader();\n  EXPECT_EQ(2, alr.size());\n  EXPECT_EQ(48, alr.as<List<AnyStruct>>()[0].getDataSection().size());\n  EXPECT_EQ(20, alr.as<List<AnyStruct>>()[0].getPointerSection().size());\n#endif\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include \"message.h\"",
      "#include \"any.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "20",
            "alr.as<List<AnyStruct>>()[0].getPointerSection().size()"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alr.as<List<AnyStruct>>",
          "args": [],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alr.as<List<AnyStruct>>",
          "args": [],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alr.as<List<AnyStruct>>",
          "args": [],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "48",
            "alr.as<List<AnyStruct>>()[0].getDataSection().size()"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alr.as<List<AnyStruct>>",
          "args": [],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alr.as<List<AnyStruct>>",
          "args": [],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alr.as<List<AnyStruct>>",
          "args": [],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "2",
            "alr.size()"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alr.size",
          "args": [],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "599-599",
          "snippet": "inline uint size() { return _builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline uint size() { return _builder.size() / ELEMENTS; }"
        }
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "20",
            "alr.as<List<AnyStruct>>()[0].getPointerSection().size()"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alr.as<List<AnyStruct>>",
          "args": [],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alr.as<List<AnyStruct>>",
          "args": [],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alr.as<List<AnyStruct>>",
          "args": [],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "48",
            "alr.as<List<AnyStruct>>()[0].getDataSection().size()"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alr.as<List<AnyStruct>>",
          "args": [],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alr.as<List<AnyStruct>>",
          "args": [],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alr.as<List<AnyStruct>>",
          "args": [],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "2",
            "alr.size()"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "toAny",
          "args": [],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "toAny",
          "args": [
            "root.getAnyPointerField().getAs<List<TestAllTypes>>()"
          ],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "toAny",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "350-353",
          "snippet": "inline BuilderFor<AnyTypeFor<FromBuilder<T>>> toAny(T&& value) {\n  return BuilderFor<AnyTypeFor<FromBuilder<T>>>(\n      _::PointerHelpers<FromBuilder<T>>::getInternalBuilder(kj::mv(value)));\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline BuilderFor<AnyTypeFor<FromBuilder<T>>> toAny(T&& value) {\n  return BuilderFor<AnyTypeFor<FromBuilder<T>>>(\n      _::PointerHelpers<FromBuilder<T>>::getInternalBuilder(kj::mv(value)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "20",
            "alr.as<List<AnyStruct>>()[0].getPointerSection().size()"
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alr.as<List<AnyStruct>>",
          "args": [],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alr.as<List<AnyStruct>>",
          "args": [],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alr.as<List<AnyStruct>>",
          "args": [],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "48",
            "alr.as<List<AnyStruct>>()[0].getDataSection().size()"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alr.as<List<AnyStruct>>",
          "args": [],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alr.as<List<AnyStruct>>",
          "args": [],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alr.as<List<AnyStruct>>",
          "args": [],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "2",
            "alr.size()"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "20",
            "alb.as<List<AnyStruct>>()[0].getPointerSection().size()"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alb.as<List<AnyStruct>>",
          "args": [],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alb.as<List<AnyStruct>>",
          "args": [],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alb.as<List<AnyStruct>>",
          "args": [],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "48",
            "alb.as<List<AnyStruct>>()[0].getDataSection().size()"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alb.as<List<AnyStruct>>",
          "args": [],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alb.as<List<AnyStruct>>",
          "args": [],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alb.as<List<AnyStruct>>",
          "args": [],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "2",
            "alb.size()"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "20",
            "alb.as<List<AnyStruct>>()[0].getPointerSection().size()"
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alb.as<List<AnyStruct>>",
          "args": [],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alb.as<List<AnyStruct>>",
          "args": [],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alb.as<List<AnyStruct>>",
          "args": [],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "48",
            "alb.as<List<AnyStruct>>()[0].getDataSection().size()"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alb.as<List<AnyStruct>>",
          "args": [],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alb.as<List<AnyStruct>>",
          "args": [],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alb.as<List<AnyStruct>>",
          "args": [],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "2",
            "alb.size()"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "20",
            "readPtr.as<List<AnyStruct>>()[0].getPointerSection().size()"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "readPtr.as<List<AnyStruct>>",
          "args": [],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "readPtr.as<List<AnyStruct>>",
          "args": [],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "readPtr.as<List<AnyStruct>>",
          "args": [],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "48",
            "readPtr.as<List<AnyStruct>>()[0].getDataSection().size()"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "readPtr.as<List<AnyStruct>>",
          "args": [],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "readPtr.as<List<AnyStruct>>",
          "args": [],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "readPtr.as<List<AnyStruct>>",
          "args": [],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "2",
            "readPtr.size()"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "20",
            "ptr.as<List<AnyStruct>>()[0].getPointerSection().size()"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ptr.as<List<AnyStruct>>",
          "args": [],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ptr.as<List<AnyStruct>>",
          "args": [],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ptr.as<List<AnyStruct>>",
          "args": [],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "48",
            "ptr.as<List<AnyStruct>>()[0].getDataSection().size()"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ptr.as<List<AnyStruct>>",
          "args": [],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ptr.as<List<AnyStruct>>",
          "args": [],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ptr.as<List<AnyStruct>>",
          "args": [],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "2",
            "ptr.size()"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "b[0]"
          ],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [
            "2"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getRoot<test::TestAnyPointer>",
          "args": [],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "getRoot",
          "container": "RpcRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1322-1324",
          "snippet": "inline AnyPointer::Builder getRoot() {\n      return paramsBuilder;\n    }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nRpcRequest {\n  inline AnyPointer::Builder getRoot() {\n        return paramsBuilder;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include \"message.h\"\n#include \"any.h\"\n\nTEST(Any, AnyList) {\n  MallocMessageBuilder builder;\n  auto root = builder.getRoot<test::TestAnyPointer>();\n  List<TestAllTypes>::Builder b = root.getAnyPointerField().initAs<List<TestAllTypes>>(2);\n  initTestMessage(b[0]);\n\n  auto ptr = root.getAnyPointerField().getAs<AnyList>();\n\n  EXPECT_EQ(2, ptr.size());\n  EXPECT_EQ(48, ptr.as<List<AnyStruct>>()[0].getDataSection().size());\n  EXPECT_EQ(20, ptr.as<List<AnyStruct>>()[0].getPointerSection().size());\n\n  auto readPtr = root.getAnyPointerField().asReader().getAs<AnyList>();\n\n  EXPECT_EQ(2, readPtr.size());\n  EXPECT_EQ(48, readPtr.as<List<AnyStruct>>()[0].getDataSection().size());\n  EXPECT_EQ(20, readPtr.as<List<AnyStruct>>()[0].getPointerSection().size());\n\n  auto alb = toAny(root.getAnyPointerField().getAs<List<TestAllTypes>>());\n  EXPECT_EQ(2, alb.size());\n  EXPECT_EQ(48, alb.as<List<AnyStruct>>()[0].getDataSection().size());\n  EXPECT_EQ(20, alb.as<List<AnyStruct>>()[0].getPointerSection().size());\n\n#if !_MSC_VER  // TODO(msvc): ICE on the necessary constructor; see any.h.\n  alb = root.getAnyPointerField().getAs<List<TestAllTypes>>();\n  EXPECT_EQ(2, alb.size());\n  EXPECT_EQ(48, alb.as<List<AnyStruct>>()[0].getDataSection().size());\n  EXPECT_EQ(20, alb.as<List<AnyStruct>>()[0].getPointerSection().size());\n#endif\n\n  auto alr = toAny(root.getAnyPointerField().getAs<List<TestAllTypes>>().asReader());\n  EXPECT_EQ(2, alr.size());\n  EXPECT_EQ(48, alr.as<List<AnyStruct>>()[0].getDataSection().size());\n  EXPECT_EQ(20, alr.as<List<AnyStruct>>()[0].getPointerSection().size());\n\n  alr = toAny(root.getAnyPointerField().getAs<List<TestAllTypes>>()).asReader();\n  EXPECT_EQ(2, alr.size());\n  EXPECT_EQ(48, alr.as<List<AnyStruct>>()[0].getDataSection().size());\n  EXPECT_EQ(20, alr.as<List<AnyStruct>>()[0].getPointerSection().size());\n\n#if !_MSC_VER  // TODO(msvc): ICE on the necessary constructor; see any.h.\n  alr = root.getAnyPointerField().getAs<List<TestAllTypes>>().asReader();\n  EXPECT_EQ(2, alr.size());\n  EXPECT_EQ(48, alr.as<List<AnyStruct>>()[0].getDataSection().size());\n  EXPECT_EQ(20, alr.as<List<AnyStruct>>()[0].getPointerSection().size());\n#endif\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any-test.c++",
    "lines": "109-179",
    "snippet": "TEST(Any, AnyStruct) {\n  MallocMessageBuilder builder;\n  auto root = builder.getRoot<test::TestAnyPointer>();\n\n  initTestMessage(root.getAnyPointerField().initAs<TestAllTypes>());\n  checkTestMessage(root.getAnyPointerField().getAs<TestAllTypes>());\n  checkTestMessage(root.asReader().getAnyPointerField().getAs<TestAllTypes>());\n\n  auto allTypes = root.getAnyPointerField().getAs<AnyStruct>().as<TestAllTypes>();\n  auto allTypesReader = root.getAnyPointerField().getAs<AnyStruct>().asReader().as<TestAllTypes>();\n  allTypes.setInt32Field(100);\n  EXPECT_EQ(100, allTypes.getInt32Field());\n  EXPECT_EQ(100, allTypesReader.getInt32Field());\n\n  EXPECT_EQ(48, root.getAnyPointerField().getAs<AnyStruct>().getDataSection().size());\n  EXPECT_EQ(20, root.getAnyPointerField().getAs<AnyStruct>().getPointerSection().size());\n\n  EXPECT_EQ(48, root.getAnyPointerField().asReader().getAs<AnyStruct>().getDataSection().size());\n  EXPECT_EQ(20, root.getAnyPointerField().asReader().getAs<AnyStruct>().getPointerSection().size());\n\n  auto b = toAny(root.getAnyPointerField().getAs<TestAllTypes>());\n  EXPECT_EQ(48, b.getDataSection().size());\n  EXPECT_EQ(20, b.getPointerSection().size());\n\n#if !_MSC_VER  // TODO(msvc): ICE on the necessary constructor; see any.h.\n  b = root.getAnyPointerField().getAs<TestAllTypes>();\n  EXPECT_EQ(48, b.getDataSection().size());\n  EXPECT_EQ(20, b.getPointerSection().size());\n#endif\n\n  auto r = toAny(root.getAnyPointerField().getAs<TestAllTypes>().asReader());\n  EXPECT_EQ(48, r.getDataSection().size());\n  EXPECT_EQ(20, r.getPointerSection().size());\n\n  r = toAny(root.getAnyPointerField().getAs<TestAllTypes>()).asReader();\n  EXPECT_EQ(48, r.getDataSection().size());\n  EXPECT_EQ(20, r.getPointerSection().size());\n\n#if !_MSC_VER  // TODO(msvc): ICE on the necessary constructor; see any.h.\n  r = root.getAnyPointerField().getAs<TestAllTypes>().asReader();\n  EXPECT_EQ(48, r.getDataSection().size());\n  EXPECT_EQ(20, r.getPointerSection().size());\n#endif\n\n  {\n    MallocMessageBuilder b2;\n    auto root2 = b2.getRoot<test::TestAnyPointer>();\n    auto sb = root2.getAnyPointerField().initAsAnyStruct(\n        r.getDataSection().size() / 8, r.getPointerSection().size());\n\n    EXPECT_EQ(48, sb.getDataSection().size());\n    EXPECT_EQ(20, sb.getPointerSection().size());\n\n    // TODO: is there a higher-level API for this?\n    memcpy(sb.getDataSection().begin(), r.getDataSection().begin(), r.getDataSection().size());\n  }\n\n  {\n    auto ptrs = r.getPointerSection();\n    EXPECT_EQ(\"foo\", ptrs[0].getAs<Text>());\n    EXPECT_EQ(\"bar\", kj::heapString(ptrs[1].getAs<Data>().asChars()));\n    EXPECT_EQ(\"xyzzy\", ptrs[15].getAs<List<Text>>()[1]);\n  }\n\n  {\n    auto ptrs = b.getPointerSection();\n    EXPECT_EQ(\"foo\", ptrs[0].getAs<Text>());\n    EXPECT_EQ(\"bar\", kj::heapString(ptrs[1].getAs<Data>().asChars()));\n    EXPECT_EQ(\"xyzzy\", ptrs[15].getAs<List<Text>>()[1]);\n  }\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include \"message.h\"",
      "#include \"any.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"xyzzy\"",
            "ptrs[15].getAs<List<Text>>()[1]"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ptrs[15].getAs<List<Text>>",
          "args": [],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"bar\"",
            "kj::heapString(ptrs[1].getAs<Data>().asChars())"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::heapString",
          "args": [
            "ptrs[1].getAs<Data>().asChars()"
          ],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "heapString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.c++",
          "lines": "36-40",
          "snippet": "String heapString(size_t size) {\n  char* buffer = _::HeapArrayDisposer::allocate<char>(size + 1);\n  buffer[size] = '\\0';\n  return String(buffer, size, _::HeapArrayDisposer::instance);\n}",
          "includes": [
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <float.h>",
            "#include <stdio.h>",
            "#include \"debug.h\"",
            "#include \"string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdlib.h>\n#include <errno.h>\n#include <float.h>\n#include <stdio.h>\n#include \"debug.h\"\n#include \"string.h\"\n\nString heapString(size_t size) {\n  char* buffer = _::HeapArrayDisposer::allocate<char>(size + 1);\n  buffer[size] = '\\0';\n  return String(buffer, size, _::HeapArrayDisposer::instance);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ptrs[1].getAs<Data>",
          "args": [],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ptrs[1].getAs<Data>",
          "args": [],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "ptrs[0].getAs<Text>()"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ptrs[0].getAs<Text>",
          "args": [],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "b.getPointerSection",
          "args": [],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "getPointerSection",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "465-467",
          "snippet": "List<AnyPointer>::Builder getPointerSection() {\n    return List<AnyPointer>::Builder(_builder.getPointerSectionAsList());\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nList<AnyPointer>::Builder getPointerSection() {\n    return List<AnyPointer>::Builder(_builder.getPointerSectionAsList());\n  }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"xyzzy\"",
            "ptrs[15].getAs<List<Text>>()[1]"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ptrs[15].getAs<List<Text>>",
          "args": [],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"bar\"",
            "kj::heapString(ptrs[1].getAs<Data>().asChars())"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ptrs[1].getAs<Data>",
          "args": [],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ptrs[1].getAs<Data>",
          "args": [],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "ptrs[0].getAs<Text>()"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ptrs[0].getAs<Text>",
          "args": [],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r.getPointerSection",
          "args": [],
          "line": 167
        },
        "resolved": true,
        "details": {
          "function_name": "getPointerSectionSize",
          "container": "StructReader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/layout.h",
          "lines": "491-491",
          "snippet": "inline WirePointerCount getPointerSectionSize() const { return pointerCount; }",
          "includes": [
            "#include \"endian.h\"",
            "#include \"blob.h\"",
            "#include \"common.h\"",
            "#include <kj/memory.h>",
            "#include <kj/common.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"endian.h\"\n#include \"blob.h\"\n#include \"common.h\"\n#include <kj/memory.h>\n#include <kj/common.h>\n\nStructReader {\n  inline WirePointerCount getPointerSectionSize() const { return pointerCount; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "sb.getDataSection().begin()",
            "r.getDataSection().begin()",
            "r.getDataSection().size()"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r.getDataSection",
          "args": [],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "getDataSectionSize",
          "container": "StructReader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/layout.h",
          "lines": "490-490",
          "snippet": "inline BitCount getDataSectionSize() const { return dataSize; }",
          "includes": [
            "#include \"endian.h\"",
            "#include \"blob.h\"",
            "#include \"common.h\"",
            "#include <kj/memory.h>",
            "#include <kj/common.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"endian.h\"\n#include \"blob.h\"\n#include \"common.h\"\n#include <kj/memory.h>\n#include <kj/common.h>\n\nStructReader {\n  inline BitCount getDataSectionSize() const { return dataSize; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "sb.getDataSection",
          "args": [],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "getDataSection",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "462-464",
          "snippet": "inline Data::Builder getDataSection() {\n    return _builder.getDataSectionAsBlob();\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Data::Builder getDataSection() {\n    return _builder.getDataSectionAsBlob();\n  }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "20",
            "sb.getPointerSection().size()"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "48",
            "sb.getDataSection().size()"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root2.getAnyPointerField",
          "args": [
            "r.getDataSection().size() / 8",
            "r.getPointerSection().size()"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root2.getAnyPointerField",
          "args": [],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "b2.getRoot<test::TestAnyPointer>",
          "args": [],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "getRoot",
          "container": "RpcRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1322-1324",
          "snippet": "inline AnyPointer::Builder getRoot() {\n      return paramsBuilder;\n    }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nRpcRequest {\n  inline AnyPointer::Builder getRoot() {\n        return paramsBuilder;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "20",
            "r.getPointerSection().size()"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "48",
            "r.getDataSection().size()"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "20",
            "r.getPointerSection().size()"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "48",
            "r.getDataSection().size()"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "toAny",
          "args": [],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "toAny",
          "args": [
            "root.getAnyPointerField().getAs<TestAllTypes>()"
          ],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "toAny",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "350-353",
          "snippet": "inline BuilderFor<AnyTypeFor<FromBuilder<T>>> toAny(T&& value) {\n  return BuilderFor<AnyTypeFor<FromBuilder<T>>>(\n      _::PointerHelpers<FromBuilder<T>>::getInternalBuilder(kj::mv(value)));\n}",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline BuilderFor<AnyTypeFor<FromBuilder<T>>> toAny(T&& value) {\n  return BuilderFor<AnyTypeFor<FromBuilder<T>>>(\n      _::PointerHelpers<FromBuilder<T>>::getInternalBuilder(kj::mv(value)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "20",
            "r.getPointerSection().size()"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "48",
            "r.getDataSection().size()"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "20",
            "b.getPointerSection().size()"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "48",
            "b.getDataSection().size()"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "20",
            "b.getPointerSection().size()"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "48",
            "b.getDataSection().size()"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "20",
            "root.getAnyPointerField().asReader().getAs<AnyStruct>().getPointerSection().size()"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "48",
            "root.getAnyPointerField().asReader().getAs<AnyStruct>().getDataSection().size()"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "20",
            "root.getAnyPointerField().getAs<AnyStruct>().getPointerSection().size()"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "48",
            "root.getAnyPointerField().getAs<AnyStruct>().getDataSection().size()"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "100",
            "allTypesReader.getInt32Field()"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "allTypesReader.getInt32Field",
          "args": [],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "100",
            "allTypes.getInt32Field()"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "allTypes.getInt32Field",
          "args": [],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "allTypes.setInt32Field",
          "args": [
            "100"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "root.asReader().getAnyPointerField().getAs<TestAllTypes>()"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "root.getAnyPointerField().initAs<TestAllTypes>()"
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include \"message.h\"\n#include \"any.h\"\n\nTEST(Any, AnyStruct) {\n  MallocMessageBuilder builder;\n  auto root = builder.getRoot<test::TestAnyPointer>();\n\n  initTestMessage(root.getAnyPointerField().initAs<TestAllTypes>());\n  checkTestMessage(root.getAnyPointerField().getAs<TestAllTypes>());\n  checkTestMessage(root.asReader().getAnyPointerField().getAs<TestAllTypes>());\n\n  auto allTypes = root.getAnyPointerField().getAs<AnyStruct>().as<TestAllTypes>();\n  auto allTypesReader = root.getAnyPointerField().getAs<AnyStruct>().asReader().as<TestAllTypes>();\n  allTypes.setInt32Field(100);\n  EXPECT_EQ(100, allTypes.getInt32Field());\n  EXPECT_EQ(100, allTypesReader.getInt32Field());\n\n  EXPECT_EQ(48, root.getAnyPointerField().getAs<AnyStruct>().getDataSection().size());\n  EXPECT_EQ(20, root.getAnyPointerField().getAs<AnyStruct>().getPointerSection().size());\n\n  EXPECT_EQ(48, root.getAnyPointerField().asReader().getAs<AnyStruct>().getDataSection().size());\n  EXPECT_EQ(20, root.getAnyPointerField().asReader().getAs<AnyStruct>().getPointerSection().size());\n\n  auto b = toAny(root.getAnyPointerField().getAs<TestAllTypes>());\n  EXPECT_EQ(48, b.getDataSection().size());\n  EXPECT_EQ(20, b.getPointerSection().size());\n\n#if !_MSC_VER  // TODO(msvc): ICE on the necessary constructor; see any.h.\n  b = root.getAnyPointerField().getAs<TestAllTypes>();\n  EXPECT_EQ(48, b.getDataSection().size());\n  EXPECT_EQ(20, b.getPointerSection().size());\n#endif\n\n  auto r = toAny(root.getAnyPointerField().getAs<TestAllTypes>().asReader());\n  EXPECT_EQ(48, r.getDataSection().size());\n  EXPECT_EQ(20, r.getPointerSection().size());\n\n  r = toAny(root.getAnyPointerField().getAs<TestAllTypes>()).asReader();\n  EXPECT_EQ(48, r.getDataSection().size());\n  EXPECT_EQ(20, r.getPointerSection().size());\n\n#if !_MSC_VER  // TODO(msvc): ICE on the necessary constructor; see any.h.\n  r = root.getAnyPointerField().getAs<TestAllTypes>().asReader();\n  EXPECT_EQ(48, r.getDataSection().size());\n  EXPECT_EQ(20, r.getPointerSection().size());\n#endif\n\n  {\n    MallocMessageBuilder b2;\n    auto root2 = b2.getRoot<test::TestAnyPointer>();\n    auto sb = root2.getAnyPointerField().initAsAnyStruct(\n        r.getDataSection().size() / 8, r.getPointerSection().size());\n\n    EXPECT_EQ(48, sb.getDataSection().size());\n    EXPECT_EQ(20, sb.getPointerSection().size());\n\n    // TODO: is there a higher-level API for this?\n    memcpy(sb.getDataSection().begin(), r.getDataSection().begin(), r.getDataSection().size());\n  }\n\n  {\n    auto ptrs = r.getPointerSection();\n    EXPECT_EQ(\"foo\", ptrs[0].getAs<Text>());\n    EXPECT_EQ(\"bar\", kj::heapString(ptrs[1].getAs<Data>().asChars()));\n    EXPECT_EQ(\"xyzzy\", ptrs[15].getAs<List<Text>>()[1]);\n  }\n\n  {\n    auto ptrs = b.getPointerSection();\n    EXPECT_EQ(\"foo\", ptrs[0].getAs<Text>());\n    EXPECT_EQ(\"bar\", kj::heapString(ptrs[1].getAs<Data>().asChars()));\n    EXPECT_EQ(\"xyzzy\", ptrs[15].getAs<List<Text>>()[1]);\n  }\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any-test.c++",
    "lines": "31-107",
    "snippet": "TEST(Any, AnyPointer) {\n  MallocMessageBuilder builder;\n  auto root = builder.getRoot<test::TestAnyPointer>();\n\n  initTestMessage(root.getAnyPointerField().initAs<TestAllTypes>());\n  checkTestMessage(root.getAnyPointerField().getAs<TestAllTypes>());\n  checkTestMessage(root.asReader().getAnyPointerField().getAs<TestAllTypes>());\n\n  root.getAnyPointerField().setAs<Text>(\"foo\");\n  EXPECT_EQ(\"foo\", root.getAnyPointerField().getAs<Text>());\n  EXPECT_EQ(\"foo\", root.asReader().getAnyPointerField().getAs<Text>());\n\n  root.getAnyPointerField().setAs<Data>(data(\"foo\"));\n  EXPECT_EQ(data(\"foo\"), root.getAnyPointerField().getAs<Data>());\n  EXPECT_EQ(data(\"foo\"), root.asReader().getAnyPointerField().getAs<Data>());\n\n  {\n    root.getAnyPointerField().setAs<List<uint32_t>>({123, 456, 789});\n\n    {\n      List<uint32_t>::Builder list = root.getAnyPointerField().getAs<List<uint32_t>>();\n      ASSERT_EQ(3u, list.size());\n      EXPECT_EQ(123u, list[0]);\n      EXPECT_EQ(456u, list[1]);\n      EXPECT_EQ(789u, list[2]);\n    }\n\n    {\n      List<uint32_t>::Reader list = root.asReader().getAnyPointerField().getAs<List<uint32_t>>();\n      ASSERT_EQ(3u, list.size());\n      EXPECT_EQ(123u, list[0]);\n      EXPECT_EQ(456u, list[1]);\n      EXPECT_EQ(789u, list[2]);\n    }\n  }\n\n  {\n    root.getAnyPointerField().setAs<List<Text>>({\"foo\", \"bar\"});\n\n    {\n      List<Text>::Builder list = root.getAnyPointerField().getAs<List<Text>>();\n      ASSERT_EQ(2u, list.size());\n      EXPECT_EQ(\"foo\", list[0]);\n      EXPECT_EQ(\"bar\", list[1]);\n    }\n\n    {\n      List<Text>::Reader list = root.asReader().getAnyPointerField().getAs<List<Text>>();\n      ASSERT_EQ(2u, list.size());\n      EXPECT_EQ(\"foo\", list[0]);\n      EXPECT_EQ(\"bar\", list[1]);\n    }\n  }\n\n  {\n    {\n      List<TestAllTypes>::Builder list = root.getAnyPointerField().initAs<List<TestAllTypes>>(2);\n      ASSERT_EQ(2u, list.size());\n      initTestMessage(list[0]);\n    }\n\n    {\n      List<TestAllTypes>::Builder list = root.getAnyPointerField().getAs<List<TestAllTypes>>();\n      ASSERT_EQ(2u, list.size());\n      checkTestMessage(list[0]);\n      checkTestMessageAllZero(list[1]);\n    }\n\n    {\n      List<TestAllTypes>::Reader list =\n          root.asReader().getAnyPointerField().getAs<List<TestAllTypes>>();\n      ASSERT_EQ(2u, list.size());\n      checkTestMessage(list[0]);\n      checkTestMessageAllZero(list[1]);\n    }\n  }\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include \"message.h\"",
      "#include \"any.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkTestMessageAllZero",
          "args": [
            "list[1]"
          ],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessageAllZero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "849-851",
          "snippet": "void checkTestMessageAllZero(TestAllTypes::Reader reader) {\n  genericCheckTestMessageAllZero(reader);\n}",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessageAllZero(TestAllTypes::Reader reader) {\n  genericCheckTestMessageAllZero(reader);\n}"
        }
      },
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "list[0]"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "2u",
            "list.size()"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list.size",
          "args": [],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "599-599",
          "snippet": "inline uint size() { return _builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline uint size() { return _builder.size() / ELEMENTS; }"
        }
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "2u",
            "list.size()"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "list[0]"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "2u",
            "list.size()"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [
            "2"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"bar\"",
            "list[1]"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "list[0]"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "2u",
            "list.size()"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"bar\"",
            "list[1]"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "list[0]"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "2u",
            "list.size()"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [
            "{\"foo\", \"bar\"}"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "789u",
            "list[2]"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "456u",
            "list[1]"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "123u",
            "list[0]"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "3u",
            "list.size()"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "789u",
            "list[2]"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "456u",
            "list[1]"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "123u",
            "list[0]"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "3u",
            "list.size()"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [
            "{123, 456, 789}"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "data(\"foo\")",
            "root.asReader().getAnyPointerField().getAs<Data>()"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "data",
          "args": [
            "\"foo\""
          ],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "dataEquals",
          "container": "TestOutputStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-test.c++",
          "lines": "278-281",
          "snippet": "bool dataEquals(kj::ArrayPtr<const word> other) {\n    return data ==\n        std::string(other.asChars().begin(), other.asChars().size());\n  }",
          "includes": [
            "#include \"test-util.h\"",
            "#include <fcntl.h>",
            "#include <stdlib.h>",
            "#include <string>",
            "#include <kj/miniposix.h>",
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"test-util.h\"\n#include <fcntl.h>\n#include <stdlib.h>\n#include <string>\n#include <kj/miniposix.h>\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n\nTestOutputStream {\n  bool dataEquals(kj::ArrayPtr<const word> other) {\n      return data ==\n          std::string(other.asChars().begin(), other.asChars().size());\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "data(\"foo\")",
            "root.getAnyPointerField().getAs<Data>()"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [
            "data(\"foo\")"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "root.asReader().getAnyPointerField().getAs<Text>()"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "root.getAnyPointerField().getAs<Text>()"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [
            "\"foo\""
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getRoot<test::TestAnyPointer>",
          "args": [],
          "line": 33
        },
        "resolved": true,
        "details": {
          "function_name": "getRoot",
          "container": "RpcRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1322-1324",
          "snippet": "inline AnyPointer::Builder getRoot() {\n      return paramsBuilder;\n    }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nRpcRequest {\n  inline AnyPointer::Builder getRoot() {\n        return paramsBuilder;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include \"message.h\"\n#include \"any.h\"\n\nTEST(Any, AnyPointer) {\n  MallocMessageBuilder builder;\n  auto root = builder.getRoot<test::TestAnyPointer>();\n\n  initTestMessage(root.getAnyPointerField().initAs<TestAllTypes>());\n  checkTestMessage(root.getAnyPointerField().getAs<TestAllTypes>());\n  checkTestMessage(root.asReader().getAnyPointerField().getAs<TestAllTypes>());\n\n  root.getAnyPointerField().setAs<Text>(\"foo\");\n  EXPECT_EQ(\"foo\", root.getAnyPointerField().getAs<Text>());\n  EXPECT_EQ(\"foo\", root.asReader().getAnyPointerField().getAs<Text>());\n\n  root.getAnyPointerField().setAs<Data>(data(\"foo\"));\n  EXPECT_EQ(data(\"foo\"), root.getAnyPointerField().getAs<Data>());\n  EXPECT_EQ(data(\"foo\"), root.asReader().getAnyPointerField().getAs<Data>());\n\n  {\n    root.getAnyPointerField().setAs<List<uint32_t>>({123, 456, 789});\n\n    {\n      List<uint32_t>::Builder list = root.getAnyPointerField().getAs<List<uint32_t>>();\n      ASSERT_EQ(3u, list.size());\n      EXPECT_EQ(123u, list[0]);\n      EXPECT_EQ(456u, list[1]);\n      EXPECT_EQ(789u, list[2]);\n    }\n\n    {\n      List<uint32_t>::Reader list = root.asReader().getAnyPointerField().getAs<List<uint32_t>>();\n      ASSERT_EQ(3u, list.size());\n      EXPECT_EQ(123u, list[0]);\n      EXPECT_EQ(456u, list[1]);\n      EXPECT_EQ(789u, list[2]);\n    }\n  }\n\n  {\n    root.getAnyPointerField().setAs<List<Text>>({\"foo\", \"bar\"});\n\n    {\n      List<Text>::Builder list = root.getAnyPointerField().getAs<List<Text>>();\n      ASSERT_EQ(2u, list.size());\n      EXPECT_EQ(\"foo\", list[0]);\n      EXPECT_EQ(\"bar\", list[1]);\n    }\n\n    {\n      List<Text>::Reader list = root.asReader().getAnyPointerField().getAs<List<Text>>();\n      ASSERT_EQ(2u, list.size());\n      EXPECT_EQ(\"foo\", list[0]);\n      EXPECT_EQ(\"bar\", list[1]);\n    }\n  }\n\n  {\n    {\n      List<TestAllTypes>::Builder list = root.getAnyPointerField().initAs<List<TestAllTypes>>(2);\n      ASSERT_EQ(2u, list.size());\n      initTestMessage(list[0]);\n    }\n\n    {\n      List<TestAllTypes>::Builder list = root.getAnyPointerField().getAs<List<TestAllTypes>>();\n      ASSERT_EQ(2u, list.size());\n      checkTestMessage(list[0]);\n      checkTestMessageAllZero(list[1]);\n    }\n\n    {\n      List<TestAllTypes>::Reader list =\n          root.asReader().getAnyPointerField().getAs<List<TestAllTypes>>();\n      ASSERT_EQ(2u, list.size());\n      checkTestMessage(list[0]);\n      checkTestMessageAllZero(list[1]);\n    }\n  }\n}"
  }
]