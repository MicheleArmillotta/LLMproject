[
  {
    "function_name": "strTree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
    "lines": "206-208",
    "snippet": "StringTree strTree(Params&&... params) {\n  return StringTree::concat(_::toStringTreeOrCharSequence(kj::fwd<Params>(params))...);\n}",
    "includes": [
      "#include \"string.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "StringTree::concat",
          "args": [
            "_::toStringTreeOrCharSequence(kj::fwd<Params>(params))..."
          ],
          "line": 207
        },
        "resolved": true,
        "details": {
          "function_name": "concat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "245-247",
          "snippet": "inline String concat(String&& arr) {\n  return kj::mv(arr);\n}",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\ninline String concat(String&& arr) {\n  return kj::mv(arr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "_::toStringTreeOrCharSequence",
          "args": [
            "kj::fwd<Params>(params)"
          ],
          "line": 207
        },
        "resolved": true,
        "details": {
          "function_name": "toStringTreeOrCharSequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
          "lines": "135-142",
          "snippet": "inline auto toStringTreeOrCharSequence(T&& value)\n    -> decltype(toCharSequence(kj::fwd<T>(value))) {\n  static_assert(!isStringTree<Decay<T>>(),\n      \"When passing a StringTree into kj::strTree(), either pass it by rvalue \"\n      \"(use kj::mv(value)) or explicitly call value.flatten() to make a copy.\");\n\n  return toCharSequence(kj::fwd<T>(value));\n}",
          "includes": [
            "#include \"string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"string.h\"\n\ninline auto toStringTreeOrCharSequence(T&& value)\n    -> decltype(toCharSequence(kj::fwd<T>(value))) {\n  static_assert(!isStringTree<Decay<T>>(),\n      \"When passing a StringTree into kj::strTree(), either pass it by rvalue \"\n      \"(use kj::mv(value)) or explicitly call value.flatten() to make a copy.\");\n\n  return toCharSequence(kj::fwd<T>(value));\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::fwd<Params>",
          "args": [
            "params"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"string.h\"\n\nStringTree strTree(Params&&... params) {\n  return StringTree::concat(_::toStringTreeOrCharSequence(kj::fwd<Params>(params))...);\n}"
  },
  {
    "function_name": "StringTree::concat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
    "lines": "194-203",
    "snippet": "StringTree StringTree::concat(Params&&... params) {\n  StringTree result;\n  result.size_ = _::sum({params.size()...});\n  result.text = heapString(\n      _::sum({StringTree::flatSize(kj::fwd<Params>(params))...}));\n  result.branches = heapArray<StringTree::Branch>(\n      _::sum({StringTree::branchCount(kj::fwd<Params>(params))...}));\n  result.fill(result.text.begin(), 0, kj::fwd<Params>(params)...);\n  return result;\n}",
    "includes": [
      "#include \"string.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "result.fill",
          "args": [
            "result.text.begin()",
            "0",
            "kj::fwd<Params>(params)..."
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::fwd<Params>",
          "args": [
            "params"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result.text.begin",
          "args": [],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "Repeat",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "692-692",
          "snippet": "inline Iterator begin() const { return Iterator(value, 0); }",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\nRepeat {\n  inline Iterator begin() const { return Iterator(value, 0); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "heapArray<StringTree::Branch>",
          "args": [
            "_::sum({StringTree::branchCount(kj::fwd<Params>(params))...})"
          ],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "heapArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "696-698",
          "snippet": "inline Array<T> heapArray(std::initializer_list<T> init) {\n  return heapArray<T>(init.begin(), init.end());\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\ninline Array<T> heapArray(std::initializer_list<T> init) {\n  return heapArray<T>(init.begin(), init.end());\n}"
        }
      },
      {
        "call_info": {
          "callee": "_::sum",
          "args": [
            "{StringTree::branchCount(kj::fwd<Params>(params))...}"
          ],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "sum",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "209-215",
          "snippet": "inline size_t sum(std::initializer_list<size_t> nums) {\n  size_t result = 0;\n  for (auto num: nums) {\n    result += num;\n  }\n  return result;\n}",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\ninline size_t sum(std::initializer_list<size_t> nums) {\n  size_t result = 0;\n  for (auto num: nums) {\n    result += num;\n  }\n  return result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "StringTree::branchCount",
          "args": [
            "kj::fwd<Params>(params)"
          ],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "branchCount",
          "container": "StringTree",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
          "lines": "98-98",
          "snippet": "static inline size_t branchCount(StringTree&& s) { return 1; }",
          "includes": [
            "#include \"string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"string.h\"\n\nStringTree {\n  static inline size_t branchCount(StringTree&& s) { return 1; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::fwd<Params>",
          "args": [
            "params"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "heapString",
          "args": [
            "_::sum({StringTree::flatSize(kj::fwd<Params>(params))...})"
          ],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "heapString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.c++",
          "lines": "36-40",
          "snippet": "String heapString(size_t size) {\n  char* buffer = _::HeapArrayDisposer::allocate<char>(size + 1);\n  buffer[size] = '\\0';\n  return String(buffer, size, _::HeapArrayDisposer::instance);\n}",
          "includes": [
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <float.h>",
            "#include <stdio.h>",
            "#include \"debug.h\"",
            "#include \"string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdlib.h>\n#include <errno.h>\n#include <float.h>\n#include <stdio.h>\n#include \"debug.h\"\n#include \"string.h\"\n\nString heapString(size_t size) {\n  char* buffer = _::HeapArrayDisposer::allocate<char>(size + 1);\n  buffer[size] = '\\0';\n  return String(buffer, size, _::HeapArrayDisposer::instance);\n}"
        }
      },
      {
        "call_info": {
          "callee": "StringTree::flatSize",
          "args": [
            "kj::fwd<Params>(params)"
          ],
          "line": 198
        },
        "resolved": true,
        "details": {
          "function_name": "flatSize",
          "container": "StringTree",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
          "lines": "93-93",
          "snippet": "static inline size_t flatSize(StringTree&& s) { return 0; }",
          "includes": [
            "#include \"string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"string.h\"\n\nStringTree {\n  static inline size_t flatSize(StringTree&& s) { return 0; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::fwd<Params>",
          "args": [
            "params"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "params.size",
          "args": [],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "StringTree",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
          "lines": "55-55",
          "snippet": "inline size_t size() const { return size_; }",
          "includes": [
            "#include \"string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"string.h\"\n\nStringTree {\n  inline size_t size() const { return size_; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"string.h\"\n\nStringTree StringTree::concat(Params&&... params) {\n  StringTree result;\n  result.size_ = _::sum({params.size()...});\n  result.text = heapString(\n      _::sum({StringTree::flatSize(kj::fwd<Params>(params))...}));\n  result.branches = heapArray<StringTree::Branch>(\n      _::sum({StringTree::branchCount(kj::fwd<Params>(params))...}));\n  result.fill(result.text.begin(), 0, kj::fwd<Params>(params)...);\n  return result;\n}"
  },
  {
    "function_name": "StringTree::fill",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
    "lines": "187-191",
    "snippet": "void StringTree::fill(char* pos, size_t branchIndex, String&& first, Rest&&... rest) {\n  branches[branchIndex].index = pos - text.begin();\n  branches[branchIndex].content = StringTree(kj::mv(first));\n  fill(pos, branchIndex + 1, kj::fwd<Rest>(rest)...);\n}",
    "includes": [
      "#include \"string.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::fwd<Rest>",
          "args": [
            "rest"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "StringTree",
          "args": [
            "kj::mv(first)"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "branchCount",
          "container": "StringTree",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
          "lines": "98-98",
          "snippet": "static inline size_t branchCount(StringTree&& s) { return 1; }",
          "includes": [
            "#include \"string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"string.h\"\n\nStringTree {\n  static inline size_t branchCount(StringTree&& s) { return 1; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "first"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "text.begin",
          "args": [],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "Repeat",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "692-692",
          "snippet": "inline Iterator begin() const { return Iterator(value, 0); }",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\nRepeat {\n  inline Iterator begin() const { return Iterator(value, 0); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"string.h\"\n\nvoid StringTree::fill(char* pos, size_t branchIndex, String&& first, Rest&&... rest) {\n  branches[branchIndex].index = pos - text.begin();\n  branches[branchIndex].content = StringTree(kj::mv(first));\n  fill(pos, branchIndex + 1, kj::fwd<Rest>(rest)...);\n}"
  },
  {
    "function_name": "StringTree::fill",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
    "lines": "180-184",
    "snippet": "void StringTree::fill(char* pos, size_t branchIndex, StringTree&& first, Rest&&... rest) {\n  branches[branchIndex].index = pos - text.begin();\n  branches[branchIndex].content = kj::mv(first);\n  fill(pos, branchIndex + 1, kj::fwd<Rest>(rest)...);\n}",
    "includes": [
      "#include \"string.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::fwd<Rest>",
          "args": [
            "rest"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "first"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "text.begin",
          "args": [],
          "line": 181
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "Repeat",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "692-692",
          "snippet": "inline Iterator begin() const { return Iterator(value, 0); }",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\nRepeat {\n  inline Iterator begin() const { return Iterator(value, 0); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"string.h\"\n\nvoid StringTree::fill(char* pos, size_t branchIndex, StringTree&& first, Rest&&... rest) {\n  branches[branchIndex].index = pos - text.begin();\n  branches[branchIndex].content = kj::mv(first);\n  fill(pos, branchIndex + 1, kj::fwd<Rest>(rest)...);\n}"
  },
  {
    "function_name": "StringTree::fill",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
    "lines": "174-177",
    "snippet": "void StringTree::fill(char* pos, size_t branchIndex, First&& first, Rest&&... rest) {\n  pos = _::fill(pos, kj::fwd<First>(first));\n  fill(pos, branchIndex, kj::fwd<Rest>(rest)...);\n}",
    "includes": [
      "#include \"string.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::fwd<Rest>",
          "args": [
            "rest"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_::fill",
          "args": [
            "pos",
            "kj::fwd<First>(first)"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::fwd<First>",
          "args": [
            "first"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"string.h\"\n\nvoid StringTree::fill(char* pos, size_t branchIndex, First&& first, Rest&&... rest) {\n  pos = _::fill(pos, kj::fwd<First>(first));\n  fill(pos, branchIndex, kj::fwd<Rest>(rest)...);\n}"
  },
  {
    "function_name": "StringTree::fill",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
    "lines": "168-171",
    "snippet": "inline void StringTree::fill(char* pos, size_t branchIndex) {\n  KJ_IREQUIRE(pos == text.end() && branchIndex == branches.size(),\n              kj::str(text.end() - pos, ' ', branches.size() - branchIndex).cStr());\n}",
    "includes": [
      "#include \"string.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "KJ_IREQUIRE",
          "args": [
            "pos == text.end() && branchIndex == branches.size()",
            "kj::str(text.end() - pos, ' ', branches.size() - branchIndex).cStr()"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "331-339",
          "snippet": "String str(Params&&... params) {\n  // Magic function which builds a string from a bunch of arbitrary values.  Example:\n  //     str(1, \" / \", 2, \" = \", 0.5)\n  // returns:\n  //     \"1 / 2 = 0.5\"\n  // To teach `str` how to stringify a type, see `Stringifier`.\n\n  return _::concat(toCharSequence(kj::fwd<Params>(params))...);\n}",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\nString str(Params&&... params) {\n  // Magic function which builds a string from a bunch of arbitrary values.  Example:\n  //     str(1, \" / \", 2, \" = \", 0.5)\n  // returns:\n  //     \"1 / 2 = 0.5\"\n  // To teach `str` how to stringify a type, see `Stringifier`.\n\n  return _::concat(toCharSequence(kj::fwd<Params>(params))...);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "text.end() - pos",
            "' '",
            "branches.size() - branchIndex"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "branches.size",
          "args": [],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "StringTree",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
          "lines": "55-55",
          "snippet": "inline size_t size() const { return size_; }",
          "includes": [
            "#include \"string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"string.h\"\n\nStringTree {\n  inline size_t size() const { return size_; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "text.end",
          "args": [],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "Repeat",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "693-693",
          "snippet": "inline Iterator end() const { return Iterator(value, count); }",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\nRepeat {\n  inline Iterator end() const { return Iterator(value, count); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"string.h\"\n\ninline void StringTree::fill(char* pos, size_t branchIndex) {\n  KJ_IREQUIRE(pos == text.end() && branchIndex == branches.size(),\n              kj::str(text.end() - pos, ' ', branches.size() - branchIndex).cStr());\n}"
  },
  {
    "function_name": "StringTree::visit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
    "lines": "154-166",
    "snippet": "void StringTree::visit(Func&& func) const {\n  size_t pos = 0;\n  for (auto& branch: branches) {\n    if (branch.index > pos) {\n      func(text.slice(pos, branch.index));\n      pos = branch.index;\n    }\n    branch.content.visit(func);\n  }\n  if (text.size() > pos) {\n    func(text.slice(pos, text.size()));\n  }\n}",
    "includes": [
      "#include \"string.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "func",
          "args": [
            "text.slice(pos, text.size())"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "text.slice",
          "args": [
            "pos",
            "text.size()"
          ],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "slice",
          "container": "ArrayPtr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "1154-1157",
          "snippet": "inline ArrayPtr slice(size_t start, size_t end) {\n    KJ_IREQUIRE(start <= end && end <= size_, \"Out-of-bounds ArrayPtr::slice().\");\n    return ArrayPtr(ptr + start, end - start);\n  }",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\nArrayPtr {\n  inline ArrayPtr slice(size_t start, size_t end) {\n      KJ_IREQUIRE(start <= end && end <= size_, \"Out-of-bounds ArrayPtr::slice().\");\n      return ArrayPtr(ptr + start, end - start);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "text.size",
          "args": [],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "StringTree",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
          "lines": "55-55",
          "snippet": "inline size_t size() const { return size_; }",
          "includes": [
            "#include \"string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"string.h\"\n\nStringTree {\n  inline size_t size() const { return size_; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "branch.content.visit",
          "args": [
            "func"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "func",
          "args": [
            "text.slice(pos, branch.index)"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"string.h\"\n\nvoid StringTree::visit(Func&& func) const {\n  size_t pos = 0;\n  for (auto& branch: branches) {\n    if (branch.index > pos) {\n      func(text.slice(pos, branch.index));\n      pos = branch.index;\n    }\n    branch.content.visit(func);\n  }\n  if (text.size() > pos) {\n    func(text.slice(pos, text.size()));\n  }\n}"
  },
  {
    "function_name": "toStringTreeOrCharSequence",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
    "lines": "135-142",
    "snippet": "inline auto toStringTreeOrCharSequence(T&& value)\n    -> decltype(toCharSequence(kj::fwd<T>(value))) {\n  static_assert(!isStringTree<Decay<T>>(),\n      \"When passing a StringTree into kj::strTree(), either pass it by rvalue \"\n      \"(use kj::mv(value)) or explicitly call value.flatten() to make a copy.\");\n\n  return toCharSequence(kj::fwd<T>(value));\n}",
    "includes": [
      "#include \"string.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "toCharSequence",
          "args": [
            "kj::fwd<T>(value)"
          ],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "toCharSequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "312-322",
          "snippet": "auto toCharSequence(T&& value) -> decltype(_::STR * kj::fwd<T>(value)) {\n  // Returns an iterable of chars that represent a textual representation of the value, suitable\n  // for debugging.\n  //\n  // Most users should use str() instead, but toCharSequence() may occasionally be useful to avoid\n  // heap allocation overhead that str() implies.\n  //\n  // To specialize this function for your type, see KJ_STRINGIFY.\n\n  return _::STR * kj::fwd<T>(value);\n}",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\nauto toCharSequence(T&& value) -> decltype(_::STR * kj::fwd<T>(value)) {\n  // Returns an iterable of chars that represent a textual representation of the value, suitable\n  // for debugging.\n  //\n  // Most users should use str() instead, but toCharSequence() may occasionally be useful to avoid\n  // heap allocation overhead that str() implies.\n  //\n  // To specialize this function for your type, see KJ_STRINGIFY.\n\n  return _::STR * kj::fwd<T>(value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::fwd<T>",
          "args": [
            "value"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isStringTree<Decay<T>>",
          "args": [],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::fwd<T>",
          "args": [
            "value"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"string.h\"\n\ninline auto toStringTreeOrCharSequence(T&& value)\n    -> decltype(toCharSequence(kj::fwd<T>(value))) {\n  static_assert(!isStringTree<Decay<T>>(),\n      \"When passing a StringTree into kj::strTree(), either pass it by rvalue \"\n      \"(use kj::mv(value)) or explicitly call value.flatten() to make a copy.\");\n\n  return toCharSequence(kj::fwd<T>(value));\n}"
  },
  {
    "function_name": "toStringTreeOrCharSequence",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
    "lines": "132-132",
    "snippet": "inline StringTree toStringTreeOrCharSequence(String&& str) { return StringTree(kj::mv(str)); }",
    "includes": [
      "#include \"string.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "StringTree",
          "args": [
            "kj::mv(str)"
          ],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "branchCount",
          "container": "StringTree",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
          "lines": "98-98",
          "snippet": "static inline size_t branchCount(StringTree&& s) { return 1; }",
          "includes": [
            "#include \"string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"string.h\"\n\nStringTree {\n  static inline size_t branchCount(StringTree&& s) { return 1; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "str"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"string.h\"\n\ninline StringTree toStringTreeOrCharSequence(String&& str) { return StringTree(kj::mv(str)); }"
  },
  {
    "function_name": "isStringTree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
    "lines": "128-128",
    "snippet": "constexpr bool isStringTree() { return false; }",
    "includes": [
      "#include \"string.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"string.h\"\n\nconstexpr bool isStringTree() { return false; }"
  },
  {
    "function_name": "KJ_STRINGIFY",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
    "lines": "107-107",
    "snippet": "inline StringTree KJ_STRINGIFY(Array<StringTree>&& trees) { return StringTree(kj::mv(trees), \"\"); }",
    "includes": [
      "#include \"string.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "StringTree",
          "args": [
            "kj::mv(trees)",
            "\"\""
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "StringTree::StringTree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.c++",
          "lines": "26-48",
          "snippet": "StringTree::StringTree(Array<StringTree>&& pieces, StringPtr delim)\n    : size_(0),\n      branches(heapArray<Branch>(pieces.size())) {\n  if (pieces.size() > 0) {\n    if (pieces.size() > 1 && delim.size() > 0) {\n      text = heapString((pieces.size() - 1) * delim.size());\n      size_ = text.size();\n    }\n\n    branches[0].index = 0;\n    branches[0].content = kj::mv(pieces[0]);\n    size_ += pieces[0].size();\n\n    for (uint i = 1; i < pieces.size(); i++) {\n      if (delim.size() > 0) {\n        memcpy(text.begin() + (i - 1) * delim.size(), delim.begin(), delim.size());\n      }\n      branches[i].index = i * delim.size();\n      branches[i].content = kj::mv(pieces[i]);\n      size_ += pieces[i].size();\n    }\n  }\n}",
          "includes": [
            "#include \"string-tree.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"string-tree.h\"\n\nStringTree::StringTree(Array<StringTree>&& pieces, StringPtr delim)\n    : size_(0),\n      branches(heapArray<Branch>(pieces.size())) {\n  if (pieces.size() > 0) {\n    if (pieces.size() > 1 && delim.size() > 0) {\n      text = heapString((pieces.size() - 1) * delim.size());\n      size_ = text.size();\n    }\n\n    branches[0].index = 0;\n    branches[0].content = kj::mv(pieces[0]);\n    size_ += pieces[0].size();\n\n    for (uint i = 1; i < pieces.size(); i++) {\n      if (delim.size() > 0) {\n        memcpy(text.begin() + (i - 1) * delim.size(), delim.begin(), delim.size());\n      }\n      branches[i].index = i * delim.size();\n      branches[i].content = kj::mv(pieces[i]);\n      size_ += pieces[i].size();\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "trees"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"string.h\"\n\ninline StringTree KJ_STRINGIFY(Array<StringTree>&& trees) { return StringTree(kj::mv(trees), \"\"); }"
  },
  {
    "function_name": "branchCount",
    "container": "StringTree",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
    "lines": "98-98",
    "snippet": "static inline size_t branchCount(StringTree&& s) { return 1; }",
    "includes": [
      "#include \"string.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"string.h\"\n\nStringTree {\n  static inline size_t branchCount(StringTree&& s) { return 1; }\n}"
  },
  {
    "function_name": "branchCount",
    "container": "StringTree",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
    "lines": "97-97",
    "snippet": "static inline size_t branchCount(String&& s) { return 1; }",
    "includes": [
      "#include \"string.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"string.h\"\n\nStringTree {\n  static inline size_t branchCount(String&& s) { return 1; }\n}"
  },
  {
    "function_name": "branchCount",
    "container": "StringTree",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
    "lines": "96-96",
    "snippet": "static inline size_t branchCount(const T& t) { return 0; }",
    "includes": [
      "#include \"string.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"string.h\"\n\nStringTree {\n  static inline size_t branchCount(const T& t) { return 0; }\n}"
  },
  {
    "function_name": "flatSize",
    "container": "StringTree",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
    "lines": "93-93",
    "snippet": "static inline size_t flatSize(StringTree&& s) { return 0; }",
    "includes": [
      "#include \"string.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"string.h\"\n\nStringTree {\n  static inline size_t flatSize(StringTree&& s) { return 0; }\n}"
  },
  {
    "function_name": "flatSize",
    "container": "StringTree",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
    "lines": "92-92",
    "snippet": "static inline size_t flatSize(String&& s) { return 0; }",
    "includes": [
      "#include \"string.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"string.h\"\n\nStringTree {\n  static inline size_t flatSize(String&& s) { return 0; }\n}"
  },
  {
    "function_name": "flatSize",
    "container": "StringTree",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
    "lines": "91-91",
    "snippet": "static inline size_t flatSize(const T& t) { return t.size(); }",
    "includes": [
      "#include \"string.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "t.size",
          "args": [],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "StringTree",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
          "lines": "55-55",
          "snippet": "inline size_t size() const { return size_; }",
          "includes": [
            "#include \"string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"string.h\"\n\nStringTree {\n  inline size_t size() const { return size_; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"string.h\"\n\nStringTree {\n  static inline size_t flatSize(const T& t) { return t.size(); }\n}"
  },
  {
    "function_name": "size",
    "container": "StringTree",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
    "lines": "55-55",
    "snippet": "inline size_t size() const { return size_; }",
    "includes": [
      "#include \"string.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"string.h\"\n\nStringTree {\n  inline size_t size() const { return size_; }\n}"
  },
  {
    "function_name": "StringTree",
    "container": "StringTree",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
    "lines": "49-49",
    "snippet": "inline StringTree(String&& text): size_(text.size()), text(kj::mv(text)) {}",
    "includes": [
      "#include \"string.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "text"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "text.size",
          "args": [],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "StringTree",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
          "lines": "55-55",
          "snippet": "inline size_t size() const { return size_; }",
          "includes": [
            "#include \"string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"string.h\"\n\nStringTree {\n  inline size_t size() const { return size_; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"string.h\"\n\nStringTree {\n  inline StringTree(String&& text): size_(text.size()), text(kj::mv(text)) {}\n}"
  },
  {
    "function_name": "StringTree",
    "container": "StringTree",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
    "lines": "48-48",
    "snippet": "inline StringTree(): size_(0) {}",
    "includes": [
      "#include \"string.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"string.h\"\n\nStringTree {\n  inline StringTree(): size_(0) {}\n}"
  }
]