[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/protobuf-catrank.c++",
    "lines": "126-130",
    "snippet": "int main(int argc, char* argv[]) {\n  return capnp::benchmark::benchmarkMain<\n      capnp::benchmark::protobuf::BenchmarkTypes,\n      capnp::benchmark::protobuf::CatRankTestCase>(argc, argv);\n}",
    "includes": [
      "#include \"protobuf-common.h\"",
      "#include \"catrank.pb.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "capnp::benchmark::benchmarkMain<\n      capnp::benchmark::protobuf::BenchmarkTypes,\n      capnp::benchmark::protobuf::CatRankTestCase>",
          "args": [
            "argc",
            "argv"
          ],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "benchmarkMain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/common.h",
          "lines": "281-292",
          "snippet": "int benchmarkMain(int argc, char* argv[]) {\n  if (argc != 5) {\n    fprintf(stderr, \"USAGE:  %s MODE REUSE COMPRESSION ITERATION_COUNT\\n\", argv[0]);\n    return 1;\n  }\n\n  uint64_t iters = strtoull(argv[4], nullptr, 0);\n  uint64_t throughput = doBenchmark3<BenchmarkTypes, TestCase>(argv[1], argv[2], argv[3], iters);\n  fprintf(stdout, \"%llu\\n\", (long long unsigned int)throughput);\n\n  return 0;\n}",
          "includes": [
            "#include <vector>",
            "#include <string>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdexcept>",
            "#include <algorithm>",
            "#include <semaphore.h>",
            "#include <stdlib.h>",
            "#include <sys/wait.h>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include <errno.h>",
            "#include <limits>",
            "#include <unistd.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <stdio.h>\n#include <stdexcept>\n#include <algorithm>\n#include <semaphore.h>\n#include <stdlib.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include <errno.h>\n#include <limits>\n#include <unistd.h>\n\nint benchmarkMain(int argc, char* argv[]) {\n  if (argc != 5) {\n    fprintf(stderr, \"USAGE:  %s MODE REUSE COMPRESSION ITERATION_COUNT\\n\", argv[0]);\n    return 1;\n  }\n\n  uint64_t iters = strtoull(argv[4], nullptr, 0);\n  uint64_t throughput = doBenchmark3<BenchmarkTypes, TestCase>(argv[1], argv[2], argv[3], iters);\n  fprintf(stdout, \"%llu\\n\", (long long unsigned int)throughput);\n\n  return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"protobuf-common.h\"\n#include \"catrank.pb.h\"\n\nint main(int argc, char* argv[]) {\n  return capnp::benchmark::benchmarkMain<\n      capnp::benchmark::protobuf::BenchmarkTypes,\n      capnp::benchmark::protobuf::CatRankTestCase>(argc, argv);\n}"
  },
  {
    "function_name": "checkResponse",
    "container": "CatRankTestCase",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/protobuf-catrank.c++",
    "lines": "108-119",
    "snippet": "static bool checkResponse(const SearchResultList& response, int expectedGoodCount) {\n    int goodCount = 0;\n    for (auto& result: response.result()) {\n      if (result.score() > 1001) {\n        ++goodCount;\n      } else {\n        break;\n      }\n    }\n\n    return goodCount == expectedGoodCount;\n  }",
    "includes": [
      "#include \"protobuf-common.h\"",
      "#include \"catrank.pb.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "result.score",
          "args": [],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "response.result",
          "args": [],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"protobuf-common.h\"\n#include \"catrank.pb.h\"\n\nCatRankTestCase {\n  static bool checkResponse(const SearchResultList& response, int expectedGoodCount) {\n      int goodCount = 0;\n      for (auto& result: response.result()) {\n        if (result.score() > 1001) {\n          ++goodCount;\n        } else {\n          break;\n        }\n      }\n  \n      return goodCount == expectedGoodCount;\n    }\n}"
  },
  {
    "function_name": "handleRequest",
    "container": "CatRankTestCase",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/protobuf-catrank.c++",
    "lines": "84-106",
    "snippet": "static void handleRequest(const SearchResultList& request, SearchResultList* response) {\n    std::vector<ScoredResult> scoredResults;\n\n    for (auto& result: request.result()) {\n      double score = result.score();\n      if (result.snippet().find(\" cat \") != std::string::npos) {\n        score *= 10000;\n      }\n      if (result.snippet().find(\" dog \") != std::string::npos) {\n        score /= 10000;\n      }\n      scoredResults.emplace_back(score, &result);\n    }\n\n    std::sort(scoredResults.begin(), scoredResults.end());\n\n    for (auto& result: scoredResults) {\n      SearchResult* out = response->add_result();\n      out->set_score(result.score);\n      out->set_url(result.result->url());\n      out->set_snippet(result.result->snippet());\n    }\n  }",
    "includes": [
      "#include \"protobuf-common.h\"",
      "#include \"catrank.pb.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "out->set_snippet",
          "args": [
            "result.result->snippet()"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result.result->snippet",
          "args": [],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "out->set_url",
          "args": [
            "result.result->url()"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result.result->url",
          "args": [],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "out->set_score",
          "args": [
            "result.score"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "response->add_result",
          "args": [],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::sort",
          "args": [
            "scoredResults.begin()",
            "scoredResults.end()"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scoredResults.end",
          "args": [],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "551-551",
          "snippet": "inline Iterator end() { return Iterator(this, size()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Iterator end() { return Iterator(this, size()); }"
        }
      },
      {
        "call_info": {
          "callee": "scoredResults.begin",
          "args": [],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "550-550",
          "snippet": "inline Iterator begin() { return Iterator(this, 0); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Iterator begin() { return Iterator(this, 0); }"
        }
      },
      {
        "call_info": {
          "callee": "scoredResults.emplace_back",
          "args": [
            "score",
            "&result"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result.snippet",
          "args": [
            "\" dog \""
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result.snippet",
          "args": [],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result.snippet",
          "args": [
            "\" cat \""
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result.snippet",
          "args": [],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result.score",
          "args": [],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request.result",
          "args": [],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"protobuf-common.h\"\n#include \"catrank.pb.h\"\n\nCatRankTestCase {\n  static void handleRequest(const SearchResultList& request, SearchResultList* response) {\n      std::vector<ScoredResult> scoredResults;\n  \n      for (auto& result: request.result()) {\n        double score = result.score();\n        if (result.snippet().find(\" cat \") != std::string::npos) {\n          score *= 10000;\n        }\n        if (result.snippet().find(\" dog \") != std::string::npos) {\n          score /= 10000;\n        }\n        scoredResults.emplace_back(score, &result);\n      }\n  \n      std::sort(scoredResults.begin(), scoredResults.end());\n  \n      for (auto& result: scoredResults) {\n        SearchResult* out = response->add_result();\n        out->set_score(result.score);\n        out->set_url(result.result->url());\n        out->set_snippet(result.result->snippet());\n      }\n    }\n}"
  },
  {
    "function_name": "setupRequest",
    "container": "CatRankTestCase",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/protobuf-catrank.c++",
    "lines": "45-82",
    "snippet": "static int setupRequest(SearchResultList* request) {\n    int count = fastRand(1000);\n    int goodCount = 0;\n\n    for (int i = 0; i < count; i++) {\n      SearchResult* result = request->add_result();\n      result->set_score(1000 - i);\n      result->set_url(\"http://example.com/\");\n      std::string* url = result->mutable_url();\n      int urlSize = fastRand(100);\n      for (int j = 0; j < urlSize; j++) {\n        url->push_back('a' + fastRand(26));\n      }\n\n      bool isCat = fastRand(8) == 0;\n      bool isDog = fastRand(8) == 0;\n      goodCount += isCat && !isDog;\n\n      std::string* snippet = result->mutable_snippet();\n      snippet->reserve(7 * 22);\n      snippet->push_back(' ');\n\n      int prefix = fastRand(20);\n      for (int j = 0; j < prefix; j++) {\n        snippet->append(WORDS[fastRand(WORDS_COUNT)]);\n      }\n\n      if (isCat) snippet->append(\"cat \");\n      if (isDog) snippet->append(\"dog \");\n\n      int suffix = fastRand(20);\n      for (int j = 0; j < suffix; j++) {\n        snippet->append(WORDS[fastRand(WORDS_COUNT)]);\n      }\n    }\n\n    return goodCount;\n  }",
    "includes": [
      "#include \"protobuf-common.h\"",
      "#include \"catrank.pb.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snippet->append",
          "args": [
            "WORDS[fastRand(WORDS_COUNT)]"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fastRand",
          "args": [
            "WORDS_COUNT"
          ],
          "line": 77
        },
        "resolved": true,
        "details": {
          "function_name": "fastRand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/common.h",
          "lines": "64-66",
          "snippet": "static inline uint32_t fastRand(uint32_t range) {\n  return nextFastRand() % range;\n}",
          "includes": [
            "#include <vector>",
            "#include <string>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdexcept>",
            "#include <algorithm>",
            "#include <semaphore.h>",
            "#include <stdlib.h>",
            "#include <sys/wait.h>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include <errno.h>",
            "#include <limits>",
            "#include <unistd.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <stdio.h>\n#include <stdexcept>\n#include <algorithm>\n#include <semaphore.h>\n#include <stdlib.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include <errno.h>\n#include <limits>\n#include <unistd.h>\n\nstatic inline uint32_t fastRand(uint32_t range) {\n  return nextFastRand() % range;\n}"
        }
      },
      {
        "call_info": {
          "callee": "snippet->append",
          "args": [
            "\"dog \""
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snippet->append",
          "args": [
            "\"cat \""
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snippet->append",
          "args": [
            "WORDS[fastRand(WORDS_COUNT)]"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snippet->push_back",
          "args": [
            "' '"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snippet->reserve",
          "args": [
            "7 * 22"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result->mutable_snippet",
          "args": [],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "url->push_back",
          "args": [
            "'a' + fastRand(26)"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result->mutable_url",
          "args": [],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result->set_url",
          "args": [
            "\"http://example.com/\""
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result->set_score",
          "args": [
            "1000 - i"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request->add_result",
          "args": [],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"protobuf-common.h\"\n#include \"catrank.pb.h\"\n\nCatRankTestCase {\n  static int setupRequest(SearchResultList* request) {\n      int count = fastRand(1000);\n      int goodCount = 0;\n  \n      for (int i = 0; i < count; i++) {\n        SearchResult* result = request->add_result();\n        result->set_score(1000 - i);\n        result->set_url(\"http://example.com/\");\n        std::string* url = result->mutable_url();\n        int urlSize = fastRand(100);\n        for (int j = 0; j < urlSize; j++) {\n          url->push_back('a' + fastRand(26));\n        }\n  \n        bool isCat = fastRand(8) == 0;\n        bool isDog = fastRand(8) == 0;\n        goodCount += isCat && !isDog;\n  \n        std::string* snippet = result->mutable_snippet();\n        snippet->reserve(7 * 22);\n        snippet->push_back(' ');\n  \n        int prefix = fastRand(20);\n        for (int j = 0; j < prefix; j++) {\n          snippet->append(WORDS[fastRand(WORDS_COUNT)]);\n        }\n  \n        if (isCat) snippet->append(\"cat \");\n        if (isDog) snippet->append(\"dog \");\n  \n        int suffix = fastRand(20);\n        for (int j = 0; j < suffix; j++) {\n          snippet->append(WORDS[fastRand(WORDS_COUNT)]);\n        }\n      }\n  \n      return goodCount;\n    }\n}"
  },
  {
    "function_name": "ScoredResult",
    "container": "ScoredResult",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/protobuf-catrank.c++",
    "lines": "34-34",
    "snippet": "ScoredResult(double score, const SearchResult* result): score(score), result(result) {}",
    "includes": [
      "#include \"protobuf-common.h\"",
      "#include \"catrank.pb.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"protobuf-common.h\"\n#include \"catrank.pb.h\"\n\nScoredResult {\n  ScoredResult(double score, const SearchResult* result): score(score), result(result) {}\n}"
  }
]