[
  {
    "function_name": "Timer::timeoutAfter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/time.h",
    "lines": "111-115",
    "snippet": "Promise<T> Timer::timeoutAfter(Duration delay, Promise<T>&& promise) {\n  return promise.exclusiveJoin(afterDelay(delay).then([]() -> kj::Promise<T> {\n    return makeTimeoutException();\n  }));\n}",
    "includes": [
      "#include <inttypes.h>",
      "#include \"units.h\"",
      "#include \"async.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "promise.exclusiveJoin",
          "args": [
            "afterDelay(delay).then([]() -> kj::Promise<T> {\n    return makeTimeoutException();\n  })"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterDelay",
          "args": [
            "[]() -> kj::Promise<T> {\n    return makeTimeoutException();\n  }"
          ],
          "line": 112
        },
        "resolved": true,
        "details": {
          "function_name": "afterDelay",
          "container": "TimerImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/async-io.c++",
          "lines": "892-894",
          "snippet": "Promise<void> afterDelay(Duration delay) override {\n    return eventPort.atSteadyTime(eventPort.steadyTime() + delay);\n  }",
          "includes": [
            "#include <limits.h>",
            "#include <poll.h>",
            "#include <set>",
            "#include <netdb.h>",
            "#include <arpa/inet.h>",
            "#include <stdlib.h>",
            "#include <stddef.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/in.h>",
            "#include <sys/un.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/uio.h>",
            "#include <unistd.h>",
            "#include \"io.h\"",
            "#include \"thread.h\"",
            "#include \"debug.h\"",
            "#include \"async-unix.h\"",
            "#include \"async-io.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <poll.h>\n#include <set>\n#include <netdb.h>\n#include <arpa/inet.h>\n#include <stdlib.h>\n#include <stddef.h>\n#include <netinet/tcp.h>\n#include <netinet/in.h>\n#include <sys/un.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/uio.h>\n#include <unistd.h>\n#include \"io.h\"\n#include \"thread.h\"\n#include \"debug.h\"\n#include \"async-unix.h\"\n#include \"async-io.h\"\n\nTimerImpl {\n  Promise<void> afterDelay(Duration delay) override {\n      return eventPort.atSteadyTime(eventPort.steadyTime() + delay);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "makeTimeoutException",
          "args": [],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "Timer::makeTimeoutException",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/time.c++",
          "lines": "28-30",
          "snippet": "kj::Exception Timer::makeTimeoutException() {\n  return KJ_EXCEPTION(OVERLOADED, \"operation timed out\");\n}",
          "includes": [
            "#include \"debug.h\"",
            "#include \"time.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"debug.h\"\n#include \"time.h\"\n\nkj::Exception Timer::makeTimeoutException() {\n  return KJ_EXCEPTION(OVERLOADED, \"operation timed out\");\n}"
        }
      }
    ],
    "contextual_snippet": "#include <inttypes.h>\n#include \"units.h\"\n#include \"async.h\"\n\nPromise<T> Timer::timeoutAfter(Duration delay, Promise<T>&& promise) {\n  return promise.exclusiveJoin(afterDelay(delay).then([]() -> kj::Promise<T> {\n    return makeTimeoutException();\n  }));\n}"
  },
  {
    "function_name": "Timer::timeoutAt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/time.h",
    "lines": "104-108",
    "snippet": "Promise<T> Timer::timeoutAt(TimePoint time, Promise<T>&& promise) {\n  return promise.exclusiveJoin(atTime(time).then([]() -> kj::Promise<T> {\n    return makeTimeoutException();\n  }));\n}",
    "includes": [
      "#include <inttypes.h>",
      "#include \"units.h\"",
      "#include \"async.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "promise.exclusiveJoin",
          "args": [
            "atTime(time).then([]() -> kj::Promise<T> {\n    return makeTimeoutException();\n  })"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atTime",
          "args": [
            "[]() -> kj::Promise<T> {\n    return makeTimeoutException();\n  }"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "atTime",
          "container": "TimerImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/async-io.c++",
          "lines": "888-890",
          "snippet": "Promise<void> atTime(TimePoint time) override {\n    return eventPort.atSteadyTime(time);\n  }",
          "includes": [
            "#include <limits.h>",
            "#include <poll.h>",
            "#include <set>",
            "#include <netdb.h>",
            "#include <arpa/inet.h>",
            "#include <stdlib.h>",
            "#include <stddef.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/in.h>",
            "#include <sys/un.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/uio.h>",
            "#include <unistd.h>",
            "#include \"io.h\"",
            "#include \"thread.h\"",
            "#include \"debug.h\"",
            "#include \"async-unix.h\"",
            "#include \"async-io.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <poll.h>\n#include <set>\n#include <netdb.h>\n#include <arpa/inet.h>\n#include <stdlib.h>\n#include <stddef.h>\n#include <netinet/tcp.h>\n#include <netinet/in.h>\n#include <sys/un.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/uio.h>\n#include <unistd.h>\n#include \"io.h\"\n#include \"thread.h\"\n#include \"debug.h\"\n#include \"async-unix.h\"\n#include \"async-io.h\"\n\nTimerImpl {\n  Promise<void> atTime(TimePoint time) override {\n      return eventPort.atSteadyTime(time);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "makeTimeoutException",
          "args": [],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "Timer::makeTimeoutException",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/time.c++",
          "lines": "28-30",
          "snippet": "kj::Exception Timer::makeTimeoutException() {\n  return KJ_EXCEPTION(OVERLOADED, \"operation timed out\");\n}",
          "includes": [
            "#include \"debug.h\"",
            "#include \"time.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"debug.h\"\n#include \"time.h\"\n\nkj::Exception Timer::makeTimeoutException() {\n  return KJ_EXCEPTION(OVERLOADED, \"operation timed out\");\n}"
        }
      }
    ],
    "contextual_snippet": "#include <inttypes.h>\n#include \"units.h\"\n#include \"async.h\"\n\nPromise<T> Timer::timeoutAt(TimePoint time, Promise<T>&& promise) {\n  return promise.exclusiveJoin(atTime(time).then([]() -> kj::Promise<T> {\n    return makeTimeoutException();\n  }));\n}"
  }
]