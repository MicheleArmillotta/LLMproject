[
  {
    "function_name": "FdOutputStream",
    "container": "FdOutputStream",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/io.h",
    "lines": "298-298",
    "snippet": "explicit FdOutputStream(AutoCloseFd fd): fd(fd), autoclose(mv(fd)) {}",
    "includes": [
      "#include \"exception.h\"",
      "#include \"array.h\"",
      "#include \"common.h\"",
      "#include <stddef.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mv",
          "args": [
            "fd"
          ],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"exception.h\"\n#include \"array.h\"\n#include \"common.h\"\n#include <stddef.h>\n\nFdOutputStream {\n  explicit FdOutputStream(AutoCloseFd fd): fd(fd), autoclose(mv(fd)) {}\n}"
  },
  {
    "function_name": "FdOutputStream",
    "container": "FdOutputStream",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/io.h",
    "lines": "297-297",
    "snippet": "explicit FdOutputStream(int fd): fd(fd) {}",
    "includes": [
      "#include \"exception.h\"",
      "#include \"array.h\"",
      "#include \"common.h\"",
      "#include <stddef.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"exception.h\"\n#include \"array.h\"\n#include \"common.h\"\n#include <stddef.h>\n\nFdOutputStream {\n  explicit FdOutputStream(int fd): fd(fd) {}\n}"
  },
  {
    "function_name": "FdInputStream",
    "container": "FdInputStream",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/io.h",
    "lines": "282-282",
    "snippet": "explicit FdInputStream(AutoCloseFd fd): fd(fd), autoclose(mv(fd)) {}",
    "includes": [
      "#include \"exception.h\"",
      "#include \"array.h\"",
      "#include \"common.h\"",
      "#include <stddef.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mv",
          "args": [
            "fd"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"exception.h\"\n#include \"array.h\"\n#include \"common.h\"\n#include <stddef.h>\n\nFdInputStream {\n  explicit FdInputStream(AutoCloseFd fd): fd(fd), autoclose(mv(fd)) {}\n}"
  },
  {
    "function_name": "FdInputStream",
    "container": "FdInputStream",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/io.h",
    "lines": "281-281",
    "snippet": "explicit FdInputStream(int fd): fd(fd) {}",
    "includes": [
      "#include \"exception.h\"",
      "#include \"array.h\"",
      "#include \"common.h\"",
      "#include <stddef.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"exception.h\"\n#include \"array.h\"\n#include \"common.h\"\n#include <stddef.h>\n\nFdInputStream {\n  explicit FdInputStream(int fd): fd(fd) {}\n}"
  },
  {
    "function_name": "KJ_STRINGIFY",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/io.h",
    "lines": "272-275",
    "snippet": "inline auto KJ_STRINGIFY(const AutoCloseFd& fd)\n    -> decltype(kj::toCharSequence(implicitCast<int>(fd))) {\n  return kj::toCharSequence(implicitCast<int>(fd));\n}",
    "includes": [
      "#include \"exception.h\"",
      "#include \"array.h\"",
      "#include \"common.h\"",
      "#include <stddef.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::toCharSequence",
          "args": [
            "implicitCast<int>(fd)"
          ],
          "line": 274
        },
        "resolved": true,
        "details": {
          "function_name": "toCharSequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "312-322",
          "snippet": "auto toCharSequence(T&& value) -> decltype(_::STR * kj::fwd<T>(value)) {\n  // Returns an iterable of chars that represent a textual representation of the value, suitable\n  // for debugging.\n  //\n  // Most users should use str() instead, but toCharSequence() may occasionally be useful to avoid\n  // heap allocation overhead that str() implies.\n  //\n  // To specialize this function for your type, see KJ_STRINGIFY.\n\n  return _::STR * kj::fwd<T>(value);\n}",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\nauto toCharSequence(T&& value) -> decltype(_::STR * kj::fwd<T>(value)) {\n  // Returns an iterable of chars that represent a textual representation of the value, suitable\n  // for debugging.\n  //\n  // Most users should use str() instead, but toCharSequence() may occasionally be useful to avoid\n  // heap allocation overhead that str() implies.\n  //\n  // To specialize this function for your type, see KJ_STRINGIFY.\n\n  return _::STR * kj::fwd<T>(value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "implicitCast<int>",
          "args": [
            "fd"
          ],
          "line": 274
        },
        "resolved": true,
        "details": {
          "function_name": "implicitCast",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "1203-1207",
          "snippet": "To implicitCast(From&& from) {\n  // `implicitCast<T>(value)` casts `value` to type `T` only if the conversion is implicit.  Useful\n  // for e.g. resolving ambiguous overloads without sacrificing type-safety.\n  return kj::fwd<From>(from);\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\nTo implicitCast(From&& from) {\n  // `implicitCast<T>(value)` casts `value` to type `T` only if the conversion is implicit.  Useful\n  // for e.g. resolving ambiguous overloads without sacrificing type-safety.\n  return kj::fwd<From>(from);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"exception.h\"\n#include \"array.h\"\n#include \"common.h\"\n#include <stddef.h>\n\ninline auto KJ_STRINGIFY(const AutoCloseFd& fd)\n    -> decltype(kj::toCharSequence(implicitCast<int>(fd))) {\n  return kj::toCharSequence(implicitCast<int>(fd));\n}"
  },
  {
    "function_name": "get",
    "container": "AutoCloseFd",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/io.h",
    "lines": "258-258",
    "snippet": "inline int get() const { return fd; }",
    "includes": [
      "#include \"exception.h\"",
      "#include \"array.h\"",
      "#include \"common.h\"",
      "#include <stddef.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"exception.h\"\n#include \"array.h\"\n#include \"common.h\"\n#include <stddef.h>\n\nAutoCloseFd {\n  inline int get() const { return fd; }\n}"
  },
  {
    "function_name": "AutoCloseFd",
    "container": "AutoCloseFd",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/io.h",
    "lines": "241-241",
    "snippet": "inline AutoCloseFd(AutoCloseFd&& other) noexcept: fd(other.fd) { other.fd = -1; }",
    "includes": [
      "#include \"exception.h\"",
      "#include \"array.h\"",
      "#include \"common.h\"",
      "#include <stddef.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"exception.h\"\n#include \"array.h\"\n#include \"common.h\"\n#include <stddef.h>\n\nAutoCloseFd {\n  inline AutoCloseFd(AutoCloseFd&& other) noexcept: fd(other.fd) { other.fd = -1; }\n}"
  },
  {
    "function_name": "AutoCloseFd",
    "container": "AutoCloseFd",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/io.h",
    "lines": "240-240",
    "snippet": "inline explicit AutoCloseFd(int fd): fd(fd) {}",
    "includes": [
      "#include \"exception.h\"",
      "#include \"array.h\"",
      "#include \"common.h\"",
      "#include <stddef.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"exception.h\"\n#include \"array.h\"\n#include \"common.h\"\n#include <stddef.h>\n\nAutoCloseFd {\n  inline explicit AutoCloseFd(int fd): fd(fd) {}\n}"
  },
  {
    "function_name": "AutoCloseFd",
    "container": "AutoCloseFd",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/io.h",
    "lines": "239-239",
    "snippet": "inline AutoCloseFd(decltype(nullptr)): fd(-1) {}",
    "includes": [
      "#include \"exception.h\"",
      "#include \"array.h\"",
      "#include \"common.h\"",
      "#include <stddef.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"exception.h\"\n#include \"array.h\"\n#include \"common.h\"\n#include <stddef.h>\n\nAutoCloseFd {\n  inline AutoCloseFd(decltype(nullptr)): fd(-1) {}\n}"
  },
  {
    "function_name": "AutoCloseFd",
    "container": "AutoCloseFd",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/io.h",
    "lines": "238-238",
    "snippet": "inline AutoCloseFd(): fd(-1) {}",
    "includes": [
      "#include \"exception.h\"",
      "#include \"array.h\"",
      "#include \"common.h\"",
      "#include <stddef.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"exception.h\"\n#include \"array.h\"\n#include \"common.h\"\n#include <stddef.h>\n\nAutoCloseFd {\n  inline AutoCloseFd(): fd(-1) {}\n}"
  },
  {
    "function_name": "getArray",
    "container": "ArrayOutputStream",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/io.h",
    "lines": "211-214",
    "snippet": "ArrayPtr<byte> getArray() {\n    // Get the portion of the array which has been filled in.\n    return arrayPtr(array.begin(), fillPos);\n  }",
    "includes": [
      "#include \"exception.h\"",
      "#include \"array.h\"",
      "#include \"common.h\"",
      "#include <stddef.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "arrayPtr",
          "args": [
            "array.begin()",
            "fillPos"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "arrayPtr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "1194-1197",
          "snippet": "inline constexpr ArrayPtr<T> arrayPtr(T* begin, T* end) {\n  // Use this function to construct ArrayPtrs without writing out the type name.\n  return ArrayPtr<T>(begin, end);\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\ninline constexpr ArrayPtr<T> arrayPtr(T* begin, T* end) {\n  // Use this function to construct ArrayPtrs without writing out the type name.\n  return ArrayPtr<T>(begin, end);\n}"
        }
      },
      {
        "call_info": {
          "callee": "array.begin",
          "args": [],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "Repeat",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "692-692",
          "snippet": "inline Iterator begin() const { return Iterator(value, 0); }",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\nRepeat {\n  inline Iterator begin() const { return Iterator(value, 0); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"exception.h\"\n#include \"array.h\"\n#include \"common.h\"\n#include <stddef.h>\n\nArrayOutputStream {\n  ArrayPtr<byte> getArray() {\n      // Get the portion of the array which has been filled in.\n      return arrayPtr(array.begin(), fillPos);\n    }\n}"
  },
  {
    "function_name": "read",
    "container": "InputStream",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/io.h",
    "lines": "66-66",
    "snippet": "inline void read(void* buffer, size_t bytes) { read(buffer, bytes, bytes); }",
    "includes": [
      "#include \"exception.h\"",
      "#include \"array.h\"",
      "#include \"common.h\"",
      "#include <stddef.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "read",
          "args": [
            "buffer",
            "bytes",
            "bytes"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "InputStream::read",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/io.c++",
          "lines": "40-48",
          "snippet": "size_t InputStream::read(void* buffer, size_t minBytes, size_t maxBytes) {\n  size_t n = tryRead(buffer, minBytes, maxBytes);\n  KJ_REQUIRE(n >= minBytes, \"Premature EOF\") {\n    // Pretend we read zeros from the input.\n    memset(reinterpret_cast<byte*>(buffer) + n, 0, minBytes - n);\n    return minBytes;\n  }\n  return n;\n}",
          "includes": [
            "#include <sys/uio.h>",
            "#include <limits.h>",
            "#include <errno.h>",
            "#include <algorithm>",
            "#include \"miniposix.h\"",
            "#include \"debug.h\"",
            "#include \"io.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/uio.h>\n#include <limits.h>\n#include <errno.h>\n#include <algorithm>\n#include \"miniposix.h\"\n#include \"debug.h\"\n#include \"io.h\"\n\nsize_t InputStream::read(void* buffer, size_t minBytes, size_t maxBytes) {\n  size_t n = tryRead(buffer, minBytes, maxBytes);\n  KJ_REQUIRE(n >= minBytes, \"Premature EOF\") {\n    // Pretend we read zeros from the input.\n    memset(reinterpret_cast<byte*>(buffer) + n, 0, minBytes - n);\n    return minBytes;\n  }\n  return n;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"exception.h\"\n#include \"array.h\"\n#include \"common.h\"\n#include <stddef.h>\n\nInputStream {\n  inline void read(void* buffer, size_t bytes) { read(buffer, bytes, bytes); }\n}"
  }
]