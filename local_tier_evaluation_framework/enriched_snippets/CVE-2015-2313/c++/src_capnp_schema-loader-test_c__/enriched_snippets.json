[
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-loader-test.c++",
    "lines": "331-388",
    "snippet": "TEST(SchemaLoader, Generics) {\n  SchemaLoader loader;\n\n  StructSchema allTypes = loader.load(Schema::from<TestAllTypes>().getProto()).asStruct();\n  StructSchema tap = loader.load(Schema::from<test::TestAnyPointer>().getProto()).asStruct();\n  loader.load(Schema::from<test::TestGenerics<>::Inner>().getProto());\n  loader.load(Schema::from<test::TestGenerics<>::Inner2<>>().getProto());\n  loader.load(Schema::from<test::TestGenerics<>::Interface<>>().getProto());\n  loader.load(Schema::from<test::TestGenerics<>::Interface<>::CallResults>().getProto());\n  loader.load(Schema::from<test::TestGenerics<>>().getProto());\n  StructSchema schema = loader.load(Schema::from<test::TestUseGenerics>().getProto()).asStruct();\n\n  StructSchema branded;\n\n  {\n    StructSchema::Field basic = schema.getFieldByName(\"basic\");\n    branded = basic.getType().asStruct();\n\n    StructSchema::Field foo = branded.getFieldByName(\"foo\");\n    EXPECT_TRUE(foo.getType().asStruct() == allTypes);\n    EXPECT_TRUE(foo.getType().asStruct() != tap);\n\n    StructSchema instance2 = branded.getFieldByName(\"rev\").getType().asStruct();\n    StructSchema::Field foo2 = instance2.getFieldByName(\"foo\");\n    EXPECT_TRUE(foo2.getType().asStruct() == tap);\n    EXPECT_TRUE(foo2.getType().asStruct() != allTypes);\n  }\n\n  {\n    StructSchema inner2 = schema.getFieldByName(\"inner2\").getType().asStruct();\n\n    StructSchema bound = inner2.getFieldByName(\"innerBound\").getType().asStruct();\n    Type boundFoo = bound.getFieldByName(\"foo\").getType();\n    EXPECT_FALSE(boundFoo.isAnyPointer());\n    EXPECT_TRUE(boundFoo.asStruct() == allTypes);\n\n    StructSchema unbound = inner2.getFieldByName(\"innerUnbound\").getType().asStruct();\n    Type unboundFoo = unbound.getFieldByName(\"foo\").getType();\n    EXPECT_TRUE(unboundFoo.isAnyPointer());\n  }\n\n  {\n    InterfaceSchema cap = schema.getFieldByName(\"genericCap\").getType().asInterface();\n    InterfaceSchema::Method method = cap.getMethodByName(\"call\");\n\n    StructSchema inner2 = method.getParamType();\n    StructSchema bound = inner2.getFieldByName(\"innerBound\").getType().asStruct();\n    Type boundFoo = bound.getFieldByName(\"foo\").getType();\n    EXPECT_FALSE(boundFoo.isAnyPointer());\n    EXPECT_TRUE(boundFoo.asStruct() == allTypes);\n    EXPECT_TRUE(inner2.getFieldByName(\"baz\").getType().isText());\n\n    StructSchema results = method.getResultType();\n    EXPECT_TRUE(results.getFieldByName(\"qux\").getType().isData());\n\n    EXPECT_TRUE(results.getFieldByName(\"gen\").getType().asStruct() == branded);\n  }\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include \"schema-loader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "results.getFieldByName(\"gen\").getType().asStruct() == branded"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "results.getFieldByName",
          "args": [],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "results.getFieldByName",
          "args": [],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "results.getFieldByName",
          "args": [
            "\"gen\""
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "results.getFieldByName(\"qux\").getType().isData()"
          ],
          "line": 384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "results.getFieldByName",
          "args": [],
          "line": 384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "results.getFieldByName",
          "args": [],
          "line": 384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "results.getFieldByName",
          "args": [
            "\"qux\""
          ],
          "line": 384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "method.getResultType",
          "args": [],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "inner2.getFieldByName(\"baz\").getType().isText()"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inner2.getFieldByName",
          "args": [],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inner2.getFieldByName",
          "args": [],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inner2.getFieldByName",
          "args": [
            "\"baz\""
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "boundFoo.asStruct() == allTypes"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boundFoo.asStruct",
          "args": [],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "boundFoo.isAnyPointer()"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boundFoo.isAnyPointer",
          "args": [],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bound.getFieldByName",
          "args": [],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bound.getFieldByName",
          "args": [
            "\"foo\""
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inner2.getFieldByName",
          "args": [],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inner2.getFieldByName",
          "args": [],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inner2.getFieldByName",
          "args": [
            "\"innerBound\""
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "method.getParamType",
          "args": [],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cap.getMethodByName",
          "args": [
            "\"call\""
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [
            "\"genericCap\""
          ],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "unboundFoo.isAnyPointer()"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unboundFoo.isAnyPointer",
          "args": [],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unbound.getFieldByName",
          "args": [],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unbound.getFieldByName",
          "args": [
            "\"foo\""
          ],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inner2.getFieldByName",
          "args": [],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inner2.getFieldByName",
          "args": [],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inner2.getFieldByName",
          "args": [
            "\"innerUnbound\""
          ],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "boundFoo.asStruct() == allTypes"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boundFoo.asStruct",
          "args": [],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "boundFoo.isAnyPointer()"
          ],
          "line": 364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boundFoo.isAnyPointer",
          "args": [],
          "line": 364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bound.getFieldByName",
          "args": [],
          "line": 363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bound.getFieldByName",
          "args": [
            "\"foo\""
          ],
          "line": 363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inner2.getFieldByName",
          "args": [],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inner2.getFieldByName",
          "args": [],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inner2.getFieldByName",
          "args": [
            "\"innerBound\""
          ],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [
            "\"inner2\""
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "foo2.getType().asStruct() != allTypes"
          ],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "foo2.getType",
          "args": [],
          "line": 356
        },
        "resolved": true,
        "details": {
          "function_name": "getType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "942-942",
          "snippet": "inline DynamicValue::Type getType() { return type; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline DynamicValue::Type getType() { return type; }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "foo2.getType().asStruct() == tap"
          ],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "instance2.getFieldByName",
          "args": [
            "\"foo\""
          ],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "branded.getFieldByName",
          "args": [],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "branded.getFieldByName",
          "args": [],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "branded.getFieldByName",
          "args": [
            "\"rev\""
          ],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "foo.getType().asStruct() != tap"
          ],
          "line": 351
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "foo.getType().asStruct() == allTypes"
          ],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "branded.getFieldByName",
          "args": [
            "\"foo\""
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [
            "\"basic\""
          ],
          "line": 346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loader.load",
          "args": [],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loader.load",
          "args": [
            "Schema::from<test::TestUseGenerics>().getProto()"
          ],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<test::TestUseGenerics>",
          "args": [],
          "line": 341
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "loader.load",
          "args": [
            "Schema::from<test::TestGenerics<>>().getProto()"
          ],
          "line": 340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<test::TestGenerics<>>",
          "args": [],
          "line": 340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<test::TestGenerics<>>",
          "args": [],
          "line": 340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loader.load",
          "args": [
            "Schema::from<test::TestGenerics<>::Interface<>::CallResults>().getProto()"
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<test::TestGenerics<>::Interface<>::CallResults>",
          "args": [],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<test::TestGenerics<>::Interface<>::CallResults>",
          "args": [],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loader.load",
          "args": [
            "Schema::from<test::TestGenerics<>::Interface<>>().getProto()"
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<test::TestGenerics<>::Interface<>>",
          "args": [],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<test::TestGenerics<>::Interface<>>",
          "args": [],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loader.load",
          "args": [
            "Schema::from<test::TestGenerics<>::Inner2<>>().getProto()"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<test::TestGenerics<>::Inner2<>>",
          "args": [],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<test::TestGenerics<>::Inner2<>>",
          "args": [],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loader.load",
          "args": [
            "Schema::from<test::TestGenerics<>::Inner>().getProto()"
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<test::TestGenerics<>::Inner>",
          "args": [],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<test::TestGenerics<>::Inner>",
          "args": [],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loader.load",
          "args": [],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loader.load",
          "args": [
            "Schema::from<test::TestAnyPointer>().getProto()"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loader.load",
          "args": [],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loader.load",
          "args": [
            "Schema::from<TestAllTypes>().getProto()"
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include \"schema-loader.h\"\n\nTEST(SchemaLoader, Generics) {\n  SchemaLoader loader;\n\n  StructSchema allTypes = loader.load(Schema::from<TestAllTypes>().getProto()).asStruct();\n  StructSchema tap = loader.load(Schema::from<test::TestAnyPointer>().getProto()).asStruct();\n  loader.load(Schema::from<test::TestGenerics<>::Inner>().getProto());\n  loader.load(Schema::from<test::TestGenerics<>::Inner2<>>().getProto());\n  loader.load(Schema::from<test::TestGenerics<>::Interface<>>().getProto());\n  loader.load(Schema::from<test::TestGenerics<>::Interface<>::CallResults>().getProto());\n  loader.load(Schema::from<test::TestGenerics<>>().getProto());\n  StructSchema schema = loader.load(Schema::from<test::TestUseGenerics>().getProto()).asStruct();\n\n  StructSchema branded;\n\n  {\n    StructSchema::Field basic = schema.getFieldByName(\"basic\");\n    branded = basic.getType().asStruct();\n\n    StructSchema::Field foo = branded.getFieldByName(\"foo\");\n    EXPECT_TRUE(foo.getType().asStruct() == allTypes);\n    EXPECT_TRUE(foo.getType().asStruct() != tap);\n\n    StructSchema instance2 = branded.getFieldByName(\"rev\").getType().asStruct();\n    StructSchema::Field foo2 = instance2.getFieldByName(\"foo\");\n    EXPECT_TRUE(foo2.getType().asStruct() == tap);\n    EXPECT_TRUE(foo2.getType().asStruct() != allTypes);\n  }\n\n  {\n    StructSchema inner2 = schema.getFieldByName(\"inner2\").getType().asStruct();\n\n    StructSchema bound = inner2.getFieldByName(\"innerBound\").getType().asStruct();\n    Type boundFoo = bound.getFieldByName(\"foo\").getType();\n    EXPECT_FALSE(boundFoo.isAnyPointer());\n    EXPECT_TRUE(boundFoo.asStruct() == allTypes);\n\n    StructSchema unbound = inner2.getFieldByName(\"innerUnbound\").getType().asStruct();\n    Type unboundFoo = unbound.getFieldByName(\"foo\").getType();\n    EXPECT_TRUE(unboundFoo.isAnyPointer());\n  }\n\n  {\n    InterfaceSchema cap = schema.getFieldByName(\"genericCap\").getType().asInterface();\n    InterfaceSchema::Method method = cap.getMethodByName(\"call\");\n\n    StructSchema inner2 = method.getParamType();\n    StructSchema bound = inner2.getFieldByName(\"innerBound\").getType().asStruct();\n    Type boundFoo = bound.getFieldByName(\"foo\").getType();\n    EXPECT_FALSE(boundFoo.isAnyPointer());\n    EXPECT_TRUE(boundFoo.asStruct() == allTypes);\n    EXPECT_TRUE(inner2.getFieldByName(\"baz\").getType().isText());\n\n    StructSchema results = method.getResultType();\n    EXPECT_TRUE(results.getFieldByName(\"qux\").getType().isData());\n\n    EXPECT_TRUE(results.getFieldByName(\"gen\").getType().asStruct() == branded);\n  }\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-loader-test.c++",
    "lines": "312-329",
    "snippet": "TEST(SchemaLoader, LazyLoadGetDependency) {\n  FakeLoaderCallback callback(Schema::from<TestAllTypes>().getProto());\n  SchemaLoader loader(callback);\n\n  Schema schema = loader.load(Schema::from<TestDefaults>().getProto());\n\n  EXPECT_FALSE(callback.isLoaded());\n\n  Schema dep = schema.getDependency(typeId<TestAllTypes>());\n\n  EXPECT_TRUE(callback.isLoaded());\n\n  EXPECT_EQ(dep.getProto().getDisplayName(),\n            Schema::from<TestAllTypes>().getProto().getDisplayName());\n\n  EXPECT_EQ(dep, schema.getDependency(typeId<TestAllTypes>()));\n  EXPECT_EQ(dep, loader.get(typeId<TestAllTypes>()));\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include \"schema-loader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "dep",
            "loader.get(typeId<TestAllTypes>())"
          ],
          "line": 328
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loader.get",
          "args": [
            "typeId<TestAllTypes>()"
          ],
          "line": 328
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "868-871",
          "snippet": "static inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }"
        }
      },
      {
        "call_info": {
          "callee": "typeId<TestAllTypes>",
          "args": [],
          "line": 328
        },
        "resolved": true,
        "details": {
          "function_name": "typeId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "491-491",
          "snippet": "inline constexpr uint64_t typeId() { return id; }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\ninline constexpr uint64_t typeId() { return id; }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "dep",
            "schema.getDependency(typeId<TestAllTypes>())"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getDependency",
          "args": [
            "typeId<TestAllTypes>()"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "dep.getProto().getDisplayName()",
            "Schema::from<TestAllTypes>().getProto().getDisplayName()"
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<TestAllTypes>",
          "args": [],
          "line": 325
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dep.getProto",
          "args": [],
          "line": 324
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "callback.isLoaded()"
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "callback.isLoaded",
          "args": [],
          "line": 322
        },
        "resolved": true,
        "details": {
          "function_name": "isLoaded",
          "container": "FakeLoaderCallback",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-loader-test.c++",
          "lines": "276-276",
          "snippet": "bool isLoaded() { return loaded; }",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"test-util.h\"",
            "#include <kj/compat/gtest.h>",
            "#include \"schema-loader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include \"schema-loader.h\"\n\nFakeLoaderCallback {\n  bool isLoaded() { return loaded; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "schema.getDependency",
          "args": [
            "typeId<TestAllTypes>()"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "callback.isLoaded()"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loader.load",
          "args": [
            "Schema::from<TestDefaults>().getProto()"
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include \"schema-loader.h\"\n\nTEST(SchemaLoader, LazyLoadGetDependency) {\n  FakeLoaderCallback callback(Schema::from<TestAllTypes>().getProto());\n  SchemaLoader loader(callback);\n\n  Schema schema = loader.load(Schema::from<TestDefaults>().getProto());\n\n  EXPECT_FALSE(callback.isLoaded());\n\n  Schema dep = schema.getDependency(typeId<TestAllTypes>());\n\n  EXPECT_TRUE(callback.isLoaded());\n\n  EXPECT_EQ(dep.getProto().getDisplayName(),\n            Schema::from<TestAllTypes>().getProto().getDisplayName());\n\n  EXPECT_EQ(dep, schema.getDependency(typeId<TestAllTypes>()));\n  EXPECT_EQ(dep, loader.get(typeId<TestAllTypes>()));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-loader-test.c++",
    "lines": "295-310",
    "snippet": "TEST(SchemaLoader, LazyLoad) {\n  FakeLoaderCallback callback(Schema::from<TestAllTypes>().getProto());\n  SchemaLoader loader(callback);\n\n  EXPECT_TRUE(loader.tryGet(1234) == nullptr);\n\n  EXPECT_FALSE(callback.isLoaded());\n  Schema schema = loader.get(typeId<TestAllTypes>());\n  EXPECT_TRUE(callback.isLoaded());\n\n  EXPECT_EQ(schema.getProto().getDisplayName(),\n            Schema::from<TestAllTypes>().getProto().getDisplayName());\n\n  EXPECT_EQ(schema, schema.getDependency(typeId<TestAllTypes>()));\n  EXPECT_EQ(schema, loader.get(typeId<TestAllTypes>()));\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include \"schema-loader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "schema",
            "loader.get(typeId<TestAllTypes>())"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loader.get",
          "args": [
            "typeId<TestAllTypes>()"
          ],
          "line": 309
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "868-871",
          "snippet": "static inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }"
        }
      },
      {
        "call_info": {
          "callee": "typeId<TestAllTypes>",
          "args": [],
          "line": 309
        },
        "resolved": true,
        "details": {
          "function_name": "typeId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "491-491",
          "snippet": "inline constexpr uint64_t typeId() { return id; }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\ninline constexpr uint64_t typeId() { return id; }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "schema",
            "schema.getDependency(typeId<TestAllTypes>())"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getDependency",
          "args": [
            "typeId<TestAllTypes>()"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "schema.getProto().getDisplayName()",
            "Schema::from<TestAllTypes>().getProto().getDisplayName()"
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<TestAllTypes>",
          "args": [],
          "line": 306
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "schema.getProto",
          "args": [],
          "line": 305
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "callback.isLoaded()"
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "callback.isLoaded",
          "args": [],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "isLoaded",
          "container": "FakeLoaderCallback",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-loader-test.c++",
          "lines": "276-276",
          "snippet": "bool isLoaded() { return loaded; }",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"test-util.h\"",
            "#include <kj/compat/gtest.h>",
            "#include \"schema-loader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include \"schema-loader.h\"\n\nFakeLoaderCallback {\n  bool isLoaded() { return loaded; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "callback.isLoaded()"
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "loader.tryGet(1234) == nullptr"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loader.tryGet",
          "args": [
            "1234"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include \"schema-loader.h\"\n\nTEST(SchemaLoader, LazyLoad) {\n  FakeLoaderCallback callback(Schema::from<TestAllTypes>().getProto());\n  SchemaLoader loader(callback);\n\n  EXPECT_TRUE(loader.tryGet(1234) == nullptr);\n\n  EXPECT_FALSE(callback.isLoaded());\n  Schema schema = loader.get(typeId<TestAllTypes>());\n  EXPECT_TRUE(callback.isLoaded());\n\n  EXPECT_EQ(schema.getProto().getDisplayName(),\n            Schema::from<TestAllTypes>().getProto().getDisplayName());\n\n  EXPECT_EQ(schema, schema.getDependency(typeId<TestAllTypes>()));\n  EXPECT_EQ(schema, loader.get(typeId<TestAllTypes>()));\n}"
  },
  {
    "function_name": "load",
    "container": "FakeLoaderCallback",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-loader-test.c++",
    "lines": "278-288",
    "snippet": "void load(const SchemaLoader& loader, uint64_t id) const override {\n    if (id == 1234) {\n      // Magic \"not found\" ID.\n      return;\n    }\n\n    EXPECT_EQ(node.getId(), id);\n    EXPECT_FALSE(loaded);\n    loaded = true;\n    loader.loadOnce(node);\n  }",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include \"schema-loader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "loader.loadOnce",
          "args": [
            "node"
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "loaded"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "node.getId()",
            "id"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "node.getId",
          "args": [],
          "line": 284
        },
        "resolved": true,
        "details": {
          "function_name": "getId",
          "container": "QuestionRef",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1289-1289",
          "snippet": "inline QuestionId getId() const { return id; }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nQuestionRef {\n  inline QuestionId getId() const { return id; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include \"schema-loader.h\"\n\nFakeLoaderCallback {\n  void load(const SchemaLoader& loader, uint64_t id) const override {\n      if (id == 1234) {\n        // Magic \"not found\" ID.\n        return;\n      }\n  \n      EXPECT_EQ(node.getId(), id);\n      EXPECT_FALSE(loaded);\n      loaded = true;\n      loader.loadOnce(node);\n    }\n}"
  },
  {
    "function_name": "isLoaded",
    "container": "FakeLoaderCallback",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-loader-test.c++",
    "lines": "276-276",
    "snippet": "bool isLoaded() { return loaded; }",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include \"schema-loader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include \"schema-loader.h\"\n\nFakeLoaderCallback {\n  bool isLoaded() { return loaded; }\n}"
  },
  {
    "function_name": "FakeLoaderCallback",
    "container": "FakeLoaderCallback",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-loader-test.c++",
    "lines": "274-274",
    "snippet": "FakeLoaderCallback(const schema::Node::Reader node): node(node), loaded(false) {}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include \"schema-loader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include \"schema-loader.h\"\n\nFakeLoaderCallback {\n  FakeLoaderCallback(const schema::Node::Reader node): node(node), loaded(false) {}\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-loader-test.c++",
    "lines": "248-270",
    "snippet": "TEST(SchemaLoader, EnumerateNoPlaceholders) {\n  SchemaLoader loader;\n  Schema schema = loader.load(Schema::from<TestDefaults>().getProto());\n\n  {\n    auto list = loader.getAllLoaded();\n    ASSERT_EQ(1u, list.size());\n    EXPECT_TRUE(list[0] == schema);\n  }\n\n  Schema dep = schema.getDependency(typeId<TestAllTypes>());\n\n  {\n    auto list = loader.getAllLoaded();\n    ASSERT_EQ(2u, list.size());\n    if (list[0] == schema) {\n      EXPECT_TRUE(list[1] == dep);\n    } else {\n      EXPECT_TRUE(list[0] == dep);\n      EXPECT_TRUE(list[1] == schema);\n    }\n  }\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include \"schema-loader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "list[1] == schema"
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "list[0] == dep"
          ],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "list[1] == dep"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "2u",
            "list.size()"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list.size",
          "args": [],
          "line": 262
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "599-599",
          "snippet": "inline uint size() { return _builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline uint size() { return _builder.size() / ELEMENTS; }"
        }
      },
      {
        "call_info": {
          "callee": "loader.getAllLoaded",
          "args": [],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getDependency",
          "args": [
            "typeId<TestAllTypes>()"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typeId<TestAllTypes>",
          "args": [],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "typeId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "491-491",
          "snippet": "inline constexpr uint64_t typeId() { return id; }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\ninline constexpr uint64_t typeId() { return id; }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "list[0] == schema"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "1u",
            "list.size()"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loader.getAllLoaded",
          "args": [],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loader.load",
          "args": [
            "Schema::from<TestDefaults>().getProto()"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<TestDefaults>",
          "args": [],
          "line": 250
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include \"schema-loader.h\"\n\nTEST(SchemaLoader, EnumerateNoPlaceholders) {\n  SchemaLoader loader;\n  Schema schema = loader.load(Schema::from<TestDefaults>().getProto());\n\n  {\n    auto list = loader.getAllLoaded();\n    ASSERT_EQ(1u, list.size());\n    EXPECT_TRUE(list[0] == schema);\n  }\n\n  Schema dep = schema.getDependency(typeId<TestAllTypes>());\n\n  {\n    auto list = loader.getAllLoaded();\n    ASSERT_EQ(2u, list.size());\n    if (list[0] == schema) {\n      EXPECT_TRUE(list[1] == dep);\n    } else {\n      EXPECT_TRUE(list[0] == dep);\n      EXPECT_TRUE(list[1] == schema);\n    }\n  }\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-loader-test.c++",
    "lines": "234-246",
    "snippet": "TEST(SchemaLoader, Enumerate) {\n  SchemaLoader loader;\n  loader.loadCompiledTypeAndDependencies<TestAllTypes>();\n  auto list = loader.getAllLoaded();\n\n  ASSERT_EQ(2u, list.size());\n  if (list[0] == loader.get(typeId<TestAllTypes>())) {\n    EXPECT_TRUE(list[1] == loader.get(typeId<TestEnum>()));\n  } else {\n    EXPECT_TRUE(list[0] == loader.get(typeId<TestEnum>()));\n    EXPECT_TRUE(list[1] == loader.get(typeId<TestAllTypes>()));\n  }\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include \"schema-loader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "list[1] == loader.get(typeId<TestAllTypes>())"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loader.get",
          "args": [
            "typeId<TestAllTypes>()"
          ],
          "line": 244
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "868-871",
          "snippet": "static inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }"
        }
      },
      {
        "call_info": {
          "callee": "typeId<TestAllTypes>",
          "args": [],
          "line": 244
        },
        "resolved": true,
        "details": {
          "function_name": "typeId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "491-491",
          "snippet": "inline constexpr uint64_t typeId() { return id; }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\ninline constexpr uint64_t typeId() { return id; }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "list[0] == loader.get(typeId<TestEnum>())"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "list[1] == loader.get(typeId<TestEnum>())"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "2u",
            "list.size()"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list.size",
          "args": [],
          "line": 239
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "599-599",
          "snippet": "inline uint size() { return _builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline uint size() { return _builder.size() / ELEMENTS; }"
        }
      },
      {
        "call_info": {
          "callee": "loader.getAllLoaded",
          "args": [],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loader.loadCompiledTypeAndDependencies<TestAllTypes>",
          "args": [],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "loadCompiledTypeAndDependencies",
          "container": "SchemaParser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-parser.h",
          "lines": "81-84",
          "snippet": "inline void loadCompiledTypeAndDependencies() {\n    // See SchemaLoader::loadCompiledTypeAndDependencies().\n    getLoader().loadCompiledTypeAndDependencies<T>();\n  }",
          "includes": [
            "#include <kj/string.h>",
            "#include \"schema-loader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string.h>\n#include \"schema-loader.h\"\n\nSchemaParser {\n  inline void loadCompiledTypeAndDependencies() {\n      // See SchemaLoader::loadCompiledTypeAndDependencies().\n      getLoader().loadCompiledTypeAndDependencies<T>();\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include \"schema-loader.h\"\n\nTEST(SchemaLoader, Enumerate) {\n  SchemaLoader loader;\n  loader.loadCompiledTypeAndDependencies<TestAllTypes>();\n  auto list = loader.getAllLoaded();\n\n  ASSERT_EQ(2u, list.size());\n  if (list[0] == loader.get(typeId<TestAllTypes>())) {\n    EXPECT_TRUE(list[1] == loader.get(typeId<TestEnum>()));\n  } else {\n    EXPECT_TRUE(list[0] == loader.get(typeId<TestEnum>()));\n    EXPECT_TRUE(list[1] == loader.get(typeId<TestAllTypes>()));\n  }\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-loader-test.c++",
    "lines": "227-232",
    "snippet": "TEST(SchemaLoader, Incompatible) {\n  SchemaLoader loader;\n  loader.loadCompiledTypeAndDependencies<test::TestListDefaults>();\n  EXPECT_NONFATAL_FAILURE(\n      loadUnderAlternateTypeId<test::TestAllTypes>(loader, typeId<test::TestListDefaults>()));\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include \"schema-loader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_NONFATAL_FAILURE",
          "args": [
            "loadUnderAlternateTypeId<test::TestAllTypes>(loader, typeId<test::TestListDefaults>())"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loadUnderAlternateTypeId<test::TestAllTypes>",
          "args": [
            "loader",
            "typeId<test::TestListDefaults>()"
          ],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "loadUnderAlternateTypeId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-loader-test.c++",
          "lines": "168-188",
          "snippet": "Schema loadUnderAlternateTypeId(SchemaLoader& loader, uint64_t id) {\n  MallocMessageBuilder schemaBuilder;\n  schemaBuilder.setRoot(Schema::from<T>().getProto());\n  auto root = schemaBuilder.getRoot<schema::Node>();\n  root.setId(id);\n\n  if (root.isStruct()) {\n    // If the struct contains any self-referential members, change their type IDs as well.\n    auto fields = root.getStruct().getFields();\n    for (auto field: fields) {\n      if (field.isSlot()) {\n        auto type = field.getSlot().getType();\n        if (type.isStruct() && type.getStruct().getTypeId() == typeId<T>()) {\n          type.getStruct().setTypeId(id);\n        }\n      }\n    }\n  }\n\n  return loader.load(root);\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"test-util.h\"",
            "#include <kj/compat/gtest.h>",
            "#include \"schema-loader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include \"schema-loader.h\"\n\nSchema loadUnderAlternateTypeId(SchemaLoader& loader, uint64_t id) {\n  MallocMessageBuilder schemaBuilder;\n  schemaBuilder.setRoot(Schema::from<T>().getProto());\n  auto root = schemaBuilder.getRoot<schema::Node>();\n  root.setId(id);\n\n  if (root.isStruct()) {\n    // If the struct contains any self-referential members, change their type IDs as well.\n    auto fields = root.getStruct().getFields();\n    for (auto field: fields) {\n      if (field.isSlot()) {\n        auto type = field.getSlot().getType();\n        if (type.isStruct() && type.getStruct().getTypeId() == typeId<T>()) {\n          type.getStruct().setTypeId(id);\n        }\n      }\n    }\n  }\n\n  return loader.load(root);\n}"
        }
      },
      {
        "call_info": {
          "callee": "typeId<test::TestListDefaults>",
          "args": [],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "typeId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "491-491",
          "snippet": "inline constexpr uint64_t typeId() { return id; }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\ninline constexpr uint64_t typeId() { return id; }"
        }
      },
      {
        "call_info": {
          "callee": "loader.loadCompiledTypeAndDependencies<test::TestListDefaults>",
          "args": [],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "loadCompiledTypeAndDependencies",
          "container": "SchemaParser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-parser.h",
          "lines": "81-84",
          "snippet": "inline void loadCompiledTypeAndDependencies() {\n    // See SchemaLoader::loadCompiledTypeAndDependencies().\n    getLoader().loadCompiledTypeAndDependencies<T>();\n  }",
          "includes": [
            "#include <kj/string.h>",
            "#include \"schema-loader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string.h>\n#include \"schema-loader.h\"\n\nSchemaParser {\n  inline void loadCompiledTypeAndDependencies() {\n      // See SchemaLoader::loadCompiledTypeAndDependencies().\n      getLoader().loadCompiledTypeAndDependencies<T>();\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include \"schema-loader.h\"\n\nTEST(SchemaLoader, Incompatible) {\n  SchemaLoader loader;\n  loader.loadCompiledTypeAndDependencies<test::TestListDefaults>();\n  EXPECT_NONFATAL_FAILURE(\n      loadUnderAlternateTypeId<test::TestAllTypes>(loader, typeId<test::TestListDefaults>()));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-loader-test.c++",
    "lines": "210-225",
    "snippet": "TEST(SchemaLoader, Downgrade) {\n  SchemaLoader loader;\n\n  loader.loadCompiledTypeAndDependencies<test::TestNewVersion>();\n\n  StructSchema schema = loader.get(typeId<test::TestNewVersion>()).asStruct();\n\n  EXPECT_EQ(kj::str(Schema::from<test::TestNewVersion>().getProto()), kj::str(schema.getProto()));\n\n  loadUnderAlternateTypeId<test::TestOldVersion>(loader, typeId<test::TestNewVersion>());\n\n  // We kept the new version, because the replacement was older.\n  EXPECT_EQ(Schema::from<test::TestNewVersion>().getProto().getDisplayName(),\n            schema.getProto().getDisplayName());\n  schema.requireUsableAs<test::TestNewVersion>();\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include \"schema-loader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "schema.requireUsableAs<test::TestNewVersion>",
          "args": [],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "Schema::from<test::TestNewVersion>().getProto().getDisplayName()",
            "schema.getProto().getDisplayName()"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getProto",
          "args": [],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      },
      {
        "call_info": {
          "callee": "Schema::from<test::TestNewVersion>",
          "args": [],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "loadUnderAlternateTypeId<test::TestOldVersion>",
          "args": [
            "loader",
            "typeId<test::TestNewVersion>()"
          ],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "loadUnderAlternateTypeId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-loader-test.c++",
          "lines": "168-188",
          "snippet": "Schema loadUnderAlternateTypeId(SchemaLoader& loader, uint64_t id) {\n  MallocMessageBuilder schemaBuilder;\n  schemaBuilder.setRoot(Schema::from<T>().getProto());\n  auto root = schemaBuilder.getRoot<schema::Node>();\n  root.setId(id);\n\n  if (root.isStruct()) {\n    // If the struct contains any self-referential members, change their type IDs as well.\n    auto fields = root.getStruct().getFields();\n    for (auto field: fields) {\n      if (field.isSlot()) {\n        auto type = field.getSlot().getType();\n        if (type.isStruct() && type.getStruct().getTypeId() == typeId<T>()) {\n          type.getStruct().setTypeId(id);\n        }\n      }\n    }\n  }\n\n  return loader.load(root);\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"test-util.h\"",
            "#include <kj/compat/gtest.h>",
            "#include \"schema-loader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include \"schema-loader.h\"\n\nSchema loadUnderAlternateTypeId(SchemaLoader& loader, uint64_t id) {\n  MallocMessageBuilder schemaBuilder;\n  schemaBuilder.setRoot(Schema::from<T>().getProto());\n  auto root = schemaBuilder.getRoot<schema::Node>();\n  root.setId(id);\n\n  if (root.isStruct()) {\n    // If the struct contains any self-referential members, change their type IDs as well.\n    auto fields = root.getStruct().getFields();\n    for (auto field: fields) {\n      if (field.isSlot()) {\n        auto type = field.getSlot().getType();\n        if (type.isStruct() && type.getStruct().getTypeId() == typeId<T>()) {\n          type.getStruct().setTypeId(id);\n        }\n      }\n    }\n  }\n\n  return loader.load(root);\n}"
        }
      },
      {
        "call_info": {
          "callee": "typeId<test::TestNewVersion>",
          "args": [],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "typeId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "491-491",
          "snippet": "inline constexpr uint64_t typeId() { return id; }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\ninline constexpr uint64_t typeId() { return id; }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "kj::str(Schema::from<test::TestNewVersion>().getProto())",
            "kj::str(schema.getProto())"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "schema.getProto()"
          ],
          "line": 217
        },
        "resolved": true,
        "details": {
          "function_name": "str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "341-341",
          "snippet": "inline String str(String&& s) { return mv(s); }",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\ninline String str(String&& s) { return mv(s); }"
        }
      },
      {
        "call_info": {
          "callee": "loader.get",
          "args": [],
          "line": 215
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "loader.get",
          "args": [
            "typeId<test::TestNewVersion>()"
          ],
          "line": 215
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "868-871",
          "snippet": "static inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }"
        }
      },
      {
        "call_info": {
          "callee": "loader.loadCompiledTypeAndDependencies<test::TestNewVersion>",
          "args": [],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "loadCompiledTypeAndDependencies",
          "container": "SchemaParser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-parser.h",
          "lines": "81-84",
          "snippet": "inline void loadCompiledTypeAndDependencies() {\n    // See SchemaLoader::loadCompiledTypeAndDependencies().\n    getLoader().loadCompiledTypeAndDependencies<T>();\n  }",
          "includes": [
            "#include <kj/string.h>",
            "#include \"schema-loader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string.h>\n#include \"schema-loader.h\"\n\nSchemaParser {\n  inline void loadCompiledTypeAndDependencies() {\n      // See SchemaLoader::loadCompiledTypeAndDependencies().\n      getLoader().loadCompiledTypeAndDependencies<T>();\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include \"schema-loader.h\"\n\nTEST(SchemaLoader, Downgrade) {\n  SchemaLoader loader;\n\n  loader.loadCompiledTypeAndDependencies<test::TestNewVersion>();\n\n  StructSchema schema = loader.get(typeId<test::TestNewVersion>()).asStruct();\n\n  EXPECT_EQ(kj::str(Schema::from<test::TestNewVersion>().getProto()), kj::str(schema.getProto()));\n\n  loadUnderAlternateTypeId<test::TestOldVersion>(loader, typeId<test::TestNewVersion>());\n\n  // We kept the new version, because the replacement was older.\n  EXPECT_EQ(Schema::from<test::TestNewVersion>().getProto().getDisplayName(),\n            schema.getProto().getDisplayName());\n  schema.requireUsableAs<test::TestNewVersion>();\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-loader-test.c++",
    "lines": "190-208",
    "snippet": "TEST(SchemaLoader, Upgrade) {\n  SchemaLoader loader;\n\n  loader.loadCompiledTypeAndDependencies<test::TestOldVersion>();\n\n  StructSchema schema = loader.get(typeId<test::TestOldVersion>()).asStruct();\n\n  EXPECT_EQ(kj::str(Schema::from<test::TestOldVersion>().getProto()),\n            kj::str(schema.getProto()));\n\n  loadUnderAlternateTypeId<test::TestNewVersion>(loader, typeId<test::TestOldVersion>());\n\n  // The new version replaced the old.\n  EXPECT_EQ(Schema::from<test::TestNewVersion>().getProto().getDisplayName(),\n            schema.getProto().getDisplayName());\n\n  // But it is still usable as the old version.\n  schema.requireUsableAs<test::TestOldVersion>();\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include \"schema-loader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "schema.requireUsableAs<test::TestOldVersion>",
          "args": [],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "Schema::from<test::TestNewVersion>().getProto().getDisplayName()",
            "schema.getProto().getDisplayName()"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getProto",
          "args": [],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      },
      {
        "call_info": {
          "callee": "Schema::from<test::TestNewVersion>",
          "args": [],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "loadUnderAlternateTypeId<test::TestNewVersion>",
          "args": [
            "loader",
            "typeId<test::TestOldVersion>()"
          ],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "loadUnderAlternateTypeId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-loader-test.c++",
          "lines": "168-188",
          "snippet": "Schema loadUnderAlternateTypeId(SchemaLoader& loader, uint64_t id) {\n  MallocMessageBuilder schemaBuilder;\n  schemaBuilder.setRoot(Schema::from<T>().getProto());\n  auto root = schemaBuilder.getRoot<schema::Node>();\n  root.setId(id);\n\n  if (root.isStruct()) {\n    // If the struct contains any self-referential members, change their type IDs as well.\n    auto fields = root.getStruct().getFields();\n    for (auto field: fields) {\n      if (field.isSlot()) {\n        auto type = field.getSlot().getType();\n        if (type.isStruct() && type.getStruct().getTypeId() == typeId<T>()) {\n          type.getStruct().setTypeId(id);\n        }\n      }\n    }\n  }\n\n  return loader.load(root);\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"test-util.h\"",
            "#include <kj/compat/gtest.h>",
            "#include \"schema-loader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include \"schema-loader.h\"\n\nSchema loadUnderAlternateTypeId(SchemaLoader& loader, uint64_t id) {\n  MallocMessageBuilder schemaBuilder;\n  schemaBuilder.setRoot(Schema::from<T>().getProto());\n  auto root = schemaBuilder.getRoot<schema::Node>();\n  root.setId(id);\n\n  if (root.isStruct()) {\n    // If the struct contains any self-referential members, change their type IDs as well.\n    auto fields = root.getStruct().getFields();\n    for (auto field: fields) {\n      if (field.isSlot()) {\n        auto type = field.getSlot().getType();\n        if (type.isStruct() && type.getStruct().getTypeId() == typeId<T>()) {\n          type.getStruct().setTypeId(id);\n        }\n      }\n    }\n  }\n\n  return loader.load(root);\n}"
        }
      },
      {
        "call_info": {
          "callee": "typeId<test::TestOldVersion>",
          "args": [],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "typeId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "491-491",
          "snippet": "inline constexpr uint64_t typeId() { return id; }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\ninline constexpr uint64_t typeId() { return id; }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "kj::str(Schema::from<test::TestOldVersion>().getProto())",
            "kj::str(schema.getProto())"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "schema.getProto()"
          ],
          "line": 198
        },
        "resolved": true,
        "details": {
          "function_name": "str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "341-341",
          "snippet": "inline String str(String&& s) { return mv(s); }",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\ninline String str(String&& s) { return mv(s); }"
        }
      },
      {
        "call_info": {
          "callee": "loader.get",
          "args": [],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "loader.get",
          "args": [
            "typeId<test::TestOldVersion>()"
          ],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "868-871",
          "snippet": "static inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }"
        }
      },
      {
        "call_info": {
          "callee": "loader.loadCompiledTypeAndDependencies<test::TestOldVersion>",
          "args": [],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "loadCompiledTypeAndDependencies",
          "container": "SchemaParser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-parser.h",
          "lines": "81-84",
          "snippet": "inline void loadCompiledTypeAndDependencies() {\n    // See SchemaLoader::loadCompiledTypeAndDependencies().\n    getLoader().loadCompiledTypeAndDependencies<T>();\n  }",
          "includes": [
            "#include <kj/string.h>",
            "#include \"schema-loader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string.h>\n#include \"schema-loader.h\"\n\nSchemaParser {\n  inline void loadCompiledTypeAndDependencies() {\n      // See SchemaLoader::loadCompiledTypeAndDependencies().\n      getLoader().loadCompiledTypeAndDependencies<T>();\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include \"schema-loader.h\"\n\nTEST(SchemaLoader, Upgrade) {\n  SchemaLoader loader;\n\n  loader.loadCompiledTypeAndDependencies<test::TestOldVersion>();\n\n  StructSchema schema = loader.get(typeId<test::TestOldVersion>()).asStruct();\n\n  EXPECT_EQ(kj::str(Schema::from<test::TestOldVersion>().getProto()),\n            kj::str(schema.getProto()));\n\n  loadUnderAlternateTypeId<test::TestNewVersion>(loader, typeId<test::TestOldVersion>());\n\n  // The new version replaced the old.\n  EXPECT_EQ(Schema::from<test::TestNewVersion>().getProto().getDisplayName(),\n            schema.getProto().getDisplayName());\n\n  // But it is still usable as the old version.\n  schema.requireUsableAs<test::TestOldVersion>();\n}"
  },
  {
    "function_name": "loadUnderAlternateTypeId",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-loader-test.c++",
    "lines": "168-188",
    "snippet": "Schema loadUnderAlternateTypeId(SchemaLoader& loader, uint64_t id) {\n  MallocMessageBuilder schemaBuilder;\n  schemaBuilder.setRoot(Schema::from<T>().getProto());\n  auto root = schemaBuilder.getRoot<schema::Node>();\n  root.setId(id);\n\n  if (root.isStruct()) {\n    // If the struct contains any self-referential members, change their type IDs as well.\n    auto fields = root.getStruct().getFields();\n    for (auto field: fields) {\n      if (field.isSlot()) {\n        auto type = field.getSlot().getType();\n        if (type.isStruct() && type.getStruct().getTypeId() == typeId<T>()) {\n          type.getStruct().setTypeId(id);\n        }\n      }\n    }\n  }\n\n  return loader.load(root);\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include \"schema-loader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "loader.load",
          "args": [
            "root"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.getStruct",
          "args": [
            "id"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.getStruct",
          "args": [],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typeId<T>",
          "args": [],
          "line": 180
        },
        "resolved": true,
        "details": {
          "function_name": "typeId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "491-491",
          "snippet": "inline constexpr uint64_t typeId() { return id; }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\ninline constexpr uint64_t typeId() { return id; }"
        }
      },
      {
        "call_info": {
          "callee": "type.getStruct",
          "args": [],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.getStruct",
          "args": [],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.isStruct",
          "args": [],
          "line": 180
        },
        "resolved": true,
        "details": {
          "function_name": "isStruct",
          "container": "AnyPointer::Builder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "142-144",
          "snippet": "inline bool isStruct() {\n      return builder.isStruct();\n    }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nAnyPointer {\n  Builder {\n    inline bool isStruct() {\n          return builder.isStruct();\n        }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "field.getSlot",
          "args": [],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getSlot",
          "args": [],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.isSlot",
          "args": [],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getStruct",
          "args": [],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getStruct",
          "args": [],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.setId",
          "args": [
            "id"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schemaBuilder.getRoot<schema::Node>",
          "args": [],
          "line": 171
        },
        "resolved": true,
        "details": {
          "function_name": "getRoot",
          "container": "RpcRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1322-1324",
          "snippet": "inline AnyPointer::Builder getRoot() {\n      return paramsBuilder;\n    }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nRpcRequest {\n  inline AnyPointer::Builder getRoot() {\n        return paramsBuilder;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "schemaBuilder.setRoot",
          "args": [
            "Schema::from<T>().getProto()"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<T>",
          "args": [],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include \"schema-loader.h\"\n\nSchema loadUnderAlternateTypeId(SchemaLoader& loader, uint64_t id) {\n  MallocMessageBuilder schemaBuilder;\n  schemaBuilder.setRoot(Schema::from<T>().getProto());\n  auto root = schemaBuilder.getRoot<schema::Node>();\n  root.setId(id);\n\n  if (root.isStruct()) {\n    // If the struct contains any self-referential members, change their type IDs as well.\n    auto fields = root.getStruct().getFields();\n    for (auto field: fields) {\n      if (field.isSlot()) {\n        auto type = field.getSlot().getType();\n        if (type.isStruct() && type.getStruct().getTypeId() == typeId<T>()) {\n          type.getStruct().setTypeId(id);\n        }\n      }\n    }\n  }\n\n  return loader.load(root);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-loader-test.c++",
    "lines": "89-165",
    "snippet": "TEST(SchemaLoader, Use) {\n  SchemaLoader loader;\n\n  StructSchema schema = loader.load(Schema::from<TestAllTypes>().getProto()).asStruct();\n\n  // Also have to load TestEnum.\n  loader.load(Schema::from<TestEnum>().getProto());\n\n  {\n    MallocMessageBuilder builder;\n    auto root = builder.getRoot<DynamicStruct>(schema);\n\n    initDynamicTestMessage(root);\n    checkDynamicTestMessage(root.asReader());\n\n    // Can't convert to TestAllTypes because we didn't use loadCompiledTypeAndDependencies().\n    EXPECT_ANY_THROW(root.as<TestAllTypes>());\n\n    // But if we reinterpret the raw bytes, it works.\n    checkTestMessage(builder.getRoot<TestAllTypes>());\n  }\n\n  loader.loadCompiledTypeAndDependencies<TestAllTypes>();\n\n  {\n    MallocMessageBuilder builder;\n    auto root = builder.getRoot<DynamicStruct>(schema);\n\n    initDynamicTestMessage(root);\n\n    // Now we can actually cast.\n    checkTestMessage(root.as<TestAllTypes>());\n  }\n\n  // Let's also test TestListDefaults, but as we do so, let's load the compiled types first, to\n  // make sure the opposite order works.\n\n  loader.loadCompiledTypeAndDependencies<TestListDefaults>();\n  StructSchema testListsSchema = loader.get(typeId<TestListDefaults>()).asStruct();\n  EXPECT_TRUE(testListsSchema != Schema::from<TestListDefaults>());\n\n  {\n    MallocMessageBuilder builder;\n    auto root = builder.getRoot<DynamicStruct>(testListsSchema);\n\n    initDynamicTestLists(root);\n    checkDynamicTestLists(root.asReader());\n\n    checkTestMessage(root.as<TestListDefaults>());\n  }\n\n  EXPECT_TRUE(loader.load(Schema::from<TestListDefaults>().getProto()) == testListsSchema);\n\n  {\n    MallocMessageBuilder builder;\n    auto root = builder.getRoot<DynamicStruct>(testListsSchema);\n\n    initDynamicTestLists(root);\n    checkTestMessage(root.as<TestListDefaults>());\n  }\n\n  // Finally, let's test some unions.\n  StructSchema unionSchema = loader.load(Schema::from<TestUnion>().getProto()).asStruct();\n  loader.load(Schema::from<TestUnion::Union0>().getProto());\n  loader.load(Schema::from<TestUnion::Union1>().getProto());\n  {\n    MallocMessageBuilder builder;\n    auto root = builder.getRoot<DynamicStruct>(unionSchema);\n\n    root.get(\"union0\").as<DynamicStruct>().set(\"u0f1s16\", 123);\n    root.get(\"union1\").as<DynamicStruct>().set(\"u1f0sp\", \"hello\");\n\n    auto reader = builder.getRoot<TestUnion>().asReader();\n    EXPECT_EQ(123, reader.getUnion0().getU0f1s16());\n    EXPECT_EQ(\"hello\", reader.getUnion1().getU1f0sp());\n  }\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include \"schema-loader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"hello\"",
            "reader.getUnion1().getU1f0sp()"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getUnion1",
          "args": [],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getUnion1",
          "args": [],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "123",
            "reader.getUnion0().getU0f1s16()"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getUnion0",
          "args": [],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getUnion0",
          "args": [],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getRoot<TestUnion>",
          "args": [],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "getRoot",
          "container": "RpcRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1322-1324",
          "snippet": "inline AnyPointer::Builder getRoot() {\n      return paramsBuilder;\n    }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nRpcRequest {\n  inline AnyPointer::Builder getRoot() {\n        return paramsBuilder;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "root.get",
          "args": [
            "\"u1f0sp\"",
            "\"hello\""
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.get",
          "args": [],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "root.get",
          "args": [
            "\"union1\""
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "868-871",
          "snippet": "static inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }"
        }
      },
      {
        "call_info": {
          "callee": "root.get",
          "args": [
            "\"u0f1s16\"",
            "123"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getRoot<DynamicStruct>",
          "args": [
            "unionSchema"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loader.load",
          "args": [
            "Schema::from<TestUnion::Union1>().getProto()"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<TestUnion::Union1>",
          "args": [],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "loader.load",
          "args": [
            "Schema::from<TestUnion::Union0>().getProto()"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loader.load",
          "args": [],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loader.load",
          "args": [
            "Schema::from<TestUnion>().getProto()"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "root.as<TestListDefaults>()"
          ],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "root.as<TestListDefaults>",
          "args": [],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "as",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "601-604",
          "snippet": "BuilderFor<T> as() {\n    // T must be List<U>.\n    return BuilderFor<T>(_builder);\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nBuilderFor<T> as() {\n    // T must be List<U>.\n    return BuilderFor<T>(_builder);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "initDynamicTestLists",
          "args": [
            "root"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "initDynamicTestLists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "858-860",
          "snippet": "void initDynamicTestLists(DynamicStruct::Builder builder) {\n  dynamicInitListDefaults(builder);\n}",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initDynamicTestLists(DynamicStruct::Builder builder) {\n  dynamicInitListDefaults(builder);\n}"
        }
      },
      {
        "call_info": {
          "callee": "builder.getRoot<DynamicStruct>",
          "args": [
            "testListsSchema"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "loader.load(Schema::from<TestListDefaults>().getProto()) == testListsSchema"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loader.load",
          "args": [
            "Schema::from<TestListDefaults>().getProto()"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "checkDynamicTestLists",
          "args": [
            "root.asReader()"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "checkDynamicTestLists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "870-872",
          "snippet": "void checkDynamicTestLists(DynamicStruct::Reader reader) {\n  dynamicCheckListDefaults(reader);\n}",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkDynamicTestLists(DynamicStruct::Reader reader) {\n  dynamicCheckListDefaults(reader);\n}"
        }
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      },
      {
        "call_info": {
          "callee": "builder.getRoot<DynamicStruct>",
          "args": [
            "testListsSchema"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "testListsSchema != Schema::from<TestListDefaults>()"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typeId<TestListDefaults>",
          "args": [],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "typeId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "491-491",
          "snippet": "inline constexpr uint64_t typeId() { return id; }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\ninline constexpr uint64_t typeId() { return id; }"
        }
      },
      {
        "call_info": {
          "callee": "loader.loadCompiledTypeAndDependencies<TestListDefaults>",
          "args": [],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "loadCompiledTypeAndDependencies",
          "container": "SchemaParser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-parser.h",
          "lines": "81-84",
          "snippet": "inline void loadCompiledTypeAndDependencies() {\n    // See SchemaLoader::loadCompiledTypeAndDependencies().\n    getLoader().loadCompiledTypeAndDependencies<T>();\n  }",
          "includes": [
            "#include <kj/string.h>",
            "#include \"schema-loader.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string.h>\n#include \"schema-loader.h\"\n\nSchemaParser {\n  inline void loadCompiledTypeAndDependencies() {\n      // See SchemaLoader::loadCompiledTypeAndDependencies().\n      getLoader().loadCompiledTypeAndDependencies<T>();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "initDynamicTestMessage",
          "args": [
            "root"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "initDynamicTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "855-857",
          "snippet": "void initDynamicTestMessage(DynamicStruct::Builder builder) {\n  dynamicInitTestMessage(builder);\n}",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initDynamicTestMessage(DynamicStruct::Builder builder) {\n  dynamicInitTestMessage(builder);\n}"
        }
      },
      {
        "call_info": {
          "callee": "builder.getRoot<DynamicStruct>",
          "args": [
            "schema"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_ANY_THROW",
          "args": [
            "root.as<TestAllTypes>()"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "checkDynamicTestMessage",
          "args": [
            "root.asReader()"
          ],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "checkDynamicTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "867-869",
          "snippet": "void checkDynamicTestMessage(DynamicStruct::Reader reader) {\n  dynamicCheckTestMessage(reader);\n}",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkDynamicTestMessage(DynamicStruct::Reader reader) {\n  dynamicCheckTestMessage(reader);\n}"
        }
      },
      {
        "call_info": {
          "callee": "builder.getRoot<DynamicStruct>",
          "args": [
            "schema"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loader.load",
          "args": [
            "Schema::from<TestEnum>().getProto()"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loader.load",
          "args": [],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loader.load",
          "args": [
            "Schema::from<TestAllTypes>().getProto()"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include \"schema-loader.h\"\n\nTEST(SchemaLoader, Use) {\n  SchemaLoader loader;\n\n  StructSchema schema = loader.load(Schema::from<TestAllTypes>().getProto()).asStruct();\n\n  // Also have to load TestEnum.\n  loader.load(Schema::from<TestEnum>().getProto());\n\n  {\n    MallocMessageBuilder builder;\n    auto root = builder.getRoot<DynamicStruct>(schema);\n\n    initDynamicTestMessage(root);\n    checkDynamicTestMessage(root.asReader());\n\n    // Can't convert to TestAllTypes because we didn't use loadCompiledTypeAndDependencies().\n    EXPECT_ANY_THROW(root.as<TestAllTypes>());\n\n    // But if we reinterpret the raw bytes, it works.\n    checkTestMessage(builder.getRoot<TestAllTypes>());\n  }\n\n  loader.loadCompiledTypeAndDependencies<TestAllTypes>();\n\n  {\n    MallocMessageBuilder builder;\n    auto root = builder.getRoot<DynamicStruct>(schema);\n\n    initDynamicTestMessage(root);\n\n    // Now we can actually cast.\n    checkTestMessage(root.as<TestAllTypes>());\n  }\n\n  // Let's also test TestListDefaults, but as we do so, let's load the compiled types first, to\n  // make sure the opposite order works.\n\n  loader.loadCompiledTypeAndDependencies<TestListDefaults>();\n  StructSchema testListsSchema = loader.get(typeId<TestListDefaults>()).asStruct();\n  EXPECT_TRUE(testListsSchema != Schema::from<TestListDefaults>());\n\n  {\n    MallocMessageBuilder builder;\n    auto root = builder.getRoot<DynamicStruct>(testListsSchema);\n\n    initDynamicTestLists(root);\n    checkDynamicTestLists(root.asReader());\n\n    checkTestMessage(root.as<TestListDefaults>());\n  }\n\n  EXPECT_TRUE(loader.load(Schema::from<TestListDefaults>().getProto()) == testListsSchema);\n\n  {\n    MallocMessageBuilder builder;\n    auto root = builder.getRoot<DynamicStruct>(testListsSchema);\n\n    initDynamicTestLists(root);\n    checkTestMessage(root.as<TestListDefaults>());\n  }\n\n  // Finally, let's test some unions.\n  StructSchema unionSchema = loader.load(Schema::from<TestUnion>().getProto()).asStruct();\n  loader.load(Schema::from<TestUnion::Union0>().getProto());\n  loader.load(Schema::from<TestUnion::Union1>().getProto());\n  {\n    MallocMessageBuilder builder;\n    auto root = builder.getRoot<DynamicStruct>(unionSchema);\n\n    root.get(\"union0\").as<DynamicStruct>().set(\"u0f1s16\", 123);\n    root.get(\"union1\").as<DynamicStruct>().set(\"u1f0sp\", \"hello\");\n\n    auto reader = builder.getRoot<TestUnion>().asReader();\n    EXPECT_EQ(123, reader.getUnion0().getU0f1s16());\n    EXPECT_EQ(\"hello\", reader.getUnion1().getU1f0sp());\n  }\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-loader-test.c++",
    "lines": "75-87",
    "snippet": "TEST(SchemaLoader, LoadUnnamedUnion) {\n  SchemaLoader loader;\n\n  StructSchema schema =\n      loader.load(Schema::from<test::TestUnnamedUnion>().getProto()).asStruct();\n\n  EXPECT_TRUE(schema.findFieldByName(\"\") == nullptr);\n\n  EXPECT_TRUE(schema.findFieldByName(\"foo\") != nullptr);\n  EXPECT_TRUE(schema.findFieldByName(\"bar\") != nullptr);\n  EXPECT_TRUE(schema.findFieldByName(\"before\") != nullptr);\n  EXPECT_TRUE(schema.findFieldByName(\"after\") != nullptr);\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include \"schema-loader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.findFieldByName(\"after\") != nullptr"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.findFieldByName",
          "args": [
            "\"after\""
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.findFieldByName(\"before\") != nullptr"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.findFieldByName",
          "args": [
            "\"before\""
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.findFieldByName(\"bar\") != nullptr"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.findFieldByName",
          "args": [
            "\"bar\""
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.findFieldByName(\"foo\") != nullptr"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.findFieldByName",
          "args": [
            "\"foo\""
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.findFieldByName(\"\") == nullptr"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.findFieldByName",
          "args": [
            "\"\""
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loader.load",
          "args": [],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loader.load",
          "args": [
            "Schema::from<test::TestUnnamedUnion>().getProto()"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<test::TestUnnamedUnion>",
          "args": [],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include \"schema-loader.h\"\n\nTEST(SchemaLoader, LoadUnnamedUnion) {\n  SchemaLoader loader;\n\n  StructSchema schema =\n      loader.load(Schema::from<test::TestUnnamedUnion>().getProto()).asStruct();\n\n  EXPECT_TRUE(schema.findFieldByName(\"\") == nullptr);\n\n  EXPECT_TRUE(schema.findFieldByName(\"foo\") != nullptr);\n  EXPECT_TRUE(schema.findFieldByName(\"bar\") != nullptr);\n  EXPECT_TRUE(schema.findFieldByName(\"before\") != nullptr);\n  EXPECT_TRUE(schema.findFieldByName(\"after\") != nullptr);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-loader-test.c++",
    "lines": "57-73",
    "snippet": "TEST(SchemaLoader, LoadLateUnion) {\n  SchemaLoader loader;\n\n  StructSchema schema =\n      loader.load(Schema::from<test::TestLateUnion>().getProto()).asStruct();\n  loader.load(Schema::from<test::TestLateUnion::TheUnion>().getProto()).asStruct();\n  loader.load(Schema::from<test::TestLateUnion::AnotherUnion>().getProto()).asStruct();\n\n  EXPECT_EQ(6,\n      schema.getDependency(schema.getFieldByName(\"theUnion\").getProto().getGroup().getTypeId())\n            .asStruct().getFieldByName(\"grault\").getProto().getOrdinal().getExplicit());\n  EXPECT_EQ(9,\n      schema.getDependency(schema.getFieldByName(\"anotherUnion\").getProto().getGroup().getTypeId())\n            .asStruct().getFieldByName(\"corge\").getProto().getOrdinal().getExplicit());\n  EXPECT_TRUE(schema.findFieldByName(\"corge\") == nullptr);\n  EXPECT_TRUE(schema.findFieldByName(\"grault\") == nullptr);\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include \"schema-loader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.findFieldByName(\"grault\") == nullptr"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.findFieldByName",
          "args": [
            "\"grault\""
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.findFieldByName(\"corge\") == nullptr"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.findFieldByName",
          "args": [
            "\"corge\""
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "9",
            "schema.getDependency(schema.getFieldByName(\"anotherUnion\").getProto().getGroup().getTypeId())\n            .asStruct().getFieldByName(\"corge\").getProto().getOrdinal().getExplicit()"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getDependency",
          "args": [],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getDependency",
          "args": [],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getDependency",
          "args": [],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getDependency",
          "args": [
            "\"corge\""
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getDependency",
          "args": [],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getDependency",
          "args": [
            "schema.getFieldByName(\"anotherUnion\").getProto().getGroup().getTypeId()"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [
            "\"anotherUnion\""
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "6",
            "schema.getDependency(schema.getFieldByName(\"theUnion\").getProto().getGroup().getTypeId())\n            .asStruct().getFieldByName(\"grault\").getProto().getOrdinal().getExplicit()"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getDependency",
          "args": [],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getDependency",
          "args": [],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getDependency",
          "args": [],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getDependency",
          "args": [
            "\"grault\""
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getDependency",
          "args": [],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getDependency",
          "args": [
            "schema.getFieldByName(\"theUnion\").getProto().getGroup().getTypeId()"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [
            "\"theUnion\""
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loader.load",
          "args": [],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loader.load",
          "args": [
            "Schema::from<test::TestLateUnion::AnotherUnion>().getProto()"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<test::TestLateUnion::AnotherUnion>",
          "args": [],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "loader.load",
          "args": [],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loader.load",
          "args": [
            "Schema::from<test::TestLateUnion::TheUnion>().getProto()"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loader.load",
          "args": [],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loader.load",
          "args": [
            "Schema::from<test::TestLateUnion>().getProto()"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include \"schema-loader.h\"\n\nTEST(SchemaLoader, LoadLateUnion) {\n  SchemaLoader loader;\n\n  StructSchema schema =\n      loader.load(Schema::from<test::TestLateUnion>().getProto()).asStruct();\n  loader.load(Schema::from<test::TestLateUnion::TheUnion>().getProto()).asStruct();\n  loader.load(Schema::from<test::TestLateUnion::AnotherUnion>().getProto()).asStruct();\n\n  EXPECT_EQ(6,\n      schema.getDependency(schema.getFieldByName(\"theUnion\").getProto().getGroup().getTypeId())\n            .asStruct().getFieldByName(\"grault\").getProto().getOrdinal().getExplicit());\n  EXPECT_EQ(9,\n      schema.getDependency(schema.getFieldByName(\"anotherUnion\").getProto().getGroup().getTypeId())\n            .asStruct().getFieldByName(\"corge\").getProto().getOrdinal().getExplicit());\n  EXPECT_TRUE(schema.findFieldByName(\"corge\") == nullptr);\n  EXPECT_TRUE(schema.findFieldByName(\"grault\") == nullptr);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-loader-test.c++",
    "lines": "31-55",
    "snippet": "TEST(SchemaLoader, Load) {\n  SchemaLoader loader;\n\n  Schema struct32Schema = loader.load(Schema::from<test::TestLists::Struct32>().getProto());\n\n  auto nativeSchema = Schema::from<test::TestLists>();\n  Schema testListsSchema = loader.load(nativeSchema.getProto());\n\n  Schema struct8Schema = loader.load(Schema::from<test::TestLists::Struct8>().getProto());\n  Schema structPSchema = loader.load(Schema::from<test::TestLists::StructP>().getProto());\n\n  EXPECT_EQ(kj::str(nativeSchema.getProto()), kj::str(testListsSchema.getProto()));\n\n  EXPECT_FALSE(testListsSchema == nativeSchema);\n  EXPECT_FALSE(struct32Schema == Schema::from<test::TestLists::Struct32>());\n  EXPECT_FALSE(struct8Schema == Schema::from<test::TestLists::Struct8>());\n  EXPECT_FALSE(structPSchema == Schema::from<test::TestLists::StructP>());\n\n  EXPECT_TRUE(testListsSchema.getDependency(typeId<test::TestLists::Struct32>()) == struct32Schema);\n  EXPECT_TRUE(testListsSchema.getDependency(typeId<test::TestLists::Struct8>()) == struct8Schema);\n  EXPECT_TRUE(testListsSchema.getDependency(typeId<test::TestLists::StructP>()) == structPSchema);\n\n  auto struct16Schema = testListsSchema.getDependency(typeId<test::TestLists::Struct16>());\n  EXPECT_EQ(0u, struct16Schema.getProto().getStruct().getFields().size());\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include \"schema-loader.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "0u",
            "struct16Schema.getProto().getStruct().getFields().size()"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "struct16Schema.getProto",
          "args": [],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      },
      {
        "call_info": {
          "callee": "testListsSchema.getDependency",
          "args": [
            "typeId<test::TestLists::Struct16>()"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typeId<test::TestLists::Struct16>",
          "args": [],
          "line": 53
        },
        "resolved": true,
        "details": {
          "function_name": "typeId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "491-491",
          "snippet": "inline constexpr uint64_t typeId() { return id; }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\ninline constexpr uint64_t typeId() { return id; }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "testListsSchema.getDependency(typeId<test::TestLists::StructP>()) == structPSchema"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "testListsSchema.getDependency",
          "args": [
            "typeId<test::TestLists::StructP>()"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "testListsSchema.getDependency(typeId<test::TestLists::Struct8>()) == struct8Schema"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "testListsSchema.getDependency",
          "args": [
            "typeId<test::TestLists::Struct8>()"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "testListsSchema.getDependency(typeId<test::TestLists::Struct32>()) == struct32Schema"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "testListsSchema.getDependency",
          "args": [
            "typeId<test::TestLists::Struct32>()"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "structPSchema == Schema::from<test::TestLists::StructP>()"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<test::TestLists::StructP>",
          "args": [],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "struct8Schema == Schema::from<test::TestLists::Struct8>()"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "struct32Schema == Schema::from<test::TestLists::Struct32>()"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "testListsSchema == nativeSchema"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "kj::str(nativeSchema.getProto())",
            "kj::str(testListsSchema.getProto())"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "testListsSchema.getProto()"
          ],
          "line": 42
        },
        "resolved": true,
        "details": {
          "function_name": "str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "341-341",
          "snippet": "inline String str(String&& s) { return mv(s); }",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\ninline String str(String&& s) { return mv(s); }"
        }
      },
      {
        "call_info": {
          "callee": "loader.load",
          "args": [
            "Schema::from<test::TestLists::StructP>().getProto()"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loader.load",
          "args": [
            "Schema::from<test::TestLists::Struct8>().getProto()"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loader.load",
          "args": [
            "nativeSchema.getProto()"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loader.load",
          "args": [
            "Schema::from<test::TestLists::Struct32>().getProto()"
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include \"schema-loader.h\"\n\nTEST(SchemaLoader, Load) {\n  SchemaLoader loader;\n\n  Schema struct32Schema = loader.load(Schema::from<test::TestLists::Struct32>().getProto());\n\n  auto nativeSchema = Schema::from<test::TestLists>();\n  Schema testListsSchema = loader.load(nativeSchema.getProto());\n\n  Schema struct8Schema = loader.load(Schema::from<test::TestLists::Struct8>().getProto());\n  Schema structPSchema = loader.load(Schema::from<test::TestLists::StructP>().getProto());\n\n  EXPECT_EQ(kj::str(nativeSchema.getProto()), kj::str(testListsSchema.getProto()));\n\n  EXPECT_FALSE(testListsSchema == nativeSchema);\n  EXPECT_FALSE(struct32Schema == Schema::from<test::TestLists::Struct32>());\n  EXPECT_FALSE(struct8Schema == Schema::from<test::TestLists::Struct8>());\n  EXPECT_FALSE(structPSchema == Schema::from<test::TestLists::StructP>());\n\n  EXPECT_TRUE(testListsSchema.getDependency(typeId<test::TestLists::Struct32>()) == struct32Schema);\n  EXPECT_TRUE(testListsSchema.getDependency(typeId<test::TestLists::Struct8>()) == struct8Schema);\n  EXPECT_TRUE(testListsSchema.getDependency(typeId<test::TestLists::StructP>()) == structPSchema);\n\n  auto struct16Schema = testListsSchema.getDependency(typeId<test::TestLists::Struct16>());\n  EXPECT_EQ(0u, struct16Schema.getProto().getStruct().getFields().size());\n}"
  }
]