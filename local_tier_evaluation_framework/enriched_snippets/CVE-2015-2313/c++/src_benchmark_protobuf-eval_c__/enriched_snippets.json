[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/protobuf-eval.c++",
    "lines": "114-118",
    "snippet": "int main(int argc, char* argv[]) {\n  return capnp::benchmark::benchmarkMain<\n      capnp::benchmark::protobuf::BenchmarkTypes,\n      capnp::benchmark::protobuf::ExpressionTestCase>(argc, argv);\n}",
    "includes": [
      "#include \"protobuf-common.h\"",
      "#include \"eval.pb.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "capnp::benchmark::benchmarkMain<\n      capnp::benchmark::protobuf::BenchmarkTypes,\n      capnp::benchmark::protobuf::ExpressionTestCase>",
          "args": [
            "argc",
            "argv"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "benchmarkMain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/common.h",
          "lines": "281-292",
          "snippet": "int benchmarkMain(int argc, char* argv[]) {\n  if (argc != 5) {\n    fprintf(stderr, \"USAGE:  %s MODE REUSE COMPRESSION ITERATION_COUNT\\n\", argv[0]);\n    return 1;\n  }\n\n  uint64_t iters = strtoull(argv[4], nullptr, 0);\n  uint64_t throughput = doBenchmark3<BenchmarkTypes, TestCase>(argv[1], argv[2], argv[3], iters);\n  fprintf(stdout, \"%llu\\n\", (long long unsigned int)throughput);\n\n  return 0;\n}",
          "includes": [
            "#include <vector>",
            "#include <string>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdexcept>",
            "#include <algorithm>",
            "#include <semaphore.h>",
            "#include <stdlib.h>",
            "#include <sys/wait.h>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include <errno.h>",
            "#include <limits>",
            "#include <unistd.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <stdio.h>\n#include <stdexcept>\n#include <algorithm>\n#include <semaphore.h>\n#include <stdlib.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include <errno.h>\n#include <limits>\n#include <unistd.h>\n\nint benchmarkMain(int argc, char* argv[]) {\n  if (argc != 5) {\n    fprintf(stderr, \"USAGE:  %s MODE REUSE COMPRESSION ITERATION_COUNT\\n\", argv[0]);\n    return 1;\n  }\n\n  uint64_t iters = strtoull(argv[4], nullptr, 0);\n  uint64_t throughput = doBenchmark3<BenchmarkTypes, TestCase>(argv[1], argv[2], argv[3], iters);\n  fprintf(stdout, \"%llu\\n\", (long long unsigned int)throughput);\n\n  return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"protobuf-common.h\"\n#include \"eval.pb.h\"\n\nint main(int argc, char* argv[]) {\n  return capnp::benchmark::benchmarkMain<\n      capnp::benchmark::protobuf::BenchmarkTypes,\n      capnp::benchmark::protobuf::ExpressionTestCase>(argc, argv);\n}"
  },
  {
    "function_name": "checkResponse",
    "container": "ExpressionTestCase",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/protobuf-eval.c++",
    "lines": "105-107",
    "snippet": "static inline bool checkResponse(const EvaluationResult& response, int32_t expected) {\n    return response.value() == expected;\n  }",
    "includes": [
      "#include \"protobuf-common.h\"",
      "#include \"eval.pb.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "response.value",
          "args": [],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"protobuf-common.h\"\n#include \"eval.pb.h\"\n\nExpressionTestCase {\n  static inline bool checkResponse(const EvaluationResult& response, int32_t expected) {\n      return response.value() == expected;\n    }\n}"
  },
  {
    "function_name": "handleRequest",
    "container": "ExpressionTestCase",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/protobuf-eval.c++",
    "lines": "102-104",
    "snippet": "static inline void handleRequest(const Expression& request, EvaluationResult* response) {\n    response->set_value(evaluateExpression(request));\n  }",
    "includes": [
      "#include \"protobuf-common.h\"",
      "#include \"eval.pb.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "response->set_value",
          "args": [
            "evaluateExpression(request)"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "evaluateExpression",
          "args": [
            "request"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "evaluateExpression",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/protobuf-eval.c++",
          "lines": "63-91",
          "snippet": "int32_t evaluateExpression(const Expression& exp) {\n  uint32_t left, right;\n\n  if (exp.has_left_value()) {\n    left = exp.left_value();\n  } else {\n    left = evaluateExpression(exp.left_expression());\n  }\n\n  if (exp.has_right_value()) {\n    right = exp.right_value();\n  } else {\n    right = evaluateExpression(exp.right_expression());\n  }\n\n  switch (exp.op()) {\n    case Operation::ADD:\n      return left + right;\n    case Operation::SUBTRACT:\n      return left - right;\n    case Operation::MULTIPLY:\n      return left * right;\n    case Operation::DIVIDE:\n      return div(left, right);\n    case Operation::MODULUS:\n      return mod(left, right);\n  }\n  throw std::logic_error(\"Can't get here.\");\n}",
          "includes": [
            "#include \"protobuf-common.h\"",
            "#include \"eval.pb.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"protobuf-common.h\"\n#include \"eval.pb.h\"\n\nint32_t evaluateExpression(const Expression& exp) {\n  uint32_t left, right;\n\n  if (exp.has_left_value()) {\n    left = exp.left_value();\n  } else {\n    left = evaluateExpression(exp.left_expression());\n  }\n\n  if (exp.has_right_value()) {\n    right = exp.right_value();\n  } else {\n    right = evaluateExpression(exp.right_expression());\n  }\n\n  switch (exp.op()) {\n    case Operation::ADD:\n      return left + right;\n    case Operation::SUBTRACT:\n      return left - right;\n    case Operation::MULTIPLY:\n      return left * right;\n    case Operation::DIVIDE:\n      return div(left, right);\n    case Operation::MODULUS:\n      return mod(left, right);\n  }\n  throw std::logic_error(\"Can't get here.\");\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"protobuf-common.h\"\n#include \"eval.pb.h\"\n\nExpressionTestCase {\n  static inline void handleRequest(const Expression& request, EvaluationResult* response) {\n      response->set_value(evaluateExpression(request));\n    }\n}"
  },
  {
    "function_name": "setupRequest",
    "container": "ExpressionTestCase",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/protobuf-eval.c++",
    "lines": "99-101",
    "snippet": "static inline int32_t setupRequest(Expression* request) {\n    return makeExpression(request, 0);\n  }",
    "includes": [
      "#include \"protobuf-common.h\"",
      "#include \"eval.pb.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "makeExpression",
          "args": [
            "request",
            "0"
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "makeExpression",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/protobuf-eval.c++",
          "lines": "29-61",
          "snippet": "int32_t makeExpression(Expression* exp, uint depth) {\n  exp->set_op((Operation)(fastRand(Operation_MAX + 1)));\n\n  int32_t left, right;\n\n  if (fastRand(8) < depth) {\n    left = fastRand(128) + 1;\n    exp->set_left_value(left);\n  } else {\n    left = makeExpression(exp->mutable_left_expression(), depth + 1);\n  }\n\n  if (fastRand(8) < depth) {\n    right = fastRand(128) + 1;\n    exp->set_right_value(right);\n  } else {\n    right = makeExpression(exp->mutable_right_expression(), depth + 1);\n  }\n\n  switch (exp->op()) {\n    case Operation::ADD:\n      return left + right;\n    case Operation::SUBTRACT:\n      return left - right;\n    case Operation::MULTIPLY:\n      return left * right;\n    case Operation::DIVIDE:\n      return div(left, right);\n    case Operation::MODULUS:\n      return mod(left, right);\n  }\n  throw std::logic_error(\"Can't get here.\");\n}",
          "includes": [
            "#include \"protobuf-common.h\"",
            "#include \"eval.pb.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"protobuf-common.h\"\n#include \"eval.pb.h\"\n\nint32_t makeExpression(Expression* exp, uint depth) {\n  exp->set_op((Operation)(fastRand(Operation_MAX + 1)));\n\n  int32_t left, right;\n\n  if (fastRand(8) < depth) {\n    left = fastRand(128) + 1;\n    exp->set_left_value(left);\n  } else {\n    left = makeExpression(exp->mutable_left_expression(), depth + 1);\n  }\n\n  if (fastRand(8) < depth) {\n    right = fastRand(128) + 1;\n    exp->set_right_value(right);\n  } else {\n    right = makeExpression(exp->mutable_right_expression(), depth + 1);\n  }\n\n  switch (exp->op()) {\n    case Operation::ADD:\n      return left + right;\n    case Operation::SUBTRACT:\n      return left - right;\n    case Operation::MULTIPLY:\n      return left * right;\n    case Operation::DIVIDE:\n      return div(left, right);\n    case Operation::MODULUS:\n      return mod(left, right);\n  }\n  throw std::logic_error(\"Can't get here.\");\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"protobuf-common.h\"\n#include \"eval.pb.h\"\n\nExpressionTestCase {\n  static inline int32_t setupRequest(Expression* request) {\n      return makeExpression(request, 0);\n    }\n}"
  },
  {
    "function_name": "evaluateExpression",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/protobuf-eval.c++",
    "lines": "63-91",
    "snippet": "int32_t evaluateExpression(const Expression& exp) {\n  uint32_t left, right;\n\n  if (exp.has_left_value()) {\n    left = exp.left_value();\n  } else {\n    left = evaluateExpression(exp.left_expression());\n  }\n\n  if (exp.has_right_value()) {\n    right = exp.right_value();\n  } else {\n    right = evaluateExpression(exp.right_expression());\n  }\n\n  switch (exp.op()) {\n    case Operation::ADD:\n      return left + right;\n    case Operation::SUBTRACT:\n      return left - right;\n    case Operation::MULTIPLY:\n      return left * right;\n    case Operation::DIVIDE:\n      return div(left, right);\n    case Operation::MODULUS:\n      return mod(left, right);\n  }\n  throw std::logic_error(\"Can't get here.\");\n}",
    "includes": [
      "#include \"protobuf-common.h\"",
      "#include \"eval.pb.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::logic_error",
          "args": [
            "\"Can't get here.\""
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mod",
          "args": [
            "left",
            "right"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "mod",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/common.h",
          "lines": "81-88",
          "snippet": "inline int32_t mod(int32_t a, int32_t b) {\n  if (b == 0) return std::numeric_limits<int32_t>::max();\n  // INT_MIN % -1 => SIGFPE.  Who knew?\n  if (a == std::numeric_limits<int32_t>::min() && b == -1) {\n    return std::numeric_limits<int32_t>::max();\n  }\n  return a % b;\n}",
          "includes": [
            "#include <vector>",
            "#include <string>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdexcept>",
            "#include <algorithm>",
            "#include <semaphore.h>",
            "#include <stdlib.h>",
            "#include <sys/wait.h>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include <errno.h>",
            "#include <limits>",
            "#include <unistd.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <stdio.h>\n#include <stdexcept>\n#include <algorithm>\n#include <semaphore.h>\n#include <stdlib.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include <errno.h>\n#include <limits>\n#include <unistd.h>\n\ninline int32_t mod(int32_t a, int32_t b) {\n  if (b == 0) return std::numeric_limits<int32_t>::max();\n  // INT_MIN % -1 => SIGFPE.  Who knew?\n  if (a == std::numeric_limits<int32_t>::min() && b == -1) {\n    return std::numeric_limits<int32_t>::max();\n  }\n  return a % b;\n}"
        }
      },
      {
        "call_info": {
          "callee": "div",
          "args": [
            "left",
            "right"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "div",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/common.h",
          "lines": "72-79",
          "snippet": "inline int32_t div(int32_t a, int32_t b) {\n  if (b == 0) return std::numeric_limits<int32_t>::max();\n  // INT_MIN / -1 => SIGFPE.  Who knew?\n  if (a == std::numeric_limits<int32_t>::min() && b == -1) {\n    return std::numeric_limits<int32_t>::max();\n  }\n  return a / b;\n}",
          "includes": [
            "#include <vector>",
            "#include <string>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdexcept>",
            "#include <algorithm>",
            "#include <semaphore.h>",
            "#include <stdlib.h>",
            "#include <sys/wait.h>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include <errno.h>",
            "#include <limits>",
            "#include <unistd.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <stdio.h>\n#include <stdexcept>\n#include <algorithm>\n#include <semaphore.h>\n#include <stdlib.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include <errno.h>\n#include <limits>\n#include <unistd.h>\n\ninline int32_t div(int32_t a, int32_t b) {\n  if (b == 0) return std::numeric_limits<int32_t>::max();\n  // INT_MIN / -1 => SIGFPE.  Who knew?\n  if (a == std::numeric_limits<int32_t>::min() && b == -1) {\n    return std::numeric_limits<int32_t>::max();\n  }\n  return a / b;\n}"
        }
      },
      {
        "call_info": {
          "callee": "exp.op",
          "args": [],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exp.right_expression",
          "args": [],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exp.right_value",
          "args": [],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exp.has_right_value",
          "args": [],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exp.left_expression",
          "args": [],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exp.left_value",
          "args": [],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exp.has_left_value",
          "args": [],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"protobuf-common.h\"\n#include \"eval.pb.h\"\n\nint32_t evaluateExpression(const Expression& exp) {\n  uint32_t left, right;\n\n  if (exp.has_left_value()) {\n    left = exp.left_value();\n  } else {\n    left = evaluateExpression(exp.left_expression());\n  }\n\n  if (exp.has_right_value()) {\n    right = exp.right_value();\n  } else {\n    right = evaluateExpression(exp.right_expression());\n  }\n\n  switch (exp.op()) {\n    case Operation::ADD:\n      return left + right;\n    case Operation::SUBTRACT:\n      return left - right;\n    case Operation::MULTIPLY:\n      return left * right;\n    case Operation::DIVIDE:\n      return div(left, right);\n    case Operation::MODULUS:\n      return mod(left, right);\n  }\n  throw std::logic_error(\"Can't get here.\");\n}"
  },
  {
    "function_name": "makeExpression",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/protobuf-eval.c++",
    "lines": "29-61",
    "snippet": "int32_t makeExpression(Expression* exp, uint depth) {\n  exp->set_op((Operation)(fastRand(Operation_MAX + 1)));\n\n  int32_t left, right;\n\n  if (fastRand(8) < depth) {\n    left = fastRand(128) + 1;\n    exp->set_left_value(left);\n  } else {\n    left = makeExpression(exp->mutable_left_expression(), depth + 1);\n  }\n\n  if (fastRand(8) < depth) {\n    right = fastRand(128) + 1;\n    exp->set_right_value(right);\n  } else {\n    right = makeExpression(exp->mutable_right_expression(), depth + 1);\n  }\n\n  switch (exp->op()) {\n    case Operation::ADD:\n      return left + right;\n    case Operation::SUBTRACT:\n      return left - right;\n    case Operation::MULTIPLY:\n      return left * right;\n    case Operation::DIVIDE:\n      return div(left, right);\n    case Operation::MODULUS:\n      return mod(left, right);\n  }\n  throw std::logic_error(\"Can't get here.\");\n}",
    "includes": [
      "#include \"protobuf-common.h\"",
      "#include \"eval.pb.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::logic_error",
          "args": [
            "\"Can't get here.\""
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mod",
          "args": [
            "left",
            "right"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "mod",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/common.h",
          "lines": "81-88",
          "snippet": "inline int32_t mod(int32_t a, int32_t b) {\n  if (b == 0) return std::numeric_limits<int32_t>::max();\n  // INT_MIN % -1 => SIGFPE.  Who knew?\n  if (a == std::numeric_limits<int32_t>::min() && b == -1) {\n    return std::numeric_limits<int32_t>::max();\n  }\n  return a % b;\n}",
          "includes": [
            "#include <vector>",
            "#include <string>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdexcept>",
            "#include <algorithm>",
            "#include <semaphore.h>",
            "#include <stdlib.h>",
            "#include <sys/wait.h>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include <errno.h>",
            "#include <limits>",
            "#include <unistd.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <stdio.h>\n#include <stdexcept>\n#include <algorithm>\n#include <semaphore.h>\n#include <stdlib.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include <errno.h>\n#include <limits>\n#include <unistd.h>\n\ninline int32_t mod(int32_t a, int32_t b) {\n  if (b == 0) return std::numeric_limits<int32_t>::max();\n  // INT_MIN % -1 => SIGFPE.  Who knew?\n  if (a == std::numeric_limits<int32_t>::min() && b == -1) {\n    return std::numeric_limits<int32_t>::max();\n  }\n  return a % b;\n}"
        }
      },
      {
        "call_info": {
          "callee": "div",
          "args": [
            "left",
            "right"
          ],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "div",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/common.h",
          "lines": "72-79",
          "snippet": "inline int32_t div(int32_t a, int32_t b) {\n  if (b == 0) return std::numeric_limits<int32_t>::max();\n  // INT_MIN / -1 => SIGFPE.  Who knew?\n  if (a == std::numeric_limits<int32_t>::min() && b == -1) {\n    return std::numeric_limits<int32_t>::max();\n  }\n  return a / b;\n}",
          "includes": [
            "#include <vector>",
            "#include <string>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdexcept>",
            "#include <algorithm>",
            "#include <semaphore.h>",
            "#include <stdlib.h>",
            "#include <sys/wait.h>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include <errno.h>",
            "#include <limits>",
            "#include <unistd.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <stdio.h>\n#include <stdexcept>\n#include <algorithm>\n#include <semaphore.h>\n#include <stdlib.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include <errno.h>\n#include <limits>\n#include <unistd.h>\n\ninline int32_t div(int32_t a, int32_t b) {\n  if (b == 0) return std::numeric_limits<int32_t>::max();\n  // INT_MIN / -1 => SIGFPE.  Who knew?\n  if (a == std::numeric_limits<int32_t>::min() && b == -1) {\n    return std::numeric_limits<int32_t>::max();\n  }\n  return a / b;\n}"
        }
      },
      {
        "call_info": {
          "callee": "exp->op",
          "args": [],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exp->mutable_right_expression",
          "args": [],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exp->set_right_value",
          "args": [
            "right"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fastRand",
          "args": [
            "128"
          ],
          "line": 42
        },
        "resolved": true,
        "details": {
          "function_name": "fastRand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/common.h",
          "lines": "64-66",
          "snippet": "static inline uint32_t fastRand(uint32_t range) {\n  return nextFastRand() % range;\n}",
          "includes": [
            "#include <vector>",
            "#include <string>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdexcept>",
            "#include <algorithm>",
            "#include <semaphore.h>",
            "#include <stdlib.h>",
            "#include <sys/wait.h>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include <errno.h>",
            "#include <limits>",
            "#include <unistd.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <stdio.h>\n#include <stdexcept>\n#include <algorithm>\n#include <semaphore.h>\n#include <stdlib.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include <errno.h>\n#include <limits>\n#include <unistd.h>\n\nstatic inline uint32_t fastRand(uint32_t range) {\n  return nextFastRand() % range;\n}"
        }
      },
      {
        "call_info": {
          "callee": "exp->mutable_left_expression",
          "args": [],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exp->set_left_value",
          "args": [
            "left"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exp->set_op",
          "args": [
            "(Operation)(fastRand(Operation_MAX + 1))"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "fastRand(Operation_MAX + 1)"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"protobuf-common.h\"\n#include \"eval.pb.h\"\n\nint32_t makeExpression(Expression* exp, uint depth) {\n  exp->set_op((Operation)(fastRand(Operation_MAX + 1)));\n\n  int32_t left, right;\n\n  if (fastRand(8) < depth) {\n    left = fastRand(128) + 1;\n    exp->set_left_value(left);\n  } else {\n    left = makeExpression(exp->mutable_left_expression(), depth + 1);\n  }\n\n  if (fastRand(8) < depth) {\n    right = fastRand(128) + 1;\n    exp->set_right_value(right);\n  } else {\n    right = makeExpression(exp->mutable_right_expression(), depth + 1);\n  }\n\n  switch (exp->op()) {\n    case Operation::ADD:\n      return left + right;\n    case Operation::SUBTRACT:\n      return left - right;\n    case Operation::MULTIPLY:\n      return left * right;\n    case Operation::DIVIDE:\n      return div(left, right);\n    case Operation::MODULUS:\n      return mod(left, right);\n  }\n  throw std::logic_error(\"Can't get here.\");\n}"
  }
]