[
  {
    "function_name": "makeRpcClient",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.h",
    "lines": "407-411",
    "snippet": "RpcSystem<VatId> makeRpcClient(\n    VatNetwork<VatId, ProvisionId, RecipientId, ThirdPartyCapId, JoinResult>& network,\n    RealmGatewayClient gateway) {\n  return RpcSystem<VatId>(network, nullptr, gateway.template castAs<RealmGateway<>>());\n}",
    "includes": [
      "#include \"rpc-prelude.h\"",
      "#include \"capability.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "RpcSystem<VatId>",
          "args": [
            "network",
            "nullptr",
            "gateway.template castAs<RealmGateway<>>()"
          ],
          "line": 410
        },
        "resolved": true,
        "details": {
          "function_name": "RpcSystem<VatId>::RpcSystem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.h",
          "lines": "345-349",
          "snippet": "RpcSystem<VatId>::RpcSystem(\n      VatNetwork<VatId, ProvisionId, RecipientId, ThirdPartyCapId, JoinResult>& network,\n      kj::Maybe<Capability::Client> bootstrap,\n      kj::Maybe<RealmGateway<>::Client> gateway)\n    : _::RpcSystemBase(network, kj::mv(bootstrap), kj::mv(gateway)) {}",
          "includes": [
            "#include \"rpc-prelude.h\"",
            "#include \"capability.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rpc-prelude.h\"\n#include \"capability.h\"\n\nRpcSystem<VatId>::RpcSystem(\n      VatNetwork<VatId, ProvisionId, RecipientId, ThirdPartyCapId, JoinResult>& network,\n      kj::Maybe<Capability::Client> bootstrap,\n      kj::Maybe<RealmGateway<>::Client> gateway)\n    : _::RpcSystemBase(network, kj::mv(bootstrap), kj::mv(gateway)) {}"
        }
      },
      {
        "call_info": {
          "callee": "gateway.template castAs<RealmGateway<>>",
          "args": [],
          "line": 410
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rpc-prelude.h\"\n#include \"capability.h\"\n\nRpcSystem<VatId> makeRpcClient(\n    VatNetwork<VatId, ProvisionId, RecipientId, ThirdPartyCapId, JoinResult>& network,\n    RealmGatewayClient gateway) {\n  return RpcSystem<VatId>(network, nullptr, gateway.template castAs<RealmGateway<>>());\n}"
  },
  {
    "function_name": "makeRpcClient",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.h",
    "lines": "399-402",
    "snippet": "RpcSystem<VatId> makeRpcClient(\n    VatNetwork<VatId, ProvisionId, RecipientId, ThirdPartyCapId, JoinResult>& network) {\n  return RpcSystem<VatId>(network, nullptr);\n}",
    "includes": [
      "#include \"rpc-prelude.h\"",
      "#include \"capability.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "RpcSystem<VatId>",
          "args": [
            "network",
            "nullptr"
          ],
          "line": 401
        },
        "resolved": true,
        "details": {
          "function_name": "RpcSystem<VatId>::RpcSystem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.h",
          "lines": "355-358",
          "snippet": "RpcSystem<VatId>::RpcSystem(\n      VatNetwork<VatId, ProvisionId, RecipientId, ThirdPartyCapId, JoinResult>& network,\n      SturdyRefRestorer<LocalSturdyRefObjectId>& restorer)\n    : _::RpcSystemBase(network, restorer) {}",
          "includes": [
            "#include \"rpc-prelude.h\"",
            "#include \"capability.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rpc-prelude.h\"\n#include \"capability.h\"\n\nRpcSystem<VatId>::RpcSystem(\n      VatNetwork<VatId, ProvisionId, RecipientId, ThirdPartyCapId, JoinResult>& network,\n      SturdyRefRestorer<LocalSturdyRefObjectId>& restorer)\n    : _::RpcSystemBase(network, restorer) {}"
        }
      }
    ],
    "contextual_snippet": "#include \"rpc-prelude.h\"\n#include \"capability.h\"\n\nRpcSystem<VatId> makeRpcClient(\n    VatNetwork<VatId, ProvisionId, RecipientId, ThirdPartyCapId, JoinResult>& network) {\n  return RpcSystem<VatId>(network, nullptr);\n}"
  },
  {
    "function_name": "makeRpcServer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.h",
    "lines": "391-395",
    "snippet": "RpcSystem<VatId> makeRpcServer(\n    VatNetwork<VatId, ProvisionId, RecipientId, ThirdPartyCapId, JoinResult>& network,\n    SturdyRefRestorer<LocalSturdyRefObjectId>& restorer) {\n  return RpcSystem<VatId>(network, restorer);\n}",
    "includes": [
      "#include \"rpc-prelude.h\"",
      "#include \"capability.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "RpcSystem<VatId>",
          "args": [
            "network",
            "restorer"
          ],
          "line": 394
        },
        "resolved": true,
        "details": {
          "function_name": "RpcSystem<VatId>::RpcSystem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.h",
          "lines": "355-358",
          "snippet": "RpcSystem<VatId>::RpcSystem(\n      VatNetwork<VatId, ProvisionId, RecipientId, ThirdPartyCapId, JoinResult>& network,\n      SturdyRefRestorer<LocalSturdyRefObjectId>& restorer)\n    : _::RpcSystemBase(network, restorer) {}",
          "includes": [
            "#include \"rpc-prelude.h\"",
            "#include \"capability.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rpc-prelude.h\"\n#include \"capability.h\"\n\nRpcSystem<VatId>::RpcSystem(\n      VatNetwork<VatId, ProvisionId, RecipientId, ThirdPartyCapId, JoinResult>& network,\n      SturdyRefRestorer<LocalSturdyRefObjectId>& restorer)\n    : _::RpcSystemBase(network, restorer) {}"
        }
      }
    ],
    "contextual_snippet": "#include \"rpc-prelude.h\"\n#include \"capability.h\"\n\nRpcSystem<VatId> makeRpcServer(\n    VatNetwork<VatId, ProvisionId, RecipientId, ThirdPartyCapId, JoinResult>& network,\n    SturdyRefRestorer<LocalSturdyRefObjectId>& restorer) {\n  return RpcSystem<VatId>(network, restorer);\n}"
  },
  {
    "function_name": "makeRpcServer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.h",
    "lines": "382-387",
    "snippet": "RpcSystem<VatId> makeRpcServer(\n    VatNetwork<VatId, ProvisionId, RecipientId, ThirdPartyCapId, JoinResult>& network,\n    Capability::Client bootstrapInterface, RealmGatewayClient gateway) {\n  return RpcSystem<VatId>(network, kj::mv(bootstrapInterface),\n      gateway.template castAs<RealmGateway<>>());\n}",
    "includes": [
      "#include \"rpc-prelude.h\"",
      "#include \"capability.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "RpcSystem<VatId>",
          "args": [
            "network",
            "kj::mv(bootstrapInterface)",
            "gateway.template castAs<RealmGateway<>>()"
          ],
          "line": 385
        },
        "resolved": true,
        "details": {
          "function_name": "RpcSystem<VatId>::RpcSystem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.h",
          "lines": "345-349",
          "snippet": "RpcSystem<VatId>::RpcSystem(\n      VatNetwork<VatId, ProvisionId, RecipientId, ThirdPartyCapId, JoinResult>& network,\n      kj::Maybe<Capability::Client> bootstrap,\n      kj::Maybe<RealmGateway<>::Client> gateway)\n    : _::RpcSystemBase(network, kj::mv(bootstrap), kj::mv(gateway)) {}",
          "includes": [
            "#include \"rpc-prelude.h\"",
            "#include \"capability.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rpc-prelude.h\"\n#include \"capability.h\"\n\nRpcSystem<VatId>::RpcSystem(\n      VatNetwork<VatId, ProvisionId, RecipientId, ThirdPartyCapId, JoinResult>& network,\n      kj::Maybe<Capability::Client> bootstrap,\n      kj::Maybe<RealmGateway<>::Client> gateway)\n    : _::RpcSystemBase(network, kj::mv(bootstrap), kj::mv(gateway)) {}"
        }
      },
      {
        "call_info": {
          "callee": "gateway.template castAs<RealmGateway<>>",
          "args": [],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "bootstrapInterface"
          ],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rpc-prelude.h\"\n#include \"capability.h\"\n\nRpcSystem<VatId> makeRpcServer(\n    VatNetwork<VatId, ProvisionId, RecipientId, ThirdPartyCapId, JoinResult>& network,\n    Capability::Client bootstrapInterface, RealmGatewayClient gateway) {\n  return RpcSystem<VatId>(network, kj::mv(bootstrapInterface),\n      gateway.template castAs<RealmGateway<>>());\n}"
  },
  {
    "function_name": "makeRpcServer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.h",
    "lines": "373-377",
    "snippet": "RpcSystem<VatId> makeRpcServer(\n    VatNetwork<VatId, ProvisionId, RecipientId, ThirdPartyCapId, JoinResult>& network,\n    Capability::Client bootstrapInterface) {\n  return RpcSystem<VatId>(network, kj::mv(bootstrapInterface));\n}",
    "includes": [
      "#include \"rpc-prelude.h\"",
      "#include \"capability.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "RpcSystem<VatId>",
          "args": [
            "network",
            "kj::mv(bootstrapInterface)"
          ],
          "line": 376
        },
        "resolved": true,
        "details": {
          "function_name": "RpcSystem<VatId>::RpcSystem",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.h",
          "lines": "355-358",
          "snippet": "RpcSystem<VatId>::RpcSystem(\n      VatNetwork<VatId, ProvisionId, RecipientId, ThirdPartyCapId, JoinResult>& network,\n      SturdyRefRestorer<LocalSturdyRefObjectId>& restorer)\n    : _::RpcSystemBase(network, restorer) {}",
          "includes": [
            "#include \"rpc-prelude.h\"",
            "#include \"capability.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rpc-prelude.h\"\n#include \"capability.h\"\n\nRpcSystem<VatId>::RpcSystem(\n      VatNetwork<VatId, ProvisionId, RecipientId, ThirdPartyCapId, JoinResult>& network,\n      SturdyRefRestorer<LocalSturdyRefObjectId>& restorer)\n    : _::RpcSystemBase(network, restorer) {}"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "bootstrapInterface"
          ],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rpc-prelude.h\"\n#include \"capability.h\"\n\nRpcSystem<VatId> makeRpcServer(\n    VatNetwork<VatId, ProvisionId, RecipientId, ThirdPartyCapId, JoinResult>& network,\n    Capability::Client bootstrapInterface) {\n  return RpcSystem<VatId>(network, kj::mv(bootstrapInterface));\n}"
  },
  {
    "function_name": "RpcSystem<VatId>::restore",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.h",
    "lines": "366-369",
    "snippet": "Capability::Client RpcSystem<VatId>::restore(\n    typename VatId::Reader hostId, AnyPointer::Reader objectId) {\n  return baseRestore(_::PointerHelpers<VatId>::getInternalReader(hostId), objectId);\n}",
    "includes": [
      "#include \"rpc-prelude.h\"",
      "#include \"capability.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "baseRestore",
          "args": [
            "_::PointerHelpers<VatId>::getInternalReader(hostId)",
            "objectId"
          ],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_::PointerHelpers<VatId>::getInternalReader",
          "args": [
            "hostId"
          ],
          "line": 368
        },
        "resolved": true,
        "details": {
          "function_name": "getInternalReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/pointer-helpers.h",
          "lines": "97-99",
          "snippet": "static inline _::ListReader getInternalReader(const typename List<T>::Reader& reader) {\n    return reader.reader;\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"layout.h\"\n\nstatic inline _::ListReader getInternalReader(const typename List<T>::Reader& reader) {\n    return reader.reader;\n  }"
        }
      }
    ],
    "contextual_snippet": "#include \"rpc-prelude.h\"\n#include \"capability.h\"\n\nCapability::Client RpcSystem<VatId>::restore(\n    typename VatId::Reader hostId, AnyPointer::Reader objectId) {\n  return baseRestore(_::PointerHelpers<VatId>::getInternalReader(hostId), objectId);\n}"
  },
  {
    "function_name": "RpcSystem<VatId>::bootstrap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.h",
    "lines": "361-363",
    "snippet": "Capability::Client RpcSystem<VatId>::bootstrap(typename VatId::Reader vatId) {\n  return baseBootstrap(_::PointerHelpers<VatId>::getInternalReader(vatId));\n}",
    "includes": [
      "#include \"rpc-prelude.h\"",
      "#include \"capability.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "baseBootstrap",
          "args": [
            "_::PointerHelpers<VatId>::getInternalReader(vatId)"
          ],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_::PointerHelpers<VatId>::getInternalReader",
          "args": [
            "vatId"
          ],
          "line": 362
        },
        "resolved": true,
        "details": {
          "function_name": "getInternalReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/pointer-helpers.h",
          "lines": "97-99",
          "snippet": "static inline _::ListReader getInternalReader(const typename List<T>::Reader& reader) {\n    return reader.reader;\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"layout.h\"\n\nstatic inline _::ListReader getInternalReader(const typename List<T>::Reader& reader) {\n    return reader.reader;\n  }"
        }
      }
    ],
    "contextual_snippet": "#include \"rpc-prelude.h\"\n#include \"capability.h\"\n\nCapability::Client RpcSystem<VatId>::bootstrap(typename VatId::Reader vatId) {\n  return baseBootstrap(_::PointerHelpers<VatId>::getInternalReader(vatId));\n}"
  },
  {
    "function_name": "RpcSystem<VatId>::RpcSystem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.h",
    "lines": "355-358",
    "snippet": "RpcSystem<VatId>::RpcSystem(\n      VatNetwork<VatId, ProvisionId, RecipientId, ThirdPartyCapId, JoinResult>& network,\n      SturdyRefRestorer<LocalSturdyRefObjectId>& restorer)\n    : _::RpcSystemBase(network, restorer) {}",
    "includes": [
      "#include \"rpc-prelude.h\"",
      "#include \"capability.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"rpc-prelude.h\"\n#include \"capability.h\"\n\nRpcSystem<VatId>::RpcSystem(\n      VatNetwork<VatId, ProvisionId, RecipientId, ThirdPartyCapId, JoinResult>& network,\n      SturdyRefRestorer<LocalSturdyRefObjectId>& restorer)\n    : _::RpcSystemBase(network, restorer) {}"
  },
  {
    "function_name": "RpcSystem<VatId>::RpcSystem",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.h",
    "lines": "345-349",
    "snippet": "RpcSystem<VatId>::RpcSystem(\n      VatNetwork<VatId, ProvisionId, RecipientId, ThirdPartyCapId, JoinResult>& network,\n      kj::Maybe<Capability::Client> bootstrap,\n      kj::Maybe<RealmGateway<>::Client> gateway)\n    : _::RpcSystemBase(network, kj::mv(bootstrap), kj::mv(gateway)) {}",
    "includes": [
      "#include \"rpc-prelude.h\"",
      "#include \"capability.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "gateway"
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "bootstrap"
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rpc-prelude.h\"\n#include \"capability.h\"\n\nRpcSystem<VatId>::RpcSystem(\n      VatNetwork<VatId, ProvisionId, RecipientId, ThirdPartyCapId, JoinResult>& network,\n      kj::Maybe<Capability::Client> bootstrap,\n      kj::Maybe<RealmGateway<>::Client> gateway)\n    : _::RpcSystemBase(network, kj::mv(bootstrap), kj::mv(gateway)) {}"
  },
  {
    "function_name": "SturdyRefRestorer<SturdyRef>::baseRestore",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.h",
    "lines": "335-340",
    "snippet": "Capability::Client SturdyRefRestorer<SturdyRef>::baseRestore(AnyPointer::Reader ref) {\n#pragma GCC diagnostic push\n#pragma GCC diagnostic ignored \"-Wdeprecated-declarations\"\n  return restore(ref.getAs<SturdyRef>());\n#pragma GCC diagnostic pop\n}",
    "includes": [
      "#include \"rpc-prelude.h\"",
      "#include \"capability.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "restore",
          "args": [
            "ref.getAs<SturdyRef>()"
          ],
          "line": 338
        },
        "resolved": true,
        "details": {
          "function_name": "restore",
          "container": "RpcConnectionState",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "253-284",
          "snippet": "kj::Own<ClientHook> restore(AnyPointer::Reader objectId) {\n    if (connection.is<Disconnected>()) {\n      return newBrokenCap(kj::cp(connection.get<Disconnected>()));\n    }\n\n    QuestionId questionId;\n    auto& question = questions.next(questionId);\n\n    question.isAwaitingReturn = true;\n\n    auto paf = kj::newPromiseAndFulfiller<kj::Promise<kj::Own<RpcResponse>>>();\n\n    auto questionRef = kj::refcounted<QuestionRef>(*this, questionId, kj::mv(paf.fulfiller));\n    question.selfRef = *questionRef;\n\n    paf.promise = paf.promise.attach(kj::addRef(*questionRef));\n\n    {\n      auto message = connection.get<Connected>()->newOutgoingMessage(\n          objectId.targetSize().wordCount + messageSizeHint<rpc::Bootstrap>());\n\n      auto builder = message->getBody().initAs<rpc::Message>().initBootstrap();\n      builder.setQuestionId(questionId);\n      builder.getDeprecatedObjectId().set(objectId);\n\n      message->send();\n    }\n\n    auto pipeline = kj::refcounted<RpcPipeline>(*this, kj::mv(questionRef), kj::mv(paf.promise));\n\n    return pipeline->getPipelinedCap(kj::Array<const PipelineOp>(nullptr));\n  }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nRpcConnectionState {\n  kj::Own<ClientHook> restore(AnyPointer::Reader objectId) {\n      if (connection.is<Disconnected>()) {\n        return newBrokenCap(kj::cp(connection.get<Disconnected>()));\n      }\n  \n      QuestionId questionId;\n      auto& question = questions.next(questionId);\n  \n      question.isAwaitingReturn = true;\n  \n      auto paf = kj::newPromiseAndFulfiller<kj::Promise<kj::Own<RpcResponse>>>();\n  \n      auto questionRef = kj::refcounted<QuestionRef>(*this, questionId, kj::mv(paf.fulfiller));\n      question.selfRef = *questionRef;\n  \n      paf.promise = paf.promise.attach(kj::addRef(*questionRef));\n  \n      {\n        auto message = connection.get<Connected>()->newOutgoingMessage(\n            objectId.targetSize().wordCount + messageSizeHint<rpc::Bootstrap>());\n  \n        auto builder = message->getBody().initAs<rpc::Message>().initBootstrap();\n        builder.setQuestionId(questionId);\n        builder.getDeprecatedObjectId().set(objectId);\n  \n        message->send();\n      }\n  \n      auto pipeline = kj::refcounted<RpcPipeline>(*this, kj::mv(questionRef), kj::mv(paf.promise));\n  \n      return pipeline->getPipelinedCap(kj::Array<const PipelineOp>(nullptr));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ref.getAs<SturdyRef>",
          "args": [],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rpc-prelude.h\"\n#include \"capability.h\"\n\nCapability::Client SturdyRefRestorer<SturdyRef>::baseRestore(AnyPointer::Reader ref) {\n#pragma GCC diagnostic push\n#pragma GCC diagnostic ignored \"-Wdeprecated-declarations\"\n  return restore(ref.getAs<SturdyRef>());\n#pragma GCC diagnostic pop\n}"
  },
  {
    "function_name": "VatNetwork<SturdyRef, ProvisionId, RecipientId, ThirdPartyCapId, JoinResult>::baseAccept",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.h",
    "lines": "326-332",
    "snippet": "kj::Promise<kj::Own<_::VatNetworkBase::Connection>>\n    VatNetwork<SturdyRef, ProvisionId, RecipientId, ThirdPartyCapId, JoinResult>::baseAccept() {\n  return accept().then(\n      [](kj::Own<Connection>&& connection) -> kj::Own<_::VatNetworkBase::Connection> {\n    return kj::mv(connection);\n  });\n}",
    "includes": [
      "#include \"rpc-prelude.h\"",
      "#include \"capability.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "accept",
          "args": [
            "[](kj::Own<Connection>&& connection) -> kj::Own<_::VatNetworkBase::Connection> {\n    return kj::mv(connection);\n  }"
          ],
          "line": 328
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "connection"
          ],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "accept",
          "args": [],
          "line": 328
        },
        "resolved": true,
        "details": {
          "function_name": "TwoPartyVatNetwork::accept",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc-twoparty.c++",
          "lines": "56-66",
          "snippet": "kj::Promise<kj::Own<TwoPartyVatNetworkBase::Connection>> TwoPartyVatNetwork::accept() {\n  if (side == rpc::twoparty::Side::SERVER && !accepted) {\n    accepted = true;\n    return asConnection();\n  } else {\n    // Create a promise that will never be fulfilled.\n    auto paf = kj::newPromiseAndFulfiller<kj::Own<TwoPartyVatNetworkBase::Connection>>();\n    acceptFulfiller = kj::mv(paf.fulfiller);\n    return kj::mv(paf.promise);\n  }\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"serialize-async.h\"",
            "#include \"rpc-twoparty.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"serialize-async.h\"\n#include \"rpc-twoparty.h\"\n\nkj::Promise<kj::Own<TwoPartyVatNetworkBase::Connection>> TwoPartyVatNetwork::accept() {\n  if (side == rpc::twoparty::Side::SERVER && !accepted) {\n    accepted = true;\n    return asConnection();\n  } else {\n    // Create a promise that will never be fulfilled.\n    auto paf = kj::newPromiseAndFulfiller<kj::Own<TwoPartyVatNetworkBase::Connection>>();\n    acceptFulfiller = kj::mv(paf.fulfiller);\n    return kj::mv(paf.promise);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rpc-prelude.h\"\n#include \"capability.h\"\n\nkj::Promise<kj::Own<_::VatNetworkBase::Connection>>\n    VatNetwork<SturdyRef, ProvisionId, RecipientId, ThirdPartyCapId, JoinResult>::baseAccept() {\n  return accept().then(\n      [](kj::Own<Connection>&& connection) -> kj::Own<_::VatNetworkBase::Connection> {\n    return kj::mv(connection);\n  });\n}"
  },
  {
    "function_name": "VatNetwork<SturdyRef, ProvisionId, RecipientId, ThirdPartyCapId, JoinResult>::\n    baseConnect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.h",
    "lines": "315-322",
    "snippet": "kj::Maybe<kj::Own<_::VatNetworkBase::Connection>>\n    VatNetwork<SturdyRef, ProvisionId, RecipientId, ThirdPartyCapId, JoinResult>::\n    baseConnect(_::StructReader ref) {\n  auto maybe = connect(typename SturdyRef::Reader(ref));\n  return maybe.map([](kj::Own<Connection>& conn) -> kj::Own<_::VatNetworkBase::Connection> {\n    return kj::mv(conn);\n  });\n}",
    "includes": [
      "#include \"rpc-prelude.h\"",
      "#include \"capability.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "maybe.map",
          "args": [
            "[](kj::Own<Connection>& conn) -> kj::Own<_::VatNetworkBase::Connection> {\n    return kj::mv(conn);\n  }"
          ],
          "line": 319
        },
        "resolved": true,
        "details": {
          "function_name": "map",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "1083-1089",
          "snippet": "auto map(Func&& f) -> Maybe<decltype(f(instance<T&>()))> {\n    if (ptr == nullptr) {\n      return nullptr;\n    } else {\n      return f(*ptr);\n    }\n  }",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\nauto map(Func&& f) -> Maybe<decltype(f(instance<T&>()))> {\n    if (ptr == nullptr) {\n      return nullptr;\n    } else {\n      return f(*ptr);\n    }\n  }"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "conn"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "typenameSturdyRef::Reader(ref)"
          ],
          "line": 318
        },
        "resolved": true,
        "details": {
          "function_name": "TwoPartyVatNetwork::connect",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc-twoparty.c++",
          "lines": "47-54",
          "snippet": "kj::Maybe<kj::Own<TwoPartyVatNetworkBase::Connection>> TwoPartyVatNetwork::connect(\n    rpc::twoparty::VatId::Reader ref) {\n  if (ref.getSide() == side) {\n    return nullptr;\n  } else {\n    return asConnection();\n  }\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"serialize-async.h\"",
            "#include \"rpc-twoparty.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"serialize-async.h\"\n#include \"rpc-twoparty.h\"\n\nkj::Maybe<kj::Own<TwoPartyVatNetworkBase::Connection>> TwoPartyVatNetwork::connect(\n    rpc::twoparty::VatId::Reader ref) {\n  if (ref.getSide() == side) {\n    return nullptr;\n  } else {\n    return asConnection();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SturdyRef::Reader",
          "args": [
            "ref"
          ],
          "line": 318
        },
        "resolved": true,
        "details": {
          "function_name": "Reader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "569-570",
          "snippet": "inline Reader(T&& value)\n      : _reader(_::PointerHelpers<FromReader<T>>::getInternalReader(kj::fwd<T>(value))) {}",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader(T&& value)\n      : _reader(_::PointerHelpers<FromReader<T>>::getInternalReader(kj::fwd<T>(value))) {}"
        }
      }
    ],
    "contextual_snippet": "#include \"rpc-prelude.h\"\n#include \"capability.h\"\n\nkj::Maybe<kj::Own<_::VatNetworkBase::Connection>>\n    VatNetwork<SturdyRef, ProvisionId, RecipientId, ThirdPartyCapId, JoinResult>::\n    baseConnect(_::StructReader ref) {\n  auto maybe = connect(typename SturdyRef::Reader(ref));\n  return maybe.map([](kj::Own<Connection>& conn) -> kj::Own<_::VatNetworkBase::Connection> {\n    return kj::mv(conn);\n  });\n}"
  }
]