[
  {
    "function_name": "Orphanage::newOrphanCopy<DynamicValue::Reader>",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "2083-2102",
    "snippet": "Orphan<DynamicValue> Orphanage::newOrphanCopy<DynamicValue::Reader>(\n    const DynamicValue::Reader& copyFrom) const {\n  switch (copyFrom.getType()) {\n    case DynamicValue::UNKNOWN: return nullptr;\n    case DynamicValue::VOID: return copyFrom.voidValue;\n    case DynamicValue::BOOL: return copyFrom.boolValue;\n    case DynamicValue::INT: return copyFrom.intValue;\n    case DynamicValue::UINT: return copyFrom.uintValue;\n    case DynamicValue::FLOAT: return copyFrom.floatValue;\n    case DynamicValue::ENUM: return copyFrom.enumValue;\n\n    case DynamicValue::TEXT: return newOrphanCopy(copyFrom.textValue);\n    case DynamicValue::DATA: return newOrphanCopy(copyFrom.dataValue);\n    case DynamicValue::LIST: return newOrphanCopy(copyFrom.listValue);\n    case DynamicValue::STRUCT: return newOrphanCopy(copyFrom.structValue);\n    case DynamicValue::CAPABILITY: return newOrphanCopy(copyFrom.capabilityValue);\n    case DynamicValue::ANY_POINTER: return newOrphanCopy(copyFrom.anyPointerValue);\n  }\n  KJ_UNREACHABLE;\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "newOrphanCopy",
          "args": [
            "copyFrom.anyPointerValue"
          ],
          "line": 2099
        },
        "resolved": true,
        "details": {
          "function_name": "Orphanage::newOrphanCopy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan.h",
          "lines": "348-350",
          "snippet": "inline Orphan<FromReader<Reader>> Orphanage::newOrphanCopy(Reader& copyFrom) const {\n  return newOrphanCopy(kj::implicitCast<const Reader&>(copyFrom));\n}",
          "includes": [
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"layout.h\"\n\ninline Orphan<FromReader<Reader>> Orphanage::newOrphanCopy(Reader& copyFrom) const {\n  return newOrphanCopy(kj::implicitCast<const Reader&>(copyFrom));\n}"
        }
      },
      {
        "call_info": {
          "callee": "copyFrom.getType",
          "args": [],
          "line": 2085
        },
        "resolved": true,
        "details": {
          "function_name": "getType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "942-942",
          "snippet": "inline DynamicValue::Type getType() { return type; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline DynamicValue::Type getType() { return type; }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nOrphan<DynamicValue> Orphanage::newOrphanCopy<DynamicValue::Reader>(\n    const DynamicValue::Reader& copyFrom) const {\n  switch (copyFrom.getType()) {\n    case DynamicValue::UNKNOWN: return nullptr;\n    case DynamicValue::VOID: return copyFrom.voidValue;\n    case DynamicValue::BOOL: return copyFrom.boolValue;\n    case DynamicValue::INT: return copyFrom.intValue;\n    case DynamicValue::UINT: return copyFrom.uintValue;\n    case DynamicValue::FLOAT: return copyFrom.floatValue;\n    case DynamicValue::ENUM: return copyFrom.enumValue;\n\n    case DynamicValue::TEXT: return newOrphanCopy(copyFrom.textValue);\n    case DynamicValue::DATA: return newOrphanCopy(copyFrom.dataValue);\n    case DynamicValue::LIST: return newOrphanCopy(copyFrom.listValue);\n    case DynamicValue::STRUCT: return newOrphanCopy(copyFrom.structValue);\n    case DynamicValue::CAPABILITY: return newOrphanCopy(copyFrom.capabilityValue);\n    case DynamicValue::ANY_POINTER: return newOrphanCopy(copyFrom.anyPointerValue);\n  }\n  KJ_UNREACHABLE;\n}"
  },
  {
    "function_name": "Orphan<DynamicValue>::releaseAs<DynamicList>",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "2076-2080",
    "snippet": "Orphan<DynamicList> Orphan<DynamicValue>::releaseAs<DynamicList>() {\n  KJ_REQUIRE(type == DynamicValue::LIST, \"Value type mismatch.\");\n  type = DynamicValue::UNKNOWN;\n  return Orphan<DynamicList>(listSchema, kj::mv(builder));\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Orphan<DynamicList>",
          "args": [
            "listSchema",
            "kj::mv(builder)"
          ],
          "line": 2079
        },
        "resolved": true,
        "details": {
          "function_name": "Orphan<DynamicValue>::Orphan",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "1985-2003",
          "snippet": "Orphan<DynamicValue>::Orphan(DynamicValue::Builder value, _::OrphanBuilder&& builder)\n    : type(value.getType()), builder(kj::mv(builder)) {\n  switch (type) {\n    case DynamicValue::UNKNOWN: break;\n    case DynamicValue::VOID: voidValue = value.voidValue; break;\n    case DynamicValue::BOOL: boolValue = value.boolValue; break;\n    case DynamicValue::INT: intValue = value.intValue; break;\n    case DynamicValue::UINT: uintValue = value.uintValue; break;\n    case DynamicValue::FLOAT: floatValue = value.floatValue; break;\n    case DynamicValue::ENUM: enumValue = value.enumValue; break;\n\n    case DynamicValue::TEXT: break;\n    case DynamicValue::DATA: break;\n    case DynamicValue::LIST: listSchema = value.listValue.getSchema(); break;\n    case DynamicValue::STRUCT: structSchema = value.structValue.getSchema(); break;\n    case DynamicValue::CAPABILITY: interfaceSchema = value.capabilityValue.getSchema(); break;\n    case DynamicValue::ANY_POINTER: break;\n  }\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nOrphan<DynamicValue>::Orphan(DynamicValue::Builder value, _::OrphanBuilder&& builder)\n    : type(value.getType()), builder(kj::mv(builder)) {\n  switch (type) {\n    case DynamicValue::UNKNOWN: break;\n    case DynamicValue::VOID: voidValue = value.voidValue; break;\n    case DynamicValue::BOOL: boolValue = value.boolValue; break;\n    case DynamicValue::INT: intValue = value.intValue; break;\n    case DynamicValue::UINT: uintValue = value.uintValue; break;\n    case DynamicValue::FLOAT: floatValue = value.floatValue; break;\n    case DynamicValue::ENUM: enumValue = value.enumValue; break;\n\n    case DynamicValue::TEXT: break;\n    case DynamicValue::DATA: break;\n    case DynamicValue::LIST: listSchema = value.listValue.getSchema(); break;\n    case DynamicValue::STRUCT: structSchema = value.structValue.getSchema(); break;\n    case DynamicValue::CAPABILITY: interfaceSchema = value.capabilityValue.getSchema(); break;\n    case DynamicValue::ANY_POINTER: break;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "builder"
          ],
          "line": 2079
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "type == DynamicValue::LIST",
            "\"Value type mismatch.\""
          ],
          "line": 2077
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nOrphan<DynamicList> Orphan<DynamicValue>::releaseAs<DynamicList>() {\n  KJ_REQUIRE(type == DynamicValue::LIST, \"Value type mismatch.\");\n  type = DynamicValue::UNKNOWN;\n  return Orphan<DynamicList>(listSchema, kj::mv(builder));\n}"
  },
  {
    "function_name": "Orphan<DynamicValue>::releaseAs<DynamicStruct>",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "2070-2074",
    "snippet": "Orphan<DynamicStruct> Orphan<DynamicValue>::releaseAs<DynamicStruct>() {\n  KJ_REQUIRE(type == DynamicValue::STRUCT, \"Value type mismatch.\");\n  type = DynamicValue::UNKNOWN;\n  return Orphan<DynamicStruct>(structSchema, kj::mv(builder));\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Orphan<DynamicStruct>",
          "args": [
            "structSchema",
            "kj::mv(builder)"
          ],
          "line": 2073
        },
        "resolved": true,
        "details": {
          "function_name": "Orphan<DynamicValue>::Orphan",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "1985-2003",
          "snippet": "Orphan<DynamicValue>::Orphan(DynamicValue::Builder value, _::OrphanBuilder&& builder)\n    : type(value.getType()), builder(kj::mv(builder)) {\n  switch (type) {\n    case DynamicValue::UNKNOWN: break;\n    case DynamicValue::VOID: voidValue = value.voidValue; break;\n    case DynamicValue::BOOL: boolValue = value.boolValue; break;\n    case DynamicValue::INT: intValue = value.intValue; break;\n    case DynamicValue::UINT: uintValue = value.uintValue; break;\n    case DynamicValue::FLOAT: floatValue = value.floatValue; break;\n    case DynamicValue::ENUM: enumValue = value.enumValue; break;\n\n    case DynamicValue::TEXT: break;\n    case DynamicValue::DATA: break;\n    case DynamicValue::LIST: listSchema = value.listValue.getSchema(); break;\n    case DynamicValue::STRUCT: structSchema = value.structValue.getSchema(); break;\n    case DynamicValue::CAPABILITY: interfaceSchema = value.capabilityValue.getSchema(); break;\n    case DynamicValue::ANY_POINTER: break;\n  }\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nOrphan<DynamicValue>::Orphan(DynamicValue::Builder value, _::OrphanBuilder&& builder)\n    : type(value.getType()), builder(kj::mv(builder)) {\n  switch (type) {\n    case DynamicValue::UNKNOWN: break;\n    case DynamicValue::VOID: voidValue = value.voidValue; break;\n    case DynamicValue::BOOL: boolValue = value.boolValue; break;\n    case DynamicValue::INT: intValue = value.intValue; break;\n    case DynamicValue::UINT: uintValue = value.uintValue; break;\n    case DynamicValue::FLOAT: floatValue = value.floatValue; break;\n    case DynamicValue::ENUM: enumValue = value.enumValue; break;\n\n    case DynamicValue::TEXT: break;\n    case DynamicValue::DATA: break;\n    case DynamicValue::LIST: listSchema = value.listValue.getSchema(); break;\n    case DynamicValue::STRUCT: structSchema = value.structValue.getSchema(); break;\n    case DynamicValue::CAPABILITY: interfaceSchema = value.capabilityValue.getSchema(); break;\n    case DynamicValue::ANY_POINTER: break;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "builder"
          ],
          "line": 2073
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "type == DynamicValue::STRUCT",
            "\"Value type mismatch.\""
          ],
          "line": 2071
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nOrphan<DynamicStruct> Orphan<DynamicValue>::releaseAs<DynamicStruct>() {\n  KJ_REQUIRE(type == DynamicValue::STRUCT, \"Value type mismatch.\");\n  type = DynamicValue::UNKNOWN;\n  return Orphan<DynamicStruct>(structSchema, kj::mv(builder));\n}"
  },
  {
    "function_name": "Orphan<DynamicValue>::releaseAs<AnyPointer>",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "2064-2068",
    "snippet": "Orphan<AnyPointer> Orphan<DynamicValue>::releaseAs<AnyPointer>() {\n  KJ_REQUIRE(type == DynamicValue::ANY_POINTER, \"Value type mismatch.\");\n  type = DynamicValue::UNKNOWN;\n  return Orphan<AnyPointer>(kj::mv(builder));\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Orphan<AnyPointer>",
          "args": [
            "kj::mv(builder)"
          ],
          "line": 2067
        },
        "resolved": true,
        "details": {
          "function_name": "Orphanage::newOrphan",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "1939-1942",
          "snippet": "Orphan<DynamicStruct> Orphanage::newOrphan(StructSchema schema) const {\n  return Orphan<DynamicStruct>(\n      schema, _::OrphanBuilder::initStruct(arena, structSizeFromSchema(schema)));\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nOrphan<DynamicStruct> Orphanage::newOrphan(StructSchema schema) const {\n  return Orphan<DynamicStruct>(\n      schema, _::OrphanBuilder::initStruct(arena, structSizeFromSchema(schema)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "builder"
          ],
          "line": 2067
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "type == DynamicValue::ANY_POINTER",
            "\"Value type mismatch.\""
          ],
          "line": 2065
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nOrphan<AnyPointer> Orphan<DynamicValue>::releaseAs<AnyPointer>() {\n  KJ_REQUIRE(type == DynamicValue::ANY_POINTER, \"Value type mismatch.\");\n  type = DynamicValue::UNKNOWN;\n  return Orphan<AnyPointer>(kj::mv(builder));\n}"
  },
  {
    "function_name": "Orphan<DynamicValue>::getReader",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "2036-2061",
    "snippet": "DynamicValue::Reader Orphan<DynamicValue>::getReader() const {\n  switch (type) {\n    case DynamicValue::UNKNOWN: return nullptr;\n    case DynamicValue::VOID: return voidValue;\n    case DynamicValue::BOOL: return boolValue;\n    case DynamicValue::INT: return intValue;\n    case DynamicValue::UINT: return uintValue;\n    case DynamicValue::FLOAT: return floatValue;\n    case DynamicValue::ENUM: return enumValue;\n\n    case DynamicValue::TEXT: return builder.asTextReader();\n    case DynamicValue::DATA: return builder.asDataReader();\n    case DynamicValue::LIST:\n      return DynamicList::Reader(listSchema,\n          builder.asListReader(elementSizeFor(listSchema.whichElementType())));\n    case DynamicValue::STRUCT:\n      return DynamicStruct::Reader(structSchema,\n          builder.asStructReader(structSizeFromSchema(structSchema)));\n    case DynamicValue::CAPABILITY:\n      return DynamicCapability::Client(interfaceSchema, builder.asCapability());\n    case DynamicValue::ANY_POINTER:\n      KJ_FAIL_ASSERT(\"Can't get() an AnyPointer orphan; there is no underlying pointer to \"\n                     \"wrap in an AnyPointer::Builder.\");\n  }\n  KJ_UNREACHABLE;\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "KJ_FAIL_ASSERT",
          "args": [
            "\"Can't get() an AnyPointer orphan; there is no underlying pointer to \"\n                     \"wrap in an AnyPointer::Builder.\""
          ],
          "line": 2057
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DynamicCapability::Client",
          "args": [
            "interfaceSchema",
            "builder.asCapability()"
          ],
          "line": 2055
        },
        "resolved": true,
        "details": {
          "function_name": "Client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "476-477",
          "snippet": "Client(InterfaceSchema schema, kj::Own<ClientHook>&& hook)\n      : Capability::Client(kj::mv(hook)), schema(schema) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nClient(InterfaceSchema schema, kj::Own<ClientHook>&& hook)\n      : Capability::Client(kj::mv(hook)), schema(schema) {}"
        }
      },
      {
        "call_info": {
          "callee": "builder.asCapability",
          "args": [],
          "line": 2055
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DynamicStruct::Reader",
          "args": [
            "structSchema",
            "builder.asStructReader(structSizeFromSchema(structSchema))"
          ],
          "line": 2052
        },
        "resolved": true,
        "details": {
          "function_name": "Reader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "377-377",
          "snippet": "Reader(ListSchema schema, _::ListReader reader): schema(schema), reader(reader) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nReader(ListSchema schema, _::ListReader reader): schema(schema), reader(reader) {}"
        }
      },
      {
        "call_info": {
          "callee": "builder.asStructReader",
          "args": [
            "structSizeFromSchema(structSchema)"
          ],
          "line": 2053
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structSizeFromSchema",
          "args": [
            "structSchema"
          ],
          "line": 2053
        },
        "resolved": true,
        "details": {
          "function_name": "structSizeFromSchema",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "98-103",
          "snippet": "inline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\ninline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}"
        }
      },
      {
        "call_info": {
          "callee": "builder.asListReader",
          "args": [
            "elementSizeFor(listSchema.whichElementType())"
          ],
          "line": 2050
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elementSizeFor",
          "args": [
            "listSchema.whichElementType()"
          ],
          "line": 2050
        },
        "resolved": true,
        "details": {
          "function_name": "elementSizeFor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "70-96",
          "snippet": "ElementSize elementSizeFor(schema::Type::Which elementType) {\n  switch (elementType) {\n    case schema::Type::VOID: return ElementSize::VOID;\n    case schema::Type::BOOL: return ElementSize::BIT;\n    case schema::Type::INT8: return ElementSize::BYTE;\n    case schema::Type::INT16: return ElementSize::TWO_BYTES;\n    case schema::Type::INT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::INT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::UINT8: return ElementSize::BYTE;\n    case schema::Type::UINT16: return ElementSize::TWO_BYTES;\n    case schema::Type::UINT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::UINT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::FLOAT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::FLOAT64: return ElementSize::EIGHT_BYTES;\n\n    case schema::Type::TEXT: return ElementSize::POINTER;\n    case schema::Type::DATA: return ElementSize::POINTER;\n    case schema::Type::LIST: return ElementSize::POINTER;\n    case schema::Type::ENUM: return ElementSize::TWO_BYTES;\n    case schema::Type::STRUCT: return ElementSize::INLINE_COMPOSITE;\n    case schema::Type::INTERFACE: return ElementSize::POINTER;\n    case schema::Type::ANY_POINTER: KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\"); break;\n  }\n\n  // Unknown type.  Treat it as zero-size.\n  return ElementSize::VOID;\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nElementSize elementSizeFor(schema::Type::Which elementType) {\n  switch (elementType) {\n    case schema::Type::VOID: return ElementSize::VOID;\n    case schema::Type::BOOL: return ElementSize::BIT;\n    case schema::Type::INT8: return ElementSize::BYTE;\n    case schema::Type::INT16: return ElementSize::TWO_BYTES;\n    case schema::Type::INT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::INT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::UINT8: return ElementSize::BYTE;\n    case schema::Type::UINT16: return ElementSize::TWO_BYTES;\n    case schema::Type::UINT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::UINT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::FLOAT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::FLOAT64: return ElementSize::EIGHT_BYTES;\n\n    case schema::Type::TEXT: return ElementSize::POINTER;\n    case schema::Type::DATA: return ElementSize::POINTER;\n    case schema::Type::LIST: return ElementSize::POINTER;\n    case schema::Type::ENUM: return ElementSize::TWO_BYTES;\n    case schema::Type::STRUCT: return ElementSize::INLINE_COMPOSITE;\n    case schema::Type::INTERFACE: return ElementSize::POINTER;\n    case schema::Type::ANY_POINTER: KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\"); break;\n  }\n\n  // Unknown type.  Treat it as zero-size.\n  return ElementSize::VOID;\n}"
        }
      },
      {
        "call_info": {
          "callee": "listSchema.whichElementType",
          "args": [],
          "line": 2050
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.asDataReader",
          "args": [],
          "line": 2047
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.asTextReader",
          "args": [],
          "line": 2046
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicValue::Reader Orphan<DynamicValue>::getReader() const {\n  switch (type) {\n    case DynamicValue::UNKNOWN: return nullptr;\n    case DynamicValue::VOID: return voidValue;\n    case DynamicValue::BOOL: return boolValue;\n    case DynamicValue::INT: return intValue;\n    case DynamicValue::UINT: return uintValue;\n    case DynamicValue::FLOAT: return floatValue;\n    case DynamicValue::ENUM: return enumValue;\n\n    case DynamicValue::TEXT: return builder.asTextReader();\n    case DynamicValue::DATA: return builder.asDataReader();\n    case DynamicValue::LIST:\n      return DynamicList::Reader(listSchema,\n          builder.asListReader(elementSizeFor(listSchema.whichElementType())));\n    case DynamicValue::STRUCT:\n      return DynamicStruct::Reader(structSchema,\n          builder.asStructReader(structSizeFromSchema(structSchema)));\n    case DynamicValue::CAPABILITY:\n      return DynamicCapability::Client(interfaceSchema, builder.asCapability());\n    case DynamicValue::ANY_POINTER:\n      KJ_FAIL_ASSERT(\"Can't get() an AnyPointer orphan; there is no underlying pointer to \"\n                     \"wrap in an AnyPointer::Builder.\");\n  }\n  KJ_UNREACHABLE;\n}"
  },
  {
    "function_name": "Orphan<DynamicValue>::get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "2005-2035",
    "snippet": "DynamicValue::Builder Orphan<DynamicValue>::get() {\n  switch (type) {\n    case DynamicValue::UNKNOWN: return nullptr;\n    case DynamicValue::VOID: return voidValue;\n    case DynamicValue::BOOL: return boolValue;\n    case DynamicValue::INT: return intValue;\n    case DynamicValue::UINT: return uintValue;\n    case DynamicValue::FLOAT: return floatValue;\n    case DynamicValue::ENUM: return enumValue;\n\n    case DynamicValue::TEXT: return builder.asText();\n    case DynamicValue::DATA: return builder.asData();\n    case DynamicValue::LIST:\n      if (listSchema.whichElementType() == schema::Type::STRUCT) {\n        return DynamicList::Builder(listSchema,\n            builder.asStructList(structSizeFromSchema(listSchema.getStructElementType())));\n      } else {\n        return DynamicList::Builder(listSchema,\n            builder.asList(elementSizeFor(listSchema.whichElementType())));\n      }\n    case DynamicValue::STRUCT:\n      return DynamicStruct::Builder(structSchema,\n          builder.asStruct(structSizeFromSchema(structSchema)));\n    case DynamicValue::CAPABILITY:\n      return DynamicCapability::Client(interfaceSchema, builder.asCapability());\n    case DynamicValue::ANY_POINTER:\n      KJ_FAIL_REQUIRE(\"Can't get() an AnyPointer orphan; there is no underlying pointer to \"\n                      \"wrap in an AnyPointer::Builder.\");\n  }\n  KJ_UNREACHABLE;\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "KJ_FAIL_REQUIRE",
          "args": [
            "\"Can't get() an AnyPointer orphan; there is no underlying pointer to \"\n                      \"wrap in an AnyPointer::Builder.\""
          ],
          "line": 2031
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DynamicCapability::Client",
          "args": [
            "interfaceSchema",
            "builder.asCapability()"
          ],
          "line": 2029
        },
        "resolved": true,
        "details": {
          "function_name": "Client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "476-477",
          "snippet": "Client(InterfaceSchema schema, kj::Own<ClientHook>&& hook)\n      : Capability::Client(kj::mv(hook)), schema(schema) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nClient(InterfaceSchema schema, kj::Own<ClientHook>&& hook)\n      : Capability::Client(kj::mv(hook)), schema(schema) {}"
        }
      },
      {
        "call_info": {
          "callee": "builder.asCapability",
          "args": [],
          "line": 2029
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DynamicStruct::Builder",
          "args": [
            "structSchema",
            "builder.asStruct(structSizeFromSchema(structSchema))"
          ],
          "line": 2026
        },
        "resolved": true,
        "details": {
          "function_name": "Builder",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "427-427",
          "snippet": "Builder(ListSchema schema, _::ListBuilder builder): schema(schema), builder(builder) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nBuilder(ListSchema schema, _::ListBuilder builder): schema(schema), builder(builder) {}"
        }
      },
      {
        "call_info": {
          "callee": "builder.asStruct",
          "args": [
            "structSizeFromSchema(structSchema)"
          ],
          "line": 2027
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structSizeFromSchema",
          "args": [
            "structSchema"
          ],
          "line": 2027
        },
        "resolved": true,
        "details": {
          "function_name": "structSizeFromSchema",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "98-103",
          "snippet": "inline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\ninline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}"
        }
      },
      {
        "call_info": {
          "callee": "builder.asList",
          "args": [
            "elementSizeFor(listSchema.whichElementType())"
          ],
          "line": 2023
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elementSizeFor",
          "args": [
            "listSchema.whichElementType()"
          ],
          "line": 2023
        },
        "resolved": true,
        "details": {
          "function_name": "elementSizeFor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "70-96",
          "snippet": "ElementSize elementSizeFor(schema::Type::Which elementType) {\n  switch (elementType) {\n    case schema::Type::VOID: return ElementSize::VOID;\n    case schema::Type::BOOL: return ElementSize::BIT;\n    case schema::Type::INT8: return ElementSize::BYTE;\n    case schema::Type::INT16: return ElementSize::TWO_BYTES;\n    case schema::Type::INT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::INT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::UINT8: return ElementSize::BYTE;\n    case schema::Type::UINT16: return ElementSize::TWO_BYTES;\n    case schema::Type::UINT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::UINT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::FLOAT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::FLOAT64: return ElementSize::EIGHT_BYTES;\n\n    case schema::Type::TEXT: return ElementSize::POINTER;\n    case schema::Type::DATA: return ElementSize::POINTER;\n    case schema::Type::LIST: return ElementSize::POINTER;\n    case schema::Type::ENUM: return ElementSize::TWO_BYTES;\n    case schema::Type::STRUCT: return ElementSize::INLINE_COMPOSITE;\n    case schema::Type::INTERFACE: return ElementSize::POINTER;\n    case schema::Type::ANY_POINTER: KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\"); break;\n  }\n\n  // Unknown type.  Treat it as zero-size.\n  return ElementSize::VOID;\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nElementSize elementSizeFor(schema::Type::Which elementType) {\n  switch (elementType) {\n    case schema::Type::VOID: return ElementSize::VOID;\n    case schema::Type::BOOL: return ElementSize::BIT;\n    case schema::Type::INT8: return ElementSize::BYTE;\n    case schema::Type::INT16: return ElementSize::TWO_BYTES;\n    case schema::Type::INT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::INT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::UINT8: return ElementSize::BYTE;\n    case schema::Type::UINT16: return ElementSize::TWO_BYTES;\n    case schema::Type::UINT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::UINT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::FLOAT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::FLOAT64: return ElementSize::EIGHT_BYTES;\n\n    case schema::Type::TEXT: return ElementSize::POINTER;\n    case schema::Type::DATA: return ElementSize::POINTER;\n    case schema::Type::LIST: return ElementSize::POINTER;\n    case schema::Type::ENUM: return ElementSize::TWO_BYTES;\n    case schema::Type::STRUCT: return ElementSize::INLINE_COMPOSITE;\n    case schema::Type::INTERFACE: return ElementSize::POINTER;\n    case schema::Type::ANY_POINTER: KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\"); break;\n  }\n\n  // Unknown type.  Treat it as zero-size.\n  return ElementSize::VOID;\n}"
        }
      },
      {
        "call_info": {
          "callee": "listSchema.whichElementType",
          "args": [],
          "line": 2023
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.asStructList",
          "args": [
            "structSizeFromSchema(listSchema.getStructElementType())"
          ],
          "line": 2020
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "listSchema.getStructElementType",
          "args": [],
          "line": 2020
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "listSchema.whichElementType",
          "args": [],
          "line": 2018
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.asData",
          "args": [],
          "line": 2016
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.asText",
          "args": [],
          "line": 2015
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicValue::Builder Orphan<DynamicValue>::get() {\n  switch (type) {\n    case DynamicValue::UNKNOWN: return nullptr;\n    case DynamicValue::VOID: return voidValue;\n    case DynamicValue::BOOL: return boolValue;\n    case DynamicValue::INT: return intValue;\n    case DynamicValue::UINT: return uintValue;\n    case DynamicValue::FLOAT: return floatValue;\n    case DynamicValue::ENUM: return enumValue;\n\n    case DynamicValue::TEXT: return builder.asText();\n    case DynamicValue::DATA: return builder.asData();\n    case DynamicValue::LIST:\n      if (listSchema.whichElementType() == schema::Type::STRUCT) {\n        return DynamicList::Builder(listSchema,\n            builder.asStructList(structSizeFromSchema(listSchema.getStructElementType())));\n      } else {\n        return DynamicList::Builder(listSchema,\n            builder.asList(elementSizeFor(listSchema.whichElementType())));\n      }\n    case DynamicValue::STRUCT:\n      return DynamicStruct::Builder(structSchema,\n          builder.asStruct(structSizeFromSchema(structSchema)));\n    case DynamicValue::CAPABILITY:\n      return DynamicCapability::Client(interfaceSchema, builder.asCapability());\n    case DynamicValue::ANY_POINTER:\n      KJ_FAIL_REQUIRE(\"Can't get() an AnyPointer orphan; there is no underlying pointer to \"\n                      \"wrap in an AnyPointer::Builder.\");\n  }\n  KJ_UNREACHABLE;\n}"
  },
  {
    "function_name": "Orphan<DynamicValue>::Orphan",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1985-2003",
    "snippet": "Orphan<DynamicValue>::Orphan(DynamicValue::Builder value, _::OrphanBuilder&& builder)\n    : type(value.getType()), builder(kj::mv(builder)) {\n  switch (type) {\n    case DynamicValue::UNKNOWN: break;\n    case DynamicValue::VOID: voidValue = value.voidValue; break;\n    case DynamicValue::BOOL: boolValue = value.boolValue; break;\n    case DynamicValue::INT: intValue = value.intValue; break;\n    case DynamicValue::UINT: uintValue = value.uintValue; break;\n    case DynamicValue::FLOAT: floatValue = value.floatValue; break;\n    case DynamicValue::ENUM: enumValue = value.enumValue; break;\n\n    case DynamicValue::TEXT: break;\n    case DynamicValue::DATA: break;\n    case DynamicValue::LIST: listSchema = value.listValue.getSchema(); break;\n    case DynamicValue::STRUCT: structSchema = value.structValue.getSchema(); break;\n    case DynamicValue::CAPABILITY: interfaceSchema = value.capabilityValue.getSchema(); break;\n    case DynamicValue::ANY_POINTER: break;\n  }\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "value.capabilityValue.getSchema",
          "args": [],
          "line": 2000
        },
        "resolved": true,
        "details": {
          "function_name": "getSchema",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "505-505",
          "snippet": "inline InterfaceSchema getSchema() const { return schema; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline InterfaceSchema getSchema() const { return schema; }"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "builder"
          ],
          "line": 1986
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.getType",
          "args": [],
          "line": 1986
        },
        "resolved": true,
        "details": {
          "function_name": "getType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "942-942",
          "snippet": "inline DynamicValue::Type getType() { return type; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline DynamicValue::Type getType() { return type; }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nOrphan<DynamicValue>::Orphan(DynamicValue::Builder value, _::OrphanBuilder&& builder)\n    : type(value.getType()), builder(kj::mv(builder)) {\n  switch (type) {\n    case DynamicValue::UNKNOWN: break;\n    case DynamicValue::VOID: voidValue = value.voidValue; break;\n    case DynamicValue::BOOL: boolValue = value.boolValue; break;\n    case DynamicValue::INT: intValue = value.intValue; break;\n    case DynamicValue::UINT: uintValue = value.uintValue; break;\n    case DynamicValue::FLOAT: floatValue = value.floatValue; break;\n    case DynamicValue::ENUM: enumValue = value.enumValue; break;\n\n    case DynamicValue::TEXT: break;\n    case DynamicValue::DATA: break;\n    case DynamicValue::LIST: listSchema = value.listValue.getSchema(); break;\n    case DynamicValue::STRUCT: structSchema = value.structValue.getSchema(); break;\n    case DynamicValue::CAPABILITY: interfaceSchema = value.capabilityValue.getSchema(); break;\n    case DynamicValue::ANY_POINTER: break;\n  }\n}"
  },
  {
    "function_name": "Orphan<DynamicCapability>::getReader",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1981-1983",
    "snippet": "DynamicCapability::Client Orphan<DynamicCapability>::getReader() const {\n  return DynamicCapability::Client(schema, builder.asCapability());\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DynamicCapability::Client",
          "args": [
            "schema",
            "builder.asCapability()"
          ],
          "line": 1982
        },
        "resolved": true,
        "details": {
          "function_name": "Client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "476-477",
          "snippet": "Client(InterfaceSchema schema, kj::Own<ClientHook>&& hook)\n      : Capability::Client(kj::mv(hook)), schema(schema) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nClient(InterfaceSchema schema, kj::Own<ClientHook>&& hook)\n      : Capability::Client(kj::mv(hook)), schema(schema) {}"
        }
      },
      {
        "call_info": {
          "callee": "builder.asCapability",
          "args": [],
          "line": 1982
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicCapability::Client Orphan<DynamicCapability>::getReader() const {\n  return DynamicCapability::Client(schema, builder.asCapability());\n}"
  },
  {
    "function_name": "Orphan<DynamicCapability>::get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1977-1979",
    "snippet": "DynamicCapability::Client Orphan<DynamicCapability>::get() {\n  return DynamicCapability::Client(schema, builder.asCapability());\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DynamicCapability::Client",
          "args": [
            "schema",
            "builder.asCapability()"
          ],
          "line": 1978
        },
        "resolved": true,
        "details": {
          "function_name": "Client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "476-477",
          "snippet": "Client(InterfaceSchema schema, kj::Own<ClientHook>&& hook)\n      : Capability::Client(kj::mv(hook)), schema(schema) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nClient(InterfaceSchema schema, kj::Own<ClientHook>&& hook)\n      : Capability::Client(kj::mv(hook)), schema(schema) {}"
        }
      },
      {
        "call_info": {
          "callee": "builder.asCapability",
          "args": [],
          "line": 1978
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicCapability::Client Orphan<DynamicCapability>::get() {\n  return DynamicCapability::Client(schema, builder.asCapability());\n}"
  },
  {
    "function_name": "Orphan<DynamicList>::getReader",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1972-1975",
    "snippet": "DynamicList::Reader Orphan<DynamicList>::getReader() const {\n  return DynamicList::Reader(\n      schema, builder.asListReader(elementSizeFor(schema.whichElementType())));\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DynamicList::Reader",
          "args": [
            "schema",
            "builder.asListReader(elementSizeFor(schema.whichElementType()))"
          ],
          "line": 1973
        },
        "resolved": true,
        "details": {
          "function_name": "Reader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "377-377",
          "snippet": "Reader(ListSchema schema, _::ListReader reader): schema(schema), reader(reader) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nReader(ListSchema schema, _::ListReader reader): schema(schema), reader(reader) {}"
        }
      },
      {
        "call_info": {
          "callee": "builder.asListReader",
          "args": [
            "elementSizeFor(schema.whichElementType())"
          ],
          "line": 1974
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elementSizeFor",
          "args": [
            "schema.whichElementType()"
          ],
          "line": 1974
        },
        "resolved": true,
        "details": {
          "function_name": "elementSizeFor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "70-96",
          "snippet": "ElementSize elementSizeFor(schema::Type::Which elementType) {\n  switch (elementType) {\n    case schema::Type::VOID: return ElementSize::VOID;\n    case schema::Type::BOOL: return ElementSize::BIT;\n    case schema::Type::INT8: return ElementSize::BYTE;\n    case schema::Type::INT16: return ElementSize::TWO_BYTES;\n    case schema::Type::INT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::INT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::UINT8: return ElementSize::BYTE;\n    case schema::Type::UINT16: return ElementSize::TWO_BYTES;\n    case schema::Type::UINT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::UINT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::FLOAT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::FLOAT64: return ElementSize::EIGHT_BYTES;\n\n    case schema::Type::TEXT: return ElementSize::POINTER;\n    case schema::Type::DATA: return ElementSize::POINTER;\n    case schema::Type::LIST: return ElementSize::POINTER;\n    case schema::Type::ENUM: return ElementSize::TWO_BYTES;\n    case schema::Type::STRUCT: return ElementSize::INLINE_COMPOSITE;\n    case schema::Type::INTERFACE: return ElementSize::POINTER;\n    case schema::Type::ANY_POINTER: KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\"); break;\n  }\n\n  // Unknown type.  Treat it as zero-size.\n  return ElementSize::VOID;\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nElementSize elementSizeFor(schema::Type::Which elementType) {\n  switch (elementType) {\n    case schema::Type::VOID: return ElementSize::VOID;\n    case schema::Type::BOOL: return ElementSize::BIT;\n    case schema::Type::INT8: return ElementSize::BYTE;\n    case schema::Type::INT16: return ElementSize::TWO_BYTES;\n    case schema::Type::INT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::INT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::UINT8: return ElementSize::BYTE;\n    case schema::Type::UINT16: return ElementSize::TWO_BYTES;\n    case schema::Type::UINT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::UINT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::FLOAT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::FLOAT64: return ElementSize::EIGHT_BYTES;\n\n    case schema::Type::TEXT: return ElementSize::POINTER;\n    case schema::Type::DATA: return ElementSize::POINTER;\n    case schema::Type::LIST: return ElementSize::POINTER;\n    case schema::Type::ENUM: return ElementSize::TWO_BYTES;\n    case schema::Type::STRUCT: return ElementSize::INLINE_COMPOSITE;\n    case schema::Type::INTERFACE: return ElementSize::POINTER;\n    case schema::Type::ANY_POINTER: KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\"); break;\n  }\n\n  // Unknown type.  Treat it as zero-size.\n  return ElementSize::VOID;\n}"
        }
      },
      {
        "call_info": {
          "callee": "schema.whichElementType",
          "args": [],
          "line": 1974
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicList::Reader Orphan<DynamicList>::getReader() const {\n  return DynamicList::Reader(\n      schema, builder.asListReader(elementSizeFor(schema.whichElementType())));\n}"
  },
  {
    "function_name": "Orphan<DynamicList>::get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1962-1970",
    "snippet": "DynamicList::Builder Orphan<DynamicList>::get() {\n  if (schema.whichElementType() == schema::Type::STRUCT) {\n    return DynamicList::Builder(\n        schema, builder.asStructList(structSizeFromSchema(schema.getStructElementType())));\n  } else {\n    return DynamicList::Builder(\n        schema, builder.asList(elementSizeFor(schema.whichElementType())));\n  }\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DynamicList::Builder",
          "args": [
            "schema",
            "builder.asList(elementSizeFor(schema.whichElementType()))"
          ],
          "line": 1967
        },
        "resolved": true,
        "details": {
          "function_name": "Builder",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "427-427",
          "snippet": "Builder(ListSchema schema, _::ListBuilder builder): schema(schema), builder(builder) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nBuilder(ListSchema schema, _::ListBuilder builder): schema(schema), builder(builder) {}"
        }
      },
      {
        "call_info": {
          "callee": "builder.asList",
          "args": [
            "elementSizeFor(schema.whichElementType())"
          ],
          "line": 1968
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elementSizeFor",
          "args": [
            "schema.whichElementType()"
          ],
          "line": 1968
        },
        "resolved": true,
        "details": {
          "function_name": "elementSizeFor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "70-96",
          "snippet": "ElementSize elementSizeFor(schema::Type::Which elementType) {\n  switch (elementType) {\n    case schema::Type::VOID: return ElementSize::VOID;\n    case schema::Type::BOOL: return ElementSize::BIT;\n    case schema::Type::INT8: return ElementSize::BYTE;\n    case schema::Type::INT16: return ElementSize::TWO_BYTES;\n    case schema::Type::INT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::INT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::UINT8: return ElementSize::BYTE;\n    case schema::Type::UINT16: return ElementSize::TWO_BYTES;\n    case schema::Type::UINT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::UINT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::FLOAT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::FLOAT64: return ElementSize::EIGHT_BYTES;\n\n    case schema::Type::TEXT: return ElementSize::POINTER;\n    case schema::Type::DATA: return ElementSize::POINTER;\n    case schema::Type::LIST: return ElementSize::POINTER;\n    case schema::Type::ENUM: return ElementSize::TWO_BYTES;\n    case schema::Type::STRUCT: return ElementSize::INLINE_COMPOSITE;\n    case schema::Type::INTERFACE: return ElementSize::POINTER;\n    case schema::Type::ANY_POINTER: KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\"); break;\n  }\n\n  // Unknown type.  Treat it as zero-size.\n  return ElementSize::VOID;\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nElementSize elementSizeFor(schema::Type::Which elementType) {\n  switch (elementType) {\n    case schema::Type::VOID: return ElementSize::VOID;\n    case schema::Type::BOOL: return ElementSize::BIT;\n    case schema::Type::INT8: return ElementSize::BYTE;\n    case schema::Type::INT16: return ElementSize::TWO_BYTES;\n    case schema::Type::INT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::INT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::UINT8: return ElementSize::BYTE;\n    case schema::Type::UINT16: return ElementSize::TWO_BYTES;\n    case schema::Type::UINT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::UINT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::FLOAT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::FLOAT64: return ElementSize::EIGHT_BYTES;\n\n    case schema::Type::TEXT: return ElementSize::POINTER;\n    case schema::Type::DATA: return ElementSize::POINTER;\n    case schema::Type::LIST: return ElementSize::POINTER;\n    case schema::Type::ENUM: return ElementSize::TWO_BYTES;\n    case schema::Type::STRUCT: return ElementSize::INLINE_COMPOSITE;\n    case schema::Type::INTERFACE: return ElementSize::POINTER;\n    case schema::Type::ANY_POINTER: KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\"); break;\n  }\n\n  // Unknown type.  Treat it as zero-size.\n  return ElementSize::VOID;\n}"
        }
      },
      {
        "call_info": {
          "callee": "schema.whichElementType",
          "args": [],
          "line": 1968
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.asStructList",
          "args": [
            "structSizeFromSchema(schema.getStructElementType())"
          ],
          "line": 1965
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structSizeFromSchema",
          "args": [
            "schema.getStructElementType()"
          ],
          "line": 1965
        },
        "resolved": true,
        "details": {
          "function_name": "structSizeFromSchema",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "98-103",
          "snippet": "inline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\ninline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}"
        }
      },
      {
        "call_info": {
          "callee": "schema.getStructElementType",
          "args": [],
          "line": 1965
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.whichElementType",
          "args": [],
          "line": 1963
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicList::Builder Orphan<DynamicList>::get() {\n  if (schema.whichElementType() == schema::Type::STRUCT) {\n    return DynamicList::Builder(\n        schema, builder.asStructList(structSizeFromSchema(schema.getStructElementType())));\n  } else {\n    return DynamicList::Builder(\n        schema, builder.asList(elementSizeFor(schema.whichElementType())));\n  }\n}"
  },
  {
    "function_name": "Orphan<DynamicStruct>::getReader",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1958-1960",
    "snippet": "DynamicStruct::Reader Orphan<DynamicStruct>::getReader() const {\n  return DynamicStruct::Reader(schema, builder.asStructReader(structSizeFromSchema(schema)));\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DynamicStruct::Reader",
          "args": [
            "schema",
            "builder.asStructReader(structSizeFromSchema(schema))"
          ],
          "line": 1959
        },
        "resolved": true,
        "details": {
          "function_name": "Reader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "377-377",
          "snippet": "Reader(ListSchema schema, _::ListReader reader): schema(schema), reader(reader) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nReader(ListSchema schema, _::ListReader reader): schema(schema), reader(reader) {}"
        }
      },
      {
        "call_info": {
          "callee": "builder.asStructReader",
          "args": [
            "structSizeFromSchema(schema)"
          ],
          "line": 1959
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structSizeFromSchema",
          "args": [
            "schema"
          ],
          "line": 1959
        },
        "resolved": true,
        "details": {
          "function_name": "structSizeFromSchema",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "98-103",
          "snippet": "inline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\ninline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicStruct::Reader Orphan<DynamicStruct>::getReader() const {\n  return DynamicStruct::Reader(schema, builder.asStructReader(structSizeFromSchema(schema)));\n}"
  },
  {
    "function_name": "Orphan<DynamicStruct>::get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1954-1956",
    "snippet": "DynamicStruct::Builder Orphan<DynamicStruct>::get() {\n  return DynamicStruct::Builder(schema, builder.asStruct(structSizeFromSchema(schema)));\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DynamicStruct::Builder",
          "args": [
            "schema",
            "builder.asStruct(structSizeFromSchema(schema))"
          ],
          "line": 1955
        },
        "resolved": true,
        "details": {
          "function_name": "Builder",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "427-427",
          "snippet": "Builder(ListSchema schema, _::ListBuilder builder): schema(schema), builder(builder) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nBuilder(ListSchema schema, _::ListBuilder builder): schema(schema), builder(builder) {}"
        }
      },
      {
        "call_info": {
          "callee": "builder.asStruct",
          "args": [
            "structSizeFromSchema(schema)"
          ],
          "line": 1955
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structSizeFromSchema",
          "args": [
            "schema"
          ],
          "line": 1955
        },
        "resolved": true,
        "details": {
          "function_name": "structSizeFromSchema",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "98-103",
          "snippet": "inline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\ninline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicStruct::Builder Orphan<DynamicStruct>::get() {\n  return DynamicStruct::Builder(schema, builder.asStruct(structSizeFromSchema(schema)));\n}"
  },
  {
    "function_name": "Orphanage::newOrphan",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1944-1952",
    "snippet": "Orphan<DynamicList> Orphanage::newOrphan(ListSchema schema, uint size) const {\n  if (schema.whichElementType() == schema::Type::STRUCT) {\n    return Orphan<DynamicList>(schema, _::OrphanBuilder::initStructList(\n        arena, size * ELEMENTS, structSizeFromSchema(schema.getStructElementType())));\n  } else {\n    return Orphan<DynamicList>(schema, _::OrphanBuilder::initList(\n        arena, size * ELEMENTS, elementSizeFor(schema.whichElementType())));\n  }\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Orphan<DynamicList>",
          "args": [
            "schema",
            "_::OrphanBuilder::initList(\n        arena, size * ELEMENTS, elementSizeFor(schema.whichElementType()))"
          ],
          "line": 1949
        },
        "resolved": true,
        "details": {
          "function_name": "Orphan<DynamicValue>::Orphan",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "1985-2003",
          "snippet": "Orphan<DynamicValue>::Orphan(DynamicValue::Builder value, _::OrphanBuilder&& builder)\n    : type(value.getType()), builder(kj::mv(builder)) {\n  switch (type) {\n    case DynamicValue::UNKNOWN: break;\n    case DynamicValue::VOID: voidValue = value.voidValue; break;\n    case DynamicValue::BOOL: boolValue = value.boolValue; break;\n    case DynamicValue::INT: intValue = value.intValue; break;\n    case DynamicValue::UINT: uintValue = value.uintValue; break;\n    case DynamicValue::FLOAT: floatValue = value.floatValue; break;\n    case DynamicValue::ENUM: enumValue = value.enumValue; break;\n\n    case DynamicValue::TEXT: break;\n    case DynamicValue::DATA: break;\n    case DynamicValue::LIST: listSchema = value.listValue.getSchema(); break;\n    case DynamicValue::STRUCT: structSchema = value.structValue.getSchema(); break;\n    case DynamicValue::CAPABILITY: interfaceSchema = value.capabilityValue.getSchema(); break;\n    case DynamicValue::ANY_POINTER: break;\n  }\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nOrphan<DynamicValue>::Orphan(DynamicValue::Builder value, _::OrphanBuilder&& builder)\n    : type(value.getType()), builder(kj::mv(builder)) {\n  switch (type) {\n    case DynamicValue::UNKNOWN: break;\n    case DynamicValue::VOID: voidValue = value.voidValue; break;\n    case DynamicValue::BOOL: boolValue = value.boolValue; break;\n    case DynamicValue::INT: intValue = value.intValue; break;\n    case DynamicValue::UINT: uintValue = value.uintValue; break;\n    case DynamicValue::FLOAT: floatValue = value.floatValue; break;\n    case DynamicValue::ENUM: enumValue = value.enumValue; break;\n\n    case DynamicValue::TEXT: break;\n    case DynamicValue::DATA: break;\n    case DynamicValue::LIST: listSchema = value.listValue.getSchema(); break;\n    case DynamicValue::STRUCT: structSchema = value.structValue.getSchema(); break;\n    case DynamicValue::CAPABILITY: interfaceSchema = value.capabilityValue.getSchema(); break;\n    case DynamicValue::ANY_POINTER: break;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_::OrphanBuilder::initList",
          "args": [
            "arena",
            "size * ELEMENTS",
            "elementSizeFor(schema.whichElementType())"
          ],
          "line": 1949
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elementSizeFor",
          "args": [
            "schema.whichElementType()"
          ],
          "line": 1950
        },
        "resolved": true,
        "details": {
          "function_name": "elementSizeFor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "70-96",
          "snippet": "ElementSize elementSizeFor(schema::Type::Which elementType) {\n  switch (elementType) {\n    case schema::Type::VOID: return ElementSize::VOID;\n    case schema::Type::BOOL: return ElementSize::BIT;\n    case schema::Type::INT8: return ElementSize::BYTE;\n    case schema::Type::INT16: return ElementSize::TWO_BYTES;\n    case schema::Type::INT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::INT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::UINT8: return ElementSize::BYTE;\n    case schema::Type::UINT16: return ElementSize::TWO_BYTES;\n    case schema::Type::UINT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::UINT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::FLOAT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::FLOAT64: return ElementSize::EIGHT_BYTES;\n\n    case schema::Type::TEXT: return ElementSize::POINTER;\n    case schema::Type::DATA: return ElementSize::POINTER;\n    case schema::Type::LIST: return ElementSize::POINTER;\n    case schema::Type::ENUM: return ElementSize::TWO_BYTES;\n    case schema::Type::STRUCT: return ElementSize::INLINE_COMPOSITE;\n    case schema::Type::INTERFACE: return ElementSize::POINTER;\n    case schema::Type::ANY_POINTER: KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\"); break;\n  }\n\n  // Unknown type.  Treat it as zero-size.\n  return ElementSize::VOID;\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nElementSize elementSizeFor(schema::Type::Which elementType) {\n  switch (elementType) {\n    case schema::Type::VOID: return ElementSize::VOID;\n    case schema::Type::BOOL: return ElementSize::BIT;\n    case schema::Type::INT8: return ElementSize::BYTE;\n    case schema::Type::INT16: return ElementSize::TWO_BYTES;\n    case schema::Type::INT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::INT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::UINT8: return ElementSize::BYTE;\n    case schema::Type::UINT16: return ElementSize::TWO_BYTES;\n    case schema::Type::UINT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::UINT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::FLOAT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::FLOAT64: return ElementSize::EIGHT_BYTES;\n\n    case schema::Type::TEXT: return ElementSize::POINTER;\n    case schema::Type::DATA: return ElementSize::POINTER;\n    case schema::Type::LIST: return ElementSize::POINTER;\n    case schema::Type::ENUM: return ElementSize::TWO_BYTES;\n    case schema::Type::STRUCT: return ElementSize::INLINE_COMPOSITE;\n    case schema::Type::INTERFACE: return ElementSize::POINTER;\n    case schema::Type::ANY_POINTER: KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\"); break;\n  }\n\n  // Unknown type.  Treat it as zero-size.\n  return ElementSize::VOID;\n}"
        }
      },
      {
        "call_info": {
          "callee": "schema.whichElementType",
          "args": [],
          "line": 1950
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_::OrphanBuilder::initStructList",
          "args": [
            "arena",
            "size * ELEMENTS",
            "structSizeFromSchema(schema.getStructElementType())"
          ],
          "line": 1946
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structSizeFromSchema",
          "args": [
            "schema.getStructElementType()"
          ],
          "line": 1947
        },
        "resolved": true,
        "details": {
          "function_name": "structSizeFromSchema",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "98-103",
          "snippet": "inline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\ninline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}"
        }
      },
      {
        "call_info": {
          "callee": "schema.getStructElementType",
          "args": [],
          "line": 1947
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.whichElementType",
          "args": [],
          "line": 1945
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nOrphan<DynamicList> Orphanage::newOrphan(ListSchema schema, uint size) const {\n  if (schema.whichElementType() == schema::Type::STRUCT) {\n    return Orphan<DynamicList>(schema, _::OrphanBuilder::initStructList(\n        arena, size * ELEMENTS, structSizeFromSchema(schema.getStructElementType())));\n  } else {\n    return Orphan<DynamicList>(schema, _::OrphanBuilder::initList(\n        arena, size * ELEMENTS, elementSizeFor(schema.whichElementType())));\n  }\n}"
  },
  {
    "function_name": "Orphanage::newOrphan",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1939-1942",
    "snippet": "Orphan<DynamicStruct> Orphanage::newOrphan(StructSchema schema) const {\n  return Orphan<DynamicStruct>(\n      schema, _::OrphanBuilder::initStruct(arena, structSizeFromSchema(schema)));\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Orphan<DynamicStruct>",
          "args": [
            "schema",
            "_::OrphanBuilder::initStruct(arena, structSizeFromSchema(schema))"
          ],
          "line": 1940
        },
        "resolved": true,
        "details": {
          "function_name": "Orphan<DynamicValue>::Orphan",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "1985-2003",
          "snippet": "Orphan<DynamicValue>::Orphan(DynamicValue::Builder value, _::OrphanBuilder&& builder)\n    : type(value.getType()), builder(kj::mv(builder)) {\n  switch (type) {\n    case DynamicValue::UNKNOWN: break;\n    case DynamicValue::VOID: voidValue = value.voidValue; break;\n    case DynamicValue::BOOL: boolValue = value.boolValue; break;\n    case DynamicValue::INT: intValue = value.intValue; break;\n    case DynamicValue::UINT: uintValue = value.uintValue; break;\n    case DynamicValue::FLOAT: floatValue = value.floatValue; break;\n    case DynamicValue::ENUM: enumValue = value.enumValue; break;\n\n    case DynamicValue::TEXT: break;\n    case DynamicValue::DATA: break;\n    case DynamicValue::LIST: listSchema = value.listValue.getSchema(); break;\n    case DynamicValue::STRUCT: structSchema = value.structValue.getSchema(); break;\n    case DynamicValue::CAPABILITY: interfaceSchema = value.capabilityValue.getSchema(); break;\n    case DynamicValue::ANY_POINTER: break;\n  }\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nOrphan<DynamicValue>::Orphan(DynamicValue::Builder value, _::OrphanBuilder&& builder)\n    : type(value.getType()), builder(kj::mv(builder)) {\n  switch (type) {\n    case DynamicValue::UNKNOWN: break;\n    case DynamicValue::VOID: voidValue = value.voidValue; break;\n    case DynamicValue::BOOL: boolValue = value.boolValue; break;\n    case DynamicValue::INT: intValue = value.intValue; break;\n    case DynamicValue::UINT: uintValue = value.uintValue; break;\n    case DynamicValue::FLOAT: floatValue = value.floatValue; break;\n    case DynamicValue::ENUM: enumValue = value.enumValue; break;\n\n    case DynamicValue::TEXT: break;\n    case DynamicValue::DATA: break;\n    case DynamicValue::LIST: listSchema = value.listValue.getSchema(); break;\n    case DynamicValue::STRUCT: structSchema = value.structValue.getSchema(); break;\n    case DynamicValue::CAPABILITY: interfaceSchema = value.capabilityValue.getSchema(); break;\n    case DynamicValue::ANY_POINTER: break;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_::OrphanBuilder::initStruct",
          "args": [
            "arena",
            "structSizeFromSchema(schema)"
          ],
          "line": 1941
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structSizeFromSchema",
          "args": [
            "schema"
          ],
          "line": 1941
        },
        "resolved": true,
        "details": {
          "function_name": "structSizeFromSchema",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "98-103",
          "snippet": "inline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\ninline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nOrphan<DynamicStruct> Orphanage::newOrphan(StructSchema schema) const {\n  return Orphan<DynamicStruct>(\n      schema, _::OrphanBuilder::initStruct(arena, structSizeFromSchema(schema)));\n}"
  },
  {
    "function_name": "Orphan<AnyPointer>::releaseAs<DynamicCapability>",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1932-1935",
    "snippet": "Orphan<DynamicCapability> Orphan<AnyPointer>::releaseAs<DynamicCapability>(\n    InterfaceSchema schema) {\n  return Orphan<DynamicCapability>(schema, kj::mv(builder));\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Orphan<DynamicCapability>",
          "args": [
            "schema",
            "kj::mv(builder)"
          ],
          "line": 1934
        },
        "resolved": true,
        "details": {
          "function_name": "Orphan<DynamicValue>::Orphan",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "1985-2003",
          "snippet": "Orphan<DynamicValue>::Orphan(DynamicValue::Builder value, _::OrphanBuilder&& builder)\n    : type(value.getType()), builder(kj::mv(builder)) {\n  switch (type) {\n    case DynamicValue::UNKNOWN: break;\n    case DynamicValue::VOID: voidValue = value.voidValue; break;\n    case DynamicValue::BOOL: boolValue = value.boolValue; break;\n    case DynamicValue::INT: intValue = value.intValue; break;\n    case DynamicValue::UINT: uintValue = value.uintValue; break;\n    case DynamicValue::FLOAT: floatValue = value.floatValue; break;\n    case DynamicValue::ENUM: enumValue = value.enumValue; break;\n\n    case DynamicValue::TEXT: break;\n    case DynamicValue::DATA: break;\n    case DynamicValue::LIST: listSchema = value.listValue.getSchema(); break;\n    case DynamicValue::STRUCT: structSchema = value.structValue.getSchema(); break;\n    case DynamicValue::CAPABILITY: interfaceSchema = value.capabilityValue.getSchema(); break;\n    case DynamicValue::ANY_POINTER: break;\n  }\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nOrphan<DynamicValue>::Orphan(DynamicValue::Builder value, _::OrphanBuilder&& builder)\n    : type(value.getType()), builder(kj::mv(builder)) {\n  switch (type) {\n    case DynamicValue::UNKNOWN: break;\n    case DynamicValue::VOID: voidValue = value.voidValue; break;\n    case DynamicValue::BOOL: boolValue = value.boolValue; break;\n    case DynamicValue::INT: intValue = value.intValue; break;\n    case DynamicValue::UINT: uintValue = value.uintValue; break;\n    case DynamicValue::FLOAT: floatValue = value.floatValue; break;\n    case DynamicValue::ENUM: enumValue = value.enumValue; break;\n\n    case DynamicValue::TEXT: break;\n    case DynamicValue::DATA: break;\n    case DynamicValue::LIST: listSchema = value.listValue.getSchema(); break;\n    case DynamicValue::STRUCT: structSchema = value.structValue.getSchema(); break;\n    case DynamicValue::CAPABILITY: interfaceSchema = value.capabilityValue.getSchema(); break;\n    case DynamicValue::ANY_POINTER: break;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "builder"
          ],
          "line": 1934
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nOrphan<DynamicCapability> Orphan<AnyPointer>::releaseAs<DynamicCapability>(\n    InterfaceSchema schema) {\n  return Orphan<DynamicCapability>(schema, kj::mv(builder));\n}"
  },
  {
    "function_name": "Orphan<AnyPointer>::getAsReader<DynamicCapability>",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1927-1930",
    "snippet": "DynamicCapability::Client Orphan<AnyPointer>::getAsReader<DynamicCapability>(\n    InterfaceSchema schema) const {\n  return DynamicCapability::Client(schema, builder.asCapability());\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DynamicCapability::Client",
          "args": [
            "schema",
            "builder.asCapability()"
          ],
          "line": 1929
        },
        "resolved": true,
        "details": {
          "function_name": "Client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "476-477",
          "snippet": "Client(InterfaceSchema schema, kj::Own<ClientHook>&& hook)\n      : Capability::Client(kj::mv(hook)), schema(schema) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nClient(InterfaceSchema schema, kj::Own<ClientHook>&& hook)\n      : Capability::Client(kj::mv(hook)), schema(schema) {}"
        }
      },
      {
        "call_info": {
          "callee": "builder.asCapability",
          "args": [],
          "line": 1929
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicCapability::Client Orphan<AnyPointer>::getAsReader<DynamicCapability>(\n    InterfaceSchema schema) const {\n  return DynamicCapability::Client(schema, builder.asCapability());\n}"
  },
  {
    "function_name": "Orphan<AnyPointer>::getAs<DynamicCapability>",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1923-1925",
    "snippet": "DynamicCapability::Client Orphan<AnyPointer>::getAs<DynamicCapability>(InterfaceSchema schema) {\n  return DynamicCapability::Client(schema, builder.asCapability());\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DynamicCapability::Client",
          "args": [
            "schema",
            "builder.asCapability()"
          ],
          "line": 1924
        },
        "resolved": true,
        "details": {
          "function_name": "Client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "476-477",
          "snippet": "Client(InterfaceSchema schema, kj::Own<ClientHook>&& hook)\n      : Capability::Client(kj::mv(hook)), schema(schema) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nClient(InterfaceSchema schema, kj::Own<ClientHook>&& hook)\n      : Capability::Client(kj::mv(hook)), schema(schema) {}"
        }
      },
      {
        "call_info": {
          "callee": "builder.asCapability",
          "args": [],
          "line": 1924
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicCapability::Client Orphan<AnyPointer>::getAs<DynamicCapability>(InterfaceSchema schema) {\n  return DynamicCapability::Client(schema, builder.asCapability());\n}"
  },
  {
    "function_name": "Orphan<AnyPointer>::releaseAs<DynamicList>",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1918-1920",
    "snippet": "Orphan<DynamicList> Orphan<AnyPointer>::releaseAs<DynamicList>(ListSchema schema) {\n  return Orphan<DynamicList>(schema, kj::mv(builder));\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Orphan<DynamicList>",
          "args": [
            "schema",
            "kj::mv(builder)"
          ],
          "line": 1919
        },
        "resolved": true,
        "details": {
          "function_name": "Orphan<DynamicValue>::Orphan",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "1985-2003",
          "snippet": "Orphan<DynamicValue>::Orphan(DynamicValue::Builder value, _::OrphanBuilder&& builder)\n    : type(value.getType()), builder(kj::mv(builder)) {\n  switch (type) {\n    case DynamicValue::UNKNOWN: break;\n    case DynamicValue::VOID: voidValue = value.voidValue; break;\n    case DynamicValue::BOOL: boolValue = value.boolValue; break;\n    case DynamicValue::INT: intValue = value.intValue; break;\n    case DynamicValue::UINT: uintValue = value.uintValue; break;\n    case DynamicValue::FLOAT: floatValue = value.floatValue; break;\n    case DynamicValue::ENUM: enumValue = value.enumValue; break;\n\n    case DynamicValue::TEXT: break;\n    case DynamicValue::DATA: break;\n    case DynamicValue::LIST: listSchema = value.listValue.getSchema(); break;\n    case DynamicValue::STRUCT: structSchema = value.structValue.getSchema(); break;\n    case DynamicValue::CAPABILITY: interfaceSchema = value.capabilityValue.getSchema(); break;\n    case DynamicValue::ANY_POINTER: break;\n  }\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nOrphan<DynamicValue>::Orphan(DynamicValue::Builder value, _::OrphanBuilder&& builder)\n    : type(value.getType()), builder(kj::mv(builder)) {\n  switch (type) {\n    case DynamicValue::UNKNOWN: break;\n    case DynamicValue::VOID: voidValue = value.voidValue; break;\n    case DynamicValue::BOOL: boolValue = value.boolValue; break;\n    case DynamicValue::INT: intValue = value.intValue; break;\n    case DynamicValue::UINT: uintValue = value.uintValue; break;\n    case DynamicValue::FLOAT: floatValue = value.floatValue; break;\n    case DynamicValue::ENUM: enumValue = value.enumValue; break;\n\n    case DynamicValue::TEXT: break;\n    case DynamicValue::DATA: break;\n    case DynamicValue::LIST: listSchema = value.listValue.getSchema(); break;\n    case DynamicValue::STRUCT: structSchema = value.structValue.getSchema(); break;\n    case DynamicValue::CAPABILITY: interfaceSchema = value.capabilityValue.getSchema(); break;\n    case DynamicValue::ANY_POINTER: break;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "builder"
          ],
          "line": 1919
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nOrphan<DynamicList> Orphan<AnyPointer>::releaseAs<DynamicList>(ListSchema schema) {\n  return Orphan<DynamicList>(schema, kj::mv(builder));\n}"
  },
  {
    "function_name": "Orphan<AnyPointer>::getAsReader<DynamicList>",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1913-1916",
    "snippet": "DynamicList::Reader Orphan<AnyPointer>::getAsReader<DynamicList>(ListSchema schema) const {\n  return DynamicList::Reader(schema, builder.asListReader(\n      elementSizeFor(schema.whichElementType())));\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DynamicList::Reader",
          "args": [
            "schema",
            "builder.asListReader(\n      elementSizeFor(schema.whichElementType()))"
          ],
          "line": 1914
        },
        "resolved": true,
        "details": {
          "function_name": "Reader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "377-377",
          "snippet": "Reader(ListSchema schema, _::ListReader reader): schema(schema), reader(reader) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nReader(ListSchema schema, _::ListReader reader): schema(schema), reader(reader) {}"
        }
      },
      {
        "call_info": {
          "callee": "builder.asListReader",
          "args": [
            "elementSizeFor(schema.whichElementType())"
          ],
          "line": 1914
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elementSizeFor",
          "args": [
            "schema.whichElementType()"
          ],
          "line": 1915
        },
        "resolved": true,
        "details": {
          "function_name": "elementSizeFor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "70-96",
          "snippet": "ElementSize elementSizeFor(schema::Type::Which elementType) {\n  switch (elementType) {\n    case schema::Type::VOID: return ElementSize::VOID;\n    case schema::Type::BOOL: return ElementSize::BIT;\n    case schema::Type::INT8: return ElementSize::BYTE;\n    case schema::Type::INT16: return ElementSize::TWO_BYTES;\n    case schema::Type::INT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::INT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::UINT8: return ElementSize::BYTE;\n    case schema::Type::UINT16: return ElementSize::TWO_BYTES;\n    case schema::Type::UINT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::UINT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::FLOAT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::FLOAT64: return ElementSize::EIGHT_BYTES;\n\n    case schema::Type::TEXT: return ElementSize::POINTER;\n    case schema::Type::DATA: return ElementSize::POINTER;\n    case schema::Type::LIST: return ElementSize::POINTER;\n    case schema::Type::ENUM: return ElementSize::TWO_BYTES;\n    case schema::Type::STRUCT: return ElementSize::INLINE_COMPOSITE;\n    case schema::Type::INTERFACE: return ElementSize::POINTER;\n    case schema::Type::ANY_POINTER: KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\"); break;\n  }\n\n  // Unknown type.  Treat it as zero-size.\n  return ElementSize::VOID;\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nElementSize elementSizeFor(schema::Type::Which elementType) {\n  switch (elementType) {\n    case schema::Type::VOID: return ElementSize::VOID;\n    case schema::Type::BOOL: return ElementSize::BIT;\n    case schema::Type::INT8: return ElementSize::BYTE;\n    case schema::Type::INT16: return ElementSize::TWO_BYTES;\n    case schema::Type::INT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::INT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::UINT8: return ElementSize::BYTE;\n    case schema::Type::UINT16: return ElementSize::TWO_BYTES;\n    case schema::Type::UINT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::UINT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::FLOAT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::FLOAT64: return ElementSize::EIGHT_BYTES;\n\n    case schema::Type::TEXT: return ElementSize::POINTER;\n    case schema::Type::DATA: return ElementSize::POINTER;\n    case schema::Type::LIST: return ElementSize::POINTER;\n    case schema::Type::ENUM: return ElementSize::TWO_BYTES;\n    case schema::Type::STRUCT: return ElementSize::INLINE_COMPOSITE;\n    case schema::Type::INTERFACE: return ElementSize::POINTER;\n    case schema::Type::ANY_POINTER: KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\"); break;\n  }\n\n  // Unknown type.  Treat it as zero-size.\n  return ElementSize::VOID;\n}"
        }
      },
      {
        "call_info": {
          "callee": "schema.whichElementType",
          "args": [],
          "line": 1915
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicList::Reader Orphan<AnyPointer>::getAsReader<DynamicList>(ListSchema schema) const {\n  return DynamicList::Reader(schema, builder.asListReader(\n      elementSizeFor(schema.whichElementType())));\n}"
  },
  {
    "function_name": "Orphan<AnyPointer>::getAs<DynamicList>",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1904-1911",
    "snippet": "DynamicList::Builder Orphan<AnyPointer>::getAs<DynamicList>(ListSchema schema) {\n  if (schema.whichElementType() == schema::Type::STRUCT) {\n    return DynamicList::Builder(schema, builder.asStructList(\n        structSizeFromSchema(schema.getStructElementType())));\n  } else {\n    return DynamicList::Builder(schema, builder.asList(elementSizeFor(schema.whichElementType())));\n  }\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DynamicList::Builder",
          "args": [
            "schema",
            "builder.asList(elementSizeFor(schema.whichElementType()))"
          ],
          "line": 1909
        },
        "resolved": true,
        "details": {
          "function_name": "Builder",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "427-427",
          "snippet": "Builder(ListSchema schema, _::ListBuilder builder): schema(schema), builder(builder) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nBuilder(ListSchema schema, _::ListBuilder builder): schema(schema), builder(builder) {}"
        }
      },
      {
        "call_info": {
          "callee": "builder.asList",
          "args": [
            "elementSizeFor(schema.whichElementType())"
          ],
          "line": 1909
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elementSizeFor",
          "args": [
            "schema.whichElementType()"
          ],
          "line": 1909
        },
        "resolved": true,
        "details": {
          "function_name": "elementSizeFor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "70-96",
          "snippet": "ElementSize elementSizeFor(schema::Type::Which elementType) {\n  switch (elementType) {\n    case schema::Type::VOID: return ElementSize::VOID;\n    case schema::Type::BOOL: return ElementSize::BIT;\n    case schema::Type::INT8: return ElementSize::BYTE;\n    case schema::Type::INT16: return ElementSize::TWO_BYTES;\n    case schema::Type::INT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::INT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::UINT8: return ElementSize::BYTE;\n    case schema::Type::UINT16: return ElementSize::TWO_BYTES;\n    case schema::Type::UINT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::UINT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::FLOAT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::FLOAT64: return ElementSize::EIGHT_BYTES;\n\n    case schema::Type::TEXT: return ElementSize::POINTER;\n    case schema::Type::DATA: return ElementSize::POINTER;\n    case schema::Type::LIST: return ElementSize::POINTER;\n    case schema::Type::ENUM: return ElementSize::TWO_BYTES;\n    case schema::Type::STRUCT: return ElementSize::INLINE_COMPOSITE;\n    case schema::Type::INTERFACE: return ElementSize::POINTER;\n    case schema::Type::ANY_POINTER: KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\"); break;\n  }\n\n  // Unknown type.  Treat it as zero-size.\n  return ElementSize::VOID;\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nElementSize elementSizeFor(schema::Type::Which elementType) {\n  switch (elementType) {\n    case schema::Type::VOID: return ElementSize::VOID;\n    case schema::Type::BOOL: return ElementSize::BIT;\n    case schema::Type::INT8: return ElementSize::BYTE;\n    case schema::Type::INT16: return ElementSize::TWO_BYTES;\n    case schema::Type::INT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::INT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::UINT8: return ElementSize::BYTE;\n    case schema::Type::UINT16: return ElementSize::TWO_BYTES;\n    case schema::Type::UINT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::UINT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::FLOAT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::FLOAT64: return ElementSize::EIGHT_BYTES;\n\n    case schema::Type::TEXT: return ElementSize::POINTER;\n    case schema::Type::DATA: return ElementSize::POINTER;\n    case schema::Type::LIST: return ElementSize::POINTER;\n    case schema::Type::ENUM: return ElementSize::TWO_BYTES;\n    case schema::Type::STRUCT: return ElementSize::INLINE_COMPOSITE;\n    case schema::Type::INTERFACE: return ElementSize::POINTER;\n    case schema::Type::ANY_POINTER: KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\"); break;\n  }\n\n  // Unknown type.  Treat it as zero-size.\n  return ElementSize::VOID;\n}"
        }
      },
      {
        "call_info": {
          "callee": "schema.whichElementType",
          "args": [],
          "line": 1909
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.asStructList",
          "args": [
            "structSizeFromSchema(schema.getStructElementType())"
          ],
          "line": 1906
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structSizeFromSchema",
          "args": [
            "schema.getStructElementType()"
          ],
          "line": 1907
        },
        "resolved": true,
        "details": {
          "function_name": "structSizeFromSchema",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "98-103",
          "snippet": "inline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\ninline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}"
        }
      },
      {
        "call_info": {
          "callee": "schema.getStructElementType",
          "args": [],
          "line": 1907
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.whichElementType",
          "args": [],
          "line": 1905
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicList::Builder Orphan<AnyPointer>::getAs<DynamicList>(ListSchema schema) {\n  if (schema.whichElementType() == schema::Type::STRUCT) {\n    return DynamicList::Builder(schema, builder.asStructList(\n        structSizeFromSchema(schema.getStructElementType())));\n  } else {\n    return DynamicList::Builder(schema, builder.asList(elementSizeFor(schema.whichElementType())));\n  }\n}"
  },
  {
    "function_name": "Orphan<AnyPointer>::releaseAs<DynamicStruct>",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1899-1901",
    "snippet": "Orphan<DynamicStruct> Orphan<AnyPointer>::releaseAs<DynamicStruct>(StructSchema schema) {\n  return Orphan<DynamicStruct>(schema, kj::mv(builder));\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Orphan<DynamicStruct>",
          "args": [
            "schema",
            "kj::mv(builder)"
          ],
          "line": 1900
        },
        "resolved": true,
        "details": {
          "function_name": "Orphan<DynamicValue>::Orphan",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "1985-2003",
          "snippet": "Orphan<DynamicValue>::Orphan(DynamicValue::Builder value, _::OrphanBuilder&& builder)\n    : type(value.getType()), builder(kj::mv(builder)) {\n  switch (type) {\n    case DynamicValue::UNKNOWN: break;\n    case DynamicValue::VOID: voidValue = value.voidValue; break;\n    case DynamicValue::BOOL: boolValue = value.boolValue; break;\n    case DynamicValue::INT: intValue = value.intValue; break;\n    case DynamicValue::UINT: uintValue = value.uintValue; break;\n    case DynamicValue::FLOAT: floatValue = value.floatValue; break;\n    case DynamicValue::ENUM: enumValue = value.enumValue; break;\n\n    case DynamicValue::TEXT: break;\n    case DynamicValue::DATA: break;\n    case DynamicValue::LIST: listSchema = value.listValue.getSchema(); break;\n    case DynamicValue::STRUCT: structSchema = value.structValue.getSchema(); break;\n    case DynamicValue::CAPABILITY: interfaceSchema = value.capabilityValue.getSchema(); break;\n    case DynamicValue::ANY_POINTER: break;\n  }\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nOrphan<DynamicValue>::Orphan(DynamicValue::Builder value, _::OrphanBuilder&& builder)\n    : type(value.getType()), builder(kj::mv(builder)) {\n  switch (type) {\n    case DynamicValue::UNKNOWN: break;\n    case DynamicValue::VOID: voidValue = value.voidValue; break;\n    case DynamicValue::BOOL: boolValue = value.boolValue; break;\n    case DynamicValue::INT: intValue = value.intValue; break;\n    case DynamicValue::UINT: uintValue = value.uintValue; break;\n    case DynamicValue::FLOAT: floatValue = value.floatValue; break;\n    case DynamicValue::ENUM: enumValue = value.enumValue; break;\n\n    case DynamicValue::TEXT: break;\n    case DynamicValue::DATA: break;\n    case DynamicValue::LIST: listSchema = value.listValue.getSchema(); break;\n    case DynamicValue::STRUCT: structSchema = value.structValue.getSchema(); break;\n    case DynamicValue::CAPABILITY: interfaceSchema = value.capabilityValue.getSchema(); break;\n    case DynamicValue::ANY_POINTER: break;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "builder"
          ],
          "line": 1900
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nOrphan<DynamicStruct> Orphan<AnyPointer>::releaseAs<DynamicStruct>(StructSchema schema) {\n  return Orphan<DynamicStruct>(schema, kj::mv(builder));\n}"
  },
  {
    "function_name": "Orphan<AnyPointer>::getAsReader<DynamicStruct>",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1895-1897",
    "snippet": "DynamicStruct::Reader Orphan<AnyPointer>::getAsReader<DynamicStruct>(StructSchema schema) const {\n  return DynamicStruct::Reader(schema, builder.asStructReader(structSizeFromSchema(schema)));\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DynamicStruct::Reader",
          "args": [
            "schema",
            "builder.asStructReader(structSizeFromSchema(schema))"
          ],
          "line": 1896
        },
        "resolved": true,
        "details": {
          "function_name": "Reader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "377-377",
          "snippet": "Reader(ListSchema schema, _::ListReader reader): schema(schema), reader(reader) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nReader(ListSchema schema, _::ListReader reader): schema(schema), reader(reader) {}"
        }
      },
      {
        "call_info": {
          "callee": "builder.asStructReader",
          "args": [
            "structSizeFromSchema(schema)"
          ],
          "line": 1896
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structSizeFromSchema",
          "args": [
            "schema"
          ],
          "line": 1896
        },
        "resolved": true,
        "details": {
          "function_name": "structSizeFromSchema",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "98-103",
          "snippet": "inline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\ninline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicStruct::Reader Orphan<AnyPointer>::getAsReader<DynamicStruct>(StructSchema schema) const {\n  return DynamicStruct::Reader(schema, builder.asStructReader(structSizeFromSchema(schema)));\n}"
  },
  {
    "function_name": "Orphan<AnyPointer>::getAs<DynamicStruct>",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1891-1893",
    "snippet": "DynamicStruct::Builder Orphan<AnyPointer>::getAs<DynamicStruct>(StructSchema schema) {\n  return DynamicStruct::Builder(schema, builder.asStruct(structSizeFromSchema(schema)));\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DynamicStruct::Builder",
          "args": [
            "schema",
            "builder.asStruct(structSizeFromSchema(schema))"
          ],
          "line": 1892
        },
        "resolved": true,
        "details": {
          "function_name": "Builder",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "427-427",
          "snippet": "Builder(ListSchema schema, _::ListBuilder builder): schema(schema), builder(builder) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nBuilder(ListSchema schema, _::ListBuilder builder): schema(schema), builder(builder) {}"
        }
      },
      {
        "call_info": {
          "callee": "builder.asStruct",
          "args": [
            "structSizeFromSchema(schema)"
          ],
          "line": 1892
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structSizeFromSchema",
          "args": [
            "schema"
          ],
          "line": 1892
        },
        "resolved": true,
        "details": {
          "function_name": "structSizeFromSchema",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "98-103",
          "snippet": "inline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\ninline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicStruct::Builder Orphan<AnyPointer>::getAs<DynamicStruct>(StructSchema schema) {\n  return DynamicStruct::Builder(schema, builder.asStruct(structSizeFromSchema(schema)));\n}"
  },
  {
    "function_name": "AnyPointer::Builder::adopt<DynamicValue>",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1868-1888",
    "snippet": "void AnyPointer::Builder::adopt<DynamicValue>(Orphan<DynamicValue>&& orphan) {\n  switch (orphan.getType()) {\n    case DynamicValue::UNKNOWN:\n    case DynamicValue::VOID:\n    case DynamicValue::BOOL:\n    case DynamicValue::INT:\n    case DynamicValue::UINT:\n    case DynamicValue::FLOAT:\n    case DynamicValue::ENUM:\n      KJ_FAIL_REQUIRE(\"AnyPointer cannot adopt primitive (non-object) value.\");\n\n    case DynamicValue::STRUCT:\n    case DynamicValue::LIST:\n    case DynamicValue::TEXT:\n    case DynamicValue::DATA:\n    case DynamicValue::CAPABILITY:\n    case DynamicValue::ANY_POINTER:\n      builder.adopt(kj::mv(orphan.builder));\n      break;\n  }\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "builder.adopt",
          "args": [
            "kj::mv(orphan.builder)"
          ],
          "line": 1885
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "orphan.builder"
          ],
          "line": 1885
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_FAIL_REQUIRE",
          "args": [
            "\"AnyPointer cannot adopt primitive (non-object) value.\""
          ],
          "line": 1877
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.getType",
          "args": [],
          "line": 1869
        },
        "resolved": true,
        "details": {
          "function_name": "getType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "942-942",
          "snippet": "inline DynamicValue::Type getType() { return type; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline DynamicValue::Type getType() { return type; }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nvoid AnyPointer::Builder::adopt<DynamicValue>(Orphan<DynamicValue>&& orphan) {\n  switch (orphan.getType()) {\n    case DynamicValue::UNKNOWN:\n    case DynamicValue::VOID:\n    case DynamicValue::BOOL:\n    case DynamicValue::INT:\n    case DynamicValue::UINT:\n    case DynamicValue::FLOAT:\n    case DynamicValue::ENUM:\n      KJ_FAIL_REQUIRE(\"AnyPointer cannot adopt primitive (non-object) value.\");\n\n    case DynamicValue::STRUCT:\n    case DynamicValue::LIST:\n    case DynamicValue::TEXT:\n    case DynamicValue::DATA:\n    case DynamicValue::CAPABILITY:\n    case DynamicValue::ANY_POINTER:\n      builder.adopt(kj::mv(orphan.builder));\n      break;\n  }\n}"
  },
  {
    "function_name": "PointerHelpers<DynamicCapability, Kind::OTHER>::set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1860-1863",
    "snippet": "void PointerHelpers<DynamicCapability, Kind::OTHER>::set(\n    PointerBuilder builder, DynamicCapability::Client&& value) {\n  builder.setCapability(kj::mv(value.hook));\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "builder.setCapability",
          "args": [
            "kj::mv(value.hook)"
          ],
          "line": 1862
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "value.hook"
          ],
          "line": 1862
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nvoid PointerHelpers<DynamicCapability, Kind::OTHER>::set(\n    PointerBuilder builder, DynamicCapability::Client&& value) {\n  builder.setCapability(kj::mv(value.hook));\n}"
  },
  {
    "function_name": "PointerHelpers<DynamicCapability, Kind::OTHER>::set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1856-1859",
    "snippet": "void PointerHelpers<DynamicCapability, Kind::OTHER>::set(\n    PointerBuilder builder, DynamicCapability::Client& value) {\n  builder.setCapability(value.hook->addRef());\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "builder.setCapability",
          "args": [
            "value.hook->addRef()"
          ],
          "line": 1858
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.hook->addRef",
          "args": [],
          "line": 1858
        },
        "resolved": true,
        "details": {
          "function_name": "addRef",
          "container": "BrokenClient",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.c++",
          "lines": "598-600",
          "snippet": "kj::Own<ClientHook> addRef() override {\n    return kj::addRef(*this);\n  }",
          "includes": [
            "#include \"generated-header-support.h\"",
            "#include <map>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <kj/refcount.h>",
            "#include \"arena.h\"",
            "#include \"message.h\"",
            "#include \"capability.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"generated-header-support.h\"\n#include <map>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <kj/refcount.h>\n#include \"arena.h\"\n#include \"message.h\"\n#include \"capability.h\"\n\nBrokenClient {\n  kj::Own<ClientHook> addRef() override {\n      return kj::addRef(*this);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nvoid PointerHelpers<DynamicCapability, Kind::OTHER>::set(\n    PointerBuilder builder, DynamicCapability::Client& value) {\n  builder.setCapability(value.hook->addRef());\n}"
  },
  {
    "function_name": "PointerHelpers<DynamicCapability, Kind::OTHER>::getDynamic",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1852-1855",
    "snippet": "DynamicCapability::Client PointerHelpers<DynamicCapability, Kind::OTHER>::getDynamic(\n    PointerBuilder builder, InterfaceSchema schema) {\n  return DynamicCapability::Client(schema, builder.getCapability());\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DynamicCapability::Client",
          "args": [
            "schema",
            "builder.getCapability()"
          ],
          "line": 1854
        },
        "resolved": true,
        "details": {
          "function_name": "Client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "476-477",
          "snippet": "Client(InterfaceSchema schema, kj::Own<ClientHook>&& hook)\n      : Capability::Client(kj::mv(hook)), schema(schema) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nClient(InterfaceSchema schema, kj::Own<ClientHook>&& hook)\n      : Capability::Client(kj::mv(hook)), schema(schema) {}"
        }
      },
      {
        "call_info": {
          "callee": "builder.getCapability",
          "args": [],
          "line": 1854
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicCapability::Client PointerHelpers<DynamicCapability, Kind::OTHER>::getDynamic(\n    PointerBuilder builder, InterfaceSchema schema) {\n  return DynamicCapability::Client(schema, builder.getCapability());\n}"
  },
  {
    "function_name": "PointerHelpers<DynamicCapability, Kind::OTHER>::getDynamic",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1848-1851",
    "snippet": "DynamicCapability::Client PointerHelpers<DynamicCapability, Kind::OTHER>::getDynamic(\n    PointerReader reader, InterfaceSchema schema) {\n  return DynamicCapability::Client(schema, reader.getCapability());\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DynamicCapability::Client",
          "args": [
            "schema",
            "reader.getCapability()"
          ],
          "line": 1850
        },
        "resolved": true,
        "details": {
          "function_name": "Client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "476-477",
          "snippet": "Client(InterfaceSchema schema, kj::Own<ClientHook>&& hook)\n      : Capability::Client(kj::mv(hook)), schema(schema) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nClient(InterfaceSchema schema, kj::Own<ClientHook>&& hook)\n      : Capability::Client(kj::mv(hook)), schema(schema) {}"
        }
      },
      {
        "call_info": {
          "callee": "reader.getCapability",
          "args": [],
          "line": 1850
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicCapability::Client PointerHelpers<DynamicCapability, Kind::OTHER>::getDynamic(\n    PointerReader reader, InterfaceSchema schema) {\n  return DynamicCapability::Client(schema, reader.getCapability());\n}"
  },
  {
    "function_name": "PointerHelpers<DynamicList, Kind::OTHER>::init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1836-1846",
    "snippet": "DynamicList::Builder PointerHelpers<DynamicList, Kind::OTHER>::init(\n    PointerBuilder builder, ListSchema schema, uint size) {\n  if (schema.whichElementType() == schema::Type::STRUCT) {\n    return DynamicList::Builder(schema,\n        builder.initStructList(size * ELEMENTS,\n            structSizeFromSchema(schema.getStructElementType())));\n  } else {\n    return DynamicList::Builder(schema,\n        builder.initList(elementSizeFor(schema.whichElementType()), size * ELEMENTS));\n  }\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DynamicList::Builder",
          "args": [
            "schema",
            "builder.initList(elementSizeFor(schema.whichElementType()), size * ELEMENTS)"
          ],
          "line": 1843
        },
        "resolved": true,
        "details": {
          "function_name": "Builder",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "427-427",
          "snippet": "Builder(ListSchema schema, _::ListBuilder builder): schema(schema), builder(builder) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nBuilder(ListSchema schema, _::ListBuilder builder): schema(schema), builder(builder) {}"
        }
      },
      {
        "call_info": {
          "callee": "builder.initList",
          "args": [
            "elementSizeFor(schema.whichElementType())",
            "size * ELEMENTS"
          ],
          "line": 1844
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elementSizeFor",
          "args": [
            "schema.whichElementType()"
          ],
          "line": 1844
        },
        "resolved": true,
        "details": {
          "function_name": "elementSizeFor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "70-96",
          "snippet": "ElementSize elementSizeFor(schema::Type::Which elementType) {\n  switch (elementType) {\n    case schema::Type::VOID: return ElementSize::VOID;\n    case schema::Type::BOOL: return ElementSize::BIT;\n    case schema::Type::INT8: return ElementSize::BYTE;\n    case schema::Type::INT16: return ElementSize::TWO_BYTES;\n    case schema::Type::INT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::INT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::UINT8: return ElementSize::BYTE;\n    case schema::Type::UINT16: return ElementSize::TWO_BYTES;\n    case schema::Type::UINT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::UINT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::FLOAT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::FLOAT64: return ElementSize::EIGHT_BYTES;\n\n    case schema::Type::TEXT: return ElementSize::POINTER;\n    case schema::Type::DATA: return ElementSize::POINTER;\n    case schema::Type::LIST: return ElementSize::POINTER;\n    case schema::Type::ENUM: return ElementSize::TWO_BYTES;\n    case schema::Type::STRUCT: return ElementSize::INLINE_COMPOSITE;\n    case schema::Type::INTERFACE: return ElementSize::POINTER;\n    case schema::Type::ANY_POINTER: KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\"); break;\n  }\n\n  // Unknown type.  Treat it as zero-size.\n  return ElementSize::VOID;\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nElementSize elementSizeFor(schema::Type::Which elementType) {\n  switch (elementType) {\n    case schema::Type::VOID: return ElementSize::VOID;\n    case schema::Type::BOOL: return ElementSize::BIT;\n    case schema::Type::INT8: return ElementSize::BYTE;\n    case schema::Type::INT16: return ElementSize::TWO_BYTES;\n    case schema::Type::INT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::INT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::UINT8: return ElementSize::BYTE;\n    case schema::Type::UINT16: return ElementSize::TWO_BYTES;\n    case schema::Type::UINT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::UINT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::FLOAT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::FLOAT64: return ElementSize::EIGHT_BYTES;\n\n    case schema::Type::TEXT: return ElementSize::POINTER;\n    case schema::Type::DATA: return ElementSize::POINTER;\n    case schema::Type::LIST: return ElementSize::POINTER;\n    case schema::Type::ENUM: return ElementSize::TWO_BYTES;\n    case schema::Type::STRUCT: return ElementSize::INLINE_COMPOSITE;\n    case schema::Type::INTERFACE: return ElementSize::POINTER;\n    case schema::Type::ANY_POINTER: KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\"); break;\n  }\n\n  // Unknown type.  Treat it as zero-size.\n  return ElementSize::VOID;\n}"
        }
      },
      {
        "call_info": {
          "callee": "schema.whichElementType",
          "args": [],
          "line": 1844
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initStructList",
          "args": [
            "size * ELEMENTS",
            "structSizeFromSchema(schema.getStructElementType())"
          ],
          "line": 1840
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structSizeFromSchema",
          "args": [
            "schema.getStructElementType()"
          ],
          "line": 1841
        },
        "resolved": true,
        "details": {
          "function_name": "structSizeFromSchema",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "98-103",
          "snippet": "inline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\ninline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}"
        }
      },
      {
        "call_info": {
          "callee": "schema.getStructElementType",
          "args": [],
          "line": 1841
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.whichElementType",
          "args": [],
          "line": 1838
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicList::Builder PointerHelpers<DynamicList, Kind::OTHER>::init(\n    PointerBuilder builder, ListSchema schema, uint size) {\n  if (schema.whichElementType() == schema::Type::STRUCT) {\n    return DynamicList::Builder(schema,\n        builder.initStructList(size * ELEMENTS,\n            structSizeFromSchema(schema.getStructElementType())));\n  } else {\n    return DynamicList::Builder(schema,\n        builder.initList(elementSizeFor(schema.whichElementType()), size * ELEMENTS));\n  }\n}"
  },
  {
    "function_name": "PointerHelpers<DynamicList, Kind::OTHER>::set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1832-1835",
    "snippet": "void PointerHelpers<DynamicList, Kind::OTHER>::set(\n    PointerBuilder builder, const DynamicList::Reader& value) {\n  builder.setList(value.reader);\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "builder.setList",
          "args": [
            "value.reader"
          ],
          "line": 1834
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nvoid PointerHelpers<DynamicList, Kind::OTHER>::set(\n    PointerBuilder builder, const DynamicList::Reader& value) {\n  builder.setList(value.reader);\n}"
  },
  {
    "function_name": "PointerHelpers<DynamicList, Kind::OTHER>::getDynamic",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1820-1831",
    "snippet": "DynamicList::Builder PointerHelpers<DynamicList, Kind::OTHER>::getDynamic(\n    PointerBuilder builder, ListSchema schema) {\n  if (schema.whichElementType() == schema::Type::STRUCT) {\n    return DynamicList::Builder(schema,\n        builder.getStructList(\n            structSizeFromSchema(schema.getStructElementType()),\n            nullptr));\n  } else {\n    return DynamicList::Builder(schema,\n        builder.getList(elementSizeFor(schema.whichElementType()), nullptr));\n  }\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DynamicList::Builder",
          "args": [
            "schema",
            "builder.getList(elementSizeFor(schema.whichElementType()), nullptr)"
          ],
          "line": 1828
        },
        "resolved": true,
        "details": {
          "function_name": "Builder",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "427-427",
          "snippet": "Builder(ListSchema schema, _::ListBuilder builder): schema(schema), builder(builder) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nBuilder(ListSchema schema, _::ListBuilder builder): schema(schema), builder(builder) {}"
        }
      },
      {
        "call_info": {
          "callee": "builder.getList",
          "args": [
            "elementSizeFor(schema.whichElementType())",
            "nullptr"
          ],
          "line": 1829
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elementSizeFor",
          "args": [
            "schema.whichElementType()"
          ],
          "line": 1829
        },
        "resolved": true,
        "details": {
          "function_name": "elementSizeFor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "70-96",
          "snippet": "ElementSize elementSizeFor(schema::Type::Which elementType) {\n  switch (elementType) {\n    case schema::Type::VOID: return ElementSize::VOID;\n    case schema::Type::BOOL: return ElementSize::BIT;\n    case schema::Type::INT8: return ElementSize::BYTE;\n    case schema::Type::INT16: return ElementSize::TWO_BYTES;\n    case schema::Type::INT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::INT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::UINT8: return ElementSize::BYTE;\n    case schema::Type::UINT16: return ElementSize::TWO_BYTES;\n    case schema::Type::UINT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::UINT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::FLOAT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::FLOAT64: return ElementSize::EIGHT_BYTES;\n\n    case schema::Type::TEXT: return ElementSize::POINTER;\n    case schema::Type::DATA: return ElementSize::POINTER;\n    case schema::Type::LIST: return ElementSize::POINTER;\n    case schema::Type::ENUM: return ElementSize::TWO_BYTES;\n    case schema::Type::STRUCT: return ElementSize::INLINE_COMPOSITE;\n    case schema::Type::INTERFACE: return ElementSize::POINTER;\n    case schema::Type::ANY_POINTER: KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\"); break;\n  }\n\n  // Unknown type.  Treat it as zero-size.\n  return ElementSize::VOID;\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nElementSize elementSizeFor(schema::Type::Which elementType) {\n  switch (elementType) {\n    case schema::Type::VOID: return ElementSize::VOID;\n    case schema::Type::BOOL: return ElementSize::BIT;\n    case schema::Type::INT8: return ElementSize::BYTE;\n    case schema::Type::INT16: return ElementSize::TWO_BYTES;\n    case schema::Type::INT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::INT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::UINT8: return ElementSize::BYTE;\n    case schema::Type::UINT16: return ElementSize::TWO_BYTES;\n    case schema::Type::UINT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::UINT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::FLOAT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::FLOAT64: return ElementSize::EIGHT_BYTES;\n\n    case schema::Type::TEXT: return ElementSize::POINTER;\n    case schema::Type::DATA: return ElementSize::POINTER;\n    case schema::Type::LIST: return ElementSize::POINTER;\n    case schema::Type::ENUM: return ElementSize::TWO_BYTES;\n    case schema::Type::STRUCT: return ElementSize::INLINE_COMPOSITE;\n    case schema::Type::INTERFACE: return ElementSize::POINTER;\n    case schema::Type::ANY_POINTER: KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\"); break;\n  }\n\n  // Unknown type.  Treat it as zero-size.\n  return ElementSize::VOID;\n}"
        }
      },
      {
        "call_info": {
          "callee": "schema.whichElementType",
          "args": [],
          "line": 1829
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getStructList",
          "args": [
            "structSizeFromSchema(schema.getStructElementType())",
            "nullptr"
          ],
          "line": 1824
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structSizeFromSchema",
          "args": [
            "schema.getStructElementType()"
          ],
          "line": 1825
        },
        "resolved": true,
        "details": {
          "function_name": "structSizeFromSchema",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "98-103",
          "snippet": "inline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\ninline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}"
        }
      },
      {
        "call_info": {
          "callee": "schema.getStructElementType",
          "args": [],
          "line": 1825
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.whichElementType",
          "args": [],
          "line": 1822
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicList::Builder PointerHelpers<DynamicList, Kind::OTHER>::getDynamic(\n    PointerBuilder builder, ListSchema schema) {\n  if (schema.whichElementType() == schema::Type::STRUCT) {\n    return DynamicList::Builder(schema,\n        builder.getStructList(\n            structSizeFromSchema(schema.getStructElementType()),\n            nullptr));\n  } else {\n    return DynamicList::Builder(schema,\n        builder.getList(elementSizeFor(schema.whichElementType()), nullptr));\n  }\n}"
  },
  {
    "function_name": "PointerHelpers<DynamicList, Kind::OTHER>::getDynamic",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1815-1819",
    "snippet": "DynamicList::Reader PointerHelpers<DynamicList, Kind::OTHER>::getDynamic(\n    PointerReader reader, ListSchema schema) {\n  return DynamicList::Reader(schema,\n      reader.getList(elementSizeFor(schema.whichElementType()), nullptr));\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DynamicList::Reader",
          "args": [
            "schema",
            "reader.getList(elementSizeFor(schema.whichElementType()), nullptr)"
          ],
          "line": 1817
        },
        "resolved": true,
        "details": {
          "function_name": "Reader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "377-377",
          "snippet": "Reader(ListSchema schema, _::ListReader reader): schema(schema), reader(reader) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nReader(ListSchema schema, _::ListReader reader): schema(schema), reader(reader) {}"
        }
      },
      {
        "call_info": {
          "callee": "reader.getList",
          "args": [
            "elementSizeFor(schema.whichElementType())",
            "nullptr"
          ],
          "line": 1818
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elementSizeFor",
          "args": [
            "schema.whichElementType()"
          ],
          "line": 1818
        },
        "resolved": true,
        "details": {
          "function_name": "elementSizeFor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "70-96",
          "snippet": "ElementSize elementSizeFor(schema::Type::Which elementType) {\n  switch (elementType) {\n    case schema::Type::VOID: return ElementSize::VOID;\n    case schema::Type::BOOL: return ElementSize::BIT;\n    case schema::Type::INT8: return ElementSize::BYTE;\n    case schema::Type::INT16: return ElementSize::TWO_BYTES;\n    case schema::Type::INT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::INT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::UINT8: return ElementSize::BYTE;\n    case schema::Type::UINT16: return ElementSize::TWO_BYTES;\n    case schema::Type::UINT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::UINT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::FLOAT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::FLOAT64: return ElementSize::EIGHT_BYTES;\n\n    case schema::Type::TEXT: return ElementSize::POINTER;\n    case schema::Type::DATA: return ElementSize::POINTER;\n    case schema::Type::LIST: return ElementSize::POINTER;\n    case schema::Type::ENUM: return ElementSize::TWO_BYTES;\n    case schema::Type::STRUCT: return ElementSize::INLINE_COMPOSITE;\n    case schema::Type::INTERFACE: return ElementSize::POINTER;\n    case schema::Type::ANY_POINTER: KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\"); break;\n  }\n\n  // Unknown type.  Treat it as zero-size.\n  return ElementSize::VOID;\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nElementSize elementSizeFor(schema::Type::Which elementType) {\n  switch (elementType) {\n    case schema::Type::VOID: return ElementSize::VOID;\n    case schema::Type::BOOL: return ElementSize::BIT;\n    case schema::Type::INT8: return ElementSize::BYTE;\n    case schema::Type::INT16: return ElementSize::TWO_BYTES;\n    case schema::Type::INT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::INT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::UINT8: return ElementSize::BYTE;\n    case schema::Type::UINT16: return ElementSize::TWO_BYTES;\n    case schema::Type::UINT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::UINT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::FLOAT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::FLOAT64: return ElementSize::EIGHT_BYTES;\n\n    case schema::Type::TEXT: return ElementSize::POINTER;\n    case schema::Type::DATA: return ElementSize::POINTER;\n    case schema::Type::LIST: return ElementSize::POINTER;\n    case schema::Type::ENUM: return ElementSize::TWO_BYTES;\n    case schema::Type::STRUCT: return ElementSize::INLINE_COMPOSITE;\n    case schema::Type::INTERFACE: return ElementSize::POINTER;\n    case schema::Type::ANY_POINTER: KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\"); break;\n  }\n\n  // Unknown type.  Treat it as zero-size.\n  return ElementSize::VOID;\n}"
        }
      },
      {
        "call_info": {
          "callee": "schema.whichElementType",
          "args": [],
          "line": 1818
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicList::Reader PointerHelpers<DynamicList, Kind::OTHER>::getDynamic(\n    PointerReader reader, ListSchema schema) {\n  return DynamicList::Reader(schema,\n      reader.getList(elementSizeFor(schema.whichElementType()), nullptr));\n}"
  },
  {
    "function_name": "PointerHelpers<DynamicStruct, Kind::OTHER>::init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1807-1813",
    "snippet": "DynamicStruct::Builder PointerHelpers<DynamicStruct, Kind::OTHER>::init(\n    PointerBuilder builder, StructSchema schema) {\n  KJ_REQUIRE(!schema.getProto().getStruct().getIsGroup(),\n             \"Cannot form pointer to group type.\");\n  return DynamicStruct::Builder(schema,\n      builder.initStruct(structSizeFromSchema(schema)));\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DynamicStruct::Builder",
          "args": [
            "schema",
            "builder.initStruct(structSizeFromSchema(schema))"
          ],
          "line": 1811
        },
        "resolved": true,
        "details": {
          "function_name": "Builder",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "427-427",
          "snippet": "Builder(ListSchema schema, _::ListBuilder builder): schema(schema), builder(builder) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nBuilder(ListSchema schema, _::ListBuilder builder): schema(schema), builder(builder) {}"
        }
      },
      {
        "call_info": {
          "callee": "builder.initStruct",
          "args": [
            "structSizeFromSchema(schema)"
          ],
          "line": 1812
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structSizeFromSchema",
          "args": [
            "schema"
          ],
          "line": 1812
        },
        "resolved": true,
        "details": {
          "function_name": "structSizeFromSchema",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "98-103",
          "snippet": "inline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\ninline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}"
        }
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "!schema.getProto().getStruct().getIsGroup()",
            "\"Cannot form pointer to group type.\""
          ],
          "line": 1809
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getProto",
          "args": [],
          "line": 1809
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicStruct::Builder PointerHelpers<DynamicStruct, Kind::OTHER>::init(\n    PointerBuilder builder, StructSchema schema) {\n  KJ_REQUIRE(!schema.getProto().getStruct().getIsGroup(),\n             \"Cannot form pointer to group type.\");\n  return DynamicStruct::Builder(schema,\n      builder.initStruct(structSizeFromSchema(schema)));\n}"
  },
  {
    "function_name": "PointerHelpers<DynamicStruct, Kind::OTHER>::set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1801-1806",
    "snippet": "void PointerHelpers<DynamicStruct, Kind::OTHER>::set(\n    PointerBuilder builder, const DynamicStruct::Reader& value) {\n  KJ_REQUIRE(!value.schema.getProto().getStruct().getIsGroup(),\n             \"Cannot form pointer to group type.\");\n  builder.setStruct(value.reader);\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "builder.setStruct",
          "args": [
            "value.reader"
          ],
          "line": 1805
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "!value.schema.getProto().getStruct().getIsGroup()",
            "\"Cannot form pointer to group type.\""
          ],
          "line": 1803
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.schema.getProto",
          "args": [],
          "line": 1803
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nvoid PointerHelpers<DynamicStruct, Kind::OTHER>::set(\n    PointerBuilder builder, const DynamicStruct::Reader& value) {\n  KJ_REQUIRE(!value.schema.getProto().getStruct().getIsGroup(),\n             \"Cannot form pointer to group type.\");\n  builder.setStruct(value.reader);\n}"
  },
  {
    "function_name": "PointerHelpers<DynamicStruct, Kind::OTHER>::getDynamic",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1794-1800",
    "snippet": "DynamicStruct::Builder PointerHelpers<DynamicStruct, Kind::OTHER>::getDynamic(\n    PointerBuilder builder, StructSchema schema) {\n  KJ_REQUIRE(!schema.getProto().getStruct().getIsGroup(),\n             \"Cannot form pointer to group type.\");\n  return DynamicStruct::Builder(schema, builder.getStruct(\n      structSizeFromSchema(schema), nullptr));\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DynamicStruct::Builder",
          "args": [
            "schema",
            "builder.getStruct(\n      structSizeFromSchema(schema), nullptr)"
          ],
          "line": 1798
        },
        "resolved": true,
        "details": {
          "function_name": "Builder",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "427-427",
          "snippet": "Builder(ListSchema schema, _::ListBuilder builder): schema(schema), builder(builder) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nBuilder(ListSchema schema, _::ListBuilder builder): schema(schema), builder(builder) {}"
        }
      },
      {
        "call_info": {
          "callee": "builder.getStruct",
          "args": [
            "structSizeFromSchema(schema)",
            "nullptr"
          ],
          "line": 1798
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structSizeFromSchema",
          "args": [
            "schema"
          ],
          "line": 1799
        },
        "resolved": true,
        "details": {
          "function_name": "structSizeFromSchema",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "98-103",
          "snippet": "inline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\ninline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}"
        }
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "!schema.getProto().getStruct().getIsGroup()",
            "\"Cannot form pointer to group type.\""
          ],
          "line": 1796
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getProto",
          "args": [],
          "line": 1796
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicStruct::Builder PointerHelpers<DynamicStruct, Kind::OTHER>::getDynamic(\n    PointerBuilder builder, StructSchema schema) {\n  KJ_REQUIRE(!schema.getProto().getStruct().getIsGroup(),\n             \"Cannot form pointer to group type.\");\n  return DynamicStruct::Builder(schema, builder.getStruct(\n      structSizeFromSchema(schema), nullptr));\n}"
  },
  {
    "function_name": "PointerHelpers<DynamicStruct, Kind::OTHER>::getDynamic",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1788-1793",
    "snippet": "DynamicStruct::Reader PointerHelpers<DynamicStruct, Kind::OTHER>::getDynamic(\n    PointerReader reader, StructSchema schema) {\n  KJ_REQUIRE(!schema.getProto().getStruct().getIsGroup(),\n             \"Cannot form pointer to group type.\");\n  return DynamicStruct::Reader(schema, reader.getStruct(nullptr));\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DynamicStruct::Reader",
          "args": [
            "schema",
            "reader.getStruct(nullptr)"
          ],
          "line": 1792
        },
        "resolved": true,
        "details": {
          "function_name": "Reader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "377-377",
          "snippet": "Reader(ListSchema schema, _::ListReader reader): schema(schema), reader(reader) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nReader(ListSchema schema, _::ListReader reader): schema(schema), reader(reader) {}"
        }
      },
      {
        "call_info": {
          "callee": "reader.getStruct",
          "args": [
            "nullptr"
          ],
          "line": 1792
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "!schema.getProto().getStruct().getIsGroup()",
            "\"Cannot form pointer to group type.\""
          ],
          "line": 1790
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getProto",
          "args": [],
          "line": 1790
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicStruct::Reader PointerHelpers<DynamicStruct, Kind::OTHER>::getDynamic(\n    PointerReader reader, StructSchema schema) {\n  KJ_REQUIRE(!schema.getProto().getStruct().getIsGroup(),\n             \"Cannot form pointer to group type.\");\n  return DynamicStruct::Reader(schema, reader.getStruct(nullptr));\n}"
  },
  {
    "function_name": "DynamicValue::Builder::AsImpl<Void>::apply",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1777-1782",
    "snippet": "Void DynamicValue::Builder::AsImpl<Void>::apply(Builder& builder) {\n  KJ_REQUIRE(builder.type == VOID, \"Value type mismatch.\") {\n    return Void();\n  }\n  return builder.voidValue;\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Void",
          "args": [],
          "line": 1779
        },
        "resolved": true,
        "details": {
          "function_name": "Value::Builder::getVoid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.capnp.h",
          "lines": "6722-6727",
          "snippet": "inline  ::capnp::Void Value::Builder::getVoid() {\n  KJ_IREQUIRE(which() == Value::VOID,\n              \"Must check which() before get()ing a union member.\");\n  return _builder.getDataField< ::capnp::Void>(\n      0 * ::capnp::ELEMENTS);\n}",
          "includes": [
            "#include <capnp/generated-header-support.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/generated-header-support.h>\n\ninline  ::capnp::Void Value::Builder::getVoid() {\n  KJ_IREQUIRE(which() == Value::VOID,\n              \"Must check which() before get()ing a union member.\");\n  return _builder.getDataField< ::capnp::Void>(\n      0 * ::capnp::ELEMENTS);\n}"
        }
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "builder.type == VOID",
            "\"Value type mismatch.\""
          ],
          "line": 1778
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nVoid DynamicValue::Builder::AsImpl<Void>::apply(Builder& builder) {\n  KJ_REQUIRE(builder.type == VOID, \"Value type mismatch.\") {\n    return Void();\n  }\n  return builder.voidValue;\n}"
  },
  {
    "function_name": "DynamicValue::Reader::AsImpl<Void>::apply",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1771-1776",
    "snippet": "Void DynamicValue::Reader::AsImpl<Void>::apply(const Reader& reader) {\n  KJ_REQUIRE(reader.type == VOID, \"Value type mismatch.\") {\n    return Void();\n  }\n  return reader.voidValue;\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Void",
          "args": [],
          "line": 1773
        },
        "resolved": true,
        "details": {
          "function_name": "Value::Builder::getVoid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.capnp.h",
          "lines": "6722-6727",
          "snippet": "inline  ::capnp::Void Value::Builder::getVoid() {\n  KJ_IREQUIRE(which() == Value::VOID,\n              \"Must check which() before get()ing a union member.\");\n  return _builder.getDataField< ::capnp::Void>(\n      0 * ::capnp::ELEMENTS);\n}",
          "includes": [
            "#include <capnp/generated-header-support.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/generated-header-support.h>\n\ninline  ::capnp::Void Value::Builder::getVoid() {\n  KJ_IREQUIRE(which() == Value::VOID,\n              \"Must check which() before get()ing a union member.\");\n  return _builder.getDataField< ::capnp::Void>(\n      0 * ::capnp::ELEMENTS);\n}"
        }
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "reader.type == VOID",
            "\"Value type mismatch.\""
          ],
          "line": 1772
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nVoid DynamicValue::Reader::AsImpl<Void>::apply(const Reader& reader) {\n  KJ_REQUIRE(reader.type == VOID, \"Value type mismatch.\") {\n    return Void();\n  }\n  return reader.voidValue;\n}"
  },
  {
    "function_name": "DynamicValue::Builder::AsImpl<Data>::apply",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1759-1768",
    "snippet": "Data::Builder DynamicValue::Builder::AsImpl<Data>::apply(Builder& builder) {\n  if (builder.type == TEXT) {\n    // Coerce text to data.\n    return builder.textValue.asBytes();\n  }\n  KJ_REQUIRE(builder.type == DATA, \"Value type mismatch.\") {\n    return BuilderFor<Data>();\n  }\n  return builder.dataValue;\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BuilderFor<Data>",
          "args": [],
          "line": 1765
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "builder.type == DATA",
            "\"Value type mismatch.\""
          ],
          "line": 1764
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.textValue.asBytes",
          "args": [],
          "line": 1762
        },
        "resolved": true,
        "details": {
          "function_name": "asBytes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/blob.h",
          "lines": "128-128",
          "snippet": "inline kj::ArrayPtr<const byte> asBytes() const { return asArray().asBytes(); }",
          "includes": [
            "#include <string.h>",
            "#include \"common.h\"",
            "#include <kj/string.h>",
            "#include <kj/common.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"common.h\"\n#include <kj/string.h>\n#include <kj/common.h>\n\ninline kj::ArrayPtr<const byte> asBytes() const { return asArray().asBytes(); }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nData::Builder DynamicValue::Builder::AsImpl<Data>::apply(Builder& builder) {\n  if (builder.type == TEXT) {\n    // Coerce text to data.\n    return builder.textValue.asBytes();\n  }\n  KJ_REQUIRE(builder.type == DATA, \"Value type mismatch.\") {\n    return BuilderFor<Data>();\n  }\n  return builder.dataValue;\n}"
  },
  {
    "function_name": "DynamicValue::Reader::AsImpl<Data>::apply",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1749-1758",
    "snippet": "Data::Reader DynamicValue::Reader::AsImpl<Data>::apply(const Reader& reader) {\n  if (reader.type == TEXT) {\n    // Coerce text to data.\n    return reader.textValue.asBytes();\n  }\n  KJ_REQUIRE(reader.type == DATA, \"Value type mismatch.\") {\n    return Data::Reader();\n  }\n  return reader.dataValue;\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Data::Reader",
          "args": [],
          "line": 1755
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "reader.type == DATA",
            "\"Value type mismatch.\""
          ],
          "line": 1754
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.textValue.asBytes",
          "args": [],
          "line": 1752
        },
        "resolved": true,
        "details": {
          "function_name": "asBytes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/blob.h",
          "lines": "128-128",
          "snippet": "inline kj::ArrayPtr<const byte> asBytes() const { return asArray().asBytes(); }",
          "includes": [
            "#include <string.h>",
            "#include \"common.h\"",
            "#include <kj/string.h>",
            "#include <kj/common.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"common.h\"\n#include <kj/string.h>\n#include <kj/common.h>\n\ninline kj::ArrayPtr<const byte> asBytes() const { return asArray().asBytes(); }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nData::Reader DynamicValue::Reader::AsImpl<Data>::apply(const Reader& reader) {\n  if (reader.type == TEXT) {\n    // Coerce text to data.\n    return reader.textValue.asBytes();\n  }\n  KJ_REQUIRE(reader.type == DATA, \"Value type mismatch.\") {\n    return Data::Reader();\n  }\n  return reader.dataValue;\n}"
  },
  {
    "function_name": "DynamicValue::Pipeline::AsImpl<DynamicCapability>::apply",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1741-1747",
    "snippet": "PipelineFor<DynamicCapability> DynamicValue::Pipeline::AsImpl<DynamicCapability>::apply(\n    Pipeline& pipeline) {\n  KJ_REQUIRE(pipeline.type == CAPABILITY, \"Pipeline type mismatch.\") {\n    return DynamicCapability::Client();\n  }\n  return kj::mv(pipeline.capabilityValue);\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "pipeline.capabilityValue"
          ],
          "line": 1746
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DynamicCapability::Client",
          "args": [],
          "line": 1744
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "pipeline.type == CAPABILITY",
            "\"Pipeline type mismatch.\""
          ],
          "line": 1743
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nPipelineFor<DynamicCapability> DynamicValue::Pipeline::AsImpl<DynamicCapability>::apply(\n    Pipeline& pipeline) {\n  KJ_REQUIRE(pipeline.type == CAPABILITY, \"Pipeline type mismatch.\") {\n    return DynamicCapability::Client();\n  }\n  return kj::mv(pipeline.capabilityValue);\n}"
  },
  {
    "function_name": "DynamicValue::Builder::AsImpl<DynamicCapability>::apply",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1734-1740",
    "snippet": "BuilderFor<DynamicCapability> DynamicValue::Builder::AsImpl<DynamicCapability>::apply(\n    Builder& builder) {\n  KJ_REQUIRE(builder.type == CAPABILITY, \"Value type mismatch.\") {\n    return DynamicCapability::Client();\n  }\n  return builder.capabilityValue;\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DynamicCapability::Client",
          "args": [],
          "line": 1737
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "builder.type == CAPABILITY",
            "\"Value type mismatch.\""
          ],
          "line": 1736
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nBuilderFor<DynamicCapability> DynamicValue::Builder::AsImpl<DynamicCapability>::apply(\n    Builder& builder) {\n  KJ_REQUIRE(builder.type == CAPABILITY, \"Value type mismatch.\") {\n    return DynamicCapability::Client();\n  }\n  return builder.capabilityValue;\n}"
  },
  {
    "function_name": "DynamicValue::Reader::AsImpl<DynamicCapability>::apply",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1727-1733",
    "snippet": "ReaderFor<DynamicCapability> DynamicValue::Reader::AsImpl<DynamicCapability>::apply(\n    const Reader& reader) {\n  KJ_REQUIRE(reader.type == CAPABILITY, \"Value type mismatch.\") {\n    return DynamicCapability::Client();\n  }\n  return reader.capabilityValue;\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DynamicCapability::Client",
          "args": [],
          "line": 1730
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "reader.type == CAPABILITY",
            "\"Value type mismatch.\""
          ],
          "line": 1729
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nReaderFor<DynamicCapability> DynamicValue::Reader::AsImpl<DynamicCapability>::apply(\n    const Reader& reader) {\n  KJ_REQUIRE(reader.type == CAPABILITY, \"Value type mismatch.\") {\n    return DynamicCapability::Client();\n  }\n  return reader.capabilityValue;\n}"
  },
  {
    "function_name": "DynamicValue::Pipeline::AsImpl<DynamicStruct>::apply",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1721-1725",
    "snippet": "PipelineFor<DynamicStruct> DynamicValue::Pipeline::AsImpl<DynamicStruct>::apply(\n    Pipeline& pipeline) {\n  KJ_REQUIRE(pipeline.type == STRUCT, \"Pipeline type mismatch.\");\n  return kj::mv(pipeline.structValue);\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "pipeline.structValue"
          ],
          "line": 1724
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "pipeline.type == STRUCT",
            "\"Pipeline type mismatch.\""
          ],
          "line": 1723
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nPipelineFor<DynamicStruct> DynamicValue::Pipeline::AsImpl<DynamicStruct>::apply(\n    Pipeline& pipeline) {\n  KJ_REQUIRE(pipeline.type == STRUCT, \"Pipeline type mismatch.\");\n  return kj::mv(pipeline.structValue);\n}"
  },
  {
    "function_name": "checkRoundTrip",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1645-1651",
    "snippet": "T checkRoundTrip(U value) {\n  KJ_REQUIRE(T(value) == value, \"Value out-of-range for requested type.\", value) {\n    // Use it anyway.\n    break;\n  }\n  return value;\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "T(value) == value",
            "\"Value out-of-range for requested type.\"",
            "value"
          ],
          "line": 1646
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "T",
          "args": [
            "value"
          ],
          "line": 1646
        },
        "resolved": true,
        "details": {
          "function_name": "initCapTable",
          "container": "ReaderArena",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/arena.h",
          "lines": "217-222",
          "snippet": "inline void initCapTable(kj::Array<kj::Maybe<kj::Own<ClientHook>>> capTable) {\n    // Imbues the arena with a capability table.  This is not passed to the constructor because the\n    // table itself may be built based on some other part of the message (as is the case with the\n    // RPC protocol).\n    this->capTable = kj::mv(capTable);\n  }",
          "includes": [
            "#include \"capability.h\"",
            "#include <unordered_map>",
            "#include \"layout.h\"",
            "#include \"message.h\"",
            "#include \"common.h\"",
            "#include <kj/vector.h>",
            "#include <kj/exception.h>",
            "#include <kj/mutex.h>",
            "#include <kj/common.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include <unordered_map>\n#include \"layout.h\"\n#include \"message.h\"\n#include \"common.h\"\n#include <kj/vector.h>\n#include <kj/exception.h>\n#include <kj/mutex.h>\n#include <kj/common.h>\n\nReaderArena {\n  inline void initCapTable(kj::Array<kj::Maybe<kj::Own<ClientHook>>> capTable) {\n      // Imbues the arena with a capability table.  This is not passed to the constructor because the\n      // table itself may be built based on some other part of the message (as is the case with the\n      // RPC protocol).\n      this->capTable = kj::mv(capTable);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nT checkRoundTrip(U value) {\n  KJ_REQUIRE(T(value) == value, \"Value out-of-range for requested type.\", value) {\n    // Use it anyway.\n    break;\n  }\n  return value;\n}"
  },
  {
    "function_name": "unsignedToSigned",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1626-1633",
    "snippet": "T unsignedToSigned(unsigned long long value) {\n  KJ_REQUIRE(T(value) >= 0 && (unsigned long long)T(value) == value,\n             \"Value out-of-range for requested type.\", value) {\n    // Use it anyway.\n    break;\n  }\n  return value;\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "T(value) >= 0 && (unsigned long long)T(value) == value",
            "\"Value out-of-range for requested type.\"",
            "value"
          ],
          "line": 1627
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "T",
          "args": [
            "value"
          ],
          "line": 1627
        },
        "resolved": true,
        "details": {
          "function_name": "initCapTable",
          "container": "ReaderArena",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/arena.h",
          "lines": "217-222",
          "snippet": "inline void initCapTable(kj::Array<kj::Maybe<kj::Own<ClientHook>>> capTable) {\n    // Imbues the arena with a capability table.  This is not passed to the constructor because the\n    // table itself may be built based on some other part of the message (as is the case with the\n    // RPC protocol).\n    this->capTable = kj::mv(capTable);\n  }",
          "includes": [
            "#include \"capability.h\"",
            "#include <unordered_map>",
            "#include \"layout.h\"",
            "#include \"message.h\"",
            "#include \"common.h\"",
            "#include <kj/vector.h>",
            "#include <kj/exception.h>",
            "#include <kj/mutex.h>",
            "#include <kj/common.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include <unordered_map>\n#include \"layout.h\"\n#include \"message.h\"\n#include \"common.h\"\n#include <kj/vector.h>\n#include <kj/exception.h>\n#include <kj/mutex.h>\n#include <kj/common.h>\n\nReaderArena {\n  inline void initCapTable(kj::Array<kj::Maybe<kj::Own<ClientHook>>> capTable) {\n      // Imbues the arena with a capability table.  This is not passed to the constructor because the\n      // table itself may be built based on some other part of the message (as is the case with the\n      // RPC protocol).\n      this->capTable = kj::mv(capTable);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nT unsignedToSigned(unsigned long long value) {\n  KJ_REQUIRE(T(value) >= 0 && (unsigned long long)T(value) == value,\n             \"Value out-of-range for requested type.\", value) {\n    // Use it anyway.\n    break;\n  }\n  return value;\n}"
  },
  {
    "function_name": "signedToUnsigned",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1608-1614",
    "snippet": "T signedToUnsigned(long long value) {\n  KJ_REQUIRE(value >= 0 && T(value) == value, \"Value out-of-range for requested type.\", value) {\n    // Use it anyway.\n    break;\n  }\n  return value;\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "value >= 0 && T(value) == value",
            "\"Value out-of-range for requested type.\"",
            "value"
          ],
          "line": 1609
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "T",
          "args": [
            "value"
          ],
          "line": 1609
        },
        "resolved": true,
        "details": {
          "function_name": "initCapTable",
          "container": "ReaderArena",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/arena.h",
          "lines": "217-222",
          "snippet": "inline void initCapTable(kj::Array<kj::Maybe<kj::Own<ClientHook>>> capTable) {\n    // Imbues the arena with a capability table.  This is not passed to the constructor because the\n    // table itself may be built based on some other part of the message (as is the case with the\n    // RPC protocol).\n    this->capTable = kj::mv(capTable);\n  }",
          "includes": [
            "#include \"capability.h\"",
            "#include <unordered_map>",
            "#include \"layout.h\"",
            "#include \"message.h\"",
            "#include \"common.h\"",
            "#include <kj/vector.h>",
            "#include <kj/exception.h>",
            "#include <kj/mutex.h>",
            "#include <kj/common.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include <unordered_map>\n#include \"layout.h\"\n#include \"message.h\"\n#include \"common.h\"\n#include <kj/vector.h>\n#include <kj/exception.h>\n#include <kj/mutex.h>\n#include <kj/common.h>\n\nReaderArena {\n  inline void initCapTable(kj::Array<kj::Maybe<kj::Own<ClientHook>>> capTable) {\n      // Imbues the arena with a capability table.  This is not passed to the constructor because the\n      // table itself may be built based on some other part of the message (as is the case with the\n      // RPC protocol).\n      this->capTable = kj::mv(capTable);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nT signedToUnsigned(long long value) {\n  KJ_REQUIRE(value >= 0 && T(value) == value, \"Value out-of-range for requested type.\", value) {\n    // Use it anyway.\n    break;\n  }\n  return value;\n}"
  },
  {
    "function_name": "DynamicValue::Pipeline::~Pipeline",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1594-1603",
    "snippet": "DynamicValue::Pipeline::~Pipeline() noexcept(false) {\n  switch (type) {\n    case UNKNOWN: break;\n    case STRUCT: kj::dtor(structValue); break;\n    case CAPABILITY: kj::dtor(capabilityValue); break;\n    default:\n      KJ_FAIL_ASSERT(\"Unexpected pipeline type.\", (uint)type) { type = UNKNOWN; break; }\n      break;\n  }\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "KJ_FAIL_ASSERT",
          "args": [
            "\"Unexpected pipeline type.\"",
            "(uint)type"
          ],
          "line": 1600
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::dtor",
          "args": [
            "capabilityValue"
          ],
          "line": 1598
        },
        "resolved": true,
        "details": {
          "function_name": "dtor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "738-740",
          "snippet": "inline void dtor(T& location) {\n  location.~T();\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\ninline void dtor(T& location) {\n  location.~T();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicValue::Pipeline::~Pipeline() noexcept(false) {\n  switch (type) {\n    case UNKNOWN: break;\n    case STRUCT: kj::dtor(structValue); break;\n    case CAPABILITY: kj::dtor(capabilityValue); break;\n    default:\n      KJ_FAIL_ASSERT(\"Unexpected pipeline type.\", (uint)type) { type = UNKNOWN; break; }\n      break;\n  }\n}"
  },
  {
    "function_name": "DynamicValue::Pipeline::Pipeline",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1578-1588",
    "snippet": "DynamicValue::Pipeline::Pipeline(Pipeline&& other) noexcept: type(other.type) {\n  switch (type) {\n    case UNKNOWN: break;\n    case STRUCT: kj::ctor(structValue, kj::mv(other.structValue)); break;\n    case CAPABILITY: kj::ctor(capabilityValue, kj::mv(other.capabilityValue)); break;\n    default:\n      KJ_LOG(ERROR, \"Unexpected pipeline type.\", (uint)type);\n      type = UNKNOWN;\n      break;\n  }\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "KJ_LOG",
          "args": [
            "ERROR",
            "\"Unexpected pipeline type.\"",
            "(uint)type"
          ],
          "line": 1584
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::ctor",
          "args": [
            "capabilityValue",
            "kj::mv(other.capabilityValue)"
          ],
          "line": 1582
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "other.capabilityValue"
          ],
          "line": 1582
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::ctor",
          "args": [
            "structValue",
            "kj::mv(other.structValue)"
          ],
          "line": 1581
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "other.structValue"
          ],
          "line": 1581
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicValue::Pipeline::Pipeline(Pipeline&& other) noexcept: type(other.type) {\n  switch (type) {\n    case UNKNOWN: break;\n    case STRUCT: kj::ctor(structValue, kj::mv(other.structValue)); break;\n    case CAPABILITY: kj::ctor(capabilityValue, kj::mv(other.capabilityValue)); break;\n    default:\n      KJ_LOG(ERROR, \"Unexpected pipeline type.\", (uint)type);\n      type = UNKNOWN;\n      break;\n  }\n}"
  },
  {
    "function_name": "DynamicValue::Builder::asReader",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1558-1576",
    "snippet": "DynamicValue::Reader DynamicValue::Builder::asReader() const {\n  switch (type) {\n    case UNKNOWN: return Reader();\n    case VOID: return Reader(voidValue);\n    case BOOL: return Reader(boolValue);\n    case INT: return Reader(intValue);\n    case UINT: return Reader(uintValue);\n    case FLOAT: return Reader(floatValue);\n    case TEXT: return Reader(textValue.asReader());\n    case DATA: return Reader(dataValue.asReader());\n    case LIST: return Reader(listValue.asReader());\n    case ENUM: return Reader(enumValue);\n    case STRUCT: return Reader(structValue.asReader());\n    case CAPABILITY: return Reader(capabilityValue);\n    case ANY_POINTER: return Reader(anyPointerValue.asReader());\n  }\n  KJ_FAIL_ASSERT(\"Missing switch case.\");\n  return Reader();\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Reader",
          "args": [],
          "line": 1575
        },
        "resolved": true,
        "details": {
          "function_name": "Orphan<DynamicValue>::getReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "2036-2061",
          "snippet": "DynamicValue::Reader Orphan<DynamicValue>::getReader() const {\n  switch (type) {\n    case DynamicValue::UNKNOWN: return nullptr;\n    case DynamicValue::VOID: return voidValue;\n    case DynamicValue::BOOL: return boolValue;\n    case DynamicValue::INT: return intValue;\n    case DynamicValue::UINT: return uintValue;\n    case DynamicValue::FLOAT: return floatValue;\n    case DynamicValue::ENUM: return enumValue;\n\n    case DynamicValue::TEXT: return builder.asTextReader();\n    case DynamicValue::DATA: return builder.asDataReader();\n    case DynamicValue::LIST:\n      return DynamicList::Reader(listSchema,\n          builder.asListReader(elementSizeFor(listSchema.whichElementType())));\n    case DynamicValue::STRUCT:\n      return DynamicStruct::Reader(structSchema,\n          builder.asStructReader(structSizeFromSchema(structSchema)));\n    case DynamicValue::CAPABILITY:\n      return DynamicCapability::Client(interfaceSchema, builder.asCapability());\n    case DynamicValue::ANY_POINTER:\n      KJ_FAIL_ASSERT(\"Can't get() an AnyPointer orphan; there is no underlying pointer to \"\n                     \"wrap in an AnyPointer::Builder.\");\n  }\n  KJ_UNREACHABLE;\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicValue::Reader Orphan<DynamicValue>::getReader() const {\n  switch (type) {\n    case DynamicValue::UNKNOWN: return nullptr;\n    case DynamicValue::VOID: return voidValue;\n    case DynamicValue::BOOL: return boolValue;\n    case DynamicValue::INT: return intValue;\n    case DynamicValue::UINT: return uintValue;\n    case DynamicValue::FLOAT: return floatValue;\n    case DynamicValue::ENUM: return enumValue;\n\n    case DynamicValue::TEXT: return builder.asTextReader();\n    case DynamicValue::DATA: return builder.asDataReader();\n    case DynamicValue::LIST:\n      return DynamicList::Reader(listSchema,\n          builder.asListReader(elementSizeFor(listSchema.whichElementType())));\n    case DynamicValue::STRUCT:\n      return DynamicStruct::Reader(structSchema,\n          builder.asStructReader(structSizeFromSchema(structSchema)));\n    case DynamicValue::CAPABILITY:\n      return DynamicCapability::Client(interfaceSchema, builder.asCapability());\n    case DynamicValue::ANY_POINTER:\n      KJ_FAIL_ASSERT(\"Can't get() an AnyPointer orphan; there is no underlying pointer to \"\n                     \"wrap in an AnyPointer::Builder.\");\n  }\n  KJ_UNREACHABLE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "KJ_FAIL_ASSERT",
          "args": [
            "\"Missing switch case.\""
          ],
          "line": 1574
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Reader",
          "args": [
            "anyPointerValue.asReader()"
          ],
          "line": 1572
        },
        "resolved": true,
        "details": {
          "function_name": "DynamicValue::Reader::Reader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "1417-1447",
          "snippet": "DynamicValue::Reader::Reader(Reader&& other) noexcept {\n  switch (other.type) {\n    case UNKNOWN:\n    case VOID:\n    case BOOL:\n    case INT:\n    case UINT:\n    case FLOAT:\n    case TEXT:\n    case DATA:\n    case LIST:\n    case ENUM:\n    case STRUCT:\n    case ANY_POINTER:\n      static_assert(kj::canMemcpy<Text::Reader>() &&\n                    kj::canMemcpy<Data::Reader>() &&\n                    kj::canMemcpy<DynamicList::Reader>() &&\n                    kj::canMemcpy<DynamicEnum>() &&\n                    kj::canMemcpy<DynamicStruct::Reader>() &&\n                    kj::canMemcpy<AnyPointer::Reader>(),\n                    \"Assumptions here don't hold.\");\n      break;\n\n    case CAPABILITY:\n      type = CAPABILITY;\n      kj::ctor(capabilityValue, kj::mv(other.capabilityValue));\n      return;\n  }\n\n  memcpy(this, &other, sizeof(*this));\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicValue::Reader::Reader(Reader&& other) noexcept {\n  switch (other.type) {\n    case UNKNOWN:\n    case VOID:\n    case BOOL:\n    case INT:\n    case UINT:\n    case FLOAT:\n    case TEXT:\n    case DATA:\n    case LIST:\n    case ENUM:\n    case STRUCT:\n    case ANY_POINTER:\n      static_assert(kj::canMemcpy<Text::Reader>() &&\n                    kj::canMemcpy<Data::Reader>() &&\n                    kj::canMemcpy<DynamicList::Reader>() &&\n                    kj::canMemcpy<DynamicEnum>() &&\n                    kj::canMemcpy<DynamicStruct::Reader>() &&\n                    kj::canMemcpy<AnyPointer::Reader>(),\n                    \"Assumptions here don't hold.\");\n      break;\n\n    case CAPABILITY:\n      type = CAPABILITY;\n      kj::ctor(capabilityValue, kj::mv(other.capabilityValue));\n      return;\n  }\n\n  memcpy(this, &other, sizeof(*this));\n}"
        }
      },
      {
        "call_info": {
          "callee": "anyPointerValue.asReader",
          "args": [],
          "line": 1572
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicValue::Reader DynamicValue::Builder::asReader() const {\n  switch (type) {\n    case UNKNOWN: return Reader();\n    case VOID: return Reader(voidValue);\n    case BOOL: return Reader(boolValue);\n    case INT: return Reader(intValue);\n    case UINT: return Reader(uintValue);\n    case FLOAT: return Reader(floatValue);\n    case TEXT: return Reader(textValue.asReader());\n    case DATA: return Reader(dataValue.asReader());\n    case LIST: return Reader(listValue.asReader());\n    case ENUM: return Reader(enumValue);\n    case STRUCT: return Reader(structValue.asReader());\n    case CAPABILITY: return Reader(capabilityValue);\n    case ANY_POINTER: return Reader(anyPointerValue.asReader());\n  }\n  KJ_FAIL_ASSERT(\"Missing switch case.\");\n  return Reader();\n}"
  },
  {
    "function_name": "DynamicValue::Builder::~Builder",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1537-1541",
    "snippet": "DynamicValue::Builder::~Builder() noexcept(false) {\n  if (type == CAPABILITY) {\n    kj::dtor(capabilityValue);\n  }\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::dtor",
          "args": [
            "capabilityValue"
          ],
          "line": 1539
        },
        "resolved": true,
        "details": {
          "function_name": "dtor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "738-740",
          "snippet": "inline void dtor(T& location) {\n  location.~T();\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\ninline void dtor(T& location) {\n  location.~T();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicValue::Builder::~Builder() noexcept(false) {\n  if (type == CAPABILITY) {\n    kj::dtor(capabilityValue);\n  }\n}"
  },
  {
    "function_name": "DynamicValue::Builder::Builder",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1503-1536",
    "snippet": "DynamicValue::Builder::Builder(Builder&& other) noexcept {\n  switch (other.type) {\n    case UNKNOWN:\n    case VOID:\n    case BOOL:\n    case INT:\n    case UINT:\n    case FLOAT:\n    case TEXT:\n    case DATA:\n    case LIST:\n    case ENUM:\n    case STRUCT:\n    case ANY_POINTER:\n      // Unfortunately __has_trivial_copy doesn't work on these types due to the use of\n      // DisallowConstCopy, but __has_trivial_destructor should detect if any of these types\n      // become non-trivial.\n      static_assert(__has_trivial_destructor(Text::Builder) &&\n                    __has_trivial_destructor(Data::Builder) &&\n                    __has_trivial_destructor(DynamicList::Builder) &&\n                    __has_trivial_destructor(DynamicEnum) &&\n                    __has_trivial_destructor(DynamicStruct::Builder) &&\n                    __has_trivial_destructor(AnyPointer::Builder),\n                    \"Assumptions here don't hold.\");\n      break;\n\n    case CAPABILITY:\n      type = CAPABILITY;\n      kj::ctor(capabilityValue, kj::mv(other.capabilityValue));\n      return;\n  }\n\n  memcpy(this, &other, sizeof(*this));\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "this",
            "&other",
            "sizeof(*this)"
          ],
          "line": 1535
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::ctor",
          "args": [
            "capabilityValue",
            "kj::mv(other.capabilityValue)"
          ],
          "line": 1531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "other.capabilityValue"
          ],
          "line": 1531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__has_trivial_destructor",
          "args": [
            "AnyPointer::Builder"
          ],
          "line": 1525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__has_trivial_destructor",
          "args": [
            "DynamicStruct::Builder"
          ],
          "line": 1524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__has_trivial_destructor",
          "args": [
            "DynamicEnum"
          ],
          "line": 1523
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__has_trivial_destructor",
          "args": [
            "DynamicList::Builder"
          ],
          "line": 1522
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__has_trivial_destructor",
          "args": [
            "Data::Builder"
          ],
          "line": 1521
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__has_trivial_destructor",
          "args": [
            "Text::Builder"
          ],
          "line": 1520
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicValue::Builder::Builder(Builder&& other) noexcept {\n  switch (other.type) {\n    case UNKNOWN:\n    case VOID:\n    case BOOL:\n    case INT:\n    case UINT:\n    case FLOAT:\n    case TEXT:\n    case DATA:\n    case LIST:\n    case ENUM:\n    case STRUCT:\n    case ANY_POINTER:\n      // Unfortunately __has_trivial_copy doesn't work on these types due to the use of\n      // DisallowConstCopy, but __has_trivial_destructor should detect if any of these types\n      // become non-trivial.\n      static_assert(__has_trivial_destructor(Text::Builder) &&\n                    __has_trivial_destructor(Data::Builder) &&\n                    __has_trivial_destructor(DynamicList::Builder) &&\n                    __has_trivial_destructor(DynamicEnum) &&\n                    __has_trivial_destructor(DynamicStruct::Builder) &&\n                    __has_trivial_destructor(AnyPointer::Builder),\n                    \"Assumptions here don't hold.\");\n      break;\n\n    case CAPABILITY:\n      type = CAPABILITY;\n      kj::ctor(capabilityValue, kj::mv(other.capabilityValue));\n      return;\n  }\n\n  memcpy(this, &other, sizeof(*this));\n}"
  },
  {
    "function_name": "DynamicValue::Builder::Builder",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1469-1502",
    "snippet": "DynamicValue::Builder::Builder(Builder& other) {\n  switch (other.type) {\n    case UNKNOWN:\n    case VOID:\n    case BOOL:\n    case INT:\n    case UINT:\n    case FLOAT:\n    case TEXT:\n    case DATA:\n    case LIST:\n    case ENUM:\n    case STRUCT:\n    case ANY_POINTER:\n      // Unfortunately canMemcpy() doesn't work on these types due to the use of\n      // DisallowConstCopy, but __has_trivial_destructor should detect if any of these types\n      // become non-trivial.\n      static_assert(__has_trivial_destructor(Text::Builder) &&\n                    __has_trivial_destructor(Data::Builder) &&\n                    __has_trivial_destructor(DynamicList::Builder) &&\n                    __has_trivial_destructor(DynamicEnum) &&\n                    __has_trivial_destructor(DynamicStruct::Builder) &&\n                    __has_trivial_destructor(AnyPointer::Builder),\n                    \"Assumptions here don't hold.\");\n      break;\n\n    case CAPABILITY:\n      type = CAPABILITY;\n      kj::ctor(capabilityValue, other.capabilityValue);\n      return;\n  }\n\n  memcpy(this, &other, sizeof(*this));\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "this",
            "&other",
            "sizeof(*this)"
          ],
          "line": 1501
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::ctor",
          "args": [
            "capabilityValue",
            "other.capabilityValue"
          ],
          "line": 1497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__has_trivial_destructor",
          "args": [
            "AnyPointer::Builder"
          ],
          "line": 1491
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__has_trivial_destructor",
          "args": [
            "DynamicStruct::Builder"
          ],
          "line": 1490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__has_trivial_destructor",
          "args": [
            "DynamicEnum"
          ],
          "line": 1489
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__has_trivial_destructor",
          "args": [
            "DynamicList::Builder"
          ],
          "line": 1488
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__has_trivial_destructor",
          "args": [
            "Data::Builder"
          ],
          "line": 1487
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__has_trivial_destructor",
          "args": [
            "Text::Builder"
          ],
          "line": 1486
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicValue::Builder::Builder(Builder& other) {\n  switch (other.type) {\n    case UNKNOWN:\n    case VOID:\n    case BOOL:\n    case INT:\n    case UINT:\n    case FLOAT:\n    case TEXT:\n    case DATA:\n    case LIST:\n    case ENUM:\n    case STRUCT:\n    case ANY_POINTER:\n      // Unfortunately canMemcpy() doesn't work on these types due to the use of\n      // DisallowConstCopy, but __has_trivial_destructor should detect if any of these types\n      // become non-trivial.\n      static_assert(__has_trivial_destructor(Text::Builder) &&\n                    __has_trivial_destructor(Data::Builder) &&\n                    __has_trivial_destructor(DynamicList::Builder) &&\n                    __has_trivial_destructor(DynamicEnum) &&\n                    __has_trivial_destructor(DynamicStruct::Builder) &&\n                    __has_trivial_destructor(AnyPointer::Builder),\n                    \"Assumptions here don't hold.\");\n      break;\n\n    case CAPABILITY:\n      type = CAPABILITY;\n      kj::ctor(capabilityValue, other.capabilityValue);\n      return;\n  }\n\n  memcpy(this, &other, sizeof(*this));\n}"
  },
  {
    "function_name": "DynamicValue::Reader::~Reader",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1448-1452",
    "snippet": "DynamicValue::Reader::~Reader() noexcept(false) {\n  if (type == CAPABILITY) {\n    kj::dtor(capabilityValue);\n  }\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::dtor",
          "args": [
            "capabilityValue"
          ],
          "line": 1450
        },
        "resolved": true,
        "details": {
          "function_name": "dtor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "738-740",
          "snippet": "inline void dtor(T& location) {\n  location.~T();\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\ninline void dtor(T& location) {\n  location.~T();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicValue::Reader::~Reader() noexcept(false) {\n  if (type == CAPABILITY) {\n    kj::dtor(capabilityValue);\n  }\n}"
  },
  {
    "function_name": "DynamicValue::Reader::Reader",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1417-1447",
    "snippet": "DynamicValue::Reader::Reader(Reader&& other) noexcept {\n  switch (other.type) {\n    case UNKNOWN:\n    case VOID:\n    case BOOL:\n    case INT:\n    case UINT:\n    case FLOAT:\n    case TEXT:\n    case DATA:\n    case LIST:\n    case ENUM:\n    case STRUCT:\n    case ANY_POINTER:\n      static_assert(kj::canMemcpy<Text::Reader>() &&\n                    kj::canMemcpy<Data::Reader>() &&\n                    kj::canMemcpy<DynamicList::Reader>() &&\n                    kj::canMemcpy<DynamicEnum>() &&\n                    kj::canMemcpy<DynamicStruct::Reader>() &&\n                    kj::canMemcpy<AnyPointer::Reader>(),\n                    \"Assumptions here don't hold.\");\n      break;\n\n    case CAPABILITY:\n      type = CAPABILITY;\n      kj::ctor(capabilityValue, kj::mv(other.capabilityValue));\n      return;\n  }\n\n  memcpy(this, &other, sizeof(*this));\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "this",
            "&other",
            "sizeof(*this)"
          ],
          "line": 1446
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::ctor",
          "args": [
            "capabilityValue",
            "kj::mv(other.capabilityValue)"
          ],
          "line": 1442
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "other.capabilityValue"
          ],
          "line": 1442
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::canMemcpy<AnyPointer::Reader>",
          "args": [],
          "line": 1436
        },
        "resolved": true,
        "details": {
          "function_name": "canMemcpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "440-446",
          "snippet": "constexpr bool canMemcpy() {\n  // Returns true if T can be copied using memcpy instead of using the copy constructor or\n  // assignment operator.\n\n  // GCC defines these to mean what we want them to mean.\n  return __has_trivial_copy(T) && __has_trivial_assign(T);\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\nconstexpr bool canMemcpy() {\n  // Returns true if T can be copied using memcpy instead of using the copy constructor or\n  // assignment operator.\n\n  // GCC defines these to mean what we want them to mean.\n  return __has_trivial_copy(T) && __has_trivial_assign(T);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicValue::Reader::Reader(Reader&& other) noexcept {\n  switch (other.type) {\n    case UNKNOWN:\n    case VOID:\n    case BOOL:\n    case INT:\n    case UINT:\n    case FLOAT:\n    case TEXT:\n    case DATA:\n    case LIST:\n    case ENUM:\n    case STRUCT:\n    case ANY_POINTER:\n      static_assert(kj::canMemcpy<Text::Reader>() &&\n                    kj::canMemcpy<Data::Reader>() &&\n                    kj::canMemcpy<DynamicList::Reader>() &&\n                    kj::canMemcpy<DynamicEnum>() &&\n                    kj::canMemcpy<DynamicStruct::Reader>() &&\n                    kj::canMemcpy<AnyPointer::Reader>(),\n                    \"Assumptions here don't hold.\");\n      break;\n\n    case CAPABILITY:\n      type = CAPABILITY;\n      kj::ctor(capabilityValue, kj::mv(other.capabilityValue));\n      return;\n  }\n\n  memcpy(this, &other, sizeof(*this));\n}"
  },
  {
    "function_name": "DynamicValue::Reader::Reader",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1386-1416",
    "snippet": "DynamicValue::Reader::Reader(const Reader& other) {\n  switch (other.type) {\n    case UNKNOWN:\n    case VOID:\n    case BOOL:\n    case INT:\n    case UINT:\n    case FLOAT:\n    case TEXT:\n    case DATA:\n    case LIST:\n    case ENUM:\n    case STRUCT:\n    case ANY_POINTER:\n      static_assert(kj::canMemcpy<Text::Reader>() &&\n                    kj::canMemcpy<Data::Reader>() &&\n                    kj::canMemcpy<DynamicList::Reader>() &&\n                    kj::canMemcpy<DynamicEnum>() &&\n                    kj::canMemcpy<DynamicStruct::Reader>() &&\n                    kj::canMemcpy<AnyPointer::Reader>(),\n                    \"Assumptions here don't hold.\");\n      break;\n\n    case CAPABILITY:\n      type = CAPABILITY;\n      kj::ctor(capabilityValue, other.capabilityValue);\n      return;\n  }\n\n  memcpy(this, &other, sizeof(*this));\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "this",
            "&other",
            "sizeof(*this)"
          ],
          "line": 1415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::ctor",
          "args": [
            "capabilityValue",
            "other.capabilityValue"
          ],
          "line": 1411
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::canMemcpy<AnyPointer::Reader>",
          "args": [],
          "line": 1405
        },
        "resolved": true,
        "details": {
          "function_name": "canMemcpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "440-446",
          "snippet": "constexpr bool canMemcpy() {\n  // Returns true if T can be copied using memcpy instead of using the copy constructor or\n  // assignment operator.\n\n  // GCC defines these to mean what we want them to mean.\n  return __has_trivial_copy(T) && __has_trivial_assign(T);\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\nconstexpr bool canMemcpy() {\n  // Returns true if T can be copied using memcpy instead of using the copy constructor or\n  // assignment operator.\n\n  // GCC defines these to mean what we want them to mean.\n  return __has_trivial_copy(T) && __has_trivial_assign(T);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicValue::Reader::Reader(const Reader& other) {\n  switch (other.type) {\n    case UNKNOWN:\n    case VOID:\n    case BOOL:\n    case INT:\n    case UINT:\n    case FLOAT:\n    case TEXT:\n    case DATA:\n    case LIST:\n    case ENUM:\n    case STRUCT:\n    case ANY_POINTER:\n      static_assert(kj::canMemcpy<Text::Reader>() &&\n                    kj::canMemcpy<Data::Reader>() &&\n                    kj::canMemcpy<DynamicList::Reader>() &&\n                    kj::canMemcpy<DynamicEnum>() &&\n                    kj::canMemcpy<DynamicStruct::Reader>() &&\n                    kj::canMemcpy<AnyPointer::Reader>(),\n                    \"Assumptions here don't hold.\");\n      break;\n\n    case CAPABILITY:\n      type = CAPABILITY;\n      kj::ctor(capabilityValue, other.capabilityValue);\n      return;\n  }\n\n  memcpy(this, &other, sizeof(*this));\n}"
  },
  {
    "function_name": "DynamicValue::Reader::Reader",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1346-1384",
    "snippet": "DynamicValue::Reader::Reader(ConstSchema constant): type(VOID) {\n  auto type = constant.getType();\n  auto value = constant.getProto().getConst().getValue();\n  switch (type.which()) {\n    case schema::Type::VOID: *this = capnp::VOID; break;\n    case schema::Type::BOOL: *this = value.getBool(); break;\n    case schema::Type::INT8: *this = value.getInt8(); break;\n    case schema::Type::INT16: *this = value.getInt16(); break;\n    case schema::Type::INT32: *this = value.getInt32(); break;\n    case schema::Type::INT64: *this = value.getInt64(); break;\n    case schema::Type::UINT8: *this = value.getUint8(); break;\n    case schema::Type::UINT16: *this = value.getUint16(); break;\n    case schema::Type::UINT32: *this = value.getUint32(); break;\n    case schema::Type::UINT64: *this = value.getUint64(); break;\n    case schema::Type::FLOAT32: *this = value.getFloat32(); break;\n    case schema::Type::FLOAT64: *this = value.getFloat64(); break;\n    case schema::Type::TEXT: *this = value.getText(); break;\n    case schema::Type::DATA: *this = value.getData(); break;\n\n    case schema::Type::ENUM:\n      *this = DynamicEnum(type.asEnum(), value.getEnum());\n      break;\n\n    case schema::Type::STRUCT:\n      *this = value.getStruct().getAs<DynamicStruct>(type.asStruct());\n      break;\n\n    case schema::Type::LIST:\n      *this = value.getList().getAs<DynamicList>(type.asList());\n      break;\n\n    case schema::Type::ANY_POINTER:\n      *this = value.getAnyPointer();\n      break;\n\n    case schema::Type::INTERFACE:\n      KJ_FAIL_ASSERT(\"Constants can't have interface type.\");\n  }\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "KJ_FAIL_ASSERT",
          "args": [
            "\"Constants can't have interface type.\""
          ],
          "line": 1382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.getAnyPointer",
          "args": [],
          "line": 1378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.getList",
          "args": [
            "type.asList()"
          ],
          "line": 1374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.asList",
          "args": [],
          "line": 1374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.getList",
          "args": [],
          "line": 1374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.getStruct",
          "args": [
            "type.asStruct()"
          ],
          "line": 1370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.asStruct",
          "args": [],
          "line": 1370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.getStruct",
          "args": [],
          "line": 1370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DynamicEnum",
          "args": [
            "type.asEnum()",
            "value.getEnum()"
          ],
          "line": 1366
        },
        "resolved": true,
        "details": {
          "function_name": "DynamicEnum",
          "container": "DynamicEnum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "132-133",
          "snippet": "inline DynamicEnum(EnumSchema schema, uint16_t value)\n      : schema(schema), value(value) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nDynamicEnum {\n  inline DynamicEnum(EnumSchema schema, uint16_t value)\n        : schema(schema), value(value) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "value.getEnum",
          "args": [],
          "line": 1366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.asEnum",
          "args": [],
          "line": 1366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.getData",
          "args": [],
          "line": 1363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.getText",
          "args": [],
          "line": 1362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.getFloat64",
          "args": [],
          "line": 1361
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.getFloat32",
          "args": [],
          "line": 1360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.getUint64",
          "args": [],
          "line": 1359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.getUint32",
          "args": [],
          "line": 1358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.getUint16",
          "args": [],
          "line": 1357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.getUint8",
          "args": [],
          "line": 1356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.getInt64",
          "args": [],
          "line": 1355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.getInt32",
          "args": [],
          "line": 1354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.getInt16",
          "args": [],
          "line": 1353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.getInt8",
          "args": [],
          "line": 1352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.getBool",
          "args": [],
          "line": 1351
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.which",
          "args": [],
          "line": 1349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "constant.getProto",
          "args": [],
          "line": 1348
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      },
      {
        "call_info": {
          "callee": "constant.getType",
          "args": [],
          "line": 1347
        },
        "resolved": true,
        "details": {
          "function_name": "getType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "942-942",
          "snippet": "inline DynamicValue::Type getType() { return type; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline DynamicValue::Type getType() { return type; }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicValue::Reader::Reader(ConstSchema constant): type(VOID) {\n  auto type = constant.getType();\n  auto value = constant.getProto().getConst().getValue();\n  switch (type.which()) {\n    case schema::Type::VOID: *this = capnp::VOID; break;\n    case schema::Type::BOOL: *this = value.getBool(); break;\n    case schema::Type::INT8: *this = value.getInt8(); break;\n    case schema::Type::INT16: *this = value.getInt16(); break;\n    case schema::Type::INT32: *this = value.getInt32(); break;\n    case schema::Type::INT64: *this = value.getInt64(); break;\n    case schema::Type::UINT8: *this = value.getUint8(); break;\n    case schema::Type::UINT16: *this = value.getUint16(); break;\n    case schema::Type::UINT32: *this = value.getUint32(); break;\n    case schema::Type::UINT64: *this = value.getUint64(); break;\n    case schema::Type::FLOAT32: *this = value.getFloat32(); break;\n    case schema::Type::FLOAT64: *this = value.getFloat64(); break;\n    case schema::Type::TEXT: *this = value.getText(); break;\n    case schema::Type::DATA: *this = value.getData(); break;\n\n    case schema::Type::ENUM:\n      *this = DynamicEnum(type.asEnum(), value.getEnum());\n      break;\n\n    case schema::Type::STRUCT:\n      *this = value.getStruct().getAs<DynamicStruct>(type.asStruct());\n      break;\n\n    case schema::Type::LIST:\n      *this = value.getList().getAs<DynamicList>(type.asList());\n      break;\n\n    case schema::Type::ANY_POINTER:\n      *this = value.getAnyPointer();\n      break;\n\n    case schema::Type::INTERFACE:\n      KJ_FAIL_ASSERT(\"Constants can't have interface type.\");\n  }\n}"
  },
  {
    "function_name": "DynamicList::Builder::asReader",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1340-1342",
    "snippet": "DynamicList::Reader DynamicList::Builder::asReader() const {\n  return DynamicList::Reader(schema, builder.asReader());\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DynamicList::Reader",
          "args": [
            "schema",
            "builder.asReader()"
          ],
          "line": 1341
        },
        "resolved": true,
        "details": {
          "function_name": "Reader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "377-377",
          "snippet": "Reader(ListSchema schema, _::ListReader reader): schema(schema), reader(reader) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nReader(ListSchema schema, _::ListReader reader): schema(schema), reader(reader) {}"
        }
      },
      {
        "call_info": {
          "callee": "builder.asReader",
          "args": [],
          "line": 1341
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicList::Reader DynamicList::Builder::asReader() const {\n  return DynamicList::Reader(schema, builder.asReader());\n}"
  },
  {
    "function_name": "DynamicList::Builder::copyFrom",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1332-1338",
    "snippet": "void DynamicList::Builder::copyFrom(std::initializer_list<DynamicValue::Reader> value) {\n  KJ_REQUIRE(value.size() == size(), \"DynamicList::copyFrom() argument had different size.\");\n  uint i = 0;\n  for (auto element: value) {\n    set(i++, element);\n  }\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set",
          "args": [
            "i++",
            "element"
          ],
          "line": 1336
        },
        "resolved": true,
        "details": {
          "function_name": "PointerHelpers<DynamicCapability, Kind::OTHER>::set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "1860-1863",
          "snippet": "void PointerHelpers<DynamicCapability, Kind::OTHER>::set(\n    PointerBuilder builder, DynamicCapability::Client&& value) {\n  builder.setCapability(kj::mv(value.hook));\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nvoid PointerHelpers<DynamicCapability, Kind::OTHER>::set(\n    PointerBuilder builder, DynamicCapability::Client&& value) {\n  builder.setCapability(kj::mv(value.hook));\n}"
        }
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "value.size() == size()",
            "\"DynamicList::copyFrom() argument had different size.\""
          ],
          "line": 1333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "size",
          "args": [],
          "line": 1333
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "408-408",
          "snippet": "inline uint size() const { return builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline uint size() const { return builder.size() / ELEMENTS; }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nvoid DynamicList::Builder::copyFrom(std::initializer_list<DynamicValue::Reader> value) {\n  KJ_REQUIRE(value.size() == size(), \"DynamicList::copyFrom() argument had different size.\");\n  uint i = 0;\n  for (auto element: value) {\n    set(i++, element);\n  }\n}"
  },
  {
    "function_name": "DynamicList::Builder::disown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1279-1330",
    "snippet": "Orphan<DynamicValue> DynamicList::Builder::disown(uint index) {\n  switch (schema.whichElementType()) {\n    case schema::Type::VOID:\n    case schema::Type::BOOL:\n    case schema::Type::INT8:\n    case schema::Type::INT16:\n    case schema::Type::INT32:\n    case schema::Type::INT64:\n    case schema::Type::UINT8:\n    case schema::Type::UINT16:\n    case schema::Type::UINT32:\n    case schema::Type::UINT64:\n    case schema::Type::FLOAT32:\n    case schema::Type::FLOAT64:\n    case schema::Type::ENUM: {\n      auto result = Orphan<DynamicValue>(operator[](index), _::OrphanBuilder());\n      switch (elementSizeFor(schema.whichElementType())) {\n        case ElementSize::VOID: break;\n        case ElementSize::BIT: builder.setDataElement<bool>(index * ELEMENTS, false); break;\n        case ElementSize::BYTE: builder.setDataElement<uint8_t>(index * ELEMENTS, 0); break;\n        case ElementSize::TWO_BYTES: builder.setDataElement<uint16_t>(index * ELEMENTS, 0); break;\n        case ElementSize::FOUR_BYTES: builder.setDataElement<uint32_t>(index * ELEMENTS, 0); break;\n        case ElementSize::EIGHT_BYTES: builder.setDataElement<uint64_t>(index * ELEMENTS, 0);break;\n\n        case ElementSize::POINTER:\n        case ElementSize::INLINE_COMPOSITE:\n          KJ_UNREACHABLE;\n      }\n      return kj::mv(result);\n    }\n\n    case schema::Type::TEXT:\n    case schema::Type::DATA:\n    case schema::Type::LIST:\n    case schema::Type::ANY_POINTER:\n    case schema::Type::INTERFACE: {\n      auto value = operator[](index);\n      return Orphan<DynamicValue>(value, builder.getPointerElement(index * ELEMENTS).disown());\n    }\n\n    case schema::Type::STRUCT: {\n      // We have to make a copy.\n      Orphan<DynamicStruct> result =\n          Orphanage::getForMessageContaining(*this).newOrphan(schema.getStructElementType());\n      auto element = builder.getStructElement(index * ELEMENTS);\n      result.get().builder.transferContentFrom(element);\n      element.clearAll();\n      return kj::mv(result);\n    }\n  }\n  KJ_UNREACHABLE;\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "result"
          ],
          "line": 1326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "element.clearAll",
          "args": [],
          "line": 1325
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result.get",
          "args": [
            "element"
          ],
          "line": 1324
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "868-871",
          "snippet": "static inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }"
        }
      },
      {
        "call_info": {
          "callee": "result.get",
          "args": [],
          "line": 1324
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "builder.getStructElement",
          "args": [
            "index * ELEMENTS"
          ],
          "line": 1323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Orphanage::getForMessageContaining",
          "args": [
            "schema.getStructElementType()"
          ],
          "line": 1322
        },
        "resolved": true,
        "details": {
          "function_name": "Orphanage::getForMessageContaining",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan.h",
          "lines": "279-281",
          "snippet": "Orphanage Orphanage::getForMessageContaining(BuilderType builder) {\n  return Orphanage(GetInnerBuilder<FromBuilder<BuilderType>>::apply(builder).getArena());\n}",
          "includes": [
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"layout.h\"\n\nOrphanage Orphanage::getForMessageContaining(BuilderType builder) {\n  return Orphanage(GetInnerBuilder<FromBuilder<BuilderType>>::apply(builder).getArena());\n}"
        }
      },
      {
        "call_info": {
          "callee": "schema.getStructElementType",
          "args": [],
          "line": 1322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Orphan<DynamicValue>",
          "args": [
            "value",
            "builder.getPointerElement(index * ELEMENTS).disown()"
          ],
          "line": 1316
        },
        "resolved": true,
        "details": {
          "function_name": "Orphan<DynamicValue>::Orphan",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "1985-2003",
          "snippet": "Orphan<DynamicValue>::Orphan(DynamicValue::Builder value, _::OrphanBuilder&& builder)\n    : type(value.getType()), builder(kj::mv(builder)) {\n  switch (type) {\n    case DynamicValue::UNKNOWN: break;\n    case DynamicValue::VOID: voidValue = value.voidValue; break;\n    case DynamicValue::BOOL: boolValue = value.boolValue; break;\n    case DynamicValue::INT: intValue = value.intValue; break;\n    case DynamicValue::UINT: uintValue = value.uintValue; break;\n    case DynamicValue::FLOAT: floatValue = value.floatValue; break;\n    case DynamicValue::ENUM: enumValue = value.enumValue; break;\n\n    case DynamicValue::TEXT: break;\n    case DynamicValue::DATA: break;\n    case DynamicValue::LIST: listSchema = value.listValue.getSchema(); break;\n    case DynamicValue::STRUCT: structSchema = value.structValue.getSchema(); break;\n    case DynamicValue::CAPABILITY: interfaceSchema = value.capabilityValue.getSchema(); break;\n    case DynamicValue::ANY_POINTER: break;\n  }\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nOrphan<DynamicValue>::Orphan(DynamicValue::Builder value, _::OrphanBuilder&& builder)\n    : type(value.getType()), builder(kj::mv(builder)) {\n  switch (type) {\n    case DynamicValue::UNKNOWN: break;\n    case DynamicValue::VOID: voidValue = value.voidValue; break;\n    case DynamicValue::BOOL: boolValue = value.boolValue; break;\n    case DynamicValue::INT: intValue = value.intValue; break;\n    case DynamicValue::UINT: uintValue = value.uintValue; break;\n    case DynamicValue::FLOAT: floatValue = value.floatValue; break;\n    case DynamicValue::ENUM: enumValue = value.enumValue; break;\n\n    case DynamicValue::TEXT: break;\n    case DynamicValue::DATA: break;\n    case DynamicValue::LIST: listSchema = value.listValue.getSchema(); break;\n    case DynamicValue::STRUCT: structSchema = value.structValue.getSchema(); break;\n    case DynamicValue::CAPABILITY: interfaceSchema = value.capabilityValue.getSchema(); break;\n    case DynamicValue::ANY_POINTER: break;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [],
          "line": 1316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "index * ELEMENTS"
          ],
          "line": 1316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "operator[]",
          "args": [
            "index"
          ],
          "line": 1315
        },
        "resolved": true,
        "details": {
          "function_name": "InterfaceSchema::SuperclassList::operator[]",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.c++",
          "lines": "679-684",
          "snippet": "InterfaceSchema InterfaceSchema::SuperclassList::operator[](uint index) const {\n  auto superclass = list[index];\n  uint location = _::RawBrandedSchema::makeDepLocation(\n      _::RawBrandedSchema::DepKind::SUPERCLASS, index);\n  return parent.getDependency(superclass.getId(), location).asInterface();\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"message.h\"\n#include \"schema.h\"\n\nInterfaceSchema InterfaceSchema::SuperclassList::operator[](uint index) const {\n  auto superclass = list[index];\n  uint location = _::RawBrandedSchema::makeDepLocation(\n      _::RawBrandedSchema::DepKind::SUPERCLASS, index);\n  return parent.getDependency(superclass.getId(), location).asInterface();\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "result"
          ],
          "line": 1307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.setDataElement<uint64_t>",
          "args": [
            "index * ELEMENTS",
            "0"
          ],
          "line": 1301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.setDataElement<uint32_t>",
          "args": [
            "index * ELEMENTS",
            "0"
          ],
          "line": 1300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.setDataElement<uint16_t>",
          "args": [
            "index * ELEMENTS",
            "0"
          ],
          "line": 1299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.setDataElement<uint8_t>",
          "args": [
            "index * ELEMENTS",
            "0"
          ],
          "line": 1298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.setDataElement<bool>",
          "args": [
            "index * ELEMENTS",
            "false"
          ],
          "line": 1297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elementSizeFor",
          "args": [
            "schema.whichElementType()"
          ],
          "line": 1295
        },
        "resolved": true,
        "details": {
          "function_name": "elementSizeFor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "70-96",
          "snippet": "ElementSize elementSizeFor(schema::Type::Which elementType) {\n  switch (elementType) {\n    case schema::Type::VOID: return ElementSize::VOID;\n    case schema::Type::BOOL: return ElementSize::BIT;\n    case schema::Type::INT8: return ElementSize::BYTE;\n    case schema::Type::INT16: return ElementSize::TWO_BYTES;\n    case schema::Type::INT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::INT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::UINT8: return ElementSize::BYTE;\n    case schema::Type::UINT16: return ElementSize::TWO_BYTES;\n    case schema::Type::UINT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::UINT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::FLOAT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::FLOAT64: return ElementSize::EIGHT_BYTES;\n\n    case schema::Type::TEXT: return ElementSize::POINTER;\n    case schema::Type::DATA: return ElementSize::POINTER;\n    case schema::Type::LIST: return ElementSize::POINTER;\n    case schema::Type::ENUM: return ElementSize::TWO_BYTES;\n    case schema::Type::STRUCT: return ElementSize::INLINE_COMPOSITE;\n    case schema::Type::INTERFACE: return ElementSize::POINTER;\n    case schema::Type::ANY_POINTER: KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\"); break;\n  }\n\n  // Unknown type.  Treat it as zero-size.\n  return ElementSize::VOID;\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nElementSize elementSizeFor(schema::Type::Which elementType) {\n  switch (elementType) {\n    case schema::Type::VOID: return ElementSize::VOID;\n    case schema::Type::BOOL: return ElementSize::BIT;\n    case schema::Type::INT8: return ElementSize::BYTE;\n    case schema::Type::INT16: return ElementSize::TWO_BYTES;\n    case schema::Type::INT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::INT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::UINT8: return ElementSize::BYTE;\n    case schema::Type::UINT16: return ElementSize::TWO_BYTES;\n    case schema::Type::UINT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::UINT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::FLOAT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::FLOAT64: return ElementSize::EIGHT_BYTES;\n\n    case schema::Type::TEXT: return ElementSize::POINTER;\n    case schema::Type::DATA: return ElementSize::POINTER;\n    case schema::Type::LIST: return ElementSize::POINTER;\n    case schema::Type::ENUM: return ElementSize::TWO_BYTES;\n    case schema::Type::STRUCT: return ElementSize::INLINE_COMPOSITE;\n    case schema::Type::INTERFACE: return ElementSize::POINTER;\n    case schema::Type::ANY_POINTER: KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\"); break;\n  }\n\n  // Unknown type.  Treat it as zero-size.\n  return ElementSize::VOID;\n}"
        }
      },
      {
        "call_info": {
          "callee": "schema.whichElementType",
          "args": [],
          "line": 1295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_::OrphanBuilder",
          "args": [],
          "line": 1294
        },
        "resolved": true,
        "details": {
          "function_name": "OrphanBuilder",
          "container": "OrphanBuilder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/layout.h",
          "lines": "709-709",
          "snippet": "inline OrphanBuilder(): segment(nullptr), location(nullptr) { memset(&tag, 0, sizeof(tag)); }",
          "includes": [
            "#include \"endian.h\"",
            "#include \"blob.h\"",
            "#include \"common.h\"",
            "#include <kj/memory.h>",
            "#include <kj/common.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"endian.h\"\n#include \"blob.h\"\n#include \"common.h\"\n#include <kj/memory.h>\n#include <kj/common.h>\n\nOrphanBuilder {\n  inline OrphanBuilder(): segment(nullptr), location(nullptr) { memset(&tag, 0, sizeof(tag)); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "schema.whichElementType",
          "args": [],
          "line": 1280
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nOrphan<DynamicValue> DynamicList::Builder::disown(uint index) {\n  switch (schema.whichElementType()) {\n    case schema::Type::VOID:\n    case schema::Type::BOOL:\n    case schema::Type::INT8:\n    case schema::Type::INT16:\n    case schema::Type::INT32:\n    case schema::Type::INT64:\n    case schema::Type::UINT8:\n    case schema::Type::UINT16:\n    case schema::Type::UINT32:\n    case schema::Type::UINT64:\n    case schema::Type::FLOAT32:\n    case schema::Type::FLOAT64:\n    case schema::Type::ENUM: {\n      auto result = Orphan<DynamicValue>(operator[](index), _::OrphanBuilder());\n      switch (elementSizeFor(schema.whichElementType())) {\n        case ElementSize::VOID: break;\n        case ElementSize::BIT: builder.setDataElement<bool>(index * ELEMENTS, false); break;\n        case ElementSize::BYTE: builder.setDataElement<uint8_t>(index * ELEMENTS, 0); break;\n        case ElementSize::TWO_BYTES: builder.setDataElement<uint16_t>(index * ELEMENTS, 0); break;\n        case ElementSize::FOUR_BYTES: builder.setDataElement<uint32_t>(index * ELEMENTS, 0); break;\n        case ElementSize::EIGHT_BYTES: builder.setDataElement<uint64_t>(index * ELEMENTS, 0);break;\n\n        case ElementSize::POINTER:\n        case ElementSize::INLINE_COMPOSITE:\n          KJ_UNREACHABLE;\n      }\n      return kj::mv(result);\n    }\n\n    case schema::Type::TEXT:\n    case schema::Type::DATA:\n    case schema::Type::LIST:\n    case schema::Type::ANY_POINTER:\n    case schema::Type::INTERFACE: {\n      auto value = operator[](index);\n      return Orphan<DynamicValue>(value, builder.getPointerElement(index * ELEMENTS).disown());\n    }\n\n    case schema::Type::STRUCT: {\n      // We have to make a copy.\n      Orphan<DynamicStruct> result =\n          Orphanage::getForMessageContaining(*this).newOrphan(schema.getStructElementType());\n      auto element = builder.getStructElement(index * ELEMENTS);\n      result.get().builder.transferContentFrom(element);\n      element.clearAll();\n      return kj::mv(result);\n    }\n  }\n  KJ_UNREACHABLE;\n}"
  },
  {
    "function_name": "DynamicList::Builder::adopt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1218-1277",
    "snippet": "void DynamicList::Builder::adopt(uint index, Orphan<DynamicValue>&& orphan) {\n  switch (schema.whichElementType()) {\n    case schema::Type::VOID:\n    case schema::Type::BOOL:\n    case schema::Type::INT8:\n    case schema::Type::INT16:\n    case schema::Type::INT32:\n    case schema::Type::INT64:\n    case schema::Type::UINT8:\n    case schema::Type::UINT16:\n    case schema::Type::UINT32:\n    case schema::Type::UINT64:\n    case schema::Type::FLOAT32:\n    case schema::Type::FLOAT64:\n    case schema::Type::ENUM:\n      set(index, orphan.getReader());\n      return;\n\n    case schema::Type::TEXT:\n      KJ_REQUIRE(orphan.getType() == DynamicValue::TEXT, \"Value type mismatch.\");\n      builder.getPointerElement(index * ELEMENTS).adopt(kj::mv(orphan.builder));\n      return;\n\n    case schema::Type::DATA:\n      KJ_REQUIRE(orphan.getType() == DynamicValue::DATA, \"Value type mismatch.\");\n      builder.getPointerElement(index * ELEMENTS).adopt(kj::mv(orphan.builder));\n      return;\n\n    case schema::Type::LIST: {\n      ListSchema elementType = schema.getListElementType();\n      KJ_REQUIRE(orphan.getType() == DynamicValue::LIST && orphan.listSchema == elementType,\n                 \"Value type mismatch.\");\n      builder.getPointerElement(index * ELEMENTS).adopt(kj::mv(orphan.builder));\n      return;\n    }\n\n    case schema::Type::STRUCT: {\n      auto elementType = schema.getStructElementType();\n      KJ_REQUIRE(orphan.getType() == DynamicValue::STRUCT && orphan.structSchema == elementType,\n                 \"Value type mismatch.\");\n      builder.getStructElement(index * ELEMENTS).transferContentFrom(\n          orphan.builder.asStruct(structSizeFromSchema(elementType)));\n      return;\n    }\n\n    case schema::Type::ANY_POINTER:\n      KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\");\n\n    case schema::Type::INTERFACE: {\n      auto elementType = schema.getInterfaceElementType();\n      KJ_REQUIRE(orphan.getType() == DynamicValue::CAPABILITY &&\n                 orphan.interfaceSchema.extends(elementType),\n                 \"Value type mismatch.\");\n      builder.getPointerElement(index * ELEMENTS).adopt(kj::mv(orphan.builder));\n      return;\n    }\n  }\n\n  KJ_UNREACHABLE;\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "kj::mv(orphan.builder)"
          ],
          "line": 1271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "orphan.builder"
          ],
          "line": 1271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "index * ELEMENTS"
          ],
          "line": 1271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "orphan.getType() == DynamicValue::CAPABILITY &&\n                 orphan.interfaceSchema.extends(elementType)",
            "\"Value type mismatch.\""
          ],
          "line": 1268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.interfaceSchema.extends",
          "args": [
            "elementType"
          ],
          "line": 1269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.getType",
          "args": [],
          "line": 1268
        },
        "resolved": true,
        "details": {
          "function_name": "getType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "942-942",
          "snippet": "inline DynamicValue::Type getType() { return type; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline DynamicValue::Type getType() { return type; }"
        }
      },
      {
        "call_info": {
          "callee": "schema.getInterfaceElementType",
          "args": [],
          "line": 1267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_FAIL_ASSERT",
          "args": [
            "\"List(AnyPointer) not supported.\""
          ],
          "line": 1264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getStructElement",
          "args": [
            "orphan.builder.asStruct(structSizeFromSchema(elementType))"
          ],
          "line": 1258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.builder.asStruct",
          "args": [
            "structSizeFromSchema(elementType)"
          ],
          "line": 1259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structSizeFromSchema",
          "args": [
            "elementType"
          ],
          "line": 1259
        },
        "resolved": true,
        "details": {
          "function_name": "structSizeFromSchema",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "98-103",
          "snippet": "inline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\ninline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}"
        }
      },
      {
        "call_info": {
          "callee": "builder.getStructElement",
          "args": [
            "index * ELEMENTS"
          ],
          "line": 1258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "orphan.getType() == DynamicValue::STRUCT && orphan.structSchema == elementType",
            "\"Value type mismatch.\""
          ],
          "line": 1256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getStructElementType",
          "args": [],
          "line": 1255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "kj::mv(orphan.builder)"
          ],
          "line": 1250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "orphan.builder"
          ],
          "line": 1250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "index * ELEMENTS"
          ],
          "line": 1250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "orphan.getType() == DynamicValue::LIST && orphan.listSchema == elementType",
            "\"Value type mismatch.\""
          ],
          "line": 1248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getListElementType",
          "args": [],
          "line": 1247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "kj::mv(orphan.builder)"
          ],
          "line": 1243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "orphan.builder"
          ],
          "line": 1243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "index * ELEMENTS"
          ],
          "line": 1243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "orphan.getType() == DynamicValue::DATA",
            "\"Value type mismatch.\""
          ],
          "line": 1242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "kj::mv(orphan.builder)"
          ],
          "line": 1238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "orphan.builder"
          ],
          "line": 1238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "index * ELEMENTS"
          ],
          "line": 1238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "orphan.getType() == DynamicValue::TEXT",
            "\"Value type mismatch.\""
          ],
          "line": 1237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set",
          "args": [
            "index",
            "orphan.getReader()"
          ],
          "line": 1233
        },
        "resolved": true,
        "details": {
          "function_name": "PointerHelpers<DynamicCapability, Kind::OTHER>::set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "1860-1863",
          "snippet": "void PointerHelpers<DynamicCapability, Kind::OTHER>::set(\n    PointerBuilder builder, DynamicCapability::Client&& value) {\n  builder.setCapability(kj::mv(value.hook));\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nvoid PointerHelpers<DynamicCapability, Kind::OTHER>::set(\n    PointerBuilder builder, DynamicCapability::Client&& value) {\n  builder.setCapability(kj::mv(value.hook));\n}"
        }
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 1233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.whichElementType",
          "args": [],
          "line": 1219
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nvoid DynamicList::Builder::adopt(uint index, Orphan<DynamicValue>&& orphan) {\n  switch (schema.whichElementType()) {\n    case schema::Type::VOID:\n    case schema::Type::BOOL:\n    case schema::Type::INT8:\n    case schema::Type::INT16:\n    case schema::Type::INT32:\n    case schema::Type::INT64:\n    case schema::Type::UINT8:\n    case schema::Type::UINT16:\n    case schema::Type::UINT32:\n    case schema::Type::UINT64:\n    case schema::Type::FLOAT32:\n    case schema::Type::FLOAT64:\n    case schema::Type::ENUM:\n      set(index, orphan.getReader());\n      return;\n\n    case schema::Type::TEXT:\n      KJ_REQUIRE(orphan.getType() == DynamicValue::TEXT, \"Value type mismatch.\");\n      builder.getPointerElement(index * ELEMENTS).adopt(kj::mv(orphan.builder));\n      return;\n\n    case schema::Type::DATA:\n      KJ_REQUIRE(orphan.getType() == DynamicValue::DATA, \"Value type mismatch.\");\n      builder.getPointerElement(index * ELEMENTS).adopt(kj::mv(orphan.builder));\n      return;\n\n    case schema::Type::LIST: {\n      ListSchema elementType = schema.getListElementType();\n      KJ_REQUIRE(orphan.getType() == DynamicValue::LIST && orphan.listSchema == elementType,\n                 \"Value type mismatch.\");\n      builder.getPointerElement(index * ELEMENTS).adopt(kj::mv(orphan.builder));\n      return;\n    }\n\n    case schema::Type::STRUCT: {\n      auto elementType = schema.getStructElementType();\n      KJ_REQUIRE(orphan.getType() == DynamicValue::STRUCT && orphan.structSchema == elementType,\n                 \"Value type mismatch.\");\n      builder.getStructElement(index * ELEMENTS).transferContentFrom(\n          orphan.builder.asStruct(structSizeFromSchema(elementType)));\n      return;\n    }\n\n    case schema::Type::ANY_POINTER:\n      KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\");\n\n    case schema::Type::INTERFACE: {\n      auto elementType = schema.getInterfaceElementType();\n      KJ_REQUIRE(orphan.getType() == DynamicValue::CAPABILITY &&\n                 orphan.interfaceSchema.extends(elementType),\n                 \"Value type mismatch.\");\n      builder.getPointerElement(index * ELEMENTS).adopt(kj::mv(orphan.builder));\n      return;\n    }\n  }\n\n  KJ_UNREACHABLE;\n}"
  },
  {
    "function_name": "DynamicList::Builder::init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1166-1216",
    "snippet": "DynamicValue::Builder DynamicList::Builder::init(uint index, uint size) {\n  KJ_REQUIRE(index < this->size(), \"List index out-of-bounds.\");\n\n  switch (schema.whichElementType()) {\n    case schema::Type::VOID:\n    case schema::Type::BOOL:\n    case schema::Type::INT8:\n    case schema::Type::INT16:\n    case schema::Type::INT32:\n    case schema::Type::INT64:\n    case schema::Type::UINT8:\n    case schema::Type::UINT16:\n    case schema::Type::UINT32:\n    case schema::Type::UINT64:\n    case schema::Type::FLOAT32:\n    case schema::Type::FLOAT64:\n    case schema::Type::ENUM:\n    case schema::Type::STRUCT:\n    case schema::Type::INTERFACE:\n      KJ_FAIL_REQUIRE(\"Expected a list or blob.\");\n      return nullptr;\n\n    case schema::Type::TEXT:\n      return builder.getPointerElement(index * ELEMENTS).initBlob<Text>(size * BYTES);\n\n    case schema::Type::DATA:\n      return builder.getPointerElement(index * ELEMENTS).initBlob<Data>(size * BYTES);\n\n    case schema::Type::LIST: {\n      auto elementType = schema.getListElementType();\n\n      if (elementType.whichElementType() == schema::Type::STRUCT) {\n        return DynamicList::Builder(elementType,\n            builder.getPointerElement(index * ELEMENTS)\n                   .initStructList(size * ELEMENTS,\n                                   structSizeFromSchema(elementType.getStructElementType())));\n      } else {\n        return DynamicList::Builder(elementType,\n            builder.getPointerElement(index * ELEMENTS)\n                   .initList(elementSizeFor(elementType.whichElementType()), size * ELEMENTS));\n      }\n    }\n\n    case schema::Type::ANY_POINTER: {\n      KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\");\n      return nullptr;\n    }\n  }\n\n  return nullptr;\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "KJ_FAIL_ASSERT",
          "args": [
            "\"List(AnyPointer) not supported.\""
          ],
          "line": 1210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DynamicList::Builder",
          "args": [
            "elementType",
            "builder.getPointerElement(index * ELEMENTS)\n                   .initList(elementSizeFor(elementType.whichElementType()), size * ELEMENTS)"
          ],
          "line": 1203
        },
        "resolved": true,
        "details": {
          "function_name": "Builder",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "427-427",
          "snippet": "Builder(ListSchema schema, _::ListBuilder builder): schema(schema), builder(builder) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nBuilder(ListSchema schema, _::ListBuilder builder): schema(schema), builder(builder) {}"
        }
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "elementSizeFor(elementType.whichElementType())",
            "size * ELEMENTS"
          ],
          "line": 1204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elementSizeFor",
          "args": [
            "elementType.whichElementType()"
          ],
          "line": 1205
        },
        "resolved": true,
        "details": {
          "function_name": "elementSizeFor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "70-96",
          "snippet": "ElementSize elementSizeFor(schema::Type::Which elementType) {\n  switch (elementType) {\n    case schema::Type::VOID: return ElementSize::VOID;\n    case schema::Type::BOOL: return ElementSize::BIT;\n    case schema::Type::INT8: return ElementSize::BYTE;\n    case schema::Type::INT16: return ElementSize::TWO_BYTES;\n    case schema::Type::INT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::INT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::UINT8: return ElementSize::BYTE;\n    case schema::Type::UINT16: return ElementSize::TWO_BYTES;\n    case schema::Type::UINT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::UINT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::FLOAT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::FLOAT64: return ElementSize::EIGHT_BYTES;\n\n    case schema::Type::TEXT: return ElementSize::POINTER;\n    case schema::Type::DATA: return ElementSize::POINTER;\n    case schema::Type::LIST: return ElementSize::POINTER;\n    case schema::Type::ENUM: return ElementSize::TWO_BYTES;\n    case schema::Type::STRUCT: return ElementSize::INLINE_COMPOSITE;\n    case schema::Type::INTERFACE: return ElementSize::POINTER;\n    case schema::Type::ANY_POINTER: KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\"); break;\n  }\n\n  // Unknown type.  Treat it as zero-size.\n  return ElementSize::VOID;\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nElementSize elementSizeFor(schema::Type::Which elementType) {\n  switch (elementType) {\n    case schema::Type::VOID: return ElementSize::VOID;\n    case schema::Type::BOOL: return ElementSize::BIT;\n    case schema::Type::INT8: return ElementSize::BYTE;\n    case schema::Type::INT16: return ElementSize::TWO_BYTES;\n    case schema::Type::INT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::INT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::UINT8: return ElementSize::BYTE;\n    case schema::Type::UINT16: return ElementSize::TWO_BYTES;\n    case schema::Type::UINT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::UINT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::FLOAT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::FLOAT64: return ElementSize::EIGHT_BYTES;\n\n    case schema::Type::TEXT: return ElementSize::POINTER;\n    case schema::Type::DATA: return ElementSize::POINTER;\n    case schema::Type::LIST: return ElementSize::POINTER;\n    case schema::Type::ENUM: return ElementSize::TWO_BYTES;\n    case schema::Type::STRUCT: return ElementSize::INLINE_COMPOSITE;\n    case schema::Type::INTERFACE: return ElementSize::POINTER;\n    case schema::Type::ANY_POINTER: KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\"); break;\n  }\n\n  // Unknown type.  Treat it as zero-size.\n  return ElementSize::VOID;\n}"
        }
      },
      {
        "call_info": {
          "callee": "elementType.whichElementType",
          "args": [],
          "line": 1205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "index * ELEMENTS"
          ],
          "line": 1204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "size * ELEMENTS",
            "structSizeFromSchema(elementType.getStructElementType())"
          ],
          "line": 1199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structSizeFromSchema",
          "args": [
            "elementType.getStructElementType()"
          ],
          "line": 1201
        },
        "resolved": true,
        "details": {
          "function_name": "structSizeFromSchema",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "98-103",
          "snippet": "inline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\ninline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}"
        }
      },
      {
        "call_info": {
          "callee": "elementType.getStructElementType",
          "args": [],
          "line": 1201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "index * ELEMENTS"
          ],
          "line": 1199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elementType.whichElementType",
          "args": [],
          "line": 1197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getListElementType",
          "args": [],
          "line": 1195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "size * BYTES"
          ],
          "line": 1192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "index * ELEMENTS"
          ],
          "line": 1192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "size * BYTES"
          ],
          "line": 1189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "index * ELEMENTS"
          ],
          "line": 1189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_FAIL_REQUIRE",
          "args": [
            "\"Expected a list or blob.\""
          ],
          "line": 1185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.whichElementType",
          "args": [],
          "line": 1169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "index < this->size()",
            "\"List index out-of-bounds.\""
          ],
          "line": 1167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->size",
          "args": [],
          "line": 1167
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "408-408",
          "snippet": "inline uint size() const { return builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline uint size() const { return builder.size() / ELEMENTS; }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicValue::Builder DynamicList::Builder::init(uint index, uint size) {\n  KJ_REQUIRE(index < this->size(), \"List index out-of-bounds.\");\n\n  switch (schema.whichElementType()) {\n    case schema::Type::VOID:\n    case schema::Type::BOOL:\n    case schema::Type::INT8:\n    case schema::Type::INT16:\n    case schema::Type::INT32:\n    case schema::Type::INT64:\n    case schema::Type::UINT8:\n    case schema::Type::UINT16:\n    case schema::Type::UINT32:\n    case schema::Type::UINT64:\n    case schema::Type::FLOAT32:\n    case schema::Type::FLOAT64:\n    case schema::Type::ENUM:\n    case schema::Type::STRUCT:\n    case schema::Type::INTERFACE:\n      KJ_FAIL_REQUIRE(\"Expected a list or blob.\");\n      return nullptr;\n\n    case schema::Type::TEXT:\n      return builder.getPointerElement(index * ELEMENTS).initBlob<Text>(size * BYTES);\n\n    case schema::Type::DATA:\n      return builder.getPointerElement(index * ELEMENTS).initBlob<Data>(size * BYTES);\n\n    case schema::Type::LIST: {\n      auto elementType = schema.getListElementType();\n\n      if (elementType.whichElementType() == schema::Type::STRUCT) {\n        return DynamicList::Builder(elementType,\n            builder.getPointerElement(index * ELEMENTS)\n                   .initStructList(size * ELEMENTS,\n                                   structSizeFromSchema(elementType.getStructElementType())));\n      } else {\n        return DynamicList::Builder(elementType,\n            builder.getPointerElement(index * ELEMENTS)\n                   .initList(elementSizeFor(elementType.whichElementType()), size * ELEMENTS));\n      }\n    }\n\n    case schema::Type::ANY_POINTER: {\n      KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\");\n      return nullptr;\n    }\n  }\n\n  return nullptr;\n}"
  },
  {
    "function_name": "DynamicList::Builder::set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1078-1164",
    "snippet": "void DynamicList::Builder::set(uint index, const DynamicValue::Reader& value) {\n  KJ_REQUIRE(index < size(), \"List index out-of-bounds.\") {\n    return;\n  }\n\n  switch (schema.whichElementType()) {\n#define HANDLE_TYPE(name, discrim, typeName) \\\n    case schema::Type::discrim: \\\n      builder.setDataElement<typeName>(index * ELEMENTS, value.as<typeName>()); \\\n      return;\n\n    HANDLE_TYPE(void, VOID, Void)\n    HANDLE_TYPE(bool, BOOL, bool)\n    HANDLE_TYPE(int8, INT8, int8_t)\n    HANDLE_TYPE(int16, INT16, int16_t)\n    HANDLE_TYPE(int32, INT32, int32_t)\n    HANDLE_TYPE(int64, INT64, int64_t)\n    HANDLE_TYPE(uint8, UINT8, uint8_t)\n    HANDLE_TYPE(uint16, UINT16, uint16_t)\n    HANDLE_TYPE(uint32, UINT32, uint32_t)\n    HANDLE_TYPE(uint64, UINT64, uint64_t)\n    HANDLE_TYPE(float32, FLOAT32, float)\n    HANDLE_TYPE(float64, FLOAT64, double)\n#undef HANDLE_TYPE\n\n    case schema::Type::TEXT:\n      builder.getPointerElement(index * ELEMENTS).setBlob<Text>(value.as<Text>());\n      return;\n    case schema::Type::DATA:\n      builder.getPointerElement(index * ELEMENTS).setBlob<Data>(value.as<Data>());\n      return;\n\n    case schema::Type::LIST: {\n      auto listValue = value.as<DynamicList>();\n      KJ_REQUIRE(listValue.getSchema() == schema.getListElementType(), \"Value type mismatch.\") {\n        return;\n      }\n      builder.getPointerElement(index * ELEMENTS).setList(listValue.reader);\n      return;\n    }\n\n    case schema::Type::STRUCT: {\n      auto structValue = value.as<DynamicStruct>();\n      KJ_REQUIRE(structValue.getSchema() == schema.getStructElementType(), \"Value type mismatch.\") {\n        return;\n      }\n      builder.getStructElement(index * ELEMENTS).copyContentFrom(structValue.reader);\n      return;\n    }\n\n    case schema::Type::ENUM: {\n      uint16_t rawValue;\n      if (value.getType() == DynamicValue::TEXT) {\n        // Convert from text.\n        rawValue = schema.getEnumElementType().getEnumerantByName(value.as<Text>()).getOrdinal();\n      } else {\n        DynamicEnum enumValue = value.as<DynamicEnum>();\n        KJ_REQUIRE(schema.getEnumElementType() == enumValue.getSchema(),\n                   \"Type mismatch when using DynamicList::Builder::set().\") {\n          return;\n        }\n        rawValue = enumValue.getRaw();\n      }\n      builder.setDataElement<uint16_t>(index * ELEMENTS, rawValue);\n      return;\n    }\n\n    case schema::Type::ANY_POINTER:\n      KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\") {\n        return;\n      }\n\n    case schema::Type::INTERFACE: {\n      auto capValue = value.as<DynamicCapability>();\n      KJ_REQUIRE(capValue.getSchema().extends(schema.getInterfaceElementType()),\n                 \"Value type mismatch.\") {\n        return;\n      }\n      builder.getPointerElement(index * ELEMENTS).setCapability(kj::mv(capValue.hook));\n      return;\n    }\n  }\n\n  KJ_FAIL_REQUIRE(\"can't set element of unknown type\", (uint)schema.whichElementType()) {\n    return;\n  }\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "KJ_FAIL_REQUIRE",
          "args": [
            "\"can't set element of unknown type\"",
            "(uint)schema.whichElementType()"
          ],
          "line": 1161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.whichElementType",
          "args": [],
          "line": 1161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "kj::mv(capValue.hook)"
          ],
          "line": 1156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "capValue.hook"
          ],
          "line": 1156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "index * ELEMENTS"
          ],
          "line": 1156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "capValue.getSchema().extends(schema.getInterfaceElementType())",
            "\"Value type mismatch.\""
          ],
          "line": 1152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capValue.getSchema",
          "args": [
            "schema.getInterfaceElementType()"
          ],
          "line": 1152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getInterfaceElementType",
          "args": [],
          "line": 1152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capValue.getSchema",
          "args": [],
          "line": 1152
        },
        "resolved": true,
        "details": {
          "function_name": "getSchema",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "505-505",
          "snippet": "inline InterfaceSchema getSchema() const { return schema; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline InterfaceSchema getSchema() const { return schema; }"
        }
      },
      {
        "call_info": {
          "callee": "value.as<DynamicCapability>",
          "args": [],
          "line": 1151
        },
        "resolved": true,
        "details": {
          "function_name": "as",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "722-722",
          "snippet": "inline BuilderFor<T> as() { return AsImpl<T>::apply(*this); }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline BuilderFor<T> as() { return AsImpl<T>::apply(*this); }"
        }
      },
      {
        "call_info": {
          "callee": "KJ_FAIL_ASSERT",
          "args": [
            "\"List(AnyPointer) not supported.\""
          ],
          "line": 1146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.setDataElement<uint16_t>",
          "args": [
            "index * ELEMENTS",
            "rawValue"
          ],
          "line": 1141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "enumValue.getRaw",
          "args": [],
          "line": 1139
        },
        "resolved": true,
        "details": {
          "function_name": "getRaw",
          "container": "DynamicEnum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "149-149",
          "snippet": "inline uint16_t getRaw() const { return value; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nDynamicEnum {\n  inline uint16_t getRaw() const { return value; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "schema.getEnumElementType() == enumValue.getSchema()",
            "\"Type mismatch when using DynamicList::Builder::set().\""
          ],
          "line": 1135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getEnumElementType",
          "args": [],
          "line": 1135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getEnumElementType",
          "args": [],
          "line": 1132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getEnumElementType",
          "args": [
            "value.as<Text>()"
          ],
          "line": 1132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getEnumElementType",
          "args": [],
          "line": 1132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.getType",
          "args": [],
          "line": 1130
        },
        "resolved": true,
        "details": {
          "function_name": "getType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "942-942",
          "snippet": "inline DynamicValue::Type getType() { return type; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline DynamicValue::Type getType() { return type; }"
        }
      },
      {
        "call_info": {
          "callee": "builder.getStructElement",
          "args": [
            "structValue.reader"
          ],
          "line": 1124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getStructElement",
          "args": [
            "index * ELEMENTS"
          ],
          "line": 1124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "structValue.getSchema() == schema.getStructElementType()",
            "\"Value type mismatch.\""
          ],
          "line": 1121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getStructElementType",
          "args": [],
          "line": 1121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "listValue.reader"
          ],
          "line": 1115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "index * ELEMENTS"
          ],
          "line": 1115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "listValue.getSchema() == schema.getListElementType()",
            "\"Value type mismatch.\""
          ],
          "line": 1112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getListElementType",
          "args": [],
          "line": 1112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "value.as<Data>()"
          ],
          "line": 1107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "index * ELEMENTS"
          ],
          "line": 1107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "value.as<Text>()"
          ],
          "line": 1104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "index * ELEMENTS"
          ],
          "line": 1104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.whichElementType",
          "args": [],
          "line": 1083
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "index < size()",
            "\"List index out-of-bounds.\""
          ],
          "line": 1079
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "size",
          "args": [],
          "line": 1079
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "408-408",
          "snippet": "inline uint size() const { return builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline uint size() const { return builder.size() / ELEMENTS; }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nvoid DynamicList::Builder::set(uint index, const DynamicValue::Reader& value) {\n  KJ_REQUIRE(index < size(), \"List index out-of-bounds.\") {\n    return;\n  }\n\n  switch (schema.whichElementType()) {\n#define HANDLE_TYPE(name, discrim, typeName) \\\n    case schema::Type::discrim: \\\n      builder.setDataElement<typeName>(index * ELEMENTS, value.as<typeName>()); \\\n      return;\n\n    HANDLE_TYPE(void, VOID, Void)\n    HANDLE_TYPE(bool, BOOL, bool)\n    HANDLE_TYPE(int8, INT8, int8_t)\n    HANDLE_TYPE(int16, INT16, int16_t)\n    HANDLE_TYPE(int32, INT32, int32_t)\n    HANDLE_TYPE(int64, INT64, int64_t)\n    HANDLE_TYPE(uint8, UINT8, uint8_t)\n    HANDLE_TYPE(uint16, UINT16, uint16_t)\n    HANDLE_TYPE(uint32, UINT32, uint32_t)\n    HANDLE_TYPE(uint64, UINT64, uint64_t)\n    HANDLE_TYPE(float32, FLOAT32, float)\n    HANDLE_TYPE(float64, FLOAT64, double)\n#undef HANDLE_TYPE\n\n    case schema::Type::TEXT:\n      builder.getPointerElement(index * ELEMENTS).setBlob<Text>(value.as<Text>());\n      return;\n    case schema::Type::DATA:\n      builder.getPointerElement(index * ELEMENTS).setBlob<Data>(value.as<Data>());\n      return;\n\n    case schema::Type::LIST: {\n      auto listValue = value.as<DynamicList>();\n      KJ_REQUIRE(listValue.getSchema() == schema.getListElementType(), \"Value type mismatch.\") {\n        return;\n      }\n      builder.getPointerElement(index * ELEMENTS).setList(listValue.reader);\n      return;\n    }\n\n    case schema::Type::STRUCT: {\n      auto structValue = value.as<DynamicStruct>();\n      KJ_REQUIRE(structValue.getSchema() == schema.getStructElementType(), \"Value type mismatch.\") {\n        return;\n      }\n      builder.getStructElement(index * ELEMENTS).copyContentFrom(structValue.reader);\n      return;\n    }\n\n    case schema::Type::ENUM: {\n      uint16_t rawValue;\n      if (value.getType() == DynamicValue::TEXT) {\n        // Convert from text.\n        rawValue = schema.getEnumElementType().getEnumerantByName(value.as<Text>()).getOrdinal();\n      } else {\n        DynamicEnum enumValue = value.as<DynamicEnum>();\n        KJ_REQUIRE(schema.getEnumElementType() == enumValue.getSchema(),\n                   \"Type mismatch when using DynamicList::Builder::set().\") {\n          return;\n        }\n        rawValue = enumValue.getRaw();\n      }\n      builder.setDataElement<uint16_t>(index * ELEMENTS, rawValue);\n      return;\n    }\n\n    case schema::Type::ANY_POINTER:\n      KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\") {\n        return;\n      }\n\n    case schema::Type::INTERFACE: {\n      auto capValue = value.as<DynamicCapability>();\n      KJ_REQUIRE(capValue.getSchema().extends(schema.getInterfaceElementType()),\n                 \"Value type mismatch.\") {\n        return;\n      }\n      builder.getPointerElement(index * ELEMENTS).setCapability(kj::mv(capValue.hook));\n      return;\n    }\n  }\n\n  KJ_FAIL_REQUIRE(\"can't set element of unknown type\", (uint)schema.whichElementType()) {\n    return;\n  }\n}"
  },
  {
    "function_name": "DynamicList::Builder::operator[]",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "1017-1076",
    "snippet": "DynamicValue::Builder DynamicList::Builder::operator[](uint index) {\n  KJ_REQUIRE(index < size(), \"List index out-of-bounds.\");\n\n  switch (schema.whichElementType()) {\n#define HANDLE_TYPE(name, discrim, typeName) \\\n    case schema::Type::discrim: \\\n      return builder.getDataElement<typeName>(index * ELEMENTS);\n\n    HANDLE_TYPE(void, VOID, Void)\n    HANDLE_TYPE(bool, BOOL, bool)\n    HANDLE_TYPE(int8, INT8, int8_t)\n    HANDLE_TYPE(int16, INT16, int16_t)\n    HANDLE_TYPE(int32, INT32, int32_t)\n    HANDLE_TYPE(int64, INT64, int64_t)\n    HANDLE_TYPE(uint8, UINT8, uint8_t)\n    HANDLE_TYPE(uint16, UINT16, uint16_t)\n    HANDLE_TYPE(uint32, UINT32, uint32_t)\n    HANDLE_TYPE(uint64, UINT64, uint64_t)\n    HANDLE_TYPE(float32, FLOAT32, float)\n    HANDLE_TYPE(float64, FLOAT64, double)\n#undef HANDLE_TYPE\n\n    case schema::Type::TEXT:\n      return builder.getPointerElement(index * ELEMENTS).getBlob<Text>(nullptr, 0 * BYTES);\n    case schema::Type::DATA:\n      return builder.getPointerElement(index * ELEMENTS).getBlob<Data>(nullptr, 0 * BYTES);\n\n    case schema::Type::LIST: {\n      ListSchema elementType = schema.getListElementType();\n      if (elementType.whichElementType() == schema::Type::STRUCT) {\n        return DynamicList::Builder(elementType,\n            builder.getPointerElement(index * ELEMENTS)\n                   .getStructList(structSizeFromSchema(elementType.getStructElementType()),\n                                  nullptr));\n      } else {\n        return DynamicList::Builder(elementType,\n            builder.getPointerElement(index * ELEMENTS)\n                   .getList(elementSizeFor(elementType.whichElementType()), nullptr));\n      }\n    }\n\n    case schema::Type::STRUCT:\n      return DynamicStruct::Builder(schema.getStructElementType(),\n                                    builder.getStructElement(index * ELEMENTS));\n\n    case schema::Type::ENUM:\n      return DynamicEnum(schema.getEnumElementType(),\n                         builder.getDataElement<uint16_t>(index * ELEMENTS));\n\n    case schema::Type::ANY_POINTER:\n      KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\");\n      return nullptr;\n\n    case schema::Type::INTERFACE:\n      return DynamicCapability::Client(schema.getInterfaceElementType(),\n                                       builder.getPointerElement(index * ELEMENTS).getCapability());\n  }\n\n  return nullptr;\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DynamicCapability::Client",
          "args": [
            "schema.getInterfaceElementType()",
            "builder.getPointerElement(index * ELEMENTS).getCapability()"
          ],
          "line": 1071
        },
        "resolved": true,
        "details": {
          "function_name": "Client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "476-477",
          "snippet": "Client(InterfaceSchema schema, kj::Own<ClientHook>&& hook)\n      : Capability::Client(kj::mv(hook)), schema(schema) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nClient(InterfaceSchema schema, kj::Own<ClientHook>&& hook)\n      : Capability::Client(kj::mv(hook)), schema(schema) {}"
        }
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [],
          "line": 1072
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "index * ELEMENTS"
          ],
          "line": 1072
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getInterfaceElementType",
          "args": [],
          "line": 1071
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_FAIL_ASSERT",
          "args": [
            "\"List(AnyPointer) not supported.\""
          ],
          "line": 1067
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DynamicEnum",
          "args": [
            "schema.getEnumElementType()",
            "builder.getDataElement<uint16_t>(index * ELEMENTS)"
          ],
          "line": 1063
        },
        "resolved": true,
        "details": {
          "function_name": "DynamicEnum",
          "container": "DynamicEnum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "132-133",
          "snippet": "inline DynamicEnum(EnumSchema schema, uint16_t value)\n      : schema(schema), value(value) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nDynamicEnum {\n  inline DynamicEnum(EnumSchema schema, uint16_t value)\n        : schema(schema), value(value) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "builder.getDataElement<uint16_t>",
          "args": [
            "index * ELEMENTS"
          ],
          "line": 1064
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getEnumElementType",
          "args": [],
          "line": 1063
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DynamicStruct::Builder",
          "args": [
            "schema.getStructElementType()",
            "builder.getStructElement(index * ELEMENTS)"
          ],
          "line": 1059
        },
        "resolved": true,
        "details": {
          "function_name": "Builder",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "427-427",
          "snippet": "Builder(ListSchema schema, _::ListBuilder builder): schema(schema), builder(builder) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nBuilder(ListSchema schema, _::ListBuilder builder): schema(schema), builder(builder) {}"
        }
      },
      {
        "call_info": {
          "callee": "builder.getStructElement",
          "args": [
            "index * ELEMENTS"
          ],
          "line": 1060
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getStructElementType",
          "args": [],
          "line": 1059
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "elementSizeFor(elementType.whichElementType())",
            "nullptr"
          ],
          "line": 1053
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elementSizeFor",
          "args": [
            "elementType.whichElementType()"
          ],
          "line": 1054
        },
        "resolved": true,
        "details": {
          "function_name": "elementSizeFor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "70-96",
          "snippet": "ElementSize elementSizeFor(schema::Type::Which elementType) {\n  switch (elementType) {\n    case schema::Type::VOID: return ElementSize::VOID;\n    case schema::Type::BOOL: return ElementSize::BIT;\n    case schema::Type::INT8: return ElementSize::BYTE;\n    case schema::Type::INT16: return ElementSize::TWO_BYTES;\n    case schema::Type::INT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::INT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::UINT8: return ElementSize::BYTE;\n    case schema::Type::UINT16: return ElementSize::TWO_BYTES;\n    case schema::Type::UINT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::UINT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::FLOAT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::FLOAT64: return ElementSize::EIGHT_BYTES;\n\n    case schema::Type::TEXT: return ElementSize::POINTER;\n    case schema::Type::DATA: return ElementSize::POINTER;\n    case schema::Type::LIST: return ElementSize::POINTER;\n    case schema::Type::ENUM: return ElementSize::TWO_BYTES;\n    case schema::Type::STRUCT: return ElementSize::INLINE_COMPOSITE;\n    case schema::Type::INTERFACE: return ElementSize::POINTER;\n    case schema::Type::ANY_POINTER: KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\"); break;\n  }\n\n  // Unknown type.  Treat it as zero-size.\n  return ElementSize::VOID;\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nElementSize elementSizeFor(schema::Type::Which elementType) {\n  switch (elementType) {\n    case schema::Type::VOID: return ElementSize::VOID;\n    case schema::Type::BOOL: return ElementSize::BIT;\n    case schema::Type::INT8: return ElementSize::BYTE;\n    case schema::Type::INT16: return ElementSize::TWO_BYTES;\n    case schema::Type::INT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::INT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::UINT8: return ElementSize::BYTE;\n    case schema::Type::UINT16: return ElementSize::TWO_BYTES;\n    case schema::Type::UINT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::UINT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::FLOAT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::FLOAT64: return ElementSize::EIGHT_BYTES;\n\n    case schema::Type::TEXT: return ElementSize::POINTER;\n    case schema::Type::DATA: return ElementSize::POINTER;\n    case schema::Type::LIST: return ElementSize::POINTER;\n    case schema::Type::ENUM: return ElementSize::TWO_BYTES;\n    case schema::Type::STRUCT: return ElementSize::INLINE_COMPOSITE;\n    case schema::Type::INTERFACE: return ElementSize::POINTER;\n    case schema::Type::ANY_POINTER: KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\"); break;\n  }\n\n  // Unknown type.  Treat it as zero-size.\n  return ElementSize::VOID;\n}"
        }
      },
      {
        "call_info": {
          "callee": "elementType.whichElementType",
          "args": [],
          "line": 1054
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "index * ELEMENTS"
          ],
          "line": 1053
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "structSizeFromSchema(elementType.getStructElementType())",
            "nullptr"
          ],
          "line": 1048
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structSizeFromSchema",
          "args": [
            "elementType.getStructElementType()"
          ],
          "line": 1049
        },
        "resolved": true,
        "details": {
          "function_name": "structSizeFromSchema",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "98-103",
          "snippet": "inline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\ninline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}"
        }
      },
      {
        "call_info": {
          "callee": "elementType.getStructElementType",
          "args": [],
          "line": 1049
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "index * ELEMENTS"
          ],
          "line": 1048
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elementType.whichElementType",
          "args": [],
          "line": 1046
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getListElementType",
          "args": [],
          "line": 1045
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "nullptr",
            "0 * BYTES"
          ],
          "line": 1042
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "index * ELEMENTS"
          ],
          "line": 1042
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "nullptr",
            "0 * BYTES"
          ],
          "line": 1040
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "index * ELEMENTS"
          ],
          "line": 1040
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.whichElementType",
          "args": [],
          "line": 1020
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "index < size()",
            "\"List index out-of-bounds.\""
          ],
          "line": 1018
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "size",
          "args": [],
          "line": 1018
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "408-408",
          "snippet": "inline uint size() const { return builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline uint size() const { return builder.size() / ELEMENTS; }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicValue::Builder DynamicList::Builder::operator[](uint index) {\n  KJ_REQUIRE(index < size(), \"List index out-of-bounds.\");\n\n  switch (schema.whichElementType()) {\n#define HANDLE_TYPE(name, discrim, typeName) \\\n    case schema::Type::discrim: \\\n      return builder.getDataElement<typeName>(index * ELEMENTS);\n\n    HANDLE_TYPE(void, VOID, Void)\n    HANDLE_TYPE(bool, BOOL, bool)\n    HANDLE_TYPE(int8, INT8, int8_t)\n    HANDLE_TYPE(int16, INT16, int16_t)\n    HANDLE_TYPE(int32, INT32, int32_t)\n    HANDLE_TYPE(int64, INT64, int64_t)\n    HANDLE_TYPE(uint8, UINT8, uint8_t)\n    HANDLE_TYPE(uint16, UINT16, uint16_t)\n    HANDLE_TYPE(uint32, UINT32, uint32_t)\n    HANDLE_TYPE(uint64, UINT64, uint64_t)\n    HANDLE_TYPE(float32, FLOAT32, float)\n    HANDLE_TYPE(float64, FLOAT64, double)\n#undef HANDLE_TYPE\n\n    case schema::Type::TEXT:\n      return builder.getPointerElement(index * ELEMENTS).getBlob<Text>(nullptr, 0 * BYTES);\n    case schema::Type::DATA:\n      return builder.getPointerElement(index * ELEMENTS).getBlob<Data>(nullptr, 0 * BYTES);\n\n    case schema::Type::LIST: {\n      ListSchema elementType = schema.getListElementType();\n      if (elementType.whichElementType() == schema::Type::STRUCT) {\n        return DynamicList::Builder(elementType,\n            builder.getPointerElement(index * ELEMENTS)\n                   .getStructList(structSizeFromSchema(elementType.getStructElementType()),\n                                  nullptr));\n      } else {\n        return DynamicList::Builder(elementType,\n            builder.getPointerElement(index * ELEMENTS)\n                   .getList(elementSizeFor(elementType.whichElementType()), nullptr));\n      }\n    }\n\n    case schema::Type::STRUCT:\n      return DynamicStruct::Builder(schema.getStructElementType(),\n                                    builder.getStructElement(index * ELEMENTS));\n\n    case schema::Type::ENUM:\n      return DynamicEnum(schema.getEnumElementType(),\n                         builder.getDataElement<uint16_t>(index * ELEMENTS));\n\n    case schema::Type::ANY_POINTER:\n      KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\");\n      return nullptr;\n\n    case schema::Type::INTERFACE:\n      return DynamicCapability::Client(schema.getInterfaceElementType(),\n                                       builder.getPointerElement(index * ELEMENTS).getCapability());\n  }\n\n  return nullptr;\n}"
  },
  {
    "function_name": "DynamicList::Reader::operator[]",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "964-1015",
    "snippet": "DynamicValue::Reader DynamicList::Reader::operator[](uint index) const {\n  KJ_REQUIRE(index < size(), \"List index out-of-bounds.\");\n\n  switch (schema.whichElementType()) {\n#define HANDLE_TYPE(name, discrim, typeName) \\\n    case schema::Type::discrim: \\\n      return reader.getDataElement<typeName>(index * ELEMENTS);\n\n    HANDLE_TYPE(void, VOID, Void)\n    HANDLE_TYPE(bool, BOOL, bool)\n    HANDLE_TYPE(int8, INT8, int8_t)\n    HANDLE_TYPE(int16, INT16, int16_t)\n    HANDLE_TYPE(int32, INT32, int32_t)\n    HANDLE_TYPE(int64, INT64, int64_t)\n    HANDLE_TYPE(uint8, UINT8, uint8_t)\n    HANDLE_TYPE(uint16, UINT16, uint16_t)\n    HANDLE_TYPE(uint32, UINT32, uint32_t)\n    HANDLE_TYPE(uint64, UINT64, uint64_t)\n    HANDLE_TYPE(float32, FLOAT32, float)\n    HANDLE_TYPE(float64, FLOAT64, double)\n#undef HANDLE_TYPE\n\n    case schema::Type::TEXT:\n      return reader.getPointerElement(index * ELEMENTS).getBlob<Text>(nullptr, 0 * BYTES);\n    case schema::Type::DATA:\n      return reader.getPointerElement(index * ELEMENTS).getBlob<Data>(nullptr, 0 * BYTES);\n\n    case schema::Type::LIST: {\n      auto elementType = schema.getListElementType();\n      return DynamicList::Reader(elementType,\n          reader.getPointerElement(index * ELEMENTS)\n                .getList(elementSizeFor(elementType.whichElementType()), nullptr));\n    }\n\n    case schema::Type::STRUCT:\n      return DynamicStruct::Reader(schema.getStructElementType(),\n                                   reader.getStructElement(index * ELEMENTS));\n\n    case schema::Type::ENUM:\n      return DynamicEnum(schema.getEnumElementType(),\n                         reader.getDataElement<uint16_t>(index * ELEMENTS));\n\n    case schema::Type::ANY_POINTER:\n      return AnyPointer::Reader(reader.getPointerElement(index * ELEMENTS));\n\n    case schema::Type::INTERFACE:\n      return DynamicCapability::Client(schema.getInterfaceElementType(),\n                                       reader.getPointerElement(index * ELEMENTS).getCapability());\n  }\n\n  return nullptr;\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DynamicCapability::Client",
          "args": [
            "schema.getInterfaceElementType()",
            "reader.getPointerElement(index * ELEMENTS).getCapability()"
          ],
          "line": 1010
        },
        "resolved": true,
        "details": {
          "function_name": "Client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "476-477",
          "snippet": "Client(InterfaceSchema schema, kj::Own<ClientHook>&& hook)\n      : Capability::Client(kj::mv(hook)), schema(schema) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nClient(InterfaceSchema schema, kj::Own<ClientHook>&& hook)\n      : Capability::Client(kj::mv(hook)), schema(schema) {}"
        }
      },
      {
        "call_info": {
          "callee": "reader.getPointerElement",
          "args": [],
          "line": 1011
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getPointerElement",
          "args": [
            "index * ELEMENTS"
          ],
          "line": 1011
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getInterfaceElementType",
          "args": [],
          "line": 1010
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AnyPointer::Reader",
          "args": [
            "reader.getPointerElement(index * ELEMENTS)"
          ],
          "line": 1007
        },
        "resolved": true,
        "details": {
          "function_name": "Reader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "612-612",
          "snippet": "inline Reader(T&& value): Reader(toDynamic(kj::mv(value))) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline Reader(T&& value): Reader(toDynamic(kj::mv(value))) {}"
        }
      },
      {
        "call_info": {
          "callee": "reader.getPointerElement",
          "args": [
            "index * ELEMENTS"
          ],
          "line": 1007
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DynamicEnum",
          "args": [
            "schema.getEnumElementType()",
            "reader.getDataElement<uint16_t>(index * ELEMENTS)"
          ],
          "line": 1003
        },
        "resolved": true,
        "details": {
          "function_name": "DynamicEnum",
          "container": "DynamicEnum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "132-133",
          "snippet": "inline DynamicEnum(EnumSchema schema, uint16_t value)\n      : schema(schema), value(value) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nDynamicEnum {\n  inline DynamicEnum(EnumSchema schema, uint16_t value)\n        : schema(schema), value(value) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "reader.getDataElement<uint16_t>",
          "args": [
            "index * ELEMENTS"
          ],
          "line": 1004
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getEnumElementType",
          "args": [],
          "line": 1003
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getStructElement",
          "args": [
            "index * ELEMENTS"
          ],
          "line": 1000
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getStructElementType",
          "args": [],
          "line": 999
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getPointerElement",
          "args": [
            "elementSizeFor(elementType.whichElementType())",
            "nullptr"
          ],
          "line": 994
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elementSizeFor",
          "args": [
            "elementType.whichElementType()"
          ],
          "line": 995
        },
        "resolved": true,
        "details": {
          "function_name": "elementSizeFor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "70-96",
          "snippet": "ElementSize elementSizeFor(schema::Type::Which elementType) {\n  switch (elementType) {\n    case schema::Type::VOID: return ElementSize::VOID;\n    case schema::Type::BOOL: return ElementSize::BIT;\n    case schema::Type::INT8: return ElementSize::BYTE;\n    case schema::Type::INT16: return ElementSize::TWO_BYTES;\n    case schema::Type::INT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::INT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::UINT8: return ElementSize::BYTE;\n    case schema::Type::UINT16: return ElementSize::TWO_BYTES;\n    case schema::Type::UINT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::UINT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::FLOAT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::FLOAT64: return ElementSize::EIGHT_BYTES;\n\n    case schema::Type::TEXT: return ElementSize::POINTER;\n    case schema::Type::DATA: return ElementSize::POINTER;\n    case schema::Type::LIST: return ElementSize::POINTER;\n    case schema::Type::ENUM: return ElementSize::TWO_BYTES;\n    case schema::Type::STRUCT: return ElementSize::INLINE_COMPOSITE;\n    case schema::Type::INTERFACE: return ElementSize::POINTER;\n    case schema::Type::ANY_POINTER: KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\"); break;\n  }\n\n  // Unknown type.  Treat it as zero-size.\n  return ElementSize::VOID;\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nElementSize elementSizeFor(schema::Type::Which elementType) {\n  switch (elementType) {\n    case schema::Type::VOID: return ElementSize::VOID;\n    case schema::Type::BOOL: return ElementSize::BIT;\n    case schema::Type::INT8: return ElementSize::BYTE;\n    case schema::Type::INT16: return ElementSize::TWO_BYTES;\n    case schema::Type::INT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::INT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::UINT8: return ElementSize::BYTE;\n    case schema::Type::UINT16: return ElementSize::TWO_BYTES;\n    case schema::Type::UINT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::UINT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::FLOAT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::FLOAT64: return ElementSize::EIGHT_BYTES;\n\n    case schema::Type::TEXT: return ElementSize::POINTER;\n    case schema::Type::DATA: return ElementSize::POINTER;\n    case schema::Type::LIST: return ElementSize::POINTER;\n    case schema::Type::ENUM: return ElementSize::TWO_BYTES;\n    case schema::Type::STRUCT: return ElementSize::INLINE_COMPOSITE;\n    case schema::Type::INTERFACE: return ElementSize::POINTER;\n    case schema::Type::ANY_POINTER: KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\"); break;\n  }\n\n  // Unknown type.  Treat it as zero-size.\n  return ElementSize::VOID;\n}"
        }
      },
      {
        "call_info": {
          "callee": "elementType.whichElementType",
          "args": [],
          "line": 995
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getPointerElement",
          "args": [
            "index * ELEMENTS"
          ],
          "line": 994
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getListElementType",
          "args": [],
          "line": 992
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getPointerElement",
          "args": [
            "nullptr",
            "0 * BYTES"
          ],
          "line": 989
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getPointerElement",
          "args": [
            "index * ELEMENTS"
          ],
          "line": 989
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getPointerElement",
          "args": [
            "nullptr",
            "0 * BYTES"
          ],
          "line": 987
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getPointerElement",
          "args": [
            "index * ELEMENTS"
          ],
          "line": 987
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.whichElementType",
          "args": [],
          "line": 967
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "index < size()",
            "\"List index out-of-bounds.\""
          ],
          "line": 965
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "size",
          "args": [],
          "line": 965
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "408-408",
          "snippet": "inline uint size() const { return builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline uint size() const { return builder.size() / ELEMENTS; }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicValue::Reader DynamicList::Reader::operator[](uint index) const {\n  KJ_REQUIRE(index < size(), \"List index out-of-bounds.\");\n\n  switch (schema.whichElementType()) {\n#define HANDLE_TYPE(name, discrim, typeName) \\\n    case schema::Type::discrim: \\\n      return reader.getDataElement<typeName>(index * ELEMENTS);\n\n    HANDLE_TYPE(void, VOID, Void)\n    HANDLE_TYPE(bool, BOOL, bool)\n    HANDLE_TYPE(int8, INT8, int8_t)\n    HANDLE_TYPE(int16, INT16, int16_t)\n    HANDLE_TYPE(int32, INT32, int32_t)\n    HANDLE_TYPE(int64, INT64, int64_t)\n    HANDLE_TYPE(uint8, UINT8, uint8_t)\n    HANDLE_TYPE(uint16, UINT16, uint16_t)\n    HANDLE_TYPE(uint32, UINT32, uint32_t)\n    HANDLE_TYPE(uint64, UINT64, uint64_t)\n    HANDLE_TYPE(float32, FLOAT32, float)\n    HANDLE_TYPE(float64, FLOAT64, double)\n#undef HANDLE_TYPE\n\n    case schema::Type::TEXT:\n      return reader.getPointerElement(index * ELEMENTS).getBlob<Text>(nullptr, 0 * BYTES);\n    case schema::Type::DATA:\n      return reader.getPointerElement(index * ELEMENTS).getBlob<Data>(nullptr, 0 * BYTES);\n\n    case schema::Type::LIST: {\n      auto elementType = schema.getListElementType();\n      return DynamicList::Reader(elementType,\n          reader.getPointerElement(index * ELEMENTS)\n                .getList(elementSizeFor(elementType.whichElementType()), nullptr));\n    }\n\n    case schema::Type::STRUCT:\n      return DynamicStruct::Reader(schema.getStructElementType(),\n                                   reader.getStructElement(index * ELEMENTS));\n\n    case schema::Type::ENUM:\n      return DynamicEnum(schema.getEnumElementType(),\n                         reader.getDataElement<uint16_t>(index * ELEMENTS));\n\n    case schema::Type::ANY_POINTER:\n      return AnyPointer::Reader(reader.getPointerElement(index * ELEMENTS));\n\n    case schema::Type::INTERFACE:\n      return DynamicCapability::Client(schema.getInterfaceElementType(),\n                                       reader.getPointerElement(index * ELEMENTS).getCapability());\n  }\n\n  return nullptr;\n}"
  },
  {
    "function_name": "DynamicStruct::Builder::clear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "958-960",
    "snippet": "void DynamicStruct::Builder::clear(kj::StringPtr name) {\n  clear(schema.getFieldByName(name));\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [
            "name"
          ],
          "line": 959
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nvoid DynamicStruct::Builder::clear(kj::StringPtr name) {\n  clear(schema.getFieldByName(name));\n}"
  },
  {
    "function_name": "DynamicStruct::Builder::disown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "955-957",
    "snippet": "Orphan<DynamicValue> DynamicStruct::Builder::disown(kj::StringPtr name) {\n  return disown(schema.getFieldByName(name));\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "disown",
          "args": [
            "schema.getFieldByName(name)"
          ],
          "line": 956
        },
        "resolved": true,
        "details": {
          "function_name": "DynamicList::Builder::disown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "1279-1330",
          "snippet": "Orphan<DynamicValue> DynamicList::Builder::disown(uint index) {\n  switch (schema.whichElementType()) {\n    case schema::Type::VOID:\n    case schema::Type::BOOL:\n    case schema::Type::INT8:\n    case schema::Type::INT16:\n    case schema::Type::INT32:\n    case schema::Type::INT64:\n    case schema::Type::UINT8:\n    case schema::Type::UINT16:\n    case schema::Type::UINT32:\n    case schema::Type::UINT64:\n    case schema::Type::FLOAT32:\n    case schema::Type::FLOAT64:\n    case schema::Type::ENUM: {\n      auto result = Orphan<DynamicValue>(operator[](index), _::OrphanBuilder());\n      switch (elementSizeFor(schema.whichElementType())) {\n        case ElementSize::VOID: break;\n        case ElementSize::BIT: builder.setDataElement<bool>(index * ELEMENTS, false); break;\n        case ElementSize::BYTE: builder.setDataElement<uint8_t>(index * ELEMENTS, 0); break;\n        case ElementSize::TWO_BYTES: builder.setDataElement<uint16_t>(index * ELEMENTS, 0); break;\n        case ElementSize::FOUR_BYTES: builder.setDataElement<uint32_t>(index * ELEMENTS, 0); break;\n        case ElementSize::EIGHT_BYTES: builder.setDataElement<uint64_t>(index * ELEMENTS, 0);break;\n\n        case ElementSize::POINTER:\n        case ElementSize::INLINE_COMPOSITE:\n          KJ_UNREACHABLE;\n      }\n      return kj::mv(result);\n    }\n\n    case schema::Type::TEXT:\n    case schema::Type::DATA:\n    case schema::Type::LIST:\n    case schema::Type::ANY_POINTER:\n    case schema::Type::INTERFACE: {\n      auto value = operator[](index);\n      return Orphan<DynamicValue>(value, builder.getPointerElement(index * ELEMENTS).disown());\n    }\n\n    case schema::Type::STRUCT: {\n      // We have to make a copy.\n      Orphan<DynamicStruct> result =\n          Orphanage::getForMessageContaining(*this).newOrphan(schema.getStructElementType());\n      auto element = builder.getStructElement(index * ELEMENTS);\n      result.get().builder.transferContentFrom(element);\n      element.clearAll();\n      return kj::mv(result);\n    }\n  }\n  KJ_UNREACHABLE;\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nOrphan<DynamicValue> DynamicList::Builder::disown(uint index) {\n  switch (schema.whichElementType()) {\n    case schema::Type::VOID:\n    case schema::Type::BOOL:\n    case schema::Type::INT8:\n    case schema::Type::INT16:\n    case schema::Type::INT32:\n    case schema::Type::INT64:\n    case schema::Type::UINT8:\n    case schema::Type::UINT16:\n    case schema::Type::UINT32:\n    case schema::Type::UINT64:\n    case schema::Type::FLOAT32:\n    case schema::Type::FLOAT64:\n    case schema::Type::ENUM: {\n      auto result = Orphan<DynamicValue>(operator[](index), _::OrphanBuilder());\n      switch (elementSizeFor(schema.whichElementType())) {\n        case ElementSize::VOID: break;\n        case ElementSize::BIT: builder.setDataElement<bool>(index * ELEMENTS, false); break;\n        case ElementSize::BYTE: builder.setDataElement<uint8_t>(index * ELEMENTS, 0); break;\n        case ElementSize::TWO_BYTES: builder.setDataElement<uint16_t>(index * ELEMENTS, 0); break;\n        case ElementSize::FOUR_BYTES: builder.setDataElement<uint32_t>(index * ELEMENTS, 0); break;\n        case ElementSize::EIGHT_BYTES: builder.setDataElement<uint64_t>(index * ELEMENTS, 0);break;\n\n        case ElementSize::POINTER:\n        case ElementSize::INLINE_COMPOSITE:\n          KJ_UNREACHABLE;\n      }\n      return kj::mv(result);\n    }\n\n    case schema::Type::TEXT:\n    case schema::Type::DATA:\n    case schema::Type::LIST:\n    case schema::Type::ANY_POINTER:\n    case schema::Type::INTERFACE: {\n      auto value = operator[](index);\n      return Orphan<DynamicValue>(value, builder.getPointerElement(index * ELEMENTS).disown());\n    }\n\n    case schema::Type::STRUCT: {\n      // We have to make a copy.\n      Orphan<DynamicStruct> result =\n          Orphanage::getForMessageContaining(*this).newOrphan(schema.getStructElementType());\n      auto element = builder.getStructElement(index * ELEMENTS);\n      result.get().builder.transferContentFrom(element);\n      element.clearAll();\n      return kj::mv(result);\n    }\n  }\n  KJ_UNREACHABLE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [
            "name"
          ],
          "line": 956
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nOrphan<DynamicValue> DynamicStruct::Builder::disown(kj::StringPtr name) {\n  return disown(schema.getFieldByName(name));\n}"
  },
  {
    "function_name": "DynamicStruct::Builder::adopt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "952-954",
    "snippet": "void DynamicStruct::Builder::adopt(kj::StringPtr name, Orphan<DynamicValue>&& orphan) {\n  adopt(schema.getFieldByName(name), kj::mv(orphan));\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "adopt",
          "args": [
            "schema.getFieldByName(name)",
            "kj::mv(orphan)"
          ],
          "line": 953
        },
        "resolved": true,
        "details": {
          "function_name": "DynamicList::Builder::adopt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "1218-1277",
          "snippet": "void DynamicList::Builder::adopt(uint index, Orphan<DynamicValue>&& orphan) {\n  switch (schema.whichElementType()) {\n    case schema::Type::VOID:\n    case schema::Type::BOOL:\n    case schema::Type::INT8:\n    case schema::Type::INT16:\n    case schema::Type::INT32:\n    case schema::Type::INT64:\n    case schema::Type::UINT8:\n    case schema::Type::UINT16:\n    case schema::Type::UINT32:\n    case schema::Type::UINT64:\n    case schema::Type::FLOAT32:\n    case schema::Type::FLOAT64:\n    case schema::Type::ENUM:\n      set(index, orphan.getReader());\n      return;\n\n    case schema::Type::TEXT:\n      KJ_REQUIRE(orphan.getType() == DynamicValue::TEXT, \"Value type mismatch.\");\n      builder.getPointerElement(index * ELEMENTS).adopt(kj::mv(orphan.builder));\n      return;\n\n    case schema::Type::DATA:\n      KJ_REQUIRE(orphan.getType() == DynamicValue::DATA, \"Value type mismatch.\");\n      builder.getPointerElement(index * ELEMENTS).adopt(kj::mv(orphan.builder));\n      return;\n\n    case schema::Type::LIST: {\n      ListSchema elementType = schema.getListElementType();\n      KJ_REQUIRE(orphan.getType() == DynamicValue::LIST && orphan.listSchema == elementType,\n                 \"Value type mismatch.\");\n      builder.getPointerElement(index * ELEMENTS).adopt(kj::mv(orphan.builder));\n      return;\n    }\n\n    case schema::Type::STRUCT: {\n      auto elementType = schema.getStructElementType();\n      KJ_REQUIRE(orphan.getType() == DynamicValue::STRUCT && orphan.structSchema == elementType,\n                 \"Value type mismatch.\");\n      builder.getStructElement(index * ELEMENTS).transferContentFrom(\n          orphan.builder.asStruct(structSizeFromSchema(elementType)));\n      return;\n    }\n\n    case schema::Type::ANY_POINTER:\n      KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\");\n\n    case schema::Type::INTERFACE: {\n      auto elementType = schema.getInterfaceElementType();\n      KJ_REQUIRE(orphan.getType() == DynamicValue::CAPABILITY &&\n                 orphan.interfaceSchema.extends(elementType),\n                 \"Value type mismatch.\");\n      builder.getPointerElement(index * ELEMENTS).adopt(kj::mv(orphan.builder));\n      return;\n    }\n  }\n\n  KJ_UNREACHABLE;\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nvoid DynamicList::Builder::adopt(uint index, Orphan<DynamicValue>&& orphan) {\n  switch (schema.whichElementType()) {\n    case schema::Type::VOID:\n    case schema::Type::BOOL:\n    case schema::Type::INT8:\n    case schema::Type::INT16:\n    case schema::Type::INT32:\n    case schema::Type::INT64:\n    case schema::Type::UINT8:\n    case schema::Type::UINT16:\n    case schema::Type::UINT32:\n    case schema::Type::UINT64:\n    case schema::Type::FLOAT32:\n    case schema::Type::FLOAT64:\n    case schema::Type::ENUM:\n      set(index, orphan.getReader());\n      return;\n\n    case schema::Type::TEXT:\n      KJ_REQUIRE(orphan.getType() == DynamicValue::TEXT, \"Value type mismatch.\");\n      builder.getPointerElement(index * ELEMENTS).adopt(kj::mv(orphan.builder));\n      return;\n\n    case schema::Type::DATA:\n      KJ_REQUIRE(orphan.getType() == DynamicValue::DATA, \"Value type mismatch.\");\n      builder.getPointerElement(index * ELEMENTS).adopt(kj::mv(orphan.builder));\n      return;\n\n    case schema::Type::LIST: {\n      ListSchema elementType = schema.getListElementType();\n      KJ_REQUIRE(orphan.getType() == DynamicValue::LIST && orphan.listSchema == elementType,\n                 \"Value type mismatch.\");\n      builder.getPointerElement(index * ELEMENTS).adopt(kj::mv(orphan.builder));\n      return;\n    }\n\n    case schema::Type::STRUCT: {\n      auto elementType = schema.getStructElementType();\n      KJ_REQUIRE(orphan.getType() == DynamicValue::STRUCT && orphan.structSchema == elementType,\n                 \"Value type mismatch.\");\n      builder.getStructElement(index * ELEMENTS).transferContentFrom(\n          orphan.builder.asStruct(structSizeFromSchema(elementType)));\n      return;\n    }\n\n    case schema::Type::ANY_POINTER:\n      KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\");\n\n    case schema::Type::INTERFACE: {\n      auto elementType = schema.getInterfaceElementType();\n      KJ_REQUIRE(orphan.getType() == DynamicValue::CAPABILITY &&\n                 orphan.interfaceSchema.extends(elementType),\n                 \"Value type mismatch.\");\n      builder.getPointerElement(index * ELEMENTS).adopt(kj::mv(orphan.builder));\n      return;\n    }\n  }\n\n  KJ_UNREACHABLE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "orphan"
          ],
          "line": 953
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [
            "name"
          ],
          "line": 953
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nvoid DynamicStruct::Builder::adopt(kj::StringPtr name, Orphan<DynamicValue>&& orphan) {\n  adopt(schema.getFieldByName(name), kj::mv(orphan));\n}"
  },
  {
    "function_name": "DynamicStruct::Builder::init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "949-951",
    "snippet": "DynamicValue::Builder DynamicStruct::Builder::init(kj::StringPtr name, uint size) {\n  return init(schema.getFieldByName(name), size);\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "init",
          "args": [
            "schema.getFieldByName(name)",
            "size"
          ],
          "line": 950
        },
        "resolved": true,
        "details": {
          "function_name": "PointerHelpers<DynamicStruct, Kind::OTHER>::init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "1807-1813",
          "snippet": "DynamicStruct::Builder PointerHelpers<DynamicStruct, Kind::OTHER>::init(\n    PointerBuilder builder, StructSchema schema) {\n  KJ_REQUIRE(!schema.getProto().getStruct().getIsGroup(),\n             \"Cannot form pointer to group type.\");\n  return DynamicStruct::Builder(schema,\n      builder.initStruct(structSizeFromSchema(schema)));\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicStruct::Builder PointerHelpers<DynamicStruct, Kind::OTHER>::init(\n    PointerBuilder builder, StructSchema schema) {\n  KJ_REQUIRE(!schema.getProto().getStruct().getIsGroup(),\n             \"Cannot form pointer to group type.\");\n  return DynamicStruct::Builder(schema,\n      builder.initStruct(structSizeFromSchema(schema)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [
            "name"
          ],
          "line": 950
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicValue::Builder DynamicStruct::Builder::init(kj::StringPtr name, uint size) {\n  return init(schema.getFieldByName(name), size);\n}"
  },
  {
    "function_name": "DynamicStruct::Builder::init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "946-948",
    "snippet": "DynamicValue::Builder DynamicStruct::Builder::init(kj::StringPtr name) {\n  return init(schema.getFieldByName(name));\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [
            "name"
          ],
          "line": 947
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicValue::Builder DynamicStruct::Builder::init(kj::StringPtr name) {\n  return init(schema.getFieldByName(name));\n}"
  },
  {
    "function_name": "DynamicStruct::Builder::set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "938-945",
    "snippet": "void DynamicStruct::Builder::set(kj::StringPtr name,\n                                 std::initializer_list<DynamicValue::Reader> value) {\n  auto list = init(name, value.size()).as<DynamicList>();\n  uint i = 0;\n  for (auto element: value) {\n    list.set(i++, element);\n  }\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list.set",
          "args": [
            "i++",
            "element"
          ],
          "line": 943
        },
        "resolved": true,
        "details": {
          "function_name": "set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "872-874",
          "snippet": "static inline void set(PointerBuilder builder, AnyList::Reader value) {\n    builder.setList(value._reader);\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline void set(PointerBuilder builder, AnyList::Reader value) {\n    builder.setList(value._reader);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "init",
          "args": [],
          "line": 940
        },
        "resolved": true,
        "details": {
          "function_name": "init",
          "container": "OneOf",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/one-of.h",
          "lines": "77-81",
          "snippet": "void init(Params&&... params) {\n    if (tag != 0) destroy();\n    ctor(*reinterpret_cast<T*>(space), kj::fwd<Params>(params)...);\n    tag = typeIndex<T>();\n  }",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nOneOf {\n  void init(Params&&... params) {\n      if (tag != 0) destroy();\n      ctor(*reinterpret_cast<T*>(space), kj::fwd<Params>(params)...);\n      tag = typeIndex<T>();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "init",
          "args": [
            "name",
            "value.size()"
          ],
          "line": 940
        },
        "resolved": true,
        "details": {
          "function_name": "PointerHelpers<DynamicStruct, Kind::OTHER>::init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "1807-1813",
          "snippet": "DynamicStruct::Builder PointerHelpers<DynamicStruct, Kind::OTHER>::init(\n    PointerBuilder builder, StructSchema schema) {\n  KJ_REQUIRE(!schema.getProto().getStruct().getIsGroup(),\n             \"Cannot form pointer to group type.\");\n  return DynamicStruct::Builder(schema,\n      builder.initStruct(structSizeFromSchema(schema)));\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicStruct::Builder PointerHelpers<DynamicStruct, Kind::OTHER>::init(\n    PointerBuilder builder, StructSchema schema) {\n  KJ_REQUIRE(!schema.getProto().getStruct().getIsGroup(),\n             \"Cannot form pointer to group type.\");\n  return DynamicStruct::Builder(schema,\n      builder.initStruct(structSizeFromSchema(schema)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "value.size",
          "args": [],
          "line": 940
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "408-408",
          "snippet": "inline uint size() const { return builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline uint size() const { return builder.size() / ELEMENTS; }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nvoid DynamicStruct::Builder::set(kj::StringPtr name,\n                                 std::initializer_list<DynamicValue::Reader> value) {\n  auto list = init(name, value.size()).as<DynamicList>();\n  uint i = 0;\n  for (auto element: value) {\n    list.set(i++, element);\n  }\n}"
  },
  {
    "function_name": "DynamicStruct::Builder::set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "935-937",
    "snippet": "void DynamicStruct::Builder::set(kj::StringPtr name, const DynamicValue::Reader& value) {\n  set(schema.getFieldByName(name), value);\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set",
          "args": [
            "schema.getFieldByName(name)",
            "value"
          ],
          "line": 936
        },
        "resolved": true,
        "details": {
          "function_name": "PointerHelpers<DynamicCapability, Kind::OTHER>::set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "1860-1863",
          "snippet": "void PointerHelpers<DynamicCapability, Kind::OTHER>::set(\n    PointerBuilder builder, DynamicCapability::Client&& value) {\n  builder.setCapability(kj::mv(value.hook));\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nvoid PointerHelpers<DynamicCapability, Kind::OTHER>::set(\n    PointerBuilder builder, DynamicCapability::Client&& value) {\n  builder.setCapability(kj::mv(value.hook));\n}"
        }
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [
            "name"
          ],
          "line": 936
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nvoid DynamicStruct::Builder::set(kj::StringPtr name, const DynamicValue::Reader& value) {\n  set(schema.getFieldByName(name), value);\n}"
  },
  {
    "function_name": "DynamicStruct::Builder::has",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "932-934",
    "snippet": "bool DynamicStruct::Builder::has(kj::StringPtr name) {\n  return has(schema.getFieldByName(name));\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [
            "name"
          ],
          "line": 933
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nbool DynamicStruct::Builder::has(kj::StringPtr name) {\n  return has(schema.getFieldByName(name));\n}"
  },
  {
    "function_name": "DynamicStruct::Reader::has",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "929-931",
    "snippet": "bool DynamicStruct::Reader::has(kj::StringPtr name) const {\n  return has(schema.getFieldByName(name));\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "has",
          "args": [
            "schema.getFieldByName(name)"
          ],
          "line": 930
        },
        "resolved": true,
        "details": {
          "function_name": "DynamicStruct::Builder::has",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "932-934",
          "snippet": "bool DynamicStruct::Builder::has(kj::StringPtr name) {\n  return has(schema.getFieldByName(name));\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nbool DynamicStruct::Builder::has(kj::StringPtr name) {\n  return has(schema.getFieldByName(name));\n}"
        }
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [
            "name"
          ],
          "line": 930
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nbool DynamicStruct::Reader::has(kj::StringPtr name) const {\n  return has(schema.getFieldByName(name));\n}"
  },
  {
    "function_name": "DynamicStruct::Pipeline::get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "926-928",
    "snippet": "DynamicValue::Pipeline DynamicStruct::Pipeline::get(kj::StringPtr name) {\n  return get(schema.getFieldByName(name));\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [
            "name"
          ],
          "line": 927
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicValue::Pipeline DynamicStruct::Pipeline::get(kj::StringPtr name) {\n  return get(schema.getFieldByName(name));\n}"
  },
  {
    "function_name": "DynamicStruct::Builder::get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "923-925",
    "snippet": "DynamicValue::Builder DynamicStruct::Builder::get(kj::StringPtr name) {\n  return get(schema.getFieldByName(name));\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get",
          "args": [
            "schema.getFieldByName(name)"
          ],
          "line": 924
        },
        "resolved": true,
        "details": {
          "function_name": "DynamicStruct::Pipeline::get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "926-928",
          "snippet": "DynamicValue::Pipeline DynamicStruct::Pipeline::get(kj::StringPtr name) {\n  return get(schema.getFieldByName(name));\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicValue::Pipeline DynamicStruct::Pipeline::get(kj::StringPtr name) {\n  return get(schema.getFieldByName(name));\n}"
        }
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [
            "name"
          ],
          "line": 924
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicValue::Builder DynamicStruct::Builder::get(kj::StringPtr name) {\n  return get(schema.getFieldByName(name));\n}"
  },
  {
    "function_name": "DynamicStruct::Reader::get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "920-922",
    "snippet": "DynamicValue::Reader DynamicStruct::Reader::get(kj::StringPtr name) const {\n  return get(schema.getFieldByName(name));\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get",
          "args": [
            "schema.getFieldByName(name)"
          ],
          "line": 921
        },
        "resolved": true,
        "details": {
          "function_name": "DynamicStruct::Pipeline::get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "926-928",
          "snippet": "DynamicValue::Pipeline DynamicStruct::Pipeline::get(kj::StringPtr name) {\n  return get(schema.getFieldByName(name));\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicValue::Pipeline DynamicStruct::Pipeline::get(kj::StringPtr name) {\n  return get(schema.getFieldByName(name));\n}"
        }
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [
            "name"
          ],
          "line": 921
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicValue::Reader DynamicStruct::Reader::get(kj::StringPtr name) const {\n  return get(schema.getFieldByName(name));\n}"
  },
  {
    "function_name": "DynamicStruct::Builder::clear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "853-918",
    "snippet": "void DynamicStruct::Builder::clear(StructSchema::Field field) {\n  KJ_REQUIRE(field.getContainingStruct() == schema, \"`field` is not a field of this struct.\");\n  setInUnion(field);\n\n  auto proto = field.getProto();\n  auto type = field.getType();\n  switch (proto.which()) {\n    case schema::Field::SLOT: {\n      auto slot = proto.getSlot();\n\n      switch (type.which()) {\n        case schema::Type::VOID:\n          builder.setDataField<Void>(slot.getOffset() * ELEMENTS, VOID);\n          return;\n\n#define HANDLE_TYPE(discrim, type) \\\n        case schema::Type::discrim: \\\n          builder.setDataField<type>(slot.getOffset() * ELEMENTS, 0); \\\n          return;\n\n        HANDLE_TYPE(BOOL, bool)\n        HANDLE_TYPE(INT8, uint8_t)\n        HANDLE_TYPE(INT16, uint16_t)\n        HANDLE_TYPE(INT32, uint32_t)\n        HANDLE_TYPE(INT64, uint64_t)\n        HANDLE_TYPE(UINT8, uint8_t)\n        HANDLE_TYPE(UINT16, uint16_t)\n        HANDLE_TYPE(UINT32, uint32_t)\n        HANDLE_TYPE(UINT64, uint64_t)\n        HANDLE_TYPE(FLOAT32, uint32_t)\n        HANDLE_TYPE(FLOAT64, uint64_t)\n        HANDLE_TYPE(ENUM, uint16_t)\n\n#undef HANDLE_TYPE\n\n        case schema::Type::TEXT:\n        case schema::Type::DATA:\n        case schema::Type::LIST:\n        case schema::Type::STRUCT:\n        case schema::Type::ANY_POINTER:\n        case schema::Type::INTERFACE:\n          builder.getPointerField(slot.getOffset() * POINTERS).clear();\n          return;\n      }\n\n      KJ_UNREACHABLE;\n    }\n\n    case schema::Field::GROUP: {\n      DynamicStruct::Builder group(type.asStruct(), builder);\n\n      // We clear the union field with discriminant 0 rather than the one that is set because\n      // we want the union to end up with its default field active.\n      KJ_IF_MAYBE(unionField, group.schema.getFieldByDiscriminant(0)) {\n        group.clear(*unionField);\n      }\n\n      for (auto subField: group.schema.getNonUnionFields()) {\n        group.clear(subField);\n      }\n      return;\n    }\n  }\n\n  KJ_UNREACHABLE;\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "group.clear",
          "args": [
            "subField"
          ],
          "line": 911
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "group.schema.getNonUnionFields",
          "args": [],
          "line": 910
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "group.clear",
          "args": [
            "*unionField"
          ],
          "line": 907
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_IF_MAYBE",
          "args": [
            "unionField",
            "group.schema.getFieldByDiscriminant(0)"
          ],
          "line": 906
        },
        "resolved": true,
        "details": {
          "function_name": "KJ_IF_MAYBE",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "2462-2464",
          "snippet": "KJ_IF_MAYBE(e, exception) {\n          fulfiller->get()->reject(kj::mv(*e));\n        }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nKJ_IF_MAYBE(e, exception) {\n          fulfiller->get()->reject(kj::mv(*e));\n        }"
        }
      },
      {
        "call_info": {
          "callee": "group.schema.getFieldByDiscriminant",
          "args": [
            "0"
          ],
          "line": 906
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.asStruct",
          "args": [],
          "line": 902
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerField",
          "args": [],
          "line": 894
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerField",
          "args": [
            "slot.getOffset() * POINTERS"
          ],
          "line": 894
        },
        "resolved": true,
        "details": {
          "function_name": "getPointerField",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "490-497",
          "snippet": "inline AnyPointer::Pipeline getPointerField(uint16_t pointerIndex) {\n    // Return a new Promise representing a sub-object of the result.  `pointerIndex` is the index\n    // of the sub-object within the pointer section of the result (the result must be a struct).\n    //\n    // TODO(perf):  On GCC 4.8 / Clang 3.3, use rvalue qualifiers to avoid the need for copies.\n    //   Also make `ops` into a Vector to optimize this.\n    return typeless.getPointerField(pointerIndex);\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline AnyPointer::Pipeline getPointerField(uint16_t pointerIndex) {\n    // Return a new Promise representing a sub-object of the result.  `pointerIndex` is the index\n    // of the sub-object within the pointer section of the result (the result must be a struct).\n    //\n    // TODO(perf):  On GCC 4.8 / Clang 3.3, use rvalue qualifiers to avoid the need for copies.\n    //   Also make `ops` into a Vector to optimize this.\n    return typeless.getPointerField(pointerIndex);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 894
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.setDataField<Void>",
          "args": [
            "slot.getOffset() * ELEMENTS",
            "VOID"
          ],
          "line": 865
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 865
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.which",
          "args": [],
          "line": 863
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.getSlot",
          "args": [],
          "line": 861
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.which",
          "args": [],
          "line": 859
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getType",
          "args": [],
          "line": 858
        },
        "resolved": true,
        "details": {
          "function_name": "getType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "942-942",
          "snippet": "inline DynamicValue::Type getType() { return type; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline DynamicValue::Type getType() { return type; }"
        }
      },
      {
        "call_info": {
          "callee": "field.getProto",
          "args": [],
          "line": 857
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      },
      {
        "call_info": {
          "callee": "setInUnion",
          "args": [
            "field"
          ],
          "line": 855
        },
        "resolved": true,
        "details": {
          "function_name": "DynamicStruct::Builder::setInUnion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "163-171",
          "snippet": "void DynamicStruct::Builder::setInUnion(StructSchema::Field field) {\n  // If a union member, set the discriminant to match.\n  auto proto = field.getProto();\n  if (hasDiscriminantValue(proto)) {\n    builder.setDataField<uint16_t>(\n        schema.getProto().getStruct().getDiscriminantOffset() * ELEMENTS,\n        proto.getDiscriminantValue());\n  }\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nvoid DynamicStruct::Builder::setInUnion(StructSchema::Field field) {\n  // If a union member, set the discriminant to match.\n  auto proto = field.getProto();\n  if (hasDiscriminantValue(proto)) {\n    builder.setDataField<uint16_t>(\n        schema.getProto().getStruct().getDiscriminantOffset() * ELEMENTS,\n        proto.getDiscriminantValue());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "field.getContainingStruct() == schema",
            "\"`field` is not a field of this struct.\""
          ],
          "line": 854
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getContainingStruct",
          "args": [],
          "line": 854
        },
        "resolved": true,
        "details": {
          "function_name": "getContainingStruct",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "274-274",
          "snippet": "inline StructSchema getContainingStruct() const { return parent; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline StructSchema getContainingStruct() const { return parent; }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nvoid DynamicStruct::Builder::clear(StructSchema::Field field) {\n  KJ_REQUIRE(field.getContainingStruct() == schema, \"`field` is not a field of this struct.\");\n  setInUnion(field);\n\n  auto proto = field.getProto();\n  auto type = field.getType();\n  switch (proto.which()) {\n    case schema::Field::SLOT: {\n      auto slot = proto.getSlot();\n\n      switch (type.which()) {\n        case schema::Type::VOID:\n          builder.setDataField<Void>(slot.getOffset() * ELEMENTS, VOID);\n          return;\n\n#define HANDLE_TYPE(discrim, type) \\\n        case schema::Type::discrim: \\\n          builder.setDataField<type>(slot.getOffset() * ELEMENTS, 0); \\\n          return;\n\n        HANDLE_TYPE(BOOL, bool)\n        HANDLE_TYPE(INT8, uint8_t)\n        HANDLE_TYPE(INT16, uint16_t)\n        HANDLE_TYPE(INT32, uint32_t)\n        HANDLE_TYPE(INT64, uint64_t)\n        HANDLE_TYPE(UINT8, uint8_t)\n        HANDLE_TYPE(UINT16, uint16_t)\n        HANDLE_TYPE(UINT32, uint32_t)\n        HANDLE_TYPE(UINT64, uint64_t)\n        HANDLE_TYPE(FLOAT32, uint32_t)\n        HANDLE_TYPE(FLOAT64, uint64_t)\n        HANDLE_TYPE(ENUM, uint16_t)\n\n#undef HANDLE_TYPE\n\n        case schema::Type::TEXT:\n        case schema::Type::DATA:\n        case schema::Type::LIST:\n        case schema::Type::STRUCT:\n        case schema::Type::ANY_POINTER:\n        case schema::Type::INTERFACE:\n          builder.getPointerField(slot.getOffset() * POINTERS).clear();\n          return;\n      }\n\n      KJ_UNREACHABLE;\n    }\n\n    case schema::Field::GROUP: {\n      DynamicStruct::Builder group(type.asStruct(), builder);\n\n      // We clear the union field with discriminant 0 rather than the one that is set because\n      // we want the union to end up with its default field active.\n      KJ_IF_MAYBE(unionField, group.schema.getFieldByDiscriminant(0)) {\n        group.clear(*unionField);\n      }\n\n      for (auto subField: group.schema.getNonUnionFields()) {\n        group.clear(subField);\n      }\n      return;\n    }\n  }\n\n  KJ_UNREACHABLE;\n}"
  },
  {
    "function_name": "DynamicStruct::Builder::disown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "782-851",
    "snippet": "Orphan<DynamicValue> DynamicStruct::Builder::disown(StructSchema::Field field) {\n  // We end up calling get(field) below, so we don't need to validate `field` here.\n\n  auto proto = field.getProto();\n  switch (proto.which()) {\n    case schema::Field::SLOT: {\n      auto slot = proto.getSlot();\n\n      switch (field.getType().which()) {\n        case schema::Type::VOID:\n        case schema::Type::BOOL:\n        case schema::Type::INT8:\n        case schema::Type::INT16:\n        case schema::Type::INT32:\n        case schema::Type::INT64:\n        case schema::Type::UINT8:\n        case schema::Type::UINT16:\n        case schema::Type::UINT32:\n        case schema::Type::UINT64:\n        case schema::Type::FLOAT32:\n        case schema::Type::FLOAT64:\n        case schema::Type::ENUM: {\n          auto result = Orphan<DynamicValue>(get(field), _::OrphanBuilder());\n          clear(field);\n          return kj::mv(result);\n        }\n\n        case schema::Type::TEXT:\n        case schema::Type::DATA:\n        case schema::Type::LIST:\n        case schema::Type::STRUCT:\n        case schema::Type::ANY_POINTER:\n        case schema::Type::INTERFACE: {\n          auto value = get(field);\n          return Orphan<DynamicValue>(\n              value, builder.getPointerField(slot.getOffset() * POINTERS).disown());\n        }\n      }\n      KJ_UNREACHABLE;\n    }\n\n    case schema::Field::GROUP: {\n      // We have to allocate new space for the group, unfortunately.\n      auto src = get(field).as<DynamicStruct>();\n\n      Orphan<DynamicStruct> result =\n          Orphanage::getForMessageContaining(*this).newOrphan(src.getSchema());\n      auto dst = result.get();\n\n      KJ_IF_MAYBE(unionField, src.which()) {\n        dst.adopt(*unionField, src.disown(*unionField));\n      }\n\n      // We need to explicitly reset the union to its default field.\n      KJ_IF_MAYBE(unionField, src.schema.getFieldByDiscriminant(0)) {\n        src.clear(*unionField);\n      }\n\n      for (auto field: src.schema.getNonUnionFields()) {\n        if (src.has(field)) {\n          dst.adopt(field, src.disown(field));\n        }\n      }\n\n      return kj::mv(result);\n    }\n  }\n\n  KJ_UNREACHABLE;\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "result"
          ],
          "line": 846
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dst.adopt",
          "args": [
            "field",
            "src.disown(field)"
          ],
          "line": 842
        },
        "resolved": true,
        "details": {
          "function_name": "adopt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "1110-1112",
          "snippet": "static inline void adopt(PointerBuilder builder, Orphan<DynamicCapability>&& value) {\n    builder.adopt(kj::mv(value.builder));\n  }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nstatic inline void adopt(PointerBuilder builder, Orphan<DynamicCapability>&& value) {\n    builder.adopt(kj::mv(value.builder));\n  }"
        }
      },
      {
        "call_info": {
          "callee": "src.disown",
          "args": [
            "field"
          ],
          "line": 842
        },
        "resolved": true,
        "details": {
          "function_name": "disown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "831-833",
          "snippet": "static inline Orphan<AnyPointer> disown(PointerBuilder builder) {\n    return Orphan<AnyPointer>(builder.disown());\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline Orphan<AnyPointer> disown(PointerBuilder builder) {\n    return Orphan<AnyPointer>(builder.disown());\n  }"
        }
      },
      {
        "call_info": {
          "callee": "src.has",
          "args": [
            "field"
          ],
          "line": 841
        },
        "resolved": true,
        "details": {
          "function_name": "has",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "253-253",
          "snippet": "inline bool has(StructSchema::Field field) { return asReader().has(field); }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline bool has(StructSchema::Field field) { return asReader().has(field); }"
        }
      },
      {
        "call_info": {
          "callee": "src.schema.getNonUnionFields",
          "args": [],
          "line": 840
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "src.clear",
          "args": [
            "*unionField"
          ],
          "line": 837
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_IF_MAYBE",
          "args": [
            "unionField",
            "src.schema.getFieldByDiscriminant(0)"
          ],
          "line": 836
        },
        "resolved": true,
        "details": {
          "function_name": "KJ_IF_MAYBE",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "2462-2464",
          "snippet": "KJ_IF_MAYBE(e, exception) {\n          fulfiller->get()->reject(kj::mv(*e));\n        }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nKJ_IF_MAYBE(e, exception) {\n          fulfiller->get()->reject(kj::mv(*e));\n        }"
        }
      },
      {
        "call_info": {
          "callee": "src.schema.getFieldByDiscriminant",
          "args": [
            "0"
          ],
          "line": 836
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "src.which",
          "args": [],
          "line": 831
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result.get",
          "args": [],
          "line": 829
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Orphanage::getForMessageContaining",
          "args": [
            "src.getSchema()"
          ],
          "line": 828
        },
        "resolved": true,
        "details": {
          "function_name": "Orphanage::getForMessageContaining",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan.h",
          "lines": "279-281",
          "snippet": "Orphanage Orphanage::getForMessageContaining(BuilderType builder) {\n  return Orphanage(GetInnerBuilder<FromBuilder<BuilderType>>::apply(builder).getArena());\n}",
          "includes": [
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"layout.h\"\n\nOrphanage Orphanage::getForMessageContaining(BuilderType builder) {\n  return Orphanage(GetInnerBuilder<FromBuilder<BuilderType>>::apply(builder).getArena());\n}"
        }
      },
      {
        "call_info": {
          "callee": "src.getSchema",
          "args": [],
          "line": 828
        },
        "resolved": true,
        "details": {
          "function_name": "getSchema",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "505-505",
          "snippet": "inline InterfaceSchema getSchema() const { return schema; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline InterfaceSchema getSchema() const { return schema; }"
        }
      },
      {
        "call_info": {
          "callee": "get",
          "args": [],
          "line": 825
        },
        "resolved": true,
        "details": {
          "function_name": "Orphan<DynamicValue>::get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "2005-2035",
          "snippet": "DynamicValue::Builder Orphan<DynamicValue>::get() {\n  switch (type) {\n    case DynamicValue::UNKNOWN: return nullptr;\n    case DynamicValue::VOID: return voidValue;\n    case DynamicValue::BOOL: return boolValue;\n    case DynamicValue::INT: return intValue;\n    case DynamicValue::UINT: return uintValue;\n    case DynamicValue::FLOAT: return floatValue;\n    case DynamicValue::ENUM: return enumValue;\n\n    case DynamicValue::TEXT: return builder.asText();\n    case DynamicValue::DATA: return builder.asData();\n    case DynamicValue::LIST:\n      if (listSchema.whichElementType() == schema::Type::STRUCT) {\n        return DynamicList::Builder(listSchema,\n            builder.asStructList(structSizeFromSchema(listSchema.getStructElementType())));\n      } else {\n        return DynamicList::Builder(listSchema,\n            builder.asList(elementSizeFor(listSchema.whichElementType())));\n      }\n    case DynamicValue::STRUCT:\n      return DynamicStruct::Builder(structSchema,\n          builder.asStruct(structSizeFromSchema(structSchema)));\n    case DynamicValue::CAPABILITY:\n      return DynamicCapability::Client(interfaceSchema, builder.asCapability());\n    case DynamicValue::ANY_POINTER:\n      KJ_FAIL_REQUIRE(\"Can't get() an AnyPointer orphan; there is no underlying pointer to \"\n                      \"wrap in an AnyPointer::Builder.\");\n  }\n  KJ_UNREACHABLE;\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicValue::Builder Orphan<DynamicValue>::get() {\n  switch (type) {\n    case DynamicValue::UNKNOWN: return nullptr;\n    case DynamicValue::VOID: return voidValue;\n    case DynamicValue::BOOL: return boolValue;\n    case DynamicValue::INT: return intValue;\n    case DynamicValue::UINT: return uintValue;\n    case DynamicValue::FLOAT: return floatValue;\n    case DynamicValue::ENUM: return enumValue;\n\n    case DynamicValue::TEXT: return builder.asText();\n    case DynamicValue::DATA: return builder.asData();\n    case DynamicValue::LIST:\n      if (listSchema.whichElementType() == schema::Type::STRUCT) {\n        return DynamicList::Builder(listSchema,\n            builder.asStructList(structSizeFromSchema(listSchema.getStructElementType())));\n      } else {\n        return DynamicList::Builder(listSchema,\n            builder.asList(elementSizeFor(listSchema.whichElementType())));\n      }\n    case DynamicValue::STRUCT:\n      return DynamicStruct::Builder(structSchema,\n          builder.asStruct(structSizeFromSchema(structSchema)));\n    case DynamicValue::CAPABILITY:\n      return DynamicCapability::Client(interfaceSchema, builder.asCapability());\n    case DynamicValue::ANY_POINTER:\n      KJ_FAIL_REQUIRE(\"Can't get() an AnyPointer orphan; there is no underlying pointer to \"\n                      \"wrap in an AnyPointer::Builder.\");\n  }\n  KJ_UNREACHABLE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get",
          "args": [
            "field"
          ],
          "line": 825
        },
        "resolved": true,
        "details": {
          "function_name": "DynamicStruct::Pipeline::get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "926-928",
          "snippet": "DynamicValue::Pipeline DynamicStruct::Pipeline::get(kj::StringPtr name) {\n  return get(schema.getFieldByName(name));\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicValue::Pipeline DynamicStruct::Pipeline::get(kj::StringPtr name) {\n  return get(schema.getFieldByName(name));\n}"
        }
      },
      {
        "call_info": {
          "callee": "Orphan<DynamicValue>",
          "args": [
            "value",
            "builder.getPointerField(slot.getOffset() * POINTERS).disown()"
          ],
          "line": 816
        },
        "resolved": true,
        "details": {
          "function_name": "Orphan<DynamicValue>::Orphan",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "1985-2003",
          "snippet": "Orphan<DynamicValue>::Orphan(DynamicValue::Builder value, _::OrphanBuilder&& builder)\n    : type(value.getType()), builder(kj::mv(builder)) {\n  switch (type) {\n    case DynamicValue::UNKNOWN: break;\n    case DynamicValue::VOID: voidValue = value.voidValue; break;\n    case DynamicValue::BOOL: boolValue = value.boolValue; break;\n    case DynamicValue::INT: intValue = value.intValue; break;\n    case DynamicValue::UINT: uintValue = value.uintValue; break;\n    case DynamicValue::FLOAT: floatValue = value.floatValue; break;\n    case DynamicValue::ENUM: enumValue = value.enumValue; break;\n\n    case DynamicValue::TEXT: break;\n    case DynamicValue::DATA: break;\n    case DynamicValue::LIST: listSchema = value.listValue.getSchema(); break;\n    case DynamicValue::STRUCT: structSchema = value.structValue.getSchema(); break;\n    case DynamicValue::CAPABILITY: interfaceSchema = value.capabilityValue.getSchema(); break;\n    case DynamicValue::ANY_POINTER: break;\n  }\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nOrphan<DynamicValue>::Orphan(DynamicValue::Builder value, _::OrphanBuilder&& builder)\n    : type(value.getType()), builder(kj::mv(builder)) {\n  switch (type) {\n    case DynamicValue::UNKNOWN: break;\n    case DynamicValue::VOID: voidValue = value.voidValue; break;\n    case DynamicValue::BOOL: boolValue = value.boolValue; break;\n    case DynamicValue::INT: intValue = value.intValue; break;\n    case DynamicValue::UINT: uintValue = value.uintValue; break;\n    case DynamicValue::FLOAT: floatValue = value.floatValue; break;\n    case DynamicValue::ENUM: enumValue = value.enumValue; break;\n\n    case DynamicValue::TEXT: break;\n    case DynamicValue::DATA: break;\n    case DynamicValue::LIST: listSchema = value.listValue.getSchema(); break;\n    case DynamicValue::STRUCT: structSchema = value.structValue.getSchema(); break;\n    case DynamicValue::CAPABILITY: interfaceSchema = value.capabilityValue.getSchema(); break;\n    case DynamicValue::ANY_POINTER: break;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "builder.getPointerField",
          "args": [],
          "line": 817
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerField",
          "args": [
            "slot.getOffset() * POINTERS"
          ],
          "line": 817
        },
        "resolved": true,
        "details": {
          "function_name": "getPointerField",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "490-497",
          "snippet": "inline AnyPointer::Pipeline getPointerField(uint16_t pointerIndex) {\n    // Return a new Promise representing a sub-object of the result.  `pointerIndex` is the index\n    // of the sub-object within the pointer section of the result (the result must be a struct).\n    //\n    // TODO(perf):  On GCC 4.8 / Clang 3.3, use rvalue qualifiers to avoid the need for copies.\n    //   Also make `ops` into a Vector to optimize this.\n    return typeless.getPointerField(pointerIndex);\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline AnyPointer::Pipeline getPointerField(uint16_t pointerIndex) {\n    // Return a new Promise representing a sub-object of the result.  `pointerIndex` is the index\n    // of the sub-object within the pointer section of the result (the result must be a struct).\n    //\n    // TODO(perf):  On GCC 4.8 / Clang 3.3, use rvalue qualifiers to avoid the need for copies.\n    //   Also make `ops` into a Vector to optimize this.\n    return typeless.getPointerField(pointerIndex);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 817
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "result"
          ],
          "line": 806
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear",
          "args": [
            "field"
          ],
          "line": 805
        },
        "resolved": true,
        "details": {
          "function_name": "DynamicStruct::Builder::clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "958-960",
          "snippet": "void DynamicStruct::Builder::clear(kj::StringPtr name) {\n  clear(schema.getFieldByName(name));\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nvoid DynamicStruct::Builder::clear(kj::StringPtr name) {\n  clear(schema.getFieldByName(name));\n}"
        }
      },
      {
        "call_info": {
          "callee": "_::OrphanBuilder",
          "args": [],
          "line": 804
        },
        "resolved": true,
        "details": {
          "function_name": "OrphanBuilder",
          "container": "OrphanBuilder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/layout.h",
          "lines": "709-709",
          "snippet": "inline OrphanBuilder(): segment(nullptr), location(nullptr) { memset(&tag, 0, sizeof(tag)); }",
          "includes": [
            "#include \"endian.h\"",
            "#include \"blob.h\"",
            "#include \"common.h\"",
            "#include <kj/memory.h>",
            "#include <kj/common.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"endian.h\"\n#include \"blob.h\"\n#include \"common.h\"\n#include <kj/memory.h>\n#include <kj/common.h>\n\nOrphanBuilder {\n  inline OrphanBuilder(): segment(nullptr), location(nullptr) { memset(&tag, 0, sizeof(tag)); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "field.getType",
          "args": [],
          "line": 790
        },
        "resolved": true,
        "details": {
          "function_name": "getType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "942-942",
          "snippet": "inline DynamicValue::Type getType() { return type; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline DynamicValue::Type getType() { return type; }"
        }
      },
      {
        "call_info": {
          "callee": "proto.getSlot",
          "args": [],
          "line": 788
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.which",
          "args": [],
          "line": 786
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getProto",
          "args": [],
          "line": 785
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nOrphan<DynamicValue> DynamicStruct::Builder::disown(StructSchema::Field field) {\n  // We end up calling get(field) below, so we don't need to validate `field` here.\n\n  auto proto = field.getProto();\n  switch (proto.which()) {\n    case schema::Field::SLOT: {\n      auto slot = proto.getSlot();\n\n      switch (field.getType().which()) {\n        case schema::Type::VOID:\n        case schema::Type::BOOL:\n        case schema::Type::INT8:\n        case schema::Type::INT16:\n        case schema::Type::INT32:\n        case schema::Type::INT64:\n        case schema::Type::UINT8:\n        case schema::Type::UINT16:\n        case schema::Type::UINT32:\n        case schema::Type::UINT64:\n        case schema::Type::FLOAT32:\n        case schema::Type::FLOAT64:\n        case schema::Type::ENUM: {\n          auto result = Orphan<DynamicValue>(get(field), _::OrphanBuilder());\n          clear(field);\n          return kj::mv(result);\n        }\n\n        case schema::Type::TEXT:\n        case schema::Type::DATA:\n        case schema::Type::LIST:\n        case schema::Type::STRUCT:\n        case schema::Type::ANY_POINTER:\n        case schema::Type::INTERFACE: {\n          auto value = get(field);\n          return Orphan<DynamicValue>(\n              value, builder.getPointerField(slot.getOffset() * POINTERS).disown());\n        }\n      }\n      KJ_UNREACHABLE;\n    }\n\n    case schema::Field::GROUP: {\n      // We have to allocate new space for the group, unfortunately.\n      auto src = get(field).as<DynamicStruct>();\n\n      Orphan<DynamicStruct> result =\n          Orphanage::getForMessageContaining(*this).newOrphan(src.getSchema());\n      auto dst = result.get();\n\n      KJ_IF_MAYBE(unionField, src.which()) {\n        dst.adopt(*unionField, src.disown(*unionField));\n      }\n\n      // We need to explicitly reset the union to its default field.\n      KJ_IF_MAYBE(unionField, src.schema.getFieldByDiscriminant(0)) {\n        src.clear(*unionField);\n      }\n\n      for (auto field: src.schema.getNonUnionFields()) {\n        if (src.has(field)) {\n          dst.adopt(field, src.disown(field));\n        }\n      }\n\n      return kj::mv(result);\n    }\n  }\n\n  KJ_UNREACHABLE;\n}"
  },
  {
    "function_name": "DynamicStruct::Builder::adopt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "680-780",
    "snippet": "void DynamicStruct::Builder::adopt(StructSchema::Field field, Orphan<DynamicValue>&& orphan) {\n  KJ_REQUIRE(field.getContainingStruct() == schema, \"`field` is not a field of this struct.\");\n  setInUnion(field);\n\n  auto proto = field.getProto();\n  switch (proto.which()) {\n    case schema::Field::SLOT: {\n      auto slot = proto.getSlot();\n      auto type = field.getType();\n\n      switch (type.which()) {\n        case schema::Type::VOID:\n        case schema::Type::BOOL:\n        case schema::Type::INT8:\n        case schema::Type::INT16:\n        case schema::Type::INT32:\n        case schema::Type::INT64:\n        case schema::Type::UINT8:\n        case schema::Type::UINT16:\n        case schema::Type::UINT32:\n        case schema::Type::UINT64:\n        case schema::Type::FLOAT32:\n        case schema::Type::FLOAT64:\n        case schema::Type::ENUM:\n          set(field, orphan.getReader());\n          return;\n\n        case schema::Type::TEXT:\n          KJ_REQUIRE(orphan.getType() == DynamicValue::TEXT, \"Value type mismatch.\");\n          break;\n\n        case schema::Type::DATA:\n          KJ_REQUIRE(orphan.getType() == DynamicValue::DATA, \"Value type mismatch.\");\n          break;\n\n        case schema::Type::LIST: {\n          ListSchema listType = type.asList();\n          KJ_REQUIRE(orphan.getType() == DynamicValue::LIST && orphan.listSchema == listType,\n                     \"Value type mismatch.\") {\n            return;\n          }\n          break;\n        }\n\n        case schema::Type::STRUCT: {\n          auto structType = type.asStruct();\n          KJ_REQUIRE(orphan.getType() == DynamicValue::STRUCT && orphan.structSchema == structType,\n                     \"Value type mismatch.\") {\n            return;\n          }\n          break;\n        }\n\n        case schema::Type::ANY_POINTER:\n          KJ_REQUIRE(orphan.getType() == DynamicValue::STRUCT ||\n                     orphan.getType() == DynamicValue::LIST ||\n                     orphan.getType() == DynamicValue::TEXT ||\n                     orphan.getType() == DynamicValue::DATA ||\n                     orphan.getType() == DynamicValue::ANY_POINTER,\n                     \"Value type mismatch.\") {\n            return;\n          }\n          break;\n\n        case schema::Type::INTERFACE:\n          auto interfaceType = type.asInterface();\n          KJ_REQUIRE(orphan.getType() == DynamicValue::CAPABILITY &&\n                     orphan.interfaceSchema.extends(interfaceType),\n                     \"Value type mismatch.\") {\n            return;\n          }\n          break;\n      }\n\n      builder.getPointerField(slot.getOffset() * POINTERS).adopt(kj::mv(orphan.builder));\n      return;\n    }\n\n    case schema::Field::GROUP:\n      // Have to transfer fields.\n      auto src = orphan.get().as<DynamicStruct>();\n      auto dst = init(field).as<DynamicStruct>();\n\n      KJ_REQUIRE(orphan.getType() == DynamicValue::STRUCT && orphan.structSchema == dst.getSchema(),\n                 \"Value type mismatch.\");\n\n      KJ_IF_MAYBE(unionField, src.which()) {\n        dst.adopt(*unionField, src.disown(*unionField));\n      }\n\n      for (auto field: src.schema.getNonUnionFields()) {\n        if (src.has(field)) {\n          dst.adopt(field, src.disown(field));\n        }\n      }\n\n      return;\n  }\n\n  KJ_UNREACHABLE;\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dst.adopt",
          "args": [
            "field",
            "src.disown(field)"
          ],
          "line": 772
        },
        "resolved": true,
        "details": {
          "function_name": "adopt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "1110-1112",
          "snippet": "static inline void adopt(PointerBuilder builder, Orphan<DynamicCapability>&& value) {\n    builder.adopt(kj::mv(value.builder));\n  }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nstatic inline void adopt(PointerBuilder builder, Orphan<DynamicCapability>&& value) {\n    builder.adopt(kj::mv(value.builder));\n  }"
        }
      },
      {
        "call_info": {
          "callee": "src.disown",
          "args": [
            "field"
          ],
          "line": 772
        },
        "resolved": true,
        "details": {
          "function_name": "disown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "831-833",
          "snippet": "static inline Orphan<AnyPointer> disown(PointerBuilder builder) {\n    return Orphan<AnyPointer>(builder.disown());\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline Orphan<AnyPointer> disown(PointerBuilder builder) {\n    return Orphan<AnyPointer>(builder.disown());\n  }"
        }
      },
      {
        "call_info": {
          "callee": "src.has",
          "args": [
            "field"
          ],
          "line": 771
        },
        "resolved": true,
        "details": {
          "function_name": "has",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "253-253",
          "snippet": "inline bool has(StructSchema::Field field) { return asReader().has(field); }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline bool has(StructSchema::Field field) { return asReader().has(field); }"
        }
      },
      {
        "call_info": {
          "callee": "src.schema.getNonUnionFields",
          "args": [],
          "line": 770
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_IF_MAYBE",
          "args": [
            "unionField",
            "src.which()"
          ],
          "line": 766
        },
        "resolved": true,
        "details": {
          "function_name": "KJ_IF_MAYBE",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "2462-2464",
          "snippet": "KJ_IF_MAYBE(e, exception) {\n          fulfiller->get()->reject(kj::mv(*e));\n        }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nKJ_IF_MAYBE(e, exception) {\n          fulfiller->get()->reject(kj::mv(*e));\n        }"
        }
      },
      {
        "call_info": {
          "callee": "src.which",
          "args": [],
          "line": 766
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "orphan.getType() == DynamicValue::STRUCT && orphan.structSchema == dst.getSchema()",
            "\"Value type mismatch.\""
          ],
          "line": 763
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dst.getSchema",
          "args": [],
          "line": 763
        },
        "resolved": true,
        "details": {
          "function_name": "getSchema",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "505-505",
          "snippet": "inline InterfaceSchema getSchema() const { return schema; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline InterfaceSchema getSchema() const { return schema; }"
        }
      },
      {
        "call_info": {
          "callee": "orphan.getType",
          "args": [],
          "line": 763
        },
        "resolved": true,
        "details": {
          "function_name": "getType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "942-942",
          "snippet": "inline DynamicValue::Type getType() { return type; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline DynamicValue::Type getType() { return type; }"
        }
      },
      {
        "call_info": {
          "callee": "init",
          "args": [],
          "line": 761
        },
        "resolved": true,
        "details": {
          "function_name": "init",
          "container": "OneOf",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/one-of.h",
          "lines": "77-81",
          "snippet": "void init(Params&&... params) {\n    if (tag != 0) destroy();\n    ctor(*reinterpret_cast<T*>(space), kj::fwd<Params>(params)...);\n    tag = typeIndex<T>();\n  }",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nOneOf {\n  void init(Params&&... params) {\n      if (tag != 0) destroy();\n      ctor(*reinterpret_cast<T*>(space), kj::fwd<Params>(params)...);\n      tag = typeIndex<T>();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "init",
          "args": [
            "field"
          ],
          "line": 761
        },
        "resolved": true,
        "details": {
          "function_name": "DynamicStruct::Builder::init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "946-948",
          "snippet": "DynamicValue::Builder DynamicStruct::Builder::init(kj::StringPtr name) {\n  return init(schema.getFieldByName(name));\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicValue::Builder DynamicStruct::Builder::init(kj::StringPtr name) {\n  return init(schema.getFieldByName(name));\n}"
        }
      },
      {
        "call_info": {
          "callee": "orphan.get",
          "args": [],
          "line": 760
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "builder.getPointerField",
          "args": [
            "kj::mv(orphan.builder)"
          ],
          "line": 754
        },
        "resolved": true,
        "details": {
          "function_name": "getPointerField",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "490-497",
          "snippet": "inline AnyPointer::Pipeline getPointerField(uint16_t pointerIndex) {\n    // Return a new Promise representing a sub-object of the result.  `pointerIndex` is the index\n    // of the sub-object within the pointer section of the result (the result must be a struct).\n    //\n    // TODO(perf):  On GCC 4.8 / Clang 3.3, use rvalue qualifiers to avoid the need for copies.\n    //   Also make `ops` into a Vector to optimize this.\n    return typeless.getPointerField(pointerIndex);\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline AnyPointer::Pipeline getPointerField(uint16_t pointerIndex) {\n    // Return a new Promise representing a sub-object of the result.  `pointerIndex` is the index\n    // of the sub-object within the pointer section of the result (the result must be a struct).\n    //\n    // TODO(perf):  On GCC 4.8 / Clang 3.3, use rvalue qualifiers to avoid the need for copies.\n    //   Also make `ops` into a Vector to optimize this.\n    return typeless.getPointerField(pointerIndex);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "orphan.builder"
          ],
          "line": 754
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 754
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "orphan.getType() == DynamicValue::CAPABILITY &&\n                     orphan.interfaceSchema.extends(interfaceType)",
            "\"Value type mismatch.\""
          ],
          "line": 746
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.interfaceSchema.extends",
          "args": [
            "interfaceType"
          ],
          "line": 747
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.asInterface",
          "args": [],
          "line": 745
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "orphan.getType() == DynamicValue::STRUCT ||\n                     orphan.getType() == DynamicValue::LIST ||\n                     orphan.getType() == DynamicValue::TEXT ||\n                     orphan.getType() == DynamicValue::DATA ||\n                     orphan.getType() == DynamicValue::ANY_POINTER",
            "\"Value type mismatch.\""
          ],
          "line": 734
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "orphan.getType() == DynamicValue::STRUCT && orphan.structSchema == structType",
            "\"Value type mismatch.\""
          ],
          "line": 726
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.asStruct",
          "args": [],
          "line": 725
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "orphan.getType() == DynamicValue::LIST && orphan.listSchema == listType",
            "\"Value type mismatch.\""
          ],
          "line": 717
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.asList",
          "args": [],
          "line": 716
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "orphan.getType() == DynamicValue::DATA",
            "\"Value type mismatch.\""
          ],
          "line": 712
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "orphan.getType() == DynamicValue::TEXT",
            "\"Value type mismatch.\""
          ],
          "line": 708
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set",
          "args": [
            "field",
            "orphan.getReader()"
          ],
          "line": 704
        },
        "resolved": true,
        "details": {
          "function_name": "PointerHelpers<DynamicCapability, Kind::OTHER>::set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "1860-1863",
          "snippet": "void PointerHelpers<DynamicCapability, Kind::OTHER>::set(\n    PointerBuilder builder, DynamicCapability::Client&& value) {\n  builder.setCapability(kj::mv(value.hook));\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nvoid PointerHelpers<DynamicCapability, Kind::OTHER>::set(\n    PointerBuilder builder, DynamicCapability::Client&& value) {\n  builder.setCapability(kj::mv(value.hook));\n}"
        }
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 704
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.which",
          "args": [],
          "line": 690
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.getSlot",
          "args": [],
          "line": 687
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.which",
          "args": [],
          "line": 685
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getProto",
          "args": [],
          "line": 684
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      },
      {
        "call_info": {
          "callee": "setInUnion",
          "args": [
            "field"
          ],
          "line": 682
        },
        "resolved": true,
        "details": {
          "function_name": "DynamicStruct::Builder::setInUnion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "163-171",
          "snippet": "void DynamicStruct::Builder::setInUnion(StructSchema::Field field) {\n  // If a union member, set the discriminant to match.\n  auto proto = field.getProto();\n  if (hasDiscriminantValue(proto)) {\n    builder.setDataField<uint16_t>(\n        schema.getProto().getStruct().getDiscriminantOffset() * ELEMENTS,\n        proto.getDiscriminantValue());\n  }\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nvoid DynamicStruct::Builder::setInUnion(StructSchema::Field field) {\n  // If a union member, set the discriminant to match.\n  auto proto = field.getProto();\n  if (hasDiscriminantValue(proto)) {\n    builder.setDataField<uint16_t>(\n        schema.getProto().getStruct().getDiscriminantOffset() * ELEMENTS,\n        proto.getDiscriminantValue());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "field.getContainingStruct() == schema",
            "\"`field` is not a field of this struct.\""
          ],
          "line": 681
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getContainingStruct",
          "args": [],
          "line": 681
        },
        "resolved": true,
        "details": {
          "function_name": "getContainingStruct",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "274-274",
          "snippet": "inline StructSchema getContainingStruct() const { return parent; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline StructSchema getContainingStruct() const { return parent; }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nvoid DynamicStruct::Builder::adopt(StructSchema::Field field, Orphan<DynamicValue>&& orphan) {\n  KJ_REQUIRE(field.getContainingStruct() == schema, \"`field` is not a field of this struct.\");\n  setInUnion(field);\n\n  auto proto = field.getProto();\n  switch (proto.which()) {\n    case schema::Field::SLOT: {\n      auto slot = proto.getSlot();\n      auto type = field.getType();\n\n      switch (type.which()) {\n        case schema::Type::VOID:\n        case schema::Type::BOOL:\n        case schema::Type::INT8:\n        case schema::Type::INT16:\n        case schema::Type::INT32:\n        case schema::Type::INT64:\n        case schema::Type::UINT8:\n        case schema::Type::UINT16:\n        case schema::Type::UINT32:\n        case schema::Type::UINT64:\n        case schema::Type::FLOAT32:\n        case schema::Type::FLOAT64:\n        case schema::Type::ENUM:\n          set(field, orphan.getReader());\n          return;\n\n        case schema::Type::TEXT:\n          KJ_REQUIRE(orphan.getType() == DynamicValue::TEXT, \"Value type mismatch.\");\n          break;\n\n        case schema::Type::DATA:\n          KJ_REQUIRE(orphan.getType() == DynamicValue::DATA, \"Value type mismatch.\");\n          break;\n\n        case schema::Type::LIST: {\n          ListSchema listType = type.asList();\n          KJ_REQUIRE(orphan.getType() == DynamicValue::LIST && orphan.listSchema == listType,\n                     \"Value type mismatch.\") {\n            return;\n          }\n          break;\n        }\n\n        case schema::Type::STRUCT: {\n          auto structType = type.asStruct();\n          KJ_REQUIRE(orphan.getType() == DynamicValue::STRUCT && orphan.structSchema == structType,\n                     \"Value type mismatch.\") {\n            return;\n          }\n          break;\n        }\n\n        case schema::Type::ANY_POINTER:\n          KJ_REQUIRE(orphan.getType() == DynamicValue::STRUCT ||\n                     orphan.getType() == DynamicValue::LIST ||\n                     orphan.getType() == DynamicValue::TEXT ||\n                     orphan.getType() == DynamicValue::DATA ||\n                     orphan.getType() == DynamicValue::ANY_POINTER,\n                     \"Value type mismatch.\") {\n            return;\n          }\n          break;\n\n        case schema::Type::INTERFACE:\n          auto interfaceType = type.asInterface();\n          KJ_REQUIRE(orphan.getType() == DynamicValue::CAPABILITY &&\n                     orphan.interfaceSchema.extends(interfaceType),\n                     \"Value type mismatch.\") {\n            return;\n          }\n          break;\n      }\n\n      builder.getPointerField(slot.getOffset() * POINTERS).adopt(kj::mv(orphan.builder));\n      return;\n    }\n\n    case schema::Field::GROUP:\n      // Have to transfer fields.\n      auto src = orphan.get().as<DynamicStruct>();\n      auto dst = init(field).as<DynamicStruct>();\n\n      KJ_REQUIRE(orphan.getType() == DynamicValue::STRUCT && orphan.structSchema == dst.getSchema(),\n                 \"Value type mismatch.\");\n\n      KJ_IF_MAYBE(unionField, src.which()) {\n        dst.adopt(*unionField, src.disown(*unionField));\n      }\n\n      for (auto field: src.schema.getNonUnionFields()) {\n        if (src.has(field)) {\n          dst.adopt(field, src.disown(field));\n        }\n      }\n\n      return;\n  }\n\n  KJ_UNREACHABLE;\n}"
  },
  {
    "function_name": "DynamicStruct::Builder::init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "635-678",
    "snippet": "DynamicValue::Builder DynamicStruct::Builder::init(StructSchema::Field field, uint size) {\n  KJ_REQUIRE(field.getContainingStruct() == schema, \"`field` is not a field of this struct.\");\n  setInUnion(field);\n\n  auto proto = field.getProto();\n  auto type = field.getType();\n\n  switch (proto.which()) {\n    case schema::Field::SLOT: {\n      auto slot = proto.getSlot();\n      switch (type.which()) {\n        case schema::Type::LIST: {\n          auto listType = type.asList();\n          if (listType.whichElementType() == schema::Type::STRUCT) {\n            return DynamicList::Builder(listType,\n                builder.getPointerField(slot.getOffset() * POINTERS)\n                       .initStructList(size * ELEMENTS,\n                                       structSizeFromSchema(listType.getStructElementType())));\n          } else {\n            return DynamicList::Builder(listType,\n                builder.getPointerField(slot.getOffset() * POINTERS)\n                       .initList(elementSizeFor(listType.whichElementType()), size * ELEMENTS));\n          }\n        }\n        case schema::Type::TEXT:\n          return builder.getPointerField(slot.getOffset() * POINTERS)\n                        .initBlob<Text>(size * BYTES);\n        case schema::Type::DATA:\n          return builder.getPointerField(slot.getOffset() * POINTERS)\n                        .initBlob<Data>(size * BYTES);\n        default:\n          KJ_FAIL_REQUIRE(\n              \"init() with size is only valid for list, text, or data fields.\",\n              (uint)type.which());\n          break;\n      }\n    }\n\n    case schema::Field::GROUP:\n      KJ_FAIL_REQUIRE(\"init() with size is only valid for list, text, or data fields.\");\n  }\n\n  KJ_UNREACHABLE;\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "KJ_FAIL_REQUIRE",
          "args": [
            "\"init() with size is only valid for list, text, or data fields.\""
          ],
          "line": 674
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_FAIL_REQUIRE",
          "args": [
            "\"init() with size is only valid for list, text, or data fields.\"",
            "(uint)type.which()"
          ],
          "line": 666
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.which",
          "args": [],
          "line": 668
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerField",
          "args": [
            "size * BYTES"
          ],
          "line": 663
        },
        "resolved": true,
        "details": {
          "function_name": "getPointerField",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "490-497",
          "snippet": "inline AnyPointer::Pipeline getPointerField(uint16_t pointerIndex) {\n    // Return a new Promise representing a sub-object of the result.  `pointerIndex` is the index\n    // of the sub-object within the pointer section of the result (the result must be a struct).\n    //\n    // TODO(perf):  On GCC 4.8 / Clang 3.3, use rvalue qualifiers to avoid the need for copies.\n    //   Also make `ops` into a Vector to optimize this.\n    return typeless.getPointerField(pointerIndex);\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline AnyPointer::Pipeline getPointerField(uint16_t pointerIndex) {\n    // Return a new Promise representing a sub-object of the result.  `pointerIndex` is the index\n    // of the sub-object within the pointer section of the result (the result must be a struct).\n    //\n    // TODO(perf):  On GCC 4.8 / Clang 3.3, use rvalue qualifiers to avoid the need for copies.\n    //   Also make `ops` into a Vector to optimize this.\n    return typeless.getPointerField(pointerIndex);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 663
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DynamicList::Builder",
          "args": [
            "listType",
            "builder.getPointerField(slot.getOffset() * POINTERS)\n                       .initList(elementSizeFor(listType.whichElementType()), size * ELEMENTS)"
          ],
          "line": 654
        },
        "resolved": true,
        "details": {
          "function_name": "Builder",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "427-427",
          "snippet": "Builder(ListSchema schema, _::ListBuilder builder): schema(schema), builder(builder) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nBuilder(ListSchema schema, _::ListBuilder builder): schema(schema), builder(builder) {}"
        }
      },
      {
        "call_info": {
          "callee": "builder.getPointerField",
          "args": [
            "elementSizeFor(listType.whichElementType())",
            "size * ELEMENTS"
          ],
          "line": 655
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elementSizeFor",
          "args": [
            "listType.whichElementType()"
          ],
          "line": 656
        },
        "resolved": true,
        "details": {
          "function_name": "elementSizeFor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "70-96",
          "snippet": "ElementSize elementSizeFor(schema::Type::Which elementType) {\n  switch (elementType) {\n    case schema::Type::VOID: return ElementSize::VOID;\n    case schema::Type::BOOL: return ElementSize::BIT;\n    case schema::Type::INT8: return ElementSize::BYTE;\n    case schema::Type::INT16: return ElementSize::TWO_BYTES;\n    case schema::Type::INT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::INT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::UINT8: return ElementSize::BYTE;\n    case schema::Type::UINT16: return ElementSize::TWO_BYTES;\n    case schema::Type::UINT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::UINT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::FLOAT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::FLOAT64: return ElementSize::EIGHT_BYTES;\n\n    case schema::Type::TEXT: return ElementSize::POINTER;\n    case schema::Type::DATA: return ElementSize::POINTER;\n    case schema::Type::LIST: return ElementSize::POINTER;\n    case schema::Type::ENUM: return ElementSize::TWO_BYTES;\n    case schema::Type::STRUCT: return ElementSize::INLINE_COMPOSITE;\n    case schema::Type::INTERFACE: return ElementSize::POINTER;\n    case schema::Type::ANY_POINTER: KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\"); break;\n  }\n\n  // Unknown type.  Treat it as zero-size.\n  return ElementSize::VOID;\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nElementSize elementSizeFor(schema::Type::Which elementType) {\n  switch (elementType) {\n    case schema::Type::VOID: return ElementSize::VOID;\n    case schema::Type::BOOL: return ElementSize::BIT;\n    case schema::Type::INT8: return ElementSize::BYTE;\n    case schema::Type::INT16: return ElementSize::TWO_BYTES;\n    case schema::Type::INT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::INT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::UINT8: return ElementSize::BYTE;\n    case schema::Type::UINT16: return ElementSize::TWO_BYTES;\n    case schema::Type::UINT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::UINT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::FLOAT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::FLOAT64: return ElementSize::EIGHT_BYTES;\n\n    case schema::Type::TEXT: return ElementSize::POINTER;\n    case schema::Type::DATA: return ElementSize::POINTER;\n    case schema::Type::LIST: return ElementSize::POINTER;\n    case schema::Type::ENUM: return ElementSize::TWO_BYTES;\n    case schema::Type::STRUCT: return ElementSize::INLINE_COMPOSITE;\n    case schema::Type::INTERFACE: return ElementSize::POINTER;\n    case schema::Type::ANY_POINTER: KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\"); break;\n  }\n\n  // Unknown type.  Treat it as zero-size.\n  return ElementSize::VOID;\n}"
        }
      },
      {
        "call_info": {
          "callee": "listType.whichElementType",
          "args": [],
          "line": 656
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 655
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerField",
          "args": [
            "size * ELEMENTS",
            "structSizeFromSchema(listType.getStructElementType())"
          ],
          "line": 650
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structSizeFromSchema",
          "args": [
            "listType.getStructElementType()"
          ],
          "line": 652
        },
        "resolved": true,
        "details": {
          "function_name": "structSizeFromSchema",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "98-103",
          "snippet": "inline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\ninline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}"
        }
      },
      {
        "call_info": {
          "callee": "listType.getStructElementType",
          "args": [],
          "line": 652
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 650
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "listType.whichElementType",
          "args": [],
          "line": 648
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.asList",
          "args": [],
          "line": 647
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.which",
          "args": [],
          "line": 645
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.getSlot",
          "args": [],
          "line": 644
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.which",
          "args": [],
          "line": 642
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getType",
          "args": [],
          "line": 640
        },
        "resolved": true,
        "details": {
          "function_name": "getType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "942-942",
          "snippet": "inline DynamicValue::Type getType() { return type; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline DynamicValue::Type getType() { return type; }"
        }
      },
      {
        "call_info": {
          "callee": "field.getProto",
          "args": [],
          "line": 639
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      },
      {
        "call_info": {
          "callee": "setInUnion",
          "args": [
            "field"
          ],
          "line": 637
        },
        "resolved": true,
        "details": {
          "function_name": "DynamicStruct::Builder::setInUnion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "163-171",
          "snippet": "void DynamicStruct::Builder::setInUnion(StructSchema::Field field) {\n  // If a union member, set the discriminant to match.\n  auto proto = field.getProto();\n  if (hasDiscriminantValue(proto)) {\n    builder.setDataField<uint16_t>(\n        schema.getProto().getStruct().getDiscriminantOffset() * ELEMENTS,\n        proto.getDiscriminantValue());\n  }\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nvoid DynamicStruct::Builder::setInUnion(StructSchema::Field field) {\n  // If a union member, set the discriminant to match.\n  auto proto = field.getProto();\n  if (hasDiscriminantValue(proto)) {\n    builder.setDataField<uint16_t>(\n        schema.getProto().getStruct().getDiscriminantOffset() * ELEMENTS,\n        proto.getDiscriminantValue());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "field.getContainingStruct() == schema",
            "\"`field` is not a field of this struct.\""
          ],
          "line": 636
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getContainingStruct",
          "args": [],
          "line": 636
        },
        "resolved": true,
        "details": {
          "function_name": "getContainingStruct",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "274-274",
          "snippet": "inline StructSchema getContainingStruct() const { return parent; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline StructSchema getContainingStruct() const { return parent; }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicValue::Builder DynamicStruct::Builder::init(StructSchema::Field field, uint size) {\n  KJ_REQUIRE(field.getContainingStruct() == schema, \"`field` is not a field of this struct.\");\n  setInUnion(field);\n\n  auto proto = field.getProto();\n  auto type = field.getType();\n\n  switch (proto.which()) {\n    case schema::Field::SLOT: {\n      auto slot = proto.getSlot();\n      switch (type.which()) {\n        case schema::Type::LIST: {\n          auto listType = type.asList();\n          if (listType.whichElementType() == schema::Type::STRUCT) {\n            return DynamicList::Builder(listType,\n                builder.getPointerField(slot.getOffset() * POINTERS)\n                       .initStructList(size * ELEMENTS,\n                                       structSizeFromSchema(listType.getStructElementType())));\n          } else {\n            return DynamicList::Builder(listType,\n                builder.getPointerField(slot.getOffset() * POINTERS)\n                       .initList(elementSizeFor(listType.whichElementType()), size * ELEMENTS));\n          }\n        }\n        case schema::Type::TEXT:\n          return builder.getPointerField(slot.getOffset() * POINTERS)\n                        .initBlob<Text>(size * BYTES);\n        case schema::Type::DATA:\n          return builder.getPointerField(slot.getOffset() * POINTERS)\n                        .initBlob<Data>(size * BYTES);\n        default:\n          KJ_FAIL_REQUIRE(\n              \"init() with size is only valid for list, text, or data fields.\",\n              (uint)type.which());\n          break;\n      }\n    }\n\n    case schema::Field::GROUP:\n      KJ_FAIL_REQUIRE(\"init() with size is only valid for list, text, or data fields.\");\n  }\n\n  KJ_UNREACHABLE;\n}"
  },
  {
    "function_name": "DynamicStruct::Builder::init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "599-633",
    "snippet": "DynamicValue::Builder DynamicStruct::Builder::init(StructSchema::Field field) {\n  KJ_REQUIRE(field.getContainingStruct() == schema, \"`field` is not a field of this struct.\");\n  setInUnion(field);\n\n  auto proto = field.getProto();\n  auto type = field.getType();\n\n  switch (proto.which()) {\n    case schema::Field::SLOT: {\n      auto slot = proto.getSlot();\n      switch (type.which()) {\n        case schema::Type::STRUCT: {\n          auto subSchema = type.asStruct();\n          return DynamicStruct::Builder(subSchema,\n              builder.getPointerField(slot.getOffset() * POINTERS)\n                     .initStruct(structSizeFromSchema(subSchema)));\n        }\n        case schema::Type::ANY_POINTER: {\n          auto pointer = builder.getPointerField(slot.getOffset() * POINTERS);\n          pointer.clear();\n          return AnyPointer::Builder(pointer);\n        }\n        default:\n          KJ_FAIL_REQUIRE(\"init() without a size is only valid for struct and object fields.\");\n      }\n    }\n\n    case schema::Field::GROUP: {\n      clear(field);\n      return DynamicStruct::Builder(type.asStruct(), builder);\n    }\n  }\n\n  KJ_UNREACHABLE;\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DynamicStruct::Builder",
          "args": [
            "type.asStruct()",
            "builder"
          ],
          "line": 628
        },
        "resolved": true,
        "details": {
          "function_name": "Builder",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "427-427",
          "snippet": "Builder(ListSchema schema, _::ListBuilder builder): schema(schema), builder(builder) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nBuilder(ListSchema schema, _::ListBuilder builder): schema(schema), builder(builder) {}"
        }
      },
      {
        "call_info": {
          "callee": "type.asStruct",
          "args": [],
          "line": 628
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear",
          "args": [
            "field"
          ],
          "line": 627
        },
        "resolved": true,
        "details": {
          "function_name": "DynamicStruct::Builder::clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "958-960",
          "snippet": "void DynamicStruct::Builder::clear(kj::StringPtr name) {\n  clear(schema.getFieldByName(name));\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nvoid DynamicStruct::Builder::clear(kj::StringPtr name) {\n  clear(schema.getFieldByName(name));\n}"
        }
      },
      {
        "call_info": {
          "callee": "KJ_FAIL_REQUIRE",
          "args": [
            "\"init() without a size is only valid for struct and object fields.\""
          ],
          "line": 622
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pointer.clear",
          "args": [],
          "line": 618
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "TestPipe",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-packed-test.c++",
          "lines": "51-54",
          "snippet": "void clear(size_t preferredReadSize = kj::maxValue) {\n    resetRead(preferredReadSize);\n    data.clear();\n  }",
          "includes": [
            "#include \"test-util.h\"",
            "#include <stdlib.h>",
            "#include <string>",
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"serialize-packed.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"test-util.h\"\n#include <stdlib.h>\n#include <string>\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"serialize-packed.h\"\n\nTestPipe {\n  void clear(size_t preferredReadSize = kj::maxValue) {\n      resetRead(preferredReadSize);\n      data.clear();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "builder.getPointerField",
          "args": [
            "slot.getOffset() * POINTERS"
          ],
          "line": 617
        },
        "resolved": true,
        "details": {
          "function_name": "getPointerField",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "490-497",
          "snippet": "inline AnyPointer::Pipeline getPointerField(uint16_t pointerIndex) {\n    // Return a new Promise representing a sub-object of the result.  `pointerIndex` is the index\n    // of the sub-object within the pointer section of the result (the result must be a struct).\n    //\n    // TODO(perf):  On GCC 4.8 / Clang 3.3, use rvalue qualifiers to avoid the need for copies.\n    //   Also make `ops` into a Vector to optimize this.\n    return typeless.getPointerField(pointerIndex);\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline AnyPointer::Pipeline getPointerField(uint16_t pointerIndex) {\n    // Return a new Promise representing a sub-object of the result.  `pointerIndex` is the index\n    // of the sub-object within the pointer section of the result (the result must be a struct).\n    //\n    // TODO(perf):  On GCC 4.8 / Clang 3.3, use rvalue qualifiers to avoid the need for copies.\n    //   Also make `ops` into a Vector to optimize this.\n    return typeless.getPointerField(pointerIndex);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 617
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structSizeFromSchema",
          "args": [
            "subSchema"
          ],
          "line": 614
        },
        "resolved": true,
        "details": {
          "function_name": "structSizeFromSchema",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "98-103",
          "snippet": "inline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\ninline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}"
        }
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 613
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.asStruct",
          "args": [],
          "line": 611
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.which",
          "args": [],
          "line": 609
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.getSlot",
          "args": [],
          "line": 608
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.which",
          "args": [],
          "line": 606
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getType",
          "args": [],
          "line": 604
        },
        "resolved": true,
        "details": {
          "function_name": "getType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "942-942",
          "snippet": "inline DynamicValue::Type getType() { return type; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline DynamicValue::Type getType() { return type; }"
        }
      },
      {
        "call_info": {
          "callee": "field.getProto",
          "args": [],
          "line": 603
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      },
      {
        "call_info": {
          "callee": "setInUnion",
          "args": [
            "field"
          ],
          "line": 601
        },
        "resolved": true,
        "details": {
          "function_name": "DynamicStruct::Builder::setInUnion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "163-171",
          "snippet": "void DynamicStruct::Builder::setInUnion(StructSchema::Field field) {\n  // If a union member, set the discriminant to match.\n  auto proto = field.getProto();\n  if (hasDiscriminantValue(proto)) {\n    builder.setDataField<uint16_t>(\n        schema.getProto().getStruct().getDiscriminantOffset() * ELEMENTS,\n        proto.getDiscriminantValue());\n  }\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nvoid DynamicStruct::Builder::setInUnion(StructSchema::Field field) {\n  // If a union member, set the discriminant to match.\n  auto proto = field.getProto();\n  if (hasDiscriminantValue(proto)) {\n    builder.setDataField<uint16_t>(\n        schema.getProto().getStruct().getDiscriminantOffset() * ELEMENTS,\n        proto.getDiscriminantValue());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "field.getContainingStruct() == schema",
            "\"`field` is not a field of this struct.\""
          ],
          "line": 600
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getContainingStruct",
          "args": [],
          "line": 600
        },
        "resolved": true,
        "details": {
          "function_name": "getContainingStruct",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "274-274",
          "snippet": "inline StructSchema getContainingStruct() const { return parent; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline StructSchema getContainingStruct() const { return parent; }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicValue::Builder DynamicStruct::Builder::init(StructSchema::Field field) {\n  KJ_REQUIRE(field.getContainingStruct() == schema, \"`field` is not a field of this struct.\");\n  setInUnion(field);\n\n  auto proto = field.getProto();\n  auto type = field.getType();\n\n  switch (proto.which()) {\n    case schema::Field::SLOT: {\n      auto slot = proto.getSlot();\n      switch (type.which()) {\n        case schema::Type::STRUCT: {\n          auto subSchema = type.asStruct();\n          return DynamicStruct::Builder(subSchema,\n              builder.getPointerField(slot.getOffset() * POINTERS)\n                     .initStruct(structSizeFromSchema(subSchema)));\n        }\n        case schema::Type::ANY_POINTER: {\n          auto pointer = builder.getPointerField(slot.getOffset() * POINTERS);\n          pointer.clear();\n          return AnyPointer::Builder(pointer);\n        }\n        default:\n          KJ_FAIL_REQUIRE(\"init() without a size is only valid for struct and object fields.\");\n      }\n    }\n\n    case schema::Field::GROUP: {\n      clear(field);\n      return DynamicStruct::Builder(type.asStruct(), builder);\n    }\n  }\n\n  KJ_UNREACHABLE;\n}"
  },
  {
    "function_name": "DynamicStruct::Builder::set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "475-597",
    "snippet": "void DynamicStruct::Builder::set(StructSchema::Field field, const DynamicValue::Reader& value) {\n  KJ_REQUIRE(field.getContainingStruct() == schema, \"`field` is not a field of this struct.\");\n  setInUnion(field);\n\n  auto proto = field.getProto();\n  auto type = field.getType();\n  switch (proto.which()) {\n    case schema::Field::SLOT: {\n      auto slot = proto.getSlot();\n      auto dval = slot.getDefaultValue();\n\n      switch (type.which()) {\n        case schema::Type::VOID:\n          builder.setDataField<Void>(slot.getOffset() * ELEMENTS, value.as<Void>());\n          return;\n\n#define HANDLE_TYPE(discrim, titleCase, type) \\\n        case schema::Type::discrim: \\\n          builder.setDataField<type>( \\\n              slot.getOffset() * ELEMENTS, value.as<type>(), \\\n              bitCast<_::Mask<type> >(dval.get##titleCase())); \\\n          return;\n\n        HANDLE_TYPE(BOOL, Bool, bool)\n        HANDLE_TYPE(INT8, Int8, int8_t)\n        HANDLE_TYPE(INT16, Int16, int16_t)\n        HANDLE_TYPE(INT32, Int32, int32_t)\n        HANDLE_TYPE(INT64, Int64, int64_t)\n        HANDLE_TYPE(UINT8, Uint8, uint8_t)\n        HANDLE_TYPE(UINT16, Uint16, uint16_t)\n        HANDLE_TYPE(UINT32, Uint32, uint32_t)\n        HANDLE_TYPE(UINT64, Uint64, uint64_t)\n        HANDLE_TYPE(FLOAT32, Float32, float)\n        HANDLE_TYPE(FLOAT64, Float64, double)\n\n#undef HANDLE_TYPE\n\n        case schema::Type::ENUM: {\n          uint16_t rawValue;\n          auto enumSchema = type.asEnum();\n          if (value.getType() == DynamicValue::TEXT) {\n            // Convert from text.\n            rawValue = enumSchema.getEnumerantByName(value.as<Text>()).getOrdinal();\n          } else if (value.getType() == DynamicValue::INT ||\n                     value.getType() == DynamicValue::UINT) {\n            rawValue = value.as<uint16_t>();\n          } else {\n            DynamicEnum enumValue = value.as<DynamicEnum>();\n            KJ_REQUIRE(enumValue.getSchema() == enumSchema, \"Value type mismatch.\") {\n              return;\n            }\n            rawValue = enumValue.getRaw();\n          }\n          builder.setDataField<uint16_t>(slot.getOffset() * ELEMENTS, rawValue,\n                                         dval.getEnum());\n          return;\n        }\n\n        case schema::Type::TEXT:\n          builder.getPointerField(slot.getOffset() * POINTERS).setBlob<Text>(value.as<Text>());\n          return;\n\n        case schema::Type::DATA:\n          builder.getPointerField(slot.getOffset() * POINTERS).setBlob<Data>(value.as<Data>());\n          return;\n\n        case schema::Type::LIST: {\n          ListSchema listType = type.asList();\n          auto listValue = value.as<DynamicList>();\n          KJ_REQUIRE(listValue.getSchema() == listType, \"Value type mismatch.\") {\n            return;\n          }\n          builder.getPointerField(slot.getOffset() * POINTERS).setList(listValue.reader);\n          return;\n        }\n\n        case schema::Type::STRUCT: {\n          auto structType = type.asStruct();\n          auto structValue = value.as<DynamicStruct>();\n          KJ_REQUIRE(structValue.getSchema() == structType, \"Value type mismatch.\") {\n            return;\n          }\n          builder.getPointerField(slot.getOffset() * POINTERS).setStruct(structValue.reader);\n          return;\n        }\n\n        case schema::Type::ANY_POINTER:\n          AnyPointer::Builder(builder.getPointerField(slot.getOffset() * POINTERS))\n                 .set(value.as<AnyPointer>());\n          return;\n\n        case schema::Type::INTERFACE:\n          auto interfaceType = type.asInterface();\n          auto capability = value.as<DynamicCapability>();\n          KJ_REQUIRE(capability.getSchema().extends(interfaceType), \"Value type mismatch.\") {\n            return;\n          }\n          builder.getPointerField(slot.getOffset() * POINTERS).setCapability(\n              kj::mv(capability.hook));\n          return;\n      }\n\n      KJ_UNREACHABLE;\n    }\n\n    case schema::Field::GROUP: {\n      auto src = value.as<DynamicStruct>();\n      auto dst = init(field).as<DynamicStruct>();\n\n      KJ_IF_MAYBE(unionField, src.which()) {\n        dst.set(*unionField, src.get(*unionField));\n      }\n\n      for (auto field: src.schema.getNonUnionFields()) {\n        if (src.has(field)) {\n          dst.set(field, src.get(field));\n        }\n      }\n    }\n  }\n\n  KJ_UNREACHABLE;\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dst.set",
          "args": [
            "field",
            "src.get(field)"
          ],
          "line": 590
        },
        "resolved": true,
        "details": {
          "function_name": "set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "872-874",
          "snippet": "static inline void set(PointerBuilder builder, AnyList::Reader value) {\n    builder.setList(value._reader);\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline void set(PointerBuilder builder, AnyList::Reader value) {\n    builder.setList(value._reader);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "src.get",
          "args": [
            "field"
          ],
          "line": 590
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "868-871",
          "snippet": "static inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }"
        }
      },
      {
        "call_info": {
          "callee": "src.has",
          "args": [
            "field"
          ],
          "line": 589
        },
        "resolved": true,
        "details": {
          "function_name": "has",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "253-253",
          "snippet": "inline bool has(StructSchema::Field field) { return asReader().has(field); }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline bool has(StructSchema::Field field) { return asReader().has(field); }"
        }
      },
      {
        "call_info": {
          "callee": "src.schema.getNonUnionFields",
          "args": [],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_IF_MAYBE",
          "args": [
            "unionField",
            "src.which()"
          ],
          "line": 584
        },
        "resolved": true,
        "details": {
          "function_name": "KJ_IF_MAYBE",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "2462-2464",
          "snippet": "KJ_IF_MAYBE(e, exception) {\n          fulfiller->get()->reject(kj::mv(*e));\n        }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nKJ_IF_MAYBE(e, exception) {\n          fulfiller->get()->reject(kj::mv(*e));\n        }"
        }
      },
      {
        "call_info": {
          "callee": "src.which",
          "args": [],
          "line": 584
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init",
          "args": [],
          "line": 582
        },
        "resolved": true,
        "details": {
          "function_name": "init",
          "container": "OneOf",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/one-of.h",
          "lines": "77-81",
          "snippet": "void init(Params&&... params) {\n    if (tag != 0) destroy();\n    ctor(*reinterpret_cast<T*>(space), kj::fwd<Params>(params)...);\n    tag = typeIndex<T>();\n  }",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nOneOf {\n  void init(Params&&... params) {\n      if (tag != 0) destroy();\n      ctor(*reinterpret_cast<T*>(space), kj::fwd<Params>(params)...);\n      tag = typeIndex<T>();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "init",
          "args": [
            "field"
          ],
          "line": 582
        },
        "resolved": true,
        "details": {
          "function_name": "DynamicStruct::Builder::init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "946-948",
          "snippet": "DynamicValue::Builder DynamicStruct::Builder::init(kj::StringPtr name) {\n  return init(schema.getFieldByName(name));\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicValue::Builder DynamicStruct::Builder::init(kj::StringPtr name) {\n  return init(schema.getFieldByName(name));\n}"
        }
      },
      {
        "call_info": {
          "callee": "value.as<DynamicStruct>",
          "args": [],
          "line": 581
        },
        "resolved": true,
        "details": {
          "function_name": "as",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "722-722",
          "snippet": "inline BuilderFor<T> as() { return AsImpl<T>::apply(*this); }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline BuilderFor<T> as() { return AsImpl<T>::apply(*this); }"
        }
      },
      {
        "call_info": {
          "callee": "builder.getPointerField",
          "args": [
            "kj::mv(capability.hook)"
          ],
          "line": 572
        },
        "resolved": true,
        "details": {
          "function_name": "getPointerField",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "490-497",
          "snippet": "inline AnyPointer::Pipeline getPointerField(uint16_t pointerIndex) {\n    // Return a new Promise representing a sub-object of the result.  `pointerIndex` is the index\n    // of the sub-object within the pointer section of the result (the result must be a struct).\n    //\n    // TODO(perf):  On GCC 4.8 / Clang 3.3, use rvalue qualifiers to avoid the need for copies.\n    //   Also make `ops` into a Vector to optimize this.\n    return typeless.getPointerField(pointerIndex);\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline AnyPointer::Pipeline getPointerField(uint16_t pointerIndex) {\n    // Return a new Promise representing a sub-object of the result.  `pointerIndex` is the index\n    // of the sub-object within the pointer section of the result (the result must be a struct).\n    //\n    // TODO(perf):  On GCC 4.8 / Clang 3.3, use rvalue qualifiers to avoid the need for copies.\n    //   Also make `ops` into a Vector to optimize this.\n    return typeless.getPointerField(pointerIndex);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "capability.hook"
          ],
          "line": 573
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 572
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "capability.getSchema().extends(interfaceType)",
            "\"Value type mismatch.\""
          ],
          "line": 569
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capability.getSchema",
          "args": [
            "interfaceType"
          ],
          "line": 569
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capability.getSchema",
          "args": [],
          "line": 569
        },
        "resolved": true,
        "details": {
          "function_name": "getSchema",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "505-505",
          "snippet": "inline InterfaceSchema getSchema() const { return schema; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline InterfaceSchema getSchema() const { return schema; }"
        }
      },
      {
        "call_info": {
          "callee": "type.asInterface",
          "args": [],
          "line": 567
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AnyPointer::Builder",
          "args": [
            "value.as<AnyPointer>()"
          ],
          "line": 562
        },
        "resolved": true,
        "details": {
          "function_name": "Builder",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "711-711",
          "snippet": "inline Builder(T value): Builder(toDynamic(value)) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline Builder(T value): Builder(toDynamic(value)) {}"
        }
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 562
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 557
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "structValue.getSchema() == structType",
            "\"Value type mismatch.\""
          ],
          "line": 554
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.asStruct",
          "args": [],
          "line": 552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 547
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "listValue.getSchema() == listType",
            "\"Value type mismatch.\""
          ],
          "line": 544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.asList",
          "args": [],
          "line": 542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.setDataField<uint16_t>",
          "args": [
            "slot.getOffset() * ELEMENTS",
            "rawValue",
            "dval.getEnum()"
          ],
          "line": 528
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dval.getEnum",
          "args": [],
          "line": 529
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 528
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "enumValue.getRaw",
          "args": [],
          "line": 526
        },
        "resolved": true,
        "details": {
          "function_name": "getRaw",
          "container": "DynamicEnum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "149-149",
          "snippet": "inline uint16_t getRaw() const { return value; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nDynamicEnum {\n  inline uint16_t getRaw() const { return value; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "enumValue.getSchema() == enumSchema",
            "\"Value type mismatch.\""
          ],
          "line": 523
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.getType",
          "args": [],
          "line": 519
        },
        "resolved": true,
        "details": {
          "function_name": "getType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "942-942",
          "snippet": "inline DynamicValue::Type getType() { return type; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline DynamicValue::Type getType() { return type; }"
        }
      },
      {
        "call_info": {
          "callee": "enumSchema.getEnumerantByName",
          "args": [],
          "line": 517
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "enumSchema.getEnumerantByName",
          "args": [
            "value.as<Text>()"
          ],
          "line": 517
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.asEnum",
          "args": [],
          "line": 514
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.setDataField<Void>",
          "args": [
            "slot.getOffset() * ELEMENTS",
            "value.as<Void>()"
          ],
          "line": 488
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 488
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.which",
          "args": [],
          "line": 486
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slot.getDefaultValue",
          "args": [],
          "line": 484
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.getSlot",
          "args": [],
          "line": 483
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.which",
          "args": [],
          "line": 481
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getProto",
          "args": [],
          "line": 479
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      },
      {
        "call_info": {
          "callee": "setInUnion",
          "args": [
            "field"
          ],
          "line": 477
        },
        "resolved": true,
        "details": {
          "function_name": "DynamicStruct::Builder::setInUnion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "163-171",
          "snippet": "void DynamicStruct::Builder::setInUnion(StructSchema::Field field) {\n  // If a union member, set the discriminant to match.\n  auto proto = field.getProto();\n  if (hasDiscriminantValue(proto)) {\n    builder.setDataField<uint16_t>(\n        schema.getProto().getStruct().getDiscriminantOffset() * ELEMENTS,\n        proto.getDiscriminantValue());\n  }\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nvoid DynamicStruct::Builder::setInUnion(StructSchema::Field field) {\n  // If a union member, set the discriminant to match.\n  auto proto = field.getProto();\n  if (hasDiscriminantValue(proto)) {\n    builder.setDataField<uint16_t>(\n        schema.getProto().getStruct().getDiscriminantOffset() * ELEMENTS,\n        proto.getDiscriminantValue());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "field.getContainingStruct() == schema",
            "\"`field` is not a field of this struct.\""
          ],
          "line": 476
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getContainingStruct",
          "args": [],
          "line": 476
        },
        "resolved": true,
        "details": {
          "function_name": "getContainingStruct",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "274-274",
          "snippet": "inline StructSchema getContainingStruct() const { return parent; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline StructSchema getContainingStruct() const { return parent; }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nvoid DynamicStruct::Builder::set(StructSchema::Field field, const DynamicValue::Reader& value) {\n  KJ_REQUIRE(field.getContainingStruct() == schema, \"`field` is not a field of this struct.\");\n  setInUnion(field);\n\n  auto proto = field.getProto();\n  auto type = field.getType();\n  switch (proto.which()) {\n    case schema::Field::SLOT: {\n      auto slot = proto.getSlot();\n      auto dval = slot.getDefaultValue();\n\n      switch (type.which()) {\n        case schema::Type::VOID:\n          builder.setDataField<Void>(slot.getOffset() * ELEMENTS, value.as<Void>());\n          return;\n\n#define HANDLE_TYPE(discrim, titleCase, type) \\\n        case schema::Type::discrim: \\\n          builder.setDataField<type>( \\\n              slot.getOffset() * ELEMENTS, value.as<type>(), \\\n              bitCast<_::Mask<type> >(dval.get##titleCase())); \\\n          return;\n\n        HANDLE_TYPE(BOOL, Bool, bool)\n        HANDLE_TYPE(INT8, Int8, int8_t)\n        HANDLE_TYPE(INT16, Int16, int16_t)\n        HANDLE_TYPE(INT32, Int32, int32_t)\n        HANDLE_TYPE(INT64, Int64, int64_t)\n        HANDLE_TYPE(UINT8, Uint8, uint8_t)\n        HANDLE_TYPE(UINT16, Uint16, uint16_t)\n        HANDLE_TYPE(UINT32, Uint32, uint32_t)\n        HANDLE_TYPE(UINT64, Uint64, uint64_t)\n        HANDLE_TYPE(FLOAT32, Float32, float)\n        HANDLE_TYPE(FLOAT64, Float64, double)\n\n#undef HANDLE_TYPE\n\n        case schema::Type::ENUM: {\n          uint16_t rawValue;\n          auto enumSchema = type.asEnum();\n          if (value.getType() == DynamicValue::TEXT) {\n            // Convert from text.\n            rawValue = enumSchema.getEnumerantByName(value.as<Text>()).getOrdinal();\n          } else if (value.getType() == DynamicValue::INT ||\n                     value.getType() == DynamicValue::UINT) {\n            rawValue = value.as<uint16_t>();\n          } else {\n            DynamicEnum enumValue = value.as<DynamicEnum>();\n            KJ_REQUIRE(enumValue.getSchema() == enumSchema, \"Value type mismatch.\") {\n              return;\n            }\n            rawValue = enumValue.getRaw();\n          }\n          builder.setDataField<uint16_t>(slot.getOffset() * ELEMENTS, rawValue,\n                                         dval.getEnum());\n          return;\n        }\n\n        case schema::Type::TEXT:\n          builder.getPointerField(slot.getOffset() * POINTERS).setBlob<Text>(value.as<Text>());\n          return;\n\n        case schema::Type::DATA:\n          builder.getPointerField(slot.getOffset() * POINTERS).setBlob<Data>(value.as<Data>());\n          return;\n\n        case schema::Type::LIST: {\n          ListSchema listType = type.asList();\n          auto listValue = value.as<DynamicList>();\n          KJ_REQUIRE(listValue.getSchema() == listType, \"Value type mismatch.\") {\n            return;\n          }\n          builder.getPointerField(slot.getOffset() * POINTERS).setList(listValue.reader);\n          return;\n        }\n\n        case schema::Type::STRUCT: {\n          auto structType = type.asStruct();\n          auto structValue = value.as<DynamicStruct>();\n          KJ_REQUIRE(structValue.getSchema() == structType, \"Value type mismatch.\") {\n            return;\n          }\n          builder.getPointerField(slot.getOffset() * POINTERS).setStruct(structValue.reader);\n          return;\n        }\n\n        case schema::Type::ANY_POINTER:\n          AnyPointer::Builder(builder.getPointerField(slot.getOffset() * POINTERS))\n                 .set(value.as<AnyPointer>());\n          return;\n\n        case schema::Type::INTERFACE:\n          auto interfaceType = type.asInterface();\n          auto capability = value.as<DynamicCapability>();\n          KJ_REQUIRE(capability.getSchema().extends(interfaceType), \"Value type mismatch.\") {\n            return;\n          }\n          builder.getPointerField(slot.getOffset() * POINTERS).setCapability(\n              kj::mv(capability.hook));\n          return;\n      }\n\n      KJ_UNREACHABLE;\n    }\n\n    case schema::Field::GROUP: {\n      auto src = value.as<DynamicStruct>();\n      auto dst = init(field).as<DynamicStruct>();\n\n      KJ_IF_MAYBE(unionField, src.which()) {\n        dst.set(*unionField, src.get(*unionField));\n      }\n\n      for (auto field: src.schema.getNonUnionFields()) {\n        if (src.has(field)) {\n          dst.set(field, src.get(field));\n        }\n      }\n    }\n  }\n\n  KJ_UNREACHABLE;\n}"
  },
  {
    "function_name": "DynamicStruct::Builder::which",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "465-473",
    "snippet": "kj::Maybe<StructSchema::Field> DynamicStruct::Builder::which() {\n  auto structProto = schema.getProto().getStruct();\n  if (structProto.getDiscriminantCount() == 0) {\n    return nullptr;\n  }\n\n  uint16_t discrim = builder.getDataField<uint16_t>(structProto.getDiscriminantOffset() * ELEMENTS);\n  return schema.getFieldByDiscriminant(discrim);\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "schema.getFieldByDiscriminant",
          "args": [
            "discrim"
          ],
          "line": 472
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getDataField<uint16_t>",
          "args": [
            "structProto.getDiscriminantOffset() * ELEMENTS"
          ],
          "line": 471
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structProto.getDiscriminantOffset",
          "args": [],
          "line": 471
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structProto.getDiscriminantCount",
          "args": [],
          "line": 467
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getProto",
          "args": [],
          "line": 466
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nkj::Maybe<StructSchema::Field> DynamicStruct::Builder::which() {\n  auto structProto = schema.getProto().getStruct();\n  if (structProto.getDiscriminantCount() == 0) {\n    return nullptr;\n  }\n\n  uint16_t discrim = builder.getDataField<uint16_t>(structProto.getDiscriminantOffset() * ELEMENTS);\n  return schema.getFieldByDiscriminant(discrim);\n}"
  },
  {
    "function_name": "DynamicStruct::Reader::which",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "455-463",
    "snippet": "kj::Maybe<StructSchema::Field> DynamicStruct::Reader::which() const {\n  auto structProto = schema.getProto().getStruct();\n  if (structProto.getDiscriminantCount() == 0) {\n    return nullptr;\n  }\n\n  uint16_t discrim = reader.getDataField<uint16_t>(structProto.getDiscriminantOffset() * ELEMENTS);\n  return schema.getFieldByDiscriminant(discrim);\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "schema.getFieldByDiscriminant",
          "args": [
            "discrim"
          ],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getDataField<uint16_t>",
          "args": [
            "structProto.getDiscriminantOffset() * ELEMENTS"
          ],
          "line": 461
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structProto.getDiscriminantOffset",
          "args": [],
          "line": 461
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structProto.getDiscriminantCount",
          "args": [],
          "line": 457
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getProto",
          "args": [],
          "line": 456
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nkj::Maybe<StructSchema::Field> DynamicStruct::Reader::which() const {\n  auto structProto = schema.getProto().getStruct();\n  if (structProto.getDiscriminantCount() == 0) {\n    return nullptr;\n  }\n\n  uint16_t discrim = reader.getDataField<uint16_t>(structProto.getDiscriminantOffset() * ELEMENTS);\n  return schema.getFieldByDiscriminant(discrim);\n}"
  },
  {
    "function_name": "DynamicStruct::Reader::has",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "400-453",
    "snippet": "bool DynamicStruct::Reader::has(StructSchema::Field field) const {\n  KJ_REQUIRE(field.getContainingStruct() == schema, \"`field` is not a field of this struct.\");\n\n  auto proto = field.getProto();\n  if (hasDiscriminantValue(proto)) {\n    uint16_t discrim = reader.getDataField<uint16_t>(\n        schema.getProto().getStruct().getDiscriminantOffset() * ELEMENTS);\n    if (discrim != proto.getDiscriminantValue()) {\n      // Field is not active in the union.\n      return false;\n    }\n  }\n\n  switch (proto.which()) {\n    case schema::Field::SLOT:\n      // Continue to below.\n      break;\n\n    case schema::Field::GROUP:\n      return true;\n  }\n\n  auto slot = proto.getSlot();\n  auto type = field.getType();\n\n  switch (type.which()) {\n    case schema::Type::VOID:\n    case schema::Type::BOOL:\n    case schema::Type::INT8:\n    case schema::Type::INT16:\n    case schema::Type::INT32:\n    case schema::Type::INT64:\n    case schema::Type::UINT8:\n    case schema::Type::UINT16:\n    case schema::Type::UINT32:\n    case schema::Type::UINT64:\n    case schema::Type::FLOAT32:\n    case schema::Type::FLOAT64:\n    case schema::Type::ENUM:\n      // Primitive types are always present.\n      return true;\n\n    case schema::Type::TEXT:\n    case schema::Type::DATA:\n    case schema::Type::LIST:\n    case schema::Type::STRUCT:\n    case schema::Type::ANY_POINTER:\n    case schema::Type::INTERFACE:\n      return !reader.getPointerField(slot.getOffset() * POINTERS).isNull();\n  }\n\n  // Unknown type.  As far as we know, it isn't set.\n  return false;\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reader.getPointerField",
          "args": [],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getPointerField",
          "args": [
            "slot.getOffset() * POINTERS"
          ],
          "line": 448
        },
        "resolved": true,
        "details": {
          "function_name": "getPointerField",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "490-497",
          "snippet": "inline AnyPointer::Pipeline getPointerField(uint16_t pointerIndex) {\n    // Return a new Promise representing a sub-object of the result.  `pointerIndex` is the index\n    // of the sub-object within the pointer section of the result (the result must be a struct).\n    //\n    // TODO(perf):  On GCC 4.8 / Clang 3.3, use rvalue qualifiers to avoid the need for copies.\n    //   Also make `ops` into a Vector to optimize this.\n    return typeless.getPointerField(pointerIndex);\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline AnyPointer::Pipeline getPointerField(uint16_t pointerIndex) {\n    // Return a new Promise representing a sub-object of the result.  `pointerIndex` is the index\n    // of the sub-object within the pointer section of the result (the result must be a struct).\n    //\n    // TODO(perf):  On GCC 4.8 / Clang 3.3, use rvalue qualifiers to avoid the need for copies.\n    //   Also make `ops` into a Vector to optimize this.\n    return typeless.getPointerField(pointerIndex);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.which",
          "args": [],
          "line": 425
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getType",
          "args": [],
          "line": 423
        },
        "resolved": true,
        "details": {
          "function_name": "getType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "942-942",
          "snippet": "inline DynamicValue::Type getType() { return type; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline DynamicValue::Type getType() { return type; }"
        }
      },
      {
        "call_info": {
          "callee": "proto.getSlot",
          "args": [],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.which",
          "args": [],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.getDiscriminantValue",
          "args": [],
          "line": 407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getDataField<uint16_t>",
          "args": [
            "schema.getProto().getStruct().getDiscriminantOffset() * ELEMENTS"
          ],
          "line": 405
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getProto",
          "args": [],
          "line": 406
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      },
      {
        "call_info": {
          "callee": "hasDiscriminantValue",
          "args": [
            "proto"
          ],
          "line": 404
        },
        "resolved": true,
        "details": {
          "function_name": "hasDiscriminantValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "29-31",
          "snippet": "bool hasDiscriminantValue(const schema::Field::Reader& reader) {\n  return reader.getDiscriminantValue() != schema::Field::NO_DISCRIMINANT;\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nbool hasDiscriminantValue(const schema::Field::Reader& reader) {\n  return reader.getDiscriminantValue() != schema::Field::NO_DISCRIMINANT;\n}"
        }
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "field.getContainingStruct() == schema",
            "\"`field` is not a field of this struct.\""
          ],
          "line": 401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getContainingStruct",
          "args": [],
          "line": 401
        },
        "resolved": true,
        "details": {
          "function_name": "getContainingStruct",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "274-274",
          "snippet": "inline StructSchema getContainingStruct() const { return parent; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline StructSchema getContainingStruct() const { return parent; }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nbool DynamicStruct::Reader::has(StructSchema::Field field) const {\n  KJ_REQUIRE(field.getContainingStruct() == schema, \"`field` is not a field of this struct.\");\n\n  auto proto = field.getProto();\n  if (hasDiscriminantValue(proto)) {\n    uint16_t discrim = reader.getDataField<uint16_t>(\n        schema.getProto().getStruct().getDiscriminantOffset() * ELEMENTS);\n    if (discrim != proto.getDiscriminantValue()) {\n      // Field is not active in the union.\n      return false;\n    }\n  }\n\n  switch (proto.which()) {\n    case schema::Field::SLOT:\n      // Continue to below.\n      break;\n\n    case schema::Field::GROUP:\n      return true;\n  }\n\n  auto slot = proto.getSlot();\n  auto type = field.getType();\n\n  switch (type.which()) {\n    case schema::Type::VOID:\n    case schema::Type::BOOL:\n    case schema::Type::INT8:\n    case schema::Type::INT16:\n    case schema::Type::INT32:\n    case schema::Type::INT64:\n    case schema::Type::UINT8:\n    case schema::Type::UINT16:\n    case schema::Type::UINT32:\n    case schema::Type::UINT64:\n    case schema::Type::FLOAT32:\n    case schema::Type::FLOAT64:\n    case schema::Type::ENUM:\n      // Primitive types are always present.\n      return true;\n\n    case schema::Type::TEXT:\n    case schema::Type::DATA:\n    case schema::Type::LIST:\n    case schema::Type::STRUCT:\n    case schema::Type::ANY_POINTER:\n    case schema::Type::INTERFACE:\n      return !reader.getPointerField(slot.getOffset() * POINTERS).isNull();\n  }\n\n  // Unknown type.  As far as we know, it isn't set.\n  return false;\n}"
  },
  {
    "function_name": "DynamicStruct::Pipeline::get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "365-398",
    "snippet": "DynamicValue::Pipeline DynamicStruct::Pipeline::get(StructSchema::Field field) {\n  KJ_REQUIRE(field.getContainingStruct() == schema, \"`field` is not a field of this struct.\");\n\n  auto proto = field.getProto();\n  KJ_REQUIRE(!hasDiscriminantValue(proto), \"Can't pipeline on union members.\");\n\n  auto type = field.getType();\n\n  switch (proto.which()) {\n    case schema::Field::SLOT: {\n      auto slot = proto.getSlot();\n\n      switch (type.which()) {\n        case schema::Type::STRUCT:\n          return DynamicStruct::Pipeline(type.asStruct(),\n              typeless.getPointerField(slot.getOffset()));\n\n        case schema::Type::INTERFACE:\n          return DynamicCapability::Client(type.asInterface(),\n              typeless.getPointerField(slot.getOffset()).asCap());\n\n        default:\n          KJ_FAIL_REQUIRE(\"Can only pipeline on struct and interface fields.\");\n      }\n\n      KJ_UNREACHABLE;\n    }\n\n    case schema::Field::GROUP:\n      return DynamicStruct::Pipeline(type.asStruct(), typeless.noop());\n  }\n\n  KJ_UNREACHABLE;\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DynamicStruct::Pipeline",
          "args": [
            "type.asStruct()",
            "typeless.noop()"
          ],
          "line": 394
        },
        "resolved": true,
        "details": {
          "function_name": "Pipeline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "342-343",
          "snippet": "inline explicit Pipeline(StructSchema schema, AnyPointer::Pipeline&& typeless)\n      : schema(schema), typeless(kj::mv(typeless)) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline explicit Pipeline(StructSchema schema, AnyPointer::Pipeline&& typeless)\n      : schema(schema), typeless(kj::mv(typeless)) {}"
        }
      },
      {
        "call_info": {
          "callee": "typeless.noop",
          "args": [],
          "line": 394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.asStruct",
          "args": [],
          "line": 394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_FAIL_REQUIRE",
          "args": [
            "\"Can only pipeline on struct and interface fields.\""
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DynamicCapability::Client",
          "args": [
            "type.asInterface()",
            "typeless.getPointerField(slot.getOffset()).asCap()"
          ],
          "line": 383
        },
        "resolved": true,
        "details": {
          "function_name": "Client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "476-477",
          "snippet": "Client(InterfaceSchema schema, kj::Own<ClientHook>&& hook)\n      : Capability::Client(kj::mv(hook)), schema(schema) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nClient(InterfaceSchema schema, kj::Own<ClientHook>&& hook)\n      : Capability::Client(kj::mv(hook)), schema(schema) {}"
        }
      },
      {
        "call_info": {
          "callee": "typeless.getPointerField",
          "args": [],
          "line": 384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typeless.getPointerField",
          "args": [
            "slot.getOffset()"
          ],
          "line": 384
        },
        "resolved": true,
        "details": {
          "function_name": "getPointerField",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "490-497",
          "snippet": "inline AnyPointer::Pipeline getPointerField(uint16_t pointerIndex) {\n    // Return a new Promise representing a sub-object of the result.  `pointerIndex` is the index\n    // of the sub-object within the pointer section of the result (the result must be a struct).\n    //\n    // TODO(perf):  On GCC 4.8 / Clang 3.3, use rvalue qualifiers to avoid the need for copies.\n    //   Also make `ops` into a Vector to optimize this.\n    return typeless.getPointerField(pointerIndex);\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline AnyPointer::Pipeline getPointerField(uint16_t pointerIndex) {\n    // Return a new Promise representing a sub-object of the result.  `pointerIndex` is the index\n    // of the sub-object within the pointer section of the result (the result must be a struct).\n    //\n    // TODO(perf):  On GCC 4.8 / Clang 3.3, use rvalue qualifiers to avoid the need for copies.\n    //   Also make `ops` into a Vector to optimize this.\n    return typeless.getPointerField(pointerIndex);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.asInterface",
          "args": [],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.asStruct",
          "args": [],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.which",
          "args": [],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.getSlot",
          "args": [],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.which",
          "args": [],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getType",
          "args": [],
          "line": 371
        },
        "resolved": true,
        "details": {
          "function_name": "getType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "942-942",
          "snippet": "inline DynamicValue::Type getType() { return type; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline DynamicValue::Type getType() { return type; }"
        }
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "!hasDiscriminantValue(proto)",
            "\"Can't pipeline on union members.\""
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hasDiscriminantValue",
          "args": [
            "proto"
          ],
          "line": 369
        },
        "resolved": true,
        "details": {
          "function_name": "hasDiscriminantValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "29-31",
          "snippet": "bool hasDiscriminantValue(const schema::Field::Reader& reader) {\n  return reader.getDiscriminantValue() != schema::Field::NO_DISCRIMINANT;\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nbool hasDiscriminantValue(const schema::Field::Reader& reader) {\n  return reader.getDiscriminantValue() != schema::Field::NO_DISCRIMINANT;\n}"
        }
      },
      {
        "call_info": {
          "callee": "field.getProto",
          "args": [],
          "line": 368
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "field.getContainingStruct() == schema",
            "\"`field` is not a field of this struct.\""
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getContainingStruct",
          "args": [],
          "line": 366
        },
        "resolved": true,
        "details": {
          "function_name": "getContainingStruct",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "274-274",
          "snippet": "inline StructSchema getContainingStruct() const { return parent; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline StructSchema getContainingStruct() const { return parent; }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicValue::Pipeline DynamicStruct::Pipeline::get(StructSchema::Field field) {\n  KJ_REQUIRE(field.getContainingStruct() == schema, \"`field` is not a field of this struct.\");\n\n  auto proto = field.getProto();\n  KJ_REQUIRE(!hasDiscriminantValue(proto), \"Can't pipeline on union members.\");\n\n  auto type = field.getType();\n\n  switch (proto.which()) {\n    case schema::Field::SLOT: {\n      auto slot = proto.getSlot();\n\n      switch (type.which()) {\n        case schema::Type::STRUCT:\n          return DynamicStruct::Pipeline(type.asStruct(),\n              typeless.getPointerField(slot.getOffset()));\n\n        case schema::Type::INTERFACE:\n          return DynamicCapability::Client(type.asInterface(),\n              typeless.getPointerField(slot.getOffset()).asCap());\n\n        default:\n          KJ_FAIL_REQUIRE(\"Can only pipeline on struct and interface fields.\");\n      }\n\n      KJ_UNREACHABLE;\n    }\n\n    case schema::Field::GROUP:\n      return DynamicStruct::Pipeline(type.asStruct(), typeless.noop());\n  }\n\n  KJ_UNREACHABLE;\n}"
  },
  {
    "function_name": "DynamicStruct::Builder::get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "263-363",
    "snippet": "DynamicValue::Builder DynamicStruct::Builder::get(StructSchema::Field field) {\n  KJ_REQUIRE(field.getContainingStruct() == schema, \"`field` is not a field of this struct.\");\n  verifySetInUnion(field);\n\n  auto proto = field.getProto();\n  auto type = field.getType();\n  switch (proto.which()) {\n    case schema::Field::SLOT: {\n      auto slot = proto.getSlot();\n\n      // Note that the default value might be \"anyPointer\" even if the type is some poniter type\n      // *other than* anyPointer. This happens with generics -- the field is actually a generic\n      // parameter that has been bound, but the default value was of course compiled without any\n      // binding available.\n      auto dval = slot.getDefaultValue();\n\n      switch (type.which()) {\n        case schema::Type::VOID:\n          return builder.getDataField<Void>(slot.getOffset() * ELEMENTS);\n\n#define HANDLE_TYPE(discrim, titleCase, type) \\\n        case schema::Type::discrim: \\\n          return builder.getDataField<type>( \\\n              slot.getOffset() * ELEMENTS, \\\n              bitCast<_::Mask<type>>(dval.get##titleCase()));\n\n        HANDLE_TYPE(BOOL, Bool, bool)\n        HANDLE_TYPE(INT8, Int8, int8_t)\n        HANDLE_TYPE(INT16, Int16, int16_t)\n        HANDLE_TYPE(INT32, Int32, int32_t)\n        HANDLE_TYPE(INT64, Int64, int64_t)\n        HANDLE_TYPE(UINT8, Uint8, uint8_t)\n        HANDLE_TYPE(UINT16, Uint16, uint16_t)\n        HANDLE_TYPE(UINT32, Uint32, uint32_t)\n        HANDLE_TYPE(UINT64, Uint64, uint64_t)\n        HANDLE_TYPE(FLOAT32, Float32, float)\n        HANDLE_TYPE(FLOAT64, Float64, double)\n\n#undef HANDLE_TYPE\n\n        case schema::Type::ENUM: {\n          uint16_t typedDval = dval.getEnum();\n          return DynamicEnum(type.asEnum(),\n              builder.getDataField<uint16_t>(slot.getOffset() * ELEMENTS, typedDval));\n        }\n\n        case schema::Type::TEXT: {\n          Text::Reader typedDval = dval.isAnyPointer() ? Text::Reader() : dval.getText();\n          return builder.getPointerField(slot.getOffset() * POINTERS)\n                        .getBlob<Text>(typedDval.begin(), typedDval.size() * BYTES);\n        }\n\n        case schema::Type::DATA: {\n          Data::Reader typedDval = dval.isAnyPointer() ? Data::Reader() : dval.getData();\n          return builder.getPointerField(slot.getOffset() * POINTERS)\n                        .getBlob<Data>(typedDval.begin(), typedDval.size() * BYTES);\n        }\n\n        case schema::Type::LIST: {\n          ListSchema listType = type.asList();\n          if (listType.whichElementType() == schema::Type::STRUCT) {\n            return DynamicList::Builder(listType,\n                builder.getPointerField(slot.getOffset() * POINTERS)\n                       .getStructList(structSizeFromSchema(listType.getStructElementType()),\n                                      dval.isAnyPointer() ? nullptr :\n                                          dval.getList().getAs<_::UncheckedMessage>()));\n          } else {\n            return DynamicList::Builder(listType,\n                builder.getPointerField(slot.getOffset() * POINTERS)\n                       .getList(elementSizeFor(listType.whichElementType()),\n                                dval.isAnyPointer() ? nullptr :\n                                    dval.getList().getAs<_::UncheckedMessage>()));\n          }\n        }\n\n        case schema::Type::STRUCT: {\n          auto structSchema = type.asStruct();\n          return DynamicStruct::Builder(structSchema,\n              builder.getPointerField(slot.getOffset() * POINTERS)\n                     .getStruct(structSizeFromSchema(structSchema),\n                                dval.isAnyPointer() ? nullptr :\n                                    dval.getStruct().getAs<_::UncheckedMessage>()));\n        }\n\n        case schema::Type::ANY_POINTER:\n          return AnyPointer::Builder(builder.getPointerField(slot.getOffset() * POINTERS));\n\n        case schema::Type::INTERFACE:\n          return DynamicCapability::Client(type.asInterface(),\n              builder.getPointerField(slot.getOffset() * POINTERS).getCapability());\n      }\n\n      KJ_UNREACHABLE;\n    }\n\n    case schema::Field::GROUP:\n      return DynamicStruct::Builder(type.asStruct(), builder);\n  }\n\n  KJ_UNREACHABLE;\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DynamicStruct::Builder",
          "args": [
            "type.asStruct()",
            "builder"
          ],
          "line": 359
        },
        "resolved": true,
        "details": {
          "function_name": "Builder",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "427-427",
          "snippet": "Builder(ListSchema schema, _::ListBuilder builder): schema(schema), builder(builder) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nBuilder(ListSchema schema, _::ListBuilder builder): schema(schema), builder(builder) {}"
        }
      },
      {
        "call_info": {
          "callee": "type.asStruct",
          "args": [],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DynamicCapability::Client",
          "args": [
            "type.asInterface()",
            "builder.getPointerField(slot.getOffset() * POINTERS).getCapability()"
          ],
          "line": 351
        },
        "resolved": true,
        "details": {
          "function_name": "Client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "476-477",
          "snippet": "Client(InterfaceSchema schema, kj::Own<ClientHook>&& hook)\n      : Capability::Client(kj::mv(hook)), schema(schema) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nClient(InterfaceSchema schema, kj::Own<ClientHook>&& hook)\n      : Capability::Client(kj::mv(hook)), schema(schema) {}"
        }
      },
      {
        "call_info": {
          "callee": "builder.getPointerField",
          "args": [],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerField",
          "args": [
            "slot.getOffset() * POINTERS"
          ],
          "line": 352
        },
        "resolved": true,
        "details": {
          "function_name": "getPointerField",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "490-497",
          "snippet": "inline AnyPointer::Pipeline getPointerField(uint16_t pointerIndex) {\n    // Return a new Promise representing a sub-object of the result.  `pointerIndex` is the index\n    // of the sub-object within the pointer section of the result (the result must be a struct).\n    //\n    // TODO(perf):  On GCC 4.8 / Clang 3.3, use rvalue qualifiers to avoid the need for copies.\n    //   Also make `ops` into a Vector to optimize this.\n    return typeless.getPointerField(pointerIndex);\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline AnyPointer::Pipeline getPointerField(uint16_t pointerIndex) {\n    // Return a new Promise representing a sub-object of the result.  `pointerIndex` is the index\n    // of the sub-object within the pointer section of the result (the result must be a struct).\n    //\n    // TODO(perf):  On GCC 4.8 / Clang 3.3, use rvalue qualifiers to avoid the need for copies.\n    //   Also make `ops` into a Vector to optimize this.\n    return typeless.getPointerField(pointerIndex);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.asInterface",
          "args": [],
          "line": 351
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerField",
          "args": [
            "structSizeFromSchema(structSchema)",
            "dval.isAnyPointer() ? nullptr :\n                                    dval.getStruct().getAs<_::UncheckedMessage>()"
          ],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dval.getStruct",
          "args": [],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dval.getStruct",
          "args": [],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dval.isAnyPointer",
          "args": [],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structSizeFromSchema",
          "args": [
            "structSchema"
          ],
          "line": 342
        },
        "resolved": true,
        "details": {
          "function_name": "structSizeFromSchema",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "98-103",
          "snippet": "inline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\ninline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}"
        }
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.asStruct",
          "args": [],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerField",
          "args": [
            "elementSizeFor(listType.whichElementType())",
            "dval.isAnyPointer() ? nullptr :\n                                    dval.getList().getAs<_::UncheckedMessage>()"
          ],
          "line": 331
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dval.getList",
          "args": [],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dval.getList",
          "args": [],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dval.isAnyPointer",
          "args": [],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elementSizeFor",
          "args": [
            "listType.whichElementType()"
          ],
          "line": 332
        },
        "resolved": true,
        "details": {
          "function_name": "elementSizeFor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "70-96",
          "snippet": "ElementSize elementSizeFor(schema::Type::Which elementType) {\n  switch (elementType) {\n    case schema::Type::VOID: return ElementSize::VOID;\n    case schema::Type::BOOL: return ElementSize::BIT;\n    case schema::Type::INT8: return ElementSize::BYTE;\n    case schema::Type::INT16: return ElementSize::TWO_BYTES;\n    case schema::Type::INT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::INT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::UINT8: return ElementSize::BYTE;\n    case schema::Type::UINT16: return ElementSize::TWO_BYTES;\n    case schema::Type::UINT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::UINT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::FLOAT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::FLOAT64: return ElementSize::EIGHT_BYTES;\n\n    case schema::Type::TEXT: return ElementSize::POINTER;\n    case schema::Type::DATA: return ElementSize::POINTER;\n    case schema::Type::LIST: return ElementSize::POINTER;\n    case schema::Type::ENUM: return ElementSize::TWO_BYTES;\n    case schema::Type::STRUCT: return ElementSize::INLINE_COMPOSITE;\n    case schema::Type::INTERFACE: return ElementSize::POINTER;\n    case schema::Type::ANY_POINTER: KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\"); break;\n  }\n\n  // Unknown type.  Treat it as zero-size.\n  return ElementSize::VOID;\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nElementSize elementSizeFor(schema::Type::Which elementType) {\n  switch (elementType) {\n    case schema::Type::VOID: return ElementSize::VOID;\n    case schema::Type::BOOL: return ElementSize::BIT;\n    case schema::Type::INT8: return ElementSize::BYTE;\n    case schema::Type::INT16: return ElementSize::TWO_BYTES;\n    case schema::Type::INT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::INT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::UINT8: return ElementSize::BYTE;\n    case schema::Type::UINT16: return ElementSize::TWO_BYTES;\n    case schema::Type::UINT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::UINT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::FLOAT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::FLOAT64: return ElementSize::EIGHT_BYTES;\n\n    case schema::Type::TEXT: return ElementSize::POINTER;\n    case schema::Type::DATA: return ElementSize::POINTER;\n    case schema::Type::LIST: return ElementSize::POINTER;\n    case schema::Type::ENUM: return ElementSize::TWO_BYTES;\n    case schema::Type::STRUCT: return ElementSize::INLINE_COMPOSITE;\n    case schema::Type::INTERFACE: return ElementSize::POINTER;\n    case schema::Type::ANY_POINTER: KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\"); break;\n  }\n\n  // Unknown type.  Treat it as zero-size.\n  return ElementSize::VOID;\n}"
        }
      },
      {
        "call_info": {
          "callee": "listType.whichElementType",
          "args": [],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 331
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerField",
          "args": [
            "structSizeFromSchema(listType.getStructElementType())",
            "dval.isAnyPointer() ? nullptr :\n                                          dval.getList().getAs<_::UncheckedMessage>()"
          ],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dval.getList",
          "args": [],
          "line": 328
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dval.getList",
          "args": [],
          "line": 328
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dval.isAnyPointer",
          "args": [],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "listType.getStructElementType",
          "args": [],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "listType.whichElementType",
          "args": [],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.asList",
          "args": [],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerField",
          "args": [
            "typedDval.begin()",
            "typedDval.size() * BYTES"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typedDval.size",
          "args": [],
          "line": 318
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "408-408",
          "snippet": "inline uint size() const { return builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline uint size() const { return builder.size() / ELEMENTS; }"
        }
      },
      {
        "call_info": {
          "callee": "typedDval.begin",
          "args": [],
          "line": 318
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "416-416",
          "snippet": "inline Iterator begin() { return Iterator(this, 0); }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline Iterator begin() { return Iterator(this, 0); }"
        }
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dval.getData",
          "args": [],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Data::Reader",
          "args": [],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dval.isAnyPointer",
          "args": [],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerField",
          "args": [
            "typedDval.begin()",
            "typedDval.size() * BYTES"
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dval.getText",
          "args": [],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Text::Reader",
          "args": [],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dval.isAnyPointer",
          "args": [],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DynamicEnum",
          "args": [
            "type.asEnum()",
            "builder.getDataField<uint16_t>(slot.getOffset() * ELEMENTS, typedDval)"
          ],
          "line": 305
        },
        "resolved": true,
        "details": {
          "function_name": "DynamicEnum",
          "container": "DynamicEnum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "132-133",
          "snippet": "inline DynamicEnum(EnumSchema schema, uint16_t value)\n      : schema(schema), value(value) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nDynamicEnum {\n  inline DynamicEnum(EnumSchema schema, uint16_t value)\n        : schema(schema), value(value) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "builder.getDataField<uint16_t>",
          "args": [
            "slot.getOffset() * ELEMENTS",
            "typedDval"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.asEnum",
          "args": [],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dval.getEnum",
          "args": [],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getDataField<Void>",
          "args": [
            "slot.getOffset() * ELEMENTS"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.which",
          "args": [],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slot.getDefaultValue",
          "args": [],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.getSlot",
          "args": [],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.which",
          "args": [],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getType",
          "args": [],
          "line": 268
        },
        "resolved": true,
        "details": {
          "function_name": "getType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "942-942",
          "snippet": "inline DynamicValue::Type getType() { return type; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline DynamicValue::Type getType() { return type; }"
        }
      },
      {
        "call_info": {
          "callee": "field.getProto",
          "args": [],
          "line": 267
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      },
      {
        "call_info": {
          "callee": "verifySetInUnion",
          "args": [
            "field"
          ],
          "line": 265
        },
        "resolved": true,
        "details": {
          "function_name": "DynamicStruct::Builder::verifySetInUnion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "157-161",
          "snippet": "void DynamicStruct::Builder::verifySetInUnion(StructSchema::Field field) {\n  KJ_REQUIRE(isSetInUnion(field),\n      \"Tried to get() a union member which is not currently initialized.\",\n      field.getProto().getName(), schema.getProto().getDisplayName());\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nvoid DynamicStruct::Builder::verifySetInUnion(StructSchema::Field field) {\n  KJ_REQUIRE(isSetInUnion(field),\n      \"Tried to get() a union member which is not currently initialized.\",\n      field.getProto().getName(), schema.getProto().getDisplayName());\n}"
        }
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "field.getContainingStruct() == schema",
            "\"`field` is not a field of this struct.\""
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getContainingStruct",
          "args": [],
          "line": 264
        },
        "resolved": true,
        "details": {
          "function_name": "getContainingStruct",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "274-274",
          "snippet": "inline StructSchema getContainingStruct() const { return parent; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline StructSchema getContainingStruct() const { return parent; }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicValue::Builder DynamicStruct::Builder::get(StructSchema::Field field) {\n  KJ_REQUIRE(field.getContainingStruct() == schema, \"`field` is not a field of this struct.\");\n  verifySetInUnion(field);\n\n  auto proto = field.getProto();\n  auto type = field.getType();\n  switch (proto.which()) {\n    case schema::Field::SLOT: {\n      auto slot = proto.getSlot();\n\n      // Note that the default value might be \"anyPointer\" even if the type is some poniter type\n      // *other than* anyPointer. This happens with generics -- the field is actually a generic\n      // parameter that has been bound, but the default value was of course compiled without any\n      // binding available.\n      auto dval = slot.getDefaultValue();\n\n      switch (type.which()) {\n        case schema::Type::VOID:\n          return builder.getDataField<Void>(slot.getOffset() * ELEMENTS);\n\n#define HANDLE_TYPE(discrim, titleCase, type) \\\n        case schema::Type::discrim: \\\n          return builder.getDataField<type>( \\\n              slot.getOffset() * ELEMENTS, \\\n              bitCast<_::Mask<type>>(dval.get##titleCase()));\n\n        HANDLE_TYPE(BOOL, Bool, bool)\n        HANDLE_TYPE(INT8, Int8, int8_t)\n        HANDLE_TYPE(INT16, Int16, int16_t)\n        HANDLE_TYPE(INT32, Int32, int32_t)\n        HANDLE_TYPE(INT64, Int64, int64_t)\n        HANDLE_TYPE(UINT8, Uint8, uint8_t)\n        HANDLE_TYPE(UINT16, Uint16, uint16_t)\n        HANDLE_TYPE(UINT32, Uint32, uint32_t)\n        HANDLE_TYPE(UINT64, Uint64, uint64_t)\n        HANDLE_TYPE(FLOAT32, Float32, float)\n        HANDLE_TYPE(FLOAT64, Float64, double)\n\n#undef HANDLE_TYPE\n\n        case schema::Type::ENUM: {\n          uint16_t typedDval = dval.getEnum();\n          return DynamicEnum(type.asEnum(),\n              builder.getDataField<uint16_t>(slot.getOffset() * ELEMENTS, typedDval));\n        }\n\n        case schema::Type::TEXT: {\n          Text::Reader typedDval = dval.isAnyPointer() ? Text::Reader() : dval.getText();\n          return builder.getPointerField(slot.getOffset() * POINTERS)\n                        .getBlob<Text>(typedDval.begin(), typedDval.size() * BYTES);\n        }\n\n        case schema::Type::DATA: {\n          Data::Reader typedDval = dval.isAnyPointer() ? Data::Reader() : dval.getData();\n          return builder.getPointerField(slot.getOffset() * POINTERS)\n                        .getBlob<Data>(typedDval.begin(), typedDval.size() * BYTES);\n        }\n\n        case schema::Type::LIST: {\n          ListSchema listType = type.asList();\n          if (listType.whichElementType() == schema::Type::STRUCT) {\n            return DynamicList::Builder(listType,\n                builder.getPointerField(slot.getOffset() * POINTERS)\n                       .getStructList(structSizeFromSchema(listType.getStructElementType()),\n                                      dval.isAnyPointer() ? nullptr :\n                                          dval.getList().getAs<_::UncheckedMessage>()));\n          } else {\n            return DynamicList::Builder(listType,\n                builder.getPointerField(slot.getOffset() * POINTERS)\n                       .getList(elementSizeFor(listType.whichElementType()),\n                                dval.isAnyPointer() ? nullptr :\n                                    dval.getList().getAs<_::UncheckedMessage>()));\n          }\n        }\n\n        case schema::Type::STRUCT: {\n          auto structSchema = type.asStruct();\n          return DynamicStruct::Builder(structSchema,\n              builder.getPointerField(slot.getOffset() * POINTERS)\n                     .getStruct(structSizeFromSchema(structSchema),\n                                dval.isAnyPointer() ? nullptr :\n                                    dval.getStruct().getAs<_::UncheckedMessage>()));\n        }\n\n        case schema::Type::ANY_POINTER:\n          return AnyPointer::Builder(builder.getPointerField(slot.getOffset() * POINTERS));\n\n        case schema::Type::INTERFACE:\n          return DynamicCapability::Client(type.asInterface(),\n              builder.getPointerField(slot.getOffset() * POINTERS).getCapability());\n      }\n\n      KJ_UNREACHABLE;\n    }\n\n    case schema::Field::GROUP:\n      return DynamicStruct::Builder(type.asStruct(), builder);\n  }\n\n  KJ_UNREACHABLE;\n}"
  },
  {
    "function_name": "DynamicStruct::Reader::get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "173-261",
    "snippet": "DynamicValue::Reader DynamicStruct::Reader::get(StructSchema::Field field) const {\n  KJ_REQUIRE(field.getContainingStruct() == schema, \"`field` is not a field of this struct.\");\n  verifySetInUnion(field);\n\n  auto type = field.getType();\n  auto proto = field.getProto();\n  switch (proto.which()) {\n    case schema::Field::SLOT: {\n      auto slot = proto.getSlot();\n\n      // Note that the default value might be \"anyPointer\" even if the type is some poniter type\n      // *other than* anyPointer. This happens with generics -- the field is actually a generic\n      // parameter that has been bound, but the default value was of course compiled without any\n      // binding available.\n      auto dval = slot.getDefaultValue();\n\n      switch (type.which()) {\n        case schema::Type::VOID:\n          return reader.getDataField<Void>(slot.getOffset() * ELEMENTS);\n\n#define HANDLE_TYPE(discrim, titleCase, type) \\\n        case schema::Type::discrim: \\\n          return reader.getDataField<type>( \\\n              slot.getOffset() * ELEMENTS, \\\n              bitCast<_::Mask<type>>(dval.get##titleCase()));\n\n        HANDLE_TYPE(BOOL, Bool, bool)\n        HANDLE_TYPE(INT8, Int8, int8_t)\n        HANDLE_TYPE(INT16, Int16, int16_t)\n        HANDLE_TYPE(INT32, Int32, int32_t)\n        HANDLE_TYPE(INT64, Int64, int64_t)\n        HANDLE_TYPE(UINT8, Uint8, uint8_t)\n        HANDLE_TYPE(UINT16, Uint16, uint16_t)\n        HANDLE_TYPE(UINT32, Uint32, uint32_t)\n        HANDLE_TYPE(UINT64, Uint64, uint64_t)\n        HANDLE_TYPE(FLOAT32, Float32, float)\n        HANDLE_TYPE(FLOAT64, Float64, double)\n\n#undef HANDLE_TYPE\n\n        case schema::Type::ENUM: {\n          uint16_t typedDval = dval.getEnum();\n          return DynamicEnum(type.asEnum(),\n              reader.getDataField<uint16_t>(slot.getOffset() * ELEMENTS, typedDval));\n        }\n\n        case schema::Type::TEXT: {\n          Text::Reader typedDval = dval.isAnyPointer() ? Text::Reader() : dval.getText();\n          return reader.getPointerField(slot.getOffset() * POINTERS)\n                       .getBlob<Text>(typedDval.begin(), typedDval.size() * BYTES);\n        }\n\n        case schema::Type::DATA: {\n          Data::Reader typedDval = dval.isAnyPointer() ? Data::Reader() : dval.getData();\n          return reader.getPointerField(slot.getOffset() * POINTERS)\n                       .getBlob<Data>(typedDval.begin(), typedDval.size() * BYTES);\n        }\n\n        case schema::Type::LIST: {\n          auto elementType = type.asList().getElementType();\n          return DynamicList::Reader(type.asList(),\n              reader.getPointerField(slot.getOffset() * POINTERS)\n                    .getList(elementSizeFor(elementType.which()), dval.isAnyPointer() ? nullptr :\n                        dval.getList().getAs<_::UncheckedMessage>()));\n        }\n\n        case schema::Type::STRUCT:\n          return DynamicStruct::Reader(type.asStruct(),\n              reader.getPointerField(slot.getOffset() * POINTERS)\n                    .getStruct(dval.isAnyPointer() ? nullptr :\n                        dval.getStruct().getAs<_::UncheckedMessage>()));\n\n        case schema::Type::ANY_POINTER:\n          return AnyPointer::Reader(reader.getPointerField(slot.getOffset() * POINTERS));\n\n        case schema::Type::INTERFACE:\n          return DynamicCapability::Client(type.asInterface(),\n              reader.getPointerField(slot.getOffset() * POINTERS).getCapability());\n      }\n\n      KJ_UNREACHABLE;\n    }\n\n    case schema::Field::GROUP:\n      return DynamicStruct::Reader(type.asStruct(), reader);\n  }\n\n  KJ_UNREACHABLE;\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DynamicStruct::Reader",
          "args": [
            "type.asStruct()",
            "reader"
          ],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "Reader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "377-377",
          "snippet": "Reader(ListSchema schema, _::ListReader reader): schema(schema), reader(reader) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nReader(ListSchema schema, _::ListReader reader): schema(schema), reader(reader) {}"
        }
      },
      {
        "call_info": {
          "callee": "type.asStruct",
          "args": [],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DynamicCapability::Client",
          "args": [
            "type.asInterface()",
            "reader.getPointerField(slot.getOffset() * POINTERS).getCapability()"
          ],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "Client",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "476-477",
          "snippet": "Client(InterfaceSchema schema, kj::Own<ClientHook>&& hook)\n      : Capability::Client(kj::mv(hook)), schema(schema) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nClient(InterfaceSchema schema, kj::Own<ClientHook>&& hook)\n      : Capability::Client(kj::mv(hook)), schema(schema) {}"
        }
      },
      {
        "call_info": {
          "callee": "reader.getPointerField",
          "args": [],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getPointerField",
          "args": [
            "slot.getOffset() * POINTERS"
          ],
          "line": 250
        },
        "resolved": true,
        "details": {
          "function_name": "getPointerField",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "490-497",
          "snippet": "inline AnyPointer::Pipeline getPointerField(uint16_t pointerIndex) {\n    // Return a new Promise representing a sub-object of the result.  `pointerIndex` is the index\n    // of the sub-object within the pointer section of the result (the result must be a struct).\n    //\n    // TODO(perf):  On GCC 4.8 / Clang 3.3, use rvalue qualifiers to avoid the need for copies.\n    //   Also make `ops` into a Vector to optimize this.\n    return typeless.getPointerField(pointerIndex);\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline AnyPointer::Pipeline getPointerField(uint16_t pointerIndex) {\n    // Return a new Promise representing a sub-object of the result.  `pointerIndex` is the index\n    // of the sub-object within the pointer section of the result (the result must be a struct).\n    //\n    // TODO(perf):  On GCC 4.8 / Clang 3.3, use rvalue qualifiers to avoid the need for copies.\n    //   Also make `ops` into a Vector to optimize this.\n    return typeless.getPointerField(pointerIndex);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.asInterface",
          "args": [],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dval.getStruct",
          "args": [],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dval.getStruct",
          "args": [],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dval.isAnyPointer",
          "args": [],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.asStruct",
          "args": [],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getPointerField",
          "args": [
            "elementSizeFor(elementType.which())",
            "dval.isAnyPointer() ? nullptr :\n                        dval.getList().getAs<_::UncheckedMessage>()"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dval.getList",
          "args": [],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dval.getList",
          "args": [],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dval.isAnyPointer",
          "args": [],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elementSizeFor",
          "args": [
            "elementType.which()"
          ],
          "line": 235
        },
        "resolved": true,
        "details": {
          "function_name": "elementSizeFor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "70-96",
          "snippet": "ElementSize elementSizeFor(schema::Type::Which elementType) {\n  switch (elementType) {\n    case schema::Type::VOID: return ElementSize::VOID;\n    case schema::Type::BOOL: return ElementSize::BIT;\n    case schema::Type::INT8: return ElementSize::BYTE;\n    case schema::Type::INT16: return ElementSize::TWO_BYTES;\n    case schema::Type::INT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::INT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::UINT8: return ElementSize::BYTE;\n    case schema::Type::UINT16: return ElementSize::TWO_BYTES;\n    case schema::Type::UINT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::UINT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::FLOAT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::FLOAT64: return ElementSize::EIGHT_BYTES;\n\n    case schema::Type::TEXT: return ElementSize::POINTER;\n    case schema::Type::DATA: return ElementSize::POINTER;\n    case schema::Type::LIST: return ElementSize::POINTER;\n    case schema::Type::ENUM: return ElementSize::TWO_BYTES;\n    case schema::Type::STRUCT: return ElementSize::INLINE_COMPOSITE;\n    case schema::Type::INTERFACE: return ElementSize::POINTER;\n    case schema::Type::ANY_POINTER: KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\"); break;\n  }\n\n  // Unknown type.  Treat it as zero-size.\n  return ElementSize::VOID;\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nElementSize elementSizeFor(schema::Type::Which elementType) {\n  switch (elementType) {\n    case schema::Type::VOID: return ElementSize::VOID;\n    case schema::Type::BOOL: return ElementSize::BIT;\n    case schema::Type::INT8: return ElementSize::BYTE;\n    case schema::Type::INT16: return ElementSize::TWO_BYTES;\n    case schema::Type::INT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::INT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::UINT8: return ElementSize::BYTE;\n    case schema::Type::UINT16: return ElementSize::TWO_BYTES;\n    case schema::Type::UINT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::UINT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::FLOAT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::FLOAT64: return ElementSize::EIGHT_BYTES;\n\n    case schema::Type::TEXT: return ElementSize::POINTER;\n    case schema::Type::DATA: return ElementSize::POINTER;\n    case schema::Type::LIST: return ElementSize::POINTER;\n    case schema::Type::ENUM: return ElementSize::TWO_BYTES;\n    case schema::Type::STRUCT: return ElementSize::INLINE_COMPOSITE;\n    case schema::Type::INTERFACE: return ElementSize::POINTER;\n    case schema::Type::ANY_POINTER: KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\"); break;\n  }\n\n  // Unknown type.  Treat it as zero-size.\n  return ElementSize::VOID;\n}"
        }
      },
      {
        "call_info": {
          "callee": "elementType.which",
          "args": [],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.asList",
          "args": [],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.asList",
          "args": [],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.asList",
          "args": [],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getPointerField",
          "args": [
            "typedDval.begin()",
            "typedDval.size() * BYTES"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typedDval.size",
          "args": [],
          "line": 228
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "408-408",
          "snippet": "inline uint size() const { return builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline uint size() const { return builder.size() / ELEMENTS; }"
        }
      },
      {
        "call_info": {
          "callee": "typedDval.begin",
          "args": [],
          "line": 228
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "416-416",
          "snippet": "inline Iterator begin() { return Iterator(this, 0); }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline Iterator begin() { return Iterator(this, 0); }"
        }
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dval.getData",
          "args": [],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Data::Reader",
          "args": [],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dval.isAnyPointer",
          "args": [],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getPointerField",
          "args": [
            "typedDval.begin()",
            "typedDval.size() * BYTES"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dval.getText",
          "args": [],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Text::Reader",
          "args": [],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dval.isAnyPointer",
          "args": [],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DynamicEnum",
          "args": [
            "type.asEnum()",
            "reader.getDataField<uint16_t>(slot.getOffset() * ELEMENTS, typedDval)"
          ],
          "line": 215
        },
        "resolved": true,
        "details": {
          "function_name": "DynamicEnum",
          "container": "DynamicEnum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "132-133",
          "snippet": "inline DynamicEnum(EnumSchema schema, uint16_t value)\n      : schema(schema), value(value) {}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nDynamicEnum {\n  inline DynamicEnum(EnumSchema schema, uint16_t value)\n        : schema(schema), value(value) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "reader.getDataField<uint16_t>",
          "args": [
            "slot.getOffset() * ELEMENTS",
            "typedDval"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.asEnum",
          "args": [],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dval.getEnum",
          "args": [],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getDataField<Void>",
          "args": [
            "slot.getOffset() * ELEMENTS"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.which",
          "args": [],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slot.getDefaultValue",
          "args": [],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.getSlot",
          "args": [],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.which",
          "args": [],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getProto",
          "args": [],
          "line": 178
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      },
      {
        "call_info": {
          "callee": "field.getType",
          "args": [],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "getType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "942-942",
          "snippet": "inline DynamicValue::Type getType() { return type; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline DynamicValue::Type getType() { return type; }"
        }
      },
      {
        "call_info": {
          "callee": "verifySetInUnion",
          "args": [
            "field"
          ],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "DynamicStruct::Builder::verifySetInUnion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "157-161",
          "snippet": "void DynamicStruct::Builder::verifySetInUnion(StructSchema::Field field) {\n  KJ_REQUIRE(isSetInUnion(field),\n      \"Tried to get() a union member which is not currently initialized.\",\n      field.getProto().getName(), schema.getProto().getDisplayName());\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nvoid DynamicStruct::Builder::verifySetInUnion(StructSchema::Field field) {\n  KJ_REQUIRE(isSetInUnion(field),\n      \"Tried to get() a union member which is not currently initialized.\",\n      field.getProto().getName(), schema.getProto().getDisplayName());\n}"
        }
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "field.getContainingStruct() == schema",
            "\"`field` is not a field of this struct.\""
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getContainingStruct",
          "args": [],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "getContainingStruct",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "274-274",
          "snippet": "inline StructSchema getContainingStruct() const { return parent; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline StructSchema getContainingStruct() const { return parent; }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicValue::Reader DynamicStruct::Reader::get(StructSchema::Field field) const {\n  KJ_REQUIRE(field.getContainingStruct() == schema, \"`field` is not a field of this struct.\");\n  verifySetInUnion(field);\n\n  auto type = field.getType();\n  auto proto = field.getProto();\n  switch (proto.which()) {\n    case schema::Field::SLOT: {\n      auto slot = proto.getSlot();\n\n      // Note that the default value might be \"anyPointer\" even if the type is some poniter type\n      // *other than* anyPointer. This happens with generics -- the field is actually a generic\n      // parameter that has been bound, but the default value was of course compiled without any\n      // binding available.\n      auto dval = slot.getDefaultValue();\n\n      switch (type.which()) {\n        case schema::Type::VOID:\n          return reader.getDataField<Void>(slot.getOffset() * ELEMENTS);\n\n#define HANDLE_TYPE(discrim, titleCase, type) \\\n        case schema::Type::discrim: \\\n          return reader.getDataField<type>( \\\n              slot.getOffset() * ELEMENTS, \\\n              bitCast<_::Mask<type>>(dval.get##titleCase()));\n\n        HANDLE_TYPE(BOOL, Bool, bool)\n        HANDLE_TYPE(INT8, Int8, int8_t)\n        HANDLE_TYPE(INT16, Int16, int16_t)\n        HANDLE_TYPE(INT32, Int32, int32_t)\n        HANDLE_TYPE(INT64, Int64, int64_t)\n        HANDLE_TYPE(UINT8, Uint8, uint8_t)\n        HANDLE_TYPE(UINT16, Uint16, uint16_t)\n        HANDLE_TYPE(UINT32, Uint32, uint32_t)\n        HANDLE_TYPE(UINT64, Uint64, uint64_t)\n        HANDLE_TYPE(FLOAT32, Float32, float)\n        HANDLE_TYPE(FLOAT64, Float64, double)\n\n#undef HANDLE_TYPE\n\n        case schema::Type::ENUM: {\n          uint16_t typedDval = dval.getEnum();\n          return DynamicEnum(type.asEnum(),\n              reader.getDataField<uint16_t>(slot.getOffset() * ELEMENTS, typedDval));\n        }\n\n        case schema::Type::TEXT: {\n          Text::Reader typedDval = dval.isAnyPointer() ? Text::Reader() : dval.getText();\n          return reader.getPointerField(slot.getOffset() * POINTERS)\n                       .getBlob<Text>(typedDval.begin(), typedDval.size() * BYTES);\n        }\n\n        case schema::Type::DATA: {\n          Data::Reader typedDval = dval.isAnyPointer() ? Data::Reader() : dval.getData();\n          return reader.getPointerField(slot.getOffset() * POINTERS)\n                       .getBlob<Data>(typedDval.begin(), typedDval.size() * BYTES);\n        }\n\n        case schema::Type::LIST: {\n          auto elementType = type.asList().getElementType();\n          return DynamicList::Reader(type.asList(),\n              reader.getPointerField(slot.getOffset() * POINTERS)\n                    .getList(elementSizeFor(elementType.which()), dval.isAnyPointer() ? nullptr :\n                        dval.getList().getAs<_::UncheckedMessage>()));\n        }\n\n        case schema::Type::STRUCT:\n          return DynamicStruct::Reader(type.asStruct(),\n              reader.getPointerField(slot.getOffset() * POINTERS)\n                    .getStruct(dval.isAnyPointer() ? nullptr :\n                        dval.getStruct().getAs<_::UncheckedMessage>()));\n\n        case schema::Type::ANY_POINTER:\n          return AnyPointer::Reader(reader.getPointerField(slot.getOffset() * POINTERS));\n\n        case schema::Type::INTERFACE:\n          return DynamicCapability::Client(type.asInterface(),\n              reader.getPointerField(slot.getOffset() * POINTERS).getCapability());\n      }\n\n      KJ_UNREACHABLE;\n    }\n\n    case schema::Field::GROUP:\n      return DynamicStruct::Reader(type.asStruct(), reader);\n  }\n\n  KJ_UNREACHABLE;\n}"
  },
  {
    "function_name": "DynamicStruct::Builder::setInUnion",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "163-171",
    "snippet": "void DynamicStruct::Builder::setInUnion(StructSchema::Field field) {\n  // If a union member, set the discriminant to match.\n  auto proto = field.getProto();\n  if (hasDiscriminantValue(proto)) {\n    builder.setDataField<uint16_t>(\n        schema.getProto().getStruct().getDiscriminantOffset() * ELEMENTS,\n        proto.getDiscriminantValue());\n  }\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "builder.setDataField<uint16_t>",
          "args": [
            "schema.getProto().getStruct().getDiscriminantOffset() * ELEMENTS",
            "proto.getDiscriminantValue()"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.getDiscriminantValue",
          "args": [],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getProto",
          "args": [],
          "line": 168
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      },
      {
        "call_info": {
          "callee": "hasDiscriminantValue",
          "args": [
            "proto"
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "hasDiscriminantValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "29-31",
          "snippet": "bool hasDiscriminantValue(const schema::Field::Reader& reader) {\n  return reader.getDiscriminantValue() != schema::Field::NO_DISCRIMINANT;\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nbool hasDiscriminantValue(const schema::Field::Reader& reader) {\n  return reader.getDiscriminantValue() != schema::Field::NO_DISCRIMINANT;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nvoid DynamicStruct::Builder::setInUnion(StructSchema::Field field) {\n  // If a union member, set the discriminant to match.\n  auto proto = field.getProto();\n  if (hasDiscriminantValue(proto)) {\n    builder.setDataField<uint16_t>(\n        schema.getProto().getStruct().getDiscriminantOffset() * ELEMENTS,\n        proto.getDiscriminantValue());\n  }\n}"
  },
  {
    "function_name": "DynamicStruct::Builder::verifySetInUnion",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "157-161",
    "snippet": "void DynamicStruct::Builder::verifySetInUnion(StructSchema::Field field) {\n  KJ_REQUIRE(isSetInUnion(field),\n      \"Tried to get() a union member which is not currently initialized.\",\n      field.getProto().getName(), schema.getProto().getDisplayName());\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "isSetInUnion(field)",
            "\"Tried to get() a union member which is not currently initialized.\"",
            "field.getProto().getName()",
            "schema.getProto().getDisplayName()"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getProto",
          "args": [],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      },
      {
        "call_info": {
          "callee": "isSetInUnion",
          "args": [
            "field"
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "DynamicStruct::Builder::isSetInUnion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "146-155",
          "snippet": "bool DynamicStruct::Builder::isSetInUnion(StructSchema::Field field) {\n  auto proto = field.getProto();\n  if (hasDiscriminantValue(proto)) {\n    uint16_t discrim = builder.getDataField<uint16_t>(\n        schema.getProto().getStruct().getDiscriminantOffset() * ELEMENTS);\n    return discrim == proto.getDiscriminantValue();\n  } else {\n    return true;\n  }\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nbool DynamicStruct::Builder::isSetInUnion(StructSchema::Field field) {\n  auto proto = field.getProto();\n  if (hasDiscriminantValue(proto)) {\n    uint16_t discrim = builder.getDataField<uint16_t>(\n        schema.getProto().getStruct().getDiscriminantOffset() * ELEMENTS);\n    return discrim == proto.getDiscriminantValue();\n  } else {\n    return true;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nvoid DynamicStruct::Builder::verifySetInUnion(StructSchema::Field field) {\n  KJ_REQUIRE(isSetInUnion(field),\n      \"Tried to get() a union member which is not currently initialized.\",\n      field.getProto().getName(), schema.getProto().getDisplayName());\n}"
  },
  {
    "function_name": "DynamicStruct::Builder::isSetInUnion",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "146-155",
    "snippet": "bool DynamicStruct::Builder::isSetInUnion(StructSchema::Field field) {\n  auto proto = field.getProto();\n  if (hasDiscriminantValue(proto)) {\n    uint16_t discrim = builder.getDataField<uint16_t>(\n        schema.getProto().getStruct().getDiscriminantOffset() * ELEMENTS);\n    return discrim == proto.getDiscriminantValue();\n  } else {\n    return true;\n  }\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "proto.getDiscriminantValue",
          "args": [],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getDataField<uint16_t>",
          "args": [
            "schema.getProto().getStruct().getDiscriminantOffset() * ELEMENTS"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getProto",
          "args": [],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      },
      {
        "call_info": {
          "callee": "hasDiscriminantValue",
          "args": [
            "proto"
          ],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "hasDiscriminantValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "29-31",
          "snippet": "bool hasDiscriminantValue(const schema::Field::Reader& reader) {\n  return reader.getDiscriminantValue() != schema::Field::NO_DISCRIMINANT;\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nbool hasDiscriminantValue(const schema::Field::Reader& reader) {\n  return reader.getDiscriminantValue() != schema::Field::NO_DISCRIMINANT;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nbool DynamicStruct::Builder::isSetInUnion(StructSchema::Field field) {\n  auto proto = field.getProto();\n  if (hasDiscriminantValue(proto)) {\n    uint16_t discrim = builder.getDataField<uint16_t>(\n        schema.getProto().getStruct().getDiscriminantOffset() * ELEMENTS);\n    return discrim == proto.getDiscriminantValue();\n  } else {\n    return true;\n  }\n}"
  },
  {
    "function_name": "DynamicStruct::Reader::verifySetInUnion",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "140-144",
    "snippet": "void DynamicStruct::Reader::verifySetInUnion(StructSchema::Field field) const {\n  KJ_REQUIRE(isSetInUnion(field),\n      \"Tried to get() a union member which is not currently initialized.\",\n      field.getProto().getName(), schema.getProto().getDisplayName());\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "isSetInUnion(field)",
            "\"Tried to get() a union member which is not currently initialized.\"",
            "field.getProto().getName()",
            "schema.getProto().getDisplayName()"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getProto",
          "args": [],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      },
      {
        "call_info": {
          "callee": "isSetInUnion",
          "args": [
            "field"
          ],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "DynamicStruct::Builder::isSetInUnion",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "146-155",
          "snippet": "bool DynamicStruct::Builder::isSetInUnion(StructSchema::Field field) {\n  auto proto = field.getProto();\n  if (hasDiscriminantValue(proto)) {\n    uint16_t discrim = builder.getDataField<uint16_t>(\n        schema.getProto().getStruct().getDiscriminantOffset() * ELEMENTS);\n    return discrim == proto.getDiscriminantValue();\n  } else {\n    return true;\n  }\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nbool DynamicStruct::Builder::isSetInUnion(StructSchema::Field field) {\n  auto proto = field.getProto();\n  if (hasDiscriminantValue(proto)) {\n    uint16_t discrim = builder.getDataField<uint16_t>(\n        schema.getProto().getStruct().getDiscriminantOffset() * ELEMENTS);\n    return discrim == proto.getDiscriminantValue();\n  } else {\n    return true;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nvoid DynamicStruct::Reader::verifySetInUnion(StructSchema::Field field) const {\n  KJ_REQUIRE(isSetInUnion(field),\n      \"Tried to get() a union member which is not currently initialized.\",\n      field.getProto().getName(), schema.getProto().getDisplayName());\n}"
  },
  {
    "function_name": "DynamicStruct::Reader::isSetInUnion",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "129-138",
    "snippet": "bool DynamicStruct::Reader::isSetInUnion(StructSchema::Field field) const {\n  auto proto = field.getProto();\n  if (hasDiscriminantValue(proto)) {\n    uint16_t discrim = reader.getDataField<uint16_t>(\n        schema.getProto().getStruct().getDiscriminantOffset() * ELEMENTS);\n    return discrim == proto.getDiscriminantValue();\n  } else {\n    return true;\n  }\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "proto.getDiscriminantValue",
          "args": [],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getDataField<uint16_t>",
          "args": [
            "schema.getProto().getStruct().getDiscriminantOffset() * ELEMENTS"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getProto",
          "args": [],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      },
      {
        "call_info": {
          "callee": "hasDiscriminantValue",
          "args": [
            "proto"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "hasDiscriminantValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "29-31",
          "snippet": "bool hasDiscriminantValue(const schema::Field::Reader& reader) {\n  return reader.getDiscriminantValue() != schema::Field::NO_DISCRIMINANT;\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nbool hasDiscriminantValue(const schema::Field::Reader& reader) {\n  return reader.getDiscriminantValue() != schema::Field::NO_DISCRIMINANT;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nbool DynamicStruct::Reader::isSetInUnion(StructSchema::Field field) const {\n  auto proto = field.getProto();\n  if (hasDiscriminantValue(proto)) {\n    uint16_t discrim = reader.getDataField<uint16_t>(\n        schema.getProto().getStruct().getDiscriminantOffset() * ELEMENTS);\n    return discrim == proto.getDiscriminantValue();\n  } else {\n    return true;\n  }\n}"
  },
  {
    "function_name": "DynamicEnum::asImpl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "118-125",
    "snippet": "uint16_t DynamicEnum::asImpl(uint64_t requestedTypeId) const {\n  KJ_REQUIRE(requestedTypeId == schema.getProto().getId(),\n             \"Type mismatch in DynamicEnum.as().\") {\n    // use it anyway\n    break;\n  }\n  return value;\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "requestedTypeId == schema.getProto().getId()",
            "\"Type mismatch in DynamicEnum.as().\""
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getProto",
          "args": [],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nuint16_t DynamicEnum::asImpl(uint64_t requestedTypeId) const {\n  KJ_REQUIRE(requestedTypeId == schema.getProto().getId(),\n             \"Type mismatch in DynamicEnum.as().\") {\n    // use it anyway\n    break;\n  }\n  return value;\n}"
  },
  {
    "function_name": "DynamicEnum::getEnumerant",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "109-116",
    "snippet": "kj::Maybe<EnumSchema::Enumerant> DynamicEnum::getEnumerant() const {\n  auto enumerants = schema.getEnumerants();\n  if (value < enumerants.size()) {\n    return enumerants[value];\n  } else {\n    return nullptr;\n  }\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "enumerants.size",
          "args": [],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "408-408",
          "snippet": "inline uint size() const { return builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline uint size() const { return builder.size() / ELEMENTS; }"
        }
      },
      {
        "call_info": {
          "callee": "schema.getEnumerants",
          "args": [],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nkj::Maybe<EnumSchema::Enumerant> DynamicEnum::getEnumerant() const {\n  auto enumerants = schema.getEnumerants();\n  if (value < enumerants.size()) {\n    return enumerants[value];\n  } else {\n    return nullptr;\n  }\n}"
  },
  {
    "function_name": "structSizeFromSchema",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "98-103",
    "snippet": "inline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_::StructSize",
          "args": [
            "node.getDataWordCount() * WORDS",
            "node.getPointerCount() * POINTERS"
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "StructSize",
          "container": "StructSize",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/layout.h",
          "lines": "177-178",
          "snippet": "inline constexpr StructSize(WordCount data, WirePointerCount pointers)\n      : data(data), pointers(pointers) {}",
          "includes": [
            "#include \"endian.h\"",
            "#include \"blob.h\"",
            "#include \"common.h\"",
            "#include <kj/memory.h>",
            "#include <kj/common.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"endian.h\"\n#include \"blob.h\"\n#include \"common.h\"\n#include <kj/memory.h>\n#include <kj/common.h>\n\nStructSize {\n  inline constexpr StructSize(WordCount data, WirePointerCount pointers)\n        : data(data), pointers(pointers) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "node.getPointerCount",
          "args": [],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "node.getDataWordCount",
          "args": [],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getProto",
          "args": [],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\ninline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}"
  },
  {
    "function_name": "elementSizeFor",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "70-96",
    "snippet": "ElementSize elementSizeFor(schema::Type::Which elementType) {\n  switch (elementType) {\n    case schema::Type::VOID: return ElementSize::VOID;\n    case schema::Type::BOOL: return ElementSize::BIT;\n    case schema::Type::INT8: return ElementSize::BYTE;\n    case schema::Type::INT16: return ElementSize::TWO_BYTES;\n    case schema::Type::INT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::INT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::UINT8: return ElementSize::BYTE;\n    case schema::Type::UINT16: return ElementSize::TWO_BYTES;\n    case schema::Type::UINT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::UINT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::FLOAT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::FLOAT64: return ElementSize::EIGHT_BYTES;\n\n    case schema::Type::TEXT: return ElementSize::POINTER;\n    case schema::Type::DATA: return ElementSize::POINTER;\n    case schema::Type::LIST: return ElementSize::POINTER;\n    case schema::Type::ENUM: return ElementSize::TWO_BYTES;\n    case schema::Type::STRUCT: return ElementSize::INLINE_COMPOSITE;\n    case schema::Type::INTERFACE: return ElementSize::POINTER;\n    case schema::Type::ANY_POINTER: KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\"); break;\n  }\n\n  // Unknown type.  Treat it as zero-size.\n  return ElementSize::VOID;\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "KJ_FAIL_ASSERT",
          "args": [
            "\"List(AnyPointer) not supported.\""
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nElementSize elementSizeFor(schema::Type::Which elementType) {\n  switch (elementType) {\n    case schema::Type::VOID: return ElementSize::VOID;\n    case schema::Type::BOOL: return ElementSize::BIT;\n    case schema::Type::INT8: return ElementSize::BYTE;\n    case schema::Type::INT16: return ElementSize::TWO_BYTES;\n    case schema::Type::INT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::INT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::UINT8: return ElementSize::BYTE;\n    case schema::Type::UINT16: return ElementSize::TWO_BYTES;\n    case schema::Type::UINT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::UINT64: return ElementSize::EIGHT_BYTES;\n    case schema::Type::FLOAT32: return ElementSize::FOUR_BYTES;\n    case schema::Type::FLOAT64: return ElementSize::EIGHT_BYTES;\n\n    case schema::Type::TEXT: return ElementSize::POINTER;\n    case schema::Type::DATA: return ElementSize::POINTER;\n    case schema::Type::LIST: return ElementSize::POINTER;\n    case schema::Type::ENUM: return ElementSize::TWO_BYTES;\n    case schema::Type::STRUCT: return ElementSize::INLINE_COMPOSITE;\n    case schema::Type::INTERFACE: return ElementSize::POINTER;\n    case schema::Type::ANY_POINTER: KJ_FAIL_ASSERT(\"List(AnyPointer) not supported.\"); break;\n  }\n\n  // Unknown type.  Treat it as zero-size.\n  return ElementSize::VOID;\n}"
  },
  {
    "function_name": "bitCast",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "37-40",
    "snippet": "inline T bitCast(U value) {\n  static_assert(sizeof(T) == sizeof(U), \"Size must match.\");\n  return value;\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\ninline T bitCast(U value) {\n  static_assert(sizeof(T) == sizeof(U), \"Size must match.\");\n  return value;\n}"
  },
  {
    "function_name": "hasDiscriminantValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
    "lines": "29-31",
    "snippet": "bool hasDiscriminantValue(const schema::Field::Reader& reader) {\n  return reader.getDiscriminantValue() != schema::Field::NO_DISCRIMINANT;\n}",
    "includes": [
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reader.getDiscriminantValue",
          "args": [],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nbool hasDiscriminantValue(const schema::Field::Reader& reader) {\n  return reader.getDiscriminantValue() != schema::Field::NO_DISCRIMINANT;\n}"
  }
]