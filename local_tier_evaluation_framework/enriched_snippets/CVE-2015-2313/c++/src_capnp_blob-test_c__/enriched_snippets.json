[
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/blob-test.c++",
    "lines": "117-125",
    "snippet": "TEST(Blob, StlInterop) {\n  std::string foo = \"foo\";\n  Text::Reader reader = foo;\n\n  EXPECT_EQ(\"foo\", reader);\n\n  std::string bar = reader;\n  EXPECT_EQ(\"foo\", bar);\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <string>",
      "#include <iostream>",
      "#include <kj/compat/gtest.h>",
      "#include \"blob.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "bar"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "reader"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <string>\n#include <iostream>\n#include <kj/compat/gtest.h>\n#include \"blob.h\"\n\nTEST(Blob, StlInterop) {\n  std::string foo = \"foo\";\n  Text::Reader reader = foo;\n\n  EXPECT_EQ(\"foo\", reader);\n\n  std::string bar = reader;\n  EXPECT_EQ(\"foo\", bar);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/blob-test.c++",
    "lines": "79-114",
    "snippet": "TEST(Blob, Compare) {\n  EXPECT_TRUE (Text::Reader(\"foo\") == Text::Reader(\"foo\"));\n  EXPECT_FALSE(Text::Reader(\"foo\") != Text::Reader(\"foo\"));\n  EXPECT_TRUE (Text::Reader(\"foo\") <= Text::Reader(\"foo\"));\n  EXPECT_TRUE (Text::Reader(\"foo\") >= Text::Reader(\"foo\"));\n  EXPECT_FALSE(Text::Reader(\"foo\") <  Text::Reader(\"foo\"));\n  EXPECT_FALSE(Text::Reader(\"foo\") >  Text::Reader(\"foo\"));\n\n  EXPECT_FALSE(Text::Reader(\"foo\") == Text::Reader(\"bar\"));\n  EXPECT_TRUE (Text::Reader(\"foo\") != Text::Reader(\"bar\"));\n  EXPECT_FALSE(Text::Reader(\"foo\") <= Text::Reader(\"bar\"));\n  EXPECT_TRUE (Text::Reader(\"foo\") >= Text::Reader(\"bar\"));\n  EXPECT_FALSE(Text::Reader(\"foo\") <  Text::Reader(\"bar\"));\n  EXPECT_TRUE (Text::Reader(\"foo\") >  Text::Reader(\"bar\"));\n\n  EXPECT_FALSE(Text::Reader(\"bar\") == Text::Reader(\"foo\"));\n  EXPECT_TRUE (Text::Reader(\"bar\") != Text::Reader(\"foo\"));\n  EXPECT_TRUE (Text::Reader(\"bar\") <= Text::Reader(\"foo\"));\n  EXPECT_FALSE(Text::Reader(\"bar\") >= Text::Reader(\"foo\"));\n  EXPECT_TRUE (Text::Reader(\"bar\") <  Text::Reader(\"foo\"));\n  EXPECT_FALSE(Text::Reader(\"bar\") >  Text::Reader(\"foo\"));\n\n  EXPECT_FALSE(Text::Reader(\"foobar\") == Text::Reader(\"foo\"));\n  EXPECT_TRUE (Text::Reader(\"foobar\") != Text::Reader(\"foo\"));\n  EXPECT_FALSE(Text::Reader(\"foobar\") <= Text::Reader(\"foo\"));\n  EXPECT_TRUE (Text::Reader(\"foobar\") >= Text::Reader(\"foo\"));\n  EXPECT_FALSE(Text::Reader(\"foobar\") <  Text::Reader(\"foo\"));\n  EXPECT_TRUE (Text::Reader(\"foobar\") >  Text::Reader(\"foo\"));\n\n  EXPECT_FALSE(Text::Reader(\"foo\") == Text::Reader(\"foobar\"));\n  EXPECT_TRUE (Text::Reader(\"foo\") != Text::Reader(\"foobar\"));\n  EXPECT_TRUE (Text::Reader(\"foo\") <= Text::Reader(\"foobar\"));\n  EXPECT_FALSE(Text::Reader(\"foo\") >= Text::Reader(\"foobar\"));\n  EXPECT_TRUE (Text::Reader(\"foo\") <  Text::Reader(\"foobar\"));\n  EXPECT_FALSE(Text::Reader(\"foo\") >  Text::Reader(\"foobar\"));\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <string>",
      "#include <iostream>",
      "#include <kj/compat/gtest.h>",
      "#include \"blob.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "Text::Reader(\"foo\") >  Text::Reader(\"foobar\")"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Text::Reader",
          "args": [
            "\"foobar\""
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "Reader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "569-570",
          "snippet": "inline Reader(T&& value)\n      : _reader(_::PointerHelpers<FromReader<T>>::getInternalReader(kj::fwd<T>(value))) {}",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader(T&& value)\n      : _reader(_::PointerHelpers<FromReader<T>>::getInternalReader(kj::fwd<T>(value))) {}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "Text::Reader(\"foo\") <  Text::Reader(\"foobar\")"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "Text::Reader(\"foo\") >= Text::Reader(\"foobar\")"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "Text::Reader(\"foo\") <= Text::Reader(\"foobar\")"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "Text::Reader(\"foo\") != Text::Reader(\"foobar\")"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "Text::Reader(\"foo\") == Text::Reader(\"foobar\")"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "Text::Reader(\"foobar\") >  Text::Reader(\"foo\")"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "Text::Reader(\"foobar\") <  Text::Reader(\"foo\")"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "Text::Reader(\"foobar\") >= Text::Reader(\"foo\")"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "Text::Reader(\"foobar\") <= Text::Reader(\"foo\")"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "Text::Reader(\"foobar\") != Text::Reader(\"foo\")"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "Text::Reader(\"foobar\") == Text::Reader(\"foo\")"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "Text::Reader(\"bar\") >  Text::Reader(\"foo\")"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "Text::Reader(\"bar\") <  Text::Reader(\"foo\")"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "Text::Reader(\"bar\") >= Text::Reader(\"foo\")"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "Text::Reader(\"bar\") <= Text::Reader(\"foo\")"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "Text::Reader(\"bar\") != Text::Reader(\"foo\")"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "Text::Reader(\"bar\") == Text::Reader(\"foo\")"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "Text::Reader(\"foo\") >  Text::Reader(\"bar\")"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "Text::Reader(\"foo\") <  Text::Reader(\"bar\")"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "Text::Reader(\"foo\") >= Text::Reader(\"bar\")"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "Text::Reader(\"foo\") <= Text::Reader(\"bar\")"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "Text::Reader(\"foo\") != Text::Reader(\"bar\")"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "Text::Reader(\"foo\") == Text::Reader(\"bar\")"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "Text::Reader(\"foo\") >  Text::Reader(\"foo\")"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "Text::Reader(\"foo\") <  Text::Reader(\"foo\")"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "Text::Reader(\"foo\") >= Text::Reader(\"foo\")"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "Text::Reader(\"foo\") <= Text::Reader(\"foo\")"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "Text::Reader(\"foo\") != Text::Reader(\"foo\")"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "Text::Reader(\"foo\") == Text::Reader(\"foo\")"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <string>\n#include <iostream>\n#include <kj/compat/gtest.h>\n#include \"blob.h\"\n\nTEST(Blob, Compare) {\n  EXPECT_TRUE (Text::Reader(\"foo\") == Text::Reader(\"foo\"));\n  EXPECT_FALSE(Text::Reader(\"foo\") != Text::Reader(\"foo\"));\n  EXPECT_TRUE (Text::Reader(\"foo\") <= Text::Reader(\"foo\"));\n  EXPECT_TRUE (Text::Reader(\"foo\") >= Text::Reader(\"foo\"));\n  EXPECT_FALSE(Text::Reader(\"foo\") <  Text::Reader(\"foo\"));\n  EXPECT_FALSE(Text::Reader(\"foo\") >  Text::Reader(\"foo\"));\n\n  EXPECT_FALSE(Text::Reader(\"foo\") == Text::Reader(\"bar\"));\n  EXPECT_TRUE (Text::Reader(\"foo\") != Text::Reader(\"bar\"));\n  EXPECT_FALSE(Text::Reader(\"foo\") <= Text::Reader(\"bar\"));\n  EXPECT_TRUE (Text::Reader(\"foo\") >= Text::Reader(\"bar\"));\n  EXPECT_FALSE(Text::Reader(\"foo\") <  Text::Reader(\"bar\"));\n  EXPECT_TRUE (Text::Reader(\"foo\") >  Text::Reader(\"bar\"));\n\n  EXPECT_FALSE(Text::Reader(\"bar\") == Text::Reader(\"foo\"));\n  EXPECT_TRUE (Text::Reader(\"bar\") != Text::Reader(\"foo\"));\n  EXPECT_TRUE (Text::Reader(\"bar\") <= Text::Reader(\"foo\"));\n  EXPECT_FALSE(Text::Reader(\"bar\") >= Text::Reader(\"foo\"));\n  EXPECT_TRUE (Text::Reader(\"bar\") <  Text::Reader(\"foo\"));\n  EXPECT_FALSE(Text::Reader(\"bar\") >  Text::Reader(\"foo\"));\n\n  EXPECT_FALSE(Text::Reader(\"foobar\") == Text::Reader(\"foo\"));\n  EXPECT_TRUE (Text::Reader(\"foobar\") != Text::Reader(\"foo\"));\n  EXPECT_FALSE(Text::Reader(\"foobar\") <= Text::Reader(\"foo\"));\n  EXPECT_TRUE (Text::Reader(\"foobar\") >= Text::Reader(\"foo\"));\n  EXPECT_FALSE(Text::Reader(\"foobar\") <  Text::Reader(\"foo\"));\n  EXPECT_TRUE (Text::Reader(\"foobar\") >  Text::Reader(\"foo\"));\n\n  EXPECT_FALSE(Text::Reader(\"foo\") == Text::Reader(\"foobar\"));\n  EXPECT_TRUE (Text::Reader(\"foo\") != Text::Reader(\"foobar\"));\n  EXPECT_TRUE (Text::Reader(\"foo\") <= Text::Reader(\"foobar\"));\n  EXPECT_FALSE(Text::Reader(\"foo\") >= Text::Reader(\"foobar\"));\n  EXPECT_TRUE (Text::Reader(\"foo\") <  Text::Reader(\"foobar\"));\n  EXPECT_FALSE(Text::Reader(\"foo\") >  Text::Reader(\"foobar\"));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/blob-test.c++",
    "lines": "60-77",
    "snippet": "TEST(Blob, Data) {\n  Data::Reader data = dataLit(\"foo\");\n\n  EXPECT_EQ(dataLit(\"foo\"), data);\n  EXPECT_EQ(3u, data.size());\n\n  Data::Reader data2 = dataLit(\"bar\");\n  EXPECT_EQ(dataLit(\"bar\"), data2);\n\n  byte c[4] = \"baz\";\n  Data::Reader data3(c, 3);\n  EXPECT_EQ(dataLit(\"baz\"), data3);\n\n  Data::Builder builder(c, 3);\n  EXPECT_EQ(dataLit(\"baz\"), builder);\n\n  EXPECT_EQ(dataLit(\"az\"), builder.slice(1, 3));\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <string>",
      "#include <iostream>",
      "#include <kj/compat/gtest.h>",
      "#include \"blob.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "dataLit(\"az\")",
            "builder.slice(1, 3)"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.slice",
          "args": [
            "1",
            "3"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "slice",
          "container": "ArrayPtr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "1154-1157",
          "snippet": "inline ArrayPtr slice(size_t start, size_t end) {\n    KJ_IREQUIRE(start <= end && end <= size_, \"Out-of-bounds ArrayPtr::slice().\");\n    return ArrayPtr(ptr + start, end - start);\n  }",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\nArrayPtr {\n  inline ArrayPtr slice(size_t start, size_t end) {\n      KJ_IREQUIRE(start <= end && end <= size_, \"Out-of-bounds ArrayPtr::slice().\");\n      return ArrayPtr(ptr + start, end - start);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dataLit",
          "args": [
            "\"az\""
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "dataLit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/blob-test.c++",
          "lines": "56-58",
          "snippet": "Data::Reader dataLit(const char* str) {\n  return Data::Reader(reinterpret_cast<const byte*>(str), strlen(str));\n}",
          "includes": [
            "#include \"test-util.h\"",
            "#include <string>",
            "#include <iostream>",
            "#include <kj/compat/gtest.h>",
            "#include \"blob.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"test-util.h\"\n#include <string>\n#include <iostream>\n#include <kj/compat/gtest.h>\n#include \"blob.h\"\n\nData::Reader dataLit(const char* str) {\n  return Data::Reader(reinterpret_cast<const byte*>(str), strlen(str));\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "dataLit(\"baz\")",
            "builder"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "dataLit(\"baz\")",
            "data3"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "dataLit(\"bar\")",
            "data2"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "3u",
            "data.size()"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "data.size",
          "args": [],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "599-599",
          "snippet": "inline uint size() { return _builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline uint size() { return _builder.size() / ELEMENTS; }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "dataLit(\"foo\")",
            "data"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <string>\n#include <iostream>\n#include <kj/compat/gtest.h>\n#include \"blob.h\"\n\nTEST(Blob, Data) {\n  Data::Reader data = dataLit(\"foo\");\n\n  EXPECT_EQ(dataLit(\"foo\"), data);\n  EXPECT_EQ(3u, data.size());\n\n  Data::Reader data2 = dataLit(\"bar\");\n  EXPECT_EQ(dataLit(\"bar\"), data2);\n\n  byte c[4] = \"baz\";\n  Data::Reader data3(c, 3);\n  EXPECT_EQ(dataLit(\"baz\"), data3);\n\n  Data::Builder builder(c, 3);\n  EXPECT_EQ(dataLit(\"baz\"), builder);\n\n  EXPECT_EQ(dataLit(\"az\"), builder.slice(1, 3));\n}"
  },
  {
    "function_name": "dataLit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/blob-test.c++",
    "lines": "56-58",
    "snippet": "Data::Reader dataLit(const char* str) {\n  return Data::Reader(reinterpret_cast<const byte*>(str), strlen(str));\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <string>",
      "#include <iostream>",
      "#include <kj/compat/gtest.h>",
      "#include \"blob.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Data::Reader",
          "args": [
            "reinterpret_cast<const byte*>(str)",
            "strlen(str)"
          ],
          "line": 57
        },
        "resolved": true,
        "details": {
          "function_name": "Reader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/blob.h",
          "lines": "80-80",
          "snippet": "inline Reader(const char* value, size_t size): StringPtr(value, size) {}",
          "includes": [
            "#include <string.h>",
            "#include \"common.h\"",
            "#include <kj/string.h>",
            "#include <kj/common.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"common.h\"\n#include <kj/string.h>\n#include <kj/common.h>\n\ninline Reader(const char* value, size_t size): StringPtr(value, size) {}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "str"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<const byte*>",
          "args": [
            "str"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <string>\n#include <iostream>\n#include <kj/compat/gtest.h>\n#include \"blob.h\"\n\nData::Reader dataLit(const char* str) {\n  return Data::Reader(reinterpret_cast<const byte*>(str), strlen(str));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/blob-test.c++",
    "lines": "34-54",
    "snippet": "TEST(Blob, Text) {\n  std::string str = \"foo\";\n  Text::Reader text = str.c_str();\n\n  EXPECT_EQ(\"foo\", text);\n  EXPECT_STREQ(\"foo\", text.cStr());\n  EXPECT_STREQ(\"foo\", text.begin());\n  EXPECT_EQ(3u, text.size());\n\n  Text::Reader text2 = \"bar\";\n  EXPECT_EQ(\"bar\", text2);\n\n  char c[4] = \"baz\";\n  Text::Reader text3(c);\n  EXPECT_EQ(\"baz\", text3);\n\n  Text::Builder builder(c, 3);\n  EXPECT_EQ(\"baz\", builder);\n\n  EXPECT_EQ(kj::arrayPtr(\"az\", 2), builder.slice(1, 3));\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <string>",
      "#include <iostream>",
      "#include <kj/compat/gtest.h>",
      "#include \"blob.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "kj::arrayPtr(\"az\", 2)",
            "builder.slice(1, 3)"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.slice",
          "args": [
            "1",
            "3"
          ],
          "line": 53
        },
        "resolved": true,
        "details": {
          "function_name": "slice",
          "container": "ArrayPtr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "1154-1157",
          "snippet": "inline ArrayPtr slice(size_t start, size_t end) {\n    KJ_IREQUIRE(start <= end && end <= size_, \"Out-of-bounds ArrayPtr::slice().\");\n    return ArrayPtr(ptr + start, end - start);\n  }",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\nArrayPtr {\n  inline ArrayPtr slice(size_t start, size_t end) {\n      KJ_IREQUIRE(start <= end && end <= size_, \"Out-of-bounds ArrayPtr::slice().\");\n      return ArrayPtr(ptr + start, end - start);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::arrayPtr",
          "args": [
            "\"az\"",
            "2"
          ],
          "line": 53
        },
        "resolved": true,
        "details": {
          "function_name": "arrayPtr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "1194-1197",
          "snippet": "inline constexpr ArrayPtr<T> arrayPtr(T* begin, T* end) {\n  // Use this function to construct ArrayPtrs without writing out the type name.\n  return ArrayPtr<T>(begin, end);\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\ninline constexpr ArrayPtr<T> arrayPtr(T* begin, T* end) {\n  // Use this function to construct ArrayPtrs without writing out the type name.\n  return ArrayPtr<T>(begin, end);\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"baz\"",
            "builder"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"baz\"",
            "text3"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"bar\"",
            "text2"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "3u",
            "text.size()"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "text.size",
          "args": [],
          "line": 41
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "599-599",
          "snippet": "inline uint size() { return _builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline uint size() { return _builder.size() / ELEMENTS; }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_STREQ",
          "args": [
            "\"foo\"",
            "text.begin()"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "text.begin",
          "args": [],
          "line": 40
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "550-550",
          "snippet": "inline Iterator begin() { return Iterator(this, 0); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Iterator begin() { return Iterator(this, 0); }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_STREQ",
          "args": [
            "\"foo\"",
            "text.cStr()"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "text.cStr",
          "args": [],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "text"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str.c_str",
          "args": [],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <string>\n#include <iostream>\n#include <kj/compat/gtest.h>\n#include \"blob.h\"\n\nTEST(Blob, Text) {\n  std::string str = \"foo\";\n  Text::Reader text = str.c_str();\n\n  EXPECT_EQ(\"foo\", text);\n  EXPECT_STREQ(\"foo\", text.cStr());\n  EXPECT_STREQ(\"foo\", text.begin());\n  EXPECT_EQ(3u, text.size());\n\n  Text::Reader text2 = \"bar\";\n  EXPECT_EQ(\"bar\", text2);\n\n  char c[4] = \"baz\";\n  Text::Reader text3(c);\n  EXPECT_EQ(\"baz\", text3);\n\n  Text::Builder builder(c, 3);\n  EXPECT_EQ(\"baz\", builder);\n\n  EXPECT_EQ(kj::arrayPtr(\"az\", 2), builder.slice(1, 3));\n}"
  }
]