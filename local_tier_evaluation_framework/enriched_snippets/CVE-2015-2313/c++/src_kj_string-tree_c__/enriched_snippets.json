[
  {
    "function_name": "StringTree::flattenTo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.c++",
    "lines": "56-61",
    "snippet": "void StringTree::flattenTo(char* __restrict__ target) const {\n  visit([&target](ArrayPtr<const char> text) {\n    memcpy(target, text.begin(), text.size());\n    target += text.size();\n  });\n}",
    "includes": [
      "#include \"string-tree.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "visit",
          "args": [
            "[&target](ArrayPtr<const char> text) {\n    memcpy(target, text.begin(), text.size());\n    target += text.size();\n  }"
          ],
          "line": 57
        },
        "resolved": true,
        "details": {
          "function_name": "StringTree::visit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
          "lines": "154-166",
          "snippet": "void StringTree::visit(Func&& func) const {\n  size_t pos = 0;\n  for (auto& branch: branches) {\n    if (branch.index > pos) {\n      func(text.slice(pos, branch.index));\n      pos = branch.index;\n    }\n    branch.content.visit(func);\n  }\n  if (text.size() > pos) {\n    func(text.slice(pos, text.size()));\n  }\n}",
          "includes": [
            "#include \"string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"string.h\"\n\nvoid StringTree::visit(Func&& func) const {\n  size_t pos = 0;\n  for (auto& branch: branches) {\n    if (branch.index > pos) {\n      func(text.slice(pos, branch.index));\n      pos = branch.index;\n    }\n    branch.content.visit(func);\n  }\n  if (text.size() > pos) {\n    func(text.slice(pos, text.size()));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "text.size",
          "args": [],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "StringTree",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
          "lines": "55-55",
          "snippet": "inline size_t size() const { return size_; }",
          "includes": [
            "#include \"string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"string.h\"\n\nStringTree {\n  inline size_t size() const { return size_; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "target",
            "text.begin()",
            "text.size()"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "text.begin",
          "args": [],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "Repeat",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "692-692",
          "snippet": "inline Iterator begin() const { return Iterator(value, 0); }",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\nRepeat {\n  inline Iterator begin() const { return Iterator(value, 0); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"string-tree.h\"\n\nvoid StringTree::flattenTo(char* __restrict__ target) const {\n  visit([&target](ArrayPtr<const char> text) {\n    memcpy(target, text.begin(), text.size());\n    target += text.size();\n  });\n}"
  },
  {
    "function_name": "StringTree::flatten",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.c++",
    "lines": "50-54",
    "snippet": "String StringTree::flatten() const {\n  String result = heapString(size());\n  flattenTo(result.begin());\n  return result;\n}",
    "includes": [
      "#include \"string-tree.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "flattenTo",
          "args": [
            "result.begin()"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result.begin",
          "args": [],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "Repeat",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "692-692",
          "snippet": "inline Iterator begin() const { return Iterator(value, 0); }",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\nRepeat {\n  inline Iterator begin() const { return Iterator(value, 0); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "heapString",
          "args": [
            "size()"
          ],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "heapString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.c++",
          "lines": "36-40",
          "snippet": "String heapString(size_t size) {\n  char* buffer = _::HeapArrayDisposer::allocate<char>(size + 1);\n  buffer[size] = '\\0';\n  return String(buffer, size, _::HeapArrayDisposer::instance);\n}",
          "includes": [
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <float.h>",
            "#include <stdio.h>",
            "#include \"debug.h\"",
            "#include \"string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdlib.h>\n#include <errno.h>\n#include <float.h>\n#include <stdio.h>\n#include \"debug.h\"\n#include \"string.h\"\n\nString heapString(size_t size) {\n  char* buffer = _::HeapArrayDisposer::allocate<char>(size + 1);\n  buffer[size] = '\\0';\n  return String(buffer, size, _::HeapArrayDisposer::instance);\n}"
        }
      },
      {
        "call_info": {
          "callee": "size",
          "args": [],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "StringTree",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
          "lines": "55-55",
          "snippet": "inline size_t size() const { return size_; }",
          "includes": [
            "#include \"string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"string.h\"\n\nStringTree {\n  inline size_t size() const { return size_; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"string-tree.h\"\n\nString StringTree::flatten() const {\n  String result = heapString(size());\n  flattenTo(result.begin());\n  return result;\n}"
  },
  {
    "function_name": "StringTree::StringTree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.c++",
    "lines": "26-48",
    "snippet": "StringTree::StringTree(Array<StringTree>&& pieces, StringPtr delim)\n    : size_(0),\n      branches(heapArray<Branch>(pieces.size())) {\n  if (pieces.size() > 0) {\n    if (pieces.size() > 1 && delim.size() > 0) {\n      text = heapString((pieces.size() - 1) * delim.size());\n      size_ = text.size();\n    }\n\n    branches[0].index = 0;\n    branches[0].content = kj::mv(pieces[0]);\n    size_ += pieces[0].size();\n\n    for (uint i = 1; i < pieces.size(); i++) {\n      if (delim.size() > 0) {\n        memcpy(text.begin() + (i - 1) * delim.size(), delim.begin(), delim.size());\n      }\n      branches[i].index = i * delim.size();\n      branches[i].content = kj::mv(pieces[i]);\n      size_ += pieces[i].size();\n    }\n  }\n}",
    "includes": [
      "#include \"string-tree.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pieces[i].size",
          "args": [],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "StringTree",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
          "lines": "55-55",
          "snippet": "inline size_t size() const { return size_; }",
          "includes": [
            "#include \"string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"string.h\"\n\nStringTree {\n  inline size_t size() const { return size_; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "pieces[i]"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "text.begin() + (i - 1) * delim.size()",
            "delim.begin()",
            "delim.size()"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "delim.begin",
          "args": [],
          "line": 41
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "Repeat",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "692-692",
          "snippet": "inline Iterator begin() const { return Iterator(value, 0); }",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\nRepeat {\n  inline Iterator begin() const { return Iterator(value, 0); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "pieces[0]"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "heapString",
          "args": [
            "(pieces.size() - 1) * delim.size()"
          ],
          "line": 31
        },
        "resolved": true,
        "details": {
          "function_name": "heapString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.c++",
          "lines": "36-40",
          "snippet": "String heapString(size_t size) {\n  char* buffer = _::HeapArrayDisposer::allocate<char>(size + 1);\n  buffer[size] = '\\0';\n  return String(buffer, size, _::HeapArrayDisposer::instance);\n}",
          "includes": [
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <float.h>",
            "#include <stdio.h>",
            "#include \"debug.h\"",
            "#include \"string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdlib.h>\n#include <errno.h>\n#include <float.h>\n#include <stdio.h>\n#include \"debug.h\"\n#include \"string.h\"\n\nString heapString(size_t size) {\n  char* buffer = _::HeapArrayDisposer::allocate<char>(size + 1);\n  buffer[size] = '\\0';\n  return String(buffer, size, _::HeapArrayDisposer::instance);\n}"
        }
      },
      {
        "call_info": {
          "callee": "heapArray<Branch>",
          "args": [
            "pieces.size()"
          ],
          "line": 28
        },
        "resolved": true,
        "details": {
          "function_name": "heapArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "696-698",
          "snippet": "inline Array<T> heapArray(std::initializer_list<T> init) {\n  return heapArray<T>(init.begin(), init.end());\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\ninline Array<T> heapArray(std::initializer_list<T> init) {\n  return heapArray<T>(init.begin(), init.end());\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"string-tree.h\"\n\nStringTree::StringTree(Array<StringTree>&& pieces, StringPtr delim)\n    : size_(0),\n      branches(heapArray<Branch>(pieces.size())) {\n  if (pieces.size() > 0) {\n    if (pieces.size() > 1 && delim.size() > 0) {\n      text = heapString((pieces.size() - 1) * delim.size());\n      size_ = text.size();\n    }\n\n    branches[0].index = 0;\n    branches[0].content = kj::mv(pieces[0]);\n    size_ += pieces[0].size();\n\n    for (uint i = 1; i < pieces.size(); i++) {\n      if (delim.size() > 0) {\n        memcpy(text.begin() + (i - 1) * delim.size(), delim.begin(), delim.size());\n      }\n      branches[i].index = i * delim.size();\n      branches[i].content = kj::mv(pieces[i]);\n      size_ += pieces[i].size();\n    }\n  }\n}"
  }
]