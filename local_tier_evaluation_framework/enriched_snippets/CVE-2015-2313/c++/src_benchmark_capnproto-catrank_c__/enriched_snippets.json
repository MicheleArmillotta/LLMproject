[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-catrank.c++",
    "lines": "137-141",
    "snippet": "int main(int argc, char* argv[]) {\n  return capnp::benchmark::benchmarkMain<\n      capnp::benchmark::capnp::BenchmarkTypes,\n      capnp::benchmark::capnp::CatRankTestCase>(argc, argv);\n}",
    "includes": [
      "#include \"capnproto-common.h\"",
      "#include \"catrank.capnp.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "capnp::benchmark::benchmarkMain<\n      capnp::benchmark::capnp::BenchmarkTypes,\n      capnp::benchmark::capnp::CatRankTestCase>",
          "args": [
            "argc",
            "argv"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "benchmarkMain",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/common.h",
          "lines": "281-292",
          "snippet": "int benchmarkMain(int argc, char* argv[]) {\n  if (argc != 5) {\n    fprintf(stderr, \"USAGE:  %s MODE REUSE COMPRESSION ITERATION_COUNT\\n\", argv[0]);\n    return 1;\n  }\n\n  uint64_t iters = strtoull(argv[4], nullptr, 0);\n  uint64_t throughput = doBenchmark3<BenchmarkTypes, TestCase>(argv[1], argv[2], argv[3], iters);\n  fprintf(stdout, \"%llu\\n\", (long long unsigned int)throughput);\n\n  return 0;\n}",
          "includes": [
            "#include <vector>",
            "#include <string>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdexcept>",
            "#include <algorithm>",
            "#include <semaphore.h>",
            "#include <stdlib.h>",
            "#include <sys/wait.h>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include <errno.h>",
            "#include <limits>",
            "#include <unistd.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <stdio.h>\n#include <stdexcept>\n#include <algorithm>\n#include <semaphore.h>\n#include <stdlib.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include <errno.h>\n#include <limits>\n#include <unistd.h>\n\nint benchmarkMain(int argc, char* argv[]) {\n  if (argc != 5) {\n    fprintf(stderr, \"USAGE:  %s MODE REUSE COMPRESSION ITERATION_COUNT\\n\", argv[0]);\n    return 1;\n  }\n\n  uint64_t iters = strtoull(argv[4], nullptr, 0);\n  uint64_t throughput = doBenchmark3<BenchmarkTypes, TestCase>(argv[1], argv[2], argv[3], iters);\n  fprintf(stdout, \"%llu\\n\", (long long unsigned int)throughput);\n\n  return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"capnproto-common.h\"\n#include \"catrank.capnp.h\"\n\nint main(int argc, char* argv[]) {\n  return capnp::benchmark::benchmarkMain<\n      capnp::benchmark::capnp::BenchmarkTypes,\n      capnp::benchmark::capnp::CatRankTestCase>(argc, argv);\n}"
  },
  {
    "function_name": "checkResponse",
    "container": "CatRankTestCase",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-catrank.c++",
    "lines": "119-130",
    "snippet": "static bool checkResponse(SearchResultList::Reader response, int expectedGoodCount) {\n    int goodCount = 0;\n    for (auto result: response.getResults()) {\n      if (result.getScore() > 1001) {\n        ++goodCount;\n      } else {\n        break;\n      }\n    }\n\n    return goodCount == expectedGoodCount;\n  }",
    "includes": [
      "#include \"capnproto-common.h\"",
      "#include \"catrank.capnp.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "result.getScore",
          "args": [],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "response.getResults",
          "args": [],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "getResults",
          "container": "LocallyRedirectedRpcResponse",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1644-1646",
          "snippet": "AnyPointer::Reader getResults() override {\n      return message.getRoot<AnyPointer>();\n    }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nLocallyRedirectedRpcResponse {\n  AnyPointer::Reader getResults() override {\n        return message.getRoot<AnyPointer>();\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"capnproto-common.h\"\n#include \"catrank.capnp.h\"\n\nCatRankTestCase {\n  static bool checkResponse(SearchResultList::Reader response, int expectedGoodCount) {\n      int goodCount = 0;\n      for (auto result: response.getResults()) {\n        if (result.getScore() > 1001) {\n          ++goodCount;\n        } else {\n          break;\n        }\n      }\n  \n      return goodCount == expectedGoodCount;\n    }\n}"
  },
  {
    "function_name": "handleRequest",
    "container": "CatRankTestCase",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-catrank.c++",
    "lines": "93-117",
    "snippet": "static void handleRequest(SearchResultList::Reader request, SearchResultList::Builder response) {\n    std::vector<ScoredResult> scoredResults;\n\n    for (auto result: request.getResults()) {\n      double score = result.getScore();\n      if (strstr(result.getSnippet().cStr(), \" cat \") != nullptr) {\n        score *= 10000;\n      }\n      if (strstr(result.getSnippet().cStr(), \" dog \") != nullptr) {\n        score /= 10000;\n      }\n      scoredResults.emplace_back(score, result);\n    }\n\n    std::sort(scoredResults.begin(), scoredResults.end());\n\n    auto list = response.initResults(scoredResults.size());\n    auto iter = list.begin();\n    for (auto result: scoredResults) {\n      iter->setScore(result.score);\n      iter->setUrl(result.result.getUrl());\n      iter->setSnippet(result.result.getSnippet());\n      ++iter;\n    }\n  }",
    "includes": [
      "#include \"capnproto-common.h\"",
      "#include \"catrank.capnp.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iter->setSnippet",
          "args": [
            "result.result.getSnippet()"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result.result.getSnippet",
          "args": [],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter->setUrl",
          "args": [
            "result.result.getUrl()"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result.result.getUrl",
          "args": [],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iter->setScore",
          "args": [
            "result.score"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list.begin",
          "args": [],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "550-550",
          "snippet": "inline Iterator begin() { return Iterator(this, 0); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Iterator begin() { return Iterator(this, 0); }"
        }
      },
      {
        "call_info": {
          "callee": "response.initResults",
          "args": [
            "scoredResults.size()"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scoredResults.size",
          "args": [],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "599-599",
          "snippet": "inline uint size() { return _builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline uint size() { return _builder.size() / ELEMENTS; }"
        }
      },
      {
        "call_info": {
          "callee": "std::sort",
          "args": [
            "scoredResults.begin()",
            "scoredResults.end()"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scoredResults.end",
          "args": [],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "551-551",
          "snippet": "inline Iterator end() { return Iterator(this, size()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Iterator end() { return Iterator(this, size()); }"
        }
      },
      {
        "call_info": {
          "callee": "scoredResults.emplace_back",
          "args": [
            "score",
            "result"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "result.getSnippet().cStr()",
            "\" dog \""
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result.getSnippet",
          "args": [],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result.getSnippet",
          "args": [],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "result.getSnippet().cStr()",
            "\" cat \""
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result.getSnippet",
          "args": [],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result.getSnippet",
          "args": [],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result.getScore",
          "args": [],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request.getResults",
          "args": [],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "getResults",
          "container": "LocallyRedirectedRpcResponse",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1644-1646",
          "snippet": "AnyPointer::Reader getResults() override {\n      return message.getRoot<AnyPointer>();\n    }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nLocallyRedirectedRpcResponse {\n  AnyPointer::Reader getResults() override {\n        return message.getRoot<AnyPointer>();\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"capnproto-common.h\"\n#include \"catrank.capnp.h\"\n\nCatRankTestCase {\n  static void handleRequest(SearchResultList::Reader request, SearchResultList::Builder response) {\n      std::vector<ScoredResult> scoredResults;\n  \n      for (auto result: request.getResults()) {\n        double score = result.getScore();\n        if (strstr(result.getSnippet().cStr(), \" cat \") != nullptr) {\n          score *= 10000;\n        }\n        if (strstr(result.getSnippet().cStr(), \" dog \") != nullptr) {\n          score /= 10000;\n        }\n        scoredResults.emplace_back(score, result);\n      }\n  \n      std::sort(scoredResults.begin(), scoredResults.end());\n  \n      auto list = response.initResults(scoredResults.size());\n      auto iter = list.begin();\n      for (auto result: scoredResults) {\n        iter->setScore(result.score);\n        iter->setUrl(result.result.getUrl());\n        iter->setSnippet(result.result.getSnippet());\n        ++iter;\n      }\n    }\n}"
  },
  {
    "function_name": "setupRequest",
    "container": "CatRankTestCase",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-catrank.c++",
    "lines": "45-91",
    "snippet": "static int setupRequest(SearchResultList::Builder request) {\n    int count = fastRand(1000);\n    int goodCount = 0;\n\n    auto list = request.initResults(count);\n\n    for (int i = 0; i < count; i++) {\n      SearchResult::Builder result = list[i];\n      result.setScore(1000 - i);\n      int urlSize = fastRand(100);\n\n      static const char URL_PREFIX[] = \"http://example.com/\";\n      size_t urlPrefixLength = strlen(URL_PREFIX);\n      auto url = result.initUrl(urlSize + urlPrefixLength);\n\n      strcpy(url.begin(), URL_PREFIX);\n      char* pos = url.begin() + urlPrefixLength;\n      for (int j = 0; j < urlSize; j++) {\n        *pos++ = 'a' + fastRand(26);\n      }\n\n      bool isCat = fastRand(8) == 0;\n      bool isDog = fastRand(8) == 0;\n      goodCount += isCat && !isDog;\n\n      static std::string snippet;\n      snippet.clear();\n      snippet.push_back(' ');\n\n      int prefix = fastRand(20);\n      for (int j = 0; j < prefix; j++) {\n        snippet.append(WORDS[fastRand(WORDS_COUNT)]);\n      }\n\n      if (isCat) snippet.append(\"cat \");\n      if (isDog) snippet.append(\"dog \");\n\n      int suffix = fastRand(20);\n      for (int j = 0; j < suffix; j++) {\n        snippet.append(WORDS[fastRand(WORDS_COUNT)]);\n      }\n\n      result.setSnippet(Text::Reader(snippet.c_str(), snippet.size()));\n    }\n\n    return goodCount;\n  }",
    "includes": [
      "#include \"capnproto-common.h\"",
      "#include \"catrank.capnp.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "result.setSnippet",
          "args": [
            "Text::Reader(snippet.c_str(), snippet.size())"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Text::Reader",
          "args": [
            "snippet.c_str()",
            "snippet.size()"
          ],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "Reader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/blob.h",
          "lines": "80-80",
          "snippet": "inline Reader(const char* value, size_t size): StringPtr(value, size) {}",
          "includes": [
            "#include <string.h>",
            "#include \"common.h\"",
            "#include <kj/string.h>",
            "#include <kj/common.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"common.h\"\n#include <kj/string.h>\n#include <kj/common.h>\n\ninline Reader(const char* value, size_t size): StringPtr(value, size) {}"
        }
      },
      {
        "call_info": {
          "callee": "snippet.size",
          "args": [],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "599-599",
          "snippet": "inline uint size() { return _builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline uint size() { return _builder.size() / ELEMENTS; }"
        }
      },
      {
        "call_info": {
          "callee": "snippet.c_str",
          "args": [],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snippet.append",
          "args": [
            "WORDS[fastRand(WORDS_COUNT)]"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fastRand",
          "args": [
            "WORDS_COUNT"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "fastRand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/common.h",
          "lines": "64-66",
          "snippet": "static inline uint32_t fastRand(uint32_t range) {\n  return nextFastRand() % range;\n}",
          "includes": [
            "#include <vector>",
            "#include <string>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdexcept>",
            "#include <algorithm>",
            "#include <semaphore.h>",
            "#include <stdlib.h>",
            "#include <sys/wait.h>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include <errno.h>",
            "#include <limits>",
            "#include <unistd.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <stdio.h>\n#include <stdexcept>\n#include <algorithm>\n#include <semaphore.h>\n#include <stdlib.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include <errno.h>\n#include <limits>\n#include <unistd.h>\n\nstatic inline uint32_t fastRand(uint32_t range) {\n  return nextFastRand() % range;\n}"
        }
      },
      {
        "call_info": {
          "callee": "snippet.append",
          "args": [
            "\"dog \""
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snippet.append",
          "args": [
            "\"cat \""
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snippet.append",
          "args": [
            "WORDS[fastRand(WORDS_COUNT)]"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snippet.push_back",
          "args": [
            "' '"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snippet.clear",
          "args": [],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "TestPipe",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-packed-test.c++",
          "lines": "51-54",
          "snippet": "void clear(size_t preferredReadSize = kj::maxValue) {\n    resetRead(preferredReadSize);\n    data.clear();\n  }",
          "includes": [
            "#include \"test-util.h\"",
            "#include <stdlib.h>",
            "#include <string>",
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"serialize-packed.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"test-util.h\"\n#include <stdlib.h>\n#include <string>\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"serialize-packed.h\"\n\nTestPipe {\n  void clear(size_t preferredReadSize = kj::maxValue) {\n      resetRead(preferredReadSize);\n      data.clear();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "url.begin",
          "args": [],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "550-550",
          "snippet": "inline Iterator begin() { return Iterator(this, 0); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Iterator begin() { return Iterator(this, 0); }"
        }
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "url.begin()",
            "URL_PREFIX"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result.initUrl",
          "args": [
            "urlSize + urlPrefixLength"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "URL_PREFIX"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result.setScore",
          "args": [
            "1000 - i"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request.initResults",
          "args": [
            "count"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"capnproto-common.h\"\n#include \"catrank.capnp.h\"\n\nCatRankTestCase {\n  static int setupRequest(SearchResultList::Builder request) {\n      int count = fastRand(1000);\n      int goodCount = 0;\n  \n      auto list = request.initResults(count);\n  \n      for (int i = 0; i < count; i++) {\n        SearchResult::Builder result = list[i];\n        result.setScore(1000 - i);\n        int urlSize = fastRand(100);\n  \n        static const char URL_PREFIX[] = \"http://example.com/\";\n        size_t urlPrefixLength = strlen(URL_PREFIX);\n        auto url = result.initUrl(urlSize + urlPrefixLength);\n  \n        strcpy(url.begin(), URL_PREFIX);\n        char* pos = url.begin() + urlPrefixLength;\n        for (int j = 0; j < urlSize; j++) {\n          *pos++ = 'a' + fastRand(26);\n        }\n  \n        bool isCat = fastRand(8) == 0;\n        bool isDog = fastRand(8) == 0;\n        goodCount += isCat && !isDog;\n  \n        static std::string snippet;\n        snippet.clear();\n        snippet.push_back(' ');\n  \n        int prefix = fastRand(20);\n        for (int j = 0; j < prefix; j++) {\n          snippet.append(WORDS[fastRand(WORDS_COUNT)]);\n        }\n  \n        if (isCat) snippet.append(\"cat \");\n        if (isDog) snippet.append(\"dog \");\n  \n        int suffix = fastRand(20);\n        for (int j = 0; j < suffix; j++) {\n          snippet.append(WORDS[fastRand(WORDS_COUNT)]);\n        }\n  \n        result.setSnippet(Text::Reader(snippet.c_str(), snippet.size()));\n      }\n  \n      return goodCount;\n    }\n}"
  },
  {
    "function_name": "ScoredResult",
    "container": "ScoredResult",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-catrank.c++",
    "lines": "34-34",
    "snippet": "ScoredResult(double score, SearchResult::Reader result): score(score), result(result) {}",
    "includes": [
      "#include \"capnproto-common.h\"",
      "#include \"catrank.capnp.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"capnproto-common.h\"\n#include \"catrank.capnp.h\"\n\nScoredResult {\n  ScoredResult(double score, SearchResult::Reader result): score(score), result(result) {}\n}"
  }
]