[
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/message-test.c++",
    "lines": "123-152",
    "snippet": "TEST(Message, MessageBuilderInitSpaceAvailable) {\n  word buffer[2048];\n  memset(buffer, 0, sizeof(buffer));\n  MallocMessageBuilder builder(buffer);\n  initTestMessage(builder.getRoot<TestAllTypes>());\n\n  // Find out how much space in `buffer` was used in order to use in initializing the new message.\n  auto segs = builder.getSegmentsForOutput();\n  ASSERT_EQ(1, segs.size());\n  KJ_ASSERT(segs[0].begin() == buffer);\n\n  MessageBuilder::SegmentInit init = { kj::ArrayPtr<word>(buffer), segs[0].size() };\n\n  // Init a new builder from the old segments.\n  TestInitMessageBuilder builder2(kj::arrayPtr(&init, 1));\n  checkTestMessage(builder2.getRoot<TestAllTypes>());\n\n  // Verify that they're really using the same underlying memory.\n  builder2.getRoot<TestAllTypes>().setInt64Field(123321);\n  EXPECT_EQ(123321, builder.getRoot<TestAllTypes>().getInt64Field());\n\n  // Ask builder2 to allocate new space. It should go into the free space at the end of the\n  // segment.\n  EXPECT_EQ(0, builder2.allocations.size());\n  builder2.getRoot<TestAllTypes>().setTextField(\"foobarbaz\");\n  EXPECT_EQ(0, builder2.allocations.size());\n\n  EXPECT_EQ(kj::implicitCast<void*>(buffer + segs[0].size()),\n            kj::implicitCast<void*>(builder2.getRoot<TestAllTypes>().getTextField().begin()));\n}",
    "includes": [
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/array.h>",
      "#include \"test-util.h\"",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "kj::implicitCast<void*>(buffer + segs[0].size())",
            "kj::implicitCast<void*>(builder2.getRoot<TestAllTypes>().getTextField().begin())"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::implicitCast<void*>",
          "args": [
            "builder2.getRoot<TestAllTypes>().getTextField().begin()"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "implicitCast",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "1203-1207",
          "snippet": "To implicitCast(From&& from) {\n  // `implicitCast<T>(value)` casts `value` to type `T` only if the conversion is implicit.  Useful\n  // for e.g. resolving ambiguous overloads without sacrificing type-safety.\n  return kj::fwd<From>(from);\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\nTo implicitCast(From&& from) {\n  // `implicitCast<T>(value)` casts `value` to type `T` only if the conversion is implicit.  Useful\n  // for e.g. resolving ambiguous overloads without sacrificing type-safety.\n  return kj::fwd<From>(from);\n}"
        }
      },
      {
        "call_info": {
          "callee": "builder2.getRoot<TestAllTypes>",
          "args": [],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "getRoot",
          "container": "RpcRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1322-1324",
          "snippet": "inline AnyPointer::Builder getRoot() {\n      return paramsBuilder;\n    }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nRpcRequest {\n  inline AnyPointer::Builder getRoot() {\n        return paramsBuilder;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "segs[0].size",
          "args": [],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "599-599",
          "snippet": "inline uint size() { return _builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline uint size() { return _builder.size() / ELEMENTS; }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "0",
            "builder2.allocations.size()"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder2.getRoot<TestAllTypes>",
          "args": [
            "\"foobarbaz\""
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "0",
            "builder2.allocations.size()"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "123321",
            "builder.getRoot<TestAllTypes>().getInt64Field()"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder2.getRoot<TestAllTypes>",
          "args": [
            "123321"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "builder2.getRoot<TestAllTypes>()"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "kj::arrayPtr",
          "args": [
            "&init",
            "1"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "arrayPtr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "1194-1197",
          "snippet": "inline constexpr ArrayPtr<T> arrayPtr(T* begin, T* end) {\n  // Use this function to construct ArrayPtrs without writing out the type name.\n  return ArrayPtr<T>(begin, end);\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\ninline constexpr ArrayPtr<T> arrayPtr(T* begin, T* end) {\n  // Use this function to construct ArrayPtrs without writing out the type name.\n  return ArrayPtr<T>(begin, end);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::ArrayPtr<word>",
          "args": [
            "buffer"
          ],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "ArrayPtr",
          "container": "ArrayPtr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "1121-1121",
          "snippet": "inline constexpr ArrayPtr(T (&native)[size]): ptr(native), size_(size) {}",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\nArrayPtr {\n  inline constexpr ArrayPtr(T (&native)[size]): ptr(native), size_(size) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "KJ_ASSERT",
          "args": [
            "segs[0].begin() == buffer"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "segs[0].begin",
          "args": [],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "550-550",
          "snippet": "inline Iterator begin() { return Iterator(this, 0); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Iterator begin() { return Iterator(this, 0); }"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "1",
            "segs.size()"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "builder.getRoot<TestAllTypes>()"
          ],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "buffer",
            "0",
            "sizeof(buffer)"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/array.h>\n#include \"test-util.h\"\n#include \"message.h\"\n\nTEST(Message, MessageBuilderInitSpaceAvailable) {\n  word buffer[2048];\n  memset(buffer, 0, sizeof(buffer));\n  MallocMessageBuilder builder(buffer);\n  initTestMessage(builder.getRoot<TestAllTypes>());\n\n  // Find out how much space in `buffer` was used in order to use in initializing the new message.\n  auto segs = builder.getSegmentsForOutput();\n  ASSERT_EQ(1, segs.size());\n  KJ_ASSERT(segs[0].begin() == buffer);\n\n  MessageBuilder::SegmentInit init = { kj::ArrayPtr<word>(buffer), segs[0].size() };\n\n  // Init a new builder from the old segments.\n  TestInitMessageBuilder builder2(kj::arrayPtr(&init, 1));\n  checkTestMessage(builder2.getRoot<TestAllTypes>());\n\n  // Verify that they're really using the same underlying memory.\n  builder2.getRoot<TestAllTypes>().setInt64Field(123321);\n  EXPECT_EQ(123321, builder.getRoot<TestAllTypes>().getInt64Field());\n\n  // Ask builder2 to allocate new space. It should go into the free space at the end of the\n  // segment.\n  EXPECT_EQ(0, builder2.allocations.size());\n  builder2.getRoot<TestAllTypes>().setTextField(\"foobarbaz\");\n  EXPECT_EQ(0, builder2.allocations.size());\n\n  EXPECT_EQ(kj::implicitCast<void*>(buffer + segs[0].size()),\n            kj::implicitCast<void*>(builder2.getRoot<TestAllTypes>().getTextField().begin()));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/message-test.c++",
    "lines": "93-121",
    "snippet": "TEST(Message, MessageBuilderInitMultiSegment) {\n  // Same as previous test, but with a message containing many segments.\n\n  MallocMessageBuilder builder(1, AllocationStrategy::FIXED_SIZE);\n  initTestMessage(builder.getRoot<TestAllTypes>());\n\n  // Pull the segments out and make a segment init table out of them.\n  //\n  // We const_cast for simplicity of implementing the test, but you shouldn't do that at home. :)\n  auto segs = builder.getSegmentsForOutput();\n  ASSERT_NE(1, segs.size());\n\n  auto segInits = KJ_MAP(seg, segs) -> MessageBuilder::SegmentInit {\n    return { kj::arrayPtr(const_cast<word*>(seg.begin()), seg.size()), seg.size() };\n  };\n\n  // Init a new builder from the old segments.\n  TestInitMessageBuilder builder2(segInits);\n  checkTestMessage(builder2.getRoot<TestAllTypes>());\n\n  // Verify that they're really using the same underlying memory.\n  builder2.getRoot<TestAllTypes>().setInt64Field(123321);\n  EXPECT_EQ(123321, builder.getRoot<TestAllTypes>().getInt64Field());\n\n  // Force builder2 to allocate new space.\n  EXPECT_EQ(0, builder2.allocations.size());\n  builder2.getRoot<TestAllTypes>().setTextField(\"foobarbaz\");\n  EXPECT_EQ(1, builder2.allocations.size());\n}",
    "includes": [
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/array.h>",
      "#include \"test-util.h\"",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "1",
            "builder2.allocations.size()"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder2.allocations.size",
          "args": [],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "599-599",
          "snippet": "inline uint size() { return _builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline uint size() { return _builder.size() / ELEMENTS; }"
        }
      },
      {
        "call_info": {
          "callee": "builder2.getRoot<TestAllTypes>",
          "args": [
            "\"foobarbaz\""
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder2.getRoot<TestAllTypes>",
          "args": [],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "getRoot",
          "container": "RpcRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1322-1324",
          "snippet": "inline AnyPointer::Builder getRoot() {\n      return paramsBuilder;\n    }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nRpcRequest {\n  inline AnyPointer::Builder getRoot() {\n        return paramsBuilder;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "0",
            "builder2.allocations.size()"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "123321",
            "builder.getRoot<TestAllTypes>().getInt64Field()"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder2.getRoot<TestAllTypes>",
          "args": [
            "123321"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "builder2.getRoot<TestAllTypes>()"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "kj::arrayPtr",
          "args": [
            "const_cast<word*>(seg.begin())",
            "seg.size()"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "arrayPtr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "1194-1197",
          "snippet": "inline constexpr ArrayPtr<T> arrayPtr(T* begin, T* end) {\n  // Use this function to construct ArrayPtrs without writing out the type name.\n  return ArrayPtr<T>(begin, end);\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\ninline constexpr ArrayPtr<T> arrayPtr(T* begin, T* end) {\n  // Use this function to construct ArrayPtrs without writing out the type name.\n  return ArrayPtr<T>(begin, end);\n}"
        }
      },
      {
        "call_info": {
          "callee": "const_cast<word*>",
          "args": [
            "seg.begin()"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seg.begin",
          "args": [],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "550-550",
          "snippet": "inline Iterator begin() { return Iterator(this, 0); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Iterator begin() { return Iterator(this, 0); }"
        }
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "seg",
            "segs"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_NE",
          "args": [
            "1",
            "segs.size()"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "builder.getRoot<TestAllTypes>()"
          ],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/array.h>\n#include \"test-util.h\"\n#include \"message.h\"\n\nTEST(Message, MessageBuilderInitMultiSegment) {\n  // Same as previous test, but with a message containing many segments.\n\n  MallocMessageBuilder builder(1, AllocationStrategy::FIXED_SIZE);\n  initTestMessage(builder.getRoot<TestAllTypes>());\n\n  // Pull the segments out and make a segment init table out of them.\n  //\n  // We const_cast for simplicity of implementing the test, but you shouldn't do that at home. :)\n  auto segs = builder.getSegmentsForOutput();\n  ASSERT_NE(1, segs.size());\n\n  auto segInits = KJ_MAP(seg, segs) -> MessageBuilder::SegmentInit {\n    return { kj::arrayPtr(const_cast<word*>(seg.begin()), seg.size()), seg.size() };\n  };\n\n  // Init a new builder from the old segments.\n  TestInitMessageBuilder builder2(segInits);\n  checkTestMessage(builder2.getRoot<TestAllTypes>());\n\n  // Verify that they're really using the same underlying memory.\n  builder2.getRoot<TestAllTypes>().setInt64Field(123321);\n  EXPECT_EQ(123321, builder.getRoot<TestAllTypes>().getInt64Field());\n\n  // Force builder2 to allocate new space.\n  EXPECT_EQ(0, builder2.allocations.size());\n  builder2.getRoot<TestAllTypes>().setTextField(\"foobarbaz\");\n  EXPECT_EQ(1, builder2.allocations.size());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/message-test.c++",
    "lines": "65-91",
    "snippet": "TEST(Message, MessageBuilderInit) {\n  MallocMessageBuilder builder(2048);\n  initTestMessage(builder.getRoot<TestAllTypes>());\n\n  // Pull the segments out and make a segment init table out of them.\n  //\n  // We const_cast for simplicity of implementing the test, but you shouldn't do that at home. :)\n  auto segs = builder.getSegmentsForOutput();\n  ASSERT_EQ(1, segs.size());\n\n  auto segInits = KJ_MAP(seg, segs) -> MessageBuilder::SegmentInit {\n    return { kj::arrayPtr(const_cast<word*>(seg.begin()), seg.size()), seg.size() };\n  };\n\n  // Init a new builder from the old segments.\n  TestInitMessageBuilder builder2(segInits);\n  checkTestMessage(builder2.getRoot<TestAllTypes>());\n\n  // Verify that they're really using the same underlying memory.\n  builder2.getRoot<TestAllTypes>().setInt64Field(123321);\n  EXPECT_EQ(123321, builder.getRoot<TestAllTypes>().getInt64Field());\n\n  // Force builder2 to allocate new space.\n  EXPECT_EQ(0, builder2.allocations.size());\n  builder2.getRoot<TestAllTypes>().setTextField(\"foobarbaz\");\n  EXPECT_EQ(1, builder2.allocations.size());\n}",
    "includes": [
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/array.h>",
      "#include \"test-util.h\"",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "1",
            "builder2.allocations.size()"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder2.allocations.size",
          "args": [],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "599-599",
          "snippet": "inline uint size() { return _builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline uint size() { return _builder.size() / ELEMENTS; }"
        }
      },
      {
        "call_info": {
          "callee": "builder2.getRoot<TestAllTypes>",
          "args": [
            "\"foobarbaz\""
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder2.getRoot<TestAllTypes>",
          "args": [],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "getRoot",
          "container": "RpcRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1322-1324",
          "snippet": "inline AnyPointer::Builder getRoot() {\n      return paramsBuilder;\n    }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nRpcRequest {\n  inline AnyPointer::Builder getRoot() {\n        return paramsBuilder;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "0",
            "builder2.allocations.size()"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "123321",
            "builder.getRoot<TestAllTypes>().getInt64Field()"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder2.getRoot<TestAllTypes>",
          "args": [
            "123321"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "builder2.getRoot<TestAllTypes>()"
          ],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "kj::arrayPtr",
          "args": [
            "const_cast<word*>(seg.begin())",
            "seg.size()"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "arrayPtr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "1194-1197",
          "snippet": "inline constexpr ArrayPtr<T> arrayPtr(T* begin, T* end) {\n  // Use this function to construct ArrayPtrs without writing out the type name.\n  return ArrayPtr<T>(begin, end);\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\ninline constexpr ArrayPtr<T> arrayPtr(T* begin, T* end) {\n  // Use this function to construct ArrayPtrs without writing out the type name.\n  return ArrayPtr<T>(begin, end);\n}"
        }
      },
      {
        "call_info": {
          "callee": "const_cast<word*>",
          "args": [
            "seg.begin()"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seg.begin",
          "args": [],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "550-550",
          "snippet": "inline Iterator begin() { return Iterator(this, 0); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Iterator begin() { return Iterator(this, 0); }"
        }
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "seg",
            "segs"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "1",
            "segs.size()"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "builder.getRoot<TestAllTypes>()"
          ],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/array.h>\n#include \"test-util.h\"\n#include \"message.h\"\n\nTEST(Message, MessageBuilderInit) {\n  MallocMessageBuilder builder(2048);\n  initTestMessage(builder.getRoot<TestAllTypes>());\n\n  // Pull the segments out and make a segment init table out of them.\n  //\n  // We const_cast for simplicity of implementing the test, but you shouldn't do that at home. :)\n  auto segs = builder.getSegmentsForOutput();\n  ASSERT_EQ(1, segs.size());\n\n  auto segInits = KJ_MAP(seg, segs) -> MessageBuilder::SegmentInit {\n    return { kj::arrayPtr(const_cast<word*>(seg.begin()), seg.size()), seg.size() };\n  };\n\n  // Init a new builder from the old segments.\n  TestInitMessageBuilder builder2(segInits);\n  checkTestMessage(builder2.getRoot<TestAllTypes>());\n\n  // Verify that they're really using the same underlying memory.\n  builder2.getRoot<TestAllTypes>().setInt64Field(123321);\n  EXPECT_EQ(123321, builder.getRoot<TestAllTypes>().getInt64Field());\n\n  // Force builder2 to allocate new space.\n  EXPECT_EQ(0, builder2.allocations.size());\n  builder2.getRoot<TestAllTypes>().setTextField(\"foobarbaz\");\n  EXPECT_EQ(1, builder2.allocations.size());\n}"
  },
  {
    "function_name": "allocateSegment",
    "container": "TestInitMessageBuilder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/message-test.c++",
    "lines": "55-60",
    "snippet": "kj::ArrayPtr<word> allocateSegment(uint minimumSize) override {\n    auto array = kj::heapArray<word>(minimumSize);\n    memset(array.begin(), 0, array.asBytes().size());\n    allocations.add(kj::mv(array));\n    return allocations.back();\n  }",
    "includes": [
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/array.h>",
      "#include \"test-util.h\"",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "allocations.back",
          "args": [],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "allocations.add",
          "args": [
            "kj::mv(array)"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "add",
          "container": "ReusableObjects::ObjectSizeCounter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/null-common.h",
          "lines": "86-88",
          "snippet": "void add(size_t wordCount) {\n      maxSize = std::max(wordCount, maxSize);\n    }",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nReusableObjects {\n  ObjectSizeCounter {\n    void add(size_t wordCount) {\n          maxSize = std::max(wordCount, maxSize);\n        }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "array"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "array.begin()",
            "0",
            "array.asBytes().size()"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "array.asBytes",
          "args": [],
          "line": 57
        },
        "resolved": true,
        "details": {
          "function_name": "asBytes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/blob.h",
          "lines": "128-128",
          "snippet": "inline kj::ArrayPtr<const byte> asBytes() const { return asArray().asBytes(); }",
          "includes": [
            "#include <string.h>",
            "#include \"common.h\"",
            "#include <kj/string.h>",
            "#include <kj/common.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"common.h\"\n#include <kj/string.h>\n#include <kj/common.h>\n\ninline kj::ArrayPtr<const byte> asBytes() const { return asArray().asBytes(); }"
        }
      },
      {
        "call_info": {
          "callee": "array.begin",
          "args": [],
          "line": 57
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "550-550",
          "snippet": "inline Iterator begin() { return Iterator(this, 0); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Iterator begin() { return Iterator(this, 0); }"
        }
      },
      {
        "call_info": {
          "callee": "kj::heapArray<word>",
          "args": [
            "minimumSize"
          ],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "heapArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "696-698",
          "snippet": "inline Array<T> heapArray(std::initializer_list<T> init) {\n  return heapArray<T>(init.begin(), init.end());\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\ninline Array<T> heapArray(std::initializer_list<T> init) {\n  return heapArray<T>(init.begin(), init.end());\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/array.h>\n#include \"test-util.h\"\n#include \"message.h\"\n\nTestInitMessageBuilder {\n  kj::ArrayPtr<word> allocateSegment(uint minimumSize) override {\n      auto array = kj::heapArray<word>(minimumSize);\n      memset(array.begin(), 0, array.asBytes().size());\n      allocations.add(kj::mv(array));\n      return allocations.back();\n    }\n}"
  },
  {
    "function_name": "TestInitMessageBuilder",
    "container": "TestInitMessageBuilder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/message-test.c++",
    "lines": "53-53",
    "snippet": "TestInitMessageBuilder(kj::ArrayPtr<SegmentInit> segments): MessageBuilder(segments) {}",
    "includes": [
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/array.h>",
      "#include \"test-util.h\"",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/array.h>\n#include \"test-util.h\"\n#include \"message.h\"\n\nTestInitMessageBuilder {\n  TestInitMessageBuilder(kj::ArrayPtr<SegmentInit> segments): MessageBuilder(segments) {}\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/message-test.c++",
    "lines": "33-49",
    "snippet": "TEST(Message, MallocBuilderWithFirstSegment) {\n  word scratch[16];\n  memset(scratch, 0, sizeof(scratch));\n  MallocMessageBuilder builder(kj::arrayPtr(scratch, 16), AllocationStrategy::FIXED_SIZE);\n\n  kj::ArrayPtr<word> segment = builder.allocateSegment(1);\n  EXPECT_EQ(scratch, segment.begin());\n  EXPECT_EQ(16u, segment.size());\n\n  segment = builder.allocateSegment(1);\n  EXPECT_NE(scratch, segment.begin());\n  EXPECT_EQ(16u, segment.size());\n\n  segment = builder.allocateSegment(1);\n  EXPECT_NE(scratch, segment.begin());\n  EXPECT_EQ(16u, segment.size());\n}",
    "includes": [
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/array.h>",
      "#include \"test-util.h\"",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "16u",
            "segment.size()"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "segment.size",
          "args": [],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "599-599",
          "snippet": "inline uint size() { return _builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline uint size() { return _builder.size() / ELEMENTS; }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_NE",
          "args": [
            "scratch",
            "segment.begin()"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "segment.begin",
          "args": [],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "550-550",
          "snippet": "inline Iterator begin() { return Iterator(this, 0); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Iterator begin() { return Iterator(this, 0); }"
        }
      },
      {
        "call_info": {
          "callee": "builder.allocateSegment",
          "args": [
            "1"
          ],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "allocateSegment",
          "container": "TestInitMessageBuilder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/message-test.c++",
          "lines": "55-60",
          "snippet": "kj::ArrayPtr<word> allocateSegment(uint minimumSize) override {\n    auto array = kj::heapArray<word>(minimumSize);\n    memset(array.begin(), 0, array.asBytes().size());\n    allocations.add(kj::mv(array));\n    return allocations.back();\n  }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/array.h>",
            "#include \"test-util.h\"",
            "#include \"message.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/array.h>\n#include \"test-util.h\"\n#include \"message.h\"\n\nTestInitMessageBuilder {\n  kj::ArrayPtr<word> allocateSegment(uint minimumSize) override {\n      auto array = kj::heapArray<word>(minimumSize);\n      memset(array.begin(), 0, array.asBytes().size());\n      allocations.add(kj::mv(array));\n      return allocations.back();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "16u",
            "segment.size()"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_NE",
          "args": [
            "scratch",
            "segment.begin()"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "16u",
            "segment.size()"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "scratch",
            "segment.begin()"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::arrayPtr",
          "args": [
            "scratch",
            "16"
          ],
          "line": 36
        },
        "resolved": true,
        "details": {
          "function_name": "arrayPtr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "1194-1197",
          "snippet": "inline constexpr ArrayPtr<T> arrayPtr(T* begin, T* end) {\n  // Use this function to construct ArrayPtrs without writing out the type name.\n  return ArrayPtr<T>(begin, end);\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\ninline constexpr ArrayPtr<T> arrayPtr(T* begin, T* end) {\n  // Use this function to construct ArrayPtrs without writing out the type name.\n  return ArrayPtr<T>(begin, end);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "scratch",
            "0",
            "sizeof(scratch)"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/array.h>\n#include \"test-util.h\"\n#include \"message.h\"\n\nTEST(Message, MallocBuilderWithFirstSegment) {\n  word scratch[16];\n  memset(scratch, 0, sizeof(scratch));\n  MallocMessageBuilder builder(kj::arrayPtr(scratch, 16), AllocationStrategy::FIXED_SIZE);\n\n  kj::ArrayPtr<word> segment = builder.allocateSegment(1);\n  EXPECT_EQ(scratch, segment.begin());\n  EXPECT_EQ(16u, segment.size());\n\n  segment = builder.allocateSegment(1);\n  EXPECT_NE(scratch, segment.begin());\n  EXPECT_EQ(16u, segment.size());\n\n  segment = builder.allocateSegment(1);\n  EXPECT_NE(scratch, segment.begin());\n  EXPECT_EQ(16u, segment.size());\n}"
  }
]