[
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/exception-test.c++",
    "lines": "105-135",
    "snippet": "TEST(Exception, ScopeSuccessFail) {\n  bool success = false;\n  bool failure = false;\n\n  {\n    KJ_ON_SCOPE_SUCCESS(success = true);\n    KJ_ON_SCOPE_FAILURE(failure = true);\n\n    EXPECT_FALSE(success);\n    EXPECT_FALSE(failure);\n  }\n\n  EXPECT_TRUE(success);\n  EXPECT_FALSE(failure);\n\n  success = false;\n  failure = false;\n\n  try {\n    KJ_ON_SCOPE_SUCCESS(success = true);\n    KJ_ON_SCOPE_FAILURE(failure = true);\n\n    EXPECT_FALSE(success);\n    EXPECT_FALSE(failure);\n\n    throw 1;\n  } catch (int) {}\n\n  EXPECT_FALSE(success);\n  EXPECT_TRUE(failure);\n}",
    "includes": [
      "#include <kj/compat/gtest.h>",
      "#include \"debug.h\"",
      "#include \"exception.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "failure"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "success"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "failure"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "success"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_ON_SCOPE_FAILURE",
          "args": [
            "failure = true"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_ON_SCOPE_SUCCESS",
          "args": [
            "success = true"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "failure"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "success"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "failure"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "success"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_ON_SCOPE_FAILURE",
          "args": [
            "failure = true"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_ON_SCOPE_SUCCESS",
          "args": [
            "success = true"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/compat/gtest.h>\n#include \"debug.h\"\n#include \"exception.h\"\n\nTEST(Exception, ScopeSuccessFail) {\n  bool success = false;\n  bool failure = false;\n\n  {\n    KJ_ON_SCOPE_SUCCESS(success = true);\n    KJ_ON_SCOPE_FAILURE(failure = true);\n\n    EXPECT_FALSE(success);\n    EXPECT_FALSE(failure);\n  }\n\n  EXPECT_TRUE(success);\n  EXPECT_FALSE(failure);\n\n  success = false;\n  failure = false;\n\n  try {\n    KJ_ON_SCOPE_SUCCESS(success = true);\n    KJ_ON_SCOPE_FAILURE(failure = true);\n\n    EXPECT_FALSE(success);\n    EXPECT_FALSE(failure);\n\n    throw 1;\n  } catch (int) {}\n\n  EXPECT_FALSE(success);\n  EXPECT_TRUE(failure);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/exception-test.c++",
    "lines": "95-101",
    "snippet": "TEST(Exception, ExceptionCallbackMustBeOnStack) {\n#if KJ_NO_EXCEPTIONS\n  EXPECT_DEATH_IF_SUPPORTED(new ExceptionCallback, \"must be allocated on the stack\");\n#else\n  EXPECT_ANY_THROW(new ExceptionCallback);\n#endif\n}",
    "includes": [
      "#include <kj/compat/gtest.h>",
      "#include \"debug.h\"",
      "#include \"exception.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_ANY_THROW",
          "args": [
            "new ExceptionCallback"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_DEATH_IF_SUPPORTED",
          "args": [
            "new ExceptionCallback",
            "\"must be allocated on the stack\""
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/compat/gtest.h>\n#include \"debug.h\"\n#include \"exception.h\"\n\nTEST(Exception, ExceptionCallbackMustBeOnStack) {\n#if KJ_NO_EXCEPTIONS\n  EXPECT_DEATH_IF_SUPPORTED(new ExceptionCallback, \"must be allocated on the stack\");\n#else\n  EXPECT_ANY_THROW(new ExceptionCallback);\n#endif\n}"
  },
  {
    "function_name": "KJ_IF_MAYBE",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/exception-test.c++",
    "lines": "86-88",
    "snippet": "KJ_IF_MAYBE(ex, e) {\n    EXPECT_EQ(\"baz\", ex->getDescription());\n  }",
    "includes": [
      "#include <kj/compat/gtest.h>",
      "#include \"debug.h\"",
      "#include \"exception.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"baz\"",
            "ex->getDescription()"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ex->getDescription",
          "args": [],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "getDescription",
          "container": "Exception",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/exception.h",
          "lines": "81-81",
          "snippet": "StringPtr getDescription() const { return description; }",
          "includes": [
            "#include \"string.h\"",
            "#include \"array.h\"",
            "#include \"memory.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"string.h\"\n#include \"array.h\"\n#include \"memory.h\"\n\nException {\n  StringPtr getDescription() const { return description; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/compat/gtest.h>\n#include \"debug.h\"\n#include \"exception.h\"\n\nKJ_IF_MAYBE(ex, e) {\n    EXPECT_EQ(\"baz\", ex->getDescription());\n  }"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/exception-test.c++",
    "lines": "66-76",
    "snippet": "TEST(Exception, UnwindDetector) {\n  // If no other exception is happening, ThrowingDestructor's destructor throws one.\n  Maybe<Exception> e = kj::runCatchingExceptions([&]() {\n    ThrowingDestructor t;\n  });\n\n  KJ_IF_MAYBE(ex, e) {\n    EXPECT_EQ(\"this is a test, not a real bug\", ex->getDescription());\n  } else {\n    ADD_FAILURE() << \"Expected exception\";\n  }",
    "includes": [
      "#include <kj/compat/gtest.h>",
      "#include \"debug.h\"",
      "#include \"exception.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ADD_FAILURE",
          "args": [],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"this is a test, not a real bug\"",
            "ex->getDescription()"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ex->getDescription",
          "args": [],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "getDescription",
          "container": "Exception",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/exception.h",
          "lines": "81-81",
          "snippet": "StringPtr getDescription() const { return description; }",
          "includes": [
            "#include \"string.h\"",
            "#include \"array.h\"",
            "#include \"memory.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"string.h\"\n#include \"array.h\"\n#include \"memory.h\"\n\nException {\n  StringPtr getDescription() const { return description; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::runCatchingExceptions",
          "args": [
            "[&]() {\n    ThrowingDestructor t;\n  }"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/compat/gtest.h>\n#include \"debug.h\"\n#include \"exception.h\"\n\nTEST(Exception, UnwindDetector) {\n  // If no other exception is happening, ThrowingDestructor's destructor throws one.\n  Maybe<Exception> e = kj::runCatchingExceptions([&]() {\n    ThrowingDestructor t;\n  });\n\n  KJ_IF_MAYBE(ex, e) {\n    EXPECT_EQ(\"this is a test, not a real bug\", ex->getDescription());\n  } else {\n    ADD_FAILURE() << \"Expected exception\";\n  }"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/exception-test.c++",
    "lines": "30-49",
    "snippet": "TEST(Exception, RunCatchingExceptions) {\n  bool recovered = false;\n  Maybe<Exception> e = kj::runCatchingExceptions([&]() {\n    KJ_FAIL_ASSERT(\"foo\") {\n      break;\n    }\n    recovered = true;\n  });\n\n#if KJ_NO_EXCEPTIONS\n  EXPECT_TRUE(recovered);\n#else\n  EXPECT_FALSE(recovered);\n#endif\n\n  KJ_IF_MAYBE(ex, e) {\n    EXPECT_EQ(\"foo\", ex->getDescription());\n  } else {\n    ADD_FAILURE() << \"Expected exception\";\n  }",
    "includes": [
      "#include <kj/compat/gtest.h>",
      "#include \"debug.h\"",
      "#include \"exception.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ADD_FAILURE",
          "args": [],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "ex->getDescription()"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ex->getDescription",
          "args": [],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "getDescription",
          "container": "Exception",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/exception.h",
          "lines": "81-81",
          "snippet": "StringPtr getDescription() const { return description; }",
          "includes": [
            "#include \"string.h\"",
            "#include \"array.h\"",
            "#include \"memory.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"string.h\"\n#include \"array.h\"\n#include \"memory.h\"\n\nException {\n  StringPtr getDescription() const { return description; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "recovered"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "recovered"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::runCatchingExceptions",
          "args": [
            "[&]() {\n    KJ_FAIL_ASSERT(\"foo\") {\n      break;\n    }\n    recovered = true;\n  }"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_FAIL_ASSERT",
          "args": [
            "\"foo\""
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/compat/gtest.h>\n#include \"debug.h\"\n#include \"exception.h\"\n\nTEST(Exception, RunCatchingExceptions) {\n  bool recovered = false;\n  Maybe<Exception> e = kj::runCatchingExceptions([&]() {\n    KJ_FAIL_ASSERT(\"foo\") {\n      break;\n    }\n    recovered = true;\n  });\n\n#if KJ_NO_EXCEPTIONS\n  EXPECT_TRUE(recovered);\n#else\n  EXPECT_FALSE(recovered);\n#endif\n\n  KJ_IF_MAYBE(ex, e) {\n    EXPECT_EQ(\"foo\", ex->getDescription());\n  } else {\n    ADD_FAILURE() << \"Expected exception\";\n  }"
  }
]