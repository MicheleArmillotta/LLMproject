[
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-test.c++",
    "lines": "319-369",
    "snippet": "TEST(Schema, Generics) {\n  StructSchema allTypes = Schema::from<TestAllTypes>();\n  StructSchema tap = Schema::from<test::TestAnyPointer>();\n  StructSchema schema = Schema::from<test::TestUseGenerics>();\n\n  StructSchema branded;\n\n  {\n    StructSchema::Field basic = schema.getFieldByName(\"basic\");\n    branded = basic.getType().asStruct();\n\n    StructSchema::Field foo = branded.getFieldByName(\"foo\");\n    EXPECT_TRUE(foo.getType().asStruct() == allTypes);\n    EXPECT_TRUE(foo.getType().asStruct() != tap);\n\n    StructSchema instance2 = branded.getFieldByName(\"rev\").getType().asStruct();\n    StructSchema::Field foo2 = instance2.getFieldByName(\"foo\");\n    EXPECT_TRUE(foo2.getType().asStruct() == tap);\n    EXPECT_TRUE(foo2.getType().asStruct() != allTypes);\n  }\n\n  {\n    StructSchema inner2 = schema.getFieldByName(\"inner2\").getType().asStruct();\n\n    StructSchema bound = inner2.getFieldByName(\"innerBound\").getType().asStruct();\n    Type boundFoo = bound.getFieldByName(\"foo\").getType();\n    EXPECT_FALSE(boundFoo.isAnyPointer());\n    EXPECT_TRUE(boundFoo.asStruct() == allTypes);\n\n    StructSchema unbound = inner2.getFieldByName(\"innerUnbound\").getType().asStruct();\n    Type unboundFoo = unbound.getFieldByName(\"foo\").getType();\n    EXPECT_TRUE(unboundFoo.isAnyPointer());\n  }\n\n  {\n    InterfaceSchema cap = schema.getFieldByName(\"genericCap\").getType().asInterface();\n    InterfaceSchema::Method method = cap.getMethodByName(\"call\");\n\n    StructSchema inner2 = method.getParamType();\n    StructSchema bound = inner2.getFieldByName(\"innerBound\").getType().asStruct();\n    Type boundFoo = bound.getFieldByName(\"foo\").getType();\n    EXPECT_FALSE(boundFoo.isAnyPointer());\n    EXPECT_TRUE(boundFoo.asStruct() == allTypes);\n    EXPECT_TRUE(inner2.getFieldByName(\"baz\").getType().isText());\n\n    StructSchema results = method.getResultType();\n    EXPECT_TRUE(results.getFieldByName(\"qux\").getType().isData());\n\n    EXPECT_TRUE(results.getFieldByName(\"gen\").getType().asStruct() == branded);\n  }\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include \"schema.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "results.getFieldByName(\"gen\").getType().asStruct() == branded"
          ],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "results.getFieldByName",
          "args": [],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "results.getFieldByName",
          "args": [],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "results.getFieldByName",
          "args": [
            "\"gen\""
          ],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "results.getFieldByName(\"qux\").getType().isData()"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "results.getFieldByName",
          "args": [],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "results.getFieldByName",
          "args": [],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "results.getFieldByName",
          "args": [
            "\"qux\""
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "method.getResultType",
          "args": [],
          "line": 364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "inner2.getFieldByName(\"baz\").getType().isText()"
          ],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inner2.getFieldByName",
          "args": [],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inner2.getFieldByName",
          "args": [],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inner2.getFieldByName",
          "args": [
            "\"baz\""
          ],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "boundFoo.asStruct() == allTypes"
          ],
          "line": 361
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boundFoo.asStruct",
          "args": [],
          "line": 361
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "boundFoo.isAnyPointer()"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boundFoo.isAnyPointer",
          "args": [],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bound.getFieldByName",
          "args": [],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bound.getFieldByName",
          "args": [
            "\"foo\""
          ],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inner2.getFieldByName",
          "args": [],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inner2.getFieldByName",
          "args": [],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inner2.getFieldByName",
          "args": [
            "\"innerBound\""
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "method.getParamType",
          "args": [],
          "line": 357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cap.getMethodByName",
          "args": [
            "\"call\""
          ],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [
            "\"genericCap\""
          ],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "unboundFoo.isAnyPointer()"
          ],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unboundFoo.isAnyPointer",
          "args": [],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unbound.getFieldByName",
          "args": [],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unbound.getFieldByName",
          "args": [
            "\"foo\""
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inner2.getFieldByName",
          "args": [],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inner2.getFieldByName",
          "args": [],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inner2.getFieldByName",
          "args": [
            "\"innerUnbound\""
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "boundFoo.asStruct() == allTypes"
          ],
          "line": 346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boundFoo.asStruct",
          "args": [],
          "line": 346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "boundFoo.isAnyPointer()"
          ],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boundFoo.isAnyPointer",
          "args": [],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bound.getFieldByName",
          "args": [],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bound.getFieldByName",
          "args": [
            "\"foo\""
          ],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inner2.getFieldByName",
          "args": [],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inner2.getFieldByName",
          "args": [],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inner2.getFieldByName",
          "args": [
            "\"innerBound\""
          ],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [
            "\"inner2\""
          ],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "foo2.getType().asStruct() != allTypes"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "foo2.getType",
          "args": [],
          "line": 337
        },
        "resolved": true,
        "details": {
          "function_name": "getType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "942-942",
          "snippet": "inline DynamicValue::Type getType() { return type; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline DynamicValue::Type getType() { return type; }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "foo2.getType().asStruct() == tap"
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "instance2.getFieldByName",
          "args": [
            "\"foo\""
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "branded.getFieldByName",
          "args": [],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "branded.getFieldByName",
          "args": [],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "branded.getFieldByName",
          "args": [
            "\"rev\""
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "foo.getType().asStruct() != tap"
          ],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "foo.getType().asStruct() == allTypes"
          ],
          "line": 331
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "branded.getFieldByName",
          "args": [
            "\"foo\""
          ],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [
            "\"basic\""
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<test::TestUseGenerics>",
          "args": [],
          "line": 322
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include \"schema.h\"\n\nTEST(Schema, Generics) {\n  StructSchema allTypes = Schema::from<TestAllTypes>();\n  StructSchema tap = Schema::from<test::TestAnyPointer>();\n  StructSchema schema = Schema::from<test::TestUseGenerics>();\n\n  StructSchema branded;\n\n  {\n    StructSchema::Field basic = schema.getFieldByName(\"basic\");\n    branded = basic.getType().asStruct();\n\n    StructSchema::Field foo = branded.getFieldByName(\"foo\");\n    EXPECT_TRUE(foo.getType().asStruct() == allTypes);\n    EXPECT_TRUE(foo.getType().asStruct() != tap);\n\n    StructSchema instance2 = branded.getFieldByName(\"rev\").getType().asStruct();\n    StructSchema::Field foo2 = instance2.getFieldByName(\"foo\");\n    EXPECT_TRUE(foo2.getType().asStruct() == tap);\n    EXPECT_TRUE(foo2.getType().asStruct() != allTypes);\n  }\n\n  {\n    StructSchema inner2 = schema.getFieldByName(\"inner2\").getType().asStruct();\n\n    StructSchema bound = inner2.getFieldByName(\"innerBound\").getType().asStruct();\n    Type boundFoo = bound.getFieldByName(\"foo\").getType();\n    EXPECT_FALSE(boundFoo.isAnyPointer());\n    EXPECT_TRUE(boundFoo.asStruct() == allTypes);\n\n    StructSchema unbound = inner2.getFieldByName(\"innerUnbound\").getType().asStruct();\n    Type unboundFoo = unbound.getFieldByName(\"foo\").getType();\n    EXPECT_TRUE(unboundFoo.isAnyPointer());\n  }\n\n  {\n    InterfaceSchema cap = schema.getFieldByName(\"genericCap\").getType().asInterface();\n    InterfaceSchema::Method method = cap.getMethodByName(\"call\");\n\n    StructSchema inner2 = method.getParamType();\n    StructSchema bound = inner2.getFieldByName(\"innerBound\").getType().asStruct();\n    Type boundFoo = bound.getFieldByName(\"foo\").getType();\n    EXPECT_FALSE(boundFoo.isAnyPointer());\n    EXPECT_TRUE(boundFoo.asStruct() == allTypes);\n    EXPECT_TRUE(inner2.getFieldByName(\"baz\").getType().isText());\n\n    StructSchema results = method.getResultType();\n    EXPECT_TRUE(results.getFieldByName(\"qux\").getType().isData());\n\n    EXPECT_TRUE(results.getFieldByName(\"gen\").getType().asStruct() == branded);\n  }\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-test.c++",
    "lines": "278-317",
    "snippet": "TEST(Schema, Interfaces) {\n  InterfaceSchema schema = Schema::from<test::TestMoreStuff>();\n\n  EXPECT_EQ(typeId<test::TestMoreStuff>(), schema.getProto().getId());\n\n  EXPECT_TRUE(schema.getDependency(typeId<test::TestCallOrder>()) ==\n              Schema::from<test::TestCallOrder>());\n  EXPECT_TRUE(schema.getDependency(typeId<test::TestCallOrder>()) != schema);\n  EXPECT_NONFATAL_FAILURE(schema.getDependency(typeId<TestDefaults>()));\n\n  EXPECT_TRUE(schema.asInterface() == schema);\n  EXPECT_NONFATAL_FAILURE(schema.asStruct());\n  EXPECT_NONFATAL_FAILURE(schema.asEnum());\n\n  ASSERT_EQ(schema.getMethods().size(), schema.getProto().getInterface().getMethods().size());\n  InterfaceSchema::Method method = schema.getMethods()[0];\n  EXPECT_EQ(\"callFoo\", method.getProto().getName());\n  EXPECT_TRUE(method.getContainingInterface() == schema);\n\n  InterfaceSchema::Method lookup = schema.getMethodByName(\"callFoo\");\n  EXPECT_TRUE(lookup == method);\n  EXPECT_TRUE(lookup != schema.getMethods()[1]);\n\n  EXPECT_TRUE(Schema::from<TestDefaults>().getFieldByName(\"int32Field\")\n      .getProto().getSlot().getHadExplicitDefault());\n\n  EXPECT_TRUE(schema.findMethodByName(\"noSuchMethod\") == nullptr);\n\n  EXPECT_TRUE(schema.findMethodByName(\"callFooWhenResolved\") != nullptr);\n  EXPECT_TRUE(schema.findMethodByName(\"neverReturn\") != nullptr);\n  EXPECT_TRUE(schema.findMethodByName(\"hold\") != nullptr);\n  EXPECT_TRUE(schema.findMethodByName(\"callHeld\") != nullptr);\n  EXPECT_TRUE(schema.findMethodByName(\"getHeld\") != nullptr);\n\n  auto params = schema.getDependency(schema.getMethodByName(\"methodWithDefaults\")\n      .getProto().getParamStructType()).asStruct();\n  EXPECT_FALSE(params.getFieldByName(\"a\").getProto().getSlot().getHadExplicitDefault());\n  EXPECT_TRUE(params.getFieldByName(\"b\").getProto().getSlot().getHadExplicitDefault());\n  EXPECT_TRUE(params.getFieldByName(\"c\").getProto().getSlot().getHadExplicitDefault());\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include \"schema.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "params.getFieldByName(\"c\").getProto().getSlot().getHadExplicitDefault()"
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "params.getFieldByName",
          "args": [],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "params.getFieldByName",
          "args": [],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "params.getFieldByName",
          "args": [],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "params.getFieldByName",
          "args": [
            "\"c\""
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "params.getFieldByName(\"b\").getProto().getSlot().getHadExplicitDefault()"
          ],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "params.getFieldByName",
          "args": [],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "params.getFieldByName",
          "args": [],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "params.getFieldByName",
          "args": [],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "params.getFieldByName",
          "args": [
            "\"b\""
          ],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "params.getFieldByName(\"a\").getProto().getSlot().getHadExplicitDefault()"
          ],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "params.getFieldByName",
          "args": [],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "params.getFieldByName",
          "args": [],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "params.getFieldByName",
          "args": [],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "params.getFieldByName",
          "args": [
            "\"a\""
          ],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getDependency",
          "args": [],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getDependency",
          "args": [
            "schema.getMethodByName(\"methodWithDefaults\")\n      .getProto().getParamStructType()"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getMethodByName",
          "args": [],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getMethodByName",
          "args": [],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getMethodByName",
          "args": [
            "\"methodWithDefaults\""
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.findMethodByName(\"getHeld\") != nullptr"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.findMethodByName",
          "args": [
            "\"getHeld\""
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.findMethodByName(\"callHeld\") != nullptr"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.findMethodByName",
          "args": [
            "\"callHeld\""
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.findMethodByName(\"hold\") != nullptr"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.findMethodByName",
          "args": [
            "\"hold\""
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.findMethodByName(\"neverReturn\") != nullptr"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.findMethodByName",
          "args": [
            "\"neverReturn\""
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.findMethodByName(\"callFooWhenResolved\") != nullptr"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.findMethodByName",
          "args": [
            "\"callFooWhenResolved\""
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.findMethodByName(\"noSuchMethod\") == nullptr"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.findMethodByName",
          "args": [
            "\"noSuchMethod\""
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "Schema::from<TestDefaults>().getFieldByName(\"int32Field\")\n      .getProto().getSlot().getHadExplicitDefault()"
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<TestDefaults>",
          "args": [],
          "line": 301
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Schema::from<TestDefaults>",
          "args": [
            "\"int32Field\""
          ],
          "line": 301
        },
        "resolved": true,
        "details": {
          "function_name": "from",
          "container": "RequestHook",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
          "lines": "354-356",
          "snippet": "inline static kj::Own<RequestHook> from(Request<T, U>&& request) {\n    return kj::mv(request.hook);\n  }",
          "includes": [
            "#include \"pointer-helpers.h\"",
            "#include \"any.h\"",
            "#include <kj/async.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\nRequestHook {\n  inline static kj::Own<RequestHook> from(Request<T, U>&& request) {\n      return kj::mv(request.hook);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "lookup != schema.getMethods()[1]"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getMethods",
          "args": [],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "lookup == method"
          ],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getMethodByName",
          "args": [
            "\"callFoo\""
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "method.getContainingInterface() == schema"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "method.getContainingInterface",
          "args": [],
          "line": 295
        },
        "resolved": true,
        "details": {
          "function_name": "getContainingInterface",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "484-484",
          "snippet": "inline InterfaceSchema getContainingInterface() const { return parent; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline InterfaceSchema getContainingInterface() const { return parent; }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"callFoo\"",
            "method.getProto().getName()"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "method.getProto",
          "args": [],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      },
      {
        "call_info": {
          "callee": "schema.getMethods",
          "args": [],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "schema.getMethods().size()",
            "schema.getProto().getInterface().getMethods().size()"
          ],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getMethods",
          "args": [],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getMethods",
          "args": [],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_NONFATAL_FAILURE",
          "args": [
            "schema.asEnum()"
          ],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.asEnum",
          "args": [],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_NONFATAL_FAILURE",
          "args": [
            "schema.asStruct()"
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.asStruct",
          "args": [],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.asInterface() == schema"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.asInterface",
          "args": [],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_NONFATAL_FAILURE",
          "args": [
            "schema.getDependency(typeId<TestDefaults>())"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getDependency",
          "args": [
            "typeId<TestDefaults>()"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typeId<TestDefaults>",
          "args": [],
          "line": 286
        },
        "resolved": true,
        "details": {
          "function_name": "typeId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "491-491",
          "snippet": "inline constexpr uint64_t typeId() { return id; }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\ninline constexpr uint64_t typeId() { return id; }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.getDependency(typeId<test::TestCallOrder>()) != schema"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getDependency",
          "args": [
            "typeId<test::TestCallOrder>()"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.getDependency(typeId<test::TestCallOrder>()) ==\n              Schema::from<test::TestCallOrder>()"
          ],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getDependency",
          "args": [
            "typeId<test::TestCallOrder>()"
          ],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "typeId<test::TestMoreStuff>()",
            "schema.getProto().getId()"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include \"schema.h\"\n\nTEST(Schema, Interfaces) {\n  InterfaceSchema schema = Schema::from<test::TestMoreStuff>();\n\n  EXPECT_EQ(typeId<test::TestMoreStuff>(), schema.getProto().getId());\n\n  EXPECT_TRUE(schema.getDependency(typeId<test::TestCallOrder>()) ==\n              Schema::from<test::TestCallOrder>());\n  EXPECT_TRUE(schema.getDependency(typeId<test::TestCallOrder>()) != schema);\n  EXPECT_NONFATAL_FAILURE(schema.getDependency(typeId<TestDefaults>()));\n\n  EXPECT_TRUE(schema.asInterface() == schema);\n  EXPECT_NONFATAL_FAILURE(schema.asStruct());\n  EXPECT_NONFATAL_FAILURE(schema.asEnum());\n\n  ASSERT_EQ(schema.getMethods().size(), schema.getProto().getInterface().getMethods().size());\n  InterfaceSchema::Method method = schema.getMethods()[0];\n  EXPECT_EQ(\"callFoo\", method.getProto().getName());\n  EXPECT_TRUE(method.getContainingInterface() == schema);\n\n  InterfaceSchema::Method lookup = schema.getMethodByName(\"callFoo\");\n  EXPECT_TRUE(lookup == method);\n  EXPECT_TRUE(lookup != schema.getMethods()[1]);\n\n  EXPECT_TRUE(Schema::from<TestDefaults>().getFieldByName(\"int32Field\")\n      .getProto().getSlot().getHadExplicitDefault());\n\n  EXPECT_TRUE(schema.findMethodByName(\"noSuchMethod\") == nullptr);\n\n  EXPECT_TRUE(schema.findMethodByName(\"callFooWhenResolved\") != nullptr);\n  EXPECT_TRUE(schema.findMethodByName(\"neverReturn\") != nullptr);\n  EXPECT_TRUE(schema.findMethodByName(\"hold\") != nullptr);\n  EXPECT_TRUE(schema.findMethodByName(\"callHeld\") != nullptr);\n  EXPECT_TRUE(schema.findMethodByName(\"getHeld\") != nullptr);\n\n  auto params = schema.getDependency(schema.getMethodByName(\"methodWithDefaults\")\n      .getProto().getParamStructType()).asStruct();\n  EXPECT_FALSE(params.getFieldByName(\"a\").getProto().getSlot().getHadExplicitDefault());\n  EXPECT_TRUE(params.getFieldByName(\"b\").getProto().getSlot().getHadExplicitDefault());\n  EXPECT_TRUE(params.getFieldByName(\"c\").getProto().getSlot().getHadExplicitDefault());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-test.c++",
    "lines": "261-276",
    "snippet": "TEST(Schema, NullSchemas) {\n  EXPECT_EQ(0xff, (uint)Schema().getProto().which());\n  EXPECT_TRUE(StructSchema().getProto().isStruct());\n  EXPECT_TRUE(EnumSchema().getProto().isEnum());\n  EXPECT_TRUE(InterfaceSchema().getProto().isInterface());\n  EXPECT_TRUE(ConstSchema().getProto().isConst());\n\n  EXPECT_EQ(\"(null schema)\", Schema().getProto().getDisplayName());\n  EXPECT_EQ(\"(null struct schema)\", StructSchema().getProto().getDisplayName());\n  EXPECT_EQ(\"(null enum schema)\", EnumSchema().getProto().getDisplayName());\n  EXPECT_EQ(\"(null interface schema)\", InterfaceSchema().getProto().getDisplayName());\n  EXPECT_EQ(\"(null const schema)\", ConstSchema().getProto().getDisplayName());\n\n  EXPECT_TRUE(Schema::from<Capability>() == InterfaceSchema());\n  EXPECT_EQ(InterfaceSchema().getProto().getId(), typeId<Capability>());\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include \"schema.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "InterfaceSchema().getProto().getId()",
            "typeId<Capability>()"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typeId<Capability>",
          "args": [],
          "line": 275
        },
        "resolved": true,
        "details": {
          "function_name": "typeId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "491-491",
          "snippet": "inline constexpr uint64_t typeId() { return id; }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\ninline constexpr uint64_t typeId() { return id; }"
        }
      },
      {
        "call_info": {
          "callee": "InterfaceSchema",
          "args": [],
          "line": 275
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "Schema::from<Capability>() == InterfaceSchema()"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"(null const schema)\"",
            "ConstSchema().getProto().getDisplayName()"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ConstSchema",
          "args": [],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "ConstSchema",
          "container": "ConstSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "558-558",
          "snippet": "inline ConstSchema(): Schema(&_::NULL_CONST_SCHEMA.defaultBrand) {}",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nConstSchema {\n  inline ConstSchema(): Schema(&_::NULL_CONST_SCHEMA.defaultBrand) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"(null interface schema)\"",
            "InterfaceSchema().getProto().getDisplayName()"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"(null enum schema)\"",
            "EnumSchema().getProto().getDisplayName()"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"(null struct schema)\"",
            "StructSchema().getProto().getDisplayName()"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"(null schema)\"",
            "Schema().getProto().getDisplayName()"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema",
          "args": [],
          "line": 268
        },
        "resolved": true,
        "details": {
          "function_name": "ensureInitialized",
          "container": "RawSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "221-228",
          "snippet": "inline void ensureInitialized() const {\n    // Lazy initialization support.  Invoke to ensure that initialization has taken place.  This\n    // is required in particular when traversing the dependency list.  RawSchemas for compiled-in\n    // types are always initialized; only dynamically-loaded schemas may be lazy.\n\n    const Initializer* i = __atomic_load_n(&lazyInitializer, __ATOMIC_ACQUIRE);\n    if (i != nullptr) i->init(this);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nRawSchema {\n  inline void ensureInitialized() const {\n      // Lazy initialization support.  Invoke to ensure that initialization has taken place.  This\n      // is required in particular when traversing the dependency list.  RawSchemas for compiled-in\n      // types are always initialized; only dynamically-loaded schemas may be lazy.\n  \n      const Initializer* i = __atomic_load_n(&lazyInitializer, __ATOMIC_ACQUIRE);\n      if (i != nullptr) i->init(this);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "ConstSchema().getProto().isConst()"
          ],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "InterfaceSchema().getProto().isInterface()"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "EnumSchema().getProto().isEnum()"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "StructSchema().getProto().isStruct()"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "0xff",
            "(uint)Schema().getProto().which()"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include \"schema.h\"\n\nTEST(Schema, NullSchemas) {\n  EXPECT_EQ(0xff, (uint)Schema().getProto().which());\n  EXPECT_TRUE(StructSchema().getProto().isStruct());\n  EXPECT_TRUE(EnumSchema().getProto().isEnum());\n  EXPECT_TRUE(InterfaceSchema().getProto().isInterface());\n  EXPECT_TRUE(ConstSchema().getProto().isConst());\n\n  EXPECT_EQ(\"(null schema)\", Schema().getProto().getDisplayName());\n  EXPECT_EQ(\"(null struct schema)\", StructSchema().getProto().getDisplayName());\n  EXPECT_EQ(\"(null enum schema)\", EnumSchema().getProto().getDisplayName());\n  EXPECT_EQ(\"(null interface schema)\", InterfaceSchema().getProto().getDisplayName());\n  EXPECT_EQ(\"(null const schema)\", ConstSchema().getProto().getDisplayName());\n\n  EXPECT_TRUE(Schema::from<Capability>() == InterfaceSchema());\n  EXPECT_EQ(InterfaceSchema().getProto().getId(), typeId<Capability>());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-test.c++",
    "lines": "250-259",
    "snippet": "TEST(Schema, UnnamedUnion) {\n  StructSchema schema = Schema::from<test::TestUnnamedUnion>();\n\n  EXPECT_TRUE(schema.findFieldByName(\"\") == nullptr);\n\n  EXPECT_TRUE(schema.findFieldByName(\"foo\") != nullptr);\n  EXPECT_TRUE(schema.findFieldByName(\"bar\") != nullptr);\n  EXPECT_TRUE(schema.findFieldByName(\"before\") != nullptr);\n  EXPECT_TRUE(schema.findFieldByName(\"after\") != nullptr);\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include \"schema.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.findFieldByName(\"after\") != nullptr"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.findFieldByName",
          "args": [
            "\"after\""
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.findFieldByName(\"before\") != nullptr"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.findFieldByName",
          "args": [
            "\"before\""
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.findFieldByName(\"bar\") != nullptr"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.findFieldByName",
          "args": [
            "\"bar\""
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.findFieldByName(\"foo\") != nullptr"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.findFieldByName",
          "args": [
            "\"foo\""
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.findFieldByName(\"\") == nullptr"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.findFieldByName",
          "args": [
            "\"\""
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<test::TestUnnamedUnion>",
          "args": [],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include \"schema.h\"\n\nTEST(Schema, UnnamedUnion) {\n  StructSchema schema = Schema::from<test::TestUnnamedUnion>();\n\n  EXPECT_TRUE(schema.findFieldByName(\"\") == nullptr);\n\n  EXPECT_TRUE(schema.findFieldByName(\"foo\") != nullptr);\n  EXPECT_TRUE(schema.findFieldByName(\"bar\") != nullptr);\n  EXPECT_TRUE(schema.findFieldByName(\"before\") != nullptr);\n  EXPECT_TRUE(schema.findFieldByName(\"after\") != nullptr);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-test.c++",
    "lines": "161-248",
    "snippet": "TEST(Schema, Lists) {\n  EXPECT_EQ(schema::Type::VOID, Schema::from<List<Void>>().whichElementType());\n  EXPECT_EQ(schema::Type::BOOL, Schema::from<List<bool>>().whichElementType());\n  EXPECT_EQ(schema::Type::INT8, Schema::from<List<int8_t>>().whichElementType());\n  EXPECT_EQ(schema::Type::INT16, Schema::from<List<int16_t>>().whichElementType());\n  EXPECT_EQ(schema::Type::INT32, Schema::from<List<int32_t>>().whichElementType());\n  EXPECT_EQ(schema::Type::INT64, Schema::from<List<int64_t>>().whichElementType());\n  EXPECT_EQ(schema::Type::UINT8, Schema::from<List<uint8_t>>().whichElementType());\n  EXPECT_EQ(schema::Type::UINT16, Schema::from<List<uint16_t>>().whichElementType());\n  EXPECT_EQ(schema::Type::UINT32, Schema::from<List<uint32_t>>().whichElementType());\n  EXPECT_EQ(schema::Type::UINT64, Schema::from<List<uint64_t>>().whichElementType());\n  EXPECT_EQ(schema::Type::FLOAT32, Schema::from<List<float>>().whichElementType());\n  EXPECT_EQ(schema::Type::FLOAT64, Schema::from<List<double>>().whichElementType());\n  EXPECT_EQ(schema::Type::TEXT, Schema::from<List<Text>>().whichElementType());\n  EXPECT_EQ(schema::Type::DATA, Schema::from<List<Data>>().whichElementType());\n\n  EXPECT_NONFATAL_FAILURE(Schema::from<List<uint16_t>>().getStructElementType());\n  EXPECT_NONFATAL_FAILURE(Schema::from<List<uint16_t>>().getEnumElementType());\n  EXPECT_NONFATAL_FAILURE(Schema::from<List<uint16_t>>().getInterfaceElementType());\n  EXPECT_NONFATAL_FAILURE(Schema::from<List<uint16_t>>().getListElementType());\n\n  {\n    ListSchema schema = Schema::from<List<TestAllTypes>>();\n    EXPECT_EQ(schema::Type::STRUCT, schema.whichElementType());\n    EXPECT_TRUE(schema.getStructElementType() == Schema::from<TestAllTypes>());\n    EXPECT_NONFATAL_FAILURE(schema.getEnumElementType());\n    EXPECT_NONFATAL_FAILURE(schema.getInterfaceElementType());\n    EXPECT_NONFATAL_FAILURE(schema.getListElementType());\n  }\n\n  {\n    ListSchema schema = Schema::from<List<TestEnum>>();\n    EXPECT_EQ(schema::Type::ENUM, schema.whichElementType());\n    EXPECT_TRUE(schema.getEnumElementType() == Schema::from<TestEnum>());\n    EXPECT_NONFATAL_FAILURE(schema.getStructElementType());\n    EXPECT_NONFATAL_FAILURE(schema.getInterfaceElementType());\n    EXPECT_NONFATAL_FAILURE(schema.getListElementType());\n  }\n\n  // TODO(someday):  Test interfaces.\n\n  {\n    ListSchema schema = Schema::from<List<List<int32_t>>>();\n    EXPECT_EQ(schema::Type::LIST, schema.whichElementType());\n    EXPECT_NONFATAL_FAILURE(schema.getStructElementType());\n    EXPECT_NONFATAL_FAILURE(schema.getEnumElementType());\n    EXPECT_NONFATAL_FAILURE(schema.getInterfaceElementType());\n\n    ListSchema inner = schema.getListElementType();\n    EXPECT_EQ(schema::Type::INT32, inner.whichElementType());\n  }\n\n  {\n    ListSchema schema = Schema::from<List<List<TestAllTypes>>>();\n    EXPECT_EQ(schema::Type::LIST, schema.whichElementType());\n    EXPECT_NONFATAL_FAILURE(schema.getStructElementType());\n    EXPECT_NONFATAL_FAILURE(schema.getEnumElementType());\n    EXPECT_NONFATAL_FAILURE(schema.getInterfaceElementType());\n\n    ListSchema inner = schema.getListElementType();\n    EXPECT_EQ(schema::Type::STRUCT, inner.whichElementType());\n    EXPECT_TRUE(inner.getStructElementType() == Schema::from<TestAllTypes>());\n  }\n\n  {\n    ListSchema schema = Schema::from<List<List<TestEnum>>>();\n    EXPECT_EQ(schema::Type::LIST, schema.whichElementType());\n    EXPECT_NONFATAL_FAILURE(schema.getStructElementType());\n    EXPECT_NONFATAL_FAILURE(schema.getEnumElementType());\n    EXPECT_NONFATAL_FAILURE(schema.getInterfaceElementType());\n\n    ListSchema inner = schema.getListElementType();\n    EXPECT_EQ(schema::Type::ENUM, inner.whichElementType());\n    EXPECT_TRUE(inner.getEnumElementType() == Schema::from<TestEnum>());\n  }\n\n  {\n    auto context = Schema::from<TestAllTypes>();\n    auto type = context.getFieldByName(\"enumList\").getProto().getSlot().getType();\n\n    ListSchema schema = ListSchema::of(type.getList().getElementType(), context);\n    EXPECT_EQ(schema::Type::ENUM, schema.whichElementType());\n    EXPECT_TRUE(schema.getEnumElementType() == Schema::from<TestEnum>());\n    EXPECT_NONFATAL_FAILURE(schema.getStructElementType());\n    EXPECT_NONFATAL_FAILURE(schema.getInterfaceElementType());\n    EXPECT_NONFATAL_FAILURE(schema.getListElementType());\n  }\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include \"schema.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_NONFATAL_FAILURE",
          "args": [
            "schema.getListElementType()"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getListElementType",
          "args": [],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_NONFATAL_FAILURE",
          "args": [
            "schema.getInterfaceElementType()"
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getInterfaceElementType",
          "args": [],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_NONFATAL_FAILURE",
          "args": [
            "schema.getStructElementType()"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getStructElementType",
          "args": [],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.getEnumElementType() == Schema::from<TestEnum>()"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<TestEnum>",
          "args": [],
          "line": 243
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "schema.getEnumElementType",
          "args": [],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "schema::Type::ENUM",
            "schema.whichElementType()"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.whichElementType",
          "args": [],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ListSchema::of",
          "args": [
            "type.getList().getElementType()",
            "context"
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "ListSchema::of",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.c++",
          "lines": "732-775",
          "snippet": "ListSchema ListSchema::of(schema::Type::Reader elementType, Schema context) {\n  // This method is deprecated because it can only be implemented in terms of other deprecated\n  // methods. Temporarily disable warnings for those other deprecated methods.\n#pragma GCC diagnostic push\n#pragma GCC diagnostic ignored \"-Wdeprecated-declarations\"\n\n  switch (elementType.which()) {\n    case schema::Type::VOID:\n    case schema::Type::BOOL:\n    case schema::Type::INT8:\n    case schema::Type::INT16:\n    case schema::Type::INT32:\n    case schema::Type::INT64:\n    case schema::Type::UINT8:\n    case schema::Type::UINT16:\n    case schema::Type::UINT32:\n    case schema::Type::UINT64:\n    case schema::Type::FLOAT32:\n    case schema::Type::FLOAT64:\n    case schema::Type::TEXT:\n    case schema::Type::DATA:\n      return of(elementType.which());\n\n    case schema::Type::STRUCT:\n      return of(context.getDependency(elementType.getStruct().getTypeId()).asStruct());\n\n    case schema::Type::ENUM:\n      return of(context.getDependency(elementType.getEnum().getTypeId()).asEnum());\n\n    case schema::Type::INTERFACE:\n      return of(context.getDependency(elementType.getInterface().getTypeId()).asInterface());\n\n    case schema::Type::LIST:\n      return of(of(elementType.getList().getElementType(), context));\n\n    case schema::Type::ANY_POINTER:\n      KJ_FAIL_REQUIRE(\"List(AnyPointer) not supported.\");\n      return ListSchema();\n  }\n\n  // Unknown type is acceptable.\n  return ListSchema(elementType.which());\n#pragma GCC diagnostic pop\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"message.h\"\n#include \"schema.h\"\n\nListSchema ListSchema::of(schema::Type::Reader elementType, Schema context) {\n  // This method is deprecated because it can only be implemented in terms of other deprecated\n  // methods. Temporarily disable warnings for those other deprecated methods.\n#pragma GCC diagnostic push\n#pragma GCC diagnostic ignored \"-Wdeprecated-declarations\"\n\n  switch (elementType.which()) {\n    case schema::Type::VOID:\n    case schema::Type::BOOL:\n    case schema::Type::INT8:\n    case schema::Type::INT16:\n    case schema::Type::INT32:\n    case schema::Type::INT64:\n    case schema::Type::UINT8:\n    case schema::Type::UINT16:\n    case schema::Type::UINT32:\n    case schema::Type::UINT64:\n    case schema::Type::FLOAT32:\n    case schema::Type::FLOAT64:\n    case schema::Type::TEXT:\n    case schema::Type::DATA:\n      return of(elementType.which());\n\n    case schema::Type::STRUCT:\n      return of(context.getDependency(elementType.getStruct().getTypeId()).asStruct());\n\n    case schema::Type::ENUM:\n      return of(context.getDependency(elementType.getEnum().getTypeId()).asEnum());\n\n    case schema::Type::INTERFACE:\n      return of(context.getDependency(elementType.getInterface().getTypeId()).asInterface());\n\n    case schema::Type::LIST:\n      return of(of(elementType.getList().getElementType(), context));\n\n    case schema::Type::ANY_POINTER:\n      KJ_FAIL_REQUIRE(\"List(AnyPointer) not supported.\");\n      return ListSchema();\n  }\n\n  // Unknown type is acceptable.\n  return ListSchema(elementType.which());\n#pragma GCC diagnostic pop\n}"
        }
      },
      {
        "call_info": {
          "callee": "type.getList",
          "args": [],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.getList",
          "args": [],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "context.getFieldByName",
          "args": [],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "context.getFieldByName",
          "args": [],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "context.getFieldByName",
          "args": [],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "context.getFieldByName",
          "args": [
            "\"enumList\""
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "inner.getEnumElementType() == Schema::from<TestEnum>()"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inner.getEnumElementType",
          "args": [],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "schema::Type::ENUM",
            "inner.whichElementType()"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inner.whichElementType",
          "args": [],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getListElementType",
          "args": [],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_NONFATAL_FAILURE",
          "args": [
            "schema.getInterfaceElementType()"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getInterfaceElementType",
          "args": [],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_NONFATAL_FAILURE",
          "args": [
            "schema.getEnumElementType()"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getEnumElementType",
          "args": [],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_NONFATAL_FAILURE",
          "args": [
            "schema.getStructElementType()"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getStructElementType",
          "args": [],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "schema::Type::LIST",
            "schema.whichElementType()"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.whichElementType",
          "args": [],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<List<TestEnum>>>",
          "args": [],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "inner.getStructElementType() == Schema::from<TestAllTypes>()"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inner.getStructElementType",
          "args": [],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "schema::Type::STRUCT",
            "inner.whichElementType()"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inner.whichElementType",
          "args": [],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getListElementType",
          "args": [],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_NONFATAL_FAILURE",
          "args": [
            "schema.getInterfaceElementType()"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getInterfaceElementType",
          "args": [],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_NONFATAL_FAILURE",
          "args": [
            "schema.getEnumElementType()"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getEnumElementType",
          "args": [],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_NONFATAL_FAILURE",
          "args": [
            "schema.getStructElementType()"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getStructElementType",
          "args": [],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "schema::Type::LIST",
            "schema.whichElementType()"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.whichElementType",
          "args": [],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<List<TestAllTypes>>>",
          "args": [],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "schema::Type::INT32",
            "inner.whichElementType()"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inner.whichElementType",
          "args": [],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getListElementType",
          "args": [],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_NONFATAL_FAILURE",
          "args": [
            "schema.getInterfaceElementType()"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getInterfaceElementType",
          "args": [],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_NONFATAL_FAILURE",
          "args": [
            "schema.getEnumElementType()"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getEnumElementType",
          "args": [],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_NONFATAL_FAILURE",
          "args": [
            "schema.getStructElementType()"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getStructElementType",
          "args": [],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "schema::Type::LIST",
            "schema.whichElementType()"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.whichElementType",
          "args": [],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<List<int32_t>>>",
          "args": [],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_NONFATAL_FAILURE",
          "args": [
            "schema.getListElementType()"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getListElementType",
          "args": [],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_NONFATAL_FAILURE",
          "args": [
            "schema.getInterfaceElementType()"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getInterfaceElementType",
          "args": [],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_NONFATAL_FAILURE",
          "args": [
            "schema.getStructElementType()"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getStructElementType",
          "args": [],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.getEnumElementType() == Schema::from<TestEnum>()"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getEnumElementType",
          "args": [],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "schema::Type::ENUM",
            "schema.whichElementType()"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.whichElementType",
          "args": [],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<TestEnum>>",
          "args": [],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_NONFATAL_FAILURE",
          "args": [
            "schema.getListElementType()"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getListElementType",
          "args": [],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_NONFATAL_FAILURE",
          "args": [
            "schema.getInterfaceElementType()"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getInterfaceElementType",
          "args": [],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_NONFATAL_FAILURE",
          "args": [
            "schema.getEnumElementType()"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getEnumElementType",
          "args": [],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.getStructElementType() == Schema::from<TestAllTypes>()"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getStructElementType",
          "args": [],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "schema::Type::STRUCT",
            "schema.whichElementType()"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.whichElementType",
          "args": [],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<TestAllTypes>>",
          "args": [],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_NONFATAL_FAILURE",
          "args": [
            "Schema::from<List<uint16_t>>().getListElementType()"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<uint16_t>>",
          "args": [],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<uint16_t>>",
          "args": [],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_NONFATAL_FAILURE",
          "args": [
            "Schema::from<List<uint16_t>>().getInterfaceElementType()"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<uint16_t>>",
          "args": [],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<uint16_t>>",
          "args": [],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_NONFATAL_FAILURE",
          "args": [
            "Schema::from<List<uint16_t>>().getEnumElementType()"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<uint16_t>>",
          "args": [],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<uint16_t>>",
          "args": [],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_NONFATAL_FAILURE",
          "args": [
            "Schema::from<List<uint16_t>>().getStructElementType()"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<uint16_t>>",
          "args": [],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<uint16_t>>",
          "args": [],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "schema::Type::DATA",
            "Schema::from<List<Data>>().whichElementType()"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<Data>>",
          "args": [],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<Data>>",
          "args": [],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "schema::Type::TEXT",
            "Schema::from<List<Text>>().whichElementType()"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<Text>>",
          "args": [],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<Text>>",
          "args": [],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "schema::Type::FLOAT64",
            "Schema::from<List<double>>().whichElementType()"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<double>>",
          "args": [],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<double>>",
          "args": [],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "schema::Type::FLOAT32",
            "Schema::from<List<float>>().whichElementType()"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<float>>",
          "args": [],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<float>>",
          "args": [],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "schema::Type::UINT64",
            "Schema::from<List<uint64_t>>().whichElementType()"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<uint64_t>>",
          "args": [],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<uint64_t>>",
          "args": [],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "schema::Type::UINT32",
            "Schema::from<List<uint32_t>>().whichElementType()"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<uint32_t>>",
          "args": [],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<uint32_t>>",
          "args": [],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "schema::Type::UINT16",
            "Schema::from<List<uint16_t>>().whichElementType()"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<uint16_t>>",
          "args": [],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<uint16_t>>",
          "args": [],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "schema::Type::UINT8",
            "Schema::from<List<uint8_t>>().whichElementType()"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<uint8_t>>",
          "args": [],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<uint8_t>>",
          "args": [],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "schema::Type::INT64",
            "Schema::from<List<int64_t>>().whichElementType()"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<int64_t>>",
          "args": [],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<int64_t>>",
          "args": [],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "schema::Type::INT32",
            "Schema::from<List<int32_t>>().whichElementType()"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<int32_t>>",
          "args": [],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<int32_t>>",
          "args": [],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "schema::Type::INT16",
            "Schema::from<List<int16_t>>().whichElementType()"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<int16_t>>",
          "args": [],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<int16_t>>",
          "args": [],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "schema::Type::INT8",
            "Schema::from<List<int8_t>>().whichElementType()"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<int8_t>>",
          "args": [],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<int8_t>>",
          "args": [],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "schema::Type::BOOL",
            "Schema::from<List<bool>>().whichElementType()"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<bool>>",
          "args": [],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<bool>>",
          "args": [],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "schema::Type::VOID",
            "Schema::from<List<Void>>().whichElementType()"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<Void>>",
          "args": [],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<Void>>",
          "args": [],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include \"schema.h\"\n\nTEST(Schema, Lists) {\n  EXPECT_EQ(schema::Type::VOID, Schema::from<List<Void>>().whichElementType());\n  EXPECT_EQ(schema::Type::BOOL, Schema::from<List<bool>>().whichElementType());\n  EXPECT_EQ(schema::Type::INT8, Schema::from<List<int8_t>>().whichElementType());\n  EXPECT_EQ(schema::Type::INT16, Schema::from<List<int16_t>>().whichElementType());\n  EXPECT_EQ(schema::Type::INT32, Schema::from<List<int32_t>>().whichElementType());\n  EXPECT_EQ(schema::Type::INT64, Schema::from<List<int64_t>>().whichElementType());\n  EXPECT_EQ(schema::Type::UINT8, Schema::from<List<uint8_t>>().whichElementType());\n  EXPECT_EQ(schema::Type::UINT16, Schema::from<List<uint16_t>>().whichElementType());\n  EXPECT_EQ(schema::Type::UINT32, Schema::from<List<uint32_t>>().whichElementType());\n  EXPECT_EQ(schema::Type::UINT64, Schema::from<List<uint64_t>>().whichElementType());\n  EXPECT_EQ(schema::Type::FLOAT32, Schema::from<List<float>>().whichElementType());\n  EXPECT_EQ(schema::Type::FLOAT64, Schema::from<List<double>>().whichElementType());\n  EXPECT_EQ(schema::Type::TEXT, Schema::from<List<Text>>().whichElementType());\n  EXPECT_EQ(schema::Type::DATA, Schema::from<List<Data>>().whichElementType());\n\n  EXPECT_NONFATAL_FAILURE(Schema::from<List<uint16_t>>().getStructElementType());\n  EXPECT_NONFATAL_FAILURE(Schema::from<List<uint16_t>>().getEnumElementType());\n  EXPECT_NONFATAL_FAILURE(Schema::from<List<uint16_t>>().getInterfaceElementType());\n  EXPECT_NONFATAL_FAILURE(Schema::from<List<uint16_t>>().getListElementType());\n\n  {\n    ListSchema schema = Schema::from<List<TestAllTypes>>();\n    EXPECT_EQ(schema::Type::STRUCT, schema.whichElementType());\n    EXPECT_TRUE(schema.getStructElementType() == Schema::from<TestAllTypes>());\n    EXPECT_NONFATAL_FAILURE(schema.getEnumElementType());\n    EXPECT_NONFATAL_FAILURE(schema.getInterfaceElementType());\n    EXPECT_NONFATAL_FAILURE(schema.getListElementType());\n  }\n\n  {\n    ListSchema schema = Schema::from<List<TestEnum>>();\n    EXPECT_EQ(schema::Type::ENUM, schema.whichElementType());\n    EXPECT_TRUE(schema.getEnumElementType() == Schema::from<TestEnum>());\n    EXPECT_NONFATAL_FAILURE(schema.getStructElementType());\n    EXPECT_NONFATAL_FAILURE(schema.getInterfaceElementType());\n    EXPECT_NONFATAL_FAILURE(schema.getListElementType());\n  }\n\n  // TODO(someday):  Test interfaces.\n\n  {\n    ListSchema schema = Schema::from<List<List<int32_t>>>();\n    EXPECT_EQ(schema::Type::LIST, schema.whichElementType());\n    EXPECT_NONFATAL_FAILURE(schema.getStructElementType());\n    EXPECT_NONFATAL_FAILURE(schema.getEnumElementType());\n    EXPECT_NONFATAL_FAILURE(schema.getInterfaceElementType());\n\n    ListSchema inner = schema.getListElementType();\n    EXPECT_EQ(schema::Type::INT32, inner.whichElementType());\n  }\n\n  {\n    ListSchema schema = Schema::from<List<List<TestAllTypes>>>();\n    EXPECT_EQ(schema::Type::LIST, schema.whichElementType());\n    EXPECT_NONFATAL_FAILURE(schema.getStructElementType());\n    EXPECT_NONFATAL_FAILURE(schema.getEnumElementType());\n    EXPECT_NONFATAL_FAILURE(schema.getInterfaceElementType());\n\n    ListSchema inner = schema.getListElementType();\n    EXPECT_EQ(schema::Type::STRUCT, inner.whichElementType());\n    EXPECT_TRUE(inner.getStructElementType() == Schema::from<TestAllTypes>());\n  }\n\n  {\n    ListSchema schema = Schema::from<List<List<TestEnum>>>();\n    EXPECT_EQ(schema::Type::LIST, schema.whichElementType());\n    EXPECT_NONFATAL_FAILURE(schema.getStructElementType());\n    EXPECT_NONFATAL_FAILURE(schema.getEnumElementType());\n    EXPECT_NONFATAL_FAILURE(schema.getInterfaceElementType());\n\n    ListSchema inner = schema.getListElementType();\n    EXPECT_EQ(schema::Type::ENUM, inner.whichElementType());\n    EXPECT_TRUE(inner.getEnumElementType() == Schema::from<TestEnum>());\n  }\n\n  {\n    auto context = Schema::from<TestAllTypes>();\n    auto type = context.getFieldByName(\"enumList\").getProto().getSlot().getType();\n\n    ListSchema schema = ListSchema::of(type.getList().getElementType(), context);\n    EXPECT_EQ(schema::Type::ENUM, schema.whichElementType());\n    EXPECT_TRUE(schema.getEnumElementType() == Schema::from<TestEnum>());\n    EXPECT_NONFATAL_FAILURE(schema.getStructElementType());\n    EXPECT_NONFATAL_FAILURE(schema.getInterfaceElementType());\n    EXPECT_NONFATAL_FAILURE(schema.getListElementType());\n  }\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-test.c++",
    "lines": "129-157",
    "snippet": "TEST(Schema, Enums) {\n  EnumSchema schema = Schema::from<TestEnum>();\n\n  EXPECT_EQ(typeId<TestEnum>(), schema.getProto().getId());\n\n  EXPECT_NONFATAL_FAILURE(schema.getDependency(typeId<TestAllTypes>()));\n  EXPECT_NONFATAL_FAILURE(schema.getDependency(typeId<TestEnum>()));\n\n  EXPECT_NONFATAL_FAILURE(schema.asStruct());\n  EXPECT_NONFATAL_FAILURE(schema.asInterface());\n  EXPECT_TRUE(schema.asEnum() == schema);\n\n  ASSERT_EQ(schema.getEnumerants().size(),\n            schema.getProto().getEnum().getEnumerants().size());\n  EnumSchema::Enumerant enumerant = schema.getEnumerants()[0];\n  EXPECT_EQ(\"foo\", enumerant.getProto().getName());\n  EXPECT_TRUE(enumerant.getContainingEnum() == schema);\n\n  EnumSchema::Enumerant lookup = schema.getEnumerantByName(\"foo\");\n  EXPECT_TRUE(lookup == enumerant);\n  EXPECT_TRUE(lookup != schema.getEnumerants()[1]);\n\n  EXPECT_TRUE(schema.findEnumerantByName(\"noSuchEnumerant\") == nullptr);\n\n  EXPECT_TRUE(schema.findEnumerantByName(\"bar\") != nullptr);\n  EXPECT_TRUE(schema.findEnumerantByName(\"qux\") != nullptr);\n  EXPECT_TRUE(schema.findEnumerantByName(\"corge\") != nullptr);\n  EXPECT_TRUE(schema.findEnumerantByName(\"grault\") != nullptr);\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include \"schema.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.findEnumerantByName(\"grault\") != nullptr"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.findEnumerantByName",
          "args": [
            "\"grault\""
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.findEnumerantByName(\"corge\") != nullptr"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.findEnumerantByName",
          "args": [
            "\"corge\""
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.findEnumerantByName(\"qux\") != nullptr"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.findEnumerantByName",
          "args": [
            "\"qux\""
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.findEnumerantByName(\"bar\") != nullptr"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.findEnumerantByName",
          "args": [
            "\"bar\""
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.findEnumerantByName(\"noSuchEnumerant\") == nullptr"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.findEnumerantByName",
          "args": [
            "\"noSuchEnumerant\""
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "lookup != schema.getEnumerants()[1]"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getEnumerants",
          "args": [],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "lookup == enumerant"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getEnumerantByName",
          "args": [
            "\"foo\""
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "enumerant.getContainingEnum() == schema"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "enumerant.getContainingEnum",
          "args": [],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "getContainingEnum",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "396-396",
          "snippet": "inline EnumSchema getContainingEnum() const { return parent; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline EnumSchema getContainingEnum() const { return parent; }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "enumerant.getProto().getName()"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "enumerant.getProto",
          "args": [],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      },
      {
        "call_info": {
          "callee": "schema.getEnumerants",
          "args": [],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "schema.getEnumerants().size()",
            "schema.getProto().getEnum().getEnumerants().size()"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getEnumerants",
          "args": [],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getEnumerants",
          "args": [],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.asEnum() == schema"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.asEnum",
          "args": [],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_NONFATAL_FAILURE",
          "args": [
            "schema.asInterface()"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.asInterface",
          "args": [],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_NONFATAL_FAILURE",
          "args": [
            "schema.asStruct()"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.asStruct",
          "args": [],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_NONFATAL_FAILURE",
          "args": [
            "schema.getDependency(typeId<TestEnum>())"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getDependency",
          "args": [
            "typeId<TestEnum>()"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typeId<TestEnum>",
          "args": [],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "typeId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "491-491",
          "snippet": "inline constexpr uint64_t typeId() { return id; }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\ninline constexpr uint64_t typeId() { return id; }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_NONFATAL_FAILURE",
          "args": [
            "schema.getDependency(typeId<TestAllTypes>())"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getDependency",
          "args": [
            "typeId<TestAllTypes>()"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "typeId<TestEnum>()",
            "schema.getProto().getId()"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<TestEnum>",
          "args": [],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include \"schema.h\"\n\nTEST(Schema, Enums) {\n  EnumSchema schema = Schema::from<TestEnum>();\n\n  EXPECT_EQ(typeId<TestEnum>(), schema.getProto().getId());\n\n  EXPECT_NONFATAL_FAILURE(schema.getDependency(typeId<TestAllTypes>()));\n  EXPECT_NONFATAL_FAILURE(schema.getDependency(typeId<TestEnum>()));\n\n  EXPECT_NONFATAL_FAILURE(schema.asStruct());\n  EXPECT_NONFATAL_FAILURE(schema.asInterface());\n  EXPECT_TRUE(schema.asEnum() == schema);\n\n  ASSERT_EQ(schema.getEnumerants().size(),\n            schema.getProto().getEnum().getEnumerants().size());\n  EnumSchema::Enumerant enumerant = schema.getEnumerants()[0];\n  EXPECT_EQ(\"foo\", enumerant.getProto().getName());\n  EXPECT_TRUE(enumerant.getContainingEnum() == schema);\n\n  EnumSchema::Enumerant lookup = schema.getEnumerantByName(\"foo\");\n  EXPECT_TRUE(lookup == enumerant);\n  EXPECT_TRUE(lookup != schema.getEnumerants()[1]);\n\n  EXPECT_TRUE(schema.findEnumerantByName(\"noSuchEnumerant\") == nullptr);\n\n  EXPECT_TRUE(schema.findEnumerantByName(\"bar\") != nullptr);\n  EXPECT_TRUE(schema.findEnumerantByName(\"qux\") != nullptr);\n  EXPECT_TRUE(schema.findEnumerantByName(\"corge\") != nullptr);\n  EXPECT_TRUE(schema.findEnumerantByName(\"grault\") != nullptr);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-test.c++",
    "lines": "104-127",
    "snippet": "TEST(Schema, Unions) {\n  auto schema = Schema::from<TestUnion>().asStruct();\n\n  EXPECT_TRUE(schema.findFieldByName(\"bit0\") != nullptr);\n  EXPECT_TRUE(schema.findFieldByName(\"u1f0s8\") == nullptr);\n\n  auto union1 = schema.getFieldByName(\"union1\");\n  auto union1g = schema.getDependency(union1.getProto().getGroup().getTypeId()).asStruct();\n  EXPECT_EQ(schema, union1g.getDependency(union1g.getProto().getScopeId()));\n  EXPECT_TRUE(union1g.findFieldByName(\"bin0\") == nullptr);\n\n  auto u1f0s8 = union1g.getFieldByName(\"u1f0s8\");\n  EXPECT_EQ(\"u1f0s8\", u1f0s8.getProto().getName());\n  EXPECT_TRUE(u1f0s8.getContainingStruct() == union1g);\n\n  EXPECT_TRUE(union1g.findFieldByName(\"u1f1s8\") != nullptr);\n  EXPECT_TRUE(union1g.findFieldByName(\"u1f0s32\") != nullptr);\n  EXPECT_TRUE(union1g.findFieldByName(\"u1f0sp\") != nullptr);\n  EXPECT_TRUE(union1g.findFieldByName(\"u1f1s1\") != nullptr);\n\n  EXPECT_TRUE(union1g.findFieldByName(\"u0f0s1\") == nullptr);\n  EXPECT_TRUE(union1g.findFieldByName(\"u2f0s8\") == nullptr);\n  EXPECT_TRUE(union1g.findFieldByName(\"noSuchField\") == nullptr);\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include \"schema.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "union1g.findFieldByName(\"noSuchField\") == nullptr"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "union1g.findFieldByName",
          "args": [
            "\"noSuchField\""
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "union1g.findFieldByName(\"u2f0s8\") == nullptr"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "union1g.findFieldByName",
          "args": [
            "\"u2f0s8\""
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "union1g.findFieldByName(\"u0f0s1\") == nullptr"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "union1g.findFieldByName",
          "args": [
            "\"u0f0s1\""
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "union1g.findFieldByName(\"u1f1s1\") != nullptr"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "union1g.findFieldByName",
          "args": [
            "\"u1f1s1\""
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "union1g.findFieldByName(\"u1f0sp\") != nullptr"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "union1g.findFieldByName",
          "args": [
            "\"u1f0sp\""
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "union1g.findFieldByName(\"u1f0s32\") != nullptr"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "union1g.findFieldByName",
          "args": [
            "\"u1f0s32\""
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "union1g.findFieldByName(\"u1f1s8\") != nullptr"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "union1g.findFieldByName",
          "args": [
            "\"u1f1s8\""
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "u1f0s8.getContainingStruct() == union1g"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "u1f0s8.getContainingStruct",
          "args": [],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "getContainingStruct",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "274-274",
          "snippet": "inline StructSchema getContainingStruct() const { return parent; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline StructSchema getContainingStruct() const { return parent; }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"u1f0s8\"",
            "u1f0s8.getProto().getName()"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "u1f0s8.getProto",
          "args": [],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      },
      {
        "call_info": {
          "callee": "union1g.getFieldByName",
          "args": [
            "\"u1f0s8\""
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "union1g.findFieldByName(\"bin0\") == nullptr"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "union1g.findFieldByName",
          "args": [
            "\"bin0\""
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "schema",
            "union1g.getDependency(union1g.getProto().getScopeId())"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "union1g.getDependency",
          "args": [
            "union1g.getProto().getScopeId()"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getDependency",
          "args": [],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getDependency",
          "args": [
            "union1.getProto().getGroup().getTypeId()"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [
            "\"union1\""
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.findFieldByName(\"u1f0s8\") == nullptr"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.findFieldByName",
          "args": [
            "\"u1f0s8\""
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.findFieldByName(\"bit0\") != nullptr"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.findFieldByName",
          "args": [
            "\"bit0\""
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<TestUnion>",
          "args": [],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include \"schema.h\"\n\nTEST(Schema, Unions) {\n  auto schema = Schema::from<TestUnion>().asStruct();\n\n  EXPECT_TRUE(schema.findFieldByName(\"bit0\") != nullptr);\n  EXPECT_TRUE(schema.findFieldByName(\"u1f0s8\") == nullptr);\n\n  auto union1 = schema.getFieldByName(\"union1\");\n  auto union1g = schema.getDependency(union1.getProto().getGroup().getTypeId()).asStruct();\n  EXPECT_EQ(schema, union1g.getDependency(union1g.getProto().getScopeId()));\n  EXPECT_TRUE(union1g.findFieldByName(\"bin0\") == nullptr);\n\n  auto u1f0s8 = union1g.getFieldByName(\"u1f0s8\");\n  EXPECT_EQ(\"u1f0s8\", u1f0s8.getProto().getName());\n  EXPECT_TRUE(u1f0s8.getContainingStruct() == union1g);\n\n  EXPECT_TRUE(union1g.findFieldByName(\"u1f1s8\") != nullptr);\n  EXPECT_TRUE(union1g.findFieldByName(\"u1f0s32\") != nullptr);\n  EXPECT_TRUE(union1g.findFieldByName(\"u1f0sp\") != nullptr);\n  EXPECT_TRUE(union1g.findFieldByName(\"u1f1s1\") != nullptr);\n\n  EXPECT_TRUE(union1g.findFieldByName(\"u0f0s1\") == nullptr);\n  EXPECT_TRUE(union1g.findFieldByName(\"u2f0s8\") == nullptr);\n  EXPECT_TRUE(union1g.findFieldByName(\"noSuchField\") == nullptr);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-test.c++",
    "lines": "78-102",
    "snippet": "TEST(Schema, FieldLookupOutOfOrder) {\n  // Tests that name lookup works correctly when the fields are defined out-of-order in the schema\n  // file.\n  auto schema = Schema::from<test::TestOutOfOrder>().asStruct();\n\n  EXPECT_EQ(\"qux\", schema.getFields()[0].getProto().getName());\n  EXPECT_EQ(\"grault\", schema.getFields()[1].getProto().getName());\n  EXPECT_EQ(\"bar\", schema.getFields()[2].getProto().getName());\n  EXPECT_EQ(\"foo\", schema.getFields()[3].getProto().getName());\n  EXPECT_EQ(\"corge\", schema.getFields()[4].getProto().getName());\n  EXPECT_EQ(\"waldo\", schema.getFields()[5].getProto().getName());\n  EXPECT_EQ(\"quux\", schema.getFields()[6].getProto().getName());\n  EXPECT_EQ(\"garply\", schema.getFields()[7].getProto().getName());\n  EXPECT_EQ(\"baz\", schema.getFields()[8].getProto().getName());\n\n  EXPECT_EQ(3, schema.getFieldByName(\"foo\").getProto().getOrdinal().getExplicit());\n  EXPECT_EQ(2, schema.getFieldByName(\"bar\").getProto().getOrdinal().getExplicit());\n  EXPECT_EQ(8, schema.getFieldByName(\"baz\").getProto().getOrdinal().getExplicit());\n  EXPECT_EQ(0, schema.getFieldByName(\"qux\").getProto().getOrdinal().getExplicit());\n  EXPECT_EQ(6, schema.getFieldByName(\"quux\").getProto().getOrdinal().getExplicit());\n  EXPECT_EQ(4, schema.getFieldByName(\"corge\").getProto().getOrdinal().getExplicit());\n  EXPECT_EQ(1, schema.getFieldByName(\"grault\").getProto().getOrdinal().getExplicit());\n  EXPECT_EQ(7, schema.getFieldByName(\"garply\").getProto().getOrdinal().getExplicit());\n  EXPECT_EQ(5, schema.getFieldByName(\"waldo\").getProto().getOrdinal().getExplicit());\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include \"schema.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "5",
            "schema.getFieldByName(\"waldo\").getProto().getOrdinal().getExplicit()"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [
            "\"waldo\""
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "7",
            "schema.getFieldByName(\"garply\").getProto().getOrdinal().getExplicit()"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [
            "\"garply\""
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "1",
            "schema.getFieldByName(\"grault\").getProto().getOrdinal().getExplicit()"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [
            "\"grault\""
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "4",
            "schema.getFieldByName(\"corge\").getProto().getOrdinal().getExplicit()"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [
            "\"corge\""
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "6",
            "schema.getFieldByName(\"quux\").getProto().getOrdinal().getExplicit()"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [
            "\"quux\""
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "0",
            "schema.getFieldByName(\"qux\").getProto().getOrdinal().getExplicit()"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [
            "\"qux\""
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "8",
            "schema.getFieldByName(\"baz\").getProto().getOrdinal().getExplicit()"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [
            "\"baz\""
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "2",
            "schema.getFieldByName(\"bar\").getProto().getOrdinal().getExplicit()"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [
            "\"bar\""
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "3",
            "schema.getFieldByName(\"foo\").getProto().getOrdinal().getExplicit()"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [
            "\"foo\""
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"baz\"",
            "schema.getFields()[8].getProto().getName()"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFields",
          "args": [],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFields",
          "args": [],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFields",
          "args": [],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"garply\"",
            "schema.getFields()[7].getProto().getName()"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFields",
          "args": [],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFields",
          "args": [],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFields",
          "args": [],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"quux\"",
            "schema.getFields()[6].getProto().getName()"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFields",
          "args": [],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFields",
          "args": [],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFields",
          "args": [],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"waldo\"",
            "schema.getFields()[5].getProto().getName()"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFields",
          "args": [],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFields",
          "args": [],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFields",
          "args": [],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"corge\"",
            "schema.getFields()[4].getProto().getName()"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFields",
          "args": [],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFields",
          "args": [],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFields",
          "args": [],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "schema.getFields()[3].getProto().getName()"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFields",
          "args": [],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFields",
          "args": [],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFields",
          "args": [],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"bar\"",
            "schema.getFields()[2].getProto().getName()"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFields",
          "args": [],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFields",
          "args": [],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFields",
          "args": [],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"grault\"",
            "schema.getFields()[1].getProto().getName()"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFields",
          "args": [],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFields",
          "args": [],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFields",
          "args": [],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"qux\"",
            "schema.getFields()[0].getProto().getName()"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFields",
          "args": [],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFields",
          "args": [],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFields",
          "args": [],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<test::TestOutOfOrder>",
          "args": [],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include \"schema.h\"\n\nTEST(Schema, FieldLookupOutOfOrder) {\n  // Tests that name lookup works correctly when the fields are defined out-of-order in the schema\n  // file.\n  auto schema = Schema::from<test::TestOutOfOrder>().asStruct();\n\n  EXPECT_EQ(\"qux\", schema.getFields()[0].getProto().getName());\n  EXPECT_EQ(\"grault\", schema.getFields()[1].getProto().getName());\n  EXPECT_EQ(\"bar\", schema.getFields()[2].getProto().getName());\n  EXPECT_EQ(\"foo\", schema.getFields()[3].getProto().getName());\n  EXPECT_EQ(\"corge\", schema.getFields()[4].getProto().getName());\n  EXPECT_EQ(\"waldo\", schema.getFields()[5].getProto().getName());\n  EXPECT_EQ(\"quux\", schema.getFields()[6].getProto().getName());\n  EXPECT_EQ(\"garply\", schema.getFields()[7].getProto().getName());\n  EXPECT_EQ(\"baz\", schema.getFields()[8].getProto().getName());\n\n  EXPECT_EQ(3, schema.getFieldByName(\"foo\").getProto().getOrdinal().getExplicit());\n  EXPECT_EQ(2, schema.getFieldByName(\"bar\").getProto().getOrdinal().getExplicit());\n  EXPECT_EQ(8, schema.getFieldByName(\"baz\").getProto().getOrdinal().getExplicit());\n  EXPECT_EQ(0, schema.getFieldByName(\"qux\").getProto().getOrdinal().getExplicit());\n  EXPECT_EQ(6, schema.getFieldByName(\"quux\").getProto().getOrdinal().getExplicit());\n  EXPECT_EQ(4, schema.getFieldByName(\"corge\").getProto().getOrdinal().getExplicit());\n  EXPECT_EQ(1, schema.getFieldByName(\"grault\").getProto().getOrdinal().getExplicit());\n  EXPECT_EQ(7, schema.getFieldByName(\"garply\").getProto().getOrdinal().getExplicit());\n  EXPECT_EQ(5, schema.getFieldByName(\"waldo\").getProto().getOrdinal().getExplicit());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-test.c++",
    "lines": "39-76",
    "snippet": "TEST(Schema, Structs) {\n  StructSchema schema = Schema::from<TestAllTypes>();\n\n  EXPECT_EQ(typeId<TestAllTypes>(), schema.getProto().getId());\n\n  EXPECT_TRUE(schema.getDependency(typeId<TestEnum>()) == Schema::from<TestEnum>());\n  EXPECT_TRUE(schema.getDependency(typeId<TestEnum>()) != schema);\n  EXPECT_TRUE(schema.getDependency(typeId<TestAllTypes>()) == Schema::from<TestAllTypes>());\n  EXPECT_TRUE(schema.getDependency(typeId<TestAllTypes>()) == schema);\n  EXPECT_NONFATAL_FAILURE(schema.getDependency(typeId<TestDefaults>()));\n\n  EXPECT_TRUE(schema.asStruct() == schema);\n  EXPECT_NONFATAL_FAILURE(schema.asEnum());\n  EXPECT_NONFATAL_FAILURE(schema.asInterface());\n\n  ASSERT_EQ(schema.getFields().size(), schema.getProto().getStruct().getFields().size());\n  StructSchema::Field field = schema.getFields()[0];\n  EXPECT_EQ(\"voidField\", field.getProto().getName());\n  EXPECT_TRUE(field.getContainingStruct() == schema);\n\n  StructSchema::Field lookup = schema.getFieldByName(\"voidField\");\n  EXPECT_TRUE(lookup == field);\n  EXPECT_TRUE(lookup != schema.getFields()[1]);\n  EXPECT_FALSE(lookup.getProto().getSlot().getHadExplicitDefault());\n\n  EXPECT_FALSE(schema.getFieldByName(\"int32Field\").getProto().getSlot().getHadExplicitDefault());\n\n  EXPECT_TRUE(Schema::from<TestDefaults>().getFieldByName(\"int32Field\")\n      .getProto().getSlot().getHadExplicitDefault());\n\n  EXPECT_TRUE(schema.findFieldByName(\"noSuchField\") == nullptr);\n\n  EXPECT_TRUE(schema.findFieldByName(\"int32Field\") != nullptr);\n  EXPECT_TRUE(schema.findFieldByName(\"float32List\") != nullptr);\n  EXPECT_TRUE(schema.findFieldByName(\"dataList\") != nullptr);\n  EXPECT_TRUE(schema.findFieldByName(\"textField\") != nullptr);\n  EXPECT_TRUE(schema.findFieldByName(\"structField\") != nullptr);\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include \"schema.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.findFieldByName(\"structField\") != nullptr"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.findFieldByName",
          "args": [
            "\"structField\""
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.findFieldByName(\"textField\") != nullptr"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.findFieldByName",
          "args": [
            "\"textField\""
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.findFieldByName(\"dataList\") != nullptr"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.findFieldByName",
          "args": [
            "\"dataList\""
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.findFieldByName(\"float32List\") != nullptr"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.findFieldByName",
          "args": [
            "\"float32List\""
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.findFieldByName(\"int32Field\") != nullptr"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.findFieldByName",
          "args": [
            "\"int32Field\""
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.findFieldByName(\"noSuchField\") == nullptr"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.findFieldByName",
          "args": [
            "\"noSuchField\""
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "Schema::from<TestDefaults>().getFieldByName(\"int32Field\")\n      .getProto().getSlot().getHadExplicitDefault()"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<TestDefaults>",
          "args": [],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Schema::from<TestDefaults>",
          "args": [
            "\"int32Field\""
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "from",
          "container": "RequestHook",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
          "lines": "354-356",
          "snippet": "inline static kj::Own<RequestHook> from(Request<T, U>&& request) {\n    return kj::mv(request.hook);\n  }",
          "includes": [
            "#include \"pointer-helpers.h\"",
            "#include \"any.h\"",
            "#include <kj/async.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\nRequestHook {\n  inline static kj::Own<RequestHook> from(Request<T, U>&& request) {\n      return kj::mv(request.hook);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "schema.getFieldByName(\"int32Field\").getProto().getSlot().getHadExplicitDefault()"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [
            "\"int32Field\""
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "lookup.getProto().getSlot().getHadExplicitDefault()"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lookup.getProto",
          "args": [],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "lookup != schema.getFields()[1]"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFields",
          "args": [],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "lookup == field"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [
            "\"voidField\""
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "field.getContainingStruct() == schema"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getContainingStruct",
          "args": [],
          "line": 57
        },
        "resolved": true,
        "details": {
          "function_name": "getContainingStruct",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "274-274",
          "snippet": "inline StructSchema getContainingStruct() const { return parent; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline StructSchema getContainingStruct() const { return parent; }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"voidField\"",
            "field.getProto().getName()"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFields",
          "args": [],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "schema.getFields().size()",
            "schema.getProto().getStruct().getFields().size()"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFields",
          "args": [],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFields",
          "args": [],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_NONFATAL_FAILURE",
          "args": [
            "schema.asInterface()"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.asInterface",
          "args": [],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_NONFATAL_FAILURE",
          "args": [
            "schema.asEnum()"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.asEnum",
          "args": [],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.asStruct() == schema"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.asStruct",
          "args": [],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_NONFATAL_FAILURE",
          "args": [
            "schema.getDependency(typeId<TestDefaults>())"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getDependency",
          "args": [
            "typeId<TestDefaults>()"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typeId<TestDefaults>",
          "args": [],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "typeId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "491-491",
          "snippet": "inline constexpr uint64_t typeId() { return id; }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\ninline constexpr uint64_t typeId() { return id; }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.getDependency(typeId<TestAllTypes>()) == schema"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getDependency",
          "args": [
            "typeId<TestAllTypes>()"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.getDependency(typeId<TestAllTypes>()) == Schema::from<TestAllTypes>()"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getDependency",
          "args": [
            "typeId<TestAllTypes>()"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.getDependency(typeId<TestEnum>()) != schema"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getDependency",
          "args": [
            "typeId<TestEnum>()"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "schema.getDependency(typeId<TestEnum>()) == Schema::from<TestEnum>()"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getDependency",
          "args": [
            "typeId<TestEnum>()"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "typeId<TestAllTypes>()",
            "schema.getProto().getId()"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include \"schema.h\"\n\nTEST(Schema, Structs) {\n  StructSchema schema = Schema::from<TestAllTypes>();\n\n  EXPECT_EQ(typeId<TestAllTypes>(), schema.getProto().getId());\n\n  EXPECT_TRUE(schema.getDependency(typeId<TestEnum>()) == Schema::from<TestEnum>());\n  EXPECT_TRUE(schema.getDependency(typeId<TestEnum>()) != schema);\n  EXPECT_TRUE(schema.getDependency(typeId<TestAllTypes>()) == Schema::from<TestAllTypes>());\n  EXPECT_TRUE(schema.getDependency(typeId<TestAllTypes>()) == schema);\n  EXPECT_NONFATAL_FAILURE(schema.getDependency(typeId<TestDefaults>()));\n\n  EXPECT_TRUE(schema.asStruct() == schema);\n  EXPECT_NONFATAL_FAILURE(schema.asEnum());\n  EXPECT_NONFATAL_FAILURE(schema.asInterface());\n\n  ASSERT_EQ(schema.getFields().size(), schema.getProto().getStruct().getFields().size());\n  StructSchema::Field field = schema.getFields()[0];\n  EXPECT_EQ(\"voidField\", field.getProto().getName());\n  EXPECT_TRUE(field.getContainingStruct() == schema);\n\n  StructSchema::Field lookup = schema.getFieldByName(\"voidField\");\n  EXPECT_TRUE(lookup == field);\n  EXPECT_TRUE(lookup != schema.getFields()[1]);\n  EXPECT_FALSE(lookup.getProto().getSlot().getHadExplicitDefault());\n\n  EXPECT_FALSE(schema.getFieldByName(\"int32Field\").getProto().getSlot().getHadExplicitDefault());\n\n  EXPECT_TRUE(Schema::from<TestDefaults>().getFieldByName(\"int32Field\")\n      .getProto().getSlot().getHadExplicitDefault());\n\n  EXPECT_TRUE(schema.findFieldByName(\"noSuchField\") == nullptr);\n\n  EXPECT_TRUE(schema.findFieldByName(\"int32Field\") != nullptr);\n  EXPECT_TRUE(schema.findFieldByName(\"float32List\") != nullptr);\n  EXPECT_TRUE(schema.findFieldByName(\"dataList\") != nullptr);\n  EXPECT_TRUE(schema.findFieldByName(\"textField\") != nullptr);\n  EXPECT_TRUE(schema.findFieldByName(\"structField\") != nullptr);\n}"
  },
  {
    "function_name": "KJ_STRINGIFY",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-test.c++",
    "lines": "29-31",
    "snippet": "inline kj::String KJ_STRINGIFY(Type::Which which) {\n  return kj::str(static_cast<uint16_t>(which));\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include \"schema.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "static_cast<uint16_t>(which)"
          ],
          "line": 30
        },
        "resolved": true,
        "details": {
          "function_name": "str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "341-341",
          "snippet": "inline String str(String&& s) { return mv(s); }",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\ninline String str(String&& s) { return mv(s); }"
        }
      },
      {
        "call_info": {
          "callee": "static_cast<uint16_t>",
          "args": [
            "which"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include \"schema.h\"\n\ninline kj::String KJ_STRINGIFY(Type::Which which) {\n  return kj::str(static_cast<uint16_t>(which));\n}"
  }
]