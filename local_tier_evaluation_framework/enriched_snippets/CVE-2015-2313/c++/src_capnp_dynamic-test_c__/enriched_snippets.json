[
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic-test.c++",
    "lines": "435-452",
    "snippet": "TEST(DynamicApi, BuilderAssign) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<DynamicStruct>(Schema::from<TestAllTypes>());\n\n  // Declare upfront, assign later.\n  // Note that the Python implementation requires defaulted constructors.  Do not delete them!\n  DynamicValue::Builder value;\n  DynamicStruct::Builder structValue;\n  DynamicList::Builder listValue;\n\n  value = root.get(\"structField\");\n  structValue = value.as<DynamicStruct>();\n  structValue.set(\"int32Field\", 123);\n\n  value = root.init(\"int32List\", 1);\n  listValue = value.as<DynamicList>();\n  listValue.set(0, 123);\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\"",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "listValue.set",
          "args": [
            "0",
            "123"
          ],
          "line": 451
        },
        "resolved": true,
        "details": {
          "function_name": "set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "872-874",
          "snippet": "static inline void set(PointerBuilder builder, AnyList::Reader value) {\n    builder.setList(value._reader);\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline void set(PointerBuilder builder, AnyList::Reader value) {\n    builder.setList(value._reader);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "value.as<DynamicList>",
          "args": [],
          "line": 450
        },
        "resolved": true,
        "details": {
          "function_name": "as",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "601-604",
          "snippet": "BuilderFor<T> as() {\n    // T must be List<U>.\n    return BuilderFor<T>(_builder);\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nBuilderFor<T> as() {\n    // T must be List<U>.\n    return BuilderFor<T>(_builder);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "root.init",
          "args": [
            "\"int32List\"",
            "1"
          ],
          "line": 449
        },
        "resolved": true,
        "details": {
          "function_name": "init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/pointer-helpers.h",
          "lines": "120-122",
          "snippet": "static inline typename T::Builder init(PointerBuilder builder, uint size) {\n    return builder.initBlob<T>(size * BYTES);\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"layout.h\"\n\nstatic inline typename T::Builder init(PointerBuilder builder, uint size) {\n    return builder.initBlob<T>(size * BYTES);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "root.get",
          "args": [
            "\"structField\""
          ],
          "line": 445
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "868-871",
          "snippet": "static inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }"
        }
      },
      {
        "call_info": {
          "callee": "builder.initRoot<DynamicStruct>",
          "args": [
            "Schema::from<TestAllTypes>()"
          ],
          "line": 437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<TestAllTypes>",
          "args": [],
          "line": 437
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"dynamic.h\"\n\nTEST(DynamicApi, BuilderAssign) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<DynamicStruct>(Schema::from<TestAllTypes>());\n\n  // Declare upfront, assign later.\n  // Note that the Python implementation requires defaulted constructors.  Do not delete them!\n  DynamicValue::Builder value;\n  DynamicStruct::Builder structValue;\n  DynamicList::Builder listValue;\n\n  value = root.get(\"structField\");\n  structValue = value.as<DynamicStruct>();\n  structValue.set(\"int32Field\", 123);\n\n  value = root.init(\"int32List\", 1);\n  listValue = value.as<DynamicList>();\n  listValue.set(0, 123);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic-test.c++",
    "lines": "427-433",
    "snippet": "TEST(DynamicApi, SetDataFromText) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<DynamicStruct>(Schema::from<TestAllTypes>());\n\n  root.set(\"dataField\", \"foo\");\n  EXPECT_EQ(data(\"foo\"), root.get(\"dataField\").as<Data>());\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\"",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "data(\"foo\")",
            "root.get(\"dataField\").as<Data>()"
          ],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.get",
          "args": [],
          "line": 432
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "root.get",
          "args": [
            "\"dataField\""
          ],
          "line": 432
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "868-871",
          "snippet": "static inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }"
        }
      },
      {
        "call_info": {
          "callee": "data",
          "args": [
            "\"foo\""
          ],
          "line": 432
        },
        "resolved": true,
        "details": {
          "function_name": "dataEquals",
          "container": "TestOutputStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-test.c++",
          "lines": "278-281",
          "snippet": "bool dataEquals(kj::ArrayPtr<const word> other) {\n    return data ==\n        std::string(other.asChars().begin(), other.asChars().size());\n  }",
          "includes": [
            "#include \"test-util.h\"",
            "#include <fcntl.h>",
            "#include <stdlib.h>",
            "#include <string>",
            "#include <kj/miniposix.h>",
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"test-util.h\"\n#include <fcntl.h>\n#include <stdlib.h>\n#include <string>\n#include <kj/miniposix.h>\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n\nTestOutputStream {\n  bool dataEquals(kj::ArrayPtr<const word> other) {\n      return data ==\n          std::string(other.asChars().begin(), other.asChars().size());\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "root.set",
          "args": [
            "\"dataField\"",
            "\"foo\""
          ],
          "line": 431
        },
        "resolved": true,
        "details": {
          "function_name": "set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "872-874",
          "snippet": "static inline void set(PointerBuilder builder, AnyList::Reader value) {\n    builder.setList(value._reader);\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline void set(PointerBuilder builder, AnyList::Reader value) {\n    builder.setList(value._reader);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "builder.initRoot<DynamicStruct>",
          "args": [
            "Schema::from<TestAllTypes>()"
          ],
          "line": 429
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<TestAllTypes>",
          "args": [],
          "line": 429
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"dynamic.h\"\n\nTEST(DynamicApi, SetDataFromText) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<DynamicStruct>(Schema::from<TestAllTypes>());\n\n  root.set(\"dataField\", \"foo\");\n  EXPECT_EQ(data(\"foo\"), root.get(\"dataField\").as<Data>());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic-test.c++",
    "lines": "417-425",
    "snippet": "TEST(DynamicApi, SetEnumFromNative) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<DynamicStruct>(Schema::from<TestAllTypes>());\n\n  root.set(\"enumField\", TestEnum::BAZ);\n  root.set(\"enumList\", {TestEnum::BAR, TestEnum::FOO});\n  EXPECT_EQ(TestEnum::BAZ, root.get(\"enumField\").as<TestEnum>());\n  checkList<TestEnum>(root.get(\"enumList\"), {TestEnum::BAR, TestEnum::FOO});\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\"",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkList<TestEnum>",
          "args": [
            "root.get(\"enumList\")",
            "{TestEnum::BAR, TestEnum::FOO}"
          ],
          "line": 424
        },
        "resolved": true,
        "details": {
          "function_name": "checkList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic-test.c++",
          "lines": "33-45",
          "snippet": "void checkList(T reader, std::initializer_list<ReaderFor<Element>> expected) {\n  auto list = reader.template as<DynamicList>();\n  ASSERT_EQ(expected.size(), list.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], list[i].template as<Element>());\n  }\n\n  auto typed = reader.template as<List<Element>>();\n  ASSERT_EQ(expected.size(), typed.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], typed[i]);\n  }\n}",
          "includes": [
            "#include \"test-util.h\"",
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"dynamic.h\"\n\nvoid checkList(T reader, std::initializer_list<ReaderFor<Element>> expected) {\n  auto list = reader.template as<DynamicList>();\n  ASSERT_EQ(expected.size(), list.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], list[i].template as<Element>());\n  }\n\n  auto typed = reader.template as<List<Element>>();\n  ASSERT_EQ(expected.size(), typed.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], typed[i]);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "root.get",
          "args": [
            "\"enumList\""
          ],
          "line": 424
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "868-871",
          "snippet": "static inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "TestEnum::BAZ",
            "root.get(\"enumField\").as<TestEnum>()"
          ],
          "line": 423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.get",
          "args": [],
          "line": 423
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "root.set",
          "args": [
            "\"enumList\"",
            "{TestEnum::BAR, TestEnum::FOO}"
          ],
          "line": 422
        },
        "resolved": true,
        "details": {
          "function_name": "set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "872-874",
          "snippet": "static inline void set(PointerBuilder builder, AnyList::Reader value) {\n    builder.setList(value._reader);\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline void set(PointerBuilder builder, AnyList::Reader value) {\n    builder.setList(value._reader);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "builder.initRoot<DynamicStruct>",
          "args": [
            "Schema::from<TestAllTypes>()"
          ],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<TestAllTypes>",
          "args": [],
          "line": 419
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"dynamic.h\"\n\nTEST(DynamicApi, SetEnumFromNative) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<DynamicStruct>(Schema::from<TestAllTypes>());\n\n  root.set(\"enumField\", TestEnum::BAZ);\n  root.set(\"enumList\", {TestEnum::BAR, TestEnum::FOO});\n  EXPECT_EQ(TestEnum::BAZ, root.get(\"enumField\").as<TestEnum>());\n  checkList<TestEnum>(root.get(\"enumList\"), {TestEnum::BAR, TestEnum::FOO});\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic-test.c++",
    "lines": "405-415",
    "snippet": "TEST(DynamicApi, HasWhenEmpty) {\n  AlignedData<1> nullRoot = {{0, 0, 0, 0, 0, 0, 0, 0}};\n  kj::ArrayPtr<const word> segments[1] = {kj::arrayPtr(nullRoot.words, 1)};\n  SegmentArrayMessageReader reader(kj::arrayPtr(segments, 1));\n  auto root = reader.getRoot<DynamicStruct>(Schema::from<TestDefaults>());\n\n  EXPECT_TRUE(root.has(\"voidField\"));\n  EXPECT_TRUE(root.has(\"int32Field\"));\n  EXPECT_FALSE(root.has(\"structField\"));\n  EXPECT_FALSE(root.has(\"int32List\"));\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\"",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "root.has(\"int32List\")"
          ],
          "line": 414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.has",
          "args": [
            "\"int32List\""
          ],
          "line": 414
        },
        "resolved": true,
        "details": {
          "function_name": "has",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "253-253",
          "snippet": "inline bool has(StructSchema::Field field) { return asReader().has(field); }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline bool has(StructSchema::Field field) { return asReader().has(field); }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "root.has(\"structField\")"
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "root.has(\"int32Field\")"
          ],
          "line": 412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "root.has(\"voidField\")"
          ],
          "line": 411
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getRoot<DynamicStruct>",
          "args": [
            "Schema::from<TestDefaults>()"
          ],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<TestDefaults>",
          "args": [],
          "line": 409
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::arrayPtr",
          "args": [
            "segments",
            "1"
          ],
          "line": 408
        },
        "resolved": true,
        "details": {
          "function_name": "arrayPtr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "1194-1197",
          "snippet": "inline constexpr ArrayPtr<T> arrayPtr(T* begin, T* end) {\n  // Use this function to construct ArrayPtrs without writing out the type name.\n  return ArrayPtr<T>(begin, end);\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\ninline constexpr ArrayPtr<T> arrayPtr(T* begin, T* end) {\n  // Use this function to construct ArrayPtrs without writing out the type name.\n  return ArrayPtr<T>(begin, end);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"dynamic.h\"\n\nTEST(DynamicApi, HasWhenEmpty) {\n  AlignedData<1> nullRoot = {{0, 0, 0, 0, 0, 0, 0, 0}};\n  kj::ArrayPtr<const word> segments[1] = {kj::arrayPtr(nullRoot.words, 1)};\n  SegmentArrayMessageReader reader(kj::arrayPtr(segments, 1));\n  auto root = reader.getRoot<DynamicStruct>(Schema::from<TestDefaults>());\n\n  EXPECT_TRUE(root.has(\"voidField\"));\n  EXPECT_TRUE(root.has(\"int32Field\"));\n  EXPECT_FALSE(root.has(\"structField\"));\n  EXPECT_FALSE(root.has(\"int32List\"));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic-test.c++",
    "lines": "388-403",
    "snippet": "TEST(DynamicApi, Has) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<DynamicStruct>(Schema::from<TestDefaults>());\n\n  // Primitive fields are always present even if set to default.\n  EXPECT_TRUE(root.has(\"int32Field\"));\n  root.set(\"int32Field\", 123);\n  EXPECT_TRUE(root.has(\"int32Field\"));\n  root.set(\"int32Field\", -12345678);\n  EXPECT_TRUE(root.has(\"int32Field\"));\n\n  // Pointers are absent until initialized.\n  EXPECT_FALSE(root.has(\"structField\"));\n  root.init(\"structField\");\n  EXPECT_TRUE(root.has(\"structField\"));\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\"",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "root.has(\"structField\")"
          ],
          "line": 402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.has",
          "args": [
            "\"structField\""
          ],
          "line": 402
        },
        "resolved": true,
        "details": {
          "function_name": "has",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "253-253",
          "snippet": "inline bool has(StructSchema::Field field) { return asReader().has(field); }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline bool has(StructSchema::Field field) { return asReader().has(field); }"
        }
      },
      {
        "call_info": {
          "callee": "root.init",
          "args": [
            "\"structField\""
          ],
          "line": 401
        },
        "resolved": true,
        "details": {
          "function_name": "init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/pointer-helpers.h",
          "lines": "51-53",
          "snippet": "static inline typename T::Builder init(PointerBuilder builder) {\n    return typename T::Builder(builder.initStruct(structSize<T>()));\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"layout.h\"\n\nstatic inline typename T::Builder init(PointerBuilder builder) {\n    return typename T::Builder(builder.initStruct(structSize<T>()));\n  }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "root.has(\"structField\")"
          ],
          "line": 400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "root.has(\"int32Field\")"
          ],
          "line": 397
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.set",
          "args": [
            "\"int32Field\"",
            "-12345678"
          ],
          "line": 396
        },
        "resolved": true,
        "details": {
          "function_name": "set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "872-874",
          "snippet": "static inline void set(PointerBuilder builder, AnyList::Reader value) {\n    builder.setList(value._reader);\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline void set(PointerBuilder builder, AnyList::Reader value) {\n    builder.setList(value._reader);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "root.has(\"int32Field\")"
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "root.has(\"int32Field\")"
          ],
          "line": 393
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<DynamicStruct>",
          "args": [
            "Schema::from<TestDefaults>()"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<TestDefaults>",
          "args": [],
          "line": 390
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"dynamic.h\"\n\nTEST(DynamicApi, Has) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<DynamicStruct>(Schema::from<TestDefaults>());\n\n  // Primitive fields are always present even if set to default.\n  EXPECT_TRUE(root.has(\"int32Field\"));\n  root.set(\"int32Field\", 123);\n  EXPECT_TRUE(root.has(\"int32Field\"));\n  root.set(\"int32Field\", -12345678);\n  EXPECT_TRUE(root.has(\"int32Field\"));\n\n  // Pointers are absent until initialized.\n  EXPECT_FALSE(root.has(\"structField\"));\n  root.init(\"structField\");\n  EXPECT_TRUE(root.has(\"structField\"));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic-test.c++",
    "lines": "380-386",
    "snippet": "TEST(DynamicApi, LateUnion) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<DynamicStruct>(Schema::from<test::TestLateUnion>());\n\n  root.get(\"theUnion\").as<DynamicStruct>().set(\"qux\", \"hello\");\n  EXPECT_EQ(\"hello\", root.as<test::TestLateUnion>().getTheUnion().getQux());\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\"",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"hello\"",
            "root.as<test::TestLateUnion>().getTheUnion().getQux()"
          ],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.as<test::TestLateUnion>",
          "args": [],
          "line": 385
        },
        "resolved": true,
        "details": {
          "function_name": "as",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "601-604",
          "snippet": "BuilderFor<T> as() {\n    // T must be List<U>.\n    return BuilderFor<T>(_builder);\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nBuilderFor<T> as() {\n    // T must be List<U>.\n    return BuilderFor<T>(_builder);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "root.get",
          "args": [
            "\"qux\"",
            "\"hello\""
          ],
          "line": 384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.get",
          "args": [],
          "line": 384
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "root.get",
          "args": [
            "\"theUnion\""
          ],
          "line": 384
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "868-871",
          "snippet": "static inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }"
        }
      },
      {
        "call_info": {
          "callee": "builder.initRoot<DynamicStruct>",
          "args": [
            "Schema::from<test::TestLateUnion>()"
          ],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<test::TestLateUnion>",
          "args": [],
          "line": 382
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"dynamic.h\"\n\nTEST(DynamicApi, LateUnion) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<DynamicStruct>(Schema::from<test::TestLateUnion>());\n\n  root.get(\"theUnion\").as<DynamicStruct>().set(\"qux\", \"hello\");\n  EXPECT_EQ(\"hello\", root.as<test::TestLateUnion>().getTheUnion().getQux());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic-test.c++",
    "lines": "363-378",
    "snippet": "TEST(DynamicApi, ConversionFailures) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<DynamicStruct>(Schema::from<TestAllTypes>());\n\n  root.set(\"int8Field\", 123);\n  EXPECT_NONFATAL_FAILURE(root.set(\"int8Field\", 1234));\n\n  root.set(\"uInt32Field\", 1);\n  EXPECT_NONFATAL_FAILURE(root.set(\"uInt32Field\", -1));\n\n  root.set(\"int16Field\", 5);\n  EXPECT_NONFATAL_FAILURE(root.set(\"int16Field\", 0.5));\n\n  root.set(\"boolField\", true);\n  EXPECT_NONFATAL_FAILURE(root.set(\"boolField\", 1));\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\"",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_NONFATAL_FAILURE",
          "args": [
            "root.set(\"boolField\", 1)"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.set",
          "args": [
            "\"boolField\"",
            "1"
          ],
          "line": 377
        },
        "resolved": true,
        "details": {
          "function_name": "set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "872-874",
          "snippet": "static inline void set(PointerBuilder builder, AnyList::Reader value) {\n    builder.setList(value._reader);\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline void set(PointerBuilder builder, AnyList::Reader value) {\n    builder.setList(value._reader);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_NONFATAL_FAILURE",
          "args": [
            "root.set(\"int16Field\", 0.5)"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_NONFATAL_FAILURE",
          "args": [
            "root.set(\"uInt32Field\", -1)"
          ],
          "line": 371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_NONFATAL_FAILURE",
          "args": [
            "root.set(\"int8Field\", 1234)"
          ],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<DynamicStruct>",
          "args": [
            "Schema::from<TestAllTypes>()"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<TestAllTypes>",
          "args": [],
          "line": 365
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"dynamic.h\"\n\nTEST(DynamicApi, ConversionFailures) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<DynamicStruct>(Schema::from<TestAllTypes>());\n\n  root.set(\"int8Field\", 123);\n  EXPECT_NONFATAL_FAILURE(root.set(\"int8Field\", 1234));\n\n  root.set(\"uInt32Field\", 1);\n  EXPECT_NONFATAL_FAILURE(root.set(\"uInt32Field\", -1));\n\n  root.set(\"int16Field\", 5);\n  EXPECT_NONFATAL_FAILURE(root.set(\"int16Field\", 0.5));\n\n  root.set(\"boolField\", true);\n  EXPECT_NONFATAL_FAILURE(root.set(\"boolField\", 1));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic-test.c++",
    "lines": "327-361",
    "snippet": "TEST(DynamicApi, UnnamedUnion) {\n  MallocMessageBuilder builder;\n  StructSchema schema = Schema::from<test::TestUnnamedUnion>();\n  auto root = builder.initRoot<DynamicStruct>(schema);\n\n  EXPECT_EQ(schema.getFieldByName(\"foo\"), KJ_ASSERT_NONNULL(root.which()));\n\n  root.set(\"bar\", 321);\n  EXPECT_EQ(schema.getFieldByName(\"bar\"), KJ_ASSERT_NONNULL(root.which()));\n  EXPECT_EQ(321u, root.get(\"bar\").as<uint>());\n  EXPECT_EQ(321u, root.asReader().get(\"bar\").as<uint>());\n  EXPECT_ANY_THROW(root.get(\"foo\"));\n  EXPECT_ANY_THROW(root.asReader().get(\"foo\"));\n\n  root.set(\"foo\", 123);\n  EXPECT_EQ(schema.getFieldByName(\"foo\"), KJ_ASSERT_NONNULL(root.which()));\n  EXPECT_EQ(123u, root.get(\"foo\").as<uint>());\n  EXPECT_EQ(123u, root.asReader().get(\"foo\").as<uint>());\n  EXPECT_ANY_THROW(root.get(\"bar\"));\n  EXPECT_ANY_THROW(root.asReader().get(\"bar\"));\n\n  root.set(\"bar\", 321);\n  EXPECT_EQ(schema.getFieldByName(\"bar\"), KJ_ASSERT_NONNULL(root.which()));\n  EXPECT_EQ(321u, root.get(\"bar\").as<uint>());\n  EXPECT_EQ(321u, root.asReader().get(\"bar\").as<uint>());\n  EXPECT_ANY_THROW(root.get(\"foo\"));\n  EXPECT_ANY_THROW(root.asReader().get(\"foo\"));\n\n  root.set(\"foo\", 123);\n  EXPECT_EQ(schema.getFieldByName(\"foo\"), KJ_ASSERT_NONNULL(root.which()));\n  EXPECT_EQ(123u, root.get(\"foo\").as<uint>());\n  EXPECT_EQ(123u, root.asReader().get(\"foo\").as<uint>());\n  EXPECT_ANY_THROW(root.get(\"bar\"));\n  EXPECT_ANY_THROW(root.asReader().get(\"bar\"));\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\"",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_ANY_THROW",
          "args": [
            "root.asReader().get(\"bar\")"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [
            "\"bar\""
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [],
          "line": 360
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_ANY_THROW",
          "args": [
            "root.get(\"bar\")"
          ],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.get",
          "args": [
            "\"bar\""
          ],
          "line": 359
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "868-871",
          "snippet": "static inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "123u",
            "root.asReader().get(\"foo\").as<uint>()"
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [
            "\"foo\""
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "123u",
            "root.get(\"foo\").as<uint>()"
          ],
          "line": 357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.get",
          "args": [],
          "line": 357
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "schema.getFieldByName(\"foo\")",
            "KJ_ASSERT_NONNULL(root.which())"
          ],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_ASSERT_NONNULL",
          "args": [
            "root.which()"
          ],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.which",
          "args": [],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [
            "\"foo\""
          ],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.set",
          "args": [
            "\"foo\"",
            "123"
          ],
          "line": 355
        },
        "resolved": true,
        "details": {
          "function_name": "set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "872-874",
          "snippet": "static inline void set(PointerBuilder builder, AnyList::Reader value) {\n    builder.setList(value._reader);\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline void set(PointerBuilder builder, AnyList::Reader value) {\n    builder.setList(value._reader);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_ANY_THROW",
          "args": [
            "root.asReader().get(\"foo\")"
          ],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [
            "\"foo\""
          ],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_ANY_THROW",
          "args": [
            "root.get(\"foo\")"
          ],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "321u",
            "root.asReader().get(\"bar\").as<uint>()"
          ],
          "line": 351
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [
            "\"bar\""
          ],
          "line": 351
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "321u",
            "root.get(\"bar\").as<uint>()"
          ],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "schema.getFieldByName(\"bar\")",
            "KJ_ASSERT_NONNULL(root.which())"
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_ASSERT_NONNULL",
          "args": [
            "root.which()"
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.which",
          "args": [],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [
            "\"bar\""
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_ANY_THROW",
          "args": [
            "root.asReader().get(\"bar\")"
          ],
          "line": 346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [
            "\"bar\""
          ],
          "line": 346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_ANY_THROW",
          "args": [
            "root.get(\"bar\")"
          ],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "123u",
            "root.asReader().get(\"foo\").as<uint>()"
          ],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [
            "\"foo\""
          ],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "123u",
            "root.get(\"foo\").as<uint>()"
          ],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "schema.getFieldByName(\"foo\")",
            "KJ_ASSERT_NONNULL(root.which())"
          ],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_ASSERT_NONNULL",
          "args": [
            "root.which()"
          ],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.which",
          "args": [],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [
            "\"foo\""
          ],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_ANY_THROW",
          "args": [
            "root.asReader().get(\"foo\")"
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [
            "\"foo\""
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_ANY_THROW",
          "args": [
            "root.get(\"foo\")"
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "321u",
            "root.asReader().get(\"bar\").as<uint>()"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [
            "\"bar\""
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "321u",
            "root.get(\"bar\").as<uint>()"
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "schema.getFieldByName(\"bar\")",
            "KJ_ASSERT_NONNULL(root.which())"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_ASSERT_NONNULL",
          "args": [
            "root.which()"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.which",
          "args": [],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [
            "\"bar\""
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "schema.getFieldByName(\"foo\")",
            "KJ_ASSERT_NONNULL(root.which())"
          ],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_ASSERT_NONNULL",
          "args": [
            "root.which()"
          ],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.which",
          "args": [],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFieldByName",
          "args": [
            "\"foo\""
          ],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<DynamicStruct>",
          "args": [
            "schema"
          ],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<test::TestUnnamedUnion>",
          "args": [],
          "line": 329
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"dynamic.h\"\n\nTEST(DynamicApi, UnnamedUnion) {\n  MallocMessageBuilder builder;\n  StructSchema schema = Schema::from<test::TestUnnamedUnion>();\n  auto root = builder.initRoot<DynamicStruct>(schema);\n\n  EXPECT_EQ(schema.getFieldByName(\"foo\"), KJ_ASSERT_NONNULL(root.which()));\n\n  root.set(\"bar\", 321);\n  EXPECT_EQ(schema.getFieldByName(\"bar\"), KJ_ASSERT_NONNULL(root.which()));\n  EXPECT_EQ(321u, root.get(\"bar\").as<uint>());\n  EXPECT_EQ(321u, root.asReader().get(\"bar\").as<uint>());\n  EXPECT_ANY_THROW(root.get(\"foo\"));\n  EXPECT_ANY_THROW(root.asReader().get(\"foo\"));\n\n  root.set(\"foo\", 123);\n  EXPECT_EQ(schema.getFieldByName(\"foo\"), KJ_ASSERT_NONNULL(root.which()));\n  EXPECT_EQ(123u, root.get(\"foo\").as<uint>());\n  EXPECT_EQ(123u, root.asReader().get(\"foo\").as<uint>());\n  EXPECT_ANY_THROW(root.get(\"bar\"));\n  EXPECT_ANY_THROW(root.asReader().get(\"bar\"));\n\n  root.set(\"bar\", 321);\n  EXPECT_EQ(schema.getFieldByName(\"bar\"), KJ_ASSERT_NONNULL(root.which()));\n  EXPECT_EQ(321u, root.get(\"bar\").as<uint>());\n  EXPECT_EQ(321u, root.asReader().get(\"bar\").as<uint>());\n  EXPECT_ANY_THROW(root.get(\"foo\"));\n  EXPECT_ANY_THROW(root.asReader().get(\"foo\"));\n\n  root.set(\"foo\", 123);\n  EXPECT_EQ(schema.getFieldByName(\"foo\"), KJ_ASSERT_NONNULL(root.which()));\n  EXPECT_EQ(123u, root.get(\"foo\").as<uint>());\n  EXPECT_EQ(123u, root.asReader().get(\"foo\").as<uint>());\n  EXPECT_ANY_THROW(root.get(\"bar\"));\n  EXPECT_ANY_THROW(root.asReader().get(\"bar\"));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic-test.c++",
    "lines": "300-325",
    "snippet": "TEST(DynamicApi, UnionsWrite) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<DynamicStruct>(Schema::from<TestUnion>());\n\n  root.get(\"union0\").as<DynamicStruct>().set(\"u0f1s32\", 1234567);\n  root.get(\"union1\").as<DynamicStruct>().set(\"u1f1sp\", \"foo\");\n  root.get(\"union2\").as<DynamicStruct>().set(\"u2f0s1\", true);\n  root.get(\"union3\").as<DynamicStruct>().set(\"u3f0s64\", 1234567890123456789ll);\n\n  auto reader = root.asReader().as<TestUnion>();\n  ASSERT_EQ(TestUnion::Union0::U0F1S32, reader.getUnion0().which());\n  EXPECT_EQ(1234567, reader.getUnion0().getU0f1s32());\n\n  ASSERT_EQ(TestUnion::Union1::U1F1SP, reader.getUnion1().which());\n  EXPECT_EQ(\"foo\", reader.getUnion1().getU1f1sp());\n\n  ASSERT_EQ(TestUnion::Union2::U2F0S1, reader.getUnion2().which());\n  EXPECT_TRUE(reader.getUnion2().getU2f0s1());\n\n  ASSERT_EQ(TestUnion::Union3::U3F0S64, reader.getUnion3().which());\n  EXPECT_EQ(1234567890123456789ll, reader.getUnion3().getU3f0s64());\n\n  // Can't access union members by name from the root.\n  EXPECT_ANY_THROW(root.get(\"u0f1s32\"));\n  EXPECT_ANY_THROW(root.set(\"u0f1s32\", 1234567));\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\"",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_ANY_THROW",
          "args": [
            "root.set(\"u0f1s32\", 1234567)"
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.set",
          "args": [
            "\"u0f1s32\"",
            "1234567"
          ],
          "line": 324
        },
        "resolved": true,
        "details": {
          "function_name": "set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "872-874",
          "snippet": "static inline void set(PointerBuilder builder, AnyList::Reader value) {\n    builder.setList(value._reader);\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline void set(PointerBuilder builder, AnyList::Reader value) {\n    builder.setList(value._reader);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_ANY_THROW",
          "args": [
            "root.get(\"u0f1s32\")"
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.get",
          "args": [
            "\"u0f1s32\""
          ],
          "line": 323
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "868-871",
          "snippet": "static inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "1234567890123456789ll",
            "reader.getUnion3().getU3f0s64()"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getUnion3",
          "args": [],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getUnion3",
          "args": [],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "TestUnion::Union3::U3F0S64",
            "reader.getUnion3().which()"
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getUnion3",
          "args": [],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getUnion3",
          "args": [],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "reader.getUnion2().getU2f0s1()"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getUnion2",
          "args": [],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getUnion2",
          "args": [],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "TestUnion::Union2::U2F0S1",
            "reader.getUnion2().which()"
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getUnion2",
          "args": [],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getUnion2",
          "args": [],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "reader.getUnion1().getU1f1sp()"
          ],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getUnion1",
          "args": [],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getUnion1",
          "args": [],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "TestUnion::Union1::U1F1SP",
            "reader.getUnion1().which()"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getUnion1",
          "args": [],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getUnion1",
          "args": [],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "1234567",
            "reader.getUnion0().getU0f1s32()"
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getUnion0",
          "args": [],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getUnion0",
          "args": [],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "TestUnion::Union0::U0F1S32",
            "reader.getUnion0().which()"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getUnion0",
          "args": [],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getUnion0",
          "args": [],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [],
          "line": 309
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      },
      {
        "call_info": {
          "callee": "root.get",
          "args": [
            "\"u3f0s64\"",
            "1234567890123456789ll"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.get",
          "args": [],
          "line": 307
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "root.get",
          "args": [
            "\"u2f0s1\"",
            "true"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.get",
          "args": [
            "\"u1f1sp\"",
            "\"foo\""
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.get",
          "args": [
            "\"u0f1s32\"",
            "1234567"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<DynamicStruct>",
          "args": [
            "Schema::from<TestUnion>()"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<TestUnion>",
          "args": [],
          "line": 302
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"dynamic.h\"\n\nTEST(DynamicApi, UnionsWrite) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<DynamicStruct>(Schema::from<TestUnion>());\n\n  root.get(\"union0\").as<DynamicStruct>().set(\"u0f1s32\", 1234567);\n  root.get(\"union1\").as<DynamicStruct>().set(\"u1f1sp\", \"foo\");\n  root.get(\"union2\").as<DynamicStruct>().set(\"u2f0s1\", true);\n  root.get(\"union3\").as<DynamicStruct>().set(\"u3f0s64\", 1234567890123456789ll);\n\n  auto reader = root.asReader().as<TestUnion>();\n  ASSERT_EQ(TestUnion::Union0::U0F1S32, reader.getUnion0().which());\n  EXPECT_EQ(1234567, reader.getUnion0().getU0f1s32());\n\n  ASSERT_EQ(TestUnion::Union1::U1F1SP, reader.getUnion1().which());\n  EXPECT_EQ(\"foo\", reader.getUnion1().getU1f1sp());\n\n  ASSERT_EQ(TestUnion::Union2::U2F0S1, reader.getUnion2().which());\n  EXPECT_TRUE(reader.getUnion2().getU2f0s1());\n\n  ASSERT_EQ(TestUnion::Union3::U3F0S64, reader.getUnion3().which());\n  EXPECT_EQ(1234567890123456789ll, reader.getUnion3().getU3f0s64());\n\n  // Can't access union members by name from the root.\n  EXPECT_ANY_THROW(root.get(\"u0f1s32\"));\n  EXPECT_ANY_THROW(root.set(\"u0f1s32\", 1234567));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic-test.c++",
    "lines": "241-298",
    "snippet": "TEST(DynamicApi, UnionsRead) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<TestUnion>();\n\n  root.getUnion0().setU0f1s32(1234567);\n  root.getUnion1().setU1f1sp(\"foo\");\n  root.getUnion2().setU2f0s1(true);\n  root.getUnion3().setU3f0s64(1234567890123456789ll);\n\n  {\n    auto dynamic = toDynamic(root.asReader());\n    {\n      auto u = dynamic.get(\"union0\").as<DynamicStruct>();\n      EXPECT_MAYBE_EQ(w, u.which(), \"u0f1s32\", w->getProto().getName());\n      EXPECT_EQ(1234567, u.get(\"u0f1s32\").as<int32_t>());\n    }\n    {\n      auto u = dynamic.get(\"union1\").as<DynamicStruct>();\n      EXPECT_MAYBE_EQ(w, u.which(), \"u1f1sp\", w->getProto().getName());\n      EXPECT_EQ(\"foo\", u.get(\"u1f1sp\").as<Text>());\n    }\n    {\n      auto u = dynamic.get(\"union2\").as<DynamicStruct>();\n      EXPECT_MAYBE_EQ(w, u.which(), \"u2f0s1\", w->getProto().getName());\n      EXPECT_TRUE(u.get(\"u2f0s1\").as<bool>());\n    }\n    {\n      auto u = dynamic.get(\"union3\").as<DynamicStruct>();\n      EXPECT_MAYBE_EQ(w, u.which(), \"u3f0s64\", w->getProto().getName());\n      EXPECT_EQ(1234567890123456789ll, u.get(\"u3f0s64\").as<int64_t>());\n    }\n  }\n\n  {\n    // Again as a builder.\n    auto dynamic = toDynamic(root);\n    {\n      auto u = dynamic.get(\"union0\").as<DynamicStruct>();\n      EXPECT_MAYBE_EQ(w, u.which(), \"u0f1s32\", w->getProto().getName());\n      EXPECT_EQ(1234567, u.get(\"u0f1s32\").as<int32_t>());\n    }\n    {\n      auto u = dynamic.get(\"union1\").as<DynamicStruct>();\n      EXPECT_MAYBE_EQ(w, u.which(), \"u1f1sp\", w->getProto().getName());\n      EXPECT_EQ(\"foo\", u.get(\"u1f1sp\").as<Text>());\n    }\n    {\n      auto u = dynamic.get(\"union2\").as<DynamicStruct>();\n      EXPECT_MAYBE_EQ(w, u.which(), \"u2f0s1\", w->getProto().getName());\n      EXPECT_TRUE(u.get(\"u2f0s1\").as<bool>());\n    }\n    {\n      auto u = dynamic.get(\"union3\").as<DynamicStruct>();\n      EXPECT_MAYBE_EQ(w, u.which(), \"u3f0s64\", w->getProto().getName());\n      EXPECT_EQ(1234567890123456789ll, u.get(\"u3f0s64\").as<int64_t>());\n    }\n  }\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\"",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "1234567890123456789ll",
            "u.get(\"u3f0s64\").as<int64_t>()"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "u.get",
          "args": [],
          "line": 295
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ReusableObjects::ObjectSizeCounter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/null-common.h",
          "lines": "90-90",
          "snippet": "uint64_t get() { return iters * maxSize; }",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nReusableObjects {\n  ObjectSizeCounter {\n    uint64_t get() { return iters * maxSize; }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "u.get",
          "args": [
            "\"u3f0s64\""
          ],
          "line": 295
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "868-871",
          "snippet": "static inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_MAYBE_EQ",
          "args": [
            "w",
            "u.which()",
            "\"u3f0s64\"",
            "w->getProto().getName()"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "w->getProto",
          "args": [],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      },
      {
        "call_info": {
          "callee": "u.which",
          "args": [],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dynamic.get",
          "args": [],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "u.get(\"u2f0s1\").as<bool>()"
          ],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_MAYBE_EQ",
          "args": [
            "w",
            "u.which()",
            "\"u2f0s1\"",
            "w->getProto().getName()"
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "u.which",
          "args": [],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "u.get(\"u1f1sp\").as<Text>()"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_MAYBE_EQ",
          "args": [
            "w",
            "u.which()",
            "\"u1f1sp\"",
            "w->getProto().getName()"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "u.which",
          "args": [],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "1234567",
            "u.get(\"u0f1s32\").as<int32_t>()"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_MAYBE_EQ",
          "args": [
            "w",
            "u.which()",
            "\"u0f1s32\"",
            "w->getProto().getName()"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "u.which",
          "args": [],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "toDynamic",
          "args": [
            "root"
          ],
          "line": 276
        },
        "resolved": true,
        "details": {
          "function_name": "toDynamic",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "1246-1248",
          "snippet": "typename DynamicTypeFor<FromServer<T>>::Client toDynamic(kj::Own<T>&& value) {\n  return typename FromServer<T>::Client(kj::mv(value));\n}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ntypename DynamicTypeFor<FromServer<T>>::Client toDynamic(kj::Own<T>&& value) {\n  return typename FromServer<T>::Client(kj::mv(value));\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "1234567890123456789ll",
            "u.get(\"u3f0s64\").as<int64_t>()"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_MAYBE_EQ",
          "args": [
            "w",
            "u.which()",
            "\"u3f0s64\"",
            "w->getProto().getName()"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "u.which",
          "args": [],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "u.get(\"u2f0s1\").as<bool>()"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_MAYBE_EQ",
          "args": [
            "w",
            "u.which()",
            "\"u2f0s1\"",
            "w->getProto().getName()"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "u.which",
          "args": [],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "u.get(\"u1f1sp\").as<Text>()"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_MAYBE_EQ",
          "args": [
            "w",
            "u.which()",
            "\"u1f1sp\"",
            "w->getProto().getName()"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "u.which",
          "args": [],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "1234567",
            "u.get(\"u0f1s32\").as<int32_t>()"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_MAYBE_EQ",
          "args": [
            "w",
            "u.which()",
            "\"u0f1s32\"",
            "w->getProto().getName()"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "u.which",
          "args": [],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      },
      {
        "call_info": {
          "callee": "root.getUnion3",
          "args": [
            "1234567890123456789ll"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getUnion3",
          "args": [],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getUnion2",
          "args": [
            "true"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getUnion2",
          "args": [],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getUnion1",
          "args": [
            "\"foo\""
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getUnion1",
          "args": [],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getUnion0",
          "args": [
            "1234567"
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getUnion0",
          "args": [],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestUnion>",
          "args": [],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"dynamic.h\"\n\nTEST(DynamicApi, UnionsRead) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<TestUnion>();\n\n  root.getUnion0().setU0f1s32(1234567);\n  root.getUnion1().setU1f1sp(\"foo\");\n  root.getUnion2().setU2f0s1(true);\n  root.getUnion3().setU3f0s64(1234567890123456789ll);\n\n  {\n    auto dynamic = toDynamic(root.asReader());\n    {\n      auto u = dynamic.get(\"union0\").as<DynamicStruct>();\n      EXPECT_MAYBE_EQ(w, u.which(), \"u0f1s32\", w->getProto().getName());\n      EXPECT_EQ(1234567, u.get(\"u0f1s32\").as<int32_t>());\n    }\n    {\n      auto u = dynamic.get(\"union1\").as<DynamicStruct>();\n      EXPECT_MAYBE_EQ(w, u.which(), \"u1f1sp\", w->getProto().getName());\n      EXPECT_EQ(\"foo\", u.get(\"u1f1sp\").as<Text>());\n    }\n    {\n      auto u = dynamic.get(\"union2\").as<DynamicStruct>();\n      EXPECT_MAYBE_EQ(w, u.which(), \"u2f0s1\", w->getProto().getName());\n      EXPECT_TRUE(u.get(\"u2f0s1\").as<bool>());\n    }\n    {\n      auto u = dynamic.get(\"union3\").as<DynamicStruct>();\n      EXPECT_MAYBE_EQ(w, u.which(), \"u3f0s64\", w->getProto().getName());\n      EXPECT_EQ(1234567890123456789ll, u.get(\"u3f0s64\").as<int64_t>());\n    }\n  }\n\n  {\n    // Again as a builder.\n    auto dynamic = toDynamic(root);\n    {\n      auto u = dynamic.get(\"union0\").as<DynamicStruct>();\n      EXPECT_MAYBE_EQ(w, u.which(), \"u0f1s32\", w->getProto().getName());\n      EXPECT_EQ(1234567, u.get(\"u0f1s32\").as<int32_t>());\n    }\n    {\n      auto u = dynamic.get(\"union1\").as<DynamicStruct>();\n      EXPECT_MAYBE_EQ(w, u.which(), \"u1f1sp\", w->getProto().getName());\n      EXPECT_EQ(\"foo\", u.get(\"u1f1sp\").as<Text>());\n    }\n    {\n      auto u = dynamic.get(\"union2\").as<DynamicStruct>();\n      EXPECT_MAYBE_EQ(w, u.which(), \"u2f0s1\", w->getProto().getName());\n      EXPECT_TRUE(u.get(\"u2f0s1\").as<bool>());\n    }\n    {\n      auto u = dynamic.get(\"union3\").as<DynamicStruct>();\n      EXPECT_MAYBE_EQ(w, u.which(), \"u3f0s64\", w->getProto().getName());\n      EXPECT_EQ(1234567890123456789ll, u.get(\"u3f0s64\").as<int64_t>());\n    }\n  }\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic-test.c++",
    "lines": "225-232",
    "snippet": "TEST(DynamicApi, DynamicAnyStructs) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<DynamicStruct>(Schema::from<TestAllTypes>());\n\n  root.as<AnyStruct>().as<TestAllTypes>().setInt8Field(123);\n  EXPECT_EQ(root.get(\"int8Field\").as<int8_t>(), 123);\n  EXPECT_EQ(root.asReader().as<AnyStruct>().as<TestAllTypes>().getInt8Field(), 123);\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\"",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "root.asReader().as<AnyStruct>().as<TestAllTypes>().getInt8Field()",
            "123"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "root.get(\"int8Field\").as<int8_t>()",
            "123"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.get",
          "args": [],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "root.get",
          "args": [
            "\"int8Field\""
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "868-871",
          "snippet": "static inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }"
        }
      },
      {
        "call_info": {
          "callee": "root.as<AnyStruct>",
          "args": [
            "123"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.as<AnyStruct>",
          "args": [],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "as",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "601-604",
          "snippet": "BuilderFor<T> as() {\n    // T must be List<U>.\n    return BuilderFor<T>(_builder);\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nBuilderFor<T> as() {\n    // T must be List<U>.\n    return BuilderFor<T>(_builder);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "builder.initRoot<DynamicStruct>",
          "args": [
            "Schema::from<TestAllTypes>()"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<TestAllTypes>",
          "args": [],
          "line": 227
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"dynamic.h\"\n\nTEST(DynamicApi, DynamicAnyStructs) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<DynamicStruct>(Schema::from<TestAllTypes>());\n\n  root.as<AnyStruct>().as<TestAllTypes>().setInt8Field(123);\n  EXPECT_EQ(root.get(\"int8Field\").as<int8_t>(), 123);\n  EXPECT_EQ(root.asReader().as<AnyStruct>().as<TestAllTypes>().getInt8Field(), 123);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic-test.c++",
    "lines": "163-223",
    "snippet": "TEST(DynamicApi, DynamicAnyPointers) {\n  MallocMessageBuilder builder;\n  auto root = builder.getRoot<DynamicStruct>(Schema::from<test::TestAnyPointer>());\n\n  initDynamicTestMessage(\n      root.get(\"anyPointerField\").as<AnyPointer>()\n          .initAs<DynamicStruct>(Schema::from<TestAllTypes>()));\n  checkTestMessage(\n      root.asReader().as<test::TestAnyPointer>().getAnyPointerField().getAs<TestAllTypes>());\n\n  checkDynamicTestMessage(\n      root.asReader().get(\"anyPointerField\").as<AnyPointer>()\n          .getAs<DynamicStruct>(Schema::from<TestAllTypes>()));\n  checkDynamicTestMessage(\n      root.asReader().get(\"anyPointerField\").as<AnyPointer>()\n          .getAs<DynamicStruct>(Schema::from<TestAllTypes>()));\n  checkDynamicTestMessage(\n      root.get(\"anyPointerField\").as<AnyPointer>().asReader()\n          .getAs<DynamicStruct>(Schema::from<TestAllTypes>()));\n  checkDynamicTestMessage(\n      root.get(\"anyPointerField\").as<AnyPointer>()\n          .getAs<DynamicStruct>(Schema::from<TestAllTypes>()));\n\n  {\n    {\n      auto list = root.init(\"anyPointerField\").as<AnyPointer>()\n                      .initAs<DynamicList>(Schema::from<List<uint32_t>>(), 4);\n      list.set(0, 123);\n      list.set(1, 456);\n      list.set(2, 789);\n      list.set(3, 123456789);\n    }\n\n    {\n      auto list = root.asReader().as<test::TestAnyPointer>()\n          .getAnyPointerField().getAs<List<uint32_t>>();\n      ASSERT_EQ(4u, list.size());\n      EXPECT_EQ(123u, list[0]);\n      EXPECT_EQ(456u, list[1]);\n      EXPECT_EQ(789u, list[2]);\n      EXPECT_EQ(123456789u, list[3]);\n    }\n\n    checkList<uint32_t>(\n        root.asReader().get(\"anyPointerField\").as<AnyPointer>()\n            .getAs<DynamicList>(Schema::from<List<uint32_t>>()),\n        {123u, 456u, 789u, 123456789u});\n    checkList<uint32_t>(\n        root.asReader().get(\"anyPointerField\").as<AnyPointer>()\n            .getAs<DynamicList>(Schema::from<List<uint32_t>>()),\n        {123u, 456u, 789u, 123456789u});\n    checkList<uint32_t>(\n        root.get(\"anyPointerField\").as<AnyPointer>().asReader()\n            .getAs<DynamicList>(Schema::from<List<uint32_t>>()),\n        {123u, 456u, 789u, 123456789u});\n    checkList<uint32_t>(\n        root.get(\"anyPointerField\").as<AnyPointer>()\n            .getAs<DynamicList>(Schema::from<List<uint32_t>>()),\n        {123u, 456u, 789u, 123456789u});\n  }\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\"",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkList<uint32_t>",
          "args": [
            "root.get(\"anyPointerField\").as<AnyPointer>()\n            .getAs<DynamicList>(Schema::from<List<uint32_t>>())",
            "{123u, 456u, 789u, 123456789u}"
          ],
          "line": 218
        },
        "resolved": true,
        "details": {
          "function_name": "checkList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic-test.c++",
          "lines": "33-45",
          "snippet": "void checkList(T reader, std::initializer_list<ReaderFor<Element>> expected) {\n  auto list = reader.template as<DynamicList>();\n  ASSERT_EQ(expected.size(), list.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], list[i].template as<Element>());\n  }\n\n  auto typed = reader.template as<List<Element>>();\n  ASSERT_EQ(expected.size(), typed.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], typed[i]);\n  }\n}",
          "includes": [
            "#include \"test-util.h\"",
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"dynamic.h\"\n\nvoid checkList(T reader, std::initializer_list<ReaderFor<Element>> expected) {\n  auto list = reader.template as<DynamicList>();\n  ASSERT_EQ(expected.size(), list.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], list[i].template as<Element>());\n  }\n\n  auto typed = reader.template as<List<Element>>();\n  ASSERT_EQ(expected.size(), typed.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], typed[i]);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "root.get",
          "args": [
            "Schema::from<List<uint32_t>>()"
          ],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "868-871",
          "snippet": "static inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }"
        }
      },
      {
        "call_info": {
          "callee": "Schema::from<List<uint32_t>>",
          "args": [],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.get",
          "args": [],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Schema::from<List<uint32_t>>",
          "args": [],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [
            "Schema::from<List<uint32_t>>()"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<uint32_t>>",
          "args": [],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [],
          "line": 211
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [
            "\"anyPointerField\""
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [
            "Schema::from<List<uint32_t>>()"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<uint32_t>>",
          "args": [],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [
            "\"anyPointerField\""
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "123456789u",
            "list[3]"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "789u",
            "list[2]"
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "456u",
            "list[1]"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "123u",
            "list[0]"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "4u",
            "list.size()"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list.size",
          "args": [],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "599-599",
          "snippet": "inline uint size() { return _builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline uint size() { return _builder.size() / ELEMENTS; }"
        }
      },
      {
        "call_info": {
          "callee": "list.set",
          "args": [
            "3",
            "123456789"
          ],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "872-874",
          "snippet": "static inline void set(PointerBuilder builder, AnyList::Reader value) {\n    builder.setList(value._reader);\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline void set(PointerBuilder builder, AnyList::Reader value) {\n    builder.setList(value._reader);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "root.init",
          "args": [
            "Schema::from<List<uint32_t>>()",
            "4"
          ],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/pointer-helpers.h",
          "lines": "120-122",
          "snippet": "static inline typename T::Builder init(PointerBuilder builder, uint size) {\n    return builder.initBlob<T>(size * BYTES);\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"layout.h\"\n\nstatic inline typename T::Builder init(PointerBuilder builder, uint size) {\n    return builder.initBlob<T>(size * BYTES);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "Schema::from<List<uint32_t>>",
          "args": [],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.init",
          "args": [],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "init",
          "container": "OneOf",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/one-of.h",
          "lines": "77-81",
          "snippet": "void init(Params&&... params) {\n    if (tag != 0) destroy();\n    ctor(*reinterpret_cast<T*>(space), kj::fwd<Params>(params)...);\n    tag = typeIndex<T>();\n  }",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nOneOf {\n  void init(Params&&... params) {\n      if (tag != 0) destroy();\n      ctor(*reinterpret_cast<T*>(space), kj::fwd<Params>(params)...);\n      tag = typeIndex<T>();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "checkDynamicTestMessage",
          "args": [
            "root.get(\"anyPointerField\").as<AnyPointer>()\n          .getAs<DynamicStruct>(Schema::from<TestAllTypes>())"
          ],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "checkDynamicTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "867-869",
          "snippet": "void checkDynamicTestMessage(DynamicStruct::Reader reader) {\n  dynamicCheckTestMessage(reader);\n}",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkDynamicTestMessage(DynamicStruct::Reader reader) {\n  dynamicCheckTestMessage(reader);\n}"
        }
      },
      {
        "call_info": {
          "callee": "Schema::from<TestAllTypes>",
          "args": [],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [
            "Schema::from<TestAllTypes>()"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [
            "\"anyPointerField\""
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [
            "Schema::from<TestAllTypes>()"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [
            "\"anyPointerField\""
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "root.asReader().as<test::TestAnyPointer>().getAnyPointerField().getAs<TestAllTypes>()"
          ],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "initDynamicTestMessage",
          "args": [
            "root.get(\"anyPointerField\").as<AnyPointer>()\n          .initAs<DynamicStruct>(Schema::from<TestAllTypes>())"
          ],
          "line": 167
        },
        "resolved": true,
        "details": {
          "function_name": "initDynamicTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "855-857",
          "snippet": "void initDynamicTestMessage(DynamicStruct::Builder builder) {\n  dynamicInitTestMessage(builder);\n}",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initDynamicTestMessage(DynamicStruct::Builder builder) {\n  dynamicInitTestMessage(builder);\n}"
        }
      },
      {
        "call_info": {
          "callee": "builder.getRoot<DynamicStruct>",
          "args": [
            "Schema::from<test::TestAnyPointer>()"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"dynamic.h\"\n\nTEST(DynamicApi, DynamicAnyPointers) {\n  MallocMessageBuilder builder;\n  auto root = builder.getRoot<DynamicStruct>(Schema::from<test::TestAnyPointer>());\n\n  initDynamicTestMessage(\n      root.get(\"anyPointerField\").as<AnyPointer>()\n          .initAs<DynamicStruct>(Schema::from<TestAllTypes>()));\n  checkTestMessage(\n      root.asReader().as<test::TestAnyPointer>().getAnyPointerField().getAs<TestAllTypes>());\n\n  checkDynamicTestMessage(\n      root.asReader().get(\"anyPointerField\").as<AnyPointer>()\n          .getAs<DynamicStruct>(Schema::from<TestAllTypes>()));\n  checkDynamicTestMessage(\n      root.asReader().get(\"anyPointerField\").as<AnyPointer>()\n          .getAs<DynamicStruct>(Schema::from<TestAllTypes>()));\n  checkDynamicTestMessage(\n      root.get(\"anyPointerField\").as<AnyPointer>().asReader()\n          .getAs<DynamicStruct>(Schema::from<TestAllTypes>()));\n  checkDynamicTestMessage(\n      root.get(\"anyPointerField\").as<AnyPointer>()\n          .getAs<DynamicStruct>(Schema::from<TestAllTypes>()));\n\n  {\n    {\n      auto list = root.init(\"anyPointerField\").as<AnyPointer>()\n                      .initAs<DynamicList>(Schema::from<List<uint32_t>>(), 4);\n      list.set(0, 123);\n      list.set(1, 456);\n      list.set(2, 789);\n      list.set(3, 123456789);\n    }\n\n    {\n      auto list = root.asReader().as<test::TestAnyPointer>()\n          .getAnyPointerField().getAs<List<uint32_t>>();\n      ASSERT_EQ(4u, list.size());\n      EXPECT_EQ(123u, list[0]);\n      EXPECT_EQ(456u, list[1]);\n      EXPECT_EQ(789u, list[2]);\n      EXPECT_EQ(123456789u, list[3]);\n    }\n\n    checkList<uint32_t>(\n        root.asReader().get(\"anyPointerField\").as<AnyPointer>()\n            .getAs<DynamicList>(Schema::from<List<uint32_t>>()),\n        {123u, 456u, 789u, 123456789u});\n    checkList<uint32_t>(\n        root.asReader().get(\"anyPointerField\").as<AnyPointer>()\n            .getAs<DynamicList>(Schema::from<List<uint32_t>>()),\n        {123u, 456u, 789u, 123456789u});\n    checkList<uint32_t>(\n        root.get(\"anyPointerField\").as<AnyPointer>().asReader()\n            .getAs<DynamicList>(Schema::from<List<uint32_t>>()),\n        {123u, 456u, 789u, 123456789u});\n    checkList<uint32_t>(\n        root.get(\"anyPointerField\").as<AnyPointer>()\n            .getAs<DynamicList>(Schema::from<List<uint32_t>>()),\n        {123u, 456u, 789u, 123456789u});\n  }\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic-test.c++",
    "lines": "125-161",
    "snippet": "TEST(DynamicApi, AnyPointers) {\n  MallocMessageBuilder builder;\n  auto root = builder.getRoot<test::TestAnyPointer>();\n\n  initDynamicTestMessage(\n      root.getAnyPointerField().initAs<DynamicStruct>(Schema::from<TestAllTypes>()));\n  checkTestMessage(root.asReader().getAnyPointerField().getAs<TestAllTypes>());\n\n  checkDynamicTestMessage(\n      root.asReader().getAnyPointerField().getAs<DynamicStruct>(Schema::from<TestAllTypes>()));\n  checkDynamicTestMessage(\n      root.getAnyPointerField().getAs<DynamicStruct>(Schema::from<TestAllTypes>()));\n\n  {\n    {\n      auto list = root.getAnyPointerField().initAs<DynamicList>(Schema::from<List<uint32_t>>(), 4);\n      list.set(0, 123);\n      list.set(1, 456);\n      list.set(2, 789);\n      list.set(3, 123456789);\n    }\n\n    {\n      auto list = root.asReader().getAnyPointerField().getAs<List<uint32_t>>();\n      ASSERT_EQ(4u, list.size());\n      EXPECT_EQ(123u, list[0]);\n      EXPECT_EQ(456u, list[1]);\n      EXPECT_EQ(789u, list[2]);\n      EXPECT_EQ(123456789u, list[3]);\n    }\n\n    checkList<uint32_t>(root.asReader().getAnyPointerField().getAs<DynamicList>(\n        Schema::from<List<uint32_t>>()), {123u, 456u, 789u, 123456789u});\n    checkList<uint32_t>(root.getAnyPointerField().getAs<DynamicList>(\n        Schema::from<List<uint32_t>>()), {123u, 456u, 789u, 123456789u});\n  }\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\"",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkList<uint32_t>",
          "args": [
            "root.getAnyPointerField().getAs<DynamicList>(\n        Schema::from<List<uint32_t>>())",
            "{123u, 456u, 789u, 123456789u}"
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "checkList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic-test.c++",
          "lines": "33-45",
          "snippet": "void checkList(T reader, std::initializer_list<ReaderFor<Element>> expected) {\n  auto list = reader.template as<DynamicList>();\n  ASSERT_EQ(expected.size(), list.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], list[i].template as<Element>());\n  }\n\n  auto typed = reader.template as<List<Element>>();\n  ASSERT_EQ(expected.size(), typed.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], typed[i]);\n  }\n}",
          "includes": [
            "#include \"test-util.h\"",
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"dynamic.h\"\n\nvoid checkList(T reader, std::initializer_list<ReaderFor<Element>> expected) {\n  auto list = reader.template as<DynamicList>();\n  ASSERT_EQ(expected.size(), list.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], list[i].template as<Element>());\n  }\n\n  auto typed = reader.template as<List<Element>>();\n  ASSERT_EQ(expected.size(), typed.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], typed[i]);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [
            "Schema::from<List<uint32_t>>()"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<uint32_t>>",
          "args": [],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [
            "Schema::from<List<uint32_t>>()"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<uint32_t>>",
          "args": [],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "123456789u",
            "list[3]"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "789u",
            "list[2]"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "456u",
            "list[1]"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "123u",
            "list[0]"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "4u",
            "list.size()"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list.size",
          "args": [],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "599-599",
          "snippet": "inline uint size() { return _builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline uint size() { return _builder.size() / ELEMENTS; }"
        }
      },
      {
        "call_info": {
          "callee": "list.set",
          "args": [
            "3",
            "123456789"
          ],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "872-874",
          "snippet": "static inline void set(PointerBuilder builder, AnyList::Reader value) {\n    builder.setList(value._reader);\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline void set(PointerBuilder builder, AnyList::Reader value) {\n    builder.setList(value._reader);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [
            "Schema::from<List<uint32_t>>()",
            "4"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<uint32_t>>",
          "args": [],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "checkDynamicTestMessage",
          "args": [
            "root.getAnyPointerField().getAs<DynamicStruct>(Schema::from<TestAllTypes>())"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "checkDynamicTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "867-869",
          "snippet": "void checkDynamicTestMessage(DynamicStruct::Reader reader) {\n  dynamicCheckTestMessage(reader);\n}",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkDynamicTestMessage(DynamicStruct::Reader reader) {\n  dynamicCheckTestMessage(reader);\n}"
        }
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [
            "Schema::from<TestAllTypes>()"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<TestAllTypes>",
          "args": [],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [
            "Schema::from<TestAllTypes>()"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "root.asReader().getAnyPointerField().getAs<TestAllTypes>()"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "initDynamicTestMessage",
          "args": [
            "root.getAnyPointerField().initAs<DynamicStruct>(Schema::from<TestAllTypes>())"
          ],
          "line": 129
        },
        "resolved": true,
        "details": {
          "function_name": "initDynamicTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "855-857",
          "snippet": "void initDynamicTestMessage(DynamicStruct::Builder builder) {\n  dynamicInitTestMessage(builder);\n}",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initDynamicTestMessage(DynamicStruct::Builder builder) {\n  dynamicInitTestMessage(builder);\n}"
        }
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [
            "Schema::from<TestAllTypes>()"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getRoot<test::TestAnyPointer>",
          "args": [],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "getRoot",
          "container": "RpcRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1322-1324",
          "snippet": "inline AnyPointer::Builder getRoot() {\n      return paramsBuilder;\n    }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nRpcRequest {\n  inline AnyPointer::Builder getRoot() {\n        return paramsBuilder;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"dynamic.h\"\n\nTEST(DynamicApi, AnyPointers) {\n  MallocMessageBuilder builder;\n  auto root = builder.getRoot<test::TestAnyPointer>();\n\n  initDynamicTestMessage(\n      root.getAnyPointerField().initAs<DynamicStruct>(Schema::from<TestAllTypes>()));\n  checkTestMessage(root.asReader().getAnyPointerField().getAs<TestAllTypes>());\n\n  checkDynamicTestMessage(\n      root.asReader().getAnyPointerField().getAs<DynamicStruct>(Schema::from<TestAllTypes>()));\n  checkDynamicTestMessage(\n      root.getAnyPointerField().getAs<DynamicStruct>(Schema::from<TestAllTypes>()));\n\n  {\n    {\n      auto list = root.getAnyPointerField().initAs<DynamicList>(Schema::from<List<uint32_t>>(), 4);\n      list.set(0, 123);\n      list.set(1, 456);\n      list.set(2, 789);\n      list.set(3, 123456789);\n    }\n\n    {\n      auto list = root.asReader().getAnyPointerField().getAs<List<uint32_t>>();\n      ASSERT_EQ(4u, list.size());\n      EXPECT_EQ(123u, list[0]);\n      EXPECT_EQ(456u, list[1]);\n      EXPECT_EQ(789u, list[2]);\n      EXPECT_EQ(123456789u, list[3]);\n    }\n\n    checkList<uint32_t>(root.asReader().getAnyPointerField().getAs<DynamicList>(\n        Schema::from<List<uint32_t>>()), {123u, 456u, 789u, 123456789u});\n    checkList<uint32_t>(root.getAnyPointerField().getAs<DynamicList>(\n        Schema::from<List<uint32_t>>()), {123u, 456u, 789u, 123456789u});\n  }\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic-test.c++",
    "lines": "114-123",
    "snippet": "TEST(DynamicApi, ListListsRead) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<TestListDefaults>();\n\n  initTestMessage(root);\n\n  checkDynamicTestLists(toDynamic(root.asReader()));\n  checkDynamicTestLists(toDynamic(root).asReader());\n  checkDynamicTestLists(toDynamic(root));\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\"",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkDynamicTestLists",
          "args": [
            "toDynamic(root)"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "checkDynamicTestLists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "870-872",
          "snippet": "void checkDynamicTestLists(DynamicStruct::Reader reader) {\n  dynamicCheckListDefaults(reader);\n}",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkDynamicTestLists(DynamicStruct::Reader reader) {\n  dynamicCheckListDefaults(reader);\n}"
        }
      },
      {
        "call_info": {
          "callee": "toDynamic",
          "args": [
            "root"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "toDynamic",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "1246-1248",
          "snippet": "typename DynamicTypeFor<FromServer<T>>::Client toDynamic(kj::Own<T>&& value) {\n  return typename FromServer<T>::Client(kj::mv(value));\n}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ntypename DynamicTypeFor<FromServer<T>>::Client toDynamic(kj::Own<T>&& value) {\n  return typename FromServer<T>::Client(kj::mv(value));\n}"
        }
      },
      {
        "call_info": {
          "callee": "toDynamic",
          "args": [],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "root"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestListDefaults>",
          "args": [],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"dynamic.h\"\n\nTEST(DynamicApi, ListListsRead) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<TestListDefaults>();\n\n  initTestMessage(root);\n\n  checkDynamicTestLists(toDynamic(root.asReader()));\n  checkDynamicTestLists(toDynamic(root).asReader());\n  checkDynamicTestLists(toDynamic(root));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic-test.c++",
    "lines": "103-112",
    "snippet": "TEST(DynamicApi, ListListsBuild) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<DynamicStruct>(Schema::from<TestListDefaults>());\n\n  initDynamicTestLists(root);\n  checkTestMessage(root.asReader().as<TestListDefaults>());\n\n  checkDynamicTestLists(root.asReader());\n  checkDynamicTestLists(root);\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\"",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkDynamicTestLists",
          "args": [
            "root"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "checkDynamicTestLists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "870-872",
          "snippet": "void checkDynamicTestLists(DynamicStruct::Reader reader) {\n  dynamicCheckListDefaults(reader);\n}",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkDynamicTestLists(DynamicStruct::Reader reader) {\n  dynamicCheckListDefaults(reader);\n}"
        }
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      },
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "root.asReader().as<TestListDefaults>()"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "initDynamicTestLists",
          "args": [
            "root"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "initDynamicTestLists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "858-860",
          "snippet": "void initDynamicTestLists(DynamicStruct::Builder builder) {\n  dynamicInitListDefaults(builder);\n}",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initDynamicTestLists(DynamicStruct::Builder builder) {\n  dynamicInitListDefaults(builder);\n}"
        }
      },
      {
        "call_info": {
          "callee": "builder.initRoot<DynamicStruct>",
          "args": [
            "Schema::from<TestListDefaults>()"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<TestListDefaults>",
          "args": [],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"dynamic.h\"\n\nTEST(DynamicApi, ListListsBuild) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<DynamicStruct>(Schema::from<TestListDefaults>());\n\n  initDynamicTestLists(root);\n  checkTestMessage(root.asReader().as<TestListDefaults>());\n\n  checkDynamicTestLists(root.asReader());\n  checkDynamicTestLists(root);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic-test.c++",
    "lines": "93-101",
    "snippet": "TEST(DynamicApi, Zero) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<DynamicStruct>(Schema::from<TestAllTypes>());\n\n  checkDynamicTestMessageAllZero(root.asReader());\n  checkTestMessageAllZero(root.asReader().as<TestAllTypes>());\n  checkDynamicTestMessageAllZero(root);\n  checkTestMessageAllZero(root.asReader().as<TestAllTypes>());\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\"",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkTestMessageAllZero",
          "args": [
            "root.asReader().as<TestAllTypes>()"
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessageAllZero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "849-851",
          "snippet": "void checkTestMessageAllZero(TestAllTypes::Reader reader) {\n  genericCheckTestMessageAllZero(reader);\n}",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessageAllZero(TestAllTypes::Reader reader) {\n  genericCheckTestMessageAllZero(reader);\n}"
        }
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      },
      {
        "call_info": {
          "callee": "checkDynamicTestMessageAllZero",
          "args": [
            "root"
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "checkDynamicTestMessageAllZero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "876-878",
          "snippet": "void checkDynamicTestMessageAllZero(DynamicStruct::Reader reader) {\n  dynamicCheckTestMessageAllZero(reader);\n}",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkDynamicTestMessageAllZero(DynamicStruct::Reader reader) {\n  dynamicCheckTestMessageAllZero(reader);\n}"
        }
      },
      {
        "call_info": {
          "callee": "builder.initRoot<DynamicStruct>",
          "args": [
            "Schema::from<TestAllTypes>()"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<TestAllTypes>",
          "args": [],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"dynamic.h\"\n\nTEST(DynamicApi, Zero) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<DynamicStruct>(Schema::from<TestAllTypes>());\n\n  checkDynamicTestMessageAllZero(root.asReader());\n  checkTestMessageAllZero(root.asReader().as<TestAllTypes>());\n  checkDynamicTestMessageAllZero(root);\n  checkTestMessageAllZero(root.asReader().as<TestAllTypes>());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic-test.c++",
    "lines": "77-91",
    "snippet": "TEST(DynamicApi, DefaultsBuilder) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<DynamicStruct>(Schema::from<TestDefaults>());\n\n  checkTestMessage(root.asReader().as<TestDefaults>());\n  checkDynamicTestMessage(root.asReader());\n\n  // This will initialize the whole message, replacing null pointers with copies of defaults.\n  checkDynamicTestMessage(root);\n\n  // Check again now that the message is initialized.\n  checkTestMessage(root.asReader().as<TestDefaults>());\n  checkDynamicTestMessage(root.asReader());\n  checkDynamicTestMessage(root);\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\"",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkDynamicTestMessage",
          "args": [
            "root"
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "checkDynamicTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "867-869",
          "snippet": "void checkDynamicTestMessage(DynamicStruct::Reader reader) {\n  dynamicCheckTestMessage(reader);\n}",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkDynamicTestMessage(DynamicStruct::Reader reader) {\n  dynamicCheckTestMessage(reader);\n}"
        }
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      },
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "root.asReader().as<TestDefaults>()"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "builder.initRoot<DynamicStruct>",
          "args": [
            "Schema::from<TestDefaults>()"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<TestDefaults>",
          "args": [],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"dynamic.h\"\n\nTEST(DynamicApi, DefaultsBuilder) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<DynamicStruct>(Schema::from<TestDefaults>());\n\n  checkTestMessage(root.asReader().as<TestDefaults>());\n  checkDynamicTestMessage(root.asReader());\n\n  // This will initialize the whole message, replacing null pointers with copies of defaults.\n  checkDynamicTestMessage(root);\n\n  // Check again now that the message is initialized.\n  checkTestMessage(root.asReader().as<TestDefaults>());\n  checkDynamicTestMessage(root.asReader());\n  checkDynamicTestMessage(root);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic-test.c++",
    "lines": "69-75",
    "snippet": "TEST(DynamicApi, Defaults) {\n  AlignedData<1> nullRoot = {{0, 0, 0, 0, 0, 0, 0, 0}};\n  kj::ArrayPtr<const word> segments[1] = {kj::arrayPtr(nullRoot.words, 1)};\n  SegmentArrayMessageReader reader(kj::arrayPtr(segments, 1));\n  auto root = reader.getRoot<DynamicStruct>(Schema::from<TestDefaults>());\n  checkDynamicTestMessage(root);\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\"",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkDynamicTestMessage",
          "args": [
            "root"
          ],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "checkDynamicTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "867-869",
          "snippet": "void checkDynamicTestMessage(DynamicStruct::Reader reader) {\n  dynamicCheckTestMessage(reader);\n}",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkDynamicTestMessage(DynamicStruct::Reader reader) {\n  dynamicCheckTestMessage(reader);\n}"
        }
      },
      {
        "call_info": {
          "callee": "reader.getRoot<DynamicStruct>",
          "args": [
            "Schema::from<TestDefaults>()"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<TestDefaults>",
          "args": [],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::arrayPtr",
          "args": [
            "segments",
            "1"
          ],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "arrayPtr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "1194-1197",
          "snippet": "inline constexpr ArrayPtr<T> arrayPtr(T* begin, T* end) {\n  // Use this function to construct ArrayPtrs without writing out the type name.\n  return ArrayPtr<T>(begin, end);\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\ninline constexpr ArrayPtr<T> arrayPtr(T* begin, T* end) {\n  // Use this function to construct ArrayPtrs without writing out the type name.\n  return ArrayPtr<T>(begin, end);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"dynamic.h\"\n\nTEST(DynamicApi, Defaults) {\n  AlignedData<1> nullRoot = {{0, 0, 0, 0, 0, 0, 0, 0}};\n  kj::ArrayPtr<const word> segments[1] = {kj::arrayPtr(nullRoot.words, 1)};\n  SegmentArrayMessageReader reader(kj::arrayPtr(segments, 1));\n  auto root = reader.getRoot<DynamicStruct>(Schema::from<TestDefaults>());\n  checkDynamicTestMessage(root);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic-test.c++",
    "lines": "58-67",
    "snippet": "TEST(DynamicApi, Read) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<TestAllTypes>();\n\n  initTestMessage(root);\n\n  checkDynamicTestMessage(toDynamic(root.asReader()));\n  checkDynamicTestMessage(toDynamic(root).asReader());\n  checkDynamicTestMessage(toDynamic(root));\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\"",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkDynamicTestMessage",
          "args": [
            "toDynamic(root)"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "checkDynamicTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "867-869",
          "snippet": "void checkDynamicTestMessage(DynamicStruct::Reader reader) {\n  dynamicCheckTestMessage(reader);\n}",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkDynamicTestMessage(DynamicStruct::Reader reader) {\n  dynamicCheckTestMessage(reader);\n}"
        }
      },
      {
        "call_info": {
          "callee": "toDynamic",
          "args": [
            "root"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "toDynamic",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "1246-1248",
          "snippet": "typename DynamicTypeFor<FromServer<T>>::Client toDynamic(kj::Own<T>&& value) {\n  return typename FromServer<T>::Client(kj::mv(value));\n}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ntypename DynamicTypeFor<FromServer<T>>::Client toDynamic(kj::Own<T>&& value) {\n  return typename FromServer<T>::Client(kj::mv(value));\n}"
        }
      },
      {
        "call_info": {
          "callee": "toDynamic",
          "args": [],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "root"
          ],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"dynamic.h\"\n\nTEST(DynamicApi, Read) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<TestAllTypes>();\n\n  initTestMessage(root);\n\n  checkDynamicTestMessage(toDynamic(root.asReader()));\n  checkDynamicTestMessage(toDynamic(root).asReader());\n  checkDynamicTestMessage(toDynamic(root));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic-test.c++",
    "lines": "47-56",
    "snippet": "TEST(DynamicApi, Build) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<DynamicStruct>(Schema::from<TestAllTypes>());\n\n  initDynamicTestMessage(root);\n  checkTestMessage(root.asReader().as<TestAllTypes>());\n\n  checkDynamicTestMessage(root.asReader());\n  checkDynamicTestMessage(root);\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\"",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkDynamicTestMessage",
          "args": [
            "root"
          ],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "checkDynamicTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "867-869",
          "snippet": "void checkDynamicTestMessage(DynamicStruct::Reader reader) {\n  dynamicCheckTestMessage(reader);\n}",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkDynamicTestMessage(DynamicStruct::Reader reader) {\n  dynamicCheckTestMessage(reader);\n}"
        }
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      },
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "root.asReader().as<TestAllTypes>()"
          ],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "initDynamicTestMessage",
          "args": [
            "root"
          ],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "initDynamicTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "855-857",
          "snippet": "void initDynamicTestMessage(DynamicStruct::Builder builder) {\n  dynamicInitTestMessage(builder);\n}",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initDynamicTestMessage(DynamicStruct::Builder builder) {\n  dynamicInitTestMessage(builder);\n}"
        }
      },
      {
        "call_info": {
          "callee": "builder.initRoot<DynamicStruct>",
          "args": [
            "Schema::from<TestAllTypes>()"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<TestAllTypes>",
          "args": [],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"dynamic.h\"\n\nTEST(DynamicApi, Build) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<DynamicStruct>(Schema::from<TestAllTypes>());\n\n  initDynamicTestMessage(root);\n  checkTestMessage(root.asReader().as<TestAllTypes>());\n\n  checkDynamicTestMessage(root.asReader());\n  checkDynamicTestMessage(root);\n}"
  },
  {
    "function_name": "checkList",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic-test.c++",
    "lines": "33-45",
    "snippet": "void checkList(T reader, std::initializer_list<ReaderFor<Element>> expected) {\n  auto list = reader.template as<DynamicList>();\n  ASSERT_EQ(expected.size(), list.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], list[i].template as<Element>());\n  }\n\n  auto typed = reader.template as<List<Element>>();\n  ASSERT_EQ(expected.size(), typed.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], typed[i]);\n  }\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\"",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "expected.begin()[i]",
            "typed[i]"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "expected.begin",
          "args": [],
          "line": 43
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "550-550",
          "snippet": "inline Iterator begin() { return Iterator(this, 0); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Iterator begin() { return Iterator(this, 0); }"
        }
      },
      {
        "call_info": {
          "callee": "expected.size",
          "args": [],
          "line": 42
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "599-599",
          "snippet": "inline uint size() { return _builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline uint size() { return _builder.size() / ELEMENTS; }"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "expected.size()",
            "typed.size()"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.template as<List<Element>>",
          "args": [],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "expected.begin()[i]",
            "list[i].template as<Element>()"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list[i].template as<Element>",
          "args": [],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "expected.size()",
            "list.size()"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.template as<DynamicList>",
          "args": [],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"dynamic.h\"\n\nvoid checkList(T reader, std::initializer_list<ReaderFor<Element>> expected) {\n  auto list = reader.template as<DynamicList>();\n  ASSERT_EQ(expected.size(), list.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], list[i].template as<Element>());\n  }\n\n  auto typed = reader.template as<List<Element>>();\n  ASSERT_EQ(expected.size(), typed.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], typed[i]);\n  }\n}"
  }
]