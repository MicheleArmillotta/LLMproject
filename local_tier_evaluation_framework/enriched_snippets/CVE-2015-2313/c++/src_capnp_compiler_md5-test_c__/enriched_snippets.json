[
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/md5-test.c++",
    "lines": "35-59",
    "snippet": "TEST(Md5, Sum) {\n  EXPECT_STREQ(\"acbd18db4cc2f85cedef654fccc4a4d8\", doMd5(\"foo\").cStr());\n  EXPECT_STREQ(\"37b51d194a7513e45b56f6524f2d51f2\", doMd5(\"bar\").cStr());\n  EXPECT_STREQ(\"3858f62230ac3c915f300c664312c63f\", doMd5(\"foobar\").cStr());\n\n  {\n    Md5 md5;\n    md5.update(\"foo\");\n    md5.update(\"bar\");\n    EXPECT_STREQ(\"3858f62230ac3c915f300c664312c63f\", md5.finishAsHex().cStr());\n  }\n\n  EXPECT_STREQ(\"ebf2442d167a30ca4453f99abd8cddf4\", doMd5(\n      \"Hello, this is a long string that is more than 64 bytes because the md5 code uses a \"\n      \"buffer of 64 bytes.\").cStr());\n\n  {\n    Md5 md5;\n    md5.update(\"Hello, this is a long string \");\n    md5.update(\"that is more than 64 bytes \");\n    md5.update(\"because the md5 code uses a \");\n    md5.update(\"buffer of 64 bytes.\");\n    EXPECT_STREQ(\"ebf2442d167a30ca4453f99abd8cddf4\", md5.finishAsHex().cStr());\n  }\n}",
    "includes": [
      "#include <kj/compat/gtest.h>",
      "#include \"md5.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_STREQ",
          "args": [
            "\"ebf2442d167a30ca4453f99abd8cddf4\"",
            "md5.finishAsHex().cStr()"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "md5.finishAsHex",
          "args": [],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "md5.finishAsHex",
          "args": [],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "md5.update",
          "args": [
            "\"buffer of 64 bytes.\""
          ],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "update",
          "container": "Md5",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/md5.h",
          "lines": "52-54",
          "snippet": "inline void update(const char* data) {\n    return update(kj::StringPtr(data));\n  }",
          "includes": [
            "#include <kj/array.h>",
            "#include <kj/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/array.h>\n#include <kj/string.h>\n\nMd5 {\n  inline void update(const char* data) {\n      return update(kj::StringPtr(data));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_STREQ",
          "args": [
            "\"ebf2442d167a30ca4453f99abd8cddf4\"",
            "doMd5(\n      \"Hello, this is a long string that is more than 64 bytes because the md5 code uses a \"\n      \"buffer of 64 bytes.\").cStr()"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "doMd5",
          "args": [],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "doMd5",
          "args": [
            "\"Hello, this is a long string that is more than 64 bytes because the md5 code uses a \"\n      \"buffer of 64 bytes.\""
          ],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "doMd5",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/md5-test.c++",
          "lines": "29-33",
          "snippet": "static kj::String doMd5(kj::StringPtr text) {\n  Md5 md5;\n  md5.update(text);\n  return kj::str(md5.finishAsHex().cStr());\n}",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include \"md5.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include \"md5.h\"\n\nstatic kj::String doMd5(kj::StringPtr text) {\n  Md5 md5;\n  md5.update(text);\n  return kj::str(md5.finishAsHex().cStr());\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_STREQ",
          "args": [
            "\"3858f62230ac3c915f300c664312c63f\"",
            "md5.finishAsHex().cStr()"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "md5.finishAsHex",
          "args": [],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "md5.finishAsHex",
          "args": [],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_STREQ",
          "args": [
            "\"3858f62230ac3c915f300c664312c63f\"",
            "doMd5(\"foobar\").cStr()"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "doMd5",
          "args": [],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_STREQ",
          "args": [
            "\"37b51d194a7513e45b56f6524f2d51f2\"",
            "doMd5(\"bar\").cStr()"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "doMd5",
          "args": [],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_STREQ",
          "args": [
            "\"acbd18db4cc2f85cedef654fccc4a4d8\"",
            "doMd5(\"foo\").cStr()"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "doMd5",
          "args": [],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/compat/gtest.h>\n#include \"md5.h\"\n\nTEST(Md5, Sum) {\n  EXPECT_STREQ(\"acbd18db4cc2f85cedef654fccc4a4d8\", doMd5(\"foo\").cStr());\n  EXPECT_STREQ(\"37b51d194a7513e45b56f6524f2d51f2\", doMd5(\"bar\").cStr());\n  EXPECT_STREQ(\"3858f62230ac3c915f300c664312c63f\", doMd5(\"foobar\").cStr());\n\n  {\n    Md5 md5;\n    md5.update(\"foo\");\n    md5.update(\"bar\");\n    EXPECT_STREQ(\"3858f62230ac3c915f300c664312c63f\", md5.finishAsHex().cStr());\n  }\n\n  EXPECT_STREQ(\"ebf2442d167a30ca4453f99abd8cddf4\", doMd5(\n      \"Hello, this is a long string that is more than 64 bytes because the md5 code uses a \"\n      \"buffer of 64 bytes.\").cStr());\n\n  {\n    Md5 md5;\n    md5.update(\"Hello, this is a long string \");\n    md5.update(\"that is more than 64 bytes \");\n    md5.update(\"because the md5 code uses a \");\n    md5.update(\"buffer of 64 bytes.\");\n    EXPECT_STREQ(\"ebf2442d167a30ca4453f99abd8cddf4\", md5.finishAsHex().cStr());\n  }\n}"
  },
  {
    "function_name": "doMd5",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/md5-test.c++",
    "lines": "29-33",
    "snippet": "static kj::String doMd5(kj::StringPtr text) {\n  Md5 md5;\n  md5.update(text);\n  return kj::str(md5.finishAsHex().cStr());\n}",
    "includes": [
      "#include <kj/compat/gtest.h>",
      "#include \"md5.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "md5.finishAsHex().cStr()"
          ],
          "line": 32
        },
        "resolved": true,
        "details": {
          "function_name": "str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "341-341",
          "snippet": "inline String str(String&& s) { return mv(s); }",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\ninline String str(String&& s) { return mv(s); }"
        }
      },
      {
        "call_info": {
          "callee": "md5.finishAsHex",
          "args": [],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "md5.finishAsHex",
          "args": [],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "md5.update",
          "args": [
            "text"
          ],
          "line": 31
        },
        "resolved": true,
        "details": {
          "function_name": "update",
          "container": "Md5",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/md5.h",
          "lines": "52-54",
          "snippet": "inline void update(const char* data) {\n    return update(kj::StringPtr(data));\n  }",
          "includes": [
            "#include <kj/array.h>",
            "#include <kj/string.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/array.h>\n#include <kj/string.h>\n\nMd5 {\n  inline void update(const char* data) {\n      return update(kj::StringPtr(data));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/compat/gtest.h>\n#include \"md5.h\"\n\nstatic kj::String doMd5(kj::StringPtr text) {\n  Md5 md5;\n  md5.update(text);\n  return kj::str(md5.finishAsHex().cStr());\n}"
  }
]