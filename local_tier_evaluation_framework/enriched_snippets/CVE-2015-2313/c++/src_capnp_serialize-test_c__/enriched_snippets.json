[
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-test.c++",
    "lines": "407-425",
    "snippet": "TEST(Serialize, RejectHugeMessage) {\n  // A message whose root struct contains two words of data!\n  AlignedData<4> data = {{0,0,0,0,3,0,0,0, 0,0,0,0,2,0,0,0, 0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0}};\n\n  TestInputStream input(kj::arrayPtr(data.words, 4), false);\n\n  // We'll set the traversal limit to 2 words so our 3-word message is too big.\n  ReaderOptions options;\n  options.traversalLimitInWords = 2;\n\n  kj::Maybe<kj::Exception> e = kj::runCatchingExceptions([&]() {\n    InputStreamMessageReader reader(input, options);\n#if !KJ_NO_EXCEPTIONS\n    ADD_FAILURE() << \"Should have thrown an exception.\";\n#endif\n  });\n\n  KJ_EXPECT(e != nullptr, \"Should have thrown an exception.\");\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <fcntl.h>",
      "#include <stdlib.h>",
      "#include <string>",
      "#include <kj/miniposix.h>",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "KJ_EXPECT",
          "args": [
            "e != nullptr",
            "\"Should have thrown an exception.\""
          ],
          "line": 424
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::runCatchingExceptions",
          "args": [
            "[&]() {\n    InputStreamMessageReader reader(input, options);\n#if !KJ_NO_EXCEPTIONS\n    ADD_FAILURE() << \"Should have thrown an exception.\";\n#endif\n  }"
          ],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADD_FAILURE",
          "args": [],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::arrayPtr",
          "args": [
            "data.words",
            "4"
          ],
          "line": 411
        },
        "resolved": true,
        "details": {
          "function_name": "arrayPtr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "1194-1197",
          "snippet": "inline constexpr ArrayPtr<T> arrayPtr(T* begin, T* end) {\n  // Use this function to construct ArrayPtrs without writing out the type name.\n  return ArrayPtr<T>(begin, end);\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\ninline constexpr ArrayPtr<T> arrayPtr(T* begin, T* end) {\n  // Use this function to construct ArrayPtrs without writing out the type name.\n  return ArrayPtr<T>(begin, end);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <fcntl.h>\n#include <stdlib.h>\n#include <string>\n#include <kj/miniposix.h>\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n\nTEST(Serialize, RejectHugeMessage) {\n  // A message whose root struct contains two words of data!\n  AlignedData<4> data = {{0,0,0,0,3,0,0,0, 0,0,0,0,2,0,0,0, 0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0}};\n\n  TestInputStream input(kj::arrayPtr(data.words, 4), false);\n\n  // We'll set the traversal limit to 2 words so our 3-word message is too big.\n  ReaderOptions options;\n  options.traversalLimitInWords = 2;\n\n  kj::Maybe<kj::Exception> e = kj::runCatchingExceptions([&]() {\n    InputStreamMessageReader reader(input, options);\n#if !KJ_NO_EXCEPTIONS\n    ADD_FAILURE() << \"Should have thrown an exception.\";\n#endif\n  });\n\n  KJ_EXPECT(e != nullptr, \"Should have thrown an exception.\");\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-test.c++",
    "lines": "387-404",
    "snippet": "TEST(Serialize, RejectTooManySegments) {\n  kj::Array<word> data = kj::heapArray<word>(8192);\n  WireValue<uint32_t>* table = reinterpret_cast<WireValue<uint32_t>*>(data.begin());\n  table[0].set(1024);\n  for (uint i = 0; i < 1024; i++) {\n    table[i+1].set(1);\n  }\n  TestInputStream input(data.asPtr(), false);\n\n  kj::Maybe<kj::Exception> e = kj::runCatchingExceptions([&]() {\n    InputStreamMessageReader reader(input);\n#if !KJ_NO_EXCEPTIONS\n    ADD_FAILURE() << \"Should have thrown an exception.\";\n#endif\n  });\n\n  KJ_EXPECT(e != nullptr, \"Should have thrown an exception.\");\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <fcntl.h>",
      "#include <stdlib.h>",
      "#include <string>",
      "#include <kj/miniposix.h>",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "KJ_EXPECT",
          "args": [
            "e != nullptr",
            "\"Should have thrown an exception.\""
          ],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::runCatchingExceptions",
          "args": [
            "[&]() {\n    InputStreamMessageReader reader(input);\n#if !KJ_NO_EXCEPTIONS\n    ADD_FAILURE() << \"Should have thrown an exception.\";\n#endif\n  }"
          ],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADD_FAILURE",
          "args": [],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "data.asPtr",
          "args": [],
          "line": 394
        },
        "resolved": true,
        "details": {
          "function_name": "asPtr",
          "container": "ArrayBuilder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "313-315",
          "snippet": "inline ArrayPtr<const T> asPtr() const {\n    return arrayPtr(ptr, pos);\n  }",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\nArrayBuilder {\n  inline ArrayPtr<const T> asPtr() const {\n      return arrayPtr(ptr, pos);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "table[i+1].set",
          "args": [
            "1"
          ],
          "line": 392
        },
        "resolved": true,
        "details": {
          "function_name": "set",
          "container": "AnyPointer::Builder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "201-201",
          "snippet": "inline void set(Reader value) { builder.copyFrom(value.reader); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nAnyPointer {\n  Builder {\n    inline void set(Reader value) { builder.copyFrom(value.reader); }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<WireValue<uint32_t>*>",
          "args": [
            "data.begin()"
          ],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "data.begin",
          "args": [],
          "line": 389
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "550-550",
          "snippet": "inline Iterator begin() { return Iterator(this, 0); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Iterator begin() { return Iterator(this, 0); }"
        }
      },
      {
        "call_info": {
          "callee": "kj::heapArray<word>",
          "args": [
            "8192"
          ],
          "line": 388
        },
        "resolved": true,
        "details": {
          "function_name": "heapArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "696-698",
          "snippet": "inline Array<T> heapArray(std::initializer_list<T> init) {\n  return heapArray<T>(init.begin(), init.end());\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\ninline Array<T> heapArray(std::initializer_list<T> init) {\n  return heapArray<T>(init.begin(), init.end());\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <fcntl.h>\n#include <stdlib.h>\n#include <string>\n#include <kj/miniposix.h>\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n\nTEST(Serialize, RejectTooManySegments) {\n  kj::Array<word> data = kj::heapArray<word>(8192);\n  WireValue<uint32_t>* table = reinterpret_cast<WireValue<uint32_t>*>(data.begin());\n  table[0].set(1024);\n  for (uint i = 0; i < 1024; i++) {\n    table[i+1].set(1);\n  }\n  TestInputStream input(data.asPtr(), false);\n\n  kj::Maybe<kj::Exception> e = kj::runCatchingExceptions([&]() {\n    InputStreamMessageReader reader(input);\n#if !KJ_NO_EXCEPTIONS\n    ADD_FAILURE() << \"Should have thrown an exception.\";\n#endif\n  });\n\n  KJ_EXPECT(e != nullptr, \"Should have thrown an exception.\");\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-test.c++",
    "lines": "346-385",
    "snippet": "TEST(Serialize, FileDescriptors) {\n#if _WIN32 || __ANDROID__\n  // TODO(cleanup): Find the Windows temp directory? Seems overly difficult.\n  char filename[] = \"capnproto-serialize-test-XXXXXX\";\n#else\n  char filename[] = \"/tmp/capnproto-serialize-test-XXXXXX\";\n#endif\n  kj::AutoCloseFd tmpfile(mkstemp(filename));\n  ASSERT_GE(tmpfile.get(), 0);\n\n#if !_WIN32\n  // Unlink the file so that it will be deleted on close.\n  // (For win32, we already handled this is mkstemp().)\n  EXPECT_EQ(0, unlink(filename));\n#endif\n\n  {\n    TestMessageBuilder builder(7);\n    initTestMessage(builder.initRoot<TestAllTypes>());\n    writeMessageToFd(tmpfile.get(), builder);\n  }\n\n  {\n    TestMessageBuilder builder(1);\n    builder.initRoot<TestAllTypes>().setTextField(\"second message in file\");\n    writeMessageToFd(tmpfile.get(), builder);\n  }\n\n  lseek(tmpfile, 0, SEEK_SET);\n\n  {\n    StreamFdMessageReader reader(tmpfile.get());\n    checkTestMessage(reader.getRoot<TestAllTypes>());\n  }\n\n  {\n    StreamFdMessageReader reader(tmpfile.get());\n    EXPECT_EQ(\"second message in file\", reader.getRoot<TestAllTypes>().getTextField());\n  }\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <fcntl.h>",
      "#include <stdlib.h>",
      "#include <string>",
      "#include <kj/miniposix.h>",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"second message in file\"",
            "reader.getRoot<TestAllTypes>().getTextField()"
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getRoot<TestAllTypes>",
          "args": [],
          "line": 383
        },
        "resolved": true,
        "details": {
          "function_name": "getRoot",
          "container": "RpcRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1322-1324",
          "snippet": "inline AnyPointer::Builder getRoot() {\n      return paramsBuilder;\n    }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nRpcRequest {\n  inline AnyPointer::Builder getRoot() {\n        return paramsBuilder;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "tmpfile.get",
          "args": [],
          "line": 382
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "reader.getRoot<TestAllTypes>()"
          ],
          "line": 378
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "lseek",
          "args": [
            "tmpfile",
            "0",
            "SEEK_SET"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "writeMessageToFd",
          "args": [
            "tmpfile.get()",
            "builder"
          ],
          "line": 371
        },
        "resolved": true,
        "details": {
          "function_name": "writeMessageToFd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize.h",
          "lines": "217-219",
          "snippet": "inline void writeMessageToFd(int fd, MessageBuilder& builder) {\n  writeMessageToFd(fd, builder.getSegmentsForOutput());\n}",
          "includes": [
            "#include <kj/io.h>",
            "#include \"message.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/io.h>\n#include \"message.h\"\n\ninline void writeMessageToFd(int fd, MessageBuilder& builder) {\n  writeMessageToFd(fd, builder.getSegmentsForOutput());\n}"
        }
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [
            "\"second message in file\""
          ],
          "line": 370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "builder.initRoot<TestAllTypes>()"
          ],
          "line": 364
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "0",
            "unlink(filename)"
          ],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "filename"
          ],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_GE",
          "args": [
            "tmpfile.get()",
            "0"
          ],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <fcntl.h>\n#include <stdlib.h>\n#include <string>\n#include <kj/miniposix.h>\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n\nTEST(Serialize, FileDescriptors) {\n#if _WIN32 || __ANDROID__\n  // TODO(cleanup): Find the Windows temp directory? Seems overly difficult.\n  char filename[] = \"capnproto-serialize-test-XXXXXX\";\n#else\n  char filename[] = \"/tmp/capnproto-serialize-test-XXXXXX\";\n#endif\n  kj::AutoCloseFd tmpfile(mkstemp(filename));\n  ASSERT_GE(tmpfile.get(), 0);\n\n#if !_WIN32\n  // Unlink the file so that it will be deleted on close.\n  // (For win32, we already handled this is mkstemp().)\n  EXPECT_EQ(0, unlink(filename));\n#endif\n\n  {\n    TestMessageBuilder builder(7);\n    initTestMessage(builder.initRoot<TestAllTypes>());\n    writeMessageToFd(tmpfile.get(), builder);\n  }\n\n  {\n    TestMessageBuilder builder(1);\n    builder.initRoot<TestAllTypes>().setTextField(\"second message in file\");\n    writeMessageToFd(tmpfile.get(), builder);\n  }\n\n  lseek(tmpfile, 0, SEEK_SET);\n\n  {\n    StreamFdMessageReader reader(tmpfile.get());\n    checkTestMessage(reader.getRoot<TestAllTypes>());\n  }\n\n  {\n    StreamFdMessageReader reader(tmpfile.get());\n    EXPECT_EQ(\"second message in file\", reader.getRoot<TestAllTypes>().getTextField());\n  }\n}"
  },
  {
    "function_name": "mkstemp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-test.c++",
    "lines": "324-343",
    "snippet": "int mkstemp(char *tpl) {\n  char* end = tpl + strlen(tpl);\n  while (end > tpl && *(end-1) == 'X') --end;\n\n  for (;;) {\n    KJ_ASSERT(_mktemp(tpl) == tpl);\n\n    int fd = open(tpl, O_RDWR | O_CREAT | O_EXCL | O_TEMPORARY | O_BINARY, 0700);\n    if (fd >= 0) {\n      return fd;\n    }\n\n    int error = errno;\n    if (error != EEXIST && error != EINTR) {\n      KJ_FAIL_SYSCALL(\"open(mktemp())\", error, tpl);\n    }\n\n    memset(end, 'X', strlen(end));\n  }\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <fcntl.h>",
      "#include <stdlib.h>",
      "#include <string>",
      "#include <kj/miniposix.h>",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "end",
            "'X'",
            "strlen(end)"
          ],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "end"
          ],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_FAIL_SYSCALL",
          "args": [
            "\"open(mktemp())\"",
            "error",
            "tpl"
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "tpl",
            "O_RDWR | O_CREAT | O_EXCL | O_TEMPORARY | O_BINARY",
            "0700"
          ],
          "line": 331
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_ASSERT",
          "args": [
            "_mktemp(tpl) == tpl"
          ],
          "line": 329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_mktemp",
          "args": [
            "tpl"
          ],
          "line": 329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "tpl"
          ],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <fcntl.h>\n#include <stdlib.h>\n#include <string>\n#include <kj/miniposix.h>\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n\nint mkstemp(char *tpl) {\n  char* end = tpl + strlen(tpl);\n  while (end > tpl && *(end-1) == 'X') --end;\n\n  for (;;) {\n    KJ_ASSERT(_mktemp(tpl) == tpl);\n\n    int fd = open(tpl, O_RDWR | O_CREAT | O_EXCL | O_TEMPORARY | O_BINARY, 0700);\n    if (fd >= 0) {\n      return fd;\n    }\n\n    int error = errno;\n    if (error != EEXIST && error != EINTR) {\n      KJ_FAIL_SYSCALL(\"open(mktemp())\", error, tpl);\n    }\n\n    memset(end, 'X', strlen(end));\n  }\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-test.c++",
    "lines": "311-321",
    "snippet": "TEST(Serialize, WriteMessageEvenSegmentCount) {\n  TestMessageBuilder builder(10);\n  initTestMessage(builder.initRoot<TestAllTypes>());\n\n  kj::Array<word> serialized = messageToFlatArray(builder);\n\n  TestOutputStream output;\n  writeMessage(output, builder);\n\n  EXPECT_TRUE(output.dataEquals(serialized.asPtr()));\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <fcntl.h>",
      "#include <stdlib.h>",
      "#include <string>",
      "#include <kj/miniposix.h>",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "output.dataEquals(serialized.asPtr())"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "output.dataEquals",
          "args": [
            "serialized.asPtr()"
          ],
          "line": 320
        },
        "resolved": true,
        "details": {
          "function_name": "dataEquals",
          "container": "TestOutputStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-test.c++",
          "lines": "278-281",
          "snippet": "bool dataEquals(kj::ArrayPtr<const word> other) {\n    return data ==\n        std::string(other.asChars().begin(), other.asChars().size());\n  }",
          "includes": [
            "#include \"test-util.h\"",
            "#include <fcntl.h>",
            "#include <stdlib.h>",
            "#include <string>",
            "#include <kj/miniposix.h>",
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"test-util.h\"\n#include <fcntl.h>\n#include <stdlib.h>\n#include <string>\n#include <kj/miniposix.h>\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n\nTestOutputStream {\n  bool dataEquals(kj::ArrayPtr<const word> other) {\n      return data ==\n          std::string(other.asChars().begin(), other.asChars().size());\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "serialized.asPtr",
          "args": [],
          "line": 320
        },
        "resolved": true,
        "details": {
          "function_name": "asPtr",
          "container": "ArrayBuilder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "313-315",
          "snippet": "inline ArrayPtr<const T> asPtr() const {\n    return arrayPtr(ptr, pos);\n  }",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\nArrayBuilder {\n  inline ArrayPtr<const T> asPtr() const {\n      return arrayPtr(ptr, pos);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "writeMessage",
          "args": [
            "output",
            "builder"
          ],
          "line": 318
        },
        "resolved": true,
        "details": {
          "function_name": "writeMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-async.h",
          "lines": "58-60",
          "snippet": "inline kj::Promise<void> writeMessage(kj::AsyncOutputStream& output, MessageBuilder& builder) {\n  return writeMessage(output, builder.getSegmentsForOutput());\n}",
          "includes": [
            "#include \"message.h\"",
            "#include <kj/async-io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"message.h\"\n#include <kj/async-io.h>\n\ninline kj::Promise<void> writeMessage(kj::AsyncOutputStream& output, MessageBuilder& builder) {\n  return writeMessage(output, builder.getSegmentsForOutput());\n}"
        }
      },
      {
        "call_info": {
          "callee": "messageToFlatArray",
          "args": [
            "builder"
          ],
          "line": 315
        },
        "resolved": true,
        "details": {
          "function_name": "messageToFlatArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize.c++",
          "lines": "100-130",
          "snippet": "kj::Array<word> messageToFlatArray(kj::ArrayPtr<const kj::ArrayPtr<const word>> segments) {\n  kj::Array<word> result = kj::heapArray<word>(computeSerializedSizeInWords(segments));\n\n  _::WireValue<uint32_t>* table =\n      reinterpret_cast<_::WireValue<uint32_t>*>(result.begin());\n\n  // We write the segment count - 1 because this makes the first word zero for single-segment\n  // messages, improving compression.  We don't bother doing this with segment sizes because\n  // one-word segments are rare anyway.\n  table[0].set(segments.size() - 1);\n\n  for (uint i = 0; i < segments.size(); i++) {\n    table[i + 1].set(segments[i].size());\n  }\n\n  if (segments.size() % 2 == 0) {\n    // Set padding byte.\n    table[segments.size() + 1].set(0);\n  }\n\n  word* dst = result.begin() + segments.size() / 2 + 1;\n\n  for (auto& segment: segments) {\n    memcpy(dst, segment.begin(), segment.size() * sizeof(word));\n    dst += segment.size();\n  }\n\n  KJ_DASSERT(dst == result.end(), \"Buffer overrun/underrun bug in code above.\");\n\n  return kj::mv(result);\n}",
          "includes": [
            "#include <exception>",
            "#include <kj/debug.h>",
            "#include \"layout.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <exception>\n#include <kj/debug.h>\n#include \"layout.h\"\n#include \"serialize.h\"\n\nkj::Array<word> messageToFlatArray(kj::ArrayPtr<const kj::ArrayPtr<const word>> segments) {\n  kj::Array<word> result = kj::heapArray<word>(computeSerializedSizeInWords(segments));\n\n  _::WireValue<uint32_t>* table =\n      reinterpret_cast<_::WireValue<uint32_t>*>(result.begin());\n\n  // We write the segment count - 1 because this makes the first word zero for single-segment\n  // messages, improving compression.  We don't bother doing this with segment sizes because\n  // one-word segments are rare anyway.\n  table[0].set(segments.size() - 1);\n\n  for (uint i = 0; i < segments.size(); i++) {\n    table[i + 1].set(segments[i].size());\n  }\n\n  if (segments.size() % 2 == 0) {\n    // Set padding byte.\n    table[segments.size() + 1].set(0);\n  }\n\n  word* dst = result.begin() + segments.size() / 2 + 1;\n\n  for (auto& segment: segments) {\n    memcpy(dst, segment.begin(), segment.size() * sizeof(word));\n    dst += segment.size();\n  }\n\n  KJ_DASSERT(dst == result.end(), \"Buffer overrun/underrun bug in code above.\");\n\n  return kj::mv(result);\n}"
        }
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "builder.initRoot<TestAllTypes>()"
          ],
          "line": 313
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <fcntl.h>\n#include <stdlib.h>\n#include <string>\n#include <kj/miniposix.h>\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n\nTEST(Serialize, WriteMessageEvenSegmentCount) {\n  TestMessageBuilder builder(10);\n  initTestMessage(builder.initRoot<TestAllTypes>());\n\n  kj::Array<word> serialized = messageToFlatArray(builder);\n\n  TestOutputStream output;\n  writeMessage(output, builder);\n\n  EXPECT_TRUE(output.dataEquals(serialized.asPtr()));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-test.c++",
    "lines": "299-309",
    "snippet": "TEST(Serialize, WriteMessageOddSegmentCount) {\n  TestMessageBuilder builder(7);\n  initTestMessage(builder.initRoot<TestAllTypes>());\n\n  kj::Array<word> serialized = messageToFlatArray(builder);\n\n  TestOutputStream output;\n  writeMessage(output, builder);\n\n  EXPECT_TRUE(output.dataEquals(serialized.asPtr()));\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <fcntl.h>",
      "#include <stdlib.h>",
      "#include <string>",
      "#include <kj/miniposix.h>",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "output.dataEquals(serialized.asPtr())"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "output.dataEquals",
          "args": [
            "serialized.asPtr()"
          ],
          "line": 308
        },
        "resolved": true,
        "details": {
          "function_name": "dataEquals",
          "container": "TestOutputStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-test.c++",
          "lines": "278-281",
          "snippet": "bool dataEquals(kj::ArrayPtr<const word> other) {\n    return data ==\n        std::string(other.asChars().begin(), other.asChars().size());\n  }",
          "includes": [
            "#include \"test-util.h\"",
            "#include <fcntl.h>",
            "#include <stdlib.h>",
            "#include <string>",
            "#include <kj/miniposix.h>",
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"test-util.h\"\n#include <fcntl.h>\n#include <stdlib.h>\n#include <string>\n#include <kj/miniposix.h>\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n\nTestOutputStream {\n  bool dataEquals(kj::ArrayPtr<const word> other) {\n      return data ==\n          std::string(other.asChars().begin(), other.asChars().size());\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "serialized.asPtr",
          "args": [],
          "line": 308
        },
        "resolved": true,
        "details": {
          "function_name": "asPtr",
          "container": "ArrayBuilder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "313-315",
          "snippet": "inline ArrayPtr<const T> asPtr() const {\n    return arrayPtr(ptr, pos);\n  }",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\nArrayBuilder {\n  inline ArrayPtr<const T> asPtr() const {\n      return arrayPtr(ptr, pos);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "writeMessage",
          "args": [
            "output",
            "builder"
          ],
          "line": 306
        },
        "resolved": true,
        "details": {
          "function_name": "writeMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-async.h",
          "lines": "58-60",
          "snippet": "inline kj::Promise<void> writeMessage(kj::AsyncOutputStream& output, MessageBuilder& builder) {\n  return writeMessage(output, builder.getSegmentsForOutput());\n}",
          "includes": [
            "#include \"message.h\"",
            "#include <kj/async-io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"message.h\"\n#include <kj/async-io.h>\n\ninline kj::Promise<void> writeMessage(kj::AsyncOutputStream& output, MessageBuilder& builder) {\n  return writeMessage(output, builder.getSegmentsForOutput());\n}"
        }
      },
      {
        "call_info": {
          "callee": "messageToFlatArray",
          "args": [
            "builder"
          ],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "messageToFlatArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize.c++",
          "lines": "100-130",
          "snippet": "kj::Array<word> messageToFlatArray(kj::ArrayPtr<const kj::ArrayPtr<const word>> segments) {\n  kj::Array<word> result = kj::heapArray<word>(computeSerializedSizeInWords(segments));\n\n  _::WireValue<uint32_t>* table =\n      reinterpret_cast<_::WireValue<uint32_t>*>(result.begin());\n\n  // We write the segment count - 1 because this makes the first word zero for single-segment\n  // messages, improving compression.  We don't bother doing this with segment sizes because\n  // one-word segments are rare anyway.\n  table[0].set(segments.size() - 1);\n\n  for (uint i = 0; i < segments.size(); i++) {\n    table[i + 1].set(segments[i].size());\n  }\n\n  if (segments.size() % 2 == 0) {\n    // Set padding byte.\n    table[segments.size() + 1].set(0);\n  }\n\n  word* dst = result.begin() + segments.size() / 2 + 1;\n\n  for (auto& segment: segments) {\n    memcpy(dst, segment.begin(), segment.size() * sizeof(word));\n    dst += segment.size();\n  }\n\n  KJ_DASSERT(dst == result.end(), \"Buffer overrun/underrun bug in code above.\");\n\n  return kj::mv(result);\n}",
          "includes": [
            "#include <exception>",
            "#include <kj/debug.h>",
            "#include \"layout.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <exception>\n#include <kj/debug.h>\n#include \"layout.h\"\n#include \"serialize.h\"\n\nkj::Array<word> messageToFlatArray(kj::ArrayPtr<const kj::ArrayPtr<const word>> segments) {\n  kj::Array<word> result = kj::heapArray<word>(computeSerializedSizeInWords(segments));\n\n  _::WireValue<uint32_t>* table =\n      reinterpret_cast<_::WireValue<uint32_t>*>(result.begin());\n\n  // We write the segment count - 1 because this makes the first word zero for single-segment\n  // messages, improving compression.  We don't bother doing this with segment sizes because\n  // one-word segments are rare anyway.\n  table[0].set(segments.size() - 1);\n\n  for (uint i = 0; i < segments.size(); i++) {\n    table[i + 1].set(segments[i].size());\n  }\n\n  if (segments.size() % 2 == 0) {\n    // Set padding byte.\n    table[segments.size() + 1].set(0);\n  }\n\n  word* dst = result.begin() + segments.size() / 2 + 1;\n\n  for (auto& segment: segments) {\n    memcpy(dst, segment.begin(), segment.size() * sizeof(word));\n    dst += segment.size();\n  }\n\n  KJ_DASSERT(dst == result.end(), \"Buffer overrun/underrun bug in code above.\");\n\n  return kj::mv(result);\n}"
        }
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "builder.initRoot<TestAllTypes>()"
          ],
          "line": 301
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <fcntl.h>\n#include <stdlib.h>\n#include <string>\n#include <kj/miniposix.h>\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n\nTEST(Serialize, WriteMessageOddSegmentCount) {\n  TestMessageBuilder builder(7);\n  initTestMessage(builder.initRoot<TestAllTypes>());\n\n  kj::Array<word> serialized = messageToFlatArray(builder);\n\n  TestOutputStream output;\n  writeMessage(output, builder);\n\n  EXPECT_TRUE(output.dataEquals(serialized.asPtr()));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-test.c++",
    "lines": "287-297",
    "snippet": "TEST(Serialize, WriteMessage) {\n  TestMessageBuilder builder(1);\n  initTestMessage(builder.initRoot<TestAllTypes>());\n\n  kj::Array<word> serialized = messageToFlatArray(builder);\n\n  TestOutputStream output;\n  writeMessage(output, builder);\n\n  EXPECT_TRUE(output.dataEquals(serialized.asPtr()));\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <fcntl.h>",
      "#include <stdlib.h>",
      "#include <string>",
      "#include <kj/miniposix.h>",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "output.dataEquals(serialized.asPtr())"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "output.dataEquals",
          "args": [
            "serialized.asPtr()"
          ],
          "line": 296
        },
        "resolved": true,
        "details": {
          "function_name": "dataEquals",
          "container": "TestOutputStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-test.c++",
          "lines": "278-281",
          "snippet": "bool dataEquals(kj::ArrayPtr<const word> other) {\n    return data ==\n        std::string(other.asChars().begin(), other.asChars().size());\n  }",
          "includes": [
            "#include \"test-util.h\"",
            "#include <fcntl.h>",
            "#include <stdlib.h>",
            "#include <string>",
            "#include <kj/miniposix.h>",
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"test-util.h\"\n#include <fcntl.h>\n#include <stdlib.h>\n#include <string>\n#include <kj/miniposix.h>\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n\nTestOutputStream {\n  bool dataEquals(kj::ArrayPtr<const word> other) {\n      return data ==\n          std::string(other.asChars().begin(), other.asChars().size());\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "serialized.asPtr",
          "args": [],
          "line": 296
        },
        "resolved": true,
        "details": {
          "function_name": "asPtr",
          "container": "ArrayBuilder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "313-315",
          "snippet": "inline ArrayPtr<const T> asPtr() const {\n    return arrayPtr(ptr, pos);\n  }",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\nArrayBuilder {\n  inline ArrayPtr<const T> asPtr() const {\n      return arrayPtr(ptr, pos);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "writeMessage",
          "args": [
            "output",
            "builder"
          ],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "writeMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-async.h",
          "lines": "58-60",
          "snippet": "inline kj::Promise<void> writeMessage(kj::AsyncOutputStream& output, MessageBuilder& builder) {\n  return writeMessage(output, builder.getSegmentsForOutput());\n}",
          "includes": [
            "#include \"message.h\"",
            "#include <kj/async-io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"message.h\"\n#include <kj/async-io.h>\n\ninline kj::Promise<void> writeMessage(kj::AsyncOutputStream& output, MessageBuilder& builder) {\n  return writeMessage(output, builder.getSegmentsForOutput());\n}"
        }
      },
      {
        "call_info": {
          "callee": "messageToFlatArray",
          "args": [
            "builder"
          ],
          "line": 291
        },
        "resolved": true,
        "details": {
          "function_name": "messageToFlatArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize.c++",
          "lines": "100-130",
          "snippet": "kj::Array<word> messageToFlatArray(kj::ArrayPtr<const kj::ArrayPtr<const word>> segments) {\n  kj::Array<word> result = kj::heapArray<word>(computeSerializedSizeInWords(segments));\n\n  _::WireValue<uint32_t>* table =\n      reinterpret_cast<_::WireValue<uint32_t>*>(result.begin());\n\n  // We write the segment count - 1 because this makes the first word zero for single-segment\n  // messages, improving compression.  We don't bother doing this with segment sizes because\n  // one-word segments are rare anyway.\n  table[0].set(segments.size() - 1);\n\n  for (uint i = 0; i < segments.size(); i++) {\n    table[i + 1].set(segments[i].size());\n  }\n\n  if (segments.size() % 2 == 0) {\n    // Set padding byte.\n    table[segments.size() + 1].set(0);\n  }\n\n  word* dst = result.begin() + segments.size() / 2 + 1;\n\n  for (auto& segment: segments) {\n    memcpy(dst, segment.begin(), segment.size() * sizeof(word));\n    dst += segment.size();\n  }\n\n  KJ_DASSERT(dst == result.end(), \"Buffer overrun/underrun bug in code above.\");\n\n  return kj::mv(result);\n}",
          "includes": [
            "#include <exception>",
            "#include <kj/debug.h>",
            "#include \"layout.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <exception>\n#include <kj/debug.h>\n#include \"layout.h\"\n#include \"serialize.h\"\n\nkj::Array<word> messageToFlatArray(kj::ArrayPtr<const kj::ArrayPtr<const word>> segments) {\n  kj::Array<word> result = kj::heapArray<word>(computeSerializedSizeInWords(segments));\n\n  _::WireValue<uint32_t>* table =\n      reinterpret_cast<_::WireValue<uint32_t>*>(result.begin());\n\n  // We write the segment count - 1 because this makes the first word zero for single-segment\n  // messages, improving compression.  We don't bother doing this with segment sizes because\n  // one-word segments are rare anyway.\n  table[0].set(segments.size() - 1);\n\n  for (uint i = 0; i < segments.size(); i++) {\n    table[i + 1].set(segments[i].size());\n  }\n\n  if (segments.size() % 2 == 0) {\n    // Set padding byte.\n    table[segments.size() + 1].set(0);\n  }\n\n  word* dst = result.begin() + segments.size() / 2 + 1;\n\n  for (auto& segment: segments) {\n    memcpy(dst, segment.begin(), segment.size() * sizeof(word));\n    dst += segment.size();\n  }\n\n  KJ_DASSERT(dst == result.end(), \"Buffer overrun/underrun bug in code above.\");\n\n  return kj::mv(result);\n}"
        }
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "builder.initRoot<TestAllTypes>()"
          ],
          "line": 289
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <fcntl.h>\n#include <stdlib.h>\n#include <string>\n#include <kj/miniposix.h>\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n\nTEST(Serialize, WriteMessage) {\n  TestMessageBuilder builder(1);\n  initTestMessage(builder.initRoot<TestAllTypes>());\n\n  kj::Array<word> serialized = messageToFlatArray(builder);\n\n  TestOutputStream output;\n  writeMessage(output, builder);\n\n  EXPECT_TRUE(output.dataEquals(serialized.asPtr()));\n}"
  },
  {
    "function_name": "dataEquals",
    "container": "TestOutputStream",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-test.c++",
    "lines": "278-281",
    "snippet": "bool dataEquals(kj::ArrayPtr<const word> other) {\n    return data ==\n        std::string(other.asChars().begin(), other.asChars().size());\n  }",
    "includes": [
      "#include \"test-util.h\"",
      "#include <fcntl.h>",
      "#include <stdlib.h>",
      "#include <string>",
      "#include <kj/miniposix.h>",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "other.asChars().begin()",
            "other.asChars().size()"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "other.asChars",
          "args": [],
          "line": 280
        },
        "resolved": true,
        "details": {
          "function_name": "asChars",
          "container": "ArrayPtr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "1164-1168",
          "snippet": "inline ArrayPtr<PropagateConst<T, char>> asChars() const {\n    // Reinterpret the array as a char array. This is explicitly legal under C++ aliasing\n    // rules.\n    return { reinterpret_cast<PropagateConst<T, char>*>(ptr), size_ * sizeof(T) };\n  }",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\nArrayPtr {\n  inline ArrayPtr<PropagateConst<T, char>> asChars() const {\n      // Reinterpret the array as a char array. This is explicitly legal under C++ aliasing\n      // rules.\n      return { reinterpret_cast<PropagateConst<T, char>*>(ptr), size_ * sizeof(T) };\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <fcntl.h>\n#include <stdlib.h>\n#include <string>\n#include <kj/miniposix.h>\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n\nTestOutputStream {\n  bool dataEquals(kj::ArrayPtr<const word> other) {\n      return data ==\n          std::string(other.asChars().begin(), other.asChars().size());\n    }\n}"
  },
  {
    "function_name": "write",
    "container": "TestOutputStream",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-test.c++",
    "lines": "274-276",
    "snippet": "void write(const void* buffer, size_t size) override {\n    data.append(reinterpret_cast<const char*>(buffer), size);\n  }",
    "includes": [
      "#include \"test-util.h\"",
      "#include <fcntl.h>",
      "#include <stdlib.h>",
      "#include <string>",
      "#include <kj/miniposix.h>",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "data.append",
          "args": [
            "reinterpret_cast<const char*>(buffer)",
            "size"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<const char*>",
          "args": [
            "buffer"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <fcntl.h>\n#include <stdlib.h>\n#include <string>\n#include <kj/miniposix.h>\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n\nTestOutputStream {\n  void write(const void* buffer, size_t size) override {\n      data.append(reinterpret_cast<const char*>(buffer), size);\n    }\n}"
  },
  {
    "function_name": "TestOutputStream",
    "container": "TestOutputStream",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-test.c++",
    "lines": "271-271",
    "snippet": "TestOutputStream() {}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <fcntl.h>",
      "#include <stdlib.h>",
      "#include <string>",
      "#include <kj/miniposix.h>",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"test-util.h\"\n#include <fcntl.h>\n#include <stdlib.h>\n#include <string>\n#include <kj/miniposix.h>\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n\nTestOutputStream {\n  TestOutputStream() {}\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-test.c++",
    "lines": "255-267",
    "snippet": "TEST(Serialize, InputStreamToBuilder) {\n  TestMessageBuilder builder(1);\n  initTestMessage(builder.initRoot<TestAllTypes>());\n\n  kj::Array<word> serialized = messageToFlatArray(builder);\n\n  TestInputStream stream(serialized.asPtr(), false);\n\n  MallocMessageBuilder builder2;\n  readMessageCopy(stream, builder2);\n\n  checkTestMessage(builder2.getRoot<TestAllTypes>());\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <fcntl.h>",
      "#include <stdlib.h>",
      "#include <string>",
      "#include <kj/miniposix.h>",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "builder2.getRoot<TestAllTypes>()"
          ],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "builder2.getRoot<TestAllTypes>",
          "args": [],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "getRoot",
          "container": "RpcRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1322-1324",
          "snippet": "inline AnyPointer::Builder getRoot() {\n      return paramsBuilder;\n    }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nRpcRequest {\n  inline AnyPointer::Builder getRoot() {\n        return paramsBuilder;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "readMessageCopy",
          "args": [
            "stream",
            "builder2"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "serialized.asPtr",
          "args": [],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "asPtr",
          "container": "ArrayBuilder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "313-315",
          "snippet": "inline ArrayPtr<const T> asPtr() const {\n    return arrayPtr(ptr, pos);\n  }",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\nArrayBuilder {\n  inline ArrayPtr<const T> asPtr() const {\n      return arrayPtr(ptr, pos);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "messageToFlatArray",
          "args": [
            "builder"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "messageToFlatArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize.c++",
          "lines": "100-130",
          "snippet": "kj::Array<word> messageToFlatArray(kj::ArrayPtr<const kj::ArrayPtr<const word>> segments) {\n  kj::Array<word> result = kj::heapArray<word>(computeSerializedSizeInWords(segments));\n\n  _::WireValue<uint32_t>* table =\n      reinterpret_cast<_::WireValue<uint32_t>*>(result.begin());\n\n  // We write the segment count - 1 because this makes the first word zero for single-segment\n  // messages, improving compression.  We don't bother doing this with segment sizes because\n  // one-word segments are rare anyway.\n  table[0].set(segments.size() - 1);\n\n  for (uint i = 0; i < segments.size(); i++) {\n    table[i + 1].set(segments[i].size());\n  }\n\n  if (segments.size() % 2 == 0) {\n    // Set padding byte.\n    table[segments.size() + 1].set(0);\n  }\n\n  word* dst = result.begin() + segments.size() / 2 + 1;\n\n  for (auto& segment: segments) {\n    memcpy(dst, segment.begin(), segment.size() * sizeof(word));\n    dst += segment.size();\n  }\n\n  KJ_DASSERT(dst == result.end(), \"Buffer overrun/underrun bug in code above.\");\n\n  return kj::mv(result);\n}",
          "includes": [
            "#include <exception>",
            "#include <kj/debug.h>",
            "#include \"layout.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <exception>\n#include <kj/debug.h>\n#include \"layout.h\"\n#include \"serialize.h\"\n\nkj::Array<word> messageToFlatArray(kj::ArrayPtr<const kj::ArrayPtr<const word>> segments) {\n  kj::Array<word> result = kj::heapArray<word>(computeSerializedSizeInWords(segments));\n\n  _::WireValue<uint32_t>* table =\n      reinterpret_cast<_::WireValue<uint32_t>*>(result.begin());\n\n  // We write the segment count - 1 because this makes the first word zero for single-segment\n  // messages, improving compression.  We don't bother doing this with segment sizes because\n  // one-word segments are rare anyway.\n  table[0].set(segments.size() - 1);\n\n  for (uint i = 0; i < segments.size(); i++) {\n    table[i + 1].set(segments[i].size());\n  }\n\n  if (segments.size() % 2 == 0) {\n    // Set padding byte.\n    table[segments.size() + 1].set(0);\n  }\n\n  word* dst = result.begin() + segments.size() / 2 + 1;\n\n  for (auto& segment: segments) {\n    memcpy(dst, segment.begin(), segment.size() * sizeof(word));\n    dst += segment.size();\n  }\n\n  KJ_DASSERT(dst == result.end(), \"Buffer overrun/underrun bug in code above.\");\n\n  return kj::mv(result);\n}"
        }
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "builder.initRoot<TestAllTypes>()"
          ],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <fcntl.h>\n#include <stdlib.h>\n#include <string>\n#include <kj/miniposix.h>\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n\nTEST(Serialize, InputStreamToBuilder) {\n  TestMessageBuilder builder(1);\n  initTestMessage(builder.initRoot<TestAllTypes>());\n\n  kj::Array<word> serialized = messageToFlatArray(builder);\n\n  TestInputStream stream(serialized.asPtr(), false);\n\n  MallocMessageBuilder builder2;\n  readMessageCopy(stream, builder2);\n\n  checkTestMessage(builder2.getRoot<TestAllTypes>());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-test.c++",
    "lines": "243-253",
    "snippet": "TEST(Serialize, InputStreamEvenSegmentCountLazy) {\n  TestMessageBuilder builder(10);\n  initTestMessage(builder.initRoot<TestAllTypes>());\n\n  kj::Array<word> serialized = messageToFlatArray(builder);\n\n  TestInputStream stream(serialized.asPtr(), true);\n  InputStreamMessageReader reader(stream, ReaderOptions());\n\n  checkTestMessage(reader.getRoot<TestAllTypes>());\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <fcntl.h>",
      "#include <stdlib.h>",
      "#include <string>",
      "#include <kj/miniposix.h>",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "reader.getRoot<TestAllTypes>()"
          ],
          "line": 252
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "reader.getRoot<TestAllTypes>",
          "args": [],
          "line": 252
        },
        "resolved": true,
        "details": {
          "function_name": "getRoot",
          "container": "RpcRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1322-1324",
          "snippet": "inline AnyPointer::Builder getRoot() {\n      return paramsBuilder;\n    }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nRpcRequest {\n  inline AnyPointer::Builder getRoot() {\n        return paramsBuilder;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "serialized.asPtr",
          "args": [],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "asPtr",
          "container": "ArrayBuilder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "313-315",
          "snippet": "inline ArrayPtr<const T> asPtr() const {\n    return arrayPtr(ptr, pos);\n  }",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\nArrayBuilder {\n  inline ArrayPtr<const T> asPtr() const {\n      return arrayPtr(ptr, pos);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "messageToFlatArray",
          "args": [
            "builder"
          ],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "messageToFlatArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize.c++",
          "lines": "100-130",
          "snippet": "kj::Array<word> messageToFlatArray(kj::ArrayPtr<const kj::ArrayPtr<const word>> segments) {\n  kj::Array<word> result = kj::heapArray<word>(computeSerializedSizeInWords(segments));\n\n  _::WireValue<uint32_t>* table =\n      reinterpret_cast<_::WireValue<uint32_t>*>(result.begin());\n\n  // We write the segment count - 1 because this makes the first word zero for single-segment\n  // messages, improving compression.  We don't bother doing this with segment sizes because\n  // one-word segments are rare anyway.\n  table[0].set(segments.size() - 1);\n\n  for (uint i = 0; i < segments.size(); i++) {\n    table[i + 1].set(segments[i].size());\n  }\n\n  if (segments.size() % 2 == 0) {\n    // Set padding byte.\n    table[segments.size() + 1].set(0);\n  }\n\n  word* dst = result.begin() + segments.size() / 2 + 1;\n\n  for (auto& segment: segments) {\n    memcpy(dst, segment.begin(), segment.size() * sizeof(word));\n    dst += segment.size();\n  }\n\n  KJ_DASSERT(dst == result.end(), \"Buffer overrun/underrun bug in code above.\");\n\n  return kj::mv(result);\n}",
          "includes": [
            "#include <exception>",
            "#include <kj/debug.h>",
            "#include \"layout.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <exception>\n#include <kj/debug.h>\n#include \"layout.h\"\n#include \"serialize.h\"\n\nkj::Array<word> messageToFlatArray(kj::ArrayPtr<const kj::ArrayPtr<const word>> segments) {\n  kj::Array<word> result = kj::heapArray<word>(computeSerializedSizeInWords(segments));\n\n  _::WireValue<uint32_t>* table =\n      reinterpret_cast<_::WireValue<uint32_t>*>(result.begin());\n\n  // We write the segment count - 1 because this makes the first word zero for single-segment\n  // messages, improving compression.  We don't bother doing this with segment sizes because\n  // one-word segments are rare anyway.\n  table[0].set(segments.size() - 1);\n\n  for (uint i = 0; i < segments.size(); i++) {\n    table[i + 1].set(segments[i].size());\n  }\n\n  if (segments.size() % 2 == 0) {\n    // Set padding byte.\n    table[segments.size() + 1].set(0);\n  }\n\n  word* dst = result.begin() + segments.size() / 2 + 1;\n\n  for (auto& segment: segments) {\n    memcpy(dst, segment.begin(), segment.size() * sizeof(word));\n    dst += segment.size();\n  }\n\n  KJ_DASSERT(dst == result.end(), \"Buffer overrun/underrun bug in code above.\");\n\n  return kj::mv(result);\n}"
        }
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "builder.initRoot<TestAllTypes>()"
          ],
          "line": 245
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <fcntl.h>\n#include <stdlib.h>\n#include <string>\n#include <kj/miniposix.h>\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n\nTEST(Serialize, InputStreamEvenSegmentCountLazy) {\n  TestMessageBuilder builder(10);\n  initTestMessage(builder.initRoot<TestAllTypes>());\n\n  kj::Array<word> serialized = messageToFlatArray(builder);\n\n  TestInputStream stream(serialized.asPtr(), true);\n  InputStreamMessageReader reader(stream, ReaderOptions());\n\n  checkTestMessage(reader.getRoot<TestAllTypes>());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-test.c++",
    "lines": "231-241",
    "snippet": "TEST(Serialize, InputStreamEvenSegmentCount) {\n  TestMessageBuilder builder(10);\n  initTestMessage(builder.initRoot<TestAllTypes>());\n\n  kj::Array<word> serialized = messageToFlatArray(builder);\n\n  TestInputStream stream(serialized.asPtr(), false);\n  InputStreamMessageReader reader(stream, ReaderOptions());\n\n  checkTestMessage(reader.getRoot<TestAllTypes>());\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <fcntl.h>",
      "#include <stdlib.h>",
      "#include <string>",
      "#include <kj/miniposix.h>",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "reader.getRoot<TestAllTypes>()"
          ],
          "line": 240
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "reader.getRoot<TestAllTypes>",
          "args": [],
          "line": 240
        },
        "resolved": true,
        "details": {
          "function_name": "getRoot",
          "container": "RpcRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1322-1324",
          "snippet": "inline AnyPointer::Builder getRoot() {\n      return paramsBuilder;\n    }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nRpcRequest {\n  inline AnyPointer::Builder getRoot() {\n        return paramsBuilder;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "serialized.asPtr",
          "args": [],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "asPtr",
          "container": "ArrayBuilder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "313-315",
          "snippet": "inline ArrayPtr<const T> asPtr() const {\n    return arrayPtr(ptr, pos);\n  }",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\nArrayBuilder {\n  inline ArrayPtr<const T> asPtr() const {\n      return arrayPtr(ptr, pos);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "messageToFlatArray",
          "args": [
            "builder"
          ],
          "line": 235
        },
        "resolved": true,
        "details": {
          "function_name": "messageToFlatArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize.c++",
          "lines": "100-130",
          "snippet": "kj::Array<word> messageToFlatArray(kj::ArrayPtr<const kj::ArrayPtr<const word>> segments) {\n  kj::Array<word> result = kj::heapArray<word>(computeSerializedSizeInWords(segments));\n\n  _::WireValue<uint32_t>* table =\n      reinterpret_cast<_::WireValue<uint32_t>*>(result.begin());\n\n  // We write the segment count - 1 because this makes the first word zero for single-segment\n  // messages, improving compression.  We don't bother doing this with segment sizes because\n  // one-word segments are rare anyway.\n  table[0].set(segments.size() - 1);\n\n  for (uint i = 0; i < segments.size(); i++) {\n    table[i + 1].set(segments[i].size());\n  }\n\n  if (segments.size() % 2 == 0) {\n    // Set padding byte.\n    table[segments.size() + 1].set(0);\n  }\n\n  word* dst = result.begin() + segments.size() / 2 + 1;\n\n  for (auto& segment: segments) {\n    memcpy(dst, segment.begin(), segment.size() * sizeof(word));\n    dst += segment.size();\n  }\n\n  KJ_DASSERT(dst == result.end(), \"Buffer overrun/underrun bug in code above.\");\n\n  return kj::mv(result);\n}",
          "includes": [
            "#include <exception>",
            "#include <kj/debug.h>",
            "#include \"layout.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <exception>\n#include <kj/debug.h>\n#include \"layout.h\"\n#include \"serialize.h\"\n\nkj::Array<word> messageToFlatArray(kj::ArrayPtr<const kj::ArrayPtr<const word>> segments) {\n  kj::Array<word> result = kj::heapArray<word>(computeSerializedSizeInWords(segments));\n\n  _::WireValue<uint32_t>* table =\n      reinterpret_cast<_::WireValue<uint32_t>*>(result.begin());\n\n  // We write the segment count - 1 because this makes the first word zero for single-segment\n  // messages, improving compression.  We don't bother doing this with segment sizes because\n  // one-word segments are rare anyway.\n  table[0].set(segments.size() - 1);\n\n  for (uint i = 0; i < segments.size(); i++) {\n    table[i + 1].set(segments[i].size());\n  }\n\n  if (segments.size() % 2 == 0) {\n    // Set padding byte.\n    table[segments.size() + 1].set(0);\n  }\n\n  word* dst = result.begin() + segments.size() / 2 + 1;\n\n  for (auto& segment: segments) {\n    memcpy(dst, segment.begin(), segment.size() * sizeof(word));\n    dst += segment.size();\n  }\n\n  KJ_DASSERT(dst == result.end(), \"Buffer overrun/underrun bug in code above.\");\n\n  return kj::mv(result);\n}"
        }
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "builder.initRoot<TestAllTypes>()"
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <fcntl.h>\n#include <stdlib.h>\n#include <string>\n#include <kj/miniposix.h>\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n\nTEST(Serialize, InputStreamEvenSegmentCount) {\n  TestMessageBuilder builder(10);\n  initTestMessage(builder.initRoot<TestAllTypes>());\n\n  kj::Array<word> serialized = messageToFlatArray(builder);\n\n  TestInputStream stream(serialized.asPtr(), false);\n  InputStreamMessageReader reader(stream, ReaderOptions());\n\n  checkTestMessage(reader.getRoot<TestAllTypes>());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-test.c++",
    "lines": "219-229",
    "snippet": "TEST(Serialize, InputStreamOddSegmentCountLazy) {\n  TestMessageBuilder builder(7);\n  initTestMessage(builder.initRoot<TestAllTypes>());\n\n  kj::Array<word> serialized = messageToFlatArray(builder);\n\n  TestInputStream stream(serialized.asPtr(), true);\n  InputStreamMessageReader reader(stream, ReaderOptions());\n\n  checkTestMessage(reader.getRoot<TestAllTypes>());\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <fcntl.h>",
      "#include <stdlib.h>",
      "#include <string>",
      "#include <kj/miniposix.h>",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "reader.getRoot<TestAllTypes>()"
          ],
          "line": 228
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "reader.getRoot<TestAllTypes>",
          "args": [],
          "line": 228
        },
        "resolved": true,
        "details": {
          "function_name": "getRoot",
          "container": "RpcRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1322-1324",
          "snippet": "inline AnyPointer::Builder getRoot() {\n      return paramsBuilder;\n    }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nRpcRequest {\n  inline AnyPointer::Builder getRoot() {\n        return paramsBuilder;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "serialized.asPtr",
          "args": [],
          "line": 225
        },
        "resolved": true,
        "details": {
          "function_name": "asPtr",
          "container": "ArrayBuilder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "313-315",
          "snippet": "inline ArrayPtr<const T> asPtr() const {\n    return arrayPtr(ptr, pos);\n  }",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\nArrayBuilder {\n  inline ArrayPtr<const T> asPtr() const {\n      return arrayPtr(ptr, pos);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "messageToFlatArray",
          "args": [
            "builder"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "messageToFlatArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize.c++",
          "lines": "100-130",
          "snippet": "kj::Array<word> messageToFlatArray(kj::ArrayPtr<const kj::ArrayPtr<const word>> segments) {\n  kj::Array<word> result = kj::heapArray<word>(computeSerializedSizeInWords(segments));\n\n  _::WireValue<uint32_t>* table =\n      reinterpret_cast<_::WireValue<uint32_t>*>(result.begin());\n\n  // We write the segment count - 1 because this makes the first word zero for single-segment\n  // messages, improving compression.  We don't bother doing this with segment sizes because\n  // one-word segments are rare anyway.\n  table[0].set(segments.size() - 1);\n\n  for (uint i = 0; i < segments.size(); i++) {\n    table[i + 1].set(segments[i].size());\n  }\n\n  if (segments.size() % 2 == 0) {\n    // Set padding byte.\n    table[segments.size() + 1].set(0);\n  }\n\n  word* dst = result.begin() + segments.size() / 2 + 1;\n\n  for (auto& segment: segments) {\n    memcpy(dst, segment.begin(), segment.size() * sizeof(word));\n    dst += segment.size();\n  }\n\n  KJ_DASSERT(dst == result.end(), \"Buffer overrun/underrun bug in code above.\");\n\n  return kj::mv(result);\n}",
          "includes": [
            "#include <exception>",
            "#include <kj/debug.h>",
            "#include \"layout.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <exception>\n#include <kj/debug.h>\n#include \"layout.h\"\n#include \"serialize.h\"\n\nkj::Array<word> messageToFlatArray(kj::ArrayPtr<const kj::ArrayPtr<const word>> segments) {\n  kj::Array<word> result = kj::heapArray<word>(computeSerializedSizeInWords(segments));\n\n  _::WireValue<uint32_t>* table =\n      reinterpret_cast<_::WireValue<uint32_t>*>(result.begin());\n\n  // We write the segment count - 1 because this makes the first word zero for single-segment\n  // messages, improving compression.  We don't bother doing this with segment sizes because\n  // one-word segments are rare anyway.\n  table[0].set(segments.size() - 1);\n\n  for (uint i = 0; i < segments.size(); i++) {\n    table[i + 1].set(segments[i].size());\n  }\n\n  if (segments.size() % 2 == 0) {\n    // Set padding byte.\n    table[segments.size() + 1].set(0);\n  }\n\n  word* dst = result.begin() + segments.size() / 2 + 1;\n\n  for (auto& segment: segments) {\n    memcpy(dst, segment.begin(), segment.size() * sizeof(word));\n    dst += segment.size();\n  }\n\n  KJ_DASSERT(dst == result.end(), \"Buffer overrun/underrun bug in code above.\");\n\n  return kj::mv(result);\n}"
        }
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "builder.initRoot<TestAllTypes>()"
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <fcntl.h>\n#include <stdlib.h>\n#include <string>\n#include <kj/miniposix.h>\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n\nTEST(Serialize, InputStreamOddSegmentCountLazy) {\n  TestMessageBuilder builder(7);\n  initTestMessage(builder.initRoot<TestAllTypes>());\n\n  kj::Array<word> serialized = messageToFlatArray(builder);\n\n  TestInputStream stream(serialized.asPtr(), true);\n  InputStreamMessageReader reader(stream, ReaderOptions());\n\n  checkTestMessage(reader.getRoot<TestAllTypes>());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-test.c++",
    "lines": "207-217",
    "snippet": "TEST(Serialize, InputStreamOddSegmentCount) {\n  TestMessageBuilder builder(7);\n  initTestMessage(builder.initRoot<TestAllTypes>());\n\n  kj::Array<word> serialized = messageToFlatArray(builder);\n\n  TestInputStream stream(serialized.asPtr(), false);\n  InputStreamMessageReader reader(stream, ReaderOptions());\n\n  checkTestMessage(reader.getRoot<TestAllTypes>());\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <fcntl.h>",
      "#include <stdlib.h>",
      "#include <string>",
      "#include <kj/miniposix.h>",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "reader.getRoot<TestAllTypes>()"
          ],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "reader.getRoot<TestAllTypes>",
          "args": [],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "getRoot",
          "container": "RpcRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1322-1324",
          "snippet": "inline AnyPointer::Builder getRoot() {\n      return paramsBuilder;\n    }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nRpcRequest {\n  inline AnyPointer::Builder getRoot() {\n        return paramsBuilder;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "serialized.asPtr",
          "args": [],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "asPtr",
          "container": "ArrayBuilder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "313-315",
          "snippet": "inline ArrayPtr<const T> asPtr() const {\n    return arrayPtr(ptr, pos);\n  }",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\nArrayBuilder {\n  inline ArrayPtr<const T> asPtr() const {\n      return arrayPtr(ptr, pos);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "messageToFlatArray",
          "args": [
            "builder"
          ],
          "line": 211
        },
        "resolved": true,
        "details": {
          "function_name": "messageToFlatArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize.c++",
          "lines": "100-130",
          "snippet": "kj::Array<word> messageToFlatArray(kj::ArrayPtr<const kj::ArrayPtr<const word>> segments) {\n  kj::Array<word> result = kj::heapArray<word>(computeSerializedSizeInWords(segments));\n\n  _::WireValue<uint32_t>* table =\n      reinterpret_cast<_::WireValue<uint32_t>*>(result.begin());\n\n  // We write the segment count - 1 because this makes the first word zero for single-segment\n  // messages, improving compression.  We don't bother doing this with segment sizes because\n  // one-word segments are rare anyway.\n  table[0].set(segments.size() - 1);\n\n  for (uint i = 0; i < segments.size(); i++) {\n    table[i + 1].set(segments[i].size());\n  }\n\n  if (segments.size() % 2 == 0) {\n    // Set padding byte.\n    table[segments.size() + 1].set(0);\n  }\n\n  word* dst = result.begin() + segments.size() / 2 + 1;\n\n  for (auto& segment: segments) {\n    memcpy(dst, segment.begin(), segment.size() * sizeof(word));\n    dst += segment.size();\n  }\n\n  KJ_DASSERT(dst == result.end(), \"Buffer overrun/underrun bug in code above.\");\n\n  return kj::mv(result);\n}",
          "includes": [
            "#include <exception>",
            "#include <kj/debug.h>",
            "#include \"layout.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <exception>\n#include <kj/debug.h>\n#include \"layout.h\"\n#include \"serialize.h\"\n\nkj::Array<word> messageToFlatArray(kj::ArrayPtr<const kj::ArrayPtr<const word>> segments) {\n  kj::Array<word> result = kj::heapArray<word>(computeSerializedSizeInWords(segments));\n\n  _::WireValue<uint32_t>* table =\n      reinterpret_cast<_::WireValue<uint32_t>*>(result.begin());\n\n  // We write the segment count - 1 because this makes the first word zero for single-segment\n  // messages, improving compression.  We don't bother doing this with segment sizes because\n  // one-word segments are rare anyway.\n  table[0].set(segments.size() - 1);\n\n  for (uint i = 0; i < segments.size(); i++) {\n    table[i + 1].set(segments[i].size());\n  }\n\n  if (segments.size() % 2 == 0) {\n    // Set padding byte.\n    table[segments.size() + 1].set(0);\n  }\n\n  word* dst = result.begin() + segments.size() / 2 + 1;\n\n  for (auto& segment: segments) {\n    memcpy(dst, segment.begin(), segment.size() * sizeof(word));\n    dst += segment.size();\n  }\n\n  KJ_DASSERT(dst == result.end(), \"Buffer overrun/underrun bug in code above.\");\n\n  return kj::mv(result);\n}"
        }
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "builder.initRoot<TestAllTypes>()"
          ],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <fcntl.h>\n#include <stdlib.h>\n#include <string>\n#include <kj/miniposix.h>\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n\nTEST(Serialize, InputStreamOddSegmentCount) {\n  TestMessageBuilder builder(7);\n  initTestMessage(builder.initRoot<TestAllTypes>());\n\n  kj::Array<word> serialized = messageToFlatArray(builder);\n\n  TestInputStream stream(serialized.asPtr(), false);\n  InputStreamMessageReader reader(stream, ReaderOptions());\n\n  checkTestMessage(reader.getRoot<TestAllTypes>());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-test.c++",
    "lines": "195-205",
    "snippet": "TEST(Serialize, InputStreamLazy) {\n  TestMessageBuilder builder(1);\n  initTestMessage(builder.initRoot<TestAllTypes>());\n\n  kj::Array<word> serialized = messageToFlatArray(builder);\n\n  TestInputStream stream(serialized.asPtr(), true);\n  InputStreamMessageReader reader(stream, ReaderOptions());\n\n  checkTestMessage(reader.getRoot<TestAllTypes>());\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <fcntl.h>",
      "#include <stdlib.h>",
      "#include <string>",
      "#include <kj/miniposix.h>",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "reader.getRoot<TestAllTypes>()"
          ],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "reader.getRoot<TestAllTypes>",
          "args": [],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "getRoot",
          "container": "RpcRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1322-1324",
          "snippet": "inline AnyPointer::Builder getRoot() {\n      return paramsBuilder;\n    }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nRpcRequest {\n  inline AnyPointer::Builder getRoot() {\n        return paramsBuilder;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "serialized.asPtr",
          "args": [],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "asPtr",
          "container": "ArrayBuilder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "313-315",
          "snippet": "inline ArrayPtr<const T> asPtr() const {\n    return arrayPtr(ptr, pos);\n  }",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\nArrayBuilder {\n  inline ArrayPtr<const T> asPtr() const {\n      return arrayPtr(ptr, pos);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "messageToFlatArray",
          "args": [
            "builder"
          ],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "messageToFlatArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize.c++",
          "lines": "100-130",
          "snippet": "kj::Array<word> messageToFlatArray(kj::ArrayPtr<const kj::ArrayPtr<const word>> segments) {\n  kj::Array<word> result = kj::heapArray<word>(computeSerializedSizeInWords(segments));\n\n  _::WireValue<uint32_t>* table =\n      reinterpret_cast<_::WireValue<uint32_t>*>(result.begin());\n\n  // We write the segment count - 1 because this makes the first word zero for single-segment\n  // messages, improving compression.  We don't bother doing this with segment sizes because\n  // one-word segments are rare anyway.\n  table[0].set(segments.size() - 1);\n\n  for (uint i = 0; i < segments.size(); i++) {\n    table[i + 1].set(segments[i].size());\n  }\n\n  if (segments.size() % 2 == 0) {\n    // Set padding byte.\n    table[segments.size() + 1].set(0);\n  }\n\n  word* dst = result.begin() + segments.size() / 2 + 1;\n\n  for (auto& segment: segments) {\n    memcpy(dst, segment.begin(), segment.size() * sizeof(word));\n    dst += segment.size();\n  }\n\n  KJ_DASSERT(dst == result.end(), \"Buffer overrun/underrun bug in code above.\");\n\n  return kj::mv(result);\n}",
          "includes": [
            "#include <exception>",
            "#include <kj/debug.h>",
            "#include \"layout.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <exception>\n#include <kj/debug.h>\n#include \"layout.h\"\n#include \"serialize.h\"\n\nkj::Array<word> messageToFlatArray(kj::ArrayPtr<const kj::ArrayPtr<const word>> segments) {\n  kj::Array<word> result = kj::heapArray<word>(computeSerializedSizeInWords(segments));\n\n  _::WireValue<uint32_t>* table =\n      reinterpret_cast<_::WireValue<uint32_t>*>(result.begin());\n\n  // We write the segment count - 1 because this makes the first word zero for single-segment\n  // messages, improving compression.  We don't bother doing this with segment sizes because\n  // one-word segments are rare anyway.\n  table[0].set(segments.size() - 1);\n\n  for (uint i = 0; i < segments.size(); i++) {\n    table[i + 1].set(segments[i].size());\n  }\n\n  if (segments.size() % 2 == 0) {\n    // Set padding byte.\n    table[segments.size() + 1].set(0);\n  }\n\n  word* dst = result.begin() + segments.size() / 2 + 1;\n\n  for (auto& segment: segments) {\n    memcpy(dst, segment.begin(), segment.size() * sizeof(word));\n    dst += segment.size();\n  }\n\n  KJ_DASSERT(dst == result.end(), \"Buffer overrun/underrun bug in code above.\");\n\n  return kj::mv(result);\n}"
        }
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "builder.initRoot<TestAllTypes>()"
          ],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <fcntl.h>\n#include <stdlib.h>\n#include <string>\n#include <kj/miniposix.h>\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n\nTEST(Serialize, InputStreamLazy) {\n  TestMessageBuilder builder(1);\n  initTestMessage(builder.initRoot<TestAllTypes>());\n\n  kj::Array<word> serialized = messageToFlatArray(builder);\n\n  TestInputStream stream(serialized.asPtr(), true);\n  InputStreamMessageReader reader(stream, ReaderOptions());\n\n  checkTestMessage(reader.getRoot<TestAllTypes>());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-test.c++",
    "lines": "182-193",
    "snippet": "TEST(Serialize, InputStreamScratchSpace) {\n  TestMessageBuilder builder(1);\n  initTestMessage(builder.initRoot<TestAllTypes>());\n\n  kj::Array<word> serialized = messageToFlatArray(builder);\n\n  word scratch[4096];\n  TestInputStream stream(serialized.asPtr(), false);\n  InputStreamMessageReader reader(stream, ReaderOptions(), kj::ArrayPtr<word>(scratch, 4096));\n\n  checkTestMessage(reader.getRoot<TestAllTypes>());\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <fcntl.h>",
      "#include <stdlib.h>",
      "#include <string>",
      "#include <kj/miniposix.h>",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "reader.getRoot<TestAllTypes>()"
          ],
          "line": 192
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "reader.getRoot<TestAllTypes>",
          "args": [],
          "line": 192
        },
        "resolved": true,
        "details": {
          "function_name": "getRoot",
          "container": "RpcRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1322-1324",
          "snippet": "inline AnyPointer::Builder getRoot() {\n      return paramsBuilder;\n    }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nRpcRequest {\n  inline AnyPointer::Builder getRoot() {\n        return paramsBuilder;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::ArrayPtr<word>",
          "args": [
            "scratch",
            "4096"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "ArrayPtr",
          "container": "ArrayPtr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "1116-1116",
          "snippet": "inline constexpr ArrayPtr(T* begin, T* end): ptr(begin), size_(end - begin) {}",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\nArrayPtr {\n  inline constexpr ArrayPtr(T* begin, T* end): ptr(begin), size_(end - begin) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ReaderOptions",
          "args": [],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "serialized.asPtr",
          "args": [],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "asPtr",
          "container": "ArrayBuilder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "313-315",
          "snippet": "inline ArrayPtr<const T> asPtr() const {\n    return arrayPtr(ptr, pos);\n  }",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\nArrayBuilder {\n  inline ArrayPtr<const T> asPtr() const {\n      return arrayPtr(ptr, pos);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "messageToFlatArray",
          "args": [
            "builder"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "messageToFlatArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize.c++",
          "lines": "100-130",
          "snippet": "kj::Array<word> messageToFlatArray(kj::ArrayPtr<const kj::ArrayPtr<const word>> segments) {\n  kj::Array<word> result = kj::heapArray<word>(computeSerializedSizeInWords(segments));\n\n  _::WireValue<uint32_t>* table =\n      reinterpret_cast<_::WireValue<uint32_t>*>(result.begin());\n\n  // We write the segment count - 1 because this makes the first word zero for single-segment\n  // messages, improving compression.  We don't bother doing this with segment sizes because\n  // one-word segments are rare anyway.\n  table[0].set(segments.size() - 1);\n\n  for (uint i = 0; i < segments.size(); i++) {\n    table[i + 1].set(segments[i].size());\n  }\n\n  if (segments.size() % 2 == 0) {\n    // Set padding byte.\n    table[segments.size() + 1].set(0);\n  }\n\n  word* dst = result.begin() + segments.size() / 2 + 1;\n\n  for (auto& segment: segments) {\n    memcpy(dst, segment.begin(), segment.size() * sizeof(word));\n    dst += segment.size();\n  }\n\n  KJ_DASSERT(dst == result.end(), \"Buffer overrun/underrun bug in code above.\");\n\n  return kj::mv(result);\n}",
          "includes": [
            "#include <exception>",
            "#include <kj/debug.h>",
            "#include \"layout.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <exception>\n#include <kj/debug.h>\n#include \"layout.h\"\n#include \"serialize.h\"\n\nkj::Array<word> messageToFlatArray(kj::ArrayPtr<const kj::ArrayPtr<const word>> segments) {\n  kj::Array<word> result = kj::heapArray<word>(computeSerializedSizeInWords(segments));\n\n  _::WireValue<uint32_t>* table =\n      reinterpret_cast<_::WireValue<uint32_t>*>(result.begin());\n\n  // We write the segment count - 1 because this makes the first word zero for single-segment\n  // messages, improving compression.  We don't bother doing this with segment sizes because\n  // one-word segments are rare anyway.\n  table[0].set(segments.size() - 1);\n\n  for (uint i = 0; i < segments.size(); i++) {\n    table[i + 1].set(segments[i].size());\n  }\n\n  if (segments.size() % 2 == 0) {\n    // Set padding byte.\n    table[segments.size() + 1].set(0);\n  }\n\n  word* dst = result.begin() + segments.size() / 2 + 1;\n\n  for (auto& segment: segments) {\n    memcpy(dst, segment.begin(), segment.size() * sizeof(word));\n    dst += segment.size();\n  }\n\n  KJ_DASSERT(dst == result.end(), \"Buffer overrun/underrun bug in code above.\");\n\n  return kj::mv(result);\n}"
        }
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "builder.initRoot<TestAllTypes>()"
          ],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <fcntl.h>\n#include <stdlib.h>\n#include <string>\n#include <kj/miniposix.h>\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n\nTEST(Serialize, InputStreamScratchSpace) {\n  TestMessageBuilder builder(1);\n  initTestMessage(builder.initRoot<TestAllTypes>());\n\n  kj::Array<word> serialized = messageToFlatArray(builder);\n\n  word scratch[4096];\n  TestInputStream stream(serialized.asPtr(), false);\n  InputStreamMessageReader reader(stream, ReaderOptions(), kj::ArrayPtr<word>(scratch, 4096));\n\n  checkTestMessage(reader.getRoot<TestAllTypes>());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-test.c++",
    "lines": "170-180",
    "snippet": "TEST(Serialize, InputStream) {\n  TestMessageBuilder builder(1);\n  initTestMessage(builder.initRoot<TestAllTypes>());\n\n  kj::Array<word> serialized = messageToFlatArray(builder);\n\n  TestInputStream stream(serialized.asPtr(), false);\n  InputStreamMessageReader reader(stream, ReaderOptions());\n\n  checkTestMessage(reader.getRoot<TestAllTypes>());\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <fcntl.h>",
      "#include <stdlib.h>",
      "#include <string>",
      "#include <kj/miniposix.h>",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "reader.getRoot<TestAllTypes>()"
          ],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "reader.getRoot<TestAllTypes>",
          "args": [],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "getRoot",
          "container": "RpcRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1322-1324",
          "snippet": "inline AnyPointer::Builder getRoot() {\n      return paramsBuilder;\n    }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nRpcRequest {\n  inline AnyPointer::Builder getRoot() {\n        return paramsBuilder;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "serialized.asPtr",
          "args": [],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "asPtr",
          "container": "ArrayBuilder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "313-315",
          "snippet": "inline ArrayPtr<const T> asPtr() const {\n    return arrayPtr(ptr, pos);\n  }",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\nArrayBuilder {\n  inline ArrayPtr<const T> asPtr() const {\n      return arrayPtr(ptr, pos);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "messageToFlatArray",
          "args": [
            "builder"
          ],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "messageToFlatArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize.c++",
          "lines": "100-130",
          "snippet": "kj::Array<word> messageToFlatArray(kj::ArrayPtr<const kj::ArrayPtr<const word>> segments) {\n  kj::Array<word> result = kj::heapArray<word>(computeSerializedSizeInWords(segments));\n\n  _::WireValue<uint32_t>* table =\n      reinterpret_cast<_::WireValue<uint32_t>*>(result.begin());\n\n  // We write the segment count - 1 because this makes the first word zero for single-segment\n  // messages, improving compression.  We don't bother doing this with segment sizes because\n  // one-word segments are rare anyway.\n  table[0].set(segments.size() - 1);\n\n  for (uint i = 0; i < segments.size(); i++) {\n    table[i + 1].set(segments[i].size());\n  }\n\n  if (segments.size() % 2 == 0) {\n    // Set padding byte.\n    table[segments.size() + 1].set(0);\n  }\n\n  word* dst = result.begin() + segments.size() / 2 + 1;\n\n  for (auto& segment: segments) {\n    memcpy(dst, segment.begin(), segment.size() * sizeof(word));\n    dst += segment.size();\n  }\n\n  KJ_DASSERT(dst == result.end(), \"Buffer overrun/underrun bug in code above.\");\n\n  return kj::mv(result);\n}",
          "includes": [
            "#include <exception>",
            "#include <kj/debug.h>",
            "#include \"layout.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <exception>\n#include <kj/debug.h>\n#include \"layout.h\"\n#include \"serialize.h\"\n\nkj::Array<word> messageToFlatArray(kj::ArrayPtr<const kj::ArrayPtr<const word>> segments) {\n  kj::Array<word> result = kj::heapArray<word>(computeSerializedSizeInWords(segments));\n\n  _::WireValue<uint32_t>* table =\n      reinterpret_cast<_::WireValue<uint32_t>*>(result.begin());\n\n  // We write the segment count - 1 because this makes the first word zero for single-segment\n  // messages, improving compression.  We don't bother doing this with segment sizes because\n  // one-word segments are rare anyway.\n  table[0].set(segments.size() - 1);\n\n  for (uint i = 0; i < segments.size(); i++) {\n    table[i + 1].set(segments[i].size());\n  }\n\n  if (segments.size() % 2 == 0) {\n    // Set padding byte.\n    table[segments.size() + 1].set(0);\n  }\n\n  word* dst = result.begin() + segments.size() / 2 + 1;\n\n  for (auto& segment: segments) {\n    memcpy(dst, segment.begin(), segment.size() * sizeof(word));\n    dst += segment.size();\n  }\n\n  KJ_DASSERT(dst == result.end(), \"Buffer overrun/underrun bug in code above.\");\n\n  return kj::mv(result);\n}"
        }
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "builder.initRoot<TestAllTypes>()"
          ],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <fcntl.h>\n#include <stdlib.h>\n#include <string>\n#include <kj/miniposix.h>\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n\nTEST(Serialize, InputStream) {\n  TestMessageBuilder builder(1);\n  initTestMessage(builder.initRoot<TestAllTypes>());\n\n  kj::Array<word> serialized = messageToFlatArray(builder);\n\n  TestInputStream stream(serialized.asPtr(), false);\n  InputStreamMessageReader reader(stream, ReaderOptions());\n\n  checkTestMessage(reader.getRoot<TestAllTypes>());\n}"
  },
  {
    "function_name": "tryRead",
    "container": "TestInputStream",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-test.c++",
    "lines": "156-162",
    "snippet": "size_t tryRead(void* buffer, size_t minBytes, size_t maxBytes) override {\n    KJ_ASSERT(maxBytes <= size_t(end - pos), \"Overran end of stream.\");\n    size_t amount = lazy ? minBytes : maxBytes;\n    memcpy(buffer, pos, amount);\n    pos += amount;\n    return amount;\n  }",
    "includes": [
      "#include \"test-util.h\"",
      "#include <fcntl.h>",
      "#include <stdlib.h>",
      "#include <string>",
      "#include <kj/miniposix.h>",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "buffer",
            "pos",
            "amount"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_ASSERT",
          "args": [
            "maxBytes <= size_t(end - pos)",
            "\"Overran end of stream.\""
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "size_t",
          "args": [
            "end - pos"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <fcntl.h>\n#include <stdlib.h>\n#include <string>\n#include <kj/miniposix.h>\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n\nTestInputStream {\n  size_t tryRead(void* buffer, size_t minBytes, size_t maxBytes) override {\n      KJ_ASSERT(maxBytes <= size_t(end - pos), \"Overran end of stream.\");\n      size_t amount = lazy ? minBytes : maxBytes;\n      memcpy(buffer, pos, amount);\n      pos += amount;\n      return amount;\n    }\n}"
  },
  {
    "function_name": "TestInputStream",
    "container": "TestInputStream",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-test.c++",
    "lines": "150-153",
    "snippet": "TestInputStream(kj::ArrayPtr<const word> data, bool lazy)\n      : pos(data.asChars().begin()),\n        end(data.asChars().end()),\n        lazy(lazy) {}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <fcntl.h>",
      "#include <stdlib.h>",
      "#include <string>",
      "#include <kj/miniposix.h>",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "data.asChars",
          "args": [],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "asChars",
          "container": "ArrayPtr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "1164-1168",
          "snippet": "inline ArrayPtr<PropagateConst<T, char>> asChars() const {\n    // Reinterpret the array as a char array. This is explicitly legal under C++ aliasing\n    // rules.\n    return { reinterpret_cast<PropagateConst<T, char>*>(ptr), size_ * sizeof(T) };\n  }",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\nArrayPtr {\n  inline ArrayPtr<PropagateConst<T, char>> asChars() const {\n      // Reinterpret the array as a char array. This is explicitly legal under C++ aliasing\n      // rules.\n      return { reinterpret_cast<PropagateConst<T, char>*>(ptr), size_ * sizeof(T) };\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <fcntl.h>\n#include <stdlib.h>\n#include <string>\n#include <kj/miniposix.h>\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n\nTestInputStream {\n  TestInputStream(kj::ArrayPtr<const word> data, bool lazy)\n        : pos(data.asChars().begin()),\n          end(data.asChars().end()),\n          lazy(lazy) {}\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-test.c++",
    "lines": "126-146",
    "snippet": "TEST(Serialize, FlatArrayEvenSegmentCount) {\n  TestMessageBuilder builder(10);\n  initTestMessage(builder.initRoot<TestAllTypes>());\n\n  kj::Array<word> serialized = messageToFlatArray(builder);\n\n  {\n    FlatArrayMessageReader reader(serialized.asPtr());\n    checkTestMessage(reader.getRoot<TestAllTypes>());\n    EXPECT_EQ(serialized.end(), reader.getEnd());\n  }\n\n  kj::Array<word> serializedWithSuffix = kj::heapArray<word>(serialized.size() + 5);\n  memcpy(serializedWithSuffix.begin(), serialized.begin(), serialized.size() * sizeof(word));\n\n  {\n    FlatArrayMessageReader reader(serializedWithSuffix.asPtr());\n    checkTestMessage(reader.getRoot<TestAllTypes>());\n    EXPECT_EQ(serializedWithSuffix.end() - 5, reader.getEnd());\n  }\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <fcntl.h>",
      "#include <stdlib.h>",
      "#include <string>",
      "#include <kj/miniposix.h>",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "serializedWithSuffix.end() - 5",
            "reader.getEnd()"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getEnd",
          "args": [],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "serializedWithSuffix.end",
          "args": [],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "551-551",
          "snippet": "inline Iterator end() { return Iterator(this, size()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Iterator end() { return Iterator(this, size()); }"
        }
      },
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "reader.getRoot<TestAllTypes>()"
          ],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "reader.getRoot<TestAllTypes>",
          "args": [],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "getRoot",
          "container": "RpcRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1322-1324",
          "snippet": "inline AnyPointer::Builder getRoot() {\n      return paramsBuilder;\n    }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nRpcRequest {\n  inline AnyPointer::Builder getRoot() {\n        return paramsBuilder;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "serializedWithSuffix.asPtr",
          "args": [],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "asPtr",
          "container": "ArrayBuilder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "313-315",
          "snippet": "inline ArrayPtr<const T> asPtr() const {\n    return arrayPtr(ptr, pos);\n  }",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\nArrayBuilder {\n  inline ArrayPtr<const T> asPtr() const {\n      return arrayPtr(ptr, pos);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "serializedWithSuffix.begin()",
            "serialized.begin()",
            "serialized.size() * sizeof(word)"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "serialized.size",
          "args": [],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "599-599",
          "snippet": "inline uint size() { return _builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline uint size() { return _builder.size() / ELEMENTS; }"
        }
      },
      {
        "call_info": {
          "callee": "serialized.begin",
          "args": [],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "550-550",
          "snippet": "inline Iterator begin() { return Iterator(this, 0); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Iterator begin() { return Iterator(this, 0); }"
        }
      },
      {
        "call_info": {
          "callee": "kj::heapArray<word>",
          "args": [
            "serialized.size() + 5"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "heapArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "696-698",
          "snippet": "inline Array<T> heapArray(std::initializer_list<T> init) {\n  return heapArray<T>(init.begin(), init.end());\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\ninline Array<T> heapArray(std::initializer_list<T> init) {\n  return heapArray<T>(init.begin(), init.end());\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "serialized.end()",
            "reader.getEnd()"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getEnd",
          "args": [],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "messageToFlatArray",
          "args": [
            "builder"
          ],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "messageToFlatArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize.c++",
          "lines": "100-130",
          "snippet": "kj::Array<word> messageToFlatArray(kj::ArrayPtr<const kj::ArrayPtr<const word>> segments) {\n  kj::Array<word> result = kj::heapArray<word>(computeSerializedSizeInWords(segments));\n\n  _::WireValue<uint32_t>* table =\n      reinterpret_cast<_::WireValue<uint32_t>*>(result.begin());\n\n  // We write the segment count - 1 because this makes the first word zero for single-segment\n  // messages, improving compression.  We don't bother doing this with segment sizes because\n  // one-word segments are rare anyway.\n  table[0].set(segments.size() - 1);\n\n  for (uint i = 0; i < segments.size(); i++) {\n    table[i + 1].set(segments[i].size());\n  }\n\n  if (segments.size() % 2 == 0) {\n    // Set padding byte.\n    table[segments.size() + 1].set(0);\n  }\n\n  word* dst = result.begin() + segments.size() / 2 + 1;\n\n  for (auto& segment: segments) {\n    memcpy(dst, segment.begin(), segment.size() * sizeof(word));\n    dst += segment.size();\n  }\n\n  KJ_DASSERT(dst == result.end(), \"Buffer overrun/underrun bug in code above.\");\n\n  return kj::mv(result);\n}",
          "includes": [
            "#include <exception>",
            "#include <kj/debug.h>",
            "#include \"layout.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <exception>\n#include <kj/debug.h>\n#include \"layout.h\"\n#include \"serialize.h\"\n\nkj::Array<word> messageToFlatArray(kj::ArrayPtr<const kj::ArrayPtr<const word>> segments) {\n  kj::Array<word> result = kj::heapArray<word>(computeSerializedSizeInWords(segments));\n\n  _::WireValue<uint32_t>* table =\n      reinterpret_cast<_::WireValue<uint32_t>*>(result.begin());\n\n  // We write the segment count - 1 because this makes the first word zero for single-segment\n  // messages, improving compression.  We don't bother doing this with segment sizes because\n  // one-word segments are rare anyway.\n  table[0].set(segments.size() - 1);\n\n  for (uint i = 0; i < segments.size(); i++) {\n    table[i + 1].set(segments[i].size());\n  }\n\n  if (segments.size() % 2 == 0) {\n    // Set padding byte.\n    table[segments.size() + 1].set(0);\n  }\n\n  word* dst = result.begin() + segments.size() / 2 + 1;\n\n  for (auto& segment: segments) {\n    memcpy(dst, segment.begin(), segment.size() * sizeof(word));\n    dst += segment.size();\n  }\n\n  KJ_DASSERT(dst == result.end(), \"Buffer overrun/underrun bug in code above.\");\n\n  return kj::mv(result);\n}"
        }
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "builder.initRoot<TestAllTypes>()"
          ],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <fcntl.h>\n#include <stdlib.h>\n#include <string>\n#include <kj/miniposix.h>\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n\nTEST(Serialize, FlatArrayEvenSegmentCount) {\n  TestMessageBuilder builder(10);\n  initTestMessage(builder.initRoot<TestAllTypes>());\n\n  kj::Array<word> serialized = messageToFlatArray(builder);\n\n  {\n    FlatArrayMessageReader reader(serialized.asPtr());\n    checkTestMessage(reader.getRoot<TestAllTypes>());\n    EXPECT_EQ(serialized.end(), reader.getEnd());\n  }\n\n  kj::Array<word> serializedWithSuffix = kj::heapArray<word>(serialized.size() + 5);\n  memcpy(serializedWithSuffix.begin(), serialized.begin(), serialized.size() * sizeof(word));\n\n  {\n    FlatArrayMessageReader reader(serializedWithSuffix.asPtr());\n    checkTestMessage(reader.getRoot<TestAllTypes>());\n    EXPECT_EQ(serializedWithSuffix.end() - 5, reader.getEnd());\n  }\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-test.c++",
    "lines": "104-124",
    "snippet": "TEST(Serialize, FlatArrayOddSegmentCount) {\n  TestMessageBuilder builder(7);\n  initTestMessage(builder.initRoot<TestAllTypes>());\n\n  kj::Array<word> serialized = messageToFlatArray(builder);\n\n  {\n    FlatArrayMessageReader reader(serialized.asPtr());\n    checkTestMessage(reader.getRoot<TestAllTypes>());\n    EXPECT_EQ(serialized.end(), reader.getEnd());\n  }\n\n  kj::Array<word> serializedWithSuffix = kj::heapArray<word>(serialized.size() + 5);\n  memcpy(serializedWithSuffix.begin(), serialized.begin(), serialized.size() * sizeof(word));\n\n  {\n    FlatArrayMessageReader reader(serializedWithSuffix.asPtr());\n    checkTestMessage(reader.getRoot<TestAllTypes>());\n    EXPECT_EQ(serializedWithSuffix.end() - 5, reader.getEnd());\n  }\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <fcntl.h>",
      "#include <stdlib.h>",
      "#include <string>",
      "#include <kj/miniposix.h>",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "serializedWithSuffix.end() - 5",
            "reader.getEnd()"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getEnd",
          "args": [],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "serializedWithSuffix.end",
          "args": [],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "551-551",
          "snippet": "inline Iterator end() { return Iterator(this, size()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Iterator end() { return Iterator(this, size()); }"
        }
      },
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "reader.getRoot<TestAllTypes>()"
          ],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "reader.getRoot<TestAllTypes>",
          "args": [],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "getRoot",
          "container": "RpcRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1322-1324",
          "snippet": "inline AnyPointer::Builder getRoot() {\n      return paramsBuilder;\n    }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nRpcRequest {\n  inline AnyPointer::Builder getRoot() {\n        return paramsBuilder;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "serializedWithSuffix.asPtr",
          "args": [],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "asPtr",
          "container": "ArrayBuilder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "313-315",
          "snippet": "inline ArrayPtr<const T> asPtr() const {\n    return arrayPtr(ptr, pos);\n  }",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\nArrayBuilder {\n  inline ArrayPtr<const T> asPtr() const {\n      return arrayPtr(ptr, pos);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "serializedWithSuffix.begin()",
            "serialized.begin()",
            "serialized.size() * sizeof(word)"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "serialized.size",
          "args": [],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "599-599",
          "snippet": "inline uint size() { return _builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline uint size() { return _builder.size() / ELEMENTS; }"
        }
      },
      {
        "call_info": {
          "callee": "serialized.begin",
          "args": [],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "550-550",
          "snippet": "inline Iterator begin() { return Iterator(this, 0); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Iterator begin() { return Iterator(this, 0); }"
        }
      },
      {
        "call_info": {
          "callee": "kj::heapArray<word>",
          "args": [
            "serialized.size() + 5"
          ],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "heapArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "696-698",
          "snippet": "inline Array<T> heapArray(std::initializer_list<T> init) {\n  return heapArray<T>(init.begin(), init.end());\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\ninline Array<T> heapArray(std::initializer_list<T> init) {\n  return heapArray<T>(init.begin(), init.end());\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "serialized.end()",
            "reader.getEnd()"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getEnd",
          "args": [],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "messageToFlatArray",
          "args": [
            "builder"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "messageToFlatArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize.c++",
          "lines": "100-130",
          "snippet": "kj::Array<word> messageToFlatArray(kj::ArrayPtr<const kj::ArrayPtr<const word>> segments) {\n  kj::Array<word> result = kj::heapArray<word>(computeSerializedSizeInWords(segments));\n\n  _::WireValue<uint32_t>* table =\n      reinterpret_cast<_::WireValue<uint32_t>*>(result.begin());\n\n  // We write the segment count - 1 because this makes the first word zero for single-segment\n  // messages, improving compression.  We don't bother doing this with segment sizes because\n  // one-word segments are rare anyway.\n  table[0].set(segments.size() - 1);\n\n  for (uint i = 0; i < segments.size(); i++) {\n    table[i + 1].set(segments[i].size());\n  }\n\n  if (segments.size() % 2 == 0) {\n    // Set padding byte.\n    table[segments.size() + 1].set(0);\n  }\n\n  word* dst = result.begin() + segments.size() / 2 + 1;\n\n  for (auto& segment: segments) {\n    memcpy(dst, segment.begin(), segment.size() * sizeof(word));\n    dst += segment.size();\n  }\n\n  KJ_DASSERT(dst == result.end(), \"Buffer overrun/underrun bug in code above.\");\n\n  return kj::mv(result);\n}",
          "includes": [
            "#include <exception>",
            "#include <kj/debug.h>",
            "#include \"layout.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <exception>\n#include <kj/debug.h>\n#include \"layout.h\"\n#include \"serialize.h\"\n\nkj::Array<word> messageToFlatArray(kj::ArrayPtr<const kj::ArrayPtr<const word>> segments) {\n  kj::Array<word> result = kj::heapArray<word>(computeSerializedSizeInWords(segments));\n\n  _::WireValue<uint32_t>* table =\n      reinterpret_cast<_::WireValue<uint32_t>*>(result.begin());\n\n  // We write the segment count - 1 because this makes the first word zero for single-segment\n  // messages, improving compression.  We don't bother doing this with segment sizes because\n  // one-word segments are rare anyway.\n  table[0].set(segments.size() - 1);\n\n  for (uint i = 0; i < segments.size(); i++) {\n    table[i + 1].set(segments[i].size());\n  }\n\n  if (segments.size() % 2 == 0) {\n    // Set padding byte.\n    table[segments.size() + 1].set(0);\n  }\n\n  word* dst = result.begin() + segments.size() / 2 + 1;\n\n  for (auto& segment: segments) {\n    memcpy(dst, segment.begin(), segment.size() * sizeof(word));\n    dst += segment.size();\n  }\n\n  KJ_DASSERT(dst == result.end(), \"Buffer overrun/underrun bug in code above.\");\n\n  return kj::mv(result);\n}"
        }
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "builder.initRoot<TestAllTypes>()"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <fcntl.h>\n#include <stdlib.h>\n#include <string>\n#include <kj/miniposix.h>\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n\nTEST(Serialize, FlatArrayOddSegmentCount) {\n  TestMessageBuilder builder(7);\n  initTestMessage(builder.initRoot<TestAllTypes>());\n\n  kj::Array<word> serialized = messageToFlatArray(builder);\n\n  {\n    FlatArrayMessageReader reader(serialized.asPtr());\n    checkTestMessage(reader.getRoot<TestAllTypes>());\n    EXPECT_EQ(serialized.end(), reader.getEnd());\n  }\n\n  kj::Array<word> serializedWithSuffix = kj::heapArray<word>(serialized.size() + 5);\n  memcpy(serializedWithSuffix.begin(), serialized.begin(), serialized.size() * sizeof(word));\n\n  {\n    FlatArrayMessageReader reader(serializedWithSuffix.asPtr());\n    checkTestMessage(reader.getRoot<TestAllTypes>());\n    EXPECT_EQ(serializedWithSuffix.end() - 5, reader.getEnd());\n  }\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-test.c++",
    "lines": "66-102",
    "snippet": "TEST(Serialize, FlatArray) {\n  TestMessageBuilder builder(1);\n  initTestMessage(builder.initRoot<TestAllTypes>());\n\n  kj::Array<word> serialized = messageToFlatArray(builder);\n\n  {\n    FlatArrayMessageReader reader(serialized.asPtr());\n    checkTestMessage(reader.getRoot<TestAllTypes>());\n    EXPECT_EQ(serialized.end(), reader.getEnd());\n  }\n\n  {\n    MallocMessageBuilder builder2;\n    auto remaining = initMessageBuilderFromFlatArrayCopy(serialized, builder2);\n    checkTestMessage(builder2.getRoot<TestAllTypes>());\n    EXPECT_EQ(serialized.end(), remaining.begin());\n    EXPECT_EQ(serialized.end(), remaining.end());\n  }\n\n  kj::Array<word> serializedWithSuffix = kj::heapArray<word>(serialized.size() + 5);\n  memcpy(serializedWithSuffix.begin(), serialized.begin(), serialized.size() * sizeof(word));\n\n  {\n    FlatArrayMessageReader reader(serializedWithSuffix.asPtr());\n    checkTestMessage(reader.getRoot<TestAllTypes>());\n    EXPECT_EQ(serializedWithSuffix.end() - 5, reader.getEnd());\n  }\n\n  {\n    MallocMessageBuilder builder2;\n    auto remaining = initMessageBuilderFromFlatArrayCopy(serializedWithSuffix, builder2);\n    checkTestMessage(builder2.getRoot<TestAllTypes>());\n    EXPECT_EQ(serializedWithSuffix.end() - 5, remaining.begin());\n    EXPECT_EQ(serializedWithSuffix.end(), remaining.end());\n  }\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <fcntl.h>",
      "#include <stdlib.h>",
      "#include <string>",
      "#include <kj/miniposix.h>",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "serializedWithSuffix.end()",
            "remaining.end()"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "remaining.end",
          "args": [],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "551-551",
          "snippet": "inline Iterator end() { return Iterator(this, size()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Iterator end() { return Iterator(this, size()); }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "serializedWithSuffix.end() - 5",
            "remaining.begin()"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "remaining.begin",
          "args": [],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "550-550",
          "snippet": "inline Iterator begin() { return Iterator(this, 0); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Iterator begin() { return Iterator(this, 0); }"
        }
      },
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "builder2.getRoot<TestAllTypes>()"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "builder2.getRoot<TestAllTypes>",
          "args": [],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "getRoot",
          "container": "RpcRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1322-1324",
          "snippet": "inline AnyPointer::Builder getRoot() {\n      return paramsBuilder;\n    }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nRpcRequest {\n  inline AnyPointer::Builder getRoot() {\n        return paramsBuilder;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "initMessageBuilderFromFlatArrayCopy",
          "args": [
            "serializedWithSuffix",
            "builder2"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "serializedWithSuffix.end() - 5",
            "reader.getEnd()"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getEnd",
          "args": [],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "serializedWithSuffix.asPtr",
          "args": [],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "asPtr",
          "container": "ArrayBuilder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "313-315",
          "snippet": "inline ArrayPtr<const T> asPtr() const {\n    return arrayPtr(ptr, pos);\n  }",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\nArrayBuilder {\n  inline ArrayPtr<const T> asPtr() const {\n      return arrayPtr(ptr, pos);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "serializedWithSuffix.begin()",
            "serialized.begin()",
            "serialized.size() * sizeof(word)"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "serialized.size",
          "args": [],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "599-599",
          "snippet": "inline uint size() { return _builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline uint size() { return _builder.size() / ELEMENTS; }"
        }
      },
      {
        "call_info": {
          "callee": "kj::heapArray<word>",
          "args": [
            "serialized.size() + 5"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "heapArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "696-698",
          "snippet": "inline Array<T> heapArray(std::initializer_list<T> init) {\n  return heapArray<T>(init.begin(), init.end());\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\ninline Array<T> heapArray(std::initializer_list<T> init) {\n  return heapArray<T>(init.begin(), init.end());\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "serialized.end()",
            "remaining.end()"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "serialized.end()",
            "remaining.begin()"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "initMessageBuilderFromFlatArrayCopy",
          "args": [
            "serialized",
            "builder2"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "serialized.end()",
            "reader.getEnd()"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getEnd",
          "args": [],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "messageToFlatArray",
          "args": [
            "builder"
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "messageToFlatArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize.c++",
          "lines": "100-130",
          "snippet": "kj::Array<word> messageToFlatArray(kj::ArrayPtr<const kj::ArrayPtr<const word>> segments) {\n  kj::Array<word> result = kj::heapArray<word>(computeSerializedSizeInWords(segments));\n\n  _::WireValue<uint32_t>* table =\n      reinterpret_cast<_::WireValue<uint32_t>*>(result.begin());\n\n  // We write the segment count - 1 because this makes the first word zero for single-segment\n  // messages, improving compression.  We don't bother doing this with segment sizes because\n  // one-word segments are rare anyway.\n  table[0].set(segments.size() - 1);\n\n  for (uint i = 0; i < segments.size(); i++) {\n    table[i + 1].set(segments[i].size());\n  }\n\n  if (segments.size() % 2 == 0) {\n    // Set padding byte.\n    table[segments.size() + 1].set(0);\n  }\n\n  word* dst = result.begin() + segments.size() / 2 + 1;\n\n  for (auto& segment: segments) {\n    memcpy(dst, segment.begin(), segment.size() * sizeof(word));\n    dst += segment.size();\n  }\n\n  KJ_DASSERT(dst == result.end(), \"Buffer overrun/underrun bug in code above.\");\n\n  return kj::mv(result);\n}",
          "includes": [
            "#include <exception>",
            "#include <kj/debug.h>",
            "#include \"layout.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <exception>\n#include <kj/debug.h>\n#include \"layout.h\"\n#include \"serialize.h\"\n\nkj::Array<word> messageToFlatArray(kj::ArrayPtr<const kj::ArrayPtr<const word>> segments) {\n  kj::Array<word> result = kj::heapArray<word>(computeSerializedSizeInWords(segments));\n\n  _::WireValue<uint32_t>* table =\n      reinterpret_cast<_::WireValue<uint32_t>*>(result.begin());\n\n  // We write the segment count - 1 because this makes the first word zero for single-segment\n  // messages, improving compression.  We don't bother doing this with segment sizes because\n  // one-word segments are rare anyway.\n  table[0].set(segments.size() - 1);\n\n  for (uint i = 0; i < segments.size(); i++) {\n    table[i + 1].set(segments[i].size());\n  }\n\n  if (segments.size() % 2 == 0) {\n    // Set padding byte.\n    table[segments.size() + 1].set(0);\n  }\n\n  word* dst = result.begin() + segments.size() / 2 + 1;\n\n  for (auto& segment: segments) {\n    memcpy(dst, segment.begin(), segment.size() * sizeof(word));\n    dst += segment.size();\n  }\n\n  KJ_DASSERT(dst == result.end(), \"Buffer overrun/underrun bug in code above.\");\n\n  return kj::mv(result);\n}"
        }
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "builder.initRoot<TestAllTypes>()"
          ],
          "line": 68
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <fcntl.h>\n#include <stdlib.h>\n#include <string>\n#include <kj/miniposix.h>\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n\nTEST(Serialize, FlatArray) {\n  TestMessageBuilder builder(1);\n  initTestMessage(builder.initRoot<TestAllTypes>());\n\n  kj::Array<word> serialized = messageToFlatArray(builder);\n\n  {\n    FlatArrayMessageReader reader(serialized.asPtr());\n    checkTestMessage(reader.getRoot<TestAllTypes>());\n    EXPECT_EQ(serialized.end(), reader.getEnd());\n  }\n\n  {\n    MallocMessageBuilder builder2;\n    auto remaining = initMessageBuilderFromFlatArrayCopy(serialized, builder2);\n    checkTestMessage(builder2.getRoot<TestAllTypes>());\n    EXPECT_EQ(serialized.end(), remaining.begin());\n    EXPECT_EQ(serialized.end(), remaining.end());\n  }\n\n  kj::Array<word> serializedWithSuffix = kj::heapArray<word>(serialized.size() + 5);\n  memcpy(serializedWithSuffix.begin(), serialized.begin(), serialized.size() * sizeof(word));\n\n  {\n    FlatArrayMessageReader reader(serializedWithSuffix.asPtr());\n    checkTestMessage(reader.getRoot<TestAllTypes>());\n    EXPECT_EQ(serializedWithSuffix.end() - 5, reader.getEnd());\n  }\n\n  {\n    MallocMessageBuilder builder2;\n    auto remaining = initMessageBuilderFromFlatArrayCopy(serializedWithSuffix, builder2);\n    checkTestMessage(builder2.getRoot<TestAllTypes>());\n    EXPECT_EQ(serializedWithSuffix.end() - 5, remaining.begin());\n    EXPECT_EQ(serializedWithSuffix.end(), remaining.end());\n  }\n}"
  },
  {
    "function_name": "allocateSegment",
    "container": "TestMessageBuilder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-test.c++",
    "lines": "48-60",
    "snippet": "kj::ArrayPtr<word> allocateSegment(uint minimumSize) override {\n    if (desiredSegmentCount <= 1) {\n      if (desiredSegmentCount < 1) {\n        ADD_FAILURE() << \"Allocated more segments than desired.\";\n      } else {\n        --desiredSegmentCount;\n      }\n      return MallocMessageBuilder::allocateSegment(SUGGESTED_FIRST_SEGMENT_WORDS);\n    } else {\n      --desiredSegmentCount;\n      return MallocMessageBuilder::allocateSegment(minimumSize);\n    }\n  }",
    "includes": [
      "#include \"test-util.h\"",
      "#include <fcntl.h>",
      "#include <stdlib.h>",
      "#include <string>",
      "#include <kj/miniposix.h>",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ADD_FAILURE",
          "args": [],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <fcntl.h>\n#include <stdlib.h>\n#include <string>\n#include <kj/miniposix.h>\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n\nTestMessageBuilder {\n  kj::ArrayPtr<word> allocateSegment(uint minimumSize) override {\n      if (desiredSegmentCount <= 1) {\n        if (desiredSegmentCount < 1) {\n          ADD_FAILURE() << \"Allocated more segments than desired.\";\n        } else {\n          --desiredSegmentCount;\n        }\n        return MallocMessageBuilder::allocateSegment(SUGGESTED_FIRST_SEGMENT_WORDS);\n      } else {\n        --desiredSegmentCount;\n        return MallocMessageBuilder::allocateSegment(minimumSize);\n      }\n    }\n}"
  },
  {
    "function_name": "TestMessageBuilder",
    "container": "TestMessageBuilder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-test.c++",
    "lines": "41-43",
    "snippet": "explicit TestMessageBuilder(uint desiredSegmentCount)\n      : MallocMessageBuilder(0, AllocationStrategy::FIXED_SIZE),\n        desiredSegmentCount(desiredSegmentCount) {}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <fcntl.h>",
      "#include <stdlib.h>",
      "#include <string>",
      "#include <kj/miniposix.h>",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"serialize.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"test-util.h\"\n#include <fcntl.h>\n#include <stdlib.h>\n#include <string>\n#include <kj/miniposix.h>\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n\nTestMessageBuilder {\n  explicit TestMessageBuilder(uint desiredSegmentCount)\n        : MallocMessageBuilder(0, AllocationStrategy::FIXED_SIZE),\n          desiredSegmentCount(desiredSegmentCount) {}\n}"
  }
]