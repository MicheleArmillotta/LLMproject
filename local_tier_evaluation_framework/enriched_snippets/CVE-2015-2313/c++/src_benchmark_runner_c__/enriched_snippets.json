[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/runner.c++",
    "lines": "646-648",
    "snippet": "int main(int argc, char* argv[]) {\n  return capnp::benchmark::runner::main(argc, argv);\n}",
    "includes": [
      "#include <iomanip>",
      "#include <iostream>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include <string>",
      "#include <inttypes.h>",
      "#include <sys/stat.h>",
      "#include <sys/wait.h>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <iomanip>\n#include <iostream>\n#include <string.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <string>\n#include <inttypes.h>\n#include <sys/stat.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n\nint main(int argc, char* argv[]) {\n  return capnp::benchmark::runner::main(argc, argv);\n}"
  },
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/runner.c++",
    "lines": "350-640",
    "snippet": "int main(int argc, char* argv[]) {\n  char* path = argv[0];\n  char* slashpos = strrchr(path, '/');\n  char origDir[1024];\n  if (getcwd(origDir, sizeof(origDir)) == nullptr) {\n    perror(\"getcwd\");\n    return 1;\n  }\n  if (slashpos != nullptr) {\n    *slashpos = '\\0';\n    if (chdir(path) < 0) {\n      perror(\"chdir\");\n      return 1;\n    }\n    *slashpos = '/';\n  }\n\n  TestCase testCase = TestCase::CATRANK;\n  Mode mode = Mode::PIPE_SYNC;\n  Compression compression = Compression::NONE;\n  uint64_t iters = 1;\n  const char* oldDir = nullptr;\n\n  for (int i = 1; i < argc; i++) {\n    string arg = argv[i];\n    if (isdigit(argv[i][0])) {\n      iters = strtoul(argv[i], nullptr, 0);\n    } else if (arg == \"async\") {\n      mode = Mode::PIPE_ASYNC;\n    } else if (arg == \"inmem\") {\n      mode = Mode::BYTES;\n    } else if (arg == \"eval\") {\n      testCase = TestCase::EVAL;\n    } else if (arg == \"carsales\") {\n      testCase = TestCase::CARSALES;\n    } else if (arg == \"snappy\") {\n      compression = Compression::SNAPPY;\n    } else if (arg == \"-c\") {\n      ++i;\n      if (i == argc) {\n        fprintf(stderr, \"-c requires argument.\\n\");\n        return 1;\n      }\n      oldDir = argv[i];\n    } else {\n      fprintf(stderr, \"Unknown option: %s\\n\", argv[i]);\n      return 1;\n    }\n  }\n\n  // Scale iterations to something reasonable for each case.\n  switch (testCase) {\n    case TestCase::EVAL:\n      iters *= 100000;\n      break;\n    case TestCase::CATRANK:\n      iters *= 1000;\n      break;\n    case TestCase::CARSALES:\n      iters *= 20000;\n      break;\n  }\n\n  cout << \"Running \" << iters << \" iterations of \";\n  switch (testCase) {\n    case TestCase::EVAL:\n      cout << \"calculator\";\n      break;\n    case TestCase::CATRANK:\n      cout << \"CatRank\";\n      break;\n    case TestCase::CARSALES:\n      cout << \"car sales\";\n      break;\n  }\n\n  cout << \" example case with:\" << endl;\n\n  switch (mode) {\n    case Mode::OBJECTS:\n    case Mode::OBJECT_SIZE:\n      // Can't happen.\n      break;\n    case Mode::BYTES:\n      cout << \"* in-memory I/O\" << endl;\n      cout << \"  * with client and server in the same thread\" << endl;\n      break;\n    case Mode::PIPE_SYNC:\n      cout << \"* pipe I/O\" << endl;\n      cout << \"  * with client and server in separate processes\" << endl;\n      cout << \"  * client waits for each response before sending next request\" << endl;\n      break;\n    case Mode::PIPE_ASYNC:\n      cout << \"* pipe I/O\" << endl;\n      cout << \"  * with client and server in separate processes\" << endl;\n      cout << \"  * client sends as many simultaneous requests as it can\" << endl;\n      break;\n  }\n  switch (compression) {\n    case Compression::NONE:\n      cout << \"* no compression\" << endl;\n      break;\n    case Compression::PACKED:\n      cout << \"* de-zero packing for Cap'n Proto\" << endl;\n      cout << \"* standard packing for Protobuf\" << endl;\n      break;\n    case Compression::SNAPPY:\n      cout << \"* Snappy compression\" << endl;\n      break;\n  }\n\n  cout << endl;\n\n  reportTableHeader();\n\n  TestResult nullCase = runTest(\n      Product::NULLCASE, testCase, Mode::OBJECT_SIZE, Reuse::YES, compression, iters);\n  reportResults(\"Theoretical best pass-by-object\", iters, nullCase);\n\n  TestResult protobufBase = runTest(\n      Product::PROTOBUF, testCase, Mode::OBJECTS, Reuse::YES, compression, iters);\n  protobufBase.objectSize = runTest(\n      Product::PROTOBUF, testCase, Mode::OBJECT_SIZE, Reuse::YES, compression, iters).objectSize;\n  reportResults(\"Protobuf pass-by-object\", iters, protobufBase);\n\n  TestResult capnpBase = runTest(\n      Product::CAPNPROTO, testCase, Mode::OBJECTS, Reuse::YES, compression, iters);\n  capnpBase.objectSize = runTest(\n      Product::CAPNPROTO, testCase, Mode::OBJECT_SIZE, Reuse::YES, compression, iters).objectSize;\n  reportResults(\"Cap'n Proto pass-by-object\", iters, capnpBase);\n\n  TestResult nullCaseNoReuse = runTest(\n      Product::NULLCASE, testCase, Mode::OBJECT_SIZE, Reuse::NO, compression, iters);\n  reportResults(\"Theoretical best w/o object reuse\", iters, nullCaseNoReuse);\n\n  TestResult protobufNoReuse = runTest(\n      Product::PROTOBUF, testCase, Mode::OBJECTS, Reuse::NO, compression, iters);\n  protobufNoReuse.objectSize = runTest(\n      Product::PROTOBUF, testCase, Mode::OBJECT_SIZE, Reuse::NO, compression, iters).objectSize;\n  reportResults(\"Protobuf w/o object reuse\", iters, protobufNoReuse);\n\n  TestResult capnpNoReuse = runTest(\n      Product::CAPNPROTO, testCase, Mode::OBJECTS, Reuse::NO, compression, iters);\n  capnpNoReuse.objectSize = runTest(\n      Product::CAPNPROTO, testCase, Mode::OBJECT_SIZE, Reuse::NO, compression, iters).objectSize;\n  reportResults(\"Cap'n Proto w/o object reuse\", iters, capnpNoReuse);\n\n  TestResult protobuf = runTest(\n      Product::PROTOBUF, testCase, mode, Reuse::YES, compression, iters);\n  protobuf.objectSize = protobufBase.objectSize;\n  reportResults(\"Protobuf I/O\", iters, protobuf);\n\n  TestResult capnp = runTest(\n      Product::CAPNPROTO, testCase, mode, Reuse::YES, compression, iters);\n  capnp.objectSize = capnpBase.objectSize;\n  reportResults(\"Cap'n Proto I/O\", iters, capnp);\n  TestResult capnpPacked = runTest(\n      Product::CAPNPROTO, testCase, mode, Reuse::YES, Compression::PACKED, iters);\n  capnpPacked.objectSize = capnpBase.objectSize;\n  reportResults(\"Cap'n Proto packed I/O\", iters, capnpPacked);\n\n  size_t protobufBinarySize = fileSize(\"protobuf-\" + std::string(testCaseName(testCase)));\n  size_t capnpBinarySize = fileSize(\"capnproto-\" + std::string(testCaseName(testCase)));\n  size_t protobufCodeSize = fileSize(std::string(testCaseName(testCase)) + \".pb.cc\")\n                          + fileSize(std::string(testCaseName(testCase)) + \".pb.h\");\n  size_t capnpCodeSize = fileSize(std::string(testCaseName(testCase)) + \".capnp.c++\")\n                       + fileSize(std::string(testCaseName(testCase)) + \".capnp.h\");\n  size_t protobufObjSize = fileSize(std::string(testCaseName(testCase)) + \".pb.o\");\n  size_t capnpObjSize = fileSize(std::string(testCaseName(testCase)) + \".capnp.o\");\n\n  TestResult oldNullCase;\n  TestResult oldNullCaseNoReuse;\n  TestResult oldCapnpBase;\n  TestResult oldCapnpNoReuse;\n  TestResult oldCapnp;\n  TestResult oldCapnpPacked;\n  size_t oldCapnpBinarySize = 0;\n  size_t oldCapnpCodeSize = 0;\n  size_t oldCapnpObjSize = 0;\n  if (oldDir != nullptr) {\n    if (chdir(origDir) < 0) {\n      perror(\"chdir\");\n      return 1;\n    }\n    if (chdir(oldDir) < 0) {\n      perror(oldDir);\n      return 1;\n    }\n\n    oldNullCase = runTest(\n        Product::NULLCASE, testCase, Mode::OBJECT_SIZE, Reuse::YES, compression, iters);\n    reportResults(\"Old theoretical best pass-by-object\", iters, nullCase);\n\n    oldCapnpBase = runTest(\n        Product::CAPNPROTO, testCase, Mode::OBJECTS, Reuse::YES, compression, iters);\n    oldCapnpBase.objectSize = runTest(\n        Product::CAPNPROTO, testCase, Mode::OBJECT_SIZE, Reuse::YES, compression, iters)\n        .objectSize;\n    reportResults(\"Old Cap'n Proto pass-by-object\", iters, oldCapnpBase);\n\n    oldNullCaseNoReuse = runTest(\n        Product::NULLCASE, testCase, Mode::OBJECT_SIZE, Reuse::NO, compression, iters);\n    reportResults(\"Old theoretical best w/o object reuse\", iters, oldNullCaseNoReuse);\n\n    oldCapnpNoReuse = runTest(\n        Product::CAPNPROTO, testCase, Mode::OBJECTS, Reuse::NO, compression, iters);\n    oldCapnpNoReuse.objectSize = runTest(\n        Product::CAPNPROTO, testCase, Mode::OBJECT_SIZE, Reuse::NO, compression, iters).objectSize;\n    reportResults(\"Old Cap'n Proto w/o object reuse\", iters, oldCapnpNoReuse);\n\n    oldCapnp = runTest(\n        Product::CAPNPROTO, testCase, mode, Reuse::YES, compression, iters);\n    oldCapnp.objectSize = oldCapnpBase.objectSize;\n    reportResults(\"Old Cap'n Proto I/O\", iters, oldCapnp);\n    oldCapnpPacked = runTest(\n        Product::CAPNPROTO, testCase, mode, Reuse::YES, Compression::PACKED, iters);\n    oldCapnpPacked.objectSize = oldCapnpBase.objectSize;\n    reportResults(\"Old Cap'n Proto packed I/O\", iters, oldCapnpPacked);\n\n    oldCapnpBinarySize = fileSize(\"capnproto-\" + std::string(testCaseName(testCase)));\n    oldCapnpCodeSize = fileSize(std::string(testCaseName(testCase)) + \".capnp.c++\")\n                     + fileSize(std::string(testCaseName(testCase)) + \".capnp.h\");\n    oldCapnpObjSize = fileSize(std::string(testCaseName(testCase)) + \".capnp.o\");\n  }\n\n  cout << endl;\n\n  reportComparisonHeader();\n  reportComparison(\"memory overhead (vs ideal)\",\n      nullCase.objectSize, protobufBase.objectSize, capnpBase.objectSize, iters);\n  reportComparison(\"memory overhead w/o object reuse\",\n      nullCaseNoReuse.objectSize, protobufNoReuse.objectSize, capnpNoReuse.objectSize, iters);\n  reportComparison(\"object manipulation time (us)\", \"\",\n      ((int64_t)protobufBase.time.user - (int64_t)nullCase.time.user) / 1000.0,\n      ((int64_t)capnpBase.time.user - (int64_t)nullCase.time.user) / 1000.0, iters);\n  reportComparison(\"object manipulation time w/o reuse (us)\", \"\",\n      ((int64_t)protobufNoReuse.time.user - (int64_t)nullCaseNoReuse.time.user) / 1000.0,\n      ((int64_t)capnpNoReuse.time.user - (int64_t)nullCaseNoReuse.time.user) / 1000.0, iters);\n  reportComparison(\"I/O time (us)\", \"\",\n      ((int64_t)protobuf.time.user - (int64_t)protobufBase.time.user) / 1000.0,\n      ((int64_t)capnp.time.user - (int64_t)capnpBase.time.user) / 1000.0, iters);\n  reportComparison(\"packed I/O time (us)\", \"\",\n      ((int64_t)protobuf.time.user - (int64_t)protobufBase.time.user) / 1000.0,\n      ((int64_t)capnpPacked.time.user - (int64_t)capnpBase.time.user) / 1000.0, iters);\n\n  reportIntComparison(\"message size (bytes)\", \"\", protobuf.messageSize, capnp.messageSize, iters);\n  reportIntComparison(\"packed message size (bytes)\", \"\",\n                      protobuf.messageSize, capnpPacked.messageSize, iters);\n\n  reportComparison(\"binary size (KiB)\", \"\",\n      protobufBinarySize / 1024.0, capnpBinarySize / 1024.0, 1);\n  reportComparison(\"generated code size (KiB)\", \"\",\n      protobufCodeSize / 1024.0, capnpCodeSize / 1024.0, 1);\n  reportComparison(\"generated obj size (KiB)\", \"\",\n      protobufObjSize / 1024.0, capnpObjSize / 1024.0, 1);\n\n  if (oldDir != nullptr) {\n    cout << endl;\n    reportOldNewComparisonHeader();\n\n    reportComparison(\"memory overhead\",\n        oldNullCase.objectSize, oldCapnpBase.objectSize, capnpBase.objectSize, iters);\n    reportComparison(\"memory overhead w/o object reuse\",\n        oldNullCaseNoReuse.objectSize, oldCapnpNoReuse.objectSize, capnpNoReuse.objectSize, iters);\n    reportComparison(\"object manipulation time (us)\", \"\",\n        ((int64_t)oldCapnpBase.time.user - (int64_t)oldNullCase.time.user) / 1000.0,\n        ((int64_t)capnpBase.time.user - (int64_t)oldNullCase.time.user) / 1000.0, iters);\n    reportComparison(\"object manipulation time w/o reuse (us)\", \"\",\n        ((int64_t)oldCapnpNoReuse.time.user - (int64_t)oldNullCaseNoReuse.time.user) / 1000.0,\n        ((int64_t)capnpNoReuse.time.user - (int64_t)oldNullCaseNoReuse.time.user) / 1000.0, iters);\n    reportComparison(\"I/O time (us)\", \"\",\n        ((int64_t)oldCapnp.time.user - (int64_t)oldCapnpBase.time.user) / 1000.0,\n        ((int64_t)capnp.time.user - (int64_t)capnpBase.time.user) / 1000.0, iters);\n    reportComparison(\"packed I/O time (us)\", \"\",\n        ((int64_t)oldCapnpPacked.time.user - (int64_t)oldCapnpBase.time.user) / 1000.0,\n        ((int64_t)capnpPacked.time.user - (int64_t)capnpBase.time.user) / 1000.0, iters);\n\n    reportIntComparison(\"message size (bytes)\", \"\", oldCapnp.messageSize, capnp.messageSize, iters);\n    reportIntComparison(\"packed message size (bytes)\", \"\",\n                        oldCapnpPacked.messageSize, capnpPacked.messageSize, iters);\n\n    reportComparison(\"binary size (KiB)\", \"\",\n        oldCapnpBinarySize / 1024.0, capnpBinarySize / 1024.0, 1);\n    reportComparison(\"generated code size (KiB)\", \"\",\n        oldCapnpCodeSize / 1024.0, capnpCodeSize / 1024.0, 1);\n    reportComparison(\"generated obj size (KiB)\", \"\",\n        oldCapnpObjSize / 1024.0, capnpObjSize / 1024.0, 1);\n  }\n\n  return 0;\n}",
    "includes": [
      "#include <iomanip>",
      "#include <iostream>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include <string>",
      "#include <inttypes.h>",
      "#include <sys/stat.h>",
      "#include <sys/wait.h>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reportComparison",
          "args": [
            "\"generated obj size (KiB)\"",
            "\"\"",
            "oldCapnpObjSize / 1024.0",
            "capnpObjSize / 1024.0",
            "1"
          ],
          "line": 635
        },
        "resolved": true,
        "details": {
          "function_name": "reportComparison",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/runner.c++",
          "lines": "320-328",
          "snippet": "void reportComparison(const char* name, const char* unit, double protobuf, double capnproto,\n                      uint64_t iters) {\n  cout << setw(40) << left << name\n       << setw(15-strlen(unit)) << fixed << right << setprecision(2) << (protobuf / iters) << unit\n       << setw(15-strlen(unit)) << fixed << right << setprecision(2) << (capnproto / iters) << unit;\n\n  // Since smaller is better, the \"improvement\" is the \"gain\" from capnproto to protobuf.\n  cout << setw(14) << right << Gain(capnproto, protobuf) << endl;\n}",
          "includes": [
            "#include <iomanip>",
            "#include <iostream>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <string>",
            "#include <inttypes.h>",
            "#include <sys/stat.h>",
            "#include <sys/wait.h>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <iostream>\n#include <string.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <string>\n#include <inttypes.h>\n#include <sys/stat.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n\nvoid reportComparison(const char* name, const char* unit, double protobuf, double capnproto,\n                      uint64_t iters) {\n  cout << setw(40) << left << name\n       << setw(15-strlen(unit)) << fixed << right << setprecision(2) << (protobuf / iters) << unit\n       << setw(15-strlen(unit)) << fixed << right << setprecision(2) << (capnproto / iters) << unit;\n\n  // Since smaller is better, the \"improvement\" is the \"gain\" from capnproto to protobuf.\n  cout << setw(14) << right << Gain(capnproto, protobuf) << endl;\n}"
        }
      },
      {
        "call_info": {
          "callee": "reportIntComparison",
          "args": [
            "\"packed message size (bytes)\"",
            "\"\"",
            "oldCapnpPacked.messageSize",
            "capnpPacked.messageSize",
            "iters"
          ],
          "line": 628
        },
        "resolved": true,
        "details": {
          "function_name": "reportIntComparison",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/runner.c++",
          "lines": "330-338",
          "snippet": "void reportIntComparison(const char* name, const char* unit, uint64_t protobuf, uint64_t capnproto,\n                         uint64_t iters) {\n  cout << setw(40) << left << name\n       << setw(15-strlen(unit)) << right << (protobuf / iters) << unit\n       << setw(15-strlen(unit)) << right << (capnproto / iters) << unit;\n\n  // Since smaller is better, the \"improvement\" is the \"gain\" from capnproto to protobuf.\n  cout << setw(14) << right << Gain(capnproto, protobuf) << endl;\n}",
          "includes": [
            "#include <iomanip>",
            "#include <iostream>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <string>",
            "#include <inttypes.h>",
            "#include <sys/stat.h>",
            "#include <sys/wait.h>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <iostream>\n#include <string.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <string>\n#include <inttypes.h>\n#include <sys/stat.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n\nvoid reportIntComparison(const char* name, const char* unit, uint64_t protobuf, uint64_t capnproto,\n                         uint64_t iters) {\n  cout << setw(40) << left << name\n       << setw(15-strlen(unit)) << right << (protobuf / iters) << unit\n       << setw(15-strlen(unit)) << right << (capnproto / iters) << unit;\n\n  // Since smaller is better, the \"improvement\" is the \"gain\" from capnproto to protobuf.\n  cout << setw(14) << right << Gain(capnproto, protobuf) << endl;\n}"
        }
      },
      {
        "call_info": {
          "callee": "reportOldNewComparisonHeader",
          "args": [],
          "line": 608
        },
        "resolved": true,
        "details": {
          "function_name": "reportOldNewComparisonHeader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/runner.c++",
          "lines": "278-285",
          "snippet": "void reportOldNewComparisonHeader() {\n  cout << setw(40) << left << \"Measure\"\n       << setw(15) << right << \"Old\"\n       << setw(15) << right << \"New\"\n       << setw(15) << right << \"Improvement\"\n       << endl;\n  cout << setfill('=') << setw(85) << \"\" << setfill(' ') << endl;\n}",
          "includes": [
            "#include <iomanip>",
            "#include <iostream>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <string>",
            "#include <inttypes.h>",
            "#include <sys/stat.h>",
            "#include <sys/wait.h>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <iostream>\n#include <string.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <string>\n#include <inttypes.h>\n#include <sys/stat.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n\nvoid reportOldNewComparisonHeader() {\n  cout << setw(40) << left << \"Measure\"\n       << setw(15) << right << \"Old\"\n       << setw(15) << right << \"New\"\n       << setw(15) << right << \"Improvement\"\n       << endl;\n  cout << setfill('=') << setw(85) << \"\" << setfill(' ') << endl;\n}"
        }
      },
      {
        "call_info": {
          "callee": "reportComparisonHeader",
          "args": [],
          "line": 577
        },
        "resolved": true,
        "details": {
          "function_name": "reportComparisonHeader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/runner.c++",
          "lines": "269-276",
          "snippet": "void reportComparisonHeader() {\n  cout << setw(40) << left << \"Measure\"\n       << setw(15) << right << \"Protobuf\"\n       << setw(15) << right << \"Cap'n Proto\"\n       << setw(15) << right << \"Improvement\"\n       << endl;\n  cout << setfill('=') << setw(85) << \"\" << setfill(' ') << endl;\n}",
          "includes": [
            "#include <iomanip>",
            "#include <iostream>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <string>",
            "#include <inttypes.h>",
            "#include <sys/stat.h>",
            "#include <sys/wait.h>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <iostream>\n#include <string.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <string>\n#include <inttypes.h>\n#include <sys/stat.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n\nvoid reportComparisonHeader() {\n  cout << setw(40) << left << \"Measure\"\n       << setw(15) << right << \"Protobuf\"\n       << setw(15) << right << \"Cap'n Proto\"\n       << setw(15) << right << \"Improvement\"\n       << endl;\n  cout << setfill('=') << setw(85) << \"\" << setfill(' ') << endl;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fileSize",
          "args": [
            "std::string(testCaseName(testCase)) + \".capnp.o\""
          ],
          "line": 572
        },
        "resolved": true,
        "details": {
          "function_name": "fileSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/runner.c++",
          "lines": "340-348",
          "snippet": "size_t fileSize(const std::string& name) {\n  struct stat stats;\n  if (stat(name.c_str(), &stats) < 0) {\n    perror(name.c_str());\n    exit(1);\n  }\n\n  return stats.st_size;\n}",
          "includes": [
            "#include <iomanip>",
            "#include <iostream>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <string>",
            "#include <inttypes.h>",
            "#include <sys/stat.h>",
            "#include <sys/wait.h>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <iostream>\n#include <string.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <string>\n#include <inttypes.h>\n#include <sys/stat.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n\nsize_t fileSize(const std::string& name) {\n  struct stat stats;\n  if (stat(name.c_str(), &stats) < 0) {\n    perror(name.c_str());\n    exit(1);\n  }\n\n  return stats.st_size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "testCaseName(testCase)"
          ],
          "line": 572
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "testCaseName",
          "args": [
            "testCase"
          ],
          "line": 572
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "testCaseName(testCase)"
          ],
          "line": 571
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "testCaseName",
          "args": [
            "testCase"
          ],
          "line": 571
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "testCaseName(testCase)"
          ],
          "line": 570
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "testCaseName",
          "args": [
            "testCase"
          ],
          "line": 570
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "testCaseName(testCase)"
          ],
          "line": 569
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "testCaseName",
          "args": [
            "testCase"
          ],
          "line": 569
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reportResults",
          "args": [
            "\"Old Cap'n Proto packed I/O\"",
            "iters",
            "oldCapnpPacked"
          ],
          "line": 567
        },
        "resolved": true,
        "details": {
          "function_name": "reportResults",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/runner.c++",
          "lines": "259-267",
          "snippet": "void reportResults(const char* name, uint64_t iters, TestResult results) {\n  cout << setw(40) << left << name\n       << setw(10) << right << (results.objectSize / iters)\n       << setw(10) << right << (results.messageSize / iters)\n       << setw(10) << right << (results.time.real / iters)\n       << setw(10) << right << (results.time.user / iters)\n       << setw(10) << right << (results.time.sys / iters)\n       << endl;\n}",
          "includes": [
            "#include <iomanip>",
            "#include <iostream>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <string>",
            "#include <inttypes.h>",
            "#include <sys/stat.h>",
            "#include <sys/wait.h>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <iostream>\n#include <string.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <string>\n#include <inttypes.h>\n#include <sys/stat.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n\nvoid reportResults(const char* name, uint64_t iters, TestResult results) {\n  cout << setw(40) << left << name\n       << setw(10) << right << (results.objectSize / iters)\n       << setw(10) << right << (results.messageSize / iters)\n       << setw(10) << right << (results.time.real / iters)\n       << setw(10) << right << (results.time.user / iters)\n       << setw(10) << right << (results.time.sys / iters)\n       << endl;\n}"
        }
      },
      {
        "call_info": {
          "callee": "runTest",
          "args": [
            "Product::CAPNPROTO",
            "testCase",
            "mode",
            "Reuse::YES",
            "Compression::PACKED",
            "iters"
          ],
          "line": 564
        },
        "resolved": true,
        "details": {
          "function_name": "runTest",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/runner.c++",
          "lines": "128-246",
          "snippet": "TestResult runTest(Product product, TestCase testCase, Mode mode, Reuse reuse,\n                   Compression compression, uint64_t iters) {\n  char* argv[6];\n\n  string progName;\n\n  switch (product) {\n    case Product::CAPNPROTO:\n      progName = \"capnproto-\";\n      break;\n    case Product::PROTOBUF:\n      progName = \"protobuf-\";\n      break;\n    case Product::NULLCASE:\n      progName = \"null-\";\n      break;\n  }\n\n  progName += testCaseName(testCase);\n  argv[0] = strdup(progName.c_str());\n\n  switch (mode) {\n    case Mode::OBJECTS:\n      argv[1] = strdup(\"object\");\n      break;\n    case Mode::OBJECT_SIZE:\n      argv[1] = strdup(\"object-size\");\n      break;\n    case Mode::BYTES:\n      argv[1] = strdup(\"bytes\");\n      break;\n    case Mode::PIPE_SYNC:\n      argv[1] = strdup(\"pipe\");\n      break;\n    case Mode::PIPE_ASYNC:\n      argv[1] = strdup(\"pipe-async\");\n      break;\n  }\n\n  switch (reuse) {\n    case Reuse::YES:\n      argv[2] = strdup(\"reuse\");\n      break;\n    case Reuse::NO:\n      argv[2] = strdup(\"no-reuse\");\n      break;\n  }\n\n  switch (compression) {\n    case Compression::NONE:\n      argv[3] = strdup(\"none\");\n      break;\n    case Compression::PACKED:\n      argv[3] = strdup(\"packed\");\n      break;\n    case Compression::SNAPPY:\n      argv[3] = strdup(\"snappy\");\n      break;\n  }\n\n  char itersStr[64];\n  sprintf(itersStr, \"%llu\", (long long unsigned int)iters);\n  argv[4] = itersStr;\n\n  argv[5] = nullptr;\n\n  // Make pipe for child to write throughput.\n  int childPipe[2];\n  if (pipe(childPipe) < 0) {\n    perror(\"pipe\");\n    exit(1);\n  }\n\n  // Spawn the child process.\n  struct timeval start, end;\n  gettimeofday(&start, nullptr);\n  pid_t child = fork();\n  if (child == 0) {\n    close(childPipe[0]);\n    dup2(childPipe[1], STDOUT_FILENO);\n    close(childPipe[1]);\n    execv(argv[0], argv);\n    exit(1);\n  }\n\n  close(childPipe[1]);\n  for (int i = 0; i < 4; i++) {\n    free(argv[i]);\n  }\n\n  // Read throughput number written to child's stdout.\n  FILE* input = fdopen(childPipe[0], \"r\");\n  long long unsigned int throughput;\n  if (fscanf(input, \"%lld\", &throughput) != 1) {\n    fprintf(stderr, \"Child didn't write throughput to stdout.\");\n  }\n  char buffer[1024];\n  while (fgets(buffer, sizeof(buffer), input) != nullptr) {\n    // Loop until EOF.\n  }\n  fclose(input);\n\n  // Wait for child exit.\n  int status;\n  struct rusage usage;\n  wait4(child, &status, 0, &usage);\n  gettimeofday(&end, nullptr);\n\n  // Calculate results.\n\n  TestResult result;\n  result.objectSize = mode == Mode::OBJECT_SIZE ? throughput : 0;\n  result.messageSize = mode == Mode::OBJECT_SIZE ? 0 : throughput;\n  result.time.real = asNanosecs(end) - asNanosecs(start);\n  result.time.user = asNanosecs(usage.ru_utime);\n  result.time.sys = asNanosecs(usage.ru_stime);\n\n  return result;\n}",
          "includes": [
            "#include <iomanip>",
            "#include <iostream>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <string>",
            "#include <inttypes.h>",
            "#include <sys/stat.h>",
            "#include <sys/wait.h>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <iostream>\n#include <string.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <string>\n#include <inttypes.h>\n#include <sys/stat.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n\nTestResult runTest(Product product, TestCase testCase, Mode mode, Reuse reuse,\n                   Compression compression, uint64_t iters) {\n  char* argv[6];\n\n  string progName;\n\n  switch (product) {\n    case Product::CAPNPROTO:\n      progName = \"capnproto-\";\n      break;\n    case Product::PROTOBUF:\n      progName = \"protobuf-\";\n      break;\n    case Product::NULLCASE:\n      progName = \"null-\";\n      break;\n  }\n\n  progName += testCaseName(testCase);\n  argv[0] = strdup(progName.c_str());\n\n  switch (mode) {\n    case Mode::OBJECTS:\n      argv[1] = strdup(\"object\");\n      break;\n    case Mode::OBJECT_SIZE:\n      argv[1] = strdup(\"object-size\");\n      break;\n    case Mode::BYTES:\n      argv[1] = strdup(\"bytes\");\n      break;\n    case Mode::PIPE_SYNC:\n      argv[1] = strdup(\"pipe\");\n      break;\n    case Mode::PIPE_ASYNC:\n      argv[1] = strdup(\"pipe-async\");\n      break;\n  }\n\n  switch (reuse) {\n    case Reuse::YES:\n      argv[2] = strdup(\"reuse\");\n      break;\n    case Reuse::NO:\n      argv[2] = strdup(\"no-reuse\");\n      break;\n  }\n\n  switch (compression) {\n    case Compression::NONE:\n      argv[3] = strdup(\"none\");\n      break;\n    case Compression::PACKED:\n      argv[3] = strdup(\"packed\");\n      break;\n    case Compression::SNAPPY:\n      argv[3] = strdup(\"snappy\");\n      break;\n  }\n\n  char itersStr[64];\n  sprintf(itersStr, \"%llu\", (long long unsigned int)iters);\n  argv[4] = itersStr;\n\n  argv[5] = nullptr;\n\n  // Make pipe for child to write throughput.\n  int childPipe[2];\n  if (pipe(childPipe) < 0) {\n    perror(\"pipe\");\n    exit(1);\n  }\n\n  // Spawn the child process.\n  struct timeval start, end;\n  gettimeofday(&start, nullptr);\n  pid_t child = fork();\n  if (child == 0) {\n    close(childPipe[0]);\n    dup2(childPipe[1], STDOUT_FILENO);\n    close(childPipe[1]);\n    execv(argv[0], argv);\n    exit(1);\n  }\n\n  close(childPipe[1]);\n  for (int i = 0; i < 4; i++) {\n    free(argv[i]);\n  }\n\n  // Read throughput number written to child's stdout.\n  FILE* input = fdopen(childPipe[0], \"r\");\n  long long unsigned int throughput;\n  if (fscanf(input, \"%lld\", &throughput) != 1) {\n    fprintf(stderr, \"Child didn't write throughput to stdout.\");\n  }\n  char buffer[1024];\n  while (fgets(buffer, sizeof(buffer), input) != nullptr) {\n    // Loop until EOF.\n  }\n  fclose(input);\n\n  // Wait for child exit.\n  int status;\n  struct rusage usage;\n  wait4(child, &status, 0, &usage);\n  gettimeofday(&end, nullptr);\n\n  // Calculate results.\n\n  TestResult result;\n  result.objectSize = mode == Mode::OBJECT_SIZE ? throughput : 0;\n  result.messageSize = mode == Mode::OBJECT_SIZE ? 0 : throughput;\n  result.time.real = asNanosecs(end) - asNanosecs(start);\n  result.time.user = asNanosecs(usage.ru_utime);\n  result.time.sys = asNanosecs(usage.ru_stime);\n\n  return result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "perror",
          "args": [
            "oldDir"
          ],
          "line": 535
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chdir",
          "args": [
            "oldDir"
          ],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "perror",
          "args": [
            "\"chdir\""
          ],
          "line": 531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chdir",
          "args": [
            "origDir"
          ],
          "line": 530
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "testCaseName(testCase)"
          ],
          "line": 518
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "testCaseName",
          "args": [
            "testCase"
          ],
          "line": 518
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "testCaseName(testCase)"
          ],
          "line": 517
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "testCaseName",
          "args": [
            "testCase"
          ],
          "line": 517
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "testCaseName(testCase)"
          ],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "testCaseName",
          "args": [
            "testCase"
          ],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "testCaseName(testCase)"
          ],
          "line": 515
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "testCaseName",
          "args": [
            "testCase"
          ],
          "line": 515
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "testCaseName(testCase)"
          ],
          "line": 514
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "testCaseName",
          "args": [
            "testCase"
          ],
          "line": 514
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "testCaseName(testCase)"
          ],
          "line": 513
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "testCaseName",
          "args": [
            "testCase"
          ],
          "line": 513
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "testCaseName(testCase)"
          ],
          "line": 512
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "testCaseName",
          "args": [
            "testCase"
          ],
          "line": 512
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "testCaseName(testCase)"
          ],
          "line": 511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "testCaseName",
          "args": [
            "testCase"
          ],
          "line": 511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reportTableHeader",
          "args": [],
          "line": 463
        },
        "resolved": true,
        "details": {
          "function_name": "reportTableHeader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/runner.c++",
          "lines": "248-257",
          "snippet": "void reportTableHeader() {\n  cout << setw(40) << left << \"Test\"\n       << setw(10) << right << \"obj size\"\n       << setw(10) << right << \"I/O bytes\"\n       << setw(10) << right << \"wall ns\"\n       << setw(10) << right << \"user ns\"\n       << setw(10) << right << \"sys ns\"\n       << endl;\n  cout << setfill('=') << setw(90) << \"\" << setfill(' ') << endl;\n}",
          "includes": [
            "#include <iomanip>",
            "#include <iostream>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <string>",
            "#include <inttypes.h>",
            "#include <sys/stat.h>",
            "#include <sys/wait.h>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <iostream>\n#include <string.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <string>\n#include <inttypes.h>\n#include <sys/stat.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n\nvoid reportTableHeader() {\n  cout << setw(40) << left << \"Test\"\n       << setw(10) << right << \"obj size\"\n       << setw(10) << right << \"I/O bytes\"\n       << setw(10) << right << \"wall ns\"\n       << setw(10) << right << \"user ns\"\n       << setw(10) << right << \"sys ns\"\n       << endl;\n  cout << setfill('=') << setw(90) << \"\" << setfill(' ') << endl;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Unknown option: %s\\n\"",
            "argv[i]"
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"-c requires argument.\\n\""
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtoul",
          "args": [
            "argv[i]",
            "nullptr",
            "0"
          ],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isdigit",
          "args": [
            "argv[i][0]"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "perror",
          "args": [
            "\"chdir\""
          ],
          "line": 361
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chdir",
          "args": [
            "path"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "perror",
          "args": [
            "\"getcwd\""
          ],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getcwd",
          "args": [
            "origDir",
            "sizeof(origDir)"
          ],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strrchr",
          "args": [
            "path",
            "'/'"
          ],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <iomanip>\n#include <iostream>\n#include <string.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <string>\n#include <inttypes.h>\n#include <sys/stat.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n\nint main(int argc, char* argv[]) {\n  char* path = argv[0];\n  char* slashpos = strrchr(path, '/');\n  char origDir[1024];\n  if (getcwd(origDir, sizeof(origDir)) == nullptr) {\n    perror(\"getcwd\");\n    return 1;\n  }\n  if (slashpos != nullptr) {\n    *slashpos = '\\0';\n    if (chdir(path) < 0) {\n      perror(\"chdir\");\n      return 1;\n    }\n    *slashpos = '/';\n  }\n\n  TestCase testCase = TestCase::CATRANK;\n  Mode mode = Mode::PIPE_SYNC;\n  Compression compression = Compression::NONE;\n  uint64_t iters = 1;\n  const char* oldDir = nullptr;\n\n  for (int i = 1; i < argc; i++) {\n    string arg = argv[i];\n    if (isdigit(argv[i][0])) {\n      iters = strtoul(argv[i], nullptr, 0);\n    } else if (arg == \"async\") {\n      mode = Mode::PIPE_ASYNC;\n    } else if (arg == \"inmem\") {\n      mode = Mode::BYTES;\n    } else if (arg == \"eval\") {\n      testCase = TestCase::EVAL;\n    } else if (arg == \"carsales\") {\n      testCase = TestCase::CARSALES;\n    } else if (arg == \"snappy\") {\n      compression = Compression::SNAPPY;\n    } else if (arg == \"-c\") {\n      ++i;\n      if (i == argc) {\n        fprintf(stderr, \"-c requires argument.\\n\");\n        return 1;\n      }\n      oldDir = argv[i];\n    } else {\n      fprintf(stderr, \"Unknown option: %s\\n\", argv[i]);\n      return 1;\n    }\n  }\n\n  // Scale iterations to something reasonable for each case.\n  switch (testCase) {\n    case TestCase::EVAL:\n      iters *= 100000;\n      break;\n    case TestCase::CATRANK:\n      iters *= 1000;\n      break;\n    case TestCase::CARSALES:\n      iters *= 20000;\n      break;\n  }\n\n  cout << \"Running \" << iters << \" iterations of \";\n  switch (testCase) {\n    case TestCase::EVAL:\n      cout << \"calculator\";\n      break;\n    case TestCase::CATRANK:\n      cout << \"CatRank\";\n      break;\n    case TestCase::CARSALES:\n      cout << \"car sales\";\n      break;\n  }\n\n  cout << \" example case with:\" << endl;\n\n  switch (mode) {\n    case Mode::OBJECTS:\n    case Mode::OBJECT_SIZE:\n      // Can't happen.\n      break;\n    case Mode::BYTES:\n      cout << \"* in-memory I/O\" << endl;\n      cout << \"  * with client and server in the same thread\" << endl;\n      break;\n    case Mode::PIPE_SYNC:\n      cout << \"* pipe I/O\" << endl;\n      cout << \"  * with client and server in separate processes\" << endl;\n      cout << \"  * client waits for each response before sending next request\" << endl;\n      break;\n    case Mode::PIPE_ASYNC:\n      cout << \"* pipe I/O\" << endl;\n      cout << \"  * with client and server in separate processes\" << endl;\n      cout << \"  * client sends as many simultaneous requests as it can\" << endl;\n      break;\n  }\n  switch (compression) {\n    case Compression::NONE:\n      cout << \"* no compression\" << endl;\n      break;\n    case Compression::PACKED:\n      cout << \"* de-zero packing for Cap'n Proto\" << endl;\n      cout << \"* standard packing for Protobuf\" << endl;\n      break;\n    case Compression::SNAPPY:\n      cout << \"* Snappy compression\" << endl;\n      break;\n  }\n\n  cout << endl;\n\n  reportTableHeader();\n\n  TestResult nullCase = runTest(\n      Product::NULLCASE, testCase, Mode::OBJECT_SIZE, Reuse::YES, compression, iters);\n  reportResults(\"Theoretical best pass-by-object\", iters, nullCase);\n\n  TestResult protobufBase = runTest(\n      Product::PROTOBUF, testCase, Mode::OBJECTS, Reuse::YES, compression, iters);\n  protobufBase.objectSize = runTest(\n      Product::PROTOBUF, testCase, Mode::OBJECT_SIZE, Reuse::YES, compression, iters).objectSize;\n  reportResults(\"Protobuf pass-by-object\", iters, protobufBase);\n\n  TestResult capnpBase = runTest(\n      Product::CAPNPROTO, testCase, Mode::OBJECTS, Reuse::YES, compression, iters);\n  capnpBase.objectSize = runTest(\n      Product::CAPNPROTO, testCase, Mode::OBJECT_SIZE, Reuse::YES, compression, iters).objectSize;\n  reportResults(\"Cap'n Proto pass-by-object\", iters, capnpBase);\n\n  TestResult nullCaseNoReuse = runTest(\n      Product::NULLCASE, testCase, Mode::OBJECT_SIZE, Reuse::NO, compression, iters);\n  reportResults(\"Theoretical best w/o object reuse\", iters, nullCaseNoReuse);\n\n  TestResult protobufNoReuse = runTest(\n      Product::PROTOBUF, testCase, Mode::OBJECTS, Reuse::NO, compression, iters);\n  protobufNoReuse.objectSize = runTest(\n      Product::PROTOBUF, testCase, Mode::OBJECT_SIZE, Reuse::NO, compression, iters).objectSize;\n  reportResults(\"Protobuf w/o object reuse\", iters, protobufNoReuse);\n\n  TestResult capnpNoReuse = runTest(\n      Product::CAPNPROTO, testCase, Mode::OBJECTS, Reuse::NO, compression, iters);\n  capnpNoReuse.objectSize = runTest(\n      Product::CAPNPROTO, testCase, Mode::OBJECT_SIZE, Reuse::NO, compression, iters).objectSize;\n  reportResults(\"Cap'n Proto w/o object reuse\", iters, capnpNoReuse);\n\n  TestResult protobuf = runTest(\n      Product::PROTOBUF, testCase, mode, Reuse::YES, compression, iters);\n  protobuf.objectSize = protobufBase.objectSize;\n  reportResults(\"Protobuf I/O\", iters, protobuf);\n\n  TestResult capnp = runTest(\n      Product::CAPNPROTO, testCase, mode, Reuse::YES, compression, iters);\n  capnp.objectSize = capnpBase.objectSize;\n  reportResults(\"Cap'n Proto I/O\", iters, capnp);\n  TestResult capnpPacked = runTest(\n      Product::CAPNPROTO, testCase, mode, Reuse::YES, Compression::PACKED, iters);\n  capnpPacked.objectSize = capnpBase.objectSize;\n  reportResults(\"Cap'n Proto packed I/O\", iters, capnpPacked);\n\n  size_t protobufBinarySize = fileSize(\"protobuf-\" + std::string(testCaseName(testCase)));\n  size_t capnpBinarySize = fileSize(\"capnproto-\" + std::string(testCaseName(testCase)));\n  size_t protobufCodeSize = fileSize(std::string(testCaseName(testCase)) + \".pb.cc\")\n                          + fileSize(std::string(testCaseName(testCase)) + \".pb.h\");\n  size_t capnpCodeSize = fileSize(std::string(testCaseName(testCase)) + \".capnp.c++\")\n                       + fileSize(std::string(testCaseName(testCase)) + \".capnp.h\");\n  size_t protobufObjSize = fileSize(std::string(testCaseName(testCase)) + \".pb.o\");\n  size_t capnpObjSize = fileSize(std::string(testCaseName(testCase)) + \".capnp.o\");\n\n  TestResult oldNullCase;\n  TestResult oldNullCaseNoReuse;\n  TestResult oldCapnpBase;\n  TestResult oldCapnpNoReuse;\n  TestResult oldCapnp;\n  TestResult oldCapnpPacked;\n  size_t oldCapnpBinarySize = 0;\n  size_t oldCapnpCodeSize = 0;\n  size_t oldCapnpObjSize = 0;\n  if (oldDir != nullptr) {\n    if (chdir(origDir) < 0) {\n      perror(\"chdir\");\n      return 1;\n    }\n    if (chdir(oldDir) < 0) {\n      perror(oldDir);\n      return 1;\n    }\n\n    oldNullCase = runTest(\n        Product::NULLCASE, testCase, Mode::OBJECT_SIZE, Reuse::YES, compression, iters);\n    reportResults(\"Old theoretical best pass-by-object\", iters, nullCase);\n\n    oldCapnpBase = runTest(\n        Product::CAPNPROTO, testCase, Mode::OBJECTS, Reuse::YES, compression, iters);\n    oldCapnpBase.objectSize = runTest(\n        Product::CAPNPROTO, testCase, Mode::OBJECT_SIZE, Reuse::YES, compression, iters)\n        .objectSize;\n    reportResults(\"Old Cap'n Proto pass-by-object\", iters, oldCapnpBase);\n\n    oldNullCaseNoReuse = runTest(\n        Product::NULLCASE, testCase, Mode::OBJECT_SIZE, Reuse::NO, compression, iters);\n    reportResults(\"Old theoretical best w/o object reuse\", iters, oldNullCaseNoReuse);\n\n    oldCapnpNoReuse = runTest(\n        Product::CAPNPROTO, testCase, Mode::OBJECTS, Reuse::NO, compression, iters);\n    oldCapnpNoReuse.objectSize = runTest(\n        Product::CAPNPROTO, testCase, Mode::OBJECT_SIZE, Reuse::NO, compression, iters).objectSize;\n    reportResults(\"Old Cap'n Proto w/o object reuse\", iters, oldCapnpNoReuse);\n\n    oldCapnp = runTest(\n        Product::CAPNPROTO, testCase, mode, Reuse::YES, compression, iters);\n    oldCapnp.objectSize = oldCapnpBase.objectSize;\n    reportResults(\"Old Cap'n Proto I/O\", iters, oldCapnp);\n    oldCapnpPacked = runTest(\n        Product::CAPNPROTO, testCase, mode, Reuse::YES, Compression::PACKED, iters);\n    oldCapnpPacked.objectSize = oldCapnpBase.objectSize;\n    reportResults(\"Old Cap'n Proto packed I/O\", iters, oldCapnpPacked);\n\n    oldCapnpBinarySize = fileSize(\"capnproto-\" + std::string(testCaseName(testCase)));\n    oldCapnpCodeSize = fileSize(std::string(testCaseName(testCase)) + \".capnp.c++\")\n                     + fileSize(std::string(testCaseName(testCase)) + \".capnp.h\");\n    oldCapnpObjSize = fileSize(std::string(testCaseName(testCase)) + \".capnp.o\");\n  }\n\n  cout << endl;\n\n  reportComparisonHeader();\n  reportComparison(\"memory overhead (vs ideal)\",\n      nullCase.objectSize, protobufBase.objectSize, capnpBase.objectSize, iters);\n  reportComparison(\"memory overhead w/o object reuse\",\n      nullCaseNoReuse.objectSize, protobufNoReuse.objectSize, capnpNoReuse.objectSize, iters);\n  reportComparison(\"object manipulation time (us)\", \"\",\n      ((int64_t)protobufBase.time.user - (int64_t)nullCase.time.user) / 1000.0,\n      ((int64_t)capnpBase.time.user - (int64_t)nullCase.time.user) / 1000.0, iters);\n  reportComparison(\"object manipulation time w/o reuse (us)\", \"\",\n      ((int64_t)protobufNoReuse.time.user - (int64_t)nullCaseNoReuse.time.user) / 1000.0,\n      ((int64_t)capnpNoReuse.time.user - (int64_t)nullCaseNoReuse.time.user) / 1000.0, iters);\n  reportComparison(\"I/O time (us)\", \"\",\n      ((int64_t)protobuf.time.user - (int64_t)protobufBase.time.user) / 1000.0,\n      ((int64_t)capnp.time.user - (int64_t)capnpBase.time.user) / 1000.0, iters);\n  reportComparison(\"packed I/O time (us)\", \"\",\n      ((int64_t)protobuf.time.user - (int64_t)protobufBase.time.user) / 1000.0,\n      ((int64_t)capnpPacked.time.user - (int64_t)capnpBase.time.user) / 1000.0, iters);\n\n  reportIntComparison(\"message size (bytes)\", \"\", protobuf.messageSize, capnp.messageSize, iters);\n  reportIntComparison(\"packed message size (bytes)\", \"\",\n                      protobuf.messageSize, capnpPacked.messageSize, iters);\n\n  reportComparison(\"binary size (KiB)\", \"\",\n      protobufBinarySize / 1024.0, capnpBinarySize / 1024.0, 1);\n  reportComparison(\"generated code size (KiB)\", \"\",\n      protobufCodeSize / 1024.0, capnpCodeSize / 1024.0, 1);\n  reportComparison(\"generated obj size (KiB)\", \"\",\n      protobufObjSize / 1024.0, capnpObjSize / 1024.0, 1);\n\n  if (oldDir != nullptr) {\n    cout << endl;\n    reportOldNewComparisonHeader();\n\n    reportComparison(\"memory overhead\",\n        oldNullCase.objectSize, oldCapnpBase.objectSize, capnpBase.objectSize, iters);\n    reportComparison(\"memory overhead w/o object reuse\",\n        oldNullCaseNoReuse.objectSize, oldCapnpNoReuse.objectSize, capnpNoReuse.objectSize, iters);\n    reportComparison(\"object manipulation time (us)\", \"\",\n        ((int64_t)oldCapnpBase.time.user - (int64_t)oldNullCase.time.user) / 1000.0,\n        ((int64_t)capnpBase.time.user - (int64_t)oldNullCase.time.user) / 1000.0, iters);\n    reportComparison(\"object manipulation time w/o reuse (us)\", \"\",\n        ((int64_t)oldCapnpNoReuse.time.user - (int64_t)oldNullCaseNoReuse.time.user) / 1000.0,\n        ((int64_t)capnpNoReuse.time.user - (int64_t)oldNullCaseNoReuse.time.user) / 1000.0, iters);\n    reportComparison(\"I/O time (us)\", \"\",\n        ((int64_t)oldCapnp.time.user - (int64_t)oldCapnpBase.time.user) / 1000.0,\n        ((int64_t)capnp.time.user - (int64_t)capnpBase.time.user) / 1000.0, iters);\n    reportComparison(\"packed I/O time (us)\", \"\",\n        ((int64_t)oldCapnpPacked.time.user - (int64_t)oldCapnpBase.time.user) / 1000.0,\n        ((int64_t)capnpPacked.time.user - (int64_t)capnpBase.time.user) / 1000.0, iters);\n\n    reportIntComparison(\"message size (bytes)\", \"\", oldCapnp.messageSize, capnp.messageSize, iters);\n    reportIntComparison(\"packed message size (bytes)\", \"\",\n                        oldCapnpPacked.messageSize, capnpPacked.messageSize, iters);\n\n    reportComparison(\"binary size (KiB)\", \"\",\n        oldCapnpBinarySize / 1024.0, capnpBinarySize / 1024.0, 1);\n    reportComparison(\"generated code size (KiB)\", \"\",\n        oldCapnpCodeSize / 1024.0, capnpCodeSize / 1024.0, 1);\n    reportComparison(\"generated obj size (KiB)\", \"\",\n        oldCapnpObjSize / 1024.0, capnpObjSize / 1024.0, 1);\n  }\n\n  return 0;\n}"
  },
  {
    "function_name": "fileSize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/runner.c++",
    "lines": "340-348",
    "snippet": "size_t fileSize(const std::string& name) {\n  struct stat stats;\n  if (stat(name.c_str(), &stats) < 0) {\n    perror(name.c_str());\n    exit(1);\n  }\n\n  return stats.st_size;\n}",
    "includes": [
      "#include <iomanip>",
      "#include <iostream>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include <string>",
      "#include <inttypes.h>",
      "#include <sys/stat.h>",
      "#include <sys/wait.h>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "perror",
          "args": [
            "name.c_str()"
          ],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "name.c_str",
          "args": [],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stat",
          "args": [
            "name.c_str()",
            "&stats"
          ],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "name.c_str",
          "args": [],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <iomanip>\n#include <iostream>\n#include <string.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <string>\n#include <inttypes.h>\n#include <sys/stat.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n\nsize_t fileSize(const std::string& name) {\n  struct stat stats;\n  if (stat(name.c_str(), &stats) < 0) {\n    perror(name.c_str());\n    exit(1);\n  }\n\n  return stats.st_size;\n}"
  },
  {
    "function_name": "reportIntComparison",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/runner.c++",
    "lines": "330-338",
    "snippet": "void reportIntComparison(const char* name, const char* unit, uint64_t protobuf, uint64_t capnproto,\n                         uint64_t iters) {\n  cout << setw(40) << left << name\n       << setw(15-strlen(unit)) << right << (protobuf / iters) << unit\n       << setw(15-strlen(unit)) << right << (capnproto / iters) << unit;\n\n  // Since smaller is better, the \"improvement\" is the \"gain\" from capnproto to protobuf.\n  cout << setw(14) << right << Gain(capnproto, protobuf) << endl;\n}",
    "includes": [
      "#include <iomanip>",
      "#include <iostream>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include <string>",
      "#include <inttypes.h>",
      "#include <sys/stat.h>",
      "#include <sys/wait.h>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Gain",
          "args": [
            "capnproto",
            "protobuf"
          ],
          "line": 337
        },
        "resolved": true,
        "details": {
          "function_name": "Gain",
          "container": "Gain",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/runner.c++",
          "lines": "289-290",
          "snippet": "Gain(double oldValue, double newValue)\n      : amount(newValue / oldValue) {}",
          "includes": [
            "#include <iomanip>",
            "#include <iostream>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <string>",
            "#include <inttypes.h>",
            "#include <sys/stat.h>",
            "#include <sys/wait.h>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <iostream>\n#include <string.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <string>\n#include <inttypes.h>\n#include <sys/stat.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n\nGain {\n  Gain(double oldValue, double newValue)\n        : amount(newValue / oldValue) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "setw",
          "args": [
            "14"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setw",
          "args": [
            "15-strlen(unit)"
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "unit"
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setw",
          "args": [
            "15-strlen(unit)"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "unit"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setw",
          "args": [
            "40"
          ],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <iomanip>\n#include <iostream>\n#include <string.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <string>\n#include <inttypes.h>\n#include <sys/stat.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n\nvoid reportIntComparison(const char* name, const char* unit, uint64_t protobuf, uint64_t capnproto,\n                         uint64_t iters) {\n  cout << setw(40) << left << name\n       << setw(15-strlen(unit)) << right << (protobuf / iters) << unit\n       << setw(15-strlen(unit)) << right << (capnproto / iters) << unit;\n\n  // Since smaller is better, the \"improvement\" is the \"gain\" from capnproto to protobuf.\n  cout << setw(14) << right << Gain(capnproto, protobuf) << endl;\n}"
  },
  {
    "function_name": "reportComparison",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/runner.c++",
    "lines": "320-328",
    "snippet": "void reportComparison(const char* name, const char* unit, double protobuf, double capnproto,\n                      uint64_t iters) {\n  cout << setw(40) << left << name\n       << setw(15-strlen(unit)) << fixed << right << setprecision(2) << (protobuf / iters) << unit\n       << setw(15-strlen(unit)) << fixed << right << setprecision(2) << (capnproto / iters) << unit;\n\n  // Since smaller is better, the \"improvement\" is the \"gain\" from capnproto to protobuf.\n  cout << setw(14) << right << Gain(capnproto, protobuf) << endl;\n}",
    "includes": [
      "#include <iomanip>",
      "#include <iostream>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include <string>",
      "#include <inttypes.h>",
      "#include <sys/stat.h>",
      "#include <sys/wait.h>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Gain",
          "args": [
            "capnproto",
            "protobuf"
          ],
          "line": 327
        },
        "resolved": true,
        "details": {
          "function_name": "Gain",
          "container": "Gain",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/runner.c++",
          "lines": "289-290",
          "snippet": "Gain(double oldValue, double newValue)\n      : amount(newValue / oldValue) {}",
          "includes": [
            "#include <iomanip>",
            "#include <iostream>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <string>",
            "#include <inttypes.h>",
            "#include <sys/stat.h>",
            "#include <sys/wait.h>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <iostream>\n#include <string.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <string>\n#include <inttypes.h>\n#include <sys/stat.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n\nGain {\n  Gain(double oldValue, double newValue)\n        : amount(newValue / oldValue) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "setw",
          "args": [
            "14"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setprecision",
          "args": [
            "2"
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setw",
          "args": [
            "15-strlen(unit)"
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "unit"
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setprecision",
          "args": [
            "2"
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setw",
          "args": [
            "15-strlen(unit)"
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "unit"
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setw",
          "args": [
            "40"
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <iomanip>\n#include <iostream>\n#include <string.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <string>\n#include <inttypes.h>\n#include <sys/stat.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n\nvoid reportComparison(const char* name, const char* unit, double protobuf, double capnproto,\n                      uint64_t iters) {\n  cout << setw(40) << left << name\n       << setw(15-strlen(unit)) << fixed << right << setprecision(2) << (protobuf / iters) << unit\n       << setw(15-strlen(unit)) << fixed << right << setprecision(2) << (capnproto / iters) << unit;\n\n  // Since smaller is better, the \"improvement\" is the \"gain\" from capnproto to protobuf.\n  cout << setw(14) << right << Gain(capnproto, protobuf) << endl;\n}"
  },
  {
    "function_name": "reportComparison",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/runner.c++",
    "lines": "310-318",
    "snippet": "void reportComparison(const char* name, double base, double protobuf, double capnproto,\n                      uint64_t iters) {\n  cout << setw(40) << left << name\n       << setw(14) << right << Gain(base, protobuf)\n       << setw(14) << right << Gain(base, capnproto);\n\n  // Since smaller is better, the \"improvement\" is the \"gain\" from capnproto to protobuf.\n  cout << setw(14) << right << Gain(capnproto - base, protobuf - base) << endl;\n}",
    "includes": [
      "#include <iomanip>",
      "#include <iostream>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include <string>",
      "#include <inttypes.h>",
      "#include <sys/stat.h>",
      "#include <sys/wait.h>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Gain",
          "args": [
            "capnproto - base",
            "protobuf - base"
          ],
          "line": 317
        },
        "resolved": true,
        "details": {
          "function_name": "Gain",
          "container": "Gain",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/runner.c++",
          "lines": "289-290",
          "snippet": "Gain(double oldValue, double newValue)\n      : amount(newValue / oldValue) {}",
          "includes": [
            "#include <iomanip>",
            "#include <iostream>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <string>",
            "#include <inttypes.h>",
            "#include <sys/stat.h>",
            "#include <sys/wait.h>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <iostream>\n#include <string.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <string>\n#include <inttypes.h>\n#include <sys/stat.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n\nGain {\n  Gain(double oldValue, double newValue)\n        : amount(newValue / oldValue) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "setw",
          "args": [
            "14"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setw",
          "args": [
            "14"
          ],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setw",
          "args": [
            "14"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setw",
          "args": [
            "40"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <iomanip>\n#include <iostream>\n#include <string.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <string>\n#include <inttypes.h>\n#include <sys/stat.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n\nvoid reportComparison(const char* name, double base, double protobuf, double capnproto,\n                      uint64_t iters) {\n  cout << setw(40) << left << name\n       << setw(14) << right << Gain(base, protobuf)\n       << setw(14) << right << Gain(base, capnproto);\n\n  // Since smaller is better, the \"improvement\" is the \"gain\" from capnproto to protobuf.\n  cout << setw(14) << right << Gain(capnproto - base, protobuf - base) << endl;\n}"
  },
  {
    "function_name": "writeTo",
    "container": "Gain",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/runner.c++",
    "lines": "292-299",
    "snippet": "void writeTo(std::ostream& os) {\n    if (amount < 2) {\n      double percent = (amount - 1) * 100;\n      os << (int)(percent + 0.5) << \"%\";\n    } else {\n      os << fixed << setprecision(2) << amount << \"x\";\n    }\n  }",
    "includes": [
      "#include <iomanip>",
      "#include <iostream>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include <string>",
      "#include <inttypes.h>",
      "#include <sys/stat.h>",
      "#include <sys/wait.h>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setprecision",
          "args": [
            "2"
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <iomanip>\n#include <iostream>\n#include <string.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <string>\n#include <inttypes.h>\n#include <sys/stat.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n\nGain {\n  void writeTo(std::ostream& os) {\n      if (amount < 2) {\n        double percent = (amount - 1) * 100;\n        os << (int)(percent + 0.5) << \"%\";\n      } else {\n        os << fixed << setprecision(2) << amount << \"x\";\n      }\n    }\n}"
  },
  {
    "function_name": "Gain",
    "container": "Gain",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/runner.c++",
    "lines": "289-290",
    "snippet": "Gain(double oldValue, double newValue)\n      : amount(newValue / oldValue) {}",
    "includes": [
      "#include <iomanip>",
      "#include <iostream>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include <string>",
      "#include <inttypes.h>",
      "#include <sys/stat.h>",
      "#include <sys/wait.h>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <iomanip>\n#include <iostream>\n#include <string.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <string>\n#include <inttypes.h>\n#include <sys/stat.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n\nGain {\n  Gain(double oldValue, double newValue)\n        : amount(newValue / oldValue) {}\n}"
  },
  {
    "function_name": "reportOldNewComparisonHeader",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/runner.c++",
    "lines": "278-285",
    "snippet": "void reportOldNewComparisonHeader() {\n  cout << setw(40) << left << \"Measure\"\n       << setw(15) << right << \"Old\"\n       << setw(15) << right << \"New\"\n       << setw(15) << right << \"Improvement\"\n       << endl;\n  cout << setfill('=') << setw(85) << \"\" << setfill(' ') << endl;\n}",
    "includes": [
      "#include <iomanip>",
      "#include <iostream>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include <string>",
      "#include <inttypes.h>",
      "#include <sys/stat.h>",
      "#include <sys/wait.h>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setfill",
          "args": [
            "' '"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setw",
          "args": [
            "85"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setfill",
          "args": [
            "'='"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setw",
          "args": [
            "15"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setw",
          "args": [
            "15"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setw",
          "args": [
            "15"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setw",
          "args": [
            "40"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <iomanip>\n#include <iostream>\n#include <string.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <string>\n#include <inttypes.h>\n#include <sys/stat.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n\nvoid reportOldNewComparisonHeader() {\n  cout << setw(40) << left << \"Measure\"\n       << setw(15) << right << \"Old\"\n       << setw(15) << right << \"New\"\n       << setw(15) << right << \"Improvement\"\n       << endl;\n  cout << setfill('=') << setw(85) << \"\" << setfill(' ') << endl;\n}"
  },
  {
    "function_name": "reportComparisonHeader",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/runner.c++",
    "lines": "269-276",
    "snippet": "void reportComparisonHeader() {\n  cout << setw(40) << left << \"Measure\"\n       << setw(15) << right << \"Protobuf\"\n       << setw(15) << right << \"Cap'n Proto\"\n       << setw(15) << right << \"Improvement\"\n       << endl;\n  cout << setfill('=') << setw(85) << \"\" << setfill(' ') << endl;\n}",
    "includes": [
      "#include <iomanip>",
      "#include <iostream>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include <string>",
      "#include <inttypes.h>",
      "#include <sys/stat.h>",
      "#include <sys/wait.h>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setfill",
          "args": [
            "' '"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setw",
          "args": [
            "85"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setfill",
          "args": [
            "'='"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setw",
          "args": [
            "15"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setw",
          "args": [
            "15"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setw",
          "args": [
            "15"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setw",
          "args": [
            "40"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <iomanip>\n#include <iostream>\n#include <string.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <string>\n#include <inttypes.h>\n#include <sys/stat.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n\nvoid reportComparisonHeader() {\n  cout << setw(40) << left << \"Measure\"\n       << setw(15) << right << \"Protobuf\"\n       << setw(15) << right << \"Cap'n Proto\"\n       << setw(15) << right << \"Improvement\"\n       << endl;\n  cout << setfill('=') << setw(85) << \"\" << setfill(' ') << endl;\n}"
  },
  {
    "function_name": "reportResults",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/runner.c++",
    "lines": "259-267",
    "snippet": "void reportResults(const char* name, uint64_t iters, TestResult results) {\n  cout << setw(40) << left << name\n       << setw(10) << right << (results.objectSize / iters)\n       << setw(10) << right << (results.messageSize / iters)\n       << setw(10) << right << (results.time.real / iters)\n       << setw(10) << right << (results.time.user / iters)\n       << setw(10) << right << (results.time.sys / iters)\n       << endl;\n}",
    "includes": [
      "#include <iomanip>",
      "#include <iostream>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include <string>",
      "#include <inttypes.h>",
      "#include <sys/stat.h>",
      "#include <sys/wait.h>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setw",
          "args": [
            "10"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setw",
          "args": [
            "10"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setw",
          "args": [
            "10"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setw",
          "args": [
            "10"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setw",
          "args": [
            "10"
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setw",
          "args": [
            "40"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <iomanip>\n#include <iostream>\n#include <string.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <string>\n#include <inttypes.h>\n#include <sys/stat.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n\nvoid reportResults(const char* name, uint64_t iters, TestResult results) {\n  cout << setw(40) << left << name\n       << setw(10) << right << (results.objectSize / iters)\n       << setw(10) << right << (results.messageSize / iters)\n       << setw(10) << right << (results.time.real / iters)\n       << setw(10) << right << (results.time.user / iters)\n       << setw(10) << right << (results.time.sys / iters)\n       << endl;\n}"
  },
  {
    "function_name": "reportTableHeader",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/runner.c++",
    "lines": "248-257",
    "snippet": "void reportTableHeader() {\n  cout << setw(40) << left << \"Test\"\n       << setw(10) << right << \"obj size\"\n       << setw(10) << right << \"I/O bytes\"\n       << setw(10) << right << \"wall ns\"\n       << setw(10) << right << \"user ns\"\n       << setw(10) << right << \"sys ns\"\n       << endl;\n  cout << setfill('=') << setw(90) << \"\" << setfill(' ') << endl;\n}",
    "includes": [
      "#include <iomanip>",
      "#include <iostream>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include <string>",
      "#include <inttypes.h>",
      "#include <sys/stat.h>",
      "#include <sys/wait.h>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setfill",
          "args": [
            "' '"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setw",
          "args": [
            "90"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setfill",
          "args": [
            "'='"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setw",
          "args": [
            "10"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setw",
          "args": [
            "10"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setw",
          "args": [
            "10"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setw",
          "args": [
            "10"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setw",
          "args": [
            "10"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setw",
          "args": [
            "40"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <iomanip>\n#include <iostream>\n#include <string.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <string>\n#include <inttypes.h>\n#include <sys/stat.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n\nvoid reportTableHeader() {\n  cout << setw(40) << left << \"Test\"\n       << setw(10) << right << \"obj size\"\n       << setw(10) << right << \"I/O bytes\"\n       << setw(10) << right << \"wall ns\"\n       << setw(10) << right << \"user ns\"\n       << setw(10) << right << \"sys ns\"\n       << endl;\n  cout << setfill('=') << setw(90) << \"\" << setfill(' ') << endl;\n}"
  },
  {
    "function_name": "runTest",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/runner.c++",
    "lines": "128-246",
    "snippet": "TestResult runTest(Product product, TestCase testCase, Mode mode, Reuse reuse,\n                   Compression compression, uint64_t iters) {\n  char* argv[6];\n\n  string progName;\n\n  switch (product) {\n    case Product::CAPNPROTO:\n      progName = \"capnproto-\";\n      break;\n    case Product::PROTOBUF:\n      progName = \"protobuf-\";\n      break;\n    case Product::NULLCASE:\n      progName = \"null-\";\n      break;\n  }\n\n  progName += testCaseName(testCase);\n  argv[0] = strdup(progName.c_str());\n\n  switch (mode) {\n    case Mode::OBJECTS:\n      argv[1] = strdup(\"object\");\n      break;\n    case Mode::OBJECT_SIZE:\n      argv[1] = strdup(\"object-size\");\n      break;\n    case Mode::BYTES:\n      argv[1] = strdup(\"bytes\");\n      break;\n    case Mode::PIPE_SYNC:\n      argv[1] = strdup(\"pipe\");\n      break;\n    case Mode::PIPE_ASYNC:\n      argv[1] = strdup(\"pipe-async\");\n      break;\n  }\n\n  switch (reuse) {\n    case Reuse::YES:\n      argv[2] = strdup(\"reuse\");\n      break;\n    case Reuse::NO:\n      argv[2] = strdup(\"no-reuse\");\n      break;\n  }\n\n  switch (compression) {\n    case Compression::NONE:\n      argv[3] = strdup(\"none\");\n      break;\n    case Compression::PACKED:\n      argv[3] = strdup(\"packed\");\n      break;\n    case Compression::SNAPPY:\n      argv[3] = strdup(\"snappy\");\n      break;\n  }\n\n  char itersStr[64];\n  sprintf(itersStr, \"%llu\", (long long unsigned int)iters);\n  argv[4] = itersStr;\n\n  argv[5] = nullptr;\n\n  // Make pipe for child to write throughput.\n  int childPipe[2];\n  if (pipe(childPipe) < 0) {\n    perror(\"pipe\");\n    exit(1);\n  }\n\n  // Spawn the child process.\n  struct timeval start, end;\n  gettimeofday(&start, nullptr);\n  pid_t child = fork();\n  if (child == 0) {\n    close(childPipe[0]);\n    dup2(childPipe[1], STDOUT_FILENO);\n    close(childPipe[1]);\n    execv(argv[0], argv);\n    exit(1);\n  }\n\n  close(childPipe[1]);\n  for (int i = 0; i < 4; i++) {\n    free(argv[i]);\n  }\n\n  // Read throughput number written to child's stdout.\n  FILE* input = fdopen(childPipe[0], \"r\");\n  long long unsigned int throughput;\n  if (fscanf(input, \"%lld\", &throughput) != 1) {\n    fprintf(stderr, \"Child didn't write throughput to stdout.\");\n  }\n  char buffer[1024];\n  while (fgets(buffer, sizeof(buffer), input) != nullptr) {\n    // Loop until EOF.\n  }\n  fclose(input);\n\n  // Wait for child exit.\n  int status;\n  struct rusage usage;\n  wait4(child, &status, 0, &usage);\n  gettimeofday(&end, nullptr);\n\n  // Calculate results.\n\n  TestResult result;\n  result.objectSize = mode == Mode::OBJECT_SIZE ? throughput : 0;\n  result.messageSize = mode == Mode::OBJECT_SIZE ? 0 : throughput;\n  result.time.real = asNanosecs(end) - asNanosecs(start);\n  result.time.user = asNanosecs(usage.ru_utime);\n  result.time.sys = asNanosecs(usage.ru_stime);\n\n  return result;\n}",
    "includes": [
      "#include <iomanip>",
      "#include <iostream>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include <string>",
      "#include <inttypes.h>",
      "#include <sys/stat.h>",
      "#include <sys/wait.h>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "asNanosecs",
          "args": [
            "usage.ru_stime"
          ],
          "line": 243
        },
        "resolved": true,
        "details": {
          "function_name": "asNanosecs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/runner.c++",
          "lines": "57-59",
          "snippet": "uint64_t asNanosecs(const struct timeval& tv) {\n  return (uint64_t)tv.tv_sec * 1000000000 + (uint64_t)tv.tv_usec * 1000;\n}",
          "includes": [
            "#include <iomanip>",
            "#include <iostream>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <string>",
            "#include <inttypes.h>",
            "#include <sys/stat.h>",
            "#include <sys/wait.h>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <iostream>\n#include <string.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <string>\n#include <inttypes.h>\n#include <sys/stat.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n\nuint64_t asNanosecs(const struct timeval& tv) {\n  return (uint64_t)tv.tv_sec * 1000000000 + (uint64_t)tv.tv_usec * 1000;\n}"
        }
      },
      {
        "call_info": {
          "callee": "gettimeofday",
          "args": [
            "&end",
            "nullptr"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wait4",
          "args": [
            "child",
            "&status",
            "0",
            "&usage"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fclose",
          "args": [
            "input"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fgets",
          "args": [
            "buffer",
            "sizeof(buffer)",
            "input"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"Child didn't write throughput to stdout.\""
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fscanf",
          "args": [
            "input",
            "\"%lld\"",
            "&throughput"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fdopen",
          "args": [
            "childPipe[0]",
            "\"r\""
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "argv[i]"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "close",
          "args": [
            "childPipe[1]"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "close",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/miniposix.h",
          "lines": "57-59",
          "snippet": "inline int close(int fd) {\n  return ::_close(fd);\n}",
          "includes": [
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <direct.h>",
            "#include <io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <direct.h>\n#include <io.h>\n\ninline int close(int fd) {\n  return ::_close(fd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "execv",
          "args": [
            "argv[0]",
            "argv"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dup2",
          "args": [
            "childPipe[1]",
            "STDOUT_FILENO"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fork",
          "args": [],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "Promise<T>::fork",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/async-inl.h",
          "lines": "745-747",
          "snippet": "ForkedPromise<T> Promise<T>::fork() {\n  return ForkedPromise<T>(false, refcounted<_::ForkHub<_::FixVoid<T>>>(kj::mv(node)));\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "ForkedPromise<T> Promise<T>::fork() {\n  return ForkedPromise<T>(false, refcounted<_::ForkHub<_::FixVoid<T>>>(kj::mv(node)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "gettimeofday",
          "args": [
            "&start",
            "nullptr"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "perror",
          "args": [
            "\"pipe\""
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pipe",
          "args": [
            "childPipe"
          ],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "pipe",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/miniposix.h",
          "lines": "84-86",
          "snippet": "inline int pipe(int fds[2]) {\n  return ::_pipe(fds, 4096, false);\n}",
          "includes": [
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <direct.h>",
            "#include <io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <direct.h>\n#include <io.h>\n\ninline int pipe(int fds[2]) {\n  return ::_pipe(fds, 4096, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "itersStr",
            "\"%llu\"",
            "(long long unsigned int)iters"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "\"snappy\""
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "\"packed\""
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "\"none\""
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "\"no-reuse\""
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "\"reuse\""
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "\"pipe-async\""
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "\"pipe\""
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "\"bytes\""
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "\"object-size\""
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "\"object\""
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "progName.c_str()"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "progName.c_str",
          "args": [],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "testCaseName",
          "args": [
            "testCase"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <iomanip>\n#include <iostream>\n#include <string.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <string>\n#include <inttypes.h>\n#include <sys/stat.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n\nTestResult runTest(Product product, TestCase testCase, Mode mode, Reuse reuse,\n                   Compression compression, uint64_t iters) {\n  char* argv[6];\n\n  string progName;\n\n  switch (product) {\n    case Product::CAPNPROTO:\n      progName = \"capnproto-\";\n      break;\n    case Product::PROTOBUF:\n      progName = \"protobuf-\";\n      break;\n    case Product::NULLCASE:\n      progName = \"null-\";\n      break;\n  }\n\n  progName += testCaseName(testCase);\n  argv[0] = strdup(progName.c_str());\n\n  switch (mode) {\n    case Mode::OBJECTS:\n      argv[1] = strdup(\"object\");\n      break;\n    case Mode::OBJECT_SIZE:\n      argv[1] = strdup(\"object-size\");\n      break;\n    case Mode::BYTES:\n      argv[1] = strdup(\"bytes\");\n      break;\n    case Mode::PIPE_SYNC:\n      argv[1] = strdup(\"pipe\");\n      break;\n    case Mode::PIPE_ASYNC:\n      argv[1] = strdup(\"pipe-async\");\n      break;\n  }\n\n  switch (reuse) {\n    case Reuse::YES:\n      argv[2] = strdup(\"reuse\");\n      break;\n    case Reuse::NO:\n      argv[2] = strdup(\"no-reuse\");\n      break;\n  }\n\n  switch (compression) {\n    case Compression::NONE:\n      argv[3] = strdup(\"none\");\n      break;\n    case Compression::PACKED:\n      argv[3] = strdup(\"packed\");\n      break;\n    case Compression::SNAPPY:\n      argv[3] = strdup(\"snappy\");\n      break;\n  }\n\n  char itersStr[64];\n  sprintf(itersStr, \"%llu\", (long long unsigned int)iters);\n  argv[4] = itersStr;\n\n  argv[5] = nullptr;\n\n  // Make pipe for child to write throughput.\n  int childPipe[2];\n  if (pipe(childPipe) < 0) {\n    perror(\"pipe\");\n    exit(1);\n  }\n\n  // Spawn the child process.\n  struct timeval start, end;\n  gettimeofday(&start, nullptr);\n  pid_t child = fork();\n  if (child == 0) {\n    close(childPipe[0]);\n    dup2(childPipe[1], STDOUT_FILENO);\n    close(childPipe[1]);\n    execv(argv[0], argv);\n    exit(1);\n  }\n\n  close(childPipe[1]);\n  for (int i = 0; i < 4; i++) {\n    free(argv[i]);\n  }\n\n  // Read throughput number written to child's stdout.\n  FILE* input = fdopen(childPipe[0], \"r\");\n  long long unsigned int throughput;\n  if (fscanf(input, \"%lld\", &throughput) != 1) {\n    fprintf(stderr, \"Child didn't write throughput to stdout.\");\n  }\n  char buffer[1024];\n  while (fgets(buffer, sizeof(buffer), input) != nullptr) {\n    // Loop until EOF.\n  }\n  fclose(input);\n\n  // Wait for child exit.\n  int status;\n  struct rusage usage;\n  wait4(child, &status, 0, &usage);\n  gettimeofday(&end, nullptr);\n\n  // Calculate results.\n\n  TestResult result;\n  result.objectSize = mode == Mode::OBJECT_SIZE ? throughput : 0;\n  result.messageSize = mode == Mode::OBJECT_SIZE ? 0 : throughput;\n  result.time.real = asNanosecs(end) - asNanosecs(start);\n  result.time.user = asNanosecs(usage.ru_utime);\n  result.time.sys = asNanosecs(usage.ru_stime);\n\n  return result;\n}"
  },
  {
    "function_name": "currentTimes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/runner.c++",
    "lines": "61-76",
    "snippet": "Times currentTimes() {\n  Times result;\n\n  struct rusage self, children;\n  getrusage(RUSAGE_SELF, &self);\n  getrusage(RUSAGE_CHILDREN, &children);\n\n  struct timeval real;\n  gettimeofday(&real, nullptr);\n\n  result.real = asNanosecs(real);\n  result.user = asNanosecs(self.ru_utime) + asNanosecs(children.ru_utime);\n  result.sys = asNanosecs(self.ru_stime) + asNanosecs(children.ru_stime);\n\n  return result;\n}",
    "includes": [
      "#include <iomanip>",
      "#include <iostream>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include <string>",
      "#include <inttypes.h>",
      "#include <sys/stat.h>",
      "#include <sys/wait.h>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "asNanosecs",
          "args": [
            "children.ru_stime"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "asNanosecs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/runner.c++",
          "lines": "57-59",
          "snippet": "uint64_t asNanosecs(const struct timeval& tv) {\n  return (uint64_t)tv.tv_sec * 1000000000 + (uint64_t)tv.tv_usec * 1000;\n}",
          "includes": [
            "#include <iomanip>",
            "#include <iostream>",
            "#include <string.h>",
            "#include <unistd.h>",
            "#include <stdio.h>",
            "#include <string>",
            "#include <inttypes.h>",
            "#include <sys/stat.h>",
            "#include <sys/wait.h>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <iostream>\n#include <string.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <string>\n#include <inttypes.h>\n#include <sys/stat.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n\nuint64_t asNanosecs(const struct timeval& tv) {\n  return (uint64_t)tv.tv_sec * 1000000000 + (uint64_t)tv.tv_usec * 1000;\n}"
        }
      },
      {
        "call_info": {
          "callee": "gettimeofday",
          "args": [
            "&real",
            "nullptr"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getrusage",
          "args": [
            "RUSAGE_CHILDREN",
            "&children"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getrusage",
          "args": [
            "RUSAGE_SELF",
            "&self"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <iomanip>\n#include <iostream>\n#include <string.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <string>\n#include <inttypes.h>\n#include <sys/stat.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n\nTimes currentTimes() {\n  Times result;\n\n  struct rusage self, children;\n  getrusage(RUSAGE_SELF, &self);\n  getrusage(RUSAGE_CHILDREN, &children);\n\n  struct timeval real;\n  gettimeofday(&real, nullptr);\n\n  result.real = asNanosecs(real);\n  result.user = asNanosecs(self.ru_utime) + asNanosecs(children.ru_utime);\n  result.sys = asNanosecs(self.ru_stime) + asNanosecs(children.ru_stime);\n\n  return result;\n}"
  },
  {
    "function_name": "asNanosecs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/runner.c++",
    "lines": "57-59",
    "snippet": "uint64_t asNanosecs(const struct timeval& tv) {\n  return (uint64_t)tv.tv_sec * 1000000000 + (uint64_t)tv.tv_usec * 1000;\n}",
    "includes": [
      "#include <iomanip>",
      "#include <iostream>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include <string>",
      "#include <inttypes.h>",
      "#include <sys/stat.h>",
      "#include <sys/wait.h>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <iomanip>\n#include <iostream>\n#include <string.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <string>\n#include <inttypes.h>\n#include <sys/stat.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n\nuint64_t asNanosecs(const struct timeval& tv) {\n  return (uint64_t)tv.tv_sec * 1000000000 + (uint64_t)tv.tv_usec * 1000;\n}"
  },
  {
    "function_name": "cpu",
    "container": "Times",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/runner.c++",
    "lines": "46-46",
    "snippet": "uint64_t cpu() { return user + sys; }",
    "includes": [
      "#include <iomanip>",
      "#include <iostream>",
      "#include <string.h>",
      "#include <unistd.h>",
      "#include <stdio.h>",
      "#include <string>",
      "#include <inttypes.h>",
      "#include <sys/stat.h>",
      "#include <sys/wait.h>",
      "#include <sys/resource.h>",
      "#include <sys/time.h>",
      "#include <sys/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <iomanip>\n#include <iostream>\n#include <string.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <string>\n#include <inttypes.h>\n#include <sys/stat.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n\nTimes {\n  uint64_t cpu() { return user + sys; }\n}"
  }
]