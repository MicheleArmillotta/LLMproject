[
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-test.c++",
    "lines": "69-71",
    "snippet": "TEST(String, ToString) {\n  EXPECT_EQ(\"foo\", kj::str(Stringable()));\n}",
    "includes": [
      "#include <string>",
      "#include <kj/compat/gtest.h>",
      "#include \"string.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "kj::str(Stringable())"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "Stringable()"
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "341-341",
          "snippet": "inline String str(String&& s) { return mv(s); }",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\ninline String str(String&& s) { return mv(s); }"
        }
      },
      {
        "call_info": {
          "callee": "Stringable",
          "args": [],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "toString",
          "container": "Stringable",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-test.c++",
          "lines": "66-66",
          "snippet": "kj::StringPtr toString() { return \"foo\"; }",
          "includes": [
            "#include <string>",
            "#include <kj/compat/gtest.h>",
            "#include \"string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string>\n#include <kj/compat/gtest.h>\n#include \"string.h\"\n\nStringable {\n  kj::StringPtr toString() { return \"foo\"; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string>\n#include <kj/compat/gtest.h>\n#include \"string.h\"\n\nTEST(String, ToString) {\n  EXPECT_EQ(\"foo\", kj::str(Stringable()));\n}"
  },
  {
    "function_name": "toString",
    "container": "Stringable",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-test.c++",
    "lines": "66-66",
    "snippet": "kj::StringPtr toString() { return \"foo\"; }",
    "includes": [
      "#include <string>",
      "#include <kj/compat/gtest.h>",
      "#include \"string.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <string>\n#include <kj/compat/gtest.h>\n#include \"string.h\"\n\nStringable {\n  kj::StringPtr toString() { return \"foo\"; }\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-test.c++",
    "lines": "53-63",
    "snippet": "TEST(String, StlInterop) {\n  std::string foo = \"foo\";\n  StringPtr ptr = foo;\n  EXPECT_EQ(\"foo\", ptr);\n\n  std::string bar = ptr;\n  EXPECT_EQ(\"foo\", bar);\n\n  EXPECT_EQ(\"foo\", kj::str(foo));\n  EXPECT_EQ(\"foo\", kj::heapString(foo));\n}",
    "includes": [
      "#include <string>",
      "#include <kj/compat/gtest.h>",
      "#include \"string.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "kj::heapString(foo)"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::heapString",
          "args": [
            "foo"
          ],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "heapString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.c++",
          "lines": "36-40",
          "snippet": "String heapString(size_t size) {\n  char* buffer = _::HeapArrayDisposer::allocate<char>(size + 1);\n  buffer[size] = '\\0';\n  return String(buffer, size, _::HeapArrayDisposer::instance);\n}",
          "includes": [
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <float.h>",
            "#include <stdio.h>",
            "#include \"debug.h\"",
            "#include \"string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdlib.h>\n#include <errno.h>\n#include <float.h>\n#include <stdio.h>\n#include \"debug.h\"\n#include \"string.h\"\n\nString heapString(size_t size) {\n  char* buffer = _::HeapArrayDisposer::allocate<char>(size + 1);\n  buffer[size] = '\\0';\n  return String(buffer, size, _::HeapArrayDisposer::instance);\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "kj::str(foo)"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "foo"
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "341-341",
          "snippet": "inline String str(String&& s) { return mv(s); }",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\ninline String str(String&& s) { return mv(s); }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "bar"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "ptr"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string>\n#include <kj/compat/gtest.h>\n#include \"string.h\"\n\nTEST(String, StlInterop) {\n  std::string foo = \"foo\";\n  StringPtr ptr = foo;\n  EXPECT_EQ(\"foo\", ptr);\n\n  std::string bar = ptr;\n  EXPECT_EQ(\"foo\", bar);\n\n  EXPECT_EQ(\"foo\", kj::str(foo));\n  EXPECT_EQ(\"foo\", kj::heapString(foo));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-test.c++",
    "lines": "39-50",
    "snippet": "TEST(String, StartsEndsWith) {\n  EXPECT_TRUE(StringPtr(\"foobar\").startsWith(\"foo\"));\n  EXPECT_FALSE(StringPtr(\"foobar\").startsWith(\"bar\"));\n  EXPECT_FALSE(StringPtr(\"foobar\").endsWith(\"foo\"));\n  EXPECT_TRUE(StringPtr(\"foobar\").endsWith(\"bar\"));\n\n  EXPECT_FALSE(StringPtr(\"fo\").startsWith(\"foo\"));\n  EXPECT_FALSE(StringPtr(\"fo\").endsWith(\"foo\"));\n\n  EXPECT_TRUE(StringPtr(\"foobar\").startsWith(\"\"));\n  EXPECT_TRUE(StringPtr(\"foobar\").endsWith(\"\"));\n}",
    "includes": [
      "#include <string>",
      "#include <kj/compat/gtest.h>",
      "#include \"string.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "StringPtr(\"foobar\").endsWith(\"\")"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "StringPtr",
          "args": [
            "\"\""
          ],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "StringPtr",
          "container": "StringPtr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "116-116",
          "snippet": "inline StringPtr(ArrayPtr<const char> content): content(content) {}",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\nStringPtr {\n  inline StringPtr(ArrayPtr<const char> content): content(content) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "StringPtr(\"foobar\").startsWith(\"\")"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "StringPtr(\"fo\").endsWith(\"foo\")"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "StringPtr(\"fo\").startsWith(\"foo\")"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "StringPtr(\"foobar\").endsWith(\"bar\")"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "StringPtr(\"foobar\").endsWith(\"foo\")"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "StringPtr(\"foobar\").startsWith(\"bar\")"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "StringPtr(\"foobar\").startsWith(\"foo\")"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string>\n#include <kj/compat/gtest.h>\n#include \"string.h\"\n\nTEST(String, StartsEndsWith) {\n  EXPECT_TRUE(StringPtr(\"foobar\").startsWith(\"foo\"));\n  EXPECT_FALSE(StringPtr(\"foobar\").startsWith(\"bar\"));\n  EXPECT_FALSE(StringPtr(\"foobar\").endsWith(\"foo\"));\n  EXPECT_TRUE(StringPtr(\"foobar\").endsWith(\"bar\"));\n\n  EXPECT_FALSE(StringPtr(\"fo\").startsWith(\"foo\"));\n  EXPECT_FALSE(StringPtr(\"fo\").endsWith(\"foo\"));\n\n  EXPECT_TRUE(StringPtr(\"foobar\").startsWith(\"\"));\n  EXPECT_TRUE(StringPtr(\"foobar\").endsWith(\"\"));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-test.c++",
    "lines": "30-37",
    "snippet": "TEST(String, Str) {\n  EXPECT_EQ(\"foobar\", str(\"foo\", \"bar\"));\n  EXPECT_EQ(\"1 2 3 4\", str(1, \" \", 2u, \" \", 3l, \" \", 4ll));\n  EXPECT_EQ(\"1.5 foo 1e15 bar -3\", str(1.5f, \" foo \", 1e15, \" bar \", -3));\n  EXPECT_EQ(\"foo\", str('f', 'o', 'o'));\n  EXPECT_EQ(\"123 234 -123 e7\",\n            str((int8_t)123, \" \", (uint8_t)234, \" \", (int8_t)-123, \" \", hex((uint8_t)0xe7)));\n}",
    "includes": [
      "#include <string>",
      "#include <kj/compat/gtest.h>",
      "#include \"string.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"123 234 -123 e7\"",
            "str((int8_t)123, \" \", (uint8_t)234, \" \", (int8_t)-123, \" \", hex((uint8_t)0xe7))"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str",
          "args": [
            "(int8_t)123",
            "\" \"",
            "(uint8_t)234",
            "\" \"",
            "(int8_t)-123",
            "\" \"",
            "hex((uint8_t)0xe7)"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hex",
          "args": [
            "(uint8_t)0xe7"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "str('f', 'o', 'o')"
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str",
          "args": [
            "'f'",
            "'o'",
            "'o'"
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"1.5 foo 1e15 bar -3\"",
            "str(1.5f, \" foo \", 1e15, \" bar \", -3)"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str",
          "args": [
            "1.5f",
            "\" foo \"",
            "1e15",
            "\" bar \"",
            "-3"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"1 2 3 4\"",
            "str(1, \" \", 2u, \" \", 3l, \" \", 4ll)"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str",
          "args": [
            "1",
            "\" \"",
            "2u",
            "\" \"",
            "3l",
            "\" \"",
            "4ll"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foobar\"",
            "str(\"foo\", \"bar\")"
          ],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str",
          "args": [
            "\"foo\"",
            "\"bar\""
          ],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string>\n#include <kj/compat/gtest.h>\n#include \"string.h\"\n\nTEST(String, Str) {\n  EXPECT_EQ(\"foobar\", str(\"foo\", \"bar\"));\n  EXPECT_EQ(\"1 2 3 4\", str(1, \" \", 2u, \" \", 3l, \" \", 4ll));\n  EXPECT_EQ(\"1.5 foo 1e15 bar -3\", str(1.5f, \" foo \", 1e15, \" bar \", -3));\n  EXPECT_EQ(\"foo\", str('f', 'o', 'o'));\n  EXPECT_EQ(\"123 234 -123 e7\",\n            str((int8_t)123, \" \", (uint8_t)234, \" \", (int8_t)-123, \" \", hex((uint8_t)0xe7)));\n}"
  }
]