[
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree-test.c++",
    "lines": "47-55",
    "snippet": "TEST(StringTree, DelimitedArray) {\n  Array<StringTree> arr = heapArray<StringTree>(4);\n  arr[0] = strTree(\"foo\");\n  arr[1] = strTree(\"bar\");\n  arr[2] = strTree(\"baz\");\n  arr[3] = strTree(\"qux\");\n\n  EXPECT_EQ(\"foo, bar, baz, qux\", StringTree(kj::mv(arr), \", \").flatten());\n}",
    "includes": [
      "#include <kj/compat/gtest.h>",
      "#include \"string-tree.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo, bar, baz, qux\"",
            "StringTree(kj::mv(arr), \", \").flatten()"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "StringTree",
          "args": [],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "isStringTree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
          "lines": "128-128",
          "snippet": "constexpr bool isStringTree() { return false; }",
          "includes": [
            "#include \"string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"string.h\"\n\nconstexpr bool isStringTree() { return false; }"
        }
      },
      {
        "call_info": {
          "callee": "StringTree",
          "args": [
            "kj::mv(arr)",
            "\", \""
          ],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "StringTree::StringTree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.c++",
          "lines": "26-48",
          "snippet": "StringTree::StringTree(Array<StringTree>&& pieces, StringPtr delim)\n    : size_(0),\n      branches(heapArray<Branch>(pieces.size())) {\n  if (pieces.size() > 0) {\n    if (pieces.size() > 1 && delim.size() > 0) {\n      text = heapString((pieces.size() - 1) * delim.size());\n      size_ = text.size();\n    }\n\n    branches[0].index = 0;\n    branches[0].content = kj::mv(pieces[0]);\n    size_ += pieces[0].size();\n\n    for (uint i = 1; i < pieces.size(); i++) {\n      if (delim.size() > 0) {\n        memcpy(text.begin() + (i - 1) * delim.size(), delim.begin(), delim.size());\n      }\n      branches[i].index = i * delim.size();\n      branches[i].content = kj::mv(pieces[i]);\n      size_ += pieces[i].size();\n    }\n  }\n}",
          "includes": [
            "#include \"string-tree.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"string-tree.h\"\n\nStringTree::StringTree(Array<StringTree>&& pieces, StringPtr delim)\n    : size_(0),\n      branches(heapArray<Branch>(pieces.size())) {\n  if (pieces.size() > 0) {\n    if (pieces.size() > 1 && delim.size() > 0) {\n      text = heapString((pieces.size() - 1) * delim.size());\n      size_ = text.size();\n    }\n\n    branches[0].index = 0;\n    branches[0].content = kj::mv(pieces[0]);\n    size_ += pieces[0].size();\n\n    for (uint i = 1; i < pieces.size(); i++) {\n      if (delim.size() > 0) {\n        memcpy(text.begin() + (i - 1) * delim.size(), delim.begin(), delim.size());\n      }\n      branches[i].index = i * delim.size();\n      branches[i].content = kj::mv(pieces[i]);\n      size_ += pieces[i].size();\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "arr"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strTree",
          "args": [
            "\"qux\""
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strTree",
          "args": [
            "\"baz\""
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strTree",
          "args": [
            "\"bar\""
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strTree",
          "args": [
            "\"foo\""
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "heapArray<StringTree>",
          "args": [
            "4"
          ],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "heapArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "696-698",
          "snippet": "inline Array<T> heapArray(std::initializer_list<T> init) {\n  return heapArray<T>(init.begin(), init.end());\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\ninline Array<T> heapArray(std::initializer_list<T> init) {\n  return heapArray<T>(init.begin(), init.end());\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/compat/gtest.h>\n#include \"string-tree.h\"\n\nTEST(StringTree, DelimitedArray) {\n  Array<StringTree> arr = heapArray<StringTree>(4);\n  arr[0] = strTree(\"foo\");\n  arr[1] = strTree(\"bar\");\n  arr[2] = strTree(\"baz\");\n  arr[3] = strTree(\"qux\");\n\n  EXPECT_EQ(\"foo, bar, baz, qux\", StringTree(kj::mv(arr), \", \").flatten());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree-test.c++",
    "lines": "29-45",
    "snippet": "TEST(StringTree, StrTree) {\n  EXPECT_EQ(\"foobar\", strTree(\"foo\", \"bar\").flatten());\n  EXPECT_EQ(\"1 2 3 4\", strTree(1, \" \", 2u, \" \", 3l, \" \", 4ll).flatten());\n  EXPECT_EQ(\"1.5 foo 1e15 bar -3\", strTree(1.5f, \" foo \", 1e15, \" bar \", -3).flatten());\n  EXPECT_EQ(\"foo\", strTree('f', 'o', 'o').flatten());\n\n  {\n    StringTree tree = strTree(strTree(str(\"foo\"), str(\"bar\")), \"baz\");\n    EXPECT_EQ(\"foobarbaz\", tree.flatten());\n\n    uint pieceCount = 0;\n    tree.visit([&](ArrayPtr<const char> part) { ++pieceCount; EXPECT_EQ(3u, part.size()); });\n    EXPECT_EQ(3u, pieceCount);\n  }\n\n  EXPECT_EQ(\"<foobarbaz>\", str('<', strTree(str(\"foo\"), \"bar\", str(\"baz\")), '>'));\n}",
    "includes": [
      "#include <kj/compat/gtest.h>",
      "#include \"string-tree.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"<foobarbaz>\"",
            "str('<', strTree(str(\"foo\"), \"bar\", str(\"baz\")), '>')"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str",
          "args": [
            "'<'",
            "strTree(str(\"foo\"), \"bar\", str(\"baz\"))",
            "'>'"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strTree",
          "args": [
            "str(\"foo\")",
            "\"bar\"",
            "str(\"baz\")"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str",
          "args": [
            "\"baz\""
          ],
          "line": 44
        },
        "resolved": true,
        "details": {
          "function_name": "destroyObject",
          "container": "Arena",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/arena.h",
          "lines": "129-131",
          "snippet": "static void destroyObject(void* pointer) {\n    dtor(*reinterpret_cast<T*>(pointer));\n  }",
          "includes": [
            "#include \"string.h\"",
            "#include \"array.h\"",
            "#include \"memory.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"string.h\"\n#include \"array.h\"\n#include \"memory.h\"\n\nArena {\n  static void destroyObject(void* pointer) {\n      dtor(*reinterpret_cast<T*>(pointer));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "3u",
            "pieceCount"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tree.visit",
          "args": [
            "[&](ArrayPtr<const char> part) { ++pieceCount; EXPECT_EQ(3u, part.size()); }"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "3u",
            "part.size()"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "part.size",
          "args": [],
          "line": 40
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "ArrayPtr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "1131-1131",
          "snippet": "inline size_t size() const { return size_; }",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\nArrayPtr {\n  inline size_t size() const { return size_; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foobarbaz\"",
            "tree.flatten()"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tree.flatten",
          "args": [],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strTree",
          "args": [
            "strTree(str(\"foo\"), str(\"bar\"))",
            "\"baz\""
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strTree",
          "args": [
            "str(\"foo\")",
            "str(\"bar\")"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "strTree('f', 'o', 'o').flatten()"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strTree",
          "args": [],
          "line": 33
        },
        "resolved": true,
        "details": {
          "function_name": "strTree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
          "lines": "206-208",
          "snippet": "StringTree strTree(Params&&... params) {\n  return StringTree::concat(_::toStringTreeOrCharSequence(kj::fwd<Params>(params))...);\n}",
          "includes": [
            "#include \"string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"string.h\"\n\nStringTree strTree(Params&&... params) {\n  return StringTree::concat(_::toStringTreeOrCharSequence(kj::fwd<Params>(params))...);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strTree",
          "args": [
            "'f'",
            "'o'",
            "'o'"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"1.5 foo 1e15 bar -3\"",
            "strTree(1.5f, \" foo \", 1e15, \" bar \", -3).flatten()"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strTree",
          "args": [
            "1.5f",
            "\" foo \"",
            "1e15",
            "\" bar \"",
            "-3"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"1 2 3 4\"",
            "strTree(1, \" \", 2u, \" \", 3l, \" \", 4ll).flatten()"
          ],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strTree",
          "args": [
            "1",
            "\" \"",
            "2u",
            "\" \"",
            "3l",
            "\" \"",
            "4ll"
          ],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foobar\"",
            "strTree(\"foo\", \"bar\").flatten()"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strTree",
          "args": [
            "\"foo\"",
            "\"bar\""
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/compat/gtest.h>\n#include \"string-tree.h\"\n\nTEST(StringTree, StrTree) {\n  EXPECT_EQ(\"foobar\", strTree(\"foo\", \"bar\").flatten());\n  EXPECT_EQ(\"1 2 3 4\", strTree(1, \" \", 2u, \" \", 3l, \" \", 4ll).flatten());\n  EXPECT_EQ(\"1.5 foo 1e15 bar -3\", strTree(1.5f, \" foo \", 1e15, \" bar \", -3).flatten());\n  EXPECT_EQ(\"foo\", strTree('f', 'o', 'o').flatten());\n\n  {\n    StringTree tree = strTree(strTree(str(\"foo\"), str(\"bar\")), \"baz\");\n    EXPECT_EQ(\"foobarbaz\", tree.flatten());\n\n    uint pieceCount = 0;\n    tree.visit([&](ArrayPtr<const char> part) { ++pieceCount; EXPECT_EQ(3u, part.size()); });\n    EXPECT_EQ(3u, pieceCount);\n  }\n\n  EXPECT_EQ(\"<foobarbaz>\", str('<', strTree(str(\"foo\"), \"bar\", str(\"baz\")), '>'));\n}"
  }
]