[
  {
    "function_name": "Compiler::load",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "1265-1267",
    "snippet": "void Compiler::load(const SchemaLoader& loader, uint64_t id) const {\n  impl.lockExclusive()->get()->loadFinal(loader, id);\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "impl.lockExclusive",
          "args": [
            "loader",
            "id"
          ],
          "line": 1266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "impl.lockExclusive",
          "args": [],
          "line": 1266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "impl.lockExclusive",
          "args": [],
          "line": 1266
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nvoid Compiler::load(const SchemaLoader& loader, uint64_t id) const {\n  impl.lockExclusive()->get()->loadFinal(loader, id);\n}"
  },
  {
    "function_name": "Compiler::clearWorkspace",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "1261-1263",
    "snippet": "void Compiler::clearWorkspace() const {\n  impl.lockExclusive()->get()->clearWorkspace();\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "impl.lockExclusive",
          "args": [],
          "line": 1262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "impl.lockExclusive",
          "args": [],
          "line": 1262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "impl.lockExclusive",
          "args": [],
          "line": 1262
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nvoid Compiler::clearWorkspace() const {\n  impl.lockExclusive()->get()->clearWorkspace();\n}"
  },
  {
    "function_name": "Compiler::eagerlyCompile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "1257-1259",
    "snippet": "void Compiler::eagerlyCompile(uint64_t id, uint eagerness) const {\n  impl.lockExclusive()->get()->eagerlyCompile(id, eagerness, loader);\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "impl.lockExclusive",
          "args": [
            "id",
            "eagerness",
            "loader"
          ],
          "line": 1258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "impl.lockExclusive",
          "args": [],
          "line": 1258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "impl.lockExclusive",
          "args": [],
          "line": 1258
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nvoid Compiler::eagerlyCompile(uint64_t id, uint eagerness) const {\n  impl.lockExclusive()->get()->eagerlyCompile(id, eagerness, loader);\n}"
  },
  {
    "function_name": "Compiler::getFileImportTable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "1252-1255",
    "snippet": "Orphan<List<schema::CodeGeneratorRequest::RequestedFile::Import>>\n    Compiler::getFileImportTable(Module& module, Orphanage orphanage) const {\n  return impl.lockExclusive()->get()->getFileImportTable(module, orphanage);\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "impl.lockExclusive",
          "args": [
            "module",
            "orphanage"
          ],
          "line": 1254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "impl.lockExclusive",
          "args": [],
          "line": 1254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "impl.lockExclusive",
          "args": [],
          "line": 1254
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nOrphan<List<schema::CodeGeneratorRequest::RequestedFile::Import>>\n    Compiler::getFileImportTable(Module& module, Orphanage orphanage) const {\n  return impl.lockExclusive()->get()->getFileImportTable(module, orphanage);\n}"
  },
  {
    "function_name": "Compiler::lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "1248-1250",
    "snippet": "kj::Maybe<uint64_t> Compiler::lookup(uint64_t parent, kj::StringPtr childName) const {\n  return impl.lockExclusive()->get()->lookup(parent, childName);\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "impl.lockExclusive",
          "args": [
            "parent",
            "childName"
          ],
          "line": 1249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "impl.lockExclusive",
          "args": [],
          "line": 1249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "impl.lockExclusive",
          "args": [],
          "line": 1249
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nkj::Maybe<uint64_t> Compiler::lookup(uint64_t parent, kj::StringPtr childName) const {\n  return impl.lockExclusive()->get()->lookup(parent, childName);\n}"
  },
  {
    "function_name": "Compiler::add",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "1244-1246",
    "snippet": "uint64_t Compiler::add(Module& module) const {\n  return impl.lockExclusive()->get()->add(module);\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "impl.lockExclusive",
          "args": [
            "module"
          ],
          "line": 1245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "impl.lockExclusive",
          "args": [],
          "line": 1245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "impl.lockExclusive",
          "args": [],
          "line": 1245
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nuint64_t Compiler::add(Module& module) const {\n  return impl.lockExclusive()->get()->add(module);\n}"
  },
  {
    "function_name": "Compiler::~Compiler",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "1242-1242",
    "snippet": "Compiler::~Compiler() noexcept(false) {}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nCompiler::~Compiler() noexcept(false) {}"
  },
  {
    "function_name": "Compiler::Compiler",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "1239-1241",
    "snippet": "Compiler::Compiler(AnnotationFlag annotationFlag)\n    : impl(kj::heap<Impl>(annotationFlag)),\n      loader(*this) {}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::heap<Impl>",
          "args": [
            "annotationFlag"
          ],
          "line": 1240
        },
        "resolved": true,
        "details": {
          "function_name": "heap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/memory.h",
          "lines": "331-339",
          "snippet": "Own<Decay<T>> heap(T&& orig) {\n  // Allocate a copy (or move) of the argument on the heap.\n  //\n  // The purpose of this overload is to allow you to omit the template parameter as there is only\n  // one argument and the purpose is to copy it.\n\n  typedef Decay<T> T2;\n  return Own<T2>(new T2(kj::fwd<T>(orig)), _::HeapDisposer<T2>::instance);\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nOwn<Decay<T>> heap(T&& orig) {\n  // Allocate a copy (or move) of the argument on the heap.\n  //\n  // The purpose of this overload is to allow you to omit the template parameter as there is only\n  // one argument and the purpose is to copy it.\n\n  typedef Decay<T> T2;\n  return Own<T2>(new T2(kj::fwd<T>(orig)), _::HeapDisposer<T2>::instance);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nCompiler::Compiler(AnnotationFlag annotationFlag)\n    : impl(kj::heap<Impl>(annotationFlag)),\n      loader(*this) {}"
  },
  {
    "function_name": "Compiler::Impl::loadFinal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "1231-1235",
    "snippet": "void Compiler::Impl::loadFinal(const SchemaLoader& loader, uint64_t id) {\n  KJ_IF_MAYBE(node, findNode(id)) {\n    node->loadFinalSchema(loader);\n  }\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "node->loadFinalSchema",
          "args": [
            "loader"
          ],
          "line": 1233
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nvoid Compiler::Impl::loadFinal(const SchemaLoader& loader, uint64_t id) {\n  KJ_IF_MAYBE(node, findNode(id)) {\n    node->loadFinalSchema(loader);\n  }\n}"
  },
  {
    "function_name": "Compiler::Impl::load",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "1221-1229",
    "snippet": "void Compiler::Impl::load(const SchemaLoader& loader, uint64_t id) const {\n  // We know that this load() is only called from the bootstrap loader which is already protected\n  // by our mutex, so we can drop thread-safety.\n  auto& self = const_cast<Compiler::Impl&>(*this);\n\n  KJ_IF_MAYBE(node, self.findNode(id)) {\n    node->getBootstrapSchema();\n  }\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "node->getBootstrapSchema",
          "args": [],
          "line": 1227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_IF_MAYBE",
          "args": [
            "node",
            "self.findNode(id)"
          ],
          "line": 1226
        },
        "resolved": true,
        "details": {
          "function_name": "KJ_IF_MAYBE",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/parser.c++",
          "lines": "982-1016",
          "snippet": "KJ_IF_MAYBE(target, maybeTarget) {\n            if (target->value == \"*\") {\n              // Set all.\n              if (targets.value.size() > 1) {\n                errorReporter.addError(target->startByte, target->endByte,\n                    \"Wildcard should not be specified together with other targets.\");\n              }\n\n              for (auto field: dynamicBuilder.getSchema().getFields()) {\n                if (field.getProto().getName().startsWith(\"targets\")) {\n                  dynamicBuilder.set(field, true);\n                }\n              }\n            } else {\n              if (target->value.size() == 0 || target->value.size() >= 32 ||\n                  target->value[0] < 'a' || target->value[0] > 'z') {\n                errorReporter.addError(target->startByte, target->endByte,\n                                       \"Not a valid annotation target.\");\n              } else {\n                char buffer[64];\n                strcpy(buffer, \"targets\");\n                strcat(buffer, target->value.cStr());\n                buffer[strlen(\"targets\")] += 'A' - 'a';\n                KJ_IF_MAYBE(field, dynamicBuilder.getSchema().findFieldByName(buffer)) {\n                  if (dynamicBuilder.get(*field).as<bool>()) {\n                    errorReporter.addError(target->startByte, target->endByte,\n                                           \"Duplicate target specification.\");\n                  }\n                  dynamicBuilder.set(*field, true);\n                } else {\n                  errorReporter.addError(target->startByte, target->endByte,\n                                         \"Not a valid annotation target.\");\n                }\n              }\n            }",
          "includes": [
            "#include <windows.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <kj/debug.h>",
            "#include <capnp/dynamic.h>",
            "#include \"md5.h\"",
            "#include \"parser.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <windows.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <kj/debug.h>\n#include <capnp/dynamic.h>\n#include \"md5.h\"\n#include \"parser.h\"\n\nKJ_IF_MAYBE(target, maybeTarget) {\n            if (target->value == \"*\") {\n              // Set all.\n              if (targets.value.size() > 1) {\n                errorReporter.addError(target->startByte, target->endByte,\n                    \"Wildcard should not be specified together with other targets.\");\n              }\n\n              for (auto field: dynamicBuilder.getSchema().getFields()) {\n                if (field.getProto().getName().startsWith(\"targets\")) {\n                  dynamicBuilder.set(field, true);\n                }\n              }\n            } else {\n              if (target->value.size() == 0 || target->value.size() >= 32 ||\n                  target->value[0] < 'a' || target->value[0] > 'z') {\n                errorReporter.addError(target->startByte, target->endByte,\n                                       \"Not a valid annotation target.\");\n              } else {\n                char buffer[64];\n                strcpy(buffer, \"targets\");\n                strcat(buffer, target->value.cStr());\n                buffer[strlen(\"targets\")] += 'A' - 'a';\n                KJ_IF_MAYBE(field, dynamicBuilder.getSchema().findFieldByName(buffer)) {\n                  if (dynamicBuilder.get(*field).as<bool>()) {\n                    errorReporter.addError(target->startByte, target->endByte,\n                                           \"Duplicate target specification.\");\n                  }\n                  dynamicBuilder.set(*field, true);\n                } else {\n                  errorReporter.addError(target->startByte, target->endByte,\n                                         \"Not a valid annotation target.\");\n                }\n              }\n            }"
        }
      },
      {
        "call_info": {
          "callee": "self.findNode",
          "args": [
            "id"
          ],
          "line": 1226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "const_cast<Compiler::Impl&>",
          "args": [
            "*this"
          ],
          "line": 1224
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nvoid Compiler::Impl::load(const SchemaLoader& loader, uint64_t id) const {\n  // We know that this load() is only called from the bootstrap loader which is already protected\n  // by our mutex, so we can drop thread-safety.\n  auto& self = const_cast<Compiler::Impl&>(*this);\n\n  KJ_IF_MAYBE(node, self.findNode(id)) {\n    node->getBootstrapSchema();\n  }\n}"
  },
  {
    "function_name": "Compiler::Impl::eagerlyCompile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "1211-1219",
    "snippet": "void Compiler::Impl::eagerlyCompile(uint64_t id, uint eagerness,\n                                    const SchemaLoader& finalLoader) {\n  KJ_IF_MAYBE(node, findNode(id)) {\n    std::unordered_map<Node*, uint> seen;\n    node->traverse(eagerness, seen, finalLoader);\n  } else {\n    KJ_FAIL_REQUIRE(\"id did not come from this Compiler.\", id);\n  }\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "KJ_FAIL_REQUIRE",
          "args": [
            "\"id did not come from this Compiler.\"",
            "id"
          ],
          "line": 1217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "node->traverse",
          "args": [
            "eagerness",
            "seen",
            "finalLoader"
          ],
          "line": 1215
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nvoid Compiler::Impl::eagerlyCompile(uint64_t id, uint eagerness,\n                                    const SchemaLoader& finalLoader) {\n  KJ_IF_MAYBE(node, findNode(id)) {\n    std::unordered_map<Node*, uint> seen;\n    node->traverse(eagerness, seen, finalLoader);\n  } else {\n    KJ_FAIL_REQUIRE(\"id did not come from this Compiler.\", id);\n  }\n}"
  },
  {
    "function_name": "Compiler::Impl::getFileImportTable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "1206-1209",
    "snippet": "Orphan<List<schema::CodeGeneratorRequest::RequestedFile::Import>>\n    Compiler::Impl::getFileImportTable(Module& module, Orphanage orphanage) {\n  return addInternal(module).getFileImportTable(orphanage);\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "addInternal",
          "args": [
            "orphanage"
          ],
          "line": 1208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "addInternal",
          "args": [
            "module"
          ],
          "line": 1208
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nOrphan<List<schema::CodeGeneratorRequest::RequestedFile::Import>>\n    Compiler::Impl::getFileImportTable(Module& module, Orphanage orphanage) {\n  return addInternal(module).getFileImportTable(orphanage);\n}"
  },
  {
    "function_name": "Compiler::Impl::lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "1188-1204",
    "snippet": "kj::Maybe<uint64_t> Compiler::Impl::lookup(uint64_t parent, kj::StringPtr childName) {\n  // Looking up members does not use the workspace, so we don't need to lock it.\n  KJ_IF_MAYBE(parentNode, findNode(parent)) {\n    KJ_IF_MAYBE(child, parentNode->resolveMember(childName)) {\n      if (child->is<NodeTranslator::Resolver::ResolvedDecl>()) {\n        return child->get<NodeTranslator::Resolver::ResolvedDecl>().id;\n      } else {\n        // An alias. We don't support looking up aliases with this method.\n        return nullptr;\n      }\n    } else {\n      return nullptr;\n    }\n  } else {\n    KJ_FAIL_REQUIRE(\"lookup()s parameter 'parent' must be a known ID.\", parent);\n  }\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "KJ_FAIL_REQUIRE",
          "args": [
            "\"lookup()s parameter 'parent' must be a known ID.\"",
            "parent"
          ],
          "line": 1202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "child->get<NodeTranslator::Resolver::ResolvedDecl>",
          "args": [],
          "line": 1193
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "child->is<NodeTranslator::Resolver::ResolvedDecl>",
          "args": [],
          "line": 1192
        },
        "resolved": true,
        "details": {
          "function_name": "is",
          "container": "OneOf",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/one-of.h",
          "lines": "61-63",
          "snippet": "bool is() const {\n    return tag == typeIndex<T>();\n  }",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nOneOf {\n  bool is() const {\n      return tag == typeIndex<T>();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "KJ_IF_MAYBE",
          "args": [
            "child",
            "parentNode->resolveMember(childName)"
          ],
          "line": 1191
        },
        "resolved": true,
        "details": {
          "function_name": "KJ_IF_MAYBE",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/parser.c++",
          "lines": "982-1016",
          "snippet": "KJ_IF_MAYBE(target, maybeTarget) {\n            if (target->value == \"*\") {\n              // Set all.\n              if (targets.value.size() > 1) {\n                errorReporter.addError(target->startByte, target->endByte,\n                    \"Wildcard should not be specified together with other targets.\");\n              }\n\n              for (auto field: dynamicBuilder.getSchema().getFields()) {\n                if (field.getProto().getName().startsWith(\"targets\")) {\n                  dynamicBuilder.set(field, true);\n                }\n              }\n            } else {\n              if (target->value.size() == 0 || target->value.size() >= 32 ||\n                  target->value[0] < 'a' || target->value[0] > 'z') {\n                errorReporter.addError(target->startByte, target->endByte,\n                                       \"Not a valid annotation target.\");\n              } else {\n                char buffer[64];\n                strcpy(buffer, \"targets\");\n                strcat(buffer, target->value.cStr());\n                buffer[strlen(\"targets\")] += 'A' - 'a';\n                KJ_IF_MAYBE(field, dynamicBuilder.getSchema().findFieldByName(buffer)) {\n                  if (dynamicBuilder.get(*field).as<bool>()) {\n                    errorReporter.addError(target->startByte, target->endByte,\n                                           \"Duplicate target specification.\");\n                  }\n                  dynamicBuilder.set(*field, true);\n                } else {\n                  errorReporter.addError(target->startByte, target->endByte,\n                                         \"Not a valid annotation target.\");\n                }\n              }\n            }",
          "includes": [
            "#include <windows.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <kj/debug.h>",
            "#include <capnp/dynamic.h>",
            "#include \"md5.h\"",
            "#include \"parser.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <windows.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <kj/debug.h>\n#include <capnp/dynamic.h>\n#include \"md5.h\"\n#include \"parser.h\"\n\nKJ_IF_MAYBE(target, maybeTarget) {\n            if (target->value == \"*\") {\n              // Set all.\n              if (targets.value.size() > 1) {\n                errorReporter.addError(target->startByte, target->endByte,\n                    \"Wildcard should not be specified together with other targets.\");\n              }\n\n              for (auto field: dynamicBuilder.getSchema().getFields()) {\n                if (field.getProto().getName().startsWith(\"targets\")) {\n                  dynamicBuilder.set(field, true);\n                }\n              }\n            } else {\n              if (target->value.size() == 0 || target->value.size() >= 32 ||\n                  target->value[0] < 'a' || target->value[0] > 'z') {\n                errorReporter.addError(target->startByte, target->endByte,\n                                       \"Not a valid annotation target.\");\n              } else {\n                char buffer[64];\n                strcpy(buffer, \"targets\");\n                strcat(buffer, target->value.cStr());\n                buffer[strlen(\"targets\")] += 'A' - 'a';\n                KJ_IF_MAYBE(field, dynamicBuilder.getSchema().findFieldByName(buffer)) {\n                  if (dynamicBuilder.get(*field).as<bool>()) {\n                    errorReporter.addError(target->startByte, target->endByte,\n                                           \"Duplicate target specification.\");\n                  }\n                  dynamicBuilder.set(*field, true);\n                } else {\n                  errorReporter.addError(target->startByte, target->endByte,\n                                         \"Not a valid annotation target.\");\n                }\n              }\n            }"
        }
      },
      {
        "call_info": {
          "callee": "parentNode->resolveMember",
          "args": [
            "childName"
          ],
          "line": 1191
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nkj::Maybe<uint64_t> Compiler::Impl::lookup(uint64_t parent, kj::StringPtr childName) {\n  // Looking up members does not use the workspace, so we don't need to lock it.\n  KJ_IF_MAYBE(parentNode, findNode(parent)) {\n    KJ_IF_MAYBE(child, parentNode->resolveMember(childName)) {\n      if (child->is<NodeTranslator::Resolver::ResolvedDecl>()) {\n        return child->get<NodeTranslator::Resolver::ResolvedDecl>().id;\n      } else {\n        // An alias. We don't support looking up aliases with this method.\n        return nullptr;\n      }\n    } else {\n      return nullptr;\n    }\n  } else {\n    KJ_FAIL_REQUIRE(\"lookup()s parameter 'parent' must be a known ID.\", parent);\n  }\n}"
  },
  {
    "function_name": "Compiler::Impl::add",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "1184-1186",
    "snippet": "uint64_t Compiler::Impl::add(Module& module) {\n  return addInternal(module).getRootNode().getId();\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "addInternal",
          "args": [],
          "line": 1185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "addInternal",
          "args": [],
          "line": 1185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "addInternal",
          "args": [
            "module"
          ],
          "line": 1185
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nuint64_t Compiler::Impl::add(Module& module) {\n  return addInternal(module).getRootNode().getId();\n}"
  },
  {
    "function_name": "Compiler::Impl::lookupBuiltin",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "1169-1176",
    "snippet": "kj::Maybe<Compiler::Node&> Compiler::Impl::lookupBuiltin(kj::StringPtr name) {\n  auto iter = builtinDecls.find(name);\n  if (iter == builtinDecls.end()) {\n    return nullptr;\n  } else {\n    return *iter->second;\n  }\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "builtinDecls.end",
          "args": [],
          "line": 1171
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-capnp.c++",
          "lines": "77-77",
          "snippet": "inline Iterator end() const { return Iterator(amount); }",
          "includes": [
            "#include \"config.h\"",
            "#include <map>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <map>\n#include <algorithm>\n#include <kj/main.h>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nIndent {\n  inline Iterator end() const { return Iterator(amount); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "builtinDecls.find",
          "args": [
            "name"
          ],
          "line": 1170
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "ImportTable",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "191-202",
          "snippet": "kj::Maybe<T&> find(Id id) {\n    if (id < kj::size(low)) {\n      return low[id];\n    } else {\n      auto iter = high.find(id);\n      if (iter == high.end()) {\n        return nullptr;\n      } else {\n        return iter->second;\n      }\n    }\n  }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nImportTable {\n  kj::Maybe<T&> find(Id id) {\n      if (id < kj::size(low)) {\n        return low[id];\n      } else {\n        auto iter = high.find(id);\n        if (iter == high.end()) {\n          return nullptr;\n        } else {\n          return iter->second;\n        }\n      }\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nkj::Maybe<Compiler::Node&> Compiler::Impl::lookupBuiltin(kj::StringPtr name) {\n  auto iter = builtinDecls.find(name);\n  if (iter == builtinDecls.end()) {\n    return nullptr;\n  } else {\n    return *iter->second;\n  }\n}"
  },
  {
    "function_name": "Compiler::Impl::findNode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "1160-1167",
    "snippet": "kj::Maybe<Compiler::Node&> Compiler::Impl::findNode(uint64_t id) {\n  auto iter = nodesById.find(id);\n  if (iter == nodesById.end()) {\n    return nullptr;\n  } else {\n    return *iter->second;\n  }\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nodesById.end",
          "args": [],
          "line": 1162
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-capnp.c++",
          "lines": "77-77",
          "snippet": "inline Iterator end() const { return Iterator(amount); }",
          "includes": [
            "#include \"config.h\"",
            "#include <map>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <map>\n#include <algorithm>\n#include <kj/main.h>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nIndent {\n  inline Iterator end() const { return Iterator(amount); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "nodesById.find",
          "args": [
            "id"
          ],
          "line": 1161
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "ImportTable",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "191-202",
          "snippet": "kj::Maybe<T&> find(Id id) {\n    if (id < kj::size(low)) {\n      return low[id];\n    } else {\n      auto iter = high.find(id);\n      if (iter == high.end()) {\n        return nullptr;\n      } else {\n        return iter->second;\n      }\n    }\n  }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nImportTable {\n  kj::Maybe<T&> find(Id id) {\n      if (id < kj::size(low)) {\n        return low[id];\n      } else {\n        auto iter = high.find(id);\n        if (iter == high.end()) {\n          return nullptr;\n        } else {\n          return iter->second;\n        }\n      }\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nkj::Maybe<Compiler::Node&> Compiler::Impl::findNode(uint64_t id) {\n  auto iter = nodesById.find(id);\n  if (iter == nodesById.end()) {\n    return nullptr;\n  } else {\n    return *iter->second;\n  }\n}"
  },
  {
    "function_name": "Compiler::Impl::addNode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "1139-1158",
    "snippet": "uint64_t Compiler::Impl::addNode(uint64_t desiredId, Node& node) {\n  for (;;) {\n    auto insertResult = nodesById.insert(std::make_pair(desiredId, &node));\n    if (insertResult.second) {\n      return desiredId;\n    }\n\n    // Only report an error if this ID is not bogus.  Actual IDs specified in the original source\n    // code are required to have the upper bit set.  Anything else must have been manufactured\n    // at some point to cover up an error.\n    if (desiredId & (1ull << 63)) {\n      node.addError(kj::str(\"Duplicate ID @0x\", kj::hex(desiredId), \".\"));\n      insertResult.first->second->addError(\n          kj::str(\"ID @0x\", kj::hex(desiredId), \" originally used here.\"));\n    }\n\n    // Assign a new bogus ID.\n    desiredId = nextBogusId++;\n  }\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "insertResult.first->second->addError",
          "args": [
            "kj::str(\"ID @0x\", kj::hex(desiredId), \" originally used here.\")"
          ],
          "line": 1151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "\"ID @0x\"",
            "kj::hex(desiredId)",
            "\" originally used here.\""
          ],
          "line": 1152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::hex",
          "args": [
            "desiredId"
          ],
          "line": 1152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "node.addError",
          "args": [
            "kj::str(\"Duplicate ID @0x\", kj::hex(desiredId), \".\")"
          ],
          "line": 1150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "\"Duplicate ID @0x\"",
            "kj::hex(desiredId)",
            "\".\""
          ],
          "line": 1150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::hex",
          "args": [
            "desiredId"
          ],
          "line": 1150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nodesById.insert",
          "args": [
            "std::make_pair(desiredId, &node)"
          ],
          "line": 1141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::make_pair",
          "args": [
            "desiredId",
            "&node"
          ],
          "line": 1141
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nuint64_t Compiler::Impl::addNode(uint64_t desiredId, Node& node) {\n  for (;;) {\n    auto insertResult = nodesById.insert(std::make_pair(desiredId, &node));\n    if (insertResult.second) {\n      return desiredId;\n    }\n\n    // Only report an error if this ID is not bogus.  Actual IDs specified in the original source\n    // code are required to have the upper bit set.  Anything else must have been manufactured\n    // at some point to cover up an error.\n    if (desiredId & (1ull << 63)) {\n      node.addError(kj::str(\"Duplicate ID @0x\", kj::hex(desiredId), \".\"));\n      insertResult.first->second->addError(\n          kj::str(\"ID @0x\", kj::hex(desiredId), \" originally used here.\"));\n    }\n\n    // Assign a new bogus ID.\n    desiredId = nextBogusId++;\n  }\n}"
  },
  {
    "function_name": "Compiler::Impl::clearWorkspace",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "1124-1128",
    "snippet": "void Compiler::Impl::clearWorkspace() {\n  // Make sure we reconstruct the workspace even if destroying it throws an exception.\n  KJ_DEFER(kj::ctor(workspace, *this));\n  kj::dtor(workspace);\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::dtor",
          "args": [
            "workspace"
          ],
          "line": 1127
        },
        "resolved": true,
        "details": {
          "function_name": "dtor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "738-740",
          "snippet": "inline void dtor(T& location) {\n  location.~T();\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\ninline void dtor(T& location) {\n  location.~T();\n}"
        }
      },
      {
        "call_info": {
          "callee": "KJ_DEFER",
          "args": [
            "kj::ctor(workspace, *this)"
          ],
          "line": 1126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::ctor",
          "args": [
            "workspace",
            "*this"
          ],
          "line": 1126
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nvoid Compiler::Impl::clearWorkspace() {\n  // Make sure we reconstruct the workspace even if destroying it throws an exception.\n  KJ_DEFER(kj::ctor(workspace, *this));\n  kj::dtor(workspace);\n}"
  },
  {
    "function_name": "Compiler::Impl::~Impl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "1122-1122",
    "snippet": "Compiler::Impl::~Impl() noexcept(false) {}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nCompiler::Impl::~Impl() noexcept(false) {}"
  },
  {
    "function_name": "Compiler::Impl::Impl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "1091-1120",
    "snippet": "Compiler::Impl::Impl(AnnotationFlag annotationFlag)\n    : annotationFlag(annotationFlag), workspace(*this) {\n  // Reflectively interpret the members of Declaration.body.  Any member prefixed by \"builtin\"\n  // defines a builtin declaration visible in the global scope.\n\n  StructSchema declSchema = Schema::from<Declaration>();\n  for (auto field: declSchema.getFields()) {\n    auto fieldProto = field.getProto();\n    if (fieldProto.getDiscriminantValue() != schema::Field::NO_DISCRIMINANT) {\n      auto name = fieldProto.getName();\n      if (name.startsWith(\"builtin\")) {\n        kj::StringPtr symbolName = name.slice(strlen(\"builtin\"));\n\n        List<Declaration::BrandParameter>::Reader params;\n        for (auto annotation: fieldProto.getAnnotations()) {\n          if (annotation.getId() == 0x94099c3f9eb32d6bull) {\n            params = annotation.getValue().getList().getAs<List<Declaration::BrandParameter>>();\n            break;\n          }\n        }\n\n        Declaration::Which which =\n            static_cast<Declaration::Which>(fieldProto.getDiscriminantValue());\n        kj::Own<Node> newNode = nodeArena.allocateOwn<Node>(symbolName, which, params);\n        builtinDeclsByKind[which] = newNode;\n        builtinDecls[symbolName] = kj::mv(newNode);\n      }\n    }\n  }\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "newNode"
          ],
          "line": 1116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nodeArena.allocateOwn<Node>",
          "args": [
            "symbolName",
            "which",
            "params"
          ],
          "line": 1114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<Declaration::Which>",
          "args": [
            "fieldProto.getDiscriminantValue()"
          ],
          "line": 1113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fieldProto.getDiscriminantValue",
          "args": [],
          "line": 1113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "annotation.getValue",
          "args": [],
          "line": 1107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "annotation.getValue",
          "args": [],
          "line": 1107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "annotation.getValue",
          "args": [],
          "line": 1107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "annotation.getId",
          "args": [],
          "line": 1106
        },
        "resolved": true,
        "details": {
          "function_name": "getId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
          "lines": "75-75",
          "snippet": "uint64_t getId() { return id; }",
          "includes": [
            "#include \"md5.h\"",
            "#include \"node-translator.h\"",
            "#include <unordered_map>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/message.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/arena.h>",
            "#include <kj/mutex.h>",
            "#include \"parser.h\"      // only for generateChildId()",
            "#include \"compiler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nuint64_t getId() { return id; }"
        }
      },
      {
        "call_info": {
          "callee": "fieldProto.getAnnotations",
          "args": [],
          "line": 1105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "name.slice",
          "args": [
            "strlen(\"builtin\")"
          ],
          "line": 1102
        },
        "resolved": true,
        "details": {
          "function_name": "slice",
          "container": "String",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "177-177",
          "snippet": "inline StringPtr slice(size_t start) const { return StringPtr(*this).slice(start); }",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\nString {\n  inline StringPtr slice(size_t start) const { return StringPtr(*this).slice(start); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "\"builtin\""
          ],
          "line": 1102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "name.startsWith",
          "args": [
            "\"builtin\""
          ],
          "line": 1101
        },
        "resolved": true,
        "details": {
          "function_name": "startsWith",
          "container": "String",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "174-174",
          "snippet": "inline bool startsWith(const StringPtr& other) const { return StringPtr(*this).startsWith(other);}",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\nString {\n  inline bool startsWith(const StringPtr& other) const { return StringPtr(*this).startsWith(other);}\n}"
        }
      },
      {
        "call_info": {
          "callee": "fieldProto.getName",
          "args": [],
          "line": 1100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fieldProto.getDiscriminantValue",
          "args": [],
          "line": 1099
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getProto",
          "args": [],
          "line": 1098
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      },
      {
        "call_info": {
          "callee": "declSchema.getFields",
          "args": [],
          "line": 1097
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<Declaration>",
          "args": [],
          "line": 1096
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nCompiler::Impl::Impl(AnnotationFlag annotationFlag)\n    : annotationFlag(annotationFlag), workspace(*this) {\n  // Reflectively interpret the members of Declaration.body.  Any member prefixed by \"builtin\"\n  // defines a builtin declaration visible in the global scope.\n\n  StructSchema declSchema = Schema::from<Declaration>();\n  for (auto field: declSchema.getFields()) {\n    auto fieldProto = field.getProto();\n    if (fieldProto.getDiscriminantValue() != schema::Field::NO_DISCRIMINANT) {\n      auto name = fieldProto.getName();\n      if (name.startsWith(\"builtin\")) {\n        kj::StringPtr symbolName = name.slice(strlen(\"builtin\"));\n\n        List<Declaration::BrandParameter>::Reader params;\n        for (auto annotation: fieldProto.getAnnotations()) {\n          if (annotation.getId() == 0x94099c3f9eb32d6bull) {\n            params = annotation.getValue().getList().getAs<List<Declaration::BrandParameter>>();\n            break;\n          }\n        }\n\n        Declaration::Which which =\n            static_cast<Declaration::Which>(fieldProto.getDiscriminantValue());\n        kj::Own<Node> newNode = nodeArena.allocateOwn<Node>(symbolName, which, params);\n        builtinDeclsByKind[which] = newNode;\n        builtinDecls[symbolName] = kj::mv(newNode);\n      }\n    }\n  }\n}"
  },
  {
    "function_name": "Compiler::CompiledModule::getFileImportTable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "1069-1087",
    "snippet": "Orphan<List<schema::CodeGeneratorRequest::RequestedFile::Import>>\n    Compiler::CompiledModule::getFileImportTable(Orphanage orphanage) {\n  std::set<kj::StringPtr> importNames;\n  findImports(content.getReader().getRoot(), importNames);\n\n  auto result = orphanage.newOrphan<List<schema::CodeGeneratorRequest::RequestedFile::Import>>(\n      importNames.size());\n  auto builder = result.get();\n\n  uint i = 0;\n  for (auto name: importNames) {\n    // We presumably ran this import before, so it shouldn't throw now.\n    auto entry = builder[i++];\n    entry.setId(KJ_ASSERT_NONNULL(importRelative(name)).rootNode.getId());\n    entry.setName(name);\n  }\n\n  return result;\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "entry.setName",
          "args": [
            "name"
          ],
          "line": 1083
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "entry.setId",
          "args": [
            "KJ_ASSERT_NONNULL(importRelative(name)).rootNode.getId()"
          ],
          "line": 1082
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_ASSERT_NONNULL",
          "args": [],
          "line": 1082
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_ASSERT_NONNULL",
          "args": [
            "importRelative(name)"
          ],
          "line": 1082
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "importRelative",
          "args": [
            "name"
          ],
          "line": 1082
        },
        "resolved": true,
        "details": {
          "function_name": "importRelative",
          "container": "ModuleImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/evolution-test.c++",
          "lines": "645-647",
          "snippet": "kj::Maybe<Module&> importRelative(kj::StringPtr importPath) override {\n    return nullptr;\n  }",
          "includes": [
            "#include <unistd.h>",
            "#include <kj/io.h>",
            "#include <kj/main.h>",
            "#include <time.h>",
            "#include <stdlib.h>",
            "#include <kj/debug.h>",
            "#include <kj/function.h>",
            "#include \"compiler.h\"",
            "#include <capnp/pretty-print.h>",
            "#include <capnp/message.h>",
            "#include <capnp/schema-loader.h>",
            "#include <capnp/compiler/grammar.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <kj/io.h>\n#include <kj/main.h>\n#include <time.h>\n#include <stdlib.h>\n#include <kj/debug.h>\n#include <kj/function.h>\n#include \"compiler.h\"\n#include <capnp/pretty-print.h>\n#include <capnp/message.h>\n#include <capnp/schema-loader.h>\n#include <capnp/compiler/grammar.capnp.h>\n\nModuleImpl {\n  kj::Maybe<Module&> importRelative(kj::StringPtr importPath) override {\n      return nullptr;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "result.get",
          "args": [],
          "line": 1076
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "orphanage.newOrphan<List<schema::CodeGeneratorRequest::RequestedFile::Import>>",
          "args": [
            "importNames.size()"
          ],
          "line": 1074
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "importNames.size",
          "args": [],
          "line": 1075
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-capnp.c++",
          "lines": "74-74",
          "snippet": "inline size_t size() const { return amount; }",
          "includes": [
            "#include \"config.h\"",
            "#include <map>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <map>\n#include <algorithm>\n#include <kj/main.h>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nIndent {\n  inline size_t size() const { return amount; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "findImports",
          "args": [
            "content.getReader().getRoot()",
            "importNames"
          ],
          "line": 1072
        },
        "resolved": true,
        "details": {
          "function_name": "findImports",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
          "lines": "1010-1067",
          "snippet": "static void findImports(Declaration::Reader decl, std::set<kj::StringPtr>& output) {\n  switch (decl.which()) {\n    case Declaration::USING:\n      findImports(decl.getUsing().getTarget(), output);\n      break;\n    case Declaration::CONST:\n      findImports(decl.getConst().getType(), output);\n      break;\n    case Declaration::FIELD:\n      findImports(decl.getField().getType(), output);\n      break;\n    case Declaration::INTERFACE:\n      for (auto superclass: decl.getInterface().getSuperclasses()) {\n        findImports(superclass, output);\n      }\n      break;\n    case Declaration::METHOD: {\n      auto method = decl.getMethod();\n\n      auto params = method.getParams();\n      if (params.isNamedList()) {\n        for (auto param: params.getNamedList()) {\n          findImports(param.getType(), output);\n          for (auto ann: param.getAnnotations()) {\n            findImports(ann.getName(), output);\n          }\n        }\n      } else {\n        findImports(params.getType(), output);\n      }\n\n      if (method.getResults().isExplicit()) {\n        auto results = method.getResults().getExplicit();\n        if (results.isNamedList()) {\n          for (auto param: results.getNamedList()) {\n            findImports(param.getType(), output);\n            for (auto ann: param.getAnnotations()) {\n              findImports(ann.getName(), output);\n            }\n          }\n        } else {\n          findImports(results.getType(), output);\n        }\n      }\n      break;\n    }\n    default:\n      break;\n  }\n\n  for (auto ann: decl.getAnnotations()) {\n    findImports(ann.getName(), output);\n  }\n\n  for (auto nested: decl.getNestedDecls()) {\n    findImports(nested, output);\n  }\n}",
          "includes": [
            "#include \"md5.h\"",
            "#include \"node-translator.h\"",
            "#include <unordered_map>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/message.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/arena.h>",
            "#include <kj/mutex.h>",
            "#include \"parser.h\"      // only for generateChildId()",
            "#include \"compiler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nstatic void findImports(Declaration::Reader decl, std::set<kj::StringPtr>& output) {\n  switch (decl.which()) {\n    case Declaration::USING:\n      findImports(decl.getUsing().getTarget(), output);\n      break;\n    case Declaration::CONST:\n      findImports(decl.getConst().getType(), output);\n      break;\n    case Declaration::FIELD:\n      findImports(decl.getField().getType(), output);\n      break;\n    case Declaration::INTERFACE:\n      for (auto superclass: decl.getInterface().getSuperclasses()) {\n        findImports(superclass, output);\n      }\n      break;\n    case Declaration::METHOD: {\n      auto method = decl.getMethod();\n\n      auto params = method.getParams();\n      if (params.isNamedList()) {\n        for (auto param: params.getNamedList()) {\n          findImports(param.getType(), output);\n          for (auto ann: param.getAnnotations()) {\n            findImports(ann.getName(), output);\n          }\n        }\n      } else {\n        findImports(params.getType(), output);\n      }\n\n      if (method.getResults().isExplicit()) {\n        auto results = method.getResults().getExplicit();\n        if (results.isNamedList()) {\n          for (auto param: results.getNamedList()) {\n            findImports(param.getType(), output);\n            for (auto ann: param.getAnnotations()) {\n              findImports(ann.getName(), output);\n            }\n          }\n        } else {\n          findImports(results.getType(), output);\n        }\n      }\n      break;\n    }\n    default:\n      break;\n  }\n\n  for (auto ann: decl.getAnnotations()) {\n    findImports(ann.getName(), output);\n  }\n\n  for (auto nested: decl.getNestedDecls()) {\n    findImports(nested, output);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "content.getReader",
          "args": [],
          "line": 1072
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "content.getReader",
          "args": [],
          "line": 1072
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nOrphan<List<schema::CodeGeneratorRequest::RequestedFile::Import>>\n    Compiler::CompiledModule::getFileImportTable(Orphanage orphanage) {\n  std::set<kj::StringPtr> importNames;\n  findImports(content.getReader().getRoot(), importNames);\n\n  auto result = orphanage.newOrphan<List<schema::CodeGeneratorRequest::RequestedFile::Import>>(\n      importNames.size());\n  auto builder = result.get();\n\n  uint i = 0;\n  for (auto name: importNames) {\n    // We presumably ran this import before, so it shouldn't throw now.\n    auto entry = builder[i++];\n    entry.setId(KJ_ASSERT_NONNULL(importRelative(name)).rootNode.getId());\n    entry.setName(name);\n  }\n\n  return result;\n}"
  },
  {
    "function_name": "findImports",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "1010-1067",
    "snippet": "static void findImports(Declaration::Reader decl, std::set<kj::StringPtr>& output) {\n  switch (decl.which()) {\n    case Declaration::USING:\n      findImports(decl.getUsing().getTarget(), output);\n      break;\n    case Declaration::CONST:\n      findImports(decl.getConst().getType(), output);\n      break;\n    case Declaration::FIELD:\n      findImports(decl.getField().getType(), output);\n      break;\n    case Declaration::INTERFACE:\n      for (auto superclass: decl.getInterface().getSuperclasses()) {\n        findImports(superclass, output);\n      }\n      break;\n    case Declaration::METHOD: {\n      auto method = decl.getMethod();\n\n      auto params = method.getParams();\n      if (params.isNamedList()) {\n        for (auto param: params.getNamedList()) {\n          findImports(param.getType(), output);\n          for (auto ann: param.getAnnotations()) {\n            findImports(ann.getName(), output);\n          }\n        }\n      } else {\n        findImports(params.getType(), output);\n      }\n\n      if (method.getResults().isExplicit()) {\n        auto results = method.getResults().getExplicit();\n        if (results.isNamedList()) {\n          for (auto param: results.getNamedList()) {\n            findImports(param.getType(), output);\n            for (auto ann: param.getAnnotations()) {\n              findImports(ann.getName(), output);\n            }\n          }\n        } else {\n          findImports(results.getType(), output);\n        }\n      }\n      break;\n    }\n    default:\n      break;\n  }\n\n  for (auto ann: decl.getAnnotations()) {\n    findImports(ann.getName(), output);\n  }\n\n  for (auto nested: decl.getNestedDecls()) {\n    findImports(nested, output);\n  }\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "decl.getNestedDecls",
          "args": [],
          "line": 1064
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ann.getName",
          "args": [],
          "line": 1061
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decl.getAnnotations",
          "args": [],
          "line": 1060
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "results.getType",
          "args": [],
          "line": 1051
        },
        "resolved": true,
        "details": {
          "function_name": "getType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "942-942",
          "snippet": "inline DynamicValue::Type getType() { return type; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline DynamicValue::Type getType() { return type; }"
        }
      },
      {
        "call_info": {
          "callee": "ann.getName",
          "args": [],
          "line": 1047
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "param.getAnnotations",
          "args": [],
          "line": 1046
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "results.getNamedList",
          "args": [],
          "line": 1044
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "results.isNamedList",
          "args": [],
          "line": 1043
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "method.getResults",
          "args": [],
          "line": 1042
        },
        "resolved": true,
        "details": {
          "function_name": "getResults",
          "container": "LocallyRedirectedRpcResponse",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1644-1646",
          "snippet": "AnyPointer::Reader getResults() override {\n      return message.getRoot<AnyPointer>();\n    }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nLocallyRedirectedRpcResponse {\n  AnyPointer::Reader getResults() override {\n        return message.getRoot<AnyPointer>();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ann.getName",
          "args": [],
          "line": 1034
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "param.getAnnotations",
          "args": [],
          "line": 1033
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "params.getNamedList",
          "args": [],
          "line": 1031
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "params.isNamedList",
          "args": [],
          "line": 1030
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "method.getParams",
          "args": [],
          "line": 1029
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decl.getMethod",
          "args": [],
          "line": 1027
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decl.getInterface",
          "args": [],
          "line": 1022
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decl.getInterface",
          "args": [],
          "line": 1022
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decl.getField",
          "args": [],
          "line": 1019
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decl.getField",
          "args": [],
          "line": 1019
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decl.getConst",
          "args": [],
          "line": 1016
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decl.getConst",
          "args": [],
          "line": 1016
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decl.getUsing",
          "args": [],
          "line": 1013
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decl.getUsing",
          "args": [],
          "line": 1013
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decl.which",
          "args": [],
          "line": 1011
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nstatic void findImports(Declaration::Reader decl, std::set<kj::StringPtr>& output) {\n  switch (decl.which()) {\n    case Declaration::USING:\n      findImports(decl.getUsing().getTarget(), output);\n      break;\n    case Declaration::CONST:\n      findImports(decl.getConst().getType(), output);\n      break;\n    case Declaration::FIELD:\n      findImports(decl.getField().getType(), output);\n      break;\n    case Declaration::INTERFACE:\n      for (auto superclass: decl.getInterface().getSuperclasses()) {\n        findImports(superclass, output);\n      }\n      break;\n    case Declaration::METHOD: {\n      auto method = decl.getMethod();\n\n      auto params = method.getParams();\n      if (params.isNamedList()) {\n        for (auto param: params.getNamedList()) {\n          findImports(param.getType(), output);\n          for (auto ann: param.getAnnotations()) {\n            findImports(ann.getName(), output);\n          }\n        }\n      } else {\n        findImports(params.getType(), output);\n      }\n\n      if (method.getResults().isExplicit()) {\n        auto results = method.getResults().getExplicit();\n        if (results.isNamedList()) {\n          for (auto param: results.getNamedList()) {\n            findImports(param.getType(), output);\n            for (auto ann: param.getAnnotations()) {\n              findImports(ann.getName(), output);\n            }\n          }\n        } else {\n          findImports(results.getType(), output);\n        }\n      }\n      break;\n    }\n    default:\n      break;\n  }\n\n  for (auto ann: decl.getAnnotations()) {\n    findImports(ann.getName(), output);\n  }\n\n  for (auto nested: decl.getNestedDecls()) {\n    findImports(nested, output);\n  }\n}"
  },
  {
    "function_name": "findImports",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "966-1008",
    "snippet": "static void findImports(Expression::Reader exp, std::set<kj::StringPtr>& output) {\n  switch (exp.which()) {\n    case Expression::UNKNOWN:\n    case Expression::POSITIVE_INT:\n    case Expression::NEGATIVE_INT:\n    case Expression::FLOAT:\n    case Expression::STRING:\n    case Expression::BINARY:\n    case Expression::RELATIVE_NAME:\n    case Expression::ABSOLUTE_NAME:\n      break;\n\n    case Expression::IMPORT:\n      output.insert(exp.getImport().getValue());\n      break;\n\n    case Expression::LIST:\n      for (auto element: exp.getList()) {\n        findImports(element, output);\n      }\n      break;\n\n    case Expression::TUPLE:\n      for (auto element: exp.getTuple()) {\n        findImports(element.getValue(), output);\n      }\n      break;\n\n    case Expression::APPLICATION: {\n      auto app = exp.getApplication();\n      findImports(app.getFunction(), output);\n      for (auto param: app.getParams()) {\n        findImports(param.getValue(), output);\n      }\n      break;\n    }\n\n    case Expression::MEMBER: {\n      findImports(exp.getMember().getParent(), output);\n      break;\n    }\n  }\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "exp.getMember",
          "args": [],
          "line": 1004
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exp.getMember",
          "args": [],
          "line": 1004
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "param.getValue",
          "args": [],
          "line": 998
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "app.getParams",
          "args": [],
          "line": 997
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "app.getFunction",
          "args": [],
          "line": 996
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exp.getApplication",
          "args": [],
          "line": 995
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "element.getValue",
          "args": [],
          "line": 990
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exp.getTuple",
          "args": [],
          "line": 989
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exp.getList",
          "args": [],
          "line": 983
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "output.insert",
          "args": [
            "exp.getImport().getValue()"
          ],
          "line": 979
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exp.getImport",
          "args": [],
          "line": 979
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exp.getImport",
          "args": [],
          "line": 979
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exp.which",
          "args": [],
          "line": 967
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nstatic void findImports(Expression::Reader exp, std::set<kj::StringPtr>& output) {\n  switch (exp.which()) {\n    case Expression::UNKNOWN:\n    case Expression::POSITIVE_INT:\n    case Expression::NEGATIVE_INT:\n    case Expression::FLOAT:\n    case Expression::STRING:\n    case Expression::BINARY:\n    case Expression::RELATIVE_NAME:\n    case Expression::ABSOLUTE_NAME:\n      break;\n\n    case Expression::IMPORT:\n      output.insert(exp.getImport().getValue());\n      break;\n\n    case Expression::LIST:\n      for (auto element: exp.getList()) {\n        findImports(element, output);\n      }\n      break;\n\n    case Expression::TUPLE:\n      for (auto element: exp.getTuple()) {\n        findImports(element.getValue(), output);\n      }\n      break;\n\n    case Expression::APPLICATION: {\n      auto app = exp.getApplication();\n      findImports(app.getFunction(), output);\n      for (auto param: app.getParams()) {\n        findImports(param.getValue(), output);\n      }\n      break;\n    }\n\n    case Expression::MEMBER: {\n      findImports(exp.getMember().getParent(), output);\n      break;\n    }\n  }\n}"
  },
  {
    "function_name": "Compiler::CompiledModule::importRelative",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "958-964",
    "snippet": "kj::Maybe<Compiler::CompiledModule&> Compiler::CompiledModule::importRelative(\n    kj::StringPtr importPath) {\n  return parserModule.importRelative(importPath).map(\n      [this](Module& module) -> Compiler::CompiledModule& {\n        return compiler.addInternal(module);\n      });\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "parserModule.importRelative",
          "args": [
            "[this](Module& module) -> Compiler::CompiledModule& {\n        return compiler.addInternal(module);\n      }"
          ],
          "line": 960
        },
        "resolved": true,
        "details": {
          "function_name": "importRelative",
          "container": "ModuleImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/evolution-test.c++",
          "lines": "645-647",
          "snippet": "kj::Maybe<Module&> importRelative(kj::StringPtr importPath) override {\n    return nullptr;\n  }",
          "includes": [
            "#include <unistd.h>",
            "#include <kj/io.h>",
            "#include <kj/main.h>",
            "#include <time.h>",
            "#include <stdlib.h>",
            "#include <kj/debug.h>",
            "#include <kj/function.h>",
            "#include \"compiler.h\"",
            "#include <capnp/pretty-print.h>",
            "#include <capnp/message.h>",
            "#include <capnp/schema-loader.h>",
            "#include <capnp/compiler/grammar.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <kj/io.h>\n#include <kj/main.h>\n#include <time.h>\n#include <stdlib.h>\n#include <kj/debug.h>\n#include <kj/function.h>\n#include \"compiler.h\"\n#include <capnp/pretty-print.h>\n#include <capnp/message.h>\n#include <capnp/schema-loader.h>\n#include <capnp/compiler/grammar.capnp.h>\n\nModuleImpl {\n  kj::Maybe<Module&> importRelative(kj::StringPtr importPath) override {\n      return nullptr;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "compiler.addInternal",
          "args": [
            "module"
          ],
          "line": 962
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nkj::Maybe<Compiler::CompiledModule&> Compiler::CompiledModule::importRelative(\n    kj::StringPtr importPath) {\n  return parserModule.importRelative(importPath).map(\n      [this](Module& module) -> Compiler::CompiledModule& {\n        return compiler.addInternal(module);\n      });\n}"
  },
  {
    "function_name": "Compiler::CompiledModule::CompiledModule",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "953-956",
    "snippet": "Compiler::CompiledModule::CompiledModule(Compiler::Impl& compiler, Module& parserModule)\n    : compiler(compiler), parserModule(parserModule),\n      content(parserModule.loadContent(contentArena.getOrphanage())),\n      rootNode(*this) {}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "parserModule.loadContent",
          "args": [
            "contentArena.getOrphanage()"
          ],
          "line": 955
        },
        "resolved": true,
        "details": {
          "function_name": "loadContent",
          "container": "ModuleImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/evolution-test.c++",
          "lines": "642-644",
          "snippet": "Orphan<ParsedFile> loadContent(Orphanage orphanage) override {\n    return orphanage.newOrphanCopy(content);\n  }",
          "includes": [
            "#include <unistd.h>",
            "#include <kj/io.h>",
            "#include <kj/main.h>",
            "#include <time.h>",
            "#include <stdlib.h>",
            "#include <kj/debug.h>",
            "#include <kj/function.h>",
            "#include \"compiler.h\"",
            "#include <capnp/pretty-print.h>",
            "#include <capnp/message.h>",
            "#include <capnp/schema-loader.h>",
            "#include <capnp/compiler/grammar.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <kj/io.h>\n#include <kj/main.h>\n#include <time.h>\n#include <stdlib.h>\n#include <kj/debug.h>\n#include <kj/function.h>\n#include \"compiler.h\"\n#include <capnp/pretty-print.h>\n#include <capnp/message.h>\n#include <capnp/schema-loader.h>\n#include <capnp/compiler/grammar.capnp.h>\n\nModuleImpl {\n  Orphan<ParsedFile> loadContent(Orphanage orphanage) override {\n      return orphanage.newOrphanCopy(content);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "contentArena.getOrphanage",
          "args": [],
          "line": 955
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nCompiler::CompiledModule::CompiledModule(Compiler::Impl& compiler, Module& parserModule)\n    : compiler(compiler), parserModule(parserModule),\n      content(parserModule.loadContent(contentArena.getOrphanage())),\n      rootNode(*this) {}"
  },
  {
    "function_name": "Compiler::Node::resolveBootstrapType",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "935-949",
    "snippet": "kj::Maybe<Type> Compiler::Node::resolveBootstrapType(schema::Type::Reader type, Schema scope) {\n  // TODO(someday): Arguably should return null if the type or its dependencies are placeholders.\n\n  kj::Maybe<Type> result;\n  KJ_IF_MAYBE(exception, kj::runCatchingExceptions([&]() {\n    result = module->getCompiler().getWorkspace().bootstrapLoader.getType(type, scope);\n  })) {\n    result = nullptr;\n    if (!module->getErrorReporter().hadErrors()) {\n      addError(kj::str(\"Internal compiler bug: Bootstrap schema failed to load:\\n\",\n                       *exception));\n    }\n  }\n  return result;\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "addError",
          "args": [
            "kj::str(\"Internal compiler bug: Bootstrap schema failed to load:\\n\",\n                       *exception)"
          ],
          "line": 944
        },
        "resolved": true,
        "details": {
          "function_name": "Compiler::Node::addError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
          "lines": "820-822",
          "snippet": "void Compiler::Node::addError(kj::StringPtr error) {\n  module->getErrorReporter().addError(startByte, endByte, error);\n}",
          "includes": [
            "#include \"md5.h\"",
            "#include \"node-translator.h\"",
            "#include <unordered_map>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/message.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/arena.h>",
            "#include <kj/mutex.h>",
            "#include \"parser.h\"      // only for generateChildId()",
            "#include \"compiler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nvoid Compiler::Node::addError(kj::StringPtr error) {\n  module->getErrorReporter().addError(startByte, endByte, error);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "\"Internal compiler bug: Bootstrap schema failed to load:\\n\"",
            "*exception"
          ],
          "line": 944
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module->getErrorReporter",
          "args": [],
          "line": 943
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module->getErrorReporter",
          "args": [],
          "line": 943
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_IF_MAYBE",
          "args": [
            "exception",
            "kj::runCatchingExceptions([&]() {\n    result = module->getCompiler().getWorkspace().bootstrapLoader.getType(type, scope);\n  })"
          ],
          "line": 939
        },
        "resolved": true,
        "details": {
          "function_name": "KJ_IF_MAYBE",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/parser.c++",
          "lines": "982-1016",
          "snippet": "KJ_IF_MAYBE(target, maybeTarget) {\n            if (target->value == \"*\") {\n              // Set all.\n              if (targets.value.size() > 1) {\n                errorReporter.addError(target->startByte, target->endByte,\n                    \"Wildcard should not be specified together with other targets.\");\n              }\n\n              for (auto field: dynamicBuilder.getSchema().getFields()) {\n                if (field.getProto().getName().startsWith(\"targets\")) {\n                  dynamicBuilder.set(field, true);\n                }\n              }\n            } else {\n              if (target->value.size() == 0 || target->value.size() >= 32 ||\n                  target->value[0] < 'a' || target->value[0] > 'z') {\n                errorReporter.addError(target->startByte, target->endByte,\n                                       \"Not a valid annotation target.\");\n              } else {\n                char buffer[64];\n                strcpy(buffer, \"targets\");\n                strcat(buffer, target->value.cStr());\n                buffer[strlen(\"targets\")] += 'A' - 'a';\n                KJ_IF_MAYBE(field, dynamicBuilder.getSchema().findFieldByName(buffer)) {\n                  if (dynamicBuilder.get(*field).as<bool>()) {\n                    errorReporter.addError(target->startByte, target->endByte,\n                                           \"Duplicate target specification.\");\n                  }\n                  dynamicBuilder.set(*field, true);\n                } else {\n                  errorReporter.addError(target->startByte, target->endByte,\n                                         \"Not a valid annotation target.\");\n                }\n              }\n            }",
          "includes": [
            "#include <windows.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <kj/debug.h>",
            "#include <capnp/dynamic.h>",
            "#include \"md5.h\"",
            "#include \"parser.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <windows.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <kj/debug.h>\n#include <capnp/dynamic.h>\n#include \"md5.h\"\n#include \"parser.h\"\n\nKJ_IF_MAYBE(target, maybeTarget) {\n            if (target->value == \"*\") {\n              // Set all.\n              if (targets.value.size() > 1) {\n                errorReporter.addError(target->startByte, target->endByte,\n                    \"Wildcard should not be specified together with other targets.\");\n              }\n\n              for (auto field: dynamicBuilder.getSchema().getFields()) {\n                if (field.getProto().getName().startsWith(\"targets\")) {\n                  dynamicBuilder.set(field, true);\n                }\n              }\n            } else {\n              if (target->value.size() == 0 || target->value.size() >= 32 ||\n                  target->value[0] < 'a' || target->value[0] > 'z') {\n                errorReporter.addError(target->startByte, target->endByte,\n                                       \"Not a valid annotation target.\");\n              } else {\n                char buffer[64];\n                strcpy(buffer, \"targets\");\n                strcat(buffer, target->value.cStr());\n                buffer[strlen(\"targets\")] += 'A' - 'a';\n                KJ_IF_MAYBE(field, dynamicBuilder.getSchema().findFieldByName(buffer)) {\n                  if (dynamicBuilder.get(*field).as<bool>()) {\n                    errorReporter.addError(target->startByte, target->endByte,\n                                           \"Duplicate target specification.\");\n                  }\n                  dynamicBuilder.set(*field, true);\n                } else {\n                  errorReporter.addError(target->startByte, target->endByte,\n                                         \"Not a valid annotation target.\");\n                }\n              }\n            }"
        }
      },
      {
        "call_info": {
          "callee": "kj::runCatchingExceptions",
          "args": [
            "[&]() {\n    result = module->getCompiler().getWorkspace().bootstrapLoader.getType(type, scope);\n  }"
          ],
          "line": 939
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module->getCompiler",
          "args": [
            "type",
            "scope"
          ],
          "line": 940
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module->getCompiler",
          "args": [],
          "line": 940
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module->getCompiler",
          "args": [],
          "line": 940
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nkj::Maybe<Type> Compiler::Node::resolveBootstrapType(schema::Type::Reader type, Schema scope) {\n  // TODO(someday): Arguably should return null if the type or its dependencies are placeholders.\n\n  kj::Maybe<Type> result;\n  KJ_IF_MAYBE(exception, kj::runCatchingExceptions([&]() {\n    result = module->getCompiler().getWorkspace().bootstrapLoader.getType(type, scope);\n  })) {\n    result = nullptr;\n    if (!module->getErrorReporter().hadErrors()) {\n      addError(kj::str(\"Internal compiler bug: Bootstrap schema failed to load:\\n\",\n                       *exception));\n    }\n  }\n  return result;\n}"
  },
  {
    "function_name": "Compiler::Node::resolveImport",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "925-933",
    "snippet": "kj::Maybe<NodeTranslator::Resolver::ResolvedDecl>\nCompiler::Node::resolveImport(kj::StringPtr name) {\n  KJ_IF_MAYBE(m, module->importRelative(name)) {\n    Node& root = m->getRootNode();\n    return ResolvedDecl { root.id, 0, 0, root.kind, &root, nullptr };\n  } else {\n    return nullptr;\n  }\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m->getRootNode",
          "args": [],
          "line": 928
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_IF_MAYBE",
          "args": [
            "m",
            "module->importRelative(name)"
          ],
          "line": 927
        },
        "resolved": true,
        "details": {
          "function_name": "KJ_IF_MAYBE",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/parser.c++",
          "lines": "982-1016",
          "snippet": "KJ_IF_MAYBE(target, maybeTarget) {\n            if (target->value == \"*\") {\n              // Set all.\n              if (targets.value.size() > 1) {\n                errorReporter.addError(target->startByte, target->endByte,\n                    \"Wildcard should not be specified together with other targets.\");\n              }\n\n              for (auto field: dynamicBuilder.getSchema().getFields()) {\n                if (field.getProto().getName().startsWith(\"targets\")) {\n                  dynamicBuilder.set(field, true);\n                }\n              }\n            } else {\n              if (target->value.size() == 0 || target->value.size() >= 32 ||\n                  target->value[0] < 'a' || target->value[0] > 'z') {\n                errorReporter.addError(target->startByte, target->endByte,\n                                       \"Not a valid annotation target.\");\n              } else {\n                char buffer[64];\n                strcpy(buffer, \"targets\");\n                strcat(buffer, target->value.cStr());\n                buffer[strlen(\"targets\")] += 'A' - 'a';\n                KJ_IF_MAYBE(field, dynamicBuilder.getSchema().findFieldByName(buffer)) {\n                  if (dynamicBuilder.get(*field).as<bool>()) {\n                    errorReporter.addError(target->startByte, target->endByte,\n                                           \"Duplicate target specification.\");\n                  }\n                  dynamicBuilder.set(*field, true);\n                } else {\n                  errorReporter.addError(target->startByte, target->endByte,\n                                         \"Not a valid annotation target.\");\n                }\n              }\n            }",
          "includes": [
            "#include <windows.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <kj/debug.h>",
            "#include <capnp/dynamic.h>",
            "#include \"md5.h\"",
            "#include \"parser.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <windows.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <kj/debug.h>\n#include <capnp/dynamic.h>\n#include \"md5.h\"\n#include \"parser.h\"\n\nKJ_IF_MAYBE(target, maybeTarget) {\n            if (target->value == \"*\") {\n              // Set all.\n              if (targets.value.size() > 1) {\n                errorReporter.addError(target->startByte, target->endByte,\n                    \"Wildcard should not be specified together with other targets.\");\n              }\n\n              for (auto field: dynamicBuilder.getSchema().getFields()) {\n                if (field.getProto().getName().startsWith(\"targets\")) {\n                  dynamicBuilder.set(field, true);\n                }\n              }\n            } else {\n              if (target->value.size() == 0 || target->value.size() >= 32 ||\n                  target->value[0] < 'a' || target->value[0] > 'z') {\n                errorReporter.addError(target->startByte, target->endByte,\n                                       \"Not a valid annotation target.\");\n              } else {\n                char buffer[64];\n                strcpy(buffer, \"targets\");\n                strcat(buffer, target->value.cStr());\n                buffer[strlen(\"targets\")] += 'A' - 'a';\n                KJ_IF_MAYBE(field, dynamicBuilder.getSchema().findFieldByName(buffer)) {\n                  if (dynamicBuilder.get(*field).as<bool>()) {\n                    errorReporter.addError(target->startByte, target->endByte,\n                                           \"Duplicate target specification.\");\n                  }\n                  dynamicBuilder.set(*field, true);\n                } else {\n                  errorReporter.addError(target->startByte, target->endByte,\n                                         \"Not a valid annotation target.\");\n                }\n              }\n            }"
        }
      },
      {
        "call_info": {
          "callee": "module->importRelative",
          "args": [
            "name"
          ],
          "line": 927
        },
        "resolved": true,
        "details": {
          "function_name": "importRelative",
          "container": "ModuleImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/evolution-test.c++",
          "lines": "645-647",
          "snippet": "kj::Maybe<Module&> importRelative(kj::StringPtr importPath) override {\n    return nullptr;\n  }",
          "includes": [
            "#include <unistd.h>",
            "#include <kj/io.h>",
            "#include <kj/main.h>",
            "#include <time.h>",
            "#include <stdlib.h>",
            "#include <kj/debug.h>",
            "#include <kj/function.h>",
            "#include \"compiler.h\"",
            "#include <capnp/pretty-print.h>",
            "#include <capnp/message.h>",
            "#include <capnp/schema-loader.h>",
            "#include <capnp/compiler/grammar.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <kj/io.h>\n#include <kj/main.h>\n#include <time.h>\n#include <stdlib.h>\n#include <kj/debug.h>\n#include <kj/function.h>\n#include \"compiler.h\"\n#include <capnp/pretty-print.h>\n#include <capnp/message.h>\n#include <capnp/schema-loader.h>\n#include <capnp/compiler/grammar.capnp.h>\n\nModuleImpl {\n  kj::Maybe<Module&> importRelative(kj::StringPtr importPath) override {\n      return nullptr;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nkj::Maybe<NodeTranslator::Resolver::ResolvedDecl>\nCompiler::Node::resolveImport(kj::StringPtr name) {\n  KJ_IF_MAYBE(m, module->importRelative(name)) {\n    Node& root = m->getRootNode();\n    return ResolvedDecl { root.id, 0, 0, root.kind, &root, nullptr };\n  } else {\n    return nullptr;\n  }\n}"
  },
  {
    "function_name": "Compiler::Node::resolveFinalSchema",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "917-922",
    "snippet": "kj::Maybe<schema::Node::Reader> Compiler::Node::resolveFinalSchema(uint64_t id) {\n  KJ_IF_MAYBE(node, module->getCompiler().findNode(id)) {\n    return node->getFinalSchema();\n  } else {\n    KJ_FAIL_REQUIRE(\"Tried to get schema for ID we haven't seen before.\");\n  }",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "KJ_FAIL_REQUIRE",
          "args": [
            "\"Tried to get schema for ID we haven't seen before.\""
          ],
          "line": 921
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "node->getFinalSchema",
          "args": [],
          "line": 919
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_IF_MAYBE",
          "args": [
            "node",
            "module->getCompiler().findNode(id)"
          ],
          "line": 918
        },
        "resolved": true,
        "details": {
          "function_name": "KJ_IF_MAYBE",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/parser.c++",
          "lines": "982-1016",
          "snippet": "KJ_IF_MAYBE(target, maybeTarget) {\n            if (target->value == \"*\") {\n              // Set all.\n              if (targets.value.size() > 1) {\n                errorReporter.addError(target->startByte, target->endByte,\n                    \"Wildcard should not be specified together with other targets.\");\n              }\n\n              for (auto field: dynamicBuilder.getSchema().getFields()) {\n                if (field.getProto().getName().startsWith(\"targets\")) {\n                  dynamicBuilder.set(field, true);\n                }\n              }\n            } else {\n              if (target->value.size() == 0 || target->value.size() >= 32 ||\n                  target->value[0] < 'a' || target->value[0] > 'z') {\n                errorReporter.addError(target->startByte, target->endByte,\n                                       \"Not a valid annotation target.\");\n              } else {\n                char buffer[64];\n                strcpy(buffer, \"targets\");\n                strcat(buffer, target->value.cStr());\n                buffer[strlen(\"targets\")] += 'A' - 'a';\n                KJ_IF_MAYBE(field, dynamicBuilder.getSchema().findFieldByName(buffer)) {\n                  if (dynamicBuilder.get(*field).as<bool>()) {\n                    errorReporter.addError(target->startByte, target->endByte,\n                                           \"Duplicate target specification.\");\n                  }\n                  dynamicBuilder.set(*field, true);\n                } else {\n                  errorReporter.addError(target->startByte, target->endByte,\n                                         \"Not a valid annotation target.\");\n                }\n              }\n            }",
          "includes": [
            "#include <windows.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <kj/debug.h>",
            "#include <capnp/dynamic.h>",
            "#include \"md5.h\"",
            "#include \"parser.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <windows.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <kj/debug.h>\n#include <capnp/dynamic.h>\n#include \"md5.h\"\n#include \"parser.h\"\n\nKJ_IF_MAYBE(target, maybeTarget) {\n            if (target->value == \"*\") {\n              // Set all.\n              if (targets.value.size() > 1) {\n                errorReporter.addError(target->startByte, target->endByte,\n                    \"Wildcard should not be specified together with other targets.\");\n              }\n\n              for (auto field: dynamicBuilder.getSchema().getFields()) {\n                if (field.getProto().getName().startsWith(\"targets\")) {\n                  dynamicBuilder.set(field, true);\n                }\n              }\n            } else {\n              if (target->value.size() == 0 || target->value.size() >= 32 ||\n                  target->value[0] < 'a' || target->value[0] > 'z') {\n                errorReporter.addError(target->startByte, target->endByte,\n                                       \"Not a valid annotation target.\");\n              } else {\n                char buffer[64];\n                strcpy(buffer, \"targets\");\n                strcat(buffer, target->value.cStr());\n                buffer[strlen(\"targets\")] += 'A' - 'a';\n                KJ_IF_MAYBE(field, dynamicBuilder.getSchema().findFieldByName(buffer)) {\n                  if (dynamicBuilder.get(*field).as<bool>()) {\n                    errorReporter.addError(target->startByte, target->endByte,\n                                           \"Duplicate target specification.\");\n                  }\n                  dynamicBuilder.set(*field, true);\n                } else {\n                  errorReporter.addError(target->startByte, target->endByte,\n                                         \"Not a valid annotation target.\");\n                }\n              }\n            }"
        }
      },
      {
        "call_info": {
          "callee": "module->getCompiler",
          "args": [
            "id"
          ],
          "line": 918
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module->getCompiler",
          "args": [],
          "line": 918
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nkj::Maybe<schema::Node::Reader> Compiler::Node::resolveFinalSchema(uint64_t id) {\n  KJ_IF_MAYBE(node, module->getCompiler().findNode(id)) {\n    return node->getFinalSchema();\n  } else {\n    KJ_FAIL_REQUIRE(\"Tried to get schema for ID we haven't seen before.\");\n  }"
  },
  {
    "function_name": "Compiler::Node::resolveBootstrapSchema",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "902-914",
    "snippet": "kj::Maybe<Schema> Compiler::Node::resolveBootstrapSchema(\n    uint64_t id, schema::Brand::Reader brand) {\n  KJ_IF_MAYBE(node, module->getCompiler().findNode(id)) {\n    // Make sure the bootstrap schema is loaded into the SchemaLoader.\n    if (node->getBootstrapSchema() == nullptr) {\n      return nullptr;\n    }\n\n    // Now we actually invoke get() to evaluate the brand.\n    return module->getCompiler().getWorkspace().bootstrapLoader.get(id, brand);\n  } else {\n    KJ_FAIL_REQUIRE(\"Tried to get schema for ID we haven't seen before.\");\n  }",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "KJ_FAIL_REQUIRE",
          "args": [
            "\"Tried to get schema for ID we haven't seen before.\""
          ],
          "line": 913
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module->getCompiler",
          "args": [
            "id",
            "brand"
          ],
          "line": 911
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module->getCompiler",
          "args": [],
          "line": 911
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module->getCompiler",
          "args": [],
          "line": 911
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "node->getBootstrapSchema",
          "args": [],
          "line": 906
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_IF_MAYBE",
          "args": [
            "node",
            "module->getCompiler().findNode(id)"
          ],
          "line": 904
        },
        "resolved": true,
        "details": {
          "function_name": "KJ_IF_MAYBE",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/parser.c++",
          "lines": "982-1016",
          "snippet": "KJ_IF_MAYBE(target, maybeTarget) {\n            if (target->value == \"*\") {\n              // Set all.\n              if (targets.value.size() > 1) {\n                errorReporter.addError(target->startByte, target->endByte,\n                    \"Wildcard should not be specified together with other targets.\");\n              }\n\n              for (auto field: dynamicBuilder.getSchema().getFields()) {\n                if (field.getProto().getName().startsWith(\"targets\")) {\n                  dynamicBuilder.set(field, true);\n                }\n              }\n            } else {\n              if (target->value.size() == 0 || target->value.size() >= 32 ||\n                  target->value[0] < 'a' || target->value[0] > 'z') {\n                errorReporter.addError(target->startByte, target->endByte,\n                                       \"Not a valid annotation target.\");\n              } else {\n                char buffer[64];\n                strcpy(buffer, \"targets\");\n                strcat(buffer, target->value.cStr());\n                buffer[strlen(\"targets\")] += 'A' - 'a';\n                KJ_IF_MAYBE(field, dynamicBuilder.getSchema().findFieldByName(buffer)) {\n                  if (dynamicBuilder.get(*field).as<bool>()) {\n                    errorReporter.addError(target->startByte, target->endByte,\n                                           \"Duplicate target specification.\");\n                  }\n                  dynamicBuilder.set(*field, true);\n                } else {\n                  errorReporter.addError(target->startByte, target->endByte,\n                                         \"Not a valid annotation target.\");\n                }\n              }\n            }",
          "includes": [
            "#include <windows.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <kj/debug.h>",
            "#include <capnp/dynamic.h>",
            "#include \"md5.h\"",
            "#include \"parser.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <windows.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <kj/debug.h>\n#include <capnp/dynamic.h>\n#include \"md5.h\"\n#include \"parser.h\"\n\nKJ_IF_MAYBE(target, maybeTarget) {\n            if (target->value == \"*\") {\n              // Set all.\n              if (targets.value.size() > 1) {\n                errorReporter.addError(target->startByte, target->endByte,\n                    \"Wildcard should not be specified together with other targets.\");\n              }\n\n              for (auto field: dynamicBuilder.getSchema().getFields()) {\n                if (field.getProto().getName().startsWith(\"targets\")) {\n                  dynamicBuilder.set(field, true);\n                }\n              }\n            } else {\n              if (target->value.size() == 0 || target->value.size() >= 32 ||\n                  target->value[0] < 'a' || target->value[0] > 'z') {\n                errorReporter.addError(target->startByte, target->endByte,\n                                       \"Not a valid annotation target.\");\n              } else {\n                char buffer[64];\n                strcpy(buffer, \"targets\");\n                strcat(buffer, target->value.cStr());\n                buffer[strlen(\"targets\")] += 'A' - 'a';\n                KJ_IF_MAYBE(field, dynamicBuilder.getSchema().findFieldByName(buffer)) {\n                  if (dynamicBuilder.get(*field).as<bool>()) {\n                    errorReporter.addError(target->startByte, target->endByte,\n                                           \"Duplicate target specification.\");\n                  }\n                  dynamicBuilder.set(*field, true);\n                } else {\n                  errorReporter.addError(target->startByte, target->endByte,\n                                         \"Not a valid annotation target.\");\n                }\n              }\n            }"
        }
      },
      {
        "call_info": {
          "callee": "module->getCompiler",
          "args": [
            "id"
          ],
          "line": 904
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module->getCompiler",
          "args": [],
          "line": 904
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nkj::Maybe<Schema> Compiler::Node::resolveBootstrapSchema(\n    uint64_t id, schema::Brand::Reader brand) {\n  KJ_IF_MAYBE(node, module->getCompiler().findNode(id)) {\n    // Make sure the bootstrap schema is loaded into the SchemaLoader.\n    if (node->getBootstrapSchema() == nullptr) {\n      return nullptr;\n    }\n\n    // Now we actually invoke get() to evaluate the brand.\n    return module->getCompiler().getWorkspace().bootstrapLoader.get(id, brand);\n  } else {\n    KJ_FAIL_REQUIRE(\"Tried to get schema for ID we haven't seen before.\");\n  }"
  },
  {
    "function_name": "Compiler::Node::getTopScope",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "897-900",
    "snippet": "NodeTranslator::Resolver::ResolvedDecl Compiler::Node::getTopScope() {\n  Node& node = module->getRootNode();\n  return ResolvedDecl { node.id, 0, 0, node.kind, &node, nullptr };\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "module->getRootNode",
          "args": [],
          "line": 898
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nNodeTranslator::Resolver::ResolvedDecl Compiler::Node::getTopScope() {\n  Node& node = module->getRootNode();\n  return ResolvedDecl { node.id, 0, 0, node.kind, &node, nullptr };\n}"
  },
  {
    "function_name": "Compiler::Node::getParent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "890-895",
    "snippet": "kj::Maybe<NodeTranslator::Resolver::ResolvedDecl> Compiler::Node::getParent() {\n  return parent.map([](Node& parent) {\n    uint64_t scopeId = parent.parent.map([](Node& gp) { return gp.id; }).orDefault(0);\n    return ResolvedDecl { parent.id, parent.genericParamCount, scopeId, parent.kind, &parent, nullptr };\n  });\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "parent.map",
          "args": [
            "[](Node& parent) {\n    uint64_t scopeId = parent.parent.map([](Node& gp) { return gp.id; }).orDefault(0);\n    return ResolvedDecl { parent.id, parent.genericParamCount, scopeId, parent.kind, &parent, nullptr };\n  }"
          ],
          "line": 891
        },
        "resolved": true,
        "details": {
          "function_name": "map",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "1083-1089",
          "snippet": "auto map(Func&& f) -> Maybe<decltype(f(instance<T&>()))> {\n    if (ptr == nullptr) {\n      return nullptr;\n    } else {\n      return f(*ptr);\n    }\n  }",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\nauto map(Func&& f) -> Maybe<decltype(f(instance<T&>()))> {\n    if (ptr == nullptr) {\n      return nullptr;\n    } else {\n      return f(*ptr);\n    }\n  }"
        }
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nkj::Maybe<NodeTranslator::Resolver::ResolvedDecl> Compiler::Node::getParent() {\n  return parent.map([](Node& parent) {\n    uint64_t scopeId = parent.parent.map([](Node& gp) { return gp.id; }).orDefault(0);\n    return ResolvedDecl { parent.id, parent.genericParamCount, scopeId, parent.kind, &parent, nullptr };\n  });\n}"
  },
  {
    "function_name": "Compiler::Node::resolveId",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "884-888",
    "snippet": "NodeTranslator::Resolver::ResolvedDecl Compiler::Node::resolveId(uint64_t id) {\n  auto& n = KJ_ASSERT_NONNULL(module->getCompiler().findNode(id));\n  uint64_t parentId = n.parent.map([](Node& n) { return n.id; }).orDefault(0);\n  return { n.id, n.genericParamCount, parentId, n.kind, &n, nullptr };\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "n.parent.map",
          "args": [
            "0"
          ],
          "line": 886
        },
        "resolved": true,
        "details": {
          "function_name": "map",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "1083-1089",
          "snippet": "auto map(Func&& f) -> Maybe<decltype(f(instance<T&>()))> {\n    if (ptr == nullptr) {\n      return nullptr;\n    } else {\n      return f(*ptr);\n    }\n  }",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\nauto map(Func&& f) -> Maybe<decltype(f(instance<T&>()))> {\n    if (ptr == nullptr) {\n      return nullptr;\n    } else {\n      return f(*ptr);\n    }\n  }"
        }
      },
      {
        "call_info": {
          "callee": "KJ_ASSERT_NONNULL",
          "args": [
            "module->getCompiler().findNode(id)"
          ],
          "line": 885
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module->getCompiler",
          "args": [
            "id"
          ],
          "line": 885
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module->getCompiler",
          "args": [],
          "line": 885
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nNodeTranslator::Resolver::ResolvedDecl Compiler::Node::resolveId(uint64_t id) {\n  auto& n = KJ_ASSERT_NONNULL(module->getCompiler().findNode(id));\n  uint64_t parentId = n.parent.map([](Node& n) { return n.id; }).orDefault(0);\n  return { n.id, n.genericParamCount, parentId, n.kind, &n, nullptr };\n}"
  },
  {
    "function_name": "Compiler::Node::resolveBuiltin",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "879-882",
    "snippet": "NodeTranslator::Resolver::ResolvedDecl Compiler::Node::resolveBuiltin(Declaration::Which which) {\n  auto& b = module->getCompiler().getBuiltin(which);\n  return { b.id, b.genericParamCount, 0, b.kind, &b, nullptr };\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "module->getCompiler",
          "args": [
            "which"
          ],
          "line": 880
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module->getCompiler",
          "args": [],
          "line": 880
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nNodeTranslator::Resolver::ResolvedDecl Compiler::Node::resolveBuiltin(Declaration::Which which) {\n  auto& b = module->getCompiler().getBuiltin(which);\n  return { b.id, b.genericParamCount, 0, b.kind, &b, nullptr };\n}"
  },
  {
    "function_name": "Compiler::Node::resolveMember",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "854-877",
    "snippet": "kj::Maybe<NodeTranslator::Resolver::ResolveResult>\nCompiler::Node::resolveMember(kj::StringPtr name) {\n  if (isBuiltin) return nullptr;\n\n  KJ_IF_MAYBE(content, getContent(Content::EXPANDED)) {\n    {\n      auto iter = content->nestedNodes.find(name);\n      if (iter != content->nestedNodes.end()) {\n        Node* node = iter->second;\n        ResolveResult result;\n        result.init<ResolvedDecl>(ResolvedDecl {\n            node->id, node->genericParamCount, id, node->kind, node, nullptr });\n        return result;\n      }\n    }\n    {\n      auto iter = content->aliases.find(name);\n      if (iter != content->aliases.end()) {\n        return iter->second->compile();\n      }\n    }\n  }\n  return nullptr;\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "iter->second->compile",
          "args": [],
          "line": 872
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "content->aliases.end",
          "args": [],
          "line": 871
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-capnp.c++",
          "lines": "77-77",
          "snippet": "inline Iterator end() const { return Iterator(amount); }",
          "includes": [
            "#include \"config.h\"",
            "#include <map>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <map>\n#include <algorithm>\n#include <kj/main.h>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nIndent {\n  inline Iterator end() const { return Iterator(amount); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "content->aliases.find",
          "args": [
            "name"
          ],
          "line": 870
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "ImportTable",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "191-202",
          "snippet": "kj::Maybe<T&> find(Id id) {\n    if (id < kj::size(low)) {\n      return low[id];\n    } else {\n      auto iter = high.find(id);\n      if (iter == high.end()) {\n        return nullptr;\n      } else {\n        return iter->second;\n      }\n    }\n  }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nImportTable {\n  kj::Maybe<T&> find(Id id) {\n      if (id < kj::size(low)) {\n        return low[id];\n      } else {\n        auto iter = high.find(id);\n        if (iter == high.end()) {\n          return nullptr;\n        } else {\n          return iter->second;\n        }\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "result.init<ResolvedDecl>",
          "args": [
            "ResolvedDecl {\n            node->id, node->genericParamCount, id, node->kind, node, nullptr }"
          ],
          "line": 864
        },
        "resolved": true,
        "details": {
          "function_name": "init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/pointer-helpers.h",
          "lines": "51-53",
          "snippet": "static inline typename T::Builder init(PointerBuilder builder) {\n    return typename T::Builder(builder.initStruct(structSize<T>()));\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"layout.h\"\n\nstatic inline typename T::Builder init(PointerBuilder builder) {\n    return typename T::Builder(builder.initStruct(structSize<T>()));\n  }"
        }
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nkj::Maybe<NodeTranslator::Resolver::ResolveResult>\nCompiler::Node::resolveMember(kj::StringPtr name) {\n  if (isBuiltin) return nullptr;\n\n  KJ_IF_MAYBE(content, getContent(Content::EXPANDED)) {\n    {\n      auto iter = content->nestedNodes.find(name);\n      if (iter != content->nestedNodes.end()) {\n        Node* node = iter->second;\n        ResolveResult result;\n        result.init<ResolvedDecl>(ResolvedDecl {\n            node->id, node->genericParamCount, id, node->kind, node, nullptr });\n        return result;\n      }\n    }\n    {\n      auto iter = content->aliases.find(name);\n      if (iter != content->aliases.end()) {\n        return iter->second->compile();\n      }\n    }\n  }\n  return nullptr;\n}"
  },
  {
    "function_name": "Compiler::Node::resolve",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "824-852",
    "snippet": "kj::Maybe<NodeTranslator::Resolver::ResolveResult>\nCompiler::Node::resolve(kj::StringPtr name) {\n  // Check members.\n  KJ_IF_MAYBE(member, resolveMember(name)) {\n    return *member;\n  }\n\n  // Check parameters.\n  // TODO(perf): Maintain a map?\n  auto params = declaration.getParameters();\n  for (uint i: kj::indices(params)) {\n    if (params[i].getName() == name) {\n      ResolveResult result;\n      result.init<ResolvedParameter>(ResolvedParameter {id, i});\n      return result;\n    }\n  }\n\n  // Check parent scope.\n  KJ_IF_MAYBE(p, parent) {\n    return p->resolve(name);\n  } else KJ_IF_MAYBE(b, module->getCompiler().lookupBuiltin(name)) {\n    ResolveResult result;\n    result.init<ResolvedDecl>(ResolvedDecl { b->id, b->genericParamCount, 0, b->kind, b, nullptr });\n    return result;\n  } else {\n    return nullptr;\n  }\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "result.init<ResolvedDecl>",
          "args": [
            "ResolvedDecl { b->id, b->genericParamCount, 0, b->kind, b, nullptr }"
          ],
          "line": 847
        },
        "resolved": true,
        "details": {
          "function_name": "init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/pointer-helpers.h",
          "lines": "51-53",
          "snippet": "static inline typename T::Builder init(PointerBuilder builder) {\n    return typename T::Builder(builder.initStruct(structSize<T>()));\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"layout.h\"\n\nstatic inline typename T::Builder init(PointerBuilder builder) {\n    return typename T::Builder(builder.initStruct(structSize<T>()));\n  }"
        }
      },
      {
        "call_info": {
          "callee": "module->getCompiler",
          "args": [
            "name"
          ],
          "line": 845
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module->getCompiler",
          "args": [],
          "line": 845
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p->resolve",
          "args": [
            "name"
          ],
          "line": 844
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "params[i].getName",
          "args": [],
          "line": 835
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::indices",
          "args": [
            "params"
          ],
          "line": 834
        },
        "resolved": true,
        "details": {
          "function_name": "indices",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "650-656",
          "snippet": "inline constexpr Range<size_t> indices(T&& container) {\n  // Shortcut for iterating over the indices of a container:\n  //\n  //     for (size_t i: kj::indices(myArray)) { handle(myArray[i]); }\n\n  return range<size_t>(0, kj::size(container));\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\ninline constexpr Range<size_t> indices(T&& container) {\n  // Shortcut for iterating over the indices of a container:\n  //\n  //     for (size_t i: kj::indices(myArray)) { handle(myArray[i]); }\n\n  return range<size_t>(0, kj::size(container));\n}"
        }
      },
      {
        "call_info": {
          "callee": "declaration.getParameters",
          "args": [],
          "line": 833
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nkj::Maybe<NodeTranslator::Resolver::ResolveResult>\nCompiler::Node::resolve(kj::StringPtr name) {\n  // Check members.\n  KJ_IF_MAYBE(member, resolveMember(name)) {\n    return *member;\n  }\n\n  // Check parameters.\n  // TODO(perf): Maintain a map?\n  auto params = declaration.getParameters();\n  for (uint i: kj::indices(params)) {\n    if (params[i].getName() == name) {\n      ResolveResult result;\n      result.init<ResolvedParameter>(ResolvedParameter {id, i});\n      return result;\n    }\n  }\n\n  // Check parent scope.\n  KJ_IF_MAYBE(p, parent) {\n    return p->resolve(name);\n  } else KJ_IF_MAYBE(b, module->getCompiler().lookupBuiltin(name)) {\n    ResolveResult result;\n    result.init<ResolvedDecl>(ResolvedDecl { b->id, b->genericParamCount, 0, b->kind, b, nullptr });\n    return result;\n  } else {\n    return nullptr;\n  }\n}"
  },
  {
    "function_name": "Compiler::Node::addError",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "820-822",
    "snippet": "void Compiler::Node::addError(kj::StringPtr error) {\n  module->getErrorReporter().addError(startByte, endByte, error);\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "module->getErrorReporter",
          "args": [
            "startByte",
            "endByte",
            "error"
          ],
          "line": 821
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module->getErrorReporter",
          "args": [],
          "line": 821
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nvoid Compiler::Node::addError(kj::StringPtr error) {\n  module->getErrorReporter().addError(startByte, endByte, error);\n}"
  },
  {
    "function_name": "Compiler::Node::traverseAnnotations",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "808-817",
    "snippet": "void Compiler::Node::traverseAnnotations(const List<schema::Annotation>::Reader& annotations,\n                                         uint eagerness,\n                                         std::unordered_map<Node*, uint>& seen,\n                                         const SchemaLoader& finalLoader) {\n  for (auto annotation: annotations) {\n    KJ_IF_MAYBE(node, module->getCompiler().findNode(annotation.getId())) {\n      node->traverse(eagerness, seen, finalLoader);\n    }\n  }\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "node->traverse",
          "args": [
            "eagerness",
            "seen",
            "finalLoader"
          ],
          "line": 814
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_IF_MAYBE",
          "args": [
            "node",
            "module->getCompiler().findNode(annotation.getId())"
          ],
          "line": 813
        },
        "resolved": true,
        "details": {
          "function_name": "KJ_IF_MAYBE",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/parser.c++",
          "lines": "982-1016",
          "snippet": "KJ_IF_MAYBE(target, maybeTarget) {\n            if (target->value == \"*\") {\n              // Set all.\n              if (targets.value.size() > 1) {\n                errorReporter.addError(target->startByte, target->endByte,\n                    \"Wildcard should not be specified together with other targets.\");\n              }\n\n              for (auto field: dynamicBuilder.getSchema().getFields()) {\n                if (field.getProto().getName().startsWith(\"targets\")) {\n                  dynamicBuilder.set(field, true);\n                }\n              }\n            } else {\n              if (target->value.size() == 0 || target->value.size() >= 32 ||\n                  target->value[0] < 'a' || target->value[0] > 'z') {\n                errorReporter.addError(target->startByte, target->endByte,\n                                       \"Not a valid annotation target.\");\n              } else {\n                char buffer[64];\n                strcpy(buffer, \"targets\");\n                strcat(buffer, target->value.cStr());\n                buffer[strlen(\"targets\")] += 'A' - 'a';\n                KJ_IF_MAYBE(field, dynamicBuilder.getSchema().findFieldByName(buffer)) {\n                  if (dynamicBuilder.get(*field).as<bool>()) {\n                    errorReporter.addError(target->startByte, target->endByte,\n                                           \"Duplicate target specification.\");\n                  }\n                  dynamicBuilder.set(*field, true);\n                } else {\n                  errorReporter.addError(target->startByte, target->endByte,\n                                         \"Not a valid annotation target.\");\n                }\n              }\n            }",
          "includes": [
            "#include <windows.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <kj/debug.h>",
            "#include <capnp/dynamic.h>",
            "#include \"md5.h\"",
            "#include \"parser.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <windows.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <kj/debug.h>\n#include <capnp/dynamic.h>\n#include \"md5.h\"\n#include \"parser.h\"\n\nKJ_IF_MAYBE(target, maybeTarget) {\n            if (target->value == \"*\") {\n              // Set all.\n              if (targets.value.size() > 1) {\n                errorReporter.addError(target->startByte, target->endByte,\n                    \"Wildcard should not be specified together with other targets.\");\n              }\n\n              for (auto field: dynamicBuilder.getSchema().getFields()) {\n                if (field.getProto().getName().startsWith(\"targets\")) {\n                  dynamicBuilder.set(field, true);\n                }\n              }\n            } else {\n              if (target->value.size() == 0 || target->value.size() >= 32 ||\n                  target->value[0] < 'a' || target->value[0] > 'z') {\n                errorReporter.addError(target->startByte, target->endByte,\n                                       \"Not a valid annotation target.\");\n              } else {\n                char buffer[64];\n                strcpy(buffer, \"targets\");\n                strcat(buffer, target->value.cStr());\n                buffer[strlen(\"targets\")] += 'A' - 'a';\n                KJ_IF_MAYBE(field, dynamicBuilder.getSchema().findFieldByName(buffer)) {\n                  if (dynamicBuilder.get(*field).as<bool>()) {\n                    errorReporter.addError(target->startByte, target->endByte,\n                                           \"Duplicate target specification.\");\n                  }\n                  dynamicBuilder.set(*field, true);\n                } else {\n                  errorReporter.addError(target->startByte, target->endByte,\n                                         \"Not a valid annotation target.\");\n                }\n              }\n            }"
        }
      },
      {
        "call_info": {
          "callee": "module->getCompiler",
          "args": [
            "annotation.getId()"
          ],
          "line": 813
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "annotation.getId",
          "args": [],
          "line": 813
        },
        "resolved": true,
        "details": {
          "function_name": "getId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
          "lines": "75-75",
          "snippet": "uint64_t getId() { return id; }",
          "includes": [
            "#include \"md5.h\"",
            "#include \"node-translator.h\"",
            "#include <unordered_map>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/message.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/arena.h>",
            "#include <kj/mutex.h>",
            "#include \"parser.h\"      // only for generateChildId()",
            "#include \"compiler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nuint64_t getId() { return id; }"
        }
      },
      {
        "call_info": {
          "callee": "module->getCompiler",
          "args": [],
          "line": 813
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nvoid Compiler::Node::traverseAnnotations(const List<schema::Annotation>::Reader& annotations,\n                                         uint eagerness,\n                                         std::unordered_map<Node*, uint>& seen,\n                                         const SchemaLoader& finalLoader) {\n  for (auto annotation: annotations) {\n    KJ_IF_MAYBE(node, module->getCompiler().findNode(annotation.getId())) {\n      node->traverse(eagerness, seen, finalLoader);\n    }\n  }\n}"
  },
  {
    "function_name": "Compiler::Node::traverseDependency",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "797-806",
    "snippet": "void Compiler::Node::traverseDependency(uint64_t depId, uint eagerness,\n                                        std::unordered_map<Node*, uint>& seen,\n                                        const SchemaLoader& finalLoader,\n                                        bool ignoreIfNotFound) {\n  KJ_IF_MAYBE(node, module->getCompiler().findNode(depId)) {\n    node->traverse(eagerness, seen, finalLoader);\n  } else if (!ignoreIfNotFound) {\n    KJ_FAIL_ASSERT(\"Dependency ID not present in compiler?\", depId);\n  }\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "KJ_FAIL_ASSERT",
          "args": [
            "\"Dependency ID not present in compiler?\"",
            "depId"
          ],
          "line": 804
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "node->traverse",
          "args": [
            "eagerness",
            "seen",
            "finalLoader"
          ],
          "line": 802
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_IF_MAYBE",
          "args": [
            "node",
            "module->getCompiler().findNode(depId)"
          ],
          "line": 801
        },
        "resolved": true,
        "details": {
          "function_name": "KJ_IF_MAYBE",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/parser.c++",
          "lines": "982-1016",
          "snippet": "KJ_IF_MAYBE(target, maybeTarget) {\n            if (target->value == \"*\") {\n              // Set all.\n              if (targets.value.size() > 1) {\n                errorReporter.addError(target->startByte, target->endByte,\n                    \"Wildcard should not be specified together with other targets.\");\n              }\n\n              for (auto field: dynamicBuilder.getSchema().getFields()) {\n                if (field.getProto().getName().startsWith(\"targets\")) {\n                  dynamicBuilder.set(field, true);\n                }\n              }\n            } else {\n              if (target->value.size() == 0 || target->value.size() >= 32 ||\n                  target->value[0] < 'a' || target->value[0] > 'z') {\n                errorReporter.addError(target->startByte, target->endByte,\n                                       \"Not a valid annotation target.\");\n              } else {\n                char buffer[64];\n                strcpy(buffer, \"targets\");\n                strcat(buffer, target->value.cStr());\n                buffer[strlen(\"targets\")] += 'A' - 'a';\n                KJ_IF_MAYBE(field, dynamicBuilder.getSchema().findFieldByName(buffer)) {\n                  if (dynamicBuilder.get(*field).as<bool>()) {\n                    errorReporter.addError(target->startByte, target->endByte,\n                                           \"Duplicate target specification.\");\n                  }\n                  dynamicBuilder.set(*field, true);\n                } else {\n                  errorReporter.addError(target->startByte, target->endByte,\n                                         \"Not a valid annotation target.\");\n                }\n              }\n            }",
          "includes": [
            "#include <windows.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <kj/debug.h>",
            "#include <capnp/dynamic.h>",
            "#include \"md5.h\"",
            "#include \"parser.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <windows.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <kj/debug.h>\n#include <capnp/dynamic.h>\n#include \"md5.h\"\n#include \"parser.h\"\n\nKJ_IF_MAYBE(target, maybeTarget) {\n            if (target->value == \"*\") {\n              // Set all.\n              if (targets.value.size() > 1) {\n                errorReporter.addError(target->startByte, target->endByte,\n                    \"Wildcard should not be specified together with other targets.\");\n              }\n\n              for (auto field: dynamicBuilder.getSchema().getFields()) {\n                if (field.getProto().getName().startsWith(\"targets\")) {\n                  dynamicBuilder.set(field, true);\n                }\n              }\n            } else {\n              if (target->value.size() == 0 || target->value.size() >= 32 ||\n                  target->value[0] < 'a' || target->value[0] > 'z') {\n                errorReporter.addError(target->startByte, target->endByte,\n                                       \"Not a valid annotation target.\");\n              } else {\n                char buffer[64];\n                strcpy(buffer, \"targets\");\n                strcat(buffer, target->value.cStr());\n                buffer[strlen(\"targets\")] += 'A' - 'a';\n                KJ_IF_MAYBE(field, dynamicBuilder.getSchema().findFieldByName(buffer)) {\n                  if (dynamicBuilder.get(*field).as<bool>()) {\n                    errorReporter.addError(target->startByte, target->endByte,\n                                           \"Duplicate target specification.\");\n                  }\n                  dynamicBuilder.set(*field, true);\n                } else {\n                  errorReporter.addError(target->startByte, target->endByte,\n                                         \"Not a valid annotation target.\");\n                }\n              }\n            }"
        }
      },
      {
        "call_info": {
          "callee": "module->getCompiler",
          "args": [
            "depId"
          ],
          "line": 801
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module->getCompiler",
          "args": [],
          "line": 801
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nvoid Compiler::Node::traverseDependency(uint64_t depId, uint eagerness,\n                                        std::unordered_map<Node*, uint>& seen,\n                                        const SchemaLoader& finalLoader,\n                                        bool ignoreIfNotFound) {\n  KJ_IF_MAYBE(node, module->getCompiler().findNode(depId)) {\n    node->traverse(eagerness, seen, finalLoader);\n  } else if (!ignoreIfNotFound) {\n    KJ_FAIL_ASSERT(\"Dependency ID not present in compiler?\", depId);\n  }\n}"
  },
  {
    "function_name": "Compiler::Node::traverseBrand",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "774-795",
    "snippet": "void Compiler::Node::traverseBrand(\n    const schema::Brand::Reader& brand, uint eagerness,\n    std::unordered_map<Node*, uint>& seen,\n    const SchemaLoader& finalLoader) {\n  for (auto scope: brand.getScopes()) {\n    switch (scope.which()) {\n      case schema::Brand::Scope::BIND:\n        for (auto binding: scope.getBind()) {\n          switch (binding.which()) {\n            case schema::Brand::Binding::UNBOUND:\n              break;\n            case schema::Brand::Binding::TYPE:\n              traverseType(binding.getType(), eagerness, seen, finalLoader);\n              break;\n          }\n        }\n        break;\n      case schema::Brand::Scope::INHERIT:\n        break;\n    }\n  }\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "traverseType",
          "args": [
            "binding.getType()",
            "eagerness",
            "seen",
            "finalLoader"
          ],
          "line": 786
        },
        "resolved": true,
        "details": {
          "function_name": "Compiler::Node::traverseType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
          "lines": "745-772",
          "snippet": "void Compiler::Node::traverseType(const schema::Type::Reader& type, uint eagerness,\n                                  std::unordered_map<Node*, uint>& seen,\n                                  const SchemaLoader& finalLoader) {\n  uint64_t id = 0;\n  schema::Brand::Reader brand;\n  switch (type.which()) {\n    case schema::Type::STRUCT:\n      id = type.getStruct().getTypeId();\n      brand = type.getStruct().getBrand();\n      break;\n    case schema::Type::ENUM:\n      id = type.getEnum().getTypeId();\n      brand = type.getEnum().getBrand();\n      break;\n    case schema::Type::INTERFACE:\n      id = type.getInterface().getTypeId();\n      brand = type.getInterface().getBrand();\n      break;\n    case schema::Type::LIST:\n      traverseType(type.getList().getElementType(), eagerness, seen, finalLoader);\n      return;\n    default:\n      return;\n  }\n\n  traverseDependency(id, eagerness, seen, finalLoader);\n  traverseBrand(brand, eagerness, seen, finalLoader);\n}",
          "includes": [
            "#include \"md5.h\"",
            "#include \"node-translator.h\"",
            "#include <unordered_map>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/message.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/arena.h>",
            "#include <kj/mutex.h>",
            "#include \"parser.h\"      // only for generateChildId()",
            "#include \"compiler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nvoid Compiler::Node::traverseType(const schema::Type::Reader& type, uint eagerness,\n                                  std::unordered_map<Node*, uint>& seen,\n                                  const SchemaLoader& finalLoader) {\n  uint64_t id = 0;\n  schema::Brand::Reader brand;\n  switch (type.which()) {\n    case schema::Type::STRUCT:\n      id = type.getStruct().getTypeId();\n      brand = type.getStruct().getBrand();\n      break;\n    case schema::Type::ENUM:\n      id = type.getEnum().getTypeId();\n      brand = type.getEnum().getBrand();\n      break;\n    case schema::Type::INTERFACE:\n      id = type.getInterface().getTypeId();\n      brand = type.getInterface().getBrand();\n      break;\n    case schema::Type::LIST:\n      traverseType(type.getList().getElementType(), eagerness, seen, finalLoader);\n      return;\n    default:\n      return;\n  }\n\n  traverseDependency(id, eagerness, seen, finalLoader);\n  traverseBrand(brand, eagerness, seen, finalLoader);\n}"
        }
      },
      {
        "call_info": {
          "callee": "binding.getType",
          "args": [],
          "line": 786
        },
        "resolved": true,
        "details": {
          "function_name": "getType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "942-942",
          "snippet": "inline DynamicValue::Type getType() { return type; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline DynamicValue::Type getType() { return type; }"
        }
      },
      {
        "call_info": {
          "callee": "binding.which",
          "args": [],
          "line": 782
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scope.getBind",
          "args": [],
          "line": 781
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scope.which",
          "args": [],
          "line": 779
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "brand.getScopes",
          "args": [],
          "line": 778
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nvoid Compiler::Node::traverseBrand(\n    const schema::Brand::Reader& brand, uint eagerness,\n    std::unordered_map<Node*, uint>& seen,\n    const SchemaLoader& finalLoader) {\n  for (auto scope: brand.getScopes()) {\n    switch (scope.which()) {\n      case schema::Brand::Scope::BIND:\n        for (auto binding: scope.getBind()) {\n          switch (binding.which()) {\n            case schema::Brand::Binding::UNBOUND:\n              break;\n            case schema::Brand::Binding::TYPE:\n              traverseType(binding.getType(), eagerness, seen, finalLoader);\n              break;\n          }\n        }\n        break;\n      case schema::Brand::Scope::INHERIT:\n        break;\n    }\n  }\n}"
  },
  {
    "function_name": "Compiler::Node::traverseType",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "745-772",
    "snippet": "void Compiler::Node::traverseType(const schema::Type::Reader& type, uint eagerness,\n                                  std::unordered_map<Node*, uint>& seen,\n                                  const SchemaLoader& finalLoader) {\n  uint64_t id = 0;\n  schema::Brand::Reader brand;\n  switch (type.which()) {\n    case schema::Type::STRUCT:\n      id = type.getStruct().getTypeId();\n      brand = type.getStruct().getBrand();\n      break;\n    case schema::Type::ENUM:\n      id = type.getEnum().getTypeId();\n      brand = type.getEnum().getBrand();\n      break;\n    case schema::Type::INTERFACE:\n      id = type.getInterface().getTypeId();\n      brand = type.getInterface().getBrand();\n      break;\n    case schema::Type::LIST:\n      traverseType(type.getList().getElementType(), eagerness, seen, finalLoader);\n      return;\n    default:\n      return;\n  }\n\n  traverseDependency(id, eagerness, seen, finalLoader);\n  traverseBrand(brand, eagerness, seen, finalLoader);\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "traverseBrand",
          "args": [
            "brand",
            "eagerness",
            "seen",
            "finalLoader"
          ],
          "line": 771
        },
        "resolved": true,
        "details": {
          "function_name": "Compiler::Node::traverseBrand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
          "lines": "774-795",
          "snippet": "void Compiler::Node::traverseBrand(\n    const schema::Brand::Reader& brand, uint eagerness,\n    std::unordered_map<Node*, uint>& seen,\n    const SchemaLoader& finalLoader) {\n  for (auto scope: brand.getScopes()) {\n    switch (scope.which()) {\n      case schema::Brand::Scope::BIND:\n        for (auto binding: scope.getBind()) {\n          switch (binding.which()) {\n            case schema::Brand::Binding::UNBOUND:\n              break;\n            case schema::Brand::Binding::TYPE:\n              traverseType(binding.getType(), eagerness, seen, finalLoader);\n              break;\n          }\n        }\n        break;\n      case schema::Brand::Scope::INHERIT:\n        break;\n    }\n  }\n}",
          "includes": [
            "#include \"md5.h\"",
            "#include \"node-translator.h\"",
            "#include <unordered_map>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/message.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/arena.h>",
            "#include <kj/mutex.h>",
            "#include \"parser.h\"      // only for generateChildId()",
            "#include \"compiler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nvoid Compiler::Node::traverseBrand(\n    const schema::Brand::Reader& brand, uint eagerness,\n    std::unordered_map<Node*, uint>& seen,\n    const SchemaLoader& finalLoader) {\n  for (auto scope: brand.getScopes()) {\n    switch (scope.which()) {\n      case schema::Brand::Scope::BIND:\n        for (auto binding: scope.getBind()) {\n          switch (binding.which()) {\n            case schema::Brand::Binding::UNBOUND:\n              break;\n            case schema::Brand::Binding::TYPE:\n              traverseType(binding.getType(), eagerness, seen, finalLoader);\n              break;\n          }\n        }\n        break;\n      case schema::Brand::Scope::INHERIT:\n        break;\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "traverseDependency",
          "args": [
            "id",
            "eagerness",
            "seen",
            "finalLoader"
          ],
          "line": 770
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.getList",
          "args": [],
          "line": 764
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.getList",
          "args": [],
          "line": 764
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.getInterface",
          "args": [],
          "line": 761
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.getInterface",
          "args": [],
          "line": 761
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.getInterface",
          "args": [],
          "line": 760
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.getInterface",
          "args": [],
          "line": 760
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.getEnum",
          "args": [],
          "line": 757
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.getEnum",
          "args": [],
          "line": 757
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.getEnum",
          "args": [],
          "line": 756
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.getEnum",
          "args": [],
          "line": 756
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.getStruct",
          "args": [],
          "line": 753
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.getStruct",
          "args": [],
          "line": 753
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.getStruct",
          "args": [],
          "line": 752
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.getStruct",
          "args": [],
          "line": 752
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.which",
          "args": [],
          "line": 750
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nvoid Compiler::Node::traverseType(const schema::Type::Reader& type, uint eagerness,\n                                  std::unordered_map<Node*, uint>& seen,\n                                  const SchemaLoader& finalLoader) {\n  uint64_t id = 0;\n  schema::Brand::Reader brand;\n  switch (type.which()) {\n    case schema::Type::STRUCT:\n      id = type.getStruct().getTypeId();\n      brand = type.getStruct().getBrand();\n      break;\n    case schema::Type::ENUM:\n      id = type.getEnum().getTypeId();\n      brand = type.getEnum().getBrand();\n      break;\n    case schema::Type::INTERFACE:\n      id = type.getInterface().getTypeId();\n      brand = type.getInterface().getBrand();\n      break;\n    case schema::Type::LIST:\n      traverseType(type.getList().getElementType(), eagerness, seen, finalLoader);\n      return;\n    default:\n      return;\n  }\n\n  traverseDependency(id, eagerness, seen, finalLoader);\n  traverseBrand(brand, eagerness, seen, finalLoader);\n}"
  },
  {
    "function_name": "Compiler::Node::traverseNodeDependencies",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "685-743",
    "snippet": "void Compiler::Node::traverseNodeDependencies(\n    const schema::Node::Reader& schemaNode, uint eagerness,\n    std::unordered_map<Node*, uint>& seen,\n    const SchemaLoader& finalLoader) {\n  switch (schemaNode.which()) {\n    case schema::Node::STRUCT:\n      for (auto field: schemaNode.getStruct().getFields()) {\n        switch (field.which()) {\n          case schema::Field::SLOT:\n            traverseType(field.getSlot().getType(), eagerness, seen, finalLoader);\n            break;\n          case schema::Field::GROUP:\n            // Aux node will be scanned later.\n            break;\n        }\n\n        traverseAnnotations(field.getAnnotations(), eagerness, seen, finalLoader);\n      }\n      break;\n\n    case schema::Node::ENUM:\n      for (auto enumerant: schemaNode.getEnum().getEnumerants()) {\n        traverseAnnotations(enumerant.getAnnotations(), eagerness, seen, finalLoader);\n      }\n      break;\n\n    case schema::Node::INTERFACE: {\n      auto interface = schemaNode.getInterface();\n      for (auto superclass: interface.getSuperclasses()) {\n        uint64_t superclassId = superclass.getId();\n        if (superclassId != 0) {  // if zero, we reported an error earlier\n          traverseDependency(superclassId, eagerness, seen, finalLoader);\n        }\n        traverseBrand(superclass.getBrand(), eagerness, seen, finalLoader);\n      }\n      for (auto method: interface.getMethods()) {\n        traverseDependency(method.getParamStructType(), eagerness, seen, finalLoader, true);\n        traverseBrand(method.getParamBrand(), eagerness, seen, finalLoader);\n        traverseDependency(method.getResultStructType(), eagerness, seen, finalLoader, true);\n        traverseBrand(method.getResultBrand(), eagerness, seen, finalLoader);\n        traverseAnnotations(method.getAnnotations(), eagerness, seen, finalLoader);\n      }\n      break;\n    }\n\n    case schema::Node::CONST:\n      traverseType(schemaNode.getConst().getType(), eagerness, seen, finalLoader);\n      break;\n\n    case schema::Node::ANNOTATION:\n      traverseType(schemaNode.getAnnotation().getType(), eagerness, seen, finalLoader);\n      break;\n\n    default:\n      break;\n  }\n\n  traverseAnnotations(schemaNode.getAnnotations(), eagerness, seen, finalLoader);\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "traverseAnnotations",
          "args": [
            "schemaNode.getAnnotations()",
            "eagerness",
            "seen",
            "finalLoader"
          ],
          "line": 742
        },
        "resolved": true,
        "details": {
          "function_name": "Compiler::Node::traverseAnnotations",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
          "lines": "808-817",
          "snippet": "void Compiler::Node::traverseAnnotations(const List<schema::Annotation>::Reader& annotations,\n                                         uint eagerness,\n                                         std::unordered_map<Node*, uint>& seen,\n                                         const SchemaLoader& finalLoader) {\n  for (auto annotation: annotations) {\n    KJ_IF_MAYBE(node, module->getCompiler().findNode(annotation.getId())) {\n      node->traverse(eagerness, seen, finalLoader);\n    }\n  }\n}",
          "includes": [
            "#include \"md5.h\"",
            "#include \"node-translator.h\"",
            "#include <unordered_map>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/message.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/arena.h>",
            "#include <kj/mutex.h>",
            "#include \"parser.h\"      // only for generateChildId()",
            "#include \"compiler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nvoid Compiler::Node::traverseAnnotations(const List<schema::Annotation>::Reader& annotations,\n                                         uint eagerness,\n                                         std::unordered_map<Node*, uint>& seen,\n                                         const SchemaLoader& finalLoader) {\n  for (auto annotation: annotations) {\n    KJ_IF_MAYBE(node, module->getCompiler().findNode(annotation.getId())) {\n      node->traverse(eagerness, seen, finalLoader);\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "schemaNode.getAnnotations",
          "args": [],
          "line": 742
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "traverseType",
          "args": [
            "schemaNode.getAnnotation().getType()",
            "eagerness",
            "seen",
            "finalLoader"
          ],
          "line": 735
        },
        "resolved": true,
        "details": {
          "function_name": "Compiler::Node::traverseType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
          "lines": "745-772",
          "snippet": "void Compiler::Node::traverseType(const schema::Type::Reader& type, uint eagerness,\n                                  std::unordered_map<Node*, uint>& seen,\n                                  const SchemaLoader& finalLoader) {\n  uint64_t id = 0;\n  schema::Brand::Reader brand;\n  switch (type.which()) {\n    case schema::Type::STRUCT:\n      id = type.getStruct().getTypeId();\n      brand = type.getStruct().getBrand();\n      break;\n    case schema::Type::ENUM:\n      id = type.getEnum().getTypeId();\n      brand = type.getEnum().getBrand();\n      break;\n    case schema::Type::INTERFACE:\n      id = type.getInterface().getTypeId();\n      brand = type.getInterface().getBrand();\n      break;\n    case schema::Type::LIST:\n      traverseType(type.getList().getElementType(), eagerness, seen, finalLoader);\n      return;\n    default:\n      return;\n  }\n\n  traverseDependency(id, eagerness, seen, finalLoader);\n  traverseBrand(brand, eagerness, seen, finalLoader);\n}",
          "includes": [
            "#include \"md5.h\"",
            "#include \"node-translator.h\"",
            "#include <unordered_map>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/message.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/arena.h>",
            "#include <kj/mutex.h>",
            "#include \"parser.h\"      // only for generateChildId()",
            "#include \"compiler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nvoid Compiler::Node::traverseType(const schema::Type::Reader& type, uint eagerness,\n                                  std::unordered_map<Node*, uint>& seen,\n                                  const SchemaLoader& finalLoader) {\n  uint64_t id = 0;\n  schema::Brand::Reader brand;\n  switch (type.which()) {\n    case schema::Type::STRUCT:\n      id = type.getStruct().getTypeId();\n      brand = type.getStruct().getBrand();\n      break;\n    case schema::Type::ENUM:\n      id = type.getEnum().getTypeId();\n      brand = type.getEnum().getBrand();\n      break;\n    case schema::Type::INTERFACE:\n      id = type.getInterface().getTypeId();\n      brand = type.getInterface().getBrand();\n      break;\n    case schema::Type::LIST:\n      traverseType(type.getList().getElementType(), eagerness, seen, finalLoader);\n      return;\n    default:\n      return;\n  }\n\n  traverseDependency(id, eagerness, seen, finalLoader);\n  traverseBrand(brand, eagerness, seen, finalLoader);\n}"
        }
      },
      {
        "call_info": {
          "callee": "schemaNode.getAnnotation",
          "args": [],
          "line": 735
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schemaNode.getAnnotation",
          "args": [],
          "line": 735
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schemaNode.getConst",
          "args": [],
          "line": 731
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schemaNode.getConst",
          "args": [],
          "line": 731
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "method.getAnnotations",
          "args": [],
          "line": 725
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "traverseBrand",
          "args": [
            "method.getResultBrand()",
            "eagerness",
            "seen",
            "finalLoader"
          ],
          "line": 724
        },
        "resolved": true,
        "details": {
          "function_name": "Compiler::Node::traverseBrand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
          "lines": "774-795",
          "snippet": "void Compiler::Node::traverseBrand(\n    const schema::Brand::Reader& brand, uint eagerness,\n    std::unordered_map<Node*, uint>& seen,\n    const SchemaLoader& finalLoader) {\n  for (auto scope: brand.getScopes()) {\n    switch (scope.which()) {\n      case schema::Brand::Scope::BIND:\n        for (auto binding: scope.getBind()) {\n          switch (binding.which()) {\n            case schema::Brand::Binding::UNBOUND:\n              break;\n            case schema::Brand::Binding::TYPE:\n              traverseType(binding.getType(), eagerness, seen, finalLoader);\n              break;\n          }\n        }\n        break;\n      case schema::Brand::Scope::INHERIT:\n        break;\n    }\n  }\n}",
          "includes": [
            "#include \"md5.h\"",
            "#include \"node-translator.h\"",
            "#include <unordered_map>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/message.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/arena.h>",
            "#include <kj/mutex.h>",
            "#include \"parser.h\"      // only for generateChildId()",
            "#include \"compiler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nvoid Compiler::Node::traverseBrand(\n    const schema::Brand::Reader& brand, uint eagerness,\n    std::unordered_map<Node*, uint>& seen,\n    const SchemaLoader& finalLoader) {\n  for (auto scope: brand.getScopes()) {\n    switch (scope.which()) {\n      case schema::Brand::Scope::BIND:\n        for (auto binding: scope.getBind()) {\n          switch (binding.which()) {\n            case schema::Brand::Binding::UNBOUND:\n              break;\n            case schema::Brand::Binding::TYPE:\n              traverseType(binding.getType(), eagerness, seen, finalLoader);\n              break;\n          }\n        }\n        break;\n      case schema::Brand::Scope::INHERIT:\n        break;\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "method.getResultBrand",
          "args": [],
          "line": 724
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "traverseDependency",
          "args": [
            "method.getResultStructType()",
            "eagerness",
            "seen",
            "finalLoader",
            "true"
          ],
          "line": 723
        },
        "resolved": true,
        "details": {
          "function_name": "Compiler::Node::traverseDependency",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
          "lines": "797-806",
          "snippet": "void Compiler::Node::traverseDependency(uint64_t depId, uint eagerness,\n                                        std::unordered_map<Node*, uint>& seen,\n                                        const SchemaLoader& finalLoader,\n                                        bool ignoreIfNotFound) {\n  KJ_IF_MAYBE(node, module->getCompiler().findNode(depId)) {\n    node->traverse(eagerness, seen, finalLoader);\n  } else if (!ignoreIfNotFound) {\n    KJ_FAIL_ASSERT(\"Dependency ID not present in compiler?\", depId);\n  }\n}",
          "includes": [
            "#include \"md5.h\"",
            "#include \"node-translator.h\"",
            "#include <unordered_map>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/message.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/arena.h>",
            "#include <kj/mutex.h>",
            "#include \"parser.h\"      // only for generateChildId()",
            "#include \"compiler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nvoid Compiler::Node::traverseDependency(uint64_t depId, uint eagerness,\n                                        std::unordered_map<Node*, uint>& seen,\n                                        const SchemaLoader& finalLoader,\n                                        bool ignoreIfNotFound) {\n  KJ_IF_MAYBE(node, module->getCompiler().findNode(depId)) {\n    node->traverse(eagerness, seen, finalLoader);\n  } else if (!ignoreIfNotFound) {\n    KJ_FAIL_ASSERT(\"Dependency ID not present in compiler?\", depId);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "method.getResultStructType",
          "args": [],
          "line": 723
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "method.getParamBrand",
          "args": [],
          "line": 722
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "method.getParamStructType",
          "args": [],
          "line": 721
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "interface.getMethods",
          "args": [],
          "line": 720
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "superclass.getBrand",
          "args": [],
          "line": 718
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "traverseDependency",
          "args": [
            "superclassId",
            "eagerness",
            "seen",
            "finalLoader"
          ],
          "line": 716
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "superclass.getId",
          "args": [],
          "line": 714
        },
        "resolved": true,
        "details": {
          "function_name": "getId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
          "lines": "75-75",
          "snippet": "uint64_t getId() { return id; }",
          "includes": [
            "#include \"md5.h\"",
            "#include \"node-translator.h\"",
            "#include <unordered_map>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/message.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/arena.h>",
            "#include <kj/mutex.h>",
            "#include \"parser.h\"      // only for generateChildId()",
            "#include \"compiler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nuint64_t getId() { return id; }"
        }
      },
      {
        "call_info": {
          "callee": "interface.getSuperclasses",
          "args": [],
          "line": 713
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schemaNode.getInterface",
          "args": [],
          "line": 712
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "enumerant.getAnnotations",
          "args": [],
          "line": 707
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schemaNode.getEnum",
          "args": [],
          "line": 706
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schemaNode.getEnum",
          "args": [],
          "line": 706
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getAnnotations",
          "args": [],
          "line": 701
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getSlot",
          "args": [],
          "line": 694
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getSlot",
          "args": [],
          "line": 694
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.which",
          "args": [],
          "line": 692
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schemaNode.getStruct",
          "args": [],
          "line": 691
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schemaNode.getStruct",
          "args": [],
          "line": 691
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schemaNode.which",
          "args": [],
          "line": 689
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nvoid Compiler::Node::traverseNodeDependencies(\n    const schema::Node::Reader& schemaNode, uint eagerness,\n    std::unordered_map<Node*, uint>& seen,\n    const SchemaLoader& finalLoader) {\n  switch (schemaNode.which()) {\n    case schema::Node::STRUCT:\n      for (auto field: schemaNode.getStruct().getFields()) {\n        switch (field.which()) {\n          case schema::Field::SLOT:\n            traverseType(field.getSlot().getType(), eagerness, seen, finalLoader);\n            break;\n          case schema::Field::GROUP:\n            // Aux node will be scanned later.\n            break;\n        }\n\n        traverseAnnotations(field.getAnnotations(), eagerness, seen, finalLoader);\n      }\n      break;\n\n    case schema::Node::ENUM:\n      for (auto enumerant: schemaNode.getEnum().getEnumerants()) {\n        traverseAnnotations(enumerant.getAnnotations(), eagerness, seen, finalLoader);\n      }\n      break;\n\n    case schema::Node::INTERFACE: {\n      auto interface = schemaNode.getInterface();\n      for (auto superclass: interface.getSuperclasses()) {\n        uint64_t superclassId = superclass.getId();\n        if (superclassId != 0) {  // if zero, we reported an error earlier\n          traverseDependency(superclassId, eagerness, seen, finalLoader);\n        }\n        traverseBrand(superclass.getBrand(), eagerness, seen, finalLoader);\n      }\n      for (auto method: interface.getMethods()) {\n        traverseDependency(method.getParamStructType(), eagerness, seen, finalLoader, true);\n        traverseBrand(method.getParamBrand(), eagerness, seen, finalLoader);\n        traverseDependency(method.getResultStructType(), eagerness, seen, finalLoader, true);\n        traverseBrand(method.getResultBrand(), eagerness, seen, finalLoader);\n        traverseAnnotations(method.getAnnotations(), eagerness, seen, finalLoader);\n      }\n      break;\n    }\n\n    case schema::Node::CONST:\n      traverseType(schemaNode.getConst().getType(), eagerness, seen, finalLoader);\n      break;\n\n    case schema::Node::ANNOTATION:\n      traverseType(schemaNode.getAnnotation().getType(), eagerness, seen, finalLoader);\n      break;\n\n    default:\n      break;\n  }\n\n  traverseAnnotations(schemaNode.getAnnotations(), eagerness, seen, finalLoader);\n}"
  },
  {
    "function_name": "Compiler::Node::traverse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "644-683",
    "snippet": "void Compiler::Node::traverse(uint eagerness, std::unordered_map<Node*, uint>& seen,\n                              const SchemaLoader& finalLoader) {\n  uint& slot = seen[this];\n  if ((slot & eagerness) == eagerness) {\n    // We've already covered this node.\n    return;\n  }\n  slot |= eagerness;\n\n  KJ_IF_MAYBE(content, getContent(Content::FINISHED)) {\n    loadFinalSchema(finalLoader);\n\n    KJ_IF_MAYBE(schema, getFinalSchema()) {\n      if (eagerness / DEPENDENCIES != 0) {\n        // For traversing dependencies, discard the bits lower than DEPENDENCIES and replace\n        // them with the bits above DEPENDENCIES shifted over.\n        uint newEagerness = (eagerness & ~(DEPENDENCIES - 1)) | (eagerness / DEPENDENCIES);\n\n        traverseNodeDependencies(*schema, newEagerness, seen, finalLoader);\n        for (auto& aux: content->auxSchemas) {\n          traverseNodeDependencies(aux, newEagerness, seen, finalLoader);\n        }\n      }\n    }\n  }\n\n  if (eagerness & PARENTS) {\n    KJ_IF_MAYBE(p, parent) {\n      p->traverse(eagerness, seen, finalLoader);\n    }\n  }\n\n  if (eagerness & CHILDREN) {\n    KJ_IF_MAYBE(content, getContent(Content::EXPANDED)) {\n      for (auto& child: content->orderedNestedNodes) {\n        child->traverse(eagerness, seen, finalLoader);\n      }\n    }\n  }\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "child->traverse",
          "args": [
            "eagerness",
            "seen",
            "finalLoader"
          ],
          "line": 679
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p->traverse",
          "args": [
            "eagerness",
            "seen",
            "finalLoader"
          ],
          "line": 672
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "traverseNodeDependencies",
          "args": [
            "aux",
            "newEagerness",
            "seen",
            "finalLoader"
          ],
          "line": 664
        },
        "resolved": true,
        "details": {
          "function_name": "Compiler::Node::traverseNodeDependencies",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
          "lines": "685-743",
          "snippet": "void Compiler::Node::traverseNodeDependencies(\n    const schema::Node::Reader& schemaNode, uint eagerness,\n    std::unordered_map<Node*, uint>& seen,\n    const SchemaLoader& finalLoader) {\n  switch (schemaNode.which()) {\n    case schema::Node::STRUCT:\n      for (auto field: schemaNode.getStruct().getFields()) {\n        switch (field.which()) {\n          case schema::Field::SLOT:\n            traverseType(field.getSlot().getType(), eagerness, seen, finalLoader);\n            break;\n          case schema::Field::GROUP:\n            // Aux node will be scanned later.\n            break;\n        }\n\n        traverseAnnotations(field.getAnnotations(), eagerness, seen, finalLoader);\n      }\n      break;\n\n    case schema::Node::ENUM:\n      for (auto enumerant: schemaNode.getEnum().getEnumerants()) {\n        traverseAnnotations(enumerant.getAnnotations(), eagerness, seen, finalLoader);\n      }\n      break;\n\n    case schema::Node::INTERFACE: {\n      auto interface = schemaNode.getInterface();\n      for (auto superclass: interface.getSuperclasses()) {\n        uint64_t superclassId = superclass.getId();\n        if (superclassId != 0) {  // if zero, we reported an error earlier\n          traverseDependency(superclassId, eagerness, seen, finalLoader);\n        }\n        traverseBrand(superclass.getBrand(), eagerness, seen, finalLoader);\n      }\n      for (auto method: interface.getMethods()) {\n        traverseDependency(method.getParamStructType(), eagerness, seen, finalLoader, true);\n        traverseBrand(method.getParamBrand(), eagerness, seen, finalLoader);\n        traverseDependency(method.getResultStructType(), eagerness, seen, finalLoader, true);\n        traverseBrand(method.getResultBrand(), eagerness, seen, finalLoader);\n        traverseAnnotations(method.getAnnotations(), eagerness, seen, finalLoader);\n      }\n      break;\n    }\n\n    case schema::Node::CONST:\n      traverseType(schemaNode.getConst().getType(), eagerness, seen, finalLoader);\n      break;\n\n    case schema::Node::ANNOTATION:\n      traverseType(schemaNode.getAnnotation().getType(), eagerness, seen, finalLoader);\n      break;\n\n    default:\n      break;\n  }\n\n  traverseAnnotations(schemaNode.getAnnotations(), eagerness, seen, finalLoader);\n}",
          "includes": [
            "#include \"md5.h\"",
            "#include \"node-translator.h\"",
            "#include <unordered_map>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/message.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/arena.h>",
            "#include <kj/mutex.h>",
            "#include \"parser.h\"      // only for generateChildId()",
            "#include \"compiler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nvoid Compiler::Node::traverseNodeDependencies(\n    const schema::Node::Reader& schemaNode, uint eagerness,\n    std::unordered_map<Node*, uint>& seen,\n    const SchemaLoader& finalLoader) {\n  switch (schemaNode.which()) {\n    case schema::Node::STRUCT:\n      for (auto field: schemaNode.getStruct().getFields()) {\n        switch (field.which()) {\n          case schema::Field::SLOT:\n            traverseType(field.getSlot().getType(), eagerness, seen, finalLoader);\n            break;\n          case schema::Field::GROUP:\n            // Aux node will be scanned later.\n            break;\n        }\n\n        traverseAnnotations(field.getAnnotations(), eagerness, seen, finalLoader);\n      }\n      break;\n\n    case schema::Node::ENUM:\n      for (auto enumerant: schemaNode.getEnum().getEnumerants()) {\n        traverseAnnotations(enumerant.getAnnotations(), eagerness, seen, finalLoader);\n      }\n      break;\n\n    case schema::Node::INTERFACE: {\n      auto interface = schemaNode.getInterface();\n      for (auto superclass: interface.getSuperclasses()) {\n        uint64_t superclassId = superclass.getId();\n        if (superclassId != 0) {  // if zero, we reported an error earlier\n          traverseDependency(superclassId, eagerness, seen, finalLoader);\n        }\n        traverseBrand(superclass.getBrand(), eagerness, seen, finalLoader);\n      }\n      for (auto method: interface.getMethods()) {\n        traverseDependency(method.getParamStructType(), eagerness, seen, finalLoader, true);\n        traverseBrand(method.getParamBrand(), eagerness, seen, finalLoader);\n        traverseDependency(method.getResultStructType(), eagerness, seen, finalLoader, true);\n        traverseBrand(method.getResultBrand(), eagerness, seen, finalLoader);\n        traverseAnnotations(method.getAnnotations(), eagerness, seen, finalLoader);\n      }\n      break;\n    }\n\n    case schema::Node::CONST:\n      traverseType(schemaNode.getConst().getType(), eagerness, seen, finalLoader);\n      break;\n\n    case schema::Node::ANNOTATION:\n      traverseType(schemaNode.getAnnotation().getType(), eagerness, seen, finalLoader);\n      break;\n\n    default:\n      break;\n  }\n\n  traverseAnnotations(schemaNode.getAnnotations(), eagerness, seen, finalLoader);\n}"
        }
      },
      {
        "call_info": {
          "callee": "loadFinalSchema",
          "args": [
            "finalLoader"
          ],
          "line": 654
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nvoid Compiler::Node::traverse(uint eagerness, std::unordered_map<Node*, uint>& seen,\n                              const SchemaLoader& finalLoader) {\n  uint& slot = seen[this];\n  if ((slot & eagerness) == eagerness) {\n    // We've already covered this node.\n    return;\n  }\n  slot |= eagerness;\n\n  KJ_IF_MAYBE(content, getContent(Content::FINISHED)) {\n    loadFinalSchema(finalLoader);\n\n    KJ_IF_MAYBE(schema, getFinalSchema()) {\n      if (eagerness / DEPENDENCIES != 0) {\n        // For traversing dependencies, discard the bits lower than DEPENDENCIES and replace\n        // them with the bits above DEPENDENCIES shifted over.\n        uint newEagerness = (eagerness & ~(DEPENDENCIES - 1)) | (eagerness / DEPENDENCIES);\n\n        traverseNodeDependencies(*schema, newEagerness, seen, finalLoader);\n        for (auto& aux: content->auxSchemas) {\n          traverseNodeDependencies(aux, newEagerness, seen, finalLoader);\n        }\n      }\n    }\n  }\n\n  if (eagerness & PARENTS) {\n    KJ_IF_MAYBE(p, parent) {\n      p->traverse(eagerness, seen, finalLoader);\n    }\n  }\n\n  if (eagerness & CHILDREN) {\n    KJ_IF_MAYBE(content, getContent(Content::EXPANDED)) {\n      for (auto& child: content->orderedNestedNodes) {\n        child->traverse(eagerness, seen, finalLoader);\n      }\n    }\n  }\n}"
  },
  {
    "function_name": "Compiler::Node::loadFinalSchema",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "620-642",
    "snippet": "void Compiler::Node::loadFinalSchema(const SchemaLoader& loader) {\n  KJ_IF_MAYBE(content, getContent(Content::FINISHED)) {\n    KJ_IF_MAYBE(exception, kj::runCatchingExceptions([&](){\n      KJ_IF_MAYBE(finalSchema, content->finalSchema) {\n        KJ_MAP(auxSchema, content->auxSchemas) {\n          return loader.loadOnce(auxSchema);\n        };\n        loadedFinalSchema = loader.loadOnce(*finalSchema).getProto();\n      }\n    })) {\n      // Schema validation threw an exception.\n\n      // Don't try loading this again.\n      content->finalSchema = nullptr;\n\n      // Only bother to report validation failures if we think we haven't seen any errors.\n      // Otherwise we assume that the errors caused the validation failure.\n      if (!module->getErrorReporter().hadErrors()) {\n        addError(kj::str(\"Internal compiler bug: Schema failed validation:\\n\", *exception));\n      }\n    }\n  }\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "addError",
          "args": [
            "kj::str(\"Internal compiler bug: Schema failed validation:\\n\", *exception)"
          ],
          "line": 638
        },
        "resolved": true,
        "details": {
          "function_name": "Compiler::Node::addError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
          "lines": "820-822",
          "snippet": "void Compiler::Node::addError(kj::StringPtr error) {\n  module->getErrorReporter().addError(startByte, endByte, error);\n}",
          "includes": [
            "#include \"md5.h\"",
            "#include \"node-translator.h\"",
            "#include <unordered_map>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/message.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/arena.h>",
            "#include <kj/mutex.h>",
            "#include \"parser.h\"      // only for generateChildId()",
            "#include \"compiler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nvoid Compiler::Node::addError(kj::StringPtr error) {\n  module->getErrorReporter().addError(startByte, endByte, error);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "\"Internal compiler bug: Schema failed validation:\\n\"",
            "*exception"
          ],
          "line": 638
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module->getErrorReporter",
          "args": [],
          "line": 637
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module->getErrorReporter",
          "args": [],
          "line": 637
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_IF_MAYBE",
          "args": [
            "exception",
            "kj::runCatchingExceptions([&](){\n      KJ_IF_MAYBE(finalSchema, content->finalSchema) {\n        KJ_MAP(auxSchema, content->auxSchemas) {\n          return loader.loadOnce(auxSchema);\n        };\n        loadedFinalSchema = loader.loadOnce(*finalSchema).getProto();\n      }\n    })"
          ],
          "line": 622
        },
        "resolved": true,
        "details": {
          "function_name": "KJ_IF_MAYBE",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/parser.c++",
          "lines": "982-1016",
          "snippet": "KJ_IF_MAYBE(target, maybeTarget) {\n            if (target->value == \"*\") {\n              // Set all.\n              if (targets.value.size() > 1) {\n                errorReporter.addError(target->startByte, target->endByte,\n                    \"Wildcard should not be specified together with other targets.\");\n              }\n\n              for (auto field: dynamicBuilder.getSchema().getFields()) {\n                if (field.getProto().getName().startsWith(\"targets\")) {\n                  dynamicBuilder.set(field, true);\n                }\n              }\n            } else {\n              if (target->value.size() == 0 || target->value.size() >= 32 ||\n                  target->value[0] < 'a' || target->value[0] > 'z') {\n                errorReporter.addError(target->startByte, target->endByte,\n                                       \"Not a valid annotation target.\");\n              } else {\n                char buffer[64];\n                strcpy(buffer, \"targets\");\n                strcat(buffer, target->value.cStr());\n                buffer[strlen(\"targets\")] += 'A' - 'a';\n                KJ_IF_MAYBE(field, dynamicBuilder.getSchema().findFieldByName(buffer)) {\n                  if (dynamicBuilder.get(*field).as<bool>()) {\n                    errorReporter.addError(target->startByte, target->endByte,\n                                           \"Duplicate target specification.\");\n                  }\n                  dynamicBuilder.set(*field, true);\n                } else {\n                  errorReporter.addError(target->startByte, target->endByte,\n                                         \"Not a valid annotation target.\");\n                }\n              }\n            }",
          "includes": [
            "#include <windows.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <kj/debug.h>",
            "#include <capnp/dynamic.h>",
            "#include \"md5.h\"",
            "#include \"parser.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <windows.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <kj/debug.h>\n#include <capnp/dynamic.h>\n#include \"md5.h\"\n#include \"parser.h\"\n\nKJ_IF_MAYBE(target, maybeTarget) {\n            if (target->value == \"*\") {\n              // Set all.\n              if (targets.value.size() > 1) {\n                errorReporter.addError(target->startByte, target->endByte,\n                    \"Wildcard should not be specified together with other targets.\");\n              }\n\n              for (auto field: dynamicBuilder.getSchema().getFields()) {\n                if (field.getProto().getName().startsWith(\"targets\")) {\n                  dynamicBuilder.set(field, true);\n                }\n              }\n            } else {\n              if (target->value.size() == 0 || target->value.size() >= 32 ||\n                  target->value[0] < 'a' || target->value[0] > 'z') {\n                errorReporter.addError(target->startByte, target->endByte,\n                                       \"Not a valid annotation target.\");\n              } else {\n                char buffer[64];\n                strcpy(buffer, \"targets\");\n                strcat(buffer, target->value.cStr());\n                buffer[strlen(\"targets\")] += 'A' - 'a';\n                KJ_IF_MAYBE(field, dynamicBuilder.getSchema().findFieldByName(buffer)) {\n                  if (dynamicBuilder.get(*field).as<bool>()) {\n                    errorReporter.addError(target->startByte, target->endByte,\n                                           \"Duplicate target specification.\");\n                  }\n                  dynamicBuilder.set(*field, true);\n                } else {\n                  errorReporter.addError(target->startByte, target->endByte,\n                                         \"Not a valid annotation target.\");\n                }\n              }\n            }"
        }
      },
      {
        "call_info": {
          "callee": "kj::runCatchingExceptions",
          "args": [
            "[&](){\n      KJ_IF_MAYBE(finalSchema, content->finalSchema) {\n        KJ_MAP(auxSchema, content->auxSchemas) {\n          return loader.loadOnce(auxSchema);\n        };\n        loadedFinalSchema = loader.loadOnce(*finalSchema).getProto();\n      }\n    }"
          ],
          "line": 622
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loader.loadOnce",
          "args": [],
          "line": 627
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loader.loadOnce",
          "args": [
            "*finalSchema"
          ],
          "line": 627
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loader.loadOnce",
          "args": [
            "auxSchema"
          ],
          "line": 625
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "auxSchema",
            "content->auxSchemas"
          ],
          "line": 624
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nvoid Compiler::Node::loadFinalSchema(const SchemaLoader& loader) {\n  KJ_IF_MAYBE(content, getContent(Content::FINISHED)) {\n    KJ_IF_MAYBE(exception, kj::runCatchingExceptions([&](){\n      KJ_IF_MAYBE(finalSchema, content->finalSchema) {\n        KJ_MAP(auxSchema, content->auxSchemas) {\n          return loader.loadOnce(auxSchema);\n        };\n        loadedFinalSchema = loader.loadOnce(*finalSchema).getProto();\n      }\n    })) {\n      // Schema validation threw an exception.\n\n      // Don't try loading this again.\n      content->finalSchema = nullptr;\n\n      // Only bother to report validation failures if we think we haven't seen any errors.\n      // Otherwise we assume that the errors caused the validation failure.\n      if (!module->getErrorReporter().hadErrors()) {\n        addError(kj::str(\"Internal compiler bug: Schema failed validation:\\n\", *exception));\n      }\n    }\n  }\n}"
  },
  {
    "function_name": "Compiler::Node::getFinalSchema",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "611-619",
    "snippet": "kj::Maybe<schema::Node::Reader> Compiler::Node::getFinalSchema() {\n  KJ_IF_MAYBE(schema, loadedFinalSchema) {\n    return *schema;\n  } else KJ_IF_MAYBE(content, getContent(Content::FINISHED)) {\n    return content->finalSchema;\n  } else {\n    return nullptr;\n  }\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nkj::Maybe<schema::Node::Reader> Compiler::Node::getFinalSchema() {\n  KJ_IF_MAYBE(schema, loadedFinalSchema) {\n    return *schema;\n  } else KJ_IF_MAYBE(content, getContent(Content::FINISHED)) {\n    return content->finalSchema;\n  } else {\n    return nullptr;\n  }\n}"
  },
  {
    "function_name": "Compiler::Node::getBootstrapSchema",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "590-610",
    "snippet": "kj::Maybe<Schema> Compiler::Node::getBootstrapSchema() {\n  KJ_IF_MAYBE(schema, loadedFinalSchema) {\n    // We don't need to rebuild the bootstrap schema if we already have a final schema.\n    return module->getCompiler().getWorkspace().bootstrapLoader.loadOnce(*schema);\n  } else KJ_IF_MAYBE(content, getContent(Content::BOOTSTRAP)) {\n    if (content->state == Content::FINISHED && content->bootstrapSchema == nullptr) {\n      // The bootstrap schema was discarded.  Copy it from the final schema.\n      // (We can't just return the final schema because using it could trigger schema loader\n      // callbacks that would deadlock.)\n      KJ_IF_MAYBE(finalSchema, content->finalSchema) {\n        return module->getCompiler().getWorkspace().bootstrapLoader.loadOnce(*finalSchema);\n      } else {\n        return nullptr;\n      }\n    } else {\n      return content->bootstrapSchema;\n    }\n  } else {\n    return nullptr;\n  }\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "module->getCompiler",
          "args": [
            "*finalSchema"
          ],
          "line": 600
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module->getCompiler",
          "args": [],
          "line": 600
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module->getCompiler",
          "args": [],
          "line": 600
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_IF_MAYBE",
          "args": [
            "finalSchema",
            "content->finalSchema"
          ],
          "line": 599
        },
        "resolved": true,
        "details": {
          "function_name": "KJ_IF_MAYBE",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/parser.c++",
          "lines": "982-1016",
          "snippet": "KJ_IF_MAYBE(target, maybeTarget) {\n            if (target->value == \"*\") {\n              // Set all.\n              if (targets.value.size() > 1) {\n                errorReporter.addError(target->startByte, target->endByte,\n                    \"Wildcard should not be specified together with other targets.\");\n              }\n\n              for (auto field: dynamicBuilder.getSchema().getFields()) {\n                if (field.getProto().getName().startsWith(\"targets\")) {\n                  dynamicBuilder.set(field, true);\n                }\n              }\n            } else {\n              if (target->value.size() == 0 || target->value.size() >= 32 ||\n                  target->value[0] < 'a' || target->value[0] > 'z') {\n                errorReporter.addError(target->startByte, target->endByte,\n                                       \"Not a valid annotation target.\");\n              } else {\n                char buffer[64];\n                strcpy(buffer, \"targets\");\n                strcat(buffer, target->value.cStr());\n                buffer[strlen(\"targets\")] += 'A' - 'a';\n                KJ_IF_MAYBE(field, dynamicBuilder.getSchema().findFieldByName(buffer)) {\n                  if (dynamicBuilder.get(*field).as<bool>()) {\n                    errorReporter.addError(target->startByte, target->endByte,\n                                           \"Duplicate target specification.\");\n                  }\n                  dynamicBuilder.set(*field, true);\n                } else {\n                  errorReporter.addError(target->startByte, target->endByte,\n                                         \"Not a valid annotation target.\");\n                }\n              }\n            }",
          "includes": [
            "#include <windows.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <kj/debug.h>",
            "#include <capnp/dynamic.h>",
            "#include \"md5.h\"",
            "#include \"parser.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <windows.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <kj/debug.h>\n#include <capnp/dynamic.h>\n#include \"md5.h\"\n#include \"parser.h\"\n\nKJ_IF_MAYBE(target, maybeTarget) {\n            if (target->value == \"*\") {\n              // Set all.\n              if (targets.value.size() > 1) {\n                errorReporter.addError(target->startByte, target->endByte,\n                    \"Wildcard should not be specified together with other targets.\");\n              }\n\n              for (auto field: dynamicBuilder.getSchema().getFields()) {\n                if (field.getProto().getName().startsWith(\"targets\")) {\n                  dynamicBuilder.set(field, true);\n                }\n              }\n            } else {\n              if (target->value.size() == 0 || target->value.size() >= 32 ||\n                  target->value[0] < 'a' || target->value[0] > 'z') {\n                errorReporter.addError(target->startByte, target->endByte,\n                                       \"Not a valid annotation target.\");\n              } else {\n                char buffer[64];\n                strcpy(buffer, \"targets\");\n                strcat(buffer, target->value.cStr());\n                buffer[strlen(\"targets\")] += 'A' - 'a';\n                KJ_IF_MAYBE(field, dynamicBuilder.getSchema().findFieldByName(buffer)) {\n                  if (dynamicBuilder.get(*field).as<bool>()) {\n                    errorReporter.addError(target->startByte, target->endByte,\n                                           \"Duplicate target specification.\");\n                  }\n                  dynamicBuilder.set(*field, true);\n                } else {\n                  errorReporter.addError(target->startByte, target->endByte,\n                                         \"Not a valid annotation target.\");\n                }\n              }\n            }"
        }
      },
      {
        "call_info": {
          "callee": "module->getCompiler",
          "args": [
            "*schema"
          ],
          "line": 593
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module->getCompiler",
          "args": [],
          "line": 593
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module->getCompiler",
          "args": [],
          "line": 593
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nkj::Maybe<Schema> Compiler::Node::getBootstrapSchema() {\n  KJ_IF_MAYBE(schema, loadedFinalSchema) {\n    // We don't need to rebuild the bootstrap schema if we already have a final schema.\n    return module->getCompiler().getWorkspace().bootstrapLoader.loadOnce(*schema);\n  } else KJ_IF_MAYBE(content, getContent(Content::BOOTSTRAP)) {\n    if (content->state == Content::FINISHED && content->bootstrapSchema == nullptr) {\n      // The bootstrap schema was discarded.  Copy it from the final schema.\n      // (We can't just return the final schema because using it could trigger schema loader\n      // callbacks that would deadlock.)\n      KJ_IF_MAYBE(finalSchema, content->finalSchema) {\n        return module->getCompiler().getWorkspace().bootstrapLoader.loadOnce(*finalSchema);\n      } else {\n        return nullptr;\n      }\n    } else {\n      return content->bootstrapSchema;\n    }\n  } else {\n    return nullptr;\n  }\n}"
  },
  {
    "function_name": "Compiler::Node::getContent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "442-588",
    "snippet": "kj::Maybe<Compiler::Node::Content&> Compiler::Node::getContent(Content::State minimumState) {\n  KJ_REQUIRE(!isBuiltin, \"illegal method call for built-in declaration\");\n\n  auto& content = guardedContent;\n\n  if (content.stateHasReached(minimumState)) {\n    return content;\n  }\n\n  if (inGetContent) {\n    addError(\"Declaration recursively depends on itself.\");\n    return nullptr;\n  }\n\n  inGetContent = true;\n  KJ_DEFER(inGetContent = false);\n\n  switch (content.state) {\n    case Content::STUB: {\n      if (minimumState <= Content::STUB) break;\n\n      // Expand the child nodes.\n      auto& arena = module->getCompiler().getNodeArena();\n\n      for (auto nestedDecl: declaration.getNestedDecls()) {\n        switch (nestedDecl.which()) {\n          case Declaration::FILE:\n          case Declaration::CONST:\n          case Declaration::ANNOTATION:\n          case Declaration::ENUM:\n          case Declaration::STRUCT:\n          case Declaration::INTERFACE: {\n            kj::Own<Node> subNode = arena.allocateOwn<Node>(*this, nestedDecl);\n            kj::StringPtr name = nestedDecl.getName().getValue();\n            content.orderedNestedNodes.add(subNode);\n            content.nestedNodes.insert(std::make_pair(name, kj::mv(subNode)));\n            break;\n          }\n\n          case Declaration::USING: {\n            kj::Own<Alias> alias = arena.allocateOwn<Alias>(\n                *module, *this, nestedDecl.getUsing().getTarget());\n            kj::StringPtr name = nestedDecl.getName().getValue();\n            content.aliases.insert(std::make_pair(name, kj::mv(alias)));\n            break;\n          }\n          case Declaration::ENUMERANT:\n          case Declaration::FIELD:\n          case Declaration::UNION:\n          case Declaration::GROUP:\n          case Declaration::METHOD:\n          case Declaration::NAKED_ID:\n          case Declaration::NAKED_ANNOTATION:\n            // Not a node.  Skip.\n            break;\n          default:\n            KJ_FAIL_ASSERT(\"unknown declaration type\", nestedDecl);\n            break;\n        }\n      }\n\n      content.advanceState(Content::EXPANDED);\n      // no break\n    }\n\n    case Content::EXPANDED: {\n      if (minimumState <= Content::EXPANDED) break;\n\n      // Construct the NodeTranslator.\n      auto& workspace = module->getCompiler().getWorkspace();\n\n      auto schemaNode = workspace.orphanage.newOrphan<schema::Node>();\n      auto builder = schemaNode.get();\n      builder.setId(id);\n      builder.setDisplayName(displayName);\n      // TODO(cleanup):  Would be better if we could remember the prefix length from before we\n      //   added this decl's name to the end.\n      KJ_IF_MAYBE(lastDot, displayName.findLast('.')) {\n        builder.setDisplayNamePrefixLength(*lastDot + 1);\n      }\n      KJ_IF_MAYBE(lastColon, displayName.findLast(':')) {\n        if (*lastColon > builder.getDisplayNamePrefixLength()) {\n          builder.setDisplayNamePrefixLength(*lastColon + 1);\n        }\n      }\n      KJ_IF_MAYBE(p, parent) {\n        builder.setScopeId(p->id);\n      }\n\n      auto nestedNodes = builder.initNestedNodes(content.orderedNestedNodes.size());\n      auto nestedIter = nestedNodes.begin();\n      for (auto node: content.orderedNestedNodes) {\n        nestedIter->setName(node->declaration.getName().getValue());\n        nestedIter->setId(node->id);\n        ++nestedIter;\n      }\n\n      content.translator = &workspace.arena.allocate<NodeTranslator>(\n          *this, module->getErrorReporter(), declaration, kj::mv(schemaNode),\n          module->getCompiler().shouldCompileAnnotations());\n      KJ_IF_MAYBE(exception, kj::runCatchingExceptions([&](){\n        auto nodeSet = content.translator->getBootstrapNode();\n        for (auto& auxNode: nodeSet.auxNodes) {\n          workspace.bootstrapLoader.loadOnce(auxNode);\n        }\n        content.bootstrapSchema = workspace.bootstrapLoader.loadOnce(nodeSet.node);\n      })) {\n        content.bootstrapSchema = nullptr;\n        // Only bother to report validation failures if we think we haven't seen any errors.\n        // Otherwise we assume that the errors caused the validation failure.\n        if (!module->getErrorReporter().hadErrors()) {\n          addError(kj::str(\"Internal compiler bug: Bootstrap schema failed validation:\\n\",\n                           *exception));\n        }\n      }\n\n      // If the Workspace is destroyed, revert the node to the EXPANDED state, because the\n      // NodeTranslator is no longer valid in this case.\n      workspace.arena.copy(kj::defer([&content]() {\n        content.bootstrapSchema = nullptr;\n        if (content.state > Content::EXPANDED) {\n          content.state = Content::EXPANDED;\n        }\n      }));\n\n      content.advanceState(Content::BOOTSTRAP);\n      // no break\n    }\n\n    case Content::BOOTSTRAP: {\n      if (minimumState <= Content::BOOTSTRAP) break;\n\n      // Create the final schema.\n      auto nodeSet = content.translator->finish();\n      content.finalSchema = nodeSet.node;\n      content.auxSchemas = kj::mv(nodeSet.auxNodes);\n\n      content.advanceState(Content::FINISHED);\n      // no break\n    }\n\n    case Content::FINISHED:\n      break;\n  }\n\n  return content;\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "content.advanceState",
          "args": [
            "Content::FINISHED"
          ],
          "line": 579
        },
        "resolved": true,
        "details": {
          "function_name": "advanceState",
          "container": "Content",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
          "lines": "148-150",
          "snippet": "inline void advanceState(State newState) {\n      state = newState;\n    }",
          "includes": [
            "#include \"md5.h\"",
            "#include \"node-translator.h\"",
            "#include <unordered_map>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/message.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/arena.h>",
            "#include <kj/mutex.h>",
            "#include \"parser.h\"      // only for generateChildId()",
            "#include \"compiler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nContent {\n  inline void advanceState(State newState) {\n        state = newState;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "nodeSet.auxNodes"
          ],
          "line": 577
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "content.translator->finish",
          "args": [],
          "line": 575
        },
        "resolved": true,
        "details": {
          "function_name": "finish",
          "container": "ArrayBuilder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "369-382",
          "snippet": "Array<T> finish() {\n    // We could safely remove this check if we assume that the disposer implementation doesn't\n    // need to know the original capacity, as is thes case with HeapArrayDisposer since it uses\n    // operator new() or if we created a custom disposer for ArrayBuilder which stores the capacity\n    // in a prefix.  But that would make it hard to write cleverer heap allocators, and anyway this\n    // check might catch bugs.  Probably people should use Vector if they want to build arrays\n    // without knowing the final size in advance.\n    KJ_IREQUIRE(pos == endPtr, \"ArrayBuilder::finish() called prematurely.\");\n    Array<T> result(reinterpret_cast<T*>(ptr), pos - ptr, *disposer);\n    ptr = nullptr;\n    pos = nullptr;\n    endPtr = nullptr;\n    return result;\n  }",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\nArrayBuilder {\n  Array<T> finish() {\n      // We could safely remove this check if we assume that the disposer implementation doesn't\n      // need to know the original capacity, as is thes case with HeapArrayDisposer since it uses\n      // operator new() or if we created a custom disposer for ArrayBuilder which stores the capacity\n      // in a prefix.  But that would make it hard to write cleverer heap allocators, and anyway this\n      // check might catch bugs.  Probably people should use Vector if they want to build arrays\n      // without knowing the final size in advance.\n      KJ_IREQUIRE(pos == endPtr, \"ArrayBuilder::finish() called prematurely.\");\n      Array<T> result(reinterpret_cast<T*>(ptr), pos - ptr, *disposer);\n      ptr = nullptr;\n      pos = nullptr;\n      endPtr = nullptr;\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "workspace.arena.copy",
          "args": [
            "kj::defer([&content]() {\n        content.bootstrapSchema = nullptr;\n        if (content.state > Content::EXPANDED) {\n          content.state = Content::EXPANDED;\n        }\n      })"
          ],
          "line": 560
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::defer",
          "args": [
            "[&content]() {\n        content.bootstrapSchema = nullptr;\n        if (content.state > Content::EXPANDED) {\n          content.state = Content::EXPANDED;\n        }\n      }"
          ],
          "line": 560
        },
        "resolved": true,
        "details": {
          "function_name": "defer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "1272-1281",
          "snippet": "_::Deferred<Decay<Func>> defer(Func&& func) {\n  // Returns an object which will invoke the given functor in its destructor.  The object is not\n  // copyable but is movable with the semantics you'd expect.  Since the return type is private,\n  // you need to assign to an `auto` variable.\n  //\n  // The KJ_DEFER macro provides slightly more convenient syntax for the common case where you\n  // want some code to run at function exit.\n\n  return _::Deferred<Decay<Func>>(kj::fwd<Func>(func));\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\n_::Deferred<Decay<Func>> defer(Func&& func) {\n  // Returns an object which will invoke the given functor in its destructor.  The object is not\n  // copyable but is movable with the semantics you'd expect.  Since the return type is private,\n  // you need to assign to an `auto` variable.\n  //\n  // The KJ_DEFER macro provides slightly more convenient syntax for the common case where you\n  // want some code to run at function exit.\n\n  return _::Deferred<Decay<Func>>(kj::fwd<Func>(func));\n}"
        }
      },
      {
        "call_info": {
          "callee": "addError",
          "args": [
            "kj::str(\"Internal compiler bug: Bootstrap schema failed validation:\\n\",\n                           *exception)"
          ],
          "line": 553
        },
        "resolved": true,
        "details": {
          "function_name": "Compiler::Node::addError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
          "lines": "820-822",
          "snippet": "void Compiler::Node::addError(kj::StringPtr error) {\n  module->getErrorReporter().addError(startByte, endByte, error);\n}",
          "includes": [
            "#include \"md5.h\"",
            "#include \"node-translator.h\"",
            "#include <unordered_map>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/message.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/arena.h>",
            "#include <kj/mutex.h>",
            "#include \"parser.h\"      // only for generateChildId()",
            "#include \"compiler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nvoid Compiler::Node::addError(kj::StringPtr error) {\n  module->getErrorReporter().addError(startByte, endByte, error);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "\"Internal compiler bug: Bootstrap schema failed validation:\\n\"",
            "*exception"
          ],
          "line": 553
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module->getErrorReporter",
          "args": [],
          "line": 552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module->getErrorReporter",
          "args": [],
          "line": 552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_IF_MAYBE",
          "args": [
            "exception",
            "kj::runCatchingExceptions([&](){\n        auto nodeSet = content.translator->getBootstrapNode();\n        for (auto& auxNode: nodeSet.auxNodes) {\n          workspace.bootstrapLoader.loadOnce(auxNode);\n        }\n        content.bootstrapSchema = workspace.bootstrapLoader.loadOnce(nodeSet.node);\n      })"
          ],
          "line": 542
        },
        "resolved": true,
        "details": {
          "function_name": "KJ_IF_MAYBE",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/parser.c++",
          "lines": "982-1016",
          "snippet": "KJ_IF_MAYBE(target, maybeTarget) {\n            if (target->value == \"*\") {\n              // Set all.\n              if (targets.value.size() > 1) {\n                errorReporter.addError(target->startByte, target->endByte,\n                    \"Wildcard should not be specified together with other targets.\");\n              }\n\n              for (auto field: dynamicBuilder.getSchema().getFields()) {\n                if (field.getProto().getName().startsWith(\"targets\")) {\n                  dynamicBuilder.set(field, true);\n                }\n              }\n            } else {\n              if (target->value.size() == 0 || target->value.size() >= 32 ||\n                  target->value[0] < 'a' || target->value[0] > 'z') {\n                errorReporter.addError(target->startByte, target->endByte,\n                                       \"Not a valid annotation target.\");\n              } else {\n                char buffer[64];\n                strcpy(buffer, \"targets\");\n                strcat(buffer, target->value.cStr());\n                buffer[strlen(\"targets\")] += 'A' - 'a';\n                KJ_IF_MAYBE(field, dynamicBuilder.getSchema().findFieldByName(buffer)) {\n                  if (dynamicBuilder.get(*field).as<bool>()) {\n                    errorReporter.addError(target->startByte, target->endByte,\n                                           \"Duplicate target specification.\");\n                  }\n                  dynamicBuilder.set(*field, true);\n                } else {\n                  errorReporter.addError(target->startByte, target->endByte,\n                                         \"Not a valid annotation target.\");\n                }\n              }\n            }",
          "includes": [
            "#include <windows.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <kj/debug.h>",
            "#include <capnp/dynamic.h>",
            "#include \"md5.h\"",
            "#include \"parser.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <windows.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <kj/debug.h>\n#include <capnp/dynamic.h>\n#include \"md5.h\"\n#include \"parser.h\"\n\nKJ_IF_MAYBE(target, maybeTarget) {\n            if (target->value == \"*\") {\n              // Set all.\n              if (targets.value.size() > 1) {\n                errorReporter.addError(target->startByte, target->endByte,\n                    \"Wildcard should not be specified together with other targets.\");\n              }\n\n              for (auto field: dynamicBuilder.getSchema().getFields()) {\n                if (field.getProto().getName().startsWith(\"targets\")) {\n                  dynamicBuilder.set(field, true);\n                }\n              }\n            } else {\n              if (target->value.size() == 0 || target->value.size() >= 32 ||\n                  target->value[0] < 'a' || target->value[0] > 'z') {\n                errorReporter.addError(target->startByte, target->endByte,\n                                       \"Not a valid annotation target.\");\n              } else {\n                char buffer[64];\n                strcpy(buffer, \"targets\");\n                strcat(buffer, target->value.cStr());\n                buffer[strlen(\"targets\")] += 'A' - 'a';\n                KJ_IF_MAYBE(field, dynamicBuilder.getSchema().findFieldByName(buffer)) {\n                  if (dynamicBuilder.get(*field).as<bool>()) {\n                    errorReporter.addError(target->startByte, target->endByte,\n                                           \"Duplicate target specification.\");\n                  }\n                  dynamicBuilder.set(*field, true);\n                } else {\n                  errorReporter.addError(target->startByte, target->endByte,\n                                         \"Not a valid annotation target.\");\n                }\n              }\n            }"
        }
      },
      {
        "call_info": {
          "callee": "kj::runCatchingExceptions",
          "args": [
            "[&](){\n        auto nodeSet = content.translator->getBootstrapNode();\n        for (auto& auxNode: nodeSet.auxNodes) {\n          workspace.bootstrapLoader.loadOnce(auxNode);\n        }\n        content.bootstrapSchema = workspace.bootstrapLoader.loadOnce(nodeSet.node);\n      }"
          ],
          "line": 542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "workspace.bootstrapLoader.loadOnce",
          "args": [
            "nodeSet.node"
          ],
          "line": 547
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "workspace.bootstrapLoader.loadOnce",
          "args": [
            "auxNode"
          ],
          "line": 545
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "content.translator->getBootstrapNode",
          "args": [],
          "line": 543
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "workspace.arena.allocate<NodeTranslator>",
          "args": [
            "*this",
            "module->getErrorReporter()",
            "declaration",
            "kj::mv(schemaNode)",
            "module->getCompiler().shouldCompileAnnotations()"
          ],
          "line": 539
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module->getCompiler",
          "args": [],
          "line": 541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module->getCompiler",
          "args": [],
          "line": 541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "schemaNode"
          ],
          "line": 540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module->getErrorReporter",
          "args": [],
          "line": 540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nestedIter->setId",
          "args": [
            "node->id"
          ],
          "line": 535
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nestedIter->setName",
          "args": [
            "node->declaration.getName().getValue()"
          ],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "node->declaration.getName",
          "args": [],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "node->declaration.getName",
          "args": [],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nestedNodes.begin",
          "args": [],
          "line": 532
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-capnp.c++",
          "lines": "76-76",
          "snippet": "inline Iterator begin() const { return Iterator(0); }",
          "includes": [
            "#include \"config.h\"",
            "#include <map>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <map>\n#include <algorithm>\n#include <kj/main.h>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nIndent {\n  inline Iterator begin() const { return Iterator(0); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "builder.initNestedNodes",
          "args": [
            "content.orderedNestedNodes.size()"
          ],
          "line": 531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "content.orderedNestedNodes.size",
          "args": [],
          "line": 531
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-capnp.c++",
          "lines": "74-74",
          "snippet": "inline size_t size() const { return amount; }",
          "includes": [
            "#include \"config.h\"",
            "#include <map>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <map>\n#include <algorithm>\n#include <kj/main.h>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nIndent {\n  inline size_t size() const { return amount; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "builder.setScopeId",
          "args": [
            "p->id"
          ],
          "line": 528
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.setDisplayNamePrefixLength",
          "args": [
            "*lastColon + 1"
          ],
          "line": 524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getDisplayNamePrefixLength",
          "args": [],
          "line": 523
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "displayName.findLast",
          "args": [
            "':'"
          ],
          "line": 522
        },
        "resolved": true,
        "details": {
          "function_name": "findLast",
          "container": "String",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "183-183",
          "snippet": "inline Maybe<size_t> findLast(char c) const { return StringPtr(*this).findLast(c); }",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\nString {\n  inline Maybe<size_t> findLast(char c) const { return StringPtr(*this).findLast(c); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "builder.setDisplayNamePrefixLength",
          "args": [
            "*lastDot + 1"
          ],
          "line": 520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.setDisplayName",
          "args": [
            "displayName"
          ],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.setId",
          "args": [
            "id"
          ],
          "line": 515
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schemaNode.get",
          "args": [],
          "line": 514
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "workspace.orphanage.newOrphan<schema::Node>",
          "args": [],
          "line": 513
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module->getCompiler",
          "args": [],
          "line": 511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module->getCompiler",
          "args": [],
          "line": 511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_FAIL_ASSERT",
          "args": [
            "\"unknown declaration type\"",
            "nestedDecl"
          ],
          "line": 498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "content.aliases.insert",
          "args": [
            "std::make_pair(name, kj::mv(alias))"
          ],
          "line": 485
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::make_pair",
          "args": [
            "name",
            "kj::mv(alias)"
          ],
          "line": 485
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "alias"
          ],
          "line": 485
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nestedDecl.getName",
          "args": [],
          "line": 484
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nestedDecl.getName",
          "args": [],
          "line": 484
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arena.allocateOwn<Alias>",
          "args": [
            "*module",
            "*this",
            "nestedDecl.getUsing().getTarget()"
          ],
          "line": 482
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nestedDecl.getUsing",
          "args": [],
          "line": 483
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nestedDecl.getUsing",
          "args": [],
          "line": 483
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "content.nestedNodes.insert",
          "args": [
            "std::make_pair(name, kj::mv(subNode))"
          ],
          "line": 477
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::make_pair",
          "args": [
            "name",
            "kj::mv(subNode)"
          ],
          "line": 477
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "subNode"
          ],
          "line": 477
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "content.orderedNestedNodes.add",
          "args": [
            "subNode"
          ],
          "line": 476
        },
        "resolved": true,
        "details": {
          "function_name": "add",
          "container": "ReusableObjects::ObjectSizeCounter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/null-common.h",
          "lines": "86-88",
          "snippet": "void add(size_t wordCount) {\n      maxSize = std::max(wordCount, maxSize);\n    }",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nReusableObjects {\n  ObjectSizeCounter {\n    void add(size_t wordCount) {\n          maxSize = std::max(wordCount, maxSize);\n        }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "nestedDecl.getName",
          "args": [],
          "line": 475
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nestedDecl.getName",
          "args": [],
          "line": 475
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arena.allocateOwn<Node>",
          "args": [
            "*this",
            "nestedDecl"
          ],
          "line": 474
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nestedDecl.which",
          "args": [],
          "line": 467
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "declaration.getNestedDecls",
          "args": [],
          "line": 466
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module->getCompiler",
          "args": [],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module->getCompiler",
          "args": [],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_DEFER",
          "args": [
            "inGetContent = false"
          ],
          "line": 457
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "content.stateHasReached",
          "args": [
            "minimumState"
          ],
          "line": 447
        },
        "resolved": true,
        "details": {
          "function_name": "stateHasReached",
          "container": "Content",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
          "lines": "145-147",
          "snippet": "inline bool stateHasReached(State minimumState) {\n      return state >= minimumState;\n    }",
          "includes": [
            "#include \"md5.h\"",
            "#include \"node-translator.h\"",
            "#include <unordered_map>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/message.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/arena.h>",
            "#include <kj/mutex.h>",
            "#include \"parser.h\"      // only for generateChildId()",
            "#include \"compiler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nContent {\n  inline bool stateHasReached(State minimumState) {\n        return state >= minimumState;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "!isBuiltin",
            "\"illegal method call for built-in declaration\""
          ],
          "line": 443
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nkj::Maybe<Compiler::Node::Content&> Compiler::Node::getContent(Content::State minimumState) {\n  KJ_REQUIRE(!isBuiltin, \"illegal method call for built-in declaration\");\n\n  auto& content = guardedContent;\n\n  if (content.stateHasReached(minimumState)) {\n    return content;\n  }\n\n  if (inGetContent) {\n    addError(\"Declaration recursively depends on itself.\");\n    return nullptr;\n  }\n\n  inGetContent = true;\n  KJ_DEFER(inGetContent = false);\n\n  switch (content.state) {\n    case Content::STUB: {\n      if (minimumState <= Content::STUB) break;\n\n      // Expand the child nodes.\n      auto& arena = module->getCompiler().getNodeArena();\n\n      for (auto nestedDecl: declaration.getNestedDecls()) {\n        switch (nestedDecl.which()) {\n          case Declaration::FILE:\n          case Declaration::CONST:\n          case Declaration::ANNOTATION:\n          case Declaration::ENUM:\n          case Declaration::STRUCT:\n          case Declaration::INTERFACE: {\n            kj::Own<Node> subNode = arena.allocateOwn<Node>(*this, nestedDecl);\n            kj::StringPtr name = nestedDecl.getName().getValue();\n            content.orderedNestedNodes.add(subNode);\n            content.nestedNodes.insert(std::make_pair(name, kj::mv(subNode)));\n            break;\n          }\n\n          case Declaration::USING: {\n            kj::Own<Alias> alias = arena.allocateOwn<Alias>(\n                *module, *this, nestedDecl.getUsing().getTarget());\n            kj::StringPtr name = nestedDecl.getName().getValue();\n            content.aliases.insert(std::make_pair(name, kj::mv(alias)));\n            break;\n          }\n          case Declaration::ENUMERANT:\n          case Declaration::FIELD:\n          case Declaration::UNION:\n          case Declaration::GROUP:\n          case Declaration::METHOD:\n          case Declaration::NAKED_ID:\n          case Declaration::NAKED_ANNOTATION:\n            // Not a node.  Skip.\n            break;\n          default:\n            KJ_FAIL_ASSERT(\"unknown declaration type\", nestedDecl);\n            break;\n        }\n      }\n\n      content.advanceState(Content::EXPANDED);\n      // no break\n    }\n\n    case Content::EXPANDED: {\n      if (minimumState <= Content::EXPANDED) break;\n\n      // Construct the NodeTranslator.\n      auto& workspace = module->getCompiler().getWorkspace();\n\n      auto schemaNode = workspace.orphanage.newOrphan<schema::Node>();\n      auto builder = schemaNode.get();\n      builder.setId(id);\n      builder.setDisplayName(displayName);\n      // TODO(cleanup):  Would be better if we could remember the prefix length from before we\n      //   added this decl's name to the end.\n      KJ_IF_MAYBE(lastDot, displayName.findLast('.')) {\n        builder.setDisplayNamePrefixLength(*lastDot + 1);\n      }\n      KJ_IF_MAYBE(lastColon, displayName.findLast(':')) {\n        if (*lastColon > builder.getDisplayNamePrefixLength()) {\n          builder.setDisplayNamePrefixLength(*lastColon + 1);\n        }\n      }\n      KJ_IF_MAYBE(p, parent) {\n        builder.setScopeId(p->id);\n      }\n\n      auto nestedNodes = builder.initNestedNodes(content.orderedNestedNodes.size());\n      auto nestedIter = nestedNodes.begin();\n      for (auto node: content.orderedNestedNodes) {\n        nestedIter->setName(node->declaration.getName().getValue());\n        nestedIter->setId(node->id);\n        ++nestedIter;\n      }\n\n      content.translator = &workspace.arena.allocate<NodeTranslator>(\n          *this, module->getErrorReporter(), declaration, kj::mv(schemaNode),\n          module->getCompiler().shouldCompileAnnotations());\n      KJ_IF_MAYBE(exception, kj::runCatchingExceptions([&](){\n        auto nodeSet = content.translator->getBootstrapNode();\n        for (auto& auxNode: nodeSet.auxNodes) {\n          workspace.bootstrapLoader.loadOnce(auxNode);\n        }\n        content.bootstrapSchema = workspace.bootstrapLoader.loadOnce(nodeSet.node);\n      })) {\n        content.bootstrapSchema = nullptr;\n        // Only bother to report validation failures if we think we haven't seen any errors.\n        // Otherwise we assume that the errors caused the validation failure.\n        if (!module->getErrorReporter().hadErrors()) {\n          addError(kj::str(\"Internal compiler bug: Bootstrap schema failed validation:\\n\",\n                           *exception));\n        }\n      }\n\n      // If the Workspace is destroyed, revert the node to the EXPANDED state, because the\n      // NodeTranslator is no longer valid in this case.\n      workspace.arena.copy(kj::defer([&content]() {\n        content.bootstrapSchema = nullptr;\n        if (content.state > Content::EXPANDED) {\n          content.state = Content::EXPANDED;\n        }\n      }));\n\n      content.advanceState(Content::BOOTSTRAP);\n      // no break\n    }\n\n    case Content::BOOTSTRAP: {\n      if (minimumState <= Content::BOOTSTRAP) break;\n\n      // Create the final schema.\n      auto nodeSet = content.translator->finish();\n      content.finalSchema = nodeSet.node;\n      content.auxSchemas = kj::mv(nodeSet.auxNodes);\n\n      content.advanceState(Content::FINISHED);\n      // no break\n    }\n\n    case Content::FINISHED:\n      break;\n  }\n\n  return content;\n}"
  },
  {
    "function_name": "Compiler::Node::joinDisplayName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "429-440",
    "snippet": "kj::StringPtr Compiler::Node::joinDisplayName(\n    kj::Arena& arena, Node& parent, kj::StringPtr declName) {\n  kj::ArrayPtr<char> result = arena.allocateArray<char>(\n      parent.displayName.size() + declName.size() + 2);\n\n  size_t separatorPos = parent.displayName.size();\n  memcpy(result.begin(), parent.displayName.begin(), separatorPos);\n  result[separatorPos] = parent.parent == nullptr ? ':' : '.';\n  memcpy(result.begin() + separatorPos + 1, declName.begin(), declName.size());\n  result[result.size() - 1] = '\\0';\n  return kj::StringPtr(result.begin(), result.size() - 1);\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::StringPtr",
          "args": [
            "result.begin()",
            "result.size() - 1"
          ],
          "line": 439
        },
        "resolved": true,
        "details": {
          "function_name": "StringPtr",
          "container": "StringPtr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "61-61",
          "snippet": "inline StringPtr(const char* begin, const char* end): StringPtr(begin, end - begin) {}",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\nStringPtr {\n  inline StringPtr(const char* begin, const char* end): StringPtr(begin, end - begin) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "result.size",
          "args": [],
          "line": 439
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-capnp.c++",
          "lines": "74-74",
          "snippet": "inline size_t size() const { return amount; }",
          "includes": [
            "#include \"config.h\"",
            "#include <map>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <map>\n#include <algorithm>\n#include <kj/main.h>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nIndent {\n  inline size_t size() const { return amount; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "result.begin",
          "args": [],
          "line": 439
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-capnp.c++",
          "lines": "76-76",
          "snippet": "inline Iterator begin() const { return Iterator(0); }",
          "includes": [
            "#include \"config.h\"",
            "#include <map>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <map>\n#include <algorithm>\n#include <kj/main.h>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nIndent {\n  inline Iterator begin() const { return Iterator(0); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "result.begin() + separatorPos + 1",
            "declName.begin()",
            "declName.size()"
          ],
          "line": 437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "result.begin()",
            "parent.displayName.begin()",
            "separatorPos"
          ],
          "line": 435
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arena.allocateArray<char>",
          "args": [
            "parent.displayName.size() + declName.size() + 2"
          ],
          "line": 431
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nkj::StringPtr Compiler::Node::joinDisplayName(\n    kj::Arena& arena, Node& parent, kj::StringPtr declName) {\n  kj::ArrayPtr<char> result = arena.allocateArray<char>(\n      parent.displayName.size() + declName.size() + 2);\n\n  size_t separatorPos = parent.displayName.size();\n  memcpy(result.begin(), parent.displayName.begin(), separatorPos);\n  result[separatorPos] = parent.parent == nullptr ? ':' : '.';\n  memcpy(result.begin() + separatorPos + 1, declName.begin(), declName.size());\n  result[result.size() - 1] = '\\0';\n  return kj::StringPtr(result.begin(), result.size() - 1);\n}"
  },
  {
    "function_name": "Compiler::Node::generateId",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "420-427",
    "snippet": "uint64_t Compiler::Node::generateId(uint64_t parentId, kj::StringPtr declName,\n                                    Declaration::Id::Reader declId) {\n  if (declId.isUid()) {\n    return declId.getUid().getValue();\n  }\n\n  return generateChildId(parentId, declName);\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "generateChildId",
          "args": [
            "parentId",
            "declName"
          ],
          "line": 426
        },
        "resolved": true,
        "details": {
          "function_name": "generateChildId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/parser.c++",
          "lines": "62-83",
          "snippet": "uint64_t generateChildId(uint64_t parentId, kj::StringPtr childName) {\n  // Compute ID by MD5 hashing the concatenation of the parent ID and the declaration name, and\n  // then taking the first 8 bytes.\n\n  kj::byte parentIdBytes[sizeof(uint64_t)];\n  for (uint i = 0; i < sizeof(uint64_t); i++) {\n    parentIdBytes[i] = (parentId >> (i * 8)) & 0xff;\n  }\n\n  Md5 md5;\n  md5.update(kj::arrayPtr(parentIdBytes, kj::size(parentIdBytes)));\n  md5.update(childName);\n\n  kj::ArrayPtr<const kj::byte> resultBytes = md5.finish();\n\n  uint64_t result = 0;\n  for (uint i = 0; i < sizeof(uint64_t); i++) {\n    result = (result << 8) | resultBytes[i];\n  }\n\n  return result | (1ull << 63);\n}",
          "includes": [
            "#include <windows.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <kj/debug.h>",
            "#include <capnp/dynamic.h>",
            "#include \"md5.h\"",
            "#include \"parser.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <windows.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <kj/debug.h>\n#include <capnp/dynamic.h>\n#include \"md5.h\"\n#include \"parser.h\"\n\nuint64_t generateChildId(uint64_t parentId, kj::StringPtr childName) {\n  // Compute ID by MD5 hashing the concatenation of the parent ID and the declaration name, and\n  // then taking the first 8 bytes.\n\n  kj::byte parentIdBytes[sizeof(uint64_t)];\n  for (uint i = 0; i < sizeof(uint64_t); i++) {\n    parentIdBytes[i] = (parentId >> (i * 8)) & 0xff;\n  }\n\n  Md5 md5;\n  md5.update(kj::arrayPtr(parentIdBytes, kj::size(parentIdBytes)));\n  md5.update(childName);\n\n  kj::ArrayPtr<const kj::byte> resultBytes = md5.finish();\n\n  uint64_t result = 0;\n  for (uint i = 0; i < sizeof(uint64_t); i++) {\n    result = (result << 8) | resultBytes[i];\n  }\n\n  return result | (1ull << 63);\n}"
        }
      },
      {
        "call_info": {
          "callee": "declId.getUid",
          "args": [],
          "line": 423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "declId.getUid",
          "args": [],
          "line": 423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "declId.isUid",
          "args": [],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nuint64_t Compiler::Node::generateId(uint64_t parentId, kj::StringPtr declName,\n                                    Declaration::Id::Reader declId) {\n  if (declId.isUid()) {\n    return declId.getUid().getValue();\n  }\n\n  return generateChildId(parentId, declName);\n}"
  },
  {
    "function_name": "Compiler::Node::Node",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "407-418",
    "snippet": "Compiler::Node::Node(kj::StringPtr name, Declaration::Which kind,\n                     List<Declaration::BrandParameter>::Reader genericParams)\n    : module(nullptr),\n      parent(nullptr),\n      // It's helpful if these have unique IDs. Real type IDs can't be under 2^31 anyway.\n      id(1000 + static_cast<uint>(kind)),\n      displayName(name),\n      kind(kind),\n      genericParamCount(genericParams.size()),\n      isBuiltin(true),\n      startByte(0),\n      endByte(0) {}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "genericParams.size",
          "args": [],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-capnp.c++",
          "lines": "74-74",
          "snippet": "inline size_t size() const { return amount; }",
          "includes": [
            "#include \"config.h\"",
            "#include <map>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <map>\n#include <algorithm>\n#include <kj/main.h>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nIndent {\n  inline size_t size() const { return amount; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "static_cast<uint>",
          "args": [
            "kind"
          ],
          "line": 412
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nCompiler::Node::Node(kj::StringPtr name, Declaration::Which kind,\n                     List<Declaration::BrandParameter>::Reader genericParams)\n    : module(nullptr),\n      parent(nullptr),\n      // It's helpful if these have unique IDs. Real type IDs can't be under 2^31 anyway.\n      id(1000 + static_cast<uint>(kind)),\n      displayName(name),\n      kind(kind),\n      genericParamCount(genericParams.size()),\n      isBuiltin(true),\n      startByte(0),\n      endByte(0) {}"
  },
  {
    "function_name": "Compiler::Node::Node",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "385-405",
    "snippet": "Compiler::Node::Node(Node& parent, const Declaration::Reader& declaration)\n    : module(parent.module),\n      parent(parent),\n      declaration(declaration),\n      id(generateId(parent.id, declaration.getName().getValue(), declaration.getId())),\n      displayName(joinDisplayName(parent.module->getCompiler().getNodeArena(),\n                                  parent, declaration.getName().getValue())),\n      kind(declaration.which()),\n      genericParamCount(declaration.getParameters().size()),\n      isBuiltin(false) {\n  auto name = declaration.getName();\n  if (name.getValue().size() > 0) {\n    startByte = name.getStartByte();\n    endByte = name.getEndByte();\n  } else {\n    startByte = declaration.getStartByte();\n    endByte = declaration.getEndByte();\n  }\n\n  id = module->getCompiler().addNode(id, *this);\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "module->getCompiler",
          "args": [
            "id",
            "*this"
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module->getCompiler",
          "args": [],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "declaration.getEndByte",
          "args": [],
          "line": 401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "declaration.getStartByte",
          "args": [],
          "line": 400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "name.getEndByte",
          "args": [],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "name.getStartByte",
          "args": [],
          "line": 397
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "name.getValue",
          "args": [],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "name.getValue",
          "args": [],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "declaration.getName",
          "args": [],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "declaration.getParameters",
          "args": [],
          "line": 393
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "declaration.getParameters",
          "args": [],
          "line": 393
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "declaration.which",
          "args": [],
          "line": 392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "joinDisplayName",
          "args": [
            "parent.module->getCompiler().getNodeArena()",
            "parent",
            "declaration.getName().getValue()"
          ],
          "line": 390
        },
        "resolved": true,
        "details": {
          "function_name": "Compiler::Node::joinDisplayName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
          "lines": "429-440",
          "snippet": "kj::StringPtr Compiler::Node::joinDisplayName(\n    kj::Arena& arena, Node& parent, kj::StringPtr declName) {\n  kj::ArrayPtr<char> result = arena.allocateArray<char>(\n      parent.displayName.size() + declName.size() + 2);\n\n  size_t separatorPos = parent.displayName.size();\n  memcpy(result.begin(), parent.displayName.begin(), separatorPos);\n  result[separatorPos] = parent.parent == nullptr ? ':' : '.';\n  memcpy(result.begin() + separatorPos + 1, declName.begin(), declName.size());\n  result[result.size() - 1] = '\\0';\n  return kj::StringPtr(result.begin(), result.size() - 1);\n}",
          "includes": [
            "#include \"md5.h\"",
            "#include \"node-translator.h\"",
            "#include <unordered_map>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/message.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/arena.h>",
            "#include <kj/mutex.h>",
            "#include \"parser.h\"      // only for generateChildId()",
            "#include \"compiler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nkj::StringPtr Compiler::Node::joinDisplayName(\n    kj::Arena& arena, Node& parent, kj::StringPtr declName) {\n  kj::ArrayPtr<char> result = arena.allocateArray<char>(\n      parent.displayName.size() + declName.size() + 2);\n\n  size_t separatorPos = parent.displayName.size();\n  memcpy(result.begin(), parent.displayName.begin(), separatorPos);\n  result[separatorPos] = parent.parent == nullptr ? ':' : '.';\n  memcpy(result.begin() + separatorPos + 1, declName.begin(), declName.size());\n  result[result.size() - 1] = '\\0';\n  return kj::StringPtr(result.begin(), result.size() - 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "declaration.getName",
          "args": [],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "declaration.getName",
          "args": [],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parent.module->getCompiler",
          "args": [],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parent.module->getCompiler",
          "args": [],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "generateId",
          "args": [
            "parent.id",
            "declaration.getName().getValue()",
            "declaration.getId()"
          ],
          "line": 389
        },
        "resolved": true,
        "details": {
          "function_name": "Compiler::Node::generateId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
          "lines": "420-427",
          "snippet": "uint64_t Compiler::Node::generateId(uint64_t parentId, kj::StringPtr declName,\n                                    Declaration::Id::Reader declId) {\n  if (declId.isUid()) {\n    return declId.getUid().getValue();\n  }\n\n  return generateChildId(parentId, declName);\n}",
          "includes": [
            "#include \"md5.h\"",
            "#include \"node-translator.h\"",
            "#include <unordered_map>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/message.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/arena.h>",
            "#include <kj/mutex.h>",
            "#include \"parser.h\"      // only for generateChildId()",
            "#include \"compiler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nuint64_t Compiler::Node::generateId(uint64_t parentId, kj::StringPtr declName,\n                                    Declaration::Id::Reader declId) {\n  if (declId.isUid()) {\n    return declId.getUid().getValue();\n  }\n\n  return generateChildId(parentId, declName);\n}"
        }
      },
      {
        "call_info": {
          "callee": "declaration.getId",
          "args": [],
          "line": 389
        },
        "resolved": true,
        "details": {
          "function_name": "getId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
          "lines": "75-75",
          "snippet": "uint64_t getId() { return id; }",
          "includes": [
            "#include \"md5.h\"",
            "#include \"node-translator.h\"",
            "#include <unordered_map>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/message.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/arena.h>",
            "#include <kj/mutex.h>",
            "#include \"parser.h\"      // only for generateChildId()",
            "#include \"compiler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nuint64_t getId() { return id; }"
        }
      },
      {
        "call_info": {
          "callee": "declaration.getName",
          "args": [],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "declaration.getName",
          "args": [],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nCompiler::Node::Node(Node& parent, const Declaration::Reader& declaration)\n    : module(parent.module),\n      parent(parent),\n      declaration(declaration),\n      id(generateId(parent.id, declaration.getName().getValue(), declaration.getId())),\n      displayName(joinDisplayName(parent.module->getCompiler().getNodeArena(),\n                                  parent, declaration.getName().getValue())),\n      kind(declaration.which()),\n      genericParamCount(declaration.getParameters().size()),\n      isBuiltin(false) {\n  auto name = declaration.getName();\n  if (name.getValue().size() > 0) {\n    startByte = name.getStartByte();\n    endByte = name.getEndByte();\n  } else {\n    startByte = declaration.getStartByte();\n    endByte = declaration.getEndByte();\n  }\n\n  id = module->getCompiler().addNode(id, *this);\n}"
  },
  {
    "function_name": "Compiler::Node::Node",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "364-383",
    "snippet": "Compiler::Node::Node(CompiledModule& module)\n    : module(&module),\n      parent(nullptr),\n      declaration(module.getParsedFile().getRoot()),\n      id(generateId(0, declaration.getName().getValue(), declaration.getId())),\n      displayName(module.getSourceName()),\n      kind(declaration.which()),\n      genericParamCount(declaration.getParameters().size()),\n      isBuiltin(false) {\n  auto name = declaration.getName();\n  if (name.getValue().size() > 0) {\n    startByte = name.getStartByte();\n    endByte = name.getEndByte();\n  } else {\n    startByte = declaration.getStartByte();\n    endByte = declaration.getEndByte();\n  }\n\n  id = module.getCompiler().addNode(id, *this);\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "module.getCompiler",
          "args": [
            "id",
            "*this"
          ],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module.getCompiler",
          "args": [],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "declaration.getEndByte",
          "args": [],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "declaration.getStartByte",
          "args": [],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "name.getEndByte",
          "args": [],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "name.getStartByte",
          "args": [],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "name.getValue",
          "args": [],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "name.getValue",
          "args": [],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "declaration.getName",
          "args": [],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "declaration.getParameters",
          "args": [],
          "line": 371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "declaration.getParameters",
          "args": [],
          "line": 371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "declaration.which",
          "args": [],
          "line": 370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module.getSourceName",
          "args": [],
          "line": 369
        },
        "resolved": true,
        "details": {
          "function_name": "getSourceName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
          "lines": "232-232",
          "snippet": "kj::StringPtr getSourceName() { return parserModule.getSourceName(); }",
          "includes": [
            "#include \"md5.h\"",
            "#include \"node-translator.h\"",
            "#include <unordered_map>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/message.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/arena.h>",
            "#include <kj/mutex.h>",
            "#include \"parser.h\"      // only for generateChildId()",
            "#include \"compiler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nkj::StringPtr getSourceName() { return parserModule.getSourceName(); }"
        }
      },
      {
        "call_info": {
          "callee": "generateId",
          "args": [
            "0",
            "declaration.getName().getValue()",
            "declaration.getId()"
          ],
          "line": 368
        },
        "resolved": true,
        "details": {
          "function_name": "Compiler::Node::generateId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
          "lines": "420-427",
          "snippet": "uint64_t Compiler::Node::generateId(uint64_t parentId, kj::StringPtr declName,\n                                    Declaration::Id::Reader declId) {\n  if (declId.isUid()) {\n    return declId.getUid().getValue();\n  }\n\n  return generateChildId(parentId, declName);\n}",
          "includes": [
            "#include \"md5.h\"",
            "#include \"node-translator.h\"",
            "#include <unordered_map>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/message.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/arena.h>",
            "#include <kj/mutex.h>",
            "#include \"parser.h\"      // only for generateChildId()",
            "#include \"compiler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nuint64_t Compiler::Node::generateId(uint64_t parentId, kj::StringPtr declName,\n                                    Declaration::Id::Reader declId) {\n  if (declId.isUid()) {\n    return declId.getUid().getValue();\n  }\n\n  return generateChildId(parentId, declName);\n}"
        }
      },
      {
        "call_info": {
          "callee": "declaration.getId",
          "args": [],
          "line": 368
        },
        "resolved": true,
        "details": {
          "function_name": "getId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
          "lines": "75-75",
          "snippet": "uint64_t getId() { return id; }",
          "includes": [
            "#include \"md5.h\"",
            "#include \"node-translator.h\"",
            "#include <unordered_map>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/message.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/arena.h>",
            "#include <kj/mutex.h>",
            "#include \"parser.h\"      // only for generateChildId()",
            "#include \"compiler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nuint64_t getId() { return id; }"
        }
      },
      {
        "call_info": {
          "callee": "declaration.getName",
          "args": [],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "declaration.getName",
          "args": [],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module.getParsedFile",
          "args": [],
          "line": 367
        },
        "resolved": true,
        "details": {
          "function_name": "getParsedFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
          "lines": "230-230",
          "snippet": "ParsedFile::Reader getParsedFile() { return content.getReader(); }",
          "includes": [
            "#include \"md5.h\"",
            "#include \"node-translator.h\"",
            "#include <unordered_map>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/message.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/arena.h>",
            "#include <kj/mutex.h>",
            "#include \"parser.h\"      // only for generateChildId()",
            "#include \"compiler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nParsedFile::Reader getParsedFile() { return content.getReader(); }"
        }
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nCompiler::Node::Node(CompiledModule& module)\n    : module(&module),\n      parent(nullptr),\n      declaration(module.getParsedFile().getRoot()),\n      id(generateId(0, declaration.getName().getValue(), declaration.getId())),\n      displayName(module.getSourceName()),\n      kind(declaration.which()),\n      genericParamCount(declaration.getParameters().size()),\n      isBuiltin(false) {\n  auto name = declaration.getName();\n  if (name.getValue().size() > 0) {\n    startByte = name.getStartByte();\n    endByte = name.getEndByte();\n  } else {\n    startByte = declaration.getStartByte();\n    endByte = declaration.getEndByte();\n  }\n\n  id = module.getCompiler().addNode(id, *this);\n}"
  },
  {
    "function_name": "Compiler::Alias::compile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "340-360",
    "snippet": "kj::Maybe<NodeTranslator::Resolver::ResolveResult> Compiler::Alias::compile() {\n  if (!initialized) {\n    initialized = true;\n\n    auto& workspace = module.getCompiler().getWorkspace();\n    brandOrphan = workspace.orphanage.newOrphan<schema::Brand>();\n\n    // If the Workspace is destroyed, revert the alias to the uninitialized state, because the\n    // orphan we created is no longer valid in this case.\n    workspace.arena.copy(kj::defer([this]() {\n      initialized = false;\n      brandOrphan = Orphan<schema::Brand>();\n    }));\n\n    target = NodeTranslator::compileDecl(\n        parent.getId(), parent.getParameterCount(), parent,\n        module.getErrorReporter(), targetName, brandOrphan.get());\n  }\n\n  return target;\n}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "NodeTranslator::compileDecl",
          "args": [
            "parent.getId()",
            "parent.getParameterCount()",
            "parent",
            "module.getErrorReporter()",
            "targetName",
            "brandOrphan.get()"
          ],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "NodeTranslator::compileDecl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/node-translator.c++",
          "lines": "2456-2465",
          "snippet": "kj::Maybe<NodeTranslator::Resolver::ResolveResult> NodeTranslator::compileDecl(\n    uint64_t scopeId, uint scopeParameterCount, Resolver& resolver, ErrorReporter& errorReporter,\n    Expression::Reader expression, schema::Brand::Builder brandBuilder) {\n  auto scope = kj::refcounted<BrandScope>(errorReporter, scopeId, scopeParameterCount, resolver);\n  KJ_IF_MAYBE(decl, scope->compileDeclExpression(expression, resolver, noImplicitParams())) {\n    return decl->asResolveResult(scope->getScopeId(), brandBuilder);\n  } else {\n    return nullptr;\n  }\n}",
          "includes": [
            "#include <map>",
            "#include <set>",
            "#include <kj/arena.h>",
            "#include <kj/debug.h>",
            "#include \"parser.h\"      // only for generateGroupId()",
            "#include \"node-translator.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "DuplicateOrdinalDetector dupDetector(errorReporter);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <map>\n#include <set>\n#include <kj/arena.h>\n#include <kj/debug.h>\n#include \"parser.h\"      // only for generateGroupId()\n#include \"node-translator.h\"\n\nDuplicateOrdinalDetector dupDetector(errorReporter);\n\nkj::Maybe<NodeTranslator::Resolver::ResolveResult> NodeTranslator::compileDecl(\n    uint64_t scopeId, uint scopeParameterCount, Resolver& resolver, ErrorReporter& errorReporter,\n    Expression::Reader expression, schema::Brand::Builder brandBuilder) {\n  auto scope = kj::refcounted<BrandScope>(errorReporter, scopeId, scopeParameterCount, resolver);\n  KJ_IF_MAYBE(decl, scope->compileDeclExpression(expression, resolver, noImplicitParams())) {\n    return decl->asResolveResult(scope->getScopeId(), brandBuilder);\n  } else {\n    return nullptr;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "brandOrphan.get",
          "args": [],
          "line": 356
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "module.getErrorReporter",
          "args": [],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parent.getParameterCount",
          "args": [],
          "line": 355
        },
        "resolved": true,
        "details": {
          "function_name": "getParameterCount",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
          "lines": "76-76",
          "snippet": "uint getParameterCount() { return genericParamCount; }",
          "includes": [
            "#include \"md5.h\"",
            "#include \"node-translator.h\"",
            "#include <unordered_map>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/message.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/arena.h>",
            "#include <kj/mutex.h>",
            "#include \"parser.h\"      // only for generateChildId()",
            "#include \"compiler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nuint getParameterCount() { return genericParamCount; }"
        }
      },
      {
        "call_info": {
          "callee": "parent.getId",
          "args": [],
          "line": 355
        },
        "resolved": true,
        "details": {
          "function_name": "getId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
          "lines": "75-75",
          "snippet": "uint64_t getId() { return id; }",
          "includes": [
            "#include \"md5.h\"",
            "#include \"node-translator.h\"",
            "#include <unordered_map>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/message.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/arena.h>",
            "#include <kj/mutex.h>",
            "#include \"parser.h\"      // only for generateChildId()",
            "#include \"compiler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nuint64_t getId() { return id; }"
        }
      },
      {
        "call_info": {
          "callee": "workspace.arena.copy",
          "args": [
            "kj::defer([this]() {\n      initialized = false;\n      brandOrphan = Orphan<schema::Brand>();\n    })"
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::defer",
          "args": [
            "[this]() {\n      initialized = false;\n      brandOrphan = Orphan<schema::Brand>();\n    }"
          ],
          "line": 349
        },
        "resolved": true,
        "details": {
          "function_name": "defer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "1272-1281",
          "snippet": "_::Deferred<Decay<Func>> defer(Func&& func) {\n  // Returns an object which will invoke the given functor in its destructor.  The object is not\n  // copyable but is movable with the semantics you'd expect.  Since the return type is private,\n  // you need to assign to an `auto` variable.\n  //\n  // The KJ_DEFER macro provides slightly more convenient syntax for the common case where you\n  // want some code to run at function exit.\n\n  return _::Deferred<Decay<Func>>(kj::fwd<Func>(func));\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\n_::Deferred<Decay<Func>> defer(Func&& func) {\n  // Returns an object which will invoke the given functor in its destructor.  The object is not\n  // copyable but is movable with the semantics you'd expect.  Since the return type is private,\n  // you need to assign to an `auto` variable.\n  //\n  // The KJ_DEFER macro provides slightly more convenient syntax for the common case where you\n  // want some code to run at function exit.\n\n  return _::Deferred<Decay<Func>>(kj::fwd<Func>(func));\n}"
        }
      },
      {
        "call_info": {
          "callee": "Orphan<schema::Brand>",
          "args": [],
          "line": 351
        },
        "resolved": true,
        "details": {
          "function_name": "OrphanBuilder",
          "container": "OrphanBuilder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/layout.h",
          "lines": "709-709",
          "snippet": "inline OrphanBuilder(): segment(nullptr), location(nullptr) { memset(&tag, 0, sizeof(tag)); }",
          "includes": [
            "#include \"endian.h\"",
            "#include \"blob.h\"",
            "#include \"common.h\"",
            "#include <kj/memory.h>",
            "#include <kj/common.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"endian.h\"\n#include \"blob.h\"\n#include \"common.h\"\n#include <kj/memory.h>\n#include <kj/common.h>\n\nOrphanBuilder {\n  inline OrphanBuilder(): segment(nullptr), location(nullptr) { memset(&tag, 0, sizeof(tag)); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "workspace.orphanage.newOrphan<schema::Brand>",
          "args": [],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module.getCompiler",
          "args": [],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "module.getCompiler",
          "args": [],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nkj::Maybe<NodeTranslator::Resolver::ResolveResult> Compiler::Alias::compile() {\n  if (!initialized) {\n    initialized = true;\n\n    auto& workspace = module.getCompiler().getWorkspace();\n    brandOrphan = workspace.orphanage.newOrphan<schema::Brand>();\n\n    // If the Workspace is destroyed, revert the alias to the uninitialized state, because the\n    // orphan we created is no longer valid in this case.\n    workspace.arena.copy(kj::defer([this]() {\n      initialized = false;\n      brandOrphan = Orphan<schema::Brand>();\n    }));\n\n    target = NodeTranslator::compileDecl(\n        parent.getId(), parent.getParameterCount(), parent,\n        module.getErrorReporter(), targetName, brandOrphan.get());\n  }\n\n  return target;\n}"
  },
  {
    "function_name": "shouldCompileAnnotations",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "292-294",
    "snippet": "inline bool shouldCompileAnnotations() {\n    return annotationFlag == AnnotationFlag::COMPILE_ANNOTATIONS;\n  }",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\ninline bool shouldCompileAnnotations() {\n    return annotationFlag == AnnotationFlag::COMPILE_ANNOTATIONS;\n  }"
  },
  {
    "function_name": "Workspace",
    "container": "Workspace",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "281-283",
    "snippet": "inline explicit Workspace(const SchemaLoader::LazyLoadCallback& loaderCallback)\n        : orphanage(message.getOrphanage()),\n          bootstrapLoader(loaderCallback) {}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "message.getOrphanage",
          "args": [],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nWorkspace {\n  inline explicit Workspace(const SchemaLoader::LazyLoadCallback& loaderCallback)\n          : orphanage(message.getOrphanage()),\n            bootstrapLoader(loaderCallback) {}\n}"
  },
  {
    "function_name": "getSourceName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "232-232",
    "snippet": "kj::StringPtr getSourceName() { return parserModule.getSourceName(); }",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nkj::StringPtr getSourceName() { return parserModule.getSourceName(); }"
  },
  {
    "function_name": "getParsedFile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "230-230",
    "snippet": "ParsedFile::Reader getParsedFile() { return content.getReader(); }",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "content.getReader",
          "args": [],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nParsedFile::Reader getParsedFile() { return content.getReader(); }"
  },
  {
    "function_name": "advanceState",
    "container": "Content",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "148-150",
    "snippet": "inline void advanceState(State newState) {\n      state = newState;\n    }",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nContent {\n  inline void advanceState(State newState) {\n        state = newState;\n      }\n}"
  },
  {
    "function_name": "stateHasReached",
    "container": "Content",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "145-147",
    "snippet": "inline bool stateHasReached(State minimumState) {\n      return state >= minimumState;\n    }",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nContent {\n  inline bool stateHasReached(State minimumState) {\n        return state >= minimumState;\n      }\n}"
  },
  {
    "function_name": "Content",
    "container": "Content",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "134-134",
    "snippet": "inline Content(): state(STUB) {}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nContent {\n  inline Content(): state(STUB) {}\n}"
  },
  {
    "function_name": "getKind",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "77-77",
    "snippet": "Declaration::Which getKind() { return kind; }",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nDeclaration::Which getKind() { return kind; }"
  },
  {
    "function_name": "getParameterCount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "76-76",
    "snippet": "uint getParameterCount() { return genericParamCount; }",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nuint getParameterCount() { return genericParamCount; }"
  },
  {
    "function_name": "getId",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "75-75",
    "snippet": "uint64_t getId() { return id; }",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nuint64_t getId() { return id; }"
  },
  {
    "function_name": "Alias",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
    "lines": "40-41",
    "snippet": "Alias(CompiledModule& module, Node& parent, const Expression::Reader& targetName)\n      : module(module), parent(parent), targetName(targetName) {}",
    "includes": [
      "#include \"md5.h\"",
      "#include \"node-translator.h\"",
      "#include <unordered_map>",
      "#include <set>",
      "#include <map>",
      "#include <capnp/message.h>",
      "#include <kj/debug.h>",
      "#include <kj/vector.h>",
      "#include <kj/arena.h>",
      "#include <kj/mutex.h>",
      "#include \"parser.h\"      // only for generateChildId()",
      "#include \"compiler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nAlias(CompiledModule& module, Node& parent, const Expression::Reader& targetName)\n      : module(module), parent(parent), targetName(targetName) {}"
  }
]