[
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/function-test.c++",
    "lines": "93-118",
    "snippet": "TEST(ConstFunction, Method) {\n  TestConstType obj;\n  ConstFunction<int(int, int)> f = KJ_BIND_METHOD(obj, foo);\n  ConstFunction<uint(uint, uint)> f2 = KJ_BIND_METHOD(obj, foo);\n\n  EXPECT_EQ(123 + 456, f(123, 456));\n  EXPECT_EQ(7 + 8 + 1, f(7, 8));\n  EXPECT_EQ(9u + 2u + 2u, f2(2, 9));\n\n  EXPECT_EQ(3, obj.callCount);\n\n  // Bind to a temporary.\n  f = KJ_BIND_METHOD(TestConstType(10), foo);\n\n  EXPECT_EQ(123 + 456 + 10, f(123, 456));\n  EXPECT_EQ(7 + 8 + 11, f(7, 8));\n  EXPECT_EQ(9 + 2 + 12, f(2, 9));\n\n  // Bind to a move.\n  f = KJ_BIND_METHOD(kj::mv(obj), foo);\n  obj.callCount = 1234;\n\n  EXPECT_EQ(123 + 456 + 3, f(123, 456));\n  EXPECT_EQ(7 + 8 + 4, f(7, 8));\n  EXPECT_EQ(9 + 2 + 5, f(2, 9));\n}",
    "includes": [
      "#include <kj/compat/gtest.h>",
      "#include \"function.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "9 + 2 + 5",
            "f(2, 9)"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "f",
          "args": [
            "2",
            "9"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "foo",
          "container": "TestConstType",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/function-test.c++",
          "lines": "88-90",
          "snippet": "int foo(int a, int b) const {\n    return a + b + callCount++;\n  }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include \"function.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include \"function.h\"\n\nTestConstType {\n  int foo(int a, int b) const {\n      return a + b + callCount++;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "7 + 8 + 4",
            "f(7, 8)"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "123 + 456 + 3",
            "f(123, 456)"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_BIND_METHOD",
          "args": [
            "kj::mv(obj)",
            "foo"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "obj"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "9 + 2 + 12",
            "f(2, 9)"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "7 + 8 + 11",
            "f(7, 8)"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "123 + 456 + 10",
            "f(123, 456)"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_BIND_METHOD",
          "args": [
            "TestConstType(10)",
            "foo"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TestConstType",
          "args": [
            "10"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "3",
            "obj.callCount"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "9u + 2u + 2u",
            "f2(2, 9)"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "f2",
          "args": [
            "2",
            "9"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "7 + 8 + 1",
            "f(7, 8)"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "123 + 456",
            "f(123, 456)"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_BIND_METHOD",
          "args": [
            "obj",
            "foo"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_BIND_METHOD",
          "args": [
            "obj",
            "foo"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/compat/gtest.h>\n#include \"function.h\"\n\nTEST(ConstFunction, Method) {\n  TestConstType obj;\n  ConstFunction<int(int, int)> f = KJ_BIND_METHOD(obj, foo);\n  ConstFunction<uint(uint, uint)> f2 = KJ_BIND_METHOD(obj, foo);\n\n  EXPECT_EQ(123 + 456, f(123, 456));\n  EXPECT_EQ(7 + 8 + 1, f(7, 8));\n  EXPECT_EQ(9u + 2u + 2u, f2(2, 9));\n\n  EXPECT_EQ(3, obj.callCount);\n\n  // Bind to a temporary.\n  f = KJ_BIND_METHOD(TestConstType(10), foo);\n\n  EXPECT_EQ(123 + 456 + 10, f(123, 456));\n  EXPECT_EQ(7 + 8 + 11, f(7, 8));\n  EXPECT_EQ(9 + 2 + 12, f(2, 9));\n\n  // Bind to a move.\n  f = KJ_BIND_METHOD(kj::mv(obj), foo);\n  obj.callCount = 1234;\n\n  EXPECT_EQ(123 + 456 + 3, f(123, 456));\n  EXPECT_EQ(7 + 8 + 4, f(7, 8));\n  EXPECT_EQ(9 + 2 + 5, f(2, 9));\n}"
  },
  {
    "function_name": "foo",
    "container": "TestConstType",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/function-test.c++",
    "lines": "88-90",
    "snippet": "int foo(int a, int b) const {\n    return a + b + callCount++;\n  }",
    "includes": [
      "#include <kj/compat/gtest.h>",
      "#include \"function.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <kj/compat/gtest.h>\n#include \"function.h\"\n\nTestConstType {\n  int foo(int a, int b) const {\n      return a + b + callCount++;\n    }\n}"
  },
  {
    "function_name": "TestConstType",
    "container": "TestConstType",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/function-test.c++",
    "lines": "83-83",
    "snippet": "TestConstType(int callCount = 0): callCount(callCount) {}",
    "includes": [
      "#include <kj/compat/gtest.h>",
      "#include \"function.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <kj/compat/gtest.h>\n#include \"function.h\"\n\nTestConstType {\n  TestConstType(int callCount = 0): callCount(callCount) {}\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/function-test.c++",
    "lines": "53-78",
    "snippet": "TEST(Function, Method) {\n  TestType obj;\n  Function<int(int, int)> f = KJ_BIND_METHOD(obj, foo);\n  Function<uint(uint, uint)> f2 = KJ_BIND_METHOD(obj, foo);\n\n  EXPECT_EQ(123 + 456, f(123, 456));\n  EXPECT_EQ(7 + 8 + 1, f(7, 8));\n  EXPECT_EQ(9u + 2u + 2u, f2(2, 9));\n\n  EXPECT_EQ(3, obj.callCount);\n\n  // Bind to a temporary.\n  f = KJ_BIND_METHOD(TestType(10), foo);\n\n  EXPECT_EQ(123 + 456 + 10, f(123, 456));\n  EXPECT_EQ(7 + 8 + 11, f(7, 8));\n  EXPECT_EQ(9 + 2 + 12, f(2, 9));\n\n  // Bind to a move.\n  f = KJ_BIND_METHOD(kj::mv(obj), foo);\n  obj.callCount = 1234;\n\n  EXPECT_EQ(123 + 456 + 3, f(123, 456));\n  EXPECT_EQ(7 + 8 + 4, f(7, 8));\n  EXPECT_EQ(9 + 2 + 5, f(2, 9));\n}",
    "includes": [
      "#include <kj/compat/gtest.h>",
      "#include \"function.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "9 + 2 + 5",
            "f(2, 9)"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "f",
          "args": [
            "2",
            "9"
          ],
          "line": 77
        },
        "resolved": true,
        "details": {
          "function_name": "foo",
          "container": "TestConstType",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/function-test.c++",
          "lines": "88-90",
          "snippet": "int foo(int a, int b) const {\n    return a + b + callCount++;\n  }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include \"function.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include \"function.h\"\n\nTestConstType {\n  int foo(int a, int b) const {\n      return a + b + callCount++;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "7 + 8 + 4",
            "f(7, 8)"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "123 + 456 + 3",
            "f(123, 456)"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_BIND_METHOD",
          "args": [
            "kj::mv(obj)",
            "foo"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "obj"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "9 + 2 + 12",
            "f(2, 9)"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "7 + 8 + 11",
            "f(7, 8)"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "123 + 456 + 10",
            "f(123, 456)"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_BIND_METHOD",
          "args": [
            "TestType(10)",
            "foo"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TestType",
          "args": [
            "10"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "3",
            "obj.callCount"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "9u + 2u + 2u",
            "f2(2, 9)"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "f2",
          "args": [
            "2",
            "9"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "7 + 8 + 1",
            "f(7, 8)"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "123 + 456",
            "f(123, 456)"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_BIND_METHOD",
          "args": [
            "obj",
            "foo"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_BIND_METHOD",
          "args": [
            "obj",
            "foo"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/compat/gtest.h>\n#include \"function.h\"\n\nTEST(Function, Method) {\n  TestType obj;\n  Function<int(int, int)> f = KJ_BIND_METHOD(obj, foo);\n  Function<uint(uint, uint)> f2 = KJ_BIND_METHOD(obj, foo);\n\n  EXPECT_EQ(123 + 456, f(123, 456));\n  EXPECT_EQ(7 + 8 + 1, f(7, 8));\n  EXPECT_EQ(9u + 2u + 2u, f2(2, 9));\n\n  EXPECT_EQ(3, obj.callCount);\n\n  // Bind to a temporary.\n  f = KJ_BIND_METHOD(TestType(10), foo);\n\n  EXPECT_EQ(123 + 456 + 10, f(123, 456));\n  EXPECT_EQ(7 + 8 + 11, f(7, 8));\n  EXPECT_EQ(9 + 2 + 12, f(2, 9));\n\n  // Bind to a move.\n  f = KJ_BIND_METHOD(kj::mv(obj), foo);\n  obj.callCount = 1234;\n\n  EXPECT_EQ(123 + 456 + 3, f(123, 456));\n  EXPECT_EQ(7 + 8 + 4, f(7, 8));\n  EXPECT_EQ(9 + 2 + 5, f(2, 9));\n}"
  },
  {
    "function_name": "foo",
    "container": "TestType",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/function-test.c++",
    "lines": "48-50",
    "snippet": "int foo(int a, int b) {\n    return a + b + callCount++;\n  }",
    "includes": [
      "#include <kj/compat/gtest.h>",
      "#include \"function.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <kj/compat/gtest.h>\n#include \"function.h\"\n\nTestType {\n  int foo(int a, int b) {\n      return a + b + callCount++;\n    }\n}"
  },
  {
    "function_name": "TestType",
    "container": "TestType",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/function-test.c++",
    "lines": "43-43",
    "snippet": "TestType(int callCount = 0): callCount(callCount) {}",
    "includes": [
      "#include <kj/compat/gtest.h>",
      "#include \"function.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <kj/compat/gtest.h>\n#include \"function.h\"\n\nTestType {\n  TestType(int callCount = 0): callCount(callCount) {}\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/function-test.c++",
    "lines": "28-38",
    "snippet": "TEST(Function, Lambda) {\n  int i = 0;\n\n  Function<int(int, int)> f = [&](int a, int b) { return a + b + i++; };\n\n  EXPECT_EQ(123 + 456, f(123, 456));\n  EXPECT_EQ(7 + 8 + 1, f(7, 8));\n  EXPECT_EQ(9 + 2 + 2, f(2, 9));\n\n  EXPECT_EQ(i, 3);\n}",
    "includes": [
      "#include <kj/compat/gtest.h>",
      "#include \"function.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "i",
            "3"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "9 + 2 + 2",
            "f(2, 9)"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "f",
          "args": [
            "2",
            "9"
          ],
          "line": 35
        },
        "resolved": true,
        "details": {
          "function_name": "foo",
          "container": "TestConstType",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/function-test.c++",
          "lines": "88-90",
          "snippet": "int foo(int a, int b) const {\n    return a + b + callCount++;\n  }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include \"function.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include \"function.h\"\n\nTestConstType {\n  int foo(int a, int b) const {\n      return a + b + callCount++;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "7 + 8 + 1",
            "f(7, 8)"
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "123 + 456",
            "f(123, 456)"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/compat/gtest.h>\n#include \"function.h\"\n\nTEST(Function, Lambda) {\n  int i = 0;\n\n  Function<int(int, int)> f = [&](int a, int b) { return a + b + i++; };\n\n  EXPECT_EQ(123 + 456, f(123, 456));\n  EXPECT_EQ(7 + 8 + 1, f(7, 8));\n  EXPECT_EQ(9 + 2 + 2, f(2, 9));\n\n  EXPECT_EQ(i, 3);\n}"
  }
]