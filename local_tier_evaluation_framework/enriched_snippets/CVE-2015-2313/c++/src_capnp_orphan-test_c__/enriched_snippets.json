[
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "1016-1035",
    "snippet": "TEST(Orphans, TruncateText) {\n  MallocMessageBuilder message;\n  auto orphan = message.getOrphanage().newOrphan<Text>(17);\n  auto builder = orphan.get();\n  memset(builder.begin(), 'a', builder.size());\n\n  EXPECT_EQ(4, message.getSegmentsForOutput()[0].size());\n  orphan.truncate(2);\n  EXPECT_EQ(2, message.getSegmentsForOutput()[0].size());\n\n  auto reader = orphan.getReader();\n  EXPECT_EQ(2, reader.size());\n  EXPECT_EQ(builder.begin(), reader.begin());\n\n  EXPECT_EQ('a', builder[0]);\n  EXPECT_EQ('a', builder[1]);\n  EXPECT_EQ('\\0', builder[2]);\n  EXPECT_EQ('\\0', builder[3]);\n  EXPECT_EQ('\\0', builder[16]);\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "'\\0'",
            "builder[16]"
          ],
          "line": 1034
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "'\\0'",
            "builder[3]"
          ],
          "line": 1033
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "'\\0'",
            "builder[2]"
          ],
          "line": 1032
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "'a'",
            "builder[1]"
          ],
          "line": 1031
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "'a'",
            "builder[0]"
          ],
          "line": 1030
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "builder.begin()",
            "reader.begin()"
          ],
          "line": 1028
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.begin",
          "args": [],
          "line": 1028
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "550-550",
          "snippet": "inline Iterator begin() { return Iterator(this, 0); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Iterator begin() { return Iterator(this, 0); }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "2",
            "reader.size()"
          ],
          "line": 1027
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.size",
          "args": [],
          "line": 1027
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "599-599",
          "snippet": "inline uint size() { return _builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline uint size() { return _builder.size() / ELEMENTS; }"
        }
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 1026
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "2",
            "message.getSegmentsForOutput()[0].size()"
          ],
          "line": 1024
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "message.getSegmentsForOutput",
          "args": [],
          "line": 1024
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "message.getSegmentsForOutput",
          "args": [],
          "line": 1024
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.truncate",
          "args": [
            "2"
          ],
          "line": 1023
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "4",
            "message.getSegmentsForOutput()[0].size()"
          ],
          "line": 1022
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "message.getSegmentsForOutput",
          "args": [],
          "line": 1022
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "message.getSegmentsForOutput",
          "args": [],
          "line": 1022
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "builder.begin()",
            "'a'",
            "builder.size()"
          ],
          "line": 1020
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.get",
          "args": [],
          "line": 1019
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "message.getOrphanage",
          "args": [
            "17"
          ],
          "line": 1018
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "message.getOrphanage",
          "args": [],
          "line": 1018
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, TruncateText) {\n  MallocMessageBuilder message;\n  auto orphan = message.getOrphanage().newOrphan<Text>(17);\n  auto builder = orphan.get();\n  memset(builder.begin(), 'a', builder.size());\n\n  EXPECT_EQ(4, message.getSegmentsForOutput()[0].size());\n  orphan.truncate(2);\n  EXPECT_EQ(2, message.getSegmentsForOutput()[0].size());\n\n  auto reader = orphan.getReader();\n  EXPECT_EQ(2, reader.size());\n  EXPECT_EQ(builder.begin(), reader.begin());\n\n  EXPECT_EQ('a', builder[0]);\n  EXPECT_EQ('a', builder[1]);\n  EXPECT_EQ('\\0', builder[2]);\n  EXPECT_EQ('\\0', builder[3]);\n  EXPECT_EQ('\\0', builder[16]);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "995-1014",
    "snippet": "TEST(Orphans, Truncate) {\n  MallocMessageBuilder message;\n  auto orphan = message.getOrphanage().newOrphan<Data>(17);\n  auto builder = orphan.get();\n  memset(builder.begin(), 123, builder.size());\n\n  EXPECT_EQ(4, message.getSegmentsForOutput()[0].size());\n  orphan.truncate(2);\n  EXPECT_EQ(2, message.getSegmentsForOutput()[0].size());\n\n  auto reader = orphan.getReader();\n  EXPECT_EQ(2, reader.size());\n  EXPECT_EQ(builder.begin(), reader.begin());\n\n  EXPECT_EQ(123, builder[0]);\n  EXPECT_EQ(123, builder[1]);\n  EXPECT_EQ(0, builder[2]);\n  EXPECT_EQ(0, builder[3]);\n  EXPECT_EQ(0, builder[16]);\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "0",
            "builder[16]"
          ],
          "line": 1013
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "0",
            "builder[3]"
          ],
          "line": 1012
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "0",
            "builder[2]"
          ],
          "line": 1011
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "123",
            "builder[1]"
          ],
          "line": 1010
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "123",
            "builder[0]"
          ],
          "line": 1009
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "builder.begin()",
            "reader.begin()"
          ],
          "line": 1007
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.begin",
          "args": [],
          "line": 1007
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "550-550",
          "snippet": "inline Iterator begin() { return Iterator(this, 0); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Iterator begin() { return Iterator(this, 0); }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "2",
            "reader.size()"
          ],
          "line": 1006
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.size",
          "args": [],
          "line": 1006
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "599-599",
          "snippet": "inline uint size() { return _builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline uint size() { return _builder.size() / ELEMENTS; }"
        }
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 1005
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "2",
            "message.getSegmentsForOutput()[0].size()"
          ],
          "line": 1003
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "message.getSegmentsForOutput",
          "args": [],
          "line": 1003
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "message.getSegmentsForOutput",
          "args": [],
          "line": 1003
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.truncate",
          "args": [
            "2"
          ],
          "line": 1002
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "4",
            "message.getSegmentsForOutput()[0].size()"
          ],
          "line": 1001
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "message.getSegmentsForOutput",
          "args": [],
          "line": 1001
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "message.getSegmentsForOutput",
          "args": [],
          "line": 1001
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "builder.begin()",
            "123",
            "builder.size()"
          ],
          "line": 999
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.get",
          "args": [],
          "line": 998
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "message.getOrphanage",
          "args": [
            "17"
          ],
          "line": 997
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "message.getOrphanage",
          "args": [],
          "line": 997
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, Truncate) {\n  MallocMessageBuilder message;\n  auto orphan = message.getOrphanage().newOrphan<Data>(17);\n  auto builder = orphan.get();\n  memset(builder.begin(), 123, builder.size());\n\n  EXPECT_EQ(4, message.getSegmentsForOutput()[0].size());\n  orphan.truncate(2);\n  EXPECT_EQ(2, message.getSegmentsForOutput()[0].size());\n\n  auto reader = orphan.getReader();\n  EXPECT_EQ(2, reader.size());\n  EXPECT_EQ(builder.begin(), reader.begin());\n\n  EXPECT_EQ(123, builder[0]);\n  EXPECT_EQ(123, builder[1]);\n  EXPECT_EQ(0, builder[2]);\n  EXPECT_EQ(0, builder[3]);\n  EXPECT_EQ(0, builder[16]);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "976-993",
    "snippet": "TEST(Orphans, ReferenceExternalData_NoZeroImmediateAbandon) {\n  // Verify that an external blob is not zeroed when abandoned immediately, without ever being\n  // adopted.\n\n  union {\n    word align;\n    byte data[50];\n  };\n\n  memset(data, 0x55, sizeof(data));\n\n  MallocMessageBuilder builder;\n  builder.getOrphanage().referenceExternalData(Data::Builder(data, sizeof(data)));\n\n  for (byte b: data) {\n    EXPECT_EQ(0x55, b);\n  }\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "0x55",
            "b"
          ],
          "line": 991
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getOrphanage",
          "args": [
            "Data::Builder(data, sizeof(data))"
          ],
          "line": 988
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Data::Builder",
          "args": [
            "data",
            "sizeof(data)"
          ],
          "line": 988
        },
        "resolved": true,
        "details": {
          "function_name": "Builder",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/blob.h",
          "lines": "116-118",
          "snippet": "inline Builder(char* value, size_t size): content(value, size + 1) {\n    KJ_IREQUIRE(value[size] == '\\0', \"StringPtr must be NUL-terminated.\");\n  }",
          "includes": [
            "#include <string.h>",
            "#include \"common.h\"",
            "#include <kj/string.h>",
            "#include <kj/common.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"common.h\"\n#include <kj/string.h>\n#include <kj/common.h>\n\ninline Builder(char* value, size_t size): content(value, size + 1) {\n    KJ_IREQUIRE(value[size] == '\\0', \"StringPtr must be NUL-terminated.\");\n  }"
        }
      },
      {
        "call_info": {
          "callee": "builder.getOrphanage",
          "args": [],
          "line": 988
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "data",
            "0x55",
            "sizeof(data)"
          ],
          "line": 985
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, ReferenceExternalData_NoZeroImmediateAbandon) {\n  // Verify that an external blob is not zeroed when abandoned immediately, without ever being\n  // adopted.\n\n  union {\n    word align;\n    byte data[50];\n  };\n\n  memset(data, 0x55, sizeof(data));\n\n  MallocMessageBuilder builder;\n  builder.getOrphanage().referenceExternalData(Data::Builder(data, sizeof(data)));\n\n  for (byte b: data) {\n    EXPECT_EQ(0x55, b);\n  }\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "954-974",
    "snippet": "TEST(Orphans, ReferenceExternalData_NoZeroOnSet) {\n  // Verify that an external blob is not zeroed by setFoo().\n\n  union {\n    word align;\n    byte data[50];\n  };\n\n  memset(data, 0x55, sizeof(data));\n\n  MallocMessageBuilder builder;\n  auto root = builder.getRoot<TestAllTypes>();\n  root.adoptDataField(builder.getOrphanage().referenceExternalData(\n      Data::Builder(data, sizeof(data))));\n\n  root.setDataField(Data::Builder());\n\n  for (byte b: data) {\n    EXPECT_EQ(0x55, b);\n  }\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "0x55",
            "b"
          ],
          "line": 972
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.setDataField",
          "args": [
            "Data::Builder()"
          ],
          "line": 969
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Data::Builder",
          "args": [],
          "line": 969
        },
        "resolved": true,
        "details": {
          "function_name": "Builder",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/blob.h",
          "lines": "113-113",
          "snippet": "inline Builder(): content(nulstr, 1) {}",
          "includes": [
            "#include <string.h>",
            "#include \"common.h\"",
            "#include <kj/string.h>",
            "#include <kj/common.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"common.h\"\n#include <kj/string.h>\n#include <kj/common.h>\n\ninline Builder(): content(nulstr, 1) {}"
        }
      },
      {
        "call_info": {
          "callee": "root.adoptDataField",
          "args": [
            "builder.getOrphanage().referenceExternalData(\n      Data::Builder(data, sizeof(data)))"
          ],
          "line": 966
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getOrphanage",
          "args": [
            "Data::Builder(data, sizeof(data))"
          ],
          "line": 966
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getOrphanage",
          "args": [],
          "line": 966
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getRoot<TestAllTypes>",
          "args": [],
          "line": 965
        },
        "resolved": true,
        "details": {
          "function_name": "getRoot",
          "container": "RpcRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1322-1324",
          "snippet": "inline AnyPointer::Builder getRoot() {\n      return paramsBuilder;\n    }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nRpcRequest {\n  inline AnyPointer::Builder getRoot() {\n        return paramsBuilder;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "data",
            "0x55",
            "sizeof(data)"
          ],
          "line": 962
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, ReferenceExternalData_NoZeroOnSet) {\n  // Verify that an external blob is not zeroed by setFoo().\n\n  union {\n    word align;\n    byte data[50];\n  };\n\n  memset(data, 0x55, sizeof(data));\n\n  MallocMessageBuilder builder;\n  auto root = builder.getRoot<TestAllTypes>();\n  root.adoptDataField(builder.getOrphanage().referenceExternalData(\n      Data::Builder(data, sizeof(data))));\n\n  root.setDataField(Data::Builder());\n\n  for (byte b: data) {\n    EXPECT_EQ(0x55, b);\n  }\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "886-952",
    "snippet": "TEST(Orphans, ReferenceExternalData) {\n  MallocMessageBuilder builder;\n\n  union {\n    word align;\n    byte data[50];\n  };\n\n  memset(data, 0x55, sizeof(data));\n\n  auto orphan = builder.getOrphanage().referenceExternalData(Data::Builder(data, sizeof(data)));\n\n  // Data was added as a new segment.\n  {\n    auto segments = builder.getSegmentsForOutput();\n    ASSERT_EQ(2, segments.size());\n    EXPECT_EQ(data, segments[1].asBytes().begin());\n    EXPECT_EQ((sizeof(data) + 7) / 8, segments[1].size());\n  }\n\n  // Can't get builder because it's read-only.\n  EXPECT_ANY_THROW(orphan.get());\n\n  // Can get reader.\n  {\n    auto reader = orphan.getReader();\n    EXPECT_EQ(data, reader.begin());\n    EXPECT_EQ(sizeof(data), reader.size());\n  }\n\n  // Adopt into message tree.\n  auto root = builder.getRoot<TestAllTypes>();\n  root.adoptDataField(kj::mv(orphan));\n\n  // Can't get child builder.\n  EXPECT_ANY_THROW(root.getDataField());\n\n  // Can get child reader.\n  {\n    auto reader = root.asReader().getDataField();\n    EXPECT_EQ(data, reader.begin());\n    EXPECT_EQ(sizeof(data), reader.size());\n  }\n\n  // Back to orphan.\n  orphan = root.disownDataField();\n\n  // Now the orphan may be pointing to a far pointer landing pad, so check that it still does the\n  // right things.\n\n  // Can't get builder because it's read-only.\n  EXPECT_ANY_THROW(orphan.get());\n\n  // Can get reader.\n  {\n    auto reader = orphan.getReader();\n    EXPECT_EQ(data, reader.begin());\n    EXPECT_EQ(sizeof(data), reader.size());\n  }\n\n  // Finally, let's abandon the orphan and check that this doesn't zero out the data.\n  orphan = Orphan<Data>();\n\n  for (byte b: data) {\n    EXPECT_EQ(0x55, b);\n  }\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "0x55",
            "b"
          ],
          "line": 950
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Orphan<Data>",
          "args": [],
          "line": 947
        },
        "resolved": true,
        "details": {
          "function_name": "OrphanBuilder",
          "container": "OrphanBuilder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/layout.h",
          "lines": "709-709",
          "snippet": "inline OrphanBuilder(): segment(nullptr), location(nullptr) { memset(&tag, 0, sizeof(tag)); }",
          "includes": [
            "#include \"endian.h\"",
            "#include \"blob.h\"",
            "#include \"common.h\"",
            "#include <kj/memory.h>",
            "#include <kj/common.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"endian.h\"\n#include \"blob.h\"\n#include \"common.h\"\n#include <kj/memory.h>\n#include <kj/common.h>\n\nOrphanBuilder {\n  inline OrphanBuilder(): segment(nullptr), location(nullptr) { memset(&tag, 0, sizeof(tag)); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "sizeof(data)",
            "reader.size()"
          ],
          "line": 943
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.size",
          "args": [],
          "line": 943
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "599-599",
          "snippet": "inline uint size() { return _builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline uint size() { return _builder.size() / ELEMENTS; }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "data",
            "reader.begin()"
          ],
          "line": 942
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.begin",
          "args": [],
          "line": 942
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "550-550",
          "snippet": "inline Iterator begin() { return Iterator(this, 0); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Iterator begin() { return Iterator(this, 0); }"
        }
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 941
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_ANY_THROW",
          "args": [
            "orphan.get()"
          ],
          "line": 937
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.get",
          "args": [],
          "line": 937
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "root.disownDataField",
          "args": [],
          "line": 931
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "sizeof(data)",
            "reader.size()"
          ],
          "line": 927
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "data",
            "reader.begin()"
          ],
          "line": 926
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [],
          "line": 925
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_ANY_THROW",
          "args": [
            "root.getDataField()"
          ],
          "line": 921
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getDataField",
          "args": [],
          "line": 921
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.adoptDataField",
          "args": [
            "kj::mv(orphan)"
          ],
          "line": 918
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "orphan"
          ],
          "line": 918
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getRoot<TestAllTypes>",
          "args": [],
          "line": 917
        },
        "resolved": true,
        "details": {
          "function_name": "getRoot",
          "container": "RpcRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1322-1324",
          "snippet": "inline AnyPointer::Builder getRoot() {\n      return paramsBuilder;\n    }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nRpcRequest {\n  inline AnyPointer::Builder getRoot() {\n        return paramsBuilder;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "sizeof(data)",
            "reader.size()"
          ],
          "line": 913
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "data",
            "reader.begin()"
          ],
          "line": 912
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 911
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_ANY_THROW",
          "args": [
            "orphan.get()"
          ],
          "line": 907
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "(sizeof(data) + 7) / 8",
            "segments[1].size()"
          ],
          "line": 903
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "data",
            "segments[1].asBytes().begin()"
          ],
          "line": 902
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "segments[1].asBytes",
          "args": [],
          "line": 902
        },
        "resolved": true,
        "details": {
          "function_name": "asBytes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/blob.h",
          "lines": "128-128",
          "snippet": "inline kj::ArrayPtr<const byte> asBytes() const { return asArray().asBytes(); }",
          "includes": [
            "#include <string.h>",
            "#include \"common.h\"",
            "#include <kj/string.h>",
            "#include <kj/common.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"common.h\"\n#include <kj/string.h>\n#include <kj/common.h>\n\ninline kj::ArrayPtr<const byte> asBytes() const { return asArray().asBytes(); }"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "2",
            "segments.size()"
          ],
          "line": 901
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 900
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getOrphanage",
          "args": [
            "Data::Builder(data, sizeof(data))"
          ],
          "line": 896
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Data::Builder",
          "args": [
            "data",
            "sizeof(data)"
          ],
          "line": 896
        },
        "resolved": true,
        "details": {
          "function_name": "Builder",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/blob.h",
          "lines": "116-118",
          "snippet": "inline Builder(char* value, size_t size): content(value, size + 1) {\n    KJ_IREQUIRE(value[size] == '\\0', \"StringPtr must be NUL-terminated.\");\n  }",
          "includes": [
            "#include <string.h>",
            "#include \"common.h\"",
            "#include <kj/string.h>",
            "#include <kj/common.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"common.h\"\n#include <kj/string.h>\n#include <kj/common.h>\n\ninline Builder(char* value, size_t size): content(value, size + 1) {\n    KJ_IREQUIRE(value[size] == '\\0', \"StringPtr must be NUL-terminated.\");\n  }"
        }
      },
      {
        "call_info": {
          "callee": "builder.getOrphanage",
          "args": [],
          "line": 896
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "data",
            "0x55",
            "sizeof(data)"
          ],
          "line": 894
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, ReferenceExternalData) {\n  MallocMessageBuilder builder;\n\n  union {\n    word align;\n    byte data[50];\n  };\n\n  memset(data, 0x55, sizeof(data));\n\n  auto orphan = builder.getOrphanage().referenceExternalData(Data::Builder(data, sizeof(data)));\n\n  // Data was added as a new segment.\n  {\n    auto segments = builder.getSegmentsForOutput();\n    ASSERT_EQ(2, segments.size());\n    EXPECT_EQ(data, segments[1].asBytes().begin());\n    EXPECT_EQ((sizeof(data) + 7) / 8, segments[1].size());\n  }\n\n  // Can't get builder because it's read-only.\n  EXPECT_ANY_THROW(orphan.get());\n\n  // Can get reader.\n  {\n    auto reader = orphan.getReader();\n    EXPECT_EQ(data, reader.begin());\n    EXPECT_EQ(sizeof(data), reader.size());\n  }\n\n  // Adopt into message tree.\n  auto root = builder.getRoot<TestAllTypes>();\n  root.adoptDataField(kj::mv(orphan));\n\n  // Can't get child builder.\n  EXPECT_ANY_THROW(root.getDataField());\n\n  // Can get child reader.\n  {\n    auto reader = root.asReader().getDataField();\n    EXPECT_EQ(data, reader.begin());\n    EXPECT_EQ(sizeof(data), reader.size());\n  }\n\n  // Back to orphan.\n  orphan = root.disownDataField();\n\n  // Now the orphan may be pointing to a far pointer landing pad, so check that it still does the\n  // right things.\n\n  // Can't get builder because it's read-only.\n  EXPECT_ANY_THROW(orphan.get());\n\n  // Can get reader.\n  {\n    auto reader = orphan.getReader();\n    EXPECT_EQ(data, reader.begin());\n    EXPECT_EQ(sizeof(data), reader.size());\n  }\n\n  // Finally, let's abandon the orphan and check that this doesn't zero out the data.\n  orphan = Orphan<Data>();\n\n  for (byte b: data) {\n    EXPECT_EQ(0x55, b);\n  }\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "847-884",
    "snippet": "TEST(Orphans, DisownNull) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<TestAllTypes>();\n\n  {\n    Orphan<TestAllTypes> orphan = root.disownStructField();\n    EXPECT_TRUE(orphan == nullptr);\n\n    checkTestMessageAllZero(orphan.getReader());\n    EXPECT_TRUE(orphan == nullptr);\n\n    // get()ing the orphan allocates an object, for security reasons.\n    checkTestMessageAllZero(orphan.get());\n    EXPECT_FALSE(orphan == nullptr);\n  }\n\n  {\n    Orphan<List<int32_t>> orphan = root.disownInt32List();\n    EXPECT_TRUE(orphan == nullptr);\n\n    EXPECT_EQ(0, orphan.getReader().size());\n    EXPECT_TRUE(orphan == nullptr);\n\n    EXPECT_EQ(0, orphan.get().size());\n    EXPECT_TRUE(orphan == nullptr);\n  }\n\n  {\n    Orphan<List<TestAllTypes>> orphan = root.disownStructList();\n    EXPECT_TRUE(orphan == nullptr);\n\n    EXPECT_EQ(0, orphan.getReader().size());\n    EXPECT_TRUE(orphan == nullptr);\n\n    EXPECT_EQ(0, orphan.get().size());\n    EXPECT_TRUE(orphan == nullptr);\n  }\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "orphan == nullptr"
          ],
          "line": 882
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "0",
            "orphan.get().size()"
          ],
          "line": 881
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.get",
          "args": [],
          "line": 881
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "orphan == nullptr"
          ],
          "line": 879
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "0",
            "orphan.getReader().size()"
          ],
          "line": 878
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 878
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 878
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "orphan == nullptr"
          ],
          "line": 876
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.disownStructList",
          "args": [],
          "line": 875
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "orphan == nullptr"
          ],
          "line": 871
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "0",
            "orphan.get().size()"
          ],
          "line": 870
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "orphan == nullptr"
          ],
          "line": 868
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "0",
            "orphan.getReader().size()"
          ],
          "line": 867
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 867
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 867
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "orphan == nullptr"
          ],
          "line": 865
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.disownInt32List",
          "args": [],
          "line": 864
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "orphan == nullptr"
          ],
          "line": 860
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "checkTestMessageAllZero",
          "args": [
            "orphan.get()"
          ],
          "line": 859
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessageAllZero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "849-851",
          "snippet": "void checkTestMessageAllZero(TestAllTypes::Reader reader) {\n  genericCheckTestMessageAllZero(reader);\n}",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessageAllZero(TestAllTypes::Reader reader) {\n  genericCheckTestMessageAllZero(reader);\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "orphan == nullptr"
          ],
          "line": 856
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 855
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "orphan == nullptr"
          ],
          "line": 853
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.disownStructField",
          "args": [],
          "line": 852
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 849
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, DisownNull) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<TestAllTypes>();\n\n  {\n    Orphan<TestAllTypes> orphan = root.disownStructField();\n    EXPECT_TRUE(orphan == nullptr);\n\n    checkTestMessageAllZero(orphan.getReader());\n    EXPECT_TRUE(orphan == nullptr);\n\n    // get()ing the orphan allocates an object, for security reasons.\n    checkTestMessageAllZero(orphan.get());\n    EXPECT_FALSE(orphan == nullptr);\n  }\n\n  {\n    Orphan<List<int32_t>> orphan = root.disownInt32List();\n    EXPECT_TRUE(orphan == nullptr);\n\n    EXPECT_EQ(0, orphan.getReader().size());\n    EXPECT_TRUE(orphan == nullptr);\n\n    EXPECT_EQ(0, orphan.get().size());\n    EXPECT_TRUE(orphan == nullptr);\n  }\n\n  {\n    Orphan<List<TestAllTypes>> orphan = root.disownStructList();\n    EXPECT_TRUE(orphan == nullptr);\n\n    EXPECT_EQ(0, orphan.getReader().size());\n    EXPECT_TRUE(orphan == nullptr);\n\n    EXPECT_EQ(0, orphan.get().size());\n    EXPECT_TRUE(orphan == nullptr);\n  }\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "818-845",
    "snippet": "TEST(Orphans, UpgradeStructList) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<test::TestAnyPointer>();\n\n  auto old = root.getAnyPointerField().initAs<List<test::TestOldVersion>>(2);\n  old[0].setOld1(1234);\n  old[0].setOld2(\"foo\");\n  old[1].setOld1(4321);\n  old[1].setOld2(\"bar\");\n\n  auto orphan = root.getAnyPointerField().disownAs<List<test::TestNewVersion>>();\n\n  // Relocation has not occurred yet.\n  old[0].setOld1(12345);\n  EXPECT_EQ(12345, orphan.getReader()[0].getOld1());\n  EXPECT_EQ(\"foo\", old[0].getOld2());\n\n  // This will relocate the struct.\n  auto newVersion = orphan.get();\n\n  EXPECT_EQ(0, old[0].getOld1());\n  EXPECT_EQ(\"\", old[0].getOld2());\n\n  EXPECT_EQ(12345, newVersion[0].getOld1());\n  EXPECT_EQ(\"foo\", newVersion[0].getOld2());\n  EXPECT_EQ(4321, newVersion[1].getOld1());\n  EXPECT_EQ(\"bar\", newVersion[1].getOld2());\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"bar\"",
            "newVersion[1].getOld2()"
          ],
          "line": 844
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "newVersion[1].getOld2",
          "args": [],
          "line": 844
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "4321",
            "newVersion[1].getOld1()"
          ],
          "line": 843
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "newVersion[1].getOld1",
          "args": [],
          "line": 843
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "newVersion[0].getOld2()"
          ],
          "line": 842
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "newVersion[0].getOld2",
          "args": [],
          "line": 842
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "12345",
            "newVersion[0].getOld1()"
          ],
          "line": 841
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "newVersion[0].getOld1",
          "args": [],
          "line": 841
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"\"",
            "old[0].getOld2()"
          ],
          "line": 839
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "old[0].getOld2",
          "args": [],
          "line": 839
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "0",
            "old[0].getOld1()"
          ],
          "line": 838
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "old[0].getOld1",
          "args": [],
          "line": 838
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.get",
          "args": [],
          "line": 836
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "old[0].getOld2()"
          ],
          "line": 833
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "old[0].getOld2",
          "args": [],
          "line": 833
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "12345",
            "orphan.getReader()[0].getOld1()"
          ],
          "line": 832
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 832
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 832
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "old[0].setOld1",
          "args": [
            "12345"
          ],
          "line": 831
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 828
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 828
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "old[1].setOld2",
          "args": [
            "\"bar\""
          ],
          "line": 826
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "old[1].setOld1",
          "args": [
            "4321"
          ],
          "line": 825
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "old[0].setOld2",
          "args": [
            "\"foo\""
          ],
          "line": 824
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "old[0].setOld1",
          "args": [
            "1234"
          ],
          "line": 823
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [
            "2"
          ],
          "line": 822
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 822
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<test::TestAnyPointer>",
          "args": [],
          "line": 820
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, UpgradeStructList) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<test::TestAnyPointer>();\n\n  auto old = root.getAnyPointerField().initAs<List<test::TestOldVersion>>(2);\n  old[0].setOld1(1234);\n  old[0].setOld2(\"foo\");\n  old[1].setOld1(4321);\n  old[1].setOld2(\"bar\");\n\n  auto orphan = root.getAnyPointerField().disownAs<List<test::TestNewVersion>>();\n\n  // Relocation has not occurred yet.\n  old[0].setOld1(12345);\n  EXPECT_EQ(12345, orphan.getReader()[0].getOld1());\n  EXPECT_EQ(\"foo\", old[0].getOld2());\n\n  // This will relocate the struct.\n  auto newVersion = orphan.get();\n\n  EXPECT_EQ(0, old[0].getOld1());\n  EXPECT_EQ(\"\", old[0].getOld2());\n\n  EXPECT_EQ(12345, newVersion[0].getOld1());\n  EXPECT_EQ(\"foo\", newVersion[0].getOld2());\n  EXPECT_EQ(4321, newVersion[1].getOld1());\n  EXPECT_EQ(\"bar\", newVersion[1].getOld2());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "793-816",
    "snippet": "TEST(Orphans, UpgradeStruct) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<test::TestAnyPointer>();\n\n  auto old = root.getAnyPointerField().initAs<test::TestOldVersion>();\n  old.setOld1(1234);\n  old.setOld2(\"foo\");\n\n  auto orphan = root.getAnyPointerField().disownAs<test::TestNewVersion>();\n\n  // Relocation has not occurred yet.\n  old.setOld1(12345);\n  EXPECT_EQ(12345, orphan.getReader().getOld1());\n  EXPECT_EQ(\"foo\", old.getOld2());\n\n  // This will relocate the struct.\n  auto newVersion = orphan.get();\n\n  EXPECT_EQ(0, old.getOld1());\n  EXPECT_EQ(\"\", old.getOld2());\n\n  EXPECT_EQ(12345, newVersion.getOld1());\n  EXPECT_EQ(\"foo\", newVersion.getOld2());\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "newVersion.getOld2()"
          ],
          "line": 815
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "newVersion.getOld2",
          "args": [],
          "line": 815
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "12345",
            "newVersion.getOld1()"
          ],
          "line": 814
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "newVersion.getOld1",
          "args": [],
          "line": 814
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"\"",
            "old.getOld2()"
          ],
          "line": 812
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "old.getOld2",
          "args": [],
          "line": 812
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "0",
            "old.getOld1()"
          ],
          "line": 811
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "old.getOld1",
          "args": [],
          "line": 811
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.get",
          "args": [],
          "line": 809
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "old.getOld2()"
          ],
          "line": 806
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "old.getOld2",
          "args": [],
          "line": 806
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "12345",
            "orphan.getReader().getOld1()"
          ],
          "line": 805
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 805
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 805
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "old.setOld1",
          "args": [
            "12345"
          ],
          "line": 804
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 801
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 801
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "old.setOld2",
          "args": [
            "\"foo\""
          ],
          "line": 799
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "old.setOld1",
          "args": [
            "1234"
          ],
          "line": 798
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 797
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 797
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<test::TestAnyPointer>",
          "args": [],
          "line": 795
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, UpgradeStruct) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<test::TestAnyPointer>();\n\n  auto old = root.getAnyPointerField().initAs<test::TestOldVersion>();\n  old.setOld1(1234);\n  old.setOld2(\"foo\");\n\n  auto orphan = root.getAnyPointerField().disownAs<test::TestNewVersion>();\n\n  // Relocation has not occurred yet.\n  old.setOld1(12345);\n  EXPECT_EQ(12345, orphan.getReader().getOld1());\n  EXPECT_EQ(\"foo\", old.getOld2());\n\n  // This will relocate the struct.\n  auto newVersion = orphan.get();\n\n  EXPECT_EQ(0, old.getOld1());\n  EXPECT_EQ(\"\", old.getOld2());\n\n  EXPECT_EQ(12345, newVersion.getOld1());\n  EXPECT_EQ(\"foo\", newVersion.getOld2());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "778-791",
    "snippet": "TEST(Orphans, FarPointer) {\n  MallocMessageBuilder builder(0, AllocationStrategy::FIXED_SIZE);\n  auto root = builder.initRoot<TestAllTypes>();\n  auto child = root.initStructField();\n  initTestMessage(child);\n\n  auto orphan = root.disownStructField();\n  EXPECT_FALSE(root.hasStructField());\n  EXPECT_TRUE(orphan != nullptr);\n  EXPECT_FALSE(orphan == nullptr);\n\n  checkTestMessage(orphan.getReader());\n  checkTestMessage(orphan.get());\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "orphan.get()"
          ],
          "line": 790
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "orphan.get",
          "args": [],
          "line": 790
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 789
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "orphan == nullptr"
          ],
          "line": 787
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "orphan != nullptr"
          ],
          "line": 786
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "root.hasStructField()"
          ],
          "line": 785
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.hasStructField",
          "args": [],
          "line": 785
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.disownStructField",
          "args": [],
          "line": 784
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "child"
          ],
          "line": 782
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "root.initStructField",
          "args": [],
          "line": 781
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 780
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, FarPointer) {\n  MallocMessageBuilder builder(0, AllocationStrategy::FIXED_SIZE);\n  auto root = builder.initRoot<TestAllTypes>();\n  auto child = root.initStructField();\n  initTestMessage(child);\n\n  auto orphan = root.disownStructField();\n  EXPECT_FALSE(root.hasStructField());\n  EXPECT_TRUE(orphan != nullptr);\n  EXPECT_FALSE(orphan == nullptr);\n\n  checkTestMessage(orphan.getReader());\n  checkTestMessage(orphan.get());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "759-776",
    "snippet": "TEST(Orphans, DataZerodAfterUse) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<TestAllTypes>();\n\n  const word* zerosStart = builder.getSegmentsForOutput()[0].end();\n  root.setDataField(data(\"abcd123\"));\n  const word* zerosEnd = builder.getSegmentsForOutput()[0].end();\n\n  root.setTextField(\"foo\");  // guard against overruns\n\n  EXPECT_EQ(1u, builder.getSegmentsForOutput().size());  // otherwise test is invalid\n\n  root.disownDataField();\n\n  EXPECT_TRUE(allZero(zerosStart, zerosEnd));\n\n  EXPECT_EQ(\"foo\", root.getTextField());\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "root.getTextField()"
          ],
          "line": 775
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getTextField",
          "args": [],
          "line": 775
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "allZero(zerosStart, zerosEnd)"
          ],
          "line": 773
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "allZero",
          "args": [
            "zerosStart",
            "zerosEnd"
          ],
          "line": 773
        },
        "resolved": true,
        "details": {
          "function_name": "allZero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
          "lines": "633-639",
          "snippet": "static bool allZero(const word* begin, const word* end) {\n  for (const byte* pos = reinterpret_cast<const byte*>(begin);\n       pos < reinterpret_cast<const byte*>(end); ++pos) {\n    if (*pos != 0) return false;\n  }\n  return true;\n}",
          "includes": [
            "#include \"test-util.h\"",
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nstatic bool allZero(const word* begin, const word* end) {\n  for (const byte* pos = reinterpret_cast<const byte*>(begin);\n       pos < reinterpret_cast<const byte*>(end); ++pos) {\n    if (*pos != 0) return false;\n  }\n  return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "root.disownDataField",
          "args": [],
          "line": 771
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "1u",
            "builder.getSegmentsForOutput().size()"
          ],
          "line": 769
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 769
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 769
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.setTextField",
          "args": [
            "\"foo\""
          ],
          "line": 767
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 765
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 765
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.setDataField",
          "args": [
            "data(\"abcd123\")"
          ],
          "line": 764
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "data",
          "args": [
            "\"abcd123\""
          ],
          "line": 764
        },
        "resolved": true,
        "details": {
          "function_name": "dataEquals",
          "container": "TestOutputStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-test.c++",
          "lines": "278-281",
          "snippet": "bool dataEquals(kj::ArrayPtr<const word> other) {\n    return data ==\n        std::string(other.asChars().begin(), other.asChars().size());\n  }",
          "includes": [
            "#include \"test-util.h\"",
            "#include <fcntl.h>",
            "#include <stdlib.h>",
            "#include <string>",
            "#include <kj/miniposix.h>",
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"test-util.h\"\n#include <fcntl.h>\n#include <stdlib.h>\n#include <string>\n#include <kj/miniposix.h>\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n\nTestOutputStream {\n  bool dataEquals(kj::ArrayPtr<const word> other) {\n      return data ==\n          std::string(other.asChars().begin(), other.asChars().size());\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 763
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 763
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 761
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, DataZerodAfterUse) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<TestAllTypes>();\n\n  const word* zerosStart = builder.getSegmentsForOutput()[0].end();\n  root.setDataField(data(\"abcd123\"));\n  const word* zerosEnd = builder.getSegmentsForOutput()[0].end();\n\n  root.setTextField(\"foo\");  // guard against overruns\n\n  EXPECT_EQ(1u, builder.getSegmentsForOutput().size());  // otherwise test is invalid\n\n  root.disownDataField();\n\n  EXPECT_TRUE(allZero(zerosStart, zerosEnd));\n\n  EXPECT_EQ(\"foo\", root.getTextField());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "740-757",
    "snippet": "TEST(Orphans, TextZerodAfterUse) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<TestAllTypes>();\n\n  const word* zerosStart = builder.getSegmentsForOutput()[0].end();\n  root.setTextField(\"abcd123\");\n  const word* zerosEnd = builder.getSegmentsForOutput()[0].end();\n\n  root.setDataField(data(\"foo\"));  // guard against overruns\n\n  EXPECT_EQ(1u, builder.getSegmentsForOutput().size());  // otherwise test is invalid\n\n  root.disownTextField();\n\n  EXPECT_TRUE(allZero(zerosStart, zerosEnd));\n\n  EXPECT_EQ(data(\"foo\"), root.getDataField());\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "data(\"foo\")",
            "root.getDataField()"
          ],
          "line": 756
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getDataField",
          "args": [],
          "line": 756
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "data",
          "args": [
            "\"foo\""
          ],
          "line": 756
        },
        "resolved": true,
        "details": {
          "function_name": "dataEquals",
          "container": "TestOutputStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-test.c++",
          "lines": "278-281",
          "snippet": "bool dataEquals(kj::ArrayPtr<const word> other) {\n    return data ==\n        std::string(other.asChars().begin(), other.asChars().size());\n  }",
          "includes": [
            "#include \"test-util.h\"",
            "#include <fcntl.h>",
            "#include <stdlib.h>",
            "#include <string>",
            "#include <kj/miniposix.h>",
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"test-util.h\"\n#include <fcntl.h>\n#include <stdlib.h>\n#include <string>\n#include <kj/miniposix.h>\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n\nTestOutputStream {\n  bool dataEquals(kj::ArrayPtr<const word> other) {\n      return data ==\n          std::string(other.asChars().begin(), other.asChars().size());\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "allZero(zerosStart, zerosEnd)"
          ],
          "line": 754
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "allZero",
          "args": [
            "zerosStart",
            "zerosEnd"
          ],
          "line": 754
        },
        "resolved": true,
        "details": {
          "function_name": "allZero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
          "lines": "633-639",
          "snippet": "static bool allZero(const word* begin, const word* end) {\n  for (const byte* pos = reinterpret_cast<const byte*>(begin);\n       pos < reinterpret_cast<const byte*>(end); ++pos) {\n    if (*pos != 0) return false;\n  }\n  return true;\n}",
          "includes": [
            "#include \"test-util.h\"",
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nstatic bool allZero(const word* begin, const word* end) {\n  for (const byte* pos = reinterpret_cast<const byte*>(begin);\n       pos < reinterpret_cast<const byte*>(end); ++pos) {\n    if (*pos != 0) return false;\n  }\n  return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "root.disownTextField",
          "args": [],
          "line": 752
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "1u",
            "builder.getSegmentsForOutput().size()"
          ],
          "line": 750
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 750
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 750
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.setDataField",
          "args": [
            "data(\"foo\")"
          ],
          "line": 748
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 746
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 746
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.setTextField",
          "args": [
            "\"abcd123\""
          ],
          "line": 745
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 744
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 744
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 742
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, TextZerodAfterUse) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<TestAllTypes>();\n\n  const word* zerosStart = builder.getSegmentsForOutput()[0].end();\n  root.setTextField(\"abcd123\");\n  const word* zerosEnd = builder.getSegmentsForOutput()[0].end();\n\n  root.setDataField(data(\"foo\"));  // guard against overruns\n\n  EXPECT_EQ(1u, builder.getSegmentsForOutput().size());  // otherwise test is invalid\n\n  root.disownTextField();\n\n  EXPECT_TRUE(allZero(zerosStart, zerosEnd));\n\n  EXPECT_EQ(data(\"foo\"), root.getDataField());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "721-738",
    "snippet": "TEST(Orphans, EmptyStructListsZerodAfterUse) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<TestAllTypes>();\n\n  const word* zerosStart = builder.getSegmentsForOutput()[0].end();\n  root.initStructList(0);\n  const word* zerosEnd = builder.getSegmentsForOutput()[0].end();\n\n  root.setTextField(\"foo\");  // guard against overruns\n\n  EXPECT_EQ(1u, builder.getSegmentsForOutput().size());  // otherwise test is invalid\n\n  root.disownStructList();\n\n  EXPECT_TRUE(allZero(zerosStart, zerosEnd));\n\n  EXPECT_EQ(\"foo\", root.getTextField());\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "root.getTextField()"
          ],
          "line": 737
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getTextField",
          "args": [],
          "line": 737
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "allZero(zerosStart, zerosEnd)"
          ],
          "line": 735
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "allZero",
          "args": [
            "zerosStart",
            "zerosEnd"
          ],
          "line": 735
        },
        "resolved": true,
        "details": {
          "function_name": "allZero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
          "lines": "633-639",
          "snippet": "static bool allZero(const word* begin, const word* end) {\n  for (const byte* pos = reinterpret_cast<const byte*>(begin);\n       pos < reinterpret_cast<const byte*>(end); ++pos) {\n    if (*pos != 0) return false;\n  }\n  return true;\n}",
          "includes": [
            "#include \"test-util.h\"",
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nstatic bool allZero(const word* begin, const word* end) {\n  for (const byte* pos = reinterpret_cast<const byte*>(begin);\n       pos < reinterpret_cast<const byte*>(end); ++pos) {\n    if (*pos != 0) return false;\n  }\n  return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "root.disownStructList",
          "args": [],
          "line": 733
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "1u",
            "builder.getSegmentsForOutput().size()"
          ],
          "line": 731
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 731
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 731
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.setTextField",
          "args": [
            "\"foo\""
          ],
          "line": 729
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 727
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 727
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.initStructList",
          "args": [
            "0"
          ],
          "line": 726
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 725
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 725
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 723
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, EmptyStructListsZerodAfterUse) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<TestAllTypes>();\n\n  const word* zerosStart = builder.getSegmentsForOutput()[0].end();\n  root.initStructList(0);\n  const word* zerosEnd = builder.getSegmentsForOutput()[0].end();\n\n  root.setTextField(\"foo\");  // guard against overruns\n\n  EXPECT_EQ(1u, builder.getSegmentsForOutput().size());  // otherwise test is invalid\n\n  root.disownStructList();\n\n  EXPECT_TRUE(allZero(zerosStart, zerosEnd));\n\n  EXPECT_EQ(\"foo\", root.getTextField());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "698-719",
    "snippet": "TEST(Orphans, StructListsZerodAfterUse) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<TestAllTypes>();\n\n  const word* zerosStart = builder.getSegmentsForOutput()[0].end();\n  {\n    auto list = root.initStructList(2);\n    initTestMessage(list[0]);\n    initTestMessage(list[1]);\n  }\n  const word* zerosEnd = builder.getSegmentsForOutput()[0].end();\n\n  root.setTextField(\"foo\");  // guard against overruns\n\n  EXPECT_EQ(1u, builder.getSegmentsForOutput().size());  // otherwise test is invalid\n\n  root.disownStructList();\n\n  EXPECT_TRUE(allZero(zerosStart, zerosEnd));\n\n  EXPECT_EQ(\"foo\", root.getTextField());\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "root.getTextField()"
          ],
          "line": 718
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getTextField",
          "args": [],
          "line": 718
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "allZero(zerosStart, zerosEnd)"
          ],
          "line": 716
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "allZero",
          "args": [
            "zerosStart",
            "zerosEnd"
          ],
          "line": 716
        },
        "resolved": true,
        "details": {
          "function_name": "allZero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
          "lines": "633-639",
          "snippet": "static bool allZero(const word* begin, const word* end) {\n  for (const byte* pos = reinterpret_cast<const byte*>(begin);\n       pos < reinterpret_cast<const byte*>(end); ++pos) {\n    if (*pos != 0) return false;\n  }\n  return true;\n}",
          "includes": [
            "#include \"test-util.h\"",
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nstatic bool allZero(const word* begin, const word* end) {\n  for (const byte* pos = reinterpret_cast<const byte*>(begin);\n       pos < reinterpret_cast<const byte*>(end); ++pos) {\n    if (*pos != 0) return false;\n  }\n  return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "root.disownStructList",
          "args": [],
          "line": 714
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "1u",
            "builder.getSegmentsForOutput().size()"
          ],
          "line": 712
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 712
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 712
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.setTextField",
          "args": [
            "\"foo\""
          ],
          "line": 710
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 708
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 708
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "list[1]"
          ],
          "line": 706
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "root.initStructList",
          "args": [
            "2"
          ],
          "line": 704
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 702
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 702
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 700
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, StructListsZerodAfterUse) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<TestAllTypes>();\n\n  const word* zerosStart = builder.getSegmentsForOutput()[0].end();\n  {\n    auto list = root.initStructList(2);\n    initTestMessage(list[0]);\n    initTestMessage(list[1]);\n  }\n  const word* zerosEnd = builder.getSegmentsForOutput()[0].end();\n\n  root.setTextField(\"foo\");  // guard against overruns\n\n  EXPECT_EQ(1u, builder.getSegmentsForOutput().size());  // otherwise test is invalid\n\n  root.disownStructList();\n\n  EXPECT_TRUE(allZero(zerosStart, zerosEnd));\n\n  EXPECT_EQ(\"foo\", root.getTextField());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "679-696",
    "snippet": "TEST(Orphans, EmptyListsZerodAfterUse) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<TestAllTypes>();\n\n  const word* zerosStart = builder.getSegmentsForOutput()[0].end();\n  root.initUInt32List(0);\n  const word* zerosEnd = builder.getSegmentsForOutput()[0].end();\n\n  root.setTextField(\"foo\");  // guard against overruns\n\n  EXPECT_EQ(1u, builder.getSegmentsForOutput().size());  // otherwise test is invalid\n\n  root.disownUInt32List();\n\n  EXPECT_TRUE(allZero(zerosStart, zerosEnd));\n\n  EXPECT_EQ(\"foo\", root.getTextField());\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "root.getTextField()"
          ],
          "line": 695
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getTextField",
          "args": [],
          "line": 695
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "allZero(zerosStart, zerosEnd)"
          ],
          "line": 693
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "allZero",
          "args": [
            "zerosStart",
            "zerosEnd"
          ],
          "line": 693
        },
        "resolved": true,
        "details": {
          "function_name": "allZero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
          "lines": "633-639",
          "snippet": "static bool allZero(const word* begin, const word* end) {\n  for (const byte* pos = reinterpret_cast<const byte*>(begin);\n       pos < reinterpret_cast<const byte*>(end); ++pos) {\n    if (*pos != 0) return false;\n  }\n  return true;\n}",
          "includes": [
            "#include \"test-util.h\"",
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nstatic bool allZero(const word* begin, const word* end) {\n  for (const byte* pos = reinterpret_cast<const byte*>(begin);\n       pos < reinterpret_cast<const byte*>(end); ++pos) {\n    if (*pos != 0) return false;\n  }\n  return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "root.disownUInt32List",
          "args": [],
          "line": 691
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "1u",
            "builder.getSegmentsForOutput().size()"
          ],
          "line": 689
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 689
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 689
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.setTextField",
          "args": [
            "\"foo\""
          ],
          "line": 687
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 685
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 685
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.initUInt32List",
          "args": [
            "0"
          ],
          "line": 684
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 683
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 683
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 681
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, EmptyListsZerodAfterUse) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<TestAllTypes>();\n\n  const word* zerosStart = builder.getSegmentsForOutput()[0].end();\n  root.initUInt32List(0);\n  const word* zerosEnd = builder.getSegmentsForOutput()[0].end();\n\n  root.setTextField(\"foo\");  // guard against overruns\n\n  EXPECT_EQ(1u, builder.getSegmentsForOutput().size());  // otherwise test is invalid\n\n  root.disownUInt32List();\n\n  EXPECT_TRUE(allZero(zerosStart, zerosEnd));\n\n  EXPECT_EQ(\"foo\", root.getTextField());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "660-677",
    "snippet": "TEST(Orphans, ListsZerodAfterUse) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<TestAllTypes>();\n\n  const word* zerosStart = builder.getSegmentsForOutput()[0].end();\n  root.setUInt32List({12, 34, 56});\n  const word* zerosEnd = builder.getSegmentsForOutput()[0].end();\n\n  root.setTextField(\"foo\");  // guard against overruns\n\n  EXPECT_EQ(1u, builder.getSegmentsForOutput().size());  // otherwise test is invalid\n\n  root.disownUInt32List();\n\n  EXPECT_TRUE(allZero(zerosStart, zerosEnd));\n\n  EXPECT_EQ(\"foo\", root.getTextField());\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "root.getTextField()"
          ],
          "line": 676
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getTextField",
          "args": [],
          "line": 676
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "allZero(zerosStart, zerosEnd)"
          ],
          "line": 674
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "allZero",
          "args": [
            "zerosStart",
            "zerosEnd"
          ],
          "line": 674
        },
        "resolved": true,
        "details": {
          "function_name": "allZero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
          "lines": "633-639",
          "snippet": "static bool allZero(const word* begin, const word* end) {\n  for (const byte* pos = reinterpret_cast<const byte*>(begin);\n       pos < reinterpret_cast<const byte*>(end); ++pos) {\n    if (*pos != 0) return false;\n  }\n  return true;\n}",
          "includes": [
            "#include \"test-util.h\"",
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nstatic bool allZero(const word* begin, const word* end) {\n  for (const byte* pos = reinterpret_cast<const byte*>(begin);\n       pos < reinterpret_cast<const byte*>(end); ++pos) {\n    if (*pos != 0) return false;\n  }\n  return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "root.disownUInt32List",
          "args": [],
          "line": 672
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "1u",
            "builder.getSegmentsForOutput().size()"
          ],
          "line": 670
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 670
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 670
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.setTextField",
          "args": [
            "\"foo\""
          ],
          "line": 668
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 666
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 666
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.setUInt32List",
          "args": [
            "{12, 34, 56}"
          ],
          "line": 665
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 664
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 664
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 662
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, ListsZerodAfterUse) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<TestAllTypes>();\n\n  const word* zerosStart = builder.getSegmentsForOutput()[0].end();\n  root.setUInt32List({12, 34, 56});\n  const word* zerosEnd = builder.getSegmentsForOutput()[0].end();\n\n  root.setTextField(\"foo\");  // guard against overruns\n\n  EXPECT_EQ(1u, builder.getSegmentsForOutput().size());  // otherwise test is invalid\n\n  root.disownUInt32List();\n\n  EXPECT_TRUE(allZero(zerosStart, zerosEnd));\n\n  EXPECT_EQ(\"foo\", root.getTextField());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "641-658",
    "snippet": "TEST(Orphans, StructsZerodAfterUse) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<TestAllTypes>();\n\n  const word* zerosStart = builder.getSegmentsForOutput()[0].end();\n  initTestMessage(root.initStructField());\n  const word* zerosEnd = builder.getSegmentsForOutput()[0].end();\n\n  root.setTextField(\"foo\");  // guard against overruns\n\n  EXPECT_EQ(1u, builder.getSegmentsForOutput().size());  // otherwise test is invalid\n\n  root.disownStructField();\n\n  EXPECT_TRUE(allZero(zerosStart, zerosEnd));\n\n  EXPECT_EQ(\"foo\", root.getTextField());\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "root.getTextField()"
          ],
          "line": 657
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getTextField",
          "args": [],
          "line": 657
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "allZero(zerosStart, zerosEnd)"
          ],
          "line": 655
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "allZero",
          "args": [
            "zerosStart",
            "zerosEnd"
          ],
          "line": 655
        },
        "resolved": true,
        "details": {
          "function_name": "allZero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
          "lines": "633-639",
          "snippet": "static bool allZero(const word* begin, const word* end) {\n  for (const byte* pos = reinterpret_cast<const byte*>(begin);\n       pos < reinterpret_cast<const byte*>(end); ++pos) {\n    if (*pos != 0) return false;\n  }\n  return true;\n}",
          "includes": [
            "#include \"test-util.h\"",
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nstatic bool allZero(const word* begin, const word* end) {\n  for (const byte* pos = reinterpret_cast<const byte*>(begin);\n       pos < reinterpret_cast<const byte*>(end); ++pos) {\n    if (*pos != 0) return false;\n  }\n  return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "root.disownStructField",
          "args": [],
          "line": 653
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "1u",
            "builder.getSegmentsForOutput().size()"
          ],
          "line": 651
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 651
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 651
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.setTextField",
          "args": [
            "\"foo\""
          ],
          "line": 649
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 647
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 647
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "root.initStructField()"
          ],
          "line": 646
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "root.initStructField",
          "args": [],
          "line": 646
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 645
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getSegmentsForOutput",
          "args": [],
          "line": 645
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 643
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, StructsZerodAfterUse) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<TestAllTypes>();\n\n  const word* zerosStart = builder.getSegmentsForOutput()[0].end();\n  initTestMessage(root.initStructField());\n  const word* zerosEnd = builder.getSegmentsForOutput()[0].end();\n\n  root.setTextField(\"foo\");  // guard against overruns\n\n  EXPECT_EQ(1u, builder.getSegmentsForOutput().size());  // otherwise test is invalid\n\n  root.disownStructField();\n\n  EXPECT_TRUE(allZero(zerosStart, zerosEnd));\n\n  EXPECT_EQ(\"foo\", root.getTextField());\n}"
  },
  {
    "function_name": "allZero",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "633-639",
    "snippet": "static bool allZero(const word* begin, const word* end) {\n  for (const byte* pos = reinterpret_cast<const byte*>(begin);\n       pos < reinterpret_cast<const byte*>(end); ++pos) {\n    if (*pos != 0) return false;\n  }\n  return true;\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reinterpret_cast<const byte*>",
          "args": [
            "end"
          ],
          "line": 635
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<const byte*>",
          "args": [
            "begin"
          ],
          "line": 634
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nstatic bool allZero(const word* begin, const word* end) {\n  for (const byte* pos = reinterpret_cast<const byte*>(begin);\n       pos < reinterpret_cast<const byte*>(end); ++pos) {\n    if (*pos != 0) return false;\n  }\n  return true;\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "594-631",
    "snippet": "TEST(Orphans, OrphanageFromBuilder) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<TestAllTypes>();\n\n  {\n    Orphanage orphanage = Orphanage::getForMessageContaining(root);\n    Orphan<TestAllTypes> orphan = orphanage.newOrphan<TestAllTypes>();\n    initTestMessage(orphan.get());\n    root.adoptStructField(kj::mv(orphan));\n    checkTestMessage(root.asReader().getStructField());\n  }\n\n  {\n    Orphanage orphanage = Orphanage::getForMessageContaining(root.initBoolList(3));\n    Orphan<TestAllTypes> orphan = orphanage.newOrphan<TestAllTypes>();\n    initTestMessage(orphan.get());\n    root.adoptStructField(kj::mv(orphan));\n    checkTestMessage(root.asReader().getStructField());\n  }\n\n#if !CAPNP_LITE\n  {\n    Orphanage orphanage = Orphanage::getForMessageContaining(toDynamic(root));\n    Orphan<TestAllTypes> orphan = orphanage.newOrphan<TestAllTypes>();\n    initTestMessage(orphan.get());\n    root.adoptStructField(kj::mv(orphan));\n    checkTestMessage(root.asReader().getStructField());\n  }\n\n  {\n    Orphanage orphanage = Orphanage::getForMessageContaining(toDynamic(root.initBoolList(3)));\n    Orphan<TestAllTypes> orphan = orphanage.newOrphan<TestAllTypes>();\n    initTestMessage(orphan.get());\n    root.adoptStructField(kj::mv(orphan));\n    checkTestMessage(root.asReader().getStructField());\n  }\n#endif  // !CAPNP_LITE\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "root.asReader().getStructField()"
          ],
          "line": 628
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [],
          "line": 628
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      },
      {
        "call_info": {
          "callee": "root.adoptStructField",
          "args": [
            "kj::mv(orphan)"
          ],
          "line": 627
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "orphan"
          ],
          "line": 627
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "orphan.get()"
          ],
          "line": 626
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "orphan.get",
          "args": [],
          "line": 626
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "orphanage.newOrphan<TestAllTypes>",
          "args": [],
          "line": 625
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Orphanage::getForMessageContaining",
          "args": [
            "toDynamic(root.initBoolList(3))"
          ],
          "line": 624
        },
        "resolved": true,
        "details": {
          "function_name": "Orphanage::getForMessageContaining",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan.h",
          "lines": "279-281",
          "snippet": "Orphanage Orphanage::getForMessageContaining(BuilderType builder) {\n  return Orphanage(GetInnerBuilder<FromBuilder<BuilderType>>::apply(builder).getArena());\n}",
          "includes": [
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"layout.h\"\n\nOrphanage Orphanage::getForMessageContaining(BuilderType builder) {\n  return Orphanage(GetInnerBuilder<FromBuilder<BuilderType>>::apply(builder).getArena());\n}"
        }
      },
      {
        "call_info": {
          "callee": "toDynamic",
          "args": [
            "root.initBoolList(3)"
          ],
          "line": 624
        },
        "resolved": true,
        "details": {
          "function_name": "toDynamic",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "1246-1248",
          "snippet": "typename DynamicTypeFor<FromServer<T>>::Client toDynamic(kj::Own<T>&& value) {\n  return typename FromServer<T>::Client(kj::mv(value));\n}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ntypename DynamicTypeFor<FromServer<T>>::Client toDynamic(kj::Own<T>&& value) {\n  return typename FromServer<T>::Client(kj::mv(value));\n}"
        }
      },
      {
        "call_info": {
          "callee": "root.initBoolList",
          "args": [
            "3"
          ],
          "line": 624
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.adoptStructField",
          "args": [
            "kj::mv(orphan)"
          ],
          "line": 619
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "orphan"
          ],
          "line": 619
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphanage.newOrphan<TestAllTypes>",
          "args": [],
          "line": 617
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.adoptStructField",
          "args": [
            "kj::mv(orphan)"
          ],
          "line": 610
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "orphan"
          ],
          "line": 610
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphanage.newOrphan<TestAllTypes>",
          "args": [],
          "line": 608
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.initBoolList",
          "args": [
            "3"
          ],
          "line": 607
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.adoptStructField",
          "args": [
            "kj::mv(orphan)"
          ],
          "line": 602
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "orphan"
          ],
          "line": 602
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphanage.newOrphan<TestAllTypes>",
          "args": [],
          "line": 600
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 596
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, OrphanageFromBuilder) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<TestAllTypes>();\n\n  {\n    Orphanage orphanage = Orphanage::getForMessageContaining(root);\n    Orphan<TestAllTypes> orphan = orphanage.newOrphan<TestAllTypes>();\n    initTestMessage(orphan.get());\n    root.adoptStructField(kj::mv(orphan));\n    checkTestMessage(root.asReader().getStructField());\n  }\n\n  {\n    Orphanage orphanage = Orphanage::getForMessageContaining(root.initBoolList(3));\n    Orphan<TestAllTypes> orphan = orphanage.newOrphan<TestAllTypes>();\n    initTestMessage(orphan.get());\n    root.adoptStructField(kj::mv(orphan));\n    checkTestMessage(root.asReader().getStructField());\n  }\n\n#if !CAPNP_LITE\n  {\n    Orphanage orphanage = Orphanage::getForMessageContaining(toDynamic(root));\n    Orphan<TestAllTypes> orphan = orphanage.newOrphan<TestAllTypes>();\n    initTestMessage(orphan.get());\n    root.adoptStructField(kj::mv(orphan));\n    checkTestMessage(root.asReader().getStructField());\n  }\n\n  {\n    Orphanage orphanage = Orphanage::getForMessageContaining(toDynamic(root.initBoolList(3)));\n    Orphan<TestAllTypes> orphan = orphanage.newOrphan<TestAllTypes>();\n    initTestMessage(orphan.get());\n    root.adoptStructField(kj::mv(orphan));\n    checkTestMessage(root.asReader().getStructField());\n  }\n#endif  // !CAPNP_LITE\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "569-591",
    "snippet": "TEST(Orphans, DynamicDisownGroup) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<test::TestGroups>();\n\n  auto bar = root.initGroups().initBar();\n  bar.setCorge(123);\n  bar.setGrault(\"foo\");\n  bar.setGarply(9876543210987ll);\n\n  Orphan<test::TestGroups> dstOrphan =\n      Orphanage::getForMessageContaining(root).newOrphan<test::TestGroups>();\n  auto dst = dstOrphan.get();\n\n  toDynamic(dst).adopt(\"groups\", toDynamic(root).disown(\"groups\"));\n\n  EXPECT_EQ(test::TestGroups::Groups::FOO, root.getGroups().which());\n\n  EXPECT_EQ(test::TestGroups::Groups::BAR, dst.getGroups().which());\n  auto newBar = dst.getGroups().getBar();\n  EXPECT_EQ(123, newBar.getCorge());\n  EXPECT_EQ(\"foo\", newBar.getGrault());\n  EXPECT_EQ(9876543210987ll, newBar.getGarply());\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "9876543210987ll",
            "newBar.getGarply()"
          ],
          "line": 590
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "newBar.getGarply",
          "args": [],
          "line": 590
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "newBar.getGrault()"
          ],
          "line": 589
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "newBar.getGrault",
          "args": [],
          "line": 589
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "123",
            "newBar.getCorge()"
          ],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "newBar.getCorge",
          "args": [],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dst.getGroups",
          "args": [],
          "line": 587
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dst.getGroups",
          "args": [],
          "line": 587
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "test::TestGroups::Groups::BAR",
            "dst.getGroups().which()"
          ],
          "line": 586
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dst.getGroups",
          "args": [],
          "line": 586
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dst.getGroups",
          "args": [],
          "line": 586
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "test::TestGroups::Groups::FOO",
            "root.getGroups().which()"
          ],
          "line": 584
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getGroups",
          "args": [],
          "line": 584
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getGroups",
          "args": [],
          "line": 584
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "toDynamic",
          "args": [
            "\"groups\"",
            "toDynamic(root).disown(\"groups\")"
          ],
          "line": 582
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "toDynamic",
          "args": [
            "\"groups\""
          ],
          "line": 582
        },
        "resolved": true,
        "details": {
          "function_name": "toDynamic",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "1246-1248",
          "snippet": "typename DynamicTypeFor<FromServer<T>>::Client toDynamic(kj::Own<T>&& value) {\n  return typename FromServer<T>::Client(kj::mv(value));\n}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ntypename DynamicTypeFor<FromServer<T>>::Client toDynamic(kj::Own<T>&& value) {\n  return typename FromServer<T>::Client(kj::mv(value));\n}"
        }
      },
      {
        "call_info": {
          "callee": "dstOrphan.get",
          "args": [],
          "line": 580
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Orphanage::getForMessageContaining",
          "args": [],
          "line": 579
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Orphanage::getForMessageContaining",
          "args": [
            "root"
          ],
          "line": 579
        },
        "resolved": true,
        "details": {
          "function_name": "Orphanage::getForMessageContaining",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan.h",
          "lines": "279-281",
          "snippet": "Orphanage Orphanage::getForMessageContaining(BuilderType builder) {\n  return Orphanage(GetInnerBuilder<FromBuilder<BuilderType>>::apply(builder).getArena());\n}",
          "includes": [
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"layout.h\"\n\nOrphanage Orphanage::getForMessageContaining(BuilderType builder) {\n  return Orphanage(GetInnerBuilder<FromBuilder<BuilderType>>::apply(builder).getArena());\n}"
        }
      },
      {
        "call_info": {
          "callee": "bar.setGarply",
          "args": [
            "9876543210987ll"
          ],
          "line": 576
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bar.setGrault",
          "args": [
            "\"foo\""
          ],
          "line": 575
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bar.setCorge",
          "args": [
            "123"
          ],
          "line": 574
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.initGroups",
          "args": [],
          "line": 573
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.initGroups",
          "args": [],
          "line": 573
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<test::TestGroups>",
          "args": [],
          "line": 571
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, DynamicDisownGroup) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<test::TestGroups>();\n\n  auto bar = root.initGroups().initBar();\n  bar.setCorge(123);\n  bar.setGrault(\"foo\");\n  bar.setGarply(9876543210987ll);\n\n  Orphan<test::TestGroups> dstOrphan =\n      Orphanage::getForMessageContaining(root).newOrphan<test::TestGroups>();\n  auto dst = dstOrphan.get();\n\n  toDynamic(dst).adopt(\"groups\", toDynamic(root).disown(\"groups\"));\n\n  EXPECT_EQ(test::TestGroups::Groups::FOO, root.getGroups().which());\n\n  EXPECT_EQ(test::TestGroups::Groups::BAR, dst.getGroups().which());\n  auto newBar = dst.getGroups().getBar();\n  EXPECT_EQ(123, newBar.getCorge());\n  EXPECT_EQ(\"foo\", newBar.getGrault());\n  EXPECT_EQ(9876543210987ll, newBar.getGarply());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "542-567",
    "snippet": "TEST(Orphans, DynamicDisown) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<TestAllTypes>();\n  initTestMessage(root);\n\n  Orphan<TestAllTypes> dstOrphan =\n      Orphanage::getForMessageContaining(root).newOrphan<TestAllTypes>();\n  auto dst = dstOrphan.get();\n\n  DynamicStruct::Builder dynamic = root;\n  DynamicStruct::Builder dynamicDst = dst;\n\n  for (auto field: dynamic.getSchema().getFields()) {\n    dynamicDst.adopt(field, dynamic.disown(field));\n  }\n\n  checkTestMessageAllZero(root.asReader());\n  checkTestMessage(dst.asReader());\n\n  for (auto field: dynamic.getSchema().getFields()) {\n    dynamicDst.adopt(field, dynamic.disown(field));\n  }\n\n  checkTestMessageAllZero(root.asReader());\n  checkTestMessageAllZero(dst.asReader());\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkTestMessageAllZero",
          "args": [
            "dst.asReader()"
          ],
          "line": 566
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessageAllZero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "849-851",
          "snippet": "void checkTestMessageAllZero(TestAllTypes::Reader reader) {\n  genericCheckTestMessageAllZero(reader);\n}",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessageAllZero(TestAllTypes::Reader reader) {\n  genericCheckTestMessageAllZero(reader);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dst.asReader",
          "args": [],
          "line": 566
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      },
      {
        "call_info": {
          "callee": "dynamicDst.adopt",
          "args": [
            "field",
            "dynamic.disown(field)"
          ],
          "line": 562
        },
        "resolved": true,
        "details": {
          "function_name": "adopt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "828-830",
          "snippet": "static inline void adopt(PointerBuilder builder, Orphan<AnyPointer>&& value) {\n    builder.adopt(kj::mv(value.builder));\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline void adopt(PointerBuilder builder, Orphan<AnyPointer>&& value) {\n    builder.adopt(kj::mv(value.builder));\n  }"
        }
      },
      {
        "call_info": {
          "callee": "dynamic.disown",
          "args": [
            "field"
          ],
          "line": 562
        },
        "resolved": true,
        "details": {
          "function_name": "disown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "831-833",
          "snippet": "static inline Orphan<AnyPointer> disown(PointerBuilder builder) {\n    return Orphan<AnyPointer>(builder.disown());\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline Orphan<AnyPointer> disown(PointerBuilder builder) {\n    return Orphan<AnyPointer>(builder.disown());\n  }"
        }
      },
      {
        "call_info": {
          "callee": "dynamic.getSchema",
          "args": [],
          "line": 561
        },
        "resolved": true,
        "details": {
          "function_name": "getSchema",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "505-505",
          "snippet": "inline InterfaceSchema getSchema() const { return schema; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline InterfaceSchema getSchema() const { return schema; }"
        }
      },
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "dst.asReader()"
          ],
          "line": 559
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "dstOrphan.get",
          "args": [],
          "line": 549
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Orphanage::getForMessageContaining",
          "args": [],
          "line": 548
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Orphanage::getForMessageContaining",
          "args": [
            "root"
          ],
          "line": 548
        },
        "resolved": true,
        "details": {
          "function_name": "Orphanage::getForMessageContaining",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan.h",
          "lines": "279-281",
          "snippet": "Orphanage Orphanage::getForMessageContaining(BuilderType builder) {\n  return Orphanage(GetInnerBuilder<FromBuilder<BuilderType>>::apply(builder).getArena());\n}",
          "includes": [
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"layout.h\"\n\nOrphanage Orphanage::getForMessageContaining(BuilderType builder) {\n  return Orphanage(GetInnerBuilder<FromBuilder<BuilderType>>::apply(builder).getArena());\n}"
        }
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "root"
          ],
          "line": 545
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 544
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, DynamicDisown) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<TestAllTypes>();\n  initTestMessage(root);\n\n  Orphan<TestAllTypes> dstOrphan =\n      Orphanage::getForMessageContaining(root).newOrphan<TestAllTypes>();\n  auto dst = dstOrphan.get();\n\n  DynamicStruct::Builder dynamic = root;\n  DynamicStruct::Builder dynamicDst = dst;\n\n  for (auto field: dynamic.getSchema().getFields()) {\n    dynamicDst.adopt(field, dynamic.disown(field));\n  }\n\n  checkTestMessageAllZero(root.asReader());\n  checkTestMessage(dst.asReader());\n\n  for (auto field: dynamic.getSchema().getFields()) {\n    dynamicDst.adopt(field, dynamic.disown(field));\n  }\n\n  checkTestMessageAllZero(root.asReader());\n  checkTestMessageAllZero(dst.asReader());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "527-540",
    "snippet": "TEST(Orphans, DynamicAnyPointer) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<test::TestAnyPointer>();\n\n  initTestMessage(root.getAnyPointerField().initAs<TestAllTypes>());\n  EXPECT_TRUE(root.hasAnyPointerField());\n\n  Orphan<DynamicValue> orphan = root.getAnyPointerField().disown();\n  EXPECT_EQ(DynamicValue::ANY_POINTER, orphan.getType());\n\n  Orphan<AnyPointer> objectOrphan = orphan.releaseAs<AnyPointer>();\n  checkTestMessage(objectOrphan.getAs<TestAllTypes>());\n  checkDynamicTestMessage(objectOrphan.getAs<DynamicStruct>(Schema::from<TestAllTypes>()));\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkDynamicTestMessage",
          "args": [
            "objectOrphan.getAs<DynamicStruct>(Schema::from<TestAllTypes>())"
          ],
          "line": 539
        },
        "resolved": true,
        "details": {
          "function_name": "checkDynamicTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "867-869",
          "snippet": "void checkDynamicTestMessage(DynamicStruct::Reader reader) {\n  dynamicCheckTestMessage(reader);\n}",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkDynamicTestMessage(DynamicStruct::Reader reader) {\n  dynamicCheckTestMessage(reader);\n}"
        }
      },
      {
        "call_info": {
          "callee": "objectOrphan.getAs<DynamicStruct>",
          "args": [
            "Schema::from<TestAllTypes>()"
          ],
          "line": 539
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<TestAllTypes>",
          "args": [],
          "line": 539
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "objectOrphan.getAs<TestAllTypes>()"
          ],
          "line": 538
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "objectOrphan.getAs<TestAllTypes>",
          "args": [],
          "line": 538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.releaseAs<AnyPointer>",
          "args": [],
          "line": 537
        },
        "resolved": true,
        "details": {
          "function_name": "releaseAs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "770-770",
          "snippet": "inline PipelineFor<T> releaseAs() { return AsImpl<T>::apply(*this); }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline PipelineFor<T> releaseAs() { return AsImpl<T>::apply(*this); }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "DynamicValue::ANY_POINTER",
            "orphan.getType()"
          ],
          "line": 535
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.getType",
          "args": [],
          "line": 535
        },
        "resolved": true,
        "details": {
          "function_name": "getType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "942-942",
          "snippet": "inline DynamicValue::Type getType() { return type; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline DynamicValue::Type getType() { return type; }"
        }
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "root.hasAnyPointerField()"
          ],
          "line": 532
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.hasAnyPointerField",
          "args": [],
          "line": 532
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "root.getAnyPointerField().initAs<TestAllTypes>()"
          ],
          "line": 531
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<test::TestAnyPointer>",
          "args": [],
          "line": 529
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, DynamicAnyPointer) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<test::TestAnyPointer>();\n\n  initTestMessage(root.getAnyPointerField().initAs<TestAllTypes>());\n  EXPECT_TRUE(root.hasAnyPointerField());\n\n  Orphan<DynamicValue> orphan = root.getAnyPointerField().disown();\n  EXPECT_EQ(DynamicValue::ANY_POINTER, orphan.getType());\n\n  Orphan<AnyPointer> objectOrphan = orphan.releaseAs<AnyPointer>();\n  checkTestMessage(objectOrphan.getAs<TestAllTypes>());\n  checkDynamicTestMessage(objectOrphan.getAs<DynamicStruct>(Schema::from<TestAllTypes>()));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "485-525",
    "snippet": "TEST(Orphans, DynamicListAs) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<test::TestAnyPointer>();\n\n  root.getAnyPointerField().setAs<List<uint32_t>>({12, 34, 56});\n  EXPECT_TRUE(root.hasAnyPointerField());\n\n  Orphan<DynamicValue> orphan =\n      root.getAnyPointerField().disownAs<DynamicList>(Schema::from<List<uint32_t>>());\n  EXPECT_EQ(DynamicValue::LIST, orphan.getType());\n\n  checkList(orphan.getReader().as<List<uint32_t>>(), {12, 34, 56});\n  checkList(orphan.get().as<List<uint32_t>>(), {12, 34, 56});\n\n  {\n    Orphan<DynamicList> listOrphan = orphan.releaseAs<DynamicList>();\n    EXPECT_EQ(DynamicValue::UNKNOWN, orphan.getType());\n    EXPECT_FALSE(listOrphan == nullptr);\n    checkList<uint32_t>(listOrphan.getReader(), {12, 34, 56});\n    checkList<uint32_t>(listOrphan.get(), {12, 34, 56});\n    checkList(listOrphan.getReader().as<List<uint32_t>>(), {12, 34, 56});\n    checkList(listOrphan.get().as<List<uint32_t>>(), {12, 34, 56});\n\n    {\n      Orphan<List<uint32_t>> typedOrphan = listOrphan.releaseAs<List<uint32_t>>();\n      EXPECT_TRUE(listOrphan == nullptr);\n      EXPECT_FALSE(typedOrphan == nullptr);\n      checkList(typedOrphan.getReader(), {12, 34, 56});\n      checkList(typedOrphan.get(), {12, 34, 56});\n      orphan = kj::mv(typedOrphan);\n      EXPECT_EQ(DynamicValue::LIST, orphan.getType());\n      EXPECT_TRUE(typedOrphan == nullptr);\n    }\n  }\n\n  {\n    Orphan<List<uint32_t>> typedOrphan = orphan.releaseAs<List<uint32_t>>();\n    checkList(typedOrphan.getReader(), {12, 34, 56});\n    checkList(typedOrphan.get(), {12, 34, 56});\n  }\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkList",
          "args": [
            "typedOrphan.get()",
            "{12, 34, 56}"
          ],
          "line": 523
        },
        "resolved": true,
        "details": {
          "function_name": "checkList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic-test.c++",
          "lines": "33-45",
          "snippet": "void checkList(T reader, std::initializer_list<ReaderFor<Element>> expected) {\n  auto list = reader.template as<DynamicList>();\n  ASSERT_EQ(expected.size(), list.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], list[i].template as<Element>());\n  }\n\n  auto typed = reader.template as<List<Element>>();\n  ASSERT_EQ(expected.size(), typed.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], typed[i]);\n  }\n}",
          "includes": [
            "#include \"test-util.h\"",
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"dynamic.h\"\n\nvoid checkList(T reader, std::initializer_list<ReaderFor<Element>> expected) {\n  auto list = reader.template as<DynamicList>();\n  ASSERT_EQ(expected.size(), list.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], list[i].template as<Element>());\n  }\n\n  auto typed = reader.template as<List<Element>>();\n  ASSERT_EQ(expected.size(), typed.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], typed[i]);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "typedOrphan.get",
          "args": [],
          "line": 523
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "typedOrphan.getReader",
          "args": [],
          "line": 522
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.releaseAs<List<uint32_t>>",
          "args": [],
          "line": 521
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "typedOrphan == nullptr"
          ],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "DynamicValue::LIST",
            "orphan.getType()"
          ],
          "line": 515
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.getType",
          "args": [],
          "line": 515
        },
        "resolved": true,
        "details": {
          "function_name": "getType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "942-942",
          "snippet": "inline DynamicValue::Type getType() { return type; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline DynamicValue::Type getType() { return type; }"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "typedOrphan"
          ],
          "line": 514
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typedOrphan.getReader",
          "args": [],
          "line": 512
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "typedOrphan == nullptr"
          ],
          "line": 511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "listOrphan == nullptr"
          ],
          "line": 510
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "listOrphan.releaseAs<List<uint32_t>>",
          "args": [],
          "line": 509
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "listOrphan.getReader",
          "args": [],
          "line": 505
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "listOrphan.getReader",
          "args": [],
          "line": 505
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "listOrphan.getReader",
          "args": [],
          "line": 503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "listOrphan == nullptr"
          ],
          "line": 502
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "DynamicValue::UNKNOWN",
            "orphan.getType()"
          ],
          "line": 501
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.releaseAs<DynamicList>",
          "args": [],
          "line": 500
        },
        "resolved": true,
        "details": {
          "function_name": "releaseAs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "770-770",
          "snippet": "inline PipelineFor<T> releaseAs() { return AsImpl<T>::apply(*this); }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline PipelineFor<T> releaseAs() { return AsImpl<T>::apply(*this); }"
        }
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 496
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 496
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "DynamicValue::LIST",
            "orphan.getType()"
          ],
          "line": 494
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [
            "Schema::from<List<uint32_t>>()"
          ],
          "line": 493
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<uint32_t>>",
          "args": [],
          "line": 493
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 493
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "root.hasAnyPointerField()"
          ],
          "line": 490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.hasAnyPointerField",
          "args": [],
          "line": 490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [
            "{12, 34, 56}"
          ],
          "line": 489
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 489
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<test::TestAnyPointer>",
          "args": [],
          "line": 487
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, DynamicListAs) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<test::TestAnyPointer>();\n\n  root.getAnyPointerField().setAs<List<uint32_t>>({12, 34, 56});\n  EXPECT_TRUE(root.hasAnyPointerField());\n\n  Orphan<DynamicValue> orphan =\n      root.getAnyPointerField().disownAs<DynamicList>(Schema::from<List<uint32_t>>());\n  EXPECT_EQ(DynamicValue::LIST, orphan.getType());\n\n  checkList(orphan.getReader().as<List<uint32_t>>(), {12, 34, 56});\n  checkList(orphan.get().as<List<uint32_t>>(), {12, 34, 56});\n\n  {\n    Orphan<DynamicList> listOrphan = orphan.releaseAs<DynamicList>();\n    EXPECT_EQ(DynamicValue::UNKNOWN, orphan.getType());\n    EXPECT_FALSE(listOrphan == nullptr);\n    checkList<uint32_t>(listOrphan.getReader(), {12, 34, 56});\n    checkList<uint32_t>(listOrphan.get(), {12, 34, 56});\n    checkList(listOrphan.getReader().as<List<uint32_t>>(), {12, 34, 56});\n    checkList(listOrphan.get().as<List<uint32_t>>(), {12, 34, 56});\n\n    {\n      Orphan<List<uint32_t>> typedOrphan = listOrphan.releaseAs<List<uint32_t>>();\n      EXPECT_TRUE(listOrphan == nullptr);\n      EXPECT_FALSE(typedOrphan == nullptr);\n      checkList(typedOrphan.getReader(), {12, 34, 56});\n      checkList(typedOrphan.get(), {12, 34, 56});\n      orphan = kj::mv(typedOrphan);\n      EXPECT_EQ(DynamicValue::LIST, orphan.getType());\n      EXPECT_TRUE(typedOrphan == nullptr);\n    }\n  }\n\n  {\n    Orphan<List<uint32_t>> typedOrphan = orphan.releaseAs<List<uint32_t>>();\n    checkList(typedOrphan.getReader(), {12, 34, 56});\n    checkList(typedOrphan.get(), {12, 34, 56});\n  }\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "443-483",
    "snippet": "TEST(Orphans, DynamicStructAs) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<test::TestAnyPointer>();\n\n  initTestMessage(root.getAnyPointerField().initAs<TestAllTypes>());\n  EXPECT_TRUE(root.hasAnyPointerField());\n\n  Orphan<DynamicValue> orphan =\n      root.getAnyPointerField().disownAs<DynamicStruct>(Schema::from<TestAllTypes>());\n  EXPECT_EQ(DynamicValue::STRUCT, orphan.getType());\n\n  checkTestMessage(orphan.getReader().as<TestAllTypes>());\n  checkTestMessage(orphan.get().as<TestAllTypes>());\n\n  {\n    Orphan<DynamicStruct> structOrphan = orphan.releaseAs<DynamicStruct>();\n    EXPECT_EQ(DynamicValue::UNKNOWN, orphan.getType());\n    EXPECT_FALSE(structOrphan == nullptr);\n    checkDynamicTestMessage(structOrphan.getReader());\n    checkDynamicTestMessage(structOrphan.get());\n    checkTestMessage(structOrphan.getReader().as<TestAllTypes>());\n    checkTestMessage(structOrphan.get().as<TestAllTypes>());\n\n    {\n      Orphan<TestAllTypes> typedOrphan = structOrphan.releaseAs<TestAllTypes>();\n      EXPECT_TRUE(structOrphan == nullptr);\n      EXPECT_FALSE(typedOrphan == nullptr);\n      checkTestMessage(typedOrphan.getReader());\n      checkTestMessage(typedOrphan.get());\n      orphan = kj::mv(typedOrphan);\n      EXPECT_EQ(DynamicValue::STRUCT, orphan.getType());\n      EXPECT_TRUE(typedOrphan == nullptr);\n    }\n  }\n\n  {\n    Orphan<TestAllTypes> typedOrphan = orphan.releaseAs<TestAllTypes>();\n    checkTestMessage(typedOrphan.getReader());\n    checkTestMessage(typedOrphan.get());\n  }\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "typedOrphan.get()"
          ],
          "line": 481
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "typedOrphan.get",
          "args": [],
          "line": 481
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "typedOrphan.getReader",
          "args": [],
          "line": 480
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.releaseAs<TestAllTypes>",
          "args": [],
          "line": 479
        },
        "resolved": true,
        "details": {
          "function_name": "releaseAs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "770-770",
          "snippet": "inline PipelineFor<T> releaseAs() { return AsImpl<T>::apply(*this); }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline PipelineFor<T> releaseAs() { return AsImpl<T>::apply(*this); }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "typedOrphan == nullptr"
          ],
          "line": 474
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "DynamicValue::STRUCT",
            "orphan.getType()"
          ],
          "line": 473
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.getType",
          "args": [],
          "line": 473
        },
        "resolved": true,
        "details": {
          "function_name": "getType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "942-942",
          "snippet": "inline DynamicValue::Type getType() { return type; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline DynamicValue::Type getType() { return type; }"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "typedOrphan"
          ],
          "line": 472
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typedOrphan.getReader",
          "args": [],
          "line": 470
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "typedOrphan == nullptr"
          ],
          "line": 469
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "structOrphan == nullptr"
          ],
          "line": 468
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structOrphan.getReader",
          "args": [],
          "line": 463
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structOrphan.getReader",
          "args": [],
          "line": 463
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "checkDynamicTestMessage",
          "args": [
            "structOrphan.get()"
          ],
          "line": 462
        },
        "resolved": true,
        "details": {
          "function_name": "checkDynamicTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "867-869",
          "snippet": "void checkDynamicTestMessage(DynamicStruct::Reader reader) {\n  dynamicCheckTestMessage(reader);\n}",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkDynamicTestMessage(DynamicStruct::Reader reader) {\n  dynamicCheckTestMessage(reader);\n}"
        }
      },
      {
        "call_info": {
          "callee": "structOrphan.getReader",
          "args": [],
          "line": 461
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "structOrphan == nullptr"
          ],
          "line": 460
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "DynamicValue::UNKNOWN",
            "orphan.getType()"
          ],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "DynamicValue::STRUCT",
            "orphan.getType()"
          ],
          "line": 452
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [
            "Schema::from<TestAllTypes>()"
          ],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<TestAllTypes>",
          "args": [],
          "line": 451
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "root.hasAnyPointerField()"
          ],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.hasAnyPointerField",
          "args": [],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "root.getAnyPointerField().initAs<TestAllTypes>()"
          ],
          "line": 447
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 447
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 447
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<test::TestAnyPointer>",
          "args": [],
          "line": 445
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, DynamicStructAs) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<test::TestAnyPointer>();\n\n  initTestMessage(root.getAnyPointerField().initAs<TestAllTypes>());\n  EXPECT_TRUE(root.hasAnyPointerField());\n\n  Orphan<DynamicValue> orphan =\n      root.getAnyPointerField().disownAs<DynamicStruct>(Schema::from<TestAllTypes>());\n  EXPECT_EQ(DynamicValue::STRUCT, orphan.getType());\n\n  checkTestMessage(orphan.getReader().as<TestAllTypes>());\n  checkTestMessage(orphan.get().as<TestAllTypes>());\n\n  {\n    Orphan<DynamicStruct> structOrphan = orphan.releaseAs<DynamicStruct>();\n    EXPECT_EQ(DynamicValue::UNKNOWN, orphan.getType());\n    EXPECT_FALSE(structOrphan == nullptr);\n    checkDynamicTestMessage(structOrphan.getReader());\n    checkDynamicTestMessage(structOrphan.get());\n    checkTestMessage(structOrphan.getReader().as<TestAllTypes>());\n    checkTestMessage(structOrphan.get().as<TestAllTypes>());\n\n    {\n      Orphan<TestAllTypes> typedOrphan = structOrphan.releaseAs<TestAllTypes>();\n      EXPECT_TRUE(structOrphan == nullptr);\n      EXPECT_FALSE(typedOrphan == nullptr);\n      checkTestMessage(typedOrphan.getReader());\n      checkTestMessage(typedOrphan.get());\n      orphan = kj::mv(typedOrphan);\n      EXPECT_EQ(DynamicValue::STRUCT, orphan.getType());\n      EXPECT_TRUE(typedOrphan == nullptr);\n    }\n  }\n\n  {\n    Orphan<TestAllTypes> typedOrphan = orphan.releaseAs<TestAllTypes>();\n    checkTestMessage(typedOrphan.getReader());\n    checkTestMessage(typedOrphan.get());\n  }\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "427-441",
    "snippet": "TEST(Orphans, OrphanageDynamicListCopy) {\n  MallocMessageBuilder builder1;\n  MallocMessageBuilder builder2;\n\n  auto root1 = builder1.initRoot<test::TestAnyPointer>();\n  root1.getAnyPointerField().setAs<List<uint32_t>>({12, 34, 56});\n\n  Orphan<DynamicList> orphan = builder2.getOrphanage().newOrphanCopy(\n      root1.asReader().getAnyPointerField().getAs<DynamicList>(Schema::from<List<uint32_t>>()));\n  checkList<uint32_t>(orphan.getReader(), {12, 34, 56});\n\n  auto root2 = builder2.initRoot<test::TestAnyPointer>();\n  root2.getAnyPointerField().adopt(kj::mv(orphan));\n  checkList(root2.getAnyPointerField().getAs<List<uint32_t>>(), {12u, 34u, 56u});\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkList",
          "args": [
            "root2.getAnyPointerField().getAs<List<uint32_t>>()",
            "{12u, 34u, 56u}"
          ],
          "line": 440
        },
        "resolved": true,
        "details": {
          "function_name": "checkList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic-test.c++",
          "lines": "33-45",
          "snippet": "void checkList(T reader, std::initializer_list<ReaderFor<Element>> expected) {\n  auto list = reader.template as<DynamicList>();\n  ASSERT_EQ(expected.size(), list.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], list[i].template as<Element>());\n  }\n\n  auto typed = reader.template as<List<Element>>();\n  ASSERT_EQ(expected.size(), typed.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], typed[i]);\n  }\n}",
          "includes": [
            "#include \"test-util.h\"",
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"dynamic.h\"\n\nvoid checkList(T reader, std::initializer_list<ReaderFor<Element>> expected) {\n  auto list = reader.template as<DynamicList>();\n  ASSERT_EQ(expected.size(), list.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], list[i].template as<Element>());\n  }\n\n  auto typed = reader.template as<List<Element>>();\n  ASSERT_EQ(expected.size(), typed.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], typed[i]);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "root2.getAnyPointerField",
          "args": [],
          "line": 440
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root2.getAnyPointerField",
          "args": [],
          "line": 440
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root2.getAnyPointerField",
          "args": [
            "kj::mv(orphan)"
          ],
          "line": 439
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "orphan"
          ],
          "line": 439
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root2.getAnyPointerField",
          "args": [],
          "line": 439
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder2.initRoot<test::TestAnyPointer>",
          "args": [],
          "line": 438
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 436
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder2.getOrphanage",
          "args": [
            "root1.asReader().getAnyPointerField().getAs<DynamicList>(Schema::from<List<uint32_t>>())"
          ],
          "line": 434
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root1.asReader",
          "args": [
            "Schema::from<List<uint32_t>>()"
          ],
          "line": 435
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<uint32_t>>",
          "args": [],
          "line": 435
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root1.asReader",
          "args": [],
          "line": 435
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      },
      {
        "call_info": {
          "callee": "builder2.getOrphanage",
          "args": [],
          "line": 434
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root1.getAnyPointerField",
          "args": [
            "{12, 34, 56}"
          ],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root1.getAnyPointerField",
          "args": [],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder1.initRoot<test::TestAnyPointer>",
          "args": [],
          "line": 431
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, OrphanageDynamicListCopy) {\n  MallocMessageBuilder builder1;\n  MallocMessageBuilder builder2;\n\n  auto root1 = builder1.initRoot<test::TestAnyPointer>();\n  root1.getAnyPointerField().setAs<List<uint32_t>>({12, 34, 56});\n\n  Orphan<DynamicList> orphan = builder2.getOrphanage().newOrphanCopy(\n      root1.asReader().getAnyPointerField().getAs<DynamicList>(Schema::from<List<uint32_t>>()));\n  checkList<uint32_t>(orphan.getReader(), {12, 34, 56});\n\n  auto root2 = builder2.initRoot<test::TestAnyPointer>();\n  root2.getAnyPointerField().adopt(kj::mv(orphan));\n  checkList(root2.getAnyPointerField().getAs<List<uint32_t>>(), {12u, 34u, 56u});\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "411-425",
    "snippet": "TEST(Orphans, OrphanageDynamicStructCopy) {\n  MallocMessageBuilder builder1;\n  MallocMessageBuilder builder2;\n\n  auto root1 = builder1.initRoot<test::TestAnyPointer>();\n  initTestMessage(root1.getAnyPointerField().initAs<TestAllTypes>());\n\n  Orphan<DynamicStruct> orphan = builder2.getOrphanage().newOrphanCopy(\n      root1.asReader().getAnyPointerField().getAs<DynamicStruct>(Schema::from<TestAllTypes>()));\n  checkDynamicTestMessage(orphan.getReader());\n\n  auto root2 = builder2.initRoot<test::TestAnyPointer>();\n  root2.getAnyPointerField().adopt(kj::mv(orphan));\n  checkTestMessage(root2.asReader().getAnyPointerField().getAs<TestAllTypes>());\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "root2.asReader().getAnyPointerField().getAs<TestAllTypes>()"
          ],
          "line": 424
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "root2.asReader",
          "args": [],
          "line": 424
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      },
      {
        "call_info": {
          "callee": "root2.getAnyPointerField",
          "args": [
            "kj::mv(orphan)"
          ],
          "line": 423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "orphan"
          ],
          "line": 423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root2.getAnyPointerField",
          "args": [],
          "line": 423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder2.initRoot<test::TestAnyPointer>",
          "args": [],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "checkDynamicTestMessage",
          "args": [
            "orphan.getReader()"
          ],
          "line": 420
        },
        "resolved": true,
        "details": {
          "function_name": "checkDynamicTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "867-869",
          "snippet": "void checkDynamicTestMessage(DynamicStruct::Reader reader) {\n  dynamicCheckTestMessage(reader);\n}",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkDynamicTestMessage(DynamicStruct::Reader reader) {\n  dynamicCheckTestMessage(reader);\n}"
        }
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder2.getOrphanage",
          "args": [
            "root1.asReader().getAnyPointerField().getAs<DynamicStruct>(Schema::from<TestAllTypes>())"
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root1.asReader",
          "args": [
            "Schema::from<TestAllTypes>()"
          ],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<TestAllTypes>",
          "args": [],
          "line": 419
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "builder2.getOrphanage",
          "args": [],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "root1.getAnyPointerField().initAs<TestAllTypes>()"
          ],
          "line": 416
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "root1.getAnyPointerField",
          "args": [],
          "line": 416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root1.getAnyPointerField",
          "args": [],
          "line": 416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder1.initRoot<test::TestAnyPointer>",
          "args": [],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, OrphanageDynamicStructCopy) {\n  MallocMessageBuilder builder1;\n  MallocMessageBuilder builder2;\n\n  auto root1 = builder1.initRoot<test::TestAnyPointer>();\n  initTestMessage(root1.getAnyPointerField().initAs<TestAllTypes>());\n\n  Orphan<DynamicStruct> orphan = builder2.getOrphanage().newOrphanCopy(\n      root1.asReader().getAnyPointerField().getAs<DynamicStruct>(Schema::from<TestAllTypes>()));\n  checkDynamicTestMessage(orphan.getReader());\n\n  auto root2 = builder2.initRoot<test::TestAnyPointer>();\n  root2.getAnyPointerField().adopt(kj::mv(orphan));\n  checkTestMessage(root2.asReader().getAnyPointerField().getAs<TestAllTypes>());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "397-409",
    "snippet": "TEST(Orphans, OrphanageDynamicList) {\n  MallocMessageBuilder builder;\n\n  Orphan<DynamicList> orphan = builder.getOrphanage().newOrphan(Schema::from<List<uint32_t>>(), 2);\n  orphan.get().set(0, 123);\n  orphan.get().set(1, 456);\n\n  checkList<uint32_t>(orphan.getReader(), {123, 456});\n\n  auto root = builder.initRoot<test::TestAnyPointer>();\n  root.getAnyPointerField().adopt(kj::mv(orphan));\n  checkList(root.getAnyPointerField().getAs<List<uint32_t>>(), {123u, 456u});\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkList",
          "args": [
            "root.getAnyPointerField().getAs<List<uint32_t>>()",
            "{123u, 456u}"
          ],
          "line": 408
        },
        "resolved": true,
        "details": {
          "function_name": "checkList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic-test.c++",
          "lines": "33-45",
          "snippet": "void checkList(T reader, std::initializer_list<ReaderFor<Element>> expected) {\n  auto list = reader.template as<DynamicList>();\n  ASSERT_EQ(expected.size(), list.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], list[i].template as<Element>());\n  }\n\n  auto typed = reader.template as<List<Element>>();\n  ASSERT_EQ(expected.size(), typed.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], typed[i]);\n  }\n}",
          "includes": [
            "#include \"test-util.h\"",
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"dynamic.h\"\n\nvoid checkList(T reader, std::initializer_list<ReaderFor<Element>> expected) {\n  auto list = reader.template as<DynamicList>();\n  ASSERT_EQ(expected.size(), list.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], list[i].template as<Element>());\n  }\n\n  auto typed = reader.template as<List<Element>>();\n  ASSERT_EQ(expected.size(), typed.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], typed[i]);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 408
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 408
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [
            "kj::mv(orphan)"
          ],
          "line": 407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "orphan"
          ],
          "line": 407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<test::TestAnyPointer>",
          "args": [],
          "line": 406
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.get",
          "args": [
            "1",
            "456"
          ],
          "line": 402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.get",
          "args": [],
          "line": 402
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "orphan.get",
          "args": [
            "0",
            "123"
          ],
          "line": 401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getOrphanage",
          "args": [
            "Schema::from<List<uint32_t>>()",
            "2"
          ],
          "line": 400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<uint32_t>>",
          "args": [],
          "line": 400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getOrphanage",
          "args": [],
          "line": 400
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, OrphanageDynamicList) {\n  MallocMessageBuilder builder;\n\n  Orphan<DynamicList> orphan = builder.getOrphanage().newOrphan(Schema::from<List<uint32_t>>(), 2);\n  orphan.get().set(0, 123);\n  orphan.get().set(1, 456);\n\n  checkList<uint32_t>(orphan.getReader(), {123, 456});\n\n  auto root = builder.initRoot<test::TestAnyPointer>();\n  root.getAnyPointerField().adopt(kj::mv(orphan));\n  checkList(root.getAnyPointerField().getAs<List<uint32_t>>(), {123u, 456u});\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "385-395",
    "snippet": "TEST(Orphans, OrphanageDynamicStruct) {\n  MallocMessageBuilder builder;\n\n  Orphan<DynamicStruct> orphan = builder.getOrphanage().newOrphan(Schema::from<TestAllTypes>());\n  initDynamicTestMessage(orphan.get());\n  checkDynamicTestMessage(orphan.getReader());\n\n  auto root = builder.initRoot<test::TestAnyPointer>();\n  root.getAnyPointerField().adopt(kj::mv(orphan));\n  checkTestMessage(root.asReader().getAnyPointerField().getAs<TestAllTypes>());\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "root.asReader().getAnyPointerField().getAs<TestAllTypes>()"
          ],
          "line": 394
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [],
          "line": 394
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [
            "kj::mv(orphan)"
          ],
          "line": 393
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "orphan"
          ],
          "line": 393
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 393
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<test::TestAnyPointer>",
          "args": [],
          "line": 392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "checkDynamicTestMessage",
          "args": [
            "orphan.getReader()"
          ],
          "line": 390
        },
        "resolved": true,
        "details": {
          "function_name": "checkDynamicTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "867-869",
          "snippet": "void checkDynamicTestMessage(DynamicStruct::Reader reader) {\n  dynamicCheckTestMessage(reader);\n}",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkDynamicTestMessage(DynamicStruct::Reader reader) {\n  dynamicCheckTestMessage(reader);\n}"
        }
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "initDynamicTestMessage",
          "args": [
            "orphan.get()"
          ],
          "line": 389
        },
        "resolved": true,
        "details": {
          "function_name": "initDynamicTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "855-857",
          "snippet": "void initDynamicTestMessage(DynamicStruct::Builder builder) {\n  dynamicInitTestMessage(builder);\n}",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initDynamicTestMessage(DynamicStruct::Builder builder) {\n  dynamicInitTestMessage(builder);\n}"
        }
      },
      {
        "call_info": {
          "callee": "orphan.get",
          "args": [],
          "line": 389
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "builder.getOrphanage",
          "args": [
            "Schema::from<TestAllTypes>()"
          ],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<TestAllTypes>",
          "args": [],
          "line": 388
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "builder.getOrphanage",
          "args": [],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, OrphanageDynamicStruct) {\n  MallocMessageBuilder builder;\n\n  Orphan<DynamicStruct> orphan = builder.getOrphanage().newOrphan(Schema::from<TestAllTypes>());\n  initDynamicTestMessage(orphan.get());\n  checkDynamicTestMessage(orphan.getReader());\n\n  auto root = builder.initRoot<test::TestAnyPointer>();\n  root.getAnyPointerField().adopt(kj::mv(orphan));\n  checkTestMessage(root.asReader().getAnyPointerField().getAs<TestAllTypes>());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "357-383",
    "snippet": "TEST(Orphans, DynamicStructList) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<test::TestAnyPointer>();\n\n  auto list = root.getAnyPointerField().initAs<List<TestAllTypes>>(2);\n  list[0].setTextField(\"foo\");\n  list[1].setTextField(\"bar\");\n  EXPECT_TRUE(root.hasAnyPointerField());\n\n  Orphan<DynamicList> orphan =\n      root.getAnyPointerField().disownAs<DynamicList>(Schema::from<List<TestAllTypes>>());\n  EXPECT_FALSE(orphan == nullptr);\n\n  ASSERT_EQ(2u, orphan.get().size());\n  EXPECT_EQ(\"foo\", orphan.get()[0].as<TestAllTypes>().getTextField());\n  EXPECT_EQ(\"bar\", orphan.get()[1].as<TestAllTypes>().getTextField());\n  EXPECT_FALSE(root.hasAnyPointerField());\n\n  root.getAnyPointerField().adopt(kj::mv(orphan));\n  EXPECT_TRUE(orphan == nullptr);\n  EXPECT_TRUE(root.hasAnyPointerField());\n  ASSERT_EQ(2u, root.asReader().getAnyPointerField().getAs<List<TestAllTypes>>().size());\n  EXPECT_EQ(\"foo\", root.asReader().getAnyPointerField()\n                       .getAs<List<TestAllTypes>>()[0].getTextField());\n  EXPECT_EQ(\"bar\", root.asReader().getAnyPointerField()\n                       .getAs<List<TestAllTypes>>()[1].getTextField());\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"bar\"",
            "root.asReader().getAnyPointerField()\n                       .getAs<List<TestAllTypes>>()[1].getTextField()"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [],
          "line": 381
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "root.asReader().getAnyPointerField()\n                       .getAs<List<TestAllTypes>>()[0].getTextField()"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "2u",
            "root.asReader().getAnyPointerField().getAs<List<TestAllTypes>>().size()"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "root.hasAnyPointerField()"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.hasAnyPointerField",
          "args": [],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "orphan == nullptr"
          ],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [
            "kj::mv(orphan)"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "orphan"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "root.hasAnyPointerField()"
          ],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.hasAnyPointerField",
          "args": [],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"bar\"",
            "orphan.get()[1].as<TestAllTypes>().getTextField()"
          ],
          "line": 372
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.get",
          "args": [],
          "line": 372
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "orphan.get()[0].as<TestAllTypes>().getTextField()"
          ],
          "line": 371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "2u",
            "orphan.get().size()"
          ],
          "line": 370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "orphan == nullptr"
          ],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [
            "Schema::from<List<TestAllTypes>>()"
          ],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<TestAllTypes>>",
          "args": [],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "root.hasAnyPointerField()"
          ],
          "line": 364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.hasAnyPointerField",
          "args": [],
          "line": 364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list[1].setTextField",
          "args": [
            "\"bar\""
          ],
          "line": 363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list[0].setTextField",
          "args": [
            "\"foo\""
          ],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [
            "2"
          ],
          "line": 361
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 361
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<test::TestAnyPointer>",
          "args": [],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, DynamicStructList) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<test::TestAnyPointer>();\n\n  auto list = root.getAnyPointerField().initAs<List<TestAllTypes>>(2);\n  list[0].setTextField(\"foo\");\n  list[1].setTextField(\"bar\");\n  EXPECT_TRUE(root.hasAnyPointerField());\n\n  Orphan<DynamicList> orphan =\n      root.getAnyPointerField().disownAs<DynamicList>(Schema::from<List<TestAllTypes>>());\n  EXPECT_FALSE(orphan == nullptr);\n\n  ASSERT_EQ(2u, orphan.get().size());\n  EXPECT_EQ(\"foo\", orphan.get()[0].as<TestAllTypes>().getTextField());\n  EXPECT_EQ(\"bar\", orphan.get()[1].as<TestAllTypes>().getTextField());\n  EXPECT_FALSE(root.hasAnyPointerField());\n\n  root.getAnyPointerField().adopt(kj::mv(orphan));\n  EXPECT_TRUE(orphan == nullptr);\n  EXPECT_TRUE(root.hasAnyPointerField());\n  ASSERT_EQ(2u, root.asReader().getAnyPointerField().getAs<List<TestAllTypes>>().size());\n  EXPECT_EQ(\"foo\", root.asReader().getAnyPointerField()\n                       .getAs<List<TestAllTypes>>()[0].getTextField());\n  EXPECT_EQ(\"bar\", root.asReader().getAnyPointerField()\n                       .getAs<List<TestAllTypes>>()[1].getTextField());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "333-355",
    "snippet": "TEST(Orphans, DynamicList) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<test::TestAnyPointer>();\n\n  root.getAnyPointerField().setAs<List<uint32_t>>({12, 34, 56});\n  EXPECT_TRUE(root.hasAnyPointerField());\n\n  Orphan<DynamicList> orphan =\n      root.getAnyPointerField().disownAs<DynamicList>(Schema::from<List<uint32_t>>());\n  EXPECT_FALSE(orphan == nullptr);\n\n  checkList<uint32_t>(orphan.getReader(), {12, 34, 56});\n  EXPECT_FALSE(root.hasAnyPointerField());\n\n  root.getAnyPointerField().adopt(kj::mv(orphan));\n  EXPECT_TRUE(orphan == nullptr);\n  EXPECT_TRUE(root.hasAnyPointerField());\n  checkList(root.asReader().getAnyPointerField().getAs<List<uint32_t>>(), {12u, 34u, 56u});\n\n  Orphan<DynamicList> orphan2 = root.getAnyPointerField().disownAs<List<uint32_t>>();\n  EXPECT_FALSE(orphan2 == nullptr);\n  checkList<uint32_t>(orphan2.getReader(), {12, 34, 56});\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkList<uint32_t>",
          "args": [
            "orphan2.getReader()",
            "{12, 34, 56}"
          ],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "checkList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic-test.c++",
          "lines": "33-45",
          "snippet": "void checkList(T reader, std::initializer_list<ReaderFor<Element>> expected) {\n  auto list = reader.template as<DynamicList>();\n  ASSERT_EQ(expected.size(), list.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], list[i].template as<Element>());\n  }\n\n  auto typed = reader.template as<List<Element>>();\n  ASSERT_EQ(expected.size(), typed.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], typed[i]);\n  }\n}",
          "includes": [
            "#include \"test-util.h\"",
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"dynamic.h\"\n\nvoid checkList(T reader, std::initializer_list<ReaderFor<Element>> expected) {\n  auto list = reader.template as<DynamicList>();\n  ASSERT_EQ(expected.size(), list.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], list[i].template as<Element>());\n  }\n\n  auto typed = reader.template as<List<Element>>();\n  ASSERT_EQ(expected.size(), typed.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], typed[i]);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "orphan2.getReader",
          "args": [],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "orphan2 == nullptr"
          ],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [],
          "line": 350
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "root.hasAnyPointerField()"
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.hasAnyPointerField",
          "args": [],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "orphan == nullptr"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [
            "kj::mv(orphan)"
          ],
          "line": 347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "orphan"
          ],
          "line": 347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "root.hasAnyPointerField()"
          ],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.hasAnyPointerField",
          "args": [],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "orphan == nullptr"
          ],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [
            "Schema::from<List<uint32_t>>()"
          ],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<List<uint32_t>>",
          "args": [],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "root.hasAnyPointerField()"
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.hasAnyPointerField",
          "args": [],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [
            "{12, 34, 56}"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<test::TestAnyPointer>",
          "args": [],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, DynamicList) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<test::TestAnyPointer>();\n\n  root.getAnyPointerField().setAs<List<uint32_t>>({12, 34, 56});\n  EXPECT_TRUE(root.hasAnyPointerField());\n\n  Orphan<DynamicList> orphan =\n      root.getAnyPointerField().disownAs<DynamicList>(Schema::from<List<uint32_t>>());\n  EXPECT_FALSE(orphan == nullptr);\n\n  checkList<uint32_t>(orphan.getReader(), {12, 34, 56});\n  EXPECT_FALSE(root.hasAnyPointerField());\n\n  root.getAnyPointerField().adopt(kj::mv(orphan));\n  EXPECT_TRUE(orphan == nullptr);\n  EXPECT_TRUE(root.hasAnyPointerField());\n  checkList(root.asReader().getAnyPointerField().getAs<List<uint32_t>>(), {12u, 34u, 56u});\n\n  Orphan<DynamicList> orphan2 = root.getAnyPointerField().disownAs<List<uint32_t>>();\n  EXPECT_FALSE(orphan2 == nullptr);\n  checkList<uint32_t>(orphan2.getReader(), {12, 34, 56});\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "307-331",
    "snippet": "TEST(Orphans, DynamicStruct) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<test::TestAnyPointer>();\n\n  initTestMessage(root.getAnyPointerField().initAs<TestAllTypes>());\n  EXPECT_TRUE(root.hasAnyPointerField());\n\n  Orphan<DynamicStruct> orphan =\n      root.getAnyPointerField().disownAs<DynamicStruct>(Schema::from<TestAllTypes>());\n  EXPECT_FALSE(orphan == nullptr);\n\n  EXPECT_TRUE(orphan.get().getSchema() == Schema::from<TestAllTypes>());\n  checkDynamicTestMessage(orphan.getReader());\n  EXPECT_FALSE(root.hasAnyPointerField());\n\n  root.getAnyPointerField().adopt(kj::mv(orphan));\n  EXPECT_TRUE(orphan == nullptr);\n  EXPECT_TRUE(root.hasAnyPointerField());\n  checkTestMessage(root.asReader().getAnyPointerField().getAs<TestAllTypes>());\n\n  Orphan<DynamicStruct> orphan2 = root.getAnyPointerField().disownAs<TestAllTypes>();\n  EXPECT_FALSE(orphan2 == nullptr);\n  EXPECT_TRUE(orphan2.get().getSchema() == Schema::from<TestAllTypes>());\n  checkDynamicTestMessage(orphan2.getReader());\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkDynamicTestMessage",
          "args": [
            "orphan2.getReader()"
          ],
          "line": 330
        },
        "resolved": true,
        "details": {
          "function_name": "checkDynamicTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "867-869",
          "snippet": "void checkDynamicTestMessage(DynamicStruct::Reader reader) {\n  dynamicCheckTestMessage(reader);\n}",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkDynamicTestMessage(DynamicStruct::Reader reader) {\n  dynamicCheckTestMessage(reader);\n}"
        }
      },
      {
        "call_info": {
          "callee": "orphan2.getReader",
          "args": [],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "orphan2.get().getSchema() == Schema::from<TestAllTypes>()"
          ],
          "line": 329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<TestAllTypes>",
          "args": [],
          "line": 329
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "orphan2.get",
          "args": [],
          "line": 329
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "orphan2 == nullptr"
          ],
          "line": 328
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "root.asReader().getAnyPointerField().getAs<TestAllTypes>()"
          ],
          "line": 325
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [],
          "line": 325
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "root.hasAnyPointerField()"
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.hasAnyPointerField",
          "args": [],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "orphan == nullptr"
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [
            "kj::mv(orphan)"
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "orphan"
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "root.hasAnyPointerField()"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.hasAnyPointerField",
          "args": [],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "orphan.get().getSchema() == Schema::from<TestAllTypes>()"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "orphan == nullptr"
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [
            "Schema::from<TestAllTypes>()"
          ],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "root.hasAnyPointerField()"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.hasAnyPointerField",
          "args": [],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "root.getAnyPointerField().initAs<TestAllTypes>()"
          ],
          "line": 311
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<test::TestAnyPointer>",
          "args": [],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, DynamicStruct) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<test::TestAnyPointer>();\n\n  initTestMessage(root.getAnyPointerField().initAs<TestAllTypes>());\n  EXPECT_TRUE(root.hasAnyPointerField());\n\n  Orphan<DynamicStruct> orphan =\n      root.getAnyPointerField().disownAs<DynamicStruct>(Schema::from<TestAllTypes>());\n  EXPECT_FALSE(orphan == nullptr);\n\n  EXPECT_TRUE(orphan.get().getSchema() == Schema::from<TestAllTypes>());\n  checkDynamicTestMessage(orphan.getReader());\n  EXPECT_FALSE(root.hasAnyPointerField());\n\n  root.getAnyPointerField().adopt(kj::mv(orphan));\n  EXPECT_TRUE(orphan == nullptr);\n  EXPECT_TRUE(root.hasAnyPointerField());\n  checkTestMessage(root.asReader().getAnyPointerField().getAs<TestAllTypes>());\n\n  Orphan<DynamicStruct> orphan2 = root.getAnyPointerField().disownAs<TestAllTypes>();\n  EXPECT_FALSE(orphan2 == nullptr);\n  EXPECT_TRUE(orphan2.get().getSchema() == Schema::from<TestAllTypes>());\n  checkDynamicTestMessage(orphan2.getReader());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "287-304",
    "snippet": "TEST(Orphans, ListAnyPointer) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<test::TestAnyPointer>();\n\n  root.getAnyPointerField().setAs<List<uint32_t>>({12, 34, 56});\n  EXPECT_TRUE(root.hasAnyPointerField());\n\n  Orphan<List<uint32_t>> orphan = root.getAnyPointerField().disownAs<List<uint32_t>>();\n  EXPECT_FALSE(orphan == nullptr);\n\n  checkList(orphan.getReader(), {12u, 34u, 56u});\n  EXPECT_FALSE(root.hasAnyPointerField());\n\n  root.getAnyPointerField().adopt(kj::mv(orphan));\n  EXPECT_TRUE(orphan == nullptr);\n  EXPECT_TRUE(root.hasAnyPointerField());\n  checkList(root.asReader().getAnyPointerField().getAs<List<uint32_t>>(), {12u, 34u, 56u});\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkList",
          "args": [
            "root.asReader().getAnyPointerField().getAs<List<uint32_t>>()",
            "{12u, 34u, 56u}"
          ],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "checkList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic-test.c++",
          "lines": "33-45",
          "snippet": "void checkList(T reader, std::initializer_list<ReaderFor<Element>> expected) {\n  auto list = reader.template as<DynamicList>();\n  ASSERT_EQ(expected.size(), list.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], list[i].template as<Element>());\n  }\n\n  auto typed = reader.template as<List<Element>>();\n  ASSERT_EQ(expected.size(), typed.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], typed[i]);\n  }\n}",
          "includes": [
            "#include \"test-util.h\"",
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"dynamic.h\"\n\nvoid checkList(T reader, std::initializer_list<ReaderFor<Element>> expected) {\n  auto list = reader.template as<DynamicList>();\n  ASSERT_EQ(expected.size(), list.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], list[i].template as<Element>());\n  }\n\n  auto typed = reader.template as<List<Element>>();\n  ASSERT_EQ(expected.size(), typed.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], typed[i]);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "root.hasAnyPointerField()"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.hasAnyPointerField",
          "args": [],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "orphan == nullptr"
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [
            "kj::mv(orphan)"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "orphan"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "root.hasAnyPointerField()"
          ],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.hasAnyPointerField",
          "args": [],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "orphan == nullptr"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "root.hasAnyPointerField()"
          ],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.hasAnyPointerField",
          "args": [],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [
            "{12, 34, 56}"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<test::TestAnyPointer>",
          "args": [],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, ListAnyPointer) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<test::TestAnyPointer>();\n\n  root.getAnyPointerField().setAs<List<uint32_t>>({12, 34, 56});\n  EXPECT_TRUE(root.hasAnyPointerField());\n\n  Orphan<List<uint32_t>> orphan = root.getAnyPointerField().disownAs<List<uint32_t>>();\n  EXPECT_FALSE(orphan == nullptr);\n\n  checkList(orphan.getReader(), {12u, 34u, 56u});\n  EXPECT_FALSE(root.hasAnyPointerField());\n\n  root.getAnyPointerField().adopt(kj::mv(orphan));\n  EXPECT_TRUE(orphan == nullptr);\n  EXPECT_TRUE(root.hasAnyPointerField());\n  checkList(root.asReader().getAnyPointerField().getAs<List<uint32_t>>(), {12u, 34u, 56u});\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "268-285",
    "snippet": "TEST(Orphans, StructAnyPointer) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<test::TestAnyPointer>();\n\n  initTestMessage(root.getAnyPointerField().initAs<TestAllTypes>());\n  EXPECT_TRUE(root.hasAnyPointerField());\n\n  Orphan<TestAllTypes> orphan = root.getAnyPointerField().disownAs<TestAllTypes>();\n  EXPECT_FALSE(orphan == nullptr);\n\n  checkTestMessage(orphan.getReader());\n  EXPECT_FALSE(root.hasAnyPointerField());\n\n  root.getAnyPointerField().adopt(kj::mv(orphan));\n  EXPECT_TRUE(orphan == nullptr);\n  EXPECT_TRUE(root.hasAnyPointerField());\n  checkTestMessage(root.asReader().getAnyPointerField().getAs<TestAllTypes>());\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "root.asReader().getAnyPointerField().getAs<TestAllTypes>()"
          ],
          "line": 284
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [],
          "line": 284
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "root.hasAnyPointerField()"
          ],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.hasAnyPointerField",
          "args": [],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "orphan == nullptr"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [
            "kj::mv(orphan)"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "orphan"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "root.hasAnyPointerField()"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.hasAnyPointerField",
          "args": [],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "orphan == nullptr"
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "root.hasAnyPointerField()"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.hasAnyPointerField",
          "args": [],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "root.getAnyPointerField().initAs<TestAllTypes>()"
          ],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getAnyPointerField",
          "args": [],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<test::TestAnyPointer>",
          "args": [],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, StructAnyPointer) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<test::TestAnyPointer>();\n\n  initTestMessage(root.getAnyPointerField().initAs<TestAllTypes>());\n  EXPECT_TRUE(root.hasAnyPointerField());\n\n  Orphan<TestAllTypes> orphan = root.getAnyPointerField().disownAs<TestAllTypes>();\n  EXPECT_FALSE(orphan == nullptr);\n\n  checkTestMessage(orphan.getReader());\n  EXPECT_FALSE(root.hasAnyPointerField());\n\n  root.getAnyPointerField().adopt(kj::mv(orphan));\n  EXPECT_TRUE(orphan == nullptr);\n  EXPECT_TRUE(root.hasAnyPointerField());\n  checkTestMessage(root.asReader().getAnyPointerField().getAs<TestAllTypes>());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "253-266",
    "snippet": "TEST(Orphans, ZeroOut) {\n  MallocMessageBuilder builder;\n  TestAllTypes::Reader orphanReader;\n\n  {\n    Orphan<TestAllTypes> orphan = builder.getOrphanage().newOrphan<TestAllTypes>();\n    orphanReader = orphan.getReader();\n    initTestMessage(orphan.get());\n    checkTestMessage(orphan.getReader());\n  }\n\n  // Once the Orphan destructor is called, the message should be zero'd out.\n  checkTestMessageAllZero(orphanReader);\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkTestMessageAllZero",
          "args": [
            "orphanReader"
          ],
          "line": 265
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessageAllZero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "849-851",
          "snippet": "void checkTestMessageAllZero(TestAllTypes::Reader reader) {\n  genericCheckTestMessageAllZero(reader);\n}",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessageAllZero(TestAllTypes::Reader reader) {\n  genericCheckTestMessageAllZero(reader);\n}"
        }
      },
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "orphan.getReader()"
          ],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "orphan.get()"
          ],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "orphan.get",
          "args": [],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getOrphanage",
          "args": [],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getOrphanage",
          "args": [],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, ZeroOut) {\n  MallocMessageBuilder builder;\n  TestAllTypes::Reader orphanReader;\n\n  {\n    Orphan<TestAllTypes> orphan = builder.getOrphanage().newOrphan<TestAllTypes>();\n    orphanReader = orphan.getReader();\n    initTestMessage(orphan.get());\n    checkTestMessage(orphan.getReader());\n  }\n\n  // Once the Orphan destructor is called, the message should be zero'd out.\n  checkTestMessageAllZero(orphanReader);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "243-251",
    "snippet": "TEST(Orphans, OrphanageDataCopy) {\n  MallocMessageBuilder builder;\n\n  Orphan<Data> orphan = builder.getOrphanage().newOrphanCopy(data(\"foo\"));\n  EXPECT_EQ(data(\"foo\"), orphan.getReader());\n\n  auto root = builder.initRoot<TestAllTypes>();\n  root.adoptDataField(kj::mv(orphan));\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "root.adoptDataField",
          "args": [
            "kj::mv(orphan)"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "orphan"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "data(\"foo\")",
            "orphan.getReader()"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "data",
          "args": [
            "\"foo\""
          ],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "dataEquals",
          "container": "TestOutputStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-test.c++",
          "lines": "278-281",
          "snippet": "bool dataEquals(kj::ArrayPtr<const word> other) {\n    return data ==\n        std::string(other.asChars().begin(), other.asChars().size());\n  }",
          "includes": [
            "#include \"test-util.h\"",
            "#include <fcntl.h>",
            "#include <stdlib.h>",
            "#include <string>",
            "#include <kj/miniposix.h>",
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"test-util.h\"\n#include <fcntl.h>\n#include <stdlib.h>\n#include <string>\n#include <kj/miniposix.h>\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n\nTestOutputStream {\n  bool dataEquals(kj::ArrayPtr<const word> other) {\n      return data ==\n          std::string(other.asChars().begin(), other.asChars().size());\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "builder.getOrphanage",
          "args": [
            "data(\"foo\")"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getOrphanage",
          "args": [],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, OrphanageDataCopy) {\n  MallocMessageBuilder builder;\n\n  Orphan<Data> orphan = builder.getOrphanage().newOrphanCopy(data(\"foo\"));\n  EXPECT_EQ(data(\"foo\"), orphan.getReader());\n\n  auto root = builder.initRoot<TestAllTypes>();\n  root.adoptDataField(kj::mv(orphan));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "233-241",
    "snippet": "TEST(Orphans, OrphanageTextCopy) {\n  MallocMessageBuilder builder;\n\n  Orphan<Text> orphan = builder.getOrphanage().newOrphanCopy(Text::Reader(\"foobarba\"));\n  EXPECT_EQ(\"foobarba\", orphan.getReader());\n\n  auto root = builder.initRoot<TestAllTypes>();\n  root.adoptTextField(kj::mv(orphan));\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "root.adoptTextField",
          "args": [
            "kj::mv(orphan)"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "orphan"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foobarba\"",
            "orphan.getReader()"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getOrphanage",
          "args": [
            "Text::Reader(\"foobarba\")"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Text::Reader",
          "args": [
            "\"foobarba\""
          ],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "Reader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "569-570",
          "snippet": "inline Reader(T&& value)\n      : _reader(_::PointerHelpers<FromReader<T>>::getInternalReader(kj::fwd<T>(value))) {}",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader(T&& value)\n      : _reader(_::PointerHelpers<FromReader<T>>::getInternalReader(kj::fwd<T>(value))) {}"
        }
      },
      {
        "call_info": {
          "callee": "builder.getOrphanage",
          "args": [],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, OrphanageTextCopy) {\n  MallocMessageBuilder builder;\n\n  Orphan<Text> orphan = builder.getOrphanage().newOrphanCopy(Text::Reader(\"foobarba\"));\n  EXPECT_EQ(\"foobarba\", orphan.getReader());\n\n  auto root = builder.initRoot<TestAllTypes>();\n  root.adoptTextField(kj::mv(orphan));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "218-231",
    "snippet": "TEST(Orphans, OrphanageListCopy) {\n  MallocMessageBuilder builder1;\n  MallocMessageBuilder builder2;\n\n  auto root1 = builder1.initRoot<TestAllTypes>();\n  root1.setUInt32List({12, 34, 56});\n\n  Orphan<List<uint32_t>> orphan = builder2.getOrphanage().newOrphanCopy(\n      root1.asReader().getUInt32List());\n  checkList(orphan.getReader(), {12u, 34u, 56u});\n\n  auto root2 = builder2.initRoot<TestAllTypes>();\n  root2.adoptUInt32List(kj::mv(orphan));\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "root2.adoptUInt32List",
          "args": [
            "kj::mv(orphan)"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "orphan"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder2.initRoot<TestAllTypes>",
          "args": [],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "checkList",
          "args": [
            "orphan.getReader()",
            "{12u, 34u, 56u}"
          ],
          "line": 227
        },
        "resolved": true,
        "details": {
          "function_name": "checkList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic-test.c++",
          "lines": "33-45",
          "snippet": "void checkList(T reader, std::initializer_list<ReaderFor<Element>> expected) {\n  auto list = reader.template as<DynamicList>();\n  ASSERT_EQ(expected.size(), list.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], list[i].template as<Element>());\n  }\n\n  auto typed = reader.template as<List<Element>>();\n  ASSERT_EQ(expected.size(), typed.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], typed[i]);\n  }\n}",
          "includes": [
            "#include \"test-util.h\"",
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"dynamic.h\"\n\nvoid checkList(T reader, std::initializer_list<ReaderFor<Element>> expected) {\n  auto list = reader.template as<DynamicList>();\n  ASSERT_EQ(expected.size(), list.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], list[i].template as<Element>());\n  }\n\n  auto typed = reader.template as<List<Element>>();\n  ASSERT_EQ(expected.size(), typed.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], typed[i]);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder2.getOrphanage",
          "args": [
            "root1.asReader().getUInt32List()"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root1.asReader",
          "args": [],
          "line": 226
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      },
      {
        "call_info": {
          "callee": "builder2.getOrphanage",
          "args": [],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root1.setUInt32List",
          "args": [
            "{12, 34, 56}"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder1.initRoot<TestAllTypes>",
          "args": [],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, OrphanageListCopy) {\n  MallocMessageBuilder builder1;\n  MallocMessageBuilder builder2;\n\n  auto root1 = builder1.initRoot<TestAllTypes>();\n  root1.setUInt32List({12, 34, 56});\n\n  Orphan<List<uint32_t>> orphan = builder2.getOrphanage().newOrphanCopy(\n      root1.asReader().getUInt32List());\n  checkList(orphan.getReader(), {12u, 34u, 56u});\n\n  auto root2 = builder2.initRoot<TestAllTypes>();\n  root2.adoptUInt32List(kj::mv(orphan));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "204-216",
    "snippet": "TEST(Orphans, OrphanageStructCopy) {\n  MallocMessageBuilder builder1;\n  MallocMessageBuilder builder2;\n\n  auto root1 = builder1.initRoot<TestAllTypes>();\n  initTestMessage(root1);\n\n  Orphan<TestAllTypes> orphan = builder2.getOrphanage().newOrphanCopy(root1.asReader());\n  checkTestMessage(orphan.getReader());\n\n  auto root2 = builder2.initRoot<TestAllTypes>();\n  root2.adoptStructField(kj::mv(orphan));\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "root2.adoptStructField",
          "args": [
            "kj::mv(orphan)"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "orphan"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder2.initRoot<TestAllTypes>",
          "args": [],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "orphan.getReader()"
          ],
          "line": 212
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder2.getOrphanage",
          "args": [
            "root1.asReader()"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root1.asReader",
          "args": [],
          "line": 211
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      },
      {
        "call_info": {
          "callee": "builder2.getOrphanage",
          "args": [],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "root1"
          ],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "builder1.initRoot<TestAllTypes>",
          "args": [],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, OrphanageStructCopy) {\n  MallocMessageBuilder builder1;\n  MallocMessageBuilder builder2;\n\n  auto root1 = builder1.initRoot<TestAllTypes>();\n  initTestMessage(root1);\n\n  Orphan<TestAllTypes> orphan = builder2.getOrphanage().newOrphanCopy(root1.asReader());\n  checkTestMessage(orphan.getReader());\n\n  auto root2 = builder2.initRoot<TestAllTypes>();\n  root2.adoptStructField(kj::mv(orphan));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "189-202",
    "snippet": "TEST(Orphans, OrphanageData) {\n  MallocMessageBuilder builder;\n\n  Orphan<Data> orphan = builder.getOrphanage().newOrphan<Data>(2);\n  ASSERT_EQ(2u, orphan.get().size());\n  orphan.get()[0] = 123;\n  orphan.get()[1] = 45;\n\n  auto root = builder.initRoot<TestAllTypes>();\n  root.adoptDataField(kj::mv(orphan));\n  ASSERT_EQ(2u, root.getDataField().size());\n  EXPECT_EQ(123u, root.getDataField()[0]);\n  EXPECT_EQ(45u, root.getDataField()[1]);\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "45u",
            "root.getDataField()[1]"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getDataField",
          "args": [],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "123u",
            "root.getDataField()[0]"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getDataField",
          "args": [],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "2u",
            "root.getDataField().size()"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getDataField",
          "args": [],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getDataField",
          "args": [],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.adoptDataField",
          "args": [
            "kj::mv(orphan)"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "orphan"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.get",
          "args": [],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "2u",
            "orphan.get().size()"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getOrphanage",
          "args": [
            "2"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getOrphanage",
          "args": [],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, OrphanageData) {\n  MallocMessageBuilder builder;\n\n  Orphan<Data> orphan = builder.getOrphanage().newOrphan<Data>(2);\n  ASSERT_EQ(2u, orphan.get().size());\n  orphan.get()[0] = 123;\n  orphan.get()[1] = 45;\n\n  auto root = builder.initRoot<TestAllTypes>();\n  root.adoptDataField(kj::mv(orphan));\n  ASSERT_EQ(2u, root.getDataField().size());\n  EXPECT_EQ(123u, root.getDataField()[0]);\n  EXPECT_EQ(45u, root.getDataField()[1]);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "177-187",
    "snippet": "TEST(Orphans, OrphanageText) {\n  MallocMessageBuilder builder;\n\n  Orphan<Text> orphan = builder.getOrphanage().newOrphan<Text>(8);\n  ASSERT_EQ(8u, orphan.get().size());\n  memcpy(orphan.get().begin(), \"12345678\", 8);\n\n  auto root = builder.initRoot<TestAllTypes>();\n  root.adoptTextField(kj::mv(orphan));\n  EXPECT_EQ(\"12345678\", root.getTextField());\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"12345678\"",
            "root.getTextField()"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getTextField",
          "args": [],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.adoptTextField",
          "args": [
            "kj::mv(orphan)"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "orphan"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "orphan.get().begin()",
            "\"12345678\"",
            "8"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.get",
          "args": [],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "8u",
            "orphan.get().size()"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getOrphanage",
          "args": [
            "8"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getOrphanage",
          "args": [],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, OrphanageText) {\n  MallocMessageBuilder builder;\n\n  Orphan<Text> orphan = builder.getOrphanage().newOrphan<Text>(8);\n  ASSERT_EQ(8u, orphan.get().size());\n  memcpy(orphan.get().begin(), \"12345678\", 8);\n\n  auto root = builder.initRoot<TestAllTypes>();\n  root.adoptTextField(kj::mv(orphan));\n  EXPECT_EQ(\"12345678\", root.getTextField());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "161-175",
    "snippet": "TEST(Orphans, OrphanageList) {\n  MallocMessageBuilder builder;\n\n  Orphan<List<uint32_t>> orphan = builder.getOrphanage().newOrphan<List<uint32_t>>(2);\n  orphan.get().set(0, 123);\n  orphan.get().set(1, 456);\n\n  List<uint32_t>::Reader reader = orphan.getReader();\n  ASSERT_EQ(2u, reader.size());\n  EXPECT_EQ(123u, reader[0]);\n  EXPECT_EQ(456u, reader[1]);\n\n  auto root = builder.initRoot<TestAllTypes>();\n  root.adoptUInt32List(kj::mv(orphan));\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "root.adoptUInt32List",
          "args": [
            "kj::mv(orphan)"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "orphan"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "456u",
            "reader[1]"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "123u",
            "reader[0]"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "2u",
            "reader.size()"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.size",
          "args": [],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "599-599",
          "snippet": "inline uint size() { return _builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline uint size() { return _builder.size() / ELEMENTS; }"
        }
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.get",
          "args": [
            "1",
            "456"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.get",
          "args": [],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "orphan.get",
          "args": [
            "0",
            "123"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getOrphanage",
          "args": [
            "2"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getOrphanage",
          "args": [],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, OrphanageList) {\n  MallocMessageBuilder builder;\n\n  Orphan<List<uint32_t>> orphan = builder.getOrphanage().newOrphan<List<uint32_t>>(2);\n  orphan.get().set(0, 123);\n  orphan.get().set(1, 456);\n\n  List<uint32_t>::Reader reader = orphan.getReader();\n  ASSERT_EQ(2u, reader.size());\n  EXPECT_EQ(123u, reader[0]);\n  EXPECT_EQ(456u, reader[1]);\n\n  auto root = builder.initRoot<TestAllTypes>();\n  root.adoptUInt32List(kj::mv(orphan));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "150-159",
    "snippet": "TEST(Orphans, OrphanageStruct) {\n  MallocMessageBuilder builder;\n\n  Orphan<TestAllTypes> orphan = builder.getOrphanage().newOrphan<TestAllTypes>();\n  initTestMessage(orphan.get());\n  checkTestMessage(orphan.getReader());\n\n  auto root = builder.initRoot<TestAllTypes>();\n  root.adoptStructField(kj::mv(orphan));\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "root.adoptStructField",
          "args": [
            "kj::mv(orphan)"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "orphan"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "orphan.getReader()"
          ],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "orphan.get()"
          ],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "orphan.get",
          "args": [],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "builder.getOrphanage",
          "args": [],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getOrphanage",
          "args": [],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, OrphanageStruct) {\n  MallocMessageBuilder builder;\n\n  Orphan<TestAllTypes> orphan = builder.getOrphanage().newOrphan<TestAllTypes>();\n  initTestMessage(orphan.get());\n  checkTestMessage(orphan.getReader());\n\n  auto root = builder.initRoot<TestAllTypes>();\n  root.adoptStructField(kj::mv(orphan));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "139-148",
    "snippet": "TEST(Orphans, NoCrossMessageTransfers) {\n  MallocMessageBuilder builder1;\n  MallocMessageBuilder builder2;\n  auto root1 = builder1.initRoot<TestAllTypes>();\n  auto root2 = builder2.initRoot<TestAllTypes>();\n\n  initTestMessage(root1.initStructField());\n\n  EXPECT_ANY_THROW(root2.adoptStructField(root1.disownStructField()));\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_ANY_THROW",
          "args": [
            "root2.adoptStructField(root1.disownStructField())"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root2.adoptStructField",
          "args": [
            "root1.disownStructField()"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root1.disownStructField",
          "args": [],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "root1.initStructField()"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "root1.initStructField",
          "args": [],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder2.initRoot<TestAllTypes>",
          "args": [],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder1.initRoot<TestAllTypes>",
          "args": [],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, NoCrossMessageTransfers) {\n  MallocMessageBuilder builder1;\n  MallocMessageBuilder builder2;\n  auto root1 = builder1.initRoot<TestAllTypes>();\n  auto root2 = builder2.initRoot<TestAllTypes>();\n\n  initTestMessage(root1.initStructField());\n\n  EXPECT_ANY_THROW(root2.adoptStructField(root1.disownStructField()));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "119-137",
    "snippet": "TEST(Orphans, Data) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<TestAllTypes>();\n\n  root.setDataField(data(\"foo\"));\n  EXPECT_TRUE(root.hasDataField());\n\n  Orphan<Data> orphan = root.disownDataField();\n  EXPECT_FALSE(orphan == nullptr);\n\n  EXPECT_EQ(data(\"foo\"), orphan.getReader());\n  EXPECT_EQ(data(\"foo\"), orphan.get());\n  EXPECT_FALSE(root.hasDataField());\n\n  root.adoptDataField(kj::mv(orphan));\n  EXPECT_TRUE(orphan == nullptr);\n  EXPECT_TRUE(root.hasDataField());\n  EXPECT_EQ(data(\"foo\"), root.getDataField());\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "data(\"foo\")",
            "root.getDataField()"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getDataField",
          "args": [],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "data",
          "args": [
            "\"foo\""
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "dataEquals",
          "container": "TestOutputStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-test.c++",
          "lines": "278-281",
          "snippet": "bool dataEquals(kj::ArrayPtr<const word> other) {\n    return data ==\n        std::string(other.asChars().begin(), other.asChars().size());\n  }",
          "includes": [
            "#include \"test-util.h\"",
            "#include <fcntl.h>",
            "#include <stdlib.h>",
            "#include <string>",
            "#include <kj/miniposix.h>",
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"test-util.h\"\n#include <fcntl.h>\n#include <stdlib.h>\n#include <string>\n#include <kj/miniposix.h>\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n\nTestOutputStream {\n  bool dataEquals(kj::ArrayPtr<const word> other) {\n      return data ==\n          std::string(other.asChars().begin(), other.asChars().size());\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "root.hasDataField()"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.hasDataField",
          "args": [],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "orphan == nullptr"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.adoptDataField",
          "args": [
            "kj::mv(orphan)"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "orphan"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "root.hasDataField()"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.hasDataField",
          "args": [],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "data(\"foo\")",
            "orphan.get()"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.get",
          "args": [],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "data(\"foo\")",
            "orphan.getReader()"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "orphan == nullptr"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.disownDataField",
          "args": [],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "root.hasDataField()"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.hasDataField",
          "args": [],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.setDataField",
          "args": [
            "data(\"foo\")"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, Data) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<TestAllTypes>();\n\n  root.setDataField(data(\"foo\"));\n  EXPECT_TRUE(root.hasDataField());\n\n  Orphan<Data> orphan = root.disownDataField();\n  EXPECT_FALSE(orphan == nullptr);\n\n  EXPECT_EQ(data(\"foo\"), orphan.getReader());\n  EXPECT_EQ(data(\"foo\"), orphan.get());\n  EXPECT_FALSE(root.hasDataField());\n\n  root.adoptDataField(kj::mv(orphan));\n  EXPECT_TRUE(orphan == nullptr);\n  EXPECT_TRUE(root.hasDataField());\n  EXPECT_EQ(data(\"foo\"), root.getDataField());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "99-117",
    "snippet": "TEST(Orphans, Text) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<TestAllTypes>();\n\n  root.setTextField(\"foo\");\n  EXPECT_TRUE(root.hasTextField());\n\n  Orphan<Text> orphan = root.disownTextField();\n  EXPECT_FALSE(orphan == nullptr);\n\n  EXPECT_EQ(\"foo\", orphan.getReader());\n  EXPECT_EQ(\"foo\", orphan.get());\n  EXPECT_FALSE(root.hasTextField());\n\n  root.adoptTextField(kj::mv(orphan));\n  EXPECT_TRUE(orphan == nullptr);\n  EXPECT_TRUE(root.hasTextField());\n  EXPECT_EQ(\"foo\", root.getTextField());\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "root.getTextField()"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.getTextField",
          "args": [],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "root.hasTextField()"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.hasTextField",
          "args": [],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "orphan == nullptr"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.adoptTextField",
          "args": [
            "kj::mv(orphan)"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "orphan"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "root.hasTextField()"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.hasTextField",
          "args": [],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "orphan.get()"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.get",
          "args": [],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "orphan.getReader()"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "orphan == nullptr"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.disownTextField",
          "args": [],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "root.hasTextField()"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.hasTextField",
          "args": [],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.setTextField",
          "args": [
            "\"foo\""
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, Text) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<TestAllTypes>();\n\n  root.setTextField(\"foo\");\n  EXPECT_TRUE(root.hasTextField());\n\n  Orphan<Text> orphan = root.disownTextField();\n  EXPECT_FALSE(orphan == nullptr);\n\n  EXPECT_EQ(\"foo\", orphan.getReader());\n  EXPECT_EQ(\"foo\", orphan.get());\n  EXPECT_FALSE(root.hasTextField());\n\n  root.adoptTextField(kj::mv(orphan));\n  EXPECT_TRUE(orphan == nullptr);\n  EXPECT_TRUE(root.hasTextField());\n  EXPECT_EQ(\"foo\", root.getTextField());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "71-97",
    "snippet": "TEST(Orphans, StructLists) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<TestAllTypes>();\n\n  auto list = root.initStructList(2);\n  list[0].setTextField(\"foo\");\n  list[1].setTextField(\"bar\");\n  EXPECT_TRUE(root.hasStructList());\n\n  Orphan<List<TestAllTypes>> orphan = root.disownStructList();\n  EXPECT_FALSE(orphan == nullptr);\n\n  ASSERT_EQ(2u, orphan.getReader().size());\n  EXPECT_EQ(\"foo\", orphan.getReader()[0].getTextField());\n  EXPECT_EQ(\"bar\", orphan.getReader()[1].getTextField());\n  ASSERT_EQ(2u, orphan.get().size());\n  EXPECT_EQ(\"foo\", orphan.get()[0].getTextField());\n  EXPECT_EQ(\"bar\", orphan.get()[1].getTextField());\n  EXPECT_FALSE(root.hasStructList());\n\n  root.adoptStructList(kj::mv(orphan));\n  EXPECT_TRUE(orphan == nullptr);\n  EXPECT_TRUE(root.hasStructList());\n  ASSERT_EQ(2u, root.asReader().getStructList().size());\n  EXPECT_EQ(\"foo\", root.asReader().getStructList()[0].getTextField());\n  EXPECT_EQ(\"bar\", root.asReader().getStructList()[1].getTextField());\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"bar\"",
            "root.asReader().getStructList()[1].getTextField()"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "root.asReader().getStructList()[0].getTextField()"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "2u",
            "root.asReader().getStructList().size()"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "root.hasStructList()"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.hasStructList",
          "args": [],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "orphan == nullptr"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.adoptStructList",
          "args": [
            "kj::mv(orphan)"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "orphan"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "root.hasStructList()"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.hasStructList",
          "args": [],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"bar\"",
            "orphan.get()[1].getTextField()"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.get",
          "args": [],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "orphan.get()[0].getTextField()"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "2u",
            "orphan.get().size()"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"bar\"",
            "orphan.getReader()[1].getTextField()"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "\"foo\"",
            "orphan.getReader()[0].getTextField()"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "2u",
            "orphan.getReader().size()"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "orphan == nullptr"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.disownStructList",
          "args": [],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "root.hasStructList()"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.hasStructList",
          "args": [],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list[1].setTextField",
          "args": [
            "\"bar\""
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list[0].setTextField",
          "args": [
            "\"foo\""
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.initStructList",
          "args": [
            "2"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, StructLists) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<TestAllTypes>();\n\n  auto list = root.initStructList(2);\n  list[0].setTextField(\"foo\");\n  list[1].setTextField(\"bar\");\n  EXPECT_TRUE(root.hasStructList());\n\n  Orphan<List<TestAllTypes>> orphan = root.disownStructList();\n  EXPECT_FALSE(orphan == nullptr);\n\n  ASSERT_EQ(2u, orphan.getReader().size());\n  EXPECT_EQ(\"foo\", orphan.getReader()[0].getTextField());\n  EXPECT_EQ(\"bar\", orphan.getReader()[1].getTextField());\n  ASSERT_EQ(2u, orphan.get().size());\n  EXPECT_EQ(\"foo\", orphan.get()[0].getTextField());\n  EXPECT_EQ(\"bar\", orphan.get()[1].getTextField());\n  EXPECT_FALSE(root.hasStructList());\n\n  root.adoptStructList(kj::mv(orphan));\n  EXPECT_TRUE(orphan == nullptr);\n  EXPECT_TRUE(root.hasStructList());\n  ASSERT_EQ(2u, root.asReader().getStructList().size());\n  EXPECT_EQ(\"foo\", root.asReader().getStructList()[0].getTextField());\n  EXPECT_EQ(\"bar\", root.asReader().getStructList()[1].getTextField());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "51-69",
    "snippet": "TEST(Orphans, Lists) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<TestAllTypes>();\n\n  root.setUInt32List({12, 34, 56});\n  EXPECT_TRUE(root.hasUInt32List());\n\n  Orphan<List<uint32_t>> orphan = root.disownUInt32List();\n  EXPECT_FALSE(orphan == nullptr);\n\n  checkList(orphan.getReader(), {12u, 34u, 56u});\n  checkList(orphan.get(), {12u, 34u, 56u});\n  EXPECT_FALSE(root.hasUInt32List());\n\n  root.adoptUInt32List(kj::mv(orphan));\n  EXPECT_TRUE(orphan == nullptr);\n  EXPECT_TRUE(root.hasUInt32List());\n  checkList(root.asReader().getUInt32List(), {12u, 34u, 56u});\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkList",
          "args": [
            "root.asReader().getUInt32List()",
            "{12u, 34u, 56u}"
          ],
          "line": 68
        },
        "resolved": true,
        "details": {
          "function_name": "checkList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic-test.c++",
          "lines": "33-45",
          "snippet": "void checkList(T reader, std::initializer_list<ReaderFor<Element>> expected) {\n  auto list = reader.template as<DynamicList>();\n  ASSERT_EQ(expected.size(), list.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], list[i].template as<Element>());\n  }\n\n  auto typed = reader.template as<List<Element>>();\n  ASSERT_EQ(expected.size(), typed.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], typed[i]);\n  }\n}",
          "includes": [
            "#include \"test-util.h\"",
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"dynamic.h\"\n\nvoid checkList(T reader, std::initializer_list<ReaderFor<Element>> expected) {\n  auto list = reader.template as<DynamicList>();\n  ASSERT_EQ(expected.size(), list.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], list[i].template as<Element>());\n  }\n\n  auto typed = reader.template as<List<Element>>();\n  ASSERT_EQ(expected.size(), typed.size());\n  for (uint i = 0; i < expected.size(); i++) {\n    EXPECT_EQ(expected.begin()[i], typed[i]);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [],
          "line": 68
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "root.hasUInt32List()"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.hasUInt32List",
          "args": [],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "orphan == nullptr"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.adoptUInt32List",
          "args": [
            "kj::mv(orphan)"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "orphan"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "root.hasUInt32List()"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.hasUInt32List",
          "args": [],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.get",
          "args": [],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "orphan == nullptr"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.disownUInt32List",
          "args": [],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "root.hasUInt32List()"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.hasUInt32List",
          "args": [],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.setUInt32List",
          "args": [
            "{12, 34, 56}"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, Lists) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<TestAllTypes>();\n\n  root.setUInt32List({12, 34, 56});\n  EXPECT_TRUE(root.hasUInt32List());\n\n  Orphan<List<uint32_t>> orphan = root.disownUInt32List();\n  EXPECT_FALSE(orphan == nullptr);\n\n  checkList(orphan.getReader(), {12u, 34u, 56u});\n  checkList(orphan.get(), {12u, 34u, 56u});\n  EXPECT_FALSE(root.hasUInt32List());\n\n  root.adoptUInt32List(kj::mv(orphan));\n  EXPECT_TRUE(orphan == nullptr);\n  EXPECT_TRUE(root.hasUInt32List());\n  checkList(root.asReader().getUInt32List(), {12u, 34u, 56u});\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan-test.c++",
    "lines": "31-49",
    "snippet": "TEST(Orphans, Structs) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<TestAllTypes>();\n\n  initTestMessage(root.initStructField());\n  EXPECT_TRUE(root.hasStructField());\n\n  Orphan<TestAllTypes> orphan = root.disownStructField();\n  EXPECT_FALSE(orphan == nullptr);\n\n  checkTestMessage(orphan.getReader());\n  checkTestMessage(orphan.get());\n  EXPECT_FALSE(root.hasStructField());\n\n  root.adoptStructField(kj::mv(orphan));\n  EXPECT_TRUE(orphan == nullptr);\n  EXPECT_TRUE(root.hasStructField());\n  checkTestMessage(root.asReader().getStructField());\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/compat/gtest.h>",
      "#include <kj/debug.h>",
      "#include \"message.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "root.asReader().getStructField()"
          ],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "root.asReader",
          "args": [],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "root.hasStructField()"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.hasStructField",
          "args": [],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "orphan == nullptr"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.adoptStructField",
          "args": [
            "kj::mv(orphan)"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "orphan"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "root.hasStructField()"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.hasStructField",
          "args": [],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orphan.get",
          "args": [],
          "line": 42
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "orphan.getReader",
          "args": [],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "orphan == nullptr"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.disownStructField",
          "args": [],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "root.hasStructField()"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "root.hasStructField",
          "args": [],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "root.initStructField()"
          ],
          "line": 35
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "root.initStructField",
          "args": [],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.initRoot<TestAllTypes>",
          "args": [],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"message.h\"\n\nTEST(Orphans, Structs) {\n  MallocMessageBuilder builder;\n  auto root = builder.initRoot<TestAllTypes>();\n\n  initTestMessage(root.initStructField());\n  EXPECT_TRUE(root.hasStructField());\n\n  Orphan<TestAllTypes> orphan = root.disownStructField();\n  EXPECT_FALSE(orphan == nullptr);\n\n  checkTestMessage(orphan.getReader());\n  checkTestMessage(orphan.get());\n  EXPECT_FALSE(root.hasStructField());\n\n  root.adoptStructField(kj::mv(orphan));\n  EXPECT_TRUE(orphan == nullptr);\n  EXPECT_TRUE(root.hasStructField());\n  checkTestMessage(root.asReader().getStructField());\n}"
  }
]