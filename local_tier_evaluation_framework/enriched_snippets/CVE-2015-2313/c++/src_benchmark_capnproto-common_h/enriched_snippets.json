[
  {
    "function_name": "passByBytes",
    "container": "BenchmarkMethods",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-common.h",
    "lines": "362-402",
    "snippet": "static uint64_t passByBytes(uint64_t iters) {\n    uint64_t throughput = 0;\n    typename ReuseStrategy::ScratchSpace clientRequestScratch;\n    UseScratch::ScratchSpace requestBytesScratch;\n    typename ReuseStrategy::ScratchSpace serverRequestScratch;\n    typename ReuseStrategy::ScratchSpace serverResponseScratch;\n    UseScratch::ScratchSpace responseBytesScratch;\n    typename ReuseStrategy::ScratchSpace clientResponseScratch;\n\n    for (; iters > 0; --iters) {\n      typename ReuseStrategy::MessageBuilder requestBuilder(clientRequestScratch);\n      typename TestCase::Expectation expected = TestCase::setupRequest(\n          requestBuilder.template initRoot<typename TestCase::Request>());\n\n      kj::ArrayOutputStream requestOutput(kj::arrayPtr(\n          reinterpret_cast<byte*>(requestBytesScratch.words), SCRATCH_SIZE * sizeof(word)));\n      Compression::write(requestOutput, requestBuilder);\n      throughput += requestOutput.getArray().size();\n      typename ReuseStrategy::template ArrayMessageReader<Compression> requestReader(\n          requestOutput.getArray(), serverRequestScratch);\n\n      typename ReuseStrategy::MessageBuilder responseBuilder(serverResponseScratch);\n      TestCase::handleRequest(requestReader.template getRoot<typename TestCase::Request>(),\n                              responseBuilder.template initRoot<typename TestCase::Response>());\n\n      kj::ArrayOutputStream responseOutput(\n          kj::arrayPtr(reinterpret_cast<byte*>(responseBytesScratch.words),\n                       SCRATCH_SIZE * sizeof(word)));\n      Compression::write(responseOutput, responseBuilder);\n      throughput += responseOutput.getArray().size();\n      typename ReuseStrategy::template ArrayMessageReader<Compression> responseReader(\n          responseOutput.getArray(), clientResponseScratch);\n\n      if (!TestCase::checkResponse(\n          responseReader.template getRoot<typename TestCase::Response>(), expected)) {\n        throw std::logic_error(\"Incorrect response.\");\n      }\n     }\n\n    return throughput;\n  }",
    "includes": [
      "#include <thread>",
      "#include <capnp/serialize-snappy.h>",
      "#include <kj/debug.h>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/serialize.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::logic_error",
          "args": [
            "\"Incorrect response.\""
          ],
          "line": 397
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TestCase::checkResponse",
          "args": [
            "responseReader.template getRoot<typename TestCase::Response>()",
            "expected"
          ],
          "line": 395
        },
        "resolved": true,
        "details": {
          "function_name": "checkResponse",
          "container": "CatRankTestCase",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-catrank.c++",
          "lines": "119-130",
          "snippet": "static bool checkResponse(SearchResultList::Reader response, int expectedGoodCount) {\n    int goodCount = 0;\n    for (auto result: response.getResults()) {\n      if (result.getScore() > 1001) {\n        ++goodCount;\n      } else {\n        break;\n      }\n    }\n\n    return goodCount == expectedGoodCount;\n  }",
          "includes": [
            "#include \"capnproto-common.h\"",
            "#include \"catrank.capnp.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capnproto-common.h\"\n#include \"catrank.capnp.h\"\n\nCatRankTestCase {\n  static bool checkResponse(SearchResultList::Reader response, int expectedGoodCount) {\n      int goodCount = 0;\n      for (auto result: response.getResults()) {\n        if (result.getScore() > 1001) {\n          ++goodCount;\n        } else {\n          break;\n        }\n      }\n  \n      return goodCount == expectedGoodCount;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "responseReader.template getRoot<typename TestCase::Response>",
          "args": [],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "responseOutput.getArray",
          "args": [],
          "line": 393
        },
        "resolved": true,
        "details": {
          "function_name": "getArray",
          "container": "ArrayOutputStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/io.h",
          "lines": "211-214",
          "snippet": "ArrayPtr<byte> getArray() {\n    // Get the portion of the array which has been filled in.\n    return arrayPtr(array.begin(), fillPos);\n  }",
          "includes": [
            "#include \"exception.h\"",
            "#include \"array.h\"",
            "#include \"common.h\"",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"exception.h\"\n#include \"array.h\"\n#include \"common.h\"\n#include <stddef.h>\n\nArrayOutputStream {\n  ArrayPtr<byte> getArray() {\n      // Get the portion of the array which has been filled in.\n      return arrayPtr(array.begin(), fillPos);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Compression::write",
          "args": [
            "responseOutput",
            "responseBuilder"
          ],
          "line": 390
        },
        "resolved": true,
        "details": {
          "function_name": "write",
          "container": "SnappyCompressed",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-common.h",
          "lines": "123-127",
          "snippet": "static inline void write(OutputStream& output, MessageBuilder& builder) {\n    writeSnappyPackedMessage(output, builder,\n        kj::arrayPtr(snappyWriteBuffer, SNAPPY_BUFFER_SIZE),\n        kj::arrayPtr(snappyCompressedBuffer, SNAPPY_COMPRESSED_BUFFER_SIZE));\n  }",
          "includes": [
            "#include <thread>",
            "#include <capnp/serialize-snappy.h>",
            "#include <kj/debug.h>",
            "#include <capnp/serialize-packed.h>",
            "#include <capnp/serialize.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <thread>\n#include <capnp/serialize-snappy.h>\n#include <kj/debug.h>\n#include <capnp/serialize-packed.h>\n#include <capnp/serialize.h>\n#include \"common.h\"\n\nSnappyCompressed {\n  static inline void write(OutputStream& output, MessageBuilder& builder) {\n      writeSnappyPackedMessage(output, builder,\n          kj::arrayPtr(snappyWriteBuffer, SNAPPY_BUFFER_SIZE),\n          kj::arrayPtr(snappyCompressedBuffer, SNAPPY_COMPRESSED_BUFFER_SIZE));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::arrayPtr",
          "args": [
            "reinterpret_cast<byte*>(responseBytesScratch.words)",
            "SCRATCH_SIZE * sizeof(word)"
          ],
          "line": 388
        },
        "resolved": true,
        "details": {
          "function_name": "arrayPtr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "1194-1197",
          "snippet": "inline constexpr ArrayPtr<T> arrayPtr(T* begin, T* end) {\n  // Use this function to construct ArrayPtrs without writing out the type name.\n  return ArrayPtr<T>(begin, end);\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\ninline constexpr ArrayPtr<T> arrayPtr(T* begin, T* end) {\n  // Use this function to construct ArrayPtrs without writing out the type name.\n  return ArrayPtr<T>(begin, end);\n}"
        }
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<byte*>",
          "args": [
            "responseBytesScratch.words"
          ],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TestCase::handleRequest",
          "args": [
            "requestReader.template getRoot<typename TestCase::Request>()",
            "responseBuilder.template initRoot<typename TestCase::Response>()"
          ],
          "line": 384
        },
        "resolved": true,
        "details": {
          "function_name": "handleRequest",
          "container": "CatRankTestCase",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-catrank.c++",
          "lines": "93-117",
          "snippet": "static void handleRequest(SearchResultList::Reader request, SearchResultList::Builder response) {\n    std::vector<ScoredResult> scoredResults;\n\n    for (auto result: request.getResults()) {\n      double score = result.getScore();\n      if (strstr(result.getSnippet().cStr(), \" cat \") != nullptr) {\n        score *= 10000;\n      }\n      if (strstr(result.getSnippet().cStr(), \" dog \") != nullptr) {\n        score /= 10000;\n      }\n      scoredResults.emplace_back(score, result);\n    }\n\n    std::sort(scoredResults.begin(), scoredResults.end());\n\n    auto list = response.initResults(scoredResults.size());\n    auto iter = list.begin();\n    for (auto result: scoredResults) {\n      iter->setScore(result.score);\n      iter->setUrl(result.result.getUrl());\n      iter->setSnippet(result.result.getSnippet());\n      ++iter;\n    }\n  }",
          "includes": [
            "#include \"capnproto-common.h\"",
            "#include \"catrank.capnp.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capnproto-common.h\"\n#include \"catrank.capnp.h\"\n\nCatRankTestCase {\n  static void handleRequest(SearchResultList::Reader request, SearchResultList::Builder response) {\n      std::vector<ScoredResult> scoredResults;\n  \n      for (auto result: request.getResults()) {\n        double score = result.getScore();\n        if (strstr(result.getSnippet().cStr(), \" cat \") != nullptr) {\n          score *= 10000;\n        }\n        if (strstr(result.getSnippet().cStr(), \" dog \") != nullptr) {\n          score /= 10000;\n        }\n        scoredResults.emplace_back(score, result);\n      }\n  \n      std::sort(scoredResults.begin(), scoredResults.end());\n  \n      auto list = response.initResults(scoredResults.size());\n      auto iter = list.begin();\n      for (auto result: scoredResults) {\n        iter->setScore(result.score);\n        iter->setUrl(result.result.getUrl());\n        iter->setSnippet(result.result.getSnippet());\n        ++iter;\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "responseBuilder.template initRoot<typename TestCase::Response>",
          "args": [],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "requestReader.template getRoot<typename TestCase::Request>",
          "args": [],
          "line": 384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<byte*>",
          "args": [
            "requestBytesScratch.words"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TestCase::setupRequest",
          "args": [
            "requestBuilder.template initRoot<typename TestCase::Request>()"
          ],
          "line": 373
        },
        "resolved": true,
        "details": {
          "function_name": "setupRequest",
          "container": "CatRankTestCase",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-catrank.c++",
          "lines": "45-91",
          "snippet": "static int setupRequest(SearchResultList::Builder request) {\n    int count = fastRand(1000);\n    int goodCount = 0;\n\n    auto list = request.initResults(count);\n\n    for (int i = 0; i < count; i++) {\n      SearchResult::Builder result = list[i];\n      result.setScore(1000 - i);\n      int urlSize = fastRand(100);\n\n      static const char URL_PREFIX[] = \"http://example.com/\";\n      size_t urlPrefixLength = strlen(URL_PREFIX);\n      auto url = result.initUrl(urlSize + urlPrefixLength);\n\n      strcpy(url.begin(), URL_PREFIX);\n      char* pos = url.begin() + urlPrefixLength;\n      for (int j = 0; j < urlSize; j++) {\n        *pos++ = 'a' + fastRand(26);\n      }\n\n      bool isCat = fastRand(8) == 0;\n      bool isDog = fastRand(8) == 0;\n      goodCount += isCat && !isDog;\n\n      static std::string snippet;\n      snippet.clear();\n      snippet.push_back(' ');\n\n      int prefix = fastRand(20);\n      for (int j = 0; j < prefix; j++) {\n        snippet.append(WORDS[fastRand(WORDS_COUNT)]);\n      }\n\n      if (isCat) snippet.append(\"cat \");\n      if (isDog) snippet.append(\"dog \");\n\n      int suffix = fastRand(20);\n      for (int j = 0; j < suffix; j++) {\n        snippet.append(WORDS[fastRand(WORDS_COUNT)]);\n      }\n\n      result.setSnippet(Text::Reader(snippet.c_str(), snippet.size()));\n    }\n\n    return goodCount;\n  }",
          "includes": [
            "#include \"capnproto-common.h\"",
            "#include \"catrank.capnp.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capnproto-common.h\"\n#include \"catrank.capnp.h\"\n\nCatRankTestCase {\n  static int setupRequest(SearchResultList::Builder request) {\n      int count = fastRand(1000);\n      int goodCount = 0;\n  \n      auto list = request.initResults(count);\n  \n      for (int i = 0; i < count; i++) {\n        SearchResult::Builder result = list[i];\n        result.setScore(1000 - i);\n        int urlSize = fastRand(100);\n  \n        static const char URL_PREFIX[] = \"http://example.com/\";\n        size_t urlPrefixLength = strlen(URL_PREFIX);\n        auto url = result.initUrl(urlSize + urlPrefixLength);\n  \n        strcpy(url.begin(), URL_PREFIX);\n        char* pos = url.begin() + urlPrefixLength;\n        for (int j = 0; j < urlSize; j++) {\n          *pos++ = 'a' + fastRand(26);\n        }\n  \n        bool isCat = fastRand(8) == 0;\n        bool isDog = fastRand(8) == 0;\n        goodCount += isCat && !isDog;\n  \n        static std::string snippet;\n        snippet.clear();\n        snippet.push_back(' ');\n  \n        int prefix = fastRand(20);\n        for (int j = 0; j < prefix; j++) {\n          snippet.append(WORDS[fastRand(WORDS_COUNT)]);\n        }\n  \n        if (isCat) snippet.append(\"cat \");\n        if (isDog) snippet.append(\"dog \");\n  \n        int suffix = fastRand(20);\n        for (int j = 0; j < suffix; j++) {\n          snippet.append(WORDS[fastRand(WORDS_COUNT)]);\n        }\n  \n        result.setSnippet(Text::Reader(snippet.c_str(), snippet.size()));\n      }\n  \n      return goodCount;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "requestBuilder.template initRoot<typename TestCase::Request>",
          "args": [],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <thread>\n#include <capnp/serialize-snappy.h>\n#include <kj/debug.h>\n#include <capnp/serialize-packed.h>\n#include <capnp/serialize.h>\n#include \"common.h\"\n\nBenchmarkMethods {\n  static uint64_t passByBytes(uint64_t iters) {\n      uint64_t throughput = 0;\n      typename ReuseStrategy::ScratchSpace clientRequestScratch;\n      UseScratch::ScratchSpace requestBytesScratch;\n      typename ReuseStrategy::ScratchSpace serverRequestScratch;\n      typename ReuseStrategy::ScratchSpace serverResponseScratch;\n      UseScratch::ScratchSpace responseBytesScratch;\n      typename ReuseStrategy::ScratchSpace clientResponseScratch;\n  \n      for (; iters > 0; --iters) {\n        typename ReuseStrategy::MessageBuilder requestBuilder(clientRequestScratch);\n        typename TestCase::Expectation expected = TestCase::setupRequest(\n            requestBuilder.template initRoot<typename TestCase::Request>());\n  \n        kj::ArrayOutputStream requestOutput(kj::arrayPtr(\n            reinterpret_cast<byte*>(requestBytesScratch.words), SCRATCH_SIZE * sizeof(word)));\n        Compression::write(requestOutput, requestBuilder);\n        throughput += requestOutput.getArray().size();\n        typename ReuseStrategy::template ArrayMessageReader<Compression> requestReader(\n            requestOutput.getArray(), serverRequestScratch);\n  \n        typename ReuseStrategy::MessageBuilder responseBuilder(serverResponseScratch);\n        TestCase::handleRequest(requestReader.template getRoot<typename TestCase::Request>(),\n                                responseBuilder.template initRoot<typename TestCase::Response>());\n  \n        kj::ArrayOutputStream responseOutput(\n            kj::arrayPtr(reinterpret_cast<byte*>(responseBytesScratch.words),\n                         SCRATCH_SIZE * sizeof(word)));\n        Compression::write(responseOutput, responseBuilder);\n        throughput += responseOutput.getArray().size();\n        typename ReuseStrategy::template ArrayMessageReader<Compression> responseReader(\n            responseOutput.getArray(), clientResponseScratch);\n  \n        if (!TestCase::checkResponse(\n            responseReader.template getRoot<typename TestCase::Response>(), expected)) {\n          throw std::logic_error(\"Incorrect response.\");\n        }\n       }\n  \n      return throughput;\n    }\n}"
  },
  {
    "function_name": "passByObject",
    "container": "BenchmarkMethods",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-common.h",
    "lines": "335-360",
    "snippet": "static uint64_t passByObject(uint64_t iters, bool countObjectSize) {\n    typename ReuseStrategy::ScratchSpace requestScratch;\n    typename ReuseStrategy::ScratchSpace responseScratch;\n\n    typename ReuseStrategy::ObjectSizeCounter counter(iters);\n\n    for (; iters > 0; --iters) {\n      typename ReuseStrategy::MessageBuilder requestMessage(requestScratch);\n      auto request = requestMessage.template initRoot<typename TestCase::Request>();\n      typename TestCase::Expectation expected = TestCase::setupRequest(request);\n\n      typename ReuseStrategy::MessageBuilder responseMessage(responseScratch);\n      auto response = responseMessage.template initRoot<typename TestCase::Response>();\n      TestCase::handleRequest(request.asReader(), response);\n\n      if (!TestCase::checkResponse(response.asReader(), expected)) {\n        throw std::logic_error(\"Incorrect response.\");\n      }\n\n      if (countObjectSize) {\n        counter.add(requestMessage, responseMessage);\n      }\n    }\n\n    return counter.get();\n  }",
    "includes": [
      "#include <thread>",
      "#include <capnp/serialize-snappy.h>",
      "#include <kj/debug.h>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/serialize.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "counter.get",
          "args": [],
          "line": 359
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "UseScratch::ObjectSizeCounter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-common.h",
          "lines": "231-231",
          "snippet": "uint64_t get() { return iters * maxSize; }",
          "includes": [
            "#include <thread>",
            "#include <capnp/serialize-snappy.h>",
            "#include <kj/debug.h>",
            "#include <capnp/serialize-packed.h>",
            "#include <capnp/serialize.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <thread>\n#include <capnp/serialize-snappy.h>\n#include <kj/debug.h>\n#include <capnp/serialize-packed.h>\n#include <capnp/serialize.h>\n#include \"common.h\"\n\nUseScratch {\n  ObjectSizeCounter {\n    uint64_t get() { return iters * maxSize; }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "counter.add",
          "args": [
            "requestMessage",
            "responseMessage"
          ],
          "line": 355
        },
        "resolved": true,
        "details": {
          "function_name": "add",
          "container": "UseScratch::ObjectSizeCounter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-common.h",
          "lines": "220-229",
          "snippet": "void add(RequestBuilder& request, ResponseBuilder& response) {\n      size_t counter = 0;\n      for (auto segment: request.getSegmentsForOutput()) {\n        counter += segment.size() * sizeof(word);\n      }\n      for (auto segment: response.getSegmentsForOutput()) {\n        counter += segment.size() * sizeof(word);\n      }\n      maxSize = std::max(counter, maxSize);\n    }",
          "includes": [
            "#include <thread>",
            "#include <capnp/serialize-snappy.h>",
            "#include <kj/debug.h>",
            "#include <capnp/serialize-packed.h>",
            "#include <capnp/serialize.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <thread>\n#include <capnp/serialize-snappy.h>\n#include <kj/debug.h>\n#include <capnp/serialize-packed.h>\n#include <capnp/serialize.h>\n#include \"common.h\"\n\nUseScratch {\n  ObjectSizeCounter {\n    void add(RequestBuilder& request, ResponseBuilder& response) {\n          size_t counter = 0;\n          for (auto segment: request.getSegmentsForOutput()) {\n            counter += segment.size() * sizeof(word);\n          }\n          for (auto segment: response.getSegmentsForOutput()) {\n            counter += segment.size() * sizeof(word);\n          }\n          maxSize = std::max(counter, maxSize);\n        }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::logic_error",
          "args": [
            "\"Incorrect response.\""
          ],
          "line": 351
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TestCase::checkResponse",
          "args": [
            "response.asReader()",
            "expected"
          ],
          "line": 350
        },
        "resolved": true,
        "details": {
          "function_name": "checkResponse",
          "container": "CatRankTestCase",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-catrank.c++",
          "lines": "119-130",
          "snippet": "static bool checkResponse(SearchResultList::Reader response, int expectedGoodCount) {\n    int goodCount = 0;\n    for (auto result: response.getResults()) {\n      if (result.getScore() > 1001) {\n        ++goodCount;\n      } else {\n        break;\n      }\n    }\n\n    return goodCount == expectedGoodCount;\n  }",
          "includes": [
            "#include \"capnproto-common.h\"",
            "#include \"catrank.capnp.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capnproto-common.h\"\n#include \"catrank.capnp.h\"\n\nCatRankTestCase {\n  static bool checkResponse(SearchResultList::Reader response, int expectedGoodCount) {\n      int goodCount = 0;\n      for (auto result: response.getResults()) {\n        if (result.getScore() > 1001) {\n          ++goodCount;\n        } else {\n          break;\n        }\n      }\n  \n      return goodCount == expectedGoodCount;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "response.asReader",
          "args": [],
          "line": 350
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      },
      {
        "call_info": {
          "callee": "TestCase::handleRequest",
          "args": [
            "request.asReader()",
            "response"
          ],
          "line": 348
        },
        "resolved": true,
        "details": {
          "function_name": "handleRequest",
          "container": "CatRankTestCase",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-catrank.c++",
          "lines": "93-117",
          "snippet": "static void handleRequest(SearchResultList::Reader request, SearchResultList::Builder response) {\n    std::vector<ScoredResult> scoredResults;\n\n    for (auto result: request.getResults()) {\n      double score = result.getScore();\n      if (strstr(result.getSnippet().cStr(), \" cat \") != nullptr) {\n        score *= 10000;\n      }\n      if (strstr(result.getSnippet().cStr(), \" dog \") != nullptr) {\n        score /= 10000;\n      }\n      scoredResults.emplace_back(score, result);\n    }\n\n    std::sort(scoredResults.begin(), scoredResults.end());\n\n    auto list = response.initResults(scoredResults.size());\n    auto iter = list.begin();\n    for (auto result: scoredResults) {\n      iter->setScore(result.score);\n      iter->setUrl(result.result.getUrl());\n      iter->setSnippet(result.result.getSnippet());\n      ++iter;\n    }\n  }",
          "includes": [
            "#include \"capnproto-common.h\"",
            "#include \"catrank.capnp.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capnproto-common.h\"\n#include \"catrank.capnp.h\"\n\nCatRankTestCase {\n  static void handleRequest(SearchResultList::Reader request, SearchResultList::Builder response) {\n      std::vector<ScoredResult> scoredResults;\n  \n      for (auto result: request.getResults()) {\n        double score = result.getScore();\n        if (strstr(result.getSnippet().cStr(), \" cat \") != nullptr) {\n          score *= 10000;\n        }\n        if (strstr(result.getSnippet().cStr(), \" dog \") != nullptr) {\n          score /= 10000;\n        }\n        scoredResults.emplace_back(score, result);\n      }\n  \n      std::sort(scoredResults.begin(), scoredResults.end());\n  \n      auto list = response.initResults(scoredResults.size());\n      auto iter = list.begin();\n      for (auto result: scoredResults) {\n        iter->setScore(result.score);\n        iter->setUrl(result.result.getUrl());\n        iter->setSnippet(result.result.getSnippet());\n        ++iter;\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "responseMessage.template initRoot<typename TestCase::Response>",
          "args": [],
          "line": 347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TestCase::setupRequest",
          "args": [
            "request"
          ],
          "line": 344
        },
        "resolved": true,
        "details": {
          "function_name": "setupRequest",
          "container": "CatRankTestCase",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-catrank.c++",
          "lines": "45-91",
          "snippet": "static int setupRequest(SearchResultList::Builder request) {\n    int count = fastRand(1000);\n    int goodCount = 0;\n\n    auto list = request.initResults(count);\n\n    for (int i = 0; i < count; i++) {\n      SearchResult::Builder result = list[i];\n      result.setScore(1000 - i);\n      int urlSize = fastRand(100);\n\n      static const char URL_PREFIX[] = \"http://example.com/\";\n      size_t urlPrefixLength = strlen(URL_PREFIX);\n      auto url = result.initUrl(urlSize + urlPrefixLength);\n\n      strcpy(url.begin(), URL_PREFIX);\n      char* pos = url.begin() + urlPrefixLength;\n      for (int j = 0; j < urlSize; j++) {\n        *pos++ = 'a' + fastRand(26);\n      }\n\n      bool isCat = fastRand(8) == 0;\n      bool isDog = fastRand(8) == 0;\n      goodCount += isCat && !isDog;\n\n      static std::string snippet;\n      snippet.clear();\n      snippet.push_back(' ');\n\n      int prefix = fastRand(20);\n      for (int j = 0; j < prefix; j++) {\n        snippet.append(WORDS[fastRand(WORDS_COUNT)]);\n      }\n\n      if (isCat) snippet.append(\"cat \");\n      if (isDog) snippet.append(\"dog \");\n\n      int suffix = fastRand(20);\n      for (int j = 0; j < suffix; j++) {\n        snippet.append(WORDS[fastRand(WORDS_COUNT)]);\n      }\n\n      result.setSnippet(Text::Reader(snippet.c_str(), snippet.size()));\n    }\n\n    return goodCount;\n  }",
          "includes": [
            "#include \"capnproto-common.h\"",
            "#include \"catrank.capnp.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capnproto-common.h\"\n#include \"catrank.capnp.h\"\n\nCatRankTestCase {\n  static int setupRequest(SearchResultList::Builder request) {\n      int count = fastRand(1000);\n      int goodCount = 0;\n  \n      auto list = request.initResults(count);\n  \n      for (int i = 0; i < count; i++) {\n        SearchResult::Builder result = list[i];\n        result.setScore(1000 - i);\n        int urlSize = fastRand(100);\n  \n        static const char URL_PREFIX[] = \"http://example.com/\";\n        size_t urlPrefixLength = strlen(URL_PREFIX);\n        auto url = result.initUrl(urlSize + urlPrefixLength);\n  \n        strcpy(url.begin(), URL_PREFIX);\n        char* pos = url.begin() + urlPrefixLength;\n        for (int j = 0; j < urlSize; j++) {\n          *pos++ = 'a' + fastRand(26);\n        }\n  \n        bool isCat = fastRand(8) == 0;\n        bool isDog = fastRand(8) == 0;\n        goodCount += isCat && !isDog;\n  \n        static std::string snippet;\n        snippet.clear();\n        snippet.push_back(' ');\n  \n        int prefix = fastRand(20);\n        for (int j = 0; j < prefix; j++) {\n          snippet.append(WORDS[fastRand(WORDS_COUNT)]);\n        }\n  \n        if (isCat) snippet.append(\"cat \");\n        if (isDog) snippet.append(\"dog \");\n  \n        int suffix = fastRand(20);\n        for (int j = 0; j < suffix; j++) {\n          snippet.append(WORDS[fastRand(WORDS_COUNT)]);\n        }\n  \n        result.setSnippet(Text::Reader(snippet.c_str(), snippet.size()));\n      }\n  \n      return goodCount;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "requestMessage.template initRoot<typename TestCase::Request>",
          "args": [],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <thread>\n#include <capnp/serialize-snappy.h>\n#include <kj/debug.h>\n#include <capnp/serialize-packed.h>\n#include <capnp/serialize.h>\n#include \"common.h\"\n\nBenchmarkMethods {\n  static uint64_t passByObject(uint64_t iters, bool countObjectSize) {\n      typename ReuseStrategy::ScratchSpace requestScratch;\n      typename ReuseStrategy::ScratchSpace responseScratch;\n  \n      typename ReuseStrategy::ObjectSizeCounter counter(iters);\n  \n      for (; iters > 0; --iters) {\n        typename ReuseStrategy::MessageBuilder requestMessage(requestScratch);\n        auto request = requestMessage.template initRoot<typename TestCase::Request>();\n        typename TestCase::Expectation expected = TestCase::setupRequest(request);\n  \n        typename ReuseStrategy::MessageBuilder responseMessage(responseScratch);\n        auto response = responseMessage.template initRoot<typename TestCase::Response>();\n        TestCase::handleRequest(request.asReader(), response);\n  \n        if (!TestCase::checkResponse(response.asReader(), expected)) {\n          throw std::logic_error(\"Incorrect response.\");\n        }\n  \n        if (countObjectSize) {\n          counter.add(requestMessage, responseMessage);\n        }\n      }\n  \n      return counter.get();\n    }\n}"
  },
  {
    "function_name": "server",
    "container": "BenchmarkMethods",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-common.h",
    "lines": "315-333",
    "snippet": "static uint64_t server(int inputFd, int outputFd, uint64_t iters) {\n    kj::FdInputStream inputStream(inputFd);\n    typename Compression::BufferedInput bufferedInput(inputStream);\n\n    CountingOutputStream output(outputFd);\n    typename ReuseStrategy::ScratchSpace builderScratch;\n    typename ReuseStrategy::ScratchSpace readerScratch;\n\n    for (; iters > 0; --iters) {\n      typename ReuseStrategy::MessageBuilder builder(builderScratch);\n      typename ReuseStrategy::template MessageReader<Compression> reader(\n          bufferedInput, readerScratch);\n      TestCase::handleRequest(reader.template getRoot<typename TestCase::Request>(),\n                              builder.template initRoot<typename TestCase::Response>());\n      Compression::write(output, builder);\n    }\n\n    return output.throughput;\n  }",
    "includes": [
      "#include <thread>",
      "#include <capnp/serialize-snappy.h>",
      "#include <kj/debug.h>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/serialize.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Compression::write",
          "args": [
            "output",
            "builder"
          ],
          "line": 329
        },
        "resolved": true,
        "details": {
          "function_name": "write",
          "container": "SnappyCompressed",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-common.h",
          "lines": "123-127",
          "snippet": "static inline void write(OutputStream& output, MessageBuilder& builder) {\n    writeSnappyPackedMessage(output, builder,\n        kj::arrayPtr(snappyWriteBuffer, SNAPPY_BUFFER_SIZE),\n        kj::arrayPtr(snappyCompressedBuffer, SNAPPY_COMPRESSED_BUFFER_SIZE));\n  }",
          "includes": [
            "#include <thread>",
            "#include <capnp/serialize-snappy.h>",
            "#include <kj/debug.h>",
            "#include <capnp/serialize-packed.h>",
            "#include <capnp/serialize.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <thread>\n#include <capnp/serialize-snappy.h>\n#include <kj/debug.h>\n#include <capnp/serialize-packed.h>\n#include <capnp/serialize.h>\n#include \"common.h\"\n\nSnappyCompressed {\n  static inline void write(OutputStream& output, MessageBuilder& builder) {\n      writeSnappyPackedMessage(output, builder,\n          kj::arrayPtr(snappyWriteBuffer, SNAPPY_BUFFER_SIZE),\n          kj::arrayPtr(snappyCompressedBuffer, SNAPPY_COMPRESSED_BUFFER_SIZE));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "TestCase::handleRequest",
          "args": [
            "reader.template getRoot<typename TestCase::Request>()",
            "builder.template initRoot<typename TestCase::Response>()"
          ],
          "line": 327
        },
        "resolved": true,
        "details": {
          "function_name": "handleRequest",
          "container": "CatRankTestCase",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-catrank.c++",
          "lines": "93-117",
          "snippet": "static void handleRequest(SearchResultList::Reader request, SearchResultList::Builder response) {\n    std::vector<ScoredResult> scoredResults;\n\n    for (auto result: request.getResults()) {\n      double score = result.getScore();\n      if (strstr(result.getSnippet().cStr(), \" cat \") != nullptr) {\n        score *= 10000;\n      }\n      if (strstr(result.getSnippet().cStr(), \" dog \") != nullptr) {\n        score /= 10000;\n      }\n      scoredResults.emplace_back(score, result);\n    }\n\n    std::sort(scoredResults.begin(), scoredResults.end());\n\n    auto list = response.initResults(scoredResults.size());\n    auto iter = list.begin();\n    for (auto result: scoredResults) {\n      iter->setScore(result.score);\n      iter->setUrl(result.result.getUrl());\n      iter->setSnippet(result.result.getSnippet());\n      ++iter;\n    }\n  }",
          "includes": [
            "#include \"capnproto-common.h\"",
            "#include \"catrank.capnp.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capnproto-common.h\"\n#include \"catrank.capnp.h\"\n\nCatRankTestCase {\n  static void handleRequest(SearchResultList::Reader request, SearchResultList::Builder response) {\n      std::vector<ScoredResult> scoredResults;\n  \n      for (auto result: request.getResults()) {\n        double score = result.getScore();\n        if (strstr(result.getSnippet().cStr(), \" cat \") != nullptr) {\n          score *= 10000;\n        }\n        if (strstr(result.getSnippet().cStr(), \" dog \") != nullptr) {\n          score /= 10000;\n        }\n        scoredResults.emplace_back(score, result);\n      }\n  \n      std::sort(scoredResults.begin(), scoredResults.end());\n  \n      auto list = response.initResults(scoredResults.size());\n      auto iter = list.begin();\n      for (auto result: scoredResults) {\n        iter->setScore(result.score);\n        iter->setUrl(result.result.getUrl());\n        iter->setSnippet(result.result.getSnippet());\n        ++iter;\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "builder.template initRoot<typename TestCase::Response>",
          "args": [],
          "line": 328
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.template getRoot<typename TestCase::Request>",
          "args": [],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <thread>\n#include <capnp/serialize-snappy.h>\n#include <kj/debug.h>\n#include <capnp/serialize-packed.h>\n#include <capnp/serialize.h>\n#include \"common.h\"\n\nBenchmarkMethods {\n  static uint64_t server(int inputFd, int outputFd, uint64_t iters) {\n      kj::FdInputStream inputStream(inputFd);\n      typename Compression::BufferedInput bufferedInput(inputStream);\n  \n      CountingOutputStream output(outputFd);\n      typename ReuseStrategy::ScratchSpace builderScratch;\n      typename ReuseStrategy::ScratchSpace readerScratch;\n  \n      for (; iters > 0; --iters) {\n        typename ReuseStrategy::MessageBuilder builder(builderScratch);\n        typename ReuseStrategy::template MessageReader<Compression> reader(\n            bufferedInput, readerScratch);\n        TestCase::handleRequest(reader.template getRoot<typename TestCase::Request>(),\n                                builder.template initRoot<typename TestCase::Response>());\n        Compression::write(output, builder);\n      }\n  \n      return output.throughput;\n    }\n}"
  },
  {
    "function_name": "asyncClient",
    "container": "BenchmarkMethods",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-common.h",
    "lines": "307-313",
    "snippet": "static uint64_t asyncClient(int inputFd, int outputFd, uint64_t iters) {\n    ProducerConsumerQueue<typename TestCase::Expectation> expectations;\n    std::thread receiverThread(asyncClientReceiver, inputFd, &expectations, iters);\n    uint64_t throughput = asyncClientSender(outputFd, &expectations, iters);\n    receiverThread.join();\n    return throughput;\n  }",
    "includes": [
      "#include <thread>",
      "#include <capnp/serialize-snappy.h>",
      "#include <kj/debug.h>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/serialize.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "receiverThread.join",
          "args": [],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "asyncClientSender",
          "args": [
            "outputFd",
            "&expectations",
            "iters"
          ],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "asyncClientSender",
          "container": "BenchmarkMethods",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/null-common.h",
          "lines": "107-112",
          "snippet": "static uint64_t asyncClientSender(\n      int outputFd, ProducerConsumerQueue<typename TestCase::Expectation>* expectations,\n      uint64_t iters) {\n    fprintf(stderr, \"Null benchmark doesn't do I/O.\\n\");\n    exit(1);\n  }",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nBenchmarkMethods {\n  static uint64_t asyncClientSender(\n        int outputFd, ProducerConsumerQueue<typename TestCase::Expectation>* expectations,\n        uint64_t iters) {\n      fprintf(stderr, \"Null benchmark doesn't do I/O.\\n\");\n      exit(1);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <thread>\n#include <capnp/serialize-snappy.h>\n#include <kj/debug.h>\n#include <capnp/serialize-packed.h>\n#include <capnp/serialize.h>\n#include \"common.h\"\n\nBenchmarkMethods {\n  static uint64_t asyncClient(int inputFd, int outputFd, uint64_t iters) {\n      ProducerConsumerQueue<typename TestCase::Expectation> expectations;\n      std::thread receiverThread(asyncClientReceiver, inputFd, &expectations, iters);\n      uint64_t throughput = asyncClientSender(outputFd, &expectations, iters);\n      receiverThread.join();\n      return throughput;\n    }\n}"
  },
  {
    "function_name": "asyncClientReceiver",
    "container": "BenchmarkMethods",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-common.h",
    "lines": "289-305",
    "snippet": "static void asyncClientReceiver(\n      int inputFd, ProducerConsumerQueue<typename TestCase::Expectation>* expectations,\n      uint64_t iters) {\n    kj::FdInputStream inputStream(inputFd);\n    typename Compression::BufferedInput bufferedInput(inputStream);\n\n    typename ReuseStrategy::ScratchSpace scratch;\n\n    for (; iters > 0; --iters) {\n      typename TestCase::Expectation expected = expectations->next();\n      typename ReuseStrategy::template MessageReader<Compression> reader(bufferedInput, scratch);\n      if (!TestCase::checkResponse(\n          reader.template getRoot<typename TestCase::Response>(), expected)) {\n        throw std::logic_error(\"Incorrect response.\");\n      }\n    }\n  }",
    "includes": [
      "#include <thread>",
      "#include <capnp/serialize-snappy.h>",
      "#include <kj/debug.h>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/serialize.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::logic_error",
          "args": [
            "\"Incorrect response.\""
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TestCase::checkResponse",
          "args": [
            "reader.template getRoot<typename TestCase::Response>()",
            "expected"
          ],
          "line": 300
        },
        "resolved": true,
        "details": {
          "function_name": "checkResponse",
          "container": "CatRankTestCase",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-catrank.c++",
          "lines": "119-130",
          "snippet": "static bool checkResponse(SearchResultList::Reader response, int expectedGoodCount) {\n    int goodCount = 0;\n    for (auto result: response.getResults()) {\n      if (result.getScore() > 1001) {\n        ++goodCount;\n      } else {\n        break;\n      }\n    }\n\n    return goodCount == expectedGoodCount;\n  }",
          "includes": [
            "#include \"capnproto-common.h\"",
            "#include \"catrank.capnp.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capnproto-common.h\"\n#include \"catrank.capnp.h\"\n\nCatRankTestCase {\n  static bool checkResponse(SearchResultList::Reader response, int expectedGoodCount) {\n      int goodCount = 0;\n      for (auto result: response.getResults()) {\n        if (result.getScore() > 1001) {\n          ++goodCount;\n        } else {\n          break;\n        }\n      }\n  \n      return goodCount == expectedGoodCount;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "reader.template getRoot<typename TestCase::Response>",
          "args": [],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "expectations->next",
          "args": [],
          "line": 298
        },
        "resolved": true,
        "details": {
          "function_name": "next",
          "container": "ProducerConsumerQueue",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/common.h",
          "lines": "120-126",
          "snippet": "T next() {\n    sem_wait(&semaphore);\n    Node* oldFront = front;\n    front = front->next;\n    delete oldFront;\n    return front->value;\n  }",
          "includes": [
            "#include <vector>",
            "#include <string>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdexcept>",
            "#include <algorithm>",
            "#include <semaphore.h>",
            "#include <stdlib.h>",
            "#include <sys/wait.h>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include <errno.h>",
            "#include <limits>",
            "#include <unistd.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <stdio.h>\n#include <stdexcept>\n#include <algorithm>\n#include <semaphore.h>\n#include <stdlib.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include <errno.h>\n#include <limits>\n#include <unistd.h>\n\nProducerConsumerQueue {\n  T next() {\n      sem_wait(&semaphore);\n      Node* oldFront = front;\n      front = front->next;\n      delete oldFront;\n      return front->value;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <thread>\n#include <capnp/serialize-snappy.h>\n#include <kj/debug.h>\n#include <capnp/serialize-packed.h>\n#include <capnp/serialize.h>\n#include \"common.h\"\n\nBenchmarkMethods {\n  static void asyncClientReceiver(\n        int inputFd, ProducerConsumerQueue<typename TestCase::Expectation>* expectations,\n        uint64_t iters) {\n      kj::FdInputStream inputStream(inputFd);\n      typename Compression::BufferedInput bufferedInput(inputStream);\n  \n      typename ReuseStrategy::ScratchSpace scratch;\n  \n      for (; iters > 0; --iters) {\n        typename TestCase::Expectation expected = expectations->next();\n        typename ReuseStrategy::template MessageReader<Compression> reader(bufferedInput, scratch);\n        if (!TestCase::checkResponse(\n            reader.template getRoot<typename TestCase::Response>(), expected)) {\n          throw std::logic_error(\"Incorrect response.\");\n        }\n      }\n    }\n}"
  },
  {
    "function_name": "asyncClientSender",
    "container": "BenchmarkMethods",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-common.h",
    "lines": "273-287",
    "snippet": "static uint64_t asyncClientSender(\n      int outputFd, ProducerConsumerQueue<typename TestCase::Expectation>* expectations,\n      uint64_t iters) {\n    CountingOutputStream output(outputFd);\n    typename ReuseStrategy::ScratchSpace scratch;\n\n    for (; iters > 0; --iters) {\n      typename ReuseStrategy::MessageBuilder builder(scratch);\n      expectations->post(TestCase::setupRequest(\n          builder.template initRoot<typename TestCase::Request>()));\n      Compression::write(output, builder);\n    }\n\n    return output.throughput;\n  }",
    "includes": [
      "#include <thread>",
      "#include <capnp/serialize-snappy.h>",
      "#include <kj/debug.h>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/serialize.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Compression::write",
          "args": [
            "output",
            "builder"
          ],
          "line": 283
        },
        "resolved": true,
        "details": {
          "function_name": "write",
          "container": "SnappyCompressed",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-common.h",
          "lines": "123-127",
          "snippet": "static inline void write(OutputStream& output, MessageBuilder& builder) {\n    writeSnappyPackedMessage(output, builder,\n        kj::arrayPtr(snappyWriteBuffer, SNAPPY_BUFFER_SIZE),\n        kj::arrayPtr(snappyCompressedBuffer, SNAPPY_COMPRESSED_BUFFER_SIZE));\n  }",
          "includes": [
            "#include <thread>",
            "#include <capnp/serialize-snappy.h>",
            "#include <kj/debug.h>",
            "#include <capnp/serialize-packed.h>",
            "#include <capnp/serialize.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <thread>\n#include <capnp/serialize-snappy.h>\n#include <kj/debug.h>\n#include <capnp/serialize-packed.h>\n#include <capnp/serialize.h>\n#include \"common.h\"\n\nSnappyCompressed {\n  static inline void write(OutputStream& output, MessageBuilder& builder) {\n      writeSnappyPackedMessage(output, builder,\n          kj::arrayPtr(snappyWriteBuffer, SNAPPY_BUFFER_SIZE),\n          kj::arrayPtr(snappyCompressedBuffer, SNAPPY_COMPRESSED_BUFFER_SIZE));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "expectations->post",
          "args": [
            "TestCase::setupRequest(\n          builder.template initRoot<typename TestCase::Request>())"
          ],
          "line": 281
        },
        "resolved": true,
        "details": {
          "function_name": "post",
          "container": "ProducerConsumerQueue",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/common.h",
          "lines": "114-118",
          "snippet": "void post(T t) {\n    back->next = new Node(t);\n    back = back->next;\n    sem_post(&semaphore);\n  }",
          "includes": [
            "#include <vector>",
            "#include <string>",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdexcept>",
            "#include <algorithm>",
            "#include <semaphore.h>",
            "#include <stdlib.h>",
            "#include <sys/wait.h>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include <errno.h>",
            "#include <limits>",
            "#include <unistd.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <string>\n#include <string.h>\n#include <stdio.h>\n#include <stdexcept>\n#include <algorithm>\n#include <semaphore.h>\n#include <stdlib.h>\n#include <sys/wait.h>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include <errno.h>\n#include <limits>\n#include <unistd.h>\n\nProducerConsumerQueue {\n  void post(T t) {\n      back->next = new Node(t);\n      back = back->next;\n      sem_post(&semaphore);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "TestCase::setupRequest",
          "args": [
            "builder.template initRoot<typename TestCase::Request>()"
          ],
          "line": 281
        },
        "resolved": true,
        "details": {
          "function_name": "setupRequest",
          "container": "CatRankTestCase",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-catrank.c++",
          "lines": "45-91",
          "snippet": "static int setupRequest(SearchResultList::Builder request) {\n    int count = fastRand(1000);\n    int goodCount = 0;\n\n    auto list = request.initResults(count);\n\n    for (int i = 0; i < count; i++) {\n      SearchResult::Builder result = list[i];\n      result.setScore(1000 - i);\n      int urlSize = fastRand(100);\n\n      static const char URL_PREFIX[] = \"http://example.com/\";\n      size_t urlPrefixLength = strlen(URL_PREFIX);\n      auto url = result.initUrl(urlSize + urlPrefixLength);\n\n      strcpy(url.begin(), URL_PREFIX);\n      char* pos = url.begin() + urlPrefixLength;\n      for (int j = 0; j < urlSize; j++) {\n        *pos++ = 'a' + fastRand(26);\n      }\n\n      bool isCat = fastRand(8) == 0;\n      bool isDog = fastRand(8) == 0;\n      goodCount += isCat && !isDog;\n\n      static std::string snippet;\n      snippet.clear();\n      snippet.push_back(' ');\n\n      int prefix = fastRand(20);\n      for (int j = 0; j < prefix; j++) {\n        snippet.append(WORDS[fastRand(WORDS_COUNT)]);\n      }\n\n      if (isCat) snippet.append(\"cat \");\n      if (isDog) snippet.append(\"dog \");\n\n      int suffix = fastRand(20);\n      for (int j = 0; j < suffix; j++) {\n        snippet.append(WORDS[fastRand(WORDS_COUNT)]);\n      }\n\n      result.setSnippet(Text::Reader(snippet.c_str(), snippet.size()));\n    }\n\n    return goodCount;\n  }",
          "includes": [
            "#include \"capnproto-common.h\"",
            "#include \"catrank.capnp.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capnproto-common.h\"\n#include \"catrank.capnp.h\"\n\nCatRankTestCase {\n  static int setupRequest(SearchResultList::Builder request) {\n      int count = fastRand(1000);\n      int goodCount = 0;\n  \n      auto list = request.initResults(count);\n  \n      for (int i = 0; i < count; i++) {\n        SearchResult::Builder result = list[i];\n        result.setScore(1000 - i);\n        int urlSize = fastRand(100);\n  \n        static const char URL_PREFIX[] = \"http://example.com/\";\n        size_t urlPrefixLength = strlen(URL_PREFIX);\n        auto url = result.initUrl(urlSize + urlPrefixLength);\n  \n        strcpy(url.begin(), URL_PREFIX);\n        char* pos = url.begin() + urlPrefixLength;\n        for (int j = 0; j < urlSize; j++) {\n          *pos++ = 'a' + fastRand(26);\n        }\n  \n        bool isCat = fastRand(8) == 0;\n        bool isDog = fastRand(8) == 0;\n        goodCount += isCat && !isDog;\n  \n        static std::string snippet;\n        snippet.clear();\n        snippet.push_back(' ');\n  \n        int prefix = fastRand(20);\n        for (int j = 0; j < prefix; j++) {\n          snippet.append(WORDS[fastRand(WORDS_COUNT)]);\n        }\n  \n        if (isCat) snippet.append(\"cat \");\n        if (isDog) snippet.append(\"dog \");\n  \n        int suffix = fastRand(20);\n        for (int j = 0; j < suffix; j++) {\n          snippet.append(WORDS[fastRand(WORDS_COUNT)]);\n        }\n  \n        result.setSnippet(Text::Reader(snippet.c_str(), snippet.size()));\n      }\n  \n      return goodCount;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "builder.template initRoot<typename TestCase::Request>",
          "args": [],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <thread>\n#include <capnp/serialize-snappy.h>\n#include <kj/debug.h>\n#include <capnp/serialize-packed.h>\n#include <capnp/serialize.h>\n#include \"common.h\"\n\nBenchmarkMethods {\n  static uint64_t asyncClientSender(\n        int outputFd, ProducerConsumerQueue<typename TestCase::Expectation>* expectations,\n        uint64_t iters) {\n      CountingOutputStream output(outputFd);\n      typename ReuseStrategy::ScratchSpace scratch;\n  \n      for (; iters > 0; --iters) {\n        typename ReuseStrategy::MessageBuilder builder(scratch);\n        expectations->post(TestCase::setupRequest(\n            builder.template initRoot<typename TestCase::Request>()));\n        Compression::write(output, builder);\n      }\n  \n      return output.throughput;\n    }\n}"
  },
  {
    "function_name": "syncClient",
    "container": "BenchmarkMethods",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-common.h",
    "lines": "243-271",
    "snippet": "static uint64_t syncClient(int inputFd, int outputFd, uint64_t iters) {\n    kj::FdInputStream inputStream(inputFd);\n    typename Compression::BufferedInput bufferedInput(inputStream);\n\n    CountingOutputStream output(outputFd);\n    typename ReuseStrategy::ScratchSpace builderScratch;\n    typename ReuseStrategy::ScratchSpace readerScratch;\n\n    for (; iters > 0; --iters) {\n      typename TestCase::Expectation expected;\n      {\n        typename ReuseStrategy::MessageBuilder builder(builderScratch);\n        expected = TestCase::setupRequest(\n            builder.template initRoot<typename TestCase::Request>());\n        Compression::write(output, builder);\n      }\n\n      {\n        typename ReuseStrategy::template MessageReader<Compression> reader(\n            bufferedInput, readerScratch);\n        if (!TestCase::checkResponse(\n            reader.template getRoot<typename TestCase::Response>(), expected)) {\n          throw std::logic_error(\"Incorrect response.\");\n        }\n      }\n    }\n\n    return output.throughput;\n  }",
    "includes": [
      "#include <thread>",
      "#include <capnp/serialize-snappy.h>",
      "#include <kj/debug.h>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/serialize.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::logic_error",
          "args": [
            "\"Incorrect response.\""
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TestCase::checkResponse",
          "args": [
            "reader.template getRoot<typename TestCase::Response>()",
            "expected"
          ],
          "line": 263
        },
        "resolved": true,
        "details": {
          "function_name": "checkResponse",
          "container": "CatRankTestCase",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-catrank.c++",
          "lines": "119-130",
          "snippet": "static bool checkResponse(SearchResultList::Reader response, int expectedGoodCount) {\n    int goodCount = 0;\n    for (auto result: response.getResults()) {\n      if (result.getScore() > 1001) {\n        ++goodCount;\n      } else {\n        break;\n      }\n    }\n\n    return goodCount == expectedGoodCount;\n  }",
          "includes": [
            "#include \"capnproto-common.h\"",
            "#include \"catrank.capnp.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capnproto-common.h\"\n#include \"catrank.capnp.h\"\n\nCatRankTestCase {\n  static bool checkResponse(SearchResultList::Reader response, int expectedGoodCount) {\n      int goodCount = 0;\n      for (auto result: response.getResults()) {\n        if (result.getScore() > 1001) {\n          ++goodCount;\n        } else {\n          break;\n        }\n      }\n  \n      return goodCount == expectedGoodCount;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "reader.template getRoot<typename TestCase::Response>",
          "args": [],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Compression::write",
          "args": [
            "output",
            "builder"
          ],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "write",
          "container": "SnappyCompressed",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-common.h",
          "lines": "123-127",
          "snippet": "static inline void write(OutputStream& output, MessageBuilder& builder) {\n    writeSnappyPackedMessage(output, builder,\n        kj::arrayPtr(snappyWriteBuffer, SNAPPY_BUFFER_SIZE),\n        kj::arrayPtr(snappyCompressedBuffer, SNAPPY_COMPRESSED_BUFFER_SIZE));\n  }",
          "includes": [
            "#include <thread>",
            "#include <capnp/serialize-snappy.h>",
            "#include <kj/debug.h>",
            "#include <capnp/serialize-packed.h>",
            "#include <capnp/serialize.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <thread>\n#include <capnp/serialize-snappy.h>\n#include <kj/debug.h>\n#include <capnp/serialize-packed.h>\n#include <capnp/serialize.h>\n#include \"common.h\"\n\nSnappyCompressed {\n  static inline void write(OutputStream& output, MessageBuilder& builder) {\n      writeSnappyPackedMessage(output, builder,\n          kj::arrayPtr(snappyWriteBuffer, SNAPPY_BUFFER_SIZE),\n          kj::arrayPtr(snappyCompressedBuffer, SNAPPY_COMPRESSED_BUFFER_SIZE));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "TestCase::setupRequest",
          "args": [
            "builder.template initRoot<typename TestCase::Request>()"
          ],
          "line": 255
        },
        "resolved": true,
        "details": {
          "function_name": "setupRequest",
          "container": "CatRankTestCase",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-catrank.c++",
          "lines": "45-91",
          "snippet": "static int setupRequest(SearchResultList::Builder request) {\n    int count = fastRand(1000);\n    int goodCount = 0;\n\n    auto list = request.initResults(count);\n\n    for (int i = 0; i < count; i++) {\n      SearchResult::Builder result = list[i];\n      result.setScore(1000 - i);\n      int urlSize = fastRand(100);\n\n      static const char URL_PREFIX[] = \"http://example.com/\";\n      size_t urlPrefixLength = strlen(URL_PREFIX);\n      auto url = result.initUrl(urlSize + urlPrefixLength);\n\n      strcpy(url.begin(), URL_PREFIX);\n      char* pos = url.begin() + urlPrefixLength;\n      for (int j = 0; j < urlSize; j++) {\n        *pos++ = 'a' + fastRand(26);\n      }\n\n      bool isCat = fastRand(8) == 0;\n      bool isDog = fastRand(8) == 0;\n      goodCount += isCat && !isDog;\n\n      static std::string snippet;\n      snippet.clear();\n      snippet.push_back(' ');\n\n      int prefix = fastRand(20);\n      for (int j = 0; j < prefix; j++) {\n        snippet.append(WORDS[fastRand(WORDS_COUNT)]);\n      }\n\n      if (isCat) snippet.append(\"cat \");\n      if (isDog) snippet.append(\"dog \");\n\n      int suffix = fastRand(20);\n      for (int j = 0; j < suffix; j++) {\n        snippet.append(WORDS[fastRand(WORDS_COUNT)]);\n      }\n\n      result.setSnippet(Text::Reader(snippet.c_str(), snippet.size()));\n    }\n\n    return goodCount;\n  }",
          "includes": [
            "#include \"capnproto-common.h\"",
            "#include \"catrank.capnp.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capnproto-common.h\"\n#include \"catrank.capnp.h\"\n\nCatRankTestCase {\n  static int setupRequest(SearchResultList::Builder request) {\n      int count = fastRand(1000);\n      int goodCount = 0;\n  \n      auto list = request.initResults(count);\n  \n      for (int i = 0; i < count; i++) {\n        SearchResult::Builder result = list[i];\n        result.setScore(1000 - i);\n        int urlSize = fastRand(100);\n  \n        static const char URL_PREFIX[] = \"http://example.com/\";\n        size_t urlPrefixLength = strlen(URL_PREFIX);\n        auto url = result.initUrl(urlSize + urlPrefixLength);\n  \n        strcpy(url.begin(), URL_PREFIX);\n        char* pos = url.begin() + urlPrefixLength;\n        for (int j = 0; j < urlSize; j++) {\n          *pos++ = 'a' + fastRand(26);\n        }\n  \n        bool isCat = fastRand(8) == 0;\n        bool isDog = fastRand(8) == 0;\n        goodCount += isCat && !isDog;\n  \n        static std::string snippet;\n        snippet.clear();\n        snippet.push_back(' ');\n  \n        int prefix = fastRand(20);\n        for (int j = 0; j < prefix; j++) {\n          snippet.append(WORDS[fastRand(WORDS_COUNT)]);\n        }\n  \n        if (isCat) snippet.append(\"cat \");\n        if (isDog) snippet.append(\"dog \");\n  \n        int suffix = fastRand(20);\n        for (int j = 0; j < suffix; j++) {\n          snippet.append(WORDS[fastRand(WORDS_COUNT)]);\n        }\n  \n        result.setSnippet(Text::Reader(snippet.c_str(), snippet.size()));\n      }\n  \n      return goodCount;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "builder.template initRoot<typename TestCase::Request>",
          "args": [],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <thread>\n#include <capnp/serialize-snappy.h>\n#include <kj/debug.h>\n#include <capnp/serialize-packed.h>\n#include <capnp/serialize.h>\n#include \"common.h\"\n\nBenchmarkMethods {\n  static uint64_t syncClient(int inputFd, int outputFd, uint64_t iters) {\n      kj::FdInputStream inputStream(inputFd);\n      typename Compression::BufferedInput bufferedInput(inputStream);\n  \n      CountingOutputStream output(outputFd);\n      typename ReuseStrategy::ScratchSpace builderScratch;\n      typename ReuseStrategy::ScratchSpace readerScratch;\n  \n      for (; iters > 0; --iters) {\n        typename TestCase::Expectation expected;\n        {\n          typename ReuseStrategy::MessageBuilder builder(builderScratch);\n          expected = TestCase::setupRequest(\n              builder.template initRoot<typename TestCase::Request>());\n          Compression::write(output, builder);\n        }\n  \n        {\n          typename ReuseStrategy::template MessageReader<Compression> reader(\n              bufferedInput, readerScratch);\n          if (!TestCase::checkResponse(\n              reader.template getRoot<typename TestCase::Response>(), expected)) {\n            throw std::logic_error(\"Incorrect response.\");\n          }\n        }\n      }\n  \n      return output.throughput;\n    }\n}"
  },
  {
    "function_name": "get",
    "container": "UseScratch::ObjectSizeCounter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-common.h",
    "lines": "231-231",
    "snippet": "uint64_t get() { return iters * maxSize; }",
    "includes": [
      "#include <thread>",
      "#include <capnp/serialize-snappy.h>",
      "#include <kj/debug.h>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/serialize.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <thread>\n#include <capnp/serialize-snappy.h>\n#include <kj/debug.h>\n#include <capnp/serialize-packed.h>\n#include <capnp/serialize.h>\n#include \"common.h\"\n\nUseScratch {\n  ObjectSizeCounter {\n    uint64_t get() { return iters * maxSize; }\n  }\n}"
  },
  {
    "function_name": "add",
    "container": "UseScratch::ObjectSizeCounter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-common.h",
    "lines": "220-229",
    "snippet": "void add(RequestBuilder& request, ResponseBuilder& response) {\n      size_t counter = 0;\n      for (auto segment: request.getSegmentsForOutput()) {\n        counter += segment.size() * sizeof(word);\n      }\n      for (auto segment: response.getSegmentsForOutput()) {\n        counter += segment.size() * sizeof(word);\n      }\n      maxSize = std::max(counter, maxSize);\n    }",
    "includes": [
      "#include <thread>",
      "#include <capnp/serialize-snappy.h>",
      "#include <kj/debug.h>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/serialize.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::max",
          "args": [
            "counter",
            "maxSize"
          ],
          "line": 228
        },
        "resolved": true,
        "details": {
          "function_name": "max",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "486-488",
          "snippet": "auto max(T&& a, U&& b) -> MaxType<Decay<T>, Decay<U>> {\n  return a > b ? MaxType<Decay<T>, Decay<U>>(a) : MaxType<Decay<T>, Decay<U>>(b);\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\nauto max(T&& a, U&& b) -> MaxType<Decay<T>, Decay<U>> {\n  return a > b ? MaxType<Decay<T>, Decay<U>>(a) : MaxType<Decay<T>, Decay<U>>(b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "segment.size",
          "args": [],
          "line": 226
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "599-599",
          "snippet": "inline uint size() { return _builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline uint size() { return _builder.size() / ELEMENTS; }"
        }
      },
      {
        "call_info": {
          "callee": "response.getSegmentsForOutput",
          "args": [],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request.getSegmentsForOutput",
          "args": [],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <thread>\n#include <capnp/serialize-snappy.h>\n#include <kj/debug.h>\n#include <capnp/serialize-packed.h>\n#include <capnp/serialize.h>\n#include \"common.h\"\n\nUseScratch {\n  ObjectSizeCounter {\n    void add(RequestBuilder& request, ResponseBuilder& response) {\n          size_t counter = 0;\n          for (auto segment: request.getSegmentsForOutput()) {\n            counter += segment.size() * sizeof(word);\n          }\n          for (auto segment: response.getSegmentsForOutput()) {\n            counter += segment.size() * sizeof(word);\n          }\n          maxSize = std::max(counter, maxSize);\n        }\n  }\n}"
  },
  {
    "function_name": "ObjectSizeCounter",
    "container": "UseScratch::ObjectSizeCounter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-common.h",
    "lines": "217-217",
    "snippet": "ObjectSizeCounter(uint64_t iters): iters(iters), maxSize(0) {}",
    "includes": [
      "#include <thread>",
      "#include <capnp/serialize-snappy.h>",
      "#include <kj/debug.h>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/serialize.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <thread>\n#include <capnp/serialize-snappy.h>\n#include <kj/debug.h>\n#include <capnp/serialize-packed.h>\n#include <capnp/serialize.h>\n#include \"common.h\"\n\nUseScratch {\n  ObjectSizeCounter {\n    ObjectSizeCounter(uint64_t iters): iters(iters), maxSize(0) {}\n  }\n}"
  },
  {
    "function_name": "MessageBuilder",
    "container": "UseScratch::MessageBuilder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-common.h",
    "lines": "211-212",
    "snippet": "inline MessageBuilder(ScratchSpace& scratch)\n        : MallocMessageBuilder(kj::arrayPtr(scratch.words, SCRATCH_SIZE)) {}",
    "includes": [
      "#include <thread>",
      "#include <capnp/serialize-snappy.h>",
      "#include <kj/debug.h>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/serialize.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::arrayPtr",
          "args": [
            "scratch.words",
            "SCRATCH_SIZE"
          ],
          "line": 212
        },
        "resolved": true,
        "details": {
          "function_name": "arrayPtr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "1194-1197",
          "snippet": "inline constexpr ArrayPtr<T> arrayPtr(T* begin, T* end) {\n  // Use this function to construct ArrayPtrs without writing out the type name.\n  return ArrayPtr<T>(begin, end);\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\ninline constexpr ArrayPtr<T> arrayPtr(T* begin, T* end) {\n  // Use this function to construct ArrayPtrs without writing out the type name.\n  return ArrayPtr<T>(begin, end);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <thread>\n#include <capnp/serialize-snappy.h>\n#include <kj/debug.h>\n#include <capnp/serialize-packed.h>\n#include <capnp/serialize.h>\n#include \"common.h\"\n\nUseScratch {\n  MessageBuilder {\n    inline MessageBuilder(ScratchSpace& scratch)\n            : MallocMessageBuilder(kj::arrayPtr(scratch.words, SCRATCH_SIZE)) {}\n  }\n}"
  },
  {
    "function_name": "ArrayMessageReader",
    "container": "UseScratch::ArrayMessageReader",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-common.h",
    "lines": "204-206",
    "snippet": "inline ArrayMessageReader(kj::ArrayPtr<const byte> input, ScratchSpace& scratch)\n        : Compression::ArrayMessageReader(\n            input, ReaderOptions(), kj::arrayPtr(scratch.words, SCRATCH_SIZE)) {}",
    "includes": [
      "#include <thread>",
      "#include <capnp/serialize-snappy.h>",
      "#include <kj/debug.h>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/serialize.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::arrayPtr",
          "args": [
            "scratch.words",
            "SCRATCH_SIZE"
          ],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "arrayPtr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "1194-1197",
          "snippet": "inline constexpr ArrayPtr<T> arrayPtr(T* begin, T* end) {\n  // Use this function to construct ArrayPtrs without writing out the type name.\n  return ArrayPtr<T>(begin, end);\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\ninline constexpr ArrayPtr<T> arrayPtr(T* begin, T* end) {\n  // Use this function to construct ArrayPtrs without writing out the type name.\n  return ArrayPtr<T>(begin, end);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ReaderOptions",
          "args": [],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <thread>\n#include <capnp/serialize-snappy.h>\n#include <kj/debug.h>\n#include <capnp/serialize-packed.h>\n#include <capnp/serialize.h>\n#include \"common.h\"\n\nUseScratch {\n  ArrayMessageReader {\n    inline ArrayMessageReader(kj::ArrayPtr<const byte> input, ScratchSpace& scratch)\n            : Compression::ArrayMessageReader(\n                input, ReaderOptions(), kj::arrayPtr(scratch.words, SCRATCH_SIZE)) {}\n  }\n}"
  },
  {
    "function_name": "MessageReader",
    "container": "UseScratch::MessageReader",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-common.h",
    "lines": "196-198",
    "snippet": "inline MessageReader(typename Compression::BufferedInput& input, ScratchSpace& scratch)\n        : Compression::MessageReader(\n            input, ReaderOptions(), kj::arrayPtr(scratch.words, SCRATCH_SIZE)) {}",
    "includes": [
      "#include <thread>",
      "#include <capnp/serialize-snappy.h>",
      "#include <kj/debug.h>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/serialize.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::arrayPtr",
          "args": [
            "scratch.words",
            "SCRATCH_SIZE"
          ],
          "line": 198
        },
        "resolved": true,
        "details": {
          "function_name": "arrayPtr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "1194-1197",
          "snippet": "inline constexpr ArrayPtr<T> arrayPtr(T* begin, T* end) {\n  // Use this function to construct ArrayPtrs without writing out the type name.\n  return ArrayPtr<T>(begin, end);\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\ninline constexpr ArrayPtr<T> arrayPtr(T* begin, T* end) {\n  // Use this function to construct ArrayPtrs without writing out the type name.\n  return ArrayPtr<T>(begin, end);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ReaderOptions",
          "args": [],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <thread>\n#include <capnp/serialize-snappy.h>\n#include <kj/debug.h>\n#include <capnp/serialize-packed.h>\n#include <capnp/serialize.h>\n#include \"common.h\"\n\nUseScratch {\n  MessageReader {\n    inline MessageReader(typename Compression::BufferedInput& input, ScratchSpace& scratch)\n            : Compression::MessageReader(\n                input, ReaderOptions(), kj::arrayPtr(scratch.words, SCRATCH_SIZE)) {}\n  }\n}"
  },
  {
    "function_name": "ScratchSpace",
    "container": "UseScratch::ScratchSpace",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-common.h",
    "lines": "184-187",
    "snippet": "ScratchSpace() {\n      KJ_REQUIRE(scratchCounter < 6, \"Too many scratch spaces needed at once.\");\n      words = scratchSpace + scratchCounter++ * SCRATCH_SIZE;\n    }",
    "includes": [
      "#include <thread>",
      "#include <capnp/serialize-snappy.h>",
      "#include <kj/debug.h>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/serialize.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "scratchCounter < 6",
            "\"Too many scratch spaces needed at once.\""
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <thread>\n#include <capnp/serialize-snappy.h>\n#include <kj/debug.h>\n#include <capnp/serialize-packed.h>\n#include <capnp/serialize.h>\n#include \"common.h\"\n\nUseScratch {\n  ScratchSpace {\n    ScratchSpace() {\n          KJ_REQUIRE(scratchCounter < 6, \"Too many scratch spaces needed at once.\");\n          words = scratchSpace + scratchCounter++ * SCRATCH_SIZE;\n        }\n  }\n}"
  },
  {
    "function_name": "get",
    "container": "NoScratch::ObjectSizeCounter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-common.h",
    "lines": "169-169",
    "snippet": "uint64_t get() { return counter; }",
    "includes": [
      "#include <thread>",
      "#include <capnp/serialize-snappy.h>",
      "#include <kj/debug.h>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/serialize.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <thread>\n#include <capnp/serialize-snappy.h>\n#include <kj/debug.h>\n#include <capnp/serialize-packed.h>\n#include <capnp/serialize.h>\n#include \"common.h\"\n\nNoScratch {\n  ObjectSizeCounter {\n    uint64_t get() { return counter; }\n  }\n}"
  },
  {
    "function_name": "add",
    "container": "NoScratch::ObjectSizeCounter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-common.h",
    "lines": "160-167",
    "snippet": "void add(RequestBuilder& request, ResponseBuilder& response) {\n      for (auto segment: request.getSegmentsForOutput()) {\n        counter += segment.size() * sizeof(word);\n      }\n      for (auto segment: response.getSegmentsForOutput()) {\n        counter += segment.size() * sizeof(word);\n      }\n    }",
    "includes": [
      "#include <thread>",
      "#include <capnp/serialize-snappy.h>",
      "#include <kj/debug.h>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/serialize.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "segment.size",
          "args": [],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "599-599",
          "snippet": "inline uint size() { return _builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline uint size() { return _builder.size() / ELEMENTS; }"
        }
      },
      {
        "call_info": {
          "callee": "response.getSegmentsForOutput",
          "args": [],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request.getSegmentsForOutput",
          "args": [],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <thread>\n#include <capnp/serialize-snappy.h>\n#include <kj/debug.h>\n#include <capnp/serialize-packed.h>\n#include <capnp/serialize.h>\n#include \"common.h\"\n\nNoScratch {\n  ObjectSizeCounter {\n    void add(RequestBuilder& request, ResponseBuilder& response) {\n          for (auto segment: request.getSegmentsForOutput()) {\n            counter += segment.size() * sizeof(word);\n          }\n          for (auto segment: response.getSegmentsForOutput()) {\n            counter += segment.size() * sizeof(word);\n          }\n        }\n  }\n}"
  },
  {
    "function_name": "ObjectSizeCounter",
    "container": "NoScratch::ObjectSizeCounter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-common.h",
    "lines": "157-157",
    "snippet": "ObjectSizeCounter(uint64_t iters): counter(0) {}",
    "includes": [
      "#include <thread>",
      "#include <capnp/serialize-snappy.h>",
      "#include <kj/debug.h>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/serialize.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <thread>\n#include <capnp/serialize-snappy.h>\n#include <kj/debug.h>\n#include <capnp/serialize-packed.h>\n#include <capnp/serialize.h>\n#include \"common.h\"\n\nNoScratch {\n  ObjectSizeCounter {\n    ObjectSizeCounter(uint64_t iters): counter(0) {}\n  }\n}"
  },
  {
    "function_name": "MessageBuilder",
    "container": "NoScratch::MessageBuilder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-common.h",
    "lines": "152-152",
    "snippet": "inline MessageBuilder(ScratchSpace& scratch): MallocMessageBuilder() {}",
    "includes": [
      "#include <thread>",
      "#include <capnp/serialize-snappy.h>",
      "#include <kj/debug.h>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/serialize.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <thread>\n#include <capnp/serialize-snappy.h>\n#include <kj/debug.h>\n#include <capnp/serialize-packed.h>\n#include <capnp/serialize.h>\n#include \"common.h\"\n\nNoScratch {\n  MessageBuilder {\n    inline MessageBuilder(ScratchSpace& scratch): MallocMessageBuilder() {}\n  }\n}"
  },
  {
    "function_name": "ArrayMessageReader",
    "container": "NoScratch::ArrayMessageReader",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-common.h",
    "lines": "146-147",
    "snippet": "inline ArrayMessageReader(kj::ArrayPtr<const byte> input, ScratchSpace& scratch)\n        : Compression::ArrayMessageReader(input) {}",
    "includes": [
      "#include <thread>",
      "#include <capnp/serialize-snappy.h>",
      "#include <kj/debug.h>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/serialize.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <thread>\n#include <capnp/serialize-snappy.h>\n#include <kj/debug.h>\n#include <capnp/serialize-packed.h>\n#include <capnp/serialize.h>\n#include \"common.h\"\n\nNoScratch {\n  ArrayMessageReader {\n    inline ArrayMessageReader(kj::ArrayPtr<const byte> input, ScratchSpace& scratch)\n            : Compression::ArrayMessageReader(input) {}\n  }\n}"
  },
  {
    "function_name": "MessageReader",
    "container": "NoScratch::MessageReader",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-common.h",
    "lines": "139-140",
    "snippet": "inline MessageReader(typename Compression::BufferedInput& input, ScratchSpace& scratch)\n        : Compression::MessageReader(input) {}",
    "includes": [
      "#include <thread>",
      "#include <capnp/serialize-snappy.h>",
      "#include <kj/debug.h>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/serialize.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <thread>\n#include <capnp/serialize-snappy.h>\n#include <kj/debug.h>\n#include <capnp/serialize-packed.h>\n#include <capnp/serialize.h>\n#include \"common.h\"\n\nNoScratch {\n  MessageReader {\n    inline MessageReader(typename Compression::BufferedInput& input, ScratchSpace& scratch)\n            : Compression::MessageReader(input) {}\n  }\n}"
  },
  {
    "function_name": "write",
    "container": "SnappyCompressed",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-common.h",
    "lines": "123-127",
    "snippet": "static inline void write(OutputStream& output, MessageBuilder& builder) {\n    writeSnappyPackedMessage(output, builder,\n        kj::arrayPtr(snappyWriteBuffer, SNAPPY_BUFFER_SIZE),\n        kj::arrayPtr(snappyCompressedBuffer, SNAPPY_COMPRESSED_BUFFER_SIZE));\n  }",
    "includes": [
      "#include <thread>",
      "#include <capnp/serialize-snappy.h>",
      "#include <kj/debug.h>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/serialize.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "writeSnappyPackedMessage",
          "args": [
            "output",
            "builder",
            "kj::arrayPtr(snappyWriteBuffer, SNAPPY_BUFFER_SIZE)",
            "kj::arrayPtr(snappyCompressedBuffer, SNAPPY_COMPRESSED_BUFFER_SIZE)"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::arrayPtr",
          "args": [
            "snappyCompressedBuffer",
            "SNAPPY_COMPRESSED_BUFFER_SIZE"
          ],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "arrayPtr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "1194-1197",
          "snippet": "inline constexpr ArrayPtr<T> arrayPtr(T* begin, T* end) {\n  // Use this function to construct ArrayPtrs without writing out the type name.\n  return ArrayPtr<T>(begin, end);\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\ninline constexpr ArrayPtr<T> arrayPtr(T* begin, T* end) {\n  // Use this function to construct ArrayPtrs without writing out the type name.\n  return ArrayPtr<T>(begin, end);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <thread>\n#include <capnp/serialize-snappy.h>\n#include <kj/debug.h>\n#include <capnp/serialize-packed.h>\n#include <capnp/serialize.h>\n#include \"common.h\"\n\nSnappyCompressed {\n  static inline void write(OutputStream& output, MessageBuilder& builder) {\n      writeSnappyPackedMessage(output, builder,\n          kj::arrayPtr(snappyWriteBuffer, SNAPPY_BUFFER_SIZE),\n          kj::arrayPtr(snappyCompressedBuffer, SNAPPY_COMPRESSED_BUFFER_SIZE));\n    }\n}"
  },
  {
    "function_name": "ArrayMessageReader",
    "container": "SnappyCompressed::ArrayMessageReader",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-common.h",
    "lines": "115-120",
    "snippet": "ArrayMessageReader(kj::ArrayPtr<const byte> array,\n                       ReaderOptions options = ReaderOptions(),\n                       kj::ArrayPtr<word> scratchSpace = nullptr)\n      : ArrayInputStream(array),\n        SnappyPackedMessageReader(static_cast<ArrayInputStream&>(*this), options, scratchSpace,\n                                  kj::arrayPtr(snappyReadBuffer, SNAPPY_BUFFER_SIZE)) {}",
    "includes": [
      "#include <thread>",
      "#include <capnp/serialize-snappy.h>",
      "#include <kj/debug.h>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/serialize.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::arrayPtr",
          "args": [
            "snappyReadBuffer",
            "SNAPPY_BUFFER_SIZE"
          ],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "arrayPtr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "1194-1197",
          "snippet": "inline constexpr ArrayPtr<T> arrayPtr(T* begin, T* end) {\n  // Use this function to construct ArrayPtrs without writing out the type name.\n  return ArrayPtr<T>(begin, end);\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\ninline constexpr ArrayPtr<T> arrayPtr(T* begin, T* end) {\n  // Use this function to construct ArrayPtrs without writing out the type name.\n  return ArrayPtr<T>(begin, end);\n}"
        }
      },
      {
        "call_info": {
          "callee": "static_cast<ArrayInputStream&>",
          "args": [
            "*this"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ReaderOptions",
          "args": [],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <thread>\n#include <capnp/serialize-snappy.h>\n#include <kj/debug.h>\n#include <capnp/serialize-packed.h>\n#include <capnp/serialize.h>\n#include \"common.h\"\n\nSnappyCompressed {\n  ArrayMessageReader {\n    ArrayMessageReader(kj::ArrayPtr<const byte> array,\n                           ReaderOptions options = ReaderOptions(),\n                           kj::ArrayPtr<word> scratchSpace = nullptr)\n          : ArrayInputStream(array),\n            SnappyPackedMessageReader(static_cast<ArrayInputStream&>(*this), options, scratchSpace,\n                                      kj::arrayPtr(snappyReadBuffer, SNAPPY_BUFFER_SIZE)) {}\n  }\n}"
  },
  {
    "function_name": "write",
    "container": "Packed",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-common.h",
    "lines": "99-101",
    "snippet": "static inline void write(kj::BufferedOutputStream& output, MessageBuilder& builder) {\n    writePackedMessage(output, builder);\n  }",
    "includes": [
      "#include <thread>",
      "#include <capnp/serialize-snappy.h>",
      "#include <kj/debug.h>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/serialize.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "writePackedMessage",
          "args": [
            "output",
            "builder"
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "writePackedMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-packed.h",
          "lines": "116-118",
          "snippet": "inline void writePackedMessage(kj::OutputStream& output, MessageBuilder& builder) {\n  writePackedMessage(output, builder.getSegmentsForOutput());\n}",
          "includes": [
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"serialize.h\"\n\ninline void writePackedMessage(kj::OutputStream& output, MessageBuilder& builder) {\n  writePackedMessage(output, builder.getSegmentsForOutput());\n}"
        }
      }
    ],
    "contextual_snippet": "#include <thread>\n#include <capnp/serialize-snappy.h>\n#include <kj/debug.h>\n#include <capnp/serialize-packed.h>\n#include <capnp/serialize.h>\n#include \"common.h\"\n\nPacked {\n  static inline void write(kj::BufferedOutputStream& output, MessageBuilder& builder) {\n      writePackedMessage(output, builder);\n    }\n}"
  },
  {
    "function_name": "write",
    "container": "Packed",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-common.h",
    "lines": "95-97",
    "snippet": "static inline void write(kj::OutputStream& output, MessageBuilder& builder) {\n    writePackedMessage(output, builder);\n  }",
    "includes": [
      "#include <thread>",
      "#include <capnp/serialize-snappy.h>",
      "#include <kj/debug.h>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/serialize.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "writePackedMessage",
          "args": [
            "output",
            "builder"
          ],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "writePackedMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-packed.h",
          "lines": "116-118",
          "snippet": "inline void writePackedMessage(kj::OutputStream& output, MessageBuilder& builder) {\n  writePackedMessage(output, builder.getSegmentsForOutput());\n}",
          "includes": [
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"serialize.h\"\n\ninline void writePackedMessage(kj::OutputStream& output, MessageBuilder& builder) {\n  writePackedMessage(output, builder.getSegmentsForOutput());\n}"
        }
      }
    ],
    "contextual_snippet": "#include <thread>\n#include <capnp/serialize-snappy.h>\n#include <kj/debug.h>\n#include <capnp/serialize-packed.h>\n#include <capnp/serialize.h>\n#include \"common.h\"\n\nPacked {\n  static inline void write(kj::OutputStream& output, MessageBuilder& builder) {\n      writePackedMessage(output, builder);\n    }\n}"
  },
  {
    "function_name": "ArrayMessageReader",
    "container": "Packed::ArrayMessageReader",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-common.h",
    "lines": "88-92",
    "snippet": "ArrayMessageReader(kj::ArrayPtr<const byte> array,\n                       ReaderOptions options = ReaderOptions(),\n                       kj::ArrayPtr<word> scratchSpace = nullptr)\n      : ArrayInputStream(array),\n        PackedMessageReader(*this, options, scratchSpace) {}",
    "includes": [
      "#include <thread>",
      "#include <capnp/serialize-snappy.h>",
      "#include <kj/debug.h>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/serialize.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ReaderOptions",
          "args": [],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <thread>\n#include <capnp/serialize-snappy.h>\n#include <kj/debug.h>\n#include <capnp/serialize-packed.h>\n#include <capnp/serialize.h>\n#include \"common.h\"\n\nPacked {\n  ArrayMessageReader {\n    ArrayMessageReader(kj::ArrayPtr<const byte> array,\n                           ReaderOptions options = ReaderOptions(),\n                           kj::ArrayPtr<word> scratchSpace = nullptr)\n          : ArrayInputStream(array),\n            PackedMessageReader(*this, options, scratchSpace) {}\n  }\n}"
  },
  {
    "function_name": "write",
    "container": "Uncompressed",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-common.h",
    "lines": "77-79",
    "snippet": "static inline void write(kj::OutputStream& output, MessageBuilder& builder) {\n    writeMessage(output, builder);\n  }",
    "includes": [
      "#include <thread>",
      "#include <capnp/serialize-snappy.h>",
      "#include <kj/debug.h>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/serialize.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "writeMessage",
          "args": [
            "output",
            "builder"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "writeMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-async.h",
          "lines": "58-60",
          "snippet": "inline kj::Promise<void> writeMessage(kj::AsyncOutputStream& output, MessageBuilder& builder) {\n  return writeMessage(output, builder.getSegmentsForOutput());\n}",
          "includes": [
            "#include \"message.h\"",
            "#include <kj/async-io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"message.h\"\n#include <kj/async-io.h>\n\ninline kj::Promise<void> writeMessage(kj::AsyncOutputStream& output, MessageBuilder& builder) {\n  return writeMessage(output, builder.getSegmentsForOutput());\n}"
        }
      }
    ],
    "contextual_snippet": "#include <thread>\n#include <capnp/serialize-snappy.h>\n#include <kj/debug.h>\n#include <capnp/serialize-packed.h>\n#include <capnp/serialize.h>\n#include \"common.h\"\n\nUncompressed {\n  static inline void write(kj::OutputStream& output, MessageBuilder& builder) {\n      writeMessage(output, builder);\n    }\n}"
  },
  {
    "function_name": "ArrayMessageReader",
    "container": "Uncompressed::ArrayMessageReader",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-common.h",
    "lines": "69-74",
    "snippet": "ArrayMessageReader(kj::ArrayPtr<const byte> array,\n                       ReaderOptions options = ReaderOptions(),\n                       kj::ArrayPtr<word> scratchSpace = nullptr)\n      : FlatArrayMessageReader(kj::arrayPtr(\n          reinterpret_cast<const word*>(array.begin()),\n          reinterpret_cast<const word*>(array.end())), options) {}",
    "includes": [
      "#include <thread>",
      "#include <capnp/serialize-snappy.h>",
      "#include <kj/debug.h>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/serialize.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::arrayPtr",
          "args": [
            "reinterpret_cast<const word*>(array.begin())",
            "reinterpret_cast<const word*>(array.end())"
          ],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "arrayPtr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "1194-1197",
          "snippet": "inline constexpr ArrayPtr<T> arrayPtr(T* begin, T* end) {\n  // Use this function to construct ArrayPtrs without writing out the type name.\n  return ArrayPtr<T>(begin, end);\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\ninline constexpr ArrayPtr<T> arrayPtr(T* begin, T* end) {\n  // Use this function to construct ArrayPtrs without writing out the type name.\n  return ArrayPtr<T>(begin, end);\n}"
        }
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<const word*>",
          "args": [
            "array.end()"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "array.end",
          "args": [],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "551-551",
          "snippet": "inline Iterator end() { return Iterator(this, size()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Iterator end() { return Iterator(this, size()); }"
        }
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<const word*>",
          "args": [
            "array.begin()"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "array.begin",
          "args": [],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "550-550",
          "snippet": "inline Iterator begin() { return Iterator(this, 0); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Iterator begin() { return Iterator(this, 0); }"
        }
      },
      {
        "call_info": {
          "callee": "ReaderOptions",
          "args": [],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <thread>\n#include <capnp/serialize-snappy.h>\n#include <kj/debug.h>\n#include <capnp/serialize-packed.h>\n#include <capnp/serialize.h>\n#include \"common.h\"\n\nUncompressed {\n  ArrayMessageReader {\n    ArrayMessageReader(kj::ArrayPtr<const byte> array,\n                           ReaderOptions options = ReaderOptions(),\n                           kj::ArrayPtr<word> scratchSpace = nullptr)\n          : FlatArrayMessageReader(kj::arrayPtr(\n              reinterpret_cast<const word*>(array.begin()),\n              reinterpret_cast<const word*>(array.end())), options) {}\n  }\n}"
  },
  {
    "function_name": "write",
    "container": "CountingOutputStream",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-common.h",
    "lines": "53-58",
    "snippet": "void write(kj::ArrayPtr<const kj::ArrayPtr<const byte>> pieces) override {\n    FdOutputStream::write(pieces);\n    for (auto& piece: pieces) {\n      throughput += piece.size();\n    }\n  }",
    "includes": [
      "#include <thread>",
      "#include <capnp/serialize-snappy.h>",
      "#include <kj/debug.h>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/serialize.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "piece.size",
          "args": [],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "599-599",
          "snippet": "inline uint size() { return _builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline uint size() { return _builder.size() / ELEMENTS; }"
        }
      }
    ],
    "contextual_snippet": "#include <thread>\n#include <capnp/serialize-snappy.h>\n#include <kj/debug.h>\n#include <capnp/serialize-packed.h>\n#include <capnp/serialize.h>\n#include \"common.h\"\n\nCountingOutputStream {\n  void write(kj::ArrayPtr<const kj::ArrayPtr<const byte>> pieces) override {\n      FdOutputStream::write(pieces);\n      for (auto& piece: pieces) {\n        throughput += piece.size();\n      }\n    }\n}"
  },
  {
    "function_name": "write",
    "container": "CountingOutputStream",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-common.h",
    "lines": "48-51",
    "snippet": "void write(const void* buffer, size_t size) override {\n    FdOutputStream::write(buffer, size);\n    throughput += size;\n  }",
    "includes": [
      "#include <thread>",
      "#include <capnp/serialize-snappy.h>",
      "#include <kj/debug.h>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/serialize.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <thread>\n#include <capnp/serialize-snappy.h>\n#include <kj/debug.h>\n#include <capnp/serialize-packed.h>\n#include <capnp/serialize.h>\n#include \"common.h\"\n\nCountingOutputStream {\n  void write(const void* buffer, size_t size) override {\n      FdOutputStream::write(buffer, size);\n      throughput += size;\n    }\n}"
  },
  {
    "function_name": "CountingOutputStream",
    "container": "CountingOutputStream",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/capnproto-common.h",
    "lines": "44-44",
    "snippet": "CountingOutputStream(int fd): FdOutputStream(fd), throughput(0) {}",
    "includes": [
      "#include <thread>",
      "#include <capnp/serialize-snappy.h>",
      "#include <kj/debug.h>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/serialize.h>",
      "#include \"common.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <thread>\n#include <capnp/serialize-snappy.h>\n#include <kj/debug.h>\n#include <capnp/serialize-packed.h>\n#include <capnp/serialize.h>\n#include \"common.h\"\n\nCountingOutputStream {\n  CountingOutputStream(int fd): FdOutputStream(fd), throughput(0) {}\n}"
  }
]