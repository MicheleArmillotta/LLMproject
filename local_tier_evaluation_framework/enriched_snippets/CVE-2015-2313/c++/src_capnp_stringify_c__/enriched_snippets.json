[
  {
    "function_name": "enumString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
    "lines": "288-295",
    "snippet": "kj::String enumString(uint16_t value, const RawBrandedSchema& schema) {\n  auto enumerants = Schema(&schema).asEnum().getEnumerants();\n  if (value < enumerants.size()) {\n    return kj::heapString(enumerants[value].getProto().getName());\n  } else {\n    return kj::str(value);\n  }\n}",
    "includes": [
      "#include <kj/vector.h>",
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "value"
          ],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "341-341",
          "snippet": "inline String str(String&& s) { return mv(s); }",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\ninline String str(String&& s) { return mv(s); }"
        }
      },
      {
        "call_info": {
          "callee": "kj::heapString",
          "args": [
            "enumerants[value].getProto().getName()"
          ],
          "line": 291
        },
        "resolved": true,
        "details": {
          "function_name": "heapString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.c++",
          "lines": "36-40",
          "snippet": "String heapString(size_t size) {\n  char* buffer = _::HeapArrayDisposer::allocate<char>(size + 1);\n  buffer[size] = '\\0';\n  return String(buffer, size, _::HeapArrayDisposer::instance);\n}",
          "includes": [
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <float.h>",
            "#include <stdio.h>",
            "#include \"debug.h\"",
            "#include \"string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdlib.h>\n#include <errno.h>\n#include <float.h>\n#include <stdio.h>\n#include \"debug.h\"\n#include \"string.h\"\n\nString heapString(size_t size) {\n  char* buffer = _::HeapArrayDisposer::allocate<char>(size + 1);\n  buffer[size] = '\\0';\n  return String(buffer, size, _::HeapArrayDisposer::instance);\n}"
        }
      },
      {
        "call_info": {
          "callee": "enumerants[value].getProto",
          "args": [],
          "line": 291
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      },
      {
        "call_info": {
          "callee": "enumerants.size",
          "args": [],
          "line": 290
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "599-599",
          "snippet": "inline uint size() { return _builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline uint size() { return _builder.size() / ELEMENTS; }"
        }
      },
      {
        "call_info": {
          "callee": "Schema",
          "args": [],
          "line": 289
        },
        "resolved": true,
        "details": {
          "function_name": "ensureInitialized",
          "container": "RawSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "221-228",
          "snippet": "inline void ensureInitialized() const {\n    // Lazy initialization support.  Invoke to ensure that initialization has taken place.  This\n    // is required in particular when traversing the dependency list.  RawSchemas for compiled-in\n    // types are always initialized; only dynamically-loaded schemas may be lazy.\n\n    const Initializer* i = __atomic_load_n(&lazyInitializer, __ATOMIC_ACQUIRE);\n    if (i != nullptr) i->init(this);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nRawSchema {\n  inline void ensureInitialized() const {\n      // Lazy initialization support.  Invoke to ensure that initialization has taken place.  This\n      // is required in particular when traversing the dependency list.  RawSchemas for compiled-in\n      // types are always initialized; only dynamically-loaded schemas may be lazy.\n  \n      const Initializer* i = __atomic_load_n(&lazyInitializer, __ATOMIC_ACQUIRE);\n      if (i != nullptr) i->init(this);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Schema",
          "args": [
            "&schema"
          ],
          "line": 289
        },
        "resolved": true,
        "details": {
          "function_name": "structSizeFromSchema",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "98-103",
          "snippet": "inline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\ninline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nkj::String enumString(uint16_t value, const RawBrandedSchema& schema) {\n  auto enumerants = Schema(&schema).asEnum().getEnumerants();\n  if (value < enumerants.size()) {\n    return kj::heapString(enumerants[value].getProto().getName());\n  } else {\n    return kj::str(value);\n  }\n}"
  },
  {
    "function_name": "structString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
    "lines": "284-286",
    "snippet": "kj::StringTree structString(StructReader reader, const RawBrandedSchema& schema) {\n  return stringify(DynamicStruct::Reader(Schema(&schema).asStruct(), reader));\n}",
    "includes": [
      "#include <kj/vector.h>",
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "stringify",
          "args": [
            "DynamicStruct::Reader(Schema(&schema).asStruct(), reader)"
          ],
          "line": 285
        },
        "resolved": true,
        "details": {
          "function_name": "stringify",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
          "lines": "257-259",
          "snippet": "kj::StringTree stringify(DynamicValue::Reader value) {\n  return print(value, schema::Type::STRUCT, Indent(false), BARE);\n}",
          "includes": [
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nkj::StringTree stringify(DynamicValue::Reader value) {\n  return print(value, schema::Type::STRUCT, Indent(false), BARE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "DynamicStruct::Reader",
          "args": [
            "Schema(&schema).asStruct()",
            "reader"
          ],
          "line": 285
        },
        "resolved": true,
        "details": {
          "function_name": "Reader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/blob.h",
          "lines": "80-80",
          "snippet": "inline Reader(const char* value, size_t size): StringPtr(value, size) {}",
          "includes": [
            "#include <string.h>",
            "#include \"common.h\"",
            "#include <kj/string.h>",
            "#include <kj/common.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"common.h\"\n#include <kj/string.h>\n#include <kj/common.h>\n\ninline Reader(const char* value, size_t size): StringPtr(value, size) {}"
        }
      },
      {
        "call_info": {
          "callee": "Schema",
          "args": [],
          "line": 285
        },
        "resolved": true,
        "details": {
          "function_name": "ensureInitialized",
          "container": "RawSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "221-228",
          "snippet": "inline void ensureInitialized() const {\n    // Lazy initialization support.  Invoke to ensure that initialization has taken place.  This\n    // is required in particular when traversing the dependency list.  RawSchemas for compiled-in\n    // types are always initialized; only dynamically-loaded schemas may be lazy.\n\n    const Initializer* i = __atomic_load_n(&lazyInitializer, __ATOMIC_ACQUIRE);\n    if (i != nullptr) i->init(this);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nRawSchema {\n  inline void ensureInitialized() const {\n      // Lazy initialization support.  Invoke to ensure that initialization has taken place.  This\n      // is required in particular when traversing the dependency list.  RawSchemas for compiled-in\n      // types are always initialized; only dynamically-loaded schemas may be lazy.\n  \n      const Initializer* i = __atomic_load_n(&lazyInitializer, __ATOMIC_ACQUIRE);\n      if (i != nullptr) i->init(this);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Schema",
          "args": [
            "&schema"
          ],
          "line": 285
        },
        "resolved": true,
        "details": {
          "function_name": "structSizeFromSchema",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "98-103",
          "snippet": "inline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\ninline _::StructSize structSizeFromSchema(StructSchema schema) {\n  auto node = schema.getProto().getStruct();\n  return _::StructSize(\n      node.getDataWordCount() * WORDS,\n      node.getPointerCount() * POINTERS);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nkj::StringTree structString(StructReader reader, const RawBrandedSchema& schema) {\n  return stringify(DynamicStruct::Reader(Schema(&schema).asStruct(), reader));\n}"
  },
  {
    "function_name": "KJ_STRINGIFY",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
    "lines": "280-280",
    "snippet": "kj::StringTree KJ_STRINGIFY(const DynamicList::Builder& value) { return stringify(value.asReader()); }",
    "includes": [
      "#include <kj/vector.h>",
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "stringify",
          "args": [
            "value.asReader()"
          ],
          "line": 280
        },
        "resolved": true,
        "details": {
          "function_name": "stringify",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
          "lines": "257-259",
          "snippet": "kj::StringTree stringify(DynamicValue::Reader value) {\n  return print(value, schema::Type::STRUCT, Indent(false), BARE);\n}",
          "includes": [
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nkj::StringTree stringify(DynamicValue::Reader value) {\n  return print(value, schema::Type::STRUCT, Indent(false), BARE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "value.asReader",
          "args": [],
          "line": 280
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nkj::StringTree KJ_STRINGIFY(const DynamicList::Builder& value) { return stringify(value.asReader()); }"
  },
  {
    "function_name": "KJ_STRINGIFY",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
    "lines": "279-279",
    "snippet": "kj::StringTree KJ_STRINGIFY(const DynamicList::Reader& value) { return stringify(value); }",
    "includes": [
      "#include <kj/vector.h>",
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "stringify",
          "args": [
            "value"
          ],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "stringify",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
          "lines": "257-259",
          "snippet": "kj::StringTree stringify(DynamicValue::Reader value) {\n  return print(value, schema::Type::STRUCT, Indent(false), BARE);\n}",
          "includes": [
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nkj::StringTree stringify(DynamicValue::Reader value) {\n  return print(value, schema::Type::STRUCT, Indent(false), BARE);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nkj::StringTree KJ_STRINGIFY(const DynamicList::Reader& value) { return stringify(value); }"
  },
  {
    "function_name": "KJ_STRINGIFY",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
    "lines": "278-278",
    "snippet": "kj::StringTree KJ_STRINGIFY(const DynamicStruct::Builder& value) { return stringify(value.asReader()); }",
    "includes": [
      "#include <kj/vector.h>",
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "stringify",
          "args": [
            "value.asReader()"
          ],
          "line": 278
        },
        "resolved": true,
        "details": {
          "function_name": "stringify",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
          "lines": "257-259",
          "snippet": "kj::StringTree stringify(DynamicValue::Reader value) {\n  return print(value, schema::Type::STRUCT, Indent(false), BARE);\n}",
          "includes": [
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nkj::StringTree stringify(DynamicValue::Reader value) {\n  return print(value, schema::Type::STRUCT, Indent(false), BARE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "value.asReader",
          "args": [],
          "line": 278
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nkj::StringTree KJ_STRINGIFY(const DynamicStruct::Builder& value) { return stringify(value.asReader()); }"
  },
  {
    "function_name": "KJ_STRINGIFY",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
    "lines": "277-277",
    "snippet": "kj::StringTree KJ_STRINGIFY(const DynamicStruct::Reader& value) { return stringify(value); }",
    "includes": [
      "#include <kj/vector.h>",
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "stringify",
          "args": [
            "value"
          ],
          "line": 277
        },
        "resolved": true,
        "details": {
          "function_name": "stringify",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
          "lines": "257-259",
          "snippet": "kj::StringTree stringify(DynamicValue::Reader value) {\n  return print(value, schema::Type::STRUCT, Indent(false), BARE);\n}",
          "includes": [
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nkj::StringTree stringify(DynamicValue::Reader value) {\n  return print(value, schema::Type::STRUCT, Indent(false), BARE);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nkj::StringTree KJ_STRINGIFY(const DynamicStruct::Reader& value) { return stringify(value); }"
  },
  {
    "function_name": "KJ_STRINGIFY",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
    "lines": "276-276",
    "snippet": "kj::StringTree KJ_STRINGIFY(DynamicEnum value) { return stringify(value); }",
    "includes": [
      "#include <kj/vector.h>",
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "stringify",
          "args": [
            "value"
          ],
          "line": 276
        },
        "resolved": true,
        "details": {
          "function_name": "stringify",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
          "lines": "257-259",
          "snippet": "kj::StringTree stringify(DynamicValue::Reader value) {\n  return print(value, schema::Type::STRUCT, Indent(false), BARE);\n}",
          "includes": [
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nkj::StringTree stringify(DynamicValue::Reader value) {\n  return print(value, schema::Type::STRUCT, Indent(false), BARE);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nkj::StringTree KJ_STRINGIFY(DynamicEnum value) { return stringify(value); }"
  },
  {
    "function_name": "KJ_STRINGIFY",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
    "lines": "275-275",
    "snippet": "kj::StringTree KJ_STRINGIFY(const DynamicValue::Builder& value) { return stringify(value.asReader()); }",
    "includes": [
      "#include <kj/vector.h>",
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "stringify",
          "args": [
            "value.asReader()"
          ],
          "line": 275
        },
        "resolved": true,
        "details": {
          "function_name": "stringify",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
          "lines": "257-259",
          "snippet": "kj::StringTree stringify(DynamicValue::Reader value) {\n  return print(value, schema::Type::STRUCT, Indent(false), BARE);\n}",
          "includes": [
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nkj::StringTree stringify(DynamicValue::Reader value) {\n  return print(value, schema::Type::STRUCT, Indent(false), BARE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "value.asReader",
          "args": [],
          "line": 275
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nkj::StringTree KJ_STRINGIFY(const DynamicValue::Builder& value) { return stringify(value.asReader()); }"
  },
  {
    "function_name": "KJ_STRINGIFY",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
    "lines": "274-274",
    "snippet": "kj::StringTree KJ_STRINGIFY(const DynamicValue::Reader& value) { return stringify(value); }",
    "includes": [
      "#include <kj/vector.h>",
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "stringify",
          "args": [
            "value"
          ],
          "line": 274
        },
        "resolved": true,
        "details": {
          "function_name": "stringify",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
          "lines": "257-259",
          "snippet": "kj::StringTree stringify(DynamicValue::Reader value) {\n  return print(value, schema::Type::STRUCT, Indent(false), BARE);\n}",
          "includes": [
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nkj::StringTree stringify(DynamicValue::Reader value) {\n  return print(value, schema::Type::STRUCT, Indent(false), BARE);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nkj::StringTree KJ_STRINGIFY(const DynamicValue::Reader& value) { return stringify(value); }"
  },
  {
    "function_name": "prettyPrint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
    "lines": "272-272",
    "snippet": "kj::StringTree prettyPrint(DynamicList::Builder value) { return prettyPrint(value.asReader()); }",
    "includes": [
      "#include <kj/vector.h>",
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "value.asReader",
          "args": [],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nkj::StringTree prettyPrint(DynamicList::Builder value) { return prettyPrint(value.asReader()); }"
  },
  {
    "function_name": "prettyPrint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
    "lines": "271-271",
    "snippet": "kj::StringTree prettyPrint(DynamicStruct::Builder value) { return prettyPrint(value.asReader()); }",
    "includes": [
      "#include <kj/vector.h>",
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "value.asReader",
          "args": [],
          "line": 271
        },
        "resolved": true,
        "details": {
          "function_name": "asReader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "607-607",
          "snippet": "inline Reader asReader() const { return Reader(_builder.asReader()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Reader asReader() const { return Reader(_builder.asReader()); }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nkj::StringTree prettyPrint(DynamicStruct::Builder value) { return prettyPrint(value.asReader()); }"
  },
  {
    "function_name": "prettyPrint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
    "lines": "267-269",
    "snippet": "kj::StringTree prettyPrint(DynamicList::Reader value) {\n  return print(value, schema::Type::LIST, Indent(true), BARE);\n}",
    "includes": [
      "#include <kj/vector.h>",
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print",
          "args": [
            "value",
            "schema::Type::LIST",
            "Indent(true)",
            "BARE"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Indent",
          "args": [
            "true"
          ],
          "line": 268
        },
        "resolved": true,
        "details": {
          "function_name": "canPrintInline",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
          "lines": "83-96",
          "snippet": "static bool canPrintInline(const kj::StringTree& text) {\n    if (text.size() > maxInlineValueSize) {\n      return false;\n    }\n\n    char flat[maxInlineValueSize + 1];\n    text.flattenTo(flat);\n    flat[text.size()] = '\\0';\n    if (strchr(flat, '\\n') != nullptr) {\n      return false;\n    }\n\n    return true;\n  }",
          "includes": [
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nIndent {\n  static bool canPrintInline(const kj::StringTree& text) {\n      if (text.size() > maxInlineValueSize) {\n        return false;\n      }\n  \n      char flat[maxInlineValueSize + 1];\n      text.flattenTo(flat);\n      flat[text.size()] = '\\0';\n      if (strchr(flat, '\\n') != nullptr) {\n        return false;\n      }\n  \n      return true;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nkj::StringTree prettyPrint(DynamicList::Reader value) {\n  return print(value, schema::Type::LIST, Indent(true), BARE);\n}"
  },
  {
    "function_name": "prettyPrint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
    "lines": "263-265",
    "snippet": "kj::StringTree prettyPrint(DynamicStruct::Reader value) {\n  return print(value, schema::Type::STRUCT, Indent(true), BARE);\n}",
    "includes": [
      "#include <kj/vector.h>",
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print",
          "args": [
            "value",
            "schema::Type::STRUCT",
            "Indent(true)",
            "BARE"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Indent",
          "args": [
            "true"
          ],
          "line": 264
        },
        "resolved": true,
        "details": {
          "function_name": "canPrintInline",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
          "lines": "83-96",
          "snippet": "static bool canPrintInline(const kj::StringTree& text) {\n    if (text.size() > maxInlineValueSize) {\n      return false;\n    }\n\n    char flat[maxInlineValueSize + 1];\n    text.flattenTo(flat);\n    flat[text.size()] = '\\0';\n    if (strchr(flat, '\\n') != nullptr) {\n      return false;\n    }\n\n    return true;\n  }",
          "includes": [
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nIndent {\n  static bool canPrintInline(const kj::StringTree& text) {\n      if (text.size() > maxInlineValueSize) {\n        return false;\n      }\n  \n      char flat[maxInlineValueSize + 1];\n      text.flattenTo(flat);\n      flat[text.size()] = '\\0';\n      if (strchr(flat, '\\n') != nullptr) {\n        return false;\n      }\n  \n      return true;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nkj::StringTree prettyPrint(DynamicStruct::Reader value) {\n  return print(value, schema::Type::STRUCT, Indent(true), BARE);\n}"
  },
  {
    "function_name": "stringify",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
    "lines": "257-259",
    "snippet": "kj::StringTree stringify(DynamicValue::Reader value) {\n  return print(value, schema::Type::STRUCT, Indent(false), BARE);\n}",
    "includes": [
      "#include <kj/vector.h>",
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "print",
          "args": [
            "value",
            "schema::Type::STRUCT",
            "Indent(false)",
            "BARE"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Indent",
          "args": [
            "false"
          ],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "canPrintInline",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
          "lines": "83-96",
          "snippet": "static bool canPrintInline(const kj::StringTree& text) {\n    if (text.size() > maxInlineValueSize) {\n      return false;\n    }\n\n    char flat[maxInlineValueSize + 1];\n    text.flattenTo(flat);\n    flat[text.size()] = '\\0';\n    if (strchr(flat, '\\n') != nullptr) {\n      return false;\n    }\n\n    return true;\n  }",
          "includes": [
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nIndent {\n  static bool canPrintInline(const kj::StringTree& text) {\n      if (text.size() > maxInlineValueSize) {\n        return false;\n      }\n  \n      char flat[maxInlineValueSize + 1];\n      text.flattenTo(flat);\n      flat[text.size()] = '\\0';\n      if (strchr(flat, '\\n') != nullptr) {\n        return false;\n      }\n  \n      return true;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nkj::StringTree stringify(DynamicValue::Reader value) {\n  return print(value, schema::Type::STRUCT, Indent(false), BARE);\n}"
  },
  {
    "function_name": "print",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
    "lines": "122-252",
    "snippet": "static kj::StringTree print(const DynamicValue::Reader& value,\n                            schema::Type::Which which, Indent indent,\n                            PrintMode mode) {\n  switch (value.getType()) {\n    case DynamicValue::UNKNOWN:\n      return kj::strTree(\"?\");\n    case DynamicValue::VOID:\n      return kj::strTree(\"void\");\n    case DynamicValue::BOOL:\n      return kj::strTree(value.as<bool>() ? \"true\" : \"false\");\n    case DynamicValue::INT:\n      return kj::strTree(value.as<int64_t>());\n    case DynamicValue::UINT:\n      return kj::strTree(value.as<uint64_t>());\n    case DynamicValue::FLOAT:\n      if (which == schema::Type::FLOAT32) {\n        return kj::strTree(value.as<float>());\n      } else {\n        return kj::strTree(value.as<double>());\n      }\n    case DynamicValue::TEXT:\n    case DynamicValue::DATA: {\n      // TODO(someday): Maybe data should be printed as binary literal.\n      kj::ArrayPtr<const char> chars;\n      if (value.getType() == DynamicValue::DATA) {\n        chars = value.as<Data>().asChars();\n      } else {\n        chars = value.as<Text>();\n      }\n\n      kj::Vector<char> escaped(chars.size());\n\n      for (char c: chars) {\n        switch (c) {\n          case '\\a': escaped.addAll(kj::StringPtr(\"\\\\a\")); break;\n          case '\\b': escaped.addAll(kj::StringPtr(\"\\\\b\")); break;\n          case '\\f': escaped.addAll(kj::StringPtr(\"\\\\f\")); break;\n          case '\\n': escaped.addAll(kj::StringPtr(\"\\\\n\")); break;\n          case '\\r': escaped.addAll(kj::StringPtr(\"\\\\r\")); break;\n          case '\\t': escaped.addAll(kj::StringPtr(\"\\\\t\")); break;\n          case '\\v': escaped.addAll(kj::StringPtr(\"\\\\v\")); break;\n          case '\\'': escaped.addAll(kj::StringPtr(\"\\\\\\'\")); break;\n          case '\\\"': escaped.addAll(kj::StringPtr(\"\\\\\\\"\")); break;\n          case '\\\\': escaped.addAll(kj::StringPtr(\"\\\\\\\\\")); break;\n          default:\n            if (c < 0x20) {\n              escaped.add('\\\\');\n              escaped.add('x');\n              uint8_t c2 = c;\n              escaped.add(HEXDIGITS[c2 / 16]);\n              escaped.add(HEXDIGITS[c2 % 16]);\n            } else {\n              escaped.add(c);\n            }\n            break;\n        }\n      }\n      return kj::strTree('\"', escaped, '\"');\n    }\n    case DynamicValue::LIST: {\n      auto listValue = value.as<DynamicList>();\n      auto which = listValue.getSchema().whichElementType();\n      kj::Array<kj::StringTree> elements = KJ_MAP(element, listValue) {\n        return print(element, which, indent.next(), BARE);\n      };\n      return kj::strTree('[', indent.delimit(kj::mv(elements), mode, PrintKind::LIST), ']');\n    }\n    case DynamicValue::ENUM: {\n      auto enumValue = value.as<DynamicEnum>();\n      KJ_IF_MAYBE(enumerant, enumValue.getEnumerant()) {\n        return kj::strTree(enumerant->getProto().getName());\n      } else {\n        // Unknown enum value; output raw number.\n        return kj::strTree('(', enumValue.getRaw(), ')');\n      }\n      break;\n    }\n    case DynamicValue::STRUCT: {\n      auto structValue = value.as<DynamicStruct>();\n      auto unionFields = structValue.getSchema().getUnionFields();\n      auto nonUnionFields = structValue.getSchema().getNonUnionFields();\n\n      kj::Vector<kj::StringTree> printedFields(nonUnionFields.size() + (unionFields.size() != 0));\n\n      // We try to write the union field, if any, in proper order with the rest.\n      auto which = structValue.which();\n\n      kj::StringTree unionValue;\n      KJ_IF_MAYBE(field, which) {\n        // Even if the union field has its default value, if it is not the default field of the\n        // union then we have to print it anyway.\n        auto fieldProto = field->getProto();\n        if (fieldProto.getDiscriminantValue() != 0 || structValue.has(*field)) {\n          unionValue = kj::strTree(\n              fieldProto.getName(), \" = \",\n              print(structValue.get(*field), whichFieldType(*field), indent.next(), PREFIXED));\n        } else {\n          which = nullptr;\n        }\n      }\n\n      for (auto field: nonUnionFields) {\n        KJ_IF_MAYBE(unionField, which) {\n          if (unionField->getIndex() < field.getIndex()) {\n            printedFields.add(kj::mv(unionValue));\n            which = nullptr;\n          }\n        }\n        if (structValue.has(field)) {\n          printedFields.add(kj::strTree(\n              field.getProto().getName(), \" = \",\n              print(structValue.get(field), whichFieldType(field), indent.next(), PREFIXED)));\n        }\n      }\n      if (which != nullptr) {\n        // Union value is last.\n        printedFields.add(kj::mv(unionValue));\n      }\n\n      if (mode == PARENTHESIZED) {\n        return indent.delimit(printedFields.releaseAsArray(), mode, PrintKind::RECORD);\n      } else {\n        return kj::strTree(\n            '(', indent.delimit(printedFields.releaseAsArray(), mode, PrintKind::RECORD), ')');\n      }\n    }\n    case DynamicValue::CAPABILITY:\n      return kj::strTree(\"<external capability>\");\n    case DynamicValue::ANY_POINTER:\n      return kj::strTree(\"<opaque pointer>\");\n  }",
    "includes": [
      "#include <kj/vector.h>",
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"<opaque pointer>\""
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"<external capability>\""
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "'('",
            "indent.delimit(printedFields.releaseAsArray(), mode, PrintKind::RECORD)",
            "')'"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "indent.delimit",
          "args": [
            "printedFields.releaseAsArray()",
            "mode",
            "PrintKind::RECORD"
          ],
          "line": 245
        },
        "resolved": true,
        "details": {
          "function_name": "delimit",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
          "lines": "57-73",
          "snippet": "kj::StringTree delimit(kj::Array<kj::StringTree> items, PrintMode mode, PrintKind kind) {\n    if (amount == 0 || canPrintAllInline(items, kind)) {\n      return kj::StringTree(kj::mv(items), \", \");\n    } else {\n      char delim[amount * 2 + 3];\n      delim[0] = ',';\n      delim[1] = '\\n';\n      memset(delim + 2, ' ', amount * 2);\n      delim[amount * 2 + 2] = '\\0';\n\n      // If the outer value isn't being printed on its own line, we need to add a newline/indent\n      // before the first item, otherwise we only add a space on the assumption that it is preceded\n      // by an open bracket or parenthesis.\n      return kj::strTree(mode == BARE ? \" \" : delim + 1,\n          kj::StringTree(kj::mv(items), kj::StringPtr(delim, amount * 2 + 2)), ' ');\n    }\n  }",
          "includes": [
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nIndent {\n  kj::StringTree delimit(kj::Array<kj::StringTree> items, PrintMode mode, PrintKind kind) {\n      if (amount == 0 || canPrintAllInline(items, kind)) {\n        return kj::StringTree(kj::mv(items), \", \");\n      } else {\n        char delim[amount * 2 + 3];\n        delim[0] = ',';\n        delim[1] = '\\n';\n        memset(delim + 2, ' ', amount * 2);\n        delim[amount * 2 + 2] = '\\0';\n  \n        // If the outer value isn't being printed on its own line, we need to add a newline/indent\n        // before the first item, otherwise we only add a space on the assumption that it is preceded\n        // by an open bracket or parenthesis.\n        return kj::strTree(mode == BARE ? \" \" : delim + 1,\n            kj::StringTree(kj::mv(items), kj::StringPtr(delim, amount * 2 + 2)), ' ');\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "printedFields.releaseAsArray",
          "args": [],
          "line": 245
        },
        "resolved": true,
        "details": {
          "function_name": "releaseAsArray",
          "container": "Vector",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/vector.h",
          "lines": "66-72",
          "snippet": "inline Array<T> releaseAsArray() {\n    // TODO(perf):  Avoid a copy/move by allowing Array<T> to point to incomplete space?\n    if (!builder.isFull()) {\n      setCapacity(size());\n    }\n    return builder.finish();\n  }",
          "includes": [
            "#include \"array.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n\nVector {\n  inline Array<T> releaseAsArray() {\n      // TODO(perf):  Avoid a copy/move by allowing Array<T> to point to incomplete space?\n      if (!builder.isFull()) {\n        setCapacity(size());\n      }\n      return builder.finish();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "printedFields.add",
          "args": [
            "kj::mv(unionValue)"
          ],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "add",
          "container": "ReusableObjects::ObjectSizeCounter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/null-common.h",
          "lines": "86-88",
          "snippet": "void add(size_t wordCount) {\n      maxSize = std::max(wordCount, maxSize);\n    }",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nReusableObjects {\n  ObjectSizeCounter {\n    void add(size_t wordCount) {\n          maxSize = std::max(wordCount, maxSize);\n        }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "unionValue"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "field.getProto().getName()",
            "\" = \"",
            "print(structValue.get(field), whichFieldType(field), indent.next(), PREFIXED)"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print",
          "args": [
            "structValue.get(field)",
            "whichFieldType(field)",
            "indent.next()",
            "PREFIXED"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "indent.next",
          "args": [],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "next",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
          "lines": "53-55",
          "snippet": "Indent next() {\n    return Indent(amount == 0 ? 0 : amount + 1);\n  }",
          "includes": [
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nIndent {\n  Indent next() {\n      return Indent(amount == 0 ? 0 : amount + 1);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "whichFieldType",
          "args": [
            "field"
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "whichFieldType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
          "lines": "111-120",
          "snippet": "static schema::Type::Which whichFieldType(const StructSchema::Field& field) {\n  auto proto = field.getProto();\n  switch (proto.which()) {\n    case schema::Field::SLOT:\n      return proto.getSlot().getType().which();\n    case schema::Field::GROUP:\n      return schema::Type::STRUCT;\n  }\n  KJ_UNREACHABLE;\n}",
          "includes": [
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nstatic schema::Type::Which whichFieldType(const StructSchema::Field& field) {\n  auto proto = field.getProto();\n  switch (proto.which()) {\n    case schema::Field::SLOT:\n      return proto.getSlot().getType().which();\n    case schema::Field::GROUP:\n      return schema::Type::STRUCT;\n  }\n  KJ_UNREACHABLE;\n}"
        }
      },
      {
        "call_info": {
          "callee": "structValue.get",
          "args": [
            "field"
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "868-871",
          "snippet": "static inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }"
        }
      },
      {
        "call_info": {
          "callee": "field.getProto",
          "args": [],
          "line": 232
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      },
      {
        "call_info": {
          "callee": "structValue.has",
          "args": [
            "field"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "has",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "253-253",
          "snippet": "inline bool has(StructSchema::Field field) { return asReader().has(field); }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline bool has(StructSchema::Field field) { return asReader().has(field); }"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "unionValue"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getIndex",
          "args": [],
          "line": 225
        },
        "resolved": true,
        "details": {
          "function_name": "getIndex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "487-487",
          "snippet": "inline uint getIndex() const { return ordinal; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline uint getIndex() const { return ordinal; }"
        }
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "fieldProto.getName()",
            "\" = \"",
            "print(structValue.get(*field), whichFieldType(*field), indent.next(), PREFIXED)"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print",
          "args": [
            "structValue.get(*field)",
            "whichFieldType(*field)",
            "indent.next()",
            "PREFIXED"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fieldProto.getName",
          "args": [],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fieldProto.getDiscriminantValue",
          "args": [],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structValue.which",
          "args": [],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unionFields.size",
          "args": [],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "599-599",
          "snippet": "inline uint size() { return _builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline uint size() { return _builder.size() / ELEMENTS; }"
        }
      },
      {
        "call_info": {
          "callee": "structValue.getSchema",
          "args": [],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "getSchema",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "505-505",
          "snippet": "inline InterfaceSchema getSchema() const { return schema; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline InterfaceSchema getSchema() const { return schema; }"
        }
      },
      {
        "call_info": {
          "callee": "value.as<DynamicStruct>",
          "args": [],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "as",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "601-604",
          "snippet": "BuilderFor<T> as() {\n    // T must be List<U>.\n    return BuilderFor<T>(_builder);\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nBuilderFor<T> as() {\n    // T must be List<U>.\n    return BuilderFor<T>(_builder);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "return kj::strTree",
          "args": [
            "'('",
            "enumValue.getRaw()",
            "')'"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "enumValue.getRaw",
          "args": [],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "getRaw",
          "container": "DynamicEnum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "149-149",
          "snippet": "inline uint16_t getRaw() const { return value; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nDynamicEnum {\n  inline uint16_t getRaw() const { return value; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "enumerant->getProto().getName()"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_IF_MAYBE",
          "args": [
            "enumerant",
            "enumValue.getEnumerant()"
          ],
          "line": 191
        },
        "resolved": true,
        "details": {
          "function_name": "KJ_IF_MAYBE",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "2462-2464",
          "snippet": "KJ_IF_MAYBE(e, exception) {\n          fulfiller->get()->reject(kj::mv(*e));\n        }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nKJ_IF_MAYBE(e, exception) {\n          fulfiller->get()->reject(kj::mv(*e));\n        }"
        }
      },
      {
        "call_info": {
          "callee": "enumValue.getEnumerant",
          "args": [],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "'['",
            "indent.delimit(kj::mv(elements), mode, PrintKind::LIST)",
            "']'"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "elements"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print",
          "args": [
            "element",
            "which",
            "indent.next()",
            "BARE"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "element",
            "listValue"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "'\"'",
            "escaped",
            "'\"'"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "escaped.addAll",
          "args": [
            "kj::StringPtr(\"\\\\\\\\\")"
          ],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "addAll",
          "container": "ArrayBuilder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "357-359",
          "snippet": "void addAll(Container&& container) {\n    addAll(container.begin(), container.end());\n  }",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\nArrayBuilder {\n  void addAll(Container&& container) {\n      addAll(container.begin(), container.end());\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::StringPtr",
          "args": [
            "\"\\\\\\\\\""
          ],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "StringPtr",
          "container": "StringPtr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "116-116",
          "snippet": "inline StringPtr(ArrayPtr<const char> content): content(content) {}",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\nStringPtr {\n  inline StringPtr(ArrayPtr<const char> content): content(content) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "value.getType",
          "args": [],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "getType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "942-942",
          "snippet": "inline DynamicValue::Type getType() { return type; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline DynamicValue::Type getType() { return type; }"
        }
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "value.as<double>()"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "value.as<float>()"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "value.as<uint64_t>()"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "value.as<int64_t>()"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "value.as<bool>() ? \"true\" : \"false\""
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"void\""
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"?\""
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nstatic kj::StringTree print(const DynamicValue::Reader& value,\n                            schema::Type::Which which, Indent indent,\n                            PrintMode mode) {\n  switch (value.getType()) {\n    case DynamicValue::UNKNOWN:\n      return kj::strTree(\"?\");\n    case DynamicValue::VOID:\n      return kj::strTree(\"void\");\n    case DynamicValue::BOOL:\n      return kj::strTree(value.as<bool>() ? \"true\" : \"false\");\n    case DynamicValue::INT:\n      return kj::strTree(value.as<int64_t>());\n    case DynamicValue::UINT:\n      return kj::strTree(value.as<uint64_t>());\n    case DynamicValue::FLOAT:\n      if (which == schema::Type::FLOAT32) {\n        return kj::strTree(value.as<float>());\n      } else {\n        return kj::strTree(value.as<double>());\n      }\n    case DynamicValue::TEXT:\n    case DynamicValue::DATA: {\n      // TODO(someday): Maybe data should be printed as binary literal.\n      kj::ArrayPtr<const char> chars;\n      if (value.getType() == DynamicValue::DATA) {\n        chars = value.as<Data>().asChars();\n      } else {\n        chars = value.as<Text>();\n      }\n\n      kj::Vector<char> escaped(chars.size());\n\n      for (char c: chars) {\n        switch (c) {\n          case '\\a': escaped.addAll(kj::StringPtr(\"\\\\a\")); break;\n          case '\\b': escaped.addAll(kj::StringPtr(\"\\\\b\")); break;\n          case '\\f': escaped.addAll(kj::StringPtr(\"\\\\f\")); break;\n          case '\\n': escaped.addAll(kj::StringPtr(\"\\\\n\")); break;\n          case '\\r': escaped.addAll(kj::StringPtr(\"\\\\r\")); break;\n          case '\\t': escaped.addAll(kj::StringPtr(\"\\\\t\")); break;\n          case '\\v': escaped.addAll(kj::StringPtr(\"\\\\v\")); break;\n          case '\\'': escaped.addAll(kj::StringPtr(\"\\\\\\'\")); break;\n          case '\\\"': escaped.addAll(kj::StringPtr(\"\\\\\\\"\")); break;\n          case '\\\\': escaped.addAll(kj::StringPtr(\"\\\\\\\\\")); break;\n          default:\n            if (c < 0x20) {\n              escaped.add('\\\\');\n              escaped.add('x');\n              uint8_t c2 = c;\n              escaped.add(HEXDIGITS[c2 / 16]);\n              escaped.add(HEXDIGITS[c2 % 16]);\n            } else {\n              escaped.add(c);\n            }\n            break;\n        }\n      }\n      return kj::strTree('\"', escaped, '\"');\n    }\n    case DynamicValue::LIST: {\n      auto listValue = value.as<DynamicList>();\n      auto which = listValue.getSchema().whichElementType();\n      kj::Array<kj::StringTree> elements = KJ_MAP(element, listValue) {\n        return print(element, which, indent.next(), BARE);\n      };\n      return kj::strTree('[', indent.delimit(kj::mv(elements), mode, PrintKind::LIST), ']');\n    }\n    case DynamicValue::ENUM: {\n      auto enumValue = value.as<DynamicEnum>();\n      KJ_IF_MAYBE(enumerant, enumValue.getEnumerant()) {\n        return kj::strTree(enumerant->getProto().getName());\n      } else {\n        // Unknown enum value; output raw number.\n        return kj::strTree('(', enumValue.getRaw(), ')');\n      }\n      break;\n    }\n    case DynamicValue::STRUCT: {\n      auto structValue = value.as<DynamicStruct>();\n      auto unionFields = structValue.getSchema().getUnionFields();\n      auto nonUnionFields = structValue.getSchema().getNonUnionFields();\n\n      kj::Vector<kj::StringTree> printedFields(nonUnionFields.size() + (unionFields.size() != 0));\n\n      // We try to write the union field, if any, in proper order with the rest.\n      auto which = structValue.which();\n\n      kj::StringTree unionValue;\n      KJ_IF_MAYBE(field, which) {\n        // Even if the union field has its default value, if it is not the default field of the\n        // union then we have to print it anyway.\n        auto fieldProto = field->getProto();\n        if (fieldProto.getDiscriminantValue() != 0 || structValue.has(*field)) {\n          unionValue = kj::strTree(\n              fieldProto.getName(), \" = \",\n              print(structValue.get(*field), whichFieldType(*field), indent.next(), PREFIXED));\n        } else {\n          which = nullptr;\n        }\n      }\n\n      for (auto field: nonUnionFields) {\n        KJ_IF_MAYBE(unionField, which) {\n          if (unionField->getIndex() < field.getIndex()) {\n            printedFields.add(kj::mv(unionValue));\n            which = nullptr;\n          }\n        }\n        if (structValue.has(field)) {\n          printedFields.add(kj::strTree(\n              field.getProto().getName(), \" = \",\n              print(structValue.get(field), whichFieldType(field), indent.next(), PREFIXED)));\n        }\n      }\n      if (which != nullptr) {\n        // Union value is last.\n        printedFields.add(kj::mv(unionValue));\n      }\n\n      if (mode == PARENTHESIZED) {\n        return indent.delimit(printedFields.releaseAsArray(), mode, PrintKind::RECORD);\n      } else {\n        return kj::strTree(\n            '(', indent.delimit(printedFields.releaseAsArray(), mode, PrintKind::RECORD), ')');\n      }\n    }\n    case DynamicValue::CAPABILITY:\n      return kj::strTree(\"<external capability>\");\n    case DynamicValue::ANY_POINTER:\n      return kj::strTree(\"<opaque pointer>\");\n  }"
  },
  {
    "function_name": "whichFieldType",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
    "lines": "111-120",
    "snippet": "static schema::Type::Which whichFieldType(const StructSchema::Field& field) {\n  auto proto = field.getProto();\n  switch (proto.which()) {\n    case schema::Field::SLOT:\n      return proto.getSlot().getType().which();\n    case schema::Field::GROUP:\n      return schema::Type::STRUCT;\n  }\n  KJ_UNREACHABLE;\n}",
    "includes": [
      "#include <kj/vector.h>",
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "proto.getSlot",
          "args": [],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.getSlot",
          "args": [],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.getSlot",
          "args": [],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.which",
          "args": [],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getProto",
          "args": [],
          "line": 112
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      }
    ],
    "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nstatic schema::Type::Which whichFieldType(const StructSchema::Field& field) {\n  auto proto = field.getProto();\n  switch (proto.which()) {\n    case schema::Field::SLOT:\n      return proto.getSlot().getType().which();\n    case schema::Field::GROUP:\n      return schema::Type::STRUCT;\n  }\n  KJ_UNREACHABLE;\n}"
  },
  {
    "function_name": "canPrintAllInline",
    "container": "Indent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
    "lines": "98-108",
    "snippet": "static bool canPrintAllInline(const kj::Array<kj::StringTree>& items, PrintKind kind) {\n    size_t totalSize = 0;\n    for (auto& item: items) {\n      if (!canPrintInline(item)) return false;\n      if (kind == PrintKind::RECORD) {\n        totalSize += item.size();\n        if (totalSize > maxInlineRecordSize) return false;\n      }\n    }\n    return true;\n  }",
    "includes": [
      "#include <kj/vector.h>",
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "item.size",
          "args": [],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "599-599",
          "snippet": "inline uint size() { return _builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline uint size() { return _builder.size() / ELEMENTS; }"
        }
      },
      {
        "call_info": {
          "callee": "canPrintInline",
          "args": [
            "item"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "canPrintInline",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
          "lines": "83-96",
          "snippet": "static bool canPrintInline(const kj::StringTree& text) {\n    if (text.size() > maxInlineValueSize) {\n      return false;\n    }\n\n    char flat[maxInlineValueSize + 1];\n    text.flattenTo(flat);\n    flat[text.size()] = '\\0';\n    if (strchr(flat, '\\n') != nullptr) {\n      return false;\n    }\n\n    return true;\n  }",
          "includes": [
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nIndent {\n  static bool canPrintInline(const kj::StringTree& text) {\n      if (text.size() > maxInlineValueSize) {\n        return false;\n      }\n  \n      char flat[maxInlineValueSize + 1];\n      text.flattenTo(flat);\n      flat[text.size()] = '\\0';\n      if (strchr(flat, '\\n') != nullptr) {\n        return false;\n      }\n  \n      return true;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nIndent {\n  static bool canPrintAllInline(const kj::Array<kj::StringTree>& items, PrintKind kind) {\n      size_t totalSize = 0;\n      for (auto& item: items) {\n        if (!canPrintInline(item)) return false;\n        if (kind == PrintKind::RECORD) {\n          totalSize += item.size();\n          if (totalSize > maxInlineRecordSize) return false;\n        }\n      }\n      return true;\n    }\n}"
  },
  {
    "function_name": "canPrintInline",
    "container": "Indent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
    "lines": "83-96",
    "snippet": "static bool canPrintInline(const kj::StringTree& text) {\n    if (text.size() > maxInlineValueSize) {\n      return false;\n    }\n\n    char flat[maxInlineValueSize + 1];\n    text.flattenTo(flat);\n    flat[text.size()] = '\\0';\n    if (strchr(flat, '\\n') != nullptr) {\n      return false;\n    }\n\n    return true;\n  }",
    "includes": [
      "#include <kj/vector.h>",
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "flat",
            "'\\n'"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "text.size",
          "args": [],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "599-599",
          "snippet": "inline uint size() { return _builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline uint size() { return _builder.size() / ELEMENTS; }"
        }
      },
      {
        "call_info": {
          "callee": "text.flattenTo",
          "args": [
            "flat"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nIndent {\n  static bool canPrintInline(const kj::StringTree& text) {\n      if (text.size() > maxInlineValueSize) {\n        return false;\n      }\n  \n      char flat[maxInlineValueSize + 1];\n      text.flattenTo(flat);\n      flat[text.size()] = '\\0';\n      if (strchr(flat, '\\n') != nullptr) {\n        return false;\n      }\n  \n      return true;\n    }\n}"
  },
  {
    "function_name": "Indent",
    "container": "Indent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
    "lines": "78-78",
    "snippet": "explicit Indent(uint amount): amount(amount) {}",
    "includes": [
      "#include <kj/vector.h>",
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nIndent {\n  explicit Indent(uint amount): amount(amount) {}\n}"
  },
  {
    "function_name": "delimit",
    "container": "Indent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
    "lines": "57-73",
    "snippet": "kj::StringTree delimit(kj::Array<kj::StringTree> items, PrintMode mode, PrintKind kind) {\n    if (amount == 0 || canPrintAllInline(items, kind)) {\n      return kj::StringTree(kj::mv(items), \", \");\n    } else {\n      char delim[amount * 2 + 3];\n      delim[0] = ',';\n      delim[1] = '\\n';\n      memset(delim + 2, ' ', amount * 2);\n      delim[amount * 2 + 2] = '\\0';\n\n      // If the outer value isn't being printed on its own line, we need to add a newline/indent\n      // before the first item, otherwise we only add a space on the assumption that it is preceded\n      // by an open bracket or parenthesis.\n      return kj::strTree(mode == BARE ? \" \" : delim + 1,\n          kj::StringTree(kj::mv(items), kj::StringPtr(delim, amount * 2 + 2)), ' ');\n    }\n  }",
    "includes": [
      "#include <kj/vector.h>",
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "mode == BARE ? \" \" : delim + 1",
            "kj::StringTree(kj::mv(items), kj::StringPtr(delim, amount * 2 + 2))",
            "' '"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::StringTree",
          "args": [
            "kj::mv(items)",
            "kj::StringPtr(delim, amount * 2 + 2)"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::StringPtr",
          "args": [
            "delim",
            "amount * 2 + 2"
          ],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "StringPtr",
          "container": "StringPtr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "61-61",
          "snippet": "inline StringPtr(const char* begin, const char* end): StringPtr(begin, end - begin) {}",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\nStringPtr {\n  inline StringPtr(const char* begin, const char* end): StringPtr(begin, end - begin) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "items"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "delim + 2",
            "' '",
            "amount * 2"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::StringTree",
          "args": [
            "kj::mv(items)",
            "\", \""
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "items"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "canPrintAllInline",
          "args": [
            "items",
            "kind"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "canPrintAllInline",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
          "lines": "98-108",
          "snippet": "static bool canPrintAllInline(const kj::Array<kj::StringTree>& items, PrintKind kind) {\n    size_t totalSize = 0;\n    for (auto& item: items) {\n      if (!canPrintInline(item)) return false;\n      if (kind == PrintKind::RECORD) {\n        totalSize += item.size();\n        if (totalSize > maxInlineRecordSize) return false;\n      }\n    }\n    return true;\n  }",
          "includes": [
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nIndent {\n  static bool canPrintAllInline(const kj::Array<kj::StringTree>& items, PrintKind kind) {\n      size_t totalSize = 0;\n      for (auto& item: items) {\n        if (!canPrintInline(item)) return false;\n        if (kind == PrintKind::RECORD) {\n          totalSize += item.size();\n          if (totalSize > maxInlineRecordSize) return false;\n        }\n      }\n      return true;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nIndent {\n  kj::StringTree delimit(kj::Array<kj::StringTree> items, PrintMode mode, PrintKind kind) {\n      if (amount == 0 || canPrintAllInline(items, kind)) {\n        return kj::StringTree(kj::mv(items), \", \");\n      } else {\n        char delim[amount * 2 + 3];\n        delim[0] = ',';\n        delim[1] = '\\n';\n        memset(delim + 2, ' ', amount * 2);\n        delim[amount * 2 + 2] = '\\0';\n  \n        // If the outer value isn't being printed on its own line, we need to add a newline/indent\n        // before the first item, otherwise we only add a space on the assumption that it is preceded\n        // by an open bracket or parenthesis.\n        return kj::strTree(mode == BARE ? \" \" : delim + 1,\n            kj::StringTree(kj::mv(items), kj::StringPtr(delim, amount * 2 + 2)), ' ');\n      }\n    }\n}"
  },
  {
    "function_name": "next",
    "container": "Indent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
    "lines": "53-55",
    "snippet": "Indent next() {\n    return Indent(amount == 0 ? 0 : amount + 1);\n  }",
    "includes": [
      "#include <kj/vector.h>",
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Indent",
          "args": [
            "amount == 0 ? 0 : amount + 1"
          ],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "canPrintInline",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
          "lines": "83-96",
          "snippet": "static bool canPrintInline(const kj::StringTree& text) {\n    if (text.size() > maxInlineValueSize) {\n      return false;\n    }\n\n    char flat[maxInlineValueSize + 1];\n    text.flattenTo(flat);\n    flat[text.size()] = '\\0';\n    if (strchr(flat, '\\n') != nullptr) {\n      return false;\n    }\n\n    return true;\n  }",
          "includes": [
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nIndent {\n  static bool canPrintInline(const kj::StringTree& text) {\n      if (text.size() > maxInlineValueSize) {\n        return false;\n      }\n  \n      char flat[maxInlineValueSize + 1];\n      text.flattenTo(flat);\n      flat[text.size()] = '\\0';\n      if (strchr(flat, '\\n') != nullptr) {\n        return false;\n      }\n  \n      return true;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nIndent {\n  Indent next() {\n      return Indent(amount == 0 ? 0 : amount + 1);\n    }\n}"
  },
  {
    "function_name": "Indent",
    "container": "Indent",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/stringify.c++",
    "lines": "51-51",
    "snippet": "explicit Indent(bool enable): amount(enable ? 1 : 0) {}",
    "includes": [
      "#include <kj/vector.h>",
      "#include <kj/debug.h>",
      "#include \"dynamic.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"dynamic.h\"\n\nIndent {\n  explicit Indent(bool enable): amount(enable ? 1 : 0) {}\n}"
  }
]