[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/samples/addressbook.c++",
    "lines": "263-281",
    "snippet": "int main(int argc, char* argv[]) {\n  StructSchema schema = Schema::from<AddressBook>();\n  if (argc != 2) {\n    std::cerr << \"Missing arg.\" << std::endl;\n    return 1;\n  } else if (strcmp(argv[1], \"write\") == 0) {\n    writeAddressBook(1);\n  } else if (strcmp(argv[1], \"read\") == 0) {\n    printAddressBook(0);\n  } else if (strcmp(argv[1], \"dwrite\") == 0) {\n    dynamicWriteAddressBook(1, schema);\n  } else if (strcmp(argv[1], \"dread\") == 0) {\n    dynamicPrintMessage(0, schema);\n  } else {\n    std::cerr << \"Invalid arg: \" << argv[1] << std::endl;\n    return 1;\n  }\n  return 0;\n}",
    "includes": [
      "#include <capnp/dynamic.h>",
      "#include <capnp/schema.h>",
      "#include <iostream>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/message.h>",
      "#include \"addressbook.capnp.h\"",
      "#include <iostream>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/message.h>",
      "#include \"addressbook.capnp.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dynamicPrintMessage",
          "args": [
            "0",
            "schema"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "argv[1]",
            "\"dread\""
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dynamicWriteAddressBook",
          "args": [
            "1",
            "schema"
          ],
          "line": 273
        },
        "resolved": true,
        "details": {
          "function_name": "dynamicWriteAddressBook",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/samples/addressbook.c++",
          "lines": "137-181",
          "snippet": "void dynamicWriteAddressBook(int fd, StructSchema schema) {\n  // Write a message using the dynamic API to set each\n  // field by text name.  This isn't something you'd\n  // normally want to do; it's just for illustration.\n\n  MallocMessageBuilder message;\n\n  // Types shown for explanation purposes; normally you'd\n  // use auto.\n  DynamicStruct::Builder addressBook =\n      message.initRoot<DynamicStruct>(schema);\n\n  DynamicList::Builder people =\n      addressBook.init(\"people\", 2).as<DynamicList>();\n\n  DynamicStruct::Builder alice =\n      people[0].as<DynamicStruct>();\n  alice.set(\"id\", 123);\n  alice.set(\"name\", \"Alice\");\n  alice.set(\"email\", \"alice@example.com\");\n  auto alicePhones = alice.init(\"phones\", 1).as<DynamicList>();\n  auto phone0 = alicePhones[0].as<DynamicStruct>();\n  phone0.set(\"number\", \"555-1212\");\n  phone0.set(\"type\", \"mobile\");\n  alice.get(\"employment\").as<DynamicStruct>()\n       .set(\"school\", \"MIT\");\n\n  auto bob = people[1].as<DynamicStruct>();\n  bob.set(\"id\", 456);\n  bob.set(\"name\", \"Bob\");\n  bob.set(\"email\", \"bob@example.com\");\n\n  // Some magic:  We can convert a dynamic sub-value back to\n  // the native type with as<T>()!\n  List<Person::PhoneNumber>::Builder bobPhones =\n      bob.init(\"phones\", 2).as<List<Person::PhoneNumber>>();\n  bobPhones[0].setNumber(\"555-4567\");\n  bobPhones[0].setType(Person::PhoneNumber::Type::HOME);\n  bobPhones[1].setNumber(\"555-7654\");\n  bobPhones[1].setType(Person::PhoneNumber::Type::WORK);\n  bob.get(\"employment\").as<DynamicStruct>()\n     .set(\"unemployed\", ::capnp::VOID);\n\n  writePackedMessageToFd(fd, message);\n}",
          "includes": [
            "#include <capnp/dynamic.h>",
            "#include <capnp/schema.h>",
            "#include <iostream>",
            "#include <capnp/serialize-packed.h>",
            "#include <capnp/message.h>",
            "#include \"addressbook.capnp.h\"",
            "#include <iostream>",
            "#include <capnp/serialize-packed.h>",
            "#include <capnp/message.h>",
            "#include \"addressbook.capnp.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/dynamic.h>\n#include <capnp/schema.h>\n#include <iostream>\n#include <capnp/serialize-packed.h>\n#include <capnp/message.h>\n#include \"addressbook.capnp.h\"\n#include <iostream>\n#include <capnp/serialize-packed.h>\n#include <capnp/message.h>\n#include \"addressbook.capnp.h\"\n\nvoid dynamicWriteAddressBook(int fd, StructSchema schema) {\n  // Write a message using the dynamic API to set each\n  // field by text name.  This isn't something you'd\n  // normally want to do; it's just for illustration.\n\n  MallocMessageBuilder message;\n\n  // Types shown for explanation purposes; normally you'd\n  // use auto.\n  DynamicStruct::Builder addressBook =\n      message.initRoot<DynamicStruct>(schema);\n\n  DynamicList::Builder people =\n      addressBook.init(\"people\", 2).as<DynamicList>();\n\n  DynamicStruct::Builder alice =\n      people[0].as<DynamicStruct>();\n  alice.set(\"id\", 123);\n  alice.set(\"name\", \"Alice\");\n  alice.set(\"email\", \"alice@example.com\");\n  auto alicePhones = alice.init(\"phones\", 1).as<DynamicList>();\n  auto phone0 = alicePhones[0].as<DynamicStruct>();\n  phone0.set(\"number\", \"555-1212\");\n  phone0.set(\"type\", \"mobile\");\n  alice.get(\"employment\").as<DynamicStruct>()\n       .set(\"school\", \"MIT\");\n\n  auto bob = people[1].as<DynamicStruct>();\n  bob.set(\"id\", 456);\n  bob.set(\"name\", \"Bob\");\n  bob.set(\"email\", \"bob@example.com\");\n\n  // Some magic:  We can convert a dynamic sub-value back to\n  // the native type with as<T>()!\n  List<Person::PhoneNumber>::Builder bobPhones =\n      bob.init(\"phones\", 2).as<List<Person::PhoneNumber>>();\n  bobPhones[0].setNumber(\"555-4567\");\n  bobPhones[0].setType(Person::PhoneNumber::Type::HOME);\n  bobPhones[1].setNumber(\"555-7654\");\n  bobPhones[1].setType(Person::PhoneNumber::Type::WORK);\n  bob.get(\"employment\").as<DynamicStruct>()\n     .set(\"unemployed\", ::capnp::VOID);\n\n  writePackedMessageToFd(fd, message);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "argv[1]",
            "\"dwrite\""
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printAddressBook",
          "args": [
            "0"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "argv[1]",
            "\"read\""
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "writeAddressBook",
          "args": [
            "1"
          ],
          "line": 269
        },
        "resolved": true,
        "details": {
          "function_name": "writeAddressBook",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/samples/addressbook.c++",
          "lines": "47-76",
          "snippet": "void writeAddressBook(int fd) {\n  ::capnp::MallocMessageBuilder message;\n\n  AddressBook::Builder addressBook = message.initRoot<AddressBook>();\n  ::capnp::List<Person>::Builder people = addressBook.initPeople(2);\n\n  Person::Builder alice = people[0];\n  alice.setId(123);\n  alice.setName(\"Alice\");\n  alice.setEmail(\"alice@example.com\");\n  // Type shown for explanation purposes; normally you'd use auto.\n  ::capnp::List<Person::PhoneNumber>::Builder alicePhones =\n      alice.initPhones(1);\n  alicePhones[0].setNumber(\"555-1212\");\n  alicePhones[0].setType(Person::PhoneNumber::Type::MOBILE);\n  alice.getEmployment().setSchool(\"MIT\");\n\n  Person::Builder bob = people[1];\n  bob.setId(456);\n  bob.setName(\"Bob\");\n  bob.setEmail(\"bob@example.com\");\n  auto bobPhones = bob.initPhones(2);\n  bobPhones[0].setNumber(\"555-4567\");\n  bobPhones[0].setType(Person::PhoneNumber::Type::HOME);\n  bobPhones[1].setNumber(\"555-7654\");\n  bobPhones[1].setType(Person::PhoneNumber::Type::WORK);\n  bob.getEmployment().setUnemployed();\n\n  writePackedMessageToFd(fd, message);\n}",
          "includes": [
            "#include <capnp/dynamic.h>",
            "#include <capnp/schema.h>",
            "#include <iostream>",
            "#include <capnp/serialize-packed.h>",
            "#include <capnp/message.h>",
            "#include \"addressbook.capnp.h\"",
            "#include <iostream>",
            "#include <capnp/serialize-packed.h>",
            "#include <capnp/message.h>",
            "#include \"addressbook.capnp.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/dynamic.h>\n#include <capnp/schema.h>\n#include <iostream>\n#include <capnp/serialize-packed.h>\n#include <capnp/message.h>\n#include \"addressbook.capnp.h\"\n#include <iostream>\n#include <capnp/serialize-packed.h>\n#include <capnp/message.h>\n#include \"addressbook.capnp.h\"\n\nvoid writeAddressBook(int fd) {\n  ::capnp::MallocMessageBuilder message;\n\n  AddressBook::Builder addressBook = message.initRoot<AddressBook>();\n  ::capnp::List<Person>::Builder people = addressBook.initPeople(2);\n\n  Person::Builder alice = people[0];\n  alice.setId(123);\n  alice.setName(\"Alice\");\n  alice.setEmail(\"alice@example.com\");\n  // Type shown for explanation purposes; normally you'd use auto.\n  ::capnp::List<Person::PhoneNumber>::Builder alicePhones =\n      alice.initPhones(1);\n  alicePhones[0].setNumber(\"555-1212\");\n  alicePhones[0].setType(Person::PhoneNumber::Type::MOBILE);\n  alice.getEmployment().setSchool(\"MIT\");\n\n  Person::Builder bob = people[1];\n  bob.setId(456);\n  bob.setName(\"Bob\");\n  bob.setEmail(\"bob@example.com\");\n  auto bobPhones = bob.initPhones(2);\n  bobPhones[0].setNumber(\"555-4567\");\n  bobPhones[0].setType(Person::PhoneNumber::Type::HOME);\n  bobPhones[1].setNumber(\"555-7654\");\n  bobPhones[1].setType(Person::PhoneNumber::Type::WORK);\n  bob.getEmployment().setUnemployed();\n\n  writePackedMessageToFd(fd, message);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "argv[1]",
            "\"write\""
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Schema::from<AddressBook>",
          "args": [],
          "line": 264
        },
        "resolved": true,
        "details": {
          "function_name": "fromImpl",
          "container": "InterfaceSchema",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "466-468",
          "snippet": "static inline InterfaceSchema fromImpl() {\n    return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n  }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\nInterfaceSchema {\n  static inline InterfaceSchema fromImpl() {\n      return InterfaceSchema(Schema(&_::rawBrandedSchema<T>()));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <capnp/dynamic.h>\n#include <capnp/schema.h>\n#include <iostream>\n#include <capnp/serialize-packed.h>\n#include <capnp/message.h>\n#include \"addressbook.capnp.h\"\n#include <iostream>\n#include <capnp/serialize-packed.h>\n#include <capnp/message.h>\n#include \"addressbook.capnp.h\"\n\nint main(int argc, char* argv[]) {\n  StructSchema schema = Schema::from<AddressBook>();\n  if (argc != 2) {\n    std::cerr << \"Missing arg.\" << std::endl;\n    return 1;\n  } else if (strcmp(argv[1], \"write\") == 0) {\n    writeAddressBook(1);\n  } else if (strcmp(argv[1], \"read\") == 0) {\n    printAddressBook(0);\n  } else if (strcmp(argv[1], \"dwrite\") == 0) {\n    dynamicWriteAddressBook(1, schema);\n  } else if (strcmp(argv[1], \"dread\") == 0) {\n    dynamicPrintMessage(0, schema);\n  } else {\n    std::cerr << \"Invalid arg: \" << argv[1] << std::endl;\n    return 1;\n  }\n  return 0;\n}"
  },
  {
    "function_name": "dynamicPrintMessage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/samples/addressbook.c++",
    "lines": "257-261",
    "snippet": "void dynamicPrintMessage(int fd, StructSchema schema) {\n  PackedFdMessageReader message(fd);\n  dynamicPrintValue(message.getRoot<DynamicStruct>(schema));\n  std::cout << std::endl;\n}",
    "includes": [
      "#include <capnp/dynamic.h>",
      "#include <capnp/schema.h>",
      "#include <iostream>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/message.h>",
      "#include \"addressbook.capnp.h\"",
      "#include <iostream>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/message.h>",
      "#include \"addressbook.capnp.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dynamicPrintValue",
          "args": [
            "message.getRoot<DynamicStruct>(schema)"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "dynamicPrintValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/samples/addressbook.c++",
          "lines": "183-254",
          "snippet": "void dynamicPrintValue(DynamicValue::Reader value) {\n  // Print an arbitrary message via the dynamic API by\n  // iterating over the schema.  Look at the handling\n  // of STRUCT in particular.\n\n  switch (value.getType()) {\n    case DynamicValue::VOID:\n      std::cout << \"\";\n      break;\n    case DynamicValue::BOOL:\n      std::cout << (value.as<bool>() ? \"true\" : \"false\");\n      break;\n    case DynamicValue::INT:\n      std::cout << value.as<int64_t>();\n      break;\n    case DynamicValue::UINT:\n      std::cout << value.as<uint64_t>();\n      break;\n    case DynamicValue::FLOAT:\n      std::cout << value.as<double>();\n      break;\n    case DynamicValue::TEXT:\n      std::cout << '\\\"' << value.as<Text>().cStr() << '\\\"';\n      break;\n    case DynamicValue::LIST: {\n      std::cout << \"[\";\n      bool first = true;\n      for (auto element: value.as<DynamicList>()) {\n        if (first) {\n          first = false;\n        } else {\n          std::cout << \", \";\n        }\n        dynamicPrintValue(element);\n      }\n      std::cout << \"]\";\n      break;\n    }\n    case DynamicValue::ENUM: {\n      auto enumValue = value.as<DynamicEnum>();\n      KJ_IF_MAYBE(enumerant, enumValue.getEnumerant()) {\n        std::cout <<\n            enumerant->getProto().getName().cStr();\n      } else {\n        // Unknown enum value; output raw number.\n        std::cout << enumValue.getRaw();\n      }\n      break;\n    }\n    case DynamicValue::STRUCT: {\n      std::cout << \"(\";\n      auto structValue = value.as<DynamicStruct>();\n      bool first = true;\n      for (auto field: structValue.getSchema().getFields()) {\n        if (!structValue.has(field)) continue;\n        if (first) {\n          first = false;\n        } else {\n          std::cout << \", \";\n        }\n        std::cout << field.getProto().getName().cStr()\n                  << \" = \";\n        dynamicPrintValue(structValue.get(field));\n      }\n      std::cout << \")\";\n      break;\n    }\n    default:\n      // There are other types, we aren't handling them.\n      std::cout << \"?\";\n      break;\n  }",
          "includes": [
            "#include <capnp/dynamic.h>",
            "#include <capnp/schema.h>",
            "#include <iostream>",
            "#include <capnp/serialize-packed.h>",
            "#include <capnp/message.h>",
            "#include \"addressbook.capnp.h\"",
            "#include <iostream>",
            "#include <capnp/serialize-packed.h>",
            "#include <capnp/message.h>",
            "#include \"addressbook.capnp.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/dynamic.h>\n#include <capnp/schema.h>\n#include <iostream>\n#include <capnp/serialize-packed.h>\n#include <capnp/message.h>\n#include \"addressbook.capnp.h\"\n#include <iostream>\n#include <capnp/serialize-packed.h>\n#include <capnp/message.h>\n#include \"addressbook.capnp.h\"\n\nvoid dynamicPrintValue(DynamicValue::Reader value) {\n  // Print an arbitrary message via the dynamic API by\n  // iterating over the schema.  Look at the handling\n  // of STRUCT in particular.\n\n  switch (value.getType()) {\n    case DynamicValue::VOID:\n      std::cout << \"\";\n      break;\n    case DynamicValue::BOOL:\n      std::cout << (value.as<bool>() ? \"true\" : \"false\");\n      break;\n    case DynamicValue::INT:\n      std::cout << value.as<int64_t>();\n      break;\n    case DynamicValue::UINT:\n      std::cout << value.as<uint64_t>();\n      break;\n    case DynamicValue::FLOAT:\n      std::cout << value.as<double>();\n      break;\n    case DynamicValue::TEXT:\n      std::cout << '\\\"' << value.as<Text>().cStr() << '\\\"';\n      break;\n    case DynamicValue::LIST: {\n      std::cout << \"[\";\n      bool first = true;\n      for (auto element: value.as<DynamicList>()) {\n        if (first) {\n          first = false;\n        } else {\n          std::cout << \", \";\n        }\n        dynamicPrintValue(element);\n      }\n      std::cout << \"]\";\n      break;\n    }\n    case DynamicValue::ENUM: {\n      auto enumValue = value.as<DynamicEnum>();\n      KJ_IF_MAYBE(enumerant, enumValue.getEnumerant()) {\n        std::cout <<\n            enumerant->getProto().getName().cStr();\n      } else {\n        // Unknown enum value; output raw number.\n        std::cout << enumValue.getRaw();\n      }\n      break;\n    }\n    case DynamicValue::STRUCT: {\n      std::cout << \"(\";\n      auto structValue = value.as<DynamicStruct>();\n      bool first = true;\n      for (auto field: structValue.getSchema().getFields()) {\n        if (!structValue.has(field)) continue;\n        if (first) {\n          first = false;\n        } else {\n          std::cout << \", \";\n        }\n        std::cout << field.getProto().getName().cStr()\n                  << \" = \";\n        dynamicPrintValue(structValue.get(field));\n      }\n      std::cout << \")\";\n      break;\n    }\n    default:\n      // There are other types, we aren't handling them.\n      std::cout << \"?\";\n      break;\n  }"
        }
      },
      {
        "call_info": {
          "callee": "message.getRoot<DynamicStruct>",
          "args": [
            "schema"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <capnp/dynamic.h>\n#include <capnp/schema.h>\n#include <iostream>\n#include <capnp/serialize-packed.h>\n#include <capnp/message.h>\n#include \"addressbook.capnp.h\"\n#include <iostream>\n#include <capnp/serialize-packed.h>\n#include <capnp/message.h>\n#include \"addressbook.capnp.h\"\n\nvoid dynamicPrintMessage(int fd, StructSchema schema) {\n  PackedFdMessageReader message(fd);\n  dynamicPrintValue(message.getRoot<DynamicStruct>(schema));\n  std::cout << std::endl;\n}"
  },
  {
    "function_name": "dynamicPrintValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/samples/addressbook.c++",
    "lines": "183-254",
    "snippet": "void dynamicPrintValue(DynamicValue::Reader value) {\n  // Print an arbitrary message via the dynamic API by\n  // iterating over the schema.  Look at the handling\n  // of STRUCT in particular.\n\n  switch (value.getType()) {\n    case DynamicValue::VOID:\n      std::cout << \"\";\n      break;\n    case DynamicValue::BOOL:\n      std::cout << (value.as<bool>() ? \"true\" : \"false\");\n      break;\n    case DynamicValue::INT:\n      std::cout << value.as<int64_t>();\n      break;\n    case DynamicValue::UINT:\n      std::cout << value.as<uint64_t>();\n      break;\n    case DynamicValue::FLOAT:\n      std::cout << value.as<double>();\n      break;\n    case DynamicValue::TEXT:\n      std::cout << '\\\"' << value.as<Text>().cStr() << '\\\"';\n      break;\n    case DynamicValue::LIST: {\n      std::cout << \"[\";\n      bool first = true;\n      for (auto element: value.as<DynamicList>()) {\n        if (first) {\n          first = false;\n        } else {\n          std::cout << \", \";\n        }\n        dynamicPrintValue(element);\n      }\n      std::cout << \"]\";\n      break;\n    }\n    case DynamicValue::ENUM: {\n      auto enumValue = value.as<DynamicEnum>();\n      KJ_IF_MAYBE(enumerant, enumValue.getEnumerant()) {\n        std::cout <<\n            enumerant->getProto().getName().cStr();\n      } else {\n        // Unknown enum value; output raw number.\n        std::cout << enumValue.getRaw();\n      }\n      break;\n    }\n    case DynamicValue::STRUCT: {\n      std::cout << \"(\";\n      auto structValue = value.as<DynamicStruct>();\n      bool first = true;\n      for (auto field: structValue.getSchema().getFields()) {\n        if (!structValue.has(field)) continue;\n        if (first) {\n          first = false;\n        } else {\n          std::cout << \", \";\n        }\n        std::cout << field.getProto().getName().cStr()\n                  << \" = \";\n        dynamicPrintValue(structValue.get(field));\n      }\n      std::cout << \")\";\n      break;\n    }\n    default:\n      // There are other types, we aren't handling them.\n      std::cout << \"?\";\n      break;\n  }",
    "includes": [
      "#include <capnp/dynamic.h>",
      "#include <capnp/schema.h>",
      "#include <iostream>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/message.h>",
      "#include \"addressbook.capnp.h\"",
      "#include <iostream>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/message.h>",
      "#include \"addressbook.capnp.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "structValue.get",
          "args": [
            "field"
          ],
          "line": 245
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "868-871",
          "snippet": "static inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }"
        }
      },
      {
        "call_info": {
          "callee": "field.getProto",
          "args": [],
          "line": 243
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      },
      {
        "call_info": {
          "callee": "structValue.has",
          "args": [
            "field"
          ],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "has",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "253-253",
          "snippet": "inline bool has(StructSchema::Field field) { return asReader().has(field); }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline bool has(StructSchema::Field field) { return asReader().has(field); }"
        }
      },
      {
        "call_info": {
          "callee": "structValue.getSchema",
          "args": [],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "getSchema",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "505-505",
          "snippet": "inline InterfaceSchema getSchema() const { return schema; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline InterfaceSchema getSchema() const { return schema; }"
        }
      },
      {
        "call_info": {
          "callee": "value.as<DynamicStruct>",
          "args": [],
          "line": 234
        },
        "resolved": true,
        "details": {
          "function_name": "as",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "601-604",
          "snippet": "BuilderFor<T> as() {\n    // T must be List<U>.\n    return BuilderFor<T>(_builder);\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nBuilderFor<T> as() {\n    // T must be List<U>.\n    return BuilderFor<T>(_builder);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "enumValue.getRaw",
          "args": [],
          "line": 228
        },
        "resolved": true,
        "details": {
          "function_name": "getRaw",
          "container": "DynamicEnum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "149-149",
          "snippet": "inline uint16_t getRaw() const { return value; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\nDynamicEnum {\n  inline uint16_t getRaw() const { return value; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "KJ_IF_MAYBE",
          "args": [
            "enumerant",
            "enumValue.getEnumerant()"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "KJ_IF_MAYBE",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "2462-2464",
          "snippet": "KJ_IF_MAYBE(e, exception) {\n          fulfiller->get()->reject(kj::mv(*e));\n        }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nKJ_IF_MAYBE(e, exception) {\n          fulfiller->get()->reject(kj::mv(*e));\n        }"
        }
      },
      {
        "call_info": {
          "callee": "enumValue.getEnumerant",
          "args": [],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.getType",
          "args": [],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "getType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "942-942",
          "snippet": "inline DynamicValue::Type getType() { return type; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline DynamicValue::Type getType() { return type; }"
        }
      }
    ],
    "contextual_snippet": "#include <capnp/dynamic.h>\n#include <capnp/schema.h>\n#include <iostream>\n#include <capnp/serialize-packed.h>\n#include <capnp/message.h>\n#include \"addressbook.capnp.h\"\n#include <iostream>\n#include <capnp/serialize-packed.h>\n#include <capnp/message.h>\n#include \"addressbook.capnp.h\"\n\nvoid dynamicPrintValue(DynamicValue::Reader value) {\n  // Print an arbitrary message via the dynamic API by\n  // iterating over the schema.  Look at the handling\n  // of STRUCT in particular.\n\n  switch (value.getType()) {\n    case DynamicValue::VOID:\n      std::cout << \"\";\n      break;\n    case DynamicValue::BOOL:\n      std::cout << (value.as<bool>() ? \"true\" : \"false\");\n      break;\n    case DynamicValue::INT:\n      std::cout << value.as<int64_t>();\n      break;\n    case DynamicValue::UINT:\n      std::cout << value.as<uint64_t>();\n      break;\n    case DynamicValue::FLOAT:\n      std::cout << value.as<double>();\n      break;\n    case DynamicValue::TEXT:\n      std::cout << '\\\"' << value.as<Text>().cStr() << '\\\"';\n      break;\n    case DynamicValue::LIST: {\n      std::cout << \"[\";\n      bool first = true;\n      for (auto element: value.as<DynamicList>()) {\n        if (first) {\n          first = false;\n        } else {\n          std::cout << \", \";\n        }\n        dynamicPrintValue(element);\n      }\n      std::cout << \"]\";\n      break;\n    }\n    case DynamicValue::ENUM: {\n      auto enumValue = value.as<DynamicEnum>();\n      KJ_IF_MAYBE(enumerant, enumValue.getEnumerant()) {\n        std::cout <<\n            enumerant->getProto().getName().cStr();\n      } else {\n        // Unknown enum value; output raw number.\n        std::cout << enumValue.getRaw();\n      }\n      break;\n    }\n    case DynamicValue::STRUCT: {\n      std::cout << \"(\";\n      auto structValue = value.as<DynamicStruct>();\n      bool first = true;\n      for (auto field: structValue.getSchema().getFields()) {\n        if (!structValue.has(field)) continue;\n        if (first) {\n          first = false;\n        } else {\n          std::cout << \", \";\n        }\n        std::cout << field.getProto().getName().cStr()\n                  << \" = \";\n        dynamicPrintValue(structValue.get(field));\n      }\n      std::cout << \")\";\n      break;\n    }\n    default:\n      // There are other types, we aren't handling them.\n      std::cout << \"?\";\n      break;\n  }"
  },
  {
    "function_name": "dynamicWriteAddressBook",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/samples/addressbook.c++",
    "lines": "137-181",
    "snippet": "void dynamicWriteAddressBook(int fd, StructSchema schema) {\n  // Write a message using the dynamic API to set each\n  // field by text name.  This isn't something you'd\n  // normally want to do; it's just for illustration.\n\n  MallocMessageBuilder message;\n\n  // Types shown for explanation purposes; normally you'd\n  // use auto.\n  DynamicStruct::Builder addressBook =\n      message.initRoot<DynamicStruct>(schema);\n\n  DynamicList::Builder people =\n      addressBook.init(\"people\", 2).as<DynamicList>();\n\n  DynamicStruct::Builder alice =\n      people[0].as<DynamicStruct>();\n  alice.set(\"id\", 123);\n  alice.set(\"name\", \"Alice\");\n  alice.set(\"email\", \"alice@example.com\");\n  auto alicePhones = alice.init(\"phones\", 1).as<DynamicList>();\n  auto phone0 = alicePhones[0].as<DynamicStruct>();\n  phone0.set(\"number\", \"555-1212\");\n  phone0.set(\"type\", \"mobile\");\n  alice.get(\"employment\").as<DynamicStruct>()\n       .set(\"school\", \"MIT\");\n\n  auto bob = people[1].as<DynamicStruct>();\n  bob.set(\"id\", 456);\n  bob.set(\"name\", \"Bob\");\n  bob.set(\"email\", \"bob@example.com\");\n\n  // Some magic:  We can convert a dynamic sub-value back to\n  // the native type with as<T>()!\n  List<Person::PhoneNumber>::Builder bobPhones =\n      bob.init(\"phones\", 2).as<List<Person::PhoneNumber>>();\n  bobPhones[0].setNumber(\"555-4567\");\n  bobPhones[0].setType(Person::PhoneNumber::Type::HOME);\n  bobPhones[1].setNumber(\"555-7654\");\n  bobPhones[1].setType(Person::PhoneNumber::Type::WORK);\n  bob.get(\"employment\").as<DynamicStruct>()\n     .set(\"unemployed\", ::capnp::VOID);\n\n  writePackedMessageToFd(fd, message);\n}",
    "includes": [
      "#include <capnp/dynamic.h>",
      "#include <capnp/schema.h>",
      "#include <iostream>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/message.h>",
      "#include \"addressbook.capnp.h\"",
      "#include <iostream>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/message.h>",
      "#include \"addressbook.capnp.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "writePackedMessageToFd",
          "args": [
            "fd",
            "message"
          ],
          "line": 180
        },
        "resolved": true,
        "details": {
          "function_name": "writePackedMessageToFd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-packed.h",
          "lines": "120-122",
          "snippet": "inline void writePackedMessageToFd(int fd, MessageBuilder& builder) {\n  writePackedMessageToFd(fd, builder.getSegmentsForOutput());\n}",
          "includes": [
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"serialize.h\"\n\ninline void writePackedMessageToFd(int fd, MessageBuilder& builder) {\n  writePackedMessageToFd(fd, builder.getSegmentsForOutput());\n}"
        }
      },
      {
        "call_info": {
          "callee": "bob.get",
          "args": [
            "\"unemployed\"",
            "::capnp::VOID"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bob.get",
          "args": [],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "bob.get",
          "args": [
            "\"employment\""
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "868-871",
          "snippet": "static inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }"
        }
      },
      {
        "call_info": {
          "callee": "bobPhones[1].setType",
          "args": [
            "Person::PhoneNumber::Type::WORK"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bobPhones[1].setNumber",
          "args": [
            "\"555-7654\""
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bobPhones[0].setType",
          "args": [
            "Person::PhoneNumber::Type::HOME"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bobPhones[0].setNumber",
          "args": [
            "\"555-4567\""
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bob.init",
          "args": [],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "init",
          "container": "OneOf",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/one-of.h",
          "lines": "77-81",
          "snippet": "void init(Params&&... params) {\n    if (tag != 0) destroy();\n    ctor(*reinterpret_cast<T*>(space), kj::fwd<Params>(params)...);\n    tag = typeIndex<T>();\n  }",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nOneOf {\n  void init(Params&&... params) {\n      if (tag != 0) destroy();\n      ctor(*reinterpret_cast<T*>(space), kj::fwd<Params>(params)...);\n      tag = typeIndex<T>();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "bob.init",
          "args": [
            "\"phones\"",
            "2"
          ],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/pointer-helpers.h",
          "lines": "120-122",
          "snippet": "static inline typename T::Builder init(PointerBuilder builder, uint size) {\n    return builder.initBlob<T>(size * BYTES);\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"layout.h\"\n\nstatic inline typename T::Builder init(PointerBuilder builder, uint size) {\n    return builder.initBlob<T>(size * BYTES);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "bob.set",
          "args": [
            "\"email\"",
            "\"bob@example.com\""
          ],
          "line": 167
        },
        "resolved": true,
        "details": {
          "function_name": "set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "872-874",
          "snippet": "static inline void set(PointerBuilder builder, AnyList::Reader value) {\n    builder.setList(value._reader);\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline void set(PointerBuilder builder, AnyList::Reader value) {\n    builder.setList(value._reader);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "people[1].as<DynamicStruct>",
          "args": [],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "as",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "601-604",
          "snippet": "BuilderFor<T> as() {\n    // T must be List<U>.\n    return BuilderFor<T>(_builder);\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nBuilderFor<T> as() {\n    // T must be List<U>.\n    return BuilderFor<T>(_builder);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "alice.get",
          "args": [
            "\"school\"",
            "\"MIT\""
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "message.initRoot<DynamicStruct>",
          "args": [
            "schema"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <capnp/dynamic.h>\n#include <capnp/schema.h>\n#include <iostream>\n#include <capnp/serialize-packed.h>\n#include <capnp/message.h>\n#include \"addressbook.capnp.h\"\n#include <iostream>\n#include <capnp/serialize-packed.h>\n#include <capnp/message.h>\n#include \"addressbook.capnp.h\"\n\nvoid dynamicWriteAddressBook(int fd, StructSchema schema) {\n  // Write a message using the dynamic API to set each\n  // field by text name.  This isn't something you'd\n  // normally want to do; it's just for illustration.\n\n  MallocMessageBuilder message;\n\n  // Types shown for explanation purposes; normally you'd\n  // use auto.\n  DynamicStruct::Builder addressBook =\n      message.initRoot<DynamicStruct>(schema);\n\n  DynamicList::Builder people =\n      addressBook.init(\"people\", 2).as<DynamicList>();\n\n  DynamicStruct::Builder alice =\n      people[0].as<DynamicStruct>();\n  alice.set(\"id\", 123);\n  alice.set(\"name\", \"Alice\");\n  alice.set(\"email\", \"alice@example.com\");\n  auto alicePhones = alice.init(\"phones\", 1).as<DynamicList>();\n  auto phone0 = alicePhones[0].as<DynamicStruct>();\n  phone0.set(\"number\", \"555-1212\");\n  phone0.set(\"type\", \"mobile\");\n  alice.get(\"employment\").as<DynamicStruct>()\n       .set(\"school\", \"MIT\");\n\n  auto bob = people[1].as<DynamicStruct>();\n  bob.set(\"id\", 456);\n  bob.set(\"name\", \"Bob\");\n  bob.set(\"email\", \"bob@example.com\");\n\n  // Some magic:  We can convert a dynamic sub-value back to\n  // the native type with as<T>()!\n  List<Person::PhoneNumber>::Builder bobPhones =\n      bob.init(\"phones\", 2).as<List<Person::PhoneNumber>>();\n  bobPhones[0].setNumber(\"555-4567\");\n  bobPhones[0].setType(Person::PhoneNumber::Type::HOME);\n  bobPhones[1].setNumber(\"555-7654\");\n  bobPhones[1].setType(Person::PhoneNumber::Type::WORK);\n  bob.get(\"employment\").as<DynamicStruct>()\n     .set(\"unemployed\", ::capnp::VOID);\n\n  writePackedMessageToFd(fd, message);\n}"
  },
  {
    "function_name": "printAddressBook",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/samples/addressbook.c++",
    "lines": "78-114",
    "snippet": "void printAddressBook(int fd) {\n  ::capnp::PackedFdMessageReader message(fd);\n\n  AddressBook::Reader addressBook = message.getRoot<AddressBook>();\n\n  for (Person::Reader person : addressBook.getPeople()) {\n    std::cout << person.getName().cStr() << \": \"\n              << person.getEmail().cStr() << std::endl;\n    for (Person::PhoneNumber::Reader phone: person.getPhones()) {\n      const char* typeName = \"UNKNOWN\";\n      switch (phone.getType()) {\n        case Person::PhoneNumber::Type::MOBILE: typeName = \"mobile\"; break;\n        case Person::PhoneNumber::Type::HOME: typeName = \"home\"; break;\n        case Person::PhoneNumber::Type::WORK: typeName = \"work\"; break;\n      }\n      std::cout << \"  \" << typeName << \" phone: \"\n                << phone.getNumber().cStr() << std::endl;\n    }\n    Person::Employment::Reader employment = person.getEmployment();\n    switch (employment.which()) {\n      case Person::Employment::UNEMPLOYED:\n        std::cout << \"  unemployed\" << std::endl;\n        break;\n      case Person::Employment::EMPLOYER:\n        std::cout << \"  employer: \"\n                  << employment.getEmployer().cStr() << std::endl;\n        break;\n      case Person::Employment::SCHOOL:\n        std::cout << \"  student at: \"\n                  << employment.getSchool().cStr() << std::endl;\n        break;\n      case Person::Employment::SELF_EMPLOYED:\n        std::cout << \"  self-employed\" << std::endl;\n        break;\n    }\n  }\n}",
    "includes": [
      "#include <capnp/dynamic.h>",
      "#include <capnp/schema.h>",
      "#include <iostream>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/message.h>",
      "#include \"addressbook.capnp.h\"",
      "#include <iostream>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/message.h>",
      "#include \"addressbook.capnp.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "employment.getSchool",
          "args": [],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "employment.getSchool",
          "args": [],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "employment.getEmployer",
          "args": [],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "employment.getEmployer",
          "args": [],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "employment.which",
          "args": [],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "person.getEmployment",
          "args": [],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "phone.getNumber",
          "args": [],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "phone.getNumber",
          "args": [],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "phone.getType",
          "args": [],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "getType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "942-942",
          "snippet": "inline DynamicValue::Type getType() { return type; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline DynamicValue::Type getType() { return type; }"
        }
      },
      {
        "call_info": {
          "callee": "person.getPhones",
          "args": [],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "person.getEmail",
          "args": [],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "person.getEmail",
          "args": [],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "person.getName",
          "args": [],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "person.getName",
          "args": [],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "addressBook.getPeople",
          "args": [],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "message.getRoot<AddressBook>",
          "args": [],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "getRoot",
          "container": "RpcRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1322-1324",
          "snippet": "inline AnyPointer::Builder getRoot() {\n      return paramsBuilder;\n    }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nRpcRequest {\n  inline AnyPointer::Builder getRoot() {\n        return paramsBuilder;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <capnp/dynamic.h>\n#include <capnp/schema.h>\n#include <iostream>\n#include <capnp/serialize-packed.h>\n#include <capnp/message.h>\n#include \"addressbook.capnp.h\"\n#include <iostream>\n#include <capnp/serialize-packed.h>\n#include <capnp/message.h>\n#include \"addressbook.capnp.h\"\n\nvoid printAddressBook(int fd) {\n  ::capnp::PackedFdMessageReader message(fd);\n\n  AddressBook::Reader addressBook = message.getRoot<AddressBook>();\n\n  for (Person::Reader person : addressBook.getPeople()) {\n    std::cout << person.getName().cStr() << \": \"\n              << person.getEmail().cStr() << std::endl;\n    for (Person::PhoneNumber::Reader phone: person.getPhones()) {\n      const char* typeName = \"UNKNOWN\";\n      switch (phone.getType()) {\n        case Person::PhoneNumber::Type::MOBILE: typeName = \"mobile\"; break;\n        case Person::PhoneNumber::Type::HOME: typeName = \"home\"; break;\n        case Person::PhoneNumber::Type::WORK: typeName = \"work\"; break;\n      }\n      std::cout << \"  \" << typeName << \" phone: \"\n                << phone.getNumber().cStr() << std::endl;\n    }\n    Person::Employment::Reader employment = person.getEmployment();\n    switch (employment.which()) {\n      case Person::Employment::UNEMPLOYED:\n        std::cout << \"  unemployed\" << std::endl;\n        break;\n      case Person::Employment::EMPLOYER:\n        std::cout << \"  employer: \"\n                  << employment.getEmployer().cStr() << std::endl;\n        break;\n      case Person::Employment::SCHOOL:\n        std::cout << \"  student at: \"\n                  << employment.getSchool().cStr() << std::endl;\n        break;\n      case Person::Employment::SELF_EMPLOYED:\n        std::cout << \"  self-employed\" << std::endl;\n        break;\n    }\n  }\n}"
  },
  {
    "function_name": "writeAddressBook",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/samples/addressbook.c++",
    "lines": "47-76",
    "snippet": "void writeAddressBook(int fd) {\n  ::capnp::MallocMessageBuilder message;\n\n  AddressBook::Builder addressBook = message.initRoot<AddressBook>();\n  ::capnp::List<Person>::Builder people = addressBook.initPeople(2);\n\n  Person::Builder alice = people[0];\n  alice.setId(123);\n  alice.setName(\"Alice\");\n  alice.setEmail(\"alice@example.com\");\n  // Type shown for explanation purposes; normally you'd use auto.\n  ::capnp::List<Person::PhoneNumber>::Builder alicePhones =\n      alice.initPhones(1);\n  alicePhones[0].setNumber(\"555-1212\");\n  alicePhones[0].setType(Person::PhoneNumber::Type::MOBILE);\n  alice.getEmployment().setSchool(\"MIT\");\n\n  Person::Builder bob = people[1];\n  bob.setId(456);\n  bob.setName(\"Bob\");\n  bob.setEmail(\"bob@example.com\");\n  auto bobPhones = bob.initPhones(2);\n  bobPhones[0].setNumber(\"555-4567\");\n  bobPhones[0].setType(Person::PhoneNumber::Type::HOME);\n  bobPhones[1].setNumber(\"555-7654\");\n  bobPhones[1].setType(Person::PhoneNumber::Type::WORK);\n  bob.getEmployment().setUnemployed();\n\n  writePackedMessageToFd(fd, message);\n}",
    "includes": [
      "#include <capnp/dynamic.h>",
      "#include <capnp/schema.h>",
      "#include <iostream>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/message.h>",
      "#include \"addressbook.capnp.h\"",
      "#include <iostream>",
      "#include <capnp/serialize-packed.h>",
      "#include <capnp/message.h>",
      "#include \"addressbook.capnp.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "writePackedMessageToFd",
          "args": [
            "fd",
            "message"
          ],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "writePackedMessageToFd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-packed.h",
          "lines": "120-122",
          "snippet": "inline void writePackedMessageToFd(int fd, MessageBuilder& builder) {\n  writePackedMessageToFd(fd, builder.getSegmentsForOutput());\n}",
          "includes": [
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"serialize.h\"\n\ninline void writePackedMessageToFd(int fd, MessageBuilder& builder) {\n  writePackedMessageToFd(fd, builder.getSegmentsForOutput());\n}"
        }
      },
      {
        "call_info": {
          "callee": "bob.getEmployment",
          "args": [],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bob.getEmployment",
          "args": [],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bobPhones[1].setType",
          "args": [
            "Person::PhoneNumber::Type::WORK"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bobPhones[1].setNumber",
          "args": [
            "\"555-7654\""
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bobPhones[0].setType",
          "args": [
            "Person::PhoneNumber::Type::HOME"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bobPhones[0].setNumber",
          "args": [
            "\"555-4567\""
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bob.initPhones",
          "args": [
            "2"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bob.setEmail",
          "args": [
            "\"bob@example.com\""
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bob.setName",
          "args": [
            "\"Bob\""
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bob.setId",
          "args": [
            "456"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alice.getEmployment",
          "args": [
            "\"MIT\""
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alice.getEmployment",
          "args": [],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alicePhones[0].setType",
          "args": [
            "Person::PhoneNumber::Type::MOBILE"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alicePhones[0].setNumber",
          "args": [
            "\"555-1212\""
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alice.initPhones",
          "args": [
            "1"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alice.setEmail",
          "args": [
            "\"alice@example.com\""
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alice.setName",
          "args": [
            "\"Alice\""
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alice.setId",
          "args": [
            "123"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "addressBook.initPeople",
          "args": [
            "2"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "message.initRoot<AddressBook>",
          "args": [],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <capnp/dynamic.h>\n#include <capnp/schema.h>\n#include <iostream>\n#include <capnp/serialize-packed.h>\n#include <capnp/message.h>\n#include \"addressbook.capnp.h\"\n#include <iostream>\n#include <capnp/serialize-packed.h>\n#include <capnp/message.h>\n#include \"addressbook.capnp.h\"\n\nvoid writeAddressBook(int fd) {\n  ::capnp::MallocMessageBuilder message;\n\n  AddressBook::Builder addressBook = message.initRoot<AddressBook>();\n  ::capnp::List<Person>::Builder people = addressBook.initPeople(2);\n\n  Person::Builder alice = people[0];\n  alice.setId(123);\n  alice.setName(\"Alice\");\n  alice.setEmail(\"alice@example.com\");\n  // Type shown for explanation purposes; normally you'd use auto.\n  ::capnp::List<Person::PhoneNumber>::Builder alicePhones =\n      alice.initPhones(1);\n  alicePhones[0].setNumber(\"555-1212\");\n  alicePhones[0].setType(Person::PhoneNumber::Type::MOBILE);\n  alice.getEmployment().setSchool(\"MIT\");\n\n  Person::Builder bob = people[1];\n  bob.setId(456);\n  bob.setName(\"Bob\");\n  bob.setEmail(\"bob@example.com\");\n  auto bobPhones = bob.initPhones(2);\n  bobPhones[0].setNumber(\"555-4567\");\n  bobPhones[0].setType(Person::PhoneNumber::Type::HOME);\n  bobPhones[1].setNumber(\"555-7654\");\n  bobPhones[1].setType(Person::PhoneNumber::Type::WORK);\n  bob.getEmployment().setUnemployed();\n\n  writePackedMessageToFd(fd, message);\n}"
  }
]