[
  {
    "function_name": "check",
    "container": "TextChecker",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/fuzz-test.c++",
    "lines": "199-205",
    "snippet": "static uint check(ReaderOrBuilder& message) {\n    uint result = 0;\n    for (auto c: message.template getRoot<Text>()) {\n      result += c;\n    }\n    return result;\n  }",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/test.h>",
      "#include \"serialize.h\"",
      "#include \"message.h\"",
      "#include <capnp/test-import2.capnp.h>",
      "#include <capnp/test-import.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "message.template getRoot<Text>",
          "args": [],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/test.h>\n#include \"serialize.h\"\n#include \"message.h\"\n#include <capnp/test-import2.capnp.h>\n#include <capnp/test-import.capnp.h>\n\nTextChecker {\n  static uint check(ReaderOrBuilder& message) {\n      uint result = 0;\n      for (auto c: message.template getRoot<Text>()) {\n        result += c;\n      }\n      return result;\n    }\n}"
  },
  {
    "function_name": "check",
    "container": "StructListChecker",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/fuzz-test.c++",
    "lines": "175-184",
    "snippet": "static uint check(ReaderOrBuilder& message) {\n    uint result = 0;\n    auto l = message.template getRoot<List<TestAllTypes>>();\n    for (size_t i = l.size(); i > 0; i--) {\n      for (auto c: l[i-1].getTextField()) {\n        result += c;\n      }\n    }\n    return result;\n  }",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/test.h>",
      "#include \"serialize.h\"",
      "#include \"message.h\"",
      "#include <capnp/test-import2.capnp.h>",
      "#include <capnp/test-import.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "l[i-1].getTextField",
          "args": [],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "l.size",
          "args": [],
          "line": 178
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Builder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "401-401",
          "snippet": "inline uint size() const { return builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nBuilder {\n  inline uint size() const { return builder.size() / ELEMENTS; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "message.template getRoot<List<TestAllTypes>>",
          "args": [],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/test.h>\n#include \"serialize.h\"\n#include \"message.h\"\n#include <capnp/test-import2.capnp.h>\n#include <capnp/test-import.capnp.h>\n\nStructListChecker {\n  static uint check(ReaderOrBuilder& message) {\n      uint result = 0;\n      auto l = message.template getRoot<List<TestAllTypes>>();\n      for (size_t i = l.size(); i > 0; i--) {\n        for (auto c: l[i-1].getTextField()) {\n          result += c;\n        }\n      }\n      return result;\n    }\n}"
  },
  {
    "function_name": "check",
    "container": "ListChecker",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/fuzz-test.c++",
    "lines": "156-162",
    "snippet": "static uint check(ReaderOrBuilder& message) {\n    uint result = 0;\n    for (auto e: message.template getRoot<List<uint32_t>>()) {\n      result += e;\n    }\n    return result;\n  }",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/test.h>",
      "#include \"serialize.h\"",
      "#include \"message.h\"",
      "#include <capnp/test-import2.capnp.h>",
      "#include <capnp/test-import.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "message.template getRoot<List<uint32_t>>",
          "args": [],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/test.h>\n#include \"serialize.h\"\n#include \"message.h\"\n#include <capnp/test-import2.capnp.h>\n#include <capnp/test-import.capnp.h>\n\nListChecker {\n  static uint check(ReaderOrBuilder& message) {\n      uint result = 0;\n      for (auto e: message.template getRoot<List<uint32_t>>()) {\n        result += e;\n      }\n      return result;\n    }\n}"
  },
  {
    "function_name": "check",
    "container": "StructChecker",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/fuzz-test.c++",
    "lines": "138-144",
    "snippet": "static uint check(ReaderOrBuilder& message) {\n    uint result = 0;\n    for (auto c: message.template getRoot<TestAllTypes>().getTextField()) {\n      result += c;\n    }\n    return result;\n  }",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/test.h>",
      "#include \"serialize.h\"",
      "#include \"message.h\"",
      "#include <capnp/test-import2.capnp.h>",
      "#include <capnp/test-import.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "message.template getRoot<TestAllTypes>",
          "args": [],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "message.template getRoot<TestAllTypes>",
          "args": [],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/test.h>\n#include \"serialize.h\"\n#include \"message.h\"\n#include <capnp/test-import2.capnp.h>\n#include <capnp/test-import.capnp.h>\n\nStructChecker {\n  static uint check(ReaderOrBuilder& message) {\n      uint result = 0;\n      for (auto c: message.template getRoot<TestAllTypes>().getTextField()) {\n        result += c;\n      }\n      return result;\n    }\n}"
  },
  {
    "function_name": "fuzz",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/fuzz-test.c++",
    "lines": "118-134",
    "snippet": "void fuzz(kj::ArrayPtr<word> data, uint flipCount, uint startAt, uint endAt) {\n  if (flipCount == 0) {\n    traverseCatchingExceptions<Checker>(data);\n  } else {\n    for (uint i = startAt; i < endAt; i++) {\n      byte bit = 1u << (i % 8);\n      byte old = data.asBytes()[i / 8];\n      data.asBytes()[i / 8] |= bit;\n      fuzz<Checker>(data, flipCount - 1, i + 1, endAt);\n      data.asBytes()[i / 8] &= ~bit;\n      fuzz<Checker>(data, flipCount - 1, i + 1, endAt);\n      data.asBytes()[i / 8] = bit;\n      fuzz<Checker>(data, flipCount - 1, i + 1, endAt);\n      data.asBytes()[i / 8] = old;\n    }\n  }\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/test.h>",
      "#include \"serialize.h\"",
      "#include \"message.h\"",
      "#include <capnp/test-import2.capnp.h>",
      "#include <capnp/test-import.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "data.asBytes",
          "args": [],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "asBytes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/blob.h",
          "lines": "128-128",
          "snippet": "inline kj::ArrayPtr<const byte> asBytes() const { return asArray().asBytes(); }",
          "includes": [
            "#include <string.h>",
            "#include \"common.h\"",
            "#include <kj/string.h>",
            "#include <kj/common.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"common.h\"\n#include <kj/string.h>\n#include <kj/common.h>\n\ninline kj::ArrayPtr<const byte> asBytes() const { return asArray().asBytes(); }"
        }
      },
      {
        "call_info": {
          "callee": "traverseCatchingExceptions<Checker>",
          "args": [
            "data"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/test.h>\n#include \"serialize.h\"\n#include \"message.h\"\n#include <capnp/test-import2.capnp.h>\n#include <capnp/test-import.capnp.h>\n\nvoid fuzz(kj::ArrayPtr<word> data, uint flipCount, uint startAt, uint endAt) {\n  if (flipCount == 0) {\n    traverseCatchingExceptions<Checker>(data);\n  } else {\n    for (uint i = startAt; i < endAt; i++) {\n      byte bit = 1u << (i % 8);\n      byte old = data.asBytes()[i / 8];\n      data.asBytes()[i / 8] |= bit;\n      fuzz<Checker>(data, flipCount - 1, i + 1, endAt);\n      data.asBytes()[i / 8] &= ~bit;\n      fuzz<Checker>(data, flipCount - 1, i + 1, endAt);\n      data.asBytes()[i / 8] = bit;\n      fuzz<Checker>(data, flipCount - 1, i + 1, endAt);\n      data.asBytes()[i / 8] = old;\n    }\n  }\n}"
  },
  {
    "function_name": "traverseCatchingExceptions",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/fuzz-test.c++",
    "lines": "88-115",
    "snippet": "void traverseCatchingExceptions(kj::ArrayPtr<const word> data) {\n  // Try traversing through Checker.\n  kj::runCatchingExceptions([&]() {\n    FlatArrayMessageReader reader(data);\n    KJ_ASSERT(Checker::check(reader) != 0);\n  });\n\n  // Try traversing through AnyPointer.\n  kj::runCatchingExceptions([&]() {\n    FlatArrayMessageReader reader(data);\n    KJ_ASSERT(traverse(reader.getRoot<AnyPointer>()) != 0);\n  });\n\n  // Try counting the size..\n  kj::runCatchingExceptions([&]() {\n    FlatArrayMessageReader reader(data);\n    KJ_ASSERT(reader.getRoot<AnyPointer>().targetSize().wordCount != 0);\n  });\n\n  // Try copying into a builder, and if that works, traversing it with Checker.\n  static word buffer[8192];\n  kj::runCatchingExceptions([&]() {\n    FlatArrayMessageReader reader(data);\n    MallocMessageBuilder copyBuilder(buffer);\n    copyBuilder.setRoot(reader.getRoot<AnyPointer>());\n    KJ_ASSERT(Checker::check(copyBuilder) != 0);\n  });\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/test.h>",
      "#include \"serialize.h\"",
      "#include \"message.h\"",
      "#include <capnp/test-import2.capnp.h>",
      "#include <capnp/test-import.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::runCatchingExceptions",
          "args": [
            "[&]() {\n    FlatArrayMessageReader reader(data);\n    MallocMessageBuilder copyBuilder(buffer);\n    copyBuilder.setRoot(reader.getRoot<AnyPointer>());\n    KJ_ASSERT(Checker::check(copyBuilder) != 0);\n  }"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_ASSERT",
          "args": [
            "Checker::check(copyBuilder) != 0"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Checker::check",
          "args": [
            "copyBuilder"
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "check",
          "container": "TextChecker",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/fuzz-test.c++",
          "lines": "199-205",
          "snippet": "static uint check(ReaderOrBuilder& message) {\n    uint result = 0;\n    for (auto c: message.template getRoot<Text>()) {\n      result += c;\n    }\n    return result;\n  }",
          "includes": [
            "#include \"test-util.h\"",
            "#include <kj/test.h>",
            "#include \"serialize.h\"",
            "#include \"message.h\"",
            "#include <capnp/test-import2.capnp.h>",
            "#include <capnp/test-import.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"test-util.h\"\n#include <kj/test.h>\n#include \"serialize.h\"\n#include \"message.h\"\n#include <capnp/test-import2.capnp.h>\n#include <capnp/test-import.capnp.h>\n\nTextChecker {\n  static uint check(ReaderOrBuilder& message) {\n      uint result = 0;\n      for (auto c: message.template getRoot<Text>()) {\n        result += c;\n      }\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "copyBuilder.setRoot",
          "args": [
            "reader.getRoot<AnyPointer>()"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getRoot<AnyPointer>",
          "args": [],
          "line": 112
        },
        "resolved": true,
        "details": {
          "function_name": "getRoot",
          "container": "RpcRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1322-1324",
          "snippet": "inline AnyPointer::Builder getRoot() {\n      return paramsBuilder;\n    }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nRpcRequest {\n  inline AnyPointer::Builder getRoot() {\n        return paramsBuilder;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::runCatchingExceptions",
          "args": [
            "[&]() {\n    FlatArrayMessageReader reader(data);\n    KJ_ASSERT(reader.getRoot<AnyPointer>().targetSize().wordCount != 0);\n  }"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_ASSERT",
          "args": [
            "reader.getRoot<AnyPointer>().targetSize().wordCount != 0"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::runCatchingExceptions",
          "args": [
            "[&]() {\n    FlatArrayMessageReader reader(data);\n    KJ_ASSERT(traverse(reader.getRoot<AnyPointer>()) != 0);\n  }"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_ASSERT",
          "args": [
            "traverse(reader.getRoot<AnyPointer>()) != 0"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "traverse",
          "args": [
            "reader.getRoot<AnyPointer>()"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "traverse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/fuzz-test.c++",
          "lines": "77-85",
          "snippet": "uint64_t traverse(AnyPointer::Reader reader) {\n  if (reader.isStruct()) {\n    return traverse(reader.getAs<AnyStruct>());\n  } else if (reader.isList()) {\n    return traverse(reader.getAs<AnyList>());\n  } else {\n    return 0;\n  }\n}",
          "includes": [
            "#include \"test-util.h\"",
            "#include <kj/test.h>",
            "#include \"serialize.h\"",
            "#include \"message.h\"",
            "#include <capnp/test-import2.capnp.h>",
            "#include <capnp/test-import.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"test-util.h\"\n#include <kj/test.h>\n#include \"serialize.h\"\n#include \"message.h\"\n#include <capnp/test-import2.capnp.h>\n#include <capnp/test-import.capnp.h>\n\nuint64_t traverse(AnyPointer::Reader reader) {\n  if (reader.isStruct()) {\n    return traverse(reader.getAs<AnyStruct>());\n  } else if (reader.isList()) {\n    return traverse(reader.getAs<AnyList>());\n  } else {\n    return 0;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::runCatchingExceptions",
          "args": [
            "[&]() {\n    FlatArrayMessageReader reader(data);\n    KJ_ASSERT(Checker::check(reader) != 0);\n  }"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_ASSERT",
          "args": [
            "Checker::check(reader) != 0"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/test.h>\n#include \"serialize.h\"\n#include \"message.h\"\n#include <capnp/test-import2.capnp.h>\n#include <capnp/test-import.capnp.h>\n\nvoid traverseCatchingExceptions(kj::ArrayPtr<const word> data) {\n  // Try traversing through Checker.\n  kj::runCatchingExceptions([&]() {\n    FlatArrayMessageReader reader(data);\n    KJ_ASSERT(Checker::check(reader) != 0);\n  });\n\n  // Try traversing through AnyPointer.\n  kj::runCatchingExceptions([&]() {\n    FlatArrayMessageReader reader(data);\n    KJ_ASSERT(traverse(reader.getRoot<AnyPointer>()) != 0);\n  });\n\n  // Try counting the size..\n  kj::runCatchingExceptions([&]() {\n    FlatArrayMessageReader reader(data);\n    KJ_ASSERT(reader.getRoot<AnyPointer>().targetSize().wordCount != 0);\n  });\n\n  // Try copying into a builder, and if that works, traversing it with Checker.\n  static word buffer[8192];\n  kj::runCatchingExceptions([&]() {\n    FlatArrayMessageReader reader(data);\n    MallocMessageBuilder copyBuilder(buffer);\n    copyBuilder.setRoot(reader.getRoot<AnyPointer>());\n    KJ_ASSERT(Checker::check(copyBuilder) != 0);\n  });\n}"
  },
  {
    "function_name": "traverse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/fuzz-test.c++",
    "lines": "77-85",
    "snippet": "uint64_t traverse(AnyPointer::Reader reader) {\n  if (reader.isStruct()) {\n    return traverse(reader.getAs<AnyStruct>());\n  } else if (reader.isList()) {\n    return traverse(reader.getAs<AnyList>());\n  } else {\n    return 0;\n  }\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/test.h>",
      "#include \"serialize.h\"",
      "#include \"message.h\"",
      "#include <capnp/test-import2.capnp.h>",
      "#include <capnp/test-import.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reader.getAs<AnyList>",
          "args": [],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.isList",
          "args": [],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "isList",
          "container": "AnyPointer::Builder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "145-147",
          "snippet": "inline bool isList() {\n      return builder.isList();\n    }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nAnyPointer {\n  Builder {\n    inline bool isList() {\n          return builder.isList();\n        }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "reader.getAs<AnyStruct>",
          "args": [],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.isStruct",
          "args": [],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "isStruct",
          "container": "AnyPointer::Builder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "142-144",
          "snippet": "inline bool isStruct() {\n      return builder.isStruct();\n    }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nAnyPointer {\n  Builder {\n    inline bool isStruct() {\n          return builder.isStruct();\n        }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/test.h>\n#include \"serialize.h\"\n#include \"message.h\"\n#include <capnp/test-import2.capnp.h>\n#include <capnp/test-import.capnp.h>\n\nuint64_t traverse(AnyPointer::Reader reader) {\n  if (reader.isStruct()) {\n    return traverse(reader.getAs<AnyStruct>());\n  } else if (reader.isList()) {\n    return traverse(reader.getAs<AnyList>());\n  } else {\n    return 0;\n  }\n}"
  },
  {
    "function_name": "traverse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/fuzz-test.c++",
    "lines": "58-75",
    "snippet": "uint64_t traverse(AnyList::Reader reader) {\n  uint64_t result = 0;\n  switch (reader.getElementSize()) {\n    case ElementSize::VOID: break;\n    case ElementSize::BIT:         for (auto e: reader.as<List<bool    >>()) result += e; break;\n    case ElementSize::BYTE:        for (auto e: reader.as<List<uint8_t >>()) result += e; break;\n    case ElementSize::TWO_BYTES:   for (auto e: reader.as<List<uint16_t>>()) result += e; break;\n    case ElementSize::FOUR_BYTES:  for (auto e: reader.as<List<uint32_t>>()) result += e; break;\n    case ElementSize::EIGHT_BYTES: for (auto e: reader.as<List<uint64_t>>()) result += e; break;\n    case ElementSize::POINTER:\n      traverseList(reader.as<List<AnyPointer>>());\n      break;\n    case ElementSize::INLINE_COMPOSITE:\n      traverseList(reader.as<List<AnyStruct>>());\n      break;\n  }\n  return result;\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/test.h>",
      "#include \"serialize.h\"",
      "#include \"message.h\"",
      "#include <capnp/test-import2.capnp.h>",
      "#include <capnp/test-import.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "traverseList",
          "args": [
            "reader.as<List<AnyStruct>>()"
          ],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "traverseList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/fuzz-test.c++",
          "lines": "38-47",
          "snippet": "uint64_t traverseList(ListType list) {\n  // Traverse in reverse order in order to trigger segfaults before exceptions if we go\n  // out-of-bounds.\n\n  uint64_t result = 0;\n  for (size_t i = list.size(); i != 0; i--) {\n    result += traverse(list[i-1]);\n  }\n  return result;\n}",
          "includes": [
            "#include \"test-util.h\"",
            "#include <kj/test.h>",
            "#include \"serialize.h\"",
            "#include \"message.h\"",
            "#include <capnp/test-import2.capnp.h>",
            "#include <capnp/test-import.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"test-util.h\"\n#include <kj/test.h>\n#include \"serialize.h\"\n#include \"message.h\"\n#include <capnp/test-import2.capnp.h>\n#include <capnp/test-import.capnp.h>\n\nuint64_t traverseList(ListType list) {\n  // Traverse in reverse order in order to trigger segfaults before exceptions if we go\n  // out-of-bounds.\n\n  uint64_t result = 0;\n  for (size_t i = list.size(); i != 0; i--) {\n    result += traverse(list[i-1]);\n  }\n  return result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "reader.as<List<AnyStruct>>",
          "args": [],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.as<List<AnyPointer>>",
          "args": [],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.as<List<uint64_t>>",
          "args": [],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.as<List<uint32_t>>",
          "args": [],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.as<List<uint16_t>>",
          "args": [],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.as<List<uint8_t >>",
          "args": [],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.as<List<bool    >>",
          "args": [],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getElementSize",
          "args": [],
          "line": 60
        },
        "resolved": true,
        "details": {
          "function_name": "getElementSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "598-598",
          "snippet": "inline ElementSize getElementSize() { return _builder.getElementSize(); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline ElementSize getElementSize() { return _builder.getElementSize(); }"
        }
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/test.h>\n#include \"serialize.h\"\n#include \"message.h\"\n#include <capnp/test-import2.capnp.h>\n#include <capnp/test-import.capnp.h>\n\nuint64_t traverse(AnyList::Reader reader) {\n  uint64_t result = 0;\n  switch (reader.getElementSize()) {\n    case ElementSize::VOID: break;\n    case ElementSize::BIT:         for (auto e: reader.as<List<bool    >>()) result += e; break;\n    case ElementSize::BYTE:        for (auto e: reader.as<List<uint8_t >>()) result += e; break;\n    case ElementSize::TWO_BYTES:   for (auto e: reader.as<List<uint16_t>>()) result += e; break;\n    case ElementSize::FOUR_BYTES:  for (auto e: reader.as<List<uint32_t>>()) result += e; break;\n    case ElementSize::EIGHT_BYTES: for (auto e: reader.as<List<uint64_t>>()) result += e; break;\n    case ElementSize::POINTER:\n      traverseList(reader.as<List<AnyPointer>>());\n      break;\n    case ElementSize::INLINE_COMPOSITE:\n      traverseList(reader.as<List<AnyStruct>>());\n      break;\n  }\n  return result;\n}"
  },
  {
    "function_name": "traverse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/fuzz-test.c++",
    "lines": "49-56",
    "snippet": "uint64_t traverse(AnyStruct::Reader reader) {\n  uint64_t result = 0;\n  for (byte b: reader.getDataSection()) {\n    result += b;\n  }\n  result += traverseList(reader.getPointerSection());\n  return result;\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/test.h>",
      "#include \"serialize.h\"",
      "#include \"message.h\"",
      "#include <capnp/test-import2.capnp.h>",
      "#include <capnp/test-import.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "traverseList",
          "args": [
            "reader.getPointerSection()"
          ],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "traverseList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/fuzz-test.c++",
          "lines": "38-47",
          "snippet": "uint64_t traverseList(ListType list) {\n  // Traverse in reverse order in order to trigger segfaults before exceptions if we go\n  // out-of-bounds.\n\n  uint64_t result = 0;\n  for (size_t i = list.size(); i != 0; i--) {\n    result += traverse(list[i-1]);\n  }\n  return result;\n}",
          "includes": [
            "#include \"test-util.h\"",
            "#include <kj/test.h>",
            "#include \"serialize.h\"",
            "#include \"message.h\"",
            "#include <capnp/test-import2.capnp.h>",
            "#include <capnp/test-import.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"test-util.h\"\n#include <kj/test.h>\n#include \"serialize.h\"\n#include \"message.h\"\n#include <capnp/test-import2.capnp.h>\n#include <capnp/test-import.capnp.h>\n\nuint64_t traverseList(ListType list) {\n  // Traverse in reverse order in order to trigger segfaults before exceptions if we go\n  // out-of-bounds.\n\n  uint64_t result = 0;\n  for (size_t i = list.size(); i != 0; i--) {\n    result += traverse(list[i-1]);\n  }\n  return result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "reader.getPointerSection",
          "args": [],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "getPointerSection",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "465-467",
          "snippet": "List<AnyPointer>::Builder getPointerSection() {\n    return List<AnyPointer>::Builder(_builder.getPointerSectionAsList());\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nList<AnyPointer>::Builder getPointerSection() {\n    return List<AnyPointer>::Builder(_builder.getPointerSectionAsList());\n  }"
        }
      },
      {
        "call_info": {
          "callee": "reader.getDataSection",
          "args": [],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "getDataSection",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "462-464",
          "snippet": "inline Data::Builder getDataSection() {\n    return _builder.getDataSectionAsBlob();\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Data::Builder getDataSection() {\n    return _builder.getDataSectionAsBlob();\n  }"
        }
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/test.h>\n#include \"serialize.h\"\n#include \"message.h\"\n#include <capnp/test-import2.capnp.h>\n#include <capnp/test-import.capnp.h>\n\nuint64_t traverse(AnyStruct::Reader reader) {\n  uint64_t result = 0;\n  for (byte b: reader.getDataSection()) {\n    result += b;\n  }\n  result += traverseList(reader.getPointerSection());\n  return result;\n}"
  },
  {
    "function_name": "traverseList",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/fuzz-test.c++",
    "lines": "38-47",
    "snippet": "uint64_t traverseList(ListType list) {\n  // Traverse in reverse order in order to trigger segfaults before exceptions if we go\n  // out-of-bounds.\n\n  uint64_t result = 0;\n  for (size_t i = list.size(); i != 0; i--) {\n    result += traverse(list[i-1]);\n  }\n  return result;\n}",
    "includes": [
      "#include \"test-util.h\"",
      "#include <kj/test.h>",
      "#include \"serialize.h\"",
      "#include \"message.h\"",
      "#include <capnp/test-import2.capnp.h>",
      "#include <capnp/test-import.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "traverse",
          "args": [
            "list[i-1]"
          ],
          "line": 44
        },
        "resolved": true,
        "details": {
          "function_name": "traverse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/fuzz-test.c++",
          "lines": "77-85",
          "snippet": "uint64_t traverse(AnyPointer::Reader reader) {\n  if (reader.isStruct()) {\n    return traverse(reader.getAs<AnyStruct>());\n  } else if (reader.isList()) {\n    return traverse(reader.getAs<AnyList>());\n  } else {\n    return 0;\n  }\n}",
          "includes": [
            "#include \"test-util.h\"",
            "#include <kj/test.h>",
            "#include \"serialize.h\"",
            "#include \"message.h\"",
            "#include <capnp/test-import2.capnp.h>",
            "#include <capnp/test-import.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"test-util.h\"\n#include <kj/test.h>\n#include \"serialize.h\"\n#include \"message.h\"\n#include <capnp/test-import2.capnp.h>\n#include <capnp/test-import.capnp.h>\n\nuint64_t traverse(AnyPointer::Reader reader) {\n  if (reader.isStruct()) {\n    return traverse(reader.getAs<AnyStruct>());\n  } else if (reader.isList()) {\n    return traverse(reader.getAs<AnyList>());\n  } else {\n    return 0;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "list.size",
          "args": [],
          "line": 43
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "599-599",
          "snippet": "inline uint size() { return _builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline uint size() { return _builder.size() / ELEMENTS; }"
        }
      }
    ],
    "contextual_snippet": "#include \"test-util.h\"\n#include <kj/test.h>\n#include \"serialize.h\"\n#include \"message.h\"\n#include <capnp/test-import2.capnp.h>\n#include <capnp/test-import.capnp.h>\n\nuint64_t traverseList(ListType list) {\n  // Traverse in reverse order in order to trigger segfaults before exceptions if we go\n  // out-of-bounds.\n\n  uint64_t result = 0;\n  for (size_t i = list.size(); i != 0; i--) {\n    result += traverse(list[i-1]);\n  }\n  return result;\n}"
  }
]