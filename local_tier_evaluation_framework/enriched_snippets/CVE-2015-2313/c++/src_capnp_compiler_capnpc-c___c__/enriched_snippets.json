[
  {
    "function_name": "run",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "2892-2914",
    "snippet": "kj::MainBuilder::Validity run() {\n    ReaderOptions options;\n    options.traversalLimitInWords = 1 << 30;  // Don't limit.\n    StreamFdMessageReader reader(STDIN_FILENO, options);\n    auto request = reader.getRoot<schema::CodeGeneratorRequest>();\n\n    for (auto node: request.getNodes()) {\n      schemaLoader.load(node);\n    }\n\n    kj::FdOutputStream rawOut(STDOUT_FILENO);\n    kj::BufferedOutputStreamWrapper out(rawOut);\n\n    for (auto requestedFile: request.getRequestedFiles()) {\n      auto schema = schemaLoader.get(requestedFile.getId());\n      auto fileText = makeFileText(schema, requestedFile);\n\n      writeFile(kj::str(schema.getProto().getDisplayName(), \".h\"), fileText.header);\n      writeFile(kj::str(schema.getProto().getDisplayName(), \".c++\"), fileText.source);\n    }\n\n    return true;\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "schema::Node::Reader node;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "writeFile",
          "args": [
            "kj::str(schema.getProto().getDisplayName(), \".c++\")",
            "fileText.source"
          ],
          "line": 2910
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "schema.getProto().getDisplayName()",
            "\".c++\""
          ],
          "line": 2910
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getProto",
          "args": [],
          "line": 2910
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      },
      {
        "call_info": {
          "callee": "writeFile",
          "args": [
            "kj::str(schema.getProto().getDisplayName(), \".h\")",
            "fileText.header"
          ],
          "line": 2909
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "schema.getProto().getDisplayName()",
            "\".h\""
          ],
          "line": 2909
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "makeFileText",
          "args": [
            "schema",
            "requestedFile"
          ],
          "line": 2907
        },
        "resolved": true,
        "details": {
          "function_name": "makeFileText",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "2742-2774",
          "snippet": "FileText makeFileText(Schema schema,\n                        schema::CodeGeneratorRequest::RequestedFile::Reader request) {\n    usedImports.clear();\n\n    auto node = schema.getProto();\n    auto displayName = node.getDisplayName();\n\n    kj::Vector<kj::ArrayPtr<const char>> namespaceParts;\n    kj::String namespacePrefix;\n\n    for (auto annotation: node.getAnnotations()) {\n      if (annotation.getId() == NAMESPACE_ANNOTATION_ID) {\n        kj::StringPtr ns = annotation.getValue().getText();\n        kj::StringPtr ns2 = ns;\n        namespacePrefix = kj::str(\"::\", ns);\n\n        for (;;) {\n          KJ_IF_MAYBE(colonPos, ns.findFirst(':')) {\n            namespaceParts.add(ns.slice(0, *colonPos));\n            ns = ns.slice(*colonPos);\n            if (!ns.startsWith(\"::\")) {\n              context.exitError(kj::str(displayName, \": invalid namespace spec: \", ns2));\n            }\n            ns = ns.slice(2);\n          } else {\n            namespaceParts.add(ns);\n            break;\n          }\n        }\n\n        break;\n      }\n    }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "schema::Node::Reader node;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nschema::Node::Reader node;\n\nFileText makeFileText(Schema schema,\n                        schema::CodeGeneratorRequest::RequestedFile::Reader request) {\n    usedImports.clear();\n\n    auto node = schema.getProto();\n    auto displayName = node.getDisplayName();\n\n    kj::Vector<kj::ArrayPtr<const char>> namespaceParts;\n    kj::String namespacePrefix;\n\n    for (auto annotation: node.getAnnotations()) {\n      if (annotation.getId() == NAMESPACE_ANNOTATION_ID) {\n        kj::StringPtr ns = annotation.getValue().getText();\n        kj::StringPtr ns2 = ns;\n        namespacePrefix = kj::str(\"::\", ns);\n\n        for (;;) {\n          KJ_IF_MAYBE(colonPos, ns.findFirst(':')) {\n            namespaceParts.add(ns.slice(0, *colonPos));\n            ns = ns.slice(*colonPos);\n            if (!ns.startsWith(\"::\")) {\n              context.exitError(kj::str(displayName, \": invalid namespace spec: \", ns2));\n            }\n            ns = ns.slice(2);\n          } else {\n            namespaceParts.add(ns);\n            break;\n          }\n        }\n\n        break;\n      }\n    }"
        }
      },
      {
        "call_info": {
          "callee": "schemaLoader.get",
          "args": [
            "requestedFile.getId()"
          ],
          "line": 2906
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "868-871",
          "snippet": "static inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }"
        }
      },
      {
        "call_info": {
          "callee": "requestedFile.getId",
          "args": [],
          "line": 2906
        },
        "resolved": true,
        "details": {
          "function_name": "getId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
          "lines": "75-75",
          "snippet": "uint64_t getId() { return id; }",
          "includes": [
            "#include \"md5.h\"",
            "#include \"node-translator.h\"",
            "#include <unordered_map>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/message.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/arena.h>",
            "#include <kj/mutex.h>",
            "#include \"parser.h\"      // only for generateChildId()",
            "#include \"compiler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nuint64_t getId() { return id; }"
        }
      },
      {
        "call_info": {
          "callee": "request.getRequestedFiles",
          "args": [],
          "line": 2905
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schemaLoader.load",
          "args": [
            "node"
          ],
          "line": 2899
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request.getNodes",
          "args": [],
          "line": 2898
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getRoot<schema::CodeGeneratorRequest>",
          "args": [],
          "line": 2896
        },
        "resolved": true,
        "details": {
          "function_name": "getRoot",
          "container": "RpcRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1322-1324",
          "snippet": "inline AnyPointer::Builder getRoot() {\n      return paramsBuilder;\n    }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nRpcRequest {\n  inline AnyPointer::Builder getRoot() {\n        return paramsBuilder;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nschema::Node::Reader node;\n\nkj::MainBuilder::Validity run() {\n    ReaderOptions options;\n    options.traversalLimitInWords = 1 << 30;  // Don't limit.\n    StreamFdMessageReader reader(STDIN_FILENO, options);\n    auto request = reader.getRoot<schema::CodeGeneratorRequest>();\n\n    for (auto node: request.getNodes()) {\n      schemaLoader.load(node);\n    }\n\n    kj::FdOutputStream rawOut(STDOUT_FILENO);\n    kj::BufferedOutputStreamWrapper out(rawOut);\n\n    for (auto requestedFile: request.getRequestedFiles()) {\n      auto schema = schemaLoader.get(requestedFile.getId());\n      auto fileText = makeFileText(schema, requestedFile);\n\n      writeFile(kj::str(schema.getProto().getDisplayName(), \".h\"), fileText.header);\n      writeFile(kj::str(schema.getProto().getDisplayName(), \".c++\"), fileText.source);\n    }\n\n    return true;\n  }"
  },
  {
    "function_name": "writeFile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "2874-2890",
    "snippet": "void writeFile(kj::StringPtr filename, const kj::StringTree& text) {\n    if (!filename.startsWith(\"/\")) {\n      KJ_IF_MAYBE(slashpos, filename.findLast('/')) {\n        // Make the parent dir.\n        makeDirectory(kj::str(filename.slice(0, *slashpos)));\n      }\n    }\n\n    int fd;\n    KJ_SYSCALL(fd = open(filename.cStr(), O_CREAT | O_WRONLY | O_TRUNC, 0666), filename);\n    kj::FdOutputStream out((kj::AutoCloseFd(fd)));\n\n    text.visit(\n        [&](kj::ArrayPtr<const char> text) {\n          out.write(text.begin(), text.size());\n        });\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "text.visit",
          "args": [
            "[&](kj::ArrayPtr<const char> text) {\n          out.write(text.begin(), text.size());\n        }"
          ],
          "line": 2886
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "out.write",
          "args": [
            "text.begin()",
            "text.size()"
          ],
          "line": 2888
        },
        "resolved": true,
        "details": {
          "function_name": "write",
          "container": "FragmentingOutputStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-async-test.c++",
          "lines": "42-50",
          "snippet": "void write(const void* buffer, size_t size) override {\n    while (size > 0) {\n      usleep(5000);\n      size_t n = rand() % size + 1;\n      inner.write(buffer, n);\n      buffer = reinterpret_cast<const byte*>(buffer) + n;\n      size -= n;\n    }\n  }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include \"test-util.h\"",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <kj/thread.h>",
            "#include <kj/debug.h>",
            "#include \"serialize.h\"",
            "#include \"serialize-async.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include \"test-util.h\"\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <kj/thread.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n#include \"serialize-async.h\"\n\nFragmentingOutputStream {\n  void write(const void* buffer, size_t size) override {\n      while (size > 0) {\n        usleep(5000);\n        size_t n = rand() % size + 1;\n        inner.write(buffer, n);\n        buffer = reinterpret_cast<const byte*>(buffer) + n;\n        size -= n;\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "text.size",
          "args": [],
          "line": 2888
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-capnp.c++",
          "lines": "74-74",
          "snippet": "inline size_t size() const { return amount; }",
          "includes": [
            "#include \"config.h\"",
            "#include <map>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <map>\n#include <algorithm>\n#include <kj/main.h>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nIndent {\n  inline size_t size() const { return amount; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "text.begin",
          "args": [],
          "line": 2888
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-capnp.c++",
          "lines": "76-76",
          "snippet": "inline Iterator begin() const { return Iterator(0); }",
          "includes": [
            "#include \"config.h\"",
            "#include <map>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <map>\n#include <algorithm>\n#include <kj/main.h>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nIndent {\n  inline Iterator begin() const { return Iterator(0); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::AutoCloseFd",
          "args": [
            "fd"
          ],
          "line": 2884
        },
        "resolved": true,
        "details": {
          "function_name": "AutoCloseFd",
          "container": "AutoCloseFd",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/io.h",
          "lines": "241-241",
          "snippet": "inline AutoCloseFd(AutoCloseFd&& other) noexcept: fd(other.fd) { other.fd = -1; }",
          "includes": [
            "#include \"exception.h\"",
            "#include \"array.h\"",
            "#include \"common.h\"",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"exception.h\"\n#include \"array.h\"\n#include \"common.h\"\n#include <stddef.h>\n\nAutoCloseFd {\n  inline AutoCloseFd(AutoCloseFd&& other) noexcept: fd(other.fd) { other.fd = -1; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "KJ_SYSCALL",
          "args": [
            "fd = open(filename.cStr(), O_CREAT | O_WRONLY | O_TRUNC, 0666)",
            "filename"
          ],
          "line": 2883
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "filename.cStr()",
            "O_CREAT | O_WRONLY | O_TRUNC",
            "0666"
          ],
          "line": 2883
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filename.cStr",
          "args": [],
          "line": 2883
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "makeDirectory",
          "args": [
            "kj::str(filename.slice(0, *slashpos))"
          ],
          "line": 2878
        },
        "resolved": true,
        "details": {
          "function_name": "makeDirectory",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "2860-2872",
          "snippet": "void makeDirectory(kj::StringPtr path) {\n    KJ_IF_MAYBE(slashpos, path.findLast('/')) {\n      // Make the parent dir.\n      makeDirectory(kj::str(path.slice(0, *slashpos)));\n    }\n\n    if (mkdir(path.cStr(), 0777) < 0) {\n      int error = errno;\n      if (error != EEXIST) {\n        KJ_FAIL_SYSCALL(\"mkdir(path)\", error, path);\n      }\n    }\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nvoid makeDirectory(kj::StringPtr path) {\n    KJ_IF_MAYBE(slashpos, path.findLast('/')) {\n      // Make the parent dir.\n      makeDirectory(kj::str(path.slice(0, *slashpos)));\n    }\n\n    if (mkdir(path.cStr(), 0777) < 0) {\n      int error = errno;\n      if (error != EEXIST) {\n        KJ_FAIL_SYSCALL(\"mkdir(path)\", error, path);\n      }\n    }\n  }"
        }
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "filename.slice(0, *slashpos)"
          ],
          "line": 2878
        },
        "resolved": true,
        "details": {
          "function_name": "str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "341-341",
          "snippet": "inline String str(String&& s) { return mv(s); }",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\ninline String str(String&& s) { return mv(s); }"
        }
      },
      {
        "call_info": {
          "callee": "filename.slice",
          "args": [
            "0",
            "*slashpos"
          ],
          "line": 2878
        },
        "resolved": true,
        "details": {
          "function_name": "slice",
          "container": "ArrayPtr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "1154-1157",
          "snippet": "inline ArrayPtr slice(size_t start, size_t end) {\n    KJ_IREQUIRE(start <= end && end <= size_, \"Out-of-bounds ArrayPtr::slice().\");\n    return ArrayPtr(ptr + start, end - start);\n  }",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\nArrayPtr {\n  inline ArrayPtr slice(size_t start, size_t end) {\n      KJ_IREQUIRE(start <= end && end <= size_, \"Out-of-bounds ArrayPtr::slice().\");\n      return ArrayPtr(ptr + start, end - start);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "KJ_IF_MAYBE",
          "args": [
            "slashpos",
            "filename.findLast('/')"
          ],
          "line": 2876
        },
        "resolved": true,
        "details": {
          "function_name": "KJ_IF_MAYBE",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/parser.c++",
          "lines": "982-1016",
          "snippet": "KJ_IF_MAYBE(target, maybeTarget) {\n            if (target->value == \"*\") {\n              // Set all.\n              if (targets.value.size() > 1) {\n                errorReporter.addError(target->startByte, target->endByte,\n                    \"Wildcard should not be specified together with other targets.\");\n              }\n\n              for (auto field: dynamicBuilder.getSchema().getFields()) {\n                if (field.getProto().getName().startsWith(\"targets\")) {\n                  dynamicBuilder.set(field, true);\n                }\n              }\n            } else {\n              if (target->value.size() == 0 || target->value.size() >= 32 ||\n                  target->value[0] < 'a' || target->value[0] > 'z') {\n                errorReporter.addError(target->startByte, target->endByte,\n                                       \"Not a valid annotation target.\");\n              } else {\n                char buffer[64];\n                strcpy(buffer, \"targets\");\n                strcat(buffer, target->value.cStr());\n                buffer[strlen(\"targets\")] += 'A' - 'a';\n                KJ_IF_MAYBE(field, dynamicBuilder.getSchema().findFieldByName(buffer)) {\n                  if (dynamicBuilder.get(*field).as<bool>()) {\n                    errorReporter.addError(target->startByte, target->endByte,\n                                           \"Duplicate target specification.\");\n                  }\n                  dynamicBuilder.set(*field, true);\n                } else {\n                  errorReporter.addError(target->startByte, target->endByte,\n                                         \"Not a valid annotation target.\");\n                }\n              }\n            }",
          "includes": [
            "#include <windows.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <kj/debug.h>",
            "#include <capnp/dynamic.h>",
            "#include \"md5.h\"",
            "#include \"parser.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <windows.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <kj/debug.h>\n#include <capnp/dynamic.h>\n#include \"md5.h\"\n#include \"parser.h\"\n\nKJ_IF_MAYBE(target, maybeTarget) {\n            if (target->value == \"*\") {\n              // Set all.\n              if (targets.value.size() > 1) {\n                errorReporter.addError(target->startByte, target->endByte,\n                    \"Wildcard should not be specified together with other targets.\");\n              }\n\n              for (auto field: dynamicBuilder.getSchema().getFields()) {\n                if (field.getProto().getName().startsWith(\"targets\")) {\n                  dynamicBuilder.set(field, true);\n                }\n              }\n            } else {\n              if (target->value.size() == 0 || target->value.size() >= 32 ||\n                  target->value[0] < 'a' || target->value[0] > 'z') {\n                errorReporter.addError(target->startByte, target->endByte,\n                                       \"Not a valid annotation target.\");\n              } else {\n                char buffer[64];\n                strcpy(buffer, \"targets\");\n                strcat(buffer, target->value.cStr());\n                buffer[strlen(\"targets\")] += 'A' - 'a';\n                KJ_IF_MAYBE(field, dynamicBuilder.getSchema().findFieldByName(buffer)) {\n                  if (dynamicBuilder.get(*field).as<bool>()) {\n                    errorReporter.addError(target->startByte, target->endByte,\n                                           \"Duplicate target specification.\");\n                  }\n                  dynamicBuilder.set(*field, true);\n                } else {\n                  errorReporter.addError(target->startByte, target->endByte,\n                                         \"Not a valid annotation target.\");\n                }\n              }\n            }"
        }
      },
      {
        "call_info": {
          "callee": "filename.findLast",
          "args": [
            "'/'"
          ],
          "line": 2876
        },
        "resolved": true,
        "details": {
          "function_name": "findLast",
          "container": "String",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "183-183",
          "snippet": "inline Maybe<size_t> findLast(char c) const { return StringPtr(*this).findLast(c); }",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\nString {\n  inline Maybe<size_t> findLast(char c) const { return StringPtr(*this).findLast(c); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "filename.startsWith",
          "args": [
            "\"/\""
          ],
          "line": 2875
        },
        "resolved": true,
        "details": {
          "function_name": "startsWith",
          "container": "String",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "174-174",
          "snippet": "inline bool startsWith(const StringPtr& other) const { return StringPtr(*this).startsWith(other);}",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\nString {\n  inline bool startsWith(const StringPtr& other) const { return StringPtr(*this).startsWith(other);}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nvoid writeFile(kj::StringPtr filename, const kj::StringTree& text) {\n    if (!filename.startsWith(\"/\")) {\n      KJ_IF_MAYBE(slashpos, filename.findLast('/')) {\n        // Make the parent dir.\n        makeDirectory(kj::str(filename.slice(0, *slashpos)));\n      }\n    }\n\n    int fd;\n    KJ_SYSCALL(fd = open(filename.cStr(), O_CREAT | O_WRONLY | O_TRUNC, 0666), filename);\n    kj::FdOutputStream out((kj::AutoCloseFd(fd)));\n\n    text.visit(\n        [&](kj::ArrayPtr<const char> text) {\n          out.write(text.begin(), text.size());\n        });\n  }"
  },
  {
    "function_name": "makeDirectory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "2860-2872",
    "snippet": "void makeDirectory(kj::StringPtr path) {\n    KJ_IF_MAYBE(slashpos, path.findLast('/')) {\n      // Make the parent dir.\n      makeDirectory(kj::str(path.slice(0, *slashpos)));\n    }\n\n    if (mkdir(path.cStr(), 0777) < 0) {\n      int error = errno;\n      if (error != EEXIST) {\n        KJ_FAIL_SYSCALL(\"mkdir(path)\", error, path);\n      }\n    }\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "KJ_FAIL_SYSCALL",
          "args": [
            "\"mkdir(path)\"",
            "error",
            "path"
          ],
          "line": 2869
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mkdir",
          "args": [
            "path.cStr()",
            "0777"
          ],
          "line": 2866
        },
        "resolved": true,
        "details": {
          "function_name": "mkdir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/miniposix.h",
          "lines": "87-89",
          "snippet": "inline int mkdir(const char* path, int mode) {\n  return ::_mkdir(path);\n}",
          "includes": [
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <direct.h>",
            "#include <io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <direct.h>\n#include <io.h>\n\ninline int mkdir(const char* path, int mode) {\n  return ::_mkdir(path);\n}"
        }
      },
      {
        "call_info": {
          "callee": "path.cStr",
          "args": [],
          "line": 2866
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "path.slice(0, *slashpos)"
          ],
          "line": 2863
        },
        "resolved": true,
        "details": {
          "function_name": "str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "341-341",
          "snippet": "inline String str(String&& s) { return mv(s); }",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\ninline String str(String&& s) { return mv(s); }"
        }
      },
      {
        "call_info": {
          "callee": "path.slice",
          "args": [
            "0",
            "*slashpos"
          ],
          "line": 2863
        },
        "resolved": true,
        "details": {
          "function_name": "slice",
          "container": "ArrayPtr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "1154-1157",
          "snippet": "inline ArrayPtr slice(size_t start, size_t end) {\n    KJ_IREQUIRE(start <= end && end <= size_, \"Out-of-bounds ArrayPtr::slice().\");\n    return ArrayPtr(ptr + start, end - start);\n  }",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\nArrayPtr {\n  inline ArrayPtr slice(size_t start, size_t end) {\n      KJ_IREQUIRE(start <= end && end <= size_, \"Out-of-bounds ArrayPtr::slice().\");\n      return ArrayPtr(ptr + start, end - start);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "KJ_IF_MAYBE",
          "args": [
            "slashpos",
            "path.findLast('/')"
          ],
          "line": 2861
        },
        "resolved": true,
        "details": {
          "function_name": "KJ_IF_MAYBE",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/parser.c++",
          "lines": "982-1016",
          "snippet": "KJ_IF_MAYBE(target, maybeTarget) {\n            if (target->value == \"*\") {\n              // Set all.\n              if (targets.value.size() > 1) {\n                errorReporter.addError(target->startByte, target->endByte,\n                    \"Wildcard should not be specified together with other targets.\");\n              }\n\n              for (auto field: dynamicBuilder.getSchema().getFields()) {\n                if (field.getProto().getName().startsWith(\"targets\")) {\n                  dynamicBuilder.set(field, true);\n                }\n              }\n            } else {\n              if (target->value.size() == 0 || target->value.size() >= 32 ||\n                  target->value[0] < 'a' || target->value[0] > 'z') {\n                errorReporter.addError(target->startByte, target->endByte,\n                                       \"Not a valid annotation target.\");\n              } else {\n                char buffer[64];\n                strcpy(buffer, \"targets\");\n                strcat(buffer, target->value.cStr());\n                buffer[strlen(\"targets\")] += 'A' - 'a';\n                KJ_IF_MAYBE(field, dynamicBuilder.getSchema().findFieldByName(buffer)) {\n                  if (dynamicBuilder.get(*field).as<bool>()) {\n                    errorReporter.addError(target->startByte, target->endByte,\n                                           \"Duplicate target specification.\");\n                  }\n                  dynamicBuilder.set(*field, true);\n                } else {\n                  errorReporter.addError(target->startByte, target->endByte,\n                                         \"Not a valid annotation target.\");\n                }\n              }\n            }",
          "includes": [
            "#include <windows.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <kj/debug.h>",
            "#include <capnp/dynamic.h>",
            "#include \"md5.h\"",
            "#include \"parser.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <windows.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <kj/debug.h>\n#include <capnp/dynamic.h>\n#include \"md5.h\"\n#include \"parser.h\"\n\nKJ_IF_MAYBE(target, maybeTarget) {\n            if (target->value == \"*\") {\n              // Set all.\n              if (targets.value.size() > 1) {\n                errorReporter.addError(target->startByte, target->endByte,\n                    \"Wildcard should not be specified together with other targets.\");\n              }\n\n              for (auto field: dynamicBuilder.getSchema().getFields()) {\n                if (field.getProto().getName().startsWith(\"targets\")) {\n                  dynamicBuilder.set(field, true);\n                }\n              }\n            } else {\n              if (target->value.size() == 0 || target->value.size() >= 32 ||\n                  target->value[0] < 'a' || target->value[0] > 'z') {\n                errorReporter.addError(target->startByte, target->endByte,\n                                       \"Not a valid annotation target.\");\n              } else {\n                char buffer[64];\n                strcpy(buffer, \"targets\");\n                strcat(buffer, target->value.cStr());\n                buffer[strlen(\"targets\")] += 'A' - 'a';\n                KJ_IF_MAYBE(field, dynamicBuilder.getSchema().findFieldByName(buffer)) {\n                  if (dynamicBuilder.get(*field).as<bool>()) {\n                    errorReporter.addError(target->startByte, target->endByte,\n                                           \"Duplicate target specification.\");\n                  }\n                  dynamicBuilder.set(*field, true);\n                } else {\n                  errorReporter.addError(target->startByte, target->endByte,\n                                         \"Not a valid annotation target.\");\n                }\n              }\n            }"
        }
      },
      {
        "call_info": {
          "callee": "path.findLast",
          "args": [
            "'/'"
          ],
          "line": 2861
        },
        "resolved": true,
        "details": {
          "function_name": "findLast",
          "container": "String",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "183-183",
          "snippet": "inline Maybe<size_t> findLast(char c) const { return StringPtr(*this).findLast(c); }",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\nString {\n  inline Maybe<size_t> findLast(char c) const { return StringPtr(*this).findLast(c); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nvoid makeDirectory(kj::StringPtr path) {\n    KJ_IF_MAYBE(slashpos, path.findLast('/')) {\n      // Make the parent dir.\n      makeDirectory(kj::str(path.slice(0, *slashpos)));\n    }\n\n    if (mkdir(path.cStr(), 0777) < 0) {\n      int error = errno;\n      if (error != EEXIST) {\n        KJ_FAIL_SYSCALL(\"mkdir(path)\", error, path);\n      }\n    }\n  }"
  },
  {
    "function_name": "makeFileText",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "2742-2774",
    "snippet": "FileText makeFileText(Schema schema,\n                        schema::CodeGeneratorRequest::RequestedFile::Reader request) {\n    usedImports.clear();\n\n    auto node = schema.getProto();\n    auto displayName = node.getDisplayName();\n\n    kj::Vector<kj::ArrayPtr<const char>> namespaceParts;\n    kj::String namespacePrefix;\n\n    for (auto annotation: node.getAnnotations()) {\n      if (annotation.getId() == NAMESPACE_ANNOTATION_ID) {\n        kj::StringPtr ns = annotation.getValue().getText();\n        kj::StringPtr ns2 = ns;\n        namespacePrefix = kj::str(\"::\", ns);\n\n        for (;;) {\n          KJ_IF_MAYBE(colonPos, ns.findFirst(':')) {\n            namespaceParts.add(ns.slice(0, *colonPos));\n            ns = ns.slice(*colonPos);\n            if (!ns.startsWith(\"::\")) {\n              context.exitError(kj::str(displayName, \": invalid namespace spec: \", ns2));\n            }\n            ns = ns.slice(2);\n          } else {\n            namespaceParts.add(ns);\n            break;\n          }\n        }\n\n        break;\n      }\n    }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "schema::Node::Reader node;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "namespaceParts.add",
          "args": [
            "ns"
          ],
          "line": 2767
        },
        "resolved": true,
        "details": {
          "function_name": "add",
          "container": "ReusableObjects::ObjectSizeCounter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/null-common.h",
          "lines": "86-88",
          "snippet": "void add(size_t wordCount) {\n      maxSize = std::max(wordCount, maxSize);\n    }",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nReusableObjects {\n  ObjectSizeCounter {\n    void add(size_t wordCount) {\n          maxSize = std::max(wordCount, maxSize);\n        }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ns.slice",
          "args": [
            "2"
          ],
          "line": 2765
        },
        "resolved": true,
        "details": {
          "function_name": "slice",
          "container": "String",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "177-177",
          "snippet": "inline StringPtr slice(size_t start) const { return StringPtr(*this).slice(start); }",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\nString {\n  inline StringPtr slice(size_t start) const { return StringPtr(*this).slice(start); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "context.exitError",
          "args": [
            "kj::str(displayName, \": invalid namespace spec: \", ns2)"
          ],
          "line": 2763
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "displayName",
            "\": invalid namespace spec: \"",
            "ns2"
          ],
          "line": 2763
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ns.startsWith",
          "args": [
            "\"::\""
          ],
          "line": 2762
        },
        "resolved": true,
        "details": {
          "function_name": "startsWith",
          "container": "String",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "174-174",
          "snippet": "inline bool startsWith(const StringPtr& other) const { return StringPtr(*this).startsWith(other);}",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\nString {\n  inline bool startsWith(const StringPtr& other) const { return StringPtr(*this).startsWith(other);}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ns.slice",
          "args": [
            "0",
            "*colonPos"
          ],
          "line": 2760
        },
        "resolved": true,
        "details": {
          "function_name": "slice",
          "container": "ArrayPtr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "1154-1157",
          "snippet": "inline ArrayPtr slice(size_t start, size_t end) {\n    KJ_IREQUIRE(start <= end && end <= size_, \"Out-of-bounds ArrayPtr::slice().\");\n    return ArrayPtr(ptr + start, end - start);\n  }",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\nArrayPtr {\n  inline ArrayPtr slice(size_t start, size_t end) {\n      KJ_IREQUIRE(start <= end && end <= size_, \"Out-of-bounds ArrayPtr::slice().\");\n      return ArrayPtr(ptr + start, end - start);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "KJ_IF_MAYBE",
          "args": [
            "colonPos",
            "ns.findFirst(':')"
          ],
          "line": 2759
        },
        "resolved": true,
        "details": {
          "function_name": "KJ_IF_MAYBE",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/parser.c++",
          "lines": "982-1016",
          "snippet": "KJ_IF_MAYBE(target, maybeTarget) {\n            if (target->value == \"*\") {\n              // Set all.\n              if (targets.value.size() > 1) {\n                errorReporter.addError(target->startByte, target->endByte,\n                    \"Wildcard should not be specified together with other targets.\");\n              }\n\n              for (auto field: dynamicBuilder.getSchema().getFields()) {\n                if (field.getProto().getName().startsWith(\"targets\")) {\n                  dynamicBuilder.set(field, true);\n                }\n              }\n            } else {\n              if (target->value.size() == 0 || target->value.size() >= 32 ||\n                  target->value[0] < 'a' || target->value[0] > 'z') {\n                errorReporter.addError(target->startByte, target->endByte,\n                                       \"Not a valid annotation target.\");\n              } else {\n                char buffer[64];\n                strcpy(buffer, \"targets\");\n                strcat(buffer, target->value.cStr());\n                buffer[strlen(\"targets\")] += 'A' - 'a';\n                KJ_IF_MAYBE(field, dynamicBuilder.getSchema().findFieldByName(buffer)) {\n                  if (dynamicBuilder.get(*field).as<bool>()) {\n                    errorReporter.addError(target->startByte, target->endByte,\n                                           \"Duplicate target specification.\");\n                  }\n                  dynamicBuilder.set(*field, true);\n                } else {\n                  errorReporter.addError(target->startByte, target->endByte,\n                                         \"Not a valid annotation target.\");\n                }\n              }\n            }",
          "includes": [
            "#include <windows.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <kj/debug.h>",
            "#include <capnp/dynamic.h>",
            "#include \"md5.h\"",
            "#include \"parser.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <windows.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <kj/debug.h>\n#include <capnp/dynamic.h>\n#include \"md5.h\"\n#include \"parser.h\"\n\nKJ_IF_MAYBE(target, maybeTarget) {\n            if (target->value == \"*\") {\n              // Set all.\n              if (targets.value.size() > 1) {\n                errorReporter.addError(target->startByte, target->endByte,\n                    \"Wildcard should not be specified together with other targets.\");\n              }\n\n              for (auto field: dynamicBuilder.getSchema().getFields()) {\n                if (field.getProto().getName().startsWith(\"targets\")) {\n                  dynamicBuilder.set(field, true);\n                }\n              }\n            } else {\n              if (target->value.size() == 0 || target->value.size() >= 32 ||\n                  target->value[0] < 'a' || target->value[0] > 'z') {\n                errorReporter.addError(target->startByte, target->endByte,\n                                       \"Not a valid annotation target.\");\n              } else {\n                char buffer[64];\n                strcpy(buffer, \"targets\");\n                strcat(buffer, target->value.cStr());\n                buffer[strlen(\"targets\")] += 'A' - 'a';\n                KJ_IF_MAYBE(field, dynamicBuilder.getSchema().findFieldByName(buffer)) {\n                  if (dynamicBuilder.get(*field).as<bool>()) {\n                    errorReporter.addError(target->startByte, target->endByte,\n                                           \"Duplicate target specification.\");\n                  }\n                  dynamicBuilder.set(*field, true);\n                } else {\n                  errorReporter.addError(target->startByte, target->endByte,\n                                         \"Not a valid annotation target.\");\n                }\n              }\n            }"
        }
      },
      {
        "call_info": {
          "callee": "ns.findFirst",
          "args": [
            "':'"
          ],
          "line": 2759
        },
        "resolved": true,
        "details": {
          "function_name": "findFirst",
          "container": "String",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "182-182",
          "snippet": "inline Maybe<size_t> findFirst(char c) const { return StringPtr(*this).findFirst(c); }",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\nString {\n  inline Maybe<size_t> findFirst(char c) const { return StringPtr(*this).findFirst(c); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "\"::\"",
            "ns"
          ],
          "line": 2756
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "annotation.getValue",
          "args": [],
          "line": 2754
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "annotation.getValue",
          "args": [],
          "line": 2754
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "annotation.getId",
          "args": [],
          "line": 2753
        },
        "resolved": true,
        "details": {
          "function_name": "getId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
          "lines": "75-75",
          "snippet": "uint64_t getId() { return id; }",
          "includes": [
            "#include \"md5.h\"",
            "#include \"node-translator.h\"",
            "#include <unordered_map>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/message.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/arena.h>",
            "#include <kj/mutex.h>",
            "#include \"parser.h\"      // only for generateChildId()",
            "#include \"compiler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nuint64_t getId() { return id; }"
        }
      },
      {
        "call_info": {
          "callee": "node.getAnnotations",
          "args": [],
          "line": 2752
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "node.getDisplayName",
          "args": [],
          "line": 2747
        },
        "resolved": true,
        "details": {
          "function_name": "getDisplayName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-parser.c++",
          "lines": "416-418",
          "snippet": "kj::StringPtr getDisplayName() const override {\n    return displayName;\n  }",
          "includes": [
            "#include <sys/mman.h>",
            "#include <windows.h>",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/mutex.h>",
            "#include <unordered_map>",
            "#include <capnp/compiler/parser.h>",
            "#include <capnp/compiler/grammar.capnp.h>",
            "#include <capnp/compiler/lexer.h>",
            "#include <capnp/compiler/lexer.capnp.h>",
            "#include <capnp/compiler/compiler.h>",
            "#include \"message.h\"",
            "#include \"schema-parser.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/mman.h>\n#include <windows.h>\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/mutex.h>\n#include <unordered_map>\n#include <capnp/compiler/parser.h>\n#include <capnp/compiler/grammar.capnp.h>\n#include <capnp/compiler/lexer.h>\n#include <capnp/compiler/lexer.capnp.h>\n#include <capnp/compiler/compiler.h>\n#include \"message.h\"\n#include \"schema-parser.h\"\n\nkj::StringPtr getDisplayName() const override {\n    return displayName;\n  }"
        }
      },
      {
        "call_info": {
          "callee": "schema.getProto",
          "args": [],
          "line": 2746
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      },
      {
        "call_info": {
          "callee": "usedImports.clear",
          "args": [],
          "line": 2744
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "TestPipe",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-packed-test.c++",
          "lines": "51-54",
          "snippet": "void clear(size_t preferredReadSize = kj::maxValue) {\n    resetRead(preferredReadSize);\n    data.clear();\n  }",
          "includes": [
            "#include \"test-util.h\"",
            "#include <stdlib.h>",
            "#include <string>",
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"serialize-packed.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"test-util.h\"\n#include <stdlib.h>\n#include <string>\n#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"serialize-packed.h\"\n\nTestPipe {\n  void clear(size_t preferredReadSize = kj::maxValue) {\n      resetRead(preferredReadSize);\n      data.clear();\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nschema::Node::Reader node;\n\nFileText makeFileText(Schema schema,\n                        schema::CodeGeneratorRequest::RequestedFile::Reader request) {\n    usedImports.clear();\n\n    auto node = schema.getProto();\n    auto displayName = node.getDisplayName();\n\n    kj::Vector<kj::ArrayPtr<const char>> namespaceParts;\n    kj::String namespacePrefix;\n\n    for (auto annotation: node.getAnnotations()) {\n      if (annotation.getId() == NAMESPACE_ANNOTATION_ID) {\n        kj::StringPtr ns = annotation.getValue().getText();\n        kj::StringPtr ns2 = ns;\n        namespacePrefix = kj::str(\"::\", ns);\n\n        for (;;) {\n          KJ_IF_MAYBE(colonPos, ns.findFirst(':')) {\n            namespaceParts.add(ns.slice(0, *colonPos));\n            ns = ns.slice(*colonPos);\n            if (!ns.startsWith(\"::\")) {\n              context.exitError(kj::str(displayName, \": invalid namespace spec: \", ns2));\n            }\n            ns = ns.slice(2);\n          } else {\n            namespaceParts.add(ns);\n            break;\n          }\n        }\n\n        break;\n      }\n    }"
  },
  {
    "function_name": "makeNodeTextWithoutNested",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "2618-2733",
    "snippet": "NodeText makeNodeTextWithoutNested(kj::StringPtr namespace_, kj::StringPtr scope,\n                                     kj::StringPtr name, Schema schema,\n                                     kj::Array<kj::StringTree> nestedTypeDecls,\n                                     const TemplateContext& templateContext) {\n    auto proto = schema.getProto();\n    KJ_IF_MAYBE(annotatedName, annotationValue(proto, NAME_ANNOTATION_ID)) {\n      name = annotatedName->getText();\n    }\n    auto hexId = kj::hex(proto.getId());\n\n    switch (proto.which()) {\n      case schema::Node::FILE:\n        KJ_FAIL_REQUIRE(\"This method shouldn't be called on file nodes.\");\n\n      case schema::Node::STRUCT: {\n        StructText structText =\n            makeStructText(scope, name, schema.asStruct(), kj::mv(nestedTypeDecls),\n                           templateContext);\n\n        return NodeText {\n          kj::mv(structText.outerTypeDecl),\n          kj::mv(structText.outerTypeDef),\n          kj::mv(structText.readerBuilderDefs),\n          kj::mv(structText.inlineMethodDefs),\n\n          kj::strTree(),\n          kj::strTree(),\n\n          kj::mv(structText.sourceDefs),\n        };\n      }\n\n      case schema::Node::ENUM: {\n        auto enumerants = schema.asEnum().getEnumerants();\n\n        return NodeText {\n          scope.size() == 0 ? kj::strTree() : kj::strTree(\n              \"  typedef ::capnp::schemas::\", name, \"_\", hexId, \" \", name, \";\\n\"\n              \"\\n\"),\n\n          scope.size() > 0 ? kj::strTree() : kj::strTree(\n              \"typedef ::capnp::schemas::\", name, \"_\", hexId, \" \", name, \";\\n\"\n              \"\\n\"),\n\n          kj::strTree(),\n          kj::strTree(),\n\n          kj::strTree(\n              // We declare enums in the capnp::schemas namespace and then typedef them into\n              // place because we don't want them to be parameterized for generics.\n              \"enum class \", name, \"_\", hexId, \": uint16_t {\\n\",\n              KJ_MAP(e, enumerants) {\n                return kj::strTree(\"  \", toUpperCase(protoName(e.getProto())), \",\\n\");\n              },\n              \"};\\n\"\n              \"CAPNP_DECLARE_ENUM(\", name, \", \", hexId, \");\\n\"),\n          kj::strTree(\n              \"CAPNP_DEFINE_ENUM(\", name, \"_\", hexId, \", \", hexId, \");\\n\"),\n\n          kj::strTree(),\n        };\n      }\n\n      case schema::Node::INTERFACE: {\n        hasInterfaces = true;\n\n        InterfaceText interfaceText =\n            makeInterfaceText(scope, name, schema.asInterface(), kj::mv(nestedTypeDecls),\n                              templateContext);\n\n        return NodeText {\n          kj::mv(interfaceText.outerTypeDecl),\n          kj::mv(interfaceText.outerTypeDef),\n          kj::mv(interfaceText.clientServerDefs),\n          kj::mv(interfaceText.inlineMethodDefs),\n\n          kj::strTree(),\n          kj::strTree(),\n\n          kj::mv(interfaceText.sourceDefs),\n        };\n      }\n\n      case schema::Node::CONST: {\n        auto constText = makeConstText(scope, name, schema.asConst(), templateContext);\n\n        return NodeText {\n          scope.size() == 0 ? kj::strTree() : kj::strTree(\"  \", kj::mv(constText.decl)),\n          scope.size() > 0 ? kj::strTree() : kj::mv(constText.decl),\n          kj::strTree(),\n          kj::strTree(),\n\n          kj::strTree(),\n          kj::strTree(),\n\n          kj::mv(constText.def),\n        };\n      }\n\n      case schema::Node::ANNOTATION: {\n        return NodeText {\n          kj::strTree(),\n          kj::strTree(),\n          kj::strTree(),\n          kj::strTree(),\n\n          kj::strTree(),\n          kj::strTree(),\n\n          kj::strTree(),\n        };\n      }\n    }\n\n    KJ_UNREACHABLE;\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "kj::StringTree sourceDefs = kj::strTree(\n        KJ_MAP(n, nodeTexts) { return kj::mv(n.sourceFileDefs); });"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [],
          "line": 2727
        },
        "resolved": true,
        "details": {
          "function_name": "strTree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
          "lines": "206-208",
          "snippet": "StringTree strTree(Params&&... params) {\n  return StringTree::concat(_::toStringTreeOrCharSequence(kj::fwd<Params>(params))...);\n}",
          "includes": [
            "#include \"string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"string.h\"\n\nStringTree strTree(Params&&... params) {\n  return StringTree::concat(_::toStringTreeOrCharSequence(kj::fwd<Params>(params))...);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "constText.def"
          ],
          "line": 2713
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "constText.decl"
          ],
          "line": 2706
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scope.size",
          "args": [],
          "line": 2706
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-capnp.c++",
          "lines": "74-74",
          "snippet": "inline size_t size() const { return amount; }",
          "includes": [
            "#include \"config.h\"",
            "#include <map>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <map>\n#include <algorithm>\n#include <kj/main.h>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nIndent {\n  inline size_t size() const { return amount; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"  \"",
            "kj::mv(constText.decl)"
          ],
          "line": 2705
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "constText.decl"
          ],
          "line": 2705
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "makeConstText",
          "args": [
            "scope",
            "name",
            "schema.asConst()",
            "templateContext"
          ],
          "line": 2702
        },
        "resolved": true,
        "details": {
          "function_name": "makeConstText",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "2324-2425",
          "snippet": "ConstText makeConstText(kj::StringPtr scope, kj::StringPtr name, ConstSchema schema,\n                          const TemplateContext& templateContext) {\n    auto proto = schema.getProto();\n    auto constProto = proto.getConst();\n    auto type = schema.getType();\n    auto typeName_ = typeName(type, nullptr);\n    auto upperCase = toUpperCase(name);\n\n    // Linkage qualifier for non-primitive types.\n    const char* linkage = scope.size() == 0 ? \"extern \" : \"static \";\n\n    switch (type.which()) {\n      case schema::Value::BOOL:\n      case schema::Value::INT8:\n      case schema::Value::INT16:\n      case schema::Value::INT32:\n      case schema::Value::INT64:\n      case schema::Value::UINT8:\n      case schema::Value::UINT16:\n      case schema::Value::UINT32:\n      case schema::Value::UINT64:\n      case schema::Value::ENUM:\n        return ConstText {\n          false,\n          kj::strTree(\"static constexpr \", typeName_, ' ', upperCase, \" = \",\n              literalValue(schema.getType(), constProto.getValue()), \";\\n\"),\n          scope.size() == 0 ? kj::strTree() : kj::strTree(\n              // TODO(msvc): MSVC doesn't like definitions of constexprs, but other compilers and\n              //   the standard require them.\n              \"#ifndef _MSC_VER\\n\"\n              \"constexpr \", typeName_, ' ', scope, upperCase, \";\\n\"\n              \"#endif\\n\")\n        };\n\n      case schema::Value::VOID:\n      case schema::Value::FLOAT32:\n      case schema::Value::FLOAT64: {\n        // TODO(msvc): MSVC doesn't like float- or class-typed constexprs. As soon as this is fixed,\n        //   treat VOID, FLOAT32, and FLOAT64 the same as the other primitives.\n        kj::String value = literalValue(schema.getType(), constProto.getValue()).flatten();\n        return ConstText {\n          false,\n          kj::strTree(\"static KJ_CONSTEXPR(const) \", typeName_, ' ', upperCase,\n              \" CAPNP_NON_INT_CONSTEXPR_DECL_INIT(\", value, \");\\n\"),\n          scope.size() == 0 ? kj::strTree() : kj::strTree(\n              \"KJ_CONSTEXPR(const) \", typeName_, ' ', scope, upperCase,\n              \" CAPNP_NON_INT_CONSTEXPR_DEF_INIT(\", value, \");\\n\")\n        };\n      }\n\n      case schema::Value::TEXT: {\n        kj::String constType = kj::strTree(\n            \"::capnp::_::ConstText<\", schema.as<Text>().size(), \">\").flatten();\n        return ConstText {\n          true,\n          kj::strTree(linkage, \"const \", constType, ' ', upperCase, \";\\n\"),\n          kj::strTree(\"const \", constType, ' ', scope, upperCase, \"(::capnp::schemas::b_\",\n                      kj::hex(proto.getId()), \".words + \", schema.getValueSchemaOffset(), \");\\n\")\n        };\n      }\n\n      case schema::Value::DATA: {\n        kj::String constType = kj::strTree(\n            \"::capnp::_::ConstData<\", schema.as<Data>().size(), \">\").flatten();\n        return ConstText {\n          true,\n          kj::strTree(linkage, \"const \", constType, ' ', upperCase, \";\\n\"),\n          kj::strTree(\"const \", constType, ' ', scope, upperCase, \"(::capnp::schemas::b_\",\n                      kj::hex(proto.getId()), \".words + \", schema.getValueSchemaOffset(), \");\\n\")\n        };\n      }\n\n      case schema::Value::STRUCT: {\n        kj::String constType = kj::strTree(\n            \"::capnp::_::ConstStruct<\", typeName_, \">\").flatten();\n        return ConstText {\n          true,\n          kj::strTree(linkage, \"const \", constType, ' ', upperCase, \";\\n\"),\n          kj::strTree(\"const \", constType, ' ', scope, upperCase, \"(::capnp::schemas::b_\",\n                      kj::hex(proto.getId()), \".words + \", schema.getValueSchemaOffset(), \");\\n\")\n        };\n      }\n\n      case schema::Value::LIST: {\n        kj::String constType = kj::strTree(\n            \"::capnp::_::ConstList<\", typeName(type.asList().getElementType(), nullptr), \">\")\n            .flatten();\n        return ConstText {\n          true,\n          kj::strTree(linkage, \"const \", constType, ' ', upperCase, \";\\n\"),\n          kj::strTree(\"const \", constType, ' ', scope, upperCase, \"(::capnp::schemas::b_\",\n                      kj::hex(proto.getId()), \".words + \", schema.getValueSchemaOffset(), \");\\n\")\n        };\n      }\n\n      case schema::Value::ANY_POINTER:\n      case schema::Value::INTERFACE:\n        return ConstText { false, kj::strTree(), kj::strTree() };\n    }\n\n    KJ_UNREACHABLE;\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nConstText makeConstText(kj::StringPtr scope, kj::StringPtr name, ConstSchema schema,\n                          const TemplateContext& templateContext) {\n    auto proto = schema.getProto();\n    auto constProto = proto.getConst();\n    auto type = schema.getType();\n    auto typeName_ = typeName(type, nullptr);\n    auto upperCase = toUpperCase(name);\n\n    // Linkage qualifier for non-primitive types.\n    const char* linkage = scope.size() == 0 ? \"extern \" : \"static \";\n\n    switch (type.which()) {\n      case schema::Value::BOOL:\n      case schema::Value::INT8:\n      case schema::Value::INT16:\n      case schema::Value::INT32:\n      case schema::Value::INT64:\n      case schema::Value::UINT8:\n      case schema::Value::UINT16:\n      case schema::Value::UINT32:\n      case schema::Value::UINT64:\n      case schema::Value::ENUM:\n        return ConstText {\n          false,\n          kj::strTree(\"static constexpr \", typeName_, ' ', upperCase, \" = \",\n              literalValue(schema.getType(), constProto.getValue()), \";\\n\"),\n          scope.size() == 0 ? kj::strTree() : kj::strTree(\n              // TODO(msvc): MSVC doesn't like definitions of constexprs, but other compilers and\n              //   the standard require them.\n              \"#ifndef _MSC_VER\\n\"\n              \"constexpr \", typeName_, ' ', scope, upperCase, \";\\n\"\n              \"#endif\\n\")\n        };\n\n      case schema::Value::VOID:\n      case schema::Value::FLOAT32:\n      case schema::Value::FLOAT64: {\n        // TODO(msvc): MSVC doesn't like float- or class-typed constexprs. As soon as this is fixed,\n        //   treat VOID, FLOAT32, and FLOAT64 the same as the other primitives.\n        kj::String value = literalValue(schema.getType(), constProto.getValue()).flatten();\n        return ConstText {\n          false,\n          kj::strTree(\"static KJ_CONSTEXPR(const) \", typeName_, ' ', upperCase,\n              \" CAPNP_NON_INT_CONSTEXPR_DECL_INIT(\", value, \");\\n\"),\n          scope.size() == 0 ? kj::strTree() : kj::strTree(\n              \"KJ_CONSTEXPR(const) \", typeName_, ' ', scope, upperCase,\n              \" CAPNP_NON_INT_CONSTEXPR_DEF_INIT(\", value, \");\\n\")\n        };\n      }\n\n      case schema::Value::TEXT: {\n        kj::String constType = kj::strTree(\n            \"::capnp::_::ConstText<\", schema.as<Text>().size(), \">\").flatten();\n        return ConstText {\n          true,\n          kj::strTree(linkage, \"const \", constType, ' ', upperCase, \";\\n\"),\n          kj::strTree(\"const \", constType, ' ', scope, upperCase, \"(::capnp::schemas::b_\",\n                      kj::hex(proto.getId()), \".words + \", schema.getValueSchemaOffset(), \");\\n\")\n        };\n      }\n\n      case schema::Value::DATA: {\n        kj::String constType = kj::strTree(\n            \"::capnp::_::ConstData<\", schema.as<Data>().size(), \">\").flatten();\n        return ConstText {\n          true,\n          kj::strTree(linkage, \"const \", constType, ' ', upperCase, \";\\n\"),\n          kj::strTree(\"const \", constType, ' ', scope, upperCase, \"(::capnp::schemas::b_\",\n                      kj::hex(proto.getId()), \".words + \", schema.getValueSchemaOffset(), \");\\n\")\n        };\n      }\n\n      case schema::Value::STRUCT: {\n        kj::String constType = kj::strTree(\n            \"::capnp::_::ConstStruct<\", typeName_, \">\").flatten();\n        return ConstText {\n          true,\n          kj::strTree(linkage, \"const \", constType, ' ', upperCase, \";\\n\"),\n          kj::strTree(\"const \", constType, ' ', scope, upperCase, \"(::capnp::schemas::b_\",\n                      kj::hex(proto.getId()), \".words + \", schema.getValueSchemaOffset(), \");\\n\")\n        };\n      }\n\n      case schema::Value::LIST: {\n        kj::String constType = kj::strTree(\n            \"::capnp::_::ConstList<\", typeName(type.asList().getElementType(), nullptr), \">\")\n            .flatten();\n        return ConstText {\n          true,\n          kj::strTree(linkage, \"const \", constType, ' ', upperCase, \";\\n\"),\n          kj::strTree(\"const \", constType, ' ', scope, upperCase, \"(::capnp::schemas::b_\",\n                      kj::hex(proto.getId()), \".words + \", schema.getValueSchemaOffset(), \");\\n\")\n        };\n      }\n\n      case schema::Value::ANY_POINTER:\n      case schema::Value::INTERFACE:\n        return ConstText { false, kj::strTree(), kj::strTree() };\n    }\n\n    KJ_UNREACHABLE;\n  }"
        }
      },
      {
        "call_info": {
          "callee": "schema.asConst",
          "args": [],
          "line": 2702
        },
        "resolved": true,
        "details": {
          "function_name": "asConst",
          "container": "ArrayPtr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "1127-1129",
          "snippet": "inline ArrayPtr<const T> asConst() const {\n    return ArrayPtr<const T>(ptr, size_);\n  }",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\nArrayPtr {\n  inline ArrayPtr<const T> asConst() const {\n      return ArrayPtr<const T>(ptr, size_);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "interfaceText.sourceDefs"
          ],
          "line": 2697
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "interfaceText.inlineMethodDefs"
          ],
          "line": 2692
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "interfaceText.clientServerDefs"
          ],
          "line": 2691
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "interfaceText.outerTypeDef"
          ],
          "line": 2690
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "interfaceText.outerTypeDecl"
          ],
          "line": 2689
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "makeInterfaceText",
          "args": [
            "scope",
            "name",
            "schema.asInterface()",
            "kj::mv(nestedTypeDecls)",
            "templateContext"
          ],
          "line": 2685
        },
        "resolved": true,
        "details": {
          "function_name": "makeInterfaceText",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "2120-2314",
          "snippet": "InterfaceText makeInterfaceText(kj::StringPtr scope, kj::StringPtr name, InterfaceSchema schema,\n                                  kj::Array<kj::StringTree> nestedTypeDecls,\n                                  const TemplateContext& templateContext) {\n    auto fullName = kj::str(scope, name, templateContext.args());\n    auto methods = KJ_MAP(m, schema.getMethods()) {\n      return makeMethodText(fullName, m, templateContext);\n    };\n\n    auto proto = schema.getProto();\n    auto hexId = kj::hex(proto.getId());\n\n    auto superclasses = KJ_MAP(superclass, schema.getSuperclasses()) {\n      return ExtendInfo { cppFullName(superclass, nullptr), superclass.getProto().getId() };\n    };\n\n    CppTypeName clientName = cppFullName(schema, nullptr);\n    clientName.addMemberType(\"Client\");\n\n    kj::String templates = kj::str(templateContext.allDecls());  // Ends with a newline\n\n    // Private members struct\n    kj::StringTree declareText = kj::strTree(\n         \"  #if !CAPNP_LITE\\n\"\n         \"  struct _capnpPrivate {\\n\"\n         \"    CAPNP_DECLARE_INTERFACE_HEADER(\", hexId, \")\\n\");\n\n    kj::StringTree defineText = kj::strTree(\n        \"// \", fullName, \"\\n\",\n        \"#if !CAPNP_LITE\\n\",\n        templates, \"constexpr ::capnp::Kind \", fullName, \"::_capnpPrivate::kind;\\n\",\n        templates, \"constexpr ::capnp::_::RawSchema const* \", fullName, \"::_capnpPrivate::schema;\\n\",\n        templates, \"constexpr ::capnp::_::RawBrandedSchema const* \", fullName, \"::_capnpPrivate::brand;\\n\");\n\n    if (templateContext.isGeneric()) {\n      auto brandInitializers = makeBrandInitializers(templateContext, schema);\n      bool hasDeps = (brandInitializers.dependencies.size() != 0);\n\n      declareText = kj::strTree(kj::mv(declareText),\n          makeGenericDeclarations(templateContext, hasDeps));\n\n      defineText = kj::strTree(kj::mv(defineText),\n          makeGenericDefinitions(templates, fullName, kj::str(hexId), kj::mv(brandInitializers)));\n    } else {\n      declareText = kj::strTree(kj::mv(declareText),\n        \"    static constexpr ::capnp::_::RawBrandedSchema const* brand = &schema->defaultBrand;\\n\");\n    }\n\n    declareText = kj::strTree(kj::mv(declareText), \"  };\\n  #endif  // !CAPNP_LITE\");\n    defineText = kj::strTree(kj::mv(defineText), \"#endif  // !CAPNP_LITE\\n\\n\");\n\n    return InterfaceText {\n      kj::strTree(\n          templateContext.hasParams() ? \"  \" : \"\", templateContext.decl(true),\n          \"  struct \", name, \";\\n\"),\n\n      kj::strTree(\n          templateContext.parentDecls(),\n          templateContext.decl(scope == nullptr),\n          \"struct \", scope, name, \" {\\n\",\n          \"  \", name, \"() = delete;\\n\"\n          \"\\n\"\n          \"#if !CAPNP_LITE\\n\"\n          \"  class Client;\\n\"\n          \"  class Server;\\n\"\n          \"#endif  // !CAPNP_LITE\\n\"\n          \"\\n\",\n          KJ_MAP(n, nestedTypeDecls) { return kj::mv(n); },\n          \"\\n\",\n          kj::mv(declareText), \"\\n\"\n          \"};\\n\"\n          \"\\n\"),\n\n      kj::strTree(\n          \"#if !CAPNP_LITE\\n\",\n          templateContext.allDecls(),\n          \"class \", fullName, \"::Client\\n\"\n          \"    : public virtual ::capnp::Capability::Client\",\n          KJ_MAP(s, superclasses) {\n            return kj::strTree(\",\\n      public virtual \", s.typeName, \"::Client\");\n          }, \" {\\n\"\n          \"public:\\n\"\n          \"  typedef \", fullName, \" Calls;\\n\"\n          \"  typedef \", fullName, \" Reads;\\n\"\n          \"\\n\"\n          \"  Client(decltype(nullptr));\\n\"\n          \"  explicit Client(::kj::Own< ::capnp::ClientHook>&& hook);\\n\"\n          \"  template <typename _t, typename = ::kj::EnableIf< ::kj::canConvert<_t*, Server*>()>>\\n\"\n          \"  Client(::kj::Own<_t>&& server);\\n\"\n          \"  template <typename _t, typename = ::kj::EnableIf< ::kj::canConvert<_t*, Client*>()>>\\n\"\n          \"  Client(::kj::Promise<_t>&& promise);\\n\"\n          \"  Client(::kj::Exception&& exception);\\n\"\n          \"  Client(Client&) = default;\\n\"\n          \"  Client(Client&&) = default;\\n\"\n          \"  Client& operator=(Client& other);\\n\"\n          \"  Client& operator=(Client&& other);\\n\"\n          \"\\n\",\n          KJ_MAP(m, methods) { return kj::mv(m.clientDecls); },\n          \"\\n\"\n          \"protected:\\n\"\n          \"  Client() = default;\\n\"\n          \"};\\n\"\n          \"\\n\",\n          templateContext.allDecls(),\n          \"class \", fullName, \"::Server\\n\"\n          \"    : public virtual ::capnp::Capability::Server\",\n          KJ_MAP(s, superclasses) {\n            return kj::strTree(\",\\n      public virtual \", s.typeName, \"::Server\");\n          }, \" {\\n\"\n          \"public:\\n\",\n          \"  typedef \", fullName, \" Serves;\\n\"\n          \"\\n\"\n          \"  ::kj::Promise<void> dispatchCall(uint64_t interfaceId, uint16_t methodId,\\n\"\n          \"      ::capnp::CallContext< ::capnp::AnyPointer, ::capnp::AnyPointer> context)\\n\"\n          \"      override;\\n\"\n          \"\\n\"\n          \"protected:\\n\",\n          KJ_MAP(m, methods) { return kj::mv(m.serverDecls); },\n          \"\\n\"\n          \"  ::kj::Promise<void> dispatchCallInternal(uint16_t methodId,\\n\"\n          \"      ::capnp::CallContext< ::capnp::AnyPointer, ::capnp::AnyPointer> context);\\n\"\n          \"};\\n\"\n          \"#endif  // !CAPNP_LITE\\n\"\n          \"\\n\"),\n\n      kj::strTree(\n          \"#if !CAPNP_LITE\\n\",\n          templateContext.allDecls(),\n          \"inline \", fullName, \"::Client::Client(decltype(nullptr))\\n\"\n          \"    : ::capnp::Capability::Client(nullptr) {}\\n\",\n          templateContext.allDecls(),\n          \"inline \", fullName, \"::Client::Client(\\n\"\n          \"    ::kj::Own< ::capnp::ClientHook>&& hook)\\n\"\n          \"    : ::capnp::Capability::Client(::kj::mv(hook)) {}\\n\",\n          templateContext.allDecls(),\n          \"template <typename _t, typename>\\n\"\n          \"inline \", fullName, \"::Client::Client(::kj::Own<_t>&& server)\\n\"\n          \"    : ::capnp::Capability::Client(::kj::mv(server)) {}\\n\",\n          templateContext.allDecls(),\n          \"template <typename _t, typename>\\n\"\n          \"inline \", fullName, \"::Client::Client(::kj::Promise<_t>&& promise)\\n\"\n          \"    : ::capnp::Capability::Client(::kj::mv(promise)) {}\\n\",\n          templateContext.allDecls(),\n          \"inline \", fullName, \"::Client::Client(::kj::Exception&& exception)\\n\"\n          \"    : ::capnp::Capability::Client(::kj::mv(exception)) {}\\n\",\n          templateContext.allDecls(),\n          \"inline \", clientName, \"& \", fullName, \"::Client::operator=(Client& other) {\\n\"\n          \"  ::capnp::Capability::Client::operator=(other);\\n\"\n          \"  return *this;\\n\"\n          \"}\\n\",\n          templateContext.allDecls(),\n          \"inline \", clientName, \"& \", fullName, \"::Client::operator=(Client&& other) {\\n\"\n          \"  ::capnp::Capability::Client::operator=(kj::mv(other));\\n\"\n          \"  return *this;\\n\"\n          \"}\\n\"\n          \"\\n\",\n          KJ_MAP(m, methods) { return kj::mv(m.inlineDefs); },\n          \"#endif  // !CAPNP_LITE\\n\"),\n\n      kj::strTree(\n          \"#if !CAPNP_LITE\\n\",\n          KJ_MAP(m, methods) { return kj::mv(m.sourceDefs); },\n          templateContext.allDecls(),\n          \"::kj::Promise<void> \", fullName, \"::Server::dispatchCall(\\n\"\n          \"    uint64_t interfaceId, uint16_t methodId,\\n\"\n          \"    ::capnp::CallContext< ::capnp::AnyPointer, ::capnp::AnyPointer> context) {\\n\"\n          \"  switch (interfaceId) {\\n\"\n          \"    case 0x\", kj::hex(proto.getId()), \"ull:\\n\"\n          \"      return dispatchCallInternal(methodId, context);\\n\",\n          KJ_MAP(s, superclasses) {\n            return kj::strTree(\n              \"    case 0x\", kj::hex(s.id), \"ull:\\n\"\n              \"      return \", s.typeName, \"::Server::dispatchCallInternal(methodId, context);\\n\");\n          },\n          \"    default:\\n\"\n          \"      return internalUnimplemented(\\\"\", proto.getDisplayName(), \"\\\", interfaceId);\\n\"\n          \"  }\\n\"\n          \"}\\n\",\n          templateContext.allDecls(),\n          \"::kj::Promise<void> \", fullName, \"::Server::dispatchCallInternal(\\n\"\n          \"    uint16_t methodId,\\n\"\n          \"    ::capnp::CallContext< ::capnp::AnyPointer, ::capnp::AnyPointer> context) {\\n\"\n          \"  switch (methodId) {\\n\",\n          KJ_MAP(m, methods) { return kj::mv(m.dispatchCase); },\n          \"    default:\\n\"\n          \"      (void)context;\\n\"\n          \"      return ::capnp::Capability::Server::internalUnimplemented(\\n\"\n          \"          \\\"\", proto.getDisplayName(), \"\\\",\\n\"\n          \"          0x\", kj::hex(proto.getId()), \"ull, methodId);\\n\"\n          \"  }\\n\"\n          \"}\\n\"\n          \"#endif  // !CAPNP_LITE\\n\"\n          \"\\n\",\n          kj::mv(defineText))\n    };\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "kj::StringTree sourceDefs = kj::strTree(\n        KJ_MAP(n, nodeTexts) { return kj::mv(n.sourceFileDefs); });"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::StringTree sourceDefs = kj::strTree(\n        KJ_MAP(n, nodeTexts) { return kj::mv(n.sourceFileDefs); });\n\nInterfaceText makeInterfaceText(kj::StringPtr scope, kj::StringPtr name, InterfaceSchema schema,\n                                  kj::Array<kj::StringTree> nestedTypeDecls,\n                                  const TemplateContext& templateContext) {\n    auto fullName = kj::str(scope, name, templateContext.args());\n    auto methods = KJ_MAP(m, schema.getMethods()) {\n      return makeMethodText(fullName, m, templateContext);\n    };\n\n    auto proto = schema.getProto();\n    auto hexId = kj::hex(proto.getId());\n\n    auto superclasses = KJ_MAP(superclass, schema.getSuperclasses()) {\n      return ExtendInfo { cppFullName(superclass, nullptr), superclass.getProto().getId() };\n    };\n\n    CppTypeName clientName = cppFullName(schema, nullptr);\n    clientName.addMemberType(\"Client\");\n\n    kj::String templates = kj::str(templateContext.allDecls());  // Ends with a newline\n\n    // Private members struct\n    kj::StringTree declareText = kj::strTree(\n         \"  #if !CAPNP_LITE\\n\"\n         \"  struct _capnpPrivate {\\n\"\n         \"    CAPNP_DECLARE_INTERFACE_HEADER(\", hexId, \")\\n\");\n\n    kj::StringTree defineText = kj::strTree(\n        \"// \", fullName, \"\\n\",\n        \"#if !CAPNP_LITE\\n\",\n        templates, \"constexpr ::capnp::Kind \", fullName, \"::_capnpPrivate::kind;\\n\",\n        templates, \"constexpr ::capnp::_::RawSchema const* \", fullName, \"::_capnpPrivate::schema;\\n\",\n        templates, \"constexpr ::capnp::_::RawBrandedSchema const* \", fullName, \"::_capnpPrivate::brand;\\n\");\n\n    if (templateContext.isGeneric()) {\n      auto brandInitializers = makeBrandInitializers(templateContext, schema);\n      bool hasDeps = (brandInitializers.dependencies.size() != 0);\n\n      declareText = kj::strTree(kj::mv(declareText),\n          makeGenericDeclarations(templateContext, hasDeps));\n\n      defineText = kj::strTree(kj::mv(defineText),\n          makeGenericDefinitions(templates, fullName, kj::str(hexId), kj::mv(brandInitializers)));\n    } else {\n      declareText = kj::strTree(kj::mv(declareText),\n        \"    static constexpr ::capnp::_::RawBrandedSchema const* brand = &schema->defaultBrand;\\n\");\n    }\n\n    declareText = kj::strTree(kj::mv(declareText), \"  };\\n  #endif  // !CAPNP_LITE\");\n    defineText = kj::strTree(kj::mv(defineText), \"#endif  // !CAPNP_LITE\\n\\n\");\n\n    return InterfaceText {\n      kj::strTree(\n          templateContext.hasParams() ? \"  \" : \"\", templateContext.decl(true),\n          \"  struct \", name, \";\\n\"),\n\n      kj::strTree(\n          templateContext.parentDecls(),\n          templateContext.decl(scope == nullptr),\n          \"struct \", scope, name, \" {\\n\",\n          \"  \", name, \"() = delete;\\n\"\n          \"\\n\"\n          \"#if !CAPNP_LITE\\n\"\n          \"  class Client;\\n\"\n          \"  class Server;\\n\"\n          \"#endif  // !CAPNP_LITE\\n\"\n          \"\\n\",\n          KJ_MAP(n, nestedTypeDecls) { return kj::mv(n); },\n          \"\\n\",\n          kj::mv(declareText), \"\\n\"\n          \"};\\n\"\n          \"\\n\"),\n\n      kj::strTree(\n          \"#if !CAPNP_LITE\\n\",\n          templateContext.allDecls(),\n          \"class \", fullName, \"::Client\\n\"\n          \"    : public virtual ::capnp::Capability::Client\",\n          KJ_MAP(s, superclasses) {\n            return kj::strTree(\",\\n      public virtual \", s.typeName, \"::Client\");\n          }, \" {\\n\"\n          \"public:\\n\"\n          \"  typedef \", fullName, \" Calls;\\n\"\n          \"  typedef \", fullName, \" Reads;\\n\"\n          \"\\n\"\n          \"  Client(decltype(nullptr));\\n\"\n          \"  explicit Client(::kj::Own< ::capnp::ClientHook>&& hook);\\n\"\n          \"  template <typename _t, typename = ::kj::EnableIf< ::kj::canConvert<_t*, Server*>()>>\\n\"\n          \"  Client(::kj::Own<_t>&& server);\\n\"\n          \"  template <typename _t, typename = ::kj::EnableIf< ::kj::canConvert<_t*, Client*>()>>\\n\"\n          \"  Client(::kj::Promise<_t>&& promise);\\n\"\n          \"  Client(::kj::Exception&& exception);\\n\"\n          \"  Client(Client&) = default;\\n\"\n          \"  Client(Client&&) = default;\\n\"\n          \"  Client& operator=(Client& other);\\n\"\n          \"  Client& operator=(Client&& other);\\n\"\n          \"\\n\",\n          KJ_MAP(m, methods) { return kj::mv(m.clientDecls); },\n          \"\\n\"\n          \"protected:\\n\"\n          \"  Client() = default;\\n\"\n          \"};\\n\"\n          \"\\n\",\n          templateContext.allDecls(),\n          \"class \", fullName, \"::Server\\n\"\n          \"    : public virtual ::capnp::Capability::Server\",\n          KJ_MAP(s, superclasses) {\n            return kj::strTree(\",\\n      public virtual \", s.typeName, \"::Server\");\n          }, \" {\\n\"\n          \"public:\\n\",\n          \"  typedef \", fullName, \" Serves;\\n\"\n          \"\\n\"\n          \"  ::kj::Promise<void> dispatchCall(uint64_t interfaceId, uint16_t methodId,\\n\"\n          \"      ::capnp::CallContext< ::capnp::AnyPointer, ::capnp::AnyPointer> context)\\n\"\n          \"      override;\\n\"\n          \"\\n\"\n          \"protected:\\n\",\n          KJ_MAP(m, methods) { return kj::mv(m.serverDecls); },\n          \"\\n\"\n          \"  ::kj::Promise<void> dispatchCallInternal(uint16_t methodId,\\n\"\n          \"      ::capnp::CallContext< ::capnp::AnyPointer, ::capnp::AnyPointer> context);\\n\"\n          \"};\\n\"\n          \"#endif  // !CAPNP_LITE\\n\"\n          \"\\n\"),\n\n      kj::strTree(\n          \"#if !CAPNP_LITE\\n\",\n          templateContext.allDecls(),\n          \"inline \", fullName, \"::Client::Client(decltype(nullptr))\\n\"\n          \"    : ::capnp::Capability::Client(nullptr) {}\\n\",\n          templateContext.allDecls(),\n          \"inline \", fullName, \"::Client::Client(\\n\"\n          \"    ::kj::Own< ::capnp::ClientHook>&& hook)\\n\"\n          \"    : ::capnp::Capability::Client(::kj::mv(hook)) {}\\n\",\n          templateContext.allDecls(),\n          \"template <typename _t, typename>\\n\"\n          \"inline \", fullName, \"::Client::Client(::kj::Own<_t>&& server)\\n\"\n          \"    : ::capnp::Capability::Client(::kj::mv(server)) {}\\n\",\n          templateContext.allDecls(),\n          \"template <typename _t, typename>\\n\"\n          \"inline \", fullName, \"::Client::Client(::kj::Promise<_t>&& promise)\\n\"\n          \"    : ::capnp::Capability::Client(::kj::mv(promise)) {}\\n\",\n          templateContext.allDecls(),\n          \"inline \", fullName, \"::Client::Client(::kj::Exception&& exception)\\n\"\n          \"    : ::capnp::Capability::Client(::kj::mv(exception)) {}\\n\",\n          templateContext.allDecls(),\n          \"inline \", clientName, \"& \", fullName, \"::Client::operator=(Client& other) {\\n\"\n          \"  ::capnp::Capability::Client::operator=(other);\\n\"\n          \"  return *this;\\n\"\n          \"}\\n\",\n          templateContext.allDecls(),\n          \"inline \", clientName, \"& \", fullName, \"::Client::operator=(Client&& other) {\\n\"\n          \"  ::capnp::Capability::Client::operator=(kj::mv(other));\\n\"\n          \"  return *this;\\n\"\n          \"}\\n\"\n          \"\\n\",\n          KJ_MAP(m, methods) { return kj::mv(m.inlineDefs); },\n          \"#endif  // !CAPNP_LITE\\n\"),\n\n      kj::strTree(\n          \"#if !CAPNP_LITE\\n\",\n          KJ_MAP(m, methods) { return kj::mv(m.sourceDefs); },\n          templateContext.allDecls(),\n          \"::kj::Promise<void> \", fullName, \"::Server::dispatchCall(\\n\"\n          \"    uint64_t interfaceId, uint16_t methodId,\\n\"\n          \"    ::capnp::CallContext< ::capnp::AnyPointer, ::capnp::AnyPointer> context) {\\n\"\n          \"  switch (interfaceId) {\\n\"\n          \"    case 0x\", kj::hex(proto.getId()), \"ull:\\n\"\n          \"      return dispatchCallInternal(methodId, context);\\n\",\n          KJ_MAP(s, superclasses) {\n            return kj::strTree(\n              \"    case 0x\", kj::hex(s.id), \"ull:\\n\"\n              \"      return \", s.typeName, \"::Server::dispatchCallInternal(methodId, context);\\n\");\n          },\n          \"    default:\\n\"\n          \"      return internalUnimplemented(\\\"\", proto.getDisplayName(), \"\\\", interfaceId);\\n\"\n          \"  }\\n\"\n          \"}\\n\",\n          templateContext.allDecls(),\n          \"::kj::Promise<void> \", fullName, \"::Server::dispatchCallInternal(\\n\"\n          \"    uint16_t methodId,\\n\"\n          \"    ::capnp::CallContext< ::capnp::AnyPointer, ::capnp::AnyPointer> context) {\\n\"\n          \"  switch (methodId) {\\n\",\n          KJ_MAP(m, methods) { return kj::mv(m.dispatchCase); },\n          \"    default:\\n\"\n          \"      (void)context;\\n\"\n          \"      return ::capnp::Capability::Server::internalUnimplemented(\\n\"\n          \"          \\\"\", proto.getDisplayName(), \"\\\",\\n\"\n          \"          0x\", kj::hex(proto.getId()), \"ull, methodId);\\n\"\n          \"  }\\n\"\n          \"}\\n\"\n          \"#endif  // !CAPNP_LITE\\n\"\n          \"\\n\",\n          kj::mv(defineText))\n    };\n  }"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "nestedTypeDecls"
          ],
          "line": 2685
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.asInterface",
          "args": [],
          "line": 2685
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"CAPNP_DEFINE_ENUM(\"",
            "name",
            "\"_\"",
            "hexId",
            "\", \"",
            "hexId",
            "\");\\n\""
          ],
          "line": 2674
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "// We declare enums in the capnp::schemas namespace and then typedef them into// place because we don't want them to be parameterized for generics.\"enum class \"",
            "name",
            "\"_\"",
            "hexId",
            "\": uint16_t {\\n\"",
            "KJ_MAP(e, enumerants){\n                return kj::strTree(\"  \", toUpperCase(protoName(e.getProto())), \",\\n\");\n              }",
            "\"};\\n\"\n              \"CAPNP_DECLARE_ENUM(\"",
            "name",
            "\", \"",
            "hexId",
            "\");\\n\""
          ],
          "line": 2665
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"  \"",
            "toUpperCase(protoName(e.getProto()))",
            "\",\\n\""
          ],
          "line": 2670
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "toUpperCase",
          "args": [
            "protoName(e.getProto())"
          ],
          "line": 2670
        },
        "resolved": true,
        "details": {
          "function_name": "toUpperCase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "404-421",
          "snippet": "kj::String toUpperCase(kj::StringPtr name) {\n    kj::Vector<char> result(name.size() + 4);\n\n    for (char c: name) {\n      if ('a' <= c && c <= 'z') {\n        result.add(c - 'a' + 'A');\n      } else if (result.size() > 0 && 'A' <= c && c <= 'Z') {\n        result.add('_');\n        result.add(c);\n      } else {\n        result.add(c);\n      }\n    }\n\n    result.add('\\0');\n\n    return kj::String(result.releaseAsArray());\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::String toUpperCase(kj::StringPtr name) {\n    kj::Vector<char> result(name.size() + 4);\n\n    for (char c: name) {\n      if ('a' <= c && c <= 'z') {\n        result.add(c - 'a' + 'A');\n      } else if (result.size() > 0 && 'A' <= c && c <= 'Z') {\n        result.add('_');\n        result.add(c);\n      } else {\n        result.add(c);\n      }\n    }\n\n    result.add('\\0');\n\n    return kj::String(result.releaseAsArray());\n  }"
        }
      },
      {
        "call_info": {
          "callee": "protoName",
          "args": [
            "e.getProto()"
          ],
          "line": 2670
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "e.getProto",
          "args": [],
          "line": 2670
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "e",
            "enumerants"
          ],
          "line": 2669
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"typedef ::capnp::schemas::\"",
            "name",
            "\"_\"",
            "hexId",
            "\" \"",
            "name",
            "\";\\n\"\n              \"\\n\""
          ],
          "line": 2658
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"  typedef ::capnp::schemas::\"",
            "name",
            "\"_\"",
            "hexId",
            "\" \"",
            "name",
            "\";\\n\"\n              \"\\n\""
          ],
          "line": 2654
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.asEnum",
          "args": [],
          "line": 2651
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.asEnum",
          "args": [],
          "line": 2651
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "structText.sourceDefs"
          ],
          "line": 2646
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "structText.inlineMethodDefs"
          ],
          "line": 2641
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "structText.readerBuilderDefs"
          ],
          "line": 2640
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "structText.outerTypeDef"
          ],
          "line": 2639
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "structText.outerTypeDecl"
          ],
          "line": 2638
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "makeStructText",
          "args": [
            "scope",
            "name",
            "schema.asStruct()",
            "kj::mv(nestedTypeDecls)",
            "templateContext"
          ],
          "line": 2634
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "nestedTypeDecls"
          ],
          "line": 2634
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.asStruct",
          "args": [],
          "line": 2634
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_FAIL_REQUIRE",
          "args": [
            "\"This method shouldn't be called on file nodes.\""
          ],
          "line": 2630
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.which",
          "args": [],
          "line": 2628
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::hex",
          "args": [
            "proto.getId()"
          ],
          "line": 2626
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.getId",
          "args": [],
          "line": 2626
        },
        "resolved": true,
        "details": {
          "function_name": "getId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
          "lines": "75-75",
          "snippet": "uint64_t getId() { return id; }",
          "includes": [
            "#include \"md5.h\"",
            "#include \"node-translator.h\"",
            "#include <unordered_map>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/message.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/arena.h>",
            "#include <kj/mutex.h>",
            "#include \"parser.h\"      // only for generateChildId()",
            "#include \"compiler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nuint64_t getId() { return id; }"
        }
      },
      {
        "call_info": {
          "callee": "annotatedName->getText",
          "args": [],
          "line": 2624
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::StringTree sourceDefs = kj::strTree(\n        KJ_MAP(n, nodeTexts) { return kj::mv(n.sourceFileDefs); });\n\nNodeText makeNodeTextWithoutNested(kj::StringPtr namespace_, kj::StringPtr scope,\n                                     kj::StringPtr name, Schema schema,\n                                     kj::Array<kj::StringTree> nestedTypeDecls,\n                                     const TemplateContext& templateContext) {\n    auto proto = schema.getProto();\n    KJ_IF_MAYBE(annotatedName, annotationValue(proto, NAME_ANNOTATION_ID)) {\n      name = annotatedName->getText();\n    }\n    auto hexId = kj::hex(proto.getId());\n\n    switch (proto.which()) {\n      case schema::Node::FILE:\n        KJ_FAIL_REQUIRE(\"This method shouldn't be called on file nodes.\");\n\n      case schema::Node::STRUCT: {\n        StructText structText =\n            makeStructText(scope, name, schema.asStruct(), kj::mv(nestedTypeDecls),\n                           templateContext);\n\n        return NodeText {\n          kj::mv(structText.outerTypeDecl),\n          kj::mv(structText.outerTypeDef),\n          kj::mv(structText.readerBuilderDefs),\n          kj::mv(structText.inlineMethodDefs),\n\n          kj::strTree(),\n          kj::strTree(),\n\n          kj::mv(structText.sourceDefs),\n        };\n      }\n\n      case schema::Node::ENUM: {\n        auto enumerants = schema.asEnum().getEnumerants();\n\n        return NodeText {\n          scope.size() == 0 ? kj::strTree() : kj::strTree(\n              \"  typedef ::capnp::schemas::\", name, \"_\", hexId, \" \", name, \";\\n\"\n              \"\\n\"),\n\n          scope.size() > 0 ? kj::strTree() : kj::strTree(\n              \"typedef ::capnp::schemas::\", name, \"_\", hexId, \" \", name, \";\\n\"\n              \"\\n\"),\n\n          kj::strTree(),\n          kj::strTree(),\n\n          kj::strTree(\n              // We declare enums in the capnp::schemas namespace and then typedef them into\n              // place because we don't want them to be parameterized for generics.\n              \"enum class \", name, \"_\", hexId, \": uint16_t {\\n\",\n              KJ_MAP(e, enumerants) {\n                return kj::strTree(\"  \", toUpperCase(protoName(e.getProto())), \",\\n\");\n              },\n              \"};\\n\"\n              \"CAPNP_DECLARE_ENUM(\", name, \", \", hexId, \");\\n\"),\n          kj::strTree(\n              \"CAPNP_DEFINE_ENUM(\", name, \"_\", hexId, \", \", hexId, \");\\n\"),\n\n          kj::strTree(),\n        };\n      }\n\n      case schema::Node::INTERFACE: {\n        hasInterfaces = true;\n\n        InterfaceText interfaceText =\n            makeInterfaceText(scope, name, schema.asInterface(), kj::mv(nestedTypeDecls),\n                              templateContext);\n\n        return NodeText {\n          kj::mv(interfaceText.outerTypeDecl),\n          kj::mv(interfaceText.outerTypeDef),\n          kj::mv(interfaceText.clientServerDefs),\n          kj::mv(interfaceText.inlineMethodDefs),\n\n          kj::strTree(),\n          kj::strTree(),\n\n          kj::mv(interfaceText.sourceDefs),\n        };\n      }\n\n      case schema::Node::CONST: {\n        auto constText = makeConstText(scope, name, schema.asConst(), templateContext);\n\n        return NodeText {\n          scope.size() == 0 ? kj::strTree() : kj::strTree(\"  \", kj::mv(constText.decl)),\n          scope.size() > 0 ? kj::strTree() : kj::mv(constText.decl),\n          kj::strTree(),\n          kj::strTree(),\n\n          kj::strTree(),\n          kj::strTree(),\n\n          kj::mv(constText.def),\n        };\n      }\n\n      case schema::Node::ANNOTATION: {\n        return NodeText {\n          kj::strTree(),\n          kj::strTree(),\n          kj::strTree(),\n          kj::strTree(),\n\n          kj::strTree(),\n          kj::strTree(),\n\n          kj::strTree(),\n        };\n      }\n    }\n\n    KJ_UNREACHABLE;\n  }"
  },
  {
    "function_name": "makeNodeText",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "2439-2616",
    "snippet": "NodeText makeNodeText(kj::StringPtr namespace_, kj::StringPtr scope,\n                        kj::StringPtr name, Schema schema,\n                        const TemplateContext& parentTemplateContext) {\n    // `templateContext` is something like \"template <typename T>\\ntemplate <typename U>\\n\"\n    // declaring template parameters for all parent scopes.\n\n    auto proto = schema.getProto();\n    KJ_IF_MAYBE(annotatedName, annotationValue(proto, NAME_ANNOTATION_ID)) {\n      name = annotatedName->getText();\n    }\n    auto hexId = kj::hex(proto.getId());\n\n    TemplateContext templateContext(parentTemplateContext, proto);\n\n    auto subScope = kj::str(scope, name, templateContext.args(), \"::\");\n\n    // Compute nested nodes, including groups.\n    kj::Vector<NodeText> nestedTexts(proto.getNestedNodes().size());\n    for (auto nested: proto.getNestedNodes()) {\n      nestedTexts.add(makeNodeText(\n          namespace_, subScope, nested.getName(), schemaLoader.getUnbound(nested.getId()),\\\n          templateContext));\n    };\n\n    if (proto.isStruct()) {\n      for (auto field: proto.getStruct().getFields()) {\n        if (field.isGroup()) {\n          nestedTexts.add(makeNodeText(\n              namespace_, subScope, toTitleCase(protoName(field)),\n              schemaLoader.getUnbound(field.getGroup().getTypeId()),\n              templateContext));\n        }\n      }\n    } else if (proto.isInterface()) {\n      for (auto method: proto.getInterface().getMethods()) {\n        {\n          Schema params = schemaLoader.getUnbound(method.getParamStructType());\n          auto paramsProto = schemaLoader.getUnbound(method.getParamStructType()).getProto();\n          if (paramsProto.getScopeId() == 0) {\n            nestedTexts.add(makeNodeText(namespace_, subScope,\n                toTitleCase(kj::str(protoName(method), \"Params\")), params, templateContext));\n          }\n        }\n        {\n          Schema results = schemaLoader.getUnbound(method.getResultStructType());\n          auto resultsProto = schemaLoader.getUnbound(method.getResultStructType()).getProto();\n          if (resultsProto.getScopeId() == 0) {\n            nestedTexts.add(makeNodeText(namespace_, subScope,\n                toTitleCase(kj::str(protoName(method), \"Results\")), results, templateContext));\n          }\n        }\n      }\n    }\n\n    // Convert the encoded schema to a literal byte array.\n    kj::ArrayPtr<const word> rawSchema = schema.asUncheckedMessage();\n    auto schemaLiteral = kj::StringTree(KJ_MAP(w, rawSchema) {\n      const byte* bytes = reinterpret_cast<const byte*>(&w);\n\n      return kj::strTree(KJ_MAP(i, kj::range<uint>(0, sizeof(word))) {\n        auto text = kj::toCharSequence(kj::implicitCast<uint>(bytes[i]));\n        return kj::strTree(kj::repeat(' ', 4 - text.size()), text, \",\");\n      });\n    }, \"\\n   \");\n\n    auto schemaDecl = kj::strTree(\n        \"CAPNP_DECLARE_SCHEMA(\", hexId, \");\\n\");\n\n    std::set<uint64_t> deps;\n    enumerateDeps(proto, deps);\n\n    kj::Array<uint> membersByName;\n    kj::Array<uint> membersByDiscrim;\n    switch (proto.which()) {\n      case schema::Node::STRUCT: {\n        auto structSchema = schema.asStruct();\n        membersByName = makeMembersByName(structSchema.getFields());\n        auto builder = kj::heapArrayBuilder<uint>(structSchema.getFields().size());\n        for (auto field: structSchema.getUnionFields()) {\n          builder.add(field.getIndex());\n        }\n        for (auto field: structSchema.getNonUnionFields()) {\n          builder.add(field.getIndex());\n        }\n        membersByDiscrim = builder.finish();\n        break;\n      }\n      case schema::Node::ENUM:\n        membersByName = makeMembersByName(schema.asEnum().getEnumerants());\n        break;\n      case schema::Node::INTERFACE:\n        membersByName = makeMembersByName(schema.asInterface().getMethods());\n        break;\n      default:\n        break;\n    }\n\n    auto brandDeps = makeBrandDepInitializers(templateContext, schema.getGeneric());\n\n    auto schemaDef = kj::strTree(\n        \"static const ::capnp::_::AlignedData<\", rawSchema.size(), \"> b_\", hexId, \" = {\\n\"\n        \"  {\", kj::mv(schemaLiteral), \" }\\n\"\n        \"};\\n\"\n        \"::capnp::word const* const bp_\", hexId, \" = b_\", hexId, \".words;\\n\"\n        \"#if !CAPNP_LITE\\n\",\n        deps.size() == 0 ? kj::strTree() : kj::strTree(\n            \"static const ::capnp::_::RawSchema* const d_\", hexId, \"[] = {\\n\",\n            KJ_MAP(depId, deps) {\n              return kj::strTree(\"  &s_\", kj::hex(depId), \",\\n\");\n            },\n            \"};\\n\"),\n        membersByName.size() == 0 ? kj::strTree() : kj::strTree(\n            \"static const uint16_t m_\", hexId, \"[] = {\",\n            kj::StringTree(KJ_MAP(index, membersByName) { return kj::strTree(index); }, \", \"),\n            \"};\\n\"),\n        membersByDiscrim.size() == 0 ? kj::strTree() : kj::strTree(\n            \"static const uint16_t i_\", hexId, \"[] = {\",\n            kj::StringTree(KJ_MAP(index, membersByDiscrim) { return kj::strTree(index); }, \", \"),\n            \"};\\n\"),\n        brandDeps.size() == 0 ? kj::strTree() : kj::strTree(\n            \"const ::capnp::_::RawBrandedSchema::Dependency bd_\", hexId, \"[] = \", kj::mv(brandDeps), \";\\n\"),\n        \"const ::capnp::_::RawSchema s_\", hexId, \" = {\\n\"\n        \"  0x\", hexId, \", b_\", hexId, \".words, \", rawSchema.size(), \", \",\n        deps.size() == 0 ? kj::strTree(\"nullptr\") : kj::strTree(\"d_\", hexId), \", \",\n        membersByName.size() == 0 ? kj::strTree(\"nullptr\") : kj::strTree(\"m_\", hexId), \",\\n\",\n        \"  \", deps.size(), \", \", membersByName.size(), \", \",\n        membersByDiscrim.size() == 0 ? kj::strTree(\"nullptr\") : kj::strTree(\"i_\", hexId),\n        \", nullptr, nullptr, { &s_\", hexId, \", nullptr, \",\n        brandDeps.size() == 0 ? kj::strTree(\"nullptr, 0, 0\") : kj::strTree(\n            \"bd_\", hexId, \", 0, \" \"sizeof(bd_\", hexId, \") / sizeof(bd_\", hexId, \"[0])\"),\n        \", nullptr }\\n\"\n        \"};\\n\"\n        \"#endif  // !CAPNP_LITE\\n\");\n\n    NodeText top = makeNodeTextWithoutNested(\n        namespace_, scope, name, schema,\n        KJ_MAP(n, nestedTexts) { return kj::mv(n.outerTypeDecl); },\n        templateContext);\n\n    NodeText result = {\n      kj::mv(top.outerTypeDecl),\n\n      kj::strTree(\n          kj::mv(top.outerTypeDef),\n          KJ_MAP(n, nestedTexts) { return kj::mv(n.outerTypeDef); }),\n\n      kj::strTree(\n          kj::mv(top.readerBuilderDefs),\n          KJ_MAP(n, nestedTexts) { return kj::mv(n.readerBuilderDefs); }),\n\n      kj::strTree(\n          kj::mv(top.inlineMethodDefs),\n          KJ_MAP(n, nestedTexts) { return kj::mv(n.inlineMethodDefs); }),\n\n      kj::strTree(\n          kj::mv(schemaDecl),\n          kj::mv(top.capnpSchemaDecls),\n          KJ_MAP(n, nestedTexts) { return kj::mv(n.capnpSchemaDecls); }),\n\n      kj::strTree(\n          kj::mv(schemaDef),\n          kj::mv(top.capnpSchemaDefs),\n          KJ_MAP(n, nestedTexts) { return kj::mv(n.capnpSchemaDefs); }),\n\n      kj::strTree(\n          kj::mv(top.sourceFileDefs),\n          KJ_MAP(n, nestedTexts) { return kj::mv(n.sourceFileDefs); }),\n    };\n\n    if (templateContext.isGeneric()) {\n      // This is a template, so move all source declarations into the header.\n      result.inlineMethodDefs = kj::strTree(\n          kj::mv(result.inlineMethodDefs), kj::mv(result.sourceFileDefs));\n      result.sourceFileDefs = kj::strTree();\n    }\n\n    return result;\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [],
          "line": 2612
        },
        "resolved": true,
        "details": {
          "function_name": "strTree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
          "lines": "206-208",
          "snippet": "StringTree strTree(Params&&... params) {\n  return StringTree::concat(_::toStringTreeOrCharSequence(kj::fwd<Params>(params))...);\n}",
          "includes": [
            "#include \"string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"string.h\"\n\nStringTree strTree(Params&&... params) {\n  return StringTree::concat(_::toStringTreeOrCharSequence(kj::fwd<Params>(params))...);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "kj::mv(result.inlineMethodDefs)",
            "kj::mv(result.sourceFileDefs)"
          ],
          "line": 2610
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "result.sourceFileDefs"
          ],
          "line": 2611
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "result.inlineMethodDefs"
          ],
          "line": 2611
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.isGeneric",
          "args": [],
          "line": 2608
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "kj::mv(top.sourceFileDefs)",
            "KJ_MAP(n, nestedTexts){ return kj::mv(n.sourceFileDefs); }"
          ],
          "line": 2603
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "n.sourceFileDefs"
          ],
          "line": 2605
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "n",
            "nestedTexts"
          ],
          "line": 2605
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "top.sourceFileDefs"
          ],
          "line": 2604
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "kj::mv(schemaDef)",
            "kj::mv(top.capnpSchemaDefs)",
            "KJ_MAP(n, nestedTexts){ return kj::mv(n.capnpSchemaDefs); }"
          ],
          "line": 2598
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "n.capnpSchemaDefs"
          ],
          "line": 2601
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "n",
            "nestedTexts"
          ],
          "line": 2601
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "top.capnpSchemaDefs"
          ],
          "line": 2600
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "schemaDef"
          ],
          "line": 2599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "kj::mv(schemaDecl)",
            "kj::mv(top.capnpSchemaDecls)",
            "KJ_MAP(n, nestedTexts){ return kj::mv(n.capnpSchemaDecls); }"
          ],
          "line": 2593
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "n.capnpSchemaDecls"
          ],
          "line": 2596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "n",
            "nestedTexts"
          ],
          "line": 2596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "top.capnpSchemaDecls"
          ],
          "line": 2595
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "schemaDecl"
          ],
          "line": 2594
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "kj::mv(top.inlineMethodDefs)",
            "KJ_MAP(n, nestedTexts){ return kj::mv(n.inlineMethodDefs); }"
          ],
          "line": 2589
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "n.inlineMethodDefs"
          ],
          "line": 2591
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "n",
            "nestedTexts"
          ],
          "line": 2591
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "top.inlineMethodDefs"
          ],
          "line": 2590
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "kj::mv(top.readerBuilderDefs)",
            "KJ_MAP(n, nestedTexts){ return kj::mv(n.readerBuilderDefs); }"
          ],
          "line": 2585
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "n.readerBuilderDefs"
          ],
          "line": 2587
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "n",
            "nestedTexts"
          ],
          "line": 2587
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "top.readerBuilderDefs"
          ],
          "line": 2586
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "kj::mv(top.outerTypeDef)",
            "KJ_MAP(n, nestedTexts){ return kj::mv(n.outerTypeDef); }"
          ],
          "line": 2581
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "n.outerTypeDef"
          ],
          "line": 2583
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "n",
            "nestedTexts"
          ],
          "line": 2583
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "top.outerTypeDef"
          ],
          "line": 2582
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "top.outerTypeDecl"
          ],
          "line": 2579
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "makeNodeTextWithoutNested",
          "args": [
            "namespace_",
            "scope",
            "name",
            "schema",
            "KJ_MAP(n, nestedTexts){ return kj::mv(n.outerTypeDecl); }",
            "templateContext"
          ],
          "line": 2573
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "n.outerTypeDecl"
          ],
          "line": 2575
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "n",
            "nestedTexts"
          ],
          "line": 2575
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"static const ::capnp::_::AlignedData<\"",
            "rawSchema.size()",
            "\"> b_\"",
            "hexId",
            "\" = {\\n\"\n        \"  {\"",
            "kj::mv(schemaLiteral)",
            "\" }\\n\"\n        \"};\\n\"\n        \"::capnp::word const* const bp_\"",
            "hexId",
            "\" = b_\"",
            "hexId",
            "\".words;\\n\"\n        \"#if !CAPNP_LITE\\n\"",
            "deps.size() == 0 ? kj::strTree() : kj::strTree(\n            \"static const ::capnp::_::RawSchema* const d_\", hexId, \"[] = {\\n\",\n            KJ_MAP(depId, deps) {\n              return kj::strTree(\"  &s_\", kj::hex(depId), \",\\n\");\n            },\n            \"};\\n\")",
            "membersByName.size() == 0 ? kj::strTree() : kj::strTree(\n            \"static const uint16_t m_\", hexId, \"[] = {\",\n            kj::StringTree(KJ_MAP(index, membersByName) { return kj::strTree(index); }, \", \"),\n            \"};\\n\")",
            "membersByDiscrim.size() == 0 ? kj::strTree() : kj::strTree(\n            \"static const uint16_t i_\", hexId, \"[] = {\",\n            kj::StringTree(KJ_MAP(index, membersByDiscrim) { return kj::strTree(index); }, \", \"),\n            \"};\\n\")",
            "brandDeps.size() == 0 ? kj::strTree() : kj::strTree(\n            \"const ::capnp::_::RawBrandedSchema::Dependency bd_\", hexId, \"[] = \", kj::mv(brandDeps), \";\\n\")",
            "\"const ::capnp::_::RawSchema s_\"",
            "hexId",
            "\" = {\\n\"\n        \"  0x\"",
            "hexId",
            "\", b_\"",
            "hexId",
            "\".words, \"",
            "rawSchema.size()",
            "\", \"",
            "deps.size() == 0 ? kj::strTree(\"nullptr\") : kj::strTree(\"d_\", hexId)",
            "\", \"",
            "membersByName.size() == 0 ? kj::strTree(\"nullptr\") : kj::strTree(\"m_\", hexId)",
            "\",\\n\"",
            "\"  \"",
            "deps.size()",
            "\", \"",
            "membersByName.size()",
            "\", \"",
            "membersByDiscrim.size() == 0 ? kj::strTree(\"nullptr\") : kj::strTree(\"i_\", hexId)",
            "\", nullptr, nullptr, { &s_\"",
            "hexId",
            "\", nullptr, \"",
            "brandDeps.size() == 0 ? kj::strTree(\"nullptr, 0, 0\") : kj::strTree(\n            \"bd_\", hexId, \", 0, \" \"sizeof(bd_\", hexId, \") / sizeof(bd_\", hexId, \"[0])\")",
            "\", nullptr }\\n\"\n        \"};\\n\"\n        \"#endif  // !CAPNP_LITE\\n\""
          ],
          "line": 2538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"bd_\"",
            "hexId",
            "\", 0, \" \"sizeof(bd_\"",
            "hexId",
            "\") / sizeof(bd_\"",
            "hexId",
            "\"[0])\""
          ],
          "line": 2567
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"nullptr, 0, 0\""
          ],
          "line": 2567
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "brandDeps.size",
          "args": [],
          "line": 2567
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-capnp.c++",
          "lines": "74-74",
          "snippet": "inline size_t size() const { return amount; }",
          "includes": [
            "#include \"config.h\"",
            "#include <map>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <map>\n#include <algorithm>\n#include <kj/main.h>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nIndent {\n  inline size_t size() const { return amount; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"i_\"",
            "hexId"
          ],
          "line": 2565
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"nullptr\""
          ],
          "line": 2565
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"m_\"",
            "hexId"
          ],
          "line": 2563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"nullptr\""
          ],
          "line": 2563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"d_\"",
            "hexId"
          ],
          "line": 2562
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"nullptr\""
          ],
          "line": 2562
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"const ::capnp::_::RawBrandedSchema::Dependency bd_\"",
            "hexId",
            "\"[] = \"",
            "kj::mv(brandDeps)",
            "\";\\n\""
          ],
          "line": 2558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "brandDeps"
          ],
          "line": 2559
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"static const uint16_t i_\"",
            "hexId",
            "\"[] = {\"",
            "kj::StringTree(KJ_MAP(index, membersByDiscrim) { return kj::strTree(index); }, \", \")",
            "\"};\\n\""
          ],
          "line": 2554
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::StringTree",
          "args": [
            "KJ_MAP(index, membersByDiscrim){ return kj::strTree(index); }",
            "\", \""
          ],
          "line": 2556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "index"
          ],
          "line": 2556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "index",
            "membersByDiscrim"
          ],
          "line": 2556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"static const uint16_t m_\"",
            "hexId",
            "\"[] = {\"",
            "kj::StringTree(KJ_MAP(index, membersByName) { return kj::strTree(index); }, \", \")",
            "\"};\\n\""
          ],
          "line": 2550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::StringTree",
          "args": [
            "KJ_MAP(index, membersByName){ return kj::strTree(index); }",
            "\", \""
          ],
          "line": 2552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "index"
          ],
          "line": 2552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "index",
            "membersByName"
          ],
          "line": 2552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"static const ::capnp::_::RawSchema* const d_\"",
            "hexId",
            "\"[] = {\\n\"",
            "KJ_MAP(depId, deps){\n              return kj::strTree(\"  &s_\", kj::hex(depId), \",\\n\");\n            }",
            "\"};\\n\""
          ],
          "line": 2544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"  &s_\"",
            "kj::hex(depId)",
            "\",\\n\""
          ],
          "line": 2547
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::hex",
          "args": [
            "depId"
          ],
          "line": 2547
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "depId",
            "deps"
          ],
          "line": 2546
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "schemaLiteral"
          ],
          "line": 2540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "makeBrandDepInitializers",
          "args": [
            "templateContext",
            "schema.getGeneric()"
          ],
          "line": 2536
        },
        "resolved": true,
        "details": {
          "function_name": "makeBrandDepInitializers",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "699-753",
          "snippet": "kj::StringTree makeBrandDepInitializers(const TemplateContext& templateContext, Schema schema) {\n    // Build deps. Returns a braced initialiser list, or an empty string if there are no dependencies.\n    std::map<uint, kj::StringTree> depMap;\n\n#define ADD_DEP(kind, index, ...) \\\n    { \\\n      uint location = _::RawBrandedSchema::makeDepLocation( \\\n          _::RawBrandedSchema::DepKind::kind, index); \\\n      KJ_IF_MAYBE(dep, makeBrandDepInitializer(__VA_ARGS__)) { \\\n        depMap[location] = kj::mv(*dep); \\\n      } \\\n    }\n\n    switch (schema.getProto().which()) {\n      case schema::Node::FILE:\n      case schema::Node::ENUM:\n      case schema::Node::ANNOTATION:\n        break;\n\n      case schema::Node::STRUCT:\n        for (auto field: schema.asStruct().getFields()) {\n          ADD_DEP(FIELD, field.getIndex(), field.getType());\n        }\n        break;\n      case schema::Node::INTERFACE: {\n        auto interface = schema.asInterface();\n        auto superclasses = interface.getSuperclasses();\n        for (auto i: kj::indices(superclasses)) {\n          ADD_DEP(SUPERCLASS, i, superclasses[i]);\n        }\n        auto methods = interface.getMethods();\n        for (auto i: kj::indices(methods)) {\n          auto method = methods[i];\n          ADD_DEP(METHOD_PARAMS, i, method, method.getParamType(), \"Params\");\n          ADD_DEP(METHOD_RESULTS, i, method, method.getResultType(), \"Results\");\n        }\n        break;\n      }\n      case schema::Node::CONST:\n        ADD_DEP(CONST_TYPE, 0, schema.asConst().getType());\n        break;\n    }\n#undef ADD_DEP\n\n    if (!depMap.size()) {\n      return kj::strTree();\n    }\n\n    auto deps = kj::heapArrayBuilder<kj::StringTree>(depMap.size());\n    for (auto& entry: depMap) {\n      deps.add(kj::strTree(\"  { \", entry.first, \", \", kj::mv(entry.second), \" },\\n\"));\n    }\n\n    return kj::strTree(\"{\\n\", kj::StringTree(deps.finish(), \"\"), \"}\");\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::StringTree makeBrandDepInitializers(const TemplateContext& templateContext, Schema schema) {\n    // Build deps. Returns a braced initialiser list, or an empty string if there are no dependencies.\n    std::map<uint, kj::StringTree> depMap;\n\n#define ADD_DEP(kind, index, ...) \\\n    { \\\n      uint location = _::RawBrandedSchema::makeDepLocation( \\\n          _::RawBrandedSchema::DepKind::kind, index); \\\n      KJ_IF_MAYBE(dep, makeBrandDepInitializer(__VA_ARGS__)) { \\\n        depMap[location] = kj::mv(*dep); \\\n      } \\\n    }\n\n    switch (schema.getProto().which()) {\n      case schema::Node::FILE:\n      case schema::Node::ENUM:\n      case schema::Node::ANNOTATION:\n        break;\n\n      case schema::Node::STRUCT:\n        for (auto field: schema.asStruct().getFields()) {\n          ADD_DEP(FIELD, field.getIndex(), field.getType());\n        }\n        break;\n      case schema::Node::INTERFACE: {\n        auto interface = schema.asInterface();\n        auto superclasses = interface.getSuperclasses();\n        for (auto i: kj::indices(superclasses)) {\n          ADD_DEP(SUPERCLASS, i, superclasses[i]);\n        }\n        auto methods = interface.getMethods();\n        for (auto i: kj::indices(methods)) {\n          auto method = methods[i];\n          ADD_DEP(METHOD_PARAMS, i, method, method.getParamType(), \"Params\");\n          ADD_DEP(METHOD_RESULTS, i, method, method.getResultType(), \"Results\");\n        }\n        break;\n      }\n      case schema::Node::CONST:\n        ADD_DEP(CONST_TYPE, 0, schema.asConst().getType());\n        break;\n    }\n#undef ADD_DEP\n\n    if (!depMap.size()) {\n      return kj::strTree();\n    }\n\n    auto deps = kj::heapArrayBuilder<kj::StringTree>(depMap.size());\n    for (auto& entry: depMap) {\n      deps.add(kj::strTree(\"  { \", entry.first, \", \", kj::mv(entry.second), \" },\\n\"));\n    }\n\n    return kj::strTree(\"{\\n\", kj::StringTree(deps.finish(), \"\"), \"}\");\n  }"
        }
      },
      {
        "call_info": {
          "callee": "schema.getGeneric",
          "args": [],
          "line": 2536
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "makeMembersByName",
          "args": [
            "schema.asInterface().getMethods()"
          ],
          "line": 2530
        },
        "resolved": true,
        "details": {
          "function_name": "makeMembersByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "129-133",
          "snippet": "kj::Array<uint> makeMembersByName(MemberList&& members) {\n  auto sorted = KJ_MAP(member, members) { return member; };\n  std::sort(sorted.begin(), sorted.end(), OrderByName());\n  return KJ_MAP(member, sorted) { return member.getIndex(); };\n}",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::Array<uint> makeMembersByName(MemberList&& members) {\n  auto sorted = KJ_MAP(member, members) { return member; };\n  std::sort(sorted.begin(), sorted.end(), OrderByName());\n  return KJ_MAP(member, sorted) { return member.getIndex(); };\n}"
        }
      },
      {
        "call_info": {
          "callee": "schema.asInterface",
          "args": [],
          "line": 2530
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.asInterface",
          "args": [],
          "line": 2530
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.asEnum",
          "args": [],
          "line": 2527
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.asEnum",
          "args": [],
          "line": 2527
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.finish",
          "args": [],
          "line": 2523
        },
        "resolved": true,
        "details": {
          "function_name": "finish",
          "container": "ArrayBuilder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "369-382",
          "snippet": "Array<T> finish() {\n    // We could safely remove this check if we assume that the disposer implementation doesn't\n    // need to know the original capacity, as is thes case with HeapArrayDisposer since it uses\n    // operator new() or if we created a custom disposer for ArrayBuilder which stores the capacity\n    // in a prefix.  But that would make it hard to write cleverer heap allocators, and anyway this\n    // check might catch bugs.  Probably people should use Vector if they want to build arrays\n    // without knowing the final size in advance.\n    KJ_IREQUIRE(pos == endPtr, \"ArrayBuilder::finish() called prematurely.\");\n    Array<T> result(reinterpret_cast<T*>(ptr), pos - ptr, *disposer);\n    ptr = nullptr;\n    pos = nullptr;\n    endPtr = nullptr;\n    return result;\n  }",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\nArrayBuilder {\n  Array<T> finish() {\n      // We could safely remove this check if we assume that the disposer implementation doesn't\n      // need to know the original capacity, as is thes case with HeapArrayDisposer since it uses\n      // operator new() or if we created a custom disposer for ArrayBuilder which stores the capacity\n      // in a prefix.  But that would make it hard to write cleverer heap allocators, and anyway this\n      // check might catch bugs.  Probably people should use Vector if they want to build arrays\n      // without knowing the final size in advance.\n      KJ_IREQUIRE(pos == endPtr, \"ArrayBuilder::finish() called prematurely.\");\n      Array<T> result(reinterpret_cast<T*>(ptr), pos - ptr, *disposer);\n      ptr = nullptr;\n      pos = nullptr;\n      endPtr = nullptr;\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "builder.add",
          "args": [
            "field.getIndex()"
          ],
          "line": 2521
        },
        "resolved": true,
        "details": {
          "function_name": "add",
          "container": "ReusableObjects::ObjectSizeCounter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/null-common.h",
          "lines": "86-88",
          "snippet": "void add(size_t wordCount) {\n      maxSize = std::max(wordCount, maxSize);\n    }",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nReusableObjects {\n  ObjectSizeCounter {\n    void add(size_t wordCount) {\n          maxSize = std::max(wordCount, maxSize);\n        }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "field.getIndex",
          "args": [],
          "line": 2521
        },
        "resolved": true,
        "details": {
          "function_name": "getIndex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "487-487",
          "snippet": "inline uint getIndex() const { return ordinal; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline uint getIndex() const { return ordinal; }"
        }
      },
      {
        "call_info": {
          "callee": "structSchema.getNonUnionFields",
          "args": [],
          "line": 2520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structSchema.getUnionFields",
          "args": [],
          "line": 2517
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::heapArrayBuilder<uint>",
          "args": [
            "structSchema.getFields().size()"
          ],
          "line": 2516
        },
        "resolved": true,
        "details": {
          "function_name": "heapArrayBuilder",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "410-416",
          "snippet": "inline ArrayBuilder<T> heapArrayBuilder(size_t size) {\n  // Like `heapArray<T>()` but does not default-construct the elements.  You must construct them\n  // manually by calling `add()`.\n\n  return ArrayBuilder<T>(_::HeapArrayDisposer::allocateUninitialized<RemoveConst<T>>(size),\n                         size, _::HeapArrayDisposer::instance);\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\ninline ArrayBuilder<T> heapArrayBuilder(size_t size) {\n  // Like `heapArray<T>()` but does not default-construct the elements.  You must construct them\n  // manually by calling `add()`.\n\n  return ArrayBuilder<T>(_::HeapArrayDisposer::allocateUninitialized<RemoveConst<T>>(size),\n                         size, _::HeapArrayDisposer::instance);\n}"
        }
      },
      {
        "call_info": {
          "callee": "structSchema.getFields",
          "args": [],
          "line": 2516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structSchema.getFields",
          "args": [],
          "line": 2516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structSchema.getFields",
          "args": [],
          "line": 2515
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.asStruct",
          "args": [],
          "line": 2514
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.which",
          "args": [],
          "line": 2512
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "enumerateDeps",
          "args": [
            "proto",
            "deps"
          ],
          "line": 2508
        },
        "resolved": true,
        "details": {
          "function_name": "enumerateDeps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "86-119",
          "snippet": "void enumerateDeps(schema::Node::Reader node, std::set<uint64_t>& deps) {\n  switch (node.which()) {\n    case schema::Node::STRUCT: {\n      auto structNode = node.getStruct();\n      for (auto field: structNode.getFields()) {\n        switch (field.which()) {\n          case schema::Field::SLOT:\n            enumerateDeps(field.getSlot().getType(), deps);\n            break;\n          case schema::Field::GROUP:\n            deps.insert(field.getGroup().getTypeId());\n            break;\n        }\n      }\n      if (structNode.getIsGroup()) {\n        deps.insert(node.getScopeId());\n      }\n      break;\n    }\n    case schema::Node::INTERFACE: {\n      auto interfaceNode = node.getInterface();\n      for (auto superclass: interfaceNode.getSuperclasses()) {\n        deps.insert(superclass.getId());\n      }\n      for (auto method: interfaceNode.getMethods()) {\n        deps.insert(method.getParamStructType());\n        deps.insert(method.getResultStructType());\n      }\n      break;\n    }\n    default:\n      break;\n  }\n}",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "schema::Node::Reader node;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nschema::Node::Reader node;\n\nvoid enumerateDeps(schema::Node::Reader node, std::set<uint64_t>& deps) {\n  switch (node.which()) {\n    case schema::Node::STRUCT: {\n      auto structNode = node.getStruct();\n      for (auto field: structNode.getFields()) {\n        switch (field.which()) {\n          case schema::Field::SLOT:\n            enumerateDeps(field.getSlot().getType(), deps);\n            break;\n          case schema::Field::GROUP:\n            deps.insert(field.getGroup().getTypeId());\n            break;\n        }\n      }\n      if (structNode.getIsGroup()) {\n        deps.insert(node.getScopeId());\n      }\n      break;\n    }\n    case schema::Node::INTERFACE: {\n      auto interfaceNode = node.getInterface();\n      for (auto superclass: interfaceNode.getSuperclasses()) {\n        deps.insert(superclass.getId());\n      }\n      for (auto method: interfaceNode.getMethods()) {\n        deps.insert(method.getParamStructType());\n        deps.insert(method.getResultStructType());\n      }\n      break;\n    }\n    default:\n      break;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"CAPNP_DECLARE_SCHEMA(\"",
            "hexId",
            "\");\\n\""
          ],
          "line": 2504
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::StringTree",
          "args": [
            "KJ_MAP(w, rawSchema){\n      const byte* bytes = reinterpret_cast<const byte*>(&w);\n\n      return kj::strTree(KJ_MAP(i, kj::range<uint>(0, sizeof(word))) {\n        auto text = kj::toCharSequence(kj::implicitCast<uint>(bytes[i]));\n        return kj::strTree(kj::repeat(' ', 4 - text.size()), text, \",\");\n      });\n    }",
            "\"\\n   \""
          ],
          "line": 2495
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "KJ_MAP(i, kj::range<uint>(0, sizeof(word))){\n        auto text = kj::toCharSequence(kj::implicitCast<uint>(bytes[i]));\n        return kj::strTree(kj::repeat(' ', 4 - text.size()), text, \",\");\n      }"
          ],
          "line": 2498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "kj::repeat(' ', 4 - text.size())",
            "text",
            "\",\""
          ],
          "line": 2500
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::repeat",
          "args": [
            "' '",
            "4 - text.size()"
          ],
          "line": 2500
        },
        "resolved": true,
        "details": {
          "function_name": "repeat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "703-708",
          "snippet": "inline constexpr Repeat<Decay<T>> repeat(T&& value, size_t count) {\n  // Returns a fake iterable which contains `count` repeats of `value`.  Useful for e.g. creating\n  // a bunch of spaces:  `kj::repeat(' ', indent * 2)`\n\n  return Repeat<Decay<T>>(value, count);\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\ninline constexpr Repeat<Decay<T>> repeat(T&& value, size_t count) {\n  // Returns a fake iterable which contains `count` repeats of `value`.  Useful for e.g. creating\n  // a bunch of spaces:  `kj::repeat(' ', indent * 2)`\n\n  return Repeat<Decay<T>>(value, count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::toCharSequence",
          "args": [
            "kj::implicitCast<uint>(bytes[i])"
          ],
          "line": 2499
        },
        "resolved": true,
        "details": {
          "function_name": "toCharSequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "312-322",
          "snippet": "auto toCharSequence(T&& value) -> decltype(_::STR * kj::fwd<T>(value)) {\n  // Returns an iterable of chars that represent a textual representation of the value, suitable\n  // for debugging.\n  //\n  // Most users should use str() instead, but toCharSequence() may occasionally be useful to avoid\n  // heap allocation overhead that str() implies.\n  //\n  // To specialize this function for your type, see KJ_STRINGIFY.\n\n  return _::STR * kj::fwd<T>(value);\n}",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\nauto toCharSequence(T&& value) -> decltype(_::STR * kj::fwd<T>(value)) {\n  // Returns an iterable of chars that represent a textual representation of the value, suitable\n  // for debugging.\n  //\n  // Most users should use str() instead, but toCharSequence() may occasionally be useful to avoid\n  // heap allocation overhead that str() implies.\n  //\n  // To specialize this function for your type, see KJ_STRINGIFY.\n\n  return _::STR * kj::fwd<T>(value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::implicitCast<uint>",
          "args": [
            "bytes[i]"
          ],
          "line": 2499
        },
        "resolved": true,
        "details": {
          "function_name": "implicitCast",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "1203-1207",
          "snippet": "To implicitCast(From&& from) {\n  // `implicitCast<T>(value)` casts `value` to type `T` only if the conversion is implicit.  Useful\n  // for e.g. resolving ambiguous overloads without sacrificing type-safety.\n  return kj::fwd<From>(from);\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\nTo implicitCast(From&& from) {\n  // `implicitCast<T>(value)` casts `value` to type `T` only if the conversion is implicit.  Useful\n  // for e.g. resolving ambiguous overloads without sacrificing type-safety.\n  return kj::fwd<From>(from);\n}"
        }
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "i",
            "kj::range<uint>(0, sizeof(word))"
          ],
          "line": 2498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::range<uint>",
          "args": [
            "0",
            "sizeof(word)"
          ],
          "line": 2498
        },
        "resolved": true,
        "details": {
          "function_name": "range",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "642-642",
          "snippet": "inline constexpr Range<Decay<T>> range(T begin, T end) { return Range<Decay<T>>(begin, end); }",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\ninline constexpr Range<Decay<T>> range(T begin, T end) { return Range<Decay<T>>(begin, end); }"
        }
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<const byte*>",
          "args": [
            "&w"
          ],
          "line": 2496
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "w",
            "rawSchema"
          ],
          "line": 2495
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.asUncheckedMessage",
          "args": [],
          "line": 2494
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "makeNodeText",
          "args": [
            "namespace_",
            "subScope",
            "toTitleCase(kj::str(protoName(method), \"Results\"))",
            "results",
            "templateContext"
          ],
          "line": 2486
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "toTitleCase",
          "args": [
            "kj::str(protoName(method), \"Results\")"
          ],
          "line": 2487
        },
        "resolved": true,
        "details": {
          "function_name": "toTitleCase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "423-429",
          "snippet": "kj::String toTitleCase(kj::StringPtr name) {\n    kj::String result = kj::heapString(name);\n    if ('a' <= result[0] && result[0] <= 'z') {\n      result[0] = result[0] - 'a' + 'A';\n    }\n    return kj::mv(result);\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::String toTitleCase(kj::StringPtr name) {\n    kj::String result = kj::heapString(name);\n    if ('a' <= result[0] && result[0] <= 'z') {\n      result[0] = result[0] - 'a' + 'A';\n    }\n    return kj::mv(result);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "protoName(method)",
            "\"Results\""
          ],
          "line": 2487
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "protoName",
          "args": [
            "method"
          ],
          "line": 2487
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "resultsProto.getScopeId",
          "args": [],
          "line": 2485
        },
        "resolved": true,
        "details": {
          "function_name": "getScopeId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/node-translator.c++",
          "lines": "778-778",
          "snippet": "inline uint64_t getScopeId() { return leafId; }",
          "includes": [
            "#include <map>",
            "#include <set>",
            "#include <kj/arena.h>",
            "#include <kj/debug.h>",
            "#include \"parser.h\"      // only for generateGroupId()",
            "#include \"node-translator.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "uint64_t leafId;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <map>\n#include <set>\n#include <kj/arena.h>\n#include <kj/debug.h>\n#include \"parser.h\"      // only for generateGroupId()\n#include \"node-translator.h\"\n\nuint64_t leafId;\n\ninline uint64_t getScopeId() { return leafId; }"
        }
      },
      {
        "call_info": {
          "callee": "schemaLoader.getUnbound",
          "args": [],
          "line": 2484
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schemaLoader.getUnbound",
          "args": [
            "method.getResultStructType()"
          ],
          "line": 2484
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "method.getResultStructType",
          "args": [],
          "line": 2484
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schemaLoader.getUnbound",
          "args": [
            "method.getResultStructType()"
          ],
          "line": 2483
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "method.getResultStructType",
          "args": [],
          "line": 2483
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "makeNodeText",
          "args": [
            "namespace_",
            "subScope",
            "toTitleCase(kj::str(protoName(method), \"Params\"))",
            "params",
            "templateContext"
          ],
          "line": 2478
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "protoName(method)",
            "\"Params\""
          ],
          "line": 2479
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "protoName",
          "args": [
            "method"
          ],
          "line": 2479
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schemaLoader.getUnbound",
          "args": [],
          "line": 2476
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schemaLoader.getUnbound",
          "args": [
            "method.getParamStructType()"
          ],
          "line": 2476
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "method.getParamStructType",
          "args": [],
          "line": 2476
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schemaLoader.getUnbound",
          "args": [
            "method.getParamStructType()"
          ],
          "line": 2475
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "method.getParamStructType",
          "args": [],
          "line": 2475
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.getInterface",
          "args": [],
          "line": 2473
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.getInterface",
          "args": [],
          "line": 2473
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.isInterface",
          "args": [],
          "line": 2472
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "makeNodeText",
          "args": [
            "namespace_",
            "subScope",
            "toTitleCase(protoName(field))",
            "schemaLoader.getUnbound(field.getGroup().getTypeId())",
            "templateContext"
          ],
          "line": 2466
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schemaLoader.getUnbound",
          "args": [
            "field.getGroup().getTypeId()"
          ],
          "line": 2468
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getGroup",
          "args": [],
          "line": 2468
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getGroup",
          "args": [],
          "line": 2468
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "protoName",
          "args": [
            "field"
          ],
          "line": 2467
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.isGroup",
          "args": [],
          "line": 2465
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.getStruct",
          "args": [],
          "line": 2464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.getStruct",
          "args": [],
          "line": 2464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.isStruct",
          "args": [],
          "line": 2463
        },
        "resolved": true,
        "details": {
          "function_name": "isStruct",
          "container": "AnyPointer::Builder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "142-144",
          "snippet": "inline bool isStruct() {\n      return builder.isStruct();\n    }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nAnyPointer {\n  Builder {\n    inline bool isStruct() {\n          return builder.isStruct();\n        }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "makeNodeText",
          "args": [
            "namespace_",
            "subScope",
            "nested.getName()",
            "schemaLoader.getUnbound(nested.getId())",
            "templateContext"
          ],
          "line": 2458
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schemaLoader.getUnbound",
          "args": [
            "nested.getId()"
          ],
          "line": 2459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nested.getId",
          "args": [],
          "line": 2459
        },
        "resolved": true,
        "details": {
          "function_name": "getId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
          "lines": "75-75",
          "snippet": "uint64_t getId() { return id; }",
          "includes": [
            "#include \"md5.h\"",
            "#include \"node-translator.h\"",
            "#include <unordered_map>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/message.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/arena.h>",
            "#include <kj/mutex.h>",
            "#include \"parser.h\"      // only for generateChildId()",
            "#include \"compiler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nuint64_t getId() { return id; }"
        }
      },
      {
        "call_info": {
          "callee": "nested.getName",
          "args": [],
          "line": 2459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.getNestedNodes",
          "args": [],
          "line": 2457
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.getNestedNodes",
          "args": [],
          "line": 2456
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.getNestedNodes",
          "args": [],
          "line": 2456
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "scope",
            "name",
            "templateContext.args()",
            "\"::\""
          ],
          "line": 2453
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.args",
          "args": [],
          "line": 2453
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::hex",
          "args": [
            "proto.getId()"
          ],
          "line": 2449
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "annotatedName->getText",
          "args": [],
          "line": 2447
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getProto",
          "args": [],
          "line": 2445
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nNodeText makeNodeText(kj::StringPtr namespace_, kj::StringPtr scope,\n                        kj::StringPtr name, Schema schema,\n                        const TemplateContext& parentTemplateContext) {\n    // `templateContext` is something like \"template <typename T>\\ntemplate <typename U>\\n\"\n    // declaring template parameters for all parent scopes.\n\n    auto proto = schema.getProto();\n    KJ_IF_MAYBE(annotatedName, annotationValue(proto, NAME_ANNOTATION_ID)) {\n      name = annotatedName->getText();\n    }\n    auto hexId = kj::hex(proto.getId());\n\n    TemplateContext templateContext(parentTemplateContext, proto);\n\n    auto subScope = kj::str(scope, name, templateContext.args(), \"::\");\n\n    // Compute nested nodes, including groups.\n    kj::Vector<NodeText> nestedTexts(proto.getNestedNodes().size());\n    for (auto nested: proto.getNestedNodes()) {\n      nestedTexts.add(makeNodeText(\n          namespace_, subScope, nested.getName(), schemaLoader.getUnbound(nested.getId()),\\\n          templateContext));\n    };\n\n    if (proto.isStruct()) {\n      for (auto field: proto.getStruct().getFields()) {\n        if (field.isGroup()) {\n          nestedTexts.add(makeNodeText(\n              namespace_, subScope, toTitleCase(protoName(field)),\n              schemaLoader.getUnbound(field.getGroup().getTypeId()),\n              templateContext));\n        }\n      }\n    } else if (proto.isInterface()) {\n      for (auto method: proto.getInterface().getMethods()) {\n        {\n          Schema params = schemaLoader.getUnbound(method.getParamStructType());\n          auto paramsProto = schemaLoader.getUnbound(method.getParamStructType()).getProto();\n          if (paramsProto.getScopeId() == 0) {\n            nestedTexts.add(makeNodeText(namespace_, subScope,\n                toTitleCase(kj::str(protoName(method), \"Params\")), params, templateContext));\n          }\n        }\n        {\n          Schema results = schemaLoader.getUnbound(method.getResultStructType());\n          auto resultsProto = schemaLoader.getUnbound(method.getResultStructType()).getProto();\n          if (resultsProto.getScopeId() == 0) {\n            nestedTexts.add(makeNodeText(namespace_, subScope,\n                toTitleCase(kj::str(protoName(method), \"Results\")), results, templateContext));\n          }\n        }\n      }\n    }\n\n    // Convert the encoded schema to a literal byte array.\n    kj::ArrayPtr<const word> rawSchema = schema.asUncheckedMessage();\n    auto schemaLiteral = kj::StringTree(KJ_MAP(w, rawSchema) {\n      const byte* bytes = reinterpret_cast<const byte*>(&w);\n\n      return kj::strTree(KJ_MAP(i, kj::range<uint>(0, sizeof(word))) {\n        auto text = kj::toCharSequence(kj::implicitCast<uint>(bytes[i]));\n        return kj::strTree(kj::repeat(' ', 4 - text.size()), text, \",\");\n      });\n    }, \"\\n   \");\n\n    auto schemaDecl = kj::strTree(\n        \"CAPNP_DECLARE_SCHEMA(\", hexId, \");\\n\");\n\n    std::set<uint64_t> deps;\n    enumerateDeps(proto, deps);\n\n    kj::Array<uint> membersByName;\n    kj::Array<uint> membersByDiscrim;\n    switch (proto.which()) {\n      case schema::Node::STRUCT: {\n        auto structSchema = schema.asStruct();\n        membersByName = makeMembersByName(structSchema.getFields());\n        auto builder = kj::heapArrayBuilder<uint>(structSchema.getFields().size());\n        for (auto field: structSchema.getUnionFields()) {\n          builder.add(field.getIndex());\n        }\n        for (auto field: structSchema.getNonUnionFields()) {\n          builder.add(field.getIndex());\n        }\n        membersByDiscrim = builder.finish();\n        break;\n      }\n      case schema::Node::ENUM:\n        membersByName = makeMembersByName(schema.asEnum().getEnumerants());\n        break;\n      case schema::Node::INTERFACE:\n        membersByName = makeMembersByName(schema.asInterface().getMethods());\n        break;\n      default:\n        break;\n    }\n\n    auto brandDeps = makeBrandDepInitializers(templateContext, schema.getGeneric());\n\n    auto schemaDef = kj::strTree(\n        \"static const ::capnp::_::AlignedData<\", rawSchema.size(), \"> b_\", hexId, \" = {\\n\"\n        \"  {\", kj::mv(schemaLiteral), \" }\\n\"\n        \"};\\n\"\n        \"::capnp::word const* const bp_\", hexId, \" = b_\", hexId, \".words;\\n\"\n        \"#if !CAPNP_LITE\\n\",\n        deps.size() == 0 ? kj::strTree() : kj::strTree(\n            \"static const ::capnp::_::RawSchema* const d_\", hexId, \"[] = {\\n\",\n            KJ_MAP(depId, deps) {\n              return kj::strTree(\"  &s_\", kj::hex(depId), \",\\n\");\n            },\n            \"};\\n\"),\n        membersByName.size() == 0 ? kj::strTree() : kj::strTree(\n            \"static const uint16_t m_\", hexId, \"[] = {\",\n            kj::StringTree(KJ_MAP(index, membersByName) { return kj::strTree(index); }, \", \"),\n            \"};\\n\"),\n        membersByDiscrim.size() == 0 ? kj::strTree() : kj::strTree(\n            \"static const uint16_t i_\", hexId, \"[] = {\",\n            kj::StringTree(KJ_MAP(index, membersByDiscrim) { return kj::strTree(index); }, \", \"),\n            \"};\\n\"),\n        brandDeps.size() == 0 ? kj::strTree() : kj::strTree(\n            \"const ::capnp::_::RawBrandedSchema::Dependency bd_\", hexId, \"[] = \", kj::mv(brandDeps), \";\\n\"),\n        \"const ::capnp::_::RawSchema s_\", hexId, \" = {\\n\"\n        \"  0x\", hexId, \", b_\", hexId, \".words, \", rawSchema.size(), \", \",\n        deps.size() == 0 ? kj::strTree(\"nullptr\") : kj::strTree(\"d_\", hexId), \", \",\n        membersByName.size() == 0 ? kj::strTree(\"nullptr\") : kj::strTree(\"m_\", hexId), \",\\n\",\n        \"  \", deps.size(), \", \", membersByName.size(), \", \",\n        membersByDiscrim.size() == 0 ? kj::strTree(\"nullptr\") : kj::strTree(\"i_\", hexId),\n        \", nullptr, nullptr, { &s_\", hexId, \", nullptr, \",\n        brandDeps.size() == 0 ? kj::strTree(\"nullptr, 0, 0\") : kj::strTree(\n            \"bd_\", hexId, \", 0, \" \"sizeof(bd_\", hexId, \") / sizeof(bd_\", hexId, \"[0])\"),\n        \", nullptr }\\n\"\n        \"};\\n\"\n        \"#endif  // !CAPNP_LITE\\n\");\n\n    NodeText top = makeNodeTextWithoutNested(\n        namespace_, scope, name, schema,\n        KJ_MAP(n, nestedTexts) { return kj::mv(n.outerTypeDecl); },\n        templateContext);\n\n    NodeText result = {\n      kj::mv(top.outerTypeDecl),\n\n      kj::strTree(\n          kj::mv(top.outerTypeDef),\n          KJ_MAP(n, nestedTexts) { return kj::mv(n.outerTypeDef); }),\n\n      kj::strTree(\n          kj::mv(top.readerBuilderDefs),\n          KJ_MAP(n, nestedTexts) { return kj::mv(n.readerBuilderDefs); }),\n\n      kj::strTree(\n          kj::mv(top.inlineMethodDefs),\n          KJ_MAP(n, nestedTexts) { return kj::mv(n.inlineMethodDefs); }),\n\n      kj::strTree(\n          kj::mv(schemaDecl),\n          kj::mv(top.capnpSchemaDecls),\n          KJ_MAP(n, nestedTexts) { return kj::mv(n.capnpSchemaDecls); }),\n\n      kj::strTree(\n          kj::mv(schemaDef),\n          kj::mv(top.capnpSchemaDefs),\n          KJ_MAP(n, nestedTexts) { return kj::mv(n.capnpSchemaDefs); }),\n\n      kj::strTree(\n          kj::mv(top.sourceFileDefs),\n          KJ_MAP(n, nestedTexts) { return kj::mv(n.sourceFileDefs); }),\n    };\n\n    if (templateContext.isGeneric()) {\n      // This is a template, so move all source declarations into the header.\n      result.inlineMethodDefs = kj::strTree(\n          kj::mv(result.inlineMethodDefs), kj::mv(result.sourceFileDefs));\n      result.sourceFileDefs = kj::strTree();\n    }\n\n    return result;\n  }"
  },
  {
    "function_name": "makeConstText",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "2324-2425",
    "snippet": "ConstText makeConstText(kj::StringPtr scope, kj::StringPtr name, ConstSchema schema,\n                          const TemplateContext& templateContext) {\n    auto proto = schema.getProto();\n    auto constProto = proto.getConst();\n    auto type = schema.getType();\n    auto typeName_ = typeName(type, nullptr);\n    auto upperCase = toUpperCase(name);\n\n    // Linkage qualifier for non-primitive types.\n    const char* linkage = scope.size() == 0 ? \"extern \" : \"static \";\n\n    switch (type.which()) {\n      case schema::Value::BOOL:\n      case schema::Value::INT8:\n      case schema::Value::INT16:\n      case schema::Value::INT32:\n      case schema::Value::INT64:\n      case schema::Value::UINT8:\n      case schema::Value::UINT16:\n      case schema::Value::UINT32:\n      case schema::Value::UINT64:\n      case schema::Value::ENUM:\n        return ConstText {\n          false,\n          kj::strTree(\"static constexpr \", typeName_, ' ', upperCase, \" = \",\n              literalValue(schema.getType(), constProto.getValue()), \";\\n\"),\n          scope.size() == 0 ? kj::strTree() : kj::strTree(\n              // TODO(msvc): MSVC doesn't like definitions of constexprs, but other compilers and\n              //   the standard require them.\n              \"#ifndef _MSC_VER\\n\"\n              \"constexpr \", typeName_, ' ', scope, upperCase, \";\\n\"\n              \"#endif\\n\")\n        };\n\n      case schema::Value::VOID:\n      case schema::Value::FLOAT32:\n      case schema::Value::FLOAT64: {\n        // TODO(msvc): MSVC doesn't like float- or class-typed constexprs. As soon as this is fixed,\n        //   treat VOID, FLOAT32, and FLOAT64 the same as the other primitives.\n        kj::String value = literalValue(schema.getType(), constProto.getValue()).flatten();\n        return ConstText {\n          false,\n          kj::strTree(\"static KJ_CONSTEXPR(const) \", typeName_, ' ', upperCase,\n              \" CAPNP_NON_INT_CONSTEXPR_DECL_INIT(\", value, \");\\n\"),\n          scope.size() == 0 ? kj::strTree() : kj::strTree(\n              \"KJ_CONSTEXPR(const) \", typeName_, ' ', scope, upperCase,\n              \" CAPNP_NON_INT_CONSTEXPR_DEF_INIT(\", value, \");\\n\")\n        };\n      }\n\n      case schema::Value::TEXT: {\n        kj::String constType = kj::strTree(\n            \"::capnp::_::ConstText<\", schema.as<Text>().size(), \">\").flatten();\n        return ConstText {\n          true,\n          kj::strTree(linkage, \"const \", constType, ' ', upperCase, \";\\n\"),\n          kj::strTree(\"const \", constType, ' ', scope, upperCase, \"(::capnp::schemas::b_\",\n                      kj::hex(proto.getId()), \".words + \", schema.getValueSchemaOffset(), \");\\n\")\n        };\n      }\n\n      case schema::Value::DATA: {\n        kj::String constType = kj::strTree(\n            \"::capnp::_::ConstData<\", schema.as<Data>().size(), \">\").flatten();\n        return ConstText {\n          true,\n          kj::strTree(linkage, \"const \", constType, ' ', upperCase, \";\\n\"),\n          kj::strTree(\"const \", constType, ' ', scope, upperCase, \"(::capnp::schemas::b_\",\n                      kj::hex(proto.getId()), \".words + \", schema.getValueSchemaOffset(), \");\\n\")\n        };\n      }\n\n      case schema::Value::STRUCT: {\n        kj::String constType = kj::strTree(\n            \"::capnp::_::ConstStruct<\", typeName_, \">\").flatten();\n        return ConstText {\n          true,\n          kj::strTree(linkage, \"const \", constType, ' ', upperCase, \";\\n\"),\n          kj::strTree(\"const \", constType, ' ', scope, upperCase, \"(::capnp::schemas::b_\",\n                      kj::hex(proto.getId()), \".words + \", schema.getValueSchemaOffset(), \");\\n\")\n        };\n      }\n\n      case schema::Value::LIST: {\n        kj::String constType = kj::strTree(\n            \"::capnp::_::ConstList<\", typeName(type.asList().getElementType(), nullptr), \">\")\n            .flatten();\n        return ConstText {\n          true,\n          kj::strTree(linkage, \"const \", constType, ' ', upperCase, \";\\n\"),\n          kj::strTree(\"const \", constType, ' ', scope, upperCase, \"(::capnp::schemas::b_\",\n                      kj::hex(proto.getId()), \".words + \", schema.getValueSchemaOffset(), \");\\n\")\n        };\n      }\n\n      case schema::Value::ANY_POINTER:\n      case schema::Value::INTERFACE:\n        return ConstText { false, kj::strTree(), kj::strTree() };\n    }\n\n    KJ_UNREACHABLE;\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [],
          "line": 2421
        },
        "resolved": true,
        "details": {
          "function_name": "strTree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
          "lines": "206-208",
          "snippet": "StringTree strTree(Params&&... params) {\n  return StringTree::concat(_::toStringTreeOrCharSequence(kj::fwd<Params>(params))...);\n}",
          "includes": [
            "#include \"string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"string.h\"\n\nStringTree strTree(Params&&... params) {\n  return StringTree::concat(_::toStringTreeOrCharSequence(kj::fwd<Params>(params))...);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"const \"",
            "constType",
            "' '",
            "scope",
            "upperCase",
            "\"(::capnp::schemas::b_\"",
            "kj::hex(proto.getId())",
            "\".words + \"",
            "schema.getValueSchemaOffset()",
            "\");\\n\""
          ],
          "line": 2414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getValueSchemaOffset",
          "args": [],
          "line": 2415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::hex",
          "args": [
            "proto.getId()"
          ],
          "line": 2415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.getId",
          "args": [],
          "line": 2415
        },
        "resolved": true,
        "details": {
          "function_name": "getId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
          "lines": "75-75",
          "snippet": "uint64_t getId() { return id; }",
          "includes": [
            "#include \"md5.h\"",
            "#include \"node-translator.h\"",
            "#include <unordered_map>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/message.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/arena.h>",
            "#include <kj/mutex.h>",
            "#include \"parser.h\"      // only for generateChildId()",
            "#include \"compiler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nuint64_t getId() { return id; }"
        }
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "linkage",
            "\"const \"",
            "constType",
            "' '",
            "upperCase",
            "\";\\n\""
          ],
          "line": 2413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"::capnp::_::ConstList<\"",
            "typeName(type.asList().getElementType(), nullptr)",
            "\">\""
          ],
          "line": 2408
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typeName",
          "args": [
            "type.asList().getElementType()",
            "nullptr"
          ],
          "line": 2409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.asList",
          "args": [],
          "line": 2409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.asList",
          "args": [],
          "line": 2409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"const \"",
            "constType",
            "' '",
            "scope",
            "upperCase",
            "\"(::capnp::schemas::b_\"",
            "kj::hex(proto.getId())",
            "\".words + \"",
            "schema.getValueSchemaOffset()",
            "\");\\n\""
          ],
          "line": 2402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getValueSchemaOffset",
          "args": [],
          "line": 2403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::hex",
          "args": [
            "proto.getId()"
          ],
          "line": 2403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "linkage",
            "\"const \"",
            "constType",
            "' '",
            "upperCase",
            "\";\\n\""
          ],
          "line": 2401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"::capnp::_::ConstStruct<\"",
            "typeName_",
            "\">\""
          ],
          "line": 2397
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"const \"",
            "constType",
            "' '",
            "scope",
            "upperCase",
            "\"(::capnp::schemas::b_\"",
            "kj::hex(proto.getId())",
            "\".words + \"",
            "schema.getValueSchemaOffset()",
            "\");\\n\""
          ],
          "line": 2391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getValueSchemaOffset",
          "args": [],
          "line": 2392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::hex",
          "args": [
            "proto.getId()"
          ],
          "line": 2392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "linkage",
            "\"const \"",
            "constType",
            "' '",
            "upperCase",
            "\";\\n\""
          ],
          "line": 2390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"::capnp::_::ConstData<\"",
            "schema.as<Data>().size()",
            "\">\""
          ],
          "line": 2386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.as<Data>",
          "args": [],
          "line": 2387
        },
        "resolved": true,
        "details": {
          "function_name": "as",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "601-604",
          "snippet": "BuilderFor<T> as() {\n    // T must be List<U>.\n    return BuilderFor<T>(_builder);\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nBuilderFor<T> as() {\n    // T must be List<U>.\n    return BuilderFor<T>(_builder);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"const \"",
            "constType",
            "' '",
            "scope",
            "upperCase",
            "\"(::capnp::schemas::b_\"",
            "kj::hex(proto.getId())",
            "\".words + \"",
            "schema.getValueSchemaOffset()",
            "\");\\n\""
          ],
          "line": 2380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getValueSchemaOffset",
          "args": [],
          "line": 2381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::hex",
          "args": [
            "proto.getId()"
          ],
          "line": 2381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "linkage",
            "\"const \"",
            "constType",
            "' '",
            "upperCase",
            "\";\\n\""
          ],
          "line": 2379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"::capnp::_::ConstText<\"",
            "schema.as<Text>().size()",
            "\">\""
          ],
          "line": 2375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"KJ_CONSTEXPR(const) \"",
            "typeName_",
            "' '",
            "scope",
            "upperCase",
            "\" CAPNP_NON_INT_CONSTEXPR_DEF_INIT(\"",
            "value",
            "\");\\n\""
          ],
          "line": 2368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scope.size",
          "args": [],
          "line": 2368
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-capnp.c++",
          "lines": "74-74",
          "snippet": "inline size_t size() const { return amount; }",
          "includes": [
            "#include \"config.h\"",
            "#include <map>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <map>\n#include <algorithm>\n#include <kj/main.h>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nIndent {\n  inline size_t size() const { return amount; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"static KJ_CONSTEXPR(const) \"",
            "typeName_",
            "' '",
            "upperCase",
            "\" CAPNP_NON_INT_CONSTEXPR_DECL_INIT(\"",
            "value",
            "\");\\n\""
          ],
          "line": 2366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "literalValue",
          "args": [],
          "line": 2363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "literalValue",
          "args": [
            "schema.getType()",
            "constProto.getValue()"
          ],
          "line": 2363
        },
        "resolved": true,
        "details": {
          "function_name": "literalValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "517-560",
          "snippet": "kj::StringTree literalValue(Type type, schema::Value::Reader value) {\n    switch (value.which()) {\n      case schema::Value::VOID: return kj::strTree(\" ::capnp::VOID\");\n      case schema::Value::BOOL: return kj::strTree(value.getBool() ? \"true\" : \"false\");\n      case schema::Value::INT8: return kj::strTree(value.getInt8());\n      case schema::Value::INT16: return kj::strTree(value.getInt16());\n      case schema::Value::INT32: return kj::strTree(value.getInt32());\n      case schema::Value::INT64: return kj::strTree(value.getInt64(), \"ll\");\n      case schema::Value::UINT8: return kj::strTree(value.getUint8(), \"u\");\n      case schema::Value::UINT16: return kj::strTree(value.getUint16(), \"u\");\n      case schema::Value::UINT32: return kj::strTree(value.getUint32(), \"u\");\n      case schema::Value::UINT64: return kj::strTree(value.getUint64(), \"llu\");\n      case schema::Value::FLOAT32: {\n        auto text = kj::str(value.getFloat32());\n        if (text.findFirst('.') == nullptr &&\n            text.findFirst('e') == nullptr &&\n            text.findFirst('E') == nullptr) {\n          text = kj::str(text, \".0\");\n        }\n        return kj::strTree(kj::mv(text), \"f\");\n      }\n      case schema::Value::FLOAT64: return kj::strTree(value.getFloat64());\n      case schema::Value::ENUM: {\n        EnumSchema schema = type.asEnum();\n        if (value.getEnum() < schema.getEnumerants().size()) {\n          return kj::strTree(\n              cppFullName(schema, nullptr), \"::\",\n              toUpperCase(protoName(schema.getEnumerants()[value.getEnum()].getProto())));\n        } else {\n          return kj::strTree(\"static_cast<\", cppFullName(schema, nullptr),\n                             \">(\", value.getEnum(), \")\");\n        }\n      }\n\n      case schema::Value::TEXT:\n      case schema::Value::DATA:\n      case schema::Value::STRUCT:\n      case schema::Value::INTERFACE:\n      case schema::Value::LIST:\n      case schema::Value::ANY_POINTER:\n        KJ_FAIL_REQUIRE(\"literalValue() can only be used on primitive types.\");\n    }\n    KJ_UNREACHABLE;\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::StringTree literalValue(Type type, schema::Value::Reader value) {\n    switch (value.which()) {\n      case schema::Value::VOID: return kj::strTree(\" ::capnp::VOID\");\n      case schema::Value::BOOL: return kj::strTree(value.getBool() ? \"true\" : \"false\");\n      case schema::Value::INT8: return kj::strTree(value.getInt8());\n      case schema::Value::INT16: return kj::strTree(value.getInt16());\n      case schema::Value::INT32: return kj::strTree(value.getInt32());\n      case schema::Value::INT64: return kj::strTree(value.getInt64(), \"ll\");\n      case schema::Value::UINT8: return kj::strTree(value.getUint8(), \"u\");\n      case schema::Value::UINT16: return kj::strTree(value.getUint16(), \"u\");\n      case schema::Value::UINT32: return kj::strTree(value.getUint32(), \"u\");\n      case schema::Value::UINT64: return kj::strTree(value.getUint64(), \"llu\");\n      case schema::Value::FLOAT32: {\n        auto text = kj::str(value.getFloat32());\n        if (text.findFirst('.') == nullptr &&\n            text.findFirst('e') == nullptr &&\n            text.findFirst('E') == nullptr) {\n          text = kj::str(text, \".0\");\n        }\n        return kj::strTree(kj::mv(text), \"f\");\n      }\n      case schema::Value::FLOAT64: return kj::strTree(value.getFloat64());\n      case schema::Value::ENUM: {\n        EnumSchema schema = type.asEnum();\n        if (value.getEnum() < schema.getEnumerants().size()) {\n          return kj::strTree(\n              cppFullName(schema, nullptr), \"::\",\n              toUpperCase(protoName(schema.getEnumerants()[value.getEnum()].getProto())));\n        } else {\n          return kj::strTree(\"static_cast<\", cppFullName(schema, nullptr),\n                             \">(\", value.getEnum(), \")\");\n        }\n      }\n\n      case schema::Value::TEXT:\n      case schema::Value::DATA:\n      case schema::Value::STRUCT:\n      case schema::Value::INTERFACE:\n      case schema::Value::LIST:\n      case schema::Value::ANY_POINTER:\n        KJ_FAIL_REQUIRE(\"literalValue() can only be used on primitive types.\");\n    }\n    KJ_UNREACHABLE;\n  }"
        }
      },
      {
        "call_info": {
          "callee": "constProto.getValue",
          "args": [],
          "line": 2363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getType",
          "args": [],
          "line": 2363
        },
        "resolved": true,
        "details": {
          "function_name": "getType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "942-942",
          "snippet": "inline DynamicValue::Type getType() { return type; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline DynamicValue::Type getType() { return type; }"
        }
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "// TODO(msvc): MSVC doesn't like definitions of constexprs, but other compilers and//   the standard require them.\"#ifndef _MSC_VER\\n\"\n              \"constexpr \"",
            "typeName_",
            "' '",
            "scope",
            "upperCase",
            "\";\\n\"\n              \"#endif\\n\""
          ],
          "line": 2350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"static constexpr \"",
            "typeName_",
            "' '",
            "upperCase",
            "\" = \"",
            "literalValue(schema.getType(), constProto.getValue())",
            "\";\\n\""
          ],
          "line": 2348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "constProto.getValue",
          "args": [],
          "line": 2349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.which",
          "args": [],
          "line": 2335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "toUpperCase",
          "args": [
            "name"
          ],
          "line": 2330
        },
        "resolved": true,
        "details": {
          "function_name": "toUpperCase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "404-421",
          "snippet": "kj::String toUpperCase(kj::StringPtr name) {\n    kj::Vector<char> result(name.size() + 4);\n\n    for (char c: name) {\n      if ('a' <= c && c <= 'z') {\n        result.add(c - 'a' + 'A');\n      } else if (result.size() > 0 && 'A' <= c && c <= 'Z') {\n        result.add('_');\n        result.add(c);\n      } else {\n        result.add(c);\n      }\n    }\n\n    result.add('\\0');\n\n    return kj::String(result.releaseAsArray());\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::String toUpperCase(kj::StringPtr name) {\n    kj::Vector<char> result(name.size() + 4);\n\n    for (char c: name) {\n      if ('a' <= c && c <= 'z') {\n        result.add(c - 'a' + 'A');\n      } else if (result.size() > 0 && 'A' <= c && c <= 'Z') {\n        result.add('_');\n        result.add(c);\n      } else {\n        result.add(c);\n      }\n    }\n\n    result.add('\\0');\n\n    return kj::String(result.releaseAsArray());\n  }"
        }
      },
      {
        "call_info": {
          "callee": "typeName",
          "args": [
            "type",
            "nullptr"
          ],
          "line": 2329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.getConst",
          "args": [],
          "line": 2327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getProto",
          "args": [],
          "line": 2326
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nConstText makeConstText(kj::StringPtr scope, kj::StringPtr name, ConstSchema schema,\n                          const TemplateContext& templateContext) {\n    auto proto = schema.getProto();\n    auto constProto = proto.getConst();\n    auto type = schema.getType();\n    auto typeName_ = typeName(type, nullptr);\n    auto upperCase = toUpperCase(name);\n\n    // Linkage qualifier for non-primitive types.\n    const char* linkage = scope.size() == 0 ? \"extern \" : \"static \";\n\n    switch (type.which()) {\n      case schema::Value::BOOL:\n      case schema::Value::INT8:\n      case schema::Value::INT16:\n      case schema::Value::INT32:\n      case schema::Value::INT64:\n      case schema::Value::UINT8:\n      case schema::Value::UINT16:\n      case schema::Value::UINT32:\n      case schema::Value::UINT64:\n      case schema::Value::ENUM:\n        return ConstText {\n          false,\n          kj::strTree(\"static constexpr \", typeName_, ' ', upperCase, \" = \",\n              literalValue(schema.getType(), constProto.getValue()), \";\\n\"),\n          scope.size() == 0 ? kj::strTree() : kj::strTree(\n              // TODO(msvc): MSVC doesn't like definitions of constexprs, but other compilers and\n              //   the standard require them.\n              \"#ifndef _MSC_VER\\n\"\n              \"constexpr \", typeName_, ' ', scope, upperCase, \";\\n\"\n              \"#endif\\n\")\n        };\n\n      case schema::Value::VOID:\n      case schema::Value::FLOAT32:\n      case schema::Value::FLOAT64: {\n        // TODO(msvc): MSVC doesn't like float- or class-typed constexprs. As soon as this is fixed,\n        //   treat VOID, FLOAT32, and FLOAT64 the same as the other primitives.\n        kj::String value = literalValue(schema.getType(), constProto.getValue()).flatten();\n        return ConstText {\n          false,\n          kj::strTree(\"static KJ_CONSTEXPR(const) \", typeName_, ' ', upperCase,\n              \" CAPNP_NON_INT_CONSTEXPR_DECL_INIT(\", value, \");\\n\"),\n          scope.size() == 0 ? kj::strTree() : kj::strTree(\n              \"KJ_CONSTEXPR(const) \", typeName_, ' ', scope, upperCase,\n              \" CAPNP_NON_INT_CONSTEXPR_DEF_INIT(\", value, \");\\n\")\n        };\n      }\n\n      case schema::Value::TEXT: {\n        kj::String constType = kj::strTree(\n            \"::capnp::_::ConstText<\", schema.as<Text>().size(), \">\").flatten();\n        return ConstText {\n          true,\n          kj::strTree(linkage, \"const \", constType, ' ', upperCase, \";\\n\"),\n          kj::strTree(\"const \", constType, ' ', scope, upperCase, \"(::capnp::schemas::b_\",\n                      kj::hex(proto.getId()), \".words + \", schema.getValueSchemaOffset(), \");\\n\")\n        };\n      }\n\n      case schema::Value::DATA: {\n        kj::String constType = kj::strTree(\n            \"::capnp::_::ConstData<\", schema.as<Data>().size(), \">\").flatten();\n        return ConstText {\n          true,\n          kj::strTree(linkage, \"const \", constType, ' ', upperCase, \";\\n\"),\n          kj::strTree(\"const \", constType, ' ', scope, upperCase, \"(::capnp::schemas::b_\",\n                      kj::hex(proto.getId()), \".words + \", schema.getValueSchemaOffset(), \");\\n\")\n        };\n      }\n\n      case schema::Value::STRUCT: {\n        kj::String constType = kj::strTree(\n            \"::capnp::_::ConstStruct<\", typeName_, \">\").flatten();\n        return ConstText {\n          true,\n          kj::strTree(linkage, \"const \", constType, ' ', upperCase, \";\\n\"),\n          kj::strTree(\"const \", constType, ' ', scope, upperCase, \"(::capnp::schemas::b_\",\n                      kj::hex(proto.getId()), \".words + \", schema.getValueSchemaOffset(), \");\\n\")\n        };\n      }\n\n      case schema::Value::LIST: {\n        kj::String constType = kj::strTree(\n            \"::capnp::_::ConstList<\", typeName(type.asList().getElementType(), nullptr), \">\")\n            .flatten();\n        return ConstText {\n          true,\n          kj::strTree(linkage, \"const \", constType, ' ', upperCase, \";\\n\"),\n          kj::strTree(\"const \", constType, ' ', scope, upperCase, \"(::capnp::schemas::b_\",\n                      kj::hex(proto.getId()), \".words + \", schema.getValueSchemaOffset(), \");\\n\")\n        };\n      }\n\n      case schema::Value::ANY_POINTER:\n      case schema::Value::INTERFACE:\n        return ConstText { false, kj::strTree(), kj::strTree() };\n    }\n\n    KJ_UNREACHABLE;\n  }"
  },
  {
    "function_name": "makeInterfaceText",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "2120-2314",
    "snippet": "InterfaceText makeInterfaceText(kj::StringPtr scope, kj::StringPtr name, InterfaceSchema schema,\n                                  kj::Array<kj::StringTree> nestedTypeDecls,\n                                  const TemplateContext& templateContext) {\n    auto fullName = kj::str(scope, name, templateContext.args());\n    auto methods = KJ_MAP(m, schema.getMethods()) {\n      return makeMethodText(fullName, m, templateContext);\n    };\n\n    auto proto = schema.getProto();\n    auto hexId = kj::hex(proto.getId());\n\n    auto superclasses = KJ_MAP(superclass, schema.getSuperclasses()) {\n      return ExtendInfo { cppFullName(superclass, nullptr), superclass.getProto().getId() };\n    };\n\n    CppTypeName clientName = cppFullName(schema, nullptr);\n    clientName.addMemberType(\"Client\");\n\n    kj::String templates = kj::str(templateContext.allDecls());  // Ends with a newline\n\n    // Private members struct\n    kj::StringTree declareText = kj::strTree(\n         \"  #if !CAPNP_LITE\\n\"\n         \"  struct _capnpPrivate {\\n\"\n         \"    CAPNP_DECLARE_INTERFACE_HEADER(\", hexId, \")\\n\");\n\n    kj::StringTree defineText = kj::strTree(\n        \"// \", fullName, \"\\n\",\n        \"#if !CAPNP_LITE\\n\",\n        templates, \"constexpr ::capnp::Kind \", fullName, \"::_capnpPrivate::kind;\\n\",\n        templates, \"constexpr ::capnp::_::RawSchema const* \", fullName, \"::_capnpPrivate::schema;\\n\",\n        templates, \"constexpr ::capnp::_::RawBrandedSchema const* \", fullName, \"::_capnpPrivate::brand;\\n\");\n\n    if (templateContext.isGeneric()) {\n      auto brandInitializers = makeBrandInitializers(templateContext, schema);\n      bool hasDeps = (brandInitializers.dependencies.size() != 0);\n\n      declareText = kj::strTree(kj::mv(declareText),\n          makeGenericDeclarations(templateContext, hasDeps));\n\n      defineText = kj::strTree(kj::mv(defineText),\n          makeGenericDefinitions(templates, fullName, kj::str(hexId), kj::mv(brandInitializers)));\n    } else {\n      declareText = kj::strTree(kj::mv(declareText),\n        \"    static constexpr ::capnp::_::RawBrandedSchema const* brand = &schema->defaultBrand;\\n\");\n    }\n\n    declareText = kj::strTree(kj::mv(declareText), \"  };\\n  #endif  // !CAPNP_LITE\");\n    defineText = kj::strTree(kj::mv(defineText), \"#endif  // !CAPNP_LITE\\n\\n\");\n\n    return InterfaceText {\n      kj::strTree(\n          templateContext.hasParams() ? \"  \" : \"\", templateContext.decl(true),\n          \"  struct \", name, \";\\n\"),\n\n      kj::strTree(\n          templateContext.parentDecls(),\n          templateContext.decl(scope == nullptr),\n          \"struct \", scope, name, \" {\\n\",\n          \"  \", name, \"() = delete;\\n\"\n          \"\\n\"\n          \"#if !CAPNP_LITE\\n\"\n          \"  class Client;\\n\"\n          \"  class Server;\\n\"\n          \"#endif  // !CAPNP_LITE\\n\"\n          \"\\n\",\n          KJ_MAP(n, nestedTypeDecls) { return kj::mv(n); },\n          \"\\n\",\n          kj::mv(declareText), \"\\n\"\n          \"};\\n\"\n          \"\\n\"),\n\n      kj::strTree(\n          \"#if !CAPNP_LITE\\n\",\n          templateContext.allDecls(),\n          \"class \", fullName, \"::Client\\n\"\n          \"    : public virtual ::capnp::Capability::Client\",\n          KJ_MAP(s, superclasses) {\n            return kj::strTree(\",\\n      public virtual \", s.typeName, \"::Client\");\n          }, \" {\\n\"\n          \"public:\\n\"\n          \"  typedef \", fullName, \" Calls;\\n\"\n          \"  typedef \", fullName, \" Reads;\\n\"\n          \"\\n\"\n          \"  Client(decltype(nullptr));\\n\"\n          \"  explicit Client(::kj::Own< ::capnp::ClientHook>&& hook);\\n\"\n          \"  template <typename _t, typename = ::kj::EnableIf< ::kj::canConvert<_t*, Server*>()>>\\n\"\n          \"  Client(::kj::Own<_t>&& server);\\n\"\n          \"  template <typename _t, typename = ::kj::EnableIf< ::kj::canConvert<_t*, Client*>()>>\\n\"\n          \"  Client(::kj::Promise<_t>&& promise);\\n\"\n          \"  Client(::kj::Exception&& exception);\\n\"\n          \"  Client(Client&) = default;\\n\"\n          \"  Client(Client&&) = default;\\n\"\n          \"  Client& operator=(Client& other);\\n\"\n          \"  Client& operator=(Client&& other);\\n\"\n          \"\\n\",\n          KJ_MAP(m, methods) { return kj::mv(m.clientDecls); },\n          \"\\n\"\n          \"protected:\\n\"\n          \"  Client() = default;\\n\"\n          \"};\\n\"\n          \"\\n\",\n          templateContext.allDecls(),\n          \"class \", fullName, \"::Server\\n\"\n          \"    : public virtual ::capnp::Capability::Server\",\n          KJ_MAP(s, superclasses) {\n            return kj::strTree(\",\\n      public virtual \", s.typeName, \"::Server\");\n          }, \" {\\n\"\n          \"public:\\n\",\n          \"  typedef \", fullName, \" Serves;\\n\"\n          \"\\n\"\n          \"  ::kj::Promise<void> dispatchCall(uint64_t interfaceId, uint16_t methodId,\\n\"\n          \"      ::capnp::CallContext< ::capnp::AnyPointer, ::capnp::AnyPointer> context)\\n\"\n          \"      override;\\n\"\n          \"\\n\"\n          \"protected:\\n\",\n          KJ_MAP(m, methods) { return kj::mv(m.serverDecls); },\n          \"\\n\"\n          \"  ::kj::Promise<void> dispatchCallInternal(uint16_t methodId,\\n\"\n          \"      ::capnp::CallContext< ::capnp::AnyPointer, ::capnp::AnyPointer> context);\\n\"\n          \"};\\n\"\n          \"#endif  // !CAPNP_LITE\\n\"\n          \"\\n\"),\n\n      kj::strTree(\n          \"#if !CAPNP_LITE\\n\",\n          templateContext.allDecls(),\n          \"inline \", fullName, \"::Client::Client(decltype(nullptr))\\n\"\n          \"    : ::capnp::Capability::Client(nullptr) {}\\n\",\n          templateContext.allDecls(),\n          \"inline \", fullName, \"::Client::Client(\\n\"\n          \"    ::kj::Own< ::capnp::ClientHook>&& hook)\\n\"\n          \"    : ::capnp::Capability::Client(::kj::mv(hook)) {}\\n\",\n          templateContext.allDecls(),\n          \"template <typename _t, typename>\\n\"\n          \"inline \", fullName, \"::Client::Client(::kj::Own<_t>&& server)\\n\"\n          \"    : ::capnp::Capability::Client(::kj::mv(server)) {}\\n\",\n          templateContext.allDecls(),\n          \"template <typename _t, typename>\\n\"\n          \"inline \", fullName, \"::Client::Client(::kj::Promise<_t>&& promise)\\n\"\n          \"    : ::capnp::Capability::Client(::kj::mv(promise)) {}\\n\",\n          templateContext.allDecls(),\n          \"inline \", fullName, \"::Client::Client(::kj::Exception&& exception)\\n\"\n          \"    : ::capnp::Capability::Client(::kj::mv(exception)) {}\\n\",\n          templateContext.allDecls(),\n          \"inline \", clientName, \"& \", fullName, \"::Client::operator=(Client& other) {\\n\"\n          \"  ::capnp::Capability::Client::operator=(other);\\n\"\n          \"  return *this;\\n\"\n          \"}\\n\",\n          templateContext.allDecls(),\n          \"inline \", clientName, \"& \", fullName, \"::Client::operator=(Client&& other) {\\n\"\n          \"  ::capnp::Capability::Client::operator=(kj::mv(other));\\n\"\n          \"  return *this;\\n\"\n          \"}\\n\"\n          \"\\n\",\n          KJ_MAP(m, methods) { return kj::mv(m.inlineDefs); },\n          \"#endif  // !CAPNP_LITE\\n\"),\n\n      kj::strTree(\n          \"#if !CAPNP_LITE\\n\",\n          KJ_MAP(m, methods) { return kj::mv(m.sourceDefs); },\n          templateContext.allDecls(),\n          \"::kj::Promise<void> \", fullName, \"::Server::dispatchCall(\\n\"\n          \"    uint64_t interfaceId, uint16_t methodId,\\n\"\n          \"    ::capnp::CallContext< ::capnp::AnyPointer, ::capnp::AnyPointer> context) {\\n\"\n          \"  switch (interfaceId) {\\n\"\n          \"    case 0x\", kj::hex(proto.getId()), \"ull:\\n\"\n          \"      return dispatchCallInternal(methodId, context);\\n\",\n          KJ_MAP(s, superclasses) {\n            return kj::strTree(\n              \"    case 0x\", kj::hex(s.id), \"ull:\\n\"\n              \"      return \", s.typeName, \"::Server::dispatchCallInternal(methodId, context);\\n\");\n          },\n          \"    default:\\n\"\n          \"      return internalUnimplemented(\\\"\", proto.getDisplayName(), \"\\\", interfaceId);\\n\"\n          \"  }\\n\"\n          \"}\\n\",\n          templateContext.allDecls(),\n          \"::kj::Promise<void> \", fullName, \"::Server::dispatchCallInternal(\\n\"\n          \"    uint16_t methodId,\\n\"\n          \"    ::capnp::CallContext< ::capnp::AnyPointer, ::capnp::AnyPointer> context) {\\n\"\n          \"  switch (methodId) {\\n\",\n          KJ_MAP(m, methods) { return kj::mv(m.dispatchCase); },\n          \"    default:\\n\"\n          \"      (void)context;\\n\"\n          \"      return ::capnp::Capability::Server::internalUnimplemented(\\n\"\n          \"          \\\"\", proto.getDisplayName(), \"\\\",\\n\"\n          \"          0x\", kj::hex(proto.getId()), \"ull, methodId);\\n\"\n          \"  }\\n\"\n          \"}\\n\"\n          \"#endif  // !CAPNP_LITE\\n\"\n          \"\\n\",\n          kj::mv(defineText))\n    };\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "kj::StringTree sourceDefs = kj::strTree(\n        KJ_MAP(n, nodeTexts) { return kj::mv(n.sourceFileDefs); });"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"#if !CAPNP_LITE\\n\"",
            "KJ_MAP(m, methods){ return kj::mv(m.sourceDefs); }",
            "templateContext.allDecls()",
            "\"::kj::Promise<void> \"",
            "fullName",
            "\"::Server::dispatchCall(\\n\"\n          \"    uint64_t interfaceId, uint16_t methodId,\\n\"\n          \"    ::capnp::CallContext< ::capnp::AnyPointer, ::capnp::AnyPointer> context) {\\n\"\n          \"  switch (interfaceId) {\\n\"\n          \"    case 0x\"",
            "kj::hex(proto.getId())",
            "\"ull:\\n\"\n          \"      return dispatchCallInternal(methodId, context);\\n\"",
            "KJ_MAP(s, superclasses){\n            return kj::strTree(\n              \"    case 0x\", kj::hex(s.id), \"ull:\\n\"\n              \"      return \", s.typeName, \"::Server::dispatchCallInternal(methodId, context);\\n\");\n          }",
            "\"    default:\\n\"\n          \"      return internalUnimplemented(\\\"\"",
            "proto.getDisplayName()",
            "\"\\\", interfaceId);\\n\"\n          \"  }\\n\"\n          \"}\\n\"",
            "templateContext.allDecls()",
            "\"::kj::Promise<void> \"",
            "fullName",
            "\"::Server::dispatchCallInternal(\\n\"\n          \"    uint16_t methodId,\\n\"\n          \"    ::capnp::CallContext< ::capnp::AnyPointer, ::capnp::AnyPointer> context) {\\n\"\n          \"  switch (methodId) {\\n\"",
            "KJ_MAP(m, methods){ return kj::mv(m.dispatchCase); }",
            "\"    default:\\n\"\n          \"      (void)context;\\n\"\n          \"      return ::capnp::Capability::Server::internalUnimplemented(\\n\"\n          \"          \\\"\"",
            "proto.getDisplayName()",
            "\"\\\",\\n\"\n          \"          0x\"",
            "kj::hex(proto.getId())",
            "\"ull, methodId);\\n\"\n          \"  }\\n\"\n          \"}\\n\"\n          \"#endif  // !CAPNP_LITE\\n\"\n          \"\\n\"",
            "kj::mv(defineText)"
          ],
          "line": 2278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "defineText"
          ],
          "line": 2312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::hex",
          "args": [
            "proto.getId()"
          ],
          "line": 2307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.getId",
          "args": [],
          "line": 2307
        },
        "resolved": true,
        "details": {
          "function_name": "getId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
          "lines": "75-75",
          "snippet": "uint64_t getId() { return id; }",
          "includes": [
            "#include \"md5.h\"",
            "#include \"node-translator.h\"",
            "#include <unordered_map>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/message.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/arena.h>",
            "#include <kj/mutex.h>",
            "#include \"parser.h\"      // only for generateChildId()",
            "#include \"compiler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nuint64_t getId() { return id; }"
        }
      },
      {
        "call_info": {
          "callee": "proto.getDisplayName",
          "args": [],
          "line": 2306
        },
        "resolved": true,
        "details": {
          "function_name": "getDisplayName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-parser.c++",
          "lines": "416-418",
          "snippet": "kj::StringPtr getDisplayName() const override {\n    return displayName;\n  }",
          "includes": [
            "#include <sys/mman.h>",
            "#include <windows.h>",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/mutex.h>",
            "#include <unordered_map>",
            "#include <capnp/compiler/parser.h>",
            "#include <capnp/compiler/grammar.capnp.h>",
            "#include <capnp/compiler/lexer.h>",
            "#include <capnp/compiler/lexer.capnp.h>",
            "#include <capnp/compiler/compiler.h>",
            "#include \"message.h\"",
            "#include \"schema-parser.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/mman.h>\n#include <windows.h>\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/mutex.h>\n#include <unordered_map>\n#include <capnp/compiler/parser.h>\n#include <capnp/compiler/grammar.capnp.h>\n#include <capnp/compiler/lexer.h>\n#include <capnp/compiler/lexer.capnp.h>\n#include <capnp/compiler/compiler.h>\n#include \"message.h\"\n#include \"schema-parser.h\"\n\nkj::StringPtr getDisplayName() const override {\n    return displayName;\n  }"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "m.dispatchCase"
          ],
          "line": 2302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "m",
            "methods"
          ],
          "line": 2302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 2297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"    case 0x\"",
            "kj::hex(s.id)",
            "\"ull:\\n\"\n              \"      return \"",
            "s.typeName",
            "\"::Server::dispatchCallInternal(methodId, context);\\n\""
          ],
          "line": 2289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::hex",
          "args": [
            "s.id"
          ],
          "line": 2290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "s",
            "superclasses"
          ],
          "line": 2288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::hex",
          "args": [
            "proto.getId()"
          ],
          "line": 2286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 2281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "m.sourceDefs"
          ],
          "line": 2280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "m",
            "methods"
          ],
          "line": 2280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"#if !CAPNP_LITE\\n\"",
            "templateContext.allDecls()",
            "\"inline \"",
            "fullName",
            "\"::Client::Client(decltype(nullptr))\\n\"\n          \"    : ::capnp::Capability::Client(nullptr) {}\\n\"",
            "templateContext.allDecls()",
            "\"inline \"",
            "fullName",
            "\"::Client::Client(\\n\"\n          \"    ::kj::Own< ::capnp::ClientHook>&& hook)\\n\"\n          \"    : ::capnp::Capability::Client(::kj::mv(hook)) {}\\n\"",
            "templateContext.allDecls()",
            "\"template <typename _t, typename>\\n\"\n          \"inline \"",
            "fullName",
            "\"::Client::Client(::kj::Own<_t>&& server)\\n\"\n          \"    : ::capnp::Capability::Client(::kj::mv(server)) {}\\n\"",
            "templateContext.allDecls()",
            "\"template <typename _t, typename>\\n\"\n          \"inline \"",
            "fullName",
            "\"::Client::Client(::kj::Promise<_t>&& promise)\\n\"\n          \"    : ::capnp::Capability::Client(::kj::mv(promise)) {}\\n\"",
            "templateContext.allDecls()",
            "\"inline \"",
            "fullName",
            "\"::Client::Client(::kj::Exception&& exception)\\n\"\n          \"    : ::capnp::Capability::Client(::kj::mv(exception)) {}\\n\"",
            "templateContext.allDecls()",
            "\"inline \"",
            "clientName",
            "\"& \"",
            "fullName",
            "\"::Client::operator=(Client& other) {\\n\"\n          \"  ::capnp::Capability::Client::operator=(other);\\n\"\n          \"  return *this;\\n\"\n          \"}\\n\"",
            "templateContext.allDecls()",
            "\"inline \"",
            "clientName",
            "\"& \"",
            "fullName",
            "\"::Client::operator=(Client&& other) {\\n\"\n          \"  ::capnp::Capability::Client::operator=(kj::mv(other));\\n\"\n          \"  return *this;\\n\"\n          \"}\\n\"\n          \"\\n\"",
            "KJ_MAP(m, methods){ return kj::mv(m.inlineDefs); }",
            "\"#endif  // !CAPNP_LITE\\n\""
          ],
          "line": 2244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "m.inlineDefs"
          ],
          "line": 2275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "m",
            "methods"
          ],
          "line": 2275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 2269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 2264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 2261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 2257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 2253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 2249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 2246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"#if !CAPNP_LITE\\n\"",
            "templateContext.allDecls()",
            "\"class \"",
            "fullName",
            "\"::Client\\n\"\n          \"    : public virtual ::capnp::Capability::Client\"",
            "KJ_MAP(s, superclasses){\n            return kj::strTree(\",\\n      public virtual \", s.typeName, \"::Client\");\n          }",
            "\" {\\n\"\n          \"public:\\n\"\n          \"  typedef \"",
            "fullName",
            "\" Calls;\\n\"\n          \"  typedef \"",
            "fullName",
            "\" Reads;\\n\"\n          \"\\n\"\n          \"  Client(decltype(nullptr));\\n\"\n          \"  explicit Client(::kj::Own< ::capnp::ClientHook>&& hook);\\n\"\n          \"  template <typename _t, typename = ::kj::EnableIf< ::kj::canConvert<_t*, Server*>()>>\\n\"\n          \"  Client(::kj::Own<_t>&& server);\\n\"\n          \"  template <typename _t, typename = ::kj::EnableIf< ::kj::canConvert<_t*, Client*>()>>\\n\"\n          \"  Client(::kj::Promise<_t>&& promise);\\n\"\n          \"  Client(::kj::Exception&& exception);\\n\"\n          \"  Client(Client&) = default;\\n\"\n          \"  Client(Client&&) = default;\\n\"\n          \"  Client& operator=(Client& other);\\n\"\n          \"  Client& operator=(Client&& other);\\n\"\n          \"\\n\"",
            "KJ_MAP(m, methods){ return kj::mv(m.clientDecls); }",
            "\"\\n\"\n          \"protected:\\n\"\n          \"  Client() = default;\\n\"\n          \"};\\n\"\n          \"\\n\"",
            "templateContext.allDecls()",
            "\"class \"",
            "fullName",
            "\"::Server\\n\"\n          \"    : public virtual ::capnp::Capability::Server\"",
            "KJ_MAP(s, superclasses){\n            return kj::strTree(\",\\n      public virtual \", s.typeName, \"::Server\");\n          }",
            "\" {\\n\"\n          \"public:\\n\"",
            "\"  typedef \"",
            "fullName",
            "\" Serves;\\n\"\n          \"\\n\"\n          \"  ::kj::Promise<void> dispatchCall(uint64_t interfaceId, uint16_t methodId,\\n\"\n          \"      ::capnp::CallContext< ::capnp::AnyPointer, ::capnp::AnyPointer> context)\\n\"\n          \"      override;\\n\"\n          \"\\n\"\n          \"protected:\\n\"",
            "KJ_MAP(m, methods){ return kj::mv(m.serverDecls); }",
            "\"\\n\"\n          \"  ::kj::Promise<void> dispatchCallInternal(uint16_t methodId,\\n\"\n          \"      ::capnp::CallContext< ::capnp::AnyPointer, ::capnp::AnyPointer> context);\\n\"\n          \"};\\n\"\n          \"#endif  // !CAPNP_LITE\\n\"\n          \"\\n\""
          ],
          "line": 2192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "m.serverDecls"
          ],
          "line": 2236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "m",
            "methods"
          ],
          "line": 2236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\",\\n      public virtual \"",
            "s.typeName",
            "\"::Server\""
          ],
          "line": 2226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "s",
            "superclasses"
          ],
          "line": 2225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 2222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "m.clientDecls"
          ],
          "line": 2216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "m",
            "methods"
          ],
          "line": 2216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\",\\n      public virtual \"",
            "s.typeName",
            "\"::Client\""
          ],
          "line": 2198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "s",
            "superclasses"
          ],
          "line": 2197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 2194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "templateContext.parentDecls()",
            "templateContext.decl(scope == nullptr)",
            "\"struct \"",
            "scope",
            "name",
            "\" {\\n\"",
            "\"  \"",
            "name",
            "\"() = delete;\\n\"\n          \"\\n\"\n          \"#if !CAPNP_LITE\\n\"\n          \"  class Client;\\n\"\n          \"  class Server;\\n\"\n          \"#endif  // !CAPNP_LITE\\n\"\n          \"\\n\"",
            "KJ_MAP(n, nestedTypeDecls){ return kj::mv(n); }",
            "\"\\n\"",
            "kj::mv(declareText)",
            "\"\\n\"\n          \"};\\n\"\n          \"\\n\""
          ],
          "line": 2175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "declareText"
          ],
          "line": 2188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "n"
          ],
          "line": 2186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "n",
            "nestedTypeDecls"
          ],
          "line": 2186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.decl",
          "args": [
            "scope == nullptr"
          ],
          "line": 2177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.parentDecls",
          "args": [],
          "line": 2176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "templateContext.hasParams() ? \"  \" : \"\"",
            "templateContext.decl(true)",
            "\"  struct \"",
            "name",
            "\";\\n\""
          ],
          "line": 2171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.decl",
          "args": [
            "true"
          ],
          "line": 2172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.hasParams",
          "args": [],
          "line": 2172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "kj::mv(defineText)",
            "\"#endif  // !CAPNP_LITE\\n\\n\""
          ],
          "line": 2168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "defineText"
          ],
          "line": 2168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "kj::mv(declareText)",
            "\"  };\\n  #endif  // !CAPNP_LITE\""
          ],
          "line": 2167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "declareText"
          ],
          "line": 2167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "kj::mv(declareText)",
            "\"    static constexpr ::capnp::_::RawBrandedSchema const* brand = &schema->defaultBrand;\\n\""
          ],
          "line": 2163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "declareText"
          ],
          "line": 2163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "kj::mv(defineText)",
            "makeGenericDefinitions(templates, fullName, kj::str(hexId), kj::mv(brandInitializers))"
          ],
          "line": 2160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "makeGenericDefinitions",
          "args": [
            "templates",
            "fullName",
            "kj::str(hexId)",
            "kj::mv(brandInitializers)"
          ],
          "line": 2161
        },
        "resolved": true,
        "details": {
          "function_name": "makeGenericDefinitions",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "1833-1858",
          "snippet": "kj::StringTree makeGenericDefinitions(\n      kj::StringPtr templates, kj::StringPtr fullName, kj::StringPtr hexId,\n      BrandInitializerText brandInitializers) {\n    // Returns the definitions for the members from makeGenericDeclarations().\n    bool hasBrandDependencies = (brandInitializers.dependencies.size() != 0);\n\n    return kj::strTree(\n        templates, \"const ::capnp::_::RawBrandedSchema::Scope \", fullName,\n        \"::_capnpPrivate::brandScopes[] = \", kj::mv(brandInitializers.scopes), \";\\n\",\n\n        templates, \"const ::capnp::_::RawBrandedSchema::Binding \", fullName,\n        \"::_capnpPrivate::brandBindings[] = \", kj::mv(brandInitializers.bindings), \";\\n\",\n\n        (!hasBrandDependencies ? kj::strTree(\"\") : kj::strTree(\n            templates, \"const ::capnp::_::RawBrandedSchema::Dependency \", fullName,\n            \"::_capnpPrivate::brandDependencies[] = \", kj::mv(brandInitializers.dependencies),\n            \";\\n\")),\n\n        templates, \"const ::capnp::_::RawBrandedSchema \", fullName, \"::_capnpPrivate::specificBrand = {\\n\",\n        \"  &::capnp::schemas::s_\", hexId, \", brandScopes, \",\n        (!hasBrandDependencies ? \"nullptr\" : \"brandDependencies\"), \",\\n\",\n        \"  sizeof(brandScopes) / sizeof(brandScopes[0]), \",\n        (!hasBrandDependencies ? \"0\" : \"sizeof(brandDependencies) / sizeof(brandDependencies[0])\"),\n        \", nullptr\\n\"\n        \"};\\n\");\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::StringTree makeGenericDefinitions(\n      kj::StringPtr templates, kj::StringPtr fullName, kj::StringPtr hexId,\n      BrandInitializerText brandInitializers) {\n    // Returns the definitions for the members from makeGenericDeclarations().\n    bool hasBrandDependencies = (brandInitializers.dependencies.size() != 0);\n\n    return kj::strTree(\n        templates, \"const ::capnp::_::RawBrandedSchema::Scope \", fullName,\n        \"::_capnpPrivate::brandScopes[] = \", kj::mv(brandInitializers.scopes), \";\\n\",\n\n        templates, \"const ::capnp::_::RawBrandedSchema::Binding \", fullName,\n        \"::_capnpPrivate::brandBindings[] = \", kj::mv(brandInitializers.bindings), \";\\n\",\n\n        (!hasBrandDependencies ? kj::strTree(\"\") : kj::strTree(\n            templates, \"const ::capnp::_::RawBrandedSchema::Dependency \", fullName,\n            \"::_capnpPrivate::brandDependencies[] = \", kj::mv(brandInitializers.dependencies),\n            \";\\n\")),\n\n        templates, \"const ::capnp::_::RawBrandedSchema \", fullName, \"::_capnpPrivate::specificBrand = {\\n\",\n        \"  &::capnp::schemas::s_\", hexId, \", brandScopes, \",\n        (!hasBrandDependencies ? \"nullptr\" : \"brandDependencies\"), \",\\n\",\n        \"  sizeof(brandScopes) / sizeof(brandScopes[0]), \",\n        (!hasBrandDependencies ? \"0\" : \"sizeof(brandDependencies) / sizeof(brandDependencies[0])\"),\n        \", nullptr\\n\"\n        \"};\\n\");\n  }"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "brandInitializers"
          ],
          "line": 2161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "hexId"
          ],
          "line": 2161
        },
        "resolved": true,
        "details": {
          "function_name": "str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "341-341",
          "snippet": "inline String str(String&& s) { return mv(s); }",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\ninline String str(String&& s) { return mv(s); }"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "defineText"
          ],
          "line": 2160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "kj::mv(declareText)",
            "makeGenericDeclarations(templateContext, hasDeps)"
          ],
          "line": 2157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "makeGenericDeclarations",
          "args": [
            "templateContext",
            "hasDeps"
          ],
          "line": 2158
        },
        "resolved": true,
        "details": {
          "function_name": "makeGenericDeclarations",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "1819-1831",
          "snippet": "kj::StringTree makeGenericDeclarations(const TemplateContext& templateContext,\n                                         bool hasBrandDependencies) {\n    // Returns the declarations for the private members of a generic struct/interface;\n    // paired with the definitions from makeGenericDefinitions().\n    return kj::strTree(\n        \"    static const ::capnp::_::RawBrandedSchema::Scope brandScopes[];\\n\"\n        \"    static const ::capnp::_::RawBrandedSchema::Binding brandBindings[];\\n\",\n        (!hasBrandDependencies ? \"\" :\n            \"    static const ::capnp::_::RawBrandedSchema::Dependency brandDependencies[];\\n\"),\n        \"    static const ::capnp::_::RawBrandedSchema specificBrand;\\n\"\n        \"    static constexpr ::capnp::_::RawBrandedSchema const* brand = \"\n        \"::capnp::_::ChooseBrand<_capnpPrivate, \", templateContext.allArgs(), \">::brand;\\n\");\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::StringTree makeGenericDeclarations(const TemplateContext& templateContext,\n                                         bool hasBrandDependencies) {\n    // Returns the declarations for the private members of a generic struct/interface;\n    // paired with the definitions from makeGenericDefinitions().\n    return kj::strTree(\n        \"    static const ::capnp::_::RawBrandedSchema::Scope brandScopes[];\\n\"\n        \"    static const ::capnp::_::RawBrandedSchema::Binding brandBindings[];\\n\",\n        (!hasBrandDependencies ? \"\" :\n            \"    static const ::capnp::_::RawBrandedSchema::Dependency brandDependencies[];\\n\"),\n        \"    static const ::capnp::_::RawBrandedSchema specificBrand;\\n\"\n        \"    static constexpr ::capnp::_::RawBrandedSchema const* brand = \"\n        \"::capnp::_::ChooseBrand<_capnpPrivate, \", templateContext.allArgs(), \">::brand;\\n\");\n  }"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "declareText"
          ],
          "line": 2157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "brandInitializers.dependencies.size",
          "args": [],
          "line": 2155
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-capnp.c++",
          "lines": "74-74",
          "snippet": "inline size_t size() const { return amount; }",
          "includes": [
            "#include \"config.h\"",
            "#include <map>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <map>\n#include <algorithm>\n#include <kj/main.h>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nIndent {\n  inline size_t size() const { return amount; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "makeBrandInitializers",
          "args": [
            "templateContext",
            "schema"
          ],
          "line": 2154
        },
        "resolved": true,
        "details": {
          "function_name": "makeBrandInitializers",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "672-697",
          "snippet": "BrandInitializerText makeBrandInitializers(\n      const TemplateContext& templateContext, Schema schema) {\n    auto scopeMap = templateContext.getScopeMap();\n\n    auto scopes = kj::heapArrayBuilder<kj::StringTree>(scopeMap.size());\n    kj::Vector<kj::StringTree> bindings(scopeMap.size() * 2);  // (estimate two params per scope)\n\n    for (auto& scope: scopeMap) {\n      scopes.add(kj::strTree(\"  { \",\n        \"0x\", kj::hex(scope.first), \", \"\n        \"brandBindings + \", bindings.size(), \", \",\n        scope.second.size(), \", \"\n        \"false\"\n      \"},\\n\"));\n\n      for (auto param: scope.second) {\n        bindings.add(kj::strTree(\"  ::capnp::_::brandBindingFor<\", param.getName(), \">(),\\n\"));\n      }\n    }\n\n    return {\n      kj::strTree(\"{\\n\", scopes.finish(), \"}\"),\n      kj::strTree(\"{\\n\", bindings.releaseAsArray(), \"}\"),\n      makeBrandDepInitializers(templateContext, schema)\n    };\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nBrandInitializerText makeBrandInitializers(\n      const TemplateContext& templateContext, Schema schema) {\n    auto scopeMap = templateContext.getScopeMap();\n\n    auto scopes = kj::heapArrayBuilder<kj::StringTree>(scopeMap.size());\n    kj::Vector<kj::StringTree> bindings(scopeMap.size() * 2);  // (estimate two params per scope)\n\n    for (auto& scope: scopeMap) {\n      scopes.add(kj::strTree(\"  { \",\n        \"0x\", kj::hex(scope.first), \", \"\n        \"brandBindings + \", bindings.size(), \", \",\n        scope.second.size(), \", \"\n        \"false\"\n      \"},\\n\"));\n\n      for (auto param: scope.second) {\n        bindings.add(kj::strTree(\"  ::capnp::_::brandBindingFor<\", param.getName(), \">(),\\n\"));\n      }\n    }\n\n    return {\n      kj::strTree(\"{\\n\", scopes.finish(), \"}\"),\n      kj::strTree(\"{\\n\", bindings.releaseAsArray(), \"}\"),\n      makeBrandDepInitializers(templateContext, schema)\n    };\n  }"
        }
      },
      {
        "call_info": {
          "callee": "templateContext.isGeneric",
          "args": [],
          "line": 2153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"// \"",
            "fullName",
            "\"\\n\"",
            "\"#if !CAPNP_LITE\\n\"",
            "templates",
            "\"constexpr ::capnp::Kind \"",
            "fullName",
            "\"::_capnpPrivate::kind;\\n\"",
            "templates",
            "\"constexpr ::capnp::_::RawSchema const* \"",
            "fullName",
            "\"::_capnpPrivate::schema;\\n\"",
            "templates",
            "\"constexpr ::capnp::_::RawBrandedSchema const* \"",
            "fullName",
            "\"::_capnpPrivate::brand;\\n\""
          ],
          "line": 2146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"  #if !CAPNP_LITE\\n\"\n         \"  struct _capnpPrivate {\\n\"\n         \"    CAPNP_DECLARE_INTERFACE_HEADER(\"",
            "hexId",
            "\")\\n\""
          ],
          "line": 2141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 2138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clientName.addMemberType",
          "args": [
            "\"Client\""
          ],
          "line": 2136
        },
        "resolved": true,
        "details": {
          "function_name": "addMemberType",
          "container": "CppTypeName",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "206-211",
          "snippet": "void addMemberType(kj::StringPtr innerName) {\n    // Append \"::innerName\" to refer to a member.\n\n    name = kj::strTree(kj::mv(name), \"::\", innerName);\n    needsTypename = isArgDependent;\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName {\n  void addMemberType(kj::StringPtr innerName) {\n      // Append \"::innerName\" to refer to a member.\n  \n      name = kj::strTree(kj::mv(name), \"::\", innerName);\n      needsTypename = isArgDependent;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "cppFullName",
          "args": [
            "schema",
            "nullptr"
          ],
          "line": 2135
        },
        "resolved": true,
        "details": {
          "function_name": "cppFullName",
          "container": "CapnpcCppMain",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "316-318",
          "snippet": "CppTypeName cppFullName(Schema schema, kj::Maybe<InterfaceSchema::Method> method) {\n    return cppFullName(schema, schema, method);\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCapnpcCppMain {\n  CppTypeName cppFullName(Schema schema, kj::Maybe<InterfaceSchema::Method> method) {\n      return cppFullName(schema, schema, method);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "superclass.getProto",
          "args": [],
          "line": 2132
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "superclass",
            "schema.getSuperclasses()"
          ],
          "line": 2131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getSuperclasses",
          "args": [],
          "line": 2131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::hex",
          "args": [
            "proto.getId()"
          ],
          "line": 2129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "makeMethodText",
          "args": [
            "fullName",
            "m",
            "templateContext"
          ],
          "line": 2125
        },
        "resolved": true,
        "details": {
          "function_name": "makeMethodText",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "1991-2105",
          "snippet": "MethodText makeMethodText(kj::StringPtr interfaceName, InterfaceSchema::Method method,\n                            const TemplateContext& templateContext) {\n    auto proto = method.getProto();\n    auto name = protoName(proto);\n    auto titleCase = toTitleCase(name);\n    auto paramSchema = method.getParamType();\n    auto resultSchema = method.getResultType();\n    auto identifierName = safeIdentifier(name);\n\n    auto paramProto = paramSchema.getProto();\n    auto resultProto = resultSchema.getProto();\n\n    auto implicitParamsReader = proto.getImplicitParameters();\n    auto implicitParamsBuilder = kj::heapArrayBuilder<CppTypeName>(implicitParamsReader.size());\n    for (auto param: implicitParamsReader) {\n      implicitParamsBuilder.add(CppTypeName::makeTemplateParam(param.getName()));\n    }\n    auto implicitParams = implicitParamsBuilder.finish();\n\n    kj::String implicitParamsTemplateDecl;\n    if (implicitParams.size() > 0) {\n      implicitParamsTemplateDecl = kj::str(\n          \"template <\", kj::StringTree(KJ_MAP(p, implicitParams) {\n            return kj::strTree(\"typename \", p);\n          }, \", \"), \">\\n\");\n    }\n\n\n    CppTypeName interfaceTypeName = cppFullName(method.getContainingInterface(), nullptr);\n    CppTypeName paramType;\n    CppTypeName genericParamType;\n    if (paramProto.getScopeId() == 0) {\n      paramType = interfaceTypeName;\n      if (implicitParams.size() == 0) {\n        paramType.addMemberType(kj::str(titleCase, \"Params\"));\n        genericParamType = paramType;\n      } else {\n        genericParamType = paramType;\n        genericParamType.addMemberTemplate(kj::str(titleCase, \"Params\"), nullptr);\n        paramType.addMemberTemplate(kj::str(titleCase, \"Params\"),\n                                    kj::heapArray(implicitParams.asPtr()));\n      }\n    } else {\n      paramType = cppFullName(paramSchema, method);\n      genericParamType = cppFullName(paramSchema, nullptr);\n    }\n    CppTypeName resultType;\n    CppTypeName genericResultType;\n    if (resultProto.getScopeId() == 0) {\n      resultType = interfaceTypeName;\n      if (implicitParams.size() == 0) {\n        resultType.addMemberType(kj::str(titleCase, \"Results\"));\n        genericResultType = resultType;\n      } else {\n        genericResultType = resultType;\n        genericResultType.addMemberTemplate(kj::str(titleCase, \"Results\"), nullptr);\n        resultType.addMemberTemplate(kj::str(titleCase, \"Results\"),\n                                     kj::heapArray(implicitParams.asPtr()));\n      }\n    } else {\n      resultType = cppFullName(resultSchema, method);\n      genericResultType = cppFullName(resultSchema, nullptr);\n    }\n\n    kj::String shortParamType = paramProto.getScopeId() == 0 ?\n        kj::str(titleCase, \"Params\") : kj::str(genericParamType);\n    kj::String shortResultType = resultProto.getScopeId() == 0 ?\n        kj::str(titleCase, \"Results\") : kj::str(genericResultType);\n\n    auto interfaceProto = method.getContainingInterface().getProto();\n    uint64_t interfaceId = interfaceProto.getId();\n    auto interfaceIdHex = kj::hex(interfaceId);\n    uint16_t methodId = method.getIndex();\n\n    auto requestMethodImpl = kj::strTree(\n        templateContext.allDecls(),\n        implicitParamsTemplateDecl,\n        \"::capnp::Request<\", paramType, \", \", resultType, \">\\n\",\n        interfaceName, \"::Client::\", name, \"Request(::kj::Maybe< ::capnp::MessageSize> sizeHint) {\\n\"\n        \"  return newCall<\", paramType, \", \", resultType, \">(\\n\"\n        \"      0x\", interfaceIdHex, \"ull, \", methodId, \", sizeHint);\\n\"\n        \"}\\n\");\n\n    return MethodText {\n      kj::strTree(\n          implicitParamsTemplateDecl.size() == 0 ? \"\" : \"  \", implicitParamsTemplateDecl,\n          \"  ::capnp::Request<\", paramType, \", \", resultType, \"> \", name, \"Request(\\n\"\n          \"      ::kj::Maybe< ::capnp::MessageSize> sizeHint = nullptr);\\n\"),\n\n      kj::strTree(\n          paramProto.getScopeId() != 0 ? kj::strTree() : kj::strTree(\n              \"  typedef \", genericParamType, \" \", titleCase, \"Params;\\n\"),\n          resultProto.getScopeId() != 0 ? kj::strTree() : kj::strTree(\n              \"  typedef \", genericResultType, \" \", titleCase, \"Results;\\n\"),\n          \"  typedef ::capnp::CallContext<\", shortParamType, \", \", shortResultType, \"> \",\n                titleCase, \"Context;\\n\"\n          \"  virtual ::kj::Promise<void> \", identifierName, \"(\", titleCase, \"Context context);\\n\"),\n\n      implicitParams.size() == 0 ? kj::strTree() : kj::mv(requestMethodImpl),\n\n      kj::strTree(\n          implicitParams.size() == 0 ? kj::mv(requestMethodImpl) : kj::strTree(),\n          templateContext.allDecls(),\n          \"::kj::Promise<void> \", interfaceName, \"::Server::\", identifierName, \"(\", titleCase, \"Context) {\\n\"\n          \"  return ::capnp::Capability::Server::internalUnimplemented(\\n\"\n          \"      \\\"\", interfaceProto.getDisplayName(), \"\\\", \\\"\", name, \"\\\",\\n\"\n          \"      0x\", interfaceIdHex, \"ull, \", methodId, \");\\n\"\n          \"}\\n\"),\n\n      kj::strTree(\n          \"    case \", methodId, \":\\n\"\n          \"      return \", identifierName, \"(::capnp::Capability::Server::internalGetTypedContext<\\n\"\n          \"          \", genericParamType, \", \", genericResultType, \">(context));\\n\")\n    };\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nMethodText makeMethodText(kj::StringPtr interfaceName, InterfaceSchema::Method method,\n                            const TemplateContext& templateContext) {\n    auto proto = method.getProto();\n    auto name = protoName(proto);\n    auto titleCase = toTitleCase(name);\n    auto paramSchema = method.getParamType();\n    auto resultSchema = method.getResultType();\n    auto identifierName = safeIdentifier(name);\n\n    auto paramProto = paramSchema.getProto();\n    auto resultProto = resultSchema.getProto();\n\n    auto implicitParamsReader = proto.getImplicitParameters();\n    auto implicitParamsBuilder = kj::heapArrayBuilder<CppTypeName>(implicitParamsReader.size());\n    for (auto param: implicitParamsReader) {\n      implicitParamsBuilder.add(CppTypeName::makeTemplateParam(param.getName()));\n    }\n    auto implicitParams = implicitParamsBuilder.finish();\n\n    kj::String implicitParamsTemplateDecl;\n    if (implicitParams.size() > 0) {\n      implicitParamsTemplateDecl = kj::str(\n          \"template <\", kj::StringTree(KJ_MAP(p, implicitParams) {\n            return kj::strTree(\"typename \", p);\n          }, \", \"), \">\\n\");\n    }\n\n\n    CppTypeName interfaceTypeName = cppFullName(method.getContainingInterface(), nullptr);\n    CppTypeName paramType;\n    CppTypeName genericParamType;\n    if (paramProto.getScopeId() == 0) {\n      paramType = interfaceTypeName;\n      if (implicitParams.size() == 0) {\n        paramType.addMemberType(kj::str(titleCase, \"Params\"));\n        genericParamType = paramType;\n      } else {\n        genericParamType = paramType;\n        genericParamType.addMemberTemplate(kj::str(titleCase, \"Params\"), nullptr);\n        paramType.addMemberTemplate(kj::str(titleCase, \"Params\"),\n                                    kj::heapArray(implicitParams.asPtr()));\n      }\n    } else {\n      paramType = cppFullName(paramSchema, method);\n      genericParamType = cppFullName(paramSchema, nullptr);\n    }\n    CppTypeName resultType;\n    CppTypeName genericResultType;\n    if (resultProto.getScopeId() == 0) {\n      resultType = interfaceTypeName;\n      if (implicitParams.size() == 0) {\n        resultType.addMemberType(kj::str(titleCase, \"Results\"));\n        genericResultType = resultType;\n      } else {\n        genericResultType = resultType;\n        genericResultType.addMemberTemplate(kj::str(titleCase, \"Results\"), nullptr);\n        resultType.addMemberTemplate(kj::str(titleCase, \"Results\"),\n                                     kj::heapArray(implicitParams.asPtr()));\n      }\n    } else {\n      resultType = cppFullName(resultSchema, method);\n      genericResultType = cppFullName(resultSchema, nullptr);\n    }\n\n    kj::String shortParamType = paramProto.getScopeId() == 0 ?\n        kj::str(titleCase, \"Params\") : kj::str(genericParamType);\n    kj::String shortResultType = resultProto.getScopeId() == 0 ?\n        kj::str(titleCase, \"Results\") : kj::str(genericResultType);\n\n    auto interfaceProto = method.getContainingInterface().getProto();\n    uint64_t interfaceId = interfaceProto.getId();\n    auto interfaceIdHex = kj::hex(interfaceId);\n    uint16_t methodId = method.getIndex();\n\n    auto requestMethodImpl = kj::strTree(\n        templateContext.allDecls(),\n        implicitParamsTemplateDecl,\n        \"::capnp::Request<\", paramType, \", \", resultType, \">\\n\",\n        interfaceName, \"::Client::\", name, \"Request(::kj::Maybe< ::capnp::MessageSize> sizeHint) {\\n\"\n        \"  return newCall<\", paramType, \", \", resultType, \">(\\n\"\n        \"      0x\", interfaceIdHex, \"ull, \", methodId, \", sizeHint);\\n\"\n        \"}\\n\");\n\n    return MethodText {\n      kj::strTree(\n          implicitParamsTemplateDecl.size() == 0 ? \"\" : \"  \", implicitParamsTemplateDecl,\n          \"  ::capnp::Request<\", paramType, \", \", resultType, \"> \", name, \"Request(\\n\"\n          \"      ::kj::Maybe< ::capnp::MessageSize> sizeHint = nullptr);\\n\"),\n\n      kj::strTree(\n          paramProto.getScopeId() != 0 ? kj::strTree() : kj::strTree(\n              \"  typedef \", genericParamType, \" \", titleCase, \"Params;\\n\"),\n          resultProto.getScopeId() != 0 ? kj::strTree() : kj::strTree(\n              \"  typedef \", genericResultType, \" \", titleCase, \"Results;\\n\"),\n          \"  typedef ::capnp::CallContext<\", shortParamType, \", \", shortResultType, \"> \",\n                titleCase, \"Context;\\n\"\n          \"  virtual ::kj::Promise<void> \", identifierName, \"(\", titleCase, \"Context context);\\n\"),\n\n      implicitParams.size() == 0 ? kj::strTree() : kj::mv(requestMethodImpl),\n\n      kj::strTree(\n          implicitParams.size() == 0 ? kj::mv(requestMethodImpl) : kj::strTree(),\n          templateContext.allDecls(),\n          \"::kj::Promise<void> \", interfaceName, \"::Server::\", identifierName, \"(\", titleCase, \"Context) {\\n\"\n          \"  return ::capnp::Capability::Server::internalUnimplemented(\\n\"\n          \"      \\\"\", interfaceProto.getDisplayName(), \"\\\", \\\"\", name, \"\\\",\\n\"\n          \"      0x\", interfaceIdHex, \"ull, \", methodId, \");\\n\"\n          \"}\\n\"),\n\n      kj::strTree(\n          \"    case \", methodId, \":\\n\"\n          \"      return \", identifierName, \"(::capnp::Capability::Server::internalGetTypedContext<\\n\"\n          \"          \", genericParamType, \", \", genericResultType, \">(context));\\n\")\n    };\n  }"
        }
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "m",
            "schema.getMethods()"
          ],
          "line": 2124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getMethods",
          "args": [],
          "line": 2124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "scope",
            "name",
            "templateContext.args()"
          ],
          "line": 2123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.args",
          "args": [],
          "line": 2123
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::StringTree sourceDefs = kj::strTree(\n        KJ_MAP(n, nodeTexts) { return kj::mv(n.sourceFileDefs); });\n\nInterfaceText makeInterfaceText(kj::StringPtr scope, kj::StringPtr name, InterfaceSchema schema,\n                                  kj::Array<kj::StringTree> nestedTypeDecls,\n                                  const TemplateContext& templateContext) {\n    auto fullName = kj::str(scope, name, templateContext.args());\n    auto methods = KJ_MAP(m, schema.getMethods()) {\n      return makeMethodText(fullName, m, templateContext);\n    };\n\n    auto proto = schema.getProto();\n    auto hexId = kj::hex(proto.getId());\n\n    auto superclasses = KJ_MAP(superclass, schema.getSuperclasses()) {\n      return ExtendInfo { cppFullName(superclass, nullptr), superclass.getProto().getId() };\n    };\n\n    CppTypeName clientName = cppFullName(schema, nullptr);\n    clientName.addMemberType(\"Client\");\n\n    kj::String templates = kj::str(templateContext.allDecls());  // Ends with a newline\n\n    // Private members struct\n    kj::StringTree declareText = kj::strTree(\n         \"  #if !CAPNP_LITE\\n\"\n         \"  struct _capnpPrivate {\\n\"\n         \"    CAPNP_DECLARE_INTERFACE_HEADER(\", hexId, \")\\n\");\n\n    kj::StringTree defineText = kj::strTree(\n        \"// \", fullName, \"\\n\",\n        \"#if !CAPNP_LITE\\n\",\n        templates, \"constexpr ::capnp::Kind \", fullName, \"::_capnpPrivate::kind;\\n\",\n        templates, \"constexpr ::capnp::_::RawSchema const* \", fullName, \"::_capnpPrivate::schema;\\n\",\n        templates, \"constexpr ::capnp::_::RawBrandedSchema const* \", fullName, \"::_capnpPrivate::brand;\\n\");\n\n    if (templateContext.isGeneric()) {\n      auto brandInitializers = makeBrandInitializers(templateContext, schema);\n      bool hasDeps = (brandInitializers.dependencies.size() != 0);\n\n      declareText = kj::strTree(kj::mv(declareText),\n          makeGenericDeclarations(templateContext, hasDeps));\n\n      defineText = kj::strTree(kj::mv(defineText),\n          makeGenericDefinitions(templates, fullName, kj::str(hexId), kj::mv(brandInitializers)));\n    } else {\n      declareText = kj::strTree(kj::mv(declareText),\n        \"    static constexpr ::capnp::_::RawBrandedSchema const* brand = &schema->defaultBrand;\\n\");\n    }\n\n    declareText = kj::strTree(kj::mv(declareText), \"  };\\n  #endif  // !CAPNP_LITE\");\n    defineText = kj::strTree(kj::mv(defineText), \"#endif  // !CAPNP_LITE\\n\\n\");\n\n    return InterfaceText {\n      kj::strTree(\n          templateContext.hasParams() ? \"  \" : \"\", templateContext.decl(true),\n          \"  struct \", name, \";\\n\"),\n\n      kj::strTree(\n          templateContext.parentDecls(),\n          templateContext.decl(scope == nullptr),\n          \"struct \", scope, name, \" {\\n\",\n          \"  \", name, \"() = delete;\\n\"\n          \"\\n\"\n          \"#if !CAPNP_LITE\\n\"\n          \"  class Client;\\n\"\n          \"  class Server;\\n\"\n          \"#endif  // !CAPNP_LITE\\n\"\n          \"\\n\",\n          KJ_MAP(n, nestedTypeDecls) { return kj::mv(n); },\n          \"\\n\",\n          kj::mv(declareText), \"\\n\"\n          \"};\\n\"\n          \"\\n\"),\n\n      kj::strTree(\n          \"#if !CAPNP_LITE\\n\",\n          templateContext.allDecls(),\n          \"class \", fullName, \"::Client\\n\"\n          \"    : public virtual ::capnp::Capability::Client\",\n          KJ_MAP(s, superclasses) {\n            return kj::strTree(\",\\n      public virtual \", s.typeName, \"::Client\");\n          }, \" {\\n\"\n          \"public:\\n\"\n          \"  typedef \", fullName, \" Calls;\\n\"\n          \"  typedef \", fullName, \" Reads;\\n\"\n          \"\\n\"\n          \"  Client(decltype(nullptr));\\n\"\n          \"  explicit Client(::kj::Own< ::capnp::ClientHook>&& hook);\\n\"\n          \"  template <typename _t, typename = ::kj::EnableIf< ::kj::canConvert<_t*, Server*>()>>\\n\"\n          \"  Client(::kj::Own<_t>&& server);\\n\"\n          \"  template <typename _t, typename = ::kj::EnableIf< ::kj::canConvert<_t*, Client*>()>>\\n\"\n          \"  Client(::kj::Promise<_t>&& promise);\\n\"\n          \"  Client(::kj::Exception&& exception);\\n\"\n          \"  Client(Client&) = default;\\n\"\n          \"  Client(Client&&) = default;\\n\"\n          \"  Client& operator=(Client& other);\\n\"\n          \"  Client& operator=(Client&& other);\\n\"\n          \"\\n\",\n          KJ_MAP(m, methods) { return kj::mv(m.clientDecls); },\n          \"\\n\"\n          \"protected:\\n\"\n          \"  Client() = default;\\n\"\n          \"};\\n\"\n          \"\\n\",\n          templateContext.allDecls(),\n          \"class \", fullName, \"::Server\\n\"\n          \"    : public virtual ::capnp::Capability::Server\",\n          KJ_MAP(s, superclasses) {\n            return kj::strTree(\",\\n      public virtual \", s.typeName, \"::Server\");\n          }, \" {\\n\"\n          \"public:\\n\",\n          \"  typedef \", fullName, \" Serves;\\n\"\n          \"\\n\"\n          \"  ::kj::Promise<void> dispatchCall(uint64_t interfaceId, uint16_t methodId,\\n\"\n          \"      ::capnp::CallContext< ::capnp::AnyPointer, ::capnp::AnyPointer> context)\\n\"\n          \"      override;\\n\"\n          \"\\n\"\n          \"protected:\\n\",\n          KJ_MAP(m, methods) { return kj::mv(m.serverDecls); },\n          \"\\n\"\n          \"  ::kj::Promise<void> dispatchCallInternal(uint16_t methodId,\\n\"\n          \"      ::capnp::CallContext< ::capnp::AnyPointer, ::capnp::AnyPointer> context);\\n\"\n          \"};\\n\"\n          \"#endif  // !CAPNP_LITE\\n\"\n          \"\\n\"),\n\n      kj::strTree(\n          \"#if !CAPNP_LITE\\n\",\n          templateContext.allDecls(),\n          \"inline \", fullName, \"::Client::Client(decltype(nullptr))\\n\"\n          \"    : ::capnp::Capability::Client(nullptr) {}\\n\",\n          templateContext.allDecls(),\n          \"inline \", fullName, \"::Client::Client(\\n\"\n          \"    ::kj::Own< ::capnp::ClientHook>&& hook)\\n\"\n          \"    : ::capnp::Capability::Client(::kj::mv(hook)) {}\\n\",\n          templateContext.allDecls(),\n          \"template <typename _t, typename>\\n\"\n          \"inline \", fullName, \"::Client::Client(::kj::Own<_t>&& server)\\n\"\n          \"    : ::capnp::Capability::Client(::kj::mv(server)) {}\\n\",\n          templateContext.allDecls(),\n          \"template <typename _t, typename>\\n\"\n          \"inline \", fullName, \"::Client::Client(::kj::Promise<_t>&& promise)\\n\"\n          \"    : ::capnp::Capability::Client(::kj::mv(promise)) {}\\n\",\n          templateContext.allDecls(),\n          \"inline \", fullName, \"::Client::Client(::kj::Exception&& exception)\\n\"\n          \"    : ::capnp::Capability::Client(::kj::mv(exception)) {}\\n\",\n          templateContext.allDecls(),\n          \"inline \", clientName, \"& \", fullName, \"::Client::operator=(Client& other) {\\n\"\n          \"  ::capnp::Capability::Client::operator=(other);\\n\"\n          \"  return *this;\\n\"\n          \"}\\n\",\n          templateContext.allDecls(),\n          \"inline \", clientName, \"& \", fullName, \"::Client::operator=(Client&& other) {\\n\"\n          \"  ::capnp::Capability::Client::operator=(kj::mv(other));\\n\"\n          \"  return *this;\\n\"\n          \"}\\n\"\n          \"\\n\",\n          KJ_MAP(m, methods) { return kj::mv(m.inlineDefs); },\n          \"#endif  // !CAPNP_LITE\\n\"),\n\n      kj::strTree(\n          \"#if !CAPNP_LITE\\n\",\n          KJ_MAP(m, methods) { return kj::mv(m.sourceDefs); },\n          templateContext.allDecls(),\n          \"::kj::Promise<void> \", fullName, \"::Server::dispatchCall(\\n\"\n          \"    uint64_t interfaceId, uint16_t methodId,\\n\"\n          \"    ::capnp::CallContext< ::capnp::AnyPointer, ::capnp::AnyPointer> context) {\\n\"\n          \"  switch (interfaceId) {\\n\"\n          \"    case 0x\", kj::hex(proto.getId()), \"ull:\\n\"\n          \"      return dispatchCallInternal(methodId, context);\\n\",\n          KJ_MAP(s, superclasses) {\n            return kj::strTree(\n              \"    case 0x\", kj::hex(s.id), \"ull:\\n\"\n              \"      return \", s.typeName, \"::Server::dispatchCallInternal(methodId, context);\\n\");\n          },\n          \"    default:\\n\"\n          \"      return internalUnimplemented(\\\"\", proto.getDisplayName(), \"\\\", interfaceId);\\n\"\n          \"  }\\n\"\n          \"}\\n\",\n          templateContext.allDecls(),\n          \"::kj::Promise<void> \", fullName, \"::Server::dispatchCallInternal(\\n\"\n          \"    uint16_t methodId,\\n\"\n          \"    ::capnp::CallContext< ::capnp::AnyPointer, ::capnp::AnyPointer> context) {\\n\"\n          \"  switch (methodId) {\\n\",\n          KJ_MAP(m, methods) { return kj::mv(m.dispatchCase); },\n          \"    default:\\n\"\n          \"      (void)context;\\n\"\n          \"      return ::capnp::Capability::Server::internalUnimplemented(\\n\"\n          \"          \\\"\", proto.getDisplayName(), \"\\\",\\n\"\n          \"          0x\", kj::hex(proto.getId()), \"ull, methodId);\\n\"\n          \"  }\\n\"\n          \"}\\n\"\n          \"#endif  // !CAPNP_LITE\\n\"\n          \"\\n\",\n          kj::mv(defineText))\n    };\n  }"
  },
  {
    "function_name": "makeMethodText",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "1991-2105",
    "snippet": "MethodText makeMethodText(kj::StringPtr interfaceName, InterfaceSchema::Method method,\n                            const TemplateContext& templateContext) {\n    auto proto = method.getProto();\n    auto name = protoName(proto);\n    auto titleCase = toTitleCase(name);\n    auto paramSchema = method.getParamType();\n    auto resultSchema = method.getResultType();\n    auto identifierName = safeIdentifier(name);\n\n    auto paramProto = paramSchema.getProto();\n    auto resultProto = resultSchema.getProto();\n\n    auto implicitParamsReader = proto.getImplicitParameters();\n    auto implicitParamsBuilder = kj::heapArrayBuilder<CppTypeName>(implicitParamsReader.size());\n    for (auto param: implicitParamsReader) {\n      implicitParamsBuilder.add(CppTypeName::makeTemplateParam(param.getName()));\n    }\n    auto implicitParams = implicitParamsBuilder.finish();\n\n    kj::String implicitParamsTemplateDecl;\n    if (implicitParams.size() > 0) {\n      implicitParamsTemplateDecl = kj::str(\n          \"template <\", kj::StringTree(KJ_MAP(p, implicitParams) {\n            return kj::strTree(\"typename \", p);\n          }, \", \"), \">\\n\");\n    }\n\n\n    CppTypeName interfaceTypeName = cppFullName(method.getContainingInterface(), nullptr);\n    CppTypeName paramType;\n    CppTypeName genericParamType;\n    if (paramProto.getScopeId() == 0) {\n      paramType = interfaceTypeName;\n      if (implicitParams.size() == 0) {\n        paramType.addMemberType(kj::str(titleCase, \"Params\"));\n        genericParamType = paramType;\n      } else {\n        genericParamType = paramType;\n        genericParamType.addMemberTemplate(kj::str(titleCase, \"Params\"), nullptr);\n        paramType.addMemberTemplate(kj::str(titleCase, \"Params\"),\n                                    kj::heapArray(implicitParams.asPtr()));\n      }\n    } else {\n      paramType = cppFullName(paramSchema, method);\n      genericParamType = cppFullName(paramSchema, nullptr);\n    }\n    CppTypeName resultType;\n    CppTypeName genericResultType;\n    if (resultProto.getScopeId() == 0) {\n      resultType = interfaceTypeName;\n      if (implicitParams.size() == 0) {\n        resultType.addMemberType(kj::str(titleCase, \"Results\"));\n        genericResultType = resultType;\n      } else {\n        genericResultType = resultType;\n        genericResultType.addMemberTemplate(kj::str(titleCase, \"Results\"), nullptr);\n        resultType.addMemberTemplate(kj::str(titleCase, \"Results\"),\n                                     kj::heapArray(implicitParams.asPtr()));\n      }\n    } else {\n      resultType = cppFullName(resultSchema, method);\n      genericResultType = cppFullName(resultSchema, nullptr);\n    }\n\n    kj::String shortParamType = paramProto.getScopeId() == 0 ?\n        kj::str(titleCase, \"Params\") : kj::str(genericParamType);\n    kj::String shortResultType = resultProto.getScopeId() == 0 ?\n        kj::str(titleCase, \"Results\") : kj::str(genericResultType);\n\n    auto interfaceProto = method.getContainingInterface().getProto();\n    uint64_t interfaceId = interfaceProto.getId();\n    auto interfaceIdHex = kj::hex(interfaceId);\n    uint16_t methodId = method.getIndex();\n\n    auto requestMethodImpl = kj::strTree(\n        templateContext.allDecls(),\n        implicitParamsTemplateDecl,\n        \"::capnp::Request<\", paramType, \", \", resultType, \">\\n\",\n        interfaceName, \"::Client::\", name, \"Request(::kj::Maybe< ::capnp::MessageSize> sizeHint) {\\n\"\n        \"  return newCall<\", paramType, \", \", resultType, \">(\\n\"\n        \"      0x\", interfaceIdHex, \"ull, \", methodId, \", sizeHint);\\n\"\n        \"}\\n\");\n\n    return MethodText {\n      kj::strTree(\n          implicitParamsTemplateDecl.size() == 0 ? \"\" : \"  \", implicitParamsTemplateDecl,\n          \"  ::capnp::Request<\", paramType, \", \", resultType, \"> \", name, \"Request(\\n\"\n          \"      ::kj::Maybe< ::capnp::MessageSize> sizeHint = nullptr);\\n\"),\n\n      kj::strTree(\n          paramProto.getScopeId() != 0 ? kj::strTree() : kj::strTree(\n              \"  typedef \", genericParamType, \" \", titleCase, \"Params;\\n\"),\n          resultProto.getScopeId() != 0 ? kj::strTree() : kj::strTree(\n              \"  typedef \", genericResultType, \" \", titleCase, \"Results;\\n\"),\n          \"  typedef ::capnp::CallContext<\", shortParamType, \", \", shortResultType, \"> \",\n                titleCase, \"Context;\\n\"\n          \"  virtual ::kj::Promise<void> \", identifierName, \"(\", titleCase, \"Context context);\\n\"),\n\n      implicitParams.size() == 0 ? kj::strTree() : kj::mv(requestMethodImpl),\n\n      kj::strTree(\n          implicitParams.size() == 0 ? kj::mv(requestMethodImpl) : kj::strTree(),\n          templateContext.allDecls(),\n          \"::kj::Promise<void> \", interfaceName, \"::Server::\", identifierName, \"(\", titleCase, \"Context) {\\n\"\n          \"  return ::capnp::Capability::Server::internalUnimplemented(\\n\"\n          \"      \\\"\", interfaceProto.getDisplayName(), \"\\\", \\\"\", name, \"\\\",\\n\"\n          \"      0x\", interfaceIdHex, \"ull, \", methodId, \");\\n\"\n          \"}\\n\"),\n\n      kj::strTree(\n          \"    case \", methodId, \":\\n\"\n          \"      return \", identifierName, \"(::capnp::Capability::Server::internalGetTypedContext<\\n\"\n          \"          \", genericParamType, \", \", genericResultType, \">(context));\\n\")\n    };\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"    case \"",
            "methodId",
            "\":\\n\"\n          \"      return \"",
            "identifierName",
            "\"(::capnp::Capability::Server::internalGetTypedContext<\\n\"\n          \"          \"",
            "genericParamType",
            "\", \"",
            "genericResultType",
            "\">(context));\\n\""
          ],
          "line": 2100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "implicitParams.size() == 0 ? kj::mv(requestMethodImpl) : kj::strTree()",
            "templateContext.allDecls()",
            "\"::kj::Promise<void> \"",
            "interfaceName",
            "\"::Server::\"",
            "identifierName",
            "\"(\"",
            "titleCase",
            "\"Context) {\\n\"\n          \"  return ::capnp::Capability::Server::internalUnimplemented(\\n\"\n          \"      \\\"\"",
            "interfaceProto.getDisplayName()",
            "\"\\\", \\\"\"",
            "name",
            "\"\\\",\\n\"\n          \"      0x\"",
            "interfaceIdHex",
            "\"ull, \"",
            "methodId",
            "\");\\n\"\n          \"}\\n\""
          ],
          "line": 2091
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "interfaceProto.getDisplayName",
          "args": [],
          "line": 2096
        },
        "resolved": true,
        "details": {
          "function_name": "getDisplayName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema-parser.c++",
          "lines": "416-418",
          "snippet": "kj::StringPtr getDisplayName() const override {\n    return displayName;\n  }",
          "includes": [
            "#include <sys/mman.h>",
            "#include <windows.h>",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/mutex.h>",
            "#include <unordered_map>",
            "#include <capnp/compiler/parser.h>",
            "#include <capnp/compiler/grammar.capnp.h>",
            "#include <capnp/compiler/lexer.h>",
            "#include <capnp/compiler/lexer.capnp.h>",
            "#include <capnp/compiler/compiler.h>",
            "#include \"message.h\"",
            "#include \"schema-parser.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/mman.h>\n#include <windows.h>\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/mutex.h>\n#include <unordered_map>\n#include <capnp/compiler/parser.h>\n#include <capnp/compiler/grammar.capnp.h>\n#include <capnp/compiler/lexer.h>\n#include <capnp/compiler/lexer.capnp.h>\n#include <capnp/compiler/compiler.h>\n#include \"message.h\"\n#include \"schema-parser.h\"\n\nkj::StringPtr getDisplayName() const override {\n    return displayName;\n  }"
        }
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 2093
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [],
          "line": 2092
        },
        "resolved": true,
        "details": {
          "function_name": "strTree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
          "lines": "206-208",
          "snippet": "StringTree strTree(Params&&... params) {\n  return StringTree::concat(_::toStringTreeOrCharSequence(kj::fwd<Params>(params))...);\n}",
          "includes": [
            "#include \"string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"string.h\"\n\nStringTree strTree(Params&&... params) {\n  return StringTree::concat(_::toStringTreeOrCharSequence(kj::fwd<Params>(params))...);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "requestMethodImpl"
          ],
          "line": 2092
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "implicitParams.size",
          "args": [],
          "line": 2092
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-capnp.c++",
          "lines": "74-74",
          "snippet": "inline size_t size() const { return amount; }",
          "includes": [
            "#include \"config.h\"",
            "#include <map>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <map>\n#include <algorithm>\n#include <kj/main.h>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nIndent {\n  inline size_t size() const { return amount; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "requestMethodImpl"
          ],
          "line": 2089
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "paramProto.getScopeId() != 0 ? kj::strTree() : kj::strTree(\n              \"  typedef \", genericParamType, \" \", titleCase, \"Params;\\n\")",
            "resultProto.getScopeId() != 0 ? kj::strTree() : kj::strTree(\n              \"  typedef \", genericResultType, \" \", titleCase, \"Results;\\n\")",
            "\"  typedef ::capnp::CallContext<\"",
            "shortParamType",
            "\", \"",
            "shortResultType",
            "\"> \"",
            "titleCase",
            "\"Context;\\n\"\n          \"  virtual ::kj::Promise<void> \"",
            "identifierName",
            "\"(\"",
            "titleCase",
            "\"Context context);\\n\""
          ],
          "line": 2080
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"  typedef \"",
            "genericResultType",
            "\" \"",
            "titleCase",
            "\"Results;\\n\""
          ],
          "line": 2083
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "resultProto.getScopeId",
          "args": [],
          "line": 2083
        },
        "resolved": true,
        "details": {
          "function_name": "getScopeId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/node-translator.c++",
          "lines": "778-778",
          "snippet": "inline uint64_t getScopeId() { return leafId; }",
          "includes": [
            "#include <map>",
            "#include <set>",
            "#include <kj/arena.h>",
            "#include <kj/debug.h>",
            "#include \"parser.h\"      // only for generateGroupId()",
            "#include \"node-translator.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "uint64_t leafId;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <map>\n#include <set>\n#include <kj/arena.h>\n#include <kj/debug.h>\n#include \"parser.h\"      // only for generateGroupId()\n#include \"node-translator.h\"\n\nuint64_t leafId;\n\ninline uint64_t getScopeId() { return leafId; }"
        }
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"  typedef \"",
            "genericParamType",
            "\" \"",
            "titleCase",
            "\"Params;\\n\""
          ],
          "line": 2081
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "implicitParamsTemplateDecl.size() == 0 ? \"\" : \"  \"",
            "implicitParamsTemplateDecl",
            "\"  ::capnp::Request<\"",
            "paramType",
            "\", \"",
            "resultType",
            "\"> \"",
            "name",
            "\"Request(\\n\"\n          \"      ::kj::Maybe< ::capnp::MessageSize> sizeHint = nullptr);\\n\""
          ],
          "line": 2075
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "templateContext.allDecls()",
            "implicitParamsTemplateDecl",
            "\"::capnp::Request<\"",
            "paramType",
            "\", \"",
            "resultType",
            "\">\\n\"",
            "interfaceName",
            "\"::Client::\"",
            "name",
            "\"Request(::kj::Maybe< ::capnp::MessageSize> sizeHint) {\\n\"\n        \"  return newCall<\"",
            "paramType",
            "\", \"",
            "resultType",
            "\">(\\n\"\n        \"      0x\"",
            "interfaceIdHex",
            "\"ull, \"",
            "methodId",
            "\", sizeHint);\\n\"\n        \"}\\n\""
          ],
          "line": 2065
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 2066
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "method.getIndex",
          "args": [],
          "line": 2063
        },
        "resolved": true,
        "details": {
          "function_name": "getIndex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "487-487",
          "snippet": "inline uint getIndex() const { return ordinal; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline uint getIndex() const { return ordinal; }"
        }
      },
      {
        "call_info": {
          "callee": "kj::hex",
          "args": [
            "interfaceId"
          ],
          "line": 2062
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "interfaceProto.getId",
          "args": [],
          "line": 2061
        },
        "resolved": true,
        "details": {
          "function_name": "getId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
          "lines": "75-75",
          "snippet": "uint64_t getId() { return id; }",
          "includes": [
            "#include \"md5.h\"",
            "#include \"node-translator.h\"",
            "#include <unordered_map>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/message.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/arena.h>",
            "#include <kj/mutex.h>",
            "#include \"parser.h\"      // only for generateChildId()",
            "#include \"compiler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nuint64_t getId() { return id; }"
        }
      },
      {
        "call_info": {
          "callee": "method.getContainingInterface",
          "args": [],
          "line": 2060
        },
        "resolved": true,
        "details": {
          "function_name": "getContainingInterface",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "484-484",
          "snippet": "inline InterfaceSchema getContainingInterface() const { return parent; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline InterfaceSchema getContainingInterface() const { return parent; }"
        }
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "genericResultType"
          ],
          "line": 2058
        },
        "resolved": true,
        "details": {
          "function_name": "str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "341-341",
          "snippet": "inline String str(String&& s) { return mv(s); }",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\ninline String str(String&& s) { return mv(s); }"
        }
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "titleCase",
            "\"Results\""
          ],
          "line": 2058
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "titleCase",
            "\"Params\""
          ],
          "line": 2056
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cppFullName",
          "args": [
            "resultSchema",
            "nullptr"
          ],
          "line": 2052
        },
        "resolved": true,
        "details": {
          "function_name": "cppFullName",
          "container": "CapnpcCppMain",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "316-318",
          "snippet": "CppTypeName cppFullName(Schema schema, kj::Maybe<InterfaceSchema::Method> method) {\n    return cppFullName(schema, schema, method);\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCapnpcCppMain {\n  CppTypeName cppFullName(Schema schema, kj::Maybe<InterfaceSchema::Method> method) {\n      return cppFullName(schema, schema, method);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "resultType.addMemberTemplate",
          "args": [
            "kj::str(titleCase, \"Results\")",
            "kj::heapArray(implicitParams.asPtr())"
          ],
          "line": 2047
        },
        "resolved": true,
        "details": {
          "function_name": "addMemberTemplate",
          "container": "CppTypeName",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "224-243",
          "snippet": "void addMemberTemplate(kj::StringPtr innerName, kj::Array<CppTypeName>&& params) {\n    // Append \"::innerName<params, ...>\".\n    //\n    // If necessary, add the \"template\" disambiguation keyword in front of `innerName`.\n\n    bool parentIsArgDependent = isArgDependent;\n    needsTypename = parentIsArgDependent;\n    hasDisambiguatedTemplate_ = hasDisambiguatedTemplate_ || parentIsArgDependent;\n\n    name = kj::strTree(kj::mv(name),\n        parentIsArgDependent ? \"::template \" : \"::\",\n        innerName, '<',\n        kj::StringTree(KJ_MAP(p, params) {\n          if (p.isArgDependent) isArgDependent = true;\n          if (p.hasInterfaces_) hasInterfaces_ = true;\n          if (p.hasDisambiguatedTemplate_) hasDisambiguatedTemplate_ = true;\n          return kj::strTree(kj::mv(p));\n        }, \", \"),\n        '>');\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName {\n  void addMemberTemplate(kj::StringPtr innerName, kj::Array<CppTypeName>&& params) {\n      // Append \"::innerName<params, ...>\".\n      //\n      // If necessary, add the \"template\" disambiguation keyword in front of `innerName`.\n  \n      bool parentIsArgDependent = isArgDependent;\n      needsTypename = parentIsArgDependent;\n      hasDisambiguatedTemplate_ = hasDisambiguatedTemplate_ || parentIsArgDependent;\n  \n      name = kj::strTree(kj::mv(name),\n          parentIsArgDependent ? \"::template \" : \"::\",\n          innerName, '<',\n          kj::StringTree(KJ_MAP(p, params) {\n            if (p.isArgDependent) isArgDependent = true;\n            if (p.hasInterfaces_) hasInterfaces_ = true;\n            if (p.hasDisambiguatedTemplate_) hasDisambiguatedTemplate_ = true;\n            return kj::strTree(kj::mv(p));\n          }, \", \"),\n          '>');\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::heapArray",
          "args": [
            "implicitParams.asPtr()"
          ],
          "line": 2048
        },
        "resolved": true,
        "details": {
          "function_name": "heapArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "696-698",
          "snippet": "inline Array<T> heapArray(std::initializer_list<T> init) {\n  return heapArray<T>(init.begin(), init.end());\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\ninline Array<T> heapArray(std::initializer_list<T> init) {\n  return heapArray<T>(init.begin(), init.end());\n}"
        }
      },
      {
        "call_info": {
          "callee": "implicitParams.asPtr",
          "args": [],
          "line": 2048
        },
        "resolved": true,
        "details": {
          "function_name": "asPtr",
          "container": "ArrayBuilder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "313-315",
          "snippet": "inline ArrayPtr<const T> asPtr() const {\n    return arrayPtr(ptr, pos);\n  }",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\nArrayBuilder {\n  inline ArrayPtr<const T> asPtr() const {\n      return arrayPtr(ptr, pos);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "titleCase",
            "\"Results\""
          ],
          "line": 2047
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "titleCase",
            "\"Results\""
          ],
          "line": 2046
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "resultType.addMemberType",
          "args": [
            "kj::str(titleCase, \"Results\")"
          ],
          "line": 2042
        },
        "resolved": true,
        "details": {
          "function_name": "addMemberType",
          "container": "CppTypeName",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "206-211",
          "snippet": "void addMemberType(kj::StringPtr innerName) {\n    // Append \"::innerName\" to refer to a member.\n\n    name = kj::strTree(kj::mv(name), \"::\", innerName);\n    needsTypename = isArgDependent;\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName {\n  void addMemberType(kj::StringPtr innerName) {\n      // Append \"::innerName\" to refer to a member.\n  \n      name = kj::strTree(kj::mv(name), \"::\", innerName);\n      needsTypename = isArgDependent;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "titleCase",
            "\"Results\""
          ],
          "line": 2042
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "titleCase",
            "\"Params\""
          ],
          "line": 2030
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "titleCase",
            "\"Params\""
          ],
          "line": 2029
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "titleCase",
            "\"Params\""
          ],
          "line": 2025
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "\"template <\"",
            "kj::StringTree(KJ_MAP(p, implicitParams) {\n            return kj::strTree(\"typename \", p);\n          }, \", \")",
            "\">\\n\""
          ],
          "line": 2012
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::StringTree",
          "args": [
            "KJ_MAP(p, implicitParams){\n            return kj::strTree(\"typename \", p);\n          }",
            "\", \""
          ],
          "line": 2013
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"typename \"",
            "p"
          ],
          "line": 2014
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "p",
            "implicitParams"
          ],
          "line": 2013
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "implicitParamsBuilder.finish",
          "args": [],
          "line": 2008
        },
        "resolved": true,
        "details": {
          "function_name": "finish",
          "container": "ArrayBuilder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "369-382",
          "snippet": "Array<T> finish() {\n    // We could safely remove this check if we assume that the disposer implementation doesn't\n    // need to know the original capacity, as is thes case with HeapArrayDisposer since it uses\n    // operator new() or if we created a custom disposer for ArrayBuilder which stores the capacity\n    // in a prefix.  But that would make it hard to write cleverer heap allocators, and anyway this\n    // check might catch bugs.  Probably people should use Vector if they want to build arrays\n    // without knowing the final size in advance.\n    KJ_IREQUIRE(pos == endPtr, \"ArrayBuilder::finish() called prematurely.\");\n    Array<T> result(reinterpret_cast<T*>(ptr), pos - ptr, *disposer);\n    ptr = nullptr;\n    pos = nullptr;\n    endPtr = nullptr;\n    return result;\n  }",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\nArrayBuilder {\n  Array<T> finish() {\n      // We could safely remove this check if we assume that the disposer implementation doesn't\n      // need to know the original capacity, as is thes case with HeapArrayDisposer since it uses\n      // operator new() or if we created a custom disposer for ArrayBuilder which stores the capacity\n      // in a prefix.  But that would make it hard to write cleverer heap allocators, and anyway this\n      // check might catch bugs.  Probably people should use Vector if they want to build arrays\n      // without knowing the final size in advance.\n      KJ_IREQUIRE(pos == endPtr, \"ArrayBuilder::finish() called prematurely.\");\n      Array<T> result(reinterpret_cast<T*>(ptr), pos - ptr, *disposer);\n      ptr = nullptr;\n      pos = nullptr;\n      endPtr = nullptr;\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "implicitParamsBuilder.add",
          "args": [
            "CppTypeName::makeTemplateParam(param.getName())"
          ],
          "line": 2006
        },
        "resolved": true,
        "details": {
          "function_name": "add",
          "container": "ReusableObjects::ObjectSizeCounter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/null-common.h",
          "lines": "86-88",
          "snippet": "void add(size_t wordCount) {\n      maxSize = std::max(wordCount, maxSize);\n    }",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nReusableObjects {\n  ObjectSizeCounter {\n    void add(size_t wordCount) {\n          maxSize = std::max(wordCount, maxSize);\n        }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CppTypeName::makeTemplateParam",
          "args": [
            "param.getName()"
          ],
          "line": 2006
        },
        "resolved": true,
        "details": {
          "function_name": "makeTemplateParam",
          "container": "CppTypeName",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "198-200",
          "snippet": "static CppTypeName makeTemplateParam(kj::StringPtr name) {\n    return CppTypeName(kj::strTree(name), true);\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName {\n  static CppTypeName makeTemplateParam(kj::StringPtr name) {\n      return CppTypeName(kj::strTree(name), true);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "param.getName",
          "args": [],
          "line": 2006
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::heapArrayBuilder<CppTypeName>",
          "args": [
            "implicitParamsReader.size()"
          ],
          "line": 2004
        },
        "resolved": true,
        "details": {
          "function_name": "heapArrayBuilder",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "410-416",
          "snippet": "inline ArrayBuilder<T> heapArrayBuilder(size_t size) {\n  // Like `heapArray<T>()` but does not default-construct the elements.  You must construct them\n  // manually by calling `add()`.\n\n  return ArrayBuilder<T>(_::HeapArrayDisposer::allocateUninitialized<RemoveConst<T>>(size),\n                         size, _::HeapArrayDisposer::instance);\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\ninline ArrayBuilder<T> heapArrayBuilder(size_t size) {\n  // Like `heapArray<T>()` but does not default-construct the elements.  You must construct them\n  // manually by calling `add()`.\n\n  return ArrayBuilder<T>(_::HeapArrayDisposer::allocateUninitialized<RemoveConst<T>>(size),\n                         size, _::HeapArrayDisposer::instance);\n}"
        }
      },
      {
        "call_info": {
          "callee": "proto.getImplicitParameters",
          "args": [],
          "line": 2003
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "resultSchema.getProto",
          "args": [],
          "line": 2001
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      },
      {
        "call_info": {
          "callee": "safeIdentifier",
          "args": [
            "name"
          ],
          "line": 1998
        },
        "resolved": true,
        "details": {
          "function_name": "safeIdentifier",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "143-166",
          "snippet": "kj::String safeIdentifier(kj::StringPtr identifier) {\n  // Given a desired identifier name, munge it to make it safe for use in generated code.\n  //\n  // If the identifier is a keyword, this adds an underscore to the end.\n\n  static const std::set<kj::StringPtr> keywords({\n    \"alignas\", \"alignof\", \"and\", \"and_eq\", \"asm\", \"auto\", \"bitand\", \"bitor\", \"bool\", \"break\",\n    \"case\", \"catch\", \"char\", \"char16_t\", \"char32_t\", \"class\", \"compl\", \"const\", \"constexpr\",\n    \"const_cast\", \"continue\", \"decltype\", \"default\", \"delete\", \"do\", \"double\", \"dynamic_cast\",\n    \"else\", \"enum\", \"explicit\", \"export\", \"extern\", \"false\", \"float\", \"for\", \"friend\", \"goto\",\n    \"if\", \"inline\", \"int\", \"long\", \"mutable\", \"namespace\", \"new\", \"noexcept\", \"not\", \"not_eq\",\n    \"nullptr\", \"operator\", \"or\", \"or_eq\", \"private\", \"protected\", \"public\", \"register\",\n    \"reinterpret_cast\", \"return\", \"short\", \"signed\", \"sizeof\", \"static\", \"static_assert\",\n    \"static_cast\", \"struct\", \"switch\", \"template\", \"this\", \"thread_local\", \"throw\", \"true\",\n    \"try\", \"typedef\", \"typeid\", \"typename\", \"union\", \"unsigned\", \"using\", \"virtual\", \"void\",\n    \"volatile\", \"wchar_t\", \"while\", \"xor\", \"xor_eq\"\n  });\n\n  if (keywords.count(identifier) > 0) {\n    return kj::str(identifier, '_');\n  } else {\n    return kj::heapString(identifier);\n  }\n}",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::String safeIdentifier(kj::StringPtr identifier) {\n  // Given a desired identifier name, munge it to make it safe for use in generated code.\n  //\n  // If the identifier is a keyword, this adds an underscore to the end.\n\n  static const std::set<kj::StringPtr> keywords({\n    \"alignas\", \"alignof\", \"and\", \"and_eq\", \"asm\", \"auto\", \"bitand\", \"bitor\", \"bool\", \"break\",\n    \"case\", \"catch\", \"char\", \"char16_t\", \"char32_t\", \"class\", \"compl\", \"const\", \"constexpr\",\n    \"const_cast\", \"continue\", \"decltype\", \"default\", \"delete\", \"do\", \"double\", \"dynamic_cast\",\n    \"else\", \"enum\", \"explicit\", \"export\", \"extern\", \"false\", \"float\", \"for\", \"friend\", \"goto\",\n    \"if\", \"inline\", \"int\", \"long\", \"mutable\", \"namespace\", \"new\", \"noexcept\", \"not\", \"not_eq\",\n    \"nullptr\", \"operator\", \"or\", \"or_eq\", \"private\", \"protected\", \"public\", \"register\",\n    \"reinterpret_cast\", \"return\", \"short\", \"signed\", \"sizeof\", \"static\", \"static_assert\",\n    \"static_cast\", \"struct\", \"switch\", \"template\", \"this\", \"thread_local\", \"throw\", \"true\",\n    \"try\", \"typedef\", \"typeid\", \"typename\", \"union\", \"unsigned\", \"using\", \"virtual\", \"void\",\n    \"volatile\", \"wchar_t\", \"while\", \"xor\", \"xor_eq\"\n  });\n\n  if (keywords.count(identifier) > 0) {\n    return kj::str(identifier, '_');\n  } else {\n    return kj::heapString(identifier);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "method.getResultType",
          "args": [],
          "line": 1997
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "method.getParamType",
          "args": [],
          "line": 1996
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "toTitleCase",
          "args": [
            "name"
          ],
          "line": 1995
        },
        "resolved": true,
        "details": {
          "function_name": "toTitleCase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "423-429",
          "snippet": "kj::String toTitleCase(kj::StringPtr name) {\n    kj::String result = kj::heapString(name);\n    if ('a' <= result[0] && result[0] <= 'z') {\n      result[0] = result[0] - 'a' + 'A';\n    }\n    return kj::mv(result);\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::String toTitleCase(kj::StringPtr name) {\n    kj::String result = kj::heapString(name);\n    if ('a' <= result[0] && result[0] <= 'z') {\n      result[0] = result[0] - 'a' + 'A';\n    }\n    return kj::mv(result);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "protoName",
          "args": [
            "proto"
          ],
          "line": 1994
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nMethodText makeMethodText(kj::StringPtr interfaceName, InterfaceSchema::Method method,\n                            const TemplateContext& templateContext) {\n    auto proto = method.getProto();\n    auto name = protoName(proto);\n    auto titleCase = toTitleCase(name);\n    auto paramSchema = method.getParamType();\n    auto resultSchema = method.getResultType();\n    auto identifierName = safeIdentifier(name);\n\n    auto paramProto = paramSchema.getProto();\n    auto resultProto = resultSchema.getProto();\n\n    auto implicitParamsReader = proto.getImplicitParameters();\n    auto implicitParamsBuilder = kj::heapArrayBuilder<CppTypeName>(implicitParamsReader.size());\n    for (auto param: implicitParamsReader) {\n      implicitParamsBuilder.add(CppTypeName::makeTemplateParam(param.getName()));\n    }\n    auto implicitParams = implicitParamsBuilder.finish();\n\n    kj::String implicitParamsTemplateDecl;\n    if (implicitParams.size() > 0) {\n      implicitParamsTemplateDecl = kj::str(\n          \"template <\", kj::StringTree(KJ_MAP(p, implicitParams) {\n            return kj::strTree(\"typename \", p);\n          }, \", \"), \">\\n\");\n    }\n\n\n    CppTypeName interfaceTypeName = cppFullName(method.getContainingInterface(), nullptr);\n    CppTypeName paramType;\n    CppTypeName genericParamType;\n    if (paramProto.getScopeId() == 0) {\n      paramType = interfaceTypeName;\n      if (implicitParams.size() == 0) {\n        paramType.addMemberType(kj::str(titleCase, \"Params\"));\n        genericParamType = paramType;\n      } else {\n        genericParamType = paramType;\n        genericParamType.addMemberTemplate(kj::str(titleCase, \"Params\"), nullptr);\n        paramType.addMemberTemplate(kj::str(titleCase, \"Params\"),\n                                    kj::heapArray(implicitParams.asPtr()));\n      }\n    } else {\n      paramType = cppFullName(paramSchema, method);\n      genericParamType = cppFullName(paramSchema, nullptr);\n    }\n    CppTypeName resultType;\n    CppTypeName genericResultType;\n    if (resultProto.getScopeId() == 0) {\n      resultType = interfaceTypeName;\n      if (implicitParams.size() == 0) {\n        resultType.addMemberType(kj::str(titleCase, \"Results\"));\n        genericResultType = resultType;\n      } else {\n        genericResultType = resultType;\n        genericResultType.addMemberTemplate(kj::str(titleCase, \"Results\"), nullptr);\n        resultType.addMemberTemplate(kj::str(titleCase, \"Results\"),\n                                     kj::heapArray(implicitParams.asPtr()));\n      }\n    } else {\n      resultType = cppFullName(resultSchema, method);\n      genericResultType = cppFullName(resultSchema, nullptr);\n    }\n\n    kj::String shortParamType = paramProto.getScopeId() == 0 ?\n        kj::str(titleCase, \"Params\") : kj::str(genericParamType);\n    kj::String shortResultType = resultProto.getScopeId() == 0 ?\n        kj::str(titleCase, \"Results\") : kj::str(genericResultType);\n\n    auto interfaceProto = method.getContainingInterface().getProto();\n    uint64_t interfaceId = interfaceProto.getId();\n    auto interfaceIdHex = kj::hex(interfaceId);\n    uint16_t methodId = method.getIndex();\n\n    auto requestMethodImpl = kj::strTree(\n        templateContext.allDecls(),\n        implicitParamsTemplateDecl,\n        \"::capnp::Request<\", paramType, \", \", resultType, \">\\n\",\n        interfaceName, \"::Client::\", name, \"Request(::kj::Maybe< ::capnp::MessageSize> sizeHint) {\\n\"\n        \"  return newCall<\", paramType, \", \", resultType, \">(\\n\"\n        \"      0x\", interfaceIdHex, \"ull, \", methodId, \", sizeHint);\\n\"\n        \"}\\n\");\n\n    return MethodText {\n      kj::strTree(\n          implicitParamsTemplateDecl.size() == 0 ? \"\" : \"  \", implicitParamsTemplateDecl,\n          \"  ::capnp::Request<\", paramType, \", \", resultType, \"> \", name, \"Request(\\n\"\n          \"      ::kj::Maybe< ::capnp::MessageSize> sizeHint = nullptr);\\n\"),\n\n      kj::strTree(\n          paramProto.getScopeId() != 0 ? kj::strTree() : kj::strTree(\n              \"  typedef \", genericParamType, \" \", titleCase, \"Params;\\n\"),\n          resultProto.getScopeId() != 0 ? kj::strTree() : kj::strTree(\n              \"  typedef \", genericResultType, \" \", titleCase, \"Results;\\n\"),\n          \"  typedef ::capnp::CallContext<\", shortParamType, \", \", shortResultType, \"> \",\n                titleCase, \"Context;\\n\"\n          \"  virtual ::kj::Promise<void> \", identifierName, \"(\", titleCase, \"Context context);\\n\"),\n\n      implicitParams.size() == 0 ? kj::strTree() : kj::mv(requestMethodImpl),\n\n      kj::strTree(\n          implicitParams.size() == 0 ? kj::mv(requestMethodImpl) : kj::strTree(),\n          templateContext.allDecls(),\n          \"::kj::Promise<void> \", interfaceName, \"::Server::\", identifierName, \"(\", titleCase, \"Context) {\\n\"\n          \"  return ::capnp::Capability::Server::internalUnimplemented(\\n\"\n          \"      \\\"\", interfaceProto.getDisplayName(), \"\\\", \\\"\", name, \"\\\",\\n\"\n          \"      0x\", interfaceIdHex, \"ull, \", methodId, \");\\n\"\n          \"}\\n\"),\n\n      kj::strTree(\n          \"    case \", methodId, \":\\n\"\n          \"      return \", identifierName, \"(::capnp::Capability::Server::internalGetTypedContext<\\n\"\n          \"          \", genericParamType, \", \", genericResultType, \">(context));\\n\")\n    };\n  }"
  },
  {
    "function_name": "makeStructText",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "1860-1979",
    "snippet": "StructText makeStructText(kj::StringPtr scope, kj::StringPtr name, StructSchema schema,\n                            kj::Array<kj::StringTree> nestedTypeDecls,\n                            const TemplateContext& templateContext) {\n    auto proto = schema.getProto();\n    KJ_IF_MAYBE(annotatedName, annotationValue(proto, NAME_ANNOTATION_ID)) {\n      name = annotatedName->getText();\n    }\n    auto fullName = kj::str(scope, name, templateContext.args());\n    auto subScope = kj::str(fullName, \"::\");\n    auto fieldTexts = KJ_MAP(f, schema.getFields()) {\n      return makeFieldText(subScope, f, templateContext);\n    };\n\n    auto structNode = proto.getStruct();\n    uint discrimOffset = structNode.getDiscriminantOffset();\n    auto hexId = kj::hex(proto.getId());\n\n    kj::String templates = kj::str(templateContext.allDecls());  // Ends with a newline\n\n    // Private members struct\n    kj::StringTree declareText = kj::strTree(\n         \"  struct _capnpPrivate {\\n\"\n         \"    CAPNP_DECLARE_STRUCT_HEADER(\", hexId, \", \", structNode.getDataWordCount(), \", \",\n         structNode.getPointerCount(), \")\\n\");\n\n    kj::StringTree defineText = kj::strTree(\n        \"// \", fullName, \"\\n\"\n        // TODO(msvc): MSVC doen't expect constexprs to have definitions. Remove #if once\n        //   MSVC catches up on constexpr.\n        \"#ifndef _MSC_VER\\n\",\n        templates, \"constexpr uint16_t \", fullName, \"::_capnpPrivate::dataWordSize;\\n\",\n        templates, \"constexpr uint16_t \", fullName, \"::_capnpPrivate::pointerCount;\\n\"\n        \"#endif\\n\",\n        \"#if !CAPNP_LITE\\n\",\n        templates, \"constexpr ::capnp::Kind \", fullName, \"::_capnpPrivate::kind;\\n\",\n        templates, \"constexpr ::capnp::_::RawSchema const* \", fullName, \"::_capnpPrivate::schema;\\n\",\n        templates, \"constexpr ::capnp::_::RawBrandedSchema const* \", fullName, \"::_capnpPrivate::brand;\\n\");\n\n    if (templateContext.isGeneric()) {\n      auto brandInitializers = makeBrandInitializers(templateContext, schema);\n      bool hasDeps = (brandInitializers.dependencies.size() != 0);\n\n      declareText = kj::strTree(kj::mv(declareText),\n          \"    #if !CAPNP_LITE\\n\",\n          makeGenericDeclarations(templateContext, hasDeps),\n          \"    #endif  // !CAPNP_LITE\\n\");\n\n      defineText = kj::strTree(kj::mv(defineText),\n          makeGenericDefinitions(templates, fullName, kj::str(hexId), kj::mv(brandInitializers)));\n    } else {\n      declareText = kj::strTree(kj::mv(declareText),\n          \"    #if !CAPNP_LITE\\n\"\n          \"    static constexpr ::capnp::_::RawBrandedSchema const* brand = &schema->defaultBrand;\\n\"\n          \"    #endif  // !CAPNP_LITE\\n\");\n    }\n\n    declareText = kj::strTree(kj::mv(declareText), \"  };\");\n    defineText = kj::strTree(kj::mv(defineText), \"#endif  // !CAPNP_LITE\\n\\n\");\n\n    // Name of the ::Which type, when applicable.\n    CppTypeName whichName;\n    if (structNode.getDiscriminantCount() != 0) {\n      whichName = cppFullName(schema, nullptr);\n      whichName.addMemberType(\"Which\");\n    }\n\n    return StructText {\n      kj::strTree(\n          templateContext.hasParams() ? \"  \" : \"\", templateContext.decl(true),\n          \"  struct \", name, \";\\n\"),\n\n      kj::strTree(\n          templateContext.parentDecls(),\n          templateContext.decl(scope == nullptr),\n          \"struct \", scope, name, \" {\\n\",\n          \"  \", name, \"() = delete;\\n\"\n          \"\\n\"\n          \"  class Reader;\\n\"\n          \"  class Builder;\\n\"\n          \"  class Pipeline;\\n\",\n          structNode.getDiscriminantCount() == 0 ? kj::strTree() : kj::strTree(\n              \"  enum Which: uint16_t {\\n\",\n              KJ_MAP(f, structNode.getFields()) {\n                if (hasDiscriminantValue(f)) {\n                  return kj::strTree(\"    \", toUpperCase(protoName(f)), \",\\n\");\n                } else {\n                  return kj::strTree();\n                }\n              },\n              \"  };\\n\"),\n          KJ_MAP(n, nestedTypeDecls) { return kj::mv(n); },\n          \"\\n\",\n          kj::mv(declareText), \"\\n\",\n          \"};\\n\"\n          \"\\n\"),\n\n      kj::strTree(\n          makeReaderDef(fullName, name, templateContext, structNode.getDiscriminantCount() != 0,\n                        KJ_MAP(f, fieldTexts) { return kj::mv(f.readerMethodDecls); }),\n          makeBuilderDef(fullName, name, templateContext, structNode.getDiscriminantCount() != 0,\n                         KJ_MAP(f, fieldTexts) { return kj::mv(f.builderMethodDecls); }),\n          makePipelineDef(fullName, name, templateContext, structNode.getDiscriminantCount() != 0,\n                          KJ_MAP(f, fieldTexts) { return kj::mv(f.pipelineMethodDecls); })),\n\n      kj::strTree(\n          structNode.getDiscriminantCount() == 0 ? kj::strTree() : kj::strTree(\n              templateContext.allDecls(),\n              \"inline \", whichName, \" \", fullName, \"::Reader::which() const {\\n\"\n              \"  return _reader.getDataField<Which>(\", discrimOffset, \" * ::capnp::ELEMENTS);\\n\"\n              \"}\\n\",\n              templateContext.allDecls(),\n              \"inline \", whichName, \" \", fullName, \"::Builder::which() {\\n\"\n              \"  return _builder.getDataField<Which>(\", discrimOffset, \" * ::capnp::ELEMENTS);\\n\"\n              \"}\\n\"\n              \"\\n\"),\n          KJ_MAP(f, fieldTexts) { return kj::mv(f.inlineMethodDefs); }),\n\n      kj::mv(defineText)\n    };\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "defineText"
          ],
          "line": 1977
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "structNode.getDiscriminantCount() == 0 ? kj::strTree() : kj::strTree(\n              templateContext.allDecls(),\n              \"inline \", whichName, \" \", fullName, \"::Reader::which() const {\\n\"\n              \"  return _reader.getDataField<Which>(\", discrimOffset, \" * ::capnp::ELEMENTS);\\n\"\n              \"}\\n\",\n              templateContext.allDecls(),\n              \"inline \", whichName, \" \", fullName, \"::Builder::which() {\\n\"\n              \"  return _builder.getDataField<Which>(\", discrimOffset, \" * ::capnp::ELEMENTS);\\n\"\n              \"}\\n\"\n              \"\\n\")",
            "KJ_MAP(f, fieldTexts){ return kj::mv(f.inlineMethodDefs); }"
          ],
          "line": 1964
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "f.inlineMethodDefs"
          ],
          "line": 1975
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "f",
            "fieldTexts"
          ],
          "line": 1975
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "templateContext.allDecls()",
            "\"inline \"",
            "whichName",
            "\" \"",
            "fullName",
            "\"::Reader::which() const {\\n\"\n              \"  return _reader.getDataField<Which>(\"",
            "discrimOffset",
            "\" * ::capnp::ELEMENTS);\\n\"\n              \"}\\n\"",
            "templateContext.allDecls()",
            "\"inline \"",
            "whichName",
            "\" \"",
            "fullName",
            "\"::Builder::which() {\\n\"\n              \"  return _builder.getDataField<Which>(\"",
            "discrimOffset",
            "\" * ::capnp::ELEMENTS);\\n\"\n              \"}\\n\"\n              \"\\n\""
          ],
          "line": 1965
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1970
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1966
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [],
          "line": 1965
        },
        "resolved": true,
        "details": {
          "function_name": "strTree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
          "lines": "206-208",
          "snippet": "StringTree strTree(Params&&... params) {\n  return StringTree::concat(_::toStringTreeOrCharSequence(kj::fwd<Params>(params))...);\n}",
          "includes": [
            "#include \"string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"string.h\"\n\nStringTree strTree(Params&&... params) {\n  return StringTree::concat(_::toStringTreeOrCharSequence(kj::fwd<Params>(params))...);\n}"
        }
      },
      {
        "call_info": {
          "callee": "structNode.getDiscriminantCount",
          "args": [],
          "line": 1965
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "makeReaderDef(fullName, name, templateContext, structNode.getDiscriminantCount() != 0,\n                        KJ_MAP(f, fieldTexts) { return kj::mv(f.readerMethodDecls); })",
            "makeBuilderDef(fullName, name, templateContext, structNode.getDiscriminantCount() != 0,\n                         KJ_MAP(f, fieldTexts) { return kj::mv(f.builderMethodDecls); })",
            "makePipelineDef(fullName, name, templateContext, structNode.getDiscriminantCount() != 0,\n                          KJ_MAP(f, fieldTexts) { return kj::mv(f.pipelineMethodDecls); })"
          ],
          "line": 1956
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "makePipelineDef",
          "args": [
            "fullName",
            "name",
            "templateContext",
            "structNode.getDiscriminantCount() != 0",
            "KJ_MAP(f, fieldTexts){ return kj::mv(f.pipelineMethodDecls); }"
          ],
          "line": 1961
        },
        "resolved": true,
        "details": {
          "function_name": "makePipelineDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "1794-1817",
          "snippet": "kj::StringTree makePipelineDef(kj::StringPtr fullName, kj::StringPtr unqualifiedParentType,\n                                 const TemplateContext& templateContext, bool isUnion,\n                                 kj::Array<kj::StringTree>&& methodDecls) {\n    return kj::strTree(\n        \"#if !CAPNP_LITE\\n\",\n        templateContext.allDecls(),\n        \"class \", fullName, \"::Pipeline {\\n\"\n        \"public:\\n\"\n        \"  typedef \", unqualifiedParentType, \" Pipelines;\\n\"\n        \"\\n\"\n        \"  inline Pipeline(decltype(nullptr)): _typeless(nullptr) {}\\n\"\n        \"  inline explicit Pipeline(::capnp::AnyPointer::Pipeline&& typeless)\\n\"\n        \"      : _typeless(kj::mv(typeless)) {}\\n\"\n        \"\\n\",\n        kj::mv(methodDecls),\n        \"private:\\n\"\n        \"  ::capnp::AnyPointer::Pipeline _typeless;\\n\"\n        \"  friend class ::capnp::PipelineHook;\\n\"\n        \"  template <typename, ::capnp::Kind>\\n\"\n        \"  friend struct ::capnp::ToDynamic_;\\n\"\n        \"};\\n\"\n        \"#endif  // !CAPNP_LITE\\n\"\n        \"\\n\");\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::StringTree makePipelineDef(kj::StringPtr fullName, kj::StringPtr unqualifiedParentType,\n                                 const TemplateContext& templateContext, bool isUnion,\n                                 kj::Array<kj::StringTree>&& methodDecls) {\n    return kj::strTree(\n        \"#if !CAPNP_LITE\\n\",\n        templateContext.allDecls(),\n        \"class \", fullName, \"::Pipeline {\\n\"\n        \"public:\\n\"\n        \"  typedef \", unqualifiedParentType, \" Pipelines;\\n\"\n        \"\\n\"\n        \"  inline Pipeline(decltype(nullptr)): _typeless(nullptr) {}\\n\"\n        \"  inline explicit Pipeline(::capnp::AnyPointer::Pipeline&& typeless)\\n\"\n        \"      : _typeless(kj::mv(typeless)) {}\\n\"\n        \"\\n\",\n        kj::mv(methodDecls),\n        \"private:\\n\"\n        \"  ::capnp::AnyPointer::Pipeline _typeless;\\n\"\n        \"  friend class ::capnp::PipelineHook;\\n\"\n        \"  template <typename, ::capnp::Kind>\\n\"\n        \"  friend struct ::capnp::ToDynamic_;\\n\"\n        \"};\\n\"\n        \"#endif  // !CAPNP_LITE\\n\"\n        \"\\n\");\n  }"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "f.pipelineMethodDecls"
          ],
          "line": 1962
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "f",
            "fieldTexts"
          ],
          "line": 1962
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structNode.getDiscriminantCount",
          "args": [],
          "line": 1961
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "makeBuilderDef",
          "args": [
            "fullName",
            "name",
            "templateContext",
            "structNode.getDiscriminantCount() != 0",
            "KJ_MAP(f, fieldTexts){ return kj::mv(f.builderMethodDecls); }"
          ],
          "line": 1959
        },
        "resolved": true,
        "details": {
          "function_name": "makeBuilderDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "1760-1792",
          "snippet": "kj::StringTree makeBuilderDef(kj::StringPtr fullName, kj::StringPtr unqualifiedParentType,\n                                const TemplateContext& templateContext, bool isUnion,\n                                kj::Array<kj::StringTree>&& methodDecls) {\n    return kj::strTree(\n        templateContext.allDecls(),\n        \"class \", fullName, \"::Builder {\\n\"\n        \"public:\\n\"\n        \"  typedef \", unqualifiedParentType, \" Builds;\\n\"\n        \"\\n\"\n        \"  Builder() = delete;  // Deleted to discourage incorrect usage.\\n\"\n        \"                       // You can explicitly initialize to nullptr instead.\\n\"\n        \"  inline Builder(decltype(nullptr)) {}\\n\"\n        \"  inline explicit Builder(::capnp::_::StructBuilder base): _builder(base) {}\\n\"\n        \"  inline operator Reader() const { return Reader(_builder.asReader()); }\\n\"\n        \"  inline Reader asReader() const { return *this; }\\n\"\n        \"\\n\"\n        \"  inline ::capnp::MessageSize totalSize() const { return asReader().totalSize(); }\\n\"\n        \"#if !CAPNP_LITE\\n\"\n        \"  inline ::kj::StringTree toString() const { return asReader().toString(); }\\n\"\n        \"#endif  // !CAPNP_LITE\\n\"\n        \"\\n\",\n        isUnion ? kj::strTree(\"  inline Which which();\\n\") : kj::strTree(),\n        kj::mv(methodDecls),\n        \"private:\\n\"\n        \"  ::capnp::_::StructBuilder _builder;\\n\"\n        \"  template <typename, ::capnp::Kind>\\n\"\n        \"  friend struct ::capnp::ToDynamic_;\\n\"\n        \"  friend class ::capnp::Orphanage;\\n\",\n        \"  template <typename, ::capnp::Kind>\\n\"\n        \"  friend struct ::capnp::_::PointerHelpers;\\n\"\n        \"};\\n\"\n        \"\\n\");\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::StringTree makeBuilderDef(kj::StringPtr fullName, kj::StringPtr unqualifiedParentType,\n                                const TemplateContext& templateContext, bool isUnion,\n                                kj::Array<kj::StringTree>&& methodDecls) {\n    return kj::strTree(\n        templateContext.allDecls(),\n        \"class \", fullName, \"::Builder {\\n\"\n        \"public:\\n\"\n        \"  typedef \", unqualifiedParentType, \" Builds;\\n\"\n        \"\\n\"\n        \"  Builder() = delete;  // Deleted to discourage incorrect usage.\\n\"\n        \"                       // You can explicitly initialize to nullptr instead.\\n\"\n        \"  inline Builder(decltype(nullptr)) {}\\n\"\n        \"  inline explicit Builder(::capnp::_::StructBuilder base): _builder(base) {}\\n\"\n        \"  inline operator Reader() const { return Reader(_builder.asReader()); }\\n\"\n        \"  inline Reader asReader() const { return *this; }\\n\"\n        \"\\n\"\n        \"  inline ::capnp::MessageSize totalSize() const { return asReader().totalSize(); }\\n\"\n        \"#if !CAPNP_LITE\\n\"\n        \"  inline ::kj::StringTree toString() const { return asReader().toString(); }\\n\"\n        \"#endif  // !CAPNP_LITE\\n\"\n        \"\\n\",\n        isUnion ? kj::strTree(\"  inline Which which();\\n\") : kj::strTree(),\n        kj::mv(methodDecls),\n        \"private:\\n\"\n        \"  ::capnp::_::StructBuilder _builder;\\n\"\n        \"  template <typename, ::capnp::Kind>\\n\"\n        \"  friend struct ::capnp::ToDynamic_;\\n\"\n        \"  friend class ::capnp::Orphanage;\\n\",\n        \"  template <typename, ::capnp::Kind>\\n\"\n        \"  friend struct ::capnp::_::PointerHelpers;\\n\"\n        \"};\\n\"\n        \"\\n\");\n  }"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "f.builderMethodDecls"
          ],
          "line": 1960
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "f",
            "fieldTexts"
          ],
          "line": 1960
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structNode.getDiscriminantCount",
          "args": [],
          "line": 1959
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "makeReaderDef",
          "args": [
            "fullName",
            "name",
            "templateContext",
            "structNode.getDiscriminantCount() != 0",
            "KJ_MAP(f, fieldTexts){ return kj::mv(f.readerMethodDecls); }"
          ],
          "line": 1957
        },
        "resolved": true,
        "details": {
          "function_name": "makeReaderDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "1722-1758",
          "snippet": "kj::StringTree makeReaderDef(kj::StringPtr fullName, kj::StringPtr unqualifiedParentType,\n                               const TemplateContext& templateContext, bool isUnion,\n                               kj::Array<kj::StringTree>&& methodDecls) {\n    return kj::strTree(\n        templateContext.allDecls(),\n        \"class \", fullName, \"::Reader {\\n\"\n        \"public:\\n\"\n        \"  typedef \", unqualifiedParentType, \" Reads;\\n\"\n        \"\\n\"\n        \"  Reader() = default;\\n\"\n        \"  inline explicit Reader(::capnp::_::StructReader base): _reader(base) {}\\n\"\n        \"\\n\"\n        \"  inline ::capnp::MessageSize totalSize() const {\\n\"\n        \"    return _reader.totalSize().asPublic();\\n\"\n        \"  }\\n\"\n        \"\\n\"\n        \"#if !CAPNP_LITE\\n\"\n        \"  inline ::kj::StringTree toString() const {\\n\"\n        \"    return ::capnp::_::structString(_reader, *_capnpPrivate::brand);\\n\"\n        \"  }\\n\"\n        \"#endif  // !CAPNP_LITE\\n\"\n        \"\\n\",\n        isUnion ? kj::strTree(\"  inline Which which() const;\\n\") : kj::strTree(),\n        kj::mv(methodDecls),\n        \"private:\\n\"\n        \"  ::capnp::_::StructReader _reader;\\n\"\n        \"  template <typename, ::capnp::Kind>\\n\"\n        \"  friend struct ::capnp::ToDynamic_;\\n\"\n        \"  template <typename, ::capnp::Kind>\\n\"\n        \"  friend struct ::capnp::_::PointerHelpers;\\n\"\n        \"  template <typename, ::capnp::Kind>\\n\"\n        \"  friend struct ::capnp::List;\\n\"\n        \"  friend class ::capnp::MessageBuilder;\\n\"\n        \"  friend class ::capnp::Orphanage;\\n\"\n        \"};\\n\"\n        \"\\n\");\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::StringTree makeReaderDef(kj::StringPtr fullName, kj::StringPtr unqualifiedParentType,\n                               const TemplateContext& templateContext, bool isUnion,\n                               kj::Array<kj::StringTree>&& methodDecls) {\n    return kj::strTree(\n        templateContext.allDecls(),\n        \"class \", fullName, \"::Reader {\\n\"\n        \"public:\\n\"\n        \"  typedef \", unqualifiedParentType, \" Reads;\\n\"\n        \"\\n\"\n        \"  Reader() = default;\\n\"\n        \"  inline explicit Reader(::capnp::_::StructReader base): _reader(base) {}\\n\"\n        \"\\n\"\n        \"  inline ::capnp::MessageSize totalSize() const {\\n\"\n        \"    return _reader.totalSize().asPublic();\\n\"\n        \"  }\\n\"\n        \"\\n\"\n        \"#if !CAPNP_LITE\\n\"\n        \"  inline ::kj::StringTree toString() const {\\n\"\n        \"    return ::capnp::_::structString(_reader, *_capnpPrivate::brand);\\n\"\n        \"  }\\n\"\n        \"#endif  // !CAPNP_LITE\\n\"\n        \"\\n\",\n        isUnion ? kj::strTree(\"  inline Which which() const;\\n\") : kj::strTree(),\n        kj::mv(methodDecls),\n        \"private:\\n\"\n        \"  ::capnp::_::StructReader _reader;\\n\"\n        \"  template <typename, ::capnp::Kind>\\n\"\n        \"  friend struct ::capnp::ToDynamic_;\\n\"\n        \"  template <typename, ::capnp::Kind>\\n\"\n        \"  friend struct ::capnp::_::PointerHelpers;\\n\"\n        \"  template <typename, ::capnp::Kind>\\n\"\n        \"  friend struct ::capnp::List;\\n\"\n        \"  friend class ::capnp::MessageBuilder;\\n\"\n        \"  friend class ::capnp::Orphanage;\\n\"\n        \"};\\n\"\n        \"\\n\");\n  }"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "f.readerMethodDecls"
          ],
          "line": 1958
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "f",
            "fieldTexts"
          ],
          "line": 1958
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structNode.getDiscriminantCount",
          "args": [],
          "line": 1957
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "templateContext.parentDecls()",
            "templateContext.decl(scope == nullptr)",
            "\"struct \"",
            "scope",
            "name",
            "\" {\\n\"",
            "\"  \"",
            "name",
            "\"() = delete;\\n\"\n          \"\\n\"\n          \"  class Reader;\\n\"\n          \"  class Builder;\\n\"\n          \"  class Pipeline;\\n\"",
            "structNode.getDiscriminantCount() == 0 ? kj::strTree() : kj::strTree(\n              \"  enum Which: uint16_t {\\n\",\n              KJ_MAP(f, structNode.getFields()) {\n                if (hasDiscriminantValue(f)) {\n                  return kj::strTree(\"    \", toUpperCase(protoName(f)), \",\\n\");\n                } else {\n                  return kj::strTree();\n                }\n              },\n              \"  };\\n\")",
            "KJ_MAP(n, nestedTypeDecls){ return kj::mv(n); }",
            "\"\\n\"",
            "kj::mv(declareText)",
            "\"\\n\"",
            "\"};\\n\"\n          \"\\n\""
          ],
          "line": 1931
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "declareText"
          ],
          "line": 1952
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "n"
          ],
          "line": 1950
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "n",
            "nestedTypeDecls"
          ],
          "line": 1950
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"  enum Which: uint16_t {\\n\"",
            "KJ_MAP(f, structNode.getFields()){\n                if (hasDiscriminantValue(f)) {\n                  return kj::strTree(\"    \", toUpperCase(protoName(f)), \",\\n\");\n                } else {\n                  return kj::strTree();\n                }\n              }",
            "\"  };\\n\""
          ],
          "line": 1940
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"    \"",
            "toUpperCase(protoName(f))",
            "\",\\n\""
          ],
          "line": 1944
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "toUpperCase",
          "args": [
            "protoName(f)"
          ],
          "line": 1944
        },
        "resolved": true,
        "details": {
          "function_name": "toUpperCase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "404-421",
          "snippet": "kj::String toUpperCase(kj::StringPtr name) {\n    kj::Vector<char> result(name.size() + 4);\n\n    for (char c: name) {\n      if ('a' <= c && c <= 'z') {\n        result.add(c - 'a' + 'A');\n      } else if (result.size() > 0 && 'A' <= c && c <= 'Z') {\n        result.add('_');\n        result.add(c);\n      } else {\n        result.add(c);\n      }\n    }\n\n    result.add('\\0');\n\n    return kj::String(result.releaseAsArray());\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::String toUpperCase(kj::StringPtr name) {\n    kj::Vector<char> result(name.size() + 4);\n\n    for (char c: name) {\n      if ('a' <= c && c <= 'z') {\n        result.add(c - 'a' + 'A');\n      } else if (result.size() > 0 && 'A' <= c && c <= 'Z') {\n        result.add('_');\n        result.add(c);\n      } else {\n        result.add(c);\n      }\n    }\n\n    result.add('\\0');\n\n    return kj::String(result.releaseAsArray());\n  }"
        }
      },
      {
        "call_info": {
          "callee": "protoName",
          "args": [
            "f"
          ],
          "line": 1944
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hasDiscriminantValue",
          "args": [
            "f"
          ],
          "line": 1943
        },
        "resolved": true,
        "details": {
          "function_name": "hasDiscriminantValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "63-65",
          "snippet": "bool hasDiscriminantValue(const schema::Field::Reader& reader) {\n  return reader.getDiscriminantValue() != schema::Field::NO_DISCRIMINANT;\n}",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nbool hasDiscriminantValue(const schema::Field::Reader& reader) {\n  return reader.getDiscriminantValue() != schema::Field::NO_DISCRIMINANT;\n}"
        }
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "f",
            "structNode.getFields()"
          ],
          "line": 1942
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structNode.getFields",
          "args": [],
          "line": 1942
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structNode.getDiscriminantCount",
          "args": [],
          "line": 1940
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.decl",
          "args": [
            "scope == nullptr"
          ],
          "line": 1933
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.parentDecls",
          "args": [],
          "line": 1932
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "templateContext.hasParams() ? \"  \" : \"\"",
            "templateContext.decl(true)",
            "\"  struct \"",
            "name",
            "\";\\n\""
          ],
          "line": 1927
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.decl",
          "args": [
            "true"
          ],
          "line": 1928
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.hasParams",
          "args": [],
          "line": 1928
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "whichName.addMemberType",
          "args": [
            "\"Which\""
          ],
          "line": 1923
        },
        "resolved": true,
        "details": {
          "function_name": "addMemberType",
          "container": "CppTypeName",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "206-211",
          "snippet": "void addMemberType(kj::StringPtr innerName) {\n    // Append \"::innerName\" to refer to a member.\n\n    name = kj::strTree(kj::mv(name), \"::\", innerName);\n    needsTypename = isArgDependent;\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName {\n  void addMemberType(kj::StringPtr innerName) {\n      // Append \"::innerName\" to refer to a member.\n  \n      name = kj::strTree(kj::mv(name), \"::\", innerName);\n      needsTypename = isArgDependent;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "cppFullName",
          "args": [
            "schema",
            "nullptr"
          ],
          "line": 1922
        },
        "resolved": true,
        "details": {
          "function_name": "cppFullName",
          "container": "CapnpcCppMain",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "316-318",
          "snippet": "CppTypeName cppFullName(Schema schema, kj::Maybe<InterfaceSchema::Method> method) {\n    return cppFullName(schema, schema, method);\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCapnpcCppMain {\n  CppTypeName cppFullName(Schema schema, kj::Maybe<InterfaceSchema::Method> method) {\n      return cppFullName(schema, schema, method);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "structNode.getDiscriminantCount",
          "args": [],
          "line": 1921
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "kj::mv(defineText)",
            "\"#endif  // !CAPNP_LITE\\n\\n\""
          ],
          "line": 1917
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "defineText"
          ],
          "line": 1917
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "kj::mv(declareText)",
            "\"  };\""
          ],
          "line": 1916
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "declareText"
          ],
          "line": 1916
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "kj::mv(declareText)",
            "\"    #if !CAPNP_LITE\\n\"\n          \"    static constexpr ::capnp::_::RawBrandedSchema const* brand = &schema->defaultBrand;\\n\"\n          \"    #endif  // !CAPNP_LITE\\n\""
          ],
          "line": 1910
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "declareText"
          ],
          "line": 1910
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "kj::mv(defineText)",
            "makeGenericDefinitions(templates, fullName, kj::str(hexId), kj::mv(brandInitializers))"
          ],
          "line": 1907
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "makeGenericDefinitions",
          "args": [
            "templates",
            "fullName",
            "kj::str(hexId)",
            "kj::mv(brandInitializers)"
          ],
          "line": 1908
        },
        "resolved": true,
        "details": {
          "function_name": "makeGenericDefinitions",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "1833-1858",
          "snippet": "kj::StringTree makeGenericDefinitions(\n      kj::StringPtr templates, kj::StringPtr fullName, kj::StringPtr hexId,\n      BrandInitializerText brandInitializers) {\n    // Returns the definitions for the members from makeGenericDeclarations().\n    bool hasBrandDependencies = (brandInitializers.dependencies.size() != 0);\n\n    return kj::strTree(\n        templates, \"const ::capnp::_::RawBrandedSchema::Scope \", fullName,\n        \"::_capnpPrivate::brandScopes[] = \", kj::mv(brandInitializers.scopes), \";\\n\",\n\n        templates, \"const ::capnp::_::RawBrandedSchema::Binding \", fullName,\n        \"::_capnpPrivate::brandBindings[] = \", kj::mv(brandInitializers.bindings), \";\\n\",\n\n        (!hasBrandDependencies ? kj::strTree(\"\") : kj::strTree(\n            templates, \"const ::capnp::_::RawBrandedSchema::Dependency \", fullName,\n            \"::_capnpPrivate::brandDependencies[] = \", kj::mv(brandInitializers.dependencies),\n            \";\\n\")),\n\n        templates, \"const ::capnp::_::RawBrandedSchema \", fullName, \"::_capnpPrivate::specificBrand = {\\n\",\n        \"  &::capnp::schemas::s_\", hexId, \", brandScopes, \",\n        (!hasBrandDependencies ? \"nullptr\" : \"brandDependencies\"), \",\\n\",\n        \"  sizeof(brandScopes) / sizeof(brandScopes[0]), \",\n        (!hasBrandDependencies ? \"0\" : \"sizeof(brandDependencies) / sizeof(brandDependencies[0])\"),\n        \", nullptr\\n\"\n        \"};\\n\");\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::StringTree makeGenericDefinitions(\n      kj::StringPtr templates, kj::StringPtr fullName, kj::StringPtr hexId,\n      BrandInitializerText brandInitializers) {\n    // Returns the definitions for the members from makeGenericDeclarations().\n    bool hasBrandDependencies = (brandInitializers.dependencies.size() != 0);\n\n    return kj::strTree(\n        templates, \"const ::capnp::_::RawBrandedSchema::Scope \", fullName,\n        \"::_capnpPrivate::brandScopes[] = \", kj::mv(brandInitializers.scopes), \";\\n\",\n\n        templates, \"const ::capnp::_::RawBrandedSchema::Binding \", fullName,\n        \"::_capnpPrivate::brandBindings[] = \", kj::mv(brandInitializers.bindings), \";\\n\",\n\n        (!hasBrandDependencies ? kj::strTree(\"\") : kj::strTree(\n            templates, \"const ::capnp::_::RawBrandedSchema::Dependency \", fullName,\n            \"::_capnpPrivate::brandDependencies[] = \", kj::mv(brandInitializers.dependencies),\n            \";\\n\")),\n\n        templates, \"const ::capnp::_::RawBrandedSchema \", fullName, \"::_capnpPrivate::specificBrand = {\\n\",\n        \"  &::capnp::schemas::s_\", hexId, \", brandScopes, \",\n        (!hasBrandDependencies ? \"nullptr\" : \"brandDependencies\"), \",\\n\",\n        \"  sizeof(brandScopes) / sizeof(brandScopes[0]), \",\n        (!hasBrandDependencies ? \"0\" : \"sizeof(brandDependencies) / sizeof(brandDependencies[0])\"),\n        \", nullptr\\n\"\n        \"};\\n\");\n  }"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "brandInitializers"
          ],
          "line": 1908
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "hexId"
          ],
          "line": 1908
        },
        "resolved": true,
        "details": {
          "function_name": "str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "341-341",
          "snippet": "inline String str(String&& s) { return mv(s); }",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\ninline String str(String&& s) { return mv(s); }"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "defineText"
          ],
          "line": 1907
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "kj::mv(declareText)",
            "\"    #if !CAPNP_LITE\\n\"",
            "makeGenericDeclarations(templateContext, hasDeps)",
            "\"    #endif  // !CAPNP_LITE\\n\""
          ],
          "line": 1902
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "makeGenericDeclarations",
          "args": [
            "templateContext",
            "hasDeps"
          ],
          "line": 1904
        },
        "resolved": true,
        "details": {
          "function_name": "makeGenericDeclarations",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "1819-1831",
          "snippet": "kj::StringTree makeGenericDeclarations(const TemplateContext& templateContext,\n                                         bool hasBrandDependencies) {\n    // Returns the declarations for the private members of a generic struct/interface;\n    // paired with the definitions from makeGenericDefinitions().\n    return kj::strTree(\n        \"    static const ::capnp::_::RawBrandedSchema::Scope brandScopes[];\\n\"\n        \"    static const ::capnp::_::RawBrandedSchema::Binding brandBindings[];\\n\",\n        (!hasBrandDependencies ? \"\" :\n            \"    static const ::capnp::_::RawBrandedSchema::Dependency brandDependencies[];\\n\"),\n        \"    static const ::capnp::_::RawBrandedSchema specificBrand;\\n\"\n        \"    static constexpr ::capnp::_::RawBrandedSchema const* brand = \"\n        \"::capnp::_::ChooseBrand<_capnpPrivate, \", templateContext.allArgs(), \">::brand;\\n\");\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::StringTree makeGenericDeclarations(const TemplateContext& templateContext,\n                                         bool hasBrandDependencies) {\n    // Returns the declarations for the private members of a generic struct/interface;\n    // paired with the definitions from makeGenericDefinitions().\n    return kj::strTree(\n        \"    static const ::capnp::_::RawBrandedSchema::Scope brandScopes[];\\n\"\n        \"    static const ::capnp::_::RawBrandedSchema::Binding brandBindings[];\\n\",\n        (!hasBrandDependencies ? \"\" :\n            \"    static const ::capnp::_::RawBrandedSchema::Dependency brandDependencies[];\\n\"),\n        \"    static const ::capnp::_::RawBrandedSchema specificBrand;\\n\"\n        \"    static constexpr ::capnp::_::RawBrandedSchema const* brand = \"\n        \"::capnp::_::ChooseBrand<_capnpPrivate, \", templateContext.allArgs(), \">::brand;\\n\");\n  }"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "declareText"
          ],
          "line": 1902
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "brandInitializers.dependencies.size",
          "args": [],
          "line": 1900
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-capnp.c++",
          "lines": "74-74",
          "snippet": "inline size_t size() const { return amount; }",
          "includes": [
            "#include \"config.h\"",
            "#include <map>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <map>\n#include <algorithm>\n#include <kj/main.h>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nIndent {\n  inline size_t size() const { return amount; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "makeBrandInitializers",
          "args": [
            "templateContext",
            "schema"
          ],
          "line": 1899
        },
        "resolved": true,
        "details": {
          "function_name": "makeBrandInitializers",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "672-697",
          "snippet": "BrandInitializerText makeBrandInitializers(\n      const TemplateContext& templateContext, Schema schema) {\n    auto scopeMap = templateContext.getScopeMap();\n\n    auto scopes = kj::heapArrayBuilder<kj::StringTree>(scopeMap.size());\n    kj::Vector<kj::StringTree> bindings(scopeMap.size() * 2);  // (estimate two params per scope)\n\n    for (auto& scope: scopeMap) {\n      scopes.add(kj::strTree(\"  { \",\n        \"0x\", kj::hex(scope.first), \", \"\n        \"brandBindings + \", bindings.size(), \", \",\n        scope.second.size(), \", \"\n        \"false\"\n      \"},\\n\"));\n\n      for (auto param: scope.second) {\n        bindings.add(kj::strTree(\"  ::capnp::_::brandBindingFor<\", param.getName(), \">(),\\n\"));\n      }\n    }\n\n    return {\n      kj::strTree(\"{\\n\", scopes.finish(), \"}\"),\n      kj::strTree(\"{\\n\", bindings.releaseAsArray(), \"}\"),\n      makeBrandDepInitializers(templateContext, schema)\n    };\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nBrandInitializerText makeBrandInitializers(\n      const TemplateContext& templateContext, Schema schema) {\n    auto scopeMap = templateContext.getScopeMap();\n\n    auto scopes = kj::heapArrayBuilder<kj::StringTree>(scopeMap.size());\n    kj::Vector<kj::StringTree> bindings(scopeMap.size() * 2);  // (estimate two params per scope)\n\n    for (auto& scope: scopeMap) {\n      scopes.add(kj::strTree(\"  { \",\n        \"0x\", kj::hex(scope.first), \", \"\n        \"brandBindings + \", bindings.size(), \", \",\n        scope.second.size(), \", \"\n        \"false\"\n      \"},\\n\"));\n\n      for (auto param: scope.second) {\n        bindings.add(kj::strTree(\"  ::capnp::_::brandBindingFor<\", param.getName(), \">(),\\n\"));\n      }\n    }\n\n    return {\n      kj::strTree(\"{\\n\", scopes.finish(), \"}\"),\n      kj::strTree(\"{\\n\", bindings.releaseAsArray(), \"}\"),\n      makeBrandDepInitializers(templateContext, schema)\n    };\n  }"
        }
      },
      {
        "call_info": {
          "callee": "templateContext.isGeneric",
          "args": [],
          "line": 1898
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"// \"",
            "fullName",
            "\"\\n\"\n        // TODO(msvc): MSVC doen't expect constexprs to have definitions. Remove #if once\n        //   MSVC catches up on constexpr.\n        \"#ifndef _MSC_VER\\n\"",
            "templates",
            "\"constexpr uint16_t \"",
            "fullName",
            "\"::_capnpPrivate::dataWordSize;\\n\"",
            "templates",
            "\"constexpr uint16_t \"",
            "fullName",
            "\"::_capnpPrivate::pointerCount;\\n\"\n        \"#endif\\n\"",
            "\"#if !CAPNP_LITE\\n\"",
            "templates",
            "\"constexpr ::capnp::Kind \"",
            "fullName",
            "\"::_capnpPrivate::kind;\\n\"",
            "templates",
            "\"constexpr ::capnp::_::RawSchema const* \"",
            "fullName",
            "\"::_capnpPrivate::schema;\\n\"",
            "templates",
            "\"constexpr ::capnp::_::RawBrandedSchema const* \"",
            "fullName",
            "\"::_capnpPrivate::brand;\\n\""
          ],
          "line": 1885
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"  struct _capnpPrivate {\\n\"\n         \"    CAPNP_DECLARE_STRUCT_HEADER(\"",
            "hexId",
            "\", \"",
            "structNode.getDataWordCount()",
            "\", \"",
            "structNode.getPointerCount()",
            "\")\\n\""
          ],
          "line": 1880
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structNode.getPointerCount",
          "args": [],
          "line": 1883
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structNode.getDataWordCount",
          "args": [],
          "line": 1882
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1877
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::hex",
          "args": [
            "proto.getId()"
          ],
          "line": 1875
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.getId",
          "args": [],
          "line": 1875
        },
        "resolved": true,
        "details": {
          "function_name": "getId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
          "lines": "75-75",
          "snippet": "uint64_t getId() { return id; }",
          "includes": [
            "#include \"md5.h\"",
            "#include \"node-translator.h\"",
            "#include <unordered_map>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/message.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/arena.h>",
            "#include <kj/mutex.h>",
            "#include \"parser.h\"      // only for generateChildId()",
            "#include \"compiler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nuint64_t getId() { return id; }"
        }
      },
      {
        "call_info": {
          "callee": "structNode.getDiscriminantOffset",
          "args": [],
          "line": 1874
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.getStruct",
          "args": [],
          "line": 1873
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "makeFieldText",
          "args": [
            "subScope",
            "f",
            "templateContext"
          ],
          "line": 1870
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "f",
            "schema.getFields()"
          ],
          "line": 1869
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFields",
          "args": [],
          "line": 1869
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "fullName",
            "\"::\""
          ],
          "line": 1868
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "scope",
            "name",
            "templateContext.args()"
          ],
          "line": 1867
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.args",
          "args": [],
          "line": 1867
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "annotatedName->getText",
          "args": [],
          "line": 1865
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getProto",
          "args": [],
          "line": 1863
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nStructText makeStructText(kj::StringPtr scope, kj::StringPtr name, StructSchema schema,\n                            kj::Array<kj::StringTree> nestedTypeDecls,\n                            const TemplateContext& templateContext) {\n    auto proto = schema.getProto();\n    KJ_IF_MAYBE(annotatedName, annotationValue(proto, NAME_ANNOTATION_ID)) {\n      name = annotatedName->getText();\n    }\n    auto fullName = kj::str(scope, name, templateContext.args());\n    auto subScope = kj::str(fullName, \"::\");\n    auto fieldTexts = KJ_MAP(f, schema.getFields()) {\n      return makeFieldText(subScope, f, templateContext);\n    };\n\n    auto structNode = proto.getStruct();\n    uint discrimOffset = structNode.getDiscriminantOffset();\n    auto hexId = kj::hex(proto.getId());\n\n    kj::String templates = kj::str(templateContext.allDecls());  // Ends with a newline\n\n    // Private members struct\n    kj::StringTree declareText = kj::strTree(\n         \"  struct _capnpPrivate {\\n\"\n         \"    CAPNP_DECLARE_STRUCT_HEADER(\", hexId, \", \", structNode.getDataWordCount(), \", \",\n         structNode.getPointerCount(), \")\\n\");\n\n    kj::StringTree defineText = kj::strTree(\n        \"// \", fullName, \"\\n\"\n        // TODO(msvc): MSVC doen't expect constexprs to have definitions. Remove #if once\n        //   MSVC catches up on constexpr.\n        \"#ifndef _MSC_VER\\n\",\n        templates, \"constexpr uint16_t \", fullName, \"::_capnpPrivate::dataWordSize;\\n\",\n        templates, \"constexpr uint16_t \", fullName, \"::_capnpPrivate::pointerCount;\\n\"\n        \"#endif\\n\",\n        \"#if !CAPNP_LITE\\n\",\n        templates, \"constexpr ::capnp::Kind \", fullName, \"::_capnpPrivate::kind;\\n\",\n        templates, \"constexpr ::capnp::_::RawSchema const* \", fullName, \"::_capnpPrivate::schema;\\n\",\n        templates, \"constexpr ::capnp::_::RawBrandedSchema const* \", fullName, \"::_capnpPrivate::brand;\\n\");\n\n    if (templateContext.isGeneric()) {\n      auto brandInitializers = makeBrandInitializers(templateContext, schema);\n      bool hasDeps = (brandInitializers.dependencies.size() != 0);\n\n      declareText = kj::strTree(kj::mv(declareText),\n          \"    #if !CAPNP_LITE\\n\",\n          makeGenericDeclarations(templateContext, hasDeps),\n          \"    #endif  // !CAPNP_LITE\\n\");\n\n      defineText = kj::strTree(kj::mv(defineText),\n          makeGenericDefinitions(templates, fullName, kj::str(hexId), kj::mv(brandInitializers)));\n    } else {\n      declareText = kj::strTree(kj::mv(declareText),\n          \"    #if !CAPNP_LITE\\n\"\n          \"    static constexpr ::capnp::_::RawBrandedSchema const* brand = &schema->defaultBrand;\\n\"\n          \"    #endif  // !CAPNP_LITE\\n\");\n    }\n\n    declareText = kj::strTree(kj::mv(declareText), \"  };\");\n    defineText = kj::strTree(kj::mv(defineText), \"#endif  // !CAPNP_LITE\\n\\n\");\n\n    // Name of the ::Which type, when applicable.\n    CppTypeName whichName;\n    if (structNode.getDiscriminantCount() != 0) {\n      whichName = cppFullName(schema, nullptr);\n      whichName.addMemberType(\"Which\");\n    }\n\n    return StructText {\n      kj::strTree(\n          templateContext.hasParams() ? \"  \" : \"\", templateContext.decl(true),\n          \"  struct \", name, \";\\n\"),\n\n      kj::strTree(\n          templateContext.parentDecls(),\n          templateContext.decl(scope == nullptr),\n          \"struct \", scope, name, \" {\\n\",\n          \"  \", name, \"() = delete;\\n\"\n          \"\\n\"\n          \"  class Reader;\\n\"\n          \"  class Builder;\\n\"\n          \"  class Pipeline;\\n\",\n          structNode.getDiscriminantCount() == 0 ? kj::strTree() : kj::strTree(\n              \"  enum Which: uint16_t {\\n\",\n              KJ_MAP(f, structNode.getFields()) {\n                if (hasDiscriminantValue(f)) {\n                  return kj::strTree(\"    \", toUpperCase(protoName(f)), \",\\n\");\n                } else {\n                  return kj::strTree();\n                }\n              },\n              \"  };\\n\"),\n          KJ_MAP(n, nestedTypeDecls) { return kj::mv(n); },\n          \"\\n\",\n          kj::mv(declareText), \"\\n\",\n          \"};\\n\"\n          \"\\n\"),\n\n      kj::strTree(\n          makeReaderDef(fullName, name, templateContext, structNode.getDiscriminantCount() != 0,\n                        KJ_MAP(f, fieldTexts) { return kj::mv(f.readerMethodDecls); }),\n          makeBuilderDef(fullName, name, templateContext, structNode.getDiscriminantCount() != 0,\n                         KJ_MAP(f, fieldTexts) { return kj::mv(f.builderMethodDecls); }),\n          makePipelineDef(fullName, name, templateContext, structNode.getDiscriminantCount() != 0,\n                          KJ_MAP(f, fieldTexts) { return kj::mv(f.pipelineMethodDecls); })),\n\n      kj::strTree(\n          structNode.getDiscriminantCount() == 0 ? kj::strTree() : kj::strTree(\n              templateContext.allDecls(),\n              \"inline \", whichName, \" \", fullName, \"::Reader::which() const {\\n\"\n              \"  return _reader.getDataField<Which>(\", discrimOffset, \" * ::capnp::ELEMENTS);\\n\"\n              \"}\\n\",\n              templateContext.allDecls(),\n              \"inline \", whichName, \" \", fullName, \"::Builder::which() {\\n\"\n              \"  return _builder.getDataField<Which>(\", discrimOffset, \" * ::capnp::ELEMENTS);\\n\"\n              \"}\\n\"\n              \"\\n\"),\n          KJ_MAP(f, fieldTexts) { return kj::mv(f.inlineMethodDefs); }),\n\n      kj::mv(defineText)\n    };\n  }"
  },
  {
    "function_name": "makeGenericDefinitions",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "1833-1858",
    "snippet": "kj::StringTree makeGenericDefinitions(\n      kj::StringPtr templates, kj::StringPtr fullName, kj::StringPtr hexId,\n      BrandInitializerText brandInitializers) {\n    // Returns the definitions for the members from makeGenericDeclarations().\n    bool hasBrandDependencies = (brandInitializers.dependencies.size() != 0);\n\n    return kj::strTree(\n        templates, \"const ::capnp::_::RawBrandedSchema::Scope \", fullName,\n        \"::_capnpPrivate::brandScopes[] = \", kj::mv(brandInitializers.scopes), \";\\n\",\n\n        templates, \"const ::capnp::_::RawBrandedSchema::Binding \", fullName,\n        \"::_capnpPrivate::brandBindings[] = \", kj::mv(brandInitializers.bindings), \";\\n\",\n\n        (!hasBrandDependencies ? kj::strTree(\"\") : kj::strTree(\n            templates, \"const ::capnp::_::RawBrandedSchema::Dependency \", fullName,\n            \"::_capnpPrivate::brandDependencies[] = \", kj::mv(brandInitializers.dependencies),\n            \";\\n\")),\n\n        templates, \"const ::capnp::_::RawBrandedSchema \", fullName, \"::_capnpPrivate::specificBrand = {\\n\",\n        \"  &::capnp::schemas::s_\", hexId, \", brandScopes, \",\n        (!hasBrandDependencies ? \"nullptr\" : \"brandDependencies\"), \",\\n\",\n        \"  sizeof(brandScopes) / sizeof(brandScopes[0]), \",\n        (!hasBrandDependencies ? \"0\" : \"sizeof(brandDependencies) / sizeof(brandDependencies[0])\"),\n        \", nullptr\\n\"\n        \"};\\n\");\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "templates",
            "\"const ::capnp::_::RawBrandedSchema::Scope \"",
            "fullName",
            "\"::_capnpPrivate::brandScopes[] = \"",
            "kj::mv(brandInitializers.scopes)",
            "\";\\n\"",
            "templates",
            "\"const ::capnp::_::RawBrandedSchema::Binding \"",
            "fullName",
            "\"::_capnpPrivate::brandBindings[] = \"",
            "kj::mv(brandInitializers.bindings)",
            "\";\\n\"",
            "(!hasBrandDependencies ? kj::strTree(\"\") : kj::strTree(\n            templates, \"const ::capnp::_::RawBrandedSchema::Dependency \", fullName,\n            \"::_capnpPrivate::brandDependencies[] = \", kj::mv(brandInitializers.dependencies),\n            \";\\n\"))",
            "templates",
            "\"const ::capnp::_::RawBrandedSchema \"",
            "fullName",
            "\"::_capnpPrivate::specificBrand = {\\n\"",
            "\"  &::capnp::schemas::s_\"",
            "hexId",
            "\", brandScopes, \"",
            "(!hasBrandDependencies ? \"nullptr\" : \"brandDependencies\")",
            "\",\\n\"",
            "\"  sizeof(brandScopes) / sizeof(brandScopes[0]), \"",
            "(!hasBrandDependencies ? \"0\" : \"sizeof(brandDependencies) / sizeof(brandDependencies[0])\")",
            "\", nullptr\\n\"\n        \"};\\n\""
          ],
          "line": 1839
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "templates",
            "\"const ::capnp::_::RawBrandedSchema::Dependency \"",
            "fullName",
            "\"::_capnpPrivate::brandDependencies[] = \"",
            "kj::mv(brandInitializers.dependencies)",
            "\";\\n\""
          ],
          "line": 1846
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "brandInitializers.dependencies"
          ],
          "line": 1848
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"\""
          ],
          "line": 1846
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "brandInitializers.bindings"
          ],
          "line": 1844
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "brandInitializers.scopes"
          ],
          "line": 1841
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "brandInitializers.dependencies.size",
          "args": [],
          "line": 1837
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-capnp.c++",
          "lines": "74-74",
          "snippet": "inline size_t size() const { return amount; }",
          "includes": [
            "#include \"config.h\"",
            "#include <map>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <map>\n#include <algorithm>\n#include <kj/main.h>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nIndent {\n  inline size_t size() const { return amount; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::StringTree makeGenericDefinitions(\n      kj::StringPtr templates, kj::StringPtr fullName, kj::StringPtr hexId,\n      BrandInitializerText brandInitializers) {\n    // Returns the definitions for the members from makeGenericDeclarations().\n    bool hasBrandDependencies = (brandInitializers.dependencies.size() != 0);\n\n    return kj::strTree(\n        templates, \"const ::capnp::_::RawBrandedSchema::Scope \", fullName,\n        \"::_capnpPrivate::brandScopes[] = \", kj::mv(brandInitializers.scopes), \";\\n\",\n\n        templates, \"const ::capnp::_::RawBrandedSchema::Binding \", fullName,\n        \"::_capnpPrivate::brandBindings[] = \", kj::mv(brandInitializers.bindings), \";\\n\",\n\n        (!hasBrandDependencies ? kj::strTree(\"\") : kj::strTree(\n            templates, \"const ::capnp::_::RawBrandedSchema::Dependency \", fullName,\n            \"::_capnpPrivate::brandDependencies[] = \", kj::mv(brandInitializers.dependencies),\n            \";\\n\")),\n\n        templates, \"const ::capnp::_::RawBrandedSchema \", fullName, \"::_capnpPrivate::specificBrand = {\\n\",\n        \"  &::capnp::schemas::s_\", hexId, \", brandScopes, \",\n        (!hasBrandDependencies ? \"nullptr\" : \"brandDependencies\"), \",\\n\",\n        \"  sizeof(brandScopes) / sizeof(brandScopes[0]), \",\n        (!hasBrandDependencies ? \"0\" : \"sizeof(brandDependencies) / sizeof(brandDependencies[0])\"),\n        \", nullptr\\n\"\n        \"};\\n\");\n  }"
  },
  {
    "function_name": "makeGenericDeclarations",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "1819-1831",
    "snippet": "kj::StringTree makeGenericDeclarations(const TemplateContext& templateContext,\n                                         bool hasBrandDependencies) {\n    // Returns the declarations for the private members of a generic struct/interface;\n    // paired with the definitions from makeGenericDefinitions().\n    return kj::strTree(\n        \"    static const ::capnp::_::RawBrandedSchema::Scope brandScopes[];\\n\"\n        \"    static const ::capnp::_::RawBrandedSchema::Binding brandBindings[];\\n\",\n        (!hasBrandDependencies ? \"\" :\n            \"    static const ::capnp::_::RawBrandedSchema::Dependency brandDependencies[];\\n\"),\n        \"    static const ::capnp::_::RawBrandedSchema specificBrand;\\n\"\n        \"    static constexpr ::capnp::_::RawBrandedSchema const* brand = \"\n        \"::capnp::_::ChooseBrand<_capnpPrivate, \", templateContext.allArgs(), \">::brand;\\n\");\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"    static const ::capnp::_::RawBrandedSchema::Scope brandScopes[];\\n\"\n        \"    static const ::capnp::_::RawBrandedSchema::Binding brandBindings[];\\n\"",
            "(!hasBrandDependencies ? \"\" :\n            \"    static const ::capnp::_::RawBrandedSchema::Dependency brandDependencies[];\\n\")",
            "\"    static const ::capnp::_::RawBrandedSchema specificBrand;\\n\"\n        \"    static constexpr ::capnp::_::RawBrandedSchema const* brand = \"\n        \"::capnp::_::ChooseBrand<_capnpPrivate, \"",
            "templateContext.allArgs()",
            "\">::brand;\\n\""
          ],
          "line": 1823
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allArgs",
          "args": [],
          "line": 1830
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::StringTree makeGenericDeclarations(const TemplateContext& templateContext,\n                                         bool hasBrandDependencies) {\n    // Returns the declarations for the private members of a generic struct/interface;\n    // paired with the definitions from makeGenericDefinitions().\n    return kj::strTree(\n        \"    static const ::capnp::_::RawBrandedSchema::Scope brandScopes[];\\n\"\n        \"    static const ::capnp::_::RawBrandedSchema::Binding brandBindings[];\\n\",\n        (!hasBrandDependencies ? \"\" :\n            \"    static const ::capnp::_::RawBrandedSchema::Dependency brandDependencies[];\\n\"),\n        \"    static const ::capnp::_::RawBrandedSchema specificBrand;\\n\"\n        \"    static constexpr ::capnp::_::RawBrandedSchema const* brand = \"\n        \"::capnp::_::ChooseBrand<_capnpPrivate, \", templateContext.allArgs(), \">::brand;\\n\");\n  }"
  },
  {
    "function_name": "makePipelineDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "1794-1817",
    "snippet": "kj::StringTree makePipelineDef(kj::StringPtr fullName, kj::StringPtr unqualifiedParentType,\n                                 const TemplateContext& templateContext, bool isUnion,\n                                 kj::Array<kj::StringTree>&& methodDecls) {\n    return kj::strTree(\n        \"#if !CAPNP_LITE\\n\",\n        templateContext.allDecls(),\n        \"class \", fullName, \"::Pipeline {\\n\"\n        \"public:\\n\"\n        \"  typedef \", unqualifiedParentType, \" Pipelines;\\n\"\n        \"\\n\"\n        \"  inline Pipeline(decltype(nullptr)): _typeless(nullptr) {}\\n\"\n        \"  inline explicit Pipeline(::capnp::AnyPointer::Pipeline&& typeless)\\n\"\n        \"      : _typeless(kj::mv(typeless)) {}\\n\"\n        \"\\n\",\n        kj::mv(methodDecls),\n        \"private:\\n\"\n        \"  ::capnp::AnyPointer::Pipeline _typeless;\\n\"\n        \"  friend class ::capnp::PipelineHook;\\n\"\n        \"  template <typename, ::capnp::Kind>\\n\"\n        \"  friend struct ::capnp::ToDynamic_;\\n\"\n        \"};\\n\"\n        \"#endif  // !CAPNP_LITE\\n\"\n        \"\\n\");\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"#if !CAPNP_LITE\\n\"",
            "templateContext.allDecls()",
            "\"class \"",
            "fullName",
            "\"::Pipeline {\\n\"\n        \"public:\\n\"\n        \"  typedef \"",
            "unqualifiedParentType",
            "\" Pipelines;\\n\"\n        \"\\n\"\n        \"  inline Pipeline(decltype(nullptr)): _typeless(nullptr) {}\\n\"\n        \"  inline explicit Pipeline(::capnp::AnyPointer::Pipeline&& typeless)\\n\"\n        \"      : _typeless(kj::mv(typeless)) {}\\n\"\n        \"\\n\"",
            "kj::mv(methodDecls)",
            "\"private:\\n\"\n        \"  ::capnp::AnyPointer::Pipeline _typeless;\\n\"\n        \"  friend class ::capnp::PipelineHook;\\n\"\n        \"  template <typename, ::capnp::Kind>\\n\"\n        \"  friend struct ::capnp::ToDynamic_;\\n\"\n        \"};\\n\"\n        \"#endif  // !CAPNP_LITE\\n\"\n        \"\\n\""
          ],
          "line": 1797
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "methodDecls"
          ],
          "line": 1808
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1799
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::StringTree makePipelineDef(kj::StringPtr fullName, kj::StringPtr unqualifiedParentType,\n                                 const TemplateContext& templateContext, bool isUnion,\n                                 kj::Array<kj::StringTree>&& methodDecls) {\n    return kj::strTree(\n        \"#if !CAPNP_LITE\\n\",\n        templateContext.allDecls(),\n        \"class \", fullName, \"::Pipeline {\\n\"\n        \"public:\\n\"\n        \"  typedef \", unqualifiedParentType, \" Pipelines;\\n\"\n        \"\\n\"\n        \"  inline Pipeline(decltype(nullptr)): _typeless(nullptr) {}\\n\"\n        \"  inline explicit Pipeline(::capnp::AnyPointer::Pipeline&& typeless)\\n\"\n        \"      : _typeless(kj::mv(typeless)) {}\\n\"\n        \"\\n\",\n        kj::mv(methodDecls),\n        \"private:\\n\"\n        \"  ::capnp::AnyPointer::Pipeline _typeless;\\n\"\n        \"  friend class ::capnp::PipelineHook;\\n\"\n        \"  template <typename, ::capnp::Kind>\\n\"\n        \"  friend struct ::capnp::ToDynamic_;\\n\"\n        \"};\\n\"\n        \"#endif  // !CAPNP_LITE\\n\"\n        \"\\n\");\n  }"
  },
  {
    "function_name": "makeBuilderDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "1760-1792",
    "snippet": "kj::StringTree makeBuilderDef(kj::StringPtr fullName, kj::StringPtr unqualifiedParentType,\n                                const TemplateContext& templateContext, bool isUnion,\n                                kj::Array<kj::StringTree>&& methodDecls) {\n    return kj::strTree(\n        templateContext.allDecls(),\n        \"class \", fullName, \"::Builder {\\n\"\n        \"public:\\n\"\n        \"  typedef \", unqualifiedParentType, \" Builds;\\n\"\n        \"\\n\"\n        \"  Builder() = delete;  // Deleted to discourage incorrect usage.\\n\"\n        \"                       // You can explicitly initialize to nullptr instead.\\n\"\n        \"  inline Builder(decltype(nullptr)) {}\\n\"\n        \"  inline explicit Builder(::capnp::_::StructBuilder base): _builder(base) {}\\n\"\n        \"  inline operator Reader() const { return Reader(_builder.asReader()); }\\n\"\n        \"  inline Reader asReader() const { return *this; }\\n\"\n        \"\\n\"\n        \"  inline ::capnp::MessageSize totalSize() const { return asReader().totalSize(); }\\n\"\n        \"#if !CAPNP_LITE\\n\"\n        \"  inline ::kj::StringTree toString() const { return asReader().toString(); }\\n\"\n        \"#endif  // !CAPNP_LITE\\n\"\n        \"\\n\",\n        isUnion ? kj::strTree(\"  inline Which which();\\n\") : kj::strTree(),\n        kj::mv(methodDecls),\n        \"private:\\n\"\n        \"  ::capnp::_::StructBuilder _builder;\\n\"\n        \"  template <typename, ::capnp::Kind>\\n\"\n        \"  friend struct ::capnp::ToDynamic_;\\n\"\n        \"  friend class ::capnp::Orphanage;\\n\",\n        \"  template <typename, ::capnp::Kind>\\n\"\n        \"  friend struct ::capnp::_::PointerHelpers;\\n\"\n        \"};\\n\"\n        \"\\n\");\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "templateContext.allDecls()",
            "\"class \"",
            "fullName",
            "\"::Builder {\\n\"\n        \"public:\\n\"\n        \"  typedef \"",
            "unqualifiedParentType",
            "\" Builds;\\n\"\n        \"\\n\"\n        \"  Builder() = delete;  // Deleted to discourage incorrect usage.\\n\"\n        \"                       // You can explicitly initialize to nullptr instead.\\n\"\n        \"  inline Builder(decltype(nullptr)) {}\\n\"\n        \"  inline explicit Builder(::capnp::_::StructBuilder base): _builder(base) {}\\n\"\n        \"  inline operator Reader() const { return Reader(_builder.asReader()); }\\n\"\n        \"  inline Reader asReader() const { return *this; }\\n\"\n        \"\\n\"\n        \"  inline ::capnp::MessageSize totalSize() const { return asReader().totalSize(); }\\n\"\n        \"#if !CAPNP_LITE\\n\"\n        \"  inline ::kj::StringTree toString() const { return asReader().toString(); }\\n\"\n        \"#endif  // !CAPNP_LITE\\n\"\n        \"\\n\"",
            "isUnion ? kj::strTree(\"  inline Which which();\\n\") : kj::strTree()",
            "kj::mv(methodDecls)",
            "\"private:\\n\"\n        \"  ::capnp::_::StructBuilder _builder;\\n\"\n        \"  template <typename, ::capnp::Kind>\\n\"\n        \"  friend struct ::capnp::ToDynamic_;\\n\"\n        \"  friend class ::capnp::Orphanage;\\n\"",
            "\"  template <typename, ::capnp::Kind>\\n\"\n        \"  friend struct ::capnp::_::PointerHelpers;\\n\"\n        \"};\\n\"\n        \"\\n\""
          ],
          "line": 1763
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "methodDecls"
          ],
          "line": 1782
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [],
          "line": 1781
        },
        "resolved": true,
        "details": {
          "function_name": "strTree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
          "lines": "206-208",
          "snippet": "StringTree strTree(Params&&... params) {\n  return StringTree::concat(_::toStringTreeOrCharSequence(kj::fwd<Params>(params))...);\n}",
          "includes": [
            "#include \"string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"string.h\"\n\nStringTree strTree(Params&&... params) {\n  return StringTree::concat(_::toStringTreeOrCharSequence(kj::fwd<Params>(params))...);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"  inline Which which();\\n\""
          ],
          "line": 1781
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1764
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::StringTree makeBuilderDef(kj::StringPtr fullName, kj::StringPtr unqualifiedParentType,\n                                const TemplateContext& templateContext, bool isUnion,\n                                kj::Array<kj::StringTree>&& methodDecls) {\n    return kj::strTree(\n        templateContext.allDecls(),\n        \"class \", fullName, \"::Builder {\\n\"\n        \"public:\\n\"\n        \"  typedef \", unqualifiedParentType, \" Builds;\\n\"\n        \"\\n\"\n        \"  Builder() = delete;  // Deleted to discourage incorrect usage.\\n\"\n        \"                       // You can explicitly initialize to nullptr instead.\\n\"\n        \"  inline Builder(decltype(nullptr)) {}\\n\"\n        \"  inline explicit Builder(::capnp::_::StructBuilder base): _builder(base) {}\\n\"\n        \"  inline operator Reader() const { return Reader(_builder.asReader()); }\\n\"\n        \"  inline Reader asReader() const { return *this; }\\n\"\n        \"\\n\"\n        \"  inline ::capnp::MessageSize totalSize() const { return asReader().totalSize(); }\\n\"\n        \"#if !CAPNP_LITE\\n\"\n        \"  inline ::kj::StringTree toString() const { return asReader().toString(); }\\n\"\n        \"#endif  // !CAPNP_LITE\\n\"\n        \"\\n\",\n        isUnion ? kj::strTree(\"  inline Which which();\\n\") : kj::strTree(),\n        kj::mv(methodDecls),\n        \"private:\\n\"\n        \"  ::capnp::_::StructBuilder _builder;\\n\"\n        \"  template <typename, ::capnp::Kind>\\n\"\n        \"  friend struct ::capnp::ToDynamic_;\\n\"\n        \"  friend class ::capnp::Orphanage;\\n\",\n        \"  template <typename, ::capnp::Kind>\\n\"\n        \"  friend struct ::capnp::_::PointerHelpers;\\n\"\n        \"};\\n\"\n        \"\\n\");\n  }"
  },
  {
    "function_name": "makeReaderDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "1722-1758",
    "snippet": "kj::StringTree makeReaderDef(kj::StringPtr fullName, kj::StringPtr unqualifiedParentType,\n                               const TemplateContext& templateContext, bool isUnion,\n                               kj::Array<kj::StringTree>&& methodDecls) {\n    return kj::strTree(\n        templateContext.allDecls(),\n        \"class \", fullName, \"::Reader {\\n\"\n        \"public:\\n\"\n        \"  typedef \", unqualifiedParentType, \" Reads;\\n\"\n        \"\\n\"\n        \"  Reader() = default;\\n\"\n        \"  inline explicit Reader(::capnp::_::StructReader base): _reader(base) {}\\n\"\n        \"\\n\"\n        \"  inline ::capnp::MessageSize totalSize() const {\\n\"\n        \"    return _reader.totalSize().asPublic();\\n\"\n        \"  }\\n\"\n        \"\\n\"\n        \"#if !CAPNP_LITE\\n\"\n        \"  inline ::kj::StringTree toString() const {\\n\"\n        \"    return ::capnp::_::structString(_reader, *_capnpPrivate::brand);\\n\"\n        \"  }\\n\"\n        \"#endif  // !CAPNP_LITE\\n\"\n        \"\\n\",\n        isUnion ? kj::strTree(\"  inline Which which() const;\\n\") : kj::strTree(),\n        kj::mv(methodDecls),\n        \"private:\\n\"\n        \"  ::capnp::_::StructReader _reader;\\n\"\n        \"  template <typename, ::capnp::Kind>\\n\"\n        \"  friend struct ::capnp::ToDynamic_;\\n\"\n        \"  template <typename, ::capnp::Kind>\\n\"\n        \"  friend struct ::capnp::_::PointerHelpers;\\n\"\n        \"  template <typename, ::capnp::Kind>\\n\"\n        \"  friend struct ::capnp::List;\\n\"\n        \"  friend class ::capnp::MessageBuilder;\\n\"\n        \"  friend class ::capnp::Orphanage;\\n\"\n        \"};\\n\"\n        \"\\n\");\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "templateContext.allDecls()",
            "\"class \"",
            "fullName",
            "\"::Reader {\\n\"\n        \"public:\\n\"\n        \"  typedef \"",
            "unqualifiedParentType",
            "\" Reads;\\n\"\n        \"\\n\"\n        \"  Reader() = default;\\n\"\n        \"  inline explicit Reader(::capnp::_::StructReader base): _reader(base) {}\\n\"\n        \"\\n\"\n        \"  inline ::capnp::MessageSize totalSize() const {\\n\"\n        \"    return _reader.totalSize().asPublic();\\n\"\n        \"  }\\n\"\n        \"\\n\"\n        \"#if !CAPNP_LITE\\n\"\n        \"  inline ::kj::StringTree toString() const {\\n\"\n        \"    return ::capnp::_::structString(_reader, *_capnpPrivate::brand);\\n\"\n        \"  }\\n\"\n        \"#endif  // !CAPNP_LITE\\n\"\n        \"\\n\"",
            "isUnion ? kj::strTree(\"  inline Which which() const;\\n\") : kj::strTree()",
            "kj::mv(methodDecls)",
            "\"private:\\n\"\n        \"  ::capnp::_::StructReader _reader;\\n\"\n        \"  template <typename, ::capnp::Kind>\\n\"\n        \"  friend struct ::capnp::ToDynamic_;\\n\"\n        \"  template <typename, ::capnp::Kind>\\n\"\n        \"  friend struct ::capnp::_::PointerHelpers;\\n\"\n        \"  template <typename, ::capnp::Kind>\\n\"\n        \"  friend struct ::capnp::List;\\n\"\n        \"  friend class ::capnp::MessageBuilder;\\n\"\n        \"  friend class ::capnp::Orphanage;\\n\"\n        \"};\\n\"\n        \"\\n\""
          ],
          "line": 1725
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "methodDecls"
          ],
          "line": 1745
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [],
          "line": 1744
        },
        "resolved": true,
        "details": {
          "function_name": "strTree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
          "lines": "206-208",
          "snippet": "StringTree strTree(Params&&... params) {\n  return StringTree::concat(_::toStringTreeOrCharSequence(kj::fwd<Params>(params))...);\n}",
          "includes": [
            "#include \"string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"string.h\"\n\nStringTree strTree(Params&&... params) {\n  return StringTree::concat(_::toStringTreeOrCharSequence(kj::fwd<Params>(params))...);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"  inline Which which() const;\\n\""
          ],
          "line": 1744
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1726
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::StringTree makeReaderDef(kj::StringPtr fullName, kj::StringPtr unqualifiedParentType,\n                               const TemplateContext& templateContext, bool isUnion,\n                               kj::Array<kj::StringTree>&& methodDecls) {\n    return kj::strTree(\n        templateContext.allDecls(),\n        \"class \", fullName, \"::Reader {\\n\"\n        \"public:\\n\"\n        \"  typedef \", unqualifiedParentType, \" Reads;\\n\"\n        \"\\n\"\n        \"  Reader() = default;\\n\"\n        \"  inline explicit Reader(::capnp::_::StructReader base): _reader(base) {}\\n\"\n        \"\\n\"\n        \"  inline ::capnp::MessageSize totalSize() const {\\n\"\n        \"    return _reader.totalSize().asPublic();\\n\"\n        \"  }\\n\"\n        \"\\n\"\n        \"#if !CAPNP_LITE\\n\"\n        \"  inline ::kj::StringTree toString() const {\\n\"\n        \"    return ::capnp::_::structString(_reader, *_capnpPrivate::brand);\\n\"\n        \"  }\\n\"\n        \"#endif  // !CAPNP_LITE\\n\"\n        \"\\n\",\n        isUnion ? kj::strTree(\"  inline Which which() const;\\n\") : kj::strTree(),\n        kj::mv(methodDecls),\n        \"private:\\n\"\n        \"  ::capnp::_::StructReader _reader;\\n\"\n        \"  template <typename, ::capnp::Kind>\\n\"\n        \"  friend struct ::capnp::ToDynamic_;\\n\"\n        \"  template <typename, ::capnp::Kind>\\n\"\n        \"  friend struct ::capnp::_::PointerHelpers;\\n\"\n        \"  template <typename, ::capnp::Kind>\\n\"\n        \"  friend struct ::capnp::List;\\n\"\n        \"  friend class ::capnp::MessageBuilder;\\n\"\n        \"  friend class ::capnp::Orphanage;\\n\"\n        \"};\\n\"\n        \"\\n\");\n  }"
  },
  {
    "function_name": "makeFieldText",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "1089-1709",
    "snippet": "FieldText makeFieldText(kj::StringPtr scope, StructSchema::Field field,\n                          const TemplateContext& templateContext) {\n    auto proto = field.getProto();\n    auto typeSchema = field.getType();\n    auto baseName = protoName(proto);\n    kj::String titleCase = toTitleCase(baseName);\n\n    DiscriminantChecks unionDiscrim;\n    if (hasDiscriminantValue(proto)) {\n      unionDiscrim = makeDiscriminantChecks(scope, baseName, field.getContainingStruct(),\n                                            templateContext);\n    }\n\n    switch (proto.which()) {\n      case schema::Field::SLOT:\n        // Continue below.\n        break;\n\n      case schema::Field::GROUP: {\n        auto slots = getSortedSlots(field.getType().asStruct());\n        return FieldText {\n            kj::strTree(\n                kj::mv(unionDiscrim.readerIsDecl),\n                \"  inline \", titleCase, \"::Reader get\", titleCase, \"() const;\\n\"\n                \"\\n\"),\n\n            kj::strTree(\n                kj::mv(unionDiscrim.builderIsDecl),\n                \"  inline \", titleCase, \"::Builder get\", titleCase, \"();\\n\"\n                \"  inline \", titleCase, \"::Builder init\", titleCase, \"();\\n\"\n                \"\\n\"),\n\n            hasDiscriminantValue(proto) ? kj::strTree() :\n                kj::strTree(\"  inline \", titleCase, \"::Pipeline get\", titleCase, \"();\\n\"),\n\n            kj::strTree(\n                kj::mv(unionDiscrim.isDefs),\n                templateContext.allDecls(),\n                \"inline \", scope, titleCase, \"::Reader \", scope, \"Reader::get\", titleCase, \"() const {\\n\",\n                unionDiscrim.check,\n                \"  return \", scope, titleCase, \"::Reader(_reader);\\n\"\n                \"}\\n\",\n                templateContext.allDecls(),\n                \"inline \", scope, titleCase, \"::Builder \", scope, \"Builder::get\", titleCase, \"() {\\n\",\n                unionDiscrim.check,\n                \"  return \", scope, titleCase, \"::Builder(_builder);\\n\"\n                \"}\\n\",\n                hasDiscriminantValue(proto) ? kj::strTree() : kj::strTree(\n                  \"#if !CAPNP_LITE\\n\",\n                  templateContext.allDecls(),\n                  \"inline \", scope, titleCase, \"::Pipeline \", scope, \"Pipeline::get\", titleCase, \"() {\\n\",\n                  \"  return \", scope, titleCase, \"::Pipeline(_typeless.noop());\\n\"\n                  \"}\\n\"\n                  \"#endif  // !CAPNP_LITE\\n\"),\n                templateContext.allDecls(),\n                \"inline \", scope, titleCase, \"::Builder \", scope, \"Builder::init\", titleCase, \"() {\\n\",\n                unionDiscrim.set,\n                KJ_MAP(slot, slots) {\n                  switch (sectionFor(slot.whichType)) {\n                    case Section::NONE:\n                      return kj::strTree();\n                    case Section::DATA:\n                      return kj::strTree(\n                          \"  _builder.setDataField<\", maskType(slot.whichType), \">(\",\n                              slot.offset, \" * ::capnp::ELEMENTS, 0);\\n\");\n                    case Section::POINTERS:\n                      return kj::strTree(\n                          \"  _builder.getPointerField(\", slot.offset,\n                              \" * ::capnp::POINTERS).clear();\\n\");\n                  }\n                  KJ_UNREACHABLE;\n                },\n                \"  return \", scope, titleCase, \"::Builder(_builder);\\n\"\n                \"}\\n\")\n          };\n      }\n    }\n\n    auto slot = proto.getSlot();\n\n    FieldKind kind = FieldKind::PRIMITIVE;\n    kj::String ownedType;\n    CppTypeName type = typeName(typeSchema, nullptr);\n    kj::StringPtr setterDefault;  // only for void\n    kj::String defaultMask;    // primitives only\n    size_t defaultOffset = 0;    // pointers only: offset of the default value within the schema.\n    size_t defaultSize = 0;      // blobs only: byte size of the default value.\n\n    auto defaultBody = slot.getDefaultValue();\n    switch (typeSchema.which()) {\n      case schema::Type::VOID:\n        kind = FieldKind::PRIMITIVE;\n        setterDefault = \" = ::capnp::VOID\";\n        break;\n\n#define HANDLE_PRIMITIVE(discrim, typeName, defaultName, suffix) \\\n      case schema::Type::discrim: \\\n        kind = FieldKind::PRIMITIVE; \\\n        if (defaultBody.get##defaultName() != 0) { \\\n          defaultMask = kj::str(defaultBody.get##defaultName(), #suffix); \\\n        } \\\n        break;\n\n      HANDLE_PRIMITIVE(BOOL, bool, Bool, );\n      HANDLE_PRIMITIVE(INT8 , ::int8_t , Int8 , );\n      HANDLE_PRIMITIVE(INT16, ::int16_t, Int16, );\n      HANDLE_PRIMITIVE(INT32, ::int32_t, Int32, );\n      HANDLE_PRIMITIVE(INT64, ::int64_t, Int64, ll);\n      HANDLE_PRIMITIVE(UINT8 , ::uint8_t , Uint8 , u);\n      HANDLE_PRIMITIVE(UINT16, ::uint16_t, Uint16, u);\n      HANDLE_PRIMITIVE(UINT32, ::uint32_t, Uint32, u);\n      HANDLE_PRIMITIVE(UINT64, ::uint64_t, Uint64, ull);\n#undef HANDLE_PRIMITIVE\n\n      case schema::Type::FLOAT32:\n        kind = FieldKind::PRIMITIVE;\n        if (defaultBody.getFloat32() != 0) {\n          uint32_t mask;\n          float value = defaultBody.getFloat32();\n          static_assert(sizeof(mask) == sizeof(value), \"bug\");\n          memcpy(&mask, &value, sizeof(mask));\n          defaultMask = kj::str(mask, \"u\");\n        }\n        break;\n\n      case schema::Type::FLOAT64:\n        kind = FieldKind::PRIMITIVE;\n        if (defaultBody.getFloat64() != 0) {\n          uint64_t mask;\n          double value = defaultBody.getFloat64();\n          static_assert(sizeof(mask) == sizeof(value), \"bug\");\n          memcpy(&mask, &value, sizeof(mask));\n          defaultMask = kj::str(mask, \"ull\");\n        }\n        break;\n\n      case schema::Type::TEXT:\n        kind = FieldKind::BLOB;\n        if (defaultBody.hasText()) {\n          defaultOffset = field.getDefaultValueSchemaOffset();\n          defaultSize = defaultBody.getText().size();\n        }\n        break;\n      case schema::Type::DATA:\n        kind = FieldKind::BLOB;\n        if (defaultBody.hasData()) {\n          defaultOffset = field.getDefaultValueSchemaOffset();\n          defaultSize = defaultBody.getData().size();\n        }\n        break;\n\n      case schema::Type::ENUM:\n        kind = FieldKind::PRIMITIVE;\n        if (defaultBody.getEnum() != 0) {\n          defaultMask = kj::str(defaultBody.getEnum(), \"u\");\n        }\n        break;\n\n      case schema::Type::STRUCT:\n        kind = FieldKind::STRUCT;\n        if (defaultBody.hasStruct()) {\n          defaultOffset = field.getDefaultValueSchemaOffset();\n        }\n        break;\n      case schema::Type::LIST:\n        kind = FieldKind::LIST;\n        if (defaultBody.hasList()) {\n          defaultOffset = field.getDefaultValueSchemaOffset();\n        }\n        break;\n      case schema::Type::INTERFACE:\n        kind = FieldKind::INTERFACE;\n        break;\n      case schema::Type::ANY_POINTER:\n        if (defaultBody.hasAnyPointer()) {\n          defaultOffset = field.getDefaultValueSchemaOffset();\n        }\n        if (typeSchema.getBrandParameter() != nullptr) {\n          kind = FieldKind::BRAND_PARAMETER;\n        } else {\n          kind = FieldKind::ANY_POINTER;\n          switch (typeSchema.whichAnyPointerKind()) {\n            case schema::Type::AnyPointer::Unconstrained::ANY_KIND:\n              kind = FieldKind::ANY_POINTER;\n              break;\n            case schema::Type::AnyPointer::Unconstrained::STRUCT:\n              kind = FieldKind::STRUCT;\n              break;\n            case schema::Type::AnyPointer::Unconstrained::LIST:\n              kind = FieldKind::LIST;\n              break;\n            case schema::Type::AnyPointer::Unconstrained::CAPABILITY:\n              kind = FieldKind::INTERFACE;\n              break;\n          }\n        }\n        break;\n    }\n\n    kj::String defaultMaskParam;\n    if (defaultMask.size() > 0) {\n      defaultMaskParam = kj::str(\", \", defaultMask);\n    }\n\n    uint offset = slot.getOffset();\n\n    if (kind == FieldKind::PRIMITIVE) {\n      return FieldText {\n        kj::strTree(\n            kj::mv(unionDiscrim.readerIsDecl),\n            \"  inline \", type, \" get\", titleCase, \"() const;\\n\"\n            \"\\n\"),\n\n        kj::strTree(\n            kj::mv(unionDiscrim.builderIsDecl),\n            \"  inline \", type, \" get\", titleCase, \"();\\n\"\n            \"  inline void set\", titleCase, \"(\", type, \" value\", setterDefault, \");\\n\"\n            \"\\n\"),\n\n        kj::strTree(),\n\n        kj::strTree(\n            kj::mv(unionDiscrim.isDefs),\n            templateContext.allDecls(),\n            \"inline \", type, \" \", scope, \"Reader::get\", titleCase, \"() const {\\n\",\n            unionDiscrim.check,\n            \"  return _reader.getDataField<\", type, \">(\\n\"\n            \"      \", offset, \" * ::capnp::ELEMENTS\", defaultMaskParam, \");\\n\",\n            \"}\\n\"\n            \"\\n\",\n            templateContext.allDecls(),\n            \"inline \", type, \" \", scope, \"Builder::get\", titleCase, \"() {\\n\",\n            unionDiscrim.check,\n            \"  return _builder.getDataField<\", type, \">(\\n\"\n            \"      \", offset, \" * ::capnp::ELEMENTS\", defaultMaskParam, \");\\n\",\n            \"}\\n\",\n            templateContext.allDecls(),\n            \"inline void \", scope, \"Builder::set\", titleCase, \"(\", type, \" value) {\\n\",\n            unionDiscrim.set,\n            \"  _builder.setDataField<\", type, \">(\\n\"\n            \"      \", offset, \" * ::capnp::ELEMENTS, value\", defaultMaskParam, \");\\n\",\n            \"}\\n\"\n            \"\\n\")\n      };\n\n    } else if (kind == FieldKind::INTERFACE) {\n      CppTypeName clientType = type;\n      clientType.addMemberType(\"Client\");\n\n      return FieldText {\n        kj::strTree(\n            kj::mv(unionDiscrim.readerIsDecl),\n            \"  inline bool has\", titleCase, \"() const;\\n\"\n            \"#if !CAPNP_LITE\\n\"\n            \"  inline \", clientType, \" get\", titleCase, \"() const;\\n\"\n            \"#endif  // !CAPNP_LITE\\n\"\n            \"\\n\"),\n\n        kj::strTree(\n            kj::mv(unionDiscrim.builderIsDecl),\n            \"  inline bool has\", titleCase, \"();\\n\"\n            \"#if !CAPNP_LITE\\n\"\n            \"  inline \", clientType, \" get\", titleCase, \"();\\n\"\n            \"  inline void set\", titleCase, \"(\", clientType, \"&& value);\\n\",\n            \"  inline void set\", titleCase, \"(\", clientType, \"& value);\\n\",\n            \"  inline void adopt\", titleCase, \"(::capnp::Orphan<\", type, \">&& value);\\n\"\n            \"  inline ::capnp::Orphan<\", type, \"> disown\", titleCase, \"();\\n\"\n            \"#endif  // !CAPNP_LITE\\n\"\n            \"\\n\"),\n\n        kj::strTree(\n            hasDiscriminantValue(proto) ? kj::strTree() : kj::strTree(\n              \"  inline \", clientType, \" get\", titleCase, \"();\\n\")),\n\n        kj::strTree(\n            kj::mv(unionDiscrim.isDefs),\n            templateContext.allDecls(),\n            \"inline bool \", scope, \"Reader::has\", titleCase, \"() const {\\n\",\n            unionDiscrim.has,\n            \"  return !_reader.getPointerField(\", offset, \" * ::capnp::POINTERS).isNull();\\n\"\n            \"}\\n\",\n            templateContext.allDecls(),\n            \"inline bool \", scope, \"Builder::has\", titleCase, \"() {\\n\",\n            unionDiscrim.has,\n            \"  return !_builder.getPointerField(\", offset, \" * ::capnp::POINTERS).isNull();\\n\"\n            \"}\\n\"\n            \"#if !CAPNP_LITE\\n\",\n            templateContext.allDecls(),\n            \"inline \", clientType, \" \", scope, \"Reader::get\", titleCase, \"() const {\\n\",\n            unionDiscrim.check,\n            \"  return ::capnp::_::PointerHelpers<\", type, \">::get(\\n\"\n            \"      _reader.getPointerField(\", offset, \" * ::capnp::POINTERS));\\n\"\n            \"}\\n\",\n            templateContext.allDecls(),\n            \"inline \", clientType, \" \", scope, \"Builder::get\", titleCase, \"() {\\n\",\n            unionDiscrim.check,\n            \"  return ::capnp::_::PointerHelpers<\", type, \">::get(\\n\"\n            \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS));\\n\"\n            \"}\\n\",\n            hasDiscriminantValue(proto) ? kj::strTree() : kj::strTree(\n              templateContext.allDecls(),\n              \"inline \", clientType, \" \", scope, \"Pipeline::get\", titleCase, \"() {\\n\",\n              \"  return \", clientType, \"(_typeless.getPointerField(\", offset, \").asCap());\\n\"\n              \"}\\n\"),\n            templateContext.allDecls(),\n            \"inline void \", scope, \"Builder::set\", titleCase, \"(\", clientType, \"&& cap) {\\n\",\n            unionDiscrim.set,\n            \"  ::capnp::_::PointerHelpers<\", type, \">::set(\\n\"\n            \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS), kj::mv(cap));\\n\"\n            \"}\\n\",\n            templateContext.allDecls(),\n            \"inline void \", scope, \"Builder::set\", titleCase, \"(\", clientType, \"& cap) {\\n\",\n            unionDiscrim.set,\n            \"  ::capnp::_::PointerHelpers<\", type, \">::set(\\n\"\n            \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS), cap);\\n\"\n            \"}\\n\",\n            templateContext.allDecls(),\n            \"inline void \", scope, \"Builder::adopt\", titleCase, \"(\\n\"\n            \"    ::capnp::Orphan<\", type, \">&& value) {\\n\",\n            unionDiscrim.set,\n            \"  ::capnp::_::PointerHelpers<\", type, \">::adopt(\\n\"\n            \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS), kj::mv(value));\\n\"\n            \"}\\n\",\n            templateContext.allDecls(),\n            \"inline ::capnp::Orphan<\", type, \"> \", scope, \"Builder::disown\", titleCase, \"() {\\n\",\n            unionDiscrim.check,\n            \"  return ::capnp::_::PointerHelpers<\", type, \">::disown(\\n\"\n            \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS));\\n\"\n            \"}\\n\"\n            \"#endif  // !CAPNP_LITE\\n\"\n            \"\\n\")\n      };\n\n    } else if (kind == FieldKind::ANY_POINTER) {\n      return FieldText {\n        kj::strTree(\n            kj::mv(unionDiscrim.readerIsDecl),\n            \"  inline bool has\", titleCase, \"() const;\\n\"\n            \"  inline ::capnp::AnyPointer::Reader get\", titleCase, \"() const;\\n\"\n            \"\\n\"),\n\n        kj::strTree(\n            kj::mv(unionDiscrim.builderIsDecl),\n            \"  inline bool has\", titleCase, \"();\\n\"\n            \"  inline ::capnp::AnyPointer::Builder get\", titleCase, \"();\\n\"\n            \"  inline ::capnp::AnyPointer::Builder init\", titleCase, \"();\\n\"\n            \"\\n\"),\n\n        kj::strTree(),\n\n        kj::strTree(\n            kj::mv(unionDiscrim.isDefs),\n            templateContext.allDecls(),\n            \"inline bool \", scope, \"Reader::has\", titleCase, \"() const {\\n\",\n            unionDiscrim.has,\n            \"  return !_reader.getPointerField(\", offset, \" * ::capnp::POINTERS).isNull();\\n\"\n            \"}\\n\",\n            templateContext.allDecls(),\n            \"inline bool \", scope, \"Builder::has\", titleCase, \"() {\\n\",\n            unionDiscrim.has,\n            \"  return !_builder.getPointerField(\", offset, \" * ::capnp::POINTERS).isNull();\\n\"\n            \"}\\n\",\n            templateContext.allDecls(),\n            \"inline ::capnp::AnyPointer::Reader \", scope, \"Reader::get\", titleCase, \"() const {\\n\",\n            unionDiscrim.check,\n            \"  return ::capnp::AnyPointer::Reader(\\n\"\n            \"      _reader.getPointerField(\", offset, \" * ::capnp::POINTERS));\\n\"\n            \"}\\n\",\n            templateContext.allDecls(),\n            \"inline ::capnp::AnyPointer::Builder \", scope, \"Builder::get\", titleCase, \"() {\\n\",\n            unionDiscrim.check,\n            \"  return ::capnp::AnyPointer::Builder(\\n\"\n            \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS));\\n\"\n            \"}\\n\",\n            templateContext.allDecls(),\n            \"inline ::capnp::AnyPointer::Builder \", scope, \"Builder::init\", titleCase, \"() {\\n\",\n            unionDiscrim.set,\n            \"  auto result = ::capnp::AnyPointer::Builder(\\n\"\n            \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS));\\n\"\n            \"  result.clear();\\n\"\n            \"  return result;\\n\"\n            \"}\\n\"\n            \"\\n\")\n      };\n\n    } else {\n      // Blob, struct, list, or template param.  These have only minor differences.\n\n      uint64_t typeId = field.getContainingStruct().getProto().getId();\n      kj::String defaultParam = defaultOffset == 0 ? kj::str() : kj::str(\n          \",\\n        ::capnp::schemas::bp_\", kj::hex(typeId), \" + \", defaultOffset,\n          defaultSize == 0 ? kj::strTree() : kj::strTree(\", \", defaultSize));\n\n      bool shouldIncludeStructInit =\n          kind == FieldKind::STRUCT || kind == FieldKind::BRAND_PARAMETER;\n      bool shouldIncludeSizedInit =\n          kind != FieldKind::STRUCT || kind == FieldKind::BRAND_PARAMETER;\n      bool shouldIncludePipelineGetter = !hasDiscriminantValue(proto) &&\n          (kind == FieldKind::STRUCT || kind == FieldKind::BRAND_PARAMETER);\n      bool shouldIncludeArrayInitializer = false;\n      bool shouldExcludeInLiteMode = type.hasInterfaces();\n      bool shouldTemplatizeInit = typeSchema.which() == schema::Type::ANY_POINTER &&\n          kind != FieldKind::BRAND_PARAMETER;\n\n      CppTypeName elementReaderType;\n      if (typeSchema.isList()) {\n        bool primitiveElement = false;\n        bool interface = false;\n        auto elementType = typeSchema.asList().getElementType();\n        switch (elementType.which()) {\n          case schema::Type::VOID:\n          case schema::Type::BOOL:\n          case schema::Type::INT8:\n          case schema::Type::INT16:\n          case schema::Type::INT32:\n          case schema::Type::INT64:\n          case schema::Type::UINT8:\n          case schema::Type::UINT16:\n          case schema::Type::UINT32:\n          case schema::Type::UINT64:\n          case schema::Type::FLOAT32:\n          case schema::Type::FLOAT64:\n          case schema::Type::ENUM:\n            primitiveElement = true;\n            shouldIncludeArrayInitializer = true;\n            break;\n\n          case schema::Type::TEXT:\n          case schema::Type::DATA:\n          case schema::Type::LIST:\n            primitiveElement = false;\n            shouldIncludeArrayInitializer = true;\n            break;\n\n          case schema::Type::ANY_POINTER:\n            primitiveElement = false;\n            shouldIncludeArrayInitializer = elementType.getBrandParameter() != nullptr;\n            break;\n\n          case schema::Type::INTERFACE:\n            primitiveElement = false;\n            interface = true;\n            break;\n\n          case schema::Type::STRUCT:\n            primitiveElement = false;\n            break;\n        }\n        elementReaderType = typeName(elementType, nullptr);\n        if (!primitiveElement) {\n          if (interface) {\n            elementReaderType.addMemberType(\"Client\");\n          } else {\n            elementReaderType.addMemberType(\"Reader\");\n          }\n        }\n      };\n\n      CppTypeName readerType;\n      CppTypeName builderType;\n      CppTypeName pipelineType;\n      if (kind == FieldKind::BRAND_PARAMETER) {\n        readerType = CppTypeName::makeNamespace(\"capnp\");\n        readerType.addMemberTemplate(\"ReaderFor\", kj::heapArray(&type, 1));\n        builderType = CppTypeName::makeNamespace(\"capnp\");\n        builderType.addMemberTemplate(\"BuilderFor\", kj::heapArray(&type, 1));\n        pipelineType = CppTypeName::makeNamespace(\"capnp\");\n        pipelineType.addMemberTemplate(\"PipelineFor\", kj::heapArray(&type, 1));\n      } else {\n        readerType = type;\n        readerType.addMemberType(\"Reader\");\n        builderType = type;\n        builderType.addMemberType(\"Builder\");\n        pipelineType = type;\n        pipelineType.addMemberType(\"Pipeline\");\n      }\n\n      #define COND(cond, ...) ((cond) ? kj::strTree(__VA_ARGS__) : kj::strTree())\n\n      return FieldText {\n        kj::strTree(\n            kj::mv(unionDiscrim.readerIsDecl),\n            \"  inline bool has\", titleCase, \"() const;\\n\",\n            COND(shouldExcludeInLiteMode, \"#if !CAPNP_LITE\\n\"),\n            \"  inline \", readerType, \" get\", titleCase, \"() const;\\n\",\n            COND(shouldExcludeInLiteMode, \"#endif  // !CAPNP_LITE\\n\"),\n            \"\\n\"),\n\n        kj::strTree(\n            kj::mv(unionDiscrim.builderIsDecl),\n            \"  inline bool has\", titleCase, \"();\\n\",\n            COND(shouldExcludeInLiteMode, \"#if !CAPNP_LITE\\n\"),\n            \"  inline \", builderType, \" get\", titleCase, \"();\\n\"\n            \"  inline void set\", titleCase, \"(\", readerType, \" value);\\n\",\n            COND(shouldIncludeArrayInitializer,\n              \"  inline void set\", titleCase, \"(::kj::ArrayPtr<const \", elementReaderType, \"> value);\\n\"),\n            COND(shouldIncludeStructInit,\n              COND(shouldTemplatizeInit,\n                \"  template <typename T_>\\n\"\n                \"  inline ::capnp::BuilderFor<T_> init\", titleCase, \"As();\\n\"),\n              COND(!shouldTemplatizeInit,\n                \"  inline \", builderType, \" init\", titleCase, \"();\\n\")),\n            COND(shouldIncludeSizedInit,\n              COND(shouldTemplatizeInit,\n                \"  template <typename T_>\\n\"\n                \"  inline ::capnp::BuilderFor<T_> init\", titleCase, \"As(unsigned int size);\\n\"),\n              COND(!shouldTemplatizeInit,\n                \"  inline \", builderType, \" init\", titleCase, \"(unsigned int size);\\n\")),\n            \"  inline void adopt\", titleCase, \"(::capnp::Orphan<\", type, \">&& value);\\n\"\n            \"  inline ::capnp::Orphan<\", type, \"> disown\", titleCase, \"();\\n\",\n            COND(shouldExcludeInLiteMode, \"#endif  // !CAPNP_LITE\\n\"),\n            \"\\n\"),\n\n        kj::strTree(\n            COND(shouldIncludePipelineGetter,\n              \"  inline \", pipelineType, \" get\", titleCase, \"();\\n\")),\n\n        kj::strTree(\n            kj::mv(unionDiscrim.isDefs),\n            templateContext.allDecls(),\n            \"inline bool \", scope, \"Reader::has\", titleCase, \"() const {\\n\",\n            unionDiscrim.has,\n            \"  return !_reader.getPointerField(\", offset, \" * ::capnp::POINTERS).isNull();\\n\"\n            \"}\\n\",\n            templateContext.allDecls(),\n            \"inline bool \", scope, \"Builder::has\", titleCase, \"() {\\n\",\n            unionDiscrim.has,\n            \"  return !_builder.getPointerField(\", offset, \" * ::capnp::POINTERS).isNull();\\n\"\n            \"}\\n\",\n            COND(shouldExcludeInLiteMode, \"#if !CAPNP_LITE\\n\"),\n            templateContext.allDecls(),\n            \"inline \", readerType, \" \", scope, \"Reader::get\", titleCase, \"() const {\\n\",\n            unionDiscrim.check,\n            \"  return ::capnp::_::PointerHelpers<\", type, \">::get(\\n\"\n            \"      _reader.getPointerField(\", offset, \" * ::capnp::POINTERS)\", defaultParam, \");\\n\"\n            \"}\\n\",\n            templateContext.allDecls(),\n            \"inline \", builderType, \" \", scope, \"Builder::get\", titleCase, \"() {\\n\",\n            unionDiscrim.check,\n            \"  return ::capnp::_::PointerHelpers<\", type, \">::get(\\n\"\n            \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS)\", defaultParam, \");\\n\"\n            \"}\\n\",\n            COND(shouldIncludePipelineGetter,\n              \"#if !CAPNP_LITE\\n\",\n              templateContext.allDecls(),\n              \"inline \", pipelineType, \" \", scope, \"Pipeline::get\", titleCase, \"() {\\n\",\n              \"  return \", pipelineType, \"(_typeless.getPointerField(\", offset, \"));\\n\"\n              \"}\\n\"\n              \"#endif  // !CAPNP_LITE\\n\"),\n            templateContext.allDecls(),\n            \"inline void \", scope, \"Builder::set\", titleCase, \"(\", readerType, \" value) {\\n\",\n            unionDiscrim.set,\n            \"  ::capnp::_::PointerHelpers<\", type, \">::set(\\n\"\n            \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS), value);\\n\"\n            \"}\\n\",\n            COND(shouldIncludeArrayInitializer,\n              templateContext.allDecls(),\n              \"inline void \", scope, \"Builder::set\", titleCase, \"(::kj::ArrayPtr<const \", elementReaderType, \"> value) {\\n\",\n              unionDiscrim.set,\n              \"  ::capnp::_::PointerHelpers<\", type, \">::set(\\n\"\n              \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS), value);\\n\"\n              \"}\\n\"),\n            COND(shouldIncludeStructInit,\n              COND(shouldTemplatizeInit,\n                templateContext.allDecls(),\n                \"template <typename T_>\\n\"\n                \"inline ::capnp::BuilderFor<T_> \", scope, \"Builder::init\", titleCase, \"As() {\\n\",\n                \"  static_assert(::capnp::kind<T_>() == ::capnp::Kind::STRUCT,\\n\"\n                \"                \\\"\", proto.getName(), \" must be a struct\\\");\\n\",\n                unionDiscrim.set,\n                \"  return ::capnp::_::PointerHelpers<T_>::init(\\n\"\n                \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS));\\n\"\n                \"}\\n\"),\n              COND(!shouldTemplatizeInit,\n                templateContext.allDecls(),\n                \"inline \", builderType, \" \", scope, \"Builder::init\", titleCase, \"() {\\n\",\n                unionDiscrim.set,\n                \"  return ::capnp::_::PointerHelpers<\", type, \">::init(\\n\"\n                \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS));\\n\"\n                \"}\\n\")),\n            COND(shouldIncludeSizedInit,\n              COND(shouldTemplatizeInit,\n                templateContext.allDecls(),\n                \"template <typename T_>\\n\"\n                \"inline ::capnp::BuilderFor<T_> \", scope, \"Builder::init\", titleCase, \"As(unsigned int size) {\\n\",\n                \"  static_assert(::capnp::kind<T_>() == ::capnp::Kind::LIST,\\n\"\n                \"                \\\"\", proto.getName(), \" must be a list\\\");\\n\",\n                unionDiscrim.set,\n                \"  return ::capnp::_::PointerHelpers<T_>::init(\\n\"\n                \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS), size);\\n\"\n                \"}\\n\"),\n              COND(!shouldTemplatizeInit,\n                templateContext.allDecls(),\n                \"inline \", builderType, \" \", scope, \"Builder::init\", titleCase, \"(unsigned int size) {\\n\",\n                unionDiscrim.set,\n                \"  return ::capnp::_::PointerHelpers<\", type, \">::init(\\n\"\n                \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS), size);\\n\"\n                \"}\\n\")),\n            templateContext.allDecls(),\n            \"inline void \", scope, \"Builder::adopt\", titleCase, \"(\\n\"\n            \"    ::capnp::Orphan<\", type, \">&& value) {\\n\",\n            unionDiscrim.set,\n            \"  ::capnp::_::PointerHelpers<\", type, \">::adopt(\\n\"\n            \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS), kj::mv(value));\\n\"\n            \"}\\n\",\n            COND(type.hasDisambiguatedTemplate(),\n                \"#ifndef _MSC_VER\\n\"\n                \"// Excluded under MSVC because bugs may make it unable to compile this method.\\n\"),\n            templateContext.allDecls(),\n            \"inline ::capnp::Orphan<\", type, \"> \", scope, \"Builder::disown\", titleCase, \"() {\\n\",\n            unionDiscrim.check,\n            \"  return ::capnp::_::PointerHelpers<\", type, \">::disown(\\n\"\n            \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS));\\n\"\n            \"}\\n\",\n            COND(type.hasDisambiguatedTemplate(), \"#endif  // !_MSC_VER\\n\"),\n            COND(shouldExcludeInLiteMode, \"#endif  // !CAPNP_LITE\\n\"),\n            \"\\n\")\n      };\n\n      #undef COND\n    }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "kj::mv(unionDiscrim.isDefs)",
            "templateContext.allDecls()",
            "\"inline bool \"",
            "scope",
            "\"Reader::has\"",
            "titleCase",
            "\"() const {\\n\"",
            "unionDiscrim.has",
            "\"  return !_reader.getPointerField(\"",
            "offset",
            "\" * ::capnp::POINTERS).isNull();\\n\"\n            \"}\\n\"",
            "templateContext.allDecls()",
            "\"inline bool \"",
            "scope",
            "\"Builder::has\"",
            "titleCase",
            "\"() {\\n\"",
            "unionDiscrim.has",
            "\"  return !_builder.getPointerField(\"",
            "offset",
            "\" * ::capnp::POINTERS).isNull();\\n\"\n            \"}\\n\"",
            "COND(shouldExcludeInLiteMode, \"#if !CAPNP_LITE\\n\")",
            "templateContext.allDecls()",
            "\"inline \"",
            "readerType",
            "\" \"",
            "scope",
            "\"Reader::get\"",
            "titleCase",
            "\"() const {\\n\"",
            "unionDiscrim.check",
            "\"  return ::capnp::_::PointerHelpers<\"",
            "type",
            "\">::get(\\n\"\n            \"      _reader.getPointerField(\"",
            "offset",
            "\" * ::capnp::POINTERS)\"",
            "defaultParam",
            "\");\\n\"\n            \"}\\n\"",
            "templateContext.allDecls()",
            "\"inline \"",
            "builderType",
            "\" \"",
            "scope",
            "\"Builder::get\"",
            "titleCase",
            "\"() {\\n\"",
            "unionDiscrim.check",
            "\"  return ::capnp::_::PointerHelpers<\"",
            "type",
            "\">::get(\\n\"\n            \"      _builder.getPointerField(\"",
            "offset",
            "\" * ::capnp::POINTERS)\"",
            "defaultParam",
            "\");\\n\"\n            \"}\\n\"",
            "COND(shouldIncludePipelineGetter,\n              \"#if !CAPNP_LITE\\n\",\n              templateContext.allDecls(),\n              \"inline \", pipelineType, \" \", scope, \"Pipeline::get\", titleCase, \"() {\\n\",\n              \"  return \", pipelineType, \"(_typeless.getPointerField(\", offset, \"));\\n\"\n              \"}\\n\"\n              \"#endif  // !CAPNP_LITE\\n\")",
            "templateContext.allDecls()",
            "\"inline void \"",
            "scope",
            "\"Builder::set\"",
            "titleCase",
            "\"(\"",
            "readerType",
            "\" value) {\\n\"",
            "unionDiscrim.set",
            "\"  ::capnp::_::PointerHelpers<\"",
            "type",
            "\">::set(\\n\"\n            \"      _builder.getPointerField(\"",
            "offset",
            "\" * ::capnp::POINTERS), value);\\n\"\n            \"}\\n\"",
            "COND(shouldIncludeArrayInitializer,\n              templateContext.allDecls(),\n              \"inline void \", scope, \"Builder::set\", titleCase, \"(::kj::ArrayPtr<const \", elementReaderType, \"> value) {\\n\",\n              unionDiscrim.set,\n              \"  ::capnp::_::PointerHelpers<\", type, \">::set(\\n\"\n              \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS), value);\\n\"\n              \"}\\n\")",
            "COND(shouldIncludeStructInit,\n              COND(shouldTemplatizeInit,\n                templateContext.allDecls(),\n                \"template <typename T_>\\n\"\n                \"inline ::capnp::BuilderFor<T_> \", scope, \"Builder::init\", titleCase, \"As() {\\n\",\n                \"  static_assert(::capnp::kind<T_>() == ::capnp::Kind::STRUCT,\\n\"\n                \"                \\\"\", proto.getName(), \" must be a struct\\\");\\n\",\n                unionDiscrim.set,\n                \"  return ::capnp::_::PointerHelpers<T_>::init(\\n\"\n                \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS));\\n\"\n                \"}\\n\"),\n              COND(!shouldTemplatizeInit,\n                templateContext.allDecls(),\n                \"inline \", builderType, \" \", scope, \"Builder::init\", titleCase, \"() {\\n\",\n                unionDiscrim.set,\n                \"  return ::capnp::_::PointerHelpers<\", type, \">::init(\\n\"\n                \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS));\\n\"\n                \"}\\n\"))",
            "COND(shouldIncludeSizedInit,\n              COND(shouldTemplatizeInit,\n                templateContext.allDecls(),\n                \"template <typename T_>\\n\"\n                \"inline ::capnp::BuilderFor<T_> \", scope, \"Builder::init\", titleCase, \"As(unsigned int size) {\\n\",\n                \"  static_assert(::capnp::kind<T_>() == ::capnp::Kind::LIST,\\n\"\n                \"                \\\"\", proto.getName(), \" must be a list\\\");\\n\",\n                unionDiscrim.set,\n                \"  return ::capnp::_::PointerHelpers<T_>::init(\\n\"\n                \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS), size);\\n\"\n                \"}\\n\"),\n              COND(!shouldTemplatizeInit,\n                templateContext.allDecls(),\n                \"inline \", builderType, \" \", scope, \"Builder::init\", titleCase, \"(unsigned int size) {\\n\",\n                unionDiscrim.set,\n                \"  return ::capnp::_::PointerHelpers<\", type, \">::init(\\n\"\n                \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS), size);\\n\"\n                \"}\\n\"))",
            "templateContext.allDecls()",
            "\"inline void \"",
            "scope",
            "\"Builder::adopt\"",
            "titleCase",
            "\"(\\n\"\n            \"    ::capnp::Orphan<\"",
            "type",
            "\">&& value) {\\n\"",
            "unionDiscrim.set",
            "\"  ::capnp::_::PointerHelpers<\"",
            "type",
            "\">::adopt(\\n\"\n            \"      _builder.getPointerField(\"",
            "offset",
            "\" * ::capnp::POINTERS), kj::mv(value));\\n\"\n            \"}\\n\"",
            "COND(type.hasDisambiguatedTemplate(),\n                \"#ifndef _MSC_VER\\n\"\n                \"// Excluded under MSVC because bugs may make it unable to compile this method.\\n\")",
            "templateContext.allDecls()",
            "\"inline ::capnp::Orphan<\"",
            "type",
            "\"> \"",
            "scope",
            "\"Builder::disown\"",
            "titleCase",
            "\"() {\\n\"",
            "unionDiscrim.check",
            "\"  return ::capnp::_::PointerHelpers<\"",
            "type",
            "\">::disown(\\n\"\n            \"      _builder.getPointerField(\"",
            "offset",
            "\" * ::capnp::POINTERS));\\n\"\n            \"}\\n\"",
            "COND(type.hasDisambiguatedTemplate(), \"#endif  // !_MSC_VER\\n\")",
            "COND(shouldExcludeInLiteMode, \"#endif  // !CAPNP_LITE\\n\")",
            "\"\\n\""
          ],
          "line": 1606
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "COND",
          "args": [
            "shouldExcludeInLiteMode",
            "\"#endif  // !CAPNP_LITE\\n\""
          ],
          "line": 1704
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "COND",
          "args": [
            "type.hasDisambiguatedTemplate()",
            "\"#endif  // !_MSC_VER\\n\""
          ],
          "line": 1703
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.hasDisambiguatedTemplate",
          "args": [],
          "line": 1703
        },
        "resolved": true,
        "details": {
          "function_name": "hasDisambiguatedTemplate",
          "container": "CppTypeName",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "220-222",
          "snippet": "bool hasDisambiguatedTemplate() {\n    return hasDisambiguatedTemplate_;\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName {\n  bool hasDisambiguatedTemplate() {\n      return hasDisambiguatedTemplate_;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1697
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "COND",
          "args": [
            "type.hasDisambiguatedTemplate()",
            "\"#ifndef _MSC_VER\\n\"\n                \"// Excluded under MSVC because bugs may make it unable to compile this method.\\n\""
          ],
          "line": 1694
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1687
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "COND",
          "args": [
            "shouldIncludeSizedInit",
            "COND(shouldTemplatizeInit,\n                templateContext.allDecls(),\n                \"template <typename T_>\\n\"\n                \"inline ::capnp::BuilderFor<T_> \", scope, \"Builder::init\", titleCase, \"As(unsigned int size) {\\n\",\n                \"  static_assert(::capnp::kind<T_>() == ::capnp::Kind::LIST,\\n\"\n                \"                \\\"\", proto.getName(), \" must be a list\\\");\\n\",\n                unionDiscrim.set,\n                \"  return ::capnp::_::PointerHelpers<T_>::init(\\n\"\n                \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS), size);\\n\"\n                \"}\\n\")",
            "COND(!shouldTemplatizeInit,\n                templateContext.allDecls(),\n                \"inline \", builderType, \" \", scope, \"Builder::init\", titleCase, \"(unsigned int size) {\\n\",\n                unionDiscrim.set,\n                \"  return ::capnp::_::PointerHelpers<\", type, \">::init(\\n\"\n                \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS), size);\\n\"\n                \"}\\n\")"
          ],
          "line": 1669
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "COND",
          "args": [
            "!shouldTemplatizeInit",
            "templateContext.allDecls()",
            "\"inline \"",
            "builderType",
            "\" \"",
            "scope",
            "\"Builder::init\"",
            "titleCase",
            "\"(unsigned int size) {\\n\"",
            "unionDiscrim.set",
            "\"  return ::capnp::_::PointerHelpers<\"",
            "type",
            "\">::init(\\n\"\n                \"      _builder.getPointerField(\"",
            "offset",
            "\" * ::capnp::POINTERS), size);\\n\"\n                \"}\\n\""
          ],
          "line": 1680
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1681
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "COND",
          "args": [
            "shouldTemplatizeInit",
            "templateContext.allDecls()",
            "\"template <typename T_>\\n\"\n                \"inline ::capnp::BuilderFor<T_> \"",
            "scope",
            "\"Builder::init\"",
            "titleCase",
            "\"As(unsigned int size) {\\n\"",
            "\"  static_assert(::capnp::kind<T_>() == ::capnp::Kind::LIST,\\n\"\n                \"                \\\"\"",
            "proto.getName()",
            "\" must be a list\\\");\\n\"",
            "unionDiscrim.set",
            "\"  return ::capnp::_::PointerHelpers<T_>::init(\\n\"\n                \"      _builder.getPointerField(\"",
            "offset",
            "\" * ::capnp::POINTERS), size);\\n\"\n                \"}\\n\""
          ],
          "line": 1670
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.getName",
          "args": [],
          "line": 1675
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1671
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "COND",
          "args": [
            "shouldIncludeStructInit",
            "COND(shouldTemplatizeInit,\n                templateContext.allDecls(),\n                \"template <typename T_>\\n\"\n                \"inline ::capnp::BuilderFor<T_> \", scope, \"Builder::init\", titleCase, \"As() {\\n\",\n                \"  static_assert(::capnp::kind<T_>() == ::capnp::Kind::STRUCT,\\n\"\n                \"                \\\"\", proto.getName(), \" must be a struct\\\");\\n\",\n                unionDiscrim.set,\n                \"  return ::capnp::_::PointerHelpers<T_>::init(\\n\"\n                \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS));\\n\"\n                \"}\\n\")",
            "COND(!shouldTemplatizeInit,\n                templateContext.allDecls(),\n                \"inline \", builderType, \" \", scope, \"Builder::init\", titleCase, \"() {\\n\",\n                unionDiscrim.set,\n                \"  return ::capnp::_::PointerHelpers<\", type, \">::init(\\n\"\n                \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS));\\n\"\n                \"}\\n\")"
          ],
          "line": 1651
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "COND",
          "args": [
            "!shouldTemplatizeInit",
            "templateContext.allDecls()",
            "\"inline \"",
            "builderType",
            "\" \"",
            "scope",
            "\"Builder::init\"",
            "titleCase",
            "\"() {\\n\"",
            "unionDiscrim.set",
            "\"  return ::capnp::_::PointerHelpers<\"",
            "type",
            "\">::init(\\n\"\n                \"      _builder.getPointerField(\"",
            "offset",
            "\" * ::capnp::POINTERS));\\n\"\n                \"}\\n\""
          ],
          "line": 1662
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1663
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "COND",
          "args": [
            "shouldTemplatizeInit",
            "templateContext.allDecls()",
            "\"template <typename T_>\\n\"\n                \"inline ::capnp::BuilderFor<T_> \"",
            "scope",
            "\"Builder::init\"",
            "titleCase",
            "\"As() {\\n\"",
            "\"  static_assert(::capnp::kind<T_>() == ::capnp::Kind::STRUCT,\\n\"\n                \"                \\\"\"",
            "proto.getName()",
            "\" must be a struct\\\");\\n\"",
            "unionDiscrim.set",
            "\"  return ::capnp::_::PointerHelpers<T_>::init(\\n\"\n                \"      _builder.getPointerField(\"",
            "offset",
            "\" * ::capnp::POINTERS));\\n\"\n                \"}\\n\""
          ],
          "line": 1652
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.getName",
          "args": [],
          "line": 1657
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1653
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "COND",
          "args": [
            "shouldIncludeArrayInitializer",
            "templateContext.allDecls()",
            "\"inline void \"",
            "scope",
            "\"Builder::set\"",
            "titleCase",
            "\"(::kj::ArrayPtr<const \"",
            "elementReaderType",
            "\"> value) {\\n\"",
            "unionDiscrim.set",
            "\"  ::capnp::_::PointerHelpers<\"",
            "type",
            "\">::set(\\n\"\n              \"      _builder.getPointerField(\"",
            "offset",
            "\" * ::capnp::POINTERS), value);\\n\"\n              \"}\\n\""
          ],
          "line": 1644
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1645
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1638
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "COND",
          "args": [
            "shouldIncludePipelineGetter",
            "\"#if !CAPNP_LITE\\n\"",
            "templateContext.allDecls()",
            "\"inline \"",
            "pipelineType",
            "\" \"",
            "scope",
            "\"Pipeline::get\"",
            "titleCase",
            "\"() {\\n\"",
            "\"  return \"",
            "pipelineType",
            "\"(_typeless.getPointerField(\"",
            "offset",
            "\"));\\n\"\n              \"}\\n\"\n              \"#endif  // !CAPNP_LITE\\n\""
          ],
          "line": 1631
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1633
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1625
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1619
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "COND",
          "args": [
            "shouldExcludeInLiteMode",
            "\"#if !CAPNP_LITE\\n\""
          ],
          "line": 1618
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1613
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1608
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "unionDiscrim.isDefs"
          ],
          "line": 1607
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "COND(shouldIncludePipelineGetter,\n              \"  inline \", pipelineType, \" get\", titleCase, \"();\\n\")"
          ],
          "line": 1602
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "COND",
          "args": [
            "shouldIncludePipelineGetter",
            "\"  inline \"",
            "pipelineType",
            "\" get\"",
            "titleCase",
            "\"();\\n\""
          ],
          "line": 1603
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "kj::mv(unionDiscrim.builderIsDecl)",
            "\"  inline bool has\"",
            "titleCase",
            "\"();\\n\"",
            "COND(shouldExcludeInLiteMode, \"#if !CAPNP_LITE\\n\")",
            "\"  inline \"",
            "builderType",
            "\" get\"",
            "titleCase",
            "\"();\\n\"\n            \"  inline void set\"",
            "titleCase",
            "\"(\"",
            "readerType",
            "\" value);\\n\"",
            "COND(shouldIncludeArrayInitializer,\n              \"  inline void set\", titleCase, \"(::kj::ArrayPtr<const \", elementReaderType, \"> value);\\n\")",
            "COND(shouldIncludeStructInit,\n              COND(shouldTemplatizeInit,\n                \"  template <typename T_>\\n\"\n                \"  inline ::capnp::BuilderFor<T_> init\", titleCase, \"As();\\n\"),\n              COND(!shouldTemplatizeInit,\n                \"  inline \", builderType, \" init\", titleCase, \"();\\n\"))",
            "COND(shouldIncludeSizedInit,\n              COND(shouldTemplatizeInit,\n                \"  template <typename T_>\\n\"\n                \"  inline ::capnp::BuilderFor<T_> init\", titleCase, \"As(unsigned int size);\\n\"),\n              COND(!shouldTemplatizeInit,\n                \"  inline \", builderType, \" init\", titleCase, \"(unsigned int size);\\n\"))",
            "\"  inline void adopt\"",
            "titleCase",
            "\"(::capnp::Orphan<\"",
            "type",
            "\">&& value);\\n\"\n            \"  inline ::capnp::Orphan<\"",
            "type",
            "\"> disown\"",
            "titleCase",
            "\"();\\n\"",
            "COND(shouldExcludeInLiteMode, \"#endif  // !CAPNP_LITE\\n\")",
            "\"\\n\""
          ],
          "line": 1577
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "COND",
          "args": [
            "shouldExcludeInLiteMode",
            "\"#endif  // !CAPNP_LITE\\n\""
          ],
          "line": 1599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "COND",
          "args": [
            "shouldIncludeSizedInit",
            "COND(shouldTemplatizeInit,\n                \"  template <typename T_>\\n\"\n                \"  inline ::capnp::BuilderFor<T_> init\", titleCase, \"As(unsigned int size);\\n\")",
            "COND(!shouldTemplatizeInit,\n                \"  inline \", builderType, \" init\", titleCase, \"(unsigned int size);\\n\")"
          ],
          "line": 1591
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "COND",
          "args": [
            "!shouldTemplatizeInit",
            "\"  inline \"",
            "builderType",
            "\" init\"",
            "titleCase",
            "\"(unsigned int size);\\n\""
          ],
          "line": 1595
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "COND",
          "args": [
            "shouldTemplatizeInit",
            "\"  template <typename T_>\\n\"\n                \"  inline ::capnp::BuilderFor<T_> init\"",
            "titleCase",
            "\"As(unsigned int size);\\n\""
          ],
          "line": 1592
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "COND",
          "args": [
            "shouldIncludeStructInit",
            "COND(shouldTemplatizeInit,\n                \"  template <typename T_>\\n\"\n                \"  inline ::capnp::BuilderFor<T_> init\", titleCase, \"As();\\n\")",
            "COND(!shouldTemplatizeInit,\n                \"  inline \", builderType, \" init\", titleCase, \"();\\n\")"
          ],
          "line": 1585
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "COND",
          "args": [
            "!shouldTemplatizeInit",
            "\"  inline \"",
            "builderType",
            "\" init\"",
            "titleCase",
            "\"();\\n\""
          ],
          "line": 1589
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "COND",
          "args": [
            "shouldTemplatizeInit",
            "\"  template <typename T_>\\n\"\n                \"  inline ::capnp::BuilderFor<T_> init\"",
            "titleCase",
            "\"As();\\n\""
          ],
          "line": 1586
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "COND",
          "args": [
            "shouldIncludeArrayInitializer",
            "\"  inline void set\"",
            "titleCase",
            "\"(::kj::ArrayPtr<const \"",
            "elementReaderType",
            "\"> value);\\n\""
          ],
          "line": 1583
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "COND",
          "args": [
            "shouldExcludeInLiteMode",
            "\"#if !CAPNP_LITE\\n\""
          ],
          "line": 1580
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "unionDiscrim.builderIsDecl"
          ],
          "line": 1578
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "kj::mv(unionDiscrim.readerIsDecl)",
            "\"  inline bool has\"",
            "titleCase",
            "\"() const;\\n\"",
            "COND(shouldExcludeInLiteMode, \"#if !CAPNP_LITE\\n\")",
            "\"  inline \"",
            "readerType",
            "\" get\"",
            "titleCase",
            "\"() const;\\n\"",
            "COND(shouldExcludeInLiteMode, \"#endif  // !CAPNP_LITE\\n\")",
            "\"\\n\""
          ],
          "line": 1569
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "COND",
          "args": [
            "shouldExcludeInLiteMode",
            "\"#endif  // !CAPNP_LITE\\n\""
          ],
          "line": 1574
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "COND",
          "args": [
            "shouldExcludeInLiteMode",
            "\"#if !CAPNP_LITE\\n\""
          ],
          "line": 1572
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "unionDiscrim.readerIsDecl"
          ],
          "line": 1570
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pipelineType.addMemberType",
          "args": [
            "\"Pipeline\""
          ],
          "line": 1563
        },
        "resolved": true,
        "details": {
          "function_name": "addMemberType",
          "container": "CppTypeName",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "206-211",
          "snippet": "void addMemberType(kj::StringPtr innerName) {\n    // Append \"::innerName\" to refer to a member.\n\n    name = kj::strTree(kj::mv(name), \"::\", innerName);\n    needsTypename = isArgDependent;\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName {\n  void addMemberType(kj::StringPtr innerName) {\n      // Append \"::innerName\" to refer to a member.\n  \n      name = kj::strTree(kj::mv(name), \"::\", innerName);\n      needsTypename = isArgDependent;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "pipelineType.addMemberTemplate",
          "args": [
            "\"PipelineFor\"",
            "kj::heapArray(&type, 1)"
          ],
          "line": 1556
        },
        "resolved": true,
        "details": {
          "function_name": "addMemberTemplate",
          "container": "CppTypeName",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "224-243",
          "snippet": "void addMemberTemplate(kj::StringPtr innerName, kj::Array<CppTypeName>&& params) {\n    // Append \"::innerName<params, ...>\".\n    //\n    // If necessary, add the \"template\" disambiguation keyword in front of `innerName`.\n\n    bool parentIsArgDependent = isArgDependent;\n    needsTypename = parentIsArgDependent;\n    hasDisambiguatedTemplate_ = hasDisambiguatedTemplate_ || parentIsArgDependent;\n\n    name = kj::strTree(kj::mv(name),\n        parentIsArgDependent ? \"::template \" : \"::\",\n        innerName, '<',\n        kj::StringTree(KJ_MAP(p, params) {\n          if (p.isArgDependent) isArgDependent = true;\n          if (p.hasInterfaces_) hasInterfaces_ = true;\n          if (p.hasDisambiguatedTemplate_) hasDisambiguatedTemplate_ = true;\n          return kj::strTree(kj::mv(p));\n        }, \", \"),\n        '>');\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName {\n  void addMemberTemplate(kj::StringPtr innerName, kj::Array<CppTypeName>&& params) {\n      // Append \"::innerName<params, ...>\".\n      //\n      // If necessary, add the \"template\" disambiguation keyword in front of `innerName`.\n  \n      bool parentIsArgDependent = isArgDependent;\n      needsTypename = parentIsArgDependent;\n      hasDisambiguatedTemplate_ = hasDisambiguatedTemplate_ || parentIsArgDependent;\n  \n      name = kj::strTree(kj::mv(name),\n          parentIsArgDependent ? \"::template \" : \"::\",\n          innerName, '<',\n          kj::StringTree(KJ_MAP(p, params) {\n            if (p.isArgDependent) isArgDependent = true;\n            if (p.hasInterfaces_) hasInterfaces_ = true;\n            if (p.hasDisambiguatedTemplate_) hasDisambiguatedTemplate_ = true;\n            return kj::strTree(kj::mv(p));\n          }, \", \"),\n          '>');\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::heapArray",
          "args": [
            "&type",
            "1"
          ],
          "line": 1556
        },
        "resolved": true,
        "details": {
          "function_name": "heapArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "688-693",
          "snippet": "Array<T>\nheapArray(Iterator begin, Iterator end) {\n  ArrayBuilder<T> builder = heapArrayBuilder<T>(end - begin);\n  builder.addAll(begin, end);\n  return builder.finish();\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\nArray<T>\nheapArray(Iterator begin, Iterator end) {\n  ArrayBuilder<T> builder = heapArrayBuilder<T>(end - begin);\n  builder.addAll(begin, end);\n  return builder.finish();\n}"
        }
      },
      {
        "call_info": {
          "callee": "CppTypeName::makeNamespace",
          "args": [
            "\"capnp\""
          ],
          "line": 1555
        },
        "resolved": true,
        "details": {
          "function_name": "makeNamespace",
          "container": "CppTypeName",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "194-196",
          "snippet": "static CppTypeName makeNamespace(kj::StringPtr name) {\n    return CppTypeName(kj::strTree(\" ::\", name), false);\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName {\n  static CppTypeName makeNamespace(kj::StringPtr name) {\n      return CppTypeName(kj::strTree(\" ::\", name), false);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "typeName",
          "args": [
            "elementType",
            "nullptr"
          ],
          "line": 1537
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elementType.getBrandParameter",
          "args": [],
          "line": 1525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elementType.which",
          "args": [],
          "line": 1498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typeSchema.asList",
          "args": [],
          "line": 1497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typeSchema.asList",
          "args": [],
          "line": 1497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typeSchema.isList",
          "args": [],
          "line": 1494
        },
        "resolved": true,
        "details": {
          "function_name": "isList",
          "container": "AnyPointer::Builder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "145-147",
          "snippet": "inline bool isList() {\n      return builder.isList();\n    }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nAnyPointer {\n  Builder {\n    inline bool isList() {\n          return builder.isList();\n        }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "typeSchema.which",
          "args": [],
          "line": 1490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.hasInterfaces",
          "args": [],
          "line": 1489
        },
        "resolved": true,
        "details": {
          "function_name": "hasInterfaces",
          "container": "CppTypeName",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "249-251",
          "snippet": "bool hasInterfaces() {\n    return hasInterfaces_;\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName {\n  bool hasInterfaces() {\n      return hasInterfaces_;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "hasDiscriminantValue",
          "args": [
            "proto"
          ],
          "line": 1486
        },
        "resolved": true,
        "details": {
          "function_name": "hasDiscriminantValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "63-65",
          "snippet": "bool hasDiscriminantValue(const schema::Field::Reader& reader) {\n  return reader.getDiscriminantValue() != schema::Field::NO_DISCRIMINANT;\n}",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nbool hasDiscriminantValue(const schema::Field::Reader& reader) {\n  return reader.getDiscriminantValue() != schema::Field::NO_DISCRIMINANT;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "\",\\n        ::capnp::schemas::bp_\"",
            "kj::hex(typeId)",
            "\" + \"",
            "defaultOffset",
            "defaultSize == 0 ? kj::strTree() : kj::strTree(\", \", defaultSize)"
          ],
          "line": 1478
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\", \"",
            "defaultSize"
          ],
          "line": 1480
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [],
          "line": 1480
        },
        "resolved": true,
        "details": {
          "function_name": "strTree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
          "lines": "206-208",
          "snippet": "StringTree strTree(Params&&... params) {\n  return StringTree::concat(_::toStringTreeOrCharSequence(kj::fwd<Params>(params))...);\n}",
          "includes": [
            "#include \"string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"string.h\"\n\nStringTree strTree(Params&&... params) {\n  return StringTree::concat(_::toStringTreeOrCharSequence(kj::fwd<Params>(params))...);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::hex",
          "args": [
            "typeId"
          ],
          "line": 1479
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [],
          "line": 1478
        },
        "resolved": true,
        "details": {
          "function_name": "str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "331-339",
          "snippet": "String str(Params&&... params) {\n  // Magic function which builds a string from a bunch of arbitrary values.  Example:\n  //     str(1, \" / \", 2, \" = \", 0.5)\n  // returns:\n  //     \"1 / 2 = 0.5\"\n  // To teach `str` how to stringify a type, see `Stringifier`.\n\n  return _::concat(toCharSequence(kj::fwd<Params>(params))...);\n}",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\nString str(Params&&... params) {\n  // Magic function which builds a string from a bunch of arbitrary values.  Example:\n  //     str(1, \" / \", 2, \" = \", 0.5)\n  // returns:\n  //     \"1 / 2 = 0.5\"\n  // To teach `str` how to stringify a type, see `Stringifier`.\n\n  return _::concat(toCharSequence(kj::fwd<Params>(params))...);\n}"
        }
      },
      {
        "call_info": {
          "callee": "field.getContainingStruct",
          "args": [],
          "line": 1477
        },
        "resolved": true,
        "details": {
          "function_name": "getContainingStruct",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "274-274",
          "snippet": "inline StructSchema getContainingStruct() const { return parent; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline StructSchema getContainingStruct() const { return parent; }"
        }
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "kj::mv(unionDiscrim.isDefs)",
            "templateContext.allDecls()",
            "\"inline bool \"",
            "scope",
            "\"Reader::has\"",
            "titleCase",
            "\"() const {\\n\"",
            "unionDiscrim.has",
            "\"  return !_reader.getPointerField(\"",
            "offset",
            "\" * ::capnp::POINTERS).isNull();\\n\"\n            \"}\\n\"",
            "templateContext.allDecls()",
            "\"inline bool \"",
            "scope",
            "\"Builder::has\"",
            "titleCase",
            "\"() {\\n\"",
            "unionDiscrim.has",
            "\"  return !_builder.getPointerField(\"",
            "offset",
            "\" * ::capnp::POINTERS).isNull();\\n\"\n            \"}\\n\"",
            "templateContext.allDecls()",
            "\"inline ::capnp::AnyPointer::Reader \"",
            "scope",
            "\"Reader::get\"",
            "titleCase",
            "\"() const {\\n\"",
            "unionDiscrim.check",
            "\"  return ::capnp::AnyPointer::Reader(\\n\"\n            \"      _reader.getPointerField(\"",
            "offset",
            "\" * ::capnp::POINTERS));\\n\"\n            \"}\\n\"",
            "templateContext.allDecls()",
            "\"inline ::capnp::AnyPointer::Builder \"",
            "scope",
            "\"Builder::get\"",
            "titleCase",
            "\"() {\\n\"",
            "unionDiscrim.check",
            "\"  return ::capnp::AnyPointer::Builder(\\n\"\n            \"      _builder.getPointerField(\"",
            "offset",
            "\" * ::capnp::POINTERS));\\n\"\n            \"}\\n\"",
            "templateContext.allDecls()",
            "\"inline ::capnp::AnyPointer::Builder \"",
            "scope",
            "\"Builder::init\"",
            "titleCase",
            "\"() {\\n\"",
            "unionDiscrim.set",
            "\"  auto result = ::capnp::AnyPointer::Builder(\\n\"\n            \"      _builder.getPointerField(\"",
            "offset",
            "\" * ::capnp::POINTERS));\\n\"\n            \"  result.clear();\\n\"\n            \"  return result;\\n\"\n            \"}\\n\"\n            \"\\n\""
          ],
          "line": 1439
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1463
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1457
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1446
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1441
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "unionDiscrim.isDefs"
          ],
          "line": 1440
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "kj::mv(unionDiscrim.builderIsDecl)",
            "\"  inline bool has\"",
            "titleCase",
            "\"();\\n\"\n            \"  inline ::capnp::AnyPointer::Builder get\"",
            "titleCase",
            "\"();\\n\"\n            \"  inline ::capnp::AnyPointer::Builder init\"",
            "titleCase",
            "\"();\\n\"\n            \"\\n\""
          ],
          "line": 1430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "unionDiscrim.builderIsDecl"
          ],
          "line": 1431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "kj::mv(unionDiscrim.readerIsDecl)",
            "\"  inline bool has\"",
            "titleCase",
            "\"() const;\\n\"\n            \"  inline ::capnp::AnyPointer::Reader get\"",
            "titleCase",
            "\"() const;\\n\"\n            \"\\n\""
          ],
          "line": 1424
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "unionDiscrim.readerIsDecl"
          ],
          "line": 1425
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "kj::mv(unionDiscrim.isDefs)",
            "templateContext.allDecls()",
            "\"inline bool \"",
            "scope",
            "\"Reader::has\"",
            "titleCase",
            "\"() const {\\n\"",
            "unionDiscrim.has",
            "\"  return !_reader.getPointerField(\"",
            "offset",
            "\" * ::capnp::POINTERS).isNull();\\n\"\n            \"}\\n\"",
            "templateContext.allDecls()",
            "\"inline bool \"",
            "scope",
            "\"Builder::has\"",
            "titleCase",
            "\"() {\\n\"",
            "unionDiscrim.has",
            "\"  return !_builder.getPointerField(\"",
            "offset",
            "\" * ::capnp::POINTERS).isNull();\\n\"\n            \"}\\n\"\n            \"#if !CAPNP_LITE\\n\"",
            "templateContext.allDecls()",
            "\"inline \"",
            "clientType",
            "\" \"",
            "scope",
            "\"Reader::get\"",
            "titleCase",
            "\"() const {\\n\"",
            "unionDiscrim.check",
            "\"  return ::capnp::_::PointerHelpers<\"",
            "type",
            "\">::get(\\n\"\n            \"      _reader.getPointerField(\"",
            "offset",
            "\" * ::capnp::POINTERS));\\n\"\n            \"}\\n\"",
            "templateContext.allDecls()",
            "\"inline \"",
            "clientType",
            "\" \"",
            "scope",
            "\"Builder::get\"",
            "titleCase",
            "\"() {\\n\"",
            "unionDiscrim.check",
            "\"  return ::capnp::_::PointerHelpers<\"",
            "type",
            "\">::get(\\n\"\n            \"      _builder.getPointerField(\"",
            "offset",
            "\" * ::capnp::POINTERS));\\n\"\n            \"}\\n\"",
            "hasDiscriminantValue(proto) ? kj::strTree() : kj::strTree(\n              templateContext.allDecls(),\n              \"inline \", clientType, \" \", scope, \"Pipeline::get\", titleCase, \"() {\\n\",\n              \"  return \", clientType, \"(_typeless.getPointerField(\", offset, \").asCap());\\n\"\n              \"}\\n\")",
            "templateContext.allDecls()",
            "\"inline void \"",
            "scope",
            "\"Builder::set\"",
            "titleCase",
            "\"(\"",
            "clientType",
            "\"&& cap) {\\n\"",
            "unionDiscrim.set",
            "\"  ::capnp::_::PointerHelpers<\"",
            "type",
            "\">::set(\\n\"\n            \"      _builder.getPointerField(\"",
            "offset",
            "\" * ::capnp::POINTERS), kj::mv(cap));\\n\"\n            \"}\\n\"",
            "templateContext.allDecls()",
            "\"inline void \"",
            "scope",
            "\"Builder::set\"",
            "titleCase",
            "\"(\"",
            "clientType",
            "\"& cap) {\\n\"",
            "unionDiscrim.set",
            "\"  ::capnp::_::PointerHelpers<\"",
            "type",
            "\">::set(\\n\"\n            \"      _builder.getPointerField(\"",
            "offset",
            "\" * ::capnp::POINTERS), cap);\\n\"\n            \"}\\n\"",
            "templateContext.allDecls()",
            "\"inline void \"",
            "scope",
            "\"Builder::adopt\"",
            "titleCase",
            "\"(\\n\"\n            \"    ::capnp::Orphan<\"",
            "type",
            "\">&& value) {\\n\"",
            "unionDiscrim.set",
            "\"  ::capnp::_::PointerHelpers<\"",
            "type",
            "\">::adopt(\\n\"\n            \"      _builder.getPointerField(\"",
            "offset",
            "\" * ::capnp::POINTERS), kj::mv(value));\\n\"\n            \"}\\n\"",
            "templateContext.allDecls()",
            "\"inline ::capnp::Orphan<\"",
            "type",
            "\"> \"",
            "scope",
            "\"Builder::disown\"",
            "titleCase",
            "\"() {\\n\"",
            "unionDiscrim.check",
            "\"  return ::capnp::_::PointerHelpers<\"",
            "type",
            "\">::disown(\\n\"\n            \"      _builder.getPointerField(\"",
            "offset",
            "\" * ::capnp::POINTERS));\\n\"\n            \"}\\n\"\n            \"#endif  // !CAPNP_LITE\\n\"\n            \"\\n\""
          ],
          "line": 1363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1405
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1393
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "templateContext.allDecls()",
            "\"inline \"",
            "clientType",
            "\" \"",
            "scope",
            "\"Pipeline::get\"",
            "titleCase",
            "\"() {\\n\"",
            "\"  return \"",
            "clientType",
            "\"(_typeless.getPointerField(\"",
            "offset",
            "\").asCap());\\n\"\n              \"}\\n\""
          ],
          "line": 1388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "unionDiscrim.isDefs"
          ],
          "line": 1364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "hasDiscriminantValue(proto) ? kj::strTree() : kj::strTree(\n              \"  inline \", clientType, \" get\", titleCase, \"();\\n\")"
          ],
          "line": 1359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"  inline \"",
            "clientType",
            "\" get\"",
            "titleCase",
            "\"();\\n\""
          ],
          "line": 1360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "kj::mv(unionDiscrim.builderIsDecl)",
            "\"  inline bool has\"",
            "titleCase",
            "\"();\\n\"\n            \"#if !CAPNP_LITE\\n\"\n            \"  inline \"",
            "clientType",
            "\" get\"",
            "titleCase",
            "\"();\\n\"\n            \"  inline void set\"",
            "titleCase",
            "\"(\"",
            "clientType",
            "\"&& value);\\n\"",
            "\"  inline void set\"",
            "titleCase",
            "\"(\"",
            "clientType",
            "\"& value);\\n\"",
            "\"  inline void adopt\"",
            "titleCase",
            "\"(::capnp::Orphan<\"",
            "type",
            "\">&& value);\\n\"\n            \"  inline ::capnp::Orphan<\"",
            "type",
            "\"> disown\"",
            "titleCase",
            "\"();\\n\"\n            \"#endif  // !CAPNP_LITE\\n\"\n            \"\\n\""
          ],
          "line": 1347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "unionDiscrim.builderIsDecl"
          ],
          "line": 1348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CAPNP_LITE\\n\"\n            \"  inline \", clientType, \" get\", titleCase, \"",
          "args": [],
          "line": 1342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FieldText {\n        kj::strTree",
          "args": [
            "\"Client\""
          ],
          "line": 1296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ";\n\n    } else if",
          "args": [
            "kind == FieldKind::INTERFACE"
          ],
          "line": 1296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "kj::mv(unionDiscrim.isDefs)",
            "templateContext.allDecls()",
            "\"inline \"",
            "type",
            "\" \"",
            "scope",
            "\"Reader::get\"",
            "titleCase",
            "\"() const {\\n\"",
            "unionDiscrim.check",
            "\"  return _reader.getDataField<\"",
            "type",
            "\">(\\n\"\n            \"      \"",
            "offset",
            "\" * ::capnp::ELEMENTS\"",
            "defaultMaskParam",
            "\");\\n\"",
            "\"}\\n\"\n            \"\\n\"",
            "templateContext.allDecls()",
            "\"inline \"",
            "type",
            "\" \"",
            "scope",
            "\"Builder::get\"",
            "titleCase",
            "\"() {\\n\"",
            "unionDiscrim.check",
            "\"  return _builder.getDataField<\"",
            "type",
            "\">(\\n\"\n            \"      \"",
            "offset",
            "\" * ::capnp::ELEMENTS\"",
            "defaultMaskParam",
            "\");\\n\"",
            "\"}\\n\"",
            "templateContext.allDecls()",
            "\"inline void \"",
            "scope",
            "\"Builder::set\"",
            "titleCase",
            "\"(\"",
            "type",
            "\" value) {\\n\"",
            "unionDiscrim.set",
            "\"  _builder.setDataField<\"",
            "type",
            "\">(\\n\"\n            \"      \"",
            "offset",
            "\" * ::capnp::ELEMENTS, value\"",
            "defaultMaskParam",
            "\");\\n\"",
            "\"}\\n\"\n            \"\\n\""
          ],
          "line": 1310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1325
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "unionDiscrim.isDefs"
          ],
          "line": 1311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "kj::mv(unionDiscrim.builderIsDecl)",
            "\"  inline \"",
            "type",
            "\" get\"",
            "titleCase",
            "\"();\\n\"\n            \"  inline void set\"",
            "titleCase",
            "\"(\"",
            "type",
            "\" value\"",
            "setterDefault",
            "\");\\n\"\n            \"\\n\""
          ],
          "line": 1302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "unionDiscrim.builderIsDecl"
          ],
          "line": 1303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "kj::mv(unionDiscrim.readerIsDecl)",
            "\"  inline \"",
            "type",
            "\" get\"",
            "titleCase",
            "\"() const;\\n\"\n            \"\\n\""
          ],
          "line": 1297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "unionDiscrim.readerIsDecl"
          ],
          "line": 1298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ";\n\n    if",
          "args": [
            "kind == FieldKind::PRIMITIVE"
          ],
          "line": 1293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 1293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "\", \"",
            "defaultMask"
          ],
          "line": 1290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::String",
          "args": [
            "defaultMask.size() > 0"
          ],
          "line": 1288
        },
        "resolved": true,
        "details": {
          "function_name": "String",
          "container": "String",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "137-137",
          "snippet": "inline String(decltype(nullptr)): content(nullptr) {}",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\nString {\n  inline String(decltype(nullptr)): content(nullptr) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "defaultMask.size",
          "args": [],
          "line": 1289
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-capnp.c++",
          "lines": "74-74",
          "snippet": "inline size_t size() const { return amount; }",
          "includes": [
            "#include \"config.h\"",
            "#include <map>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <map>\n#include <algorithm>\n#include <kj/main.h>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nIndent {\n  inline size_t size() const { return amount; }\n}"
        }
      },
      {
        "call_info": {
          "callee": ";\n          switch",
          "args": [
            "typeSchema.whichAnyPointerKind()"
          ],
          "line": 1269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typeSchema.whichAnyPointerKind",
          "args": [],
          "line": 1270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ";\n        }\n        if",
          "args": [
            "typeSchema.getBrandParameter() != nullptr"
          ],
          "line": 1264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typeSchema.getBrandParameter",
          "args": [],
          "line": 1266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getDefaultValueSchemaOffset",
          "args": [],
          "line": 1264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema::Type::ANY_POINTER",
          "args": [
            "defaultBody.hasAnyPointer()"
          ],
          "line": 1262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "defaultBody.hasAnyPointer",
          "args": [],
          "line": 1263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getDefaultValueSchemaOffset",
          "args": [],
          "line": 1256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ";\n        if",
          "args": [
            "defaultBody.hasList()"
          ],
          "line": 1254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "defaultBody.hasList",
          "args": [],
          "line": 1255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getDefaultValueSchemaOffset",
          "args": [],
          "line": 1250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ";\n        if",
          "args": [
            "defaultBody.hasStruct()"
          ],
          "line": 1248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "defaultBody.hasStruct",
          "args": [],
          "line": 1249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "defaultBody.getEnum()",
            "\"u\""
          ],
          "line": 1243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "defaultBody.getEnum",
          "args": [],
          "line": 1243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ";\n        if",
          "args": [
            "defaultBody.getEnum() != 0"
          ],
          "line": 1241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "defaultBody.getEnum",
          "args": [],
          "line": 1242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "defaultBody.getData",
          "args": [],
          "line": 1236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "defaultBody.getData",
          "args": [],
          "line": 1236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getDefaultValueSchemaOffset",
          "args": [],
          "line": 1235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ";\n        if",
          "args": [
            "defaultBody.hasData()"
          ],
          "line": 1233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "defaultBody.hasData",
          "args": [],
          "line": 1234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "defaultBody.getText",
          "args": [],
          "line": 1229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "defaultBody.getText",
          "args": [],
          "line": 1229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getDefaultValueSchemaOffset",
          "args": [],
          "line": 1228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ";\n        if",
          "args": [
            "defaultBody.hasText()"
          ],
          "line": 1226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "defaultBody.hasText",
          "args": [],
          "line": 1227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "mask",
            "\"ull\""
          ],
          "line": 1221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "defaultBody.getFloat64",
          "args": [],
          "line": 1218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FieldKind::PRIMITIVE",
          "args": [
            "defaultBody.getFloat64() != 0"
          ],
          "line": 1215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "defaultBody.getFloat64",
          "args": [],
          "line": 1216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "defaultBody.getFloat32",
          "args": [],
          "line": 1207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FieldKind::PRIMITIVE",
          "args": [
            "defaultBody.getFloat32() != 0"
          ],
          "line": 1204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "defaultBody.getFloat32",
          "args": [],
          "line": 1205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typeSchema.which",
          "args": [],
          "line": 1178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slot.getDefaultValue",
          "args": [],
          "line": 1177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typeName",
          "args": [
            "typeSchema",
            "nullptr"
          ],
          "line": 1171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.getSlot",
          "args": [],
          "line": 1167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "kj::mv(unionDiscrim.isDefs)",
            "templateContext.allDecls()",
            "\"inline \"",
            "scope",
            "titleCase",
            "\"::Reader \"",
            "scope",
            "\"Reader::get\"",
            "titleCase",
            "\"() const {\\n\"",
            "unionDiscrim.check",
            "\"  return \"",
            "scope",
            "titleCase",
            "\"::Reader(_reader);\\n\"\n                \"}\\n\"",
            "templateContext.allDecls()",
            "\"inline \"",
            "scope",
            "titleCase",
            "\"::Builder \"",
            "scope",
            "\"Builder::get\"",
            "titleCase",
            "\"() {\\n\"",
            "unionDiscrim.check",
            "\"  return \"",
            "scope",
            "titleCase",
            "\"::Builder(_builder);\\n\"\n                \"}\\n\"",
            "hasDiscriminantValue(proto) ? kj::strTree() : kj::strTree(\n                  \"#if !CAPNP_LITE\\n\",\n                  templateContext.allDecls(),\n                  \"inline \", scope, titleCase, \"::Pipeline \", scope, \"Pipeline::get\", titleCase, \"() {\\n\",\n                  \"  return \", scope, titleCase, \"::Pipeline(_typeless.noop());\\n\"\n                  \"}\\n\"\n                  \"#endif  // !CAPNP_LITE\\n\")",
            "templateContext.allDecls()",
            "\"inline \"",
            "scope",
            "titleCase",
            "\"::Builder \"",
            "scope",
            "\"Builder::init\"",
            "titleCase",
            "\"() {\\n\"",
            "unionDiscrim.set",
            "KJ_MAP(slot, slots){\n                  switch (sectionFor(slot.whichType)) {\n                    case Section::NONE:\n                      return kj::strTree();\n                    case Section::DATA:\n                      return kj::strTree(\n                          \"  _builder.setDataField<\", maskType(slot.whichType), \">(\",\n                              slot.offset, \" * ::capnp::ELEMENTS, 0);\\n\");\n                    case Section::POINTERS:\n                      return kj::strTree(\n                          \"  _builder.getPointerField(\", slot.offset,\n                              \" * ::capnp::POINTERS).clear();\\n\");\n                  }\n                  KJ_UNREACHABLE;\n                }",
            "\"  return \"",
            "scope",
            "titleCase",
            "\"::Builder(_builder);\\n\"\n                \"}\\n\""
          ],
          "line": 1124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"  _builder.getPointerField(\"",
            "slot.offset",
            "\" * ::capnp::POINTERS).clear();\\n\""
          ],
          "line": 1155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"  _builder.setDataField<\"",
            "maskType(slot.whichType)",
            "\">(\"",
            "slot.offset",
            "\" * ::capnp::ELEMENTS, 0);\\n\""
          ],
          "line": 1151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "maskType",
          "args": [
            "slot.whichType"
          ],
          "line": 1152
        },
        "resolved": true,
        "details": {
          "function_name": "maskType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "886-911",
          "snippet": "static kj::StringPtr maskType(schema::Type::Which whichType) {\n    switch (whichType) {\n      case schema::Type::BOOL: return \"bool\";\n      case schema::Type::INT8: return \" ::uint8_t\";\n      case schema::Type::INT16: return \" ::uint16_t\";\n      case schema::Type::INT32: return \" ::uint32_t\";\n      case schema::Type::INT64: return \" ::uint64_t\";\n      case schema::Type::UINT8: return \" ::uint8_t\";\n      case schema::Type::UINT16: return \" ::uint16_t\";\n      case schema::Type::UINT32: return \" ::uint32_t\";\n      case schema::Type::UINT64: return \" ::uint64_t\";\n      case schema::Type::FLOAT32: return \" ::uint32_t\";\n      case schema::Type::FLOAT64: return \" ::uint64_t\";\n      case schema::Type::ENUM: return \" ::uint16_t\";\n\n      case schema::Type::VOID:\n      case schema::Type::TEXT:\n      case schema::Type::DATA:\n      case schema::Type::LIST:\n      case schema::Type::STRUCT:\n      case schema::Type::INTERFACE:\n      case schema::Type::ANY_POINTER:\n        KJ_FAIL_REQUIRE(\"Should only be called for data types.\");\n    }\n    KJ_UNREACHABLE;\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nstatic kj::StringPtr maskType(schema::Type::Which whichType) {\n    switch (whichType) {\n      case schema::Type::BOOL: return \"bool\";\n      case schema::Type::INT8: return \" ::uint8_t\";\n      case schema::Type::INT16: return \" ::uint16_t\";\n      case schema::Type::INT32: return \" ::uint32_t\";\n      case schema::Type::INT64: return \" ::uint64_t\";\n      case schema::Type::UINT8: return \" ::uint8_t\";\n      case schema::Type::UINT16: return \" ::uint16_t\";\n      case schema::Type::UINT32: return \" ::uint32_t\";\n      case schema::Type::UINT64: return \" ::uint64_t\";\n      case schema::Type::FLOAT32: return \" ::uint32_t\";\n      case schema::Type::FLOAT64: return \" ::uint64_t\";\n      case schema::Type::ENUM: return \" ::uint16_t\";\n\n      case schema::Type::VOID:\n      case schema::Type::TEXT:\n      case schema::Type::DATA:\n      case schema::Type::LIST:\n      case schema::Type::STRUCT:\n      case schema::Type::INTERFACE:\n      case schema::Type::ANY_POINTER:\n        KJ_FAIL_REQUIRE(\"Should only be called for data types.\");\n    }\n    KJ_UNREACHABLE;\n  }"
        }
      },
      {
        "call_info": {
          "callee": "sectionFor",
          "args": [
            "slot.whichType"
          ],
          "line": 1147
        },
        "resolved": true,
        "details": {
          "function_name": "sectionFor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "858-884",
          "snippet": "static Section sectionFor(schema::Type::Which whichType) {\n    switch (whichType) {\n      case schema::Type::VOID:\n        return Section::NONE;\n      case schema::Type::BOOL:\n      case schema::Type::INT8:\n      case schema::Type::INT16:\n      case schema::Type::INT32:\n      case schema::Type::INT64:\n      case schema::Type::UINT8:\n      case schema::Type::UINT16:\n      case schema::Type::UINT32:\n      case schema::Type::UINT64:\n      case schema::Type::FLOAT32:\n      case schema::Type::FLOAT64:\n      case schema::Type::ENUM:\n        return Section::DATA;\n      case schema::Type::TEXT:\n      case schema::Type::DATA:\n      case schema::Type::LIST:\n      case schema::Type::STRUCT:\n      case schema::Type::INTERFACE:\n      case schema::Type::ANY_POINTER:\n        return Section::POINTERS;\n    }\n    KJ_UNREACHABLE;\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nstatic Section sectionFor(schema::Type::Which whichType) {\n    switch (whichType) {\n      case schema::Type::VOID:\n        return Section::NONE;\n      case schema::Type::BOOL:\n      case schema::Type::INT8:\n      case schema::Type::INT16:\n      case schema::Type::INT32:\n      case schema::Type::INT64:\n      case schema::Type::UINT8:\n      case schema::Type::UINT16:\n      case schema::Type::UINT32:\n      case schema::Type::UINT64:\n      case schema::Type::FLOAT32:\n      case schema::Type::FLOAT64:\n      case schema::Type::ENUM:\n        return Section::DATA;\n      case schema::Type::TEXT:\n      case schema::Type::DATA:\n      case schema::Type::LIST:\n      case schema::Type::STRUCT:\n      case schema::Type::INTERFACE:\n      case schema::Type::ANY_POINTER:\n        return Section::POINTERS;\n    }\n    KJ_UNREACHABLE;\n  }"
        }
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "slot",
            "slots"
          ],
          "line": 1146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"#if !CAPNP_LITE\\n\"",
            "templateContext.allDecls()",
            "\"inline \"",
            "scope",
            "titleCase",
            "\"::Pipeline \"",
            "scope",
            "\"Pipeline::get\"",
            "titleCase",
            "\"() {\\n\"",
            "\"  return \"",
            "scope",
            "titleCase",
            "\"::Pipeline(_typeless.noop());\\n\"\n                  \"}\\n\"\n                  \"#endif  // !CAPNP_LITE\\n\""
          ],
          "line": 1136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "unionDiscrim.isDefs"
          ],
          "line": 1125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"  inline \"",
            "titleCase",
            "\"::Pipeline get\"",
            "titleCase",
            "\"();\\n\""
          ],
          "line": 1122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "kj::mv(unionDiscrim.builderIsDecl)",
            "\"  inline \"",
            "titleCase",
            "\"::Builder get\"",
            "titleCase",
            "\"();\\n\"\n                \"  inline \"",
            "titleCase",
            "\"::Builder init\"",
            "titleCase",
            "\"();\\n\"\n                \"\\n\""
          ],
          "line": 1115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "unionDiscrim.builderIsDecl"
          ],
          "line": 1116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "kj::mv(unionDiscrim.readerIsDecl)",
            "\"  inline \"",
            "titleCase",
            "\"::Reader get\"",
            "titleCase",
            "\"() const;\\n\"\n                \"\\n\""
          ],
          "line": 1110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "unionDiscrim.readerIsDecl"
          ],
          "line": 1111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getSortedSlots",
          "args": [
            "field.getType().asStruct()"
          ],
          "line": 1108
        },
        "resolved": true,
        "details": {
          "function_name": "getSortedSlots",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "992-1024",
          "snippet": "kj::Array<Slot> getSortedSlots(StructSchema schema) {\n    // Get a representation of all of the field locations owned by this schema, e.g. so that they\n    // can be zero'd out.\n\n    kj::Vector<Slot> slots(schema.getFields().size());\n    getSlots(schema, slots);\n    std::sort(slots.begin(), slots.end());\n\n    kj::Vector<Slot> result(slots.size());\n\n    // All void slots are redundant, and they sort towards the front of the list.  By starting out\n    // with `prevSlot` = void, we will end up skipping them all, which is what we want.\n    Slot prevSlot = { schema::Type::VOID, 0 };\n    for (auto slot: slots) {\n      if (prevSlot.isSupersetOf(slot)) {\n        // This slot is redundant as prevSlot is a superset of it.\n        continue;\n      }\n\n      // Since all sizes are power-of-two, if two slots overlap at all, one must be a superset of\n      // the other.  Since we sort slots by starting position, we know that the only way `slot`\n      // could be a superset of `prevSlot` is if they have the same starting position.  However,\n      // since we sort slots with the same starting position by descending size, this is not\n      // possible.\n      KJ_DASSERT(!slot.isSupersetOf(prevSlot));\n\n      result.add(slot);\n\n      prevSlot = slot;\n    }\n\n    return result.releaseAsArray();\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::Array<Slot> getSortedSlots(StructSchema schema) {\n    // Get a representation of all of the field locations owned by this schema, e.g. so that they\n    // can be zero'd out.\n\n    kj::Vector<Slot> slots(schema.getFields().size());\n    getSlots(schema, slots);\n    std::sort(slots.begin(), slots.end());\n\n    kj::Vector<Slot> result(slots.size());\n\n    // All void slots are redundant, and they sort towards the front of the list.  By starting out\n    // with `prevSlot` = void, we will end up skipping them all, which is what we want.\n    Slot prevSlot = { schema::Type::VOID, 0 };\n    for (auto slot: slots) {\n      if (prevSlot.isSupersetOf(slot)) {\n        // This slot is redundant as prevSlot is a superset of it.\n        continue;\n      }\n\n      // Since all sizes are power-of-two, if two slots overlap at all, one must be a superset of\n      // the other.  Since we sort slots by starting position, we know that the only way `slot`\n      // could be a superset of `prevSlot` is if they have the same starting position.  However,\n      // since we sort slots with the same starting position by descending size, this is not\n      // possible.\n      KJ_DASSERT(!slot.isSupersetOf(prevSlot));\n\n      result.add(slot);\n\n      prevSlot = slot;\n    }\n\n    return result.releaseAsArray();\n  }"
        }
      },
      {
        "call_info": {
          "callee": "field.getType",
          "args": [],
          "line": 1108
        },
        "resolved": true,
        "details": {
          "function_name": "getType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "942-942",
          "snippet": "inline DynamicValue::Type getType() { return type; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline DynamicValue::Type getType() { return type; }"
        }
      },
      {
        "call_info": {
          "callee": "proto.which",
          "args": [],
          "line": 1102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "makeDiscriminantChecks",
          "args": [
            "scope",
            "baseName",
            "field.getContainingStruct()",
            "templateContext"
          ],
          "line": 1098
        },
        "resolved": true,
        "details": {
          "function_name": "makeDiscriminantChecks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "1037-1068",
          "snippet": "DiscriminantChecks makeDiscriminantChecks(kj::StringPtr scope,\n                                            kj::StringPtr memberName,\n                                            StructSchema containingStruct,\n                                            const TemplateContext& templateContext) {\n    auto discrimOffset = containingStruct.getProto().getStruct().getDiscriminantOffset();\n\n    kj::String titleCase = toTitleCase(memberName);\n    kj::String upperCase = toUpperCase(memberName);\n\n    return DiscriminantChecks {\n        kj::str(\n            \"  if (which() != \", scope, upperCase, \") return false;\\n\"),\n        kj::str(\n            \"  KJ_IREQUIRE(which() == \", scope, upperCase, \",\\n\"\n            \"              \\\"Must check which() before get()ing a union member.\\\");\\n\"),\n        kj::str(\n            \"  _builder.setDataField<\", scope, \"Which>(\\n\"\n            \"      \", discrimOffset, \" * ::capnp::ELEMENTS, \",\n                      scope, upperCase, \");\\n\"),\n        kj::strTree(\"  inline bool is\", titleCase, \"() const;\\n\"),\n        kj::strTree(\"  inline bool is\", titleCase, \"();\\n\"),\n        kj::strTree(\n            templateContext.allDecls(),\n            \"inline bool \", scope, \"Reader::is\", titleCase, \"() const {\\n\"\n            \"  return which() == \", scope, upperCase, \";\\n\"\n            \"}\\n\",\n            templateContext.allDecls(),\n            \"inline bool \", scope, \"Builder::is\", titleCase, \"() {\\n\"\n            \"  return which() == \", scope, upperCase, \";\\n\"\n            \"}\\n\")\n    };\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nDiscriminantChecks makeDiscriminantChecks(kj::StringPtr scope,\n                                            kj::StringPtr memberName,\n                                            StructSchema containingStruct,\n                                            const TemplateContext& templateContext) {\n    auto discrimOffset = containingStruct.getProto().getStruct().getDiscriminantOffset();\n\n    kj::String titleCase = toTitleCase(memberName);\n    kj::String upperCase = toUpperCase(memberName);\n\n    return DiscriminantChecks {\n        kj::str(\n            \"  if (which() != \", scope, upperCase, \") return false;\\n\"),\n        kj::str(\n            \"  KJ_IREQUIRE(which() == \", scope, upperCase, \",\\n\"\n            \"              \\\"Must check which() before get()ing a union member.\\\");\\n\"),\n        kj::str(\n            \"  _builder.setDataField<\", scope, \"Which>(\\n\"\n            \"      \", discrimOffset, \" * ::capnp::ELEMENTS, \",\n                      scope, upperCase, \");\\n\"),\n        kj::strTree(\"  inline bool is\", titleCase, \"() const;\\n\"),\n        kj::strTree(\"  inline bool is\", titleCase, \"();\\n\"),\n        kj::strTree(\n            templateContext.allDecls(),\n            \"inline bool \", scope, \"Reader::is\", titleCase, \"() const {\\n\"\n            \"  return which() == \", scope, upperCase, \";\\n\"\n            \"}\\n\",\n            templateContext.allDecls(),\n            \"inline bool \", scope, \"Builder::is\", titleCase, \"() {\\n\"\n            \"  return which() == \", scope, upperCase, \";\\n\"\n            \"}\\n\")\n    };\n  }"
        }
      },
      {
        "call_info": {
          "callee": "toTitleCase",
          "args": [
            "baseName"
          ],
          "line": 1094
        },
        "resolved": true,
        "details": {
          "function_name": "toTitleCase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "423-429",
          "snippet": "kj::String toTitleCase(kj::StringPtr name) {\n    kj::String result = kj::heapString(name);\n    if ('a' <= result[0] && result[0] <= 'z') {\n      result[0] = result[0] - 'a' + 'A';\n    }\n    return kj::mv(result);\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::String toTitleCase(kj::StringPtr name) {\n    kj::String result = kj::heapString(name);\n    if ('a' <= result[0] && result[0] <= 'z') {\n      result[0] = result[0] - 'a' + 'A';\n    }\n    return kj::mv(result);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "protoName",
          "args": [
            "proto"
          ],
          "line": 1093
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getProto",
          "args": [],
          "line": 1091
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nFieldText makeFieldText(kj::StringPtr scope, StructSchema::Field field,\n                          const TemplateContext& templateContext) {\n    auto proto = field.getProto();\n    auto typeSchema = field.getType();\n    auto baseName = protoName(proto);\n    kj::String titleCase = toTitleCase(baseName);\n\n    DiscriminantChecks unionDiscrim;\n    if (hasDiscriminantValue(proto)) {\n      unionDiscrim = makeDiscriminantChecks(scope, baseName, field.getContainingStruct(),\n                                            templateContext);\n    }\n\n    switch (proto.which()) {\n      case schema::Field::SLOT:\n        // Continue below.\n        break;\n\n      case schema::Field::GROUP: {\n        auto slots = getSortedSlots(field.getType().asStruct());\n        return FieldText {\n            kj::strTree(\n                kj::mv(unionDiscrim.readerIsDecl),\n                \"  inline \", titleCase, \"::Reader get\", titleCase, \"() const;\\n\"\n                \"\\n\"),\n\n            kj::strTree(\n                kj::mv(unionDiscrim.builderIsDecl),\n                \"  inline \", titleCase, \"::Builder get\", titleCase, \"();\\n\"\n                \"  inline \", titleCase, \"::Builder init\", titleCase, \"();\\n\"\n                \"\\n\"),\n\n            hasDiscriminantValue(proto) ? kj::strTree() :\n                kj::strTree(\"  inline \", titleCase, \"::Pipeline get\", titleCase, \"();\\n\"),\n\n            kj::strTree(\n                kj::mv(unionDiscrim.isDefs),\n                templateContext.allDecls(),\n                \"inline \", scope, titleCase, \"::Reader \", scope, \"Reader::get\", titleCase, \"() const {\\n\",\n                unionDiscrim.check,\n                \"  return \", scope, titleCase, \"::Reader(_reader);\\n\"\n                \"}\\n\",\n                templateContext.allDecls(),\n                \"inline \", scope, titleCase, \"::Builder \", scope, \"Builder::get\", titleCase, \"() {\\n\",\n                unionDiscrim.check,\n                \"  return \", scope, titleCase, \"::Builder(_builder);\\n\"\n                \"}\\n\",\n                hasDiscriminantValue(proto) ? kj::strTree() : kj::strTree(\n                  \"#if !CAPNP_LITE\\n\",\n                  templateContext.allDecls(),\n                  \"inline \", scope, titleCase, \"::Pipeline \", scope, \"Pipeline::get\", titleCase, \"() {\\n\",\n                  \"  return \", scope, titleCase, \"::Pipeline(_typeless.noop());\\n\"\n                  \"}\\n\"\n                  \"#endif  // !CAPNP_LITE\\n\"),\n                templateContext.allDecls(),\n                \"inline \", scope, titleCase, \"::Builder \", scope, \"Builder::init\", titleCase, \"() {\\n\",\n                unionDiscrim.set,\n                KJ_MAP(slot, slots) {\n                  switch (sectionFor(slot.whichType)) {\n                    case Section::NONE:\n                      return kj::strTree();\n                    case Section::DATA:\n                      return kj::strTree(\n                          \"  _builder.setDataField<\", maskType(slot.whichType), \">(\",\n                              slot.offset, \" * ::capnp::ELEMENTS, 0);\\n\");\n                    case Section::POINTERS:\n                      return kj::strTree(\n                          \"  _builder.getPointerField(\", slot.offset,\n                              \" * ::capnp::POINTERS).clear();\\n\");\n                  }\n                  KJ_UNREACHABLE;\n                },\n                \"  return \", scope, titleCase, \"::Builder(_builder);\\n\"\n                \"}\\n\")\n          };\n      }\n    }\n\n    auto slot = proto.getSlot();\n\n    FieldKind kind = FieldKind::PRIMITIVE;\n    kj::String ownedType;\n    CppTypeName type = typeName(typeSchema, nullptr);\n    kj::StringPtr setterDefault;  // only for void\n    kj::String defaultMask;    // primitives only\n    size_t defaultOffset = 0;    // pointers only: offset of the default value within the schema.\n    size_t defaultSize = 0;      // blobs only: byte size of the default value.\n\n    auto defaultBody = slot.getDefaultValue();\n    switch (typeSchema.which()) {\n      case schema::Type::VOID:\n        kind = FieldKind::PRIMITIVE;\n        setterDefault = \" = ::capnp::VOID\";\n        break;\n\n#define HANDLE_PRIMITIVE(discrim, typeName, defaultName, suffix) \\\n      case schema::Type::discrim: \\\n        kind = FieldKind::PRIMITIVE; \\\n        if (defaultBody.get##defaultName() != 0) { \\\n          defaultMask = kj::str(defaultBody.get##defaultName(), #suffix); \\\n        } \\\n        break;\n\n      HANDLE_PRIMITIVE(BOOL, bool, Bool, );\n      HANDLE_PRIMITIVE(INT8 , ::int8_t , Int8 , );\n      HANDLE_PRIMITIVE(INT16, ::int16_t, Int16, );\n      HANDLE_PRIMITIVE(INT32, ::int32_t, Int32, );\n      HANDLE_PRIMITIVE(INT64, ::int64_t, Int64, ll);\n      HANDLE_PRIMITIVE(UINT8 , ::uint8_t , Uint8 , u);\n      HANDLE_PRIMITIVE(UINT16, ::uint16_t, Uint16, u);\n      HANDLE_PRIMITIVE(UINT32, ::uint32_t, Uint32, u);\n      HANDLE_PRIMITIVE(UINT64, ::uint64_t, Uint64, ull);\n#undef HANDLE_PRIMITIVE\n\n      case schema::Type::FLOAT32:\n        kind = FieldKind::PRIMITIVE;\n        if (defaultBody.getFloat32() != 0) {\n          uint32_t mask;\n          float value = defaultBody.getFloat32();\n          static_assert(sizeof(mask) == sizeof(value), \"bug\");\n          memcpy(&mask, &value, sizeof(mask));\n          defaultMask = kj::str(mask, \"u\");\n        }\n        break;\n\n      case schema::Type::FLOAT64:\n        kind = FieldKind::PRIMITIVE;\n        if (defaultBody.getFloat64() != 0) {\n          uint64_t mask;\n          double value = defaultBody.getFloat64();\n          static_assert(sizeof(mask) == sizeof(value), \"bug\");\n          memcpy(&mask, &value, sizeof(mask));\n          defaultMask = kj::str(mask, \"ull\");\n        }\n        break;\n\n      case schema::Type::TEXT:\n        kind = FieldKind::BLOB;\n        if (defaultBody.hasText()) {\n          defaultOffset = field.getDefaultValueSchemaOffset();\n          defaultSize = defaultBody.getText().size();\n        }\n        break;\n      case schema::Type::DATA:\n        kind = FieldKind::BLOB;\n        if (defaultBody.hasData()) {\n          defaultOffset = field.getDefaultValueSchemaOffset();\n          defaultSize = defaultBody.getData().size();\n        }\n        break;\n\n      case schema::Type::ENUM:\n        kind = FieldKind::PRIMITIVE;\n        if (defaultBody.getEnum() != 0) {\n          defaultMask = kj::str(defaultBody.getEnum(), \"u\");\n        }\n        break;\n\n      case schema::Type::STRUCT:\n        kind = FieldKind::STRUCT;\n        if (defaultBody.hasStruct()) {\n          defaultOffset = field.getDefaultValueSchemaOffset();\n        }\n        break;\n      case schema::Type::LIST:\n        kind = FieldKind::LIST;\n        if (defaultBody.hasList()) {\n          defaultOffset = field.getDefaultValueSchemaOffset();\n        }\n        break;\n      case schema::Type::INTERFACE:\n        kind = FieldKind::INTERFACE;\n        break;\n      case schema::Type::ANY_POINTER:\n        if (defaultBody.hasAnyPointer()) {\n          defaultOffset = field.getDefaultValueSchemaOffset();\n        }\n        if (typeSchema.getBrandParameter() != nullptr) {\n          kind = FieldKind::BRAND_PARAMETER;\n        } else {\n          kind = FieldKind::ANY_POINTER;\n          switch (typeSchema.whichAnyPointerKind()) {\n            case schema::Type::AnyPointer::Unconstrained::ANY_KIND:\n              kind = FieldKind::ANY_POINTER;\n              break;\n            case schema::Type::AnyPointer::Unconstrained::STRUCT:\n              kind = FieldKind::STRUCT;\n              break;\n            case schema::Type::AnyPointer::Unconstrained::LIST:\n              kind = FieldKind::LIST;\n              break;\n            case schema::Type::AnyPointer::Unconstrained::CAPABILITY:\n              kind = FieldKind::INTERFACE;\n              break;\n          }\n        }\n        break;\n    }\n\n    kj::String defaultMaskParam;\n    if (defaultMask.size() > 0) {\n      defaultMaskParam = kj::str(\", \", defaultMask);\n    }\n\n    uint offset = slot.getOffset();\n\n    if (kind == FieldKind::PRIMITIVE) {\n      return FieldText {\n        kj::strTree(\n            kj::mv(unionDiscrim.readerIsDecl),\n            \"  inline \", type, \" get\", titleCase, \"() const;\\n\"\n            \"\\n\"),\n\n        kj::strTree(\n            kj::mv(unionDiscrim.builderIsDecl),\n            \"  inline \", type, \" get\", titleCase, \"();\\n\"\n            \"  inline void set\", titleCase, \"(\", type, \" value\", setterDefault, \");\\n\"\n            \"\\n\"),\n\n        kj::strTree(),\n\n        kj::strTree(\n            kj::mv(unionDiscrim.isDefs),\n            templateContext.allDecls(),\n            \"inline \", type, \" \", scope, \"Reader::get\", titleCase, \"() const {\\n\",\n            unionDiscrim.check,\n            \"  return _reader.getDataField<\", type, \">(\\n\"\n            \"      \", offset, \" * ::capnp::ELEMENTS\", defaultMaskParam, \");\\n\",\n            \"}\\n\"\n            \"\\n\",\n            templateContext.allDecls(),\n            \"inline \", type, \" \", scope, \"Builder::get\", titleCase, \"() {\\n\",\n            unionDiscrim.check,\n            \"  return _builder.getDataField<\", type, \">(\\n\"\n            \"      \", offset, \" * ::capnp::ELEMENTS\", defaultMaskParam, \");\\n\",\n            \"}\\n\",\n            templateContext.allDecls(),\n            \"inline void \", scope, \"Builder::set\", titleCase, \"(\", type, \" value) {\\n\",\n            unionDiscrim.set,\n            \"  _builder.setDataField<\", type, \">(\\n\"\n            \"      \", offset, \" * ::capnp::ELEMENTS, value\", defaultMaskParam, \");\\n\",\n            \"}\\n\"\n            \"\\n\")\n      };\n\n    } else if (kind == FieldKind::INTERFACE) {\n      CppTypeName clientType = type;\n      clientType.addMemberType(\"Client\");\n\n      return FieldText {\n        kj::strTree(\n            kj::mv(unionDiscrim.readerIsDecl),\n            \"  inline bool has\", titleCase, \"() const;\\n\"\n            \"#if !CAPNP_LITE\\n\"\n            \"  inline \", clientType, \" get\", titleCase, \"() const;\\n\"\n            \"#endif  // !CAPNP_LITE\\n\"\n            \"\\n\"),\n\n        kj::strTree(\n            kj::mv(unionDiscrim.builderIsDecl),\n            \"  inline bool has\", titleCase, \"();\\n\"\n            \"#if !CAPNP_LITE\\n\"\n            \"  inline \", clientType, \" get\", titleCase, \"();\\n\"\n            \"  inline void set\", titleCase, \"(\", clientType, \"&& value);\\n\",\n            \"  inline void set\", titleCase, \"(\", clientType, \"& value);\\n\",\n            \"  inline void adopt\", titleCase, \"(::capnp::Orphan<\", type, \">&& value);\\n\"\n            \"  inline ::capnp::Orphan<\", type, \"> disown\", titleCase, \"();\\n\"\n            \"#endif  // !CAPNP_LITE\\n\"\n            \"\\n\"),\n\n        kj::strTree(\n            hasDiscriminantValue(proto) ? kj::strTree() : kj::strTree(\n              \"  inline \", clientType, \" get\", titleCase, \"();\\n\")),\n\n        kj::strTree(\n            kj::mv(unionDiscrim.isDefs),\n            templateContext.allDecls(),\n            \"inline bool \", scope, \"Reader::has\", titleCase, \"() const {\\n\",\n            unionDiscrim.has,\n            \"  return !_reader.getPointerField(\", offset, \" * ::capnp::POINTERS).isNull();\\n\"\n            \"}\\n\",\n            templateContext.allDecls(),\n            \"inline bool \", scope, \"Builder::has\", titleCase, \"() {\\n\",\n            unionDiscrim.has,\n            \"  return !_builder.getPointerField(\", offset, \" * ::capnp::POINTERS).isNull();\\n\"\n            \"}\\n\"\n            \"#if !CAPNP_LITE\\n\",\n            templateContext.allDecls(),\n            \"inline \", clientType, \" \", scope, \"Reader::get\", titleCase, \"() const {\\n\",\n            unionDiscrim.check,\n            \"  return ::capnp::_::PointerHelpers<\", type, \">::get(\\n\"\n            \"      _reader.getPointerField(\", offset, \" * ::capnp::POINTERS));\\n\"\n            \"}\\n\",\n            templateContext.allDecls(),\n            \"inline \", clientType, \" \", scope, \"Builder::get\", titleCase, \"() {\\n\",\n            unionDiscrim.check,\n            \"  return ::capnp::_::PointerHelpers<\", type, \">::get(\\n\"\n            \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS));\\n\"\n            \"}\\n\",\n            hasDiscriminantValue(proto) ? kj::strTree() : kj::strTree(\n              templateContext.allDecls(),\n              \"inline \", clientType, \" \", scope, \"Pipeline::get\", titleCase, \"() {\\n\",\n              \"  return \", clientType, \"(_typeless.getPointerField(\", offset, \").asCap());\\n\"\n              \"}\\n\"),\n            templateContext.allDecls(),\n            \"inline void \", scope, \"Builder::set\", titleCase, \"(\", clientType, \"&& cap) {\\n\",\n            unionDiscrim.set,\n            \"  ::capnp::_::PointerHelpers<\", type, \">::set(\\n\"\n            \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS), kj::mv(cap));\\n\"\n            \"}\\n\",\n            templateContext.allDecls(),\n            \"inline void \", scope, \"Builder::set\", titleCase, \"(\", clientType, \"& cap) {\\n\",\n            unionDiscrim.set,\n            \"  ::capnp::_::PointerHelpers<\", type, \">::set(\\n\"\n            \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS), cap);\\n\"\n            \"}\\n\",\n            templateContext.allDecls(),\n            \"inline void \", scope, \"Builder::adopt\", titleCase, \"(\\n\"\n            \"    ::capnp::Orphan<\", type, \">&& value) {\\n\",\n            unionDiscrim.set,\n            \"  ::capnp::_::PointerHelpers<\", type, \">::adopt(\\n\"\n            \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS), kj::mv(value));\\n\"\n            \"}\\n\",\n            templateContext.allDecls(),\n            \"inline ::capnp::Orphan<\", type, \"> \", scope, \"Builder::disown\", titleCase, \"() {\\n\",\n            unionDiscrim.check,\n            \"  return ::capnp::_::PointerHelpers<\", type, \">::disown(\\n\"\n            \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS));\\n\"\n            \"}\\n\"\n            \"#endif  // !CAPNP_LITE\\n\"\n            \"\\n\")\n      };\n\n    } else if (kind == FieldKind::ANY_POINTER) {\n      return FieldText {\n        kj::strTree(\n            kj::mv(unionDiscrim.readerIsDecl),\n            \"  inline bool has\", titleCase, \"() const;\\n\"\n            \"  inline ::capnp::AnyPointer::Reader get\", titleCase, \"() const;\\n\"\n            \"\\n\"),\n\n        kj::strTree(\n            kj::mv(unionDiscrim.builderIsDecl),\n            \"  inline bool has\", titleCase, \"();\\n\"\n            \"  inline ::capnp::AnyPointer::Builder get\", titleCase, \"();\\n\"\n            \"  inline ::capnp::AnyPointer::Builder init\", titleCase, \"();\\n\"\n            \"\\n\"),\n\n        kj::strTree(),\n\n        kj::strTree(\n            kj::mv(unionDiscrim.isDefs),\n            templateContext.allDecls(),\n            \"inline bool \", scope, \"Reader::has\", titleCase, \"() const {\\n\",\n            unionDiscrim.has,\n            \"  return !_reader.getPointerField(\", offset, \" * ::capnp::POINTERS).isNull();\\n\"\n            \"}\\n\",\n            templateContext.allDecls(),\n            \"inline bool \", scope, \"Builder::has\", titleCase, \"() {\\n\",\n            unionDiscrim.has,\n            \"  return !_builder.getPointerField(\", offset, \" * ::capnp::POINTERS).isNull();\\n\"\n            \"}\\n\",\n            templateContext.allDecls(),\n            \"inline ::capnp::AnyPointer::Reader \", scope, \"Reader::get\", titleCase, \"() const {\\n\",\n            unionDiscrim.check,\n            \"  return ::capnp::AnyPointer::Reader(\\n\"\n            \"      _reader.getPointerField(\", offset, \" * ::capnp::POINTERS));\\n\"\n            \"}\\n\",\n            templateContext.allDecls(),\n            \"inline ::capnp::AnyPointer::Builder \", scope, \"Builder::get\", titleCase, \"() {\\n\",\n            unionDiscrim.check,\n            \"  return ::capnp::AnyPointer::Builder(\\n\"\n            \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS));\\n\"\n            \"}\\n\",\n            templateContext.allDecls(),\n            \"inline ::capnp::AnyPointer::Builder \", scope, \"Builder::init\", titleCase, \"() {\\n\",\n            unionDiscrim.set,\n            \"  auto result = ::capnp::AnyPointer::Builder(\\n\"\n            \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS));\\n\"\n            \"  result.clear();\\n\"\n            \"  return result;\\n\"\n            \"}\\n\"\n            \"\\n\")\n      };\n\n    } else {\n      // Blob, struct, list, or template param.  These have only minor differences.\n\n      uint64_t typeId = field.getContainingStruct().getProto().getId();\n      kj::String defaultParam = defaultOffset == 0 ? kj::str() : kj::str(\n          \",\\n        ::capnp::schemas::bp_\", kj::hex(typeId), \" + \", defaultOffset,\n          defaultSize == 0 ? kj::strTree() : kj::strTree(\", \", defaultSize));\n\n      bool shouldIncludeStructInit =\n          kind == FieldKind::STRUCT || kind == FieldKind::BRAND_PARAMETER;\n      bool shouldIncludeSizedInit =\n          kind != FieldKind::STRUCT || kind == FieldKind::BRAND_PARAMETER;\n      bool shouldIncludePipelineGetter = !hasDiscriminantValue(proto) &&\n          (kind == FieldKind::STRUCT || kind == FieldKind::BRAND_PARAMETER);\n      bool shouldIncludeArrayInitializer = false;\n      bool shouldExcludeInLiteMode = type.hasInterfaces();\n      bool shouldTemplatizeInit = typeSchema.which() == schema::Type::ANY_POINTER &&\n          kind != FieldKind::BRAND_PARAMETER;\n\n      CppTypeName elementReaderType;\n      if (typeSchema.isList()) {\n        bool primitiveElement = false;\n        bool interface = false;\n        auto elementType = typeSchema.asList().getElementType();\n        switch (elementType.which()) {\n          case schema::Type::VOID:\n          case schema::Type::BOOL:\n          case schema::Type::INT8:\n          case schema::Type::INT16:\n          case schema::Type::INT32:\n          case schema::Type::INT64:\n          case schema::Type::UINT8:\n          case schema::Type::UINT16:\n          case schema::Type::UINT32:\n          case schema::Type::UINT64:\n          case schema::Type::FLOAT32:\n          case schema::Type::FLOAT64:\n          case schema::Type::ENUM:\n            primitiveElement = true;\n            shouldIncludeArrayInitializer = true;\n            break;\n\n          case schema::Type::TEXT:\n          case schema::Type::DATA:\n          case schema::Type::LIST:\n            primitiveElement = false;\n            shouldIncludeArrayInitializer = true;\n            break;\n\n          case schema::Type::ANY_POINTER:\n            primitiveElement = false;\n            shouldIncludeArrayInitializer = elementType.getBrandParameter() != nullptr;\n            break;\n\n          case schema::Type::INTERFACE:\n            primitiveElement = false;\n            interface = true;\n            break;\n\n          case schema::Type::STRUCT:\n            primitiveElement = false;\n            break;\n        }\n        elementReaderType = typeName(elementType, nullptr);\n        if (!primitiveElement) {\n          if (interface) {\n            elementReaderType.addMemberType(\"Client\");\n          } else {\n            elementReaderType.addMemberType(\"Reader\");\n          }\n        }\n      };\n\n      CppTypeName readerType;\n      CppTypeName builderType;\n      CppTypeName pipelineType;\n      if (kind == FieldKind::BRAND_PARAMETER) {\n        readerType = CppTypeName::makeNamespace(\"capnp\");\n        readerType.addMemberTemplate(\"ReaderFor\", kj::heapArray(&type, 1));\n        builderType = CppTypeName::makeNamespace(\"capnp\");\n        builderType.addMemberTemplate(\"BuilderFor\", kj::heapArray(&type, 1));\n        pipelineType = CppTypeName::makeNamespace(\"capnp\");\n        pipelineType.addMemberTemplate(\"PipelineFor\", kj::heapArray(&type, 1));\n      } else {\n        readerType = type;\n        readerType.addMemberType(\"Reader\");\n        builderType = type;\n        builderType.addMemberType(\"Builder\");\n        pipelineType = type;\n        pipelineType.addMemberType(\"Pipeline\");\n      }\n\n      #define COND(cond, ...) ((cond) ? kj::strTree(__VA_ARGS__) : kj::strTree())\n\n      return FieldText {\n        kj::strTree(\n            kj::mv(unionDiscrim.readerIsDecl),\n            \"  inline bool has\", titleCase, \"() const;\\n\",\n            COND(shouldExcludeInLiteMode, \"#if !CAPNP_LITE\\n\"),\n            \"  inline \", readerType, \" get\", titleCase, \"() const;\\n\",\n            COND(shouldExcludeInLiteMode, \"#endif  // !CAPNP_LITE\\n\"),\n            \"\\n\"),\n\n        kj::strTree(\n            kj::mv(unionDiscrim.builderIsDecl),\n            \"  inline bool has\", titleCase, \"();\\n\",\n            COND(shouldExcludeInLiteMode, \"#if !CAPNP_LITE\\n\"),\n            \"  inline \", builderType, \" get\", titleCase, \"();\\n\"\n            \"  inline void set\", titleCase, \"(\", readerType, \" value);\\n\",\n            COND(shouldIncludeArrayInitializer,\n              \"  inline void set\", titleCase, \"(::kj::ArrayPtr<const \", elementReaderType, \"> value);\\n\"),\n            COND(shouldIncludeStructInit,\n              COND(shouldTemplatizeInit,\n                \"  template <typename T_>\\n\"\n                \"  inline ::capnp::BuilderFor<T_> init\", titleCase, \"As();\\n\"),\n              COND(!shouldTemplatizeInit,\n                \"  inline \", builderType, \" init\", titleCase, \"();\\n\")),\n            COND(shouldIncludeSizedInit,\n              COND(shouldTemplatizeInit,\n                \"  template <typename T_>\\n\"\n                \"  inline ::capnp::BuilderFor<T_> init\", titleCase, \"As(unsigned int size);\\n\"),\n              COND(!shouldTemplatizeInit,\n                \"  inline \", builderType, \" init\", titleCase, \"(unsigned int size);\\n\")),\n            \"  inline void adopt\", titleCase, \"(::capnp::Orphan<\", type, \">&& value);\\n\"\n            \"  inline ::capnp::Orphan<\", type, \"> disown\", titleCase, \"();\\n\",\n            COND(shouldExcludeInLiteMode, \"#endif  // !CAPNP_LITE\\n\"),\n            \"\\n\"),\n\n        kj::strTree(\n            COND(shouldIncludePipelineGetter,\n              \"  inline \", pipelineType, \" get\", titleCase, \"();\\n\")),\n\n        kj::strTree(\n            kj::mv(unionDiscrim.isDefs),\n            templateContext.allDecls(),\n            \"inline bool \", scope, \"Reader::has\", titleCase, \"() const {\\n\",\n            unionDiscrim.has,\n            \"  return !_reader.getPointerField(\", offset, \" * ::capnp::POINTERS).isNull();\\n\"\n            \"}\\n\",\n            templateContext.allDecls(),\n            \"inline bool \", scope, \"Builder::has\", titleCase, \"() {\\n\",\n            unionDiscrim.has,\n            \"  return !_builder.getPointerField(\", offset, \" * ::capnp::POINTERS).isNull();\\n\"\n            \"}\\n\",\n            COND(shouldExcludeInLiteMode, \"#if !CAPNP_LITE\\n\"),\n            templateContext.allDecls(),\n            \"inline \", readerType, \" \", scope, \"Reader::get\", titleCase, \"() const {\\n\",\n            unionDiscrim.check,\n            \"  return ::capnp::_::PointerHelpers<\", type, \">::get(\\n\"\n            \"      _reader.getPointerField(\", offset, \" * ::capnp::POINTERS)\", defaultParam, \");\\n\"\n            \"}\\n\",\n            templateContext.allDecls(),\n            \"inline \", builderType, \" \", scope, \"Builder::get\", titleCase, \"() {\\n\",\n            unionDiscrim.check,\n            \"  return ::capnp::_::PointerHelpers<\", type, \">::get(\\n\"\n            \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS)\", defaultParam, \");\\n\"\n            \"}\\n\",\n            COND(shouldIncludePipelineGetter,\n              \"#if !CAPNP_LITE\\n\",\n              templateContext.allDecls(),\n              \"inline \", pipelineType, \" \", scope, \"Pipeline::get\", titleCase, \"() {\\n\",\n              \"  return \", pipelineType, \"(_typeless.getPointerField(\", offset, \"));\\n\"\n              \"}\\n\"\n              \"#endif  // !CAPNP_LITE\\n\"),\n            templateContext.allDecls(),\n            \"inline void \", scope, \"Builder::set\", titleCase, \"(\", readerType, \" value) {\\n\",\n            unionDiscrim.set,\n            \"  ::capnp::_::PointerHelpers<\", type, \">::set(\\n\"\n            \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS), value);\\n\"\n            \"}\\n\",\n            COND(shouldIncludeArrayInitializer,\n              templateContext.allDecls(),\n              \"inline void \", scope, \"Builder::set\", titleCase, \"(::kj::ArrayPtr<const \", elementReaderType, \"> value) {\\n\",\n              unionDiscrim.set,\n              \"  ::capnp::_::PointerHelpers<\", type, \">::set(\\n\"\n              \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS), value);\\n\"\n              \"}\\n\"),\n            COND(shouldIncludeStructInit,\n              COND(shouldTemplatizeInit,\n                templateContext.allDecls(),\n                \"template <typename T_>\\n\"\n                \"inline ::capnp::BuilderFor<T_> \", scope, \"Builder::init\", titleCase, \"As() {\\n\",\n                \"  static_assert(::capnp::kind<T_>() == ::capnp::Kind::STRUCT,\\n\"\n                \"                \\\"\", proto.getName(), \" must be a struct\\\");\\n\",\n                unionDiscrim.set,\n                \"  return ::capnp::_::PointerHelpers<T_>::init(\\n\"\n                \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS));\\n\"\n                \"}\\n\"),\n              COND(!shouldTemplatizeInit,\n                templateContext.allDecls(),\n                \"inline \", builderType, \" \", scope, \"Builder::init\", titleCase, \"() {\\n\",\n                unionDiscrim.set,\n                \"  return ::capnp::_::PointerHelpers<\", type, \">::init(\\n\"\n                \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS));\\n\"\n                \"}\\n\")),\n            COND(shouldIncludeSizedInit,\n              COND(shouldTemplatizeInit,\n                templateContext.allDecls(),\n                \"template <typename T_>\\n\"\n                \"inline ::capnp::BuilderFor<T_> \", scope, \"Builder::init\", titleCase, \"As(unsigned int size) {\\n\",\n                \"  static_assert(::capnp::kind<T_>() == ::capnp::Kind::LIST,\\n\"\n                \"                \\\"\", proto.getName(), \" must be a list\\\");\\n\",\n                unionDiscrim.set,\n                \"  return ::capnp::_::PointerHelpers<T_>::init(\\n\"\n                \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS), size);\\n\"\n                \"}\\n\"),\n              COND(!shouldTemplatizeInit,\n                templateContext.allDecls(),\n                \"inline \", builderType, \" \", scope, \"Builder::init\", titleCase, \"(unsigned int size) {\\n\",\n                unionDiscrim.set,\n                \"  return ::capnp::_::PointerHelpers<\", type, \">::init(\\n\"\n                \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS), size);\\n\"\n                \"}\\n\")),\n            templateContext.allDecls(),\n            \"inline void \", scope, \"Builder::adopt\", titleCase, \"(\\n\"\n            \"    ::capnp::Orphan<\", type, \">&& value) {\\n\",\n            unionDiscrim.set,\n            \"  ::capnp::_::PointerHelpers<\", type, \">::adopt(\\n\"\n            \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS), kj::mv(value));\\n\"\n            \"}\\n\",\n            COND(type.hasDisambiguatedTemplate(),\n                \"#ifndef _MSC_VER\\n\"\n                \"// Excluded under MSVC because bugs may make it unable to compile this method.\\n\"),\n            templateContext.allDecls(),\n            \"inline ::capnp::Orphan<\", type, \"> \", scope, \"Builder::disown\", titleCase, \"() {\\n\",\n            unionDiscrim.check,\n            \"  return ::capnp::_::PointerHelpers<\", type, \">::disown(\\n\"\n            \"      _builder.getPointerField(\", offset, \" * ::capnp::POINTERS));\\n\"\n            \"}\\n\",\n            COND(type.hasDisambiguatedTemplate(), \"#endif  // !_MSC_VER\\n\"),\n            COND(shouldExcludeInLiteMode, \"#endif  // !CAPNP_LITE\\n\"),\n            \"\\n\")\n      };\n\n      #undef COND\n    }"
  },
  {
    "function_name": "makeDiscriminantChecks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "1037-1068",
    "snippet": "DiscriminantChecks makeDiscriminantChecks(kj::StringPtr scope,\n                                            kj::StringPtr memberName,\n                                            StructSchema containingStruct,\n                                            const TemplateContext& templateContext) {\n    auto discrimOffset = containingStruct.getProto().getStruct().getDiscriminantOffset();\n\n    kj::String titleCase = toTitleCase(memberName);\n    kj::String upperCase = toUpperCase(memberName);\n\n    return DiscriminantChecks {\n        kj::str(\n            \"  if (which() != \", scope, upperCase, \") return false;\\n\"),\n        kj::str(\n            \"  KJ_IREQUIRE(which() == \", scope, upperCase, \",\\n\"\n            \"              \\\"Must check which() before get()ing a union member.\\\");\\n\"),\n        kj::str(\n            \"  _builder.setDataField<\", scope, \"Which>(\\n\"\n            \"      \", discrimOffset, \" * ::capnp::ELEMENTS, \",\n                      scope, upperCase, \");\\n\"),\n        kj::strTree(\"  inline bool is\", titleCase, \"() const;\\n\"),\n        kj::strTree(\"  inline bool is\", titleCase, \"();\\n\"),\n        kj::strTree(\n            templateContext.allDecls(),\n            \"inline bool \", scope, \"Reader::is\", titleCase, \"() const {\\n\"\n            \"  return which() == \", scope, upperCase, \";\\n\"\n            \"}\\n\",\n            templateContext.allDecls(),\n            \"inline bool \", scope, \"Builder::is\", titleCase, \"() {\\n\"\n            \"  return which() == \", scope, upperCase, \";\\n\"\n            \"}\\n\")\n    };\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "templateContext.allDecls()",
            "\"inline bool \"",
            "scope",
            "\"Reader::is\"",
            "titleCase",
            "\"() const {\\n\"\n            \"  return which() == \"",
            "scope",
            "upperCase",
            "\";\\n\"\n            \"}\\n\"",
            "templateContext.allDecls()",
            "\"inline bool \"",
            "scope",
            "\"Builder::is\"",
            "titleCase",
            "\"() {\\n\"\n            \"  return which() == \"",
            "scope",
            "upperCase",
            "\";\\n\"\n            \"}\\n\""
          ],
          "line": 1058
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1063
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "templateContext.allDecls",
          "args": [],
          "line": 1059
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"  inline bool is\"",
            "titleCase",
            "\"();\\n\""
          ],
          "line": 1057
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"  inline bool is\"",
            "titleCase",
            "\"() const;\\n\""
          ],
          "line": 1056
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "\"  _builder.setDataField<\"",
            "scope",
            "\"Which>(\\n\"\n            \"      \"",
            "discrimOffset",
            "\" * ::capnp::ELEMENTS, \"",
            "scope",
            "upperCase",
            "\");\\n\""
          ],
          "line": 1052
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "\"  KJ_IREQUIRE(which() == \"",
            "scope",
            "upperCase",
            "\",\\n\"\n            \"              \\\"Must check which() before get()ing a union member.\\\");\\n\""
          ],
          "line": 1049
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "\"  if (which() != \"",
            "scope",
            "upperCase",
            "\") return false;\\n\""
          ],
          "line": 1047
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "toUpperCase",
          "args": [
            "memberName"
          ],
          "line": 1044
        },
        "resolved": true,
        "details": {
          "function_name": "toUpperCase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "404-421",
          "snippet": "kj::String toUpperCase(kj::StringPtr name) {\n    kj::Vector<char> result(name.size() + 4);\n\n    for (char c: name) {\n      if ('a' <= c && c <= 'z') {\n        result.add(c - 'a' + 'A');\n      } else if (result.size() > 0 && 'A' <= c && c <= 'Z') {\n        result.add('_');\n        result.add(c);\n      } else {\n        result.add(c);\n      }\n    }\n\n    result.add('\\0');\n\n    return kj::String(result.releaseAsArray());\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::String toUpperCase(kj::StringPtr name) {\n    kj::Vector<char> result(name.size() + 4);\n\n    for (char c: name) {\n      if ('a' <= c && c <= 'z') {\n        result.add(c - 'a' + 'A');\n      } else if (result.size() > 0 && 'A' <= c && c <= 'Z') {\n        result.add('_');\n        result.add(c);\n      } else {\n        result.add(c);\n      }\n    }\n\n    result.add('\\0');\n\n    return kj::String(result.releaseAsArray());\n  }"
        }
      },
      {
        "call_info": {
          "callee": "toTitleCase",
          "args": [
            "memberName"
          ],
          "line": 1043
        },
        "resolved": true,
        "details": {
          "function_name": "toTitleCase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "423-429",
          "snippet": "kj::String toTitleCase(kj::StringPtr name) {\n    kj::String result = kj::heapString(name);\n    if ('a' <= result[0] && result[0] <= 'z') {\n      result[0] = result[0] - 'a' + 'A';\n    }\n    return kj::mv(result);\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::String toTitleCase(kj::StringPtr name) {\n    kj::String result = kj::heapString(name);\n    if ('a' <= result[0] && result[0] <= 'z') {\n      result[0] = result[0] - 'a' + 'A';\n    }\n    return kj::mv(result);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "containingStruct.getProto",
          "args": [],
          "line": 1041
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nDiscriminantChecks makeDiscriminantChecks(kj::StringPtr scope,\n                                            kj::StringPtr memberName,\n                                            StructSchema containingStruct,\n                                            const TemplateContext& templateContext) {\n    auto discrimOffset = containingStruct.getProto().getStruct().getDiscriminantOffset();\n\n    kj::String titleCase = toTitleCase(memberName);\n    kj::String upperCase = toUpperCase(memberName);\n\n    return DiscriminantChecks {\n        kj::str(\n            \"  if (which() != \", scope, upperCase, \") return false;\\n\"),\n        kj::str(\n            \"  KJ_IREQUIRE(which() == \", scope, upperCase, \",\\n\"\n            \"              \\\"Must check which() before get()ing a union member.\\\");\\n\"),\n        kj::str(\n            \"  _builder.setDataField<\", scope, \"Which>(\\n\"\n            \"      \", discrimOffset, \" * ::capnp::ELEMENTS, \",\n                      scope, upperCase, \");\\n\"),\n        kj::strTree(\"  inline bool is\", titleCase, \"() const;\\n\"),\n        kj::strTree(\"  inline bool is\", titleCase, \"();\\n\"),\n        kj::strTree(\n            templateContext.allDecls(),\n            \"inline bool \", scope, \"Reader::is\", titleCase, \"() const {\\n\"\n            \"  return which() == \", scope, upperCase, \";\\n\"\n            \"}\\n\",\n            templateContext.allDecls(),\n            \"inline bool \", scope, \"Builder::is\", titleCase, \"() {\\n\"\n            \"  return which() == \", scope, upperCase, \";\\n\"\n            \"}\\n\")\n    };\n  }"
  },
  {
    "function_name": "getSortedSlots",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "992-1024",
    "snippet": "kj::Array<Slot> getSortedSlots(StructSchema schema) {\n    // Get a representation of all of the field locations owned by this schema, e.g. so that they\n    // can be zero'd out.\n\n    kj::Vector<Slot> slots(schema.getFields().size());\n    getSlots(schema, slots);\n    std::sort(slots.begin(), slots.end());\n\n    kj::Vector<Slot> result(slots.size());\n\n    // All void slots are redundant, and they sort towards the front of the list.  By starting out\n    // with `prevSlot` = void, we will end up skipping them all, which is what we want.\n    Slot prevSlot = { schema::Type::VOID, 0 };\n    for (auto slot: slots) {\n      if (prevSlot.isSupersetOf(slot)) {\n        // This slot is redundant as prevSlot is a superset of it.\n        continue;\n      }\n\n      // Since all sizes are power-of-two, if two slots overlap at all, one must be a superset of\n      // the other.  Since we sort slots by starting position, we know that the only way `slot`\n      // could be a superset of `prevSlot` is if they have the same starting position.  However,\n      // since we sort slots with the same starting position by descending size, this is not\n      // possible.\n      KJ_DASSERT(!slot.isSupersetOf(prevSlot));\n\n      result.add(slot);\n\n      prevSlot = slot;\n    }\n\n    return result.releaseAsArray();\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "result.releaseAsArray",
          "args": [],
          "line": 1023
        },
        "resolved": true,
        "details": {
          "function_name": "releaseAsArray",
          "container": "Vector",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/vector.h",
          "lines": "66-72",
          "snippet": "inline Array<T> releaseAsArray() {\n    // TODO(perf):  Avoid a copy/move by allowing Array<T> to point to incomplete space?\n    if (!builder.isFull()) {\n      setCapacity(size());\n    }\n    return builder.finish();\n  }",
          "includes": [
            "#include \"array.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n\nVector {\n  inline Array<T> releaseAsArray() {\n      // TODO(perf):  Avoid a copy/move by allowing Array<T> to point to incomplete space?\n      if (!builder.isFull()) {\n        setCapacity(size());\n      }\n      return builder.finish();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "result.add",
          "args": [
            "slot"
          ],
          "line": 1018
        },
        "resolved": true,
        "details": {
          "function_name": "add",
          "container": "ReusableObjects::ObjectSizeCounter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/null-common.h",
          "lines": "86-88",
          "snippet": "void add(size_t wordCount) {\n      maxSize = std::max(wordCount, maxSize);\n    }",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nReusableObjects {\n  ObjectSizeCounter {\n    void add(size_t wordCount) {\n          maxSize = std::max(wordCount, maxSize);\n        }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "KJ_DASSERT",
          "args": [
            "!slot.isSupersetOf(prevSlot)"
          ],
          "line": 1016
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slot.isSupersetOf",
          "args": [
            "prevSlot"
          ],
          "line": 1016
        },
        "resolved": true,
        "details": {
          "function_name": "isSupersetOf",
          "container": "Slot",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "917-934",
          "snippet": "bool isSupersetOf(Slot other) const {\n      auto section = sectionFor(whichType);\n      if (section != sectionFor(other.whichType)) return false;\n      switch (section) {\n        case Section::NONE:\n          return true;  // all voids overlap\n        case Section::DATA: {\n          auto bits = typeSizeBits(whichType);\n          auto start = offset * bits;\n          auto otherBits = typeSizeBits(other.whichType);\n          auto otherStart = other.offset * otherBits;\n          return start <= otherStart && otherStart + otherBits <= start + bits;\n        }\n        case Section::POINTERS:\n          return offset == other.offset;\n      }\n      KJ_UNREACHABLE;\n    }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nSlot {\n  bool isSupersetOf(Slot other) const {\n        auto section = sectionFor(whichType);\n        if (section != sectionFor(other.whichType)) return false;\n        switch (section) {\n          case Section::NONE:\n            return true;  // all voids overlap\n          case Section::DATA: {\n            auto bits = typeSizeBits(whichType);\n            auto start = offset * bits;\n            auto otherBits = typeSizeBits(other.whichType);\n            auto otherStart = other.offset * otherBits;\n            return start <= otherStart && otherStart + otherBits <= start + bits;\n          }\n          case Section::POINTERS:\n            return offset == other.offset;\n        }\n        KJ_UNREACHABLE;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "slots.size",
          "args": [],
          "line": 1000
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-capnp.c++",
          "lines": "74-74",
          "snippet": "inline size_t size() const { return amount; }",
          "includes": [
            "#include \"config.h\"",
            "#include <map>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <map>\n#include <algorithm>\n#include <kj/main.h>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nIndent {\n  inline size_t size() const { return amount; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::sort",
          "args": [
            "slots.begin()",
            "slots.end()"
          ],
          "line": 998
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "slots.end",
          "args": [],
          "line": 998
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-capnp.c++",
          "lines": "77-77",
          "snippet": "inline Iterator end() const { return Iterator(amount); }",
          "includes": [
            "#include \"config.h\"",
            "#include <map>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <map>\n#include <algorithm>\n#include <kj/main.h>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nIndent {\n  inline Iterator end() const { return Iterator(amount); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "slots.begin",
          "args": [],
          "line": 998
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-capnp.c++",
          "lines": "76-76",
          "snippet": "inline Iterator begin() const { return Iterator(0); }",
          "includes": [
            "#include \"config.h\"",
            "#include <map>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <map>\n#include <algorithm>\n#include <kj/main.h>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nIndent {\n  inline Iterator begin() const { return Iterator(0); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getSlots",
          "args": [
            "schema",
            "slots"
          ],
          "line": 997
        },
        "resolved": true,
        "details": {
          "function_name": "getSlots",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "971-990",
          "snippet": "void getSlots(StructSchema schema, kj::Vector<Slot>& slots) {\n    auto structProto = schema.getProto().getStruct();\n    if (structProto.getDiscriminantCount() > 0) {\n      slots.add(Slot { schema::Type::UINT16, structProto.getDiscriminantOffset() });\n    }\n\n    for (auto field: schema.getFields()) {\n      auto proto = field.getProto();\n      switch (proto.which()) {\n        case schema::Field::SLOT: {\n          auto slot = proto.getSlot();\n          slots.add(Slot { slot.getType().which(), slot.getOffset() });\n          break;\n        }\n        case schema::Field::GROUP:\n          getSlots(field.getType().asStruct(), slots);\n          break;\n      }\n    }\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nvoid getSlots(StructSchema schema, kj::Vector<Slot>& slots) {\n    auto structProto = schema.getProto().getStruct();\n    if (structProto.getDiscriminantCount() > 0) {\n      slots.add(Slot { schema::Type::UINT16, structProto.getDiscriminantOffset() });\n    }\n\n    for (auto field: schema.getFields()) {\n      auto proto = field.getProto();\n      switch (proto.which()) {\n        case schema::Field::SLOT: {\n          auto slot = proto.getSlot();\n          slots.add(Slot { slot.getType().which(), slot.getOffset() });\n          break;\n        }\n        case schema::Field::GROUP:\n          getSlots(field.getType().asStruct(), slots);\n          break;\n      }\n    }\n  }"
        }
      },
      {
        "call_info": {
          "callee": "schema.getFields",
          "args": [],
          "line": 996
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getFields",
          "args": [],
          "line": 996
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::Array<Slot> getSortedSlots(StructSchema schema) {\n    // Get a representation of all of the field locations owned by this schema, e.g. so that they\n    // can be zero'd out.\n\n    kj::Vector<Slot> slots(schema.getFields().size());\n    getSlots(schema, slots);\n    std::sort(slots.begin(), slots.end());\n\n    kj::Vector<Slot> result(slots.size());\n\n    // All void slots are redundant, and they sort towards the front of the list.  By starting out\n    // with `prevSlot` = void, we will end up skipping them all, which is what we want.\n    Slot prevSlot = { schema::Type::VOID, 0 };\n    for (auto slot: slots) {\n      if (prevSlot.isSupersetOf(slot)) {\n        // This slot is redundant as prevSlot is a superset of it.\n        continue;\n      }\n\n      // Since all sizes are power-of-two, if two slots overlap at all, one must be a superset of\n      // the other.  Since we sort slots by starting position, we know that the only way `slot`\n      // could be a superset of `prevSlot` is if they have the same starting position.  However,\n      // since we sort slots with the same starting position by descending size, this is not\n      // possible.\n      KJ_DASSERT(!slot.isSupersetOf(prevSlot));\n\n      result.add(slot);\n\n      prevSlot = slot;\n    }\n\n    return result.releaseAsArray();\n  }"
  },
  {
    "function_name": "getSlots",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "971-990",
    "snippet": "void getSlots(StructSchema schema, kj::Vector<Slot>& slots) {\n    auto structProto = schema.getProto().getStruct();\n    if (structProto.getDiscriminantCount() > 0) {\n      slots.add(Slot { schema::Type::UINT16, structProto.getDiscriminantOffset() });\n    }\n\n    for (auto field: schema.getFields()) {\n      auto proto = field.getProto();\n      switch (proto.which()) {\n        case schema::Field::SLOT: {\n          auto slot = proto.getSlot();\n          slots.add(Slot { slot.getType().which(), slot.getOffset() });\n          break;\n        }\n        case schema::Field::GROUP:\n          getSlots(field.getType().asStruct(), slots);\n          break;\n      }\n    }\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "field.getType",
          "args": [],
          "line": 986
        },
        "resolved": true,
        "details": {
          "function_name": "getType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "942-942",
          "snippet": "inline DynamicValue::Type getType() { return type; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline DynamicValue::Type getType() { return type; }"
        }
      },
      {
        "call_info": {
          "callee": "slots.add",
          "args": [
            "Slot { slot.getType().which(), slot.getOffset() }"
          ],
          "line": 982
        },
        "resolved": true,
        "details": {
          "function_name": "add",
          "container": "ReusableObjects::ObjectSizeCounter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/null-common.h",
          "lines": "86-88",
          "snippet": "void add(size_t wordCount) {\n      maxSize = std::max(wordCount, maxSize);\n    }",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nReusableObjects {\n  ObjectSizeCounter {\n    void add(size_t wordCount) {\n          maxSize = std::max(wordCount, maxSize);\n        }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "slot.getOffset",
          "args": [],
          "line": 982
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.getSlot",
          "args": [],
          "line": 981
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proto.which",
          "args": [],
          "line": 979
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getProto",
          "args": [],
          "line": 978
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      },
      {
        "call_info": {
          "callee": "schema.getFields",
          "args": [],
          "line": 977
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structProto.getDiscriminantOffset",
          "args": [],
          "line": 974
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structProto.getDiscriminantCount",
          "args": [],
          "line": 973
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nvoid getSlots(StructSchema schema, kj::Vector<Slot>& slots) {\n    auto structProto = schema.getProto().getStruct();\n    if (structProto.getDiscriminantCount() > 0) {\n      slots.add(Slot { schema::Type::UINT16, structProto.getDiscriminantOffset() });\n    }\n\n    for (auto field: schema.getFields()) {\n      auto proto = field.getProto();\n      switch (proto.which()) {\n        case schema::Field::SLOT: {\n          auto slot = proto.getSlot();\n          slots.add(Slot { slot.getType().which(), slot.getOffset() });\n          break;\n        }\n        case schema::Field::GROUP:\n          getSlots(field.getType().asStruct(), slots);\n          break;\n      }\n    }\n  }"
  },
  {
    "function_name": "isSupersetOf",
    "container": "Slot",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "917-934",
    "snippet": "bool isSupersetOf(Slot other) const {\n      auto section = sectionFor(whichType);\n      if (section != sectionFor(other.whichType)) return false;\n      switch (section) {\n        case Section::NONE:\n          return true;  // all voids overlap\n        case Section::DATA: {\n          auto bits = typeSizeBits(whichType);\n          auto start = offset * bits;\n          auto otherBits = typeSizeBits(other.whichType);\n          auto otherStart = other.offset * otherBits;\n          return start <= otherStart && otherStart + otherBits <= start + bits;\n        }\n        case Section::POINTERS:\n          return offset == other.offset;\n      }\n      KJ_UNREACHABLE;\n    }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "typeSizeBits",
          "args": [
            "other.whichType"
          ],
          "line": 926
        },
        "resolved": true,
        "details": {
          "function_name": "typeSizeBits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "825-850",
          "snippet": "static uint typeSizeBits(schema::Type::Which whichType) {\n    switch (whichType) {\n      case schema::Type::BOOL: return 1;\n      case schema::Type::INT8: return 8;\n      case schema::Type::INT16: return 16;\n      case schema::Type::INT32: return 32;\n      case schema::Type::INT64: return 64;\n      case schema::Type::UINT8: return 8;\n      case schema::Type::UINT16: return 16;\n      case schema::Type::UINT32: return 32;\n      case schema::Type::UINT64: return 64;\n      case schema::Type::FLOAT32: return 32;\n      case schema::Type::FLOAT64: return 64;\n      case schema::Type::ENUM: return 16;\n\n      case schema::Type::VOID:\n      case schema::Type::TEXT:\n      case schema::Type::DATA:\n      case schema::Type::LIST:\n      case schema::Type::STRUCT:\n      case schema::Type::INTERFACE:\n      case schema::Type::ANY_POINTER:\n        KJ_FAIL_REQUIRE(\"Should only be called for data types.\");\n    }\n    KJ_UNREACHABLE;\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nstatic uint typeSizeBits(schema::Type::Which whichType) {\n    switch (whichType) {\n      case schema::Type::BOOL: return 1;\n      case schema::Type::INT8: return 8;\n      case schema::Type::INT16: return 16;\n      case schema::Type::INT32: return 32;\n      case schema::Type::INT64: return 64;\n      case schema::Type::UINT8: return 8;\n      case schema::Type::UINT16: return 16;\n      case schema::Type::UINT32: return 32;\n      case schema::Type::UINT64: return 64;\n      case schema::Type::FLOAT32: return 32;\n      case schema::Type::FLOAT64: return 64;\n      case schema::Type::ENUM: return 16;\n\n      case schema::Type::VOID:\n      case schema::Type::TEXT:\n      case schema::Type::DATA:\n      case schema::Type::LIST:\n      case schema::Type::STRUCT:\n      case schema::Type::INTERFACE:\n      case schema::Type::ANY_POINTER:\n        KJ_FAIL_REQUIRE(\"Should only be called for data types.\");\n    }\n    KJ_UNREACHABLE;\n  }"
        }
      },
      {
        "call_info": {
          "callee": "sectionFor",
          "args": [
            "other.whichType"
          ],
          "line": 919
        },
        "resolved": true,
        "details": {
          "function_name": "sectionFor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "858-884",
          "snippet": "static Section sectionFor(schema::Type::Which whichType) {\n    switch (whichType) {\n      case schema::Type::VOID:\n        return Section::NONE;\n      case schema::Type::BOOL:\n      case schema::Type::INT8:\n      case schema::Type::INT16:\n      case schema::Type::INT32:\n      case schema::Type::INT64:\n      case schema::Type::UINT8:\n      case schema::Type::UINT16:\n      case schema::Type::UINT32:\n      case schema::Type::UINT64:\n      case schema::Type::FLOAT32:\n      case schema::Type::FLOAT64:\n      case schema::Type::ENUM:\n        return Section::DATA;\n      case schema::Type::TEXT:\n      case schema::Type::DATA:\n      case schema::Type::LIST:\n      case schema::Type::STRUCT:\n      case schema::Type::INTERFACE:\n      case schema::Type::ANY_POINTER:\n        return Section::POINTERS;\n    }\n    KJ_UNREACHABLE;\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nstatic Section sectionFor(schema::Type::Which whichType) {\n    switch (whichType) {\n      case schema::Type::VOID:\n        return Section::NONE;\n      case schema::Type::BOOL:\n      case schema::Type::INT8:\n      case schema::Type::INT16:\n      case schema::Type::INT32:\n      case schema::Type::INT64:\n      case schema::Type::UINT8:\n      case schema::Type::UINT16:\n      case schema::Type::UINT32:\n      case schema::Type::UINT64:\n      case schema::Type::FLOAT32:\n      case schema::Type::FLOAT64:\n      case schema::Type::ENUM:\n        return Section::DATA;\n      case schema::Type::TEXT:\n      case schema::Type::DATA:\n      case schema::Type::LIST:\n      case schema::Type::STRUCT:\n      case schema::Type::INTERFACE:\n      case schema::Type::ANY_POINTER:\n        return Section::POINTERS;\n    }\n    KJ_UNREACHABLE;\n  }"
        }
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nSlot {\n  bool isSupersetOf(Slot other) const {\n        auto section = sectionFor(whichType);\n        if (section != sectionFor(other.whichType)) return false;\n        switch (section) {\n          case Section::NONE:\n            return true;  // all voids overlap\n          case Section::DATA: {\n            auto bits = typeSizeBits(whichType);\n            auto start = offset * bits;\n            auto otherBits = typeSizeBits(other.whichType);\n            auto otherStart = other.offset * otherBits;\n            return start <= otherStart && otherStart + otherBits <= start + bits;\n          }\n          case Section::POINTERS:\n            return offset == other.offset;\n        }\n        KJ_UNREACHABLE;\n      }\n}"
  },
  {
    "function_name": "maskType",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "886-911",
    "snippet": "static kj::StringPtr maskType(schema::Type::Which whichType) {\n    switch (whichType) {\n      case schema::Type::BOOL: return \"bool\";\n      case schema::Type::INT8: return \" ::uint8_t\";\n      case schema::Type::INT16: return \" ::uint16_t\";\n      case schema::Type::INT32: return \" ::uint32_t\";\n      case schema::Type::INT64: return \" ::uint64_t\";\n      case schema::Type::UINT8: return \" ::uint8_t\";\n      case schema::Type::UINT16: return \" ::uint16_t\";\n      case schema::Type::UINT32: return \" ::uint32_t\";\n      case schema::Type::UINT64: return \" ::uint64_t\";\n      case schema::Type::FLOAT32: return \" ::uint32_t\";\n      case schema::Type::FLOAT64: return \" ::uint64_t\";\n      case schema::Type::ENUM: return \" ::uint16_t\";\n\n      case schema::Type::VOID:\n      case schema::Type::TEXT:\n      case schema::Type::DATA:\n      case schema::Type::LIST:\n      case schema::Type::STRUCT:\n      case schema::Type::INTERFACE:\n      case schema::Type::ANY_POINTER:\n        KJ_FAIL_REQUIRE(\"Should only be called for data types.\");\n    }\n    KJ_UNREACHABLE;\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "KJ_FAIL_REQUIRE",
          "args": [
            "\"Should only be called for data types.\""
          ],
          "line": 908
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nstatic kj::StringPtr maskType(schema::Type::Which whichType) {\n    switch (whichType) {\n      case schema::Type::BOOL: return \"bool\";\n      case schema::Type::INT8: return \" ::uint8_t\";\n      case schema::Type::INT16: return \" ::uint16_t\";\n      case schema::Type::INT32: return \" ::uint32_t\";\n      case schema::Type::INT64: return \" ::uint64_t\";\n      case schema::Type::UINT8: return \" ::uint8_t\";\n      case schema::Type::UINT16: return \" ::uint16_t\";\n      case schema::Type::UINT32: return \" ::uint32_t\";\n      case schema::Type::UINT64: return \" ::uint64_t\";\n      case schema::Type::FLOAT32: return \" ::uint32_t\";\n      case schema::Type::FLOAT64: return \" ::uint64_t\";\n      case schema::Type::ENUM: return \" ::uint16_t\";\n\n      case schema::Type::VOID:\n      case schema::Type::TEXT:\n      case schema::Type::DATA:\n      case schema::Type::LIST:\n      case schema::Type::STRUCT:\n      case schema::Type::INTERFACE:\n      case schema::Type::ANY_POINTER:\n        KJ_FAIL_REQUIRE(\"Should only be called for data types.\");\n    }\n    KJ_UNREACHABLE;\n  }"
  },
  {
    "function_name": "sectionFor",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "858-884",
    "snippet": "static Section sectionFor(schema::Type::Which whichType) {\n    switch (whichType) {\n      case schema::Type::VOID:\n        return Section::NONE;\n      case schema::Type::BOOL:\n      case schema::Type::INT8:\n      case schema::Type::INT16:\n      case schema::Type::INT32:\n      case schema::Type::INT64:\n      case schema::Type::UINT8:\n      case schema::Type::UINT16:\n      case schema::Type::UINT32:\n      case schema::Type::UINT64:\n      case schema::Type::FLOAT32:\n      case schema::Type::FLOAT64:\n      case schema::Type::ENUM:\n        return Section::DATA;\n      case schema::Type::TEXT:\n      case schema::Type::DATA:\n      case schema::Type::LIST:\n      case schema::Type::STRUCT:\n      case schema::Type::INTERFACE:\n      case schema::Type::ANY_POINTER:\n        return Section::POINTERS;\n    }\n    KJ_UNREACHABLE;\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nstatic Section sectionFor(schema::Type::Which whichType) {\n    switch (whichType) {\n      case schema::Type::VOID:\n        return Section::NONE;\n      case schema::Type::BOOL:\n      case schema::Type::INT8:\n      case schema::Type::INT16:\n      case schema::Type::INT32:\n      case schema::Type::INT64:\n      case schema::Type::UINT8:\n      case schema::Type::UINT16:\n      case schema::Type::UINT32:\n      case schema::Type::UINT64:\n      case schema::Type::FLOAT32:\n      case schema::Type::FLOAT64:\n      case schema::Type::ENUM:\n        return Section::DATA;\n      case schema::Type::TEXT:\n      case schema::Type::DATA:\n      case schema::Type::LIST:\n      case schema::Type::STRUCT:\n      case schema::Type::INTERFACE:\n      case schema::Type::ANY_POINTER:\n        return Section::POINTERS;\n    }\n    KJ_UNREACHABLE;\n  }"
  },
  {
    "function_name": "typeSizeBits",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "825-850",
    "snippet": "static uint typeSizeBits(schema::Type::Which whichType) {\n    switch (whichType) {\n      case schema::Type::BOOL: return 1;\n      case schema::Type::INT8: return 8;\n      case schema::Type::INT16: return 16;\n      case schema::Type::INT32: return 32;\n      case schema::Type::INT64: return 64;\n      case schema::Type::UINT8: return 8;\n      case schema::Type::UINT16: return 16;\n      case schema::Type::UINT32: return 32;\n      case schema::Type::UINT64: return 64;\n      case schema::Type::FLOAT32: return 32;\n      case schema::Type::FLOAT64: return 64;\n      case schema::Type::ENUM: return 16;\n\n      case schema::Type::VOID:\n      case schema::Type::TEXT:\n      case schema::Type::DATA:\n      case schema::Type::LIST:\n      case schema::Type::STRUCT:\n      case schema::Type::INTERFACE:\n      case schema::Type::ANY_POINTER:\n        KJ_FAIL_REQUIRE(\"Should only be called for data types.\");\n    }\n    KJ_UNREACHABLE;\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "KJ_FAIL_REQUIRE",
          "args": [
            "\"Should only be called for data types.\""
          ],
          "line": 847
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nstatic uint typeSizeBits(schema::Type::Which whichType) {\n    switch (whichType) {\n      case schema::Type::BOOL: return 1;\n      case schema::Type::INT8: return 8;\n      case schema::Type::INT16: return 16;\n      case schema::Type::INT32: return 32;\n      case schema::Type::INT64: return 64;\n      case schema::Type::UINT8: return 8;\n      case schema::Type::UINT16: return 16;\n      case schema::Type::UINT32: return 32;\n      case schema::Type::UINT64: return 64;\n      case schema::Type::FLOAT32: return 32;\n      case schema::Type::FLOAT64: return 64;\n      case schema::Type::ENUM: return 16;\n\n      case schema::Type::VOID:\n      case schema::Type::TEXT:\n      case schema::Type::DATA:\n      case schema::Type::LIST:\n      case schema::Type::STRUCT:\n      case schema::Type::INTERFACE:\n      case schema::Type::ANY_POINTER:\n        KJ_FAIL_REQUIRE(\"Should only be called for data types.\");\n    }\n    KJ_UNREACHABLE;\n  }"
  },
  {
    "function_name": "makeBrandDepInitializer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "791-820",
    "snippet": "kj::Maybe<kj::StringTree> makeBrandDepInitializer(Type type) {\n    switch (type.which()) {\n      case schema::Type::VOID:\n      case schema::Type::BOOL:\n      case schema::Type::INT8:\n      case schema::Type::INT16:\n      case schema::Type::INT32:\n      case schema::Type::INT64:\n      case schema::Type::UINT8:\n      case schema::Type::UINT16:\n      case schema::Type::UINT32:\n      case schema::Type::UINT64:\n      case schema::Type::FLOAT32:\n      case schema::Type::FLOAT64:\n      case schema::Type::TEXT:\n      case schema::Type::DATA:\n      case schema::Type::ENUM:\n      case schema::Type::ANY_POINTER:\n        return nullptr;\n\n      case schema::Type::STRUCT:\n        return makeBrandDepInitializer(type.asStruct());\n      case schema::Type::INTERFACE:\n        return makeBrandDepInitializer(type.asInterface());\n      case schema::Type::LIST:\n        return makeBrandDepInitializer(type.asList().getElementType());\n    }\n\n    KJ_UNREACHABLE;\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "type.asList",
          "args": [],
          "line": 816
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.asList",
          "args": [],
          "line": 816
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.asInterface",
          "args": [],
          "line": 814
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.asStruct",
          "args": [],
          "line": 812
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.which",
          "args": [],
          "line": 792
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::Maybe<kj::StringTree> makeBrandDepInitializer(Type type) {\n    switch (type.which()) {\n      case schema::Type::VOID:\n      case schema::Type::BOOL:\n      case schema::Type::INT8:\n      case schema::Type::INT16:\n      case schema::Type::INT32:\n      case schema::Type::INT64:\n      case schema::Type::UINT8:\n      case schema::Type::UINT16:\n      case schema::Type::UINT32:\n      case schema::Type::UINT64:\n      case schema::Type::FLOAT32:\n      case schema::Type::FLOAT64:\n      case schema::Type::TEXT:\n      case schema::Type::DATA:\n      case schema::Type::ENUM:\n      case schema::Type::ANY_POINTER:\n        return nullptr;\n\n      case schema::Type::STRUCT:\n        return makeBrandDepInitializer(type.asStruct());\n      case schema::Type::INTERFACE:\n        return makeBrandDepInitializer(type.asInterface());\n      case schema::Type::LIST:\n        return makeBrandDepInitializer(type.asList().getElementType());\n    }\n\n    KJ_UNREACHABLE;\n  }"
  },
  {
    "function_name": "makeBrandDepInitializer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "781-789",
    "snippet": "kj::Maybe<kj::StringTree> makeBrandDepInitializer(Schema type, CppTypeName name) {\n    if (type.isBranded()) {\n      name.addMemberType(\"_capnpPrivate\");\n      name.addMemberValue(\"brand\");\n      return kj::strTree(name);\n    } else {\n      return nullptr;\n    }\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "name"
          ],
          "line": 785
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "name.addMemberValue",
          "args": [
            "\"brand\""
          ],
          "line": 784
        },
        "resolved": true,
        "details": {
          "function_name": "addMemberValue",
          "container": "CppTypeName",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "213-218",
          "snippet": "void addMemberValue(kj::StringPtr innerName) {\n    // Append \"::innerName\" to refer to a member.\n\n    name = kj::strTree(kj::mv(name), \"::\", innerName);\n    needsTypename = false;\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName {\n  void addMemberValue(kj::StringPtr innerName) {\n      // Append \"::innerName\" to refer to a member.\n  \n      name = kj::strTree(kj::mv(name), \"::\", innerName);\n      needsTypename = false;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "name.addMemberType",
          "args": [
            "\"_capnpPrivate\""
          ],
          "line": 783
        },
        "resolved": true,
        "details": {
          "function_name": "addMemberType",
          "container": "CppTypeName",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "206-211",
          "snippet": "void addMemberType(kj::StringPtr innerName) {\n    // Append \"::innerName\" to refer to a member.\n\n    name = kj::strTree(kj::mv(name), \"::\", innerName);\n    needsTypename = isArgDependent;\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName {\n  void addMemberType(kj::StringPtr innerName) {\n      // Append \"::innerName\" to refer to a member.\n  \n      name = kj::strTree(kj::mv(name), \"::\", innerName);\n      needsTypename = isArgDependent;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "type.isBranded",
          "args": [],
          "line": 782
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::Maybe<kj::StringTree> makeBrandDepInitializer(Schema type, CppTypeName name) {\n    if (type.isBranded()) {\n      name.addMemberType(\"_capnpPrivate\");\n      name.addMemberValue(\"brand\");\n      return kj::strTree(name);\n    } else {\n      return nullptr;\n    }\n  }"
  },
  {
    "function_name": "makeBrandDepInitializer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "759-779",
    "snippet": "kj::Maybe<kj::StringTree> makeBrandDepInitializer(\n      InterfaceSchema::Method method, StructSchema type, kj::StringPtr suffix) {\n    auto typeProto = type.getProto();\n    if (typeProto.getScopeId() == 0) {\n      // This is an auto-generated params or results type.\n      auto name = cppFullName(method.getContainingInterface(), nullptr);\n      auto memberTypeName = kj::str(toTitleCase(protoName(method.getProto())), suffix);\n\n      if (typeProto.getParameters().size() == 0) {\n        name.addMemberType(memberTypeName);\n      } else {\n        // The method has implicit parameters (i.e. it's generic). For the purpose of the brand\n        // dep initializer, we only want to supply the default AnyPointer variant, so just don't\n        // pass any parameters here.\n        name.addMemberTemplate(memberTypeName, nullptr);\n      }\n      return makeBrandDepInitializer(type, kj::mv(name));\n    } else {\n      return makeBrandDepInitializer(type);\n    }\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "name"
          ],
          "line": 775
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "name.addMemberTemplate",
          "args": [
            "memberTypeName",
            "nullptr"
          ],
          "line": 773
        },
        "resolved": true,
        "details": {
          "function_name": "addMemberTemplate",
          "container": "CppTypeName",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "224-243",
          "snippet": "void addMemberTemplate(kj::StringPtr innerName, kj::Array<CppTypeName>&& params) {\n    // Append \"::innerName<params, ...>\".\n    //\n    // If necessary, add the \"template\" disambiguation keyword in front of `innerName`.\n\n    bool parentIsArgDependent = isArgDependent;\n    needsTypename = parentIsArgDependent;\n    hasDisambiguatedTemplate_ = hasDisambiguatedTemplate_ || parentIsArgDependent;\n\n    name = kj::strTree(kj::mv(name),\n        parentIsArgDependent ? \"::template \" : \"::\",\n        innerName, '<',\n        kj::StringTree(KJ_MAP(p, params) {\n          if (p.isArgDependent) isArgDependent = true;\n          if (p.hasInterfaces_) hasInterfaces_ = true;\n          if (p.hasDisambiguatedTemplate_) hasDisambiguatedTemplate_ = true;\n          return kj::strTree(kj::mv(p));\n        }, \", \"),\n        '>');\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName {\n  void addMemberTemplate(kj::StringPtr innerName, kj::Array<CppTypeName>&& params) {\n      // Append \"::innerName<params, ...>\".\n      //\n      // If necessary, add the \"template\" disambiguation keyword in front of `innerName`.\n  \n      bool parentIsArgDependent = isArgDependent;\n      needsTypename = parentIsArgDependent;\n      hasDisambiguatedTemplate_ = hasDisambiguatedTemplate_ || parentIsArgDependent;\n  \n      name = kj::strTree(kj::mv(name),\n          parentIsArgDependent ? \"::template \" : \"::\",\n          innerName, '<',\n          kj::StringTree(KJ_MAP(p, params) {\n            if (p.isArgDependent) isArgDependent = true;\n            if (p.hasInterfaces_) hasInterfaces_ = true;\n            if (p.hasDisambiguatedTemplate_) hasDisambiguatedTemplate_ = true;\n            return kj::strTree(kj::mv(p));\n          }, \", \"),\n          '>');\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "name.addMemberType",
          "args": [
            "memberTypeName"
          ],
          "line": 768
        },
        "resolved": true,
        "details": {
          "function_name": "addMemberType",
          "container": "CppTypeName",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "206-211",
          "snippet": "void addMemberType(kj::StringPtr innerName) {\n    // Append \"::innerName\" to refer to a member.\n\n    name = kj::strTree(kj::mv(name), \"::\", innerName);\n    needsTypename = isArgDependent;\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName {\n  void addMemberType(kj::StringPtr innerName) {\n      // Append \"::innerName\" to refer to a member.\n  \n      name = kj::strTree(kj::mv(name), \"::\", innerName);\n      needsTypename = isArgDependent;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "typeProto.getParameters",
          "args": [],
          "line": 767
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typeProto.getParameters",
          "args": [],
          "line": 767
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "toTitleCase(protoName(method.getProto()))",
            "suffix"
          ],
          "line": 765
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "toTitleCase",
          "args": [
            "protoName(method.getProto())"
          ],
          "line": 765
        },
        "resolved": true,
        "details": {
          "function_name": "toTitleCase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "423-429",
          "snippet": "kj::String toTitleCase(kj::StringPtr name) {\n    kj::String result = kj::heapString(name);\n    if ('a' <= result[0] && result[0] <= 'z') {\n      result[0] = result[0] - 'a' + 'A';\n    }\n    return kj::mv(result);\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::String toTitleCase(kj::StringPtr name) {\n    kj::String result = kj::heapString(name);\n    if ('a' <= result[0] && result[0] <= 'z') {\n      result[0] = result[0] - 'a' + 'A';\n    }\n    return kj::mv(result);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "protoName",
          "args": [
            "method.getProto()"
          ],
          "line": 765
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "method.getProto",
          "args": [],
          "line": 765
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      },
      {
        "call_info": {
          "callee": "cppFullName",
          "args": [
            "method.getContainingInterface()",
            "nullptr"
          ],
          "line": 764
        },
        "resolved": true,
        "details": {
          "function_name": "cppFullName",
          "container": "CapnpcCppMain",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "316-318",
          "snippet": "CppTypeName cppFullName(Schema schema, kj::Maybe<InterfaceSchema::Method> method) {\n    return cppFullName(schema, schema, method);\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCapnpcCppMain {\n  CppTypeName cppFullName(Schema schema, kj::Maybe<InterfaceSchema::Method> method) {\n      return cppFullName(schema, schema, method);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "method.getContainingInterface",
          "args": [],
          "line": 764
        },
        "resolved": true,
        "details": {
          "function_name": "getContainingInterface",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "484-484",
          "snippet": "inline InterfaceSchema getContainingInterface() const { return parent; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline InterfaceSchema getContainingInterface() const { return parent; }"
        }
      },
      {
        "call_info": {
          "callee": "typeProto.getScopeId",
          "args": [],
          "line": 762
        },
        "resolved": true,
        "details": {
          "function_name": "getScopeId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/node-translator.c++",
          "lines": "778-778",
          "snippet": "inline uint64_t getScopeId() { return leafId; }",
          "includes": [
            "#include <map>",
            "#include <set>",
            "#include <kj/arena.h>",
            "#include <kj/debug.h>",
            "#include \"parser.h\"      // only for generateGroupId()",
            "#include \"node-translator.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "uint64_t leafId;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <map>\n#include <set>\n#include <kj/arena.h>\n#include <kj/debug.h>\n#include \"parser.h\"      // only for generateGroupId()\n#include \"node-translator.h\"\n\nuint64_t leafId;\n\ninline uint64_t getScopeId() { return leafId; }"
        }
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::Maybe<kj::StringTree> makeBrandDepInitializer(\n      InterfaceSchema::Method method, StructSchema type, kj::StringPtr suffix) {\n    auto typeProto = type.getProto();\n    if (typeProto.getScopeId() == 0) {\n      // This is an auto-generated params or results type.\n      auto name = cppFullName(method.getContainingInterface(), nullptr);\n      auto memberTypeName = kj::str(toTitleCase(protoName(method.getProto())), suffix);\n\n      if (typeProto.getParameters().size() == 0) {\n        name.addMemberType(memberTypeName);\n      } else {\n        // The method has implicit parameters (i.e. it's generic). For the purpose of the brand\n        // dep initializer, we only want to supply the default AnyPointer variant, so just don't\n        // pass any parameters here.\n        name.addMemberTemplate(memberTypeName, nullptr);\n      }\n      return makeBrandDepInitializer(type, kj::mv(name));\n    } else {\n      return makeBrandDepInitializer(type);\n    }\n  }"
  },
  {
    "function_name": "makeBrandDepInitializer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "755-757",
    "snippet": "kj::Maybe<kj::StringTree> makeBrandDepInitializer(Schema type) {\n    return makeBrandDepInitializer(type, cppFullName(type, nullptr));\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cppFullName",
          "args": [
            "type",
            "nullptr"
          ],
          "line": 756
        },
        "resolved": true,
        "details": {
          "function_name": "cppFullName",
          "container": "CapnpcCppMain",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "316-318",
          "snippet": "CppTypeName cppFullName(Schema schema, kj::Maybe<InterfaceSchema::Method> method) {\n    return cppFullName(schema, schema, method);\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCapnpcCppMain {\n  CppTypeName cppFullName(Schema schema, kj::Maybe<InterfaceSchema::Method> method) {\n      return cppFullName(schema, schema, method);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::Maybe<kj::StringTree> makeBrandDepInitializer(Schema type) {\n    return makeBrandDepInitializer(type, cppFullName(type, nullptr));\n  }"
  },
  {
    "function_name": "makeBrandDepInitializers",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "699-753",
    "snippet": "kj::StringTree makeBrandDepInitializers(const TemplateContext& templateContext, Schema schema) {\n    // Build deps. Returns a braced initialiser list, or an empty string if there are no dependencies.\n    std::map<uint, kj::StringTree> depMap;\n\n#define ADD_DEP(kind, index, ...) \\\n    { \\\n      uint location = _::RawBrandedSchema::makeDepLocation( \\\n          _::RawBrandedSchema::DepKind::kind, index); \\\n      KJ_IF_MAYBE(dep, makeBrandDepInitializer(__VA_ARGS__)) { \\\n        depMap[location] = kj::mv(*dep); \\\n      } \\\n    }\n\n    switch (schema.getProto().which()) {\n      case schema::Node::FILE:\n      case schema::Node::ENUM:\n      case schema::Node::ANNOTATION:\n        break;\n\n      case schema::Node::STRUCT:\n        for (auto field: schema.asStruct().getFields()) {\n          ADD_DEP(FIELD, field.getIndex(), field.getType());\n        }\n        break;\n      case schema::Node::INTERFACE: {\n        auto interface = schema.asInterface();\n        auto superclasses = interface.getSuperclasses();\n        for (auto i: kj::indices(superclasses)) {\n          ADD_DEP(SUPERCLASS, i, superclasses[i]);\n        }\n        auto methods = interface.getMethods();\n        for (auto i: kj::indices(methods)) {\n          auto method = methods[i];\n          ADD_DEP(METHOD_PARAMS, i, method, method.getParamType(), \"Params\");\n          ADD_DEP(METHOD_RESULTS, i, method, method.getResultType(), \"Results\");\n        }\n        break;\n      }\n      case schema::Node::CONST:\n        ADD_DEP(CONST_TYPE, 0, schema.asConst().getType());\n        break;\n    }\n#undef ADD_DEP\n\n    if (!depMap.size()) {\n      return kj::strTree();\n    }\n\n    auto deps = kj::heapArrayBuilder<kj::StringTree>(depMap.size());\n    for (auto& entry: depMap) {\n      deps.add(kj::strTree(\"  { \", entry.first, \", \", kj::mv(entry.second), \" },\\n\"));\n    }\n\n    return kj::strTree(\"{\\n\", kj::StringTree(deps.finish(), \"\"), \"}\");\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"{\\n\"",
            "kj::StringTree(deps.finish(), \"\")",
            "\"}\""
          ],
          "line": 752
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::StringTree",
          "args": [
            "deps.finish()",
            "\"\""
          ],
          "line": 752
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "deps.finish",
          "args": [],
          "line": 752
        },
        "resolved": true,
        "details": {
          "function_name": "finish",
          "container": "ArrayBuilder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "369-382",
          "snippet": "Array<T> finish() {\n    // We could safely remove this check if we assume that the disposer implementation doesn't\n    // need to know the original capacity, as is thes case with HeapArrayDisposer since it uses\n    // operator new() or if we created a custom disposer for ArrayBuilder which stores the capacity\n    // in a prefix.  But that would make it hard to write cleverer heap allocators, and anyway this\n    // check might catch bugs.  Probably people should use Vector if they want to build arrays\n    // without knowing the final size in advance.\n    KJ_IREQUIRE(pos == endPtr, \"ArrayBuilder::finish() called prematurely.\");\n    Array<T> result(reinterpret_cast<T*>(ptr), pos - ptr, *disposer);\n    ptr = nullptr;\n    pos = nullptr;\n    endPtr = nullptr;\n    return result;\n  }",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\nArrayBuilder {\n  Array<T> finish() {\n      // We could safely remove this check if we assume that the disposer implementation doesn't\n      // need to know the original capacity, as is thes case with HeapArrayDisposer since it uses\n      // operator new() or if we created a custom disposer for ArrayBuilder which stores the capacity\n      // in a prefix.  But that would make it hard to write cleverer heap allocators, and anyway this\n      // check might catch bugs.  Probably people should use Vector if they want to build arrays\n      // without knowing the final size in advance.\n      KJ_IREQUIRE(pos == endPtr, \"ArrayBuilder::finish() called prematurely.\");\n      Array<T> result(reinterpret_cast<T*>(ptr), pos - ptr, *disposer);\n      ptr = nullptr;\n      pos = nullptr;\n      endPtr = nullptr;\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "deps.add",
          "args": [
            "kj::strTree(\"  { \", entry.first, \", \", kj::mv(entry.second), \" },\\n\")"
          ],
          "line": 749
        },
        "resolved": true,
        "details": {
          "function_name": "add",
          "container": "ReusableObjects::ObjectSizeCounter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/null-common.h",
          "lines": "86-88",
          "snippet": "void add(size_t wordCount) {\n      maxSize = std::max(wordCount, maxSize);\n    }",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nReusableObjects {\n  ObjectSizeCounter {\n    void add(size_t wordCount) {\n          maxSize = std::max(wordCount, maxSize);\n        }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"  { \"",
            "entry.first",
            "\", \"",
            "kj::mv(entry.second)",
            "\" },\\n\""
          ],
          "line": 749
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "entry.second"
          ],
          "line": 749
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::heapArrayBuilder<kj::StringTree>",
          "args": [
            "depMap.size()"
          ],
          "line": 747
        },
        "resolved": true,
        "details": {
          "function_name": "heapArrayBuilder",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "410-416",
          "snippet": "inline ArrayBuilder<T> heapArrayBuilder(size_t size) {\n  // Like `heapArray<T>()` but does not default-construct the elements.  You must construct them\n  // manually by calling `add()`.\n\n  return ArrayBuilder<T>(_::HeapArrayDisposer::allocateUninitialized<RemoveConst<T>>(size),\n                         size, _::HeapArrayDisposer::instance);\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\ninline ArrayBuilder<T> heapArrayBuilder(size_t size) {\n  // Like `heapArray<T>()` but does not default-construct the elements.  You must construct them\n  // manually by calling `add()`.\n\n  return ArrayBuilder<T>(_::HeapArrayDisposer::allocateUninitialized<RemoveConst<T>>(size),\n                         size, _::HeapArrayDisposer::instance);\n}"
        }
      },
      {
        "call_info": {
          "callee": "depMap.size",
          "args": [],
          "line": 747
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-capnp.c++",
          "lines": "74-74",
          "snippet": "inline size_t size() const { return amount; }",
          "includes": [
            "#include \"config.h\"",
            "#include <map>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <map>\n#include <algorithm>\n#include <kj/main.h>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nIndent {\n  inline size_t size() const { return amount; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [],
          "line": 744
        },
        "resolved": true,
        "details": {
          "function_name": "strTree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
          "lines": "206-208",
          "snippet": "StringTree strTree(Params&&... params) {\n  return StringTree::concat(_::toStringTreeOrCharSequence(kj::fwd<Params>(params))...);\n}",
          "includes": [
            "#include \"string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"string.h\"\n\nStringTree strTree(Params&&... params) {\n  return StringTree::concat(_::toStringTreeOrCharSequence(kj::fwd<Params>(params))...);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADD_DEP",
          "args": [
            "CONST_TYPE",
            "0",
            "schema.asConst().getType()"
          ],
          "line": 738
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.asConst",
          "args": [],
          "line": 738
        },
        "resolved": true,
        "details": {
          "function_name": "asConst",
          "container": "ArrayPtr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "1127-1129",
          "snippet": "inline ArrayPtr<const T> asConst() const {\n    return ArrayPtr<const T>(ptr, size_);\n  }",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\nArrayPtr {\n  inline ArrayPtr<const T> asConst() const {\n      return ArrayPtr<const T>(ptr, size_);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ADD_DEP",
          "args": [
            "METHOD_RESULTS",
            "i",
            "method",
            "method.getResultType()",
            "\"Results\""
          ],
          "line": 733
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "method.getResultType",
          "args": [],
          "line": 733
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADD_DEP",
          "args": [
            "METHOD_PARAMS",
            "i",
            "method",
            "method.getParamType()",
            "\"Params\""
          ],
          "line": 732
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "method.getParamType",
          "args": [],
          "line": 732
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::indices",
          "args": [
            "methods"
          ],
          "line": 730
        },
        "resolved": true,
        "details": {
          "function_name": "indices",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "650-656",
          "snippet": "inline constexpr Range<size_t> indices(T&& container) {\n  // Shortcut for iterating over the indices of a container:\n  //\n  //     for (size_t i: kj::indices(myArray)) { handle(myArray[i]); }\n\n  return range<size_t>(0, kj::size(container));\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\ninline constexpr Range<size_t> indices(T&& container) {\n  // Shortcut for iterating over the indices of a container:\n  //\n  //     for (size_t i: kj::indices(myArray)) { handle(myArray[i]); }\n\n  return range<size_t>(0, kj::size(container));\n}"
        }
      },
      {
        "call_info": {
          "callee": "interface.getMethods",
          "args": [],
          "line": 729
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADD_DEP",
          "args": [
            "SUPERCLASS",
            "i",
            "superclasses[i]"
          ],
          "line": 727
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "interface.getSuperclasses",
          "args": [],
          "line": 725
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.asInterface",
          "args": [],
          "line": 724
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ADD_DEP",
          "args": [
            "FIELD",
            "field.getIndex()",
            "field.getType()"
          ],
          "line": 720
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getType",
          "args": [],
          "line": 720
        },
        "resolved": true,
        "details": {
          "function_name": "getType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.h",
          "lines": "942-942",
          "snippet": "inline DynamicValue::Type getType() { return type; }",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\"",
            "#include \"message.h\"",
            "#include \"layout.h\"",
            "#include \"schema.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n#include \"message.h\"\n#include \"layout.h\"\n#include \"schema.h\"\n\ninline DynamicValue::Type getType() { return type; }"
        }
      },
      {
        "call_info": {
          "callee": "field.getIndex",
          "args": [],
          "line": 720
        },
        "resolved": true,
        "details": {
          "function_name": "getIndex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "487-487",
          "snippet": "inline uint getIndex() const { return ordinal; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline uint getIndex() const { return ordinal; }"
        }
      },
      {
        "call_info": {
          "callee": "schema.asStruct",
          "args": [],
          "line": 719
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.asStruct",
          "args": [],
          "line": 719
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getProto",
          "args": [],
          "line": 712
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::StringTree makeBrandDepInitializers(const TemplateContext& templateContext, Schema schema) {\n    // Build deps. Returns a braced initialiser list, or an empty string if there are no dependencies.\n    std::map<uint, kj::StringTree> depMap;\n\n#define ADD_DEP(kind, index, ...) \\\n    { \\\n      uint location = _::RawBrandedSchema::makeDepLocation( \\\n          _::RawBrandedSchema::DepKind::kind, index); \\\n      KJ_IF_MAYBE(dep, makeBrandDepInitializer(__VA_ARGS__)) { \\\n        depMap[location] = kj::mv(*dep); \\\n      } \\\n    }\n\n    switch (schema.getProto().which()) {\n      case schema::Node::FILE:\n      case schema::Node::ENUM:\n      case schema::Node::ANNOTATION:\n        break;\n\n      case schema::Node::STRUCT:\n        for (auto field: schema.asStruct().getFields()) {\n          ADD_DEP(FIELD, field.getIndex(), field.getType());\n        }\n        break;\n      case schema::Node::INTERFACE: {\n        auto interface = schema.asInterface();\n        auto superclasses = interface.getSuperclasses();\n        for (auto i: kj::indices(superclasses)) {\n          ADD_DEP(SUPERCLASS, i, superclasses[i]);\n        }\n        auto methods = interface.getMethods();\n        for (auto i: kj::indices(methods)) {\n          auto method = methods[i];\n          ADD_DEP(METHOD_PARAMS, i, method, method.getParamType(), \"Params\");\n          ADD_DEP(METHOD_RESULTS, i, method, method.getResultType(), \"Results\");\n        }\n        break;\n      }\n      case schema::Node::CONST:\n        ADD_DEP(CONST_TYPE, 0, schema.asConst().getType());\n        break;\n    }\n#undef ADD_DEP\n\n    if (!depMap.size()) {\n      return kj::strTree();\n    }\n\n    auto deps = kj::heapArrayBuilder<kj::StringTree>(depMap.size());\n    for (auto& entry: depMap) {\n      deps.add(kj::strTree(\"  { \", entry.first, \", \", kj::mv(entry.second), \" },\\n\"));\n    }\n\n    return kj::strTree(\"{\\n\", kj::StringTree(deps.finish(), \"\"), \"}\");\n  }"
  },
  {
    "function_name": "makeBrandInitializers",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "672-697",
    "snippet": "BrandInitializerText makeBrandInitializers(\n      const TemplateContext& templateContext, Schema schema) {\n    auto scopeMap = templateContext.getScopeMap();\n\n    auto scopes = kj::heapArrayBuilder<kj::StringTree>(scopeMap.size());\n    kj::Vector<kj::StringTree> bindings(scopeMap.size() * 2);  // (estimate two params per scope)\n\n    for (auto& scope: scopeMap) {\n      scopes.add(kj::strTree(\"  { \",\n        \"0x\", kj::hex(scope.first), \", \"\n        \"brandBindings + \", bindings.size(), \", \",\n        scope.second.size(), \", \"\n        \"false\"\n      \"},\\n\"));\n\n      for (auto param: scope.second) {\n        bindings.add(kj::strTree(\"  ::capnp::_::brandBindingFor<\", param.getName(), \">(),\\n\"));\n      }\n    }\n\n    return {\n      kj::strTree(\"{\\n\", scopes.finish(), \"}\"),\n      kj::strTree(\"{\\n\", bindings.releaseAsArray(), \"}\"),\n      makeBrandDepInitializers(templateContext, schema)\n    };\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "makeBrandDepInitializers",
          "args": [
            "templateContext",
            "schema"
          ],
          "line": 695
        },
        "resolved": true,
        "details": {
          "function_name": "makeBrandDepInitializers",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "699-753",
          "snippet": "kj::StringTree makeBrandDepInitializers(const TemplateContext& templateContext, Schema schema) {\n    // Build deps. Returns a braced initialiser list, or an empty string if there are no dependencies.\n    std::map<uint, kj::StringTree> depMap;\n\n#define ADD_DEP(kind, index, ...) \\\n    { \\\n      uint location = _::RawBrandedSchema::makeDepLocation( \\\n          _::RawBrandedSchema::DepKind::kind, index); \\\n      KJ_IF_MAYBE(dep, makeBrandDepInitializer(__VA_ARGS__)) { \\\n        depMap[location] = kj::mv(*dep); \\\n      } \\\n    }\n\n    switch (schema.getProto().which()) {\n      case schema::Node::FILE:\n      case schema::Node::ENUM:\n      case schema::Node::ANNOTATION:\n        break;\n\n      case schema::Node::STRUCT:\n        for (auto field: schema.asStruct().getFields()) {\n          ADD_DEP(FIELD, field.getIndex(), field.getType());\n        }\n        break;\n      case schema::Node::INTERFACE: {\n        auto interface = schema.asInterface();\n        auto superclasses = interface.getSuperclasses();\n        for (auto i: kj::indices(superclasses)) {\n          ADD_DEP(SUPERCLASS, i, superclasses[i]);\n        }\n        auto methods = interface.getMethods();\n        for (auto i: kj::indices(methods)) {\n          auto method = methods[i];\n          ADD_DEP(METHOD_PARAMS, i, method, method.getParamType(), \"Params\");\n          ADD_DEP(METHOD_RESULTS, i, method, method.getResultType(), \"Results\");\n        }\n        break;\n      }\n      case schema::Node::CONST:\n        ADD_DEP(CONST_TYPE, 0, schema.asConst().getType());\n        break;\n    }\n#undef ADD_DEP\n\n    if (!depMap.size()) {\n      return kj::strTree();\n    }\n\n    auto deps = kj::heapArrayBuilder<kj::StringTree>(depMap.size());\n    for (auto& entry: depMap) {\n      deps.add(kj::strTree(\"  { \", entry.first, \", \", kj::mv(entry.second), \" },\\n\"));\n    }\n\n    return kj::strTree(\"{\\n\", kj::StringTree(deps.finish(), \"\"), \"}\");\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::StringTree makeBrandDepInitializers(const TemplateContext& templateContext, Schema schema) {\n    // Build deps. Returns a braced initialiser list, or an empty string if there are no dependencies.\n    std::map<uint, kj::StringTree> depMap;\n\n#define ADD_DEP(kind, index, ...) \\\n    { \\\n      uint location = _::RawBrandedSchema::makeDepLocation( \\\n          _::RawBrandedSchema::DepKind::kind, index); \\\n      KJ_IF_MAYBE(dep, makeBrandDepInitializer(__VA_ARGS__)) { \\\n        depMap[location] = kj::mv(*dep); \\\n      } \\\n    }\n\n    switch (schema.getProto().which()) {\n      case schema::Node::FILE:\n      case schema::Node::ENUM:\n      case schema::Node::ANNOTATION:\n        break;\n\n      case schema::Node::STRUCT:\n        for (auto field: schema.asStruct().getFields()) {\n          ADD_DEP(FIELD, field.getIndex(), field.getType());\n        }\n        break;\n      case schema::Node::INTERFACE: {\n        auto interface = schema.asInterface();\n        auto superclasses = interface.getSuperclasses();\n        for (auto i: kj::indices(superclasses)) {\n          ADD_DEP(SUPERCLASS, i, superclasses[i]);\n        }\n        auto methods = interface.getMethods();\n        for (auto i: kj::indices(methods)) {\n          auto method = methods[i];\n          ADD_DEP(METHOD_PARAMS, i, method, method.getParamType(), \"Params\");\n          ADD_DEP(METHOD_RESULTS, i, method, method.getResultType(), \"Results\");\n        }\n        break;\n      }\n      case schema::Node::CONST:\n        ADD_DEP(CONST_TYPE, 0, schema.asConst().getType());\n        break;\n    }\n#undef ADD_DEP\n\n    if (!depMap.size()) {\n      return kj::strTree();\n    }\n\n    auto deps = kj::heapArrayBuilder<kj::StringTree>(depMap.size());\n    for (auto& entry: depMap) {\n      deps.add(kj::strTree(\"  { \", entry.first, \", \", kj::mv(entry.second), \" },\\n\"));\n    }\n\n    return kj::strTree(\"{\\n\", kj::StringTree(deps.finish(), \"\"), \"}\");\n  }"
        }
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"{\\n\"",
            "bindings.releaseAsArray()",
            "\"}\""
          ],
          "line": 694
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bindings.releaseAsArray",
          "args": [],
          "line": 694
        },
        "resolved": true,
        "details": {
          "function_name": "releaseAsArray",
          "container": "Vector",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/vector.h",
          "lines": "66-72",
          "snippet": "inline Array<T> releaseAsArray() {\n    // TODO(perf):  Avoid a copy/move by allowing Array<T> to point to incomplete space?\n    if (!builder.isFull()) {\n      setCapacity(size());\n    }\n    return builder.finish();\n  }",
          "includes": [
            "#include \"array.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n\nVector {\n  inline Array<T> releaseAsArray() {\n      // TODO(perf):  Avoid a copy/move by allowing Array<T> to point to incomplete space?\n      if (!builder.isFull()) {\n        setCapacity(size());\n      }\n      return builder.finish();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"{\\n\"",
            "scopes.finish()",
            "\"}\""
          ],
          "line": 693
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scopes.finish",
          "args": [],
          "line": 693
        },
        "resolved": true,
        "details": {
          "function_name": "finish",
          "container": "ArrayBuilder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "369-382",
          "snippet": "Array<T> finish() {\n    // We could safely remove this check if we assume that the disposer implementation doesn't\n    // need to know the original capacity, as is thes case with HeapArrayDisposer since it uses\n    // operator new() or if we created a custom disposer for ArrayBuilder which stores the capacity\n    // in a prefix.  But that would make it hard to write cleverer heap allocators, and anyway this\n    // check might catch bugs.  Probably people should use Vector if they want to build arrays\n    // without knowing the final size in advance.\n    KJ_IREQUIRE(pos == endPtr, \"ArrayBuilder::finish() called prematurely.\");\n    Array<T> result(reinterpret_cast<T*>(ptr), pos - ptr, *disposer);\n    ptr = nullptr;\n    pos = nullptr;\n    endPtr = nullptr;\n    return result;\n  }",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\nArrayBuilder {\n  Array<T> finish() {\n      // We could safely remove this check if we assume that the disposer implementation doesn't\n      // need to know the original capacity, as is thes case with HeapArrayDisposer since it uses\n      // operator new() or if we created a custom disposer for ArrayBuilder which stores the capacity\n      // in a prefix.  But that would make it hard to write cleverer heap allocators, and anyway this\n      // check might catch bugs.  Probably people should use Vector if they want to build arrays\n      // without knowing the final size in advance.\n      KJ_IREQUIRE(pos == endPtr, \"ArrayBuilder::finish() called prematurely.\");\n      Array<T> result(reinterpret_cast<T*>(ptr), pos - ptr, *disposer);\n      ptr = nullptr;\n      pos = nullptr;\n      endPtr = nullptr;\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "bindings.add",
          "args": [
            "kj::strTree(\"  ::capnp::_::brandBindingFor<\", param.getName(), \">(),\\n\")"
          ],
          "line": 688
        },
        "resolved": true,
        "details": {
          "function_name": "add",
          "container": "ReusableObjects::ObjectSizeCounter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/null-common.h",
          "lines": "86-88",
          "snippet": "void add(size_t wordCount) {\n      maxSize = std::max(wordCount, maxSize);\n    }",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nReusableObjects {\n  ObjectSizeCounter {\n    void add(size_t wordCount) {\n          maxSize = std::max(wordCount, maxSize);\n        }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"  ::capnp::_::brandBindingFor<\"",
            "param.getName()",
            "\">(),\\n\""
          ],
          "line": 688
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "param.getName",
          "args": [],
          "line": 688
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"  { \"",
            "\"0x\"",
            "kj::hex(scope.first)",
            "\", \"\n        \"brandBindings + \"",
            "bindings.size()",
            "\", \"",
            "scope.second.size()",
            "\", \"\n        \"false\"\n      \"},\\n\""
          ],
          "line": 680
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scope.second.size",
          "args": [],
          "line": 683
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-capnp.c++",
          "lines": "74-74",
          "snippet": "inline size_t size() const { return amount; }",
          "includes": [
            "#include \"config.h\"",
            "#include <map>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <map>\n#include <algorithm>\n#include <kj/main.h>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nIndent {\n  inline size_t size() const { return amount; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::hex",
          "args": [
            "scope.first"
          ],
          "line": 681
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::heapArrayBuilder<kj::StringTree>",
          "args": [
            "scopeMap.size()"
          ],
          "line": 676
        },
        "resolved": true,
        "details": {
          "function_name": "heapArrayBuilder",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "410-416",
          "snippet": "inline ArrayBuilder<T> heapArrayBuilder(size_t size) {\n  // Like `heapArray<T>()` but does not default-construct the elements.  You must construct them\n  // manually by calling `add()`.\n\n  return ArrayBuilder<T>(_::HeapArrayDisposer::allocateUninitialized<RemoveConst<T>>(size),\n                         size, _::HeapArrayDisposer::instance);\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\ninline ArrayBuilder<T> heapArrayBuilder(size_t size) {\n  // Like `heapArray<T>()` but does not default-construct the elements.  You must construct them\n  // manually by calling `add()`.\n\n  return ArrayBuilder<T>(_::HeapArrayDisposer::allocateUninitialized<RemoveConst<T>>(size),\n                         size, _::HeapArrayDisposer::instance);\n}"
        }
      },
      {
        "call_info": {
          "callee": "templateContext.getScopeMap",
          "args": [],
          "line": 674
        },
        "resolved": true,
        "details": {
          "function_name": "getScopeMap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "645-659",
          "snippet": "std::map<uint64_t, List<schema::Node::Parameter>::Reader> getScopeMap() const {\n      std::map<uint64_t, List<schema::Node::Parameter>::Reader> result;\n      const TemplateContext* current = this;\n      for (;;) {\n        auto params = current->node.getParameters();\n        if (params.size() > 0) {\n          result[current->node.getId()] = params;\n        }\n        KJ_IF_MAYBE(p, current->parent) {\n          current = p;\n        } else {\n          return result;\n        }\n      }\n    }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "schema::Node::Reader node;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nschema::Node::Reader node;\n\nstd::map<uint64_t, List<schema::Node::Parameter>::Reader> getScopeMap() const {\n      std::map<uint64_t, List<schema::Node::Parameter>::Reader> result;\n      const TemplateContext* current = this;\n      for (;;) {\n        auto params = current->node.getParameters();\n        if (params.size() > 0) {\n          result[current->node.getId()] = params;\n        }\n        KJ_IF_MAYBE(p, current->parent) {\n          current = p;\n        } else {\n          return result;\n        }\n      }\n    }"
        }
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nBrandInitializerText makeBrandInitializers(\n      const TemplateContext& templateContext, Schema schema) {\n    auto scopeMap = templateContext.getScopeMap();\n\n    auto scopes = kj::heapArrayBuilder<kj::StringTree>(scopeMap.size());\n    kj::Vector<kj::StringTree> bindings(scopeMap.size() * 2);  // (estimate two params per scope)\n\n    for (auto& scope: scopeMap) {\n      scopes.add(kj::strTree(\"  { \",\n        \"0x\", kj::hex(scope.first), \", \"\n        \"brandBindings + \", bindings.size(), \", \",\n        scope.second.size(), \", \"\n        \"false\"\n      \"},\\n\"));\n\n      for (auto param: scope.second) {\n        bindings.add(kj::strTree(\"  ::capnp::_::brandBindingFor<\", param.getName(), \">(),\\n\"));\n      }\n    }\n\n    return {\n      kj::strTree(\"{\\n\", scopes.finish(), \"}\"),\n      kj::strTree(\"{\\n\", bindings.releaseAsArray(), \"}\"),\n      makeBrandDepInitializers(templateContext, schema)\n    };\n  }"
  },
  {
    "function_name": "getScopeMap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "645-659",
    "snippet": "std::map<uint64_t, List<schema::Node::Parameter>::Reader> getScopeMap() const {\n      std::map<uint64_t, List<schema::Node::Parameter>::Reader> result;\n      const TemplateContext* current = this;\n      for (;;) {\n        auto params = current->node.getParameters();\n        if (params.size() > 0) {\n          result[current->node.getId()] = params;\n        }\n        KJ_IF_MAYBE(p, current->parent) {\n          current = p;\n        } else {\n          return result;\n        }\n      }\n    }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "schema::Node::Reader node;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "KJ_IF_MAYBE",
          "args": [
            "p",
            "current->parent"
          ],
          "line": 653
        },
        "resolved": true,
        "details": {
          "function_name": "KJ_IF_MAYBE",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/parser.c++",
          "lines": "982-1016",
          "snippet": "KJ_IF_MAYBE(target, maybeTarget) {\n            if (target->value == \"*\") {\n              // Set all.\n              if (targets.value.size() > 1) {\n                errorReporter.addError(target->startByte, target->endByte,\n                    \"Wildcard should not be specified together with other targets.\");\n              }\n\n              for (auto field: dynamicBuilder.getSchema().getFields()) {\n                if (field.getProto().getName().startsWith(\"targets\")) {\n                  dynamicBuilder.set(field, true);\n                }\n              }\n            } else {\n              if (target->value.size() == 0 || target->value.size() >= 32 ||\n                  target->value[0] < 'a' || target->value[0] > 'z') {\n                errorReporter.addError(target->startByte, target->endByte,\n                                       \"Not a valid annotation target.\");\n              } else {\n                char buffer[64];\n                strcpy(buffer, \"targets\");\n                strcat(buffer, target->value.cStr());\n                buffer[strlen(\"targets\")] += 'A' - 'a';\n                KJ_IF_MAYBE(field, dynamicBuilder.getSchema().findFieldByName(buffer)) {\n                  if (dynamicBuilder.get(*field).as<bool>()) {\n                    errorReporter.addError(target->startByte, target->endByte,\n                                           \"Duplicate target specification.\");\n                  }\n                  dynamicBuilder.set(*field, true);\n                } else {\n                  errorReporter.addError(target->startByte, target->endByte,\n                                         \"Not a valid annotation target.\");\n                }\n              }\n            }",
          "includes": [
            "#include <windows.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <kj/debug.h>",
            "#include <capnp/dynamic.h>",
            "#include \"md5.h\"",
            "#include \"parser.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <windows.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <kj/debug.h>\n#include <capnp/dynamic.h>\n#include \"md5.h\"\n#include \"parser.h\"\n\nKJ_IF_MAYBE(target, maybeTarget) {\n            if (target->value == \"*\") {\n              // Set all.\n              if (targets.value.size() > 1) {\n                errorReporter.addError(target->startByte, target->endByte,\n                    \"Wildcard should not be specified together with other targets.\");\n              }\n\n              for (auto field: dynamicBuilder.getSchema().getFields()) {\n                if (field.getProto().getName().startsWith(\"targets\")) {\n                  dynamicBuilder.set(field, true);\n                }\n              }\n            } else {\n              if (target->value.size() == 0 || target->value.size() >= 32 ||\n                  target->value[0] < 'a' || target->value[0] > 'z') {\n                errorReporter.addError(target->startByte, target->endByte,\n                                       \"Not a valid annotation target.\");\n              } else {\n                char buffer[64];\n                strcpy(buffer, \"targets\");\n                strcat(buffer, target->value.cStr());\n                buffer[strlen(\"targets\")] += 'A' - 'a';\n                KJ_IF_MAYBE(field, dynamicBuilder.getSchema().findFieldByName(buffer)) {\n                  if (dynamicBuilder.get(*field).as<bool>()) {\n                    errorReporter.addError(target->startByte, target->endByte,\n                                           \"Duplicate target specification.\");\n                  }\n                  dynamicBuilder.set(*field, true);\n                } else {\n                  errorReporter.addError(target->startByte, target->endByte,\n                                         \"Not a valid annotation target.\");\n                }\n              }\n            }"
        }
      },
      {
        "call_info": {
          "callee": "current->node.getId",
          "args": [],
          "line": 651
        },
        "resolved": true,
        "details": {
          "function_name": "getId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
          "lines": "75-75",
          "snippet": "uint64_t getId() { return id; }",
          "includes": [
            "#include \"md5.h\"",
            "#include \"node-translator.h\"",
            "#include <unordered_map>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/message.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/arena.h>",
            "#include <kj/mutex.h>",
            "#include \"parser.h\"      // only for generateChildId()",
            "#include \"compiler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nuint64_t getId() { return id; }"
        }
      },
      {
        "call_info": {
          "callee": "params.size",
          "args": [],
          "line": 650
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-capnp.c++",
          "lines": "74-74",
          "snippet": "inline size_t size() const { return amount; }",
          "includes": [
            "#include \"config.h\"",
            "#include <map>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <map>\n#include <algorithm>\n#include <kj/main.h>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nIndent {\n  inline size_t size() const { return amount; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "current->node.getParameters",
          "args": [],
          "line": 649
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nschema::Node::Reader node;\n\nstd::map<uint64_t, List<schema::Node::Parameter>::Reader> getScopeMap() const {\n      std::map<uint64_t, List<schema::Node::Parameter>::Reader> result;\n      const TemplateContext* current = this;\n      for (;;) {\n        auto params = current->node.getParameters();\n        if (params.size() > 0) {\n          result[current->node.getId()] = params;\n        }\n        KJ_IF_MAYBE(p, current->parent) {\n          current = p;\n        } else {\n          return result;\n        }\n      }\n    }"
  },
  {
    "function_name": "allArgs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "625-643",
    "snippet": "kj::StringTree allArgs() const {\n      // \"S, T, U, V\" -- listing all args for all enclosing scopes starting from the outermost.\n\n      auto params = node.getParameters();\n\n      kj::StringTree self(KJ_MAP(p, params) { return kj::strTree(p.getName()); }, \", \");\n      kj::StringTree up;\n      KJ_IF_MAYBE(p, parent) {\n        up = p->allArgs();\n      }\n\n      if (self.size() == 0) {\n        return up;\n      } else if (up.size() == 0) {\n        return self;\n      } else {\n        return kj::strTree(kj::mv(up), \", \", kj::mv(self));\n      }\n    }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "schema::Node::Reader node;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "kj::mv(up)",
            "\", \"",
            "kj::mv(self)"
          ],
          "line": 641
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "self"
          ],
          "line": 641
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "up"
          ],
          "line": 641
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "up.size",
          "args": [],
          "line": 638
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-capnp.c++",
          "lines": "74-74",
          "snippet": "inline size_t size() const { return amount; }",
          "includes": [
            "#include \"config.h\"",
            "#include <map>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <map>\n#include <algorithm>\n#include <kj/main.h>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nIndent {\n  inline size_t size() const { return amount; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "p->allArgs",
          "args": [],
          "line": 633
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "p.getName()"
          ],
          "line": 630
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p.getName",
          "args": [],
          "line": 630
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "p",
            "params"
          ],
          "line": 630
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "node.getParameters",
          "args": [],
          "line": 628
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nschema::Node::Reader node;\n\nkj::StringTree allArgs() const {\n      // \"S, T, U, V\" -- listing all args for all enclosing scopes starting from the outermost.\n\n      auto params = node.getParameters();\n\n      kj::StringTree self(KJ_MAP(p, params) { return kj::strTree(p.getName()); }, \", \");\n      kj::StringTree up;\n      KJ_IF_MAYBE(p, parent) {\n        up = p->allArgs();\n      }\n\n      if (self.size() == 0) {\n        return up;\n      } else if (up.size() == 0) {\n        return self;\n      } else {\n        return kj::strTree(kj::mv(up), \", \", kj::mv(self));\n      }\n    }"
  },
  {
    "function_name": "kj::StringTree args",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "564-623",
    "snippet": "class TemplateContext {\n  public:\n    TemplateContext(): parent(nullptr) {}\n    explicit TemplateContext(schema::Node::Reader node)\n        : parent(nullptr), node(node) {}\n    TemplateContext(const TemplateContext& parent, schema::Node::Reader node)\n        : parent(parent), node(node) {}\n\n    bool hasParams() const {\n      return node.getParameters().size() > 0;\n    }\n    bool isGeneric() const {\n      return node.getIsGeneric();\n    }\n\n    kj::StringTree decl(bool withDefaults) const {\n      // \"template <typename T, typename U>\" for this type. Includes default assignments\n      // (\"= ::capnp::AnyPointer\") if `withDefaults` is true. Returns empty string if this type\n      // is not parameterized.\n\n      auto params = node.getParameters();\n\n      if (params.size() == 0) {\n        return kj::strTree();\n      } else {\n        return kj::strTree(\n            \"template <\", kj::StringTree(KJ_MAP(p, params) {\n              return kj::strTree(\"typename \", p.getName(),\n                  withDefaults ? \" = ::capnp::AnyPointer\" : \"\");\n            }, \", \"), \">\\n\");\n      }\n    }\n\n    kj::StringTree allDecls() const {\n      // Decl for each generic parent plus this type, one per line.\n      return kj::strTree(parentDecls(), decl(false));\n    }\n\n    kj::StringTree parentDecls() const {\n      // Decls just for the parents.\n      KJ_IF_MAYBE(p, parent) {\n        return p->allDecls();\n      } else {\n        return kj::strTree();\n      }\n    }\n\n    kj::StringTree args() const {\n      // \"<T, U>\" for this type.\n      auto params = node.getParameters();\n\n      if (params.size() == 0) {\n        return kj::strTree();\n      } else {\n        return kj::strTree(\n            \"<\", kj::StringTree(KJ_MAP(p, params) {\n              return kj::strTree(p.getName());\n            }, \", \"), \">\");\n      }\n    }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "schema::Node::Reader node;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"<\"",
            "kj::StringTree(KJ_MAP(p, params) {\n              return kj::strTree(p.getName());\n            }, \", \")",
            "\">\""
          ],
          "line": 618
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::StringTree",
          "args": [
            "KJ_MAP(p, params){\n              return kj::strTree(p.getName());\n            }",
            "\", \""
          ],
          "line": 619
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "p.getName()"
          ],
          "line": 620
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p.getName",
          "args": [],
          "line": 620
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "p",
            "params"
          ],
          "line": 619
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [],
          "line": 616
        },
        "resolved": true,
        "details": {
          "function_name": "strTree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string-tree.h",
          "lines": "206-208",
          "snippet": "StringTree strTree(Params&&... params) {\n  return StringTree::concat(_::toStringTreeOrCharSequence(kj::fwd<Params>(params))...);\n}",
          "includes": [
            "#include \"string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"string.h\"\n\nStringTree strTree(Params&&... params) {\n  return StringTree::concat(_::toStringTreeOrCharSequence(kj::fwd<Params>(params))...);\n}"
        }
      },
      {
        "call_info": {
          "callee": "params.size",
          "args": [],
          "line": 615
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-capnp.c++",
          "lines": "74-74",
          "snippet": "inline size_t size() const { return amount; }",
          "includes": [
            "#include \"config.h\"",
            "#include <map>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <map>\n#include <algorithm>\n#include <kj/main.h>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nIndent {\n  inline size_t size() const { return amount; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "node.getParameters",
          "args": [],
          "line": 613
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p->allDecls",
          "args": [],
          "line": 605
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "parentDecls()",
            "decl(false)"
          ],
          "line": 599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decl",
          "args": [
            "false"
          ],
          "line": 599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parentDecls",
          "args": [],
          "line": 599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"template <\"",
            "kj::StringTree(KJ_MAP(p, params) {\n              return kj::strTree(\"typename \", p.getName(),\n                  withDefaults ? \" = ::capnp::AnyPointer\" : \"\");\n            }, \", \")",
            "\">\\n\""
          ],
          "line": 589
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::StringTree",
          "args": [
            "KJ_MAP(p, params){\n              return kj::strTree(\"typename \", p.getName(),\n                  withDefaults ? \" = ::capnp::AnyPointer\" : \"\");\n            }",
            "\", \""
          ],
          "line": 590
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"typename \"",
            "p.getName()",
            "withDefaults ? \" = ::capnp::AnyPointer\" : \"\""
          ],
          "line": 591
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p.getName",
          "args": [],
          "line": 591
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "p",
            "params"
          ],
          "line": 590
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "node.getParameters",
          "args": [],
          "line": 584
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "node.getIsGeneric",
          "args": [],
          "line": 576
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "node.getParameters",
          "args": [],
          "line": 573
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "node.getParameters",
          "args": [],
          "line": 573
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nschema::Node::Reader node;\n\nclass TemplateContext {\n  public:\n    TemplateContext(): parent(nullptr) {}\n    explicit TemplateContext(schema::Node::Reader node)\n        : parent(nullptr), node(node) {}\n    TemplateContext(const TemplateContext& parent, schema::Node::Reader node)\n        : parent(parent), node(node) {}\n\n    bool hasParams() const {\n      return node.getParameters().size() > 0;\n    }\n    bool isGeneric() const {\n      return node.getIsGeneric();\n    }\n\n    kj::StringTree decl(bool withDefaults) const {\n      // \"template <typename T, typename U>\" for this type. Includes default assignments\n      // (\"= ::capnp::AnyPointer\") if `withDefaults` is true. Returns empty string if this type\n      // is not parameterized.\n\n      auto params = node.getParameters();\n\n      if (params.size() == 0) {\n        return kj::strTree();\n      } else {\n        return kj::strTree(\n            \"template <\", kj::StringTree(KJ_MAP(p, params) {\n              return kj::strTree(\"typename \", p.getName(),\n                  withDefaults ? \" = ::capnp::AnyPointer\" : \"\");\n            }, \", \"), \">\\n\");\n      }\n    }\n\n    kj::StringTree allDecls() const {\n      // Decl for each generic parent plus this type, one per line.\n      return kj::strTree(parentDecls(), decl(false));\n    }\n\n    kj::StringTree parentDecls() const {\n      // Decls just for the parents.\n      KJ_IF_MAYBE(p, parent) {\n        return p->allDecls();\n      } else {\n        return kj::strTree();\n      }\n    }\n\n    kj::StringTree args() const {\n      // \"<T, U>\" for this type.\n      auto params = node.getParameters();\n\n      if (params.size() == 0) {\n        return kj::strTree();\n      } else {\n        return kj::strTree(\n            \"<\", kj::StringTree(KJ_MAP(p, params) {\n              return kj::strTree(p.getName());\n            }, \", \"), \">\");\n      }\n    }"
  },
  {
    "function_name": "literalValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "517-560",
    "snippet": "kj::StringTree literalValue(Type type, schema::Value::Reader value) {\n    switch (value.which()) {\n      case schema::Value::VOID: return kj::strTree(\" ::capnp::VOID\");\n      case schema::Value::BOOL: return kj::strTree(value.getBool() ? \"true\" : \"false\");\n      case schema::Value::INT8: return kj::strTree(value.getInt8());\n      case schema::Value::INT16: return kj::strTree(value.getInt16());\n      case schema::Value::INT32: return kj::strTree(value.getInt32());\n      case schema::Value::INT64: return kj::strTree(value.getInt64(), \"ll\");\n      case schema::Value::UINT8: return kj::strTree(value.getUint8(), \"u\");\n      case schema::Value::UINT16: return kj::strTree(value.getUint16(), \"u\");\n      case schema::Value::UINT32: return kj::strTree(value.getUint32(), \"u\");\n      case schema::Value::UINT64: return kj::strTree(value.getUint64(), \"llu\");\n      case schema::Value::FLOAT32: {\n        auto text = kj::str(value.getFloat32());\n        if (text.findFirst('.') == nullptr &&\n            text.findFirst('e') == nullptr &&\n            text.findFirst('E') == nullptr) {\n          text = kj::str(text, \".0\");\n        }\n        return kj::strTree(kj::mv(text), \"f\");\n      }\n      case schema::Value::FLOAT64: return kj::strTree(value.getFloat64());\n      case schema::Value::ENUM: {\n        EnumSchema schema = type.asEnum();\n        if (value.getEnum() < schema.getEnumerants().size()) {\n          return kj::strTree(\n              cppFullName(schema, nullptr), \"::\",\n              toUpperCase(protoName(schema.getEnumerants()[value.getEnum()].getProto())));\n        } else {\n          return kj::strTree(\"static_cast<\", cppFullName(schema, nullptr),\n                             \">(\", value.getEnum(), \")\");\n        }\n      }\n\n      case schema::Value::TEXT:\n      case schema::Value::DATA:\n      case schema::Value::STRUCT:\n      case schema::Value::INTERFACE:\n      case schema::Value::LIST:\n      case schema::Value::ANY_POINTER:\n        KJ_FAIL_REQUIRE(\"literalValue() can only be used on primitive types.\");\n    }\n    KJ_UNREACHABLE;\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "KJ_FAIL_REQUIRE",
          "args": [
            "\"literalValue() can only be used on primitive types.\""
          ],
          "line": 557
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"static_cast<\"",
            "cppFullName(schema, nullptr)",
            "\">(\"",
            "value.getEnum()",
            "\")\""
          ],
          "line": 546
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.getEnum",
          "args": [],
          "line": 547
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cppFullName",
          "args": [
            "schema",
            "nullptr"
          ],
          "line": 546
        },
        "resolved": true,
        "details": {
          "function_name": "cppFullName",
          "container": "CapnpcCppMain",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "316-318",
          "snippet": "CppTypeName cppFullName(Schema schema, kj::Maybe<InterfaceSchema::Method> method) {\n    return cppFullName(schema, schema, method);\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCapnpcCppMain {\n  CppTypeName cppFullName(Schema schema, kj::Maybe<InterfaceSchema::Method> method) {\n      return cppFullName(schema, schema, method);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "cppFullName(schema, nullptr)",
            "\"::\"",
            "toUpperCase(protoName(schema.getEnumerants()[value.getEnum()].getProto()))"
          ],
          "line": 542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "toUpperCase",
          "args": [
            "protoName(schema.getEnumerants()[value.getEnum()].getProto())"
          ],
          "line": 544
        },
        "resolved": true,
        "details": {
          "function_name": "toUpperCase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "404-421",
          "snippet": "kj::String toUpperCase(kj::StringPtr name) {\n    kj::Vector<char> result(name.size() + 4);\n\n    for (char c: name) {\n      if ('a' <= c && c <= 'z') {\n        result.add(c - 'a' + 'A');\n      } else if (result.size() > 0 && 'A' <= c && c <= 'Z') {\n        result.add('_');\n        result.add(c);\n      } else {\n        result.add(c);\n      }\n    }\n\n    result.add('\\0');\n\n    return kj::String(result.releaseAsArray());\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::String toUpperCase(kj::StringPtr name) {\n    kj::Vector<char> result(name.size() + 4);\n\n    for (char c: name) {\n      if ('a' <= c && c <= 'z') {\n        result.add(c - 'a' + 'A');\n      } else if (result.size() > 0 && 'A' <= c && c <= 'Z') {\n        result.add('_');\n        result.add(c);\n      } else {\n        result.add(c);\n      }\n    }\n\n    result.add('\\0');\n\n    return kj::String(result.releaseAsArray());\n  }"
        }
      },
      {
        "call_info": {
          "callee": "protoName",
          "args": [
            "schema.getEnumerants()[value.getEnum()].getProto()"
          ],
          "line": 544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getEnumerants",
          "args": [],
          "line": 544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.getEnum",
          "args": [],
          "line": 544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getEnumerants",
          "args": [],
          "line": 544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getEnumerants",
          "args": [],
          "line": 541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schema.getEnumerants",
          "args": [],
          "line": 541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.getEnum",
          "args": [],
          "line": 541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.asEnum",
          "args": [],
          "line": 540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "value.getFloat64()"
          ],
          "line": 538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.getFloat64",
          "args": [],
          "line": 538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "kj::mv(text)",
            "\"f\""
          ],
          "line": 536
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "text"
          ],
          "line": 536
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "text",
            "\".0\""
          ],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "text.findFirst",
          "args": [
            "'E'"
          ],
          "line": 533
        },
        "resolved": true,
        "details": {
          "function_name": "findFirst",
          "container": "String",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "182-182",
          "snippet": "inline Maybe<size_t> findFirst(char c) const { return StringPtr(*this).findFirst(c); }",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\nString {\n  inline Maybe<size_t> findFirst(char c) const { return StringPtr(*this).findFirst(c); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "value.getFloat32()"
          ],
          "line": 530
        },
        "resolved": true,
        "details": {
          "function_name": "str",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "341-341",
          "snippet": "inline String str(String&& s) { return mv(s); }",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\ninline String str(String&& s) { return mv(s); }"
        }
      },
      {
        "call_info": {
          "callee": "value.getFloat32",
          "args": [],
          "line": 530
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "value.getUint64()",
            "\"llu\""
          ],
          "line": 528
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.getUint64",
          "args": [],
          "line": 528
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "value.getUint32()",
            "\"u\""
          ],
          "line": 527
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.getUint32",
          "args": [],
          "line": 527
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "value.getUint16()",
            "\"u\""
          ],
          "line": 526
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.getUint16",
          "args": [],
          "line": 526
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "value.getUint8()",
            "\"u\""
          ],
          "line": 525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.getUint8",
          "args": [],
          "line": 525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "value.getInt64()",
            "\"ll\""
          ],
          "line": 524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.getInt64",
          "args": [],
          "line": 524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "value.getInt32()"
          ],
          "line": 523
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.getInt32",
          "args": [],
          "line": 523
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "value.getInt16()"
          ],
          "line": 522
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.getInt16",
          "args": [],
          "line": 522
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "value.getInt8()"
          ],
          "line": 521
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.getInt8",
          "args": [],
          "line": 521
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "value.getBool() ? \"true\" : \"false\""
          ],
          "line": 520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.getBool",
          "args": [],
          "line": 520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\" ::capnp::VOID\""
          ],
          "line": 519
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.which",
          "args": [],
          "line": 518
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::StringTree literalValue(Type type, schema::Value::Reader value) {\n    switch (value.which()) {\n      case schema::Value::VOID: return kj::strTree(\" ::capnp::VOID\");\n      case schema::Value::BOOL: return kj::strTree(value.getBool() ? \"true\" : \"false\");\n      case schema::Value::INT8: return kj::strTree(value.getInt8());\n      case schema::Value::INT16: return kj::strTree(value.getInt16());\n      case schema::Value::INT32: return kj::strTree(value.getInt32());\n      case schema::Value::INT64: return kj::strTree(value.getInt64(), \"ll\");\n      case schema::Value::UINT8: return kj::strTree(value.getUint8(), \"u\");\n      case schema::Value::UINT16: return kj::strTree(value.getUint16(), \"u\");\n      case schema::Value::UINT32: return kj::strTree(value.getUint32(), \"u\");\n      case schema::Value::UINT64: return kj::strTree(value.getUint64(), \"llu\");\n      case schema::Value::FLOAT32: {\n        auto text = kj::str(value.getFloat32());\n        if (text.findFirst('.') == nullptr &&\n            text.findFirst('e') == nullptr &&\n            text.findFirst('E') == nullptr) {\n          text = kj::str(text, \".0\");\n        }\n        return kj::strTree(kj::mv(text), \"f\");\n      }\n      case schema::Value::FLOAT64: return kj::strTree(value.getFloat64());\n      case schema::Value::ENUM: {\n        EnumSchema schema = type.asEnum();\n        if (value.getEnum() < schema.getEnumerants().size()) {\n          return kj::strTree(\n              cppFullName(schema, nullptr), \"::\",\n              toUpperCase(protoName(schema.getEnumerants()[value.getEnum()].getProto())));\n        } else {\n          return kj::strTree(\"static_cast<\", cppFullName(schema, nullptr),\n                             \">(\", value.getEnum(), \")\");\n        }\n      }\n\n      case schema::Value::TEXT:\n      case schema::Value::DATA:\n      case schema::Value::STRUCT:\n      case schema::Value::INTERFACE:\n      case schema::Value::LIST:\n      case schema::Value::ANY_POINTER:\n        KJ_FAIL_REQUIRE(\"literalValue() can only be used on primitive types.\");\n    }\n    KJ_UNREACHABLE;\n  }"
  },
  {
    "function_name": "protoName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "509-515",
    "snippet": "kj::StringPtr protoName(P proto) {\n    KJ_IF_MAYBE(name, annotationValue(proto, NAME_ANNOTATION_ID)) {\n      return name->getText();\n    } else {\n      return proto.getName();\n    }\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "return proto.getName",
          "args": [],
          "line": 513
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "name->getText",
          "args": [],
          "line": 511
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::StringPtr protoName(P proto) {\n    KJ_IF_MAYBE(name, annotationValue(proto, NAME_ANNOTATION_ID)) {\n      return name->getText();\n    } else {\n      return proto.getName();\n    }\n  }"
  },
  {
    "function_name": "annotationValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "499-506",
    "snippet": "kj::Maybe<schema::Value::Reader> annotationValue(P proto, uint64_t annotationId) {\n    for (auto annotation: proto.getAnnotations()) {\n      if (annotation.getId() == annotationId) {\n        return annotation.getValue();\n      }\n    }\n    return nullptr;\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "annotation.getValue",
          "args": [],
          "line": 502
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "annotation.getId",
          "args": [],
          "line": 501
        },
        "resolved": true,
        "details": {
          "function_name": "getId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
          "lines": "75-75",
          "snippet": "uint64_t getId() { return id; }",
          "includes": [
            "#include \"md5.h\"",
            "#include \"node-translator.h\"",
            "#include <unordered_map>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/message.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/arena.h>",
            "#include <kj/mutex.h>",
            "#include \"parser.h\"      // only for generateChildId()",
            "#include \"compiler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nuint64_t getId() { return id; }"
        }
      },
      {
        "call_info": {
          "callee": "proto.getAnnotations",
          "args": [],
          "line": 500
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::Maybe<schema::Value::Reader> annotationValue(P proto, uint64_t annotationId) {\n    for (auto annotation: proto.getAnnotations()) {\n      if (annotation.getId() == annotationId) {\n        return annotation.getValue();\n      }\n    }\n    return nullptr;\n  }"
  },
  {
    "function_name": "typeName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "431-491",
    "snippet": "CppTypeName typeName(Type type, kj::Maybe<InterfaceSchema::Method> method) {\n    switch (type.which()) {\n      case schema::Type::VOID: return CppTypeName::makePrimitive(\" ::capnp::Void\");\n\n      case schema::Type::BOOL: return CppTypeName::makePrimitive(\"bool\");\n      case schema::Type::INT8: return CppTypeName::makePrimitive(\" ::int8_t\");\n      case schema::Type::INT16: return CppTypeName::makePrimitive(\" ::int16_t\");\n      case schema::Type::INT32: return CppTypeName::makePrimitive(\" ::int32_t\");\n      case schema::Type::INT64: return CppTypeName::makePrimitive(\" ::int64_t\");\n      case schema::Type::UINT8: return CppTypeName::makePrimitive(\" ::uint8_t\");\n      case schema::Type::UINT16: return CppTypeName::makePrimitive(\" ::uint16_t\");\n      case schema::Type::UINT32: return CppTypeName::makePrimitive(\" ::uint32_t\");\n      case schema::Type::UINT64: return CppTypeName::makePrimitive(\" ::uint64_t\");\n      case schema::Type::FLOAT32: return CppTypeName::makePrimitive(\"float\");\n      case schema::Type::FLOAT64: return CppTypeName::makePrimitive(\"double\");\n\n      case schema::Type::TEXT: return CppTypeName::makePrimitive(\" ::capnp::Text\");\n      case schema::Type::DATA: return CppTypeName::makePrimitive(\" ::capnp::Data\");\n\n      case schema::Type::ENUM:\n        return cppFullName(type.asEnum(), method);\n      case schema::Type::STRUCT:\n        return cppFullName(type.asStruct(), method);\n      case schema::Type::INTERFACE: {\n        auto result = cppFullName(type.asInterface(), method);\n        result.setHasInterfaces();\n        return result;\n      }\n\n      case schema::Type::LIST: {\n        CppTypeName result = CppTypeName::makeNamespace(\"capnp\");\n        auto params = kj::heapArrayBuilder<CppTypeName>(1);\n        params.add(typeName(type.asList().getElementType(), method));\n        result.addMemberTemplate(\"List\", params.finish());\n        return result;\n      }\n\n      case schema::Type::ANY_POINTER:\n        KJ_IF_MAYBE(param, type.getBrandParameter()) {\n          return CppTypeName::makeTemplateParam(schemaLoader.get(param->scopeId).getProto()\n              .getParameters()[param->index].getName());\n        } else KJ_IF_MAYBE(param, type.getImplicitParameter()) {\n          KJ_IF_MAYBE(m, method) {\n            auto params = m->getProto().getImplicitParameters();\n            KJ_REQUIRE(param->index < params.size());\n            return CppTypeName::makeTemplateParam(params[param->index].getName());\n          } else {\n            return CppTypeName::makePrimitive(\" ::capnp::AnyPointer\");\n          }\n        } else {\n          switch (type.whichAnyPointerKind()) {\n            case schema::Type::AnyPointer::Unconstrained::ANY_KIND:\n              return CppTypeName::makePrimitive(\" ::capnp::AnyPointer\");\n            case schema::Type::AnyPointer::Unconstrained::STRUCT:\n              return CppTypeName::makePrimitive(\" ::capnp::AnyStruct\");\n            case schema::Type::AnyPointer::Unconstrained::LIST:\n              return CppTypeName::makePrimitive(\" ::capnp::AnyList\");\n            case schema::Type::AnyPointer::Unconstrained::CAPABILITY:\n              hasInterfaces = true;  // Probably need to #inculde <capnp/capability.h>.\n              return CppTypeName::makePrimitive(\" ::capnp::Capability\");\n          }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CppTypeName::makePrimitive",
          "args": [
            "\" ::capnp::Capability\""
          ],
          "line": 490
        },
        "resolved": true,
        "details": {
          "function_name": "makePrimitive",
          "container": "CppTypeName",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "202-204",
          "snippet": "static CppTypeName makePrimitive(kj::StringPtr name) {\n    return CppTypeName(kj::strTree(name), false);\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName {\n  static CppTypeName makePrimitive(kj::StringPtr name) {\n      return CppTypeName(kj::strTree(name), false);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "switch",
          "args": [
            "type.whichAnyPointerKind()"
          ],
          "line": 481
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.whichAnyPointerKind",
          "args": [],
          "line": 481
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CppTypeName::makeTemplateParam",
          "args": [
            "params[param->index].getName()"
          ],
          "line": 476
        },
        "resolved": true,
        "details": {
          "function_name": "makeTemplateParam",
          "container": "CppTypeName",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "198-200",
          "snippet": "static CppTypeName makeTemplateParam(kj::StringPtr name) {\n    return CppTypeName(kj::strTree(name), true);\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName {\n  static CppTypeName makeTemplateParam(kj::StringPtr name) {\n      return CppTypeName(kj::strTree(name), true);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "params[param->index].getName",
          "args": [],
          "line": 476
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "param->index < params.size()"
          ],
          "line": 475
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "params.size",
          "args": [],
          "line": 475
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-capnp.c++",
          "lines": "74-74",
          "snippet": "inline size_t size() const { return amount; }",
          "includes": [
            "#include \"config.h\"",
            "#include <map>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <map>\n#include <algorithm>\n#include <kj/main.h>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nIndent {\n  inline size_t size() const { return amount; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "m->getProto",
          "args": [],
          "line": 474
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      },
      {
        "call_info": {
          "callee": "type.getImplicitParameter",
          "args": [],
          "line": 472
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schemaLoader.get",
          "args": [],
          "line": 470
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": "ConstData",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/generated-header-support.h",
          "lines": "469-471",
          "snippet": "inline Data::Reader get() const {\n    return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n  }",
          "includes": [
            "#include <kj/string-tree.h>",
            "#include <kj/string.h>",
            "#include \"any.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"orphan.h\"",
            "#include \"list.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/string-tree.h>\n#include <kj/string.h>\n#include \"any.h\"\n#include \"pointer-helpers.h\"\n#include \"orphan.h\"\n#include \"list.h\"\n#include \"layout.h\"\n\nConstData {\n  inline Data::Reader get() const {\n      return Data::Reader(reinterpret_cast<const byte*>(ptr), size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "schemaLoader.get",
          "args": [
            "param->scopeId"
          ],
          "line": 470
        },
        "resolved": true,
        "details": {
          "function_name": "get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "868-871",
          "snippet": "static inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nstatic inline AnyList::Builder get(\n      PointerBuilder builder, const word* defaultValue = nullptr) {\n    return AnyList::Builder(builder.getListAnySize(defaultValue));\n  }"
        }
      },
      {
        "call_info": {
          "callee": "KJ_IF_MAYBE",
          "args": [
            "param",
            "type.getBrandParameter()"
          ],
          "line": 469
        },
        "resolved": true,
        "details": {
          "function_name": "KJ_IF_MAYBE",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/parser.c++",
          "lines": "982-1016",
          "snippet": "KJ_IF_MAYBE(target, maybeTarget) {\n            if (target->value == \"*\") {\n              // Set all.\n              if (targets.value.size() > 1) {\n                errorReporter.addError(target->startByte, target->endByte,\n                    \"Wildcard should not be specified together with other targets.\");\n              }\n\n              for (auto field: dynamicBuilder.getSchema().getFields()) {\n                if (field.getProto().getName().startsWith(\"targets\")) {\n                  dynamicBuilder.set(field, true);\n                }\n              }\n            } else {\n              if (target->value.size() == 0 || target->value.size() >= 32 ||\n                  target->value[0] < 'a' || target->value[0] > 'z') {\n                errorReporter.addError(target->startByte, target->endByte,\n                                       \"Not a valid annotation target.\");\n              } else {\n                char buffer[64];\n                strcpy(buffer, \"targets\");\n                strcat(buffer, target->value.cStr());\n                buffer[strlen(\"targets\")] += 'A' - 'a';\n                KJ_IF_MAYBE(field, dynamicBuilder.getSchema().findFieldByName(buffer)) {\n                  if (dynamicBuilder.get(*field).as<bool>()) {\n                    errorReporter.addError(target->startByte, target->endByte,\n                                           \"Duplicate target specification.\");\n                  }\n                  dynamicBuilder.set(*field, true);\n                } else {\n                  errorReporter.addError(target->startByte, target->endByte,\n                                         \"Not a valid annotation target.\");\n                }\n              }\n            }",
          "includes": [
            "#include <windows.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <kj/debug.h>",
            "#include <capnp/dynamic.h>",
            "#include \"md5.h\"",
            "#include \"parser.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <windows.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <kj/debug.h>\n#include <capnp/dynamic.h>\n#include \"md5.h\"\n#include \"parser.h\"\n\nKJ_IF_MAYBE(target, maybeTarget) {\n            if (target->value == \"*\") {\n              // Set all.\n              if (targets.value.size() > 1) {\n                errorReporter.addError(target->startByte, target->endByte,\n                    \"Wildcard should not be specified together with other targets.\");\n              }\n\n              for (auto field: dynamicBuilder.getSchema().getFields()) {\n                if (field.getProto().getName().startsWith(\"targets\")) {\n                  dynamicBuilder.set(field, true);\n                }\n              }\n            } else {\n              if (target->value.size() == 0 || target->value.size() >= 32 ||\n                  target->value[0] < 'a' || target->value[0] > 'z') {\n                errorReporter.addError(target->startByte, target->endByte,\n                                       \"Not a valid annotation target.\");\n              } else {\n                char buffer[64];\n                strcpy(buffer, \"targets\");\n                strcat(buffer, target->value.cStr());\n                buffer[strlen(\"targets\")] += 'A' - 'a';\n                KJ_IF_MAYBE(field, dynamicBuilder.getSchema().findFieldByName(buffer)) {\n                  if (dynamicBuilder.get(*field).as<bool>()) {\n                    errorReporter.addError(target->startByte, target->endByte,\n                                           \"Duplicate target specification.\");\n                  }\n                  dynamicBuilder.set(*field, true);\n                } else {\n                  errorReporter.addError(target->startByte, target->endByte,\n                                         \"Not a valid annotation target.\");\n                }\n              }\n            }"
        }
      },
      {
        "call_info": {
          "callee": "type.getBrandParameter",
          "args": [],
          "line": 469
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result.addMemberTemplate",
          "args": [
            "\"List\"",
            "params.finish()"
          ],
          "line": 464
        },
        "resolved": true,
        "details": {
          "function_name": "addMemberTemplate",
          "container": "CppTypeName",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "224-243",
          "snippet": "void addMemberTemplate(kj::StringPtr innerName, kj::Array<CppTypeName>&& params) {\n    // Append \"::innerName<params, ...>\".\n    //\n    // If necessary, add the \"template\" disambiguation keyword in front of `innerName`.\n\n    bool parentIsArgDependent = isArgDependent;\n    needsTypename = parentIsArgDependent;\n    hasDisambiguatedTemplate_ = hasDisambiguatedTemplate_ || parentIsArgDependent;\n\n    name = kj::strTree(kj::mv(name),\n        parentIsArgDependent ? \"::template \" : \"::\",\n        innerName, '<',\n        kj::StringTree(KJ_MAP(p, params) {\n          if (p.isArgDependent) isArgDependent = true;\n          if (p.hasInterfaces_) hasInterfaces_ = true;\n          if (p.hasDisambiguatedTemplate_) hasDisambiguatedTemplate_ = true;\n          return kj::strTree(kj::mv(p));\n        }, \", \"),\n        '>');\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName {\n  void addMemberTemplate(kj::StringPtr innerName, kj::Array<CppTypeName>&& params) {\n      // Append \"::innerName<params, ...>\".\n      //\n      // If necessary, add the \"template\" disambiguation keyword in front of `innerName`.\n  \n      bool parentIsArgDependent = isArgDependent;\n      needsTypename = parentIsArgDependent;\n      hasDisambiguatedTemplate_ = hasDisambiguatedTemplate_ || parentIsArgDependent;\n  \n      name = kj::strTree(kj::mv(name),\n          parentIsArgDependent ? \"::template \" : \"::\",\n          innerName, '<',\n          kj::StringTree(KJ_MAP(p, params) {\n            if (p.isArgDependent) isArgDependent = true;\n            if (p.hasInterfaces_) hasInterfaces_ = true;\n            if (p.hasDisambiguatedTemplate_) hasDisambiguatedTemplate_ = true;\n            return kj::strTree(kj::mv(p));\n          }, \", \"),\n          '>');\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "params.finish",
          "args": [],
          "line": 464
        },
        "resolved": true,
        "details": {
          "function_name": "finish",
          "container": "ArrayBuilder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "369-382",
          "snippet": "Array<T> finish() {\n    // We could safely remove this check if we assume that the disposer implementation doesn't\n    // need to know the original capacity, as is thes case with HeapArrayDisposer since it uses\n    // operator new() or if we created a custom disposer for ArrayBuilder which stores the capacity\n    // in a prefix.  But that would make it hard to write cleverer heap allocators, and anyway this\n    // check might catch bugs.  Probably people should use Vector if they want to build arrays\n    // without knowing the final size in advance.\n    KJ_IREQUIRE(pos == endPtr, \"ArrayBuilder::finish() called prematurely.\");\n    Array<T> result(reinterpret_cast<T*>(ptr), pos - ptr, *disposer);\n    ptr = nullptr;\n    pos = nullptr;\n    endPtr = nullptr;\n    return result;\n  }",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\nArrayBuilder {\n  Array<T> finish() {\n      // We could safely remove this check if we assume that the disposer implementation doesn't\n      // need to know the original capacity, as is thes case with HeapArrayDisposer since it uses\n      // operator new() or if we created a custom disposer for ArrayBuilder which stores the capacity\n      // in a prefix.  But that would make it hard to write cleverer heap allocators, and anyway this\n      // check might catch bugs.  Probably people should use Vector if they want to build arrays\n      // without knowing the final size in advance.\n      KJ_IREQUIRE(pos == endPtr, \"ArrayBuilder::finish() called prematurely.\");\n      Array<T> result(reinterpret_cast<T*>(ptr), pos - ptr, *disposer);\n      ptr = nullptr;\n      pos = nullptr;\n      endPtr = nullptr;\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "params.add",
          "args": [
            "typeName(type.asList().getElementType(), method)"
          ],
          "line": 463
        },
        "resolved": true,
        "details": {
          "function_name": "add",
          "container": "ReusableObjects::ObjectSizeCounter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/null-common.h",
          "lines": "86-88",
          "snippet": "void add(size_t wordCount) {\n      maxSize = std::max(wordCount, maxSize);\n    }",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nReusableObjects {\n  ObjectSizeCounter {\n    void add(size_t wordCount) {\n          maxSize = std::max(wordCount, maxSize);\n        }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "typeName",
          "args": [
            "type.asList().getElementType()",
            "method"
          ],
          "line": 463
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.asList",
          "args": [],
          "line": 463
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.asList",
          "args": [],
          "line": 463
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::heapArrayBuilder<CppTypeName>",
          "args": [
            "1"
          ],
          "line": 462
        },
        "resolved": true,
        "details": {
          "function_name": "heapArrayBuilder",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "410-416",
          "snippet": "inline ArrayBuilder<T> heapArrayBuilder(size_t size) {\n  // Like `heapArray<T>()` but does not default-construct the elements.  You must construct them\n  // manually by calling `add()`.\n\n  return ArrayBuilder<T>(_::HeapArrayDisposer::allocateUninitialized<RemoveConst<T>>(size),\n                         size, _::HeapArrayDisposer::instance);\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\ninline ArrayBuilder<T> heapArrayBuilder(size_t size) {\n  // Like `heapArray<T>()` but does not default-construct the elements.  You must construct them\n  // manually by calling `add()`.\n\n  return ArrayBuilder<T>(_::HeapArrayDisposer::allocateUninitialized<RemoveConst<T>>(size),\n                         size, _::HeapArrayDisposer::instance);\n}"
        }
      },
      {
        "call_info": {
          "callee": "CppTypeName::makeNamespace",
          "args": [
            "\"capnp\""
          ],
          "line": 461
        },
        "resolved": true,
        "details": {
          "function_name": "makeNamespace",
          "container": "CppTypeName",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "194-196",
          "snippet": "static CppTypeName makeNamespace(kj::StringPtr name) {\n    return CppTypeName(kj::strTree(\" ::\", name), false);\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName {\n  static CppTypeName makeNamespace(kj::StringPtr name) {\n      return CppTypeName(kj::strTree(\" ::\", name), false);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "result.setHasInterfaces",
          "args": [],
          "line": 456
        },
        "resolved": true,
        "details": {
          "function_name": "setHasInterfaces",
          "container": "CppTypeName",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "245-247",
          "snippet": "void setHasInterfaces() {\n    hasInterfaces_ = true;\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName {\n  void setHasInterfaces() {\n      hasInterfaces_ = true;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "cppFullName",
          "args": [
            "type.asInterface()",
            "method"
          ],
          "line": 455
        },
        "resolved": true,
        "details": {
          "function_name": "cppFullName",
          "container": "CapnpcCppMain",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "316-318",
          "snippet": "CppTypeName cppFullName(Schema schema, kj::Maybe<InterfaceSchema::Method> method) {\n    return cppFullName(schema, schema, method);\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCapnpcCppMain {\n  CppTypeName cppFullName(Schema schema, kj::Maybe<InterfaceSchema::Method> method) {\n      return cppFullName(schema, schema, method);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "type.asInterface",
          "args": [],
          "line": 455
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.asStruct",
          "args": [],
          "line": 453
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.asEnum",
          "args": [],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.which",
          "args": [],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName typeName(Type type, kj::Maybe<InterfaceSchema::Method> method) {\n    switch (type.which()) {\n      case schema::Type::VOID: return CppTypeName::makePrimitive(\" ::capnp::Void\");\n\n      case schema::Type::BOOL: return CppTypeName::makePrimitive(\"bool\");\n      case schema::Type::INT8: return CppTypeName::makePrimitive(\" ::int8_t\");\n      case schema::Type::INT16: return CppTypeName::makePrimitive(\" ::int16_t\");\n      case schema::Type::INT32: return CppTypeName::makePrimitive(\" ::int32_t\");\n      case schema::Type::INT64: return CppTypeName::makePrimitive(\" ::int64_t\");\n      case schema::Type::UINT8: return CppTypeName::makePrimitive(\" ::uint8_t\");\n      case schema::Type::UINT16: return CppTypeName::makePrimitive(\" ::uint16_t\");\n      case schema::Type::UINT32: return CppTypeName::makePrimitive(\" ::uint32_t\");\n      case schema::Type::UINT64: return CppTypeName::makePrimitive(\" ::uint64_t\");\n      case schema::Type::FLOAT32: return CppTypeName::makePrimitive(\"float\");\n      case schema::Type::FLOAT64: return CppTypeName::makePrimitive(\"double\");\n\n      case schema::Type::TEXT: return CppTypeName::makePrimitive(\" ::capnp::Text\");\n      case schema::Type::DATA: return CppTypeName::makePrimitive(\" ::capnp::Data\");\n\n      case schema::Type::ENUM:\n        return cppFullName(type.asEnum(), method);\n      case schema::Type::STRUCT:\n        return cppFullName(type.asStruct(), method);\n      case schema::Type::INTERFACE: {\n        auto result = cppFullName(type.asInterface(), method);\n        result.setHasInterfaces();\n        return result;\n      }\n\n      case schema::Type::LIST: {\n        CppTypeName result = CppTypeName::makeNamespace(\"capnp\");\n        auto params = kj::heapArrayBuilder<CppTypeName>(1);\n        params.add(typeName(type.asList().getElementType(), method));\n        result.addMemberTemplate(\"List\", params.finish());\n        return result;\n      }\n\n      case schema::Type::ANY_POINTER:\n        KJ_IF_MAYBE(param, type.getBrandParameter()) {\n          return CppTypeName::makeTemplateParam(schemaLoader.get(param->scopeId).getProto()\n              .getParameters()[param->index].getName());\n        } else KJ_IF_MAYBE(param, type.getImplicitParameter()) {\n          KJ_IF_MAYBE(m, method) {\n            auto params = m->getProto().getImplicitParameters();\n            KJ_REQUIRE(param->index < params.size());\n            return CppTypeName::makeTemplateParam(params[param->index].getName());\n          } else {\n            return CppTypeName::makePrimitive(\" ::capnp::AnyPointer\");\n          }\n        } else {\n          switch (type.whichAnyPointerKind()) {\n            case schema::Type::AnyPointer::Unconstrained::ANY_KIND:\n              return CppTypeName::makePrimitive(\" ::capnp::AnyPointer\");\n            case schema::Type::AnyPointer::Unconstrained::STRUCT:\n              return CppTypeName::makePrimitive(\" ::capnp::AnyStruct\");\n            case schema::Type::AnyPointer::Unconstrained::LIST:\n              return CppTypeName::makePrimitive(\" ::capnp::AnyList\");\n            case schema::Type::AnyPointer::Unconstrained::CAPABILITY:\n              hasInterfaces = true;  // Probably need to #inculde <capnp/capability.h>.\n              return CppTypeName::makePrimitive(\" ::capnp::Capability\");\n          }"
  },
  {
    "function_name": "toTitleCase",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "423-429",
    "snippet": "kj::String toTitleCase(kj::StringPtr name) {\n    kj::String result = kj::heapString(name);\n    if ('a' <= result[0] && result[0] <= 'z') {\n      result[0] = result[0] - 'a' + 'A';\n    }\n    return kj::mv(result);\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "result"
          ],
          "line": 428
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::heapString",
          "args": [
            "name"
          ],
          "line": 424
        },
        "resolved": true,
        "details": {
          "function_name": "heapString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.c++",
          "lines": "36-40",
          "snippet": "String heapString(size_t size) {\n  char* buffer = _::HeapArrayDisposer::allocate<char>(size + 1);\n  buffer[size] = '\\0';\n  return String(buffer, size, _::HeapArrayDisposer::instance);\n}",
          "includes": [
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <float.h>",
            "#include <stdio.h>",
            "#include \"debug.h\"",
            "#include \"string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdlib.h>\n#include <errno.h>\n#include <float.h>\n#include <stdio.h>\n#include \"debug.h\"\n#include \"string.h\"\n\nString heapString(size_t size) {\n  char* buffer = _::HeapArrayDisposer::allocate<char>(size + 1);\n  buffer[size] = '\\0';\n  return String(buffer, size, _::HeapArrayDisposer::instance);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::String toTitleCase(kj::StringPtr name) {\n    kj::String result = kj::heapString(name);\n    if ('a' <= result[0] && result[0] <= 'z') {\n      result[0] = result[0] - 'a' + 'A';\n    }\n    return kj::mv(result);\n  }"
  },
  {
    "function_name": "toUpperCase",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "404-421",
    "snippet": "kj::String toUpperCase(kj::StringPtr name) {\n    kj::Vector<char> result(name.size() + 4);\n\n    for (char c: name) {\n      if ('a' <= c && c <= 'z') {\n        result.add(c - 'a' + 'A');\n      } else if (result.size() > 0 && 'A' <= c && c <= 'Z') {\n        result.add('_');\n        result.add(c);\n      } else {\n        result.add(c);\n      }\n    }\n\n    result.add('\\0');\n\n    return kj::String(result.releaseAsArray());\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::String",
          "args": [
            "result.releaseAsArray()"
          ],
          "line": 420
        },
        "resolved": true,
        "details": {
          "function_name": "String",
          "container": "String",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "137-137",
          "snippet": "inline String(decltype(nullptr)): content(nullptr) {}",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\nString {\n  inline String(decltype(nullptr)): content(nullptr) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "result.releaseAsArray",
          "args": [],
          "line": 420
        },
        "resolved": true,
        "details": {
          "function_name": "releaseAsArray",
          "container": "Vector",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/vector.h",
          "lines": "66-72",
          "snippet": "inline Array<T> releaseAsArray() {\n    // TODO(perf):  Avoid a copy/move by allowing Array<T> to point to incomplete space?\n    if (!builder.isFull()) {\n      setCapacity(size());\n    }\n    return builder.finish();\n  }",
          "includes": [
            "#include \"array.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"array.h\"\n\nVector {\n  inline Array<T> releaseAsArray() {\n      // TODO(perf):  Avoid a copy/move by allowing Array<T> to point to incomplete space?\n      if (!builder.isFull()) {\n        setCapacity(size());\n      }\n      return builder.finish();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "result.add",
          "args": [
            "'\\0'"
          ],
          "line": 418
        },
        "resolved": true,
        "details": {
          "function_name": "add",
          "container": "ReusableObjects::ObjectSizeCounter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/null-common.h",
          "lines": "86-88",
          "snippet": "void add(size_t wordCount) {\n      maxSize = std::max(wordCount, maxSize);\n    }",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nReusableObjects {\n  ObjectSizeCounter {\n    void add(size_t wordCount) {\n          maxSize = std::max(wordCount, maxSize);\n        }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "result.size",
          "args": [],
          "line": 410
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-capnp.c++",
          "lines": "74-74",
          "snippet": "inline size_t size() const { return amount; }",
          "includes": [
            "#include \"config.h\"",
            "#include <map>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <map>\n#include <algorithm>\n#include <kj/main.h>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nIndent {\n  inline size_t size() const { return amount; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::String toUpperCase(kj::StringPtr name) {\n    kj::Vector<char> result(name.size() + 4);\n\n    for (char c: name) {\n      if ('a' <= c && c <= 'z') {\n        result.add(c - 'a' + 'A');\n      } else if (result.size() > 0 && 'A' <= c && c <= 'Z') {\n        result.add('_');\n        result.add(c);\n      } else {\n        result.add(c);\n      }\n    }\n\n    result.add('\\0');\n\n    return kj::String(result.releaseAsArray());\n  }"
  },
  {
    "function_name": "cppFullName",
    "container": "CapnpcCppMain",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "320-333",
    "snippet": "CppTypeName cppFullName(Schema schema, Schema brand, kj::Maybe<InterfaceSchema::Method> method) {\n    auto node = schema.getProto();\n\n    if (node.getScopeId() == 0) {\n      // This is the file-level scope. Search for the namespace annotation.\n      KJ_REQUIRE(node.isFile(),\n          \"Non-file had scopeId zero; perhaps it's a method param / result struct?\");\n      usedImports.insert(node.getId());\n      KJ_IF_MAYBE(ns, annotationValue(node, NAMESPACE_ANNOTATION_ID)) {\n        return CppTypeName::makeNamespace(ns->getText());\n      } else {\n        return CppTypeName::makeRoot();\n      }\n    }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "schema::Node::Reader node;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "CppTypeName::makeRoot",
          "args": [],
          "line": 331
        },
        "resolved": true,
        "details": {
          "function_name": "makeRoot",
          "container": "CppTypeName",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "190-192",
          "snippet": "static CppTypeName makeRoot() {\n    return CppTypeName(kj::strTree(\" \"), false);\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName {\n  static CppTypeName makeRoot() {\n      return CppTypeName(kj::strTree(\" \"), false);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CppTypeName::makeNamespace",
          "args": [
            "ns->getText()"
          ],
          "line": 329
        },
        "resolved": true,
        "details": {
          "function_name": "makeNamespace",
          "container": "CppTypeName",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "194-196",
          "snippet": "static CppTypeName makeNamespace(kj::StringPtr name) {\n    return CppTypeName(kj::strTree(\" ::\", name), false);\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName {\n  static CppTypeName makeNamespace(kj::StringPtr name) {\n      return CppTypeName(kj::strTree(\" ::\", name), false);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ns->getText",
          "args": [],
          "line": 329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "usedImports.insert",
          "args": [
            "node.getId()"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "node.getId",
          "args": [],
          "line": 327
        },
        "resolved": true,
        "details": {
          "function_name": "getId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
          "lines": "75-75",
          "snippet": "uint64_t getId() { return id; }",
          "includes": [
            "#include \"md5.h\"",
            "#include \"node-translator.h\"",
            "#include <unordered_map>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/message.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/arena.h>",
            "#include <kj/mutex.h>",
            "#include \"parser.h\"      // only for generateChildId()",
            "#include \"compiler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nuint64_t getId() { return id; }"
        }
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "node.isFile()",
            "\"Non-file had scopeId zero; perhaps it's a method param / result struct?\""
          ],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "node.isFile",
          "args": [],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "node.getScopeId",
          "args": [],
          "line": 323
        },
        "resolved": true,
        "details": {
          "function_name": "getScopeId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/node-translator.c++",
          "lines": "778-778",
          "snippet": "inline uint64_t getScopeId() { return leafId; }",
          "includes": [
            "#include <map>",
            "#include <set>",
            "#include <kj/arena.h>",
            "#include <kj/debug.h>",
            "#include \"parser.h\"      // only for generateGroupId()",
            "#include \"node-translator.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "uint64_t leafId;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <map>\n#include <set>\n#include <kj/arena.h>\n#include <kj/debug.h>\n#include \"parser.h\"      // only for generateGroupId()\n#include \"node-translator.h\"\n\nuint64_t leafId;\n\ninline uint64_t getScopeId() { return leafId; }"
        }
      },
      {
        "call_info": {
          "callee": "schema.getProto",
          "args": [],
          "line": 321
        },
        "resolved": true,
        "details": {
          "function_name": "getProto",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "483-483",
          "snippet": "inline schema::Method::Reader getProto() const { return proto; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline schema::Method::Reader getProto() const { return proto; }"
        }
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nschema::Node::Reader node;\n\nCapnpcCppMain {\n  CppTypeName cppFullName(Schema schema, Schema brand, kj::Maybe<InterfaceSchema::Method> method) {\n      auto node = schema.getProto();\n  \n      if (node.getScopeId() == 0) {\n        // This is the file-level scope. Search for the namespace annotation.\n        KJ_REQUIRE(node.isFile(),\n            \"Non-file had scopeId zero; perhaps it's a method param / result struct?\");\n        usedImports.insert(node.getId());\n        KJ_IF_MAYBE(ns, annotationValue(node, NAMESPACE_ANNOTATION_ID)) {\n          return CppTypeName::makeNamespace(ns->getText());\n        } else {\n          return CppTypeName::makeRoot();\n        }\n      }\n}"
  },
  {
    "function_name": "cppFullName",
    "container": "CapnpcCppMain",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "316-318",
    "snippet": "CppTypeName cppFullName(Schema schema, kj::Maybe<InterfaceSchema::Method> method) {\n    return cppFullName(schema, schema, method);\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cppFullName",
          "args": [
            "schema",
            "schema",
            "method"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCapnpcCppMain {\n  CppTypeName cppFullName(Schema schema, kj::Maybe<InterfaceSchema::Method> method) {\n      return cppFullName(schema, schema, method);\n    }\n}"
  },
  {
    "function_name": "getMain",
    "container": "CapnpcCppMain",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "301-308",
    "snippet": "kj::MainFunc getMain() {\n    return kj::MainBuilder(context, \"Cap'n Proto C++ plugin version \" VERSION,\n          \"This is a Cap'n Proto compiler plugin which generates C++ code. \"\n          \"It is meant to be run using the Cap'n Proto compiler, e.g.:\\n\"\n          \"    capnp compile -oc++ foo.capnp\")\n        .callAfterParsing(KJ_BIND_METHOD(*this, run))\n        .build();\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [
      "#define VERSION \"(unknown)\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::MainBuilder",
          "args": [],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::MainBuilder",
          "args": [
            "KJ_BIND_METHOD(*this, run)"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_BIND_METHOD",
          "args": [
            "*this",
            "run"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::MainBuilder",
          "args": [
            "context",
            "\"Cap'n Proto C++ plugin version \"VERSION",
            "\"This is a Cap'n Proto compiler plugin which generates C++ code. \"\n          \"It is meant to be run using the Cap'n Proto compiler, e.g.:\\n\"\n          \"    capnp compile -oc++ foo.capnp\""
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\n#define VERSION \"(unknown)\"\n\nCapnpcCppMain {\n  kj::MainFunc getMain() {\n      return kj::MainBuilder(context, \"Cap'n Proto C++ plugin version \" VERSION,\n            \"This is a Cap'n Proto compiler plugin which generates C++ code. \"\n            \"It is meant to be run using the Cap'n Proto compiler, e.g.:\\n\"\n            \"    capnp compile -oc++ foo.capnp\")\n          .callAfterParsing(KJ_BIND_METHOD(*this, run))\n          .build();\n    }\n}"
  },
  {
    "function_name": "CapnpcCppMain",
    "container": "CapnpcCppMain",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "299-299",
    "snippet": "CapnpcCppMain(kj::ProcessContext& context): context(context) {}",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCapnpcCppMain {\n  CapnpcCppMain(kj::ProcessContext& context): context(context) {}\n}"
  },
  {
    "function_name": "KJ_STRINGIFY",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "287-293",
    "snippet": "kj::String KJ_STRINGIFY(const CppTypeName& typeName) {\n  if (typeName.needsTypename) {\n    return kj::str(\"typename \", typeName.name);\n  } else {\n    return typeName.name.flatten();\n  }\n}",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "typeName.name.flatten",
          "args": [],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "\"typename \"",
            "typeName.name"
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::String KJ_STRINGIFY(const CppTypeName& typeName) {\n  if (typeName.needsTypename) {\n    return kj::str(\"typename \", typeName.name);\n  } else {\n    return typeName.name.flatten();\n  }\n}"
  },
  {
    "function_name": "KJ_STRINGIFY",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "280-286",
    "snippet": "kj::StringTree KJ_STRINGIFY(CppTypeName&& typeName) {\n  if (typeName.needsTypename) {\n    return kj::strTree(\"typename \", kj::mv(typeName.name));\n  } else {\n    return kj::mv(typeName.name);\n  }\n}",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "typeName.name"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\"typename \"",
            "kj::mv(typeName.name)"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "typeName.name"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::StringTree KJ_STRINGIFY(CppTypeName&& typeName) {\n  if (typeName.needsTypename) {\n    return kj::strTree(\"typename \", kj::mv(typeName.name));\n  } else {\n    return kj::mv(typeName.name);\n  }\n}"
  },
  {
    "function_name": "CppTypeName",
    "container": "CppTypeName",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "272-274",
    "snippet": "inline CppTypeName(kj::StringTree&& name, bool isArgDependent)\n      : name(kj::mv(name)), isArgDependent(isArgDependent), needsTypename(false),\n        hasInterfaces_(false), hasDisambiguatedTemplate_(false) {}",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "name"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName {\n  inline CppTypeName(kj::StringTree&& name, bool isArgDependent)\n        : name(kj::mv(name)), isArgDependent(isArgDependent), needsTypename(false),\n          hasInterfaces_(false), hasDisambiguatedTemplate_(false) {}\n}"
  },
  {
    "function_name": "hasInterfaces",
    "container": "CppTypeName",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "249-251",
    "snippet": "bool hasInterfaces() {\n    return hasInterfaces_;\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName {\n  bool hasInterfaces() {\n      return hasInterfaces_;\n    }\n}"
  },
  {
    "function_name": "setHasInterfaces",
    "container": "CppTypeName",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "245-247",
    "snippet": "void setHasInterfaces() {\n    hasInterfaces_ = true;\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName {\n  void setHasInterfaces() {\n      hasInterfaces_ = true;\n    }\n}"
  },
  {
    "function_name": "addMemberTemplate",
    "container": "CppTypeName",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "224-243",
    "snippet": "void addMemberTemplate(kj::StringPtr innerName, kj::Array<CppTypeName>&& params) {\n    // Append \"::innerName<params, ...>\".\n    //\n    // If necessary, add the \"template\" disambiguation keyword in front of `innerName`.\n\n    bool parentIsArgDependent = isArgDependent;\n    needsTypename = parentIsArgDependent;\n    hasDisambiguatedTemplate_ = hasDisambiguatedTemplate_ || parentIsArgDependent;\n\n    name = kj::strTree(kj::mv(name),\n        parentIsArgDependent ? \"::template \" : \"::\",\n        innerName, '<',\n        kj::StringTree(KJ_MAP(p, params) {\n          if (p.isArgDependent) isArgDependent = true;\n          if (p.hasInterfaces_) hasInterfaces_ = true;\n          if (p.hasDisambiguatedTemplate_) hasDisambiguatedTemplate_ = true;\n          return kj::strTree(kj::mv(p));\n        }, \", \"),\n        '>');\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "kj::mv(name)",
            "parentIsArgDependent ? \"::template \" : \"::\"",
            "innerName",
            "'<'",
            "kj::StringTree(KJ_MAP(p, params) {\n          if (p.isArgDependent) isArgDependent = true;\n          if (p.hasInterfaces_) hasInterfaces_ = true;\n          if (p.hasDisambiguatedTemplate_) hasDisambiguatedTemplate_ = true;\n          return kj::strTree(kj::mv(p));\n        }, \", \")",
            "'>'"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::StringTree",
          "args": [
            "KJ_MAP(p, params){\n          if (p.isArgDependent) isArgDependent = true;\n          if (p.hasInterfaces_) hasInterfaces_ = true;\n          if (p.hasDisambiguatedTemplate_) hasDisambiguatedTemplate_ = true;\n          return kj::strTree(kj::mv(p));\n        }",
            "\", \""
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "kj::mv(p)"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "p"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "p",
            "params"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "name"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName {\n  void addMemberTemplate(kj::StringPtr innerName, kj::Array<CppTypeName>&& params) {\n      // Append \"::innerName<params, ...>\".\n      //\n      // If necessary, add the \"template\" disambiguation keyword in front of `innerName`.\n  \n      bool parentIsArgDependent = isArgDependent;\n      needsTypename = parentIsArgDependent;\n      hasDisambiguatedTemplate_ = hasDisambiguatedTemplate_ || parentIsArgDependent;\n  \n      name = kj::strTree(kj::mv(name),\n          parentIsArgDependent ? \"::template \" : \"::\",\n          innerName, '<',\n          kj::StringTree(KJ_MAP(p, params) {\n            if (p.isArgDependent) isArgDependent = true;\n            if (p.hasInterfaces_) hasInterfaces_ = true;\n            if (p.hasDisambiguatedTemplate_) hasDisambiguatedTemplate_ = true;\n            return kj::strTree(kj::mv(p));\n          }, \", \"),\n          '>');\n    }\n}"
  },
  {
    "function_name": "hasDisambiguatedTemplate",
    "container": "CppTypeName",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "220-222",
    "snippet": "bool hasDisambiguatedTemplate() {\n    return hasDisambiguatedTemplate_;\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName {\n  bool hasDisambiguatedTemplate() {\n      return hasDisambiguatedTemplate_;\n    }\n}"
  },
  {
    "function_name": "addMemberValue",
    "container": "CppTypeName",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "213-218",
    "snippet": "void addMemberValue(kj::StringPtr innerName) {\n    // Append \"::innerName\" to refer to a member.\n\n    name = kj::strTree(kj::mv(name), \"::\", innerName);\n    needsTypename = false;\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "kj::mv(name)",
            "\"::\"",
            "innerName"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "name"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName {\n  void addMemberValue(kj::StringPtr innerName) {\n      // Append \"::innerName\" to refer to a member.\n  \n      name = kj::strTree(kj::mv(name), \"::\", innerName);\n      needsTypename = false;\n    }\n}"
  },
  {
    "function_name": "addMemberType",
    "container": "CppTypeName",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "206-211",
    "snippet": "void addMemberType(kj::StringPtr innerName) {\n    // Append \"::innerName\" to refer to a member.\n\n    name = kj::strTree(kj::mv(name), \"::\", innerName);\n    needsTypename = isArgDependent;\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "kj::mv(name)",
            "\"::\"",
            "innerName"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "name"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName {\n  void addMemberType(kj::StringPtr innerName) {\n      // Append \"::innerName\" to refer to a member.\n  \n      name = kj::strTree(kj::mv(name), \"::\", innerName);\n      needsTypename = isArgDependent;\n    }\n}"
  },
  {
    "function_name": "makePrimitive",
    "container": "CppTypeName",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "202-204",
    "snippet": "static CppTypeName makePrimitive(kj::StringPtr name) {\n    return CppTypeName(kj::strTree(name), false);\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CppTypeName",
          "args": [
            "kj::strTree(name)",
            "false"
          ],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "CppTypeName",
          "container": "CppTypeName",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "272-274",
          "snippet": "inline CppTypeName(kj::StringTree&& name, bool isArgDependent)\n      : name(kj::mv(name)), isArgDependent(isArgDependent), needsTypename(false),\n        hasInterfaces_(false), hasDisambiguatedTemplate_(false) {}",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName {\n  inline CppTypeName(kj::StringTree&& name, bool isArgDependent)\n        : name(kj::mv(name)), isArgDependent(isArgDependent), needsTypename(false),\n          hasInterfaces_(false), hasDisambiguatedTemplate_(false) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "name"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName {\n  static CppTypeName makePrimitive(kj::StringPtr name) {\n      return CppTypeName(kj::strTree(name), false);\n    }\n}"
  },
  {
    "function_name": "makeTemplateParam",
    "container": "CppTypeName",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "198-200",
    "snippet": "static CppTypeName makeTemplateParam(kj::StringPtr name) {\n    return CppTypeName(kj::strTree(name), true);\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CppTypeName",
          "args": [
            "kj::strTree(name)",
            "true"
          ],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "CppTypeName",
          "container": "CppTypeName",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "272-274",
          "snippet": "inline CppTypeName(kj::StringTree&& name, bool isArgDependent)\n      : name(kj::mv(name)), isArgDependent(isArgDependent), needsTypename(false),\n        hasInterfaces_(false), hasDisambiguatedTemplate_(false) {}",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName {\n  inline CppTypeName(kj::StringTree&& name, bool isArgDependent)\n        : name(kj::mv(name)), isArgDependent(isArgDependent), needsTypename(false),\n          hasInterfaces_(false), hasDisambiguatedTemplate_(false) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "name"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName {\n  static CppTypeName makeTemplateParam(kj::StringPtr name) {\n      return CppTypeName(kj::strTree(name), true);\n    }\n}"
  },
  {
    "function_name": "makeNamespace",
    "container": "CppTypeName",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "194-196",
    "snippet": "static CppTypeName makeNamespace(kj::StringPtr name) {\n    return CppTypeName(kj::strTree(\" ::\", name), false);\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CppTypeName",
          "args": [
            "kj::strTree(\" ::\", name)",
            "false"
          ],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "CppTypeName",
          "container": "CppTypeName",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "272-274",
          "snippet": "inline CppTypeName(kj::StringTree&& name, bool isArgDependent)\n      : name(kj::mv(name)), isArgDependent(isArgDependent), needsTypename(false),\n        hasInterfaces_(false), hasDisambiguatedTemplate_(false) {}",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName {\n  inline CppTypeName(kj::StringTree&& name, bool isArgDependent)\n        : name(kj::mv(name)), isArgDependent(isArgDependent), needsTypename(false),\n          hasInterfaces_(false), hasDisambiguatedTemplate_(false) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\" ::\"",
            "name"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName {\n  static CppTypeName makeNamespace(kj::StringPtr name) {\n      return CppTypeName(kj::strTree(\" ::\", name), false);\n    }\n}"
  },
  {
    "function_name": "makeRoot",
    "container": "CppTypeName",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "190-192",
    "snippet": "static CppTypeName makeRoot() {\n    return CppTypeName(kj::strTree(\" \"), false);\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CppTypeName",
          "args": [
            "kj::strTree(\" \")",
            "false"
          ],
          "line": 191
        },
        "resolved": true,
        "details": {
          "function_name": "CppTypeName",
          "container": "CppTypeName",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
          "lines": "272-274",
          "snippet": "inline CppTypeName(kj::StringTree&& name, bool isArgDependent)\n      : name(kj::mv(name)), isArgDependent(isArgDependent), needsTypename(false),\n        hasInterfaces_(false), hasDisambiguatedTemplate_(false) {}",
          "includes": [
            "#include \"config.h\"",
            "#include <errno.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <set>",
            "#include <map>",
            "#include <unordered_set>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/tuple.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName {\n  inline CppTypeName(kj::StringTree&& name, bool isArgDependent)\n        : name(kj::mv(name)), isArgDependent(isArgDependent), needsTypename(false),\n          hasInterfaces_(false), hasDisambiguatedTemplate_(false) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "\" \""
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName {\n  static CppTypeName makeRoot() {\n      return CppTypeName(kj::strTree(\" \"), false);\n    }\n}"
  },
  {
    "function_name": "CppTypeName",
    "container": "CppTypeName",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "177-180",
    "snippet": "CppTypeName(const CppTypeName& other)\n      : name(kj::strTree(other.name.flatten())),\n        isArgDependent(other.isArgDependent),\n        needsTypename(other.needsTypename) {}",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::strTree",
          "args": [
            "other.name.flatten()"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "other.name.flatten",
          "args": [],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName {\n  CppTypeName(const CppTypeName& other)\n        : name(kj::strTree(other.name.flatten())),\n          isArgDependent(other.isArgDependent),\n          needsTypename(other.needsTypename) {}\n}"
  },
  {
    "function_name": "CppTypeName",
    "container": "CppTypeName",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "175-175",
    "snippet": "inline CppTypeName(): isArgDependent(false), needsTypename(false) {}",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nCppTypeName {\n  inline CppTypeName(): isArgDependent(false), needsTypename(false) {}\n}"
  },
  {
    "function_name": "safeIdentifier",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "143-166",
    "snippet": "kj::String safeIdentifier(kj::StringPtr identifier) {\n  // Given a desired identifier name, munge it to make it safe for use in generated code.\n  //\n  // If the identifier is a keyword, this adds an underscore to the end.\n\n  static const std::set<kj::StringPtr> keywords({\n    \"alignas\", \"alignof\", \"and\", \"and_eq\", \"asm\", \"auto\", \"bitand\", \"bitor\", \"bool\", \"break\",\n    \"case\", \"catch\", \"char\", \"char16_t\", \"char32_t\", \"class\", \"compl\", \"const\", \"constexpr\",\n    \"const_cast\", \"continue\", \"decltype\", \"default\", \"delete\", \"do\", \"double\", \"dynamic_cast\",\n    \"else\", \"enum\", \"explicit\", \"export\", \"extern\", \"false\", \"float\", \"for\", \"friend\", \"goto\",\n    \"if\", \"inline\", \"int\", \"long\", \"mutable\", \"namespace\", \"new\", \"noexcept\", \"not\", \"not_eq\",\n    \"nullptr\", \"operator\", \"or\", \"or_eq\", \"private\", \"protected\", \"public\", \"register\",\n    \"reinterpret_cast\", \"return\", \"short\", \"signed\", \"sizeof\", \"static\", \"static_assert\",\n    \"static_cast\", \"struct\", \"switch\", \"template\", \"this\", \"thread_local\", \"throw\", \"true\",\n    \"try\", \"typedef\", \"typeid\", \"typename\", \"union\", \"unsigned\", \"using\", \"virtual\", \"void\",\n    \"volatile\", \"wchar_t\", \"while\", \"xor\", \"xor_eq\"\n  });\n\n  if (keywords.count(identifier) > 0) {\n    return kj::str(identifier, '_');\n  } else {\n    return kj::heapString(identifier);\n  }\n}",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::heapString",
          "args": [
            "identifier"
          ],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "heapString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.c++",
          "lines": "36-40",
          "snippet": "String heapString(size_t size) {\n  char* buffer = _::HeapArrayDisposer::allocate<char>(size + 1);\n  buffer[size] = '\\0';\n  return String(buffer, size, _::HeapArrayDisposer::instance);\n}",
          "includes": [
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <float.h>",
            "#include <stdio.h>",
            "#include \"debug.h\"",
            "#include \"string.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdlib.h>\n#include <errno.h>\n#include <float.h>\n#include <stdio.h>\n#include \"debug.h\"\n#include \"string.h\"\n\nString heapString(size_t size) {\n  char* buffer = _::HeapArrayDisposer::allocate<char>(size + 1);\n  buffer[size] = '\\0';\n  return String(buffer, size, _::HeapArrayDisposer::instance);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::str",
          "args": [
            "identifier",
            "'_'"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "keywords.count",
          "args": [
            "identifier"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::String safeIdentifier(kj::StringPtr identifier) {\n  // Given a desired identifier name, munge it to make it safe for use in generated code.\n  //\n  // If the identifier is a keyword, this adds an underscore to the end.\n\n  static const std::set<kj::StringPtr> keywords({\n    \"alignas\", \"alignof\", \"and\", \"and_eq\", \"asm\", \"auto\", \"bitand\", \"bitor\", \"bool\", \"break\",\n    \"case\", \"catch\", \"char\", \"char16_t\", \"char32_t\", \"class\", \"compl\", \"const\", \"constexpr\",\n    \"const_cast\", \"continue\", \"decltype\", \"default\", \"delete\", \"do\", \"double\", \"dynamic_cast\",\n    \"else\", \"enum\", \"explicit\", \"export\", \"extern\", \"false\", \"float\", \"for\", \"friend\", \"goto\",\n    \"if\", \"inline\", \"int\", \"long\", \"mutable\", \"namespace\", \"new\", \"noexcept\", \"not\", \"not_eq\",\n    \"nullptr\", \"operator\", \"or\", \"or_eq\", \"private\", \"protected\", \"public\", \"register\",\n    \"reinterpret_cast\", \"return\", \"short\", \"signed\", \"sizeof\", \"static\", \"static_assert\",\n    \"static_cast\", \"struct\", \"switch\", \"template\", \"this\", \"thread_local\", \"throw\", \"true\",\n    \"try\", \"typedef\", \"typeid\", \"typename\", \"union\", \"unsigned\", \"using\", \"virtual\", \"void\",\n    \"volatile\", \"wchar_t\", \"while\", \"xor\", \"xor_eq\"\n  });\n\n  if (keywords.count(identifier) > 0) {\n    return kj::str(identifier, '_');\n  } else {\n    return kj::heapString(identifier);\n  }\n}"
  },
  {
    "function_name": "baseName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "135-141",
    "snippet": "kj::StringPtr baseName(kj::StringPtr path) {\n  KJ_IF_MAYBE(slashPos, path.findLast('/')) {\n    return path.slice(*slashPos + 1);\n  } else {\n    return path;\n  }\n}",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "path.slice",
          "args": [
            "*slashPos + 1"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "slice",
          "container": "String",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "177-177",
          "snippet": "inline StringPtr slice(size_t start) const { return StringPtr(*this).slice(start); }",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\nString {\n  inline StringPtr slice(size_t start) const { return StringPtr(*this).slice(start); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "KJ_IF_MAYBE",
          "args": [
            "slashPos",
            "path.findLast('/')"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "KJ_IF_MAYBE",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/parser.c++",
          "lines": "982-1016",
          "snippet": "KJ_IF_MAYBE(target, maybeTarget) {\n            if (target->value == \"*\") {\n              // Set all.\n              if (targets.value.size() > 1) {\n                errorReporter.addError(target->startByte, target->endByte,\n                    \"Wildcard should not be specified together with other targets.\");\n              }\n\n              for (auto field: dynamicBuilder.getSchema().getFields()) {\n                if (field.getProto().getName().startsWith(\"targets\")) {\n                  dynamicBuilder.set(field, true);\n                }\n              }\n            } else {\n              if (target->value.size() == 0 || target->value.size() >= 32 ||\n                  target->value[0] < 'a' || target->value[0] > 'z') {\n                errorReporter.addError(target->startByte, target->endByte,\n                                       \"Not a valid annotation target.\");\n              } else {\n                char buffer[64];\n                strcpy(buffer, \"targets\");\n                strcat(buffer, target->value.cStr());\n                buffer[strlen(\"targets\")] += 'A' - 'a';\n                KJ_IF_MAYBE(field, dynamicBuilder.getSchema().findFieldByName(buffer)) {\n                  if (dynamicBuilder.get(*field).as<bool>()) {\n                    errorReporter.addError(target->startByte, target->endByte,\n                                           \"Duplicate target specification.\");\n                  }\n                  dynamicBuilder.set(*field, true);\n                } else {\n                  errorReporter.addError(target->startByte, target->endByte,\n                                         \"Not a valid annotation target.\");\n                }\n              }\n            }",
          "includes": [
            "#include <windows.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <kj/debug.h>",
            "#include <capnp/dynamic.h>",
            "#include \"md5.h\"",
            "#include \"parser.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <windows.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <kj/debug.h>\n#include <capnp/dynamic.h>\n#include \"md5.h\"\n#include \"parser.h\"\n\nKJ_IF_MAYBE(target, maybeTarget) {\n            if (target->value == \"*\") {\n              // Set all.\n              if (targets.value.size() > 1) {\n                errorReporter.addError(target->startByte, target->endByte,\n                    \"Wildcard should not be specified together with other targets.\");\n              }\n\n              for (auto field: dynamicBuilder.getSchema().getFields()) {\n                if (field.getProto().getName().startsWith(\"targets\")) {\n                  dynamicBuilder.set(field, true);\n                }\n              }\n            } else {\n              if (target->value.size() == 0 || target->value.size() >= 32 ||\n                  target->value[0] < 'a' || target->value[0] > 'z') {\n                errorReporter.addError(target->startByte, target->endByte,\n                                       \"Not a valid annotation target.\");\n              } else {\n                char buffer[64];\n                strcpy(buffer, \"targets\");\n                strcat(buffer, target->value.cStr());\n                buffer[strlen(\"targets\")] += 'A' - 'a';\n                KJ_IF_MAYBE(field, dynamicBuilder.getSchema().findFieldByName(buffer)) {\n                  if (dynamicBuilder.get(*field).as<bool>()) {\n                    errorReporter.addError(target->startByte, target->endByte,\n                                           \"Duplicate target specification.\");\n                  }\n                  dynamicBuilder.set(*field, true);\n                } else {\n                  errorReporter.addError(target->startByte, target->endByte,\n                                         \"Not a valid annotation target.\");\n                }\n              }\n            }"
        }
      },
      {
        "call_info": {
          "callee": "path.findLast",
          "args": [
            "'/'"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "findLast",
          "container": "String",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "183-183",
          "snippet": "inline Maybe<size_t> findLast(char c) const { return StringPtr(*this).findLast(c); }",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\nString {\n  inline Maybe<size_t> findLast(char c) const { return StringPtr(*this).findLast(c); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::StringPtr baseName(kj::StringPtr path) {\n  KJ_IF_MAYBE(slashPos, path.findLast('/')) {\n    return path.slice(*slashPos + 1);\n  } else {\n    return path;\n  }\n}"
  },
  {
    "function_name": "makeMembersByName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "129-133",
    "snippet": "kj::Array<uint> makeMembersByName(MemberList&& members) {\n  auto sorted = KJ_MAP(member, members) { return member; };\n  std::sort(sorted.begin(), sorted.end(), OrderByName());\n  return KJ_MAP(member, sorted) { return member.getIndex(); };\n}",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "member.getIndex",
          "args": [],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "getIndex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.h",
          "lines": "487-487",
          "snippet": "inline uint getIndex() const { return ordinal; }",
          "includes": [
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/schema.capnp.h>\n\ninline uint getIndex() const { return ordinal; }"
        }
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "member",
            "sorted"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::sort",
          "args": [
            "sorted.begin()",
            "sorted.end()",
            "OrderByName()"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OrderByName",
          "args": [],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sorted.end",
          "args": [],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-capnp.c++",
          "lines": "77-77",
          "snippet": "inline Iterator end() const { return Iterator(amount); }",
          "includes": [
            "#include \"config.h\"",
            "#include <map>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <map>\n#include <algorithm>\n#include <kj/main.h>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nIndent {\n  inline Iterator end() const { return Iterator(amount); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "sorted.begin",
          "args": [],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-capnp.c++",
          "lines": "76-76",
          "snippet": "inline Iterator begin() const { return Iterator(0); }",
          "includes": [
            "#include \"config.h\"",
            "#include <map>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <map>\n#include <algorithm>\n#include <kj/main.h>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nIndent {\n  inline Iterator begin() const { return Iterator(0); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "KJ_MAP",
          "args": [
            "member",
            "members"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nkj::Array<uint> makeMembersByName(MemberList&& members) {\n  auto sorted = KJ_MAP(member, members) { return member; };\n  std::sort(sorted.begin(), sorted.end(), OrderByName());\n  return KJ_MAP(member, sorted) { return member.getIndex(); };\n}"
  },
  {
    "function_name": "enumerateDeps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "86-119",
    "snippet": "void enumerateDeps(schema::Node::Reader node, std::set<uint64_t>& deps) {\n  switch (node.which()) {\n    case schema::Node::STRUCT: {\n      auto structNode = node.getStruct();\n      for (auto field: structNode.getFields()) {\n        switch (field.which()) {\n          case schema::Field::SLOT:\n            enumerateDeps(field.getSlot().getType(), deps);\n            break;\n          case schema::Field::GROUP:\n            deps.insert(field.getGroup().getTypeId());\n            break;\n        }\n      }\n      if (structNode.getIsGroup()) {\n        deps.insert(node.getScopeId());\n      }\n      break;\n    }\n    case schema::Node::INTERFACE: {\n      auto interfaceNode = node.getInterface();\n      for (auto superclass: interfaceNode.getSuperclasses()) {\n        deps.insert(superclass.getId());\n      }\n      for (auto method: interfaceNode.getMethods()) {\n        deps.insert(method.getParamStructType());\n        deps.insert(method.getResultStructType());\n      }\n      break;\n    }\n    default:\n      break;\n  }\n}",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "schema::Node::Reader node;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "deps.insert",
          "args": [
            "method.getResultStructType()"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "method.getResultStructType",
          "args": [],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "deps.insert",
          "args": [
            "method.getParamStructType()"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "method.getParamStructType",
          "args": [],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "interfaceNode.getMethods",
          "args": [],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "deps.insert",
          "args": [
            "superclass.getId()"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "superclass.getId",
          "args": [],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "getId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/compiler.c++",
          "lines": "75-75",
          "snippet": "uint64_t getId() { return id; }",
          "includes": [
            "#include \"md5.h\"",
            "#include \"node-translator.h\"",
            "#include <unordered_map>",
            "#include <set>",
            "#include <map>",
            "#include <capnp/message.h>",
            "#include <kj/debug.h>",
            "#include <kj/vector.h>",
            "#include <kj/arena.h>",
            "#include <kj/mutex.h>",
            "#include \"parser.h\"      // only for generateChildId()",
            "#include \"compiler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"node-translator.h\"\n#include <unordered_map>\n#include <set>\n#include <map>\n#include <capnp/message.h>\n#include <kj/debug.h>\n#include <kj/vector.h>\n#include <kj/arena.h>\n#include <kj/mutex.h>\n#include \"parser.h\"      // only for generateChildId()\n#include \"compiler.h\"\n\nuint64_t getId() { return id; }"
        }
      },
      {
        "call_info": {
          "callee": "interfaceNode.getSuperclasses",
          "args": [],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "node.getInterface",
          "args": [],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "deps.insert",
          "args": [
            "node.getScopeId()"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "node.getScopeId",
          "args": [],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "getScopeId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/node-translator.c++",
          "lines": "778-778",
          "snippet": "inline uint64_t getScopeId() { return leafId; }",
          "includes": [
            "#include <map>",
            "#include <set>",
            "#include <kj/arena.h>",
            "#include <kj/debug.h>",
            "#include \"parser.h\"      // only for generateGroupId()",
            "#include \"node-translator.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "uint64_t leafId;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <map>\n#include <set>\n#include <kj/arena.h>\n#include <kj/debug.h>\n#include \"parser.h\"      // only for generateGroupId()\n#include \"node-translator.h\"\n\nuint64_t leafId;\n\ninline uint64_t getScopeId() { return leafId; }"
        }
      },
      {
        "call_info": {
          "callee": "structNode.getIsGroup",
          "args": [],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "deps.insert",
          "args": [
            "field.getGroup().getTypeId()"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getGroup",
          "args": [],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getGroup",
          "args": [],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getSlot",
          "args": [],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.getSlot",
          "args": [],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "field.which",
          "args": [],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "structNode.getFields",
          "args": [],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "node.getStruct",
          "args": [],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "node.which",
          "args": [],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nschema::Node::Reader node;\n\nvoid enumerateDeps(schema::Node::Reader node, std::set<uint64_t>& deps) {\n  switch (node.which()) {\n    case schema::Node::STRUCT: {\n      auto structNode = node.getStruct();\n      for (auto field: structNode.getFields()) {\n        switch (field.which()) {\n          case schema::Field::SLOT:\n            enumerateDeps(field.getSlot().getType(), deps);\n            break;\n          case schema::Field::GROUP:\n            deps.insert(field.getGroup().getTypeId());\n            break;\n        }\n      }\n      if (structNode.getIsGroup()) {\n        deps.insert(node.getScopeId());\n      }\n      break;\n    }\n    case schema::Node::INTERFACE: {\n      auto interfaceNode = node.getInterface();\n      for (auto superclass: interfaceNode.getSuperclasses()) {\n        deps.insert(superclass.getId());\n      }\n      for (auto method: interfaceNode.getMethods()) {\n        deps.insert(method.getParamStructType());\n        deps.insert(method.getResultStructType());\n      }\n      break;\n    }\n    default:\n      break;\n  }\n}"
  },
  {
    "function_name": "enumerateDeps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "67-84",
    "snippet": "void enumerateDeps(schema::Type::Reader type, std::set<uint64_t>& deps) {\n  switch (type.which()) {\n    case schema::Type::STRUCT:\n      deps.insert(type.getStruct().getTypeId());\n      break;\n    case schema::Type::ENUM:\n      deps.insert(type.getEnum().getTypeId());\n      break;\n    case schema::Type::INTERFACE:\n      deps.insert(type.getInterface().getTypeId());\n      break;\n    case schema::Type::LIST:\n      enumerateDeps(type.getList().getElementType(), deps);\n      break;\n    default:\n      break;\n  }\n}",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "type.getList",
          "args": [],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.getList",
          "args": [],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "deps.insert",
          "args": [
            "type.getInterface().getTypeId()"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.getInterface",
          "args": [],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.getInterface",
          "args": [],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "deps.insert",
          "args": [
            "type.getEnum().getTypeId()"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.getEnum",
          "args": [],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.getEnum",
          "args": [],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "deps.insert",
          "args": [
            "type.getStruct().getTypeId()"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.getStruct",
          "args": [],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.getStruct",
          "args": [],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.which",
          "args": [],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nvoid enumerateDeps(schema::Type::Reader type, std::set<uint64_t>& deps) {\n  switch (type.which()) {\n    case schema::Type::STRUCT:\n      deps.insert(type.getStruct().getTypeId());\n      break;\n    case schema::Type::ENUM:\n      deps.insert(type.getEnum().getTypeId());\n      break;\n    case schema::Type::INTERFACE:\n      deps.insert(type.getInterface().getTypeId());\n      break;\n    case schema::Type::LIST:\n      enumerateDeps(type.getList().getElementType(), deps);\n      break;\n    default:\n      break;\n  }\n}"
  },
  {
    "function_name": "hasDiscriminantValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-c++.c++",
    "lines": "63-65",
    "snippet": "bool hasDiscriminantValue(const schema::Field::Reader& reader) {\n  return reader.getDiscriminantValue() != schema::Field::NO_DISCRIMINANT;\n}",
    "includes": [
      "#include \"config.h\"",
      "#include <errno.h>",
      "#include <fcntl.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <algorithm>",
      "#include <kj/main.h>",
      "#include <set>",
      "#include <map>",
      "#include <unordered_set>",
      "#include <unordered_map>",
      "#include <unistd.h>",
      "#include \"../dynamic.h\"",
      "#include \"../schema-loader.h\"",
      "#include <kj/vector.h>",
      "#include <kj/tuple.h>",
      "#include <kj/string-tree.h>",
      "#include <kj/io.h>",
      "#include <kj/debug.h>",
      "#include \"../serialize.h\"",
      "#include <capnp/schema.capnp.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reader.getDiscriminantValue",
          "args": [],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <errno.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <algorithm>\n#include <kj/main.h>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/tuple.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nbool hasDiscriminantValue(const schema::Field::Reader& reader) {\n  return reader.getDiscriminantValue() != schema::Field::NO_DISCRIMINANT;\n}"
  }
]