[
  {
    "function_name": "tryRead",
    "container": "StdInputStream",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/std/iostream.h",
    "lines": "72-78",
    "snippet": "virtual size_t tryRead(\n      void* buffer, size_t minBytes, size_t maxBytes) override {\n    // Like read(), but may return fewer than minBytes on EOF.\n\n    stream_.read((char*)buffer, maxBytes);\n    return stream_.gcount();\n  }",
    "includes": [
      "#include <iostream>",
      "#include \"../io.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "stream_.gcount",
          "args": [],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stream_.read",
          "args": [
            "(char*)buffer",
            "maxBytes"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "read",
          "container": "SnappyCompressed",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/benchmark/protobuf-common.h",
          "lines": "149-159",
          "snippet": "static void read(int* input, google::protobuf::MessageLite* message) {\n    uint32_t size;\n    readAll(*input, &size, sizeof(size));\n    readAll(*input, scratch, size);\n\n    size_t uncompressedSize;\n    GOOGLE_CHECK(snappy::GetUncompressedLength(scratch, size, &uncompressedSize));\n    GOOGLE_CHECK(snappy::RawUncompress(scratch, size, scratch2));\n\n    GOOGLE_CHECK(message->ParsePartialFromArray(scratch2, uncompressedSize));\n  }",
          "includes": [
            "#include <snappy/snappy-sinksource.h>",
            "#include <snappy/snappy.h>",
            "#include <thread>",
            "#include <google/protobuf/io/coded_stream.h>",
            "#include <google/protobuf/io/zero_copy_stream_impl.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <snappy/snappy-sinksource.h>\n#include <snappy/snappy.h>\n#include <thread>\n#include <google/protobuf/io/coded_stream.h>\n#include <google/protobuf/io/zero_copy_stream_impl.h>\n#include \"common.h\"\n\nSnappyCompressed {\n  static void read(int* input, google::protobuf::MessageLite* message) {\n      uint32_t size;\n      readAll(*input, &size, sizeof(size));\n      readAll(*input, scratch, size);\n  \n      size_t uncompressedSize;\n      GOOGLE_CHECK(snappy::GetUncompressedLength(scratch, size, &uncompressedSize));\n      GOOGLE_CHECK(snappy::RawUncompress(scratch, size, scratch2));\n  \n      GOOGLE_CHECK(message->ParsePartialFromArray(scratch2, uncompressedSize));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <iostream>\n#include \"../io.h\"\n\nStdInputStream {\n  virtual size_t tryRead(\n        void* buffer, size_t minBytes, size_t maxBytes) override {\n      // Like read(), but may return fewer than minBytes on EOF.\n  \n      stream_.read((char*)buffer, maxBytes);\n      return stream_.gcount();\n    }\n}"
  },
  {
    "function_name": "StdInputStream",
    "container": "StdInputStream",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/std/iostream.h",
    "lines": "69-69",
    "snippet": "explicit StdInputStream(::std::istream& stream) : stream_(stream) {}",
    "includes": [
      "#include <iostream>",
      "#include \"../io.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <iostream>\n#include \"../io.h\"\n\nStdInputStream {\n  explicit StdInputStream(::std::istream& stream) : stream_(stream) {}\n}"
  },
  {
    "function_name": "write",
    "container": "StdOutputStream",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/std/iostream.h",
    "lines": "51-59",
    "snippet": "virtual void write(ArrayPtr<const ArrayPtr<const byte>> pieces) override {\n    // Equivalent to write()ing each byte array in sequence, which is what the\n    // default implementation does. Override if you can do something better,\n    // e.g. use writev() to do the write in a single syscall.\n\n    for (auto piece : pieces) {\n      write(piece.begin(), piece.size());\n    }\n  }",
    "includes": [
      "#include <iostream>",
      "#include \"../io.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "piece.size",
          "args": [],
          "line": 57
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "599-599",
          "snippet": "inline uint size() { return _builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline uint size() { return _builder.size() / ELEMENTS; }"
        }
      },
      {
        "call_info": {
          "callee": "piece.begin",
          "args": [],
          "line": 57
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "550-550",
          "snippet": "inline Iterator begin() { return Iterator(this, 0); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Iterator begin() { return Iterator(this, 0); }"
        }
      }
    ],
    "contextual_snippet": "#include <iostream>\n#include \"../io.h\"\n\nStdOutputStream {\n  virtual void write(ArrayPtr<const ArrayPtr<const byte>> pieces) override {\n      // Equivalent to write()ing each byte array in sequence, which is what the\n      // default implementation does. Override if you can do something better,\n      // e.g. use writev() to do the write in a single syscall.\n  \n      for (auto piece : pieces) {\n        write(piece.begin(), piece.size());\n      }\n    }\n}"
  },
  {
    "function_name": "write",
    "container": "StdOutputStream",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/std/iostream.h",
    "lines": "45-49",
    "snippet": "virtual void write(const void* src, size_t size) override {\n    // Always writes the full size.\n\n    stream_.write((char*)src, size);\n  }",
    "includes": [
      "#include <iostream>",
      "#include \"../io.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <iostream>\n#include \"../io.h\"\n\nStdOutputStream {\n  virtual void write(const void* src, size_t size) override {\n      // Always writes the full size.\n  \n      stream_.write((char*)src, size);\n    }\n}"
  },
  {
    "function_name": "StdOutputStream",
    "container": "StdOutputStream",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/std/iostream.h",
    "lines": "42-42",
    "snippet": "explicit StdOutputStream(::std::ostream& stream) : stream_(stream) {}",
    "includes": [
      "#include <iostream>",
      "#include \"../io.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <iostream>\n#include \"../io.h\"\n\nStdOutputStream {\n  explicit StdOutputStream(::std::ostream& stream) : stream_(stream) {}\n}"
  }
]