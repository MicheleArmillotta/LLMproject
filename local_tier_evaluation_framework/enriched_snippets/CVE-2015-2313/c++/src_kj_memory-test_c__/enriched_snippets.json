[
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/memory-test.c++",
    "lines": "56-66",
    "snippet": "TEST(Memory, AssignNested) {\n  bool destroyed1 = false, destroyed2 = false;\n  auto nested = heap<Nested>(destroyed1);\n  nested->nested = heap<Nested>(destroyed2);\n  EXPECT_FALSE(destroyed1 || destroyed2);\n  nested = kj::mv(nested->nested);\n  EXPECT_TRUE(destroyed1);\n  EXPECT_FALSE(destroyed2);\n  nested = nullptr;\n  EXPECT_TRUE(destroyed1 && destroyed2);\n}",
    "includes": [
      "#include \"debug.h\"",
      "#include <kj/compat/gtest.h>",
      "#include \"memory.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "destroyed1 && destroyed2"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "destroyed2"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_TRUE",
          "args": [
            "destroyed1"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "nested->nested"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_FALSE",
          "args": [
            "destroyed1 || destroyed2"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "heap<Nested>",
          "args": [
            "destroyed2"
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "heap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/memory.h",
          "lines": "331-339",
          "snippet": "Own<Decay<T>> heap(T&& orig) {\n  // Allocate a copy (or move) of the argument on the heap.\n  //\n  // The purpose of this overload is to allow you to omit the template parameter as there is only\n  // one argument and the purpose is to copy it.\n\n  typedef Decay<T> T2;\n  return Own<T2>(new T2(kj::fwd<T>(orig)), _::HeapDisposer<T2>::instance);\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nOwn<Decay<T>> heap(T&& orig) {\n  // Allocate a copy (or move) of the argument on the heap.\n  //\n  // The purpose of this overload is to allow you to omit the template parameter as there is only\n  // one argument and the purpose is to copy it.\n\n  typedef Decay<T> T2;\n  return Own<T2>(new T2(kj::fwd<T>(orig)), _::HeapDisposer<T2>::instance);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"debug.h\"\n#include <kj/compat/gtest.h>\n#include \"memory.h\"\n\nTEST(Memory, AssignNested) {\n  bool destroyed1 = false, destroyed2 = false;\n  auto nested = heap<Nested>(destroyed1);\n  nested->nested = heap<Nested>(destroyed2);\n  EXPECT_FALSE(destroyed1 || destroyed2);\n  nested = kj::mv(nested->nested);\n  EXPECT_TRUE(destroyed1);\n  EXPECT_FALSE(destroyed2);\n  nested = nullptr;\n  EXPECT_TRUE(destroyed1 && destroyed2);\n}"
  },
  {
    "function_name": "Nested",
    "container": "Nested",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/memory-test.c++",
    "lines": "49-49",
    "snippet": "Nested(bool& destroyed): destroyed(destroyed) {}",
    "includes": [
      "#include \"debug.h\"",
      "#include <kj/compat/gtest.h>",
      "#include \"memory.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"debug.h\"\n#include <kj/compat/gtest.h>\n#include \"memory.h\"\n\nNested {\n  Nested(bool& destroyed): destroyed(destroyed) {}\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/memory-test.c++",
    "lines": "40-46",
    "snippet": "TEST(Memory, CanConvert) {\n  struct Super { virtual ~Super() {} };\n  struct Sub: public Super {};\n\n  static_assert(canConvert<Own<Sub>, Own<Super>>(), \"failure\");\n  static_assert(!canConvert<Own<Super>, Own<Sub>>(), \"failure\");\n}",
    "includes": [
      "#include \"debug.h\"",
      "#include <kj/compat/gtest.h>",
      "#include \"memory.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "canConvert<Own<Super>, Own<Sub>>",
          "args": [],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "canConvert<Own<Sub>, Own<Super>>",
          "args": [],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"debug.h\"\n#include <kj/compat/gtest.h>\n#include \"memory.h\"\n\nTEST(Memory, CanConvert) {\n  struct Super { virtual ~Super() {} };\n  struct Sub: public Super {};\n\n  static_assert(canConvert<Own<Sub>, Own<Super>>(), \"failure\");\n  static_assert(!canConvert<Own<Super>, Own<Sub>>(), \"failure\");\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/memory-test.c++",
    "lines": "29-38",
    "snippet": "TEST(Memory, OwnConst) {\n  Own<int> i = heap<int>(2);\n  EXPECT_EQ(2, *i);\n\n  Own<const int> ci = mv(i);\n  EXPECT_EQ(2, *ci);\n\n  Own<const int> ci2 = heap<const int>(3);\n  EXPECT_EQ(3, *ci2);\n}",
    "includes": [
      "#include \"debug.h\"",
      "#include <kj/compat/gtest.h>",
      "#include \"memory.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "3",
            "*ci2"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "heap<const int>",
          "args": [
            "3"
          ],
          "line": 36
        },
        "resolved": true,
        "details": {
          "function_name": "heap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/memory.h",
          "lines": "331-339",
          "snippet": "Own<Decay<T>> heap(T&& orig) {\n  // Allocate a copy (or move) of the argument on the heap.\n  //\n  // The purpose of this overload is to allow you to omit the template parameter as there is only\n  // one argument and the purpose is to copy it.\n\n  typedef Decay<T> T2;\n  return Own<T2>(new T2(kj::fwd<T>(orig)), _::HeapDisposer<T2>::instance);\n}",
          "includes": [
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"common.h\"\n\nOwn<Decay<T>> heap(T&& orig) {\n  // Allocate a copy (or move) of the argument on the heap.\n  //\n  // The purpose of this overload is to allow you to omit the template parameter as there is only\n  // one argument and the purpose is to copy it.\n\n  typedef Decay<T> T2;\n  return Own<T2>(new T2(kj::fwd<T>(orig)), _::HeapDisposer<T2>::instance);\n}"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "2",
            "*ci"
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mv",
          "args": [
            "i"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "2",
            "*i"
          ],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"debug.h\"\n#include <kj/compat/gtest.h>\n#include \"memory.h\"\n\nTEST(Memory, OwnConst) {\n  Own<int> i = heap<int>(2);\n  EXPECT_EQ(2, *i);\n\n  Own<const int> ci = mv(i);\n  EXPECT_EQ(2, *ci);\n\n  Own<const int> ci2 = heap<const int>(3);\n  EXPECT_EQ(3, *ci2);\n}"
  }
]