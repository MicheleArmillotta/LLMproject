[
  {
    "function_name": "AnyPointer::Pipeline::asCap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.c++",
    "lines": "74-76",
    "snippet": "kj::Own<ClientHook> AnyPointer::Pipeline::asCap() {\n  return hook->getPipelinedCap(ops);\n}",
    "includes": [
      "#include \"capability.h\"",
      "#include \"any.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hook->getPipelinedCap",
          "args": [
            "ops"
          ],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "getPipelinedCap",
          "container": "LocalPipeline",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.c++",
          "lines": "449-451",
          "snippet": "kj::Own<ClientHook> getPipelinedCap(kj::ArrayPtr<const PipelineOp> ops) {\n    return results.getPipelinedCap(ops);\n  }",
          "includes": [
            "#include \"generated-header-support.h\"",
            "#include <map>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <kj/refcount.h>",
            "#include \"arena.h\"",
            "#include \"message.h\"",
            "#include \"capability.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"generated-header-support.h\"\n#include <map>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <kj/refcount.h>\n#include \"arena.h\"\n#include \"message.h\"\n#include \"capability.h\"\n\nLocalPipeline {\n  kj::Own<ClientHook> getPipelinedCap(kj::ArrayPtr<const PipelineOp> ops) {\n      return results.getPipelinedCap(ops);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n\nkj::Own<ClientHook> AnyPointer::Pipeline::asCap() {\n  return hook->getPipelinedCap(ops);\n}"
  },
  {
    "function_name": "AnyPointer::Pipeline::getPointerField",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.c++",
    "lines": "62-72",
    "snippet": "AnyPointer::Pipeline AnyPointer::Pipeline::getPointerField(uint16_t pointerIndex) {\n  auto newOps = kj::heapArray<PipelineOp>(ops.size() + 1);\n  for (auto i: kj::indices(ops)) {\n    newOps[i] = ops[i];\n  }\n  auto& newOp = newOps[ops.size()];\n  newOp.type = PipelineOp::GET_POINTER_FIELD;\n  newOp.pointerIndex = pointerIndex;\n\n  return Pipeline(hook->addRef(), kj::mv(newOps));\n}",
    "includes": [
      "#include \"capability.h\"",
      "#include \"any.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Pipeline",
          "args": [
            "hook->addRef()",
            "kj::mv(newOps)"
          ],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "Pipeline",
          "container": "AnyPointer::Pipeline",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "263-264",
          "snippet": "inline Pipeline(kj::Own<PipelineHook>&& hook, kj::Array<PipelineOp>&& ops)\n        : hook(kj::mv(hook)), ops(kj::mv(ops)) {}",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nAnyPointer {\n  Pipeline {\n    inline Pipeline(kj::Own<PipelineHook>&& hook, kj::Array<PipelineOp>&& ops)\n            : hook(kj::mv(hook)), ops(kj::mv(ops)) {}\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "newOps"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hook->addRef",
          "args": [],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "addRef",
          "container": "BrokenClient",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.c++",
          "lines": "598-600",
          "snippet": "kj::Own<ClientHook> addRef() override {\n    return kj::addRef(*this);\n  }",
          "includes": [
            "#include \"generated-header-support.h\"",
            "#include <map>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <kj/refcount.h>",
            "#include \"arena.h\"",
            "#include \"message.h\"",
            "#include \"capability.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"generated-header-support.h\"\n#include <map>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <kj/refcount.h>\n#include \"arena.h\"\n#include \"message.h\"\n#include \"capability.h\"\n\nBrokenClient {\n  kj::Own<ClientHook> addRef() override {\n      return kj::addRef(*this);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ops.size",
          "args": [],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "599-599",
          "snippet": "inline uint size() { return _builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline uint size() { return _builder.size() / ELEMENTS; }"
        }
      },
      {
        "call_info": {
          "callee": "kj::indices",
          "args": [
            "ops"
          ],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "indices",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "650-656",
          "snippet": "inline constexpr Range<size_t> indices(T&& container) {\n  // Shortcut for iterating over the indices of a container:\n  //\n  //     for (size_t i: kj::indices(myArray)) { handle(myArray[i]); }\n\n  return range<size_t>(0, kj::size(container));\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\ninline constexpr Range<size_t> indices(T&& container) {\n  // Shortcut for iterating over the indices of a container:\n  //\n  //     for (size_t i: kj::indices(myArray)) { handle(myArray[i]); }\n\n  return range<size_t>(0, kj::size(container));\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::heapArray<PipelineOp>",
          "args": [
            "ops.size() + 1"
          ],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "heapArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "696-698",
          "snippet": "inline Array<T> heapArray(std::initializer_list<T> init) {\n  return heapArray<T>(init.begin(), init.end());\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\ninline Array<T> heapArray(std::initializer_list<T> init) {\n  return heapArray<T>(init.begin(), init.end());\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n\nAnyPointer::Pipeline AnyPointer::Pipeline::getPointerField(uint16_t pointerIndex) {\n  auto newOps = kj::heapArray<PipelineOp>(ops.size() + 1);\n  for (auto i: kj::indices(ops)) {\n    newOps[i] = ops[i];\n  }\n  auto& newOp = newOps[ops.size()];\n  newOp.type = PipelineOp::GET_POINTER_FIELD;\n  newOp.pointerIndex = pointerIndex;\n\n  return Pipeline(hook->addRef(), kj::mv(newOps));\n}"
  },
  {
    "function_name": "AnyPointer::Pipeline::noop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.c++",
    "lines": "54-60",
    "snippet": "AnyPointer::Pipeline AnyPointer::Pipeline::noop() {\n  auto newOps = kj::heapArray<PipelineOp>(ops.size());\n  for (auto i: kj::indices(ops)) {\n    newOps[i] = ops[i];\n  }\n  return Pipeline(hook->addRef(), kj::mv(newOps));\n}",
    "includes": [
      "#include \"capability.h\"",
      "#include \"any.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Pipeline",
          "args": [
            "hook->addRef()",
            "kj::mv(newOps)"
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "Pipeline",
          "container": "AnyPointer::Pipeline",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "263-264",
          "snippet": "inline Pipeline(kj::Own<PipelineHook>&& hook, kj::Array<PipelineOp>&& ops)\n        : hook(kj::mv(hook)), ops(kj::mv(ops)) {}",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\nAnyPointer {\n  Pipeline {\n    inline Pipeline(kj::Own<PipelineHook>&& hook, kj::Array<PipelineOp>&& ops)\n            : hook(kj::mv(hook)), ops(kj::mv(ops)) {}\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "newOps"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hook->addRef",
          "args": [],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "addRef",
          "container": "BrokenClient",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.c++",
          "lines": "598-600",
          "snippet": "kj::Own<ClientHook> addRef() override {\n    return kj::addRef(*this);\n  }",
          "includes": [
            "#include \"generated-header-support.h\"",
            "#include <map>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <kj/refcount.h>",
            "#include \"arena.h\"",
            "#include \"message.h\"",
            "#include \"capability.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"generated-header-support.h\"\n#include <map>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <kj/refcount.h>\n#include \"arena.h\"\n#include \"message.h\"\n#include \"capability.h\"\n\nBrokenClient {\n  kj::Own<ClientHook> addRef() override {\n      return kj::addRef(*this);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::indices",
          "args": [
            "ops"
          ],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "indices",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "650-656",
          "snippet": "inline constexpr Range<size_t> indices(T&& container) {\n  // Shortcut for iterating over the indices of a container:\n  //\n  //     for (size_t i: kj::indices(myArray)) { handle(myArray[i]); }\n\n  return range<size_t>(0, kj::size(container));\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\ninline constexpr Range<size_t> indices(T&& container) {\n  // Shortcut for iterating over the indices of a container:\n  //\n  //     for (size_t i: kj::indices(myArray)) { handle(myArray[i]); }\n\n  return range<size_t>(0, kj::size(container));\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::heapArray<PipelineOp>",
          "args": [
            "ops.size()"
          ],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "heapArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "696-698",
          "snippet": "inline Array<T> heapArray(std::initializer_list<T> init) {\n  return heapArray<T>(init.begin(), init.end());\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\ninline Array<T> heapArray(std::initializer_list<T> init) {\n  return heapArray<T>(init.begin(), init.end());\n}"
        }
      },
      {
        "call_info": {
          "callee": "ops.size",
          "args": [],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "599-599",
          "snippet": "inline uint size() { return _builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline uint size() { return _builder.size() / ELEMENTS; }"
        }
      }
    ],
    "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n\nAnyPointer::Pipeline AnyPointer::Pipeline::noop() {\n  auto newOps = kj::heapArray<PipelineOp>(ops.size());\n  for (auto i: kj::indices(ops)) {\n    newOps[i] = ops[i];\n  }\n  return Pipeline(hook->addRef(), kj::mv(newOps));\n}"
  },
  {
    "function_name": "AnyPointer::Reader::getPipelinedCap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.c++",
    "lines": "36-52",
    "snippet": "kj::Own<ClientHook> AnyPointer::Reader::getPipelinedCap(\n    kj::ArrayPtr<const PipelineOp> ops) const {\n  _::PointerReader pointer = reader;\n\n  for (auto& op: ops) {\n    switch (op.type) {\n      case PipelineOp::Type::NOOP:\n        break;\n\n      case PipelineOp::Type::GET_POINTER_FIELD:\n        pointer = pointer.getStruct(nullptr).getPointerField(op.pointerIndex * POINTERS);\n        break;\n    }\n  }\n\n  return pointer.getCapability();\n}",
    "includes": [
      "#include \"capability.h\"",
      "#include \"any.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pointer.getCapability",
          "args": [],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pointer.getStruct",
          "args": [
            "op.pointerIndex * POINTERS"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pointer.getStruct",
          "args": [
            "nullptr"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n\nkj::Own<ClientHook> AnyPointer::Reader::getPipelinedCap(\n    kj::ArrayPtr<const PipelineOp> ops) const {\n  _::PointerReader pointer = reader;\n\n  for (auto& op: ops) {\n    switch (op.type) {\n      case PipelineOp::Type::NOOP:\n        break;\n\n      case PipelineOp::Type::GET_POINTER_FIELD:\n        pointer = pointer.getStruct(nullptr).getPointerField(op.pointerIndex * POINTERS);\n        break;\n    }\n  }\n\n  return pointer.getCapability();\n}"
  },
  {
    "function_name": "PipelineHook::getPipelinedCap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.c++",
    "lines": "32-34",
    "snippet": "kj::Own<ClientHook> PipelineHook::getPipelinedCap(kj::Array<PipelineOp>&& ops) {\n  return getPipelinedCap(ops.asPtr());\n}",
    "includes": [
      "#include \"capability.h\"",
      "#include \"any.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "getPipelinedCap",
          "args": [
            "ops.asPtr()"
          ],
          "line": 33
        },
        "resolved": true,
        "details": {
          "function_name": "AnyPointer::Reader::getPipelinedCap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.c++",
          "lines": "36-52",
          "snippet": "kj::Own<ClientHook> AnyPointer::Reader::getPipelinedCap(\n    kj::ArrayPtr<const PipelineOp> ops) const {\n  _::PointerReader pointer = reader;\n\n  for (auto& op: ops) {\n    switch (op.type) {\n      case PipelineOp::Type::NOOP:\n        break;\n\n      case PipelineOp::Type::GET_POINTER_FIELD:\n        pointer = pointer.getStruct(nullptr).getPointerField(op.pointerIndex * POINTERS);\n        break;\n    }\n  }\n\n  return pointer.getCapability();\n}",
          "includes": [
            "#include \"capability.h\"",
            "#include \"any.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n\nkj::Own<ClientHook> AnyPointer::Reader::getPipelinedCap(\n    kj::ArrayPtr<const PipelineOp> ops) const {\n  _::PointerReader pointer = reader;\n\n  for (auto& op: ops) {\n    switch (op.type) {\n      case PipelineOp::Type::NOOP:\n        break;\n\n      case PipelineOp::Type::GET_POINTER_FIELD:\n        pointer = pointer.getStruct(nullptr).getPointerField(op.pointerIndex * POINTERS);\n        break;\n    }\n  }\n\n  return pointer.getCapability();\n}"
        }
      },
      {
        "call_info": {
          "callee": "ops.asPtr",
          "args": [],
          "line": 33
        },
        "resolved": true,
        "details": {
          "function_name": "asPtr",
          "container": "ArrayBuilder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/array.h",
          "lines": "313-315",
          "snippet": "inline ArrayPtr<const T> asPtr() const {\n    return arrayPtr(ptr, pos);\n  }",
          "includes": [
            "#include <initializer_list>",
            "#include <string.h>",
            "#include \"common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <string.h>\n#include \"common.h\"\n\nArrayBuilder {\n  inline ArrayPtr<const T> asPtr() const {\n      return arrayPtr(ptr, pos);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"capability.h\"\n#include \"any.h\"\n\nkj::Own<ClientHook> PipelineHook::getPipelinedCap(kj::Array<PipelineOp>&& ops) {\n  return getPipelinedCap(ops.asPtr());\n}"
  }
]