[
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-async-test.c++",
    "lines": "228-250",
    "snippet": "TEST(SerializeAsyncTest, WriteAsyncEvenSegmentCount) {\n  PipeWithSmallBuffer fds;\n  auto ioContext = kj::setupAsyncIo();\n  auto output = ioContext.lowLevelProvider->wrapOutputFd(fds[1]);\n\n  TestMessageBuilder message(10);\n  auto root = message.getRoot<TestAllTypes>();\n  auto list = root.initStructList(16);\n  for (auto element: list) {\n    initTestMessage(element);\n  }\n\n  kj::Thread thread([&]() {\n    StreamFdMessageReader reader(fds[0]);\n    auto listReader = reader.getRoot<TestAllTypes>().getStructList();\n    EXPECT_EQ(list.size(), listReader.size());\n    for (auto element: listReader) {\n      checkTestMessage(element);\n    }\n  });\n\n  writeMessage(*output, message).wait(ioContext.waitScope);\n}",
    "includes": [
      "#include <kj/compat/gtest.h>",
      "#include \"test-util.h\"",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <kj/thread.h>",
      "#include <kj/debug.h>",
      "#include \"serialize.h\"",
      "#include \"serialize-async.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "writeMessage",
          "args": [
            "ioContext.waitScope"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "writeMessage",
          "args": [
            "*output",
            "message"
          ],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "writeMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-async.h",
          "lines": "58-60",
          "snippet": "inline kj::Promise<void> writeMessage(kj::AsyncOutputStream& output, MessageBuilder& builder) {\n  return writeMessage(output, builder.getSegmentsForOutput());\n}",
          "includes": [
            "#include \"message.h\"",
            "#include <kj/async-io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"message.h\"\n#include <kj/async-io.h>\n\ninline kj::Promise<void> writeMessage(kj::AsyncOutputStream& output, MessageBuilder& builder) {\n  return writeMessage(output, builder.getSegmentsForOutput());\n}"
        }
      },
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "element"
          ],
          "line": 245
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "list.size()",
            "listReader.size()"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "listReader.size",
          "args": [],
          "line": 243
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "599-599",
          "snippet": "inline uint size() { return _builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline uint size() { return _builder.size() / ELEMENTS; }"
        }
      },
      {
        "call_info": {
          "callee": "reader.getRoot<TestAllTypes>",
          "args": [],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "getRoot",
          "container": "RpcRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1322-1324",
          "snippet": "inline AnyPointer::Builder getRoot() {\n      return paramsBuilder;\n    }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nRpcRequest {\n  inline AnyPointer::Builder getRoot() {\n        return paramsBuilder;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "element"
          ],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "root.initStructList",
          "args": [
            "16"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ioContext.lowLevelProvider->wrapOutputFd",
          "args": [
            "fds[1]"
          ],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "wrapOutputFd",
          "container": "LowLevelAsyncIoProviderImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/async-io.c++",
          "lines": "910-912",
          "snippet": "Own<AsyncOutputStream> wrapOutputFd(int fd, uint flags = 0) override {\n    return heap<AsyncStreamFd>(eventPort, fd, flags);\n  }",
          "includes": [
            "#include <limits.h>",
            "#include <poll.h>",
            "#include <set>",
            "#include <netdb.h>",
            "#include <arpa/inet.h>",
            "#include <stdlib.h>",
            "#include <stddef.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/in.h>",
            "#include <sys/un.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/uio.h>",
            "#include <unistd.h>",
            "#include \"io.h\"",
            "#include \"thread.h\"",
            "#include \"debug.h\"",
            "#include \"async-unix.h\"",
            "#include \"async-io.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <poll.h>\n#include <set>\n#include <netdb.h>\n#include <arpa/inet.h>\n#include <stdlib.h>\n#include <stddef.h>\n#include <netinet/tcp.h>\n#include <netinet/in.h>\n#include <sys/un.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/uio.h>\n#include <unistd.h>\n#include \"io.h\"\n#include \"thread.h\"\n#include \"debug.h\"\n#include \"async-unix.h\"\n#include \"async-io.h\"\n\nLowLevelAsyncIoProviderImpl {\n  Own<AsyncOutputStream> wrapOutputFd(int fd, uint flags = 0) override {\n      return heap<AsyncStreamFd>(eventPort, fd, flags);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::setupAsyncIo",
          "args": [],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "setupAsyncIo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/async-io.c++",
          "lines": "1379-1385",
          "snippet": "AsyncIoContext setupAsyncIo() {\n  auto lowLevel = heap<LowLevelAsyncIoProviderImpl>();\n  auto ioProvider = kj::heap<AsyncIoProviderImpl>(*lowLevel);\n  auto& waitScope = lowLevel->getWaitScope();\n  auto& eventPort = lowLevel->getEventPort();\n  return { kj::mv(lowLevel), kj::mv(ioProvider), waitScope, eventPort };\n}",
          "includes": [
            "#include <limits.h>",
            "#include <poll.h>",
            "#include <set>",
            "#include <netdb.h>",
            "#include <arpa/inet.h>",
            "#include <stdlib.h>",
            "#include <stddef.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/in.h>",
            "#include <sys/un.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/uio.h>",
            "#include <unistd.h>",
            "#include \"io.h\"",
            "#include \"thread.h\"",
            "#include \"debug.h\"",
            "#include \"async-unix.h\"",
            "#include \"async-io.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <poll.h>\n#include <set>\n#include <netdb.h>\n#include <arpa/inet.h>\n#include <stdlib.h>\n#include <stddef.h>\n#include <netinet/tcp.h>\n#include <netinet/in.h>\n#include <sys/un.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/uio.h>\n#include <unistd.h>\n#include \"io.h\"\n#include \"thread.h\"\n#include \"debug.h\"\n#include \"async-unix.h\"\n#include \"async-io.h\"\n\nAsyncIoContext setupAsyncIo() {\n  auto lowLevel = heap<LowLevelAsyncIoProviderImpl>();\n  auto ioProvider = kj::heap<AsyncIoProviderImpl>(*lowLevel);\n  auto& waitScope = lowLevel->getWaitScope();\n  auto& eventPort = lowLevel->getEventPort();\n  return { kj::mv(lowLevel), kj::mv(ioProvider), waitScope, eventPort };\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/compat/gtest.h>\n#include \"test-util.h\"\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <kj/thread.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n#include \"serialize-async.h\"\n\nTEST(SerializeAsyncTest, WriteAsyncEvenSegmentCount) {\n  PipeWithSmallBuffer fds;\n  auto ioContext = kj::setupAsyncIo();\n  auto output = ioContext.lowLevelProvider->wrapOutputFd(fds[1]);\n\n  TestMessageBuilder message(10);\n  auto root = message.getRoot<TestAllTypes>();\n  auto list = root.initStructList(16);\n  for (auto element: list) {\n    initTestMessage(element);\n  }\n\n  kj::Thread thread([&]() {\n    StreamFdMessageReader reader(fds[0]);\n    auto listReader = reader.getRoot<TestAllTypes>().getStructList();\n    EXPECT_EQ(list.size(), listReader.size());\n    for (auto element: listReader) {\n      checkTestMessage(element);\n    }\n  });\n\n  writeMessage(*output, message).wait(ioContext.waitScope);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-async-test.c++",
    "lines": "204-226",
    "snippet": "TEST(SerializeAsyncTest, WriteAsyncOddSegmentCount) {\n  PipeWithSmallBuffer fds;\n  auto ioContext = kj::setupAsyncIo();\n  auto output = ioContext.lowLevelProvider->wrapOutputFd(fds[1]);\n\n  TestMessageBuilder message(7);\n  auto root = message.getRoot<TestAllTypes>();\n  auto list = root.initStructList(16);\n  for (auto element: list) {\n    initTestMessage(element);\n  }\n\n  kj::Thread thread([&]() {\n    StreamFdMessageReader reader(fds[0]);\n    auto listReader = reader.getRoot<TestAllTypes>().getStructList();\n    EXPECT_EQ(list.size(), listReader.size());\n    for (auto element: listReader) {\n      checkTestMessage(element);\n    }\n  });\n\n  writeMessage(*output, message).wait(ioContext.waitScope);\n}",
    "includes": [
      "#include <kj/compat/gtest.h>",
      "#include \"test-util.h\"",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <kj/thread.h>",
      "#include <kj/debug.h>",
      "#include \"serialize.h\"",
      "#include \"serialize-async.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "writeMessage",
          "args": [
            "ioContext.waitScope"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "writeMessage",
          "args": [
            "*output",
            "message"
          ],
          "line": 225
        },
        "resolved": true,
        "details": {
          "function_name": "writeMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-async.h",
          "lines": "58-60",
          "snippet": "inline kj::Promise<void> writeMessage(kj::AsyncOutputStream& output, MessageBuilder& builder) {\n  return writeMessage(output, builder.getSegmentsForOutput());\n}",
          "includes": [
            "#include \"message.h\"",
            "#include <kj/async-io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"message.h\"\n#include <kj/async-io.h>\n\ninline kj::Promise<void> writeMessage(kj::AsyncOutputStream& output, MessageBuilder& builder) {\n  return writeMessage(output, builder.getSegmentsForOutput());\n}"
        }
      },
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "element"
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "list.size()",
            "listReader.size()"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "listReader.size",
          "args": [],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "599-599",
          "snippet": "inline uint size() { return _builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline uint size() { return _builder.size() / ELEMENTS; }"
        }
      },
      {
        "call_info": {
          "callee": "reader.getRoot<TestAllTypes>",
          "args": [],
          "line": 218
        },
        "resolved": true,
        "details": {
          "function_name": "getRoot",
          "container": "RpcRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1322-1324",
          "snippet": "inline AnyPointer::Builder getRoot() {\n      return paramsBuilder;\n    }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nRpcRequest {\n  inline AnyPointer::Builder getRoot() {\n        return paramsBuilder;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "element"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "root.initStructList",
          "args": [
            "16"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ioContext.lowLevelProvider->wrapOutputFd",
          "args": [
            "fds[1]"
          ],
          "line": 207
        },
        "resolved": true,
        "details": {
          "function_name": "wrapOutputFd",
          "container": "LowLevelAsyncIoProviderImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/async-io.c++",
          "lines": "910-912",
          "snippet": "Own<AsyncOutputStream> wrapOutputFd(int fd, uint flags = 0) override {\n    return heap<AsyncStreamFd>(eventPort, fd, flags);\n  }",
          "includes": [
            "#include <limits.h>",
            "#include <poll.h>",
            "#include <set>",
            "#include <netdb.h>",
            "#include <arpa/inet.h>",
            "#include <stdlib.h>",
            "#include <stddef.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/in.h>",
            "#include <sys/un.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/uio.h>",
            "#include <unistd.h>",
            "#include \"io.h\"",
            "#include \"thread.h\"",
            "#include \"debug.h\"",
            "#include \"async-unix.h\"",
            "#include \"async-io.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <poll.h>\n#include <set>\n#include <netdb.h>\n#include <arpa/inet.h>\n#include <stdlib.h>\n#include <stddef.h>\n#include <netinet/tcp.h>\n#include <netinet/in.h>\n#include <sys/un.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/uio.h>\n#include <unistd.h>\n#include \"io.h\"\n#include \"thread.h\"\n#include \"debug.h\"\n#include \"async-unix.h\"\n#include \"async-io.h\"\n\nLowLevelAsyncIoProviderImpl {\n  Own<AsyncOutputStream> wrapOutputFd(int fd, uint flags = 0) override {\n      return heap<AsyncStreamFd>(eventPort, fd, flags);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::setupAsyncIo",
          "args": [],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "setupAsyncIo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/async-io.c++",
          "lines": "1379-1385",
          "snippet": "AsyncIoContext setupAsyncIo() {\n  auto lowLevel = heap<LowLevelAsyncIoProviderImpl>();\n  auto ioProvider = kj::heap<AsyncIoProviderImpl>(*lowLevel);\n  auto& waitScope = lowLevel->getWaitScope();\n  auto& eventPort = lowLevel->getEventPort();\n  return { kj::mv(lowLevel), kj::mv(ioProvider), waitScope, eventPort };\n}",
          "includes": [
            "#include <limits.h>",
            "#include <poll.h>",
            "#include <set>",
            "#include <netdb.h>",
            "#include <arpa/inet.h>",
            "#include <stdlib.h>",
            "#include <stddef.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/in.h>",
            "#include <sys/un.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/uio.h>",
            "#include <unistd.h>",
            "#include \"io.h\"",
            "#include \"thread.h\"",
            "#include \"debug.h\"",
            "#include \"async-unix.h\"",
            "#include \"async-io.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <poll.h>\n#include <set>\n#include <netdb.h>\n#include <arpa/inet.h>\n#include <stdlib.h>\n#include <stddef.h>\n#include <netinet/tcp.h>\n#include <netinet/in.h>\n#include <sys/un.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/uio.h>\n#include <unistd.h>\n#include \"io.h\"\n#include \"thread.h\"\n#include \"debug.h\"\n#include \"async-unix.h\"\n#include \"async-io.h\"\n\nAsyncIoContext setupAsyncIo() {\n  auto lowLevel = heap<LowLevelAsyncIoProviderImpl>();\n  auto ioProvider = kj::heap<AsyncIoProviderImpl>(*lowLevel);\n  auto& waitScope = lowLevel->getWaitScope();\n  auto& eventPort = lowLevel->getEventPort();\n  return { kj::mv(lowLevel), kj::mv(ioProvider), waitScope, eventPort };\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/compat/gtest.h>\n#include \"test-util.h\"\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <kj/thread.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n#include \"serialize-async.h\"\n\nTEST(SerializeAsyncTest, WriteAsyncOddSegmentCount) {\n  PipeWithSmallBuffer fds;\n  auto ioContext = kj::setupAsyncIo();\n  auto output = ioContext.lowLevelProvider->wrapOutputFd(fds[1]);\n\n  TestMessageBuilder message(7);\n  auto root = message.getRoot<TestAllTypes>();\n  auto list = root.initStructList(16);\n  for (auto element: list) {\n    initTestMessage(element);\n  }\n\n  kj::Thread thread([&]() {\n    StreamFdMessageReader reader(fds[0]);\n    auto listReader = reader.getRoot<TestAllTypes>().getStructList();\n    EXPECT_EQ(list.size(), listReader.size());\n    for (auto element: listReader) {\n      checkTestMessage(element);\n    }\n  });\n\n  writeMessage(*output, message).wait(ioContext.waitScope);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-async-test.c++",
    "lines": "180-202",
    "snippet": "TEST(SerializeAsyncTest, WriteAsync) {\n  PipeWithSmallBuffer fds;\n  auto ioContext = kj::setupAsyncIo();\n  auto output = ioContext.lowLevelProvider->wrapOutputFd(fds[1]);\n\n  TestMessageBuilder message(1);\n  auto root = message.getRoot<TestAllTypes>();\n  auto list = root.initStructList(16);\n  for (auto element: list) {\n    initTestMessage(element);\n  }\n\n  kj::Thread thread([&]() {\n    StreamFdMessageReader reader(fds[0]);\n    auto listReader = reader.getRoot<TestAllTypes>().getStructList();\n    EXPECT_EQ(list.size(), listReader.size());\n    for (auto element: listReader) {\n      checkTestMessage(element);\n    }\n  });\n\n  writeMessage(*output, message).wait(ioContext.waitScope);\n}",
    "includes": [
      "#include <kj/compat/gtest.h>",
      "#include \"test-util.h\"",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <kj/thread.h>",
      "#include <kj/debug.h>",
      "#include \"serialize.h\"",
      "#include \"serialize-async.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "writeMessage",
          "args": [
            "ioContext.waitScope"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "writeMessage",
          "args": [
            "*output",
            "message"
          ],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "writeMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-async.h",
          "lines": "58-60",
          "snippet": "inline kj::Promise<void> writeMessage(kj::AsyncOutputStream& output, MessageBuilder& builder) {\n  return writeMessage(output, builder.getSegmentsForOutput());\n}",
          "includes": [
            "#include \"message.h\"",
            "#include <kj/async-io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"message.h\"\n#include <kj/async-io.h>\n\ninline kj::Promise<void> writeMessage(kj::AsyncOutputStream& output, MessageBuilder& builder) {\n  return writeMessage(output, builder.getSegmentsForOutput());\n}"
        }
      },
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "element"
          ],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "EXPECT_EQ",
          "args": [
            "list.size()",
            "listReader.size()"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "listReader.size",
          "args": [],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "599-599",
          "snippet": "inline uint size() { return _builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline uint size() { return _builder.size() / ELEMENTS; }"
        }
      },
      {
        "call_info": {
          "callee": "reader.getRoot<TestAllTypes>",
          "args": [],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "getRoot",
          "container": "RpcRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1322-1324",
          "snippet": "inline AnyPointer::Builder getRoot() {\n      return paramsBuilder;\n    }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nRpcRequest {\n  inline AnyPointer::Builder getRoot() {\n        return paramsBuilder;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "element"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "root.initStructList",
          "args": [
            "16"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ioContext.lowLevelProvider->wrapOutputFd",
          "args": [
            "fds[1]"
          ],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "wrapOutputFd",
          "container": "LowLevelAsyncIoProviderImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/async-io.c++",
          "lines": "910-912",
          "snippet": "Own<AsyncOutputStream> wrapOutputFd(int fd, uint flags = 0) override {\n    return heap<AsyncStreamFd>(eventPort, fd, flags);\n  }",
          "includes": [
            "#include <limits.h>",
            "#include <poll.h>",
            "#include <set>",
            "#include <netdb.h>",
            "#include <arpa/inet.h>",
            "#include <stdlib.h>",
            "#include <stddef.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/in.h>",
            "#include <sys/un.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/uio.h>",
            "#include <unistd.h>",
            "#include \"io.h\"",
            "#include \"thread.h\"",
            "#include \"debug.h\"",
            "#include \"async-unix.h\"",
            "#include \"async-io.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <poll.h>\n#include <set>\n#include <netdb.h>\n#include <arpa/inet.h>\n#include <stdlib.h>\n#include <stddef.h>\n#include <netinet/tcp.h>\n#include <netinet/in.h>\n#include <sys/un.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/uio.h>\n#include <unistd.h>\n#include \"io.h\"\n#include \"thread.h\"\n#include \"debug.h\"\n#include \"async-unix.h\"\n#include \"async-io.h\"\n\nLowLevelAsyncIoProviderImpl {\n  Own<AsyncOutputStream> wrapOutputFd(int fd, uint flags = 0) override {\n      return heap<AsyncStreamFd>(eventPort, fd, flags);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::setupAsyncIo",
          "args": [],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "setupAsyncIo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/async-io.c++",
          "lines": "1379-1385",
          "snippet": "AsyncIoContext setupAsyncIo() {\n  auto lowLevel = heap<LowLevelAsyncIoProviderImpl>();\n  auto ioProvider = kj::heap<AsyncIoProviderImpl>(*lowLevel);\n  auto& waitScope = lowLevel->getWaitScope();\n  auto& eventPort = lowLevel->getEventPort();\n  return { kj::mv(lowLevel), kj::mv(ioProvider), waitScope, eventPort };\n}",
          "includes": [
            "#include <limits.h>",
            "#include <poll.h>",
            "#include <set>",
            "#include <netdb.h>",
            "#include <arpa/inet.h>",
            "#include <stdlib.h>",
            "#include <stddef.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/in.h>",
            "#include <sys/un.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/uio.h>",
            "#include <unistd.h>",
            "#include \"io.h\"",
            "#include \"thread.h\"",
            "#include \"debug.h\"",
            "#include \"async-unix.h\"",
            "#include \"async-io.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <poll.h>\n#include <set>\n#include <netdb.h>\n#include <arpa/inet.h>\n#include <stdlib.h>\n#include <stddef.h>\n#include <netinet/tcp.h>\n#include <netinet/in.h>\n#include <sys/un.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/uio.h>\n#include <unistd.h>\n#include \"io.h\"\n#include \"thread.h\"\n#include \"debug.h\"\n#include \"async-unix.h\"\n#include \"async-io.h\"\n\nAsyncIoContext setupAsyncIo() {\n  auto lowLevel = heap<LowLevelAsyncIoProviderImpl>();\n  auto ioProvider = kj::heap<AsyncIoProviderImpl>(*lowLevel);\n  auto& waitScope = lowLevel->getWaitScope();\n  auto& eventPort = lowLevel->getEventPort();\n  return { kj::mv(lowLevel), kj::mv(ioProvider), waitScope, eventPort };\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/compat/gtest.h>\n#include \"test-util.h\"\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <kj/thread.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n#include \"serialize-async.h\"\n\nTEST(SerializeAsyncTest, WriteAsync) {\n  PipeWithSmallBuffer fds;\n  auto ioContext = kj::setupAsyncIo();\n  auto output = ioContext.lowLevelProvider->wrapOutputFd(fds[1]);\n\n  TestMessageBuilder message(1);\n  auto root = message.getRoot<TestAllTypes>();\n  auto list = root.initStructList(16);\n  for (auto element: list) {\n    initTestMessage(element);\n  }\n\n  kj::Thread thread([&]() {\n    StreamFdMessageReader reader(fds[0]);\n    auto listReader = reader.getRoot<TestAllTypes>().getStructList();\n    EXPECT_EQ(list.size(), listReader.size());\n    for (auto element: listReader) {\n      checkTestMessage(element);\n    }\n  });\n\n  writeMessage(*output, message).wait(ioContext.waitScope);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-async-test.c++",
    "lines": "161-178",
    "snippet": "TEST(SerializeAsyncTest, ParseAsyncEvenSegmentCount) {\n  PipeWithSmallBuffer fds;\n  auto ioContext = kj::setupAsyncIo();\n  auto input = ioContext.lowLevelProvider->wrapInputFd(fds[0]);\n  kj::FdOutputStream rawOutput(fds[1]);\n  FragmentingOutputStream output(rawOutput);\n\n  TestMessageBuilder message(10);\n  initTestMessage(message.getRoot<TestAllTypes>());\n\n  kj::Thread thread([&]() {\n    writeMessage(output, message);\n  });\n\n  auto received = readMessage(*input).wait(ioContext.waitScope);\n\n  checkTestMessage(received->getRoot<TestAllTypes>());\n}",
    "includes": [
      "#include <kj/compat/gtest.h>",
      "#include \"test-util.h\"",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <kj/thread.h>",
      "#include <kj/debug.h>",
      "#include \"serialize.h\"",
      "#include \"serialize-async.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "received->getRoot<TestAllTypes>()"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "received->getRoot<TestAllTypes>",
          "args": [],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "getRoot",
          "container": "RpcRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1322-1324",
          "snippet": "inline AnyPointer::Builder getRoot() {\n      return paramsBuilder;\n    }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nRpcRequest {\n  inline AnyPointer::Builder getRoot() {\n        return paramsBuilder;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "readMessage",
          "args": [
            "ioContext.waitScope"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "readMessage",
          "args": [
            "*input"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "writeMessage",
          "args": [
            "output",
            "message"
          ],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "writeMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-async.h",
          "lines": "58-60",
          "snippet": "inline kj::Promise<void> writeMessage(kj::AsyncOutputStream& output, MessageBuilder& builder) {\n  return writeMessage(output, builder.getSegmentsForOutput());\n}",
          "includes": [
            "#include \"message.h\"",
            "#include <kj/async-io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"message.h\"\n#include <kj/async-io.h>\n\ninline kj::Promise<void> writeMessage(kj::AsyncOutputStream& output, MessageBuilder& builder) {\n  return writeMessage(output, builder.getSegmentsForOutput());\n}"
        }
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "message.getRoot<TestAllTypes>()"
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "ioContext.lowLevelProvider->wrapInputFd",
          "args": [
            "fds[0]"
          ],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "wrapInputFd",
          "container": "LowLevelAsyncIoProviderImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/async-io.c++",
          "lines": "907-909",
          "snippet": "Own<AsyncInputStream> wrapInputFd(int fd, uint flags = 0) override {\n    return heap<AsyncStreamFd>(eventPort, fd, flags);\n  }",
          "includes": [
            "#include <limits.h>",
            "#include <poll.h>",
            "#include <set>",
            "#include <netdb.h>",
            "#include <arpa/inet.h>",
            "#include <stdlib.h>",
            "#include <stddef.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/in.h>",
            "#include <sys/un.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/uio.h>",
            "#include <unistd.h>",
            "#include \"io.h\"",
            "#include \"thread.h\"",
            "#include \"debug.h\"",
            "#include \"async-unix.h\"",
            "#include \"async-io.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <poll.h>\n#include <set>\n#include <netdb.h>\n#include <arpa/inet.h>\n#include <stdlib.h>\n#include <stddef.h>\n#include <netinet/tcp.h>\n#include <netinet/in.h>\n#include <sys/un.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/uio.h>\n#include <unistd.h>\n#include \"io.h\"\n#include \"thread.h\"\n#include \"debug.h\"\n#include \"async-unix.h\"\n#include \"async-io.h\"\n\nLowLevelAsyncIoProviderImpl {\n  Own<AsyncInputStream> wrapInputFd(int fd, uint flags = 0) override {\n      return heap<AsyncStreamFd>(eventPort, fd, flags);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::setupAsyncIo",
          "args": [],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "setupAsyncIo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/async-io.c++",
          "lines": "1379-1385",
          "snippet": "AsyncIoContext setupAsyncIo() {\n  auto lowLevel = heap<LowLevelAsyncIoProviderImpl>();\n  auto ioProvider = kj::heap<AsyncIoProviderImpl>(*lowLevel);\n  auto& waitScope = lowLevel->getWaitScope();\n  auto& eventPort = lowLevel->getEventPort();\n  return { kj::mv(lowLevel), kj::mv(ioProvider), waitScope, eventPort };\n}",
          "includes": [
            "#include <limits.h>",
            "#include <poll.h>",
            "#include <set>",
            "#include <netdb.h>",
            "#include <arpa/inet.h>",
            "#include <stdlib.h>",
            "#include <stddef.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/in.h>",
            "#include <sys/un.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/uio.h>",
            "#include <unistd.h>",
            "#include \"io.h\"",
            "#include \"thread.h\"",
            "#include \"debug.h\"",
            "#include \"async-unix.h\"",
            "#include \"async-io.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <poll.h>\n#include <set>\n#include <netdb.h>\n#include <arpa/inet.h>\n#include <stdlib.h>\n#include <stddef.h>\n#include <netinet/tcp.h>\n#include <netinet/in.h>\n#include <sys/un.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/uio.h>\n#include <unistd.h>\n#include \"io.h\"\n#include \"thread.h\"\n#include \"debug.h\"\n#include \"async-unix.h\"\n#include \"async-io.h\"\n\nAsyncIoContext setupAsyncIo() {\n  auto lowLevel = heap<LowLevelAsyncIoProviderImpl>();\n  auto ioProvider = kj::heap<AsyncIoProviderImpl>(*lowLevel);\n  auto& waitScope = lowLevel->getWaitScope();\n  auto& eventPort = lowLevel->getEventPort();\n  return { kj::mv(lowLevel), kj::mv(ioProvider), waitScope, eventPort };\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/compat/gtest.h>\n#include \"test-util.h\"\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <kj/thread.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n#include \"serialize-async.h\"\n\nTEST(SerializeAsyncTest, ParseAsyncEvenSegmentCount) {\n  PipeWithSmallBuffer fds;\n  auto ioContext = kj::setupAsyncIo();\n  auto input = ioContext.lowLevelProvider->wrapInputFd(fds[0]);\n  kj::FdOutputStream rawOutput(fds[1]);\n  FragmentingOutputStream output(rawOutput);\n\n  TestMessageBuilder message(10);\n  initTestMessage(message.getRoot<TestAllTypes>());\n\n  kj::Thread thread([&]() {\n    writeMessage(output, message);\n  });\n\n  auto received = readMessage(*input).wait(ioContext.waitScope);\n\n  checkTestMessage(received->getRoot<TestAllTypes>());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-async-test.c++",
    "lines": "142-159",
    "snippet": "TEST(SerializeAsyncTest, ParseAsyncOddSegmentCount) {\n  PipeWithSmallBuffer fds;\n  auto ioContext = kj::setupAsyncIo();\n  auto input = ioContext.lowLevelProvider->wrapInputFd(fds[0]);\n  kj::FdOutputStream rawOutput(fds[1]);\n  FragmentingOutputStream output(rawOutput);\n\n  TestMessageBuilder message(7);\n  initTestMessage(message.getRoot<TestAllTypes>());\n\n  kj::Thread thread([&]() {\n    writeMessage(output, message);\n  });\n\n  auto received = readMessage(*input).wait(ioContext.waitScope);\n\n  checkTestMessage(received->getRoot<TestAllTypes>());\n}",
    "includes": [
      "#include <kj/compat/gtest.h>",
      "#include \"test-util.h\"",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <kj/thread.h>",
      "#include <kj/debug.h>",
      "#include \"serialize.h\"",
      "#include \"serialize-async.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "received->getRoot<TestAllTypes>()"
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "received->getRoot<TestAllTypes>",
          "args": [],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "getRoot",
          "container": "RpcRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1322-1324",
          "snippet": "inline AnyPointer::Builder getRoot() {\n      return paramsBuilder;\n    }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nRpcRequest {\n  inline AnyPointer::Builder getRoot() {\n        return paramsBuilder;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "readMessage",
          "args": [
            "ioContext.waitScope"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "readMessage",
          "args": [
            "*input"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "writeMessage",
          "args": [
            "output",
            "message"
          ],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "writeMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-async.h",
          "lines": "58-60",
          "snippet": "inline kj::Promise<void> writeMessage(kj::AsyncOutputStream& output, MessageBuilder& builder) {\n  return writeMessage(output, builder.getSegmentsForOutput());\n}",
          "includes": [
            "#include \"message.h\"",
            "#include <kj/async-io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"message.h\"\n#include <kj/async-io.h>\n\ninline kj::Promise<void> writeMessage(kj::AsyncOutputStream& output, MessageBuilder& builder) {\n  return writeMessage(output, builder.getSegmentsForOutput());\n}"
        }
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "message.getRoot<TestAllTypes>()"
          ],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "ioContext.lowLevelProvider->wrapInputFd",
          "args": [
            "fds[0]"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "wrapInputFd",
          "container": "LowLevelAsyncIoProviderImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/async-io.c++",
          "lines": "907-909",
          "snippet": "Own<AsyncInputStream> wrapInputFd(int fd, uint flags = 0) override {\n    return heap<AsyncStreamFd>(eventPort, fd, flags);\n  }",
          "includes": [
            "#include <limits.h>",
            "#include <poll.h>",
            "#include <set>",
            "#include <netdb.h>",
            "#include <arpa/inet.h>",
            "#include <stdlib.h>",
            "#include <stddef.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/in.h>",
            "#include <sys/un.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/uio.h>",
            "#include <unistd.h>",
            "#include \"io.h\"",
            "#include \"thread.h\"",
            "#include \"debug.h\"",
            "#include \"async-unix.h\"",
            "#include \"async-io.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <poll.h>\n#include <set>\n#include <netdb.h>\n#include <arpa/inet.h>\n#include <stdlib.h>\n#include <stddef.h>\n#include <netinet/tcp.h>\n#include <netinet/in.h>\n#include <sys/un.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/uio.h>\n#include <unistd.h>\n#include \"io.h\"\n#include \"thread.h\"\n#include \"debug.h\"\n#include \"async-unix.h\"\n#include \"async-io.h\"\n\nLowLevelAsyncIoProviderImpl {\n  Own<AsyncInputStream> wrapInputFd(int fd, uint flags = 0) override {\n      return heap<AsyncStreamFd>(eventPort, fd, flags);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::setupAsyncIo",
          "args": [],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "setupAsyncIo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/async-io.c++",
          "lines": "1379-1385",
          "snippet": "AsyncIoContext setupAsyncIo() {\n  auto lowLevel = heap<LowLevelAsyncIoProviderImpl>();\n  auto ioProvider = kj::heap<AsyncIoProviderImpl>(*lowLevel);\n  auto& waitScope = lowLevel->getWaitScope();\n  auto& eventPort = lowLevel->getEventPort();\n  return { kj::mv(lowLevel), kj::mv(ioProvider), waitScope, eventPort };\n}",
          "includes": [
            "#include <limits.h>",
            "#include <poll.h>",
            "#include <set>",
            "#include <netdb.h>",
            "#include <arpa/inet.h>",
            "#include <stdlib.h>",
            "#include <stddef.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/in.h>",
            "#include <sys/un.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/uio.h>",
            "#include <unistd.h>",
            "#include \"io.h\"",
            "#include \"thread.h\"",
            "#include \"debug.h\"",
            "#include \"async-unix.h\"",
            "#include \"async-io.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <poll.h>\n#include <set>\n#include <netdb.h>\n#include <arpa/inet.h>\n#include <stdlib.h>\n#include <stddef.h>\n#include <netinet/tcp.h>\n#include <netinet/in.h>\n#include <sys/un.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/uio.h>\n#include <unistd.h>\n#include \"io.h\"\n#include \"thread.h\"\n#include \"debug.h\"\n#include \"async-unix.h\"\n#include \"async-io.h\"\n\nAsyncIoContext setupAsyncIo() {\n  auto lowLevel = heap<LowLevelAsyncIoProviderImpl>();\n  auto ioProvider = kj::heap<AsyncIoProviderImpl>(*lowLevel);\n  auto& waitScope = lowLevel->getWaitScope();\n  auto& eventPort = lowLevel->getEventPort();\n  return { kj::mv(lowLevel), kj::mv(ioProvider), waitScope, eventPort };\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/compat/gtest.h>\n#include \"test-util.h\"\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <kj/thread.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n#include \"serialize-async.h\"\n\nTEST(SerializeAsyncTest, ParseAsyncOddSegmentCount) {\n  PipeWithSmallBuffer fds;\n  auto ioContext = kj::setupAsyncIo();\n  auto input = ioContext.lowLevelProvider->wrapInputFd(fds[0]);\n  kj::FdOutputStream rawOutput(fds[1]);\n  FragmentingOutputStream output(rawOutput);\n\n  TestMessageBuilder message(7);\n  initTestMessage(message.getRoot<TestAllTypes>());\n\n  kj::Thread thread([&]() {\n    writeMessage(output, message);\n  });\n\n  auto received = readMessage(*input).wait(ioContext.waitScope);\n\n  checkTestMessage(received->getRoot<TestAllTypes>());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-async-test.c++",
    "lines": "123-140",
    "snippet": "TEST(SerializeAsyncTest, ParseAsync) {\n  PipeWithSmallBuffer fds;\n  auto ioContext = kj::setupAsyncIo();\n  auto input = ioContext.lowLevelProvider->wrapInputFd(fds[0]);\n  kj::FdOutputStream rawOutput(fds[1]);\n  FragmentingOutputStream output(rawOutput);\n\n  TestMessageBuilder message(1);\n  initTestMessage(message.getRoot<TestAllTypes>());\n\n  kj::Thread thread([&]() {\n    writeMessage(output, message);\n  });\n\n  auto received = readMessage(*input).wait(ioContext.waitScope);\n\n  checkTestMessage(received->getRoot<TestAllTypes>());\n}",
    "includes": [
      "#include <kj/compat/gtest.h>",
      "#include \"test-util.h\"",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <kj/thread.h>",
      "#include <kj/debug.h>",
      "#include \"serialize.h\"",
      "#include \"serialize-async.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkTestMessage",
          "args": [
            "received->getRoot<TestAllTypes>()"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "checkTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "844-844",
          "snippet": "void checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid checkTestMessage(TestListDefaults::Reader reader) { genericCheckListDefaults(reader); }"
        }
      },
      {
        "call_info": {
          "callee": "received->getRoot<TestAllTypes>",
          "args": [],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "getRoot",
          "container": "RpcRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1322-1324",
          "snippet": "inline AnyPointer::Builder getRoot() {\n      return paramsBuilder;\n    }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nRpcRequest {\n  inline AnyPointer::Builder getRoot() {\n        return paramsBuilder;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "readMessage",
          "args": [
            "ioContext.waitScope"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "readMessage",
          "args": [
            "*input"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "writeMessage",
          "args": [
            "output",
            "message"
          ],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "writeMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-async.h",
          "lines": "58-60",
          "snippet": "inline kj::Promise<void> writeMessage(kj::AsyncOutputStream& output, MessageBuilder& builder) {\n  return writeMessage(output, builder.getSegmentsForOutput());\n}",
          "includes": [
            "#include \"message.h\"",
            "#include <kj/async-io.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"message.h\"\n#include <kj/async-io.h>\n\ninline kj::Promise<void> writeMessage(kj::AsyncOutputStream& output, MessageBuilder& builder) {\n  return writeMessage(output, builder.getSegmentsForOutput());\n}"
        }
      },
      {
        "call_info": {
          "callee": "initTestMessage",
          "args": [
            "message.getRoot<TestAllTypes>()"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "initTestMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/test-util.c++",
          "lines": "836-836",
          "snippet": "void initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }",
          "includes": [
            "#include <kj/compat/gtest.h>",
            "#include <kj/debug.h>",
            "#include \"test-util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/compat/gtest.h>\n#include <kj/debug.h>\n#include \"test-util.h\"\n\nvoid initTestMessage(TestListDefaults::Builder builder) { genericInitListDefaults(builder); }"
        }
      },
      {
        "call_info": {
          "callee": "ioContext.lowLevelProvider->wrapInputFd",
          "args": [
            "fds[0]"
          ],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "wrapInputFd",
          "container": "LowLevelAsyncIoProviderImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/async-io.c++",
          "lines": "907-909",
          "snippet": "Own<AsyncInputStream> wrapInputFd(int fd, uint flags = 0) override {\n    return heap<AsyncStreamFd>(eventPort, fd, flags);\n  }",
          "includes": [
            "#include <limits.h>",
            "#include <poll.h>",
            "#include <set>",
            "#include <netdb.h>",
            "#include <arpa/inet.h>",
            "#include <stdlib.h>",
            "#include <stddef.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/in.h>",
            "#include <sys/un.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/uio.h>",
            "#include <unistd.h>",
            "#include \"io.h\"",
            "#include \"thread.h\"",
            "#include \"debug.h\"",
            "#include \"async-unix.h\"",
            "#include \"async-io.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <poll.h>\n#include <set>\n#include <netdb.h>\n#include <arpa/inet.h>\n#include <stdlib.h>\n#include <stddef.h>\n#include <netinet/tcp.h>\n#include <netinet/in.h>\n#include <sys/un.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/uio.h>\n#include <unistd.h>\n#include \"io.h\"\n#include \"thread.h\"\n#include \"debug.h\"\n#include \"async-unix.h\"\n#include \"async-io.h\"\n\nLowLevelAsyncIoProviderImpl {\n  Own<AsyncInputStream> wrapInputFd(int fd, uint flags = 0) override {\n      return heap<AsyncStreamFd>(eventPort, fd, flags);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::setupAsyncIo",
          "args": [],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "setupAsyncIo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/async-io.c++",
          "lines": "1379-1385",
          "snippet": "AsyncIoContext setupAsyncIo() {\n  auto lowLevel = heap<LowLevelAsyncIoProviderImpl>();\n  auto ioProvider = kj::heap<AsyncIoProviderImpl>(*lowLevel);\n  auto& waitScope = lowLevel->getWaitScope();\n  auto& eventPort = lowLevel->getEventPort();\n  return { kj::mv(lowLevel), kj::mv(ioProvider), waitScope, eventPort };\n}",
          "includes": [
            "#include <limits.h>",
            "#include <poll.h>",
            "#include <set>",
            "#include <netdb.h>",
            "#include <arpa/inet.h>",
            "#include <stdlib.h>",
            "#include <stddef.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/in.h>",
            "#include <sys/un.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <sys/uio.h>",
            "#include <unistd.h>",
            "#include \"io.h\"",
            "#include \"thread.h\"",
            "#include \"debug.h\"",
            "#include \"async-unix.h\"",
            "#include \"async-io.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include <poll.h>\n#include <set>\n#include <netdb.h>\n#include <arpa/inet.h>\n#include <stdlib.h>\n#include <stddef.h>\n#include <netinet/tcp.h>\n#include <netinet/in.h>\n#include <sys/un.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <sys/uio.h>\n#include <unistd.h>\n#include \"io.h\"\n#include \"thread.h\"\n#include \"debug.h\"\n#include \"async-unix.h\"\n#include \"async-io.h\"\n\nAsyncIoContext setupAsyncIo() {\n  auto lowLevel = heap<LowLevelAsyncIoProviderImpl>();\n  auto ioProvider = kj::heap<AsyncIoProviderImpl>(*lowLevel);\n  auto& waitScope = lowLevel->getWaitScope();\n  auto& eventPort = lowLevel->getEventPort();\n  return { kj::mv(lowLevel), kj::mv(ioProvider), waitScope, eventPort };\n}"
        }
      }
    ],
    "contextual_snippet": "#include <kj/compat/gtest.h>\n#include \"test-util.h\"\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <kj/thread.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n#include \"serialize-async.h\"\n\nTEST(SerializeAsyncTest, ParseAsync) {\n  PipeWithSmallBuffer fds;\n  auto ioContext = kj::setupAsyncIo();\n  auto input = ioContext.lowLevelProvider->wrapInputFd(fds[0]);\n  kj::FdOutputStream rawOutput(fds[1]);\n  FragmentingOutputStream output(rawOutput);\n\n  TestMessageBuilder message(1);\n  initTestMessage(message.getRoot<TestAllTypes>());\n\n  kj::Thread thread([&]() {\n    writeMessage(output, message);\n  });\n\n  auto received = readMessage(*input).wait(ioContext.waitScope);\n\n  checkTestMessage(received->getRoot<TestAllTypes>());\n}"
  },
  {
    "function_name": "PipeWithSmallBuffer",
    "container": "PipeWithSmallBuffer",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-async-test.c++",
    "lines": "89-111",
    "snippet": "PipeWithSmallBuffer() {\n    // Use a socketpair rather than a pipe so that we can set the buffer size extremely small.\n    KJ_SYSCALL(socketpair(AF_UNIX, SOCK_STREAM, 0, fds));\n\n    KJ_SYSCALL(shutdown(fds[0], SHUT_WR));\n    // Note:  OSX reports ENOTCONN if we also try to shutdown(fds[1], SHUT_RD).\n\n    // Request that the buffer size be as small as possible, to force the event loop to kick in.\n    // FUN STUFF:\n    // - On Linux, the kernel rounds up to the smallest size it permits, so we can ask for a size of\n    //   zero.\n    // - On OSX, the kernel reports EINVAL on zero, but will dutifully use a 1-byte buffer if we\n    //   set the size to 1.  This tends to cause stack overflows due to ridiculously long promise\n    //   chains.\n    // - Cygwin will apparently actually use a buffer size of 0 and therefore block forever waiting\n    //   for buffer space.\n    //\n    // Anyway, we now use 127 to avoid these issues (but also to screw around with non-word-boundary\n    // writes).\n    uint small = 127;\n    KJ_SYSCALL(setsockopt(fds[0], SOL_SOCKET, SO_RCVBUF, &small, sizeof(small)));\n    KJ_SYSCALL(setsockopt(fds[1], SOL_SOCKET, SO_SNDBUF, &small, sizeof(small)));\n  }",
    "includes": [
      "#include <kj/compat/gtest.h>",
      "#include \"test-util.h\"",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <kj/thread.h>",
      "#include <kj/debug.h>",
      "#include \"serialize.h\"",
      "#include \"serialize-async.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "KJ_SYSCALL",
          "args": [
            "setsockopt(fds[1], SOL_SOCKET, SO_SNDBUF, &small, sizeof(small))"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setsockopt",
          "args": [
            "fds[1]",
            "SOL_SOCKET",
            "SO_SNDBUF",
            "&small",
            "sizeof(small)"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_SYSCALL",
          "args": [
            "setsockopt(fds[0], SOL_SOCKET, SO_RCVBUF, &small, sizeof(small))"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setsockopt",
          "args": [
            "fds[0]",
            "SOL_SOCKET",
            "SO_RCVBUF",
            "&small",
            "sizeof(small)"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_SYSCALL",
          "args": [
            "shutdown(fds[0], SHUT_WR)"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shutdown",
          "args": [
            "fds[0]",
            "SHUT_WR"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_SYSCALL",
          "args": [
            "socketpair(AF_UNIX, SOCK_STREAM, 0, fds)"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "socketpair",
          "args": [
            "AF_UNIX",
            "SOCK_STREAM",
            "0",
            "fds"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/compat/gtest.h>\n#include \"test-util.h\"\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <kj/thread.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n#include \"serialize-async.h\"\n\nPipeWithSmallBuffer {\n  PipeWithSmallBuffer() {\n      // Use a socketpair rather than a pipe so that we can set the buffer size extremely small.\n      KJ_SYSCALL(socketpair(AF_UNIX, SOCK_STREAM, 0, fds));\n  \n      KJ_SYSCALL(shutdown(fds[0], SHUT_WR));\n      // Note:  OSX reports ENOTCONN if we also try to shutdown(fds[1], SHUT_RD).\n  \n      // Request that the buffer size be as small as possible, to force the event loop to kick in.\n      // FUN STUFF:\n      // - On Linux, the kernel rounds up to the smallest size it permits, so we can ask for a size of\n      //   zero.\n      // - On OSX, the kernel reports EINVAL on zero, but will dutifully use a 1-byte buffer if we\n      //   set the size to 1.  This tends to cause stack overflows due to ridiculously long promise\n      //   chains.\n      // - Cygwin will apparently actually use a buffer size of 0 and therefore block forever waiting\n      //   for buffer space.\n      //\n      // Anyway, we now use 127 to avoid these issues (but also to screw around with non-word-boundary\n      // writes).\n      uint small = 127;\n      KJ_SYSCALL(setsockopt(fds[0], SOL_SOCKET, SO_RCVBUF, &small, sizeof(small)));\n      KJ_SYSCALL(setsockopt(fds[1], SOL_SOCKET, SO_SNDBUF, &small, sizeof(small)));\n    }\n}"
  },
  {
    "function_name": "allocateSegment",
    "container": "TestMessageBuilder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-async-test.c++",
    "lines": "69-81",
    "snippet": "kj::ArrayPtr<word> allocateSegment(uint minimumSize) override {\n    if (desiredSegmentCount <= 1) {\n      if (desiredSegmentCount < 1) {\n        ADD_FAILURE() << \"Allocated more segments than desired.\";\n      } else {\n        --desiredSegmentCount;\n      }\n      return MallocMessageBuilder::allocateSegment(8192);\n    } else {\n      --desiredSegmentCount;\n      return MallocMessageBuilder::allocateSegment(minimumSize);\n    }\n  }",
    "includes": [
      "#include <kj/compat/gtest.h>",
      "#include \"test-util.h\"",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <kj/thread.h>",
      "#include <kj/debug.h>",
      "#include \"serialize.h\"",
      "#include \"serialize-async.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ADD_FAILURE",
          "args": [],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/compat/gtest.h>\n#include \"test-util.h\"\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <kj/thread.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n#include \"serialize-async.h\"\n\nTestMessageBuilder {\n  kj::ArrayPtr<word> allocateSegment(uint minimumSize) override {\n      if (desiredSegmentCount <= 1) {\n        if (desiredSegmentCount < 1) {\n          ADD_FAILURE() << \"Allocated more segments than desired.\";\n        } else {\n          --desiredSegmentCount;\n        }\n        return MallocMessageBuilder::allocateSegment(8192);\n      } else {\n        --desiredSegmentCount;\n        return MallocMessageBuilder::allocateSegment(minimumSize);\n      }\n    }\n}"
  },
  {
    "function_name": "TestMessageBuilder",
    "container": "TestMessageBuilder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-async-test.c++",
    "lines": "62-64",
    "snippet": "explicit TestMessageBuilder(uint desiredSegmentCount)\n      : MallocMessageBuilder(0, AllocationStrategy::FIXED_SIZE),\n        desiredSegmentCount(desiredSegmentCount) {}",
    "includes": [
      "#include <kj/compat/gtest.h>",
      "#include \"test-util.h\"",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <kj/thread.h>",
      "#include <kj/debug.h>",
      "#include \"serialize.h\"",
      "#include \"serialize-async.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <kj/compat/gtest.h>\n#include \"test-util.h\"\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <kj/thread.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n#include \"serialize-async.h\"\n\nTestMessageBuilder {\n  explicit TestMessageBuilder(uint desiredSegmentCount)\n        : MallocMessageBuilder(0, AllocationStrategy::FIXED_SIZE),\n          desiredSegmentCount(desiredSegmentCount) {}\n}"
  },
  {
    "function_name": "write",
    "container": "FragmentingOutputStream",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-async-test.c++",
    "lines": "42-50",
    "snippet": "void write(const void* buffer, size_t size) override {\n    while (size > 0) {\n      usleep(5000);\n      size_t n = rand() % size + 1;\n      inner.write(buffer, n);\n      buffer = reinterpret_cast<const byte*>(buffer) + n;\n      size -= n;\n    }\n  }",
    "includes": [
      "#include <kj/compat/gtest.h>",
      "#include \"test-util.h\"",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <kj/thread.h>",
      "#include <kj/debug.h>",
      "#include \"serialize.h\"",
      "#include \"serialize-async.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reinterpret_cast<const byte*>",
          "args": [
            "buffer"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rand",
          "args": [],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "Annotation::Builder::disownBrand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/schema.capnp.h",
          "lines": "7365-7368",
          "snippet": "inline ::capnp::Orphan< ::capnp::schema::Brand> Annotation::Builder::disownBrand() {\n  return ::capnp::_::PointerHelpers< ::capnp::schema::Brand>::disown(\n      _builder.getPointerField(1 * ::capnp::POINTERS));\n}",
          "includes": [
            "#include <capnp/generated-header-support.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/generated-header-support.h>\n\ninline ::capnp::Orphan< ::capnp::schema::Brand> Annotation::Builder::disownBrand() {\n  return ::capnp::_::PointerHelpers< ::capnp::schema::Brand>::disown(\n      _builder.getPointerField(1 * ::capnp::POINTERS));\n}"
        }
      },
      {
        "call_info": {
          "callee": "usleep",
          "args": [
            "5000"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <kj/compat/gtest.h>\n#include \"test-util.h\"\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <kj/thread.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n#include \"serialize-async.h\"\n\nFragmentingOutputStream {\n  void write(const void* buffer, size_t size) override {\n      while (size > 0) {\n        usleep(5000);\n        size_t n = rand() % size + 1;\n        inner.write(buffer, n);\n        buffer = reinterpret_cast<const byte*>(buffer) + n;\n        size -= n;\n      }\n    }\n}"
  },
  {
    "function_name": "FragmentingOutputStream",
    "container": "FragmentingOutputStream",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/serialize-async-test.c++",
    "lines": "40-40",
    "snippet": "FragmentingOutputStream(kj::OutputStream& inner): inner(inner) {}",
    "includes": [
      "#include <kj/compat/gtest.h>",
      "#include \"test-util.h\"",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <stdlib.h>",
      "#include <kj/thread.h>",
      "#include <kj/debug.h>",
      "#include \"serialize.h\"",
      "#include \"serialize-async.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <kj/compat/gtest.h>\n#include \"test-util.h\"\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <kj/thread.h>\n#include <kj/debug.h>\n#include \"serialize.h\"\n#include \"serialize-async.h\"\n\nFragmentingOutputStream {\n  FragmentingOutputStream(kj::OutputStream& inner): inner(inner) {}\n}"
  }
]