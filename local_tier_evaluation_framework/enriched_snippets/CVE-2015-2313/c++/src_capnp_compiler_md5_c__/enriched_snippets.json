[
  {
    "function_name": "Md5::finishAsHex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/md5.c++",
    "lines": "307-321",
    "snippet": "kj::StringPtr Md5::finishAsHex() {\n  static const char hexDigits[] = \"0123456789abcdef\";\n\n  kj::ArrayPtr<const kj::byte> bytes = finish();\n\n  char* chars = reinterpret_cast<char*>(ctx.buffer + 16);\n  char* pos = chars;\n  for (auto byte: bytes) {\n    *pos++ = hexDigits[byte / 16];\n    *pos++ = hexDigits[byte % 16];\n  }\n  *pos++ = '\\0';\n\n  return kj::StringPtr(chars, 32);\n}",
    "includes": [
      "#include <string.h>",
      "#include <kj/debug.h>",
      "#include \"md5.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::StringPtr",
          "args": [
            "chars",
            "32"
          ],
          "line": 320
        },
        "resolved": true,
        "details": {
          "function_name": "StringPtr",
          "container": "StringPtr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/string.h",
          "lines": "61-61",
          "snippet": "inline StringPtr(const char* begin, const char* end): StringPtr(begin, end - begin) {}",
          "includes": [
            "#include <string.h>",
            "#include \"array.h\"",
            "#include <initializer_list>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"array.h\"\n#include <initializer_list>\n\nStringPtr {\n  inline StringPtr(const char* begin, const char* end): StringPtr(begin, end - begin) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<char*>",
          "args": [
            "ctx.buffer + 16"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "finish",
          "args": [],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "Md5::finish",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/md5.c++",
          "lines": "251-305",
          "snippet": "kj::ArrayPtr<const kj::byte> Md5::finish()\n{\n  if (!finished) {\n    unsigned long used, free;\n\n    used = ctx.lo & 0x3f;\n\n    ctx.buffer[used++] = 0x80;\n\n    free = 64 - used;\n\n    if (free < 8) {\n      memset(&ctx.buffer[used], 0, free);\n      body(ctx.buffer, 64);\n      used = 0;\n      free = 64;\n    }\n\n    memset(&ctx.buffer[used], 0, free - 8);\n\n    ctx.lo <<= 3;\n    ctx.buffer[56] = ctx.lo;\n    ctx.buffer[57] = ctx.lo >> 8;\n    ctx.buffer[58] = ctx.lo >> 16;\n    ctx.buffer[59] = ctx.lo >> 24;\n    ctx.buffer[60] = ctx.hi;\n    ctx.buffer[61] = ctx.hi >> 8;\n    ctx.buffer[62] = ctx.hi >> 16;\n    ctx.buffer[63] = ctx.hi >> 24;\n\n    body(ctx.buffer, 64);\n\n    // Store final result into ctx.buffer.\n    ctx.buffer[0] = ctx.a;\n    ctx.buffer[1] = ctx.a >> 8;\n    ctx.buffer[2] = ctx.a >> 16;\n    ctx.buffer[3] = ctx.a >> 24;\n    ctx.buffer[4] = ctx.b;\n    ctx.buffer[5] = ctx.b >> 8;\n    ctx.buffer[6] = ctx.b >> 16;\n    ctx.buffer[7] = ctx.b >> 24;\n    ctx.buffer[8] = ctx.c;\n    ctx.buffer[9] = ctx.c >> 8;\n    ctx.buffer[10] = ctx.c >> 16;\n    ctx.buffer[11] = ctx.c >> 24;\n    ctx.buffer[12] = ctx.d;\n    ctx.buffer[13] = ctx.d >> 8;\n    ctx.buffer[14] = ctx.d >> 16;\n    ctx.buffer[15] = ctx.d >> 24;\n\n    finished = true;\n  }\n\n  return kj::arrayPtr(ctx.buffer, 16);\n}",
          "includes": [
            "#include <string.h>",
            "#include <kj/debug.h>",
            "#include \"md5.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <kj/debug.h>\n#include \"md5.h\"\n\nkj::ArrayPtr<const kj::byte> Md5::finish()\n{\n  if (!finished) {\n    unsigned long used, free;\n\n    used = ctx.lo & 0x3f;\n\n    ctx.buffer[used++] = 0x80;\n\n    free = 64 - used;\n\n    if (free < 8) {\n      memset(&ctx.buffer[used], 0, free);\n      body(ctx.buffer, 64);\n      used = 0;\n      free = 64;\n    }\n\n    memset(&ctx.buffer[used], 0, free - 8);\n\n    ctx.lo <<= 3;\n    ctx.buffer[56] = ctx.lo;\n    ctx.buffer[57] = ctx.lo >> 8;\n    ctx.buffer[58] = ctx.lo >> 16;\n    ctx.buffer[59] = ctx.lo >> 24;\n    ctx.buffer[60] = ctx.hi;\n    ctx.buffer[61] = ctx.hi >> 8;\n    ctx.buffer[62] = ctx.hi >> 16;\n    ctx.buffer[63] = ctx.hi >> 24;\n\n    body(ctx.buffer, 64);\n\n    // Store final result into ctx.buffer.\n    ctx.buffer[0] = ctx.a;\n    ctx.buffer[1] = ctx.a >> 8;\n    ctx.buffer[2] = ctx.a >> 16;\n    ctx.buffer[3] = ctx.a >> 24;\n    ctx.buffer[4] = ctx.b;\n    ctx.buffer[5] = ctx.b >> 8;\n    ctx.buffer[6] = ctx.b >> 16;\n    ctx.buffer[7] = ctx.b >> 24;\n    ctx.buffer[8] = ctx.c;\n    ctx.buffer[9] = ctx.c >> 8;\n    ctx.buffer[10] = ctx.c >> 16;\n    ctx.buffer[11] = ctx.c >> 24;\n    ctx.buffer[12] = ctx.d;\n    ctx.buffer[13] = ctx.d >> 8;\n    ctx.buffer[14] = ctx.d >> 16;\n    ctx.buffer[15] = ctx.d >> 24;\n\n    finished = true;\n  }\n\n  return kj::arrayPtr(ctx.buffer, 16);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <kj/debug.h>\n#include \"md5.h\"\n\nkj::StringPtr Md5::finishAsHex() {\n  static const char hexDigits[] = \"0123456789abcdef\";\n\n  kj::ArrayPtr<const kj::byte> bytes = finish();\n\n  char* chars = reinterpret_cast<char*>(ctx.buffer + 16);\n  char* pos = chars;\n  for (auto byte: bytes) {\n    *pos++ = hexDigits[byte / 16];\n    *pos++ = hexDigits[byte % 16];\n  }\n  *pos++ = '\\0';\n\n  return kj::StringPtr(chars, 32);\n}"
  },
  {
    "function_name": "Md5::finish",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/md5.c++",
    "lines": "251-305",
    "snippet": "kj::ArrayPtr<const kj::byte> Md5::finish()\n{\n  if (!finished) {\n    unsigned long used, free;\n\n    used = ctx.lo & 0x3f;\n\n    ctx.buffer[used++] = 0x80;\n\n    free = 64 - used;\n\n    if (free < 8) {\n      memset(&ctx.buffer[used], 0, free);\n      body(ctx.buffer, 64);\n      used = 0;\n      free = 64;\n    }\n\n    memset(&ctx.buffer[used], 0, free - 8);\n\n    ctx.lo <<= 3;\n    ctx.buffer[56] = ctx.lo;\n    ctx.buffer[57] = ctx.lo >> 8;\n    ctx.buffer[58] = ctx.lo >> 16;\n    ctx.buffer[59] = ctx.lo >> 24;\n    ctx.buffer[60] = ctx.hi;\n    ctx.buffer[61] = ctx.hi >> 8;\n    ctx.buffer[62] = ctx.hi >> 16;\n    ctx.buffer[63] = ctx.hi >> 24;\n\n    body(ctx.buffer, 64);\n\n    // Store final result into ctx.buffer.\n    ctx.buffer[0] = ctx.a;\n    ctx.buffer[1] = ctx.a >> 8;\n    ctx.buffer[2] = ctx.a >> 16;\n    ctx.buffer[3] = ctx.a >> 24;\n    ctx.buffer[4] = ctx.b;\n    ctx.buffer[5] = ctx.b >> 8;\n    ctx.buffer[6] = ctx.b >> 16;\n    ctx.buffer[7] = ctx.b >> 24;\n    ctx.buffer[8] = ctx.c;\n    ctx.buffer[9] = ctx.c >> 8;\n    ctx.buffer[10] = ctx.c >> 16;\n    ctx.buffer[11] = ctx.c >> 24;\n    ctx.buffer[12] = ctx.d;\n    ctx.buffer[13] = ctx.d >> 8;\n    ctx.buffer[14] = ctx.d >> 16;\n    ctx.buffer[15] = ctx.d >> 24;\n\n    finished = true;\n  }\n\n  return kj::arrayPtr(ctx.buffer, 16);\n}",
    "includes": [
      "#include <string.h>",
      "#include <kj/debug.h>",
      "#include \"md5.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::arrayPtr",
          "args": [
            "ctx.buffer",
            "16"
          ],
          "line": 304
        },
        "resolved": true,
        "details": {
          "function_name": "arrayPtr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/common.h",
          "lines": "1194-1197",
          "snippet": "inline constexpr ArrayPtr<T> arrayPtr(T* begin, T* end) {\n  // Use this function to construct ArrayPtrs without writing out the type name.\n  return ArrayPtr<T>(begin, end);\n}",
          "includes": [
            "#include <initializer_list>",
            "#include <stddef.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <initializer_list>\n#include <stddef.h>\n\ninline constexpr ArrayPtr<T> arrayPtr(T* begin, T* end) {\n  // Use this function to construct ArrayPtrs without writing out the type name.\n  return ArrayPtr<T>(begin, end);\n}"
        }
      },
      {
        "call_info": {
          "callee": "body",
          "args": [
            "ctx.buffer",
            "64"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&ctx.buffer[used]",
            "0",
            "free - 8"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "body",
          "args": [
            "ctx.buffer",
            "64"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&ctx.buffer[used]",
            "0",
            "free"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <kj/debug.h>\n#include \"md5.h\"\n\nkj::ArrayPtr<const kj::byte> Md5::finish()\n{\n  if (!finished) {\n    unsigned long used, free;\n\n    used = ctx.lo & 0x3f;\n\n    ctx.buffer[used++] = 0x80;\n\n    free = 64 - used;\n\n    if (free < 8) {\n      memset(&ctx.buffer[used], 0, free);\n      body(ctx.buffer, 64);\n      used = 0;\n      free = 64;\n    }\n\n    memset(&ctx.buffer[used], 0, free - 8);\n\n    ctx.lo <<= 3;\n    ctx.buffer[56] = ctx.lo;\n    ctx.buffer[57] = ctx.lo >> 8;\n    ctx.buffer[58] = ctx.lo >> 16;\n    ctx.buffer[59] = ctx.lo >> 24;\n    ctx.buffer[60] = ctx.hi;\n    ctx.buffer[61] = ctx.hi >> 8;\n    ctx.buffer[62] = ctx.hi >> 16;\n    ctx.buffer[63] = ctx.hi >> 24;\n\n    body(ctx.buffer, 64);\n\n    // Store final result into ctx.buffer.\n    ctx.buffer[0] = ctx.a;\n    ctx.buffer[1] = ctx.a >> 8;\n    ctx.buffer[2] = ctx.a >> 16;\n    ctx.buffer[3] = ctx.a >> 24;\n    ctx.buffer[4] = ctx.b;\n    ctx.buffer[5] = ctx.b >> 8;\n    ctx.buffer[6] = ctx.b >> 16;\n    ctx.buffer[7] = ctx.b >> 24;\n    ctx.buffer[8] = ctx.c;\n    ctx.buffer[9] = ctx.c >> 8;\n    ctx.buffer[10] = ctx.c >> 16;\n    ctx.buffer[11] = ctx.c >> 24;\n    ctx.buffer[12] = ctx.d;\n    ctx.buffer[13] = ctx.d >> 8;\n    ctx.buffer[14] = ctx.d >> 16;\n    ctx.buffer[15] = ctx.d >> 24;\n\n    finished = true;\n  }\n\n  return kj::arrayPtr(ctx.buffer, 16);\n}"
  },
  {
    "function_name": "Md5::update",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/md5.c++",
    "lines": "212-249",
    "snippet": "void Md5::update(kj::ArrayPtr<const kj::byte> dataArray)\n{\n  KJ_REQUIRE(!finished, \"already called Md5::finish()\");\n\n  const kj::byte* data = dataArray.begin();\n  unsigned long size = dataArray.size();\n\n  MD5_u32plus saved_lo;\n  unsigned long used, free;\n\n  saved_lo = ctx.lo;\n  if ((ctx.lo = (saved_lo + size) & 0x1fffffff) < saved_lo)\n    ctx.hi++;\n  ctx.hi += size >> 29;\n\n  used = saved_lo & 0x3f;\n\n  if (used) {\n    free = 64 - used;\n\n    if (size < free) {\n      memcpy(&ctx.buffer[used], data, size);\n      return;\n    }\n\n    memcpy(&ctx.buffer[used], data, free);\n    data = data + free;\n    size -= free;\n    body(ctx.buffer, 64);\n  }\n\n  if (size >= 64) {\n    data = body(data, size & ~(unsigned long)0x3f);\n    size &= 0x3f;\n  }\n\n  memcpy(ctx.buffer, data, size);\n}",
    "includes": [
      "#include <string.h>",
      "#include <kj/debug.h>",
      "#include \"md5.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ctx.buffer",
            "data",
            "size"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "body",
          "args": [
            "data",
            "size & ~(unsigned long)0x3f"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "body",
          "args": [
            "ctx.buffer",
            "64"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&ctx.buffer[used]",
            "data",
            "free"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&ctx.buffer[used]",
            "data",
            "size"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dataArray.size",
          "args": [],
          "line": 217
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-capnp.c++",
          "lines": "74-74",
          "snippet": "inline size_t size() const { return amount; }",
          "includes": [
            "#include \"config.h\"",
            "#include <map>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <map>\n#include <algorithm>\n#include <kj/main.h>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nIndent {\n  inline size_t size() const { return amount; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dataArray.begin",
          "args": [],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "Indent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/capnpc-capnp.c++",
          "lines": "76-76",
          "snippet": "inline Iterator begin() const { return Iterator(0); }",
          "includes": [
            "#include \"config.h\"",
            "#include <map>",
            "#include <algorithm>",
            "#include <kj/main.h>",
            "#include <unordered_map>",
            "#include <unistd.h>",
            "#include \"../dynamic.h\"",
            "#include \"../schema-loader.h\"",
            "#include <kj/vector.h>",
            "#include <kj/string-tree.h>",
            "#include <kj/io.h>",
            "#include <kj/debug.h>",
            "#include \"../serialize.h\"",
            "#include <capnp/schema.capnp.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <map>\n#include <algorithm>\n#include <kj/main.h>\n#include <unordered_map>\n#include <unistd.h>\n#include \"../dynamic.h\"\n#include \"../schema-loader.h\"\n#include <kj/vector.h>\n#include <kj/string-tree.h>\n#include <kj/io.h>\n#include <kj/debug.h>\n#include \"../serialize.h\"\n#include <capnp/schema.capnp.h>\n\nIndent {\n  inline Iterator begin() const { return Iterator(0); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "KJ_REQUIRE",
          "args": [
            "!finished",
            "\"already called Md5::finish()\""
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <kj/debug.h>\n#include \"md5.h\"\n\nvoid Md5::update(kj::ArrayPtr<const kj::byte> dataArray)\n{\n  KJ_REQUIRE(!finished, \"already called Md5::finish()\");\n\n  const kj::byte* data = dataArray.begin();\n  unsigned long size = dataArray.size();\n\n  MD5_u32plus saved_lo;\n  unsigned long used, free;\n\n  saved_lo = ctx.lo;\n  if ((ctx.lo = (saved_lo + size) & 0x1fffffff) < saved_lo)\n    ctx.hi++;\n  ctx.hi += size >> 29;\n\n  used = saved_lo & 0x3f;\n\n  if (used) {\n    free = 64 - used;\n\n    if (size < free) {\n      memcpy(&ctx.buffer[used], data, size);\n      return;\n    }\n\n    memcpy(&ctx.buffer[used], data, free);\n    data = data + free;\n    size -= free;\n    body(ctx.buffer, 64);\n  }\n\n  if (size >= 64) {\n    data = body(data, size & ~(unsigned long)0x3f);\n    size &= 0x3f;\n  }\n\n  memcpy(ctx.buffer, data, size);\n}"
  },
  {
    "function_name": "Md5::Md5",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/compiler/md5.c++",
    "lines": "201-210",
    "snippet": "Md5::Md5()\n{\n  ctx.a = 0x67452301;\n  ctx.b = 0xefcdab89;\n  ctx.c = 0x98badcfe;\n  ctx.d = 0x10325476;\n\n  ctx.lo = 0;\n  ctx.hi = 0;\n}",
    "includes": [
      "#include <string.h>",
      "#include <kj/debug.h>",
      "#include \"md5.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <string.h>\n#include <kj/debug.h>\n#include \"md5.h\"\n\nMd5::Md5()\n{\n  ctx.a = 0x67452301;\n  ctx.b = 0xefcdab89;\n  ctx.c = 0x98badcfe;\n  ctx.d = 0x10325476;\n\n  ctx.lo = 0;\n  ctx.hi = 0;\n}"
  }
]