[
  {
    "function_name": "ParseFloat::operator()",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/parse/char.c++",
    "lines": "31-65",
    "snippet": "double ParseFloat::operator()(const Array<char>& digits,\n                              const Maybe<Array<char>>& fraction,\n                              const Maybe<Tuple<Maybe<char>, Array<char>>>& exponent) const {\n  size_t bufSize = digits.size();\n  KJ_IF_MAYBE(f, fraction) {\n    bufSize += 1 + f->size();\n  }\n  KJ_IF_MAYBE(e, exponent) {\n    bufSize += 1 + (get<0>(*e) != nullptr) + get<1>(*e).size();\n  }\n\n  KJ_STACK_ARRAY(char, buf, bufSize + 1, 128, 128);\n\n  char* pos = buf.begin();\n  memcpy(pos, digits.begin(), digits.size());\n  pos += digits.size();\n  KJ_IF_MAYBE(f, fraction) {\n    *pos++ = '.';\n    memcpy(pos, f->begin(), f->size());\n    pos += f->size();\n  }\n  KJ_IF_MAYBE(e, exponent) {\n    *pos++ = 'e';\n    KJ_IF_MAYBE(sign, get<0>(*e)) {\n      *pos++ = *sign;\n    }\n    memcpy(pos, get<1>(*e).begin(), get<1>(*e).size());\n    pos += get<1>(*e).size();\n  }\n\n  *pos++ = '\\0';\n  KJ_DASSERT(pos == buf.end());\n\n  return strtod(buf.begin(), nullptr);\n}",
    "includes": [
      "#include <stdlib.h>",
      "#include \"../debug.h\"",
      "#include \"char.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strtod",
          "args": [
            "buf.begin()",
            "nullptr"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "buf.begin",
          "args": [],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "550-550",
          "snippet": "inline Iterator begin() { return Iterator(this, 0); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Iterator begin() { return Iterator(this, 0); }"
        }
      },
      {
        "call_info": {
          "callee": "KJ_DASSERT",
          "args": [
            "pos == buf.end()"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "buf.end",
          "args": [],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "551-551",
          "snippet": "inline Iterator end() { return Iterator(this, size()); }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline Iterator end() { return Iterator(this, size()); }"
        }
      },
      {
        "call_info": {
          "callee": "get<1>",
          "args": [],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "getPosition",
          "container": "IteratorInput",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/kj/parse/common.h",
          "lines": "91-91",
          "snippet": "Iterator getPosition() { return pos; }",
          "includes": [
            "#include \"../vector.h\"",
            "#include \"../tuple.h\"",
            "#include \"../array.h\"",
            "#include \"../memory.h\"",
            "#include \"../common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../vector.h\"\n#include \"../tuple.h\"\n#include \"../array.h\"\n#include \"../memory.h\"\n#include \"../common.h\"\n\nIteratorInput {\n  Iterator getPosition() { return pos; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "get<1>",
          "args": [
            "*e"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "DynamicStruct::Pipeline::get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "926-928",
          "snippet": "DynamicValue::Pipeline DynamicStruct::Pipeline::get(kj::StringPtr name) {\n  return get(schema.getFieldByName(name));\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nDynamicValue::Pipeline DynamicStruct::Pipeline::get(kj::StringPtr name) {\n  return get(schema.getFieldByName(name));\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "pos",
            "get<1>(*e).begin()",
            "get<1>(*e).size()"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "f->size",
          "args": [],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/any.h",
          "lines": "599-599",
          "snippet": "inline uint size() { return _builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"list.h\"",
            "#include \"orphan.h\"",
            "#include \"pointer-helpers.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"list.h\"\n#include \"orphan.h\"\n#include \"pointer-helpers.h\"\n#include \"layout.h\"\n\ninline uint size() { return _builder.size() / ELEMENTS; }"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "pos",
            "f->begin()",
            "f->size()"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "pos",
            "digits.begin()",
            "digits.size()"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include \"../debug.h\"\n#include \"char.h\"\n\ndouble ParseFloat::operator()(const Array<char>& digits,\n                              const Maybe<Array<char>>& fraction,\n                              const Maybe<Tuple<Maybe<char>, Array<char>>>& exponent) const {\n  size_t bufSize = digits.size();\n  KJ_IF_MAYBE(f, fraction) {\n    bufSize += 1 + f->size();\n  }\n  KJ_IF_MAYBE(e, exponent) {\n    bufSize += 1 + (get<0>(*e) != nullptr) + get<1>(*e).size();\n  }\n\n  KJ_STACK_ARRAY(char, buf, bufSize + 1, 128, 128);\n\n  char* pos = buf.begin();\n  memcpy(pos, digits.begin(), digits.size());\n  pos += digits.size();\n  KJ_IF_MAYBE(f, fraction) {\n    *pos++ = '.';\n    memcpy(pos, f->begin(), f->size());\n    pos += f->size();\n  }\n  KJ_IF_MAYBE(e, exponent) {\n    *pos++ = 'e';\n    KJ_IF_MAYBE(sign, get<0>(*e)) {\n      *pos++ = *sign;\n    }\n    memcpy(pos, get<1>(*e).begin(), get<1>(*e).size());\n    pos += get<1>(*e).size();\n  }\n\n  *pos++ = '\\0';\n  KJ_DASSERT(pos == buf.end());\n\n  return strtod(buf.begin(), nullptr);\n}"
  }
]