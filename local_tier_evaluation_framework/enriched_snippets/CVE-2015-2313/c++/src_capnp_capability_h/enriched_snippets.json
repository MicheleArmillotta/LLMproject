[
  {
    "function_name": "Capability::Server::internalGetTypedContext",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "687-690",
    "snippet": "CallContext<Params, Results> Capability::Server::internalGetTypedContext(\n    CallContext<AnyPointer, AnyPointer> typeless) {\n  return CallContext<Params, Results>(*typeless.hook);\n}",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CallContext<Params, Results>",
          "args": [
            "*typeless.hook"
          ],
          "line": 689
        },
        "resolved": true,
        "details": {
          "function_name": "CallContext<Params, Results>::CallContext",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
          "lines": "641-641",
          "snippet": "inline CallContext<Params, Results>::CallContext(CallContextHook& hook): hook(&hook) {}",
          "includes": [
            "#include \"pointer-helpers.h\"",
            "#include \"any.h\"",
            "#include <kj/async.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\ninline CallContext<Params, Results>::CallContext(CallContextHook& hook): hook(&hook) {}"
        }
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\nCallContext<Params, Results> Capability::Server::internalGetTypedContext(\n    CallContext<AnyPointer, AnyPointer> typeless) {\n  return CallContext<Params, Results>(*typeless.hook);\n}"
  },
  {
    "function_name": "CallContext<Params, Results>::allowCancellation",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "682-684",
    "snippet": "inline void CallContext<Params, Results>::allowCancellation() {\n  hook->allowCancellation();\n}",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hook->allowCancellation",
          "args": [],
          "line": 683
        },
        "resolved": true,
        "details": {
          "function_name": "allowCancellation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.c++",
          "lines": "185-187",
          "snippet": "void allowCancellation() override {\n    cancelAllowedFulfiller->fulfill();\n  }",
          "includes": [
            "#include \"generated-header-support.h\"",
            "#include <map>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <kj/refcount.h>",
            "#include \"arena.h\"",
            "#include \"message.h\"",
            "#include \"capability.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "kj::Own<kj::PromiseFulfiller<void>> cancelAllowedFulfiller;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"generated-header-support.h\"\n#include <map>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <kj/refcount.h>\n#include \"arena.h\"\n#include \"message.h\"\n#include \"capability.h\"\n\nkj::Own<kj::PromiseFulfiller<void>> cancelAllowedFulfiller;\n\nvoid allowCancellation() override {\n    cancelAllowedFulfiller->fulfill();\n  }"
        }
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\ninline void CallContext<Params, Results>::allowCancellation() {\n  hook->allowCancellation();\n}"
  },
  {
    "function_name": "CallContext<Params, Results>::tailCall",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "677-680",
    "snippet": "inline kj::Promise<void> CallContext<Params, Results>::tailCall(\n    Request<SubParams, Results>&& tailRequest) {\n  return hook->tailCall(kj::mv(tailRequest.hook));\n}",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hook->tailCall",
          "args": [
            "kj::mv(tailRequest.hook)"
          ],
          "line": 679
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "tailRequest.hook"
          ],
          "line": 679
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\ninline kj::Promise<void> CallContext<Params, Results>::tailCall(\n    Request<SubParams, Results>&& tailRequest) {\n  return hook->tailCall(kj::mv(tailRequest.hook));\n}"
  },
  {
    "function_name": "CallContext<Params, Results>::getResultsOrphanage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "671-674",
    "snippet": "inline Orphanage CallContext<Params, Results>::getResultsOrphanage(\n    kj::Maybe<MessageSize> sizeHint) {\n  return Orphanage::getForMessageContaining(hook->getResults(sizeHint));\n}",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Orphanage::getForMessageContaining",
          "args": [
            "hook->getResults(sizeHint)"
          ],
          "line": 673
        },
        "resolved": true,
        "details": {
          "function_name": "Orphanage::getForMessageContaining",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/orphan.h",
          "lines": "279-281",
          "snippet": "Orphanage Orphanage::getForMessageContaining(BuilderType builder) {\n  return Orphanage(GetInnerBuilder<FromBuilder<BuilderType>>::apply(builder).getArena());\n}",
          "includes": [
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"layout.h\"\n\nOrphanage Orphanage::getForMessageContaining(BuilderType builder) {\n  return Orphanage(GetInnerBuilder<FromBuilder<BuilderType>>::apply(builder).getArena());\n}"
        }
      },
      {
        "call_info": {
          "callee": "hook->getResults",
          "args": [
            "sizeHint"
          ],
          "line": 673
        },
        "resolved": true,
        "details": {
          "function_name": "getResults",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.c++",
          "lines": "154-161",
          "snippet": "AnyPointer::Builder getResults(kj::Maybe<MessageSize> sizeHint) override {\n    if (response == nullptr) {\n      auto localResponse = kj::refcounted<LocalResponse>(sizeHint);\n      responseBuilder = localResponse->message.getRoot<AnyPointer>();\n      response = Response<AnyPointer>(responseBuilder.asReader(), kj::mv(localResponse));\n    }\n    return responseBuilder;\n  }",
          "includes": [
            "#include \"generated-header-support.h\"",
            "#include <map>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <kj/refcount.h>",
            "#include \"arena.h\"",
            "#include \"message.h\"",
            "#include \"capability.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "kj::Maybe<Response<AnyPointer>> response;",
            "AnyPointer::Builder responseBuilder = nullptr;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"generated-header-support.h\"\n#include <map>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <kj/refcount.h>\n#include \"arena.h\"\n#include \"message.h\"\n#include \"capability.h\"\n\nkj::Maybe<Response<AnyPointer>> response;\nAnyPointer::Builder responseBuilder = nullptr;\n\nAnyPointer::Builder getResults(kj::Maybe<MessageSize> sizeHint) override {\n    if (response == nullptr) {\n      auto localResponse = kj::refcounted<LocalResponse>(sizeHint);\n      responseBuilder = localResponse->message.getRoot<AnyPointer>();\n      response = Response<AnyPointer>(responseBuilder.asReader(), kj::mv(localResponse));\n    }\n    return responseBuilder;\n  }"
        }
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\ninline Orphanage CallContext<Params, Results>::getResultsOrphanage(\n    kj::Maybe<MessageSize> sizeHint) {\n  return Orphanage::getForMessageContaining(hook->getResults(sizeHint));\n}"
  },
  {
    "function_name": "CallContext<Params, Results>::adoptResults",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "667-669",
    "snippet": "inline void CallContext<Params, Results>::adoptResults(Orphan<Results>&& value) {\n  hook->getResults(nullptr).adopt(kj::mv(value));\n}",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hook->getResults",
          "args": [
            "kj::mv(value)"
          ],
          "line": 668
        },
        "resolved": true,
        "details": {
          "function_name": "getResults",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.c++",
          "lines": "154-161",
          "snippet": "AnyPointer::Builder getResults(kj::Maybe<MessageSize> sizeHint) override {\n    if (response == nullptr) {\n      auto localResponse = kj::refcounted<LocalResponse>(sizeHint);\n      responseBuilder = localResponse->message.getRoot<AnyPointer>();\n      response = Response<AnyPointer>(responseBuilder.asReader(), kj::mv(localResponse));\n    }\n    return responseBuilder;\n  }",
          "includes": [
            "#include \"generated-header-support.h\"",
            "#include <map>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <kj/refcount.h>",
            "#include \"arena.h\"",
            "#include \"message.h\"",
            "#include \"capability.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "kj::Maybe<Response<AnyPointer>> response;",
            "AnyPointer::Builder responseBuilder = nullptr;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"generated-header-support.h\"\n#include <map>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <kj/refcount.h>\n#include \"arena.h\"\n#include \"message.h\"\n#include \"capability.h\"\n\nkj::Maybe<Response<AnyPointer>> response;\nAnyPointer::Builder responseBuilder = nullptr;\n\nAnyPointer::Builder getResults(kj::Maybe<MessageSize> sizeHint) override {\n    if (response == nullptr) {\n      auto localResponse = kj::refcounted<LocalResponse>(sizeHint);\n      responseBuilder = localResponse->message.getRoot<AnyPointer>();\n      response = Response<AnyPointer>(responseBuilder.asReader(), kj::mv(localResponse));\n    }\n    return responseBuilder;\n  }"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "value"
          ],
          "line": 668
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\ninline void CallContext<Params, Results>::adoptResults(Orphan<Results>&& value) {\n  hook->getResults(nullptr).adopt(kj::mv(value));\n}"
  },
  {
    "function_name": "CallContext<Params, Results>::setResults",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "663-665",
    "snippet": "inline void CallContext<Params, Results>::setResults(typename Results::Reader value) {\n  hook->getResults(value.totalSize()).template setAs<Results>(value);\n}",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hook->getResults",
          "args": [
            "value"
          ],
          "line": 664
        },
        "resolved": true,
        "details": {
          "function_name": "getResults",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.c++",
          "lines": "154-161",
          "snippet": "AnyPointer::Builder getResults(kj::Maybe<MessageSize> sizeHint) override {\n    if (response == nullptr) {\n      auto localResponse = kj::refcounted<LocalResponse>(sizeHint);\n      responseBuilder = localResponse->message.getRoot<AnyPointer>();\n      response = Response<AnyPointer>(responseBuilder.asReader(), kj::mv(localResponse));\n    }\n    return responseBuilder;\n  }",
          "includes": [
            "#include \"generated-header-support.h\"",
            "#include <map>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <kj/refcount.h>",
            "#include \"arena.h\"",
            "#include \"message.h\"",
            "#include \"capability.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "kj::Maybe<Response<AnyPointer>> response;",
            "AnyPointer::Builder responseBuilder = nullptr;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"generated-header-support.h\"\n#include <map>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <kj/refcount.h>\n#include \"arena.h\"\n#include \"message.h\"\n#include \"capability.h\"\n\nkj::Maybe<Response<AnyPointer>> response;\nAnyPointer::Builder responseBuilder = nullptr;\n\nAnyPointer::Builder getResults(kj::Maybe<MessageSize> sizeHint) override {\n    if (response == nullptr) {\n      auto localResponse = kj::refcounted<LocalResponse>(sizeHint);\n      responseBuilder = localResponse->message.getRoot<AnyPointer>();\n      response = Response<AnyPointer>(responseBuilder.asReader(), kj::mv(localResponse));\n    }\n    return responseBuilder;\n  }"
        }
      },
      {
        "call_info": {
          "callee": "value.totalSize",
          "args": [],
          "line": 664
        },
        "resolved": true,
        "details": {
          "function_name": "totalSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc-twoparty.capnp.h",
          "lines": "558-558",
          "snippet": "inline ::capnp::MessageSize totalSize() const { return asReader().totalSize(); }",
          "includes": [
            "#include <capnp/generated-header-support.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/generated-header-support.h>\n\ninline ::capnp::MessageSize totalSize() const { return asReader().totalSize(); }"
        }
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\ninline void CallContext<Params, Results>::setResults(typename Results::Reader value) {\n  hook->getResults(value.totalSize()).template setAs<Results>(value);\n}"
  },
  {
    "function_name": "CallContext<Params, Results>::initResults",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "657-661",
    "snippet": "inline typename Results::Builder CallContext<Params, Results>::initResults(\n    kj::Maybe<MessageSize> sizeHint) {\n  // `template` keyword needed due to: http://llvm.org/bugs/show_bug.cgi?id=17401\n  return hook->getResults(sizeHint).template initAs<Results>();\n}",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hook->getResults",
          "args": [],
          "line": 660
        },
        "resolved": true,
        "details": {
          "function_name": "getResults",
          "container": "LocallyRedirectedRpcResponse",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1644-1646",
          "snippet": "AnyPointer::Reader getResults() override {\n      return message.getRoot<AnyPointer>();\n    }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nLocallyRedirectedRpcResponse {\n  AnyPointer::Reader getResults() override {\n        return message.getRoot<AnyPointer>();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "hook->getResults",
          "args": [
            "sizeHint"
          ],
          "line": 660
        },
        "resolved": true,
        "details": {
          "function_name": "getResults",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.c++",
          "lines": "154-161",
          "snippet": "AnyPointer::Builder getResults(kj::Maybe<MessageSize> sizeHint) override {\n    if (response == nullptr) {\n      auto localResponse = kj::refcounted<LocalResponse>(sizeHint);\n      responseBuilder = localResponse->message.getRoot<AnyPointer>();\n      response = Response<AnyPointer>(responseBuilder.asReader(), kj::mv(localResponse));\n    }\n    return responseBuilder;\n  }",
          "includes": [
            "#include \"generated-header-support.h\"",
            "#include <map>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <kj/refcount.h>",
            "#include \"arena.h\"",
            "#include \"message.h\"",
            "#include \"capability.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "kj::Maybe<Response<AnyPointer>> response;",
            "AnyPointer::Builder responseBuilder = nullptr;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"generated-header-support.h\"\n#include <map>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <kj/refcount.h>\n#include \"arena.h\"\n#include \"message.h\"\n#include \"capability.h\"\n\nkj::Maybe<Response<AnyPointer>> response;\nAnyPointer::Builder responseBuilder = nullptr;\n\nAnyPointer::Builder getResults(kj::Maybe<MessageSize> sizeHint) override {\n    if (response == nullptr) {\n      auto localResponse = kj::refcounted<LocalResponse>(sizeHint);\n      responseBuilder = localResponse->message.getRoot<AnyPointer>();\n      response = Response<AnyPointer>(responseBuilder.asReader(), kj::mv(localResponse));\n    }\n    return responseBuilder;\n  }"
        }
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\ninline typename Results::Builder CallContext<Params, Results>::initResults(\n    kj::Maybe<MessageSize> sizeHint) {\n  // `template` keyword needed due to: http://llvm.org/bugs/show_bug.cgi?id=17401\n  return hook->getResults(sizeHint).template initAs<Results>();\n}"
  },
  {
    "function_name": "CallContext<Params, Results>::getResults",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "651-655",
    "snippet": "inline typename Results::Builder CallContext<Params, Results>::getResults(\n    kj::Maybe<MessageSize> sizeHint) {\n  // `template` keyword needed due to: http://llvm.org/bugs/show_bug.cgi?id=17401\n  return hook->getResults(sizeHint).template getAs<Results>();\n}",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hook->getResults",
          "args": [],
          "line": 654
        },
        "resolved": true,
        "details": {
          "function_name": "getResults",
          "container": "LocallyRedirectedRpcResponse",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/rpc.c++",
          "lines": "1644-1646",
          "snippet": "AnyPointer::Reader getResults() override {\n      return message.getRoot<AnyPointer>();\n    }",
          "includes": [
            "#include <capnp/rpc.capnp.h>",
            "#include <queue>",
            "#include <map>",
            "#include <unordered_map>",
            "#include <kj/function.h>",
            "#include <kj/one-of.h>",
            "#include <kj/async.h>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include \"message.h\"",
            "#include \"rpc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <capnp/rpc.capnp.h>\n#include <queue>\n#include <map>\n#include <unordered_map>\n#include <kj/function.h>\n#include <kj/one-of.h>\n#include <kj/async.h>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include \"message.h\"\n#include \"rpc.h\"\n\nLocallyRedirectedRpcResponse {\n  AnyPointer::Reader getResults() override {\n        return message.getRoot<AnyPointer>();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "hook->getResults",
          "args": [
            "sizeHint"
          ],
          "line": 654
        },
        "resolved": true,
        "details": {
          "function_name": "getResults",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.c++",
          "lines": "154-161",
          "snippet": "AnyPointer::Builder getResults(kj::Maybe<MessageSize> sizeHint) override {\n    if (response == nullptr) {\n      auto localResponse = kj::refcounted<LocalResponse>(sizeHint);\n      responseBuilder = localResponse->message.getRoot<AnyPointer>();\n      response = Response<AnyPointer>(responseBuilder.asReader(), kj::mv(localResponse));\n    }\n    return responseBuilder;\n  }",
          "includes": [
            "#include \"generated-header-support.h\"",
            "#include <map>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <kj/refcount.h>",
            "#include \"arena.h\"",
            "#include \"message.h\"",
            "#include \"capability.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "kj::Maybe<Response<AnyPointer>> response;",
            "AnyPointer::Builder responseBuilder = nullptr;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"generated-header-support.h\"\n#include <map>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <kj/refcount.h>\n#include \"arena.h\"\n#include \"message.h\"\n#include \"capability.h\"\n\nkj::Maybe<Response<AnyPointer>> response;\nAnyPointer::Builder responseBuilder = nullptr;\n\nAnyPointer::Builder getResults(kj::Maybe<MessageSize> sizeHint) override {\n    if (response == nullptr) {\n      auto localResponse = kj::refcounted<LocalResponse>(sizeHint);\n      responseBuilder = localResponse->message.getRoot<AnyPointer>();\n      response = Response<AnyPointer>(responseBuilder.asReader(), kj::mv(localResponse));\n    }\n    return responseBuilder;\n  }"
        }
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\ninline typename Results::Builder CallContext<Params, Results>::getResults(\n    kj::Maybe<MessageSize> sizeHint) {\n  // `template` keyword needed due to: http://llvm.org/bugs/show_bug.cgi?id=17401\n  return hook->getResults(sizeHint).template getAs<Results>();\n}"
  },
  {
    "function_name": "CallContext<Params, Results>::releaseParams",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "647-649",
    "snippet": "inline void CallContext<Params, Results>::releaseParams() {\n  hook->releaseParams();\n}",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hook->releaseParams",
          "args": [],
          "line": 648
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\ninline void CallContext<Params, Results>::releaseParams() {\n  hook->releaseParams();\n}"
  },
  {
    "function_name": "CallContext<Params, Results>::getParams",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "643-645",
    "snippet": "inline typename Params::Reader CallContext<Params, Results>::getParams() {\n  return hook->getParams().template getAs<Params>();\n}",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hook->getParams",
          "args": [],
          "line": 644
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hook->getParams",
          "args": [],
          "line": 644
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\ninline typename Params::Reader CallContext<Params, Results>::getParams() {\n  return hook->getParams().template getAs<Params>();\n}"
  },
  {
    "function_name": "CallContext<Params, Results>::CallContext",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "641-641",
    "snippet": "inline CallContext<Params, Results>::CallContext(CallContextHook& hook): hook(&hook) {}",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\ninline CallContext<Params, Results>::CallContext(CallContextHook& hook): hook(&hook) {}"
  },
  {
    "function_name": "Capability::Client::newCall",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "634-638",
    "snippet": "inline Request<Params, Results> Capability::Client::newCall(\n    uint64_t interfaceId, uint16_t methodId, kj::Maybe<MessageSize> sizeHint) {\n  auto typeless = hook->newCall(interfaceId, methodId, sizeHint);\n  return Request<Params, Results>(typeless.template getAs<Params>(), kj::mv(typeless.hook));\n}",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Request<Params, Results>",
          "args": [
            "typeless.template getAs<Params>()",
            "kj::mv(typeless.hook)"
          ],
          "line": 637
        },
        "resolved": true,
        "details": {
          "function_name": "Request",
          "container": "Request",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
          "lines": "108-109",
          "snippet": "inline Request(typename Params::Builder builder, kj::Own<RequestHook>&& hook)\n      : Params::Builder(builder), hook(kj::mv(hook)) {}",
          "includes": [
            "#include \"pointer-helpers.h\"",
            "#include \"any.h\"",
            "#include <kj/async.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\nRequest {\n  inline Request(typename Params::Builder builder, kj::Own<RequestHook>&& hook)\n        : Params::Builder(builder), hook(kj::mv(hook)) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "typeless.hook"
          ],
          "line": 637
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typeless.template getAs<Params>",
          "args": [],
          "line": 637
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hook->newCall",
          "args": [
            "interfaceId",
            "methodId",
            "sizeHint"
          ],
          "line": 636
        },
        "resolved": true,
        "details": {
          "function_name": "newCall",
          "container": "BrokenClient",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.c++",
          "lines": "580-583",
          "snippet": "Request<AnyPointer, AnyPointer> newCall(\n      uint64_t interfaceId, uint16_t methodId, kj::Maybe<MessageSize> sizeHint) override {\n    return newBrokenRequest(kj::cp(exception), sizeHint);\n  }",
          "includes": [
            "#include \"generated-header-support.h\"",
            "#include <map>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <kj/refcount.h>",
            "#include \"arena.h\"",
            "#include \"message.h\"",
            "#include \"capability.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"generated-header-support.h\"\n#include <map>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <kj/refcount.h>\n#include \"arena.h\"\n#include \"message.h\"\n#include \"capability.h\"\n\nBrokenClient {\n  Request<AnyPointer, AnyPointer> newCall(\n        uint64_t interfaceId, uint16_t methodId, kj::Maybe<MessageSize> sizeHint) override {\n      return newBrokenRequest(kj::cp(exception), sizeHint);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\ninline Request<Params, Results> Capability::Client::newCall(\n    uint64_t interfaceId, uint16_t methodId, kj::Maybe<MessageSize> sizeHint) {\n  auto typeless = hook->newCall(interfaceId, methodId, sizeHint);\n  return Request<Params, Results>(typeless.template getAs<Params>(), kj::mv(typeless.hook));\n}"
  },
  {
    "function_name": "Capability::Client::typelessRequest",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "628-632",
    "snippet": "inline Request<AnyPointer, AnyPointer> Capability::Client::typelessRequest(\n    uint64_t interfaceId, uint16_t methodId,\n    kj::Maybe<MessageSize> sizeHint) {\n  return newCall<AnyPointer, AnyPointer>(interfaceId, methodId, sizeHint);\n}",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "newCall<AnyPointer, AnyPointer>",
          "args": [
            "interfaceId",
            "methodId",
            "sizeHint"
          ],
          "line": 631
        },
        "resolved": true,
        "details": {
          "function_name": "Capability::Client::newCall",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
          "lines": "634-638",
          "snippet": "inline Request<Params, Results> Capability::Client::newCall(\n    uint64_t interfaceId, uint16_t methodId, kj::Maybe<MessageSize> sizeHint) {\n  auto typeless = hook->newCall(interfaceId, methodId, sizeHint);\n  return Request<Params, Results>(typeless.template getAs<Params>(), kj::mv(typeless.hook));\n}",
          "includes": [
            "#include \"pointer-helpers.h\"",
            "#include \"any.h\"",
            "#include <kj/async.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\ninline Request<Params, Results> Capability::Client::newCall(\n    uint64_t interfaceId, uint16_t methodId, kj::Maybe<MessageSize> sizeHint) {\n  auto typeless = hook->newCall(interfaceId, methodId, sizeHint);\n  return Request<Params, Results>(typeless.template getAs<Params>(), kj::mv(typeless.hook));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\ninline Request<AnyPointer, AnyPointer> Capability::Client::typelessRequest(\n    uint64_t interfaceId, uint16_t methodId,\n    kj::Maybe<MessageSize> sizeHint) {\n  return newCall<AnyPointer, AnyPointer>(interfaceId, methodId, sizeHint);\n}"
  },
  {
    "function_name": "Capability::Client::whenResolved",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "625-627",
    "snippet": "inline kj::Promise<void> Capability::Client::whenResolved() {\n  return hook->whenResolved();\n}",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hook->whenResolved",
          "args": [],
          "line": 626
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\ninline kj::Promise<void> Capability::Client::whenResolved() {\n  return hook->whenResolved();\n}"
  },
  {
    "function_name": "Capability::Client::castAs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "622-624",
    "snippet": "inline typename T::Client Capability::Client::castAs() {\n  return typename T::Client(hook->addRef());\n}",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "typename T::Client",
          "args": [
            "hook->addRef()"
          ],
          "line": 623
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hook->addRef",
          "args": [],
          "line": 623
        },
        "resolved": true,
        "details": {
          "function_name": "addRef",
          "container": "BrokenClient",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.c++",
          "lines": "598-600",
          "snippet": "kj::Own<ClientHook> addRef() override {\n    return kj::addRef(*this);\n  }",
          "includes": [
            "#include \"generated-header-support.h\"",
            "#include <map>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <kj/refcount.h>",
            "#include \"arena.h\"",
            "#include \"message.h\"",
            "#include \"capability.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"generated-header-support.h\"\n#include <map>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <kj/refcount.h>\n#include \"arena.h\"\n#include \"message.h\"\n#include \"capability.h\"\n\nBrokenClient {\n  kj::Own<ClientHook> addRef() override {\n      return kj::addRef(*this);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\ninline typename T::Client Capability::Client::castAs() {\n  return typename T::Client(hook->addRef());\n}"
  },
  {
    "function_name": "Capability::Client::Client",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "616-616",
    "snippet": "inline Capability::Client::Client(Client& other): hook(other.hook->addRef()) {}",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "other.hook->addRef",
          "args": [],
          "line": 616
        },
        "resolved": true,
        "details": {
          "function_name": "addRef",
          "container": "BrokenClient",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.c++",
          "lines": "598-600",
          "snippet": "kj::Own<ClientHook> addRef() override {\n    return kj::addRef(*this);\n  }",
          "includes": [
            "#include \"generated-header-support.h\"",
            "#include <map>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <kj/refcount.h>",
            "#include \"arena.h\"",
            "#include \"message.h\"",
            "#include \"capability.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"generated-header-support.h\"\n#include <map>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <kj/refcount.h>\n#include \"arena.h\"\n#include \"message.h\"\n#include \"capability.h\"\n\nBrokenClient {\n  kj::Own<ClientHook> addRef() override {\n      return kj::addRef(*this);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\ninline Capability::Client::Client(Client& other): hook(other.hook->addRef()) {}"
  },
  {
    "function_name": "Capability::Client::Client",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "614-615",
    "snippet": "inline Capability::Client::Client(kj::Promise<T>&& promise)\n    : hook(newLocalPromiseClient(promise.then([](T&& t) { return kj::mv(t.hook); }))) {}",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "newLocalPromiseClient",
          "args": [
            "promise.then([](T&& t) { return kj::mv(t.hook); })"
          ],
          "line": 615
        },
        "resolved": true,
        "details": {
          "function_name": "newLocalPromiseClient",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.c++",
          "lines": "534-536",
          "snippet": "kj::Own<ClientHook> newLocalPromiseClient(kj::Promise<kj::Own<ClientHook>>&& promise) {\n  return kj::refcounted<QueuedClient>(kj::mv(promise));\n}",
          "includes": [
            "#include \"generated-header-support.h\"",
            "#include <map>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <kj/refcount.h>",
            "#include \"arena.h\"",
            "#include \"message.h\"",
            "#include \"capability.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"generated-header-support.h\"\n#include <map>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <kj/refcount.h>\n#include \"arena.h\"\n#include \"message.h\"\n#include \"capability.h\"\n\nkj::Own<ClientHook> newLocalPromiseClient(kj::Promise<kj::Own<ClientHook>>&& promise) {\n  return kj::refcounted<QueuedClient>(kj::mv(promise));\n}"
        }
      },
      {
        "call_info": {
          "callee": "promise.then",
          "args": [
            "[](T&& t) { return kj::mv(t.hook); }"
          ],
          "line": 615
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "t.hook"
          ],
          "line": 615
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\ninline Capability::Client::Client(kj::Promise<T>&& promise)\n    : hook(newLocalPromiseClient(promise.then([](T&& t) { return kj::mv(t.hook); }))) {}"
  },
  {
    "function_name": "Capability::Client::Client",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "611-612",
    "snippet": "inline Capability::Client::Client(kj::Own<T>&& server)\n    : hook(makeLocalClient(kj::mv(server))) {}",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "makeLocalClient",
          "args": [
            "kj::mv(server)"
          ],
          "line": 612
        },
        "resolved": true,
        "details": {
          "function_name": "Capability::Client::makeLocalClient",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.c++",
          "lines": "530-532",
          "snippet": "kj::Own<ClientHook> Capability::Client::makeLocalClient(kj::Own<Capability::Server>&& server) {\n  return kj::refcounted<LocalClient>(kj::mv(server));\n}",
          "includes": [
            "#include \"generated-header-support.h\"",
            "#include <map>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <kj/refcount.h>",
            "#include \"arena.h\"",
            "#include \"message.h\"",
            "#include \"capability.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"generated-header-support.h\"\n#include <map>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <kj/refcount.h>\n#include \"arena.h\"\n#include \"message.h\"\n#include \"capability.h\"\n\nkj::Own<ClientHook> Capability::Client::makeLocalClient(kj::Own<Capability::Server>&& server) {\n  return kj::refcounted<LocalClient>(kj::mv(server));\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "server"
          ],
          "line": 612
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\ninline Capability::Client::Client(kj::Own<T>&& server)\n    : hook(makeLocalClient(kj::mv(server))) {}"
  },
  {
    "function_name": "Capability::Client::Client",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "609-609",
    "snippet": "inline Capability::Client::Client(kj::Own<ClientHook>&& hook): hook(kj::mv(hook)) {}",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "hook"
          ],
          "line": 609
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\ninline Capability::Client::Client(kj::Own<ClientHook>&& hook): hook(kj::mv(hook)) {}"
  },
  {
    "function_name": "Request<Params, Results>::send",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "591-607",
    "snippet": "RemotePromise<Results> Request<Params, Results>::send() {\n  auto typelessPromise = hook->send();\n\n  // Convert the Promise to return the correct response type.\n  // Explicitly upcast to kj::Promise to make clear that calling .then() doesn't invalidate the\n  // Pipeline part of the RemotePromise.\n  auto typedPromise = kj::implicitCast<kj::Promise<Response<AnyPointer>>&>(typelessPromise)\n      .then([](Response<AnyPointer>&& response) -> Response<Results> {\n        return Response<Results>(response.getAs<Results>(), kj::mv(response.hook));\n      });\n\n  // Wrap the typeless pipeline in a typed wrapper.\n  typename Results::Pipeline typedPipeline(\n      kj::mv(kj::implicitCast<AnyPointer::Pipeline&>(typelessPromise)));\n\n  return RemotePromise<Results>(kj::mv(typedPromise), kj::mv(typedPipeline));\n}",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "RemotePromise<Results>",
          "args": [
            "kj::mv(typedPromise)",
            "kj::mv(typedPipeline)"
          ],
          "line": 606
        },
        "resolved": true,
        "details": {
          "function_name": "RemotePromise",
          "container": "RemotePromise",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
          "lines": "53-55",
          "snippet": "inline RemotePromise(kj::Promise<Response<T>>&& promise, typename T::Pipeline&& pipeline)\n      : kj::Promise<Response<T>>(kj::mv(promise)),\n        T::Pipeline(kj::mv(pipeline)) {}",
          "includes": [
            "#include \"pointer-helpers.h\"",
            "#include \"any.h\"",
            "#include <kj/async.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\nRemotePromise {\n  inline RemotePromise(kj::Promise<Response<T>>&& promise, typename T::Pipeline&& pipeline)\n        : kj::Promise<Response<T>>(kj::mv(promise)),\n          T::Pipeline(kj::mv(pipeline)) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "typedPipeline"
          ],
          "line": 606
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "typedPromise"
          ],
          "line": 606
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::implicitCast<kj::Promise<Response<AnyPointer>>&>",
          "args": [
            "[](Response<AnyPointer>&& response) -> Response<Results> {\n        return Response<Results>(response.getAs<Results>(), kj::mv(response.hook));\n      }"
          ],
          "line": 597
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Response<Results>",
          "args": [
            "response.getAs<Results>()",
            "kj::mv(response.hook)"
          ],
          "line": 599
        },
        "resolved": true,
        "details": {
          "function_name": "Response",
          "container": "Response",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
          "lines": "130-131",
          "snippet": "inline Response(typename Results::Reader reader, kj::Own<ResponseHook>&& hook)\n      : Results::Reader(reader), hook(kj::mv(hook)) {}",
          "includes": [
            "#include \"pointer-helpers.h\"",
            "#include \"any.h\"",
            "#include <kj/async.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\nResponse {\n  inline Response(typename Results::Reader reader, kj::Own<ResponseHook>&& hook)\n        : Results::Reader(reader), hook(kj::mv(hook)) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "response.hook"
          ],
          "line": 599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "response.getAs<Results>",
          "args": [],
          "line": 599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::implicitCast<kj::Promise<Response<AnyPointer>>&>",
          "args": [
            "typelessPromise"
          ],
          "line": 597
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hook->send",
          "args": [],
          "line": 592
        },
        "resolved": true,
        "details": {
          "function_name": "send",
          "container": "BrokenRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.c++",
          "lines": "561-564",
          "snippet": "RemotePromise<AnyPointer> send() override {\n    return RemotePromise<AnyPointer>(kj::cp(exception),\n        AnyPointer::Pipeline(kj::refcounted<BrokenPipeline>(exception)));\n  }",
          "includes": [
            "#include \"generated-header-support.h\"",
            "#include <map>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <kj/refcount.h>",
            "#include \"arena.h\"",
            "#include \"message.h\"",
            "#include \"capability.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"generated-header-support.h\"\n#include <map>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <kj/refcount.h>\n#include \"arena.h\"\n#include \"message.h\"\n#include \"capability.h\"\n\nBrokenRequest {\n  RemotePromise<AnyPointer> send() override {\n      return RemotePromise<AnyPointer>(kj::cp(exception),\n          AnyPointer::Pipeline(kj::refcounted<BrokenPipeline>(exception)));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\nRemotePromise<Results> Request<Params, Results>::send() {\n  auto typelessPromise = hook->send();\n\n  // Convert the Promise to return the correct response type.\n  // Explicitly upcast to kj::Promise to make clear that calling .then() doesn't invalidate the\n  // Pipeline part of the RemotePromise.\n  auto typedPromise = kj::implicitCast<kj::Promise<Response<AnyPointer>>&>(typelessPromise)\n      .then([](Response<AnyPointer>&& response) -> Response<Results> {\n        return Response<Results>(response.getAs<Results>(), kj::mv(response.hook));\n      });\n\n  // Wrap the typeless pipeline in a typed wrapper.\n  typename Results::Pipeline typedPipeline(\n      kj::mv(kj::implicitCast<AnyPointer::Pipeline&>(typelessPromise)));\n\n  return RemotePromise<Results>(kj::mv(typedPromise), kj::mv(typedPipeline));\n}"
  },
  {
    "function_name": "getFromPointer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "576-579",
    "snippet": "inline static _::ListReader getFromPointer(\n      const _::PointerReader& reader, const word* defaultValue) {\n    return reader.getList(ElementSize::POINTER, defaultValue);\n  }",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reader.getList",
          "args": [
            "ElementSize::POINTER",
            "defaultValue"
          ],
          "line": 578
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\ninline static _::ListReader getFromPointer(\n      const _::PointerReader& reader, const word* defaultValue) {\n    return reader.getList(ElementSize::POINTER, defaultValue);\n  }"
  },
  {
    "function_name": "getFromPointer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "573-575",
    "snippet": "inline static _::ListBuilder getFromPointer(_::PointerBuilder builder, const word* defaultValue) {\n    return builder.getList(ElementSize::POINTER, defaultValue);\n  }",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "builder.getList",
          "args": [
            "ElementSize::POINTER",
            "defaultValue"
          ],
          "line": 574
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\ninline static _::ListBuilder getFromPointer(_::PointerBuilder builder, const word* defaultValue) {\n    return builder.getList(ElementSize::POINTER, defaultValue);\n  }"
  },
  {
    "function_name": "initPointer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "570-572",
    "snippet": "inline static _::ListBuilder initPointer(_::PointerBuilder builder, uint size) {\n    return builder.initList(ElementSize::POINTER, size * ELEMENTS);\n  }",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "builder.initList",
          "args": [
            "ElementSize::POINTER",
            "size * ELEMENTS"
          ],
          "line": 571
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\ninline static _::ListBuilder initPointer(_::PointerBuilder builder, uint size) {\n    return builder.initList(ElementSize::POINTER, size * ELEMENTS);\n  }"
  },
  {
    "function_name": "end",
    "container": "Builder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "560-560",
    "snippet": "inline Iterator end() { return Iterator(this, size()); }",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Iterator",
          "args": [
            "this",
            "size()"
          ],
          "line": 560
        },
        "resolved": true,
        "details": {
          "function_name": "IndexingIterator",
          "container": "IndexingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/list.h",
          "lines": "98-99",
          "snippet": "inline IndexingIterator(Container* container, uint index)\n      : container(container), index(index) {}",
          "includes": [
            "#include <iterator>",
            "#include <initializer_list>",
            "#include \"orphan.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iterator>\n#include <initializer_list>\n#include \"orphan.h\"\n#include \"layout.h\"\n\nIndexingIterator {\n  inline IndexingIterator(Container* container, uint index)\n        : container(container), index(index) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "size",
          "args": [],
          "line": 560
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Builder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
          "lines": "540-540",
          "snippet": "inline uint size() const { return builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"pointer-helpers.h\"",
            "#include \"any.h\"",
            "#include <kj/async.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\nBuilder {\n  inline uint size() const { return builder.size() / ELEMENTS; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\nBuilder {\n  inline Iterator end() { return Iterator(this, size()); }\n}"
  },
  {
    "function_name": "begin",
    "container": "Builder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "559-559",
    "snippet": "inline Iterator begin() { return Iterator(this, 0); }",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Iterator",
          "args": [
            "this",
            "0"
          ],
          "line": 559
        },
        "resolved": true,
        "details": {
          "function_name": "IndexingIterator",
          "container": "IndexingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/list.h",
          "lines": "98-99",
          "snippet": "inline IndexingIterator(Container* container, uint index)\n      : container(container), index(index) {}",
          "includes": [
            "#include <iterator>",
            "#include <initializer_list>",
            "#include \"orphan.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iterator>\n#include <initializer_list>\n#include \"orphan.h\"\n#include \"layout.h\"\n\nIndexingIterator {\n  inline IndexingIterator(Container* container, uint index)\n        : container(container), index(index) {}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\nBuilder {\n  inline Iterator begin() { return Iterator(this, 0); }\n}"
  },
  {
    "function_name": "disown",
    "container": "Builder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "553-556",
    "snippet": "inline Orphan<T> disown(uint index) {\n      KJ_IREQUIRE(index < size());\n      return Orphan<T>(builder.getPointerElement(index * ELEMENTS).disown());\n    }",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Orphan<T>",
          "args": [
            "builder.getPointerElement(index * ELEMENTS).disown()"
          ],
          "line": 555
        },
        "resolved": true,
        "details": {
          "function_name": "Orphanage::newOrphan",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "1939-1942",
          "snippet": "Orphan<DynamicStruct> Orphanage::newOrphan(StructSchema schema) const {\n  return Orphan<DynamicStruct>(\n      schema, _::OrphanBuilder::initStruct(arena, structSizeFromSchema(schema)));\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nOrphan<DynamicStruct> Orphanage::newOrphan(StructSchema schema) const {\n  return Orphan<DynamicStruct>(\n      schema, _::OrphanBuilder::initStruct(arena, structSizeFromSchema(schema)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "index * ELEMENTS"
          ],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_IREQUIRE",
          "args": [
            "index < size()"
          ],
          "line": 554
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "size",
          "args": [],
          "line": 554
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Builder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
          "lines": "540-540",
          "snippet": "inline uint size() const { return builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"pointer-helpers.h\"",
            "#include \"any.h\"",
            "#include <kj/async.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\nBuilder {\n  inline uint size() const { return builder.size() / ELEMENTS; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\nBuilder {\n  inline Orphan<T> disown(uint index) {\n        KJ_IREQUIRE(index < size());\n        return Orphan<T>(builder.getPointerElement(index * ELEMENTS).disown());\n      }\n}"
  },
  {
    "function_name": "adopt",
    "container": "Builder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "549-552",
    "snippet": "inline void adopt(uint index, Orphan<T>&& value) {\n      KJ_IREQUIRE(index < size());\n      builder.getPointerElement(index * ELEMENTS).adopt(kj::mv(value));\n    }",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "kj::mv(value)"
          ],
          "line": 551
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "value"
          ],
          "line": 551
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "index * ELEMENTS"
          ],
          "line": 551
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_IREQUIRE",
          "args": [
            "index < size()"
          ],
          "line": 550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "size",
          "args": [],
          "line": 550
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Builder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
          "lines": "540-540",
          "snippet": "inline uint size() const { return builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"pointer-helpers.h\"",
            "#include \"any.h\"",
            "#include <kj/async.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\nBuilder {\n  inline uint size() const { return builder.size() / ELEMENTS; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\nBuilder {\n  inline void adopt(uint index, Orphan<T>&& value) {\n        KJ_IREQUIRE(index < size());\n        builder.getPointerElement(index * ELEMENTS).adopt(kj::mv(value));\n      }\n}"
  },
  {
    "function_name": "set",
    "container": "Builder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "545-548",
    "snippet": "inline void set(uint index, typename T::Client value) {\n      KJ_IREQUIRE(index < size());\n      builder.getPointerElement(index * ELEMENTS).setCapability(kj::mv(value.hook));\n    }",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "kj::mv(value.hook)"
          ],
          "line": 547
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "value.hook"
          ],
          "line": 547
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getPointerElement",
          "args": [
            "index * ELEMENTS"
          ],
          "line": 547
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KJ_IREQUIRE",
          "args": [
            "index < size()"
          ],
          "line": 546
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "size",
          "args": [],
          "line": 546
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Builder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
          "lines": "540-540",
          "snippet": "inline uint size() const { return builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"pointer-helpers.h\"",
            "#include \"any.h\"",
            "#include <kj/async.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\nBuilder {\n  inline uint size() const { return builder.size() / ELEMENTS; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\nBuilder {\n  inline void set(uint index, typename T::Client value) {\n        KJ_IREQUIRE(index < size());\n        builder.getPointerElement(index * ELEMENTS).setCapability(kj::mv(value.hook));\n      }\n}"
  },
  {
    "function_name": "size",
    "container": "Builder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "540-540",
    "snippet": "inline uint size() const { return builder.size() / ELEMENTS; }",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\nBuilder {\n  inline uint size() const { return builder.size() / ELEMENTS; }\n}"
  },
  {
    "function_name": "asReader",
    "container": "Builder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "538-538",
    "snippet": "inline Reader asReader() { return Reader(builder.asReader()); }",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Reader",
          "args": [
            "builder.asReader()"
          ],
          "line": 538
        },
        "resolved": true,
        "details": {
          "function_name": "Reader",
          "container": "Reader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
          "lines": "506-506",
          "snippet": "inline explicit Reader(_::ListReader reader): reader(reader) {}",
          "includes": [
            "#include \"pointer-helpers.h\"",
            "#include \"any.h\"",
            "#include <kj/async.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\nReader {\n  inline explicit Reader(_::ListReader reader): reader(reader) {}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\nBuilder {\n  inline Reader asReader() { return Reader(builder.asReader()); }\n}"
  },
  {
    "function_name": "Builder",
    "container": "Builder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "535-535",
    "snippet": "inline explicit Builder(_::ListBuilder builder): builder(builder) {}",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\nBuilder {\n  inline explicit Builder(_::ListBuilder builder): builder(builder) {}\n}"
  },
  {
    "function_name": "Builder",
    "container": "Builder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "534-534",
    "snippet": "inline Builder(decltype(nullptr)) {}",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\nBuilder {\n  inline Builder(decltype(nullptr)) {}\n}"
  },
  {
    "function_name": "end",
    "container": "Reader",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "516-516",
    "snippet": "inline Iterator end() const { return Iterator(this, size()); }",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Iterator",
          "args": [
            "this",
            "size()"
          ],
          "line": 516
        },
        "resolved": true,
        "details": {
          "function_name": "IndexingIterator",
          "container": "IndexingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/list.h",
          "lines": "98-99",
          "snippet": "inline IndexingIterator(Container* container, uint index)\n      : container(container), index(index) {}",
          "includes": [
            "#include <iterator>",
            "#include <initializer_list>",
            "#include \"orphan.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iterator>\n#include <initializer_list>\n#include \"orphan.h\"\n#include \"layout.h\"\n\nIndexingIterator {\n  inline IndexingIterator(Container* container, uint index)\n        : container(container), index(index) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "size",
          "args": [],
          "line": 516
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Builder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
          "lines": "540-540",
          "snippet": "inline uint size() const { return builder.size() / ELEMENTS; }",
          "includes": [
            "#include \"pointer-helpers.h\"",
            "#include \"any.h\"",
            "#include <kj/async.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\nBuilder {\n  inline uint size() const { return builder.size() / ELEMENTS; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\nReader {\n  inline Iterator end() const { return Iterator(this, size()); }\n}"
  },
  {
    "function_name": "begin",
    "container": "Reader",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "515-515",
    "snippet": "inline Iterator begin() const { return Iterator(this, 0); }",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Iterator",
          "args": [
            "this",
            "0"
          ],
          "line": 515
        },
        "resolved": true,
        "details": {
          "function_name": "IndexingIterator",
          "container": "IndexingIterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/list.h",
          "lines": "98-99",
          "snippet": "inline IndexingIterator(Container* container, uint index)\n      : container(container), index(index) {}",
          "includes": [
            "#include <iterator>",
            "#include <initializer_list>",
            "#include \"orphan.h\"",
            "#include \"layout.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iterator>\n#include <initializer_list>\n#include \"orphan.h\"\n#include \"layout.h\"\n\nIndexingIterator {\n  inline IndexingIterator(Container* container, uint index)\n        : container(container), index(index) {}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\nReader {\n  inline Iterator begin() const { return Iterator(this, 0); }\n}"
  },
  {
    "function_name": "size",
    "container": "Reader",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "508-508",
    "snippet": "inline uint size() const { return reader.size() / ELEMENTS; }",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\nReader {\n  inline uint size() const { return reader.size() / ELEMENTS; }\n}"
  },
  {
    "function_name": "Reader",
    "container": "Reader",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "506-506",
    "snippet": "inline explicit Reader(_::ListReader reader): reader(reader) {}",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\nReader {\n  inline explicit Reader(_::ListReader reader): reader(reader) {}\n}"
  },
  {
    "function_name": "disown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "487-489",
    "snippet": "static inline Orphan<T> disown(PointerBuilder builder) {\n    return Orphan<T>(builder.disown());\n  }",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Orphan<T>",
          "args": [
            "builder.disown()"
          ],
          "line": 488
        },
        "resolved": true,
        "details": {
          "function_name": "Orphanage::newOrphan",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/dynamic.c++",
          "lines": "1939-1942",
          "snippet": "Orphan<DynamicStruct> Orphanage::newOrphan(StructSchema schema) const {\n  return Orphan<DynamicStruct>(\n      schema, _::OrphanBuilder::initStruct(arena, structSizeFromSchema(schema)));\n}",
          "includes": [
            "#include <kj/debug.h>",
            "#include \"dynamic.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <kj/debug.h>\n#include \"dynamic.h\"\n\nOrphan<DynamicStruct> Orphanage::newOrphan(StructSchema schema) const {\n  return Orphan<DynamicStruct>(\n      schema, _::OrphanBuilder::initStruct(arena, structSizeFromSchema(schema)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "builder.disown",
          "args": [],
          "line": 488
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\nstatic inline Orphan<T> disown(PointerBuilder builder) {\n    return Orphan<T>(builder.disown());\n  }"
  },
  {
    "function_name": "adopt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "484-486",
    "snippet": "static inline void adopt(PointerBuilder builder, Orphan<T>&& value) {\n    builder.adopt(kj::mv(value.builder));\n  }",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "builder.adopt",
          "args": [
            "kj::mv(value.builder)"
          ],
          "line": 485
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "value.builder"
          ],
          "line": 485
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\nstatic inline void adopt(PointerBuilder builder, Orphan<T>&& value) {\n    builder.adopt(kj::mv(value.builder));\n  }"
  },
  {
    "function_name": "set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "481-483",
    "snippet": "static inline void set(PointerBuilder builder, typename T::Client& value) {\n    builder.setCapability(value.Capability::Client::hook->addRef());\n  }",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "builder.setCapability",
          "args": [
            "value.Capability::Client::hook->addRef()"
          ],
          "line": 482
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.Capability::Client::hook->addRef",
          "args": [],
          "line": 482
        },
        "resolved": true,
        "details": {
          "function_name": "addRef",
          "container": "BrokenClient",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.c++",
          "lines": "598-600",
          "snippet": "kj::Own<ClientHook> addRef() override {\n    return kj::addRef(*this);\n  }",
          "includes": [
            "#include \"generated-header-support.h\"",
            "#include <map>",
            "#include <kj/vector.h>",
            "#include <kj/debug.h>",
            "#include <kj/refcount.h>",
            "#include \"arena.h\"",
            "#include \"message.h\"",
            "#include \"capability.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"generated-header-support.h\"\n#include <map>\n#include <kj/vector.h>\n#include <kj/debug.h>\n#include <kj/refcount.h>\n#include \"arena.h\"\n#include \"message.h\"\n#include \"capability.h\"\n\nBrokenClient {\n  kj::Own<ClientHook> addRef() override {\n      return kj::addRef(*this);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\nstatic inline void set(PointerBuilder builder, typename T::Client& value) {\n    builder.setCapability(value.Capability::Client::hook->addRef());\n  }"
  },
  {
    "function_name": "set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "478-480",
    "snippet": "static inline void set(PointerBuilder builder, typename T::Client&& value) {\n    builder.setCapability(kj::mv(value.Capability::Client::hook));\n  }",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "builder.setCapability",
          "args": [
            "kj::mv(value.Capability::Client::hook)"
          ],
          "line": 479
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "value.Capability::Client::hook"
          ],
          "line": 479
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\nstatic inline void set(PointerBuilder builder, typename T::Client&& value) {\n    builder.setCapability(kj::mv(value.Capability::Client::hook));\n  }"
  },
  {
    "function_name": "get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "475-477",
    "snippet": "static inline typename T::Client get(PointerBuilder builder) {\n    return typename T::Client(builder.getCapability());\n  }",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "typename T::Client",
          "args": [
            "builder.getCapability()"
          ],
          "line": 476
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "builder.getCapability",
          "args": [],
          "line": 476
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\nstatic inline typename T::Client get(PointerBuilder builder) {\n    return typename T::Client(builder.getCapability());\n  }"
  },
  {
    "function_name": "get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "472-474",
    "snippet": "static inline typename T::Client get(PointerReader reader) {\n    return typename T::Client(reader.getCapability());\n  }",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "typename T::Client",
          "args": [
            "reader.getCapability()"
          ],
          "line": 473
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reader.getCapability",
          "args": [],
          "line": 473
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\nstatic inline typename T::Client get(PointerReader reader) {\n    return typename T::Client(reader.getCapability());\n  }"
  },
  {
    "function_name": "from",
    "container": "RequestHook",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "354-356",
    "snippet": "inline static kj::Own<RequestHook> from(Request<T, U>&& request) {\n    return kj::mv(request.hook);\n  }",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "request.hook"
          ],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\nRequestHook {\n  inline static kj::Own<RequestHook> from(Request<T, U>&& request) {\n      return kj::mv(request.hook);\n    }\n}"
  },
  {
    "function_name": "Response",
    "container": "Response",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "130-131",
    "snippet": "inline Response(typename Results::Reader reader, kj::Own<ResponseHook>&& hook)\n      : Results::Reader(reader), hook(kj::mv(hook)) {}",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "hook"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\nResponse {\n  inline Response(typename Results::Reader reader, kj::Own<ResponseHook>&& hook)\n        : Results::Reader(reader), hook(kj::mv(hook)) {}\n}"
  },
  {
    "function_name": "Request",
    "container": "Request",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "108-109",
    "snippet": "inline Request(typename Params::Builder builder, kj::Own<RequestHook>&& hook)\n      : Params::Builder(builder), hook(kj::mv(hook)) {}",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "hook"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\nRequest {\n  inline Request(typename Params::Builder builder, kj::Own<RequestHook>&& hook)\n        : Params::Builder(builder), hook(kj::mv(hook)) {}\n}"
  },
  {
    "function_name": "RemotePromise",
    "container": "RemotePromise",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "56-58",
    "snippet": "inline RemotePromise(decltype(nullptr))\n      : kj::Promise<Response<T>>(nullptr),\n        T::Pipeline(nullptr) {}",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\nRemotePromise {\n  inline RemotePromise(decltype(nullptr))\n        : kj::Promise<Response<T>>(nullptr),\n          T::Pipeline(nullptr) {}\n}"
  },
  {
    "function_name": "RemotePromise",
    "container": "RemotePromise",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2313/repo/c++/src/capnp/capability.h",
    "lines": "53-55",
    "snippet": "inline RemotePromise(kj::Promise<Response<T>>&& promise, typename T::Pipeline&& pipeline)\n      : kj::Promise<Response<T>>(kj::mv(promise)),\n        T::Pipeline(kj::mv(pipeline)) {}",
    "includes": [
      "#include \"pointer-helpers.h\"",
      "#include \"any.h\"",
      "#include <kj/async.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "pipeline"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kj::mv",
          "args": [
            "promise"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pointer-helpers.h\"\n#include \"any.h\"\n#include <kj/async.h>\n\nRemotePromise {\n  inline RemotePromise(kj::Promise<Response<T>>&& promise, typename T::Pipeline&& pipeline)\n        : kj::Promise<Response<T>>(kj::mv(promise)),\n          T::Pipeline(kj::mv(pipeline)) {}\n}"
  }
]