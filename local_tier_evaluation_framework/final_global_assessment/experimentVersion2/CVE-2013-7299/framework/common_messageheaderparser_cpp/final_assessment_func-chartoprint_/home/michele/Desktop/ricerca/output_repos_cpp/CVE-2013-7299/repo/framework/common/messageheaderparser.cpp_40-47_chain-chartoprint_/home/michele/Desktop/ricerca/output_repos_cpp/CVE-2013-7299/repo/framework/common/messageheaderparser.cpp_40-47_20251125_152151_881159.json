{
  "assessment_type": "combined",
  "id": [
    "chartoprint",
    "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheaderparser.cpp",
    "40-47"
  ],
  "file_path": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheaderparser.cpp",
  "function_name": "chartoprint",
  "function_code": "#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/messageheaderparser.h>\n\nstd::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[ch >> 4] + hex[ch & 0xf] + '\\'';\n    }\n\n-------- CONTEXTUAL INFORMATIONS - CALLEES CODE --------\n-------- Code of the functions used by the analyzed function -------- \n\n",
  "chain_code": "---- CALL CHAIN SNIPPETS ----\n\n---- TARGET FUNCTION ----\nstd::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[ch >> 4] + hex[ch & 0xf] + '\\'';\n    }\n\n---- CALLER 1 ----\nbool Messageheader::Parser::state_fieldname(char ch)\n  {\n    if (ch == ':')            // Field-name:\n    {\n      checkHeaderspace(2);\n      *headerdataPtr++ = ch;\n      *headerdataPtr++ = '\\0';\n      fieldbodyPtr = headerdataPtr;\n      SET_STATE(state_fieldbody0);\n    }\n    else if (ch >= 33 && ch <= 126)\n    {\n      checkHeaderspace(1);\n      *headerdataPtr++ = ch;\n    }\n    else if (std::isspace(ch))\n    {\n      checkHeaderspace(2);\n      *headerdataPtr++ = ':';\n      *headerdataPtr++ = '\\0';\n      fieldbodyPtr = headerdataPtr;\n      SET_STATE(state_fieldnamespace);\n    }\n    else\n    {",
  "False_positive_reason": "",
  "Preconditions": [
    "The function is processing a non-printable character with a signed char value where the high bit is set (e.g., signed char values < 0).",
    "The input 'ch' is passed to 'chartoprint' without validation in 'Messageheader::Parser::state_fieldname'."
  ],
  "Trigger_actions": [
    "Attacker supplies a non-printable character with a negative signed char value (e.g., 0x80) in an HTTP message header during parsing."
  ],
  "Dangerous_post_conditions": [
    "Array index calculation in 'hex[ch >> 4]' and 'hex[ch & 0xf]' produces values outside [0,15], leading to out-of-bounds memory access.",
    "Memory disclosure vulnerability via reading adjacent memory beyond the bounds of the 'hex' array."
  ],
  "Initial_conditions": [
    "The application is using the 'Messageheader::Parser' code path for HTTP header parsing.",
    "The vulnerable 'chartoprint' function is called when processing fieldnames or field bodies containing non-printable characters."
  ]
}