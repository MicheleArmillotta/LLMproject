{
  "assessment_type": "combined",
  "id": [
    "chartoprint",
    "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheaderparser.cpp",
    "40-47"
  ],
  "file_path": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheaderparser.cpp",
  "function_name": "chartoprint",
  "function_code": "#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/messageheaderparser.h>\n\nstd::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[ch >> 4] + hex[ch & 0xf] + '\\'';\n    }\n\n-------- CONTEXTUAL INFORMATIONS - CALLEES CODE --------\n-------- Code of the functions used by the analyzed function -------- \n\n",
  "chain_code": "---- CALL CHAIN SNIPPETS ----\n\n---- TARGET FUNCTION ----\nstd::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[ch >> 4] + hex[ch & 0xf] + '\\'';\n    }\n\n---- CALLER 1 ----\nbool HttpRequest::Parser::state_cmd(char ch)\n  {\n    if (istokenchar(ch))\n    {\n      if (message.methodLen >= sizeof(message.method) - 1)\n      {\n        log_debug(\"invalid method field; method=\" << std::string(message.method, message.methodLen) << \", len=\" << message.methodLen);\n        throw HttpError(HTTP_BAD_REQUEST, \"invalid method field\");\n      }\n      message.method[message.methodLen++] = ch;\n    }\n    else if (ch == ' ')\n    {\n      message.method[message.methodLen] = '\\0';\n      log_debug(\"method=\" << message.method);\n      SET_STATE(state_url0);\n    }\n    else\n    {\n      log_warn(",
  "False_positive_reason": "",
  "Preconditions": [
    "Non-printable character with high bit set (signed char < 0) passed from HTTP parser to chartoprint",
    "chartoprint processes the character via bitwise operations without type promotion"
  ],
  "Trigger_actions": [
    "Attacker crafts HTTP request with malicious character having high bit set",
    "HTTP parser invokes log_warn() with vulnerable character",
    "chartoprint() is called with unvalidated input"
  ],
  "Dangerous_post_conditions": [
    "Out-of-bounds read from hex[16] array",
    "Invalid memory disclosure via hex[ch >> 4] and hex[ch & 0xf]"
  ],
  "Initial_conditions": [
    "HTTP request with invalid method field",
    "chartoprint() invoked by logging system to represent invalid character"
  ]
}