{
  "assessment_type": "combined",
  "id": [
    "chartoprint",
    "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheaderparser.cpp",
    "40-47"
  ],
  "file_path": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheaderparser.cpp",
  "function_name": "chartoprint",
  "function_code": "#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/messageheaderparser.h>\n\nstd::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[ch >> 4] + hex[ch & 0xf] + '\\'';\n    }\n\n-------- CONTEXTUAL INFORMATIONS - CALLEES CODE --------\n-------- Code of the functions used by the analyzed function -------- \n\n",
  "chain_code": "---- CALL CHAIN SNIPPETS ----\n\n---- TARGET FUNCTION ----\nstd::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[ch >> 4] + hex[ch & 0xf] + '\\'';\n    }\n\n---- CALLER 1 ----\nbool HttpRequest::Parser::state_protocol_host(char ch)\n  {\n    if (ch == '/')\n    {\n      message.url.clear();\n      message.url.reserve(32);\n      message.url += ch;\n      SET_STATE(state_url);\n    }\n    else if (!std::isalpha(ch)\n           && !std::isdigit(ch)\n           && ch != '['\n           && ch != ']'\n           && ch != '.'\n           && ch != ':')\n    {\n      log_warn(\"invalid character \" << chartoprint(ch) << \" in url\");\n      httpCode = HTTP_BAD_REQUEST;\n      failedFlag = true;\n    }\n\n    return failedFlag;\n  }",
  "False_positive_reason": "",
  "Preconditions": [
    "Input 'ch' is a non-printable character with a negative signed char value (high bit set)",
    "The input flows to chartoprint without validation"
  ],
  "Trigger_actions": [
    "An attacker provides a malicious HTTP request containing a byte value that maps to a signed char with a negative value (e.g., byte value >= 0x80) in the URL path"
  ],
  "Dangerous_post_conditions": [
    "Out-of-bounds read occurs when accessing hex[ch >> 4] or hex[ch & 0xf] with indices outside [0,15] range",
    "Memory disclosure vulnerability exposing adjacent memory contents"
  ],
  "Initial_conditions": [
    "Server is using HTTP request parser with vulnerable chartoprint() logging",
    "No input sanitization is applied to URL characters before logging"
  ]
}