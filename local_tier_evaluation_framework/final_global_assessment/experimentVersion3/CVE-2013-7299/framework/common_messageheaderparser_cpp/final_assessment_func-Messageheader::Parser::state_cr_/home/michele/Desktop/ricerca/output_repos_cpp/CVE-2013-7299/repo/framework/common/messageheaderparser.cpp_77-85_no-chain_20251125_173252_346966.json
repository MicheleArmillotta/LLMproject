{
  "assessment_type": "function_only",
  "id": [
    "Messageheader::Parser::state_cr",
    "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheaderparser.cpp",
    "77-85"
  ],
  "file_path": "/home/michele/Desktop/ricerca/agents/local_tier_evaluation_framework/enriched_snippets/CVE-2013-7299/framework/common_messageheaderparser_cpp/enriched_snippets.json",
  "function_name": "Messageheader::Parser::state_cr",
  "function_code": "#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/messageheaderparser.h>\n\nbool Messageheader::Parser::state_cr(char ch)\n  {\n    if (ch != '\\n')\n    {\n      log_warn(\"invalid character \" << chartoprint(ch) << \" in state-cr\");\n      failedFlag = true;\n    }\n    return true;\n  }\n\n-------- CONTEXTUAL INFORMATIONS - CALLEES CODE --------\n-------- Code of the functions used by the analyzed function -------- \n\n\nCallee: chartoprint\nstd::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[ch >> 4] + hex[ch & 0xf] + '\\'';\n    }\n",
  "chain_code": null,
  "False_positive_reason": "",
  "Preconditions": [
    "An attacker controls an HTTP header containing a custom character 'ch'",
    "The server logs diagnostic output (e.g., 'log_warn') to accessible storage"
  ],
  "Trigger_actions": [
    "Send an HTTP request with a header containing a non-\\n character"
  ],
  "Dangerous_post_conditions": [
    "User-controlled HTTP header content is logged in plaintext or escape-encoded form",
    "Sensitive input values are exposed in server logs"
  ],
  "Initial_conditions": [
    "Server logging system stores diagnostic messages to persistent storage",
    "Server logs are accessible to unauthorized actors (e.g., misconfigured permissions)"
  ]
}