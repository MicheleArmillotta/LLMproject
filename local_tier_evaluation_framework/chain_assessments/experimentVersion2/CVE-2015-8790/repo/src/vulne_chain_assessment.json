[
  {
    "file_path": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlUnicodeString.cpp",
    "id": [
      "UTFstring::UpdateFromUCS2",
      "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlUnicodeString.cpp",
      "198-228"
    ],
    "function_name": "UTFstring::UpdateFromUCS2",
    "chains": {
      "call_sequence": [
        "UTFstring::UpdateFromUCS2"
      ],
      "length": 1,
      "snippets": [
        {
          "qualified_name": "UTFstring::UpdateFromUCS2",
          "snippet": "void UTFstring::UpdateFromUCS2()\n{\n  // find the size of the final UTF-8 string\n  size_t i,Size=0;\n  for (i=0; i<_Length; i++) {\n    if (_Data[i] < 0x80) {\n      Size++;\n    } else if (_Data[i] < 0x800) {\n      Size += 2;\n    } else {\n      Size += 3;\n    }\n  }\n  std::string::value_type *tmpStr = new std::string::value_type[Size+1];\n  for (i=0, Size=0; i<_Length; i++) {\n    if (_Data[i] < 0x80) {\n      tmpStr[Size++] = _Data[i];\n    } else if (_Data[i] < 0x800) {\n      tmpStr[Size++] = 0xC0 | (_Data[i] >> 6);\n      tmpStr[Size++] = 0x80 | (_Data[i] & 0x3F);\n    } else {\n      tmpStr[Size++] = ",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-8790/repo/src/EbmlUnicodeString.cpp",
          "lines": "198-228"
        }
      ]
    },
    "Vulnerable": true,
    "Description": "The caller chain propagates untrusted user input into the vulnerable function without mitigations. The _Data and _Length variables originate from user-provided input (cin >> _Data), and ConvertToUTF8() directly invokes the unsafe UpdateFromUCS2() without validating the input size or checking for integer overflow. This allows an attacker to supply a malicious UCS-2 string with a crafted _Length value that triggers the integer overflow and subsequent buffer overflow in the target function.",
    "Used_entities": [
      "_Data",
      "_Length",
      "UpdateFromUCS2"
    ],
    "Hallucinated_entities": [
      "ConvertToUTF8",
      "cin"
    ],
    "Coverage": 0.0
  }
]