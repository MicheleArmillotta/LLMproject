[
  {
    "function_name": "set_change_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/xdr4.h",
    "lines": "641-655",
    "snippet": "static inline void\nset_change_info(struct nfsd4_change_info *cinfo, struct svc_fh *fhp)\n{\n\tBUG_ON(!fhp->fh_pre_saved);\n\tcinfo->atomic = (u32)fhp->fh_post_saved;\n\tcinfo->change_supported = IS_I_VERSION(d_inode(fhp->fh_dentry));\n\n\tcinfo->before_change = fhp->fh_pre_change;\n\tcinfo->after_change = fhp->fh_post_change;\n\tcinfo->before_ctime_sec = fhp->fh_pre_ctime.tv_sec;\n\tcinfo->before_ctime_nsec = fhp->fh_pre_ctime.tv_nsec;\n\tcinfo->after_ctime_sec = fhp->fh_post_attr.ctime.tv_sec;\n\tcinfo->after_ctime_nsec = fhp->fh_post_attr.ctime.tv_nsec;\n\n}",
    "includes": [
      "#include \"nfsd.h\"",
      "#include \"state.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IS_I_VERSION",
          "args": [
            "d_inode(fhp->fh_dentry)"
          ],
          "line": 646
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "d_inode",
          "args": [
            "fhp->fh_dentry"
          ],
          "line": 646
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "!fhp->fh_pre_saved"
          ],
          "line": 644
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nfsd.h\"\n#include \"state.h\"\n\nstatic inline void\nset_change_info(struct nfsd4_change_info *cinfo, struct svc_fh *fhp)\n{\n\tBUG_ON(!fhp->fh_pre_saved);\n\tcinfo->atomic = (u32)fhp->fh_post_saved;\n\tcinfo->change_supported = IS_I_VERSION(d_inode(fhp->fh_dentry));\n\n\tcinfo->before_change = fhp->fh_pre_change;\n\tcinfo->after_change = fhp->fh_post_change;\n\tcinfo->before_ctime_sec = fhp->fh_pre_ctime.tv_sec;\n\tcinfo->before_ctime_nsec = fhp->fh_pre_ctime.tv_nsec;\n\tcinfo->after_ctime_sec = fhp->fh_post_attr.ctime.tv_sec;\n\tcinfo->after_ctime_nsec = fhp->fh_post_attr.ctime.tv_nsec;\n\n}"
  },
  {
    "function_name": "nfsd4_last_compound_op",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/xdr4.h",
    "lines": "628-634",
    "snippet": "static inline bool nfsd4_last_compound_op(struct svc_rqst *rqstp)\n{\n\tstruct nfsd4_compoundres *resp = rqstp->rq_resp;\n\tstruct nfsd4_compoundargs *argp = rqstp->rq_argp;\n\n\treturn argp->opcnt == resp->opcnt;\n}",
    "includes": [
      "#include \"nfsd.h\"",
      "#include \"state.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"nfsd.h\"\n#include \"state.h\"\n\nstatic inline bool nfsd4_last_compound_op(struct svc_rqst *rqstp)\n{\n\tstruct nfsd4_compoundres *resp = rqstp->rq_resp;\n\tstruct nfsd4_compoundargs *argp = rqstp->rq_argp;\n\n\treturn argp->opcnt == resp->opcnt;\n}"
  },
  {
    "function_name": "nfsd4_not_cached",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/xdr4.h",
    "lines": "622-626",
    "snippet": "static inline bool nfsd4_not_cached(struct nfsd4_compoundres *resp)\n{\n\treturn !(resp->cstate.slot->sl_flags & NFSD4_SLOT_CACHETHIS)\n\t\t|| nfsd4_is_solo_sequence(resp);\n}",
    "includes": [
      "#include \"nfsd.h\"",
      "#include \"state.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nfsd4_is_solo_sequence",
          "args": [
            "resp"
          ],
          "line": 625
        },
        "resolved": true,
        "details": {
          "function_name": "nfsd4_is_solo_sequence",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/xdr4.h",
          "lines": "616-620",
          "snippet": "static inline bool nfsd4_is_solo_sequence(struct nfsd4_compoundres *resp)\n{\n\tstruct nfsd4_compoundargs *args = resp->rqstp->rq_argp;\n\treturn resp->opcnt == 1 && args->ops[0].opnum == OP_SEQUENCE;\n}",
          "includes": [
            "#include \"nfsd.h\"",
            "#include \"state.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nfsd.h\"\n#include \"state.h\"\n\nstatic inline bool nfsd4_is_solo_sequence(struct nfsd4_compoundres *resp)\n{\n\tstruct nfsd4_compoundargs *args = resp->rqstp->rq_argp;\n\treturn resp->opcnt == 1 && args->ops[0].opnum == OP_SEQUENCE;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nfsd.h\"\n#include \"state.h\"\n\nstatic inline bool nfsd4_not_cached(struct nfsd4_compoundres *resp)\n{\n\treturn !(resp->cstate.slot->sl_flags & NFSD4_SLOT_CACHETHIS)\n\t\t|| nfsd4_is_solo_sequence(resp);\n}"
  },
  {
    "function_name": "nfsd4_is_solo_sequence",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/xdr4.h",
    "lines": "616-620",
    "snippet": "static inline bool nfsd4_is_solo_sequence(struct nfsd4_compoundres *resp)\n{\n\tstruct nfsd4_compoundargs *args = resp->rqstp->rq_argp;\n\treturn resp->opcnt == 1 && args->ops[0].opnum == OP_SEQUENCE;\n}",
    "includes": [
      "#include \"nfsd.h\"",
      "#include \"state.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"nfsd.h\"\n#include \"state.h\"\n\nstatic inline bool nfsd4_is_solo_sequence(struct nfsd4_compoundres *resp)\n{\n\tstruct nfsd4_compoundargs *args = resp->rqstp->rq_argp;\n\treturn resp->opcnt == 1 && args->ops[0].opnum == OP_SEQUENCE;\n}"
  },
  {
    "function_name": "nfsd4_has_session",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/xdr4.h",
    "lines": "71-74",
    "snippet": "static inline bool nfsd4_has_session(struct nfsd4_compound_state *cs)\n{\n\treturn cs->slot != NULL;\n}",
    "includes": [
      "#include \"nfsd.h\"",
      "#include \"state.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"nfsd.h\"\n#include \"state.h\"\n\nstatic inline bool nfsd4_has_session(struct nfsd4_compound_state *cs)\n{\n\treturn cs->slot != NULL;\n}"
  }
]