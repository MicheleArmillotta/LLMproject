[
  {
    "function_name": "nfsd4_encode_group",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
    "lines": "658-663",
    "snippet": "__be32 nfsd4_encode_group(struct xdr_stream *xdr, struct svc_rqst *rqstp,\n\t\t\t  kgid_t gid)\n{\n\tu32 id = from_kgid(&init_user_ns, gid);\n\treturn encode_name_from_id(xdr, rqstp, IDMAP_TYPE_GROUP, id);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_name_from_id",
          "args": [
            "xdr",
            "rqstp",
            "IDMAP_TYPE_GROUP",
            "id"
          ],
          "line": 662
        },
        "resolved": true,
        "details": {
          "function_name": "encode_name_from_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
          "lines": "617-623",
          "snippet": "static __be32 encode_name_from_id(struct xdr_stream *xdr,\n\t\t\t\t  struct svc_rqst *rqstp, int type, u32 id)\n{\n\tif (nfs4_disable_idmapping && rqstp->rq_cred.cr_flavor < RPC_AUTH_GSS)\n\t\treturn encode_ascii_id(xdr, id);\n\treturn idmap_id_to_name(xdr, rqstp, type, id);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool nfs4_disable_idmapping = true;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic bool nfs4_disable_idmapping = true;\n\nstatic __be32 encode_name_from_id(struct xdr_stream *xdr,\n\t\t\t\t  struct svc_rqst *rqstp, int type, u32 id)\n{\n\tif (nfs4_disable_idmapping && rqstp->rq_cred.cr_flavor < RPC_AUTH_GSS)\n\t\treturn encode_ascii_id(xdr, id);\n\treturn idmap_id_to_name(xdr, rqstp, type, id);\n}"
        }
      },
      {
        "call_info": {
          "callee": "from_kgid",
          "args": [
            "&init_user_ns",
            "gid"
          ],
          "line": 661
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\n__be32 nfsd4_encode_group(struct xdr_stream *xdr, struct svc_rqst *rqstp,\n\t\t\t  kgid_t gid)\n{\n\tu32 id = from_kgid(&init_user_ns, gid);\n\treturn encode_name_from_id(xdr, rqstp, IDMAP_TYPE_GROUP, id);\n}"
  },
  {
    "function_name": "nfsd4_encode_user",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
    "lines": "651-656",
    "snippet": "__be32 nfsd4_encode_user(struct xdr_stream *xdr, struct svc_rqst *rqstp,\n\t\t\t kuid_t uid)\n{\n\tu32 id = from_kuid(&init_user_ns, uid);\n\treturn encode_name_from_id(xdr, rqstp, IDMAP_TYPE_USER, id);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "encode_name_from_id",
          "args": [
            "xdr",
            "rqstp",
            "IDMAP_TYPE_USER",
            "id"
          ],
          "line": 655
        },
        "resolved": true,
        "details": {
          "function_name": "encode_name_from_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
          "lines": "617-623",
          "snippet": "static __be32 encode_name_from_id(struct xdr_stream *xdr,\n\t\t\t\t  struct svc_rqst *rqstp, int type, u32 id)\n{\n\tif (nfs4_disable_idmapping && rqstp->rq_cred.cr_flavor < RPC_AUTH_GSS)\n\t\treturn encode_ascii_id(xdr, id);\n\treturn idmap_id_to_name(xdr, rqstp, type, id);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool nfs4_disable_idmapping = true;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic bool nfs4_disable_idmapping = true;\n\nstatic __be32 encode_name_from_id(struct xdr_stream *xdr,\n\t\t\t\t  struct svc_rqst *rqstp, int type, u32 id)\n{\n\tif (nfs4_disable_idmapping && rqstp->rq_cred.cr_flavor < RPC_AUTH_GSS)\n\t\treturn encode_ascii_id(xdr, id);\n\treturn idmap_id_to_name(xdr, rqstp, type, id);\n}"
        }
      },
      {
        "call_info": {
          "callee": "from_kuid",
          "args": [
            "&init_user_ns",
            "uid"
          ],
          "line": 654
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\n__be32 nfsd4_encode_user(struct xdr_stream *xdr, struct svc_rqst *rqstp,\n\t\t\t kuid_t uid)\n{\n\tu32 id = from_kuid(&init_user_ns, uid);\n\treturn encode_name_from_id(xdr, rqstp, IDMAP_TYPE_USER, id);\n}"
  },
  {
    "function_name": "nfsd_map_name_to_gid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
    "lines": "638-649",
    "snippet": "__be32\nnfsd_map_name_to_gid(struct svc_rqst *rqstp, const char *name, size_t namelen,\n\t\tkgid_t *gid)\n{\n\t__be32 status;\n\tu32 id = -1;\n\tstatus = do_name_to_id(rqstp, IDMAP_TYPE_GROUP, name, namelen, &id);\n\t*gid = make_kgid(&init_user_ns, id);\n\tif (!gid_valid(*gid))\n\t\tstatus = nfserr_badowner;\n\treturn status;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gid_valid",
          "args": [
            "*gid"
          ],
          "line": 646
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "make_kgid",
          "args": [
            "&init_user_ns",
            "id"
          ],
          "line": 645
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_name_to_id",
          "args": [
            "rqstp",
            "IDMAP_TYPE_GROUP",
            "name",
            "namelen",
            "&id"
          ],
          "line": 644
        },
        "resolved": true,
        "details": {
          "function_name": "do_name_to_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
          "lines": "604-615",
          "snippet": "static __be32\ndo_name_to_id(struct svc_rqst *rqstp, int type, const char *name, u32 namelen, u32 *id)\n{\n\tif (nfs4_disable_idmapping && rqstp->rq_cred.cr_flavor < RPC_AUTH_GSS)\n\t\tif (numeric_name_to_id(rqstp, type, name, namelen, id))\n\t\t\treturn 0;\n\t\t/*\n\t\t * otherwise, fall through and try idmapping, for\n\t\t * backwards compatibility with clients sending names:\n\t\t */\n\treturn idmap_name_to_id(rqstp, type, name, namelen, id);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool nfs4_disable_idmapping = true;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic bool nfs4_disable_idmapping = true;\n\nstatic __be32\ndo_name_to_id(struct svc_rqst *rqstp, int type, const char *name, u32 namelen, u32 *id)\n{\n\tif (nfs4_disable_idmapping && rqstp->rq_cred.cr_flavor < RPC_AUTH_GSS)\n\t\tif (numeric_name_to_id(rqstp, type, name, namelen, id))\n\t\t\treturn 0;\n\t\t/*\n\t\t * otherwise, fall through and try idmapping, for\n\t\t * backwards compatibility with clients sending names:\n\t\t */\n\treturn idmap_name_to_id(rqstp, type, name, namelen, id);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\n__be32\nnfsd_map_name_to_gid(struct svc_rqst *rqstp, const char *name, size_t namelen,\n\t\tkgid_t *gid)\n{\n\t__be32 status;\n\tu32 id = -1;\n\tstatus = do_name_to_id(rqstp, IDMAP_TYPE_GROUP, name, namelen, &id);\n\t*gid = make_kgid(&init_user_ns, id);\n\tif (!gid_valid(*gid))\n\t\tstatus = nfserr_badowner;\n\treturn status;\n}"
  },
  {
    "function_name": "nfsd_map_name_to_uid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
    "lines": "625-636",
    "snippet": "__be32\nnfsd_map_name_to_uid(struct svc_rqst *rqstp, const char *name, size_t namelen,\n\t\tkuid_t *uid)\n{\n\t__be32 status;\n\tu32 id = -1;\n\tstatus = do_name_to_id(rqstp, IDMAP_TYPE_USER, name, namelen, &id);\n\t*uid = make_kuid(&init_user_ns, id);\n\tif (!uid_valid(*uid))\n\t\tstatus = nfserr_badowner;\n\treturn status;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "uid_valid",
          "args": [
            "*uid"
          ],
          "line": 633
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "make_kuid",
          "args": [
            "&init_user_ns",
            "id"
          ],
          "line": 632
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_name_to_id",
          "args": [
            "rqstp",
            "IDMAP_TYPE_USER",
            "name",
            "namelen",
            "&id"
          ],
          "line": 631
        },
        "resolved": true,
        "details": {
          "function_name": "do_name_to_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
          "lines": "604-615",
          "snippet": "static __be32\ndo_name_to_id(struct svc_rqst *rqstp, int type, const char *name, u32 namelen, u32 *id)\n{\n\tif (nfs4_disable_idmapping && rqstp->rq_cred.cr_flavor < RPC_AUTH_GSS)\n\t\tif (numeric_name_to_id(rqstp, type, name, namelen, id))\n\t\t\treturn 0;\n\t\t/*\n\t\t * otherwise, fall through and try idmapping, for\n\t\t * backwards compatibility with clients sending names:\n\t\t */\n\treturn idmap_name_to_id(rqstp, type, name, namelen, id);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool nfs4_disable_idmapping = true;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic bool nfs4_disable_idmapping = true;\n\nstatic __be32\ndo_name_to_id(struct svc_rqst *rqstp, int type, const char *name, u32 namelen, u32 *id)\n{\n\tif (nfs4_disable_idmapping && rqstp->rq_cred.cr_flavor < RPC_AUTH_GSS)\n\t\tif (numeric_name_to_id(rqstp, type, name, namelen, id))\n\t\t\treturn 0;\n\t\t/*\n\t\t * otherwise, fall through and try idmapping, for\n\t\t * backwards compatibility with clients sending names:\n\t\t */\n\treturn idmap_name_to_id(rqstp, type, name, namelen, id);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\n__be32\nnfsd_map_name_to_uid(struct svc_rqst *rqstp, const char *name, size_t namelen,\n\t\tkuid_t *uid)\n{\n\t__be32 status;\n\tu32 id = -1;\n\tstatus = do_name_to_id(rqstp, IDMAP_TYPE_USER, name, namelen, &id);\n\t*uid = make_kuid(&init_user_ns, id);\n\tif (!uid_valid(*uid))\n\t\tstatus = nfserr_badowner;\n\treturn status;\n}"
  },
  {
    "function_name": "encode_name_from_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
    "lines": "617-623",
    "snippet": "static __be32 encode_name_from_id(struct xdr_stream *xdr,\n\t\t\t\t  struct svc_rqst *rqstp, int type, u32 id)\n{\n\tif (nfs4_disable_idmapping && rqstp->rq_cred.cr_flavor < RPC_AUTH_GSS)\n\t\treturn encode_ascii_id(xdr, id);\n\treturn idmap_id_to_name(xdr, rqstp, type, id);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool nfs4_disable_idmapping = true;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "idmap_id_to_name",
          "args": [
            "xdr",
            "rqstp",
            "type",
            "id"
          ],
          "line": 622
        },
        "resolved": true,
        "details": {
          "function_name": "idmap_id_to_name",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
          "lines": "561-586",
          "snippet": "static __be32 idmap_id_to_name(struct xdr_stream *xdr,\n\t\t\t       struct svc_rqst *rqstp, int type, u32 id)\n{\n\tstruct ent *item, key = {\n\t\t.id = id,\n\t\t.type = type,\n\t};\n\t__be32 *p;\n\tint ret;\n\tstruct nfsd_net *nn = net_generic(SVC_NET(rqstp), nfsd_net_id);\n\n\tstrlcpy(key.authname, rqst_authname(rqstp), sizeof(key.authname));\n\tret = idmap_lookup(rqstp, idtoname_lookup, &key, nn->idtoname_cache, &item);\n\tif (ret == -ENOENT)\n\t\treturn encode_ascii_id(xdr, id);\n\tif (ret)\n\t\treturn nfserrno(ret);\n\tret = strlen(item->name);\n\tWARN_ON_ONCE(ret > IDMAP_NAMESZ);\n\tp = xdr_reserve_space(xdr, ret + 4);\n\tif (!p)\n\t\treturn nfserr_resource;\n\tp = xdr_encode_opaque(p, item->name, ret);\n\tcache_put(&item->h, nn->idtoname_cache);\n\treturn 0;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
            "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\n\nstatic __be32 idmap_id_to_name(struct xdr_stream *xdr,\n\t\t\t       struct svc_rqst *rqstp, int type, u32 id)\n{\n\tstruct ent *item, key = {\n\t\t.id = id,\n\t\t.type = type,\n\t};\n\t__be32 *p;\n\tint ret;\n\tstruct nfsd_net *nn = net_generic(SVC_NET(rqstp), nfsd_net_id);\n\n\tstrlcpy(key.authname, rqst_authname(rqstp), sizeof(key.authname));\n\tret = idmap_lookup(rqstp, idtoname_lookup, &key, nn->idtoname_cache, &item);\n\tif (ret == -ENOENT)\n\t\treturn encode_ascii_id(xdr, id);\n\tif (ret)\n\t\treturn nfserrno(ret);\n\tret = strlen(item->name);\n\tWARN_ON_ONCE(ret > IDMAP_NAMESZ);\n\tp = xdr_reserve_space(xdr, ret + 4);\n\tif (!p)\n\t\treturn nfserr_resource;\n\tp = xdr_encode_opaque(p, item->name, ret);\n\tcache_put(&item->h, nn->idtoname_cache);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_ascii_id",
          "args": [
            "xdr",
            "id"
          ],
          "line": 621
        },
        "resolved": true,
        "details": {
          "function_name": "encode_ascii_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
          "lines": "547-559",
          "snippet": "static __be32 encode_ascii_id(struct xdr_stream *xdr, u32 id)\n{\n\tchar buf[11];\n\tint len;\n\t__be32 *p;\n\n\tlen = sprintf(buf, \"%u\", id);\n\tp = xdr_reserve_space(xdr, len + 4);\n\tif (!p)\n\t\treturn nfserr_resource;\n\tp = xdr_encode_opaque(p, buf, len);\n\treturn 0;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic __be32 encode_ascii_id(struct xdr_stream *xdr, u32 id)\n{\n\tchar buf[11];\n\tint len;\n\t__be32 *p;\n\n\tlen = sprintf(buf, \"%u\", id);\n\tp = xdr_reserve_space(xdr, len + 4);\n\tif (!p)\n\t\treturn nfserr_resource;\n\tp = xdr_encode_opaque(p, buf, len);\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic bool nfs4_disable_idmapping = true;\n\nstatic __be32 encode_name_from_id(struct xdr_stream *xdr,\n\t\t\t\t  struct svc_rqst *rqstp, int type, u32 id)\n{\n\tif (nfs4_disable_idmapping && rqstp->rq_cred.cr_flavor < RPC_AUTH_GSS)\n\t\treturn encode_ascii_id(xdr, id);\n\treturn idmap_id_to_name(xdr, rqstp, type, id);\n}"
  },
  {
    "function_name": "do_name_to_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
    "lines": "604-615",
    "snippet": "static __be32\ndo_name_to_id(struct svc_rqst *rqstp, int type, const char *name, u32 namelen, u32 *id)\n{\n\tif (nfs4_disable_idmapping && rqstp->rq_cred.cr_flavor < RPC_AUTH_GSS)\n\t\tif (numeric_name_to_id(rqstp, type, name, namelen, id))\n\t\t\treturn 0;\n\t\t/*\n\t\t * otherwise, fall through and try idmapping, for\n\t\t * backwards compatibility with clients sending names:\n\t\t */\n\treturn idmap_name_to_id(rqstp, type, name, namelen, id);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool nfs4_disable_idmapping = true;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "idmap_name_to_id",
          "args": [
            "rqstp",
            "type",
            "name",
            "namelen",
            "id"
          ],
          "line": 614
        },
        "resolved": true,
        "details": {
          "function_name": "idmap_name_to_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
          "lines": "522-545",
          "snippet": "static __be32\nidmap_name_to_id(struct svc_rqst *rqstp, int type, const char *name, u32 namelen,\n\t\tu32 *id)\n{\n\tstruct ent *item, key = {\n\t\t.type = type,\n\t};\n\tint ret;\n\tstruct nfsd_net *nn = net_generic(SVC_NET(rqstp), nfsd_net_id);\n\n\tif (namelen + 1 > sizeof(key.name))\n\t\treturn nfserr_badowner;\n\tmemcpy(key.name, name, namelen);\n\tkey.name[namelen] = '\\0';\n\tstrlcpy(key.authname, rqst_authname(rqstp), sizeof(key.authname));\n\tret = idmap_lookup(rqstp, nametoid_lookup, &key, nn->nametoid_cache, &item);\n\tif (ret == -ENOENT)\n\t\treturn nfserr_badowner;\n\tif (ret)\n\t\treturn nfserrno(ret);\n\t*id = item->id;\n\tcache_put(&item->h, nn->nametoid_cache);\n\treturn 0;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
            "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\n\nstatic __be32\nidmap_name_to_id(struct svc_rqst *rqstp, int type, const char *name, u32 namelen,\n\t\tu32 *id)\n{\n\tstruct ent *item, key = {\n\t\t.type = type,\n\t};\n\tint ret;\n\tstruct nfsd_net *nn = net_generic(SVC_NET(rqstp), nfsd_net_id);\n\n\tif (namelen + 1 > sizeof(key.name))\n\t\treturn nfserr_badowner;\n\tmemcpy(key.name, name, namelen);\n\tkey.name[namelen] = '\\0';\n\tstrlcpy(key.authname, rqst_authname(rqstp), sizeof(key.authname));\n\tret = idmap_lookup(rqstp, nametoid_lookup, &key, nn->nametoid_cache, &item);\n\tif (ret == -ENOENT)\n\t\treturn nfserr_badowner;\n\tif (ret)\n\t\treturn nfserrno(ret);\n\t*id = item->id;\n\tcache_put(&item->h, nn->nametoid_cache);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "numeric_name_to_id",
          "args": [
            "rqstp",
            "type",
            "name",
            "namelen",
            "id"
          ],
          "line": 608
        },
        "resolved": true,
        "details": {
          "function_name": "numeric_name_to_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
          "lines": "588-602",
          "snippet": "static bool\nnumeric_name_to_id(struct svc_rqst *rqstp, int type, const char *name, u32 namelen, u32 *id)\n{\n\tint ret;\n\tchar buf[11];\n\n\tif (namelen + 1 > sizeof(buf))\n\t\t/* too long to represent a 32-bit id: */\n\t\treturn false;\n\t/* Just to make sure it's null-terminated: */\n\tmemcpy(buf, name, namelen);\n\tbuf[namelen] = '\\0';\n\tret = kstrtouint(buf, 10, id);\n\treturn ret == 0;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic bool\nnumeric_name_to_id(struct svc_rqst *rqstp, int type, const char *name, u32 namelen, u32 *id)\n{\n\tint ret;\n\tchar buf[11];\n\n\tif (namelen + 1 > sizeof(buf))\n\t\t/* too long to represent a 32-bit id: */\n\t\treturn false;\n\t/* Just to make sure it's null-terminated: */\n\tmemcpy(buf, name, namelen);\n\tbuf[namelen] = '\\0';\n\tret = kstrtouint(buf, 10, id);\n\treturn ret == 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic bool nfs4_disable_idmapping = true;\n\nstatic __be32\ndo_name_to_id(struct svc_rqst *rqstp, int type, const char *name, u32 namelen, u32 *id)\n{\n\tif (nfs4_disable_idmapping && rqstp->rq_cred.cr_flavor < RPC_AUTH_GSS)\n\t\tif (numeric_name_to_id(rqstp, type, name, namelen, id))\n\t\t\treturn 0;\n\t\t/*\n\t\t * otherwise, fall through and try idmapping, for\n\t\t * backwards compatibility with clients sending names:\n\t\t */\n\treturn idmap_name_to_id(rqstp, type, name, namelen, id);\n}"
  },
  {
    "function_name": "numeric_name_to_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
    "lines": "588-602",
    "snippet": "static bool\nnumeric_name_to_id(struct svc_rqst *rqstp, int type, const char *name, u32 namelen, u32 *id)\n{\n\tint ret;\n\tchar buf[11];\n\n\tif (namelen + 1 > sizeof(buf))\n\t\t/* too long to represent a 32-bit id: */\n\t\treturn false;\n\t/* Just to make sure it's null-terminated: */\n\tmemcpy(buf, name, namelen);\n\tbuf[namelen] = '\\0';\n\tret = kstrtouint(buf, 10, id);\n\treturn ret == 0;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kstrtouint",
          "args": [
            "buf",
            "10",
            "id"
          ],
          "line": 600
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "buf",
            "name",
            "namelen"
          ],
          "line": 598
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic bool\nnumeric_name_to_id(struct svc_rqst *rqstp, int type, const char *name, u32 namelen, u32 *id)\n{\n\tint ret;\n\tchar buf[11];\n\n\tif (namelen + 1 > sizeof(buf))\n\t\t/* too long to represent a 32-bit id: */\n\t\treturn false;\n\t/* Just to make sure it's null-terminated: */\n\tmemcpy(buf, name, namelen);\n\tbuf[namelen] = '\\0';\n\tret = kstrtouint(buf, 10, id);\n\treturn ret == 0;\n}"
  },
  {
    "function_name": "idmap_id_to_name",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
    "lines": "561-586",
    "snippet": "static __be32 idmap_id_to_name(struct xdr_stream *xdr,\n\t\t\t       struct svc_rqst *rqstp, int type, u32 id)\n{\n\tstruct ent *item, key = {\n\t\t.id = id,\n\t\t.type = type,\n\t};\n\t__be32 *p;\n\tint ret;\n\tstruct nfsd_net *nn = net_generic(SVC_NET(rqstp), nfsd_net_id);\n\n\tstrlcpy(key.authname, rqst_authname(rqstp), sizeof(key.authname));\n\tret = idmap_lookup(rqstp, idtoname_lookup, &key, nn->idtoname_cache, &item);\n\tif (ret == -ENOENT)\n\t\treturn encode_ascii_id(xdr, id);\n\tif (ret)\n\t\treturn nfserrno(ret);\n\tret = strlen(item->name);\n\tWARN_ON_ONCE(ret > IDMAP_NAMESZ);\n\tp = xdr_reserve_space(xdr, ret + 4);\n\tif (!p)\n\t\treturn nfserr_resource;\n\tp = xdr_encode_opaque(p, item->name, ret);\n\tcache_put(&item->h, nn->idtoname_cache);\n\treturn 0;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache_put",
          "args": [
            "&item->h",
            "nn->idtoname_cache"
          ],
          "line": 584
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_encode_opaque",
          "args": [
            "p",
            "item->name",
            "ret"
          ],
          "line": 583
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_reserve_space",
          "args": [
            "xdr",
            "ret + 4"
          ],
          "line": 580
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "ret > IDMAP_NAMESZ"
          ],
          "line": 579
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "item->name"
          ],
          "line": 578
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfserrno",
          "args": [
            "ret"
          ],
          "line": 577
        },
        "resolved": true,
        "details": {
          "function_name": "nfserrno",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfsproc.c",
          "lines": "756-806",
          "snippet": "__be32\nnfserrno (int errno)\n{\n\tstatic struct {\n\t\t__be32\tnfserr;\n\t\tint\tsyserr;\n\t} nfs_errtbl[] = {\n\t\t{ nfs_ok, 0 },\n\t\t{ nfserr_perm, -EPERM },\n\t\t{ nfserr_noent, -ENOENT },\n\t\t{ nfserr_io, -EIO },\n\t\t{ nfserr_nxio, -ENXIO },\n\t\t{ nfserr_fbig, -E2BIG },\n\t\t{ nfserr_acces, -EACCES },\n\t\t{ nfserr_exist, -EEXIST },\n\t\t{ nfserr_xdev, -EXDEV },\n\t\t{ nfserr_mlink, -EMLINK },\n\t\t{ nfserr_nodev, -ENODEV },\n\t\t{ nfserr_notdir, -ENOTDIR },\n\t\t{ nfserr_isdir, -EISDIR },\n\t\t{ nfserr_inval, -EINVAL },\n\t\t{ nfserr_fbig, -EFBIG },\n\t\t{ nfserr_nospc, -ENOSPC },\n\t\t{ nfserr_rofs, -EROFS },\n\t\t{ nfserr_mlink, -EMLINK },\n\t\t{ nfserr_nametoolong, -ENAMETOOLONG },\n\t\t{ nfserr_notempty, -ENOTEMPTY },\n#ifdef EDQUOT\n\t\t{ nfserr_dquot, -EDQUOT },\n#endif\n\t\t{ nfserr_stale, -ESTALE },\n\t\t{ nfserr_jukebox, -ETIMEDOUT },\n\t\t{ nfserr_jukebox, -ERESTARTSYS },\n\t\t{ nfserr_jukebox, -EAGAIN },\n\t\t{ nfserr_jukebox, -EWOULDBLOCK },\n\t\t{ nfserr_jukebox, -ENOMEM },\n\t\t{ nfserr_io, -ETXTBSY },\n\t\t{ nfserr_notsupp, -EOPNOTSUPP },\n\t\t{ nfserr_toosmall, -ETOOSMALL },\n\t\t{ nfserr_serverfault, -ESERVERFAULT },\n\t\t{ nfserr_serverfault, -ENFILE },\n\t};\n\tint\ti;\n\n\tfor (i = 0; i < ARRAY_SIZE(nfs_errtbl); i++) {\n\t\tif (nfs_errtbl[i].syserr == errno)\n\t\t\treturn nfs_errtbl[i].nfserr;\n\t}\n\tWARN(1, \"nfsd: non-standard errno: %d\\n\", errno);\n\treturn nfserr_io;\n}",
          "includes": [
            "#include \"vfs.h\"",
            "#include \"xdr.h\"",
            "#include \"cache.h\"",
            "#include <linux/namei.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vfs.h\"\n#include \"xdr.h\"\n#include \"cache.h\"\n#include <linux/namei.h>\n\n__be32\nnfserrno (int errno)\n{\n\tstatic struct {\n\t\t__be32\tnfserr;\n\t\tint\tsyserr;\n\t} nfs_errtbl[] = {\n\t\t{ nfs_ok, 0 },\n\t\t{ nfserr_perm, -EPERM },\n\t\t{ nfserr_noent, -ENOENT },\n\t\t{ nfserr_io, -EIO },\n\t\t{ nfserr_nxio, -ENXIO },\n\t\t{ nfserr_fbig, -E2BIG },\n\t\t{ nfserr_acces, -EACCES },\n\t\t{ nfserr_exist, -EEXIST },\n\t\t{ nfserr_xdev, -EXDEV },\n\t\t{ nfserr_mlink, -EMLINK },\n\t\t{ nfserr_nodev, -ENODEV },\n\t\t{ nfserr_notdir, -ENOTDIR },\n\t\t{ nfserr_isdir, -EISDIR },\n\t\t{ nfserr_inval, -EINVAL },\n\t\t{ nfserr_fbig, -EFBIG },\n\t\t{ nfserr_nospc, -ENOSPC },\n\t\t{ nfserr_rofs, -EROFS },\n\t\t{ nfserr_mlink, -EMLINK },\n\t\t{ nfserr_nametoolong, -ENAMETOOLONG },\n\t\t{ nfserr_notempty, -ENOTEMPTY },\n#ifdef EDQUOT\n\t\t{ nfserr_dquot, -EDQUOT },\n#endif\n\t\t{ nfserr_stale, -ESTALE },\n\t\t{ nfserr_jukebox, -ETIMEDOUT },\n\t\t{ nfserr_jukebox, -ERESTARTSYS },\n\t\t{ nfserr_jukebox, -EAGAIN },\n\t\t{ nfserr_jukebox, -EWOULDBLOCK },\n\t\t{ nfserr_jukebox, -ENOMEM },\n\t\t{ nfserr_io, -ETXTBSY },\n\t\t{ nfserr_notsupp, -EOPNOTSUPP },\n\t\t{ nfserr_toosmall, -ETOOSMALL },\n\t\t{ nfserr_serverfault, -ESERVERFAULT },\n\t\t{ nfserr_serverfault, -ENFILE },\n\t};\n\tint\ti;\n\n\tfor (i = 0; i < ARRAY_SIZE(nfs_errtbl); i++) {\n\t\tif (nfs_errtbl[i].syserr == errno)\n\t\t\treturn nfs_errtbl[i].nfserr;\n\t}\n\tWARN(1, \"nfsd: non-standard errno: %d\\n\", errno);\n\treturn nfserr_io;\n}"
        }
      },
      {
        "call_info": {
          "callee": "encode_ascii_id",
          "args": [
            "xdr",
            "id"
          ],
          "line": 575
        },
        "resolved": true,
        "details": {
          "function_name": "encode_ascii_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
          "lines": "547-559",
          "snippet": "static __be32 encode_ascii_id(struct xdr_stream *xdr, u32 id)\n{\n\tchar buf[11];\n\tint len;\n\t__be32 *p;\n\n\tlen = sprintf(buf, \"%u\", id);\n\tp = xdr_reserve_space(xdr, len + 4);\n\tif (!p)\n\t\treturn nfserr_resource;\n\tp = xdr_encode_opaque(p, buf, len);\n\treturn 0;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic __be32 encode_ascii_id(struct xdr_stream *xdr, u32 id)\n{\n\tchar buf[11];\n\tint len;\n\t__be32 *p;\n\n\tlen = sprintf(buf, \"%u\", id);\n\tp = xdr_reserve_space(xdr, len + 4);\n\tif (!p)\n\t\treturn nfserr_resource;\n\tp = xdr_encode_opaque(p, buf, len);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "idmap_lookup",
          "args": [
            "rqstp",
            "idtoname_lookup",
            "&key",
            "nn->idtoname_cache",
            "&item"
          ],
          "line": 573
        },
        "resolved": true,
        "details": {
          "function_name": "idmap_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
          "lines": "490-511",
          "snippet": "static int\nidmap_lookup(struct svc_rqst *rqstp,\n\t\tstruct ent *(*lookup_fn)(struct cache_detail *, struct ent *),\n\t\tstruct ent *key, struct cache_detail *detail, struct ent **item)\n{\n\tint ret;\n\n\t*item = lookup_fn(detail, key);\n\tif (!*item)\n\t\treturn -ENOMEM;\n retry:\n\tret = cache_check(detail, &(*item)->h, &rqstp->rq_chandle);\n\n\tif (ret == -ETIMEDOUT) {\n\t\tstruct ent *prev_item = *item;\n\t\t*item = lookup_fn(detail, key);\n\t\tif (*item != prev_item)\n\t\t\tgoto retry;\n\t\tcache_put(&(*item)->h, detail);\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int         idtoname_parse(struct cache_detail *, char *, int);",
            "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
            "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
            "static int         nametoid_parse(struct cache_detail *, char *, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic int         idtoname_parse(struct cache_detail *, char *, int);\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic int         nametoid_parse(struct cache_detail *, char *, int);\n\nstatic int\nidmap_lookup(struct svc_rqst *rqstp,\n\t\tstruct ent *(*lookup_fn)(struct cache_detail *, struct ent *),\n\t\tstruct ent *key, struct cache_detail *detail, struct ent **item)\n{\n\tint ret;\n\n\t*item = lookup_fn(detail, key);\n\tif (!*item)\n\t\treturn -ENOMEM;\n retry:\n\tret = cache_check(detail, &(*item)->h, &rqstp->rq_chandle);\n\n\tif (ret == -ETIMEDOUT) {\n\t\tstruct ent *prev_item = *item;\n\t\t*item = lookup_fn(detail, key);\n\t\tif (*item != prev_item)\n\t\t\tgoto retry;\n\t\tcache_put(&(*item)->h, detail);\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlcpy",
          "args": [
            "key.authname",
            "rqst_authname(rqstp)",
            "sizeof(key.authname)"
          ],
          "line": 572
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rqst_authname",
          "args": [
            "rqstp"
          ],
          "line": 572
        },
        "resolved": true,
        "details": {
          "function_name": "rqst_authname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
          "lines": "513-520",
          "snippet": "static char *\nrqst_authname(struct svc_rqst *rqstp)\n{\n\tstruct auth_domain *clp;\n\n\tclp = rqstp->rq_gssclient ? rqstp->rq_gssclient : rqstp->rq_client;\n\treturn clp->name;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic char *\nrqst_authname(struct svc_rqst *rqstp)\n{\n\tstruct auth_domain *clp;\n\n\tclp = rqstp->rq_gssclient ? rqstp->rq_gssclient : rqstp->rq_client;\n\treturn clp->name;\n}"
        }
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "SVC_NET(rqstp)",
            "nfsd_net_id"
          ],
          "line": 570
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SVC_NET",
          "args": [
            "rqstp"
          ],
          "line": 570
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\n\nstatic __be32 idmap_id_to_name(struct xdr_stream *xdr,\n\t\t\t       struct svc_rqst *rqstp, int type, u32 id)\n{\n\tstruct ent *item, key = {\n\t\t.id = id,\n\t\t.type = type,\n\t};\n\t__be32 *p;\n\tint ret;\n\tstruct nfsd_net *nn = net_generic(SVC_NET(rqstp), nfsd_net_id);\n\n\tstrlcpy(key.authname, rqst_authname(rqstp), sizeof(key.authname));\n\tret = idmap_lookup(rqstp, idtoname_lookup, &key, nn->idtoname_cache, &item);\n\tif (ret == -ENOENT)\n\t\treturn encode_ascii_id(xdr, id);\n\tif (ret)\n\t\treturn nfserrno(ret);\n\tret = strlen(item->name);\n\tWARN_ON_ONCE(ret > IDMAP_NAMESZ);\n\tp = xdr_reserve_space(xdr, ret + 4);\n\tif (!p)\n\t\treturn nfserr_resource;\n\tp = xdr_encode_opaque(p, item->name, ret);\n\tcache_put(&item->h, nn->idtoname_cache);\n\treturn 0;\n}"
  },
  {
    "function_name": "encode_ascii_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
    "lines": "547-559",
    "snippet": "static __be32 encode_ascii_id(struct xdr_stream *xdr, u32 id)\n{\n\tchar buf[11];\n\tint len;\n\t__be32 *p;\n\n\tlen = sprintf(buf, \"%u\", id);\n\tp = xdr_reserve_space(xdr, len + 4);\n\tif (!p)\n\t\treturn nfserr_resource;\n\tp = xdr_encode_opaque(p, buf, len);\n\treturn 0;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdr_encode_opaque",
          "args": [
            "p",
            "buf",
            "len"
          ],
          "line": 557
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdr_reserve_space",
          "args": [
            "xdr",
            "len + 4"
          ],
          "line": 554
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"%u\"",
            "id"
          ],
          "line": 553
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic __be32 encode_ascii_id(struct xdr_stream *xdr, u32 id)\n{\n\tchar buf[11];\n\tint len;\n\t__be32 *p;\n\n\tlen = sprintf(buf, \"%u\", id);\n\tp = xdr_reserve_space(xdr, len + 4);\n\tif (!p)\n\t\treturn nfserr_resource;\n\tp = xdr_encode_opaque(p, buf, len);\n\treturn 0;\n}"
  },
  {
    "function_name": "idmap_name_to_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
    "lines": "522-545",
    "snippet": "static __be32\nidmap_name_to_id(struct svc_rqst *rqstp, int type, const char *name, u32 namelen,\n\t\tu32 *id)\n{\n\tstruct ent *item, key = {\n\t\t.type = type,\n\t};\n\tint ret;\n\tstruct nfsd_net *nn = net_generic(SVC_NET(rqstp), nfsd_net_id);\n\n\tif (namelen + 1 > sizeof(key.name))\n\t\treturn nfserr_badowner;\n\tmemcpy(key.name, name, namelen);\n\tkey.name[namelen] = '\\0';\n\tstrlcpy(key.authname, rqst_authname(rqstp), sizeof(key.authname));\n\tret = idmap_lookup(rqstp, nametoid_lookup, &key, nn->nametoid_cache, &item);\n\tif (ret == -ENOENT)\n\t\treturn nfserr_badowner;\n\tif (ret)\n\t\treturn nfserrno(ret);\n\t*id = item->id;\n\tcache_put(&item->h, nn->nametoid_cache);\n\treturn 0;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache_put",
          "args": [
            "&item->h",
            "nn->nametoid_cache"
          ],
          "line": 543
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nfserrno",
          "args": [
            "ret"
          ],
          "line": 541
        },
        "resolved": true,
        "details": {
          "function_name": "nfserrno",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfsproc.c",
          "lines": "756-806",
          "snippet": "__be32\nnfserrno (int errno)\n{\n\tstatic struct {\n\t\t__be32\tnfserr;\n\t\tint\tsyserr;\n\t} nfs_errtbl[] = {\n\t\t{ nfs_ok, 0 },\n\t\t{ nfserr_perm, -EPERM },\n\t\t{ nfserr_noent, -ENOENT },\n\t\t{ nfserr_io, -EIO },\n\t\t{ nfserr_nxio, -ENXIO },\n\t\t{ nfserr_fbig, -E2BIG },\n\t\t{ nfserr_acces, -EACCES },\n\t\t{ nfserr_exist, -EEXIST },\n\t\t{ nfserr_xdev, -EXDEV },\n\t\t{ nfserr_mlink, -EMLINK },\n\t\t{ nfserr_nodev, -ENODEV },\n\t\t{ nfserr_notdir, -ENOTDIR },\n\t\t{ nfserr_isdir, -EISDIR },\n\t\t{ nfserr_inval, -EINVAL },\n\t\t{ nfserr_fbig, -EFBIG },\n\t\t{ nfserr_nospc, -ENOSPC },\n\t\t{ nfserr_rofs, -EROFS },\n\t\t{ nfserr_mlink, -EMLINK },\n\t\t{ nfserr_nametoolong, -ENAMETOOLONG },\n\t\t{ nfserr_notempty, -ENOTEMPTY },\n#ifdef EDQUOT\n\t\t{ nfserr_dquot, -EDQUOT },\n#endif\n\t\t{ nfserr_stale, -ESTALE },\n\t\t{ nfserr_jukebox, -ETIMEDOUT },\n\t\t{ nfserr_jukebox, -ERESTARTSYS },\n\t\t{ nfserr_jukebox, -EAGAIN },\n\t\t{ nfserr_jukebox, -EWOULDBLOCK },\n\t\t{ nfserr_jukebox, -ENOMEM },\n\t\t{ nfserr_io, -ETXTBSY },\n\t\t{ nfserr_notsupp, -EOPNOTSUPP },\n\t\t{ nfserr_toosmall, -ETOOSMALL },\n\t\t{ nfserr_serverfault, -ESERVERFAULT },\n\t\t{ nfserr_serverfault, -ENFILE },\n\t};\n\tint\ti;\n\n\tfor (i = 0; i < ARRAY_SIZE(nfs_errtbl); i++) {\n\t\tif (nfs_errtbl[i].syserr == errno)\n\t\t\treturn nfs_errtbl[i].nfserr;\n\t}\n\tWARN(1, \"nfsd: non-standard errno: %d\\n\", errno);\n\treturn nfserr_io;\n}",
          "includes": [
            "#include \"vfs.h\"",
            "#include \"xdr.h\"",
            "#include \"cache.h\"",
            "#include <linux/namei.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vfs.h\"\n#include \"xdr.h\"\n#include \"cache.h\"\n#include <linux/namei.h>\n\n__be32\nnfserrno (int errno)\n{\n\tstatic struct {\n\t\t__be32\tnfserr;\n\t\tint\tsyserr;\n\t} nfs_errtbl[] = {\n\t\t{ nfs_ok, 0 },\n\t\t{ nfserr_perm, -EPERM },\n\t\t{ nfserr_noent, -ENOENT },\n\t\t{ nfserr_io, -EIO },\n\t\t{ nfserr_nxio, -ENXIO },\n\t\t{ nfserr_fbig, -E2BIG },\n\t\t{ nfserr_acces, -EACCES },\n\t\t{ nfserr_exist, -EEXIST },\n\t\t{ nfserr_xdev, -EXDEV },\n\t\t{ nfserr_mlink, -EMLINK },\n\t\t{ nfserr_nodev, -ENODEV },\n\t\t{ nfserr_notdir, -ENOTDIR },\n\t\t{ nfserr_isdir, -EISDIR },\n\t\t{ nfserr_inval, -EINVAL },\n\t\t{ nfserr_fbig, -EFBIG },\n\t\t{ nfserr_nospc, -ENOSPC },\n\t\t{ nfserr_rofs, -EROFS },\n\t\t{ nfserr_mlink, -EMLINK },\n\t\t{ nfserr_nametoolong, -ENAMETOOLONG },\n\t\t{ nfserr_notempty, -ENOTEMPTY },\n#ifdef EDQUOT\n\t\t{ nfserr_dquot, -EDQUOT },\n#endif\n\t\t{ nfserr_stale, -ESTALE },\n\t\t{ nfserr_jukebox, -ETIMEDOUT },\n\t\t{ nfserr_jukebox, -ERESTARTSYS },\n\t\t{ nfserr_jukebox, -EAGAIN },\n\t\t{ nfserr_jukebox, -EWOULDBLOCK },\n\t\t{ nfserr_jukebox, -ENOMEM },\n\t\t{ nfserr_io, -ETXTBSY },\n\t\t{ nfserr_notsupp, -EOPNOTSUPP },\n\t\t{ nfserr_toosmall, -ETOOSMALL },\n\t\t{ nfserr_serverfault, -ESERVERFAULT },\n\t\t{ nfserr_serverfault, -ENFILE },\n\t};\n\tint\ti;\n\n\tfor (i = 0; i < ARRAY_SIZE(nfs_errtbl); i++) {\n\t\tif (nfs_errtbl[i].syserr == errno)\n\t\t\treturn nfs_errtbl[i].nfserr;\n\t}\n\tWARN(1, \"nfsd: non-standard errno: %d\\n\", errno);\n\treturn nfserr_io;\n}"
        }
      },
      {
        "call_info": {
          "callee": "idmap_lookup",
          "args": [
            "rqstp",
            "nametoid_lookup",
            "&key",
            "nn->nametoid_cache",
            "&item"
          ],
          "line": 537
        },
        "resolved": true,
        "details": {
          "function_name": "idmap_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
          "lines": "490-511",
          "snippet": "static int\nidmap_lookup(struct svc_rqst *rqstp,\n\t\tstruct ent *(*lookup_fn)(struct cache_detail *, struct ent *),\n\t\tstruct ent *key, struct cache_detail *detail, struct ent **item)\n{\n\tint ret;\n\n\t*item = lookup_fn(detail, key);\n\tif (!*item)\n\t\treturn -ENOMEM;\n retry:\n\tret = cache_check(detail, &(*item)->h, &rqstp->rq_chandle);\n\n\tif (ret == -ETIMEDOUT) {\n\t\tstruct ent *prev_item = *item;\n\t\t*item = lookup_fn(detail, key);\n\t\tif (*item != prev_item)\n\t\t\tgoto retry;\n\t\tcache_put(&(*item)->h, detail);\n\t}\n\treturn ret;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int         idtoname_parse(struct cache_detail *, char *, int);",
            "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
            "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
            "static int         nametoid_parse(struct cache_detail *, char *, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic int         idtoname_parse(struct cache_detail *, char *, int);\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic int         nametoid_parse(struct cache_detail *, char *, int);\n\nstatic int\nidmap_lookup(struct svc_rqst *rqstp,\n\t\tstruct ent *(*lookup_fn)(struct cache_detail *, struct ent *),\n\t\tstruct ent *key, struct cache_detail *detail, struct ent **item)\n{\n\tint ret;\n\n\t*item = lookup_fn(detail, key);\n\tif (!*item)\n\t\treturn -ENOMEM;\n retry:\n\tret = cache_check(detail, &(*item)->h, &rqstp->rq_chandle);\n\n\tif (ret == -ETIMEDOUT) {\n\t\tstruct ent *prev_item = *item;\n\t\t*item = lookup_fn(detail, key);\n\t\tif (*item != prev_item)\n\t\t\tgoto retry;\n\t\tcache_put(&(*item)->h, detail);\n\t}\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlcpy",
          "args": [
            "key.authname",
            "rqst_authname(rqstp)",
            "sizeof(key.authname)"
          ],
          "line": 536
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rqst_authname",
          "args": [
            "rqstp"
          ],
          "line": 536
        },
        "resolved": true,
        "details": {
          "function_name": "rqst_authname",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
          "lines": "513-520",
          "snippet": "static char *\nrqst_authname(struct svc_rqst *rqstp)\n{\n\tstruct auth_domain *clp;\n\n\tclp = rqstp->rq_gssclient ? rqstp->rq_gssclient : rqstp->rq_client;\n\treturn clp->name;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic char *\nrqst_authname(struct svc_rqst *rqstp)\n{\n\tstruct auth_domain *clp;\n\n\tclp = rqstp->rq_gssclient ? rqstp->rq_gssclient : rqstp->rq_client;\n\treturn clp->name;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "key.name",
            "name",
            "namelen"
          ],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "SVC_NET(rqstp)",
            "nfsd_net_id"
          ],
          "line": 530
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SVC_NET",
          "args": [
            "rqstp"
          ],
          "line": 530
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\n\nstatic __be32\nidmap_name_to_id(struct svc_rqst *rqstp, int type, const char *name, u32 namelen,\n\t\tu32 *id)\n{\n\tstruct ent *item, key = {\n\t\t.type = type,\n\t};\n\tint ret;\n\tstruct nfsd_net *nn = net_generic(SVC_NET(rqstp), nfsd_net_id);\n\n\tif (namelen + 1 > sizeof(key.name))\n\t\treturn nfserr_badowner;\n\tmemcpy(key.name, name, namelen);\n\tkey.name[namelen] = '\\0';\n\tstrlcpy(key.authname, rqst_authname(rqstp), sizeof(key.authname));\n\tret = idmap_lookup(rqstp, nametoid_lookup, &key, nn->nametoid_cache, &item);\n\tif (ret == -ENOENT)\n\t\treturn nfserr_badowner;\n\tif (ret)\n\t\treturn nfserrno(ret);\n\t*id = item->id;\n\tcache_put(&item->h, nn->nametoid_cache);\n\treturn 0;\n}"
  },
  {
    "function_name": "rqst_authname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
    "lines": "513-520",
    "snippet": "static char *\nrqst_authname(struct svc_rqst *rqstp)\n{\n\tstruct auth_domain *clp;\n\n\tclp = rqstp->rq_gssclient ? rqstp->rq_gssclient : rqstp->rq_client;\n\treturn clp->name;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic char *\nrqst_authname(struct svc_rqst *rqstp)\n{\n\tstruct auth_domain *clp;\n\n\tclp = rqstp->rq_gssclient ? rqstp->rq_gssclient : rqstp->rq_client;\n\treturn clp->name;\n}"
  },
  {
    "function_name": "idmap_lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
    "lines": "490-511",
    "snippet": "static int\nidmap_lookup(struct svc_rqst *rqstp,\n\t\tstruct ent *(*lookup_fn)(struct cache_detail *, struct ent *),\n\t\tstruct ent *key, struct cache_detail *detail, struct ent **item)\n{\n\tint ret;\n\n\t*item = lookup_fn(detail, key);\n\tif (!*item)\n\t\treturn -ENOMEM;\n retry:\n\tret = cache_check(detail, &(*item)->h, &rqstp->rq_chandle);\n\n\tif (ret == -ETIMEDOUT) {\n\t\tstruct ent *prev_item = *item;\n\t\t*item = lookup_fn(detail, key);\n\t\tif (*item != prev_item)\n\t\t\tgoto retry;\n\t\tcache_put(&(*item)->h, detail);\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int         idtoname_parse(struct cache_detail *, char *, int);",
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static int         nametoid_parse(struct cache_detail *, char *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache_put",
          "args": [
            "&(*item)->h",
            "detail"
          ],
          "line": 508
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lookup_fn",
          "args": [
            "detail",
            "key"
          ],
          "line": 505
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_check",
          "args": [
            "detail",
            "&(*item)->h",
            "&rqstp->rq_chandle"
          ],
          "line": 501
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lookup_fn",
          "args": [
            "detail",
            "key"
          ],
          "line": 497
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic int         idtoname_parse(struct cache_detail *, char *, int);\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic int         nametoid_parse(struct cache_detail *, char *, int);\n\nstatic int\nidmap_lookup(struct svc_rqst *rqstp,\n\t\tstruct ent *(*lookup_fn)(struct cache_detail *, struct ent *),\n\t\tstruct ent *key, struct cache_detail *detail, struct ent **item)\n{\n\tint ret;\n\n\t*item = lookup_fn(detail, key);\n\tif (!*item)\n\t\treturn -ENOMEM;\n retry:\n\tret = cache_check(detail, &(*item)->h, &rqstp->rq_chandle);\n\n\tif (ret == -ETIMEDOUT) {\n\t\tstruct ent *prev_item = *item;\n\t\t*item = lookup_fn(detail, key);\n\t\tif (*item != prev_item)\n\t\t\tgoto retry;\n\t\tcache_put(&(*item)->h, detail);\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "nfsd_idmap_shutdown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
    "lines": "479-488",
    "snippet": "void\nnfsd_idmap_shutdown(struct net *net)\n{\n\tstruct nfsd_net *nn = net_generic(net, nfsd_net_id);\n\n\tcache_unregister_net(nn->idtoname_cache, net);\n\tcache_unregister_net(nn->nametoid_cache, net);\n\tcache_destroy_net(nn->idtoname_cache, net);\n\tcache_destroy_net(nn->nametoid_cache, net);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache_destroy_net",
          "args": [
            "nn->nametoid_cache",
            "net"
          ],
          "line": 487
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_destroy_net",
          "args": [
            "nn->idtoname_cache",
            "net"
          ],
          "line": 486
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_unregister_net",
          "args": [
            "nn->nametoid_cache",
            "net"
          ],
          "line": 485
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_unregister_net",
          "args": [
            "nn->idtoname_cache",
            "net"
          ],
          "line": 484
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "net",
            "nfsd_net_id"
          ],
          "line": 482
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nvoid\nnfsd_idmap_shutdown(struct net *net)\n{\n\tstruct nfsd_net *nn = net_generic(net, nfsd_net_id);\n\n\tcache_unregister_net(nn->idtoname_cache, net);\n\tcache_unregister_net(nn->nametoid_cache, net);\n\tcache_destroy_net(nn->idtoname_cache, net);\n\tcache_destroy_net(nn->nametoid_cache, net);\n}"
  },
  {
    "function_name": "nfsd_idmap_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
    "lines": "448-477",
    "snippet": "int\nnfsd_idmap_init(struct net *net)\n{\n\tint rv;\n\tstruct nfsd_net *nn = net_generic(net, nfsd_net_id);\n\n\tnn->idtoname_cache = cache_create_net(&idtoname_cache_template, net);\n\tif (IS_ERR(nn->idtoname_cache))\n\t\treturn PTR_ERR(nn->idtoname_cache);\n\trv = cache_register_net(nn->idtoname_cache, net);\n\tif (rv)\n\t\tgoto destroy_idtoname_cache;\n\tnn->nametoid_cache = cache_create_net(&nametoid_cache_template, net);\n\tif (IS_ERR(nn->nametoid_cache)) {\n\t\trv = PTR_ERR(nn->nametoid_cache);\n\t\tgoto unregister_idtoname_cache;\n\t}\n\trv = cache_register_net(nn->nametoid_cache, net);\n\tif (rv)\n\t\tgoto destroy_nametoid_cache;\n\treturn 0;\n\ndestroy_nametoid_cache:\n\tcache_destroy_net(nn->nametoid_cache, net);\nunregister_idtoname_cache:\n\tcache_unregister_net(nn->idtoname_cache, net);\ndestroy_idtoname_cache:\n\tcache_destroy_net(nn->idtoname_cache, net);\n\treturn rv;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct cache_detail idtoname_cache_template = {\n\t.owner\t\t= THIS_MODULE,\n\t.hash_size\t= ENT_HASHMAX,\n\t.name\t\t= \"nfs4.idtoname\",\n\t.cache_put\t= ent_put,\n\t.cache_request\t= idtoname_request,\n\t.cache_parse\t= idtoname_parse,\n\t.cache_show\t= idtoname_show,\n\t.warn_no_listener = warn_no_idmapd,\n\t.match\t\t= idtoname_match,\n\t.init\t\t= ent_init,\n\t.update\t\t= ent_init,\n\t.alloc\t\t= ent_alloc,\n};",
      "static struct cache_detail nametoid_cache_template = {\n\t.owner\t\t= THIS_MODULE,\n\t.hash_size\t= ENT_HASHMAX,\n\t.name\t\t= \"nfs4.nametoid\",\n\t.cache_put\t= ent_put,\n\t.cache_request\t= nametoid_request,\n\t.cache_parse\t= nametoid_parse,\n\t.cache_show\t= nametoid_show,\n\t.warn_no_listener = warn_no_idmapd,\n\t.match\t\t= nametoid_match,\n\t.init\t\t= ent_init,\n\t.update\t\t= ent_init,\n\t.alloc\t\t= ent_alloc,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cache_destroy_net",
          "args": [
            "nn->idtoname_cache",
            "net"
          ],
          "line": 475
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_unregister_net",
          "args": [
            "nn->idtoname_cache",
            "net"
          ],
          "line": 473
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_destroy_net",
          "args": [
            "nn->nametoid_cache",
            "net"
          ],
          "line": 471
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_register_net",
          "args": [
            "nn->nametoid_cache",
            "net"
          ],
          "line": 465
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "nn->nametoid_cache"
          ],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "nn->nametoid_cache"
          ],
          "line": 461
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_create_net",
          "args": [
            "&nametoid_cache_template",
            "net"
          ],
          "line": 460
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_register_net",
          "args": [
            "nn->idtoname_cache",
            "net"
          ],
          "line": 457
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PTR_ERR",
          "args": [
            "nn->idtoname_cache"
          ],
          "line": 456
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IS_ERR",
          "args": [
            "nn->idtoname_cache"
          ],
          "line": 455
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_create_net",
          "args": [
            "&idtoname_cache_template",
            "net"
          ],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "net_generic",
          "args": [
            "net",
            "nfsd_net_id"
          ],
          "line": 452
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic struct cache_detail idtoname_cache_template = {\n\t.owner\t\t= THIS_MODULE,\n\t.hash_size\t= ENT_HASHMAX,\n\t.name\t\t= \"nfs4.idtoname\",\n\t.cache_put\t= ent_put,\n\t.cache_request\t= idtoname_request,\n\t.cache_parse\t= idtoname_parse,\n\t.cache_show\t= idtoname_show,\n\t.warn_no_listener = warn_no_idmapd,\n\t.match\t\t= idtoname_match,\n\t.init\t\t= ent_init,\n\t.update\t\t= ent_init,\n\t.alloc\t\t= ent_alloc,\n};\nstatic struct cache_detail nametoid_cache_template = {\n\t.owner\t\t= THIS_MODULE,\n\t.hash_size\t= ENT_HASHMAX,\n\t.name\t\t= \"nfs4.nametoid\",\n\t.cache_put\t= ent_put,\n\t.cache_request\t= nametoid_request,\n\t.cache_parse\t= nametoid_parse,\n\t.cache_show\t= nametoid_show,\n\t.warn_no_listener = warn_no_idmapd,\n\t.match\t\t= nametoid_match,\n\t.init\t\t= ent_init,\n\t.update\t\t= ent_init,\n\t.alloc\t\t= ent_alloc,\n};\n\nint\nnfsd_idmap_init(struct net *net)\n{\n\tint rv;\n\tstruct nfsd_net *nn = net_generic(net, nfsd_net_id);\n\n\tnn->idtoname_cache = cache_create_net(&idtoname_cache_template, net);\n\tif (IS_ERR(nn->idtoname_cache))\n\t\treturn PTR_ERR(nn->idtoname_cache);\n\trv = cache_register_net(nn->idtoname_cache, net);\n\tif (rv)\n\t\tgoto destroy_idtoname_cache;\n\tnn->nametoid_cache = cache_create_net(&nametoid_cache_template, net);\n\tif (IS_ERR(nn->nametoid_cache)) {\n\t\trv = PTR_ERR(nn->nametoid_cache);\n\t\tgoto unregister_idtoname_cache;\n\t}\n\trv = cache_register_net(nn->nametoid_cache, net);\n\tif (rv)\n\t\tgoto destroy_nametoid_cache;\n\treturn 0;\n\ndestroy_nametoid_cache:\n\tcache_destroy_net(nn->nametoid_cache, net);\nunregister_idtoname_cache:\n\tcache_unregister_net(nn->idtoname_cache, net);\ndestroy_idtoname_cache:\n\tcache_destroy_net(nn->idtoname_cache, net);\n\treturn rv;\n}"
  },
  {
    "function_name": "nametoid_update",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
    "lines": "433-442",
    "snippet": "static struct ent *\nnametoid_update(struct cache_detail *cd, struct ent *new, struct ent *old)\n{\n\tstruct cache_head *ch = sunrpc_cache_update(cd, &new->h, &old->h,\n\t\t\t\t\t\t    nametoid_hash(new));\n\tif (ch)\n\t\treturn container_of(ch, struct ent, h);\n\telse\n\t\treturn NULL;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int         idtoname_parse(struct cache_detail *, char *, int);",
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static int         nametoid_parse(struct cache_detail *, char *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ch",
            "structent",
            "h"
          ],
          "line": 439
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sunrpc_cache_update",
          "args": [
            "cd",
            "&new->h",
            "&old->h",
            "nametoid_hash(new)"
          ],
          "line": 436
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nametoid_hash",
          "args": [
            "new"
          ],
          "line": 437
        },
        "resolved": true,
        "details": {
          "function_name": "nametoid_hash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
          "lines": "291-295",
          "snippet": "static inline int\nnametoid_hash(struct ent *ent)\n{\n\treturn hash_str(ent->name, ENT_HASHBITS);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ENT_HASHBITS          8"
          ],
          "globals_used": [
            "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
            "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\n#define ENT_HASHBITS          8\n\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\n\nstatic inline int\nnametoid_hash(struct ent *ent)\n{\n\treturn hash_str(ent->name, ENT_HASHBITS);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic int         idtoname_parse(struct cache_detail *, char *, int);\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic int         nametoid_parse(struct cache_detail *, char *, int);\n\nstatic struct ent *\nnametoid_update(struct cache_detail *cd, struct ent *new, struct ent *old)\n{\n\tstruct cache_head *ch = sunrpc_cache_update(cd, &new->h, &old->h,\n\t\t\t\t\t\t    nametoid_hash(new));\n\tif (ch)\n\t\treturn container_of(ch, struct ent, h);\n\telse\n\t\treturn NULL;\n}"
  },
  {
    "function_name": "nametoid_lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
    "lines": "422-431",
    "snippet": "static struct ent *\nnametoid_lookup(struct cache_detail *cd, struct ent *item)\n{\n\tstruct cache_head *ch = sunrpc_cache_lookup(cd, &item->h,\n\t\t\t\t\t\t    nametoid_hash(item));\n\tif (ch)\n\t\treturn container_of(ch, struct ent, h);\n\telse\n\t\treturn NULL;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int         idtoname_parse(struct cache_detail *, char *, int);",
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static int         nametoid_parse(struct cache_detail *, char *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ch",
            "structent",
            "h"
          ],
          "line": 428
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sunrpc_cache_lookup",
          "args": [
            "cd",
            "&item->h",
            "nametoid_hash(item)"
          ],
          "line": 425
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nametoid_hash",
          "args": [
            "item"
          ],
          "line": 426
        },
        "resolved": true,
        "details": {
          "function_name": "nametoid_hash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
          "lines": "291-295",
          "snippet": "static inline int\nnametoid_hash(struct ent *ent)\n{\n\treturn hash_str(ent->name, ENT_HASHBITS);\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ENT_HASHBITS          8"
          ],
          "globals_used": [
            "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
            "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\n#define ENT_HASHBITS          8\n\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\n\nstatic inline int\nnametoid_hash(struct ent *ent)\n{\n\treturn hash_str(ent->name, ENT_HASHBITS);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic int         idtoname_parse(struct cache_detail *, char *, int);\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic int         nametoid_parse(struct cache_detail *, char *, int);\n\nstatic struct ent *\nnametoid_lookup(struct cache_detail *cd, struct ent *item)\n{\n\tstruct cache_head *ch = sunrpc_cache_lookup(cd, &item->h,\n\t\t\t\t\t\t    nametoid_hash(item));\n\tif (ch)\n\t\treturn container_of(ch, struct ent, h);\n\telse\n\t\treturn NULL;\n}"
  },
  {
    "function_name": "nametoid_parse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
    "lines": "359-419",
    "snippet": "static int\nnametoid_parse(struct cache_detail *cd, char *buf, int buflen)\n{\n\tstruct ent ent, *res;\n\tchar *buf1;\n\tint len, error = -EINVAL;\n\n\tif (buf[buflen - 1] != '\\n')\n\t\treturn (-EINVAL);\n\tbuf[buflen - 1]= '\\0';\n\n\tbuf1 = kmalloc(PAGE_SIZE, GFP_KERNEL);\n\tif (buf1 == NULL)\n\t\treturn (-ENOMEM);\n\n\tmemset(&ent, 0, sizeof(ent));\n\n\t/* Authentication name */\n\tlen = qword_get(&buf, buf1, PAGE_SIZE);\n\tif (len <= 0 || len >= IDMAP_NAMESZ)\n\t\tgoto out;\n\tmemcpy(ent.authname, buf1, sizeof(ent.authname));\n\n\t/* Type */\n\tif (qword_get(&buf, buf1, PAGE_SIZE) <= 0)\n\t\tgoto out;\n\tent.type = strcmp(buf1, \"user\") == 0 ?\n\t\tIDMAP_TYPE_USER : IDMAP_TYPE_GROUP;\n\n\t/* Name */\n\tlen = qword_get(&buf, buf1, PAGE_SIZE);\n\tif (len <= 0 || len >= IDMAP_NAMESZ)\n\t\tgoto out;\n\tmemcpy(ent.name, buf1, sizeof(ent.name));\n\n\t/* expiry */\n\tent.h.expiry_time = get_expiry(&buf);\n\tif (ent.h.expiry_time == 0)\n\t\tgoto out;\n\n\t/* ID */\n\terror = get_int(&buf, &ent.id);\n\tif (error == -EINVAL)\n\t\tgoto out;\n\tif (error == -ENOENT)\n\t\tset_bit(CACHE_NEGATIVE, &ent.h.flags);\n\n\terror = -ENOMEM;\n\tres = nametoid_lookup(cd, &ent);\n\tif (res == NULL)\n\t\tgoto out;\n\tres = nametoid_update(cd, &ent, res);\n\tif (res == NULL)\n\t\tgoto out;\n\n\tcache_put(&res->h, cd);\n\terror = 0;\nout:\n\tkfree(buf1);\n\treturn (error);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int         idtoname_parse(struct cache_detail *, char *, int);",
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static int         nametoid_parse(struct cache_detail *, char *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "buf1"
          ],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_put",
          "args": [
            "&res->h",
            "cd"
          ],
          "line": 414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nametoid_update",
          "args": [
            "cd",
            "&ent",
            "res"
          ],
          "line": 410
        },
        "resolved": true,
        "details": {
          "function_name": "nametoid_update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
          "lines": "433-442",
          "snippet": "static struct ent *\nnametoid_update(struct cache_detail *cd, struct ent *new, struct ent *old)\n{\n\tstruct cache_head *ch = sunrpc_cache_update(cd, &new->h, &old->h,\n\t\t\t\t\t\t    nametoid_hash(new));\n\tif (ch)\n\t\treturn container_of(ch, struct ent, h);\n\telse\n\t\treturn NULL;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int         idtoname_parse(struct cache_detail *, char *, int);",
            "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
            "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
            "static int         nametoid_parse(struct cache_detail *, char *, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic int         idtoname_parse(struct cache_detail *, char *, int);\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic int         nametoid_parse(struct cache_detail *, char *, int);\n\nstatic struct ent *\nnametoid_update(struct cache_detail *cd, struct ent *new, struct ent *old)\n{\n\tstruct cache_head *ch = sunrpc_cache_update(cd, &new->h, &old->h,\n\t\t\t\t\t\t    nametoid_hash(new));\n\tif (ch)\n\t\treturn container_of(ch, struct ent, h);\n\telse\n\t\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nametoid_lookup",
          "args": [
            "cd",
            "&ent"
          ],
          "line": 407
        },
        "resolved": true,
        "details": {
          "function_name": "nametoid_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
          "lines": "422-431",
          "snippet": "static struct ent *\nnametoid_lookup(struct cache_detail *cd, struct ent *item)\n{\n\tstruct cache_head *ch = sunrpc_cache_lookup(cd, &item->h,\n\t\t\t\t\t\t    nametoid_hash(item));\n\tif (ch)\n\t\treturn container_of(ch, struct ent, h);\n\telse\n\t\treturn NULL;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int         idtoname_parse(struct cache_detail *, char *, int);",
            "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
            "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
            "static int         nametoid_parse(struct cache_detail *, char *, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic int         idtoname_parse(struct cache_detail *, char *, int);\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic int         nametoid_parse(struct cache_detail *, char *, int);\n\nstatic struct ent *\nnametoid_lookup(struct cache_detail *cd, struct ent *item)\n{\n\tstruct cache_head *ch = sunrpc_cache_lookup(cd, &item->h,\n\t\t\t\t\t\t    nametoid_hash(item));\n\tif (ch)\n\t\treturn container_of(ch, struct ent, h);\n\telse\n\t\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "CACHE_NEGATIVE",
            "&ent.h.flags"
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_int",
          "args": [
            "&buf",
            "&ent.id"
          ],
          "line": 400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_expiry",
          "args": [
            "&buf"
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ent.name",
            "buf1",
            "sizeof(ent.name)"
          ],
          "line": 392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qword_get",
          "args": [
            "&buf",
            "buf1",
            "PAGE_SIZE"
          ],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "buf1",
            "\"user\""
          ],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qword_get",
          "args": [
            "&buf",
            "buf1",
            "PAGE_SIZE"
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ent.authname",
            "buf1",
            "sizeof(ent.authname)"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qword_get",
          "args": [
            "&buf",
            "buf1",
            "PAGE_SIZE"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&ent",
            "0",
            "sizeof(ent)"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "PAGE_SIZE",
            "GFP_KERNEL"
          ],
          "line": 370
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic int         idtoname_parse(struct cache_detail *, char *, int);\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic int         nametoid_parse(struct cache_detail *, char *, int);\n\nstatic int\nnametoid_parse(struct cache_detail *cd, char *buf, int buflen)\n{\n\tstruct ent ent, *res;\n\tchar *buf1;\n\tint len, error = -EINVAL;\n\n\tif (buf[buflen - 1] != '\\n')\n\t\treturn (-EINVAL);\n\tbuf[buflen - 1]= '\\0';\n\n\tbuf1 = kmalloc(PAGE_SIZE, GFP_KERNEL);\n\tif (buf1 == NULL)\n\t\treturn (-ENOMEM);\n\n\tmemset(&ent, 0, sizeof(ent));\n\n\t/* Authentication name */\n\tlen = qword_get(&buf, buf1, PAGE_SIZE);\n\tif (len <= 0 || len >= IDMAP_NAMESZ)\n\t\tgoto out;\n\tmemcpy(ent.authname, buf1, sizeof(ent.authname));\n\n\t/* Type */\n\tif (qword_get(&buf, buf1, PAGE_SIZE) <= 0)\n\t\tgoto out;\n\tent.type = strcmp(buf1, \"user\") == 0 ?\n\t\tIDMAP_TYPE_USER : IDMAP_TYPE_GROUP;\n\n\t/* Name */\n\tlen = qword_get(&buf, buf1, PAGE_SIZE);\n\tif (len <= 0 || len >= IDMAP_NAMESZ)\n\t\tgoto out;\n\tmemcpy(ent.name, buf1, sizeof(ent.name));\n\n\t/* expiry */\n\tent.h.expiry_time = get_expiry(&buf);\n\tif (ent.h.expiry_time == 0)\n\t\tgoto out;\n\n\t/* ID */\n\terror = get_int(&buf, &ent.id);\n\tif (error == -EINVAL)\n\t\tgoto out;\n\tif (error == -ENOENT)\n\t\tset_bit(CACHE_NEGATIVE, &ent.h.flags);\n\n\terror = -ENOMEM;\n\tres = nametoid_lookup(cd, &ent);\n\tif (res == NULL)\n\t\tgoto out;\n\tres = nametoid_update(cd, &ent, res);\n\tif (res == NULL)\n\t\tgoto out;\n\n\tcache_put(&res->h, cd);\n\terror = 0;\nout:\n\tkfree(buf1);\n\treturn (error);\n}"
  },
  {
    "function_name": "nametoid_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
    "lines": "320-337",
    "snippet": "static int\nnametoid_show(struct seq_file *m, struct cache_detail *cd, struct cache_head *h)\n{\n\tstruct ent *ent;\n\n\tif (h == NULL) {\n\t\tseq_puts(m, \"#domain type name [id]\\n\");\n\t\treturn 0;\n\t}\n\tent = container_of(h, struct ent, h);\n\tseq_printf(m, \"%s %s %s\", ent->authname,\n\t\t\tent->type == IDMAP_TYPE_GROUP ? \"group\" : \"user\",\n\t\t\tent->name);\n\tif (test_bit(CACHE_VALID, &h->flags))\n\t\tseq_printf(m, \" %u\", ent->id);\n\tseq_printf(m, \"\\n\");\n\treturn 0;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int         idtoname_parse(struct cache_detail *, char *, int);",
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static int         nametoid_parse(struct cache_detail *, char *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"\\n\""
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\" %u\"",
            "ent->id"
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "CACHE_VALID",
            "&h->flags"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"%s %s %s\"",
            "ent->authname",
            "ent->type == IDMAP_TYPE_GROUP ? \"group\" : \"user\"",
            "ent->name"
          ],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "h",
            "structent",
            "h"
          ],
          "line": 329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_puts",
          "args": [
            "m",
            "\"#domain type name [id]\\n\""
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic int         idtoname_parse(struct cache_detail *, char *, int);\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic int         nametoid_parse(struct cache_detail *, char *, int);\n\nstatic int\nnametoid_show(struct seq_file *m, struct cache_detail *cd, struct cache_head *h)\n{\n\tstruct ent *ent;\n\n\tif (h == NULL) {\n\t\tseq_puts(m, \"#domain type name [id]\\n\");\n\t\treturn 0;\n\t}\n\tent = container_of(h, struct ent, h);\n\tseq_printf(m, \"%s %s %s\", ent->authname,\n\t\t\tent->type == IDMAP_TYPE_GROUP ? \"group\" : \"user\",\n\t\t\tent->name);\n\tif (test_bit(CACHE_VALID, &h->flags))\n\t\tseq_printf(m, \" %u\", ent->id);\n\tseq_printf(m, \"\\n\");\n\treturn 0;\n}"
  },
  {
    "function_name": "nametoid_match",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
    "lines": "310-318",
    "snippet": "static int\nnametoid_match(struct cache_head *ca, struct cache_head *cb)\n{\n\tstruct ent *a = container_of(ca, struct ent, h);\n\tstruct ent *b = container_of(cb, struct ent, h);\n\n\treturn (a->type == b->type && strcmp(a->name, b->name) == 0 &&\n\t    strcmp(a->authname, b->authname) == 0);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "a->authname",
            "b->authname"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "a->name",
            "b->name"
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "cb",
            "structent",
            "h"
          ],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ca",
            "structent",
            "h"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\n\nstatic int\nnametoid_match(struct cache_head *ca, struct cache_head *cb)\n{\n\tstruct ent *a = container_of(ca, struct ent, h);\n\tstruct ent *b = container_of(cb, struct ent, h);\n\n\treturn (a->type == b->type && strcmp(a->name, b->name) == 0 &&\n\t    strcmp(a->authname, b->authname) == 0);\n}"
  },
  {
    "function_name": "nametoid_request",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
    "lines": "297-308",
    "snippet": "static void\nnametoid_request(struct cache_detail *cd, struct cache_head *ch, char **bpp,\n    int *blen)\n{\n \tstruct ent *ent = container_of(ch, struct ent, h);\n\n\tqword_add(bpp, blen, ent->authname);\n\tqword_add(bpp, blen, ent->type == IDMAP_TYPE_GROUP ? \"group\" : \"user\");\n\tqword_add(bpp, blen, ent->name);\n\n\t(*bpp)[-1] = '\\n';\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int         idtoname_parse(struct cache_detail *, char *, int);",
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static int         nametoid_parse(struct cache_detail *, char *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "qword_add",
          "args": [
            "bpp",
            "blen",
            "ent->name"
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qword_add",
          "args": [
            "bpp",
            "blen",
            "ent->type == IDMAP_TYPE_GROUP ? \"group\" : \"user\""
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qword_add",
          "args": [
            "bpp",
            "blen",
            "ent->authname"
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ch",
            "structent",
            "h"
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic int         idtoname_parse(struct cache_detail *, char *, int);\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic int         nametoid_parse(struct cache_detail *, char *, int);\n\nstatic void\nnametoid_request(struct cache_detail *cd, struct cache_head *ch, char **bpp,\n    int *blen)\n{\n \tstruct ent *ent = container_of(ch, struct ent, h);\n\n\tqword_add(bpp, blen, ent->authname);\n\tqword_add(bpp, blen, ent->type == IDMAP_TYPE_GROUP ? \"group\" : \"user\");\n\tqword_add(bpp, blen, ent->name);\n\n\t(*bpp)[-1] = '\\n';\n}"
  },
  {
    "function_name": "nametoid_hash",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
    "lines": "291-295",
    "snippet": "static inline int\nnametoid_hash(struct ent *ent)\n{\n\treturn hash_str(ent->name, ENT_HASHBITS);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define ENT_HASHBITS          8"
    ],
    "globals_used": [
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "hash_str",
          "args": [
            "ent->name",
            "ENT_HASHBITS"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\n#define ENT_HASHBITS          8\n\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\n\nstatic inline int\nnametoid_hash(struct ent *ent)\n{\n\treturn hash_str(ent->name, ENT_HASHBITS);\n}"
  },
  {
    "function_name": "idtoname_update",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
    "lines": "275-284",
    "snippet": "static struct ent *\nidtoname_update(struct cache_detail *cd, struct ent *new, struct ent *old)\n{\n\tstruct cache_head *ch = sunrpc_cache_update(cd, &new->h, &old->h,\n\t\t\t\t\t\t    idtoname_hash(new));\n\tif (ch)\n\t\treturn container_of(ch, struct ent, h);\n\telse\n\t\treturn NULL;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int         idtoname_parse(struct cache_detail *, char *, int);",
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static int         nametoid_parse(struct cache_detail *, char *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ch",
            "structent",
            "h"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sunrpc_cache_update",
          "args": [
            "cd",
            "&new->h",
            "&old->h",
            "idtoname_hash(new)"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "idtoname_hash",
          "args": [
            "new"
          ],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "idtoname_hash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
          "lines": "109-122",
          "snippet": "static uint32_t\nidtoname_hash(struct ent *ent)\n{\n\tuint32_t hash;\n\n\thash = hash_str(ent->authname, ENT_HASHBITS);\n\thash = hash_long(hash ^ ent->id, ENT_HASHBITS);\n\n\t/* Flip LSB for user/group */\n\tif (ent->type == IDMAP_TYPE_GROUP)\n\t\thash ^= 1;\n\n\treturn hash;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ENT_HASHBITS          8"
          ],
          "globals_used": [
            "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
            "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\n#define ENT_HASHBITS          8\n\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\n\nstatic uint32_t\nidtoname_hash(struct ent *ent)\n{\n\tuint32_t hash;\n\n\thash = hash_str(ent->authname, ENT_HASHBITS);\n\thash = hash_long(hash ^ ent->id, ENT_HASHBITS);\n\n\t/* Flip LSB for user/group */\n\tif (ent->type == IDMAP_TYPE_GROUP)\n\t\thash ^= 1;\n\n\treturn hash;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic int         idtoname_parse(struct cache_detail *, char *, int);\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic int         nametoid_parse(struct cache_detail *, char *, int);\n\nstatic struct ent *\nidtoname_update(struct cache_detail *cd, struct ent *new, struct ent *old)\n{\n\tstruct cache_head *ch = sunrpc_cache_update(cd, &new->h, &old->h,\n\t\t\t\t\t\t    idtoname_hash(new));\n\tif (ch)\n\t\treturn container_of(ch, struct ent, h);\n\telse\n\t\treturn NULL;\n}"
  },
  {
    "function_name": "idtoname_lookup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
    "lines": "264-273",
    "snippet": "static struct ent *\nidtoname_lookup(struct cache_detail *cd, struct ent *item)\n{\n\tstruct cache_head *ch = sunrpc_cache_lookup(cd, &item->h,\n\t\t\t\t\t\t    idtoname_hash(item));\n\tif (ch)\n\t\treturn container_of(ch, struct ent, h);\n\telse\n\t\treturn NULL;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int         idtoname_parse(struct cache_detail *, char *, int);",
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static int         nametoid_parse(struct cache_detail *, char *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ch",
            "structent",
            "h"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sunrpc_cache_lookup",
          "args": [
            "cd",
            "&item->h",
            "idtoname_hash(item)"
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "idtoname_hash",
          "args": [
            "item"
          ],
          "line": 268
        },
        "resolved": true,
        "details": {
          "function_name": "idtoname_hash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
          "lines": "109-122",
          "snippet": "static uint32_t\nidtoname_hash(struct ent *ent)\n{\n\tuint32_t hash;\n\n\thash = hash_str(ent->authname, ENT_HASHBITS);\n\thash = hash_long(hash ^ ent->id, ENT_HASHBITS);\n\n\t/* Flip LSB for user/group */\n\tif (ent->type == IDMAP_TYPE_GROUP)\n\t\thash ^= 1;\n\n\treturn hash;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [
            "#define ENT_HASHBITS          8"
          ],
          "globals_used": [
            "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
            "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\n#define ENT_HASHBITS          8\n\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\n\nstatic uint32_t\nidtoname_hash(struct ent *ent)\n{\n\tuint32_t hash;\n\n\thash = hash_str(ent->authname, ENT_HASHBITS);\n\thash = hash_long(hash ^ ent->id, ENT_HASHBITS);\n\n\t/* Flip LSB for user/group */\n\tif (ent->type == IDMAP_TYPE_GROUP)\n\t\thash ^= 1;\n\n\treturn hash;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic int         idtoname_parse(struct cache_detail *, char *, int);\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic int         nametoid_parse(struct cache_detail *, char *, int);\n\nstatic struct ent *\nidtoname_lookup(struct cache_detail *cd, struct ent *item)\n{\n\tstruct cache_head *ch = sunrpc_cache_lookup(cd, &item->h,\n\t\t\t\t\t\t    idtoname_hash(item));\n\tif (ch)\n\t\treturn container_of(ch, struct ent, h);\n\telse\n\t\treturn NULL;\n}"
  },
  {
    "function_name": "idtoname_parse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
    "lines": "196-262",
    "snippet": "static int\nidtoname_parse(struct cache_detail *cd, char *buf, int buflen)\n{\n\tstruct ent ent, *res;\n\tchar *buf1, *bp;\n\tint len;\n\tint error = -EINVAL;\n\n\tif (buf[buflen - 1] != '\\n')\n\t\treturn (-EINVAL);\n\tbuf[buflen - 1]= '\\0';\n\n\tbuf1 = kmalloc(PAGE_SIZE, GFP_KERNEL);\n\tif (buf1 == NULL)\n\t\treturn (-ENOMEM);\n\n\tmemset(&ent, 0, sizeof(ent));\n\n\t/* Authentication name */\n\tlen = qword_get(&buf, buf1, PAGE_SIZE);\n\tif (len <= 0 || len >= IDMAP_NAMESZ)\n\t\tgoto out;\n\tmemcpy(ent.authname, buf1, sizeof(ent.authname));\n\n\t/* Type */\n\tif (qword_get(&buf, buf1, PAGE_SIZE) <= 0)\n\t\tgoto out;\n\tent.type = strcmp(buf1, \"user\") == 0 ?\n\t\tIDMAP_TYPE_USER : IDMAP_TYPE_GROUP;\n\n\t/* ID */\n\tif (qword_get(&buf, buf1, PAGE_SIZE) <= 0)\n\t\tgoto out;\n\tent.id = simple_strtoul(buf1, &bp, 10);\n\tif (bp == buf1)\n\t\tgoto out;\n\n\t/* expiry */\n\tent.h.expiry_time = get_expiry(&buf);\n\tif (ent.h.expiry_time == 0)\n\t\tgoto out;\n\n\terror = -ENOMEM;\n\tres = idtoname_lookup(cd, &ent);\n\tif (!res)\n\t\tgoto out;\n\n\t/* Name */\n\terror = -EINVAL;\n\tlen = qword_get(&buf, buf1, PAGE_SIZE);\n\tif (len < 0 || len >= IDMAP_NAMESZ)\n\t\tgoto out;\n\tif (len == 0)\n\t\tset_bit(CACHE_NEGATIVE, &ent.h.flags);\n\telse\n\t\tmemcpy(ent.name, buf1, sizeof(ent.name));\n\terror = -ENOMEM;\n\tres = idtoname_update(cd, &ent, res);\n\tif (res == NULL)\n\t\tgoto out;\n\n\tcache_put(&res->h, cd);\n\terror = 0;\nout:\n\tkfree(buf1);\n\treturn error;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int         idtoname_parse(struct cache_detail *, char *, int);",
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static int         nametoid_parse(struct cache_detail *, char *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "buf1"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cache_put",
          "args": [
            "&res->h",
            "cd"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "idtoname_update",
          "args": [
            "cd",
            "&ent",
            "res"
          ],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "idtoname_update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
          "lines": "275-284",
          "snippet": "static struct ent *\nidtoname_update(struct cache_detail *cd, struct ent *new, struct ent *old)\n{\n\tstruct cache_head *ch = sunrpc_cache_update(cd, &new->h, &old->h,\n\t\t\t\t\t\t    idtoname_hash(new));\n\tif (ch)\n\t\treturn container_of(ch, struct ent, h);\n\telse\n\t\treturn NULL;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int         idtoname_parse(struct cache_detail *, char *, int);",
            "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
            "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
            "static int         nametoid_parse(struct cache_detail *, char *, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic int         idtoname_parse(struct cache_detail *, char *, int);\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic int         nametoid_parse(struct cache_detail *, char *, int);\n\nstatic struct ent *\nidtoname_update(struct cache_detail *cd, struct ent *new, struct ent *old)\n{\n\tstruct cache_head *ch = sunrpc_cache_update(cd, &new->h, &old->h,\n\t\t\t\t\t\t    idtoname_hash(new));\n\tif (ch)\n\t\treturn container_of(ch, struct ent, h);\n\telse\n\t\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ent.name",
            "buf1",
            "sizeof(ent.name)"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_bit",
          "args": [
            "CACHE_NEGATIVE",
            "&ent.h.flags"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qword_get",
          "args": [
            "&buf",
            "buf1",
            "PAGE_SIZE"
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "idtoname_lookup",
          "args": [
            "cd",
            "&ent"
          ],
          "line": 239
        },
        "resolved": true,
        "details": {
          "function_name": "idtoname_lookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
          "lines": "264-273",
          "snippet": "static struct ent *\nidtoname_lookup(struct cache_detail *cd, struct ent *item)\n{\n\tstruct cache_head *ch = sunrpc_cache_lookup(cd, &item->h,\n\t\t\t\t\t\t    idtoname_hash(item));\n\tif (ch)\n\t\treturn container_of(ch, struct ent, h);\n\telse\n\t\treturn NULL;\n}",
          "includes": [
            "#include \"netns.h\"",
            "#include \"nfsd.h\"",
            "#include \"idmap.h\"",
            "#include <net/net_namespace.h>",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int         idtoname_parse(struct cache_detail *, char *, int);",
            "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
            "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
            "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
            "static int         nametoid_parse(struct cache_detail *, char *, int);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic int         idtoname_parse(struct cache_detail *, char *, int);\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic int         nametoid_parse(struct cache_detail *, char *, int);\n\nstatic struct ent *\nidtoname_lookup(struct cache_detail *cd, struct ent *item)\n{\n\tstruct cache_head *ch = sunrpc_cache_lookup(cd, &item->h,\n\t\t\t\t\t\t    idtoname_hash(item));\n\tif (ch)\n\t\treturn container_of(ch, struct ent, h);\n\telse\n\t\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_expiry",
          "args": [
            "&buf"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "simple_strtoul",
          "args": [
            "buf1",
            "&bp",
            "10"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qword_get",
          "args": [
            "&buf",
            "buf1",
            "PAGE_SIZE"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "buf1",
            "\"user\""
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qword_get",
          "args": [
            "&buf",
            "buf1",
            "PAGE_SIZE"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ent.authname",
            "buf1",
            "sizeof(ent.authname)"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qword_get",
          "args": [
            "&buf",
            "buf1",
            "PAGE_SIZE"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&ent",
            "0",
            "sizeof(ent)"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "PAGE_SIZE",
            "GFP_KERNEL"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic int         idtoname_parse(struct cache_detail *, char *, int);\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic int         nametoid_parse(struct cache_detail *, char *, int);\n\nstatic int\nidtoname_parse(struct cache_detail *cd, char *buf, int buflen)\n{\n\tstruct ent ent, *res;\n\tchar *buf1, *bp;\n\tint len;\n\tint error = -EINVAL;\n\n\tif (buf[buflen - 1] != '\\n')\n\t\treturn (-EINVAL);\n\tbuf[buflen - 1]= '\\0';\n\n\tbuf1 = kmalloc(PAGE_SIZE, GFP_KERNEL);\n\tif (buf1 == NULL)\n\t\treturn (-ENOMEM);\n\n\tmemset(&ent, 0, sizeof(ent));\n\n\t/* Authentication name */\n\tlen = qword_get(&buf, buf1, PAGE_SIZE);\n\tif (len <= 0 || len >= IDMAP_NAMESZ)\n\t\tgoto out;\n\tmemcpy(ent.authname, buf1, sizeof(ent.authname));\n\n\t/* Type */\n\tif (qword_get(&buf, buf1, PAGE_SIZE) <= 0)\n\t\tgoto out;\n\tent.type = strcmp(buf1, \"user\") == 0 ?\n\t\tIDMAP_TYPE_USER : IDMAP_TYPE_GROUP;\n\n\t/* ID */\n\tif (qword_get(&buf, buf1, PAGE_SIZE) <= 0)\n\t\tgoto out;\n\tent.id = simple_strtoul(buf1, &bp, 10);\n\tif (bp == buf1)\n\t\tgoto out;\n\n\t/* expiry */\n\tent.h.expiry_time = get_expiry(&buf);\n\tif (ent.h.expiry_time == 0)\n\t\tgoto out;\n\n\terror = -ENOMEM;\n\tres = idtoname_lookup(cd, &ent);\n\tif (!res)\n\t\tgoto out;\n\n\t/* Name */\n\terror = -EINVAL;\n\tlen = qword_get(&buf, buf1, PAGE_SIZE);\n\tif (len < 0 || len >= IDMAP_NAMESZ)\n\t\tgoto out;\n\tif (len == 0)\n\t\tset_bit(CACHE_NEGATIVE, &ent.h.flags);\n\telse\n\t\tmemcpy(ent.name, buf1, sizeof(ent.name));\n\terror = -ENOMEM;\n\tres = idtoname_update(cd, &ent, res);\n\tif (res == NULL)\n\t\tgoto out;\n\n\tcache_put(&res->h, cd);\n\terror = 0;\nout:\n\tkfree(buf1);\n\treturn error;\n}"
  },
  {
    "function_name": "warn_no_idmapd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
    "lines": "168-173",
    "snippet": "static void\nwarn_no_idmapd(struct cache_detail *detail, int has_died)\n{\n\tprintk(\"nfsd: nfsv4 idmapping failing: has idmapd %s?\\n\",\n\t\t\thas_died ? \"died\" : \"not been started\");\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int         idtoname_parse(struct cache_detail *, char *, int);",
      "static int         nametoid_parse(struct cache_detail *, char *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"nfsd: nfsv4 idmapping failing: has idmapd %s?\\n\"",
            "has_died ? \"died\" : \"not been started\""
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic int         idtoname_parse(struct cache_detail *, char *, int);\nstatic int         nametoid_parse(struct cache_detail *, char *, int);\n\nstatic void\nwarn_no_idmapd(struct cache_detail *detail, int has_died)\n{\n\tprintk(\"nfsd: nfsv4 idmapping failing: has idmapd %s?\\n\",\n\t\t\thas_died ? \"died\" : \"not been started\");\n}"
  },
  {
    "function_name": "idtoname_show",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
    "lines": "149-166",
    "snippet": "static int\nidtoname_show(struct seq_file *m, struct cache_detail *cd, struct cache_head *h)\n{\n\tstruct ent *ent;\n\n\tif (h == NULL) {\n\t\tseq_puts(m, \"#domain type id [name]\\n\");\n\t\treturn 0;\n\t}\n\tent = container_of(h, struct ent, h);\n\tseq_printf(m, \"%s %s %u\", ent->authname,\n\t\t\tent->type == IDMAP_TYPE_GROUP ? \"group\" : \"user\",\n\t\t\tent->id);\n\tif (test_bit(CACHE_VALID, &h->flags))\n\t\tseq_printf(m, \" %s\", ent->name);\n\tseq_printf(m, \"\\n\");\n\treturn 0;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int         idtoname_parse(struct cache_detail *, char *, int);",
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static int         nametoid_parse(struct cache_detail *, char *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"\\n\""
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\" %s\"",
            "ent->name"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "CACHE_VALID",
            "&h->flags"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_printf",
          "args": [
            "m",
            "\"%s %s %u\"",
            "ent->authname",
            "ent->type == IDMAP_TYPE_GROUP ? \"group\" : \"user\"",
            "ent->id"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "h",
            "structent",
            "h"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq_puts",
          "args": [
            "m",
            "\"#domain type id [name]\\n\""
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic int         idtoname_parse(struct cache_detail *, char *, int);\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic int         nametoid_parse(struct cache_detail *, char *, int);\n\nstatic int\nidtoname_show(struct seq_file *m, struct cache_detail *cd, struct cache_head *h)\n{\n\tstruct ent *ent;\n\n\tif (h == NULL) {\n\t\tseq_puts(m, \"#domain type id [name]\\n\");\n\t\treturn 0;\n\t}\n\tent = container_of(h, struct ent, h);\n\tseq_printf(m, \"%s %s %u\", ent->authname,\n\t\t\tent->type == IDMAP_TYPE_GROUP ? \"group\" : \"user\",\n\t\t\tent->id);\n\tif (test_bit(CACHE_VALID, &h->flags))\n\t\tseq_printf(m, \" %s\", ent->name);\n\tseq_printf(m, \"\\n\");\n\treturn 0;\n}"
  },
  {
    "function_name": "idtoname_match",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
    "lines": "139-147",
    "snippet": "static int\nidtoname_match(struct cache_head *ca, struct cache_head *cb)\n{\n\tstruct ent *a = container_of(ca, struct ent, h);\n\tstruct ent *b = container_of(cb, struct ent, h);\n\n\treturn (a->id == b->id && a->type == b->type &&\n\t    strcmp(a->authname, b->authname) == 0);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "a->authname",
            "b->authname"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "cb",
            "structent",
            "h"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ca",
            "structent",
            "h"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\n\nstatic int\nidtoname_match(struct cache_head *ca, struct cache_head *cb)\n{\n\tstruct ent *a = container_of(ca, struct ent, h);\n\tstruct ent *b = container_of(cb, struct ent, h);\n\n\treturn (a->id == b->id && a->type == b->type &&\n\t    strcmp(a->authname, b->authname) == 0);\n}"
  },
  {
    "function_name": "idtoname_request",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
    "lines": "124-137",
    "snippet": "static void\nidtoname_request(struct cache_detail *cd, struct cache_head *ch, char **bpp,\n    int *blen)\n{\n \tstruct ent *ent = container_of(ch, struct ent, h);\n\tchar idstr[11];\n\n\tqword_add(bpp, blen, ent->authname);\n\tsnprintf(idstr, sizeof(idstr), \"%u\", ent->id);\n\tqword_add(bpp, blen, ent->type == IDMAP_TYPE_GROUP ? \"group\" : \"user\");\n\tqword_add(bpp, blen, idstr);\n\n\t(*bpp)[-1] = '\\n';\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int         idtoname_parse(struct cache_detail *, char *, int);",
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static int         nametoid_parse(struct cache_detail *, char *, int);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "qword_add",
          "args": [
            "bpp",
            "blen",
            "idstr"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qword_add",
          "args": [
            "bpp",
            "blen",
            "ent->type == IDMAP_TYPE_GROUP ? \"group\" : \"user\""
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "idstr",
            "sizeof(idstr)",
            "\"%u\"",
            "ent->id"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qword_add",
          "args": [
            "bpp",
            "blen",
            "ent->authname"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ch",
            "structent",
            "h"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic int         idtoname_parse(struct cache_detail *, char *, int);\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic int         nametoid_parse(struct cache_detail *, char *, int);\n\nstatic void\nidtoname_request(struct cache_detail *cd, struct cache_head *ch, char **bpp,\n    int *blen)\n{\n \tstruct ent *ent = container_of(ch, struct ent, h);\n\tchar idstr[11];\n\n\tqword_add(bpp, blen, ent->authname);\n\tsnprintf(idstr, sizeof(idstr), \"%u\", ent->id);\n\tqword_add(bpp, blen, ent->type == IDMAP_TYPE_GROUP ? \"group\" : \"user\");\n\tqword_add(bpp, blen, idstr);\n\n\t(*bpp)[-1] = '\\n';\n}"
  },
  {
    "function_name": "idtoname_hash",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
    "lines": "109-122",
    "snippet": "static uint32_t\nidtoname_hash(struct ent *ent)\n{\n\tuint32_t hash;\n\n\thash = hash_str(ent->authname, ENT_HASHBITS);\n\thash = hash_long(hash ^ ent->id, ENT_HASHBITS);\n\n\t/* Flip LSB for user/group */\n\tif (ent->type == IDMAP_TYPE_GROUP)\n\t\thash ^= 1;\n\n\treturn hash;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [
      "#define ENT_HASHBITS          8"
    ],
    "globals_used": [
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "hash_long",
          "args": [
            "hash ^ ent->id",
            "ENT_HASHBITS"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hash_str",
          "args": [
            "ent->authname",
            "ENT_HASHBITS"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\n#define ENT_HASHBITS          8\n\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\n\nstatic uint32_t\nidtoname_hash(struct ent *ent)\n{\n\tuint32_t hash;\n\n\thash = hash_str(ent->authname, ENT_HASHBITS);\n\thash = hash_long(hash ^ ent->id, ENT_HASHBITS);\n\n\t/* Flip LSB for user/group */\n\tif (ent->type == IDMAP_TYPE_GROUP)\n\t\thash ^= 1;\n\n\treturn hash;\n}"
  },
  {
    "function_name": "ent_alloc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
    "lines": "95-103",
    "snippet": "static struct cache_head *\nent_alloc(void)\n{\n\tstruct ent *e = kmalloc(sizeof(*e), GFP_KERNEL);\n\tif (e)\n\t\treturn &e->h;\n\telse\n\t\treturn NULL;\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "sizeof(*e)",
            "GFP_KERNEL"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\n\nstatic struct cache_head *\nent_alloc(void)\n{\n\tstruct ent *e = kmalloc(sizeof(*e), GFP_KERNEL);\n\tif (e)\n\t\treturn &e->h;\n\telse\n\t\treturn NULL;\n}"
  },
  {
    "function_name": "ent_put",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
    "lines": "88-93",
    "snippet": "static void\nent_put(struct kref *ref)\n{\n\tstruct ent *map = container_of(ref, struct ent, h.ref);\n\tkfree(map);\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "map"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "ref",
            "structent",
            "h.ref"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\n\nstatic void\nent_put(struct kref *ref)\n{\n\tstruct ent *map = container_of(ref, struct ent, h.ref);\n\tkfree(map);\n}"
  },
  {
    "function_name": "ent_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs4idmap.c",
    "lines": "75-86",
    "snippet": "static void\nent_init(struct cache_head *cnew, struct cache_head *citm)\n{\n\tstruct ent *new = container_of(cnew, struct ent, h);\n\tstruct ent *itm = container_of(citm, struct ent, h);\n\n\tnew->id = itm->id;\n\tnew->type = itm->type;\n\n\tstrlcpy(new->name, itm->name, sizeof(new->name));\n\tstrlcpy(new->authname, itm->authname, sizeof(new->name));\n}",
    "includes": [
      "#include \"netns.h\"",
      "#include \"nfsd.h\"",
      "#include \"idmap.h\"",
      "#include <net/net_namespace.h>",
      "#include <linux/sunrpc/svc_xprt.h>",
      "#include <linux/slab.h>",
      "#include <linux/sched.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/module.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct ent *idtoname_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);",
      "static struct ent *nametoid_lookup(struct cache_detail *, struct ent *);",
      "static struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strlcpy",
          "args": [
            "new->authname",
            "itm->authname",
            "sizeof(new->name)"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlcpy",
          "args": [
            "new->name",
            "itm->name",
            "sizeof(new->name)"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "citm",
            "structent",
            "h"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "cnew",
            "structent",
            "h"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"netns.h\"\n#include \"nfsd.h\"\n#include \"idmap.h\"\n#include <net/net_namespace.h>\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/slab.h>\n#include <linux/sched.h>\n#include <linux/seq_file.h>\n#include <linux/module.h>\n\nstatic struct ent *idtoname_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *idtoname_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\nstatic struct ent *nametoid_lookup(struct cache_detail *, struct ent *);\nstatic struct ent *nametoid_update(struct cache_detail *, struct ent *,\n\t\t\t\t   struct ent *);\n\nstatic void\nent_init(struct cache_head *cnew, struct cache_head *citm)\n{\n\tstruct ent *new = container_of(cnew, struct ent, h);\n\tstruct ent *itm = container_of(citm, struct ent, h);\n\n\tnew->id = itm->id;\n\tnew->type = itm->type;\n\n\tstrlcpy(new->name, itm->name, sizeof(new->name));\n\tstrlcpy(new->authname, itm->authname, sizeof(new->name));\n}"
  }
]