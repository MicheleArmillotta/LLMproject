[
  {
    "function_name": "fh_unlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfsfh.h",
    "lines": "305-313",
    "snippet": "static inline void\nfh_unlock(struct svc_fh *fhp)\n{\n\tif (fhp->fh_locked) {\n\t\tfill_post_wcc(fhp);\n\t\tinode_unlock(d_inode(fhp->fh_dentry));\n\t\tfhp->fh_locked = false;\n\t}\n}",
    "includes": [
      "#include <uapi/linux/nfsd/nfsfh.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/crc32.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "inode_unlock",
          "args": [
            "d_inode(fhp->fh_dentry)"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "d_inode",
          "args": [
            "fhp->fh_dentry"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fill_post_wcc",
          "args": [
            "fhp"
          ],
          "line": 309
        },
        "resolved": true,
        "details": {
          "function_name": "fill_post_wcc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfs3xdr.c",
          "lines": "255-270",
          "snippet": "void fill_post_wcc(struct svc_fh *fhp)\n{\n\t__be32 err;\n\n\tif (fhp->fh_post_saved)\n\t\tprintk(\"nfsd: inode locked twice during operation.\\n\");\n\n\terr = fh_getattr(fhp, &fhp->fh_post_attr);\n\tfhp->fh_post_change = d_inode(fhp->fh_dentry)->i_version;\n\tif (err) {\n\t\tfhp->fh_post_saved = false;\n\t\t/* Grab the ctime anyway - set_change_info might use it */\n\t\tfhp->fh_post_attr.ctime = d_inode(fhp->fh_dentry)->i_ctime;\n\t} else\n\t\tfhp->fh_post_saved = true;\n}",
          "includes": [
            "#include \"vfs.h\"",
            "#include \"netns.h\"",
            "#include \"auth.h\"",
            "#include \"xdr3.h\"",
            "#include <linux/sunrpc/svc_xprt.h>",
            "#include <linux/namei.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vfs.h\"\n#include \"netns.h\"\n#include \"auth.h\"\n#include \"xdr3.h\"\n#include <linux/sunrpc/svc_xprt.h>\n#include <linux/namei.h>\n\nvoid fill_post_wcc(struct svc_fh *fhp)\n{\n\t__be32 err;\n\n\tif (fhp->fh_post_saved)\n\t\tprintk(\"nfsd: inode locked twice during operation.\\n\");\n\n\terr = fh_getattr(fhp, &fhp->fh_post_attr);\n\tfhp->fh_post_change = d_inode(fhp->fh_dentry)->i_version;\n\tif (err) {\n\t\tfhp->fh_post_saved = false;\n\t\t/* Grab the ctime anyway - set_change_info might use it */\n\t\tfhp->fh_post_attr.ctime = d_inode(fhp->fh_dentry)->i_ctime;\n\t} else\n\t\tfhp->fh_post_saved = true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfsd/nfsfh.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/crc32.h>\n\nstatic inline void\nfh_unlock(struct svc_fh *fhp)\n{\n\tif (fhp->fh_locked) {\n\t\tfill_post_wcc(fhp);\n\t\tinode_unlock(d_inode(fhp->fh_dentry));\n\t\tfhp->fh_locked = false;\n\t}\n}"
  },
  {
    "function_name": "fh_lock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfsfh.h",
    "lines": "296-300",
    "snippet": "static inline void\nfh_lock(struct svc_fh *fhp)\n{\n\tfh_lock_nested(fhp, I_MUTEX_NORMAL);\n}",
    "includes": [
      "#include <uapi/linux/nfsd/nfsfh.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/crc32.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fh_lock_nested",
          "args": [
            "fhp",
            "I_MUTEX_NORMAL"
          ],
          "line": 299
        },
        "resolved": true,
        "details": {
          "function_name": "fh_lock_nested",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfsfh.h",
          "lines": "276-294",
          "snippet": "static inline void\nfh_lock_nested(struct svc_fh *fhp, unsigned int subclass)\n{\n\tstruct dentry\t*dentry = fhp->fh_dentry;\n\tstruct inode\t*inode;\n\n\tBUG_ON(!dentry);\n\n\tif (fhp->fh_locked) {\n\t\tprintk(KERN_WARNING \"fh_lock: %pd2 already locked!\\n\",\n\t\t\tdentry);\n\t\treturn;\n\t}\n\n\tinode = d_inode(dentry);\n\tinode_lock_nested(inode, subclass);\n\tfill_pre_wcc(fhp);\n\tfhp->fh_locked = true;\n}",
          "includes": [
            "#include <uapi/linux/nfsd/nfsfh.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/crc32.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfsd/nfsfh.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/crc32.h>\n\nstatic inline void\nfh_lock_nested(struct svc_fh *fhp, unsigned int subclass)\n{\n\tstruct dentry\t*dentry = fhp->fh_dentry;\n\tstruct inode\t*inode;\n\n\tBUG_ON(!dentry);\n\n\tif (fhp->fh_locked) {\n\t\tprintk(KERN_WARNING \"fh_lock: %pd2 already locked!\\n\",\n\t\t\tdentry);\n\t\treturn;\n\t}\n\n\tinode = d_inode(dentry);\n\tinode_lock_nested(inode, subclass);\n\tfill_pre_wcc(fhp);\n\tfhp->fh_locked = true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfsd/nfsfh.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/crc32.h>\n\nstatic inline void\nfh_lock(struct svc_fh *fhp)\n{\n\tfh_lock_nested(fhp, I_MUTEX_NORMAL);\n}"
  },
  {
    "function_name": "fh_lock_nested",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfsfh.h",
    "lines": "276-294",
    "snippet": "static inline void\nfh_lock_nested(struct svc_fh *fhp, unsigned int subclass)\n{\n\tstruct dentry\t*dentry = fhp->fh_dentry;\n\tstruct inode\t*inode;\n\n\tBUG_ON(!dentry);\n\n\tif (fhp->fh_locked) {\n\t\tprintk(KERN_WARNING \"fh_lock: %pd2 already locked!\\n\",\n\t\t\tdentry);\n\t\treturn;\n\t}\n\n\tinode = d_inode(dentry);\n\tinode_lock_nested(inode, subclass);\n\tfill_pre_wcc(fhp);\n\tfhp->fh_locked = true;\n}",
    "includes": [
      "#include <uapi/linux/nfsd/nfsfh.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/crc32.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fill_pre_wcc",
          "args": [
            "fhp"
          ],
          "line": 292
        },
        "resolved": true,
        "details": {
          "function_name": "fill_pre_wcc",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfsfh.h",
          "lines": "246-259",
          "snippet": "static inline void\nfill_pre_wcc(struct svc_fh *fhp)\n{\n\tstruct inode    *inode;\n\n\tinode = d_inode(fhp->fh_dentry);\n\tif (!fhp->fh_pre_saved) {\n\t\tfhp->fh_pre_mtime = inode->i_mtime;\n\t\tfhp->fh_pre_ctime = inode->i_ctime;\n\t\tfhp->fh_pre_size  = inode->i_size;\n\t\tfhp->fh_pre_change = inode->i_version;\n\t\tfhp->fh_pre_saved = true;\n\t}\n}",
          "includes": [
            "#include <uapi/linux/nfsd/nfsfh.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/crc32.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfsd/nfsfh.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/crc32.h>\n\nstatic inline void\nfill_pre_wcc(struct svc_fh *fhp)\n{\n\tstruct inode    *inode;\n\n\tinode = d_inode(fhp->fh_dentry);\n\tif (!fhp->fh_pre_saved) {\n\t\tfhp->fh_pre_mtime = inode->i_mtime;\n\t\tfhp->fh_pre_ctime = inode->i_ctime;\n\t\tfhp->fh_pre_size  = inode->i_size;\n\t\tfhp->fh_pre_change = inode->i_version;\n\t\tfhp->fh_pre_saved = true;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "inode_lock_nested",
          "args": [
            "inode",
            "subclass"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "d_inode",
          "args": [
            "dentry"
          ],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "KERN_WARNING \"fh_lock: %pd2 already locked!\\n\"",
            "dentry"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "!dentry"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfsd/nfsfh.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/crc32.h>\n\nstatic inline void\nfh_lock_nested(struct svc_fh *fhp, unsigned int subclass)\n{\n\tstruct dentry\t*dentry = fhp->fh_dentry;\n\tstruct inode\t*inode;\n\n\tBUG_ON(!dentry);\n\n\tif (fhp->fh_locked) {\n\t\tprintk(KERN_WARNING \"fh_lock: %pd2 already locked!\\n\",\n\t\t\tdentry);\n\t\treturn;\n\t}\n\n\tinode = d_inode(dentry);\n\tinode_lock_nested(inode, subclass);\n\tfill_pre_wcc(fhp);\n\tfhp->fh_locked = true;\n}"
  },
  {
    "function_name": "fill_pre_wcc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfsfh.h",
    "lines": "246-259",
    "snippet": "static inline void\nfill_pre_wcc(struct svc_fh *fhp)\n{\n\tstruct inode    *inode;\n\n\tinode = d_inode(fhp->fh_dentry);\n\tif (!fhp->fh_pre_saved) {\n\t\tfhp->fh_pre_mtime = inode->i_mtime;\n\t\tfhp->fh_pre_ctime = inode->i_ctime;\n\t\tfhp->fh_pre_size  = inode->i_size;\n\t\tfhp->fh_pre_change = inode->i_version;\n\t\tfhp->fh_pre_saved = true;\n\t}\n}",
    "includes": [
      "#include <uapi/linux/nfsd/nfsfh.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/crc32.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "d_inode",
          "args": [
            "fhp->fh_dentry"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfsd/nfsfh.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/crc32.h>\n\nstatic inline void\nfill_pre_wcc(struct svc_fh *fhp)\n{\n\tstruct inode    *inode;\n\n\tinode = d_inode(fhp->fh_dentry);\n\tif (!fhp->fh_pre_saved) {\n\t\tfhp->fh_pre_mtime = inode->i_mtime;\n\t\tfhp->fh_pre_ctime = inode->i_ctime;\n\t\tfhp->fh_pre_size  = inode->i_size;\n\t\tfhp->fh_pre_change = inode->i_version;\n\t\tfhp->fh_pre_saved = true;\n\t}\n}"
  },
  {
    "function_name": "fh_clear_wcc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfsfh.h",
    "lines": "236-241",
    "snippet": "static inline void\nfh_clear_wcc(struct svc_fh *fhp)\n{\n\tfhp->fh_post_saved = false;\n\tfhp->fh_pre_saved = false;\n}",
    "includes": [
      "#include <uapi/linux/nfsd/nfsfh.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/crc32.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <uapi/linux/nfsd/nfsfh.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/crc32.h>\n\nstatic inline void\nfh_clear_wcc(struct svc_fh *fhp)\n{\n\tfhp->fh_post_saved = false;\n\tfhp->fh_pre_saved = false;\n}"
  },
  {
    "function_name": "knfsd_fh_hash",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfsfh.h",
    "lines": "224-228",
    "snippet": "static inline u32\nknfsd_fh_hash(struct knfsd_fh *fh)\n{\n\treturn 0;\n}",
    "includes": [
      "#include <uapi/linux/nfsd/nfsfh.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/crc32.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <uapi/linux/nfsd/nfsfh.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/crc32.h>\n\nstatic inline u32\nknfsd_fh_hash(struct knfsd_fh *fh)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "knfsd_fh_hash",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfsfh.h",
    "lines": "218-222",
    "snippet": "static inline u32\nknfsd_fh_hash(struct knfsd_fh *fh)\n{\n\treturn ~crc32_le(0xFFFFFFFF, (unsigned char *)&fh->fh_base, fh->fh_size);\n}",
    "includes": [
      "#include <uapi/linux/nfsd/nfsfh.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/crc32.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "crc32_le",
          "args": [
            "0xFFFFFFFF",
            "(unsigned char *)&fh->fh_base",
            "fh->fh_size"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfsd/nfsfh.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/crc32.h>\n\nstatic inline u32\nknfsd_fh_hash(struct knfsd_fh *fh)\n{\n\treturn ~crc32_le(0xFFFFFFFF, (unsigned char *)&fh->fh_base, fh->fh_size);\n}"
  },
  {
    "function_name": "fh_fsid_match",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfsfh.h",
    "lines": "200-207",
    "snippet": "static inline bool fh_fsid_match(struct knfsd_fh *fh1, struct knfsd_fh *fh2)\n{\n\tif (fh1->fh_fsid_type != fh2->fh_fsid_type)\n\t\treturn false;\n\tif (memcmp(fh1->fh_fsid, fh2->fh_fsid, key_len(fh1->fh_fsid_type)) != 0)\n\t\treturn false;\n\treturn true;\n}",
    "includes": [
      "#include <uapi/linux/nfsd/nfsfh.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/crc32.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "fh1->fh_fsid",
            "fh2->fh_fsid",
            "key_len(fh1->fh_fsid_type)"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "key_len",
          "args": [
            "fh1->fh_fsid_type"
          ],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "key_len",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfsfh.h",
          "lines": "139-152",
          "snippet": "static inline int key_len(int type)\n{\n\tswitch(type) {\n\tcase FSID_DEV:\t\treturn 8;\n\tcase FSID_NUM: \t\treturn 4;\n\tcase FSID_MAJOR_MINOR:\treturn 12;\n\tcase FSID_ENCODE_DEV:\treturn 8;\n\tcase FSID_UUID4_INUM:\treturn 8;\n\tcase FSID_UUID8:\treturn 8;\n\tcase FSID_UUID16:\treturn 16;\n\tcase FSID_UUID16_INUM:\treturn 24;\n\tdefault: return 0;\n\t}\n}",
          "includes": [
            "#include <uapi/linux/nfsd/nfsfh.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/crc32.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfsd/nfsfh.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/crc32.h>\n\nstatic inline int key_len(int type)\n{\n\tswitch(type) {\n\tcase FSID_DEV:\t\treturn 8;\n\tcase FSID_NUM: \t\treturn 4;\n\tcase FSID_MAJOR_MINOR:\treturn 12;\n\tcase FSID_ENCODE_DEV:\treturn 8;\n\tcase FSID_UUID4_INUM:\treturn 8;\n\tcase FSID_UUID8:\treturn 8;\n\tcase FSID_UUID16:\treturn 16;\n\tcase FSID_UUID16_INUM:\treturn 24;\n\tdefault: return 0;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfsd/nfsfh.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/crc32.h>\n\nstatic inline bool fh_fsid_match(struct knfsd_fh *fh1, struct knfsd_fh *fh2)\n{\n\tif (fh1->fh_fsid_type != fh2->fh_fsid_type)\n\t\treturn false;\n\tif (memcmp(fh1->fh_fsid, fh2->fh_fsid, key_len(fh1->fh_fsid_type)) != 0)\n\t\treturn false;\n\treturn true;\n}"
  },
  {
    "function_name": "fh_match",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfsfh.h",
    "lines": "191-198",
    "snippet": "static inline bool fh_match(struct knfsd_fh *fh1, struct knfsd_fh *fh2)\n{\n\tif (fh1->fh_size != fh2->fh_size)\n\t\treturn false;\n\tif (memcmp(fh1->fh_base.fh_pad, fh2->fh_base.fh_pad, fh1->fh_size) != 0)\n\t\treturn false;\n\treturn true;\n}",
    "includes": [
      "#include <uapi/linux/nfsd/nfsfh.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/crc32.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "fh1->fh_base.fh_pad",
            "fh2->fh_base.fh_pad",
            "fh1->fh_size"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfsd/nfsfh.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/crc32.h>\n\nstatic inline bool fh_match(struct knfsd_fh *fh1, struct knfsd_fh *fh2)\n{\n\tif (fh1->fh_size != fh2->fh_size)\n\t\treturn false;\n\tif (memcmp(fh1->fh_base.fh_pad, fh2->fh_base.fh_pad, fh1->fh_size) != 0)\n\t\treturn false;\n\treturn true;\n}"
  },
  {
    "function_name": "fh_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfsfh.h",
    "lines": "183-189",
    "snippet": "static __inline__ struct svc_fh *\nfh_init(struct svc_fh *fhp, int maxsize)\n{\n\tmemset(fhp, 0, sizeof(*fhp));\n\tfhp->fh_maxsize = maxsize;\n\treturn fhp;\n}",
    "includes": [
      "#include <uapi/linux/nfsd/nfsfh.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/crc32.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "fhp",
            "0",
            "sizeof(*fhp)"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfsd/nfsfh.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/crc32.h>\n\nstatic __inline__ struct svc_fh *\nfh_init(struct svc_fh *fhp, int maxsize)\n{\n\tmemset(fhp, 0, sizeof(*fhp));\n\tfhp->fh_maxsize = maxsize;\n\treturn fhp;\n}"
  },
  {
    "function_name": "fh_copy_shallow",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfsfh.h",
    "lines": "176-181",
    "snippet": "static inline void\nfh_copy_shallow(struct knfsd_fh *dst, struct knfsd_fh *src)\n{\n\tdst->fh_size = src->fh_size;\n\tmemcpy(&dst->fh_base, &src->fh_base, src->fh_size);\n}",
    "includes": [
      "#include <uapi/linux/nfsd/nfsfh.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/crc32.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&dst->fh_base",
            "&src->fh_base",
            "src->fh_size"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfsd/nfsfh.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/crc32.h>\n\nstatic inline void\nfh_copy_shallow(struct knfsd_fh *dst, struct knfsd_fh *src)\n{\n\tdst->fh_size = src->fh_size;\n\tmemcpy(&dst->fh_base, &src->fh_base, src->fh_size);\n}"
  },
  {
    "function_name": "fh_copy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfsfh.h",
    "lines": "167-174",
    "snippet": "static __inline__ struct svc_fh *\nfh_copy(struct svc_fh *dst, struct svc_fh *src)\n{\n\tWARN_ON(src->fh_dentry || src->fh_locked);\n\t\t\t\n\t*dst = *src;\n\treturn dst;\n}",
    "includes": [
      "#include <uapi/linux/nfsd/nfsfh.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/crc32.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "src->fh_dentry || src->fh_locked"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfsd/nfsfh.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/crc32.h>\n\nstatic __inline__ struct svc_fh *\nfh_copy(struct svc_fh *dst, struct svc_fh *src)\n{\n\tWARN_ON(src->fh_dentry || src->fh_locked);\n\t\t\t\n\t*dst = *src;\n\treturn dst;\n}"
  },
  {
    "function_name": "key_len",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfsfh.h",
    "lines": "139-152",
    "snippet": "static inline int key_len(int type)\n{\n\tswitch(type) {\n\tcase FSID_DEV:\t\treturn 8;\n\tcase FSID_NUM: \t\treturn 4;\n\tcase FSID_MAJOR_MINOR:\treturn 12;\n\tcase FSID_ENCODE_DEV:\treturn 8;\n\tcase FSID_UUID4_INUM:\treturn 8;\n\tcase FSID_UUID8:\treturn 8;\n\tcase FSID_UUID16:\treturn 16;\n\tcase FSID_UUID16_INUM:\treturn 24;\n\tdefault: return 0;\n\t}\n}",
    "includes": [
      "#include <uapi/linux/nfsd/nfsfh.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/crc32.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <uapi/linux/nfsd/nfsfh.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/crc32.h>\n\nstatic inline int key_len(int type)\n{\n\tswitch(type) {\n\tcase FSID_DEV:\t\treturn 8;\n\tcase FSID_NUM: \t\treturn 4;\n\tcase FSID_MAJOR_MINOR:\treturn 12;\n\tcase FSID_ENCODE_DEV:\treturn 8;\n\tcase FSID_UUID4_INUM:\treturn 8;\n\tcase FSID_UUID8:\treturn 8;\n\tcase FSID_UUID16:\treturn 16;\n\tcase FSID_UUID16_INUM:\treturn 24;\n\tdefault: return 0;\n\t}\n}"
  },
  {
    "function_name": "mk_fsid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfsfh.h",
    "lines": "87-137",
    "snippet": "static inline void mk_fsid(int vers, u32 *fsidv, dev_t dev, ino_t ino,\n\t\t\t   u32 fsid, unsigned char *uuid)\n{\n\tu32 *up;\n\tswitch(vers) {\n\tcase FSID_DEV:\n\t\tfsidv[0] = (__force __u32)htonl((MAJOR(dev)<<16) |\n\t\t\t\t MINOR(dev));\n\t\tfsidv[1] = ino_t_to_u32(ino);\n\t\tbreak;\n\tcase FSID_NUM:\n\t\tfsidv[0] = fsid;\n\t\tbreak;\n\tcase FSID_MAJOR_MINOR:\n\t\tfsidv[0] = (__force __u32)htonl(MAJOR(dev));\n\t\tfsidv[1] = (__force __u32)htonl(MINOR(dev));\n\t\tfsidv[2] = ino_t_to_u32(ino);\n\t\tbreak;\n\n\tcase FSID_ENCODE_DEV:\n\t\tfsidv[0] = new_encode_dev(dev);\n\t\tfsidv[1] = ino_t_to_u32(ino);\n\t\tbreak;\n\n\tcase FSID_UUID4_INUM:\n\t\t/* 4 byte fsid and inode number */\n\t\tup = (u32*)uuid;\n\t\tfsidv[0] = ino_t_to_u32(ino);\n\t\tfsidv[1] = up[0] ^ up[1] ^ up[2] ^ up[3];\n\t\tbreak;\n\n\tcase FSID_UUID8:\n\t\t/* 8 byte fsid  */\n\t\tup = (u32*)uuid;\n\t\tfsidv[0] = up[0] ^ up[2];\n\t\tfsidv[1] = up[1] ^ up[3];\n\t\tbreak;\n\n\tcase FSID_UUID16:\n\t\t/* 16 byte fsid - NFSv3+ only */\n\t\tmemcpy(fsidv, uuid, 16);\n\t\tbreak;\n\n\tcase FSID_UUID16_INUM:\n\t\t/* 8 byte inode and 16 byte fsid */\n\t\t*(u64*)fsidv = (u64)ino;\n\t\tmemcpy(fsidv+2, uuid, 16);\n\t\tbreak;\n\tdefault: BUG();\n\t}\n}",
    "includes": [
      "#include <uapi/linux/nfsd/nfsfh.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/crc32.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "fsidv+2",
            "uuid",
            "16"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "fsidv",
            "uuid",
            "16"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ino_t_to_u32",
          "args": [
            "ino"
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "ino_t_to_u32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfsfh.h",
          "lines": "14-17",
          "snippet": "static inline __u32 ino_t_to_u32(ino_t ino)\n{\n\treturn (__u32) ino;\n}",
          "includes": [
            "#include <uapi/linux/nfsd/nfsfh.h>",
            "#include <linux/sunrpc/svc.h>",
            "#include <linux/crc32.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <uapi/linux/nfsd/nfsfh.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/crc32.h>\n\nstatic inline __u32 ino_t_to_u32(ino_t ino)\n{\n\treturn (__u32) ino;\n}"
        }
      },
      {
        "call_info": {
          "callee": "new_encode_dev",
          "args": [
            "dev"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "htonl",
          "args": [
            "MINOR(dev)"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MINOR",
          "args": [
            "dev"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "htonl",
          "args": [
            "MAJOR(dev)"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MAJOR",
          "args": [
            "dev"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "htonl",
          "args": [
            "(MAJOR(dev)<<16) |\n\t\t\t\t MINOR(dev)"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MINOR",
          "args": [
            "dev"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MAJOR",
          "args": [
            "dev"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <uapi/linux/nfsd/nfsfh.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/crc32.h>\n\nstatic inline void mk_fsid(int vers, u32 *fsidv, dev_t dev, ino_t ino,\n\t\t\t   u32 fsid, unsigned char *uuid)\n{\n\tu32 *up;\n\tswitch(vers) {\n\tcase FSID_DEV:\n\t\tfsidv[0] = (__force __u32)htonl((MAJOR(dev)<<16) |\n\t\t\t\t MINOR(dev));\n\t\tfsidv[1] = ino_t_to_u32(ino);\n\t\tbreak;\n\tcase FSID_NUM:\n\t\tfsidv[0] = fsid;\n\t\tbreak;\n\tcase FSID_MAJOR_MINOR:\n\t\tfsidv[0] = (__force __u32)htonl(MAJOR(dev));\n\t\tfsidv[1] = (__force __u32)htonl(MINOR(dev));\n\t\tfsidv[2] = ino_t_to_u32(ino);\n\t\tbreak;\n\n\tcase FSID_ENCODE_DEV:\n\t\tfsidv[0] = new_encode_dev(dev);\n\t\tfsidv[1] = ino_t_to_u32(ino);\n\t\tbreak;\n\n\tcase FSID_UUID4_INUM:\n\t\t/* 4 byte fsid and inode number */\n\t\tup = (u32*)uuid;\n\t\tfsidv[0] = ino_t_to_u32(ino);\n\t\tfsidv[1] = up[0] ^ up[1] ^ up[2] ^ up[3];\n\t\tbreak;\n\n\tcase FSID_UUID8:\n\t\t/* 8 byte fsid  */\n\t\tup = (u32*)uuid;\n\t\tfsidv[0] = up[0] ^ up[2];\n\t\tfsidv[1] = up[1] ^ up[3];\n\t\tbreak;\n\n\tcase FSID_UUID16:\n\t\t/* 16 byte fsid - NFSv3+ only */\n\t\tmemcpy(fsidv, uuid, 16);\n\t\tbreak;\n\n\tcase FSID_UUID16_INUM:\n\t\t/* 8 byte inode and 16 byte fsid */\n\t\t*(u64*)fsidv = (u64)ino;\n\t\tmemcpy(fsidv+2, uuid, 16);\n\t\tbreak;\n\tdefault: BUG();\n\t}\n}"
  },
  {
    "function_name": "u32_to_ino_t",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfsfh.h",
    "lines": "19-22",
    "snippet": "static inline ino_t u32_to_ino_t(__u32 uino)\n{\n\treturn (ino_t) uino;\n}",
    "includes": [
      "#include <uapi/linux/nfsd/nfsfh.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/crc32.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <uapi/linux/nfsd/nfsfh.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/crc32.h>\n\nstatic inline ino_t u32_to_ino_t(__u32 uino)\n{\n\treturn (ino_t) uino;\n}"
  },
  {
    "function_name": "ino_t_to_u32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-1237/repo/fs/nfsd/nfsfh.h",
    "lines": "14-17",
    "snippet": "static inline __u32 ino_t_to_u32(ino_t ino)\n{\n\treturn (__u32) ino;\n}",
    "includes": [
      "#include <uapi/linux/nfsd/nfsfh.h>",
      "#include <linux/sunrpc/svc.h>",
      "#include <linux/crc32.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <uapi/linux/nfsd/nfsfh.h>\n#include <linux/sunrpc/svc.h>\n#include <linux/crc32.h>\n\nstatic inline __u32 ino_t_to_u32(ino_t ino)\n{\n\treturn (__u32) ino;\n}"
  }
]