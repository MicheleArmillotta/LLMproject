[
  {
    "function_name": "nox11_exit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "1711-1718",
    "snippet": "void nox11_exit(int rc) {\n#if NO_X11\n\trfbLog(\"This x11vnc was not built with X11 support.\\n\");\n\tclean_up_exit(rc);\n#else\n\tif (0) {rc = 0;}\n#endif\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "clean_up_exit",
          "args": [
            "rc"
          ],
          "line": 1714
        },
        "resolved": true,
        "details": {
          "function_name": "clean_up_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/cleanup.c",
          "lines": "151-266",
          "snippet": "void clean_up_exit(int ret) {\n\tstatic int depth = 0;\n\texit_flag = 1;\n\n\tif (depth++ > 2) {\n\t\texit(ret);\n\t}\n\n\tif (icon_mode) {\n\t\tclean_icon_mode();\n\t}\n\n\t/* remove the shm areas: */\n\tclean_shm(0);\n\n\tstop_stunnel();\n\tif (use_openssl) {\n\t\tssl_helper_pid(0, 0);\t/* killall */\n\t}\n\n\tif (ssh_pid > 0) {\n\t\tkill(ssh_pid, SIGTERM);\n\t\tssh_pid = 0;\n\t}\n\n#ifdef MACOSX\n\tif (client_connect_file) {\n\t\tif (strstr(client_connect_file, \"/tmp/x11vnc-macosx-remote\")\n\t\t    == client_connect_file) {\n\t\t\tunlink(client_connect_file);\n\t\t}\n\t}\n\tif (macosx_console) {\n\t\tmacosxCG_fini();\n\t}\n#endif\n\n\tif (pipeinput_fh != NULL) {\n\t\tpclose(pipeinput_fh);\n\t\tpipeinput_fh = NULL;\n\t}\n\n\tshutdown_uinput();\n\n\tif (unix_sock) {\n\t\tif (unix_sock_fd >= 0) {\n\t\t\trfbLog(\"deleting unix sock: %s\\n\", unix_sock);\n\t\t\tclose(unix_sock_fd);\n\t\t\tunix_sock_fd = -1;\n\t\t\tunlink(unix_sock);\n\t\t}\n\t}\n\n\tif (! dpy) {\t/* raw_rb hack */\n\t\tif (rm_flagfile) {\n\t\t\tunlink(rm_flagfile);\n\t\t\trm_flagfile = NULL;\n\t\t}\n\t\texit(ret);\n\t}\n\n\t/* X keyboard cleanups */\n\tdelete_added_keycodes(0);\n\n\t/* remove all created XInput2 devices */\n\tif(use_multipointer)\n\t    removeAllMDs(dpy);\n\n\tif (clear_mods == 1) {\n\t\tclear_modifiers(0);\n\t} else if (clear_mods == 2) {\n\t\tclear_keys();\n\t} else if (clear_mods == 3) {\n\t\tclear_keys();\n\t\tclear_locks();\n\t}\n\n\tif (no_autorepeat) {\n\t\tautorepeat(1, 0);\n\t}\n\tif (use_solid_bg) {\n\t\tsolid_bg(1);\n\t}\n\tif (ncache || ncache0) {\n\t\tkde_no_animate(1);\n\t}\n\tX_LOCK;\n\tXTestDiscard_wr(dpy);\n#if HAVE_LIBXDAMAGE\n\tif (xdamage) {\n\t\tXDamageDestroy(dpy, xdamage);\n\t}\n#endif\n#if HAVE_LIBXTRAP\n\tif (trap_ctx) {\n\t\tXEFreeTC(trap_ctx);\n\t}\n#endif\n\t/* XXX rdpy_ctrl, etc. cannot close w/o blocking */\n\tXCloseDisplay_wr(dpy);\n\tX_UNLOCK;\n\n\tfflush(stderr);\n\n\tif (rm_flagfile) {\n\t\tunlink(rm_flagfile);\n\t\trm_flagfile = NULL;\n\t}\n\n\tif (avahi) {\n\t\tavahi_cleanup();\n\t\tfflush(stderr);\n\t}\n\n\texit(ret);\n}",
          "includes": [
            "#include \"xi2_devices.h\"",
            "#include \"uinput.h\"",
            "#include \"xevents.h\"",
            "#include \"xrecord.h\"",
            "#include \"screen.h\"",
            "#include \"avahi.h\"",
            "#include \"macosxCG.h\"",
            "#include \"macosx.h\"",
            "#include \"connections.h\"",
            "#include \"sslhelper.h\"",
            "#include \"sslcmds.h\"",
            "#include \"unixpw.h\"",
            "#include \"solid.h\"",
            "#include \"gui.h\"",
            "#include \"scan.h\"",
            "#include \"keyboard.h\"",
            "#include \"remote.h\"",
            "#include \"xdamage.h\"",
            "#include \"xwrappers.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void clean_up_exit(int ret);",
            "int known_sigpipe_mode(char *s);",
            "static int exit_flag = 0;",
            "static void clean_icon_mode(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xi2_devices.h\"\n#include \"uinput.h\"\n#include \"xevents.h\"\n#include \"xrecord.h\"\n#include \"screen.h\"\n#include \"avahi.h\"\n#include \"macosxCG.h\"\n#include \"macosx.h\"\n#include \"connections.h\"\n#include \"sslhelper.h\"\n#include \"sslcmds.h\"\n#include \"unixpw.h\"\n#include \"solid.h\"\n#include \"gui.h\"\n#include \"scan.h\"\n#include \"keyboard.h\"\n#include \"remote.h\"\n#include \"xdamage.h\"\n#include \"xwrappers.h\"\n#include \"x11vnc.h\"\n\nvoid clean_up_exit(int ret);\nint known_sigpipe_mode(char *s);\nstatic int exit_flag = 0;\nstatic void clean_icon_mode(void);\n\nvoid clean_up_exit(int ret) {\n\tstatic int depth = 0;\n\texit_flag = 1;\n\n\tif (depth++ > 2) {\n\t\texit(ret);\n\t}\n\n\tif (icon_mode) {\n\t\tclean_icon_mode();\n\t}\n\n\t/* remove the shm areas: */\n\tclean_shm(0);\n\n\tstop_stunnel();\n\tif (use_openssl) {\n\t\tssl_helper_pid(0, 0);\t/* killall */\n\t}\n\n\tif (ssh_pid > 0) {\n\t\tkill(ssh_pid, SIGTERM);\n\t\tssh_pid = 0;\n\t}\n\n#ifdef MACOSX\n\tif (client_connect_file) {\n\t\tif (strstr(client_connect_file, \"/tmp/x11vnc-macosx-remote\")\n\t\t    == client_connect_file) {\n\t\t\tunlink(client_connect_file);\n\t\t}\n\t}\n\tif (macosx_console) {\n\t\tmacosxCG_fini();\n\t}\n#endif\n\n\tif (pipeinput_fh != NULL) {\n\t\tpclose(pipeinput_fh);\n\t\tpipeinput_fh = NULL;\n\t}\n\n\tshutdown_uinput();\n\n\tif (unix_sock) {\n\t\tif (unix_sock_fd >= 0) {\n\t\t\trfbLog(\"deleting unix sock: %s\\n\", unix_sock);\n\t\t\tclose(unix_sock_fd);\n\t\t\tunix_sock_fd = -1;\n\t\t\tunlink(unix_sock);\n\t\t}\n\t}\n\n\tif (! dpy) {\t/* raw_rb hack */\n\t\tif (rm_flagfile) {\n\t\t\tunlink(rm_flagfile);\n\t\t\trm_flagfile = NULL;\n\t\t}\n\t\texit(ret);\n\t}\n\n\t/* X keyboard cleanups */\n\tdelete_added_keycodes(0);\n\n\t/* remove all created XInput2 devices */\n\tif(use_multipointer)\n\t    removeAllMDs(dpy);\n\n\tif (clear_mods == 1) {\n\t\tclear_modifiers(0);\n\t} else if (clear_mods == 2) {\n\t\tclear_keys();\n\t} else if (clear_mods == 3) {\n\t\tclear_keys();\n\t\tclear_locks();\n\t}\n\n\tif (no_autorepeat) {\n\t\tautorepeat(1, 0);\n\t}\n\tif (use_solid_bg) {\n\t\tsolid_bg(1);\n\t}\n\tif (ncache || ncache0) {\n\t\tkde_no_animate(1);\n\t}\n\tX_LOCK;\n\tXTestDiscard_wr(dpy);\n#if HAVE_LIBXDAMAGE\n\tif (xdamage) {\n\t\tXDamageDestroy(dpy, xdamage);\n\t}\n#endif\n#if HAVE_LIBXTRAP\n\tif (trap_ctx) {\n\t\tXEFreeTC(trap_ctx);\n\t}\n#endif\n\t/* XXX rdpy_ctrl, etc. cannot close w/o blocking */\n\tXCloseDisplay_wr(dpy);\n\tX_UNLOCK;\n\n\tfflush(stderr);\n\n\tif (rm_flagfile) {\n\t\tunlink(rm_flagfile);\n\t\trm_flagfile = NULL;\n\t}\n\n\tif (avahi) {\n\t\tavahi_cleanup();\n\t\tfflush(stderr);\n\t}\n\n\texit(ret);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rfbLog",
          "args": [
            "\"This x11vnc was not built with X11 support.\\n\""
          ],
          "line": 1713
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nvoid nox11_exit(int rc) {\n#if NO_X11\n\trfbLog(\"This x11vnc was not built with X11 support.\\n\");\n\tclean_up_exit(rc);\n#else\n\tif (0) {rc = 0;}\n#endif\n}"
  },
  {
    "function_name": "XKeycodeToKeysym_wr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "1699-1709",
    "snippet": "KeySym XKeycodeToKeysym_wr(Display *display, KeyCode keycode, int index) {\n#if NO_X11\n\treturn 0;\n#else\n#if !HAVE_XKEYBOARD || SKIP_XKB\n\treturn XKeycodeToKeysym(display, keycode, index);\n#else\n\treturn XkbKeycodeToKeysym(display, keycode, 0, index);\n#endif\n#endif\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int XCloseDisplay_wr(Display *display);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "XkbKeycodeToKeysym",
          "args": [
            "display",
            "keycode",
            "0",
            "index"
          ],
          "line": 1706
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XKeycodeToKeysym",
          "args": [
            "display",
            "keycode",
            "index"
          ],
          "line": 1704
        },
        "resolved": true,
        "details": {
          "function_name": "XKeycodeToKeysym_wr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "1699-1709",
          "snippet": "KeySym XKeycodeToKeysym_wr(Display *display, KeyCode keycode, int index) {\n#if NO_X11\n\treturn 0;\n#else\n#if !HAVE_XKEYBOARD || SKIP_XKB\n\treturn XKeycodeToKeysym(display, keycode, index);\n#else\n\treturn XkbKeycodeToKeysym(display, keycode, 0, index);\n#endif\n#endif\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint XCloseDisplay_wr(Display *display);\n\nKeySym XKeycodeToKeysym_wr(Display *display, KeyCode keycode, int index) {\n#if NO_X11\n\treturn 0;\n#else\n#if !HAVE_XKEYBOARD || SKIP_XKB\n\treturn XKeycodeToKeysym(display, keycode, index);\n#else\n\treturn XkbKeycodeToKeysym(display, keycode, 0, index);\n#endif\n#endif\n}"
  },
  {
    "function_name": "XSelectInput_wr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "1678-1697",
    "snippet": "int XSelectInput_wr(Display *display, Window w, long event_mask) {\n#if NO_X11\n\tif (!display || !w || !event_mask) {}\n\treturn 0;\n#else\n\tint rc;\n\tXErrorHandler old_handler;\n\tif (display == NULL || w == None) {\n\t\treturn 0;\n\t}\n\told_handler = XSetErrorHandler(trap_xerror);\n\ttrapped_xerror = 0;\n\trc = XSelectInput(display, w, event_mask);\n\tXSetErrorHandler(old_handler);\n\tif (trapped_xerror) {\n\t\trc = 0;\n\t}\n\treturn rc;\n#endif\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "Bool XTestCompareCurrentCursorWithWindow_wr(Display* dpy, Window w);",
      "int XCloseDisplay_wr(Display *display);",
      "int XSelectInput_wr(Display *display, Window w, long event_mask);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "XSetErrorHandler",
          "args": [
            "old_handler"
          ],
          "line": 1691
        },
        "resolved": true,
        "details": {
          "function_name": "XSetErrorHandler",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/nox11_funcs.h",
          "lines": "2819-2821",
          "snippet": "XErrorHandler XSetErrorHandler (XErrorHandler h) {\n\treturn h;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "XErrorHandler XSetErrorHandler (XErrorHandler h) {\n\treturn h;\n}"
        }
      },
      {
        "call_info": {
          "callee": "XSelectInput",
          "args": [
            "display",
            "w",
            "event_mask"
          ],
          "line": 1690
        },
        "resolved": true,
        "details": {
          "function_name": "XSelectInput_wr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "1678-1697",
          "snippet": "int XSelectInput_wr(Display *display, Window w, long event_mask) {\n#if NO_X11\n\tif (!display || !w || !event_mask) {}\n\treturn 0;\n#else\n\tint rc;\n\tXErrorHandler old_handler;\n\tif (display == NULL || w == None) {\n\t\treturn 0;\n\t}\n\told_handler = XSetErrorHandler(trap_xerror);\n\ttrapped_xerror = 0;\n\trc = XSelectInput(display, w, event_mask);\n\tXSetErrorHandler(old_handler);\n\tif (trapped_xerror) {\n\t\trc = 0;\n\t}\n\treturn rc;\n#endif\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nBool XTestCompareCurrentCursorWithWindow_wr(Display* dpy, Window w);\nint XCloseDisplay_wr(Display *display);\nint XSelectInput_wr(Display *display, Window w, long event_mask);\n\nint XSelectInput_wr(Display *display, Window w, long event_mask) {\n#if NO_X11\n\tif (!display || !w || !event_mask) {}\n\treturn 0;\n#else\n\tint rc;\n\tXErrorHandler old_handler;\n\tif (display == NULL || w == None) {\n\t\treturn 0;\n\t}\n\told_handler = XSetErrorHandler(trap_xerror);\n\ttrapped_xerror = 0;\n\trc = XSelectInput(display, w, event_mask);\n\tXSetErrorHandler(old_handler);\n\tif (trapped_xerror) {\n\t\trc = 0;\n\t}\n\treturn rc;\n#endif\n}"
  },
  {
    "function_name": "XFree_wr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "1664-1676",
    "snippet": "int XFree_wr(void *data) {\n\tif (data == NULL) {\n\t\treturn 1;\n\t}\n\tif (! dpy) {\n\t\treturn 1;\n\t}\n#if NO_X11\n\treturn 1;\n#else\n\treturn XFree(data);\n#endif\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void XTestDiscard_wr(Display *dpy);",
      "int XFree_wr(void *data);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "XFree",
          "args": [
            "data"
          ],
          "line": 1674
        },
        "resolved": true,
        "details": {
          "function_name": "XFree_wr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "1664-1676",
          "snippet": "int XFree_wr(void *data) {\n\tif (data == NULL) {\n\t\treturn 1;\n\t}\n\tif (! dpy) {\n\t\treturn 1;\n\t}\n#if NO_X11\n\treturn 1;\n#else\n\treturn XFree(data);\n#endif\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nvoid XTestDiscard_wr(Display *dpy);\nint XFree_wr(void *data);\n\nint XFree_wr(void *data) {\n\tif (data == NULL) {\n\t\treturn 1;\n\t}\n\tif (! dpy) {\n\t\treturn 1;\n\t}\n#if NO_X11\n\treturn 1;\n#else\n\treturn XFree(data);\n#endif\n}"
  },
  {
    "function_name": "XQueryTree_wr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "1640-1662",
    "snippet": "Status XQueryTree_wr(Display *display, Window w, Window *root_return,\n    Window *parent_return, Window **children_return,\n    unsigned int *nchildren_return) {\n\n#ifdef MACOSX\n\tif (macosx_console) {\n\t\treturn macosx_xquerytree(w, root_return, parent_return,\n\t\t    children_return, nchildren_return);\n\t}\n#endif\n#if NO_X11\n\tif (!display || !w || !root_return || !parent_return\n\t    || !children_return || !nchildren_return) {}\n\treturn (Status) 0;\n#else\n\tif (! display) {\n\t\treturn (Status) 0;\n\t}\n\treturn XQueryTree(display, w, root_return, parent_return,\n\t    children_return, nchildren_return);\n#endif\t/* NO_X11 */\n    \t\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "Bool XTestCompareCurrentCursorWithWindow_wr(Display* dpy, Window w);",
      "int XCloseDisplay_wr(Display *display);",
      "Status XQueryTree_wr(Display *display, Window w, Window *root_return,\n    Window *parent_return, Window **children_return,\n    unsigned int *nchildren_return);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "XQueryTree",
          "args": [
            "display",
            "w",
            "root_return",
            "parent_return",
            "children_return",
            "nchildren_return"
          ],
          "line": 1658
        },
        "resolved": true,
        "details": {
          "function_name": "XQueryTree_wr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "1640-1662",
          "snippet": "Status XQueryTree_wr(Display *display, Window w, Window *root_return,\n    Window *parent_return, Window **children_return,\n    unsigned int *nchildren_return) {\n\n#ifdef MACOSX\n\tif (macosx_console) {\n\t\treturn macosx_xquerytree(w, root_return, parent_return,\n\t\t    children_return, nchildren_return);\n\t}\n#endif\n#if NO_X11\n\tif (!display || !w || !root_return || !parent_return\n\t    || !children_return || !nchildren_return) {}\n\treturn (Status) 0;\n#else\n\tif (! display) {\n\t\treturn (Status) 0;\n\t}\n\treturn XQueryTree(display, w, root_return, parent_return,\n\t    children_return, nchildren_return);\n#endif\t/* NO_X11 */\n    \t\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "macosx_xquerytree",
          "args": [
            "w",
            "root_return",
            "parent_return",
            "children_return",
            "nchildren_return"
          ],
          "line": 1646
        },
        "resolved": true,
        "details": {
          "function_name": "macosx_xquerytree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/macosx.c",
          "lines": "652-677",
          "snippet": "Status macosx_xquerytree(Window w, Window *root_return, Window *parent_return,\n    Window **children_return, unsigned int *nchildren_return) {\n\n\tint i, n, k;\n\n\t*root_return = (Window) 0;\n\t*parent_return = (Window) 0;\n\tif (!w) {}\n\n\tmacosxCGS_get_all_windows();\n\n\tn = 0;\n\tfor (k = CGS_levelmax - 1; k >= 0; k--) {\n\t\tfor (i = macwinmax - 1; i >= 0; i--) {\n\t\t\tif (n >= QTMAX) break;\n\t\t\tif (macwins[i].level == CGS_levels[k]) {\nif (0) fprintf(stderr, \"k=%d i=%d n=%d\\n\", k, i, n);\n\t\t\t\tcret[n++] = (Window) macwins[i].win;\n\t\t\t}\n\t\t}\n\t}\n\t*children_return = cret;\n\t*nchildren_return = (unsigned int) macwinmax;\n\n\treturn (Status) 1;\n}",
          "includes": [
            "#include \"macosxCGS.h\"",
            "#include \"macosxCGP.h\"",
            "#include \"macosxCG.h\"",
            "#include \"connections.h\"",
            "#include \"cursor.h\"",
            "#include \"keyboard.h\"",
            "#include \"allowed_input_t.h\"",
            "#include \"pointer.h\"",
            "#include \"screen.h\"",
            "#include \"scan.h\"",
            "#include \"cleanup.h\"",
            "#include \"x11vnc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [
            "#define QTMAX 2048"
          ],
          "globals_used": [
            "Status macosx_xquerytree(Window w, Window *root_return, Window *parent_return,\n    Window **children_return, unsigned int *nchildren_return);",
            "int macosx_get_wm_frame_pos(int *px, int *py, int *x, int *y, int *w, int *h,\n    Window *frame, Window *win);",
            "void macosx_add_create(Window win, int level);",
            "void macosx_add_destroy(Window win, int level);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"macosxCGS.h\"\n#include \"macosxCGP.h\"\n#include \"macosxCG.h\"\n#include \"connections.h\"\n#include \"cursor.h\"\n#include \"keyboard.h\"\n#include \"allowed_input_t.h\"\n#include \"pointer.h\"\n#include \"screen.h\"\n#include \"scan.h\"\n#include \"cleanup.h\"\n#include \"x11vnc.h\"\n#include \"config.h\"\n\n#define QTMAX 2048\n\nStatus macosx_xquerytree(Window w, Window *root_return, Window *parent_return,\n    Window **children_return, unsigned int *nchildren_return);\nint macosx_get_wm_frame_pos(int *px, int *py, int *x, int *y, int *w, int *h,\n    Window *frame, Window *win);\nvoid macosx_add_create(Window win, int level);\nvoid macosx_add_destroy(Window win, int level);\n\nStatus macosx_xquerytree(Window w, Window *root_return, Window *parent_return,\n    Window **children_return, unsigned int *nchildren_return) {\n\n\tint i, n, k;\n\n\t*root_return = (Window) 0;\n\t*parent_return = (Window) 0;\n\tif (!w) {}\n\n\tmacosxCGS_get_all_windows();\n\n\tn = 0;\n\tfor (k = CGS_levelmax - 1; k >= 0; k--) {\n\t\tfor (i = macwinmax - 1; i >= 0; i--) {\n\t\t\tif (n >= QTMAX) break;\n\t\t\tif (macwins[i].level == CGS_levels[k]) {\nif (0) fprintf(stderr, \"k=%d i=%d n=%d\\n\", k, i, n);\n\t\t\t\tcret[n++] = (Window) macwins[i].win;\n\t\t\t}\n\t\t}\n\t}\n\t*children_return = cret;\n\t*nchildren_return = (unsigned int) macwinmax;\n\n\treturn (Status) 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nBool XTestCompareCurrentCursorWithWindow_wr(Display* dpy, Window w);\nint XCloseDisplay_wr(Display *display);\nStatus XQueryTree_wr(Display *display, Window w, Window *root_return,\n    Window *parent_return, Window **children_return,\n    unsigned int *nchildren_return);\n\nStatus XQueryTree_wr(Display *display, Window w, Window *root_return,\n    Window *parent_return, Window **children_return,\n    unsigned int *nchildren_return) {\n\n#ifdef MACOSX\n\tif (macosx_console) {\n\t\treturn macosx_xquerytree(w, root_return, parent_return,\n\t\t    children_return, nchildren_return);\n\t}\n#endif\n#if NO_X11\n\tif (!display || !w || !root_return || !parent_return\n\t    || !children_return || !nchildren_return) {}\n\treturn (Status) 0;\n#else\n\tif (! display) {\n\t\treturn (Status) 0;\n\t}\n\treturn XQueryTree(display, w, root_return, parent_return,\n\t    children_return, nchildren_return);\n#endif\t/* NO_X11 */\n    \t\n}"
  },
  {
    "function_name": "XIWarpPointer_wr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "1605-1636",
    "snippet": "Bool XIWarpPointer_wr( Display *display,\n                       int deviceid,\n                       Window src_w,\n                       Window dest_w,\n                       double src_x,\n                       double src_y,\n                       int src_width,\n                       int src_height,\n                       double dest_x,\n                       double dest_y)\n{\n  Bool rc;\n  XErrorHandler old_handler;\n\n  if (! display) {\n    return False;\n  }\n\n  /* there can be a race condition where this is called when the XI2 device has not yet been created */\n  old_handler = XSetErrorHandler(trap_xerror);\n  trapped_xerror = 0;\n\n  rc = XIWarpPointer(display, deviceid, src_w, dest_w, src_x, src_y, src_width, src_height, dest_x, dest_y);\n\n  XSetErrorHandler(old_handler);\n  if (trapped_xerror) {\n    trapped_xerror = 0;\n    rc = 0;\n  }\n\n  return rc;\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "XImage *XGetSubImage_wr(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, unsigned long plane_mask,\n    int format, XImage *dest_image, int dest_x, int dest_y);",
      "int XCloseDisplay_wr(Display *display);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "XSetErrorHandler",
          "args": [
            "old_handler"
          ],
          "line": 1629
        },
        "resolved": true,
        "details": {
          "function_name": "XSetErrorHandler",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/nox11_funcs.h",
          "lines": "2819-2821",
          "snippet": "XErrorHandler XSetErrorHandler (XErrorHandler h) {\n\treturn h;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "XErrorHandler XSetErrorHandler (XErrorHandler h) {\n\treturn h;\n}"
        }
      },
      {
        "call_info": {
          "callee": "XIWarpPointer",
          "args": [
            "display",
            "deviceid",
            "src_w",
            "dest_w",
            "src_x",
            "src_y",
            "src_width",
            "src_height",
            "dest_x",
            "dest_y"
          ],
          "line": 1627
        },
        "resolved": true,
        "details": {
          "function_name": "XIWarpPointer_wr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "1605-1636",
          "snippet": "Bool XIWarpPointer_wr( Display *display,\n                       int deviceid,\n                       Window src_w,\n                       Window dest_w,\n                       double src_x,\n                       double src_y,\n                       int src_width,\n                       int src_height,\n                       double dest_x,\n                       double dest_y)\n{\n  Bool rc;\n  XErrorHandler old_handler;\n\n  if (! display) {\n    return False;\n  }\n\n  /* there can be a race condition where this is called when the XI2 device has not yet been created */\n  old_handler = XSetErrorHandler(trap_xerror);\n  trapped_xerror = 0;\n\n  rc = XIWarpPointer(display, deviceid, src_w, dest_w, src_x, src_y, src_width, src_height, dest_x, dest_y);\n\n  XSetErrorHandler(old_handler);\n  if (trapped_xerror) {\n    trapped_xerror = 0;\n    rc = 0;\n  }\n\n  return rc;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nXImage *XGetSubImage_wr(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, unsigned long plane_mask,\n    int format, XImage *dest_image, int dest_x, int dest_y);\nint XCloseDisplay_wr(Display *display);\n\nBool XIWarpPointer_wr( Display *display,\n                       int deviceid,\n                       Window src_w,\n                       Window dest_w,\n                       double src_x,\n                       double src_y,\n                       int src_width,\n                       int src_height,\n                       double dest_x,\n                       double dest_y)\n{\n  Bool rc;\n  XErrorHandler old_handler;\n\n  if (! display) {\n    return False;\n  }\n\n  /* there can be a race condition where this is called when the XI2 device has not yet been created */\n  old_handler = XSetErrorHandler(trap_xerror);\n  trapped_xerror = 0;\n\n  rc = XIWarpPointer(display, deviceid, src_w, dest_w, src_x, src_y, src_width, src_height, dest_x, dest_y);\n\n  XSetErrorHandler(old_handler);\n  if (trapped_xerror) {\n    trapped_xerror = 0;\n    rc = 0;\n  }\n\n  return rc;\n}"
  },
  {
    "function_name": "XIQueryPointer_wr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "1567-1602",
    "snippet": "Bool XIQueryPointer_wr( Display *display,\n                        int deviceid,\n                        Window win,\n                        Window *root_return,\n                        Window *child_return,\n                        double *root_x_return,\n                        double *root_y_return,\n                        double *win_x_return,\n                        double *win_y_return,\n                        XIButtonState *buttons_return,\n                        XIModifierState *modifiers_return,\n                        XIGroupState *group_return)\n{\n  Bool rc;\n  XErrorHandler old_handler;\n\n  if (! display) {\n    return False;\n  }\n\n  /* there can be a race condition where this is called when the XI2 device has not yet been created */\n  old_handler = XSetErrorHandler(trap_xerror);\n  trapped_xerror = 0;\n\n  rc = XIQueryPointer(display, deviceid, win, root_return, child_return,\n                      root_x_return, root_y_return, win_x_return, win_y_return,\n                      buttons_return, modifiers_return, group_return);\n\n  XSetErrorHandler(old_handler);\n  if (trapped_xerror) {\n    trapped_xerror = 0;\n    rc = 0;\n  }\n\n  return rc;\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int XCloseDisplay_wr(Display *display);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "XSetErrorHandler",
          "args": [
            "old_handler"
          ],
          "line": 1595
        },
        "resolved": true,
        "details": {
          "function_name": "XSetErrorHandler",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/nox11_funcs.h",
          "lines": "2819-2821",
          "snippet": "XErrorHandler XSetErrorHandler (XErrorHandler h) {\n\treturn h;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "XErrorHandler XSetErrorHandler (XErrorHandler h) {\n\treturn h;\n}"
        }
      },
      {
        "call_info": {
          "callee": "XIQueryPointer",
          "args": [
            "display",
            "deviceid",
            "win",
            "root_return",
            "child_return",
            "root_x_return",
            "root_y_return",
            "win_x_return",
            "win_y_return",
            "buttons_return",
            "modifiers_return",
            "group_return"
          ],
          "line": 1591
        },
        "resolved": true,
        "details": {
          "function_name": "XIQueryPointer_wr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "1567-1602",
          "snippet": "Bool XIQueryPointer_wr( Display *display,\n                        int deviceid,\n                        Window win,\n                        Window *root_return,\n                        Window *child_return,\n                        double *root_x_return,\n                        double *root_y_return,\n                        double *win_x_return,\n                        double *win_y_return,\n                        XIButtonState *buttons_return,\n                        XIModifierState *modifiers_return,\n                        XIGroupState *group_return)\n{\n  Bool rc;\n  XErrorHandler old_handler;\n\n  if (! display) {\n    return False;\n  }\n\n  /* there can be a race condition where this is called when the XI2 device has not yet been created */\n  old_handler = XSetErrorHandler(trap_xerror);\n  trapped_xerror = 0;\n\n  rc = XIQueryPointer(display, deviceid, win, root_return, child_return,\n                      root_x_return, root_y_return, win_x_return, win_y_return,\n                      buttons_return, modifiers_return, group_return);\n\n  XSetErrorHandler(old_handler);\n  if (trapped_xerror) {\n    trapped_xerror = 0;\n    rc = 0;\n  }\n\n  return rc;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint XCloseDisplay_wr(Display *display);\n\nBool XIQueryPointer_wr( Display *display,\n                        int deviceid,\n                        Window win,\n                        Window *root_return,\n                        Window *child_return,\n                        double *root_x_return,\n                        double *root_y_return,\n                        double *win_x_return,\n                        double *win_y_return,\n                        XIButtonState *buttons_return,\n                        XIModifierState *modifiers_return,\n                        XIGroupState *group_return)\n{\n  Bool rc;\n  XErrorHandler old_handler;\n\n  if (! display) {\n    return False;\n  }\n\n  /* there can be a race condition where this is called when the XI2 device has not yet been created */\n  old_handler = XSetErrorHandler(trap_xerror);\n  trapped_xerror = 0;\n\n  rc = XIQueryPointer(display, deviceid, win, root_return, child_return,\n                      root_x_return, root_y_return, win_x_return, win_y_return,\n                      buttons_return, modifiers_return, group_return);\n\n  XSetErrorHandler(old_handler);\n  if (trapped_xerror) {\n    trapped_xerror = 0;\n    rc = 0;\n  }\n\n  return rc;\n}"
  },
  {
    "function_name": "XQueryPointer_wr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "1522-1564",
    "snippet": "Bool XQueryPointer_wr(Display *display, Window w, Window *root_return,\n    Window *child_return, int *root_x_return, int *root_y_return,\n    int *win_x_return, int *win_y_return, unsigned int *mask_return) {\n#if NO_X11\n\tif (!display || !w || !root_return || !child_return || !root_x_return\n\t    || !root_y_return || !win_x_return || !win_y_return || !mask_return) {}\n\treturn False;\n#else\n\tBool rc;\n\tXErrorHandler old_handler;\n\n\n\tif (! display) {\n\t\treturn False;\n\t}\n\told_handler = XSetErrorHandler(trap_xerror);\n\ttrapped_xerror = 0;\n\n\trc = XQueryPointer(display, w, root_return, child_return,\n\t    root_x_return, root_y_return, win_x_return, win_y_return,\n\t    mask_return);\n\n\tXSetErrorHandler(old_handler);\n\tif (trapped_xerror) {\n\t\trc = 0;\n\t}\n\tif (rc) {\n\t\tdisplay_button_mask = (*mask_return) & Bmask;\n\t\tdisplay_mod_mask    = (*mask_return) & Mmask;\n\t\tif (last_local_button_mask != display_button_mask) {\n\t\t\tgot_local_pointer_input++;\n\t\t} else if (*root_x_return != last_local_x ||\n\t\t    *root_y_return != last_local_y) {\n\t\t\tgot_local_pointer_input++;\n\t\t}\n\t\tlast_local_button_mask = display_button_mask;\n\t\tlast_local_mod_mask = display_mod_mask;\n\t\tlast_local_x = *root_x_return;\n\t\tlast_local_y = *root_y_return;\n\t}\n\treturn rc;\n#endif\t/* NO_X11 */\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "Bool XTestCompareCurrentCursorWithWindow_wr(Display* dpy, Window w);",
      "int XCloseDisplay_wr(Display *display);",
      "Bool XQueryPointer_wr(Display *display, Window w, Window *root_return,\n    Window *child_return, int *root_x_return, int *root_y_return,\n    int *win_x_return, int *win_y_return, unsigned int *mask_return);",
      "static unsigned int Bmask = (Button1Mask|Button2Mask|Button3Mask|Button4Mask|Button5Mask);",
      "static unsigned int Mmask = (ShiftMask|LockMask|ControlMask|Mod1Mask|Mod2Mask|Mod3Mask|Mod4Mask|Mod5Mask);",
      "static unsigned int last_local_button_mask = 0;",
      "static unsigned int last_local_mod_mask = 0;",
      "static int last_local_x = 0;",
      "static int last_local_y = 0;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "XSetErrorHandler",
          "args": [
            "old_handler"
          ],
          "line": 1544
        },
        "resolved": true,
        "details": {
          "function_name": "XSetErrorHandler",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/nox11_funcs.h",
          "lines": "2819-2821",
          "snippet": "XErrorHandler XSetErrorHandler (XErrorHandler h) {\n\treturn h;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "XErrorHandler XSetErrorHandler (XErrorHandler h) {\n\treturn h;\n}"
        }
      },
      {
        "call_info": {
          "callee": "XQueryPointer",
          "args": [
            "display",
            "w",
            "root_return",
            "child_return",
            "root_x_return",
            "root_y_return",
            "win_x_return",
            "win_y_return",
            "mask_return"
          ],
          "line": 1540
        },
        "resolved": true,
        "details": {
          "function_name": "XQueryPointer_wr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "1522-1564",
          "snippet": "Bool XQueryPointer_wr(Display *display, Window w, Window *root_return,\n    Window *child_return, int *root_x_return, int *root_y_return,\n    int *win_x_return, int *win_y_return, unsigned int *mask_return) {\n#if NO_X11\n\tif (!display || !w || !root_return || !child_return || !root_x_return\n\t    || !root_y_return || !win_x_return || !win_y_return || !mask_return) {}\n\treturn False;\n#else\n\tBool rc;\n\tXErrorHandler old_handler;\n\n\n\tif (! display) {\n\t\treturn False;\n\t}\n\told_handler = XSetErrorHandler(trap_xerror);\n\ttrapped_xerror = 0;\n\n\trc = XQueryPointer(display, w, root_return, child_return,\n\t    root_x_return, root_y_return, win_x_return, win_y_return,\n\t    mask_return);\n\n\tXSetErrorHandler(old_handler);\n\tif (trapped_xerror) {\n\t\trc = 0;\n\t}\n\tif (rc) {\n\t\tdisplay_button_mask = (*mask_return) & Bmask;\n\t\tdisplay_mod_mask    = (*mask_return) & Mmask;\n\t\tif (last_local_button_mask != display_button_mask) {\n\t\t\tgot_local_pointer_input++;\n\t\t} else if (*root_x_return != last_local_x ||\n\t\t    *root_y_return != last_local_y) {\n\t\t\tgot_local_pointer_input++;\n\t\t}\n\t\tlast_local_button_mask = display_button_mask;\n\t\tlast_local_mod_mask = display_mod_mask;\n\t\tlast_local_x = *root_x_return;\n\t\tlast_local_y = *root_y_return;\n\t}\n\treturn rc;\n#endif\t/* NO_X11 */\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nBool XTestCompareCurrentCursorWithWindow_wr(Display* dpy, Window w);\nint XCloseDisplay_wr(Display *display);\nBool XQueryPointer_wr(Display *display, Window w, Window *root_return,\n    Window *child_return, int *root_x_return, int *root_y_return,\n    int *win_x_return, int *win_y_return, unsigned int *mask_return);\nstatic unsigned int Bmask = (Button1Mask|Button2Mask|Button3Mask|Button4Mask|Button5Mask);\nstatic unsigned int Mmask = (ShiftMask|LockMask|ControlMask|Mod1Mask|Mod2Mask|Mod3Mask|Mod4Mask|Mod5Mask);\nstatic unsigned int last_local_button_mask = 0;\nstatic unsigned int last_local_mod_mask = 0;\nstatic int last_local_x = 0;\nstatic int last_local_y = 0;\n\nBool XQueryPointer_wr(Display *display, Window w, Window *root_return,\n    Window *child_return, int *root_x_return, int *root_y_return,\n    int *win_x_return, int *win_y_return, unsigned int *mask_return) {\n#if NO_X11\n\tif (!display || !w || !root_return || !child_return || !root_x_return\n\t    || !root_y_return || !win_x_return || !win_y_return || !mask_return) {}\n\treturn False;\n#else\n\tBool rc;\n\tXErrorHandler old_handler;\n\n\n\tif (! display) {\n\t\treturn False;\n\t}\n\told_handler = XSetErrorHandler(trap_xerror);\n\ttrapped_xerror = 0;\n\n\trc = XQueryPointer(display, w, root_return, child_return,\n\t    root_x_return, root_y_return, win_x_return, win_y_return,\n\t    mask_return);\n\n\tXSetErrorHandler(old_handler);\n\tif (trapped_xerror) {\n\t\trc = 0;\n\t}\n\tif (rc) {\n\t\tdisplay_button_mask = (*mask_return) & Bmask;\n\t\tdisplay_mod_mask    = (*mask_return) & Mmask;\n\t\tif (last_local_button_mask != display_button_mask) {\n\t\t\tgot_local_pointer_input++;\n\t\t} else if (*root_x_return != last_local_x ||\n\t\t    *root_y_return != last_local_y) {\n\t\t\tgot_local_pointer_input++;\n\t\t}\n\t\tlast_local_button_mask = display_button_mask;\n\t\tlast_local_mod_mask = display_mod_mask;\n\t\tlast_local_x = *root_x_return;\n\t\tlast_local_y = *root_y_return;\n\t}\n\treturn rc;\n#endif\t/* NO_X11 */\n}"
  },
  {
    "function_name": "XCloseDisplay_wr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "1504-1512",
    "snippet": "int XCloseDisplay_wr(Display *display) {\n\tint db = 0;\n\tif (db) fprintf(stderr, \"XCloseDisplay_wr: %p\\n\", (void *)display);\n#if NO_X11\n\treturn 0;\n#else\n\treturn XCloseDisplay(display);\n#endif\t/* NO_X11 */\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int XCloseDisplay_wr(Display *display);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "XCloseDisplay",
          "args": [
            "display"
          ],
          "line": 1510
        },
        "resolved": true,
        "details": {
          "function_name": "XCloseDisplay_wr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "1504-1512",
          "snippet": "int XCloseDisplay_wr(Display *display) {\n\tint db = 0;\n\tif (db) fprintf(stderr, \"XCloseDisplay_wr: %p\\n\", (void *)display);\n#if NO_X11\n\treturn 0;\n#else\n\treturn XCloseDisplay(display);\n#endif\t/* NO_X11 */\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"XCloseDisplay_wr: %p\\n\"",
            "(void *)display"
          ],
          "line": 1506
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint XCloseDisplay_wr(Display *display);\n\nint XCloseDisplay_wr(Display *display) {\n\tint db = 0;\n\tif (db) fprintf(stderr, \"XCloseDisplay_wr: %p\\n\", (void *)display);\n#if NO_X11\n\treturn 0;\n#else\n\treturn XCloseDisplay(display);\n#endif\t/* NO_X11 */\n}"
  },
  {
    "function_name": "XOpenDisplay_wr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "1461-1502",
    "snippet": "Display *XOpenDisplay_wr(char *display_name) {\n\tDisplay *d = NULL;\n\tint db = 0;\n\n\tif (! xauth_raw(1)) {\n\t\treturn NULL;\n\t}\n#if NO_X11\n\trfbLog(\"This x11vnc was built without X11 support (-rawfb only).\\n\");\n\tif (!display_name || !d || !db) {}\n\treturn NULL;\n#else\n\n\td = XOpenDisplay(display_name);\n\tif (db) fprintf(stderr, \"XOpenDisplay_wr: %s  %p\\n\", display_name, (void *)d);\n\n\tif (d == NULL && !getenv(\"NO_XAUTHLOCALHOSTNAME\")) {\n\t\tchar *xalhn = getenv(\"XAUTHLOCALHOSTNAME\");\n\t\tif (1 || !xalhn) {\n\t\t\trfbLog(\"XOpenDisplay(\\\"%s\\\") failed.\\n\",\n\t\t\t    display_name ? display_name : \"\");\n\t\t\trfbLog(\"Trying again with XAUTHLOCALHOSTNAME=localhost ...\\n\");\n\t\t\tset_env(\"XAUTHLOCALHOSTNAME\", \"localhost\");\n\t\t\td = XOpenDisplay(display_name);\n\t\t\tif (d == NULL && xalhn) {\n\t\t\t\tchar *ptr = getenv(\"XAUTHLOCALHOSTNAME\");\n\t\t\t\tif (ptr) {\n\t\t\t\t\t*(ptr-2) = '_';\t/* yow */\n\t\t\t\t\trfbLog(\"XOpenDisplay(\\\"%s\\\") failed.\\n\",\n\t\t\t\t\t    display_name ? display_name : \"\");\n\t\t\t\t\trfbLog(\"Trying again with unset XAUTHLOCALHOSTNAME ...\\n\");\n\t\t\t\t\td = XOpenDisplay(display_name);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\txauth_raw(0);\n\n\treturn d;\n#endif\t/* NO_X11 */\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "Display *XOpenDisplay_wr(char *display_name);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "xauth_raw",
          "args": [
            "0"
          ],
          "line": 1498
        },
        "resolved": true,
        "details": {
          "function_name": "xauth_raw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "1405-1459",
          "snippet": "int xauth_raw(int on) {\n\tchar tmp[] = \"/tmp/x11vnc-xauth.XXXXXX\";\n\tint tmp_fd = -1;\n\tstatic char *old_xauthority = NULL;\n\tstatic char *old_tmp = NULL;\n\tint db = 0;\n\n\tif (on) {\n\t\tif (old_xauthority) {\n\t\t\tfree(old_xauthority);\n\t\t\told_xauthority = NULL;\n\t\t}\n\t\tif (old_tmp) {\n\t\t\tfree(old_tmp);\n\t\t\told_tmp = NULL;\n\t\t}\n\t\tif (xauth_raw_data) {\n\t\t\ttmp_fd = mkstemp(tmp);\n\t\t\tif (tmp_fd < 0) {\n\t\t\t\trfbLog(\"could not create tmp xauth file: %s\\n\", tmp);\t\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tif (db) fprintf(stderr, \"XAUTHORITY tmp: %s\\n\", tmp);\n\t\t\twrite(tmp_fd, xauth_raw_data, xauth_raw_len);\n\t\t\tclose(tmp_fd);\n\t\t\tif (getenv(\"XAUTHORITY\")) {\n\t\t\t\told_xauthority = strdup(getenv(\"XAUTHORITY\"));\n\t\t\t} else {\n\t\t\t\told_xauthority = strdup(\"\");\n\t\t\t}\n\t\t\tset_env(\"XAUTHORITY\", tmp);\n\t\t\told_tmp = strdup(tmp);\n\t\t}\n\t\treturn 1;\n\t} else {\n\t\tif (old_xauthority) {\n\t\t\tif (!strcmp(old_xauthority, \"\")) {\n\t\t\t\tchar *xauth = getenv(\"XAUTHORITY\");\n\t\t\t\tif (xauth) {\n\t\t\t\t\t*(xauth-2) = '_';\t/* yow */\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tset_env(\"XAUTHORITY\", old_xauthority);\n\t\t\t}\n\t\t\tfree(old_xauthority);\n\t\t\told_xauthority = NULL;\n\t\t}\n\t\tif (old_tmp) {\n\t\t\tunlink(old_tmp);\n\t\t\tfree(old_tmp);\n\t\t\told_tmp = NULL;\n\t\t}\n\t\treturn 1;\n\t}\n}",
          "includes": [
            "#include \"nox11_funcs.h\"",
            "#include \"xwrappers.h\"",
            "#include \"xi2_devices.h\"",
            "#include \"macosx.h\"",
            "#include \"cleanup.h\"",
            "#include \"connections.h\"",
            "#include \"xevents.h\"",
            "#include \"keyboard.h\"",
            "#include \"xrecord.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int xauth_raw(int on);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint xauth_raw(int on);\n\nint xauth_raw(int on) {\n\tchar tmp[] = \"/tmp/x11vnc-xauth.XXXXXX\";\n\tint tmp_fd = -1;\n\tstatic char *old_xauthority = NULL;\n\tstatic char *old_tmp = NULL;\n\tint db = 0;\n\n\tif (on) {\n\t\tif (old_xauthority) {\n\t\t\tfree(old_xauthority);\n\t\t\told_xauthority = NULL;\n\t\t}\n\t\tif (old_tmp) {\n\t\t\tfree(old_tmp);\n\t\t\told_tmp = NULL;\n\t\t}\n\t\tif (xauth_raw_data) {\n\t\t\ttmp_fd = mkstemp(tmp);\n\t\t\tif (tmp_fd < 0) {\n\t\t\t\trfbLog(\"could not create tmp xauth file: %s\\n\", tmp);\t\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tif (db) fprintf(stderr, \"XAUTHORITY tmp: %s\\n\", tmp);\n\t\t\twrite(tmp_fd, xauth_raw_data, xauth_raw_len);\n\t\t\tclose(tmp_fd);\n\t\t\tif (getenv(\"XAUTHORITY\")) {\n\t\t\t\told_xauthority = strdup(getenv(\"XAUTHORITY\"));\n\t\t\t} else {\n\t\t\t\told_xauthority = strdup(\"\");\n\t\t\t}\n\t\t\tset_env(\"XAUTHORITY\", tmp);\n\t\t\told_tmp = strdup(tmp);\n\t\t}\n\t\treturn 1;\n\t} else {\n\t\tif (old_xauthority) {\n\t\t\tif (!strcmp(old_xauthority, \"\")) {\n\t\t\t\tchar *xauth = getenv(\"XAUTHORITY\");\n\t\t\t\tif (xauth) {\n\t\t\t\t\t*(xauth-2) = '_';\t/* yow */\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tset_env(\"XAUTHORITY\", old_xauthority);\n\t\t\t}\n\t\t\tfree(old_xauthority);\n\t\t\told_xauthority = NULL;\n\t\t}\n\t\tif (old_tmp) {\n\t\t\tunlink(old_tmp);\n\t\t\tfree(old_tmp);\n\t\t\told_tmp = NULL;\n\t\t}\n\t\treturn 1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "XOpenDisplay",
          "args": [
            "display_name"
          ],
          "line": 1492
        },
        "resolved": true,
        "details": {
          "function_name": "XOpenDisplay_wr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "1461-1502",
          "snippet": "Display *XOpenDisplay_wr(char *display_name) {\n\tDisplay *d = NULL;\n\tint db = 0;\n\n\tif (! xauth_raw(1)) {\n\t\treturn NULL;\n\t}\n#if NO_X11\n\trfbLog(\"This x11vnc was built without X11 support (-rawfb only).\\n\");\n\tif (!display_name || !d || !db) {}\n\treturn NULL;\n#else\n\n\td = XOpenDisplay(display_name);\n\tif (db) fprintf(stderr, \"XOpenDisplay_wr: %s  %p\\n\", display_name, (void *)d);\n\n\tif (d == NULL && !getenv(\"NO_XAUTHLOCALHOSTNAME\")) {\n\t\tchar *xalhn = getenv(\"XAUTHLOCALHOSTNAME\");\n\t\tif (1 || !xalhn) {\n\t\t\trfbLog(\"XOpenDisplay(\\\"%s\\\") failed.\\n\",\n\t\t\t    display_name ? display_name : \"\");\n\t\t\trfbLog(\"Trying again with XAUTHLOCALHOSTNAME=localhost ...\\n\");\n\t\t\tset_env(\"XAUTHLOCALHOSTNAME\", \"localhost\");\n\t\t\td = XOpenDisplay(display_name);\n\t\t\tif (d == NULL && xalhn) {\n\t\t\t\tchar *ptr = getenv(\"XAUTHLOCALHOSTNAME\");\n\t\t\t\tif (ptr) {\n\t\t\t\t\t*(ptr-2) = '_';\t/* yow */\n\t\t\t\t\trfbLog(\"XOpenDisplay(\\\"%s\\\") failed.\\n\",\n\t\t\t\t\t    display_name ? display_name : \"\");\n\t\t\t\t\trfbLog(\"Trying again with unset XAUTHLOCALHOSTNAME ...\\n\");\n\t\t\t\t\td = XOpenDisplay(display_name);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\txauth_raw(0);\n\n\treturn d;\n#endif\t/* NO_X11 */\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "rfbLog",
          "args": [
            "\"Trying again with unset XAUTHLOCALHOSTNAME ...\\n\""
          ],
          "line": 1491
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rfbLog",
          "args": [
            "\"XOpenDisplay(\\\"%s\\\") failed.\\n\"",
            "display_name ? display_name : \"\""
          ],
          "line": 1489
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"XAUTHLOCALHOSTNAME\""
          ],
          "line": 1486
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_env",
          "args": [
            "\"XAUTHLOCALHOSTNAME\"",
            "\"localhost\""
          ],
          "line": 1483
        },
        "resolved": true,
        "details": {
          "function_name": "set_env",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/util.c",
          "lines": "239-249",
          "snippet": "void set_env(char *name, char *value) {\n\tchar *str;\n\tif (! name) {\n\t\treturn;\n\t}\n\tif (! value) {\n\t\tvalue = \"\";\n\t}\n\n\tsetenv(name, value, 1);\n}",
          "includes": [
            "#include \"connections.h\"",
            "#include \"unixpw.h\"",
            "#include \"win_utils.h\"",
            "#include \"cleanup.h\"",
            "#include \"x11vnc.h\"",
            "#include <stdlib.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void lowercase(char *str);",
            "void uppercase(char *str);",
            "char *lblanks(char *str);",
            "void strzero(char *str);",
            "void set_env(char *name, char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"connections.h\"\n#include \"unixpw.h\"\n#include \"win_utils.h\"\n#include \"cleanup.h\"\n#include \"x11vnc.h\"\n#include <stdlib.h>\n\nvoid lowercase(char *str);\nvoid uppercase(char *str);\nchar *lblanks(char *str);\nvoid strzero(char *str);\nvoid set_env(char *name, char *value);\n\nvoid set_env(char *name, char *value) {\n\tchar *str;\n\tif (! name) {\n\t\treturn;\n\t}\n\tif (! value) {\n\t\tvalue = \"\";\n\t}\n\n\tsetenv(name, value, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rfbLog",
          "args": [
            "\"Trying again with XAUTHLOCALHOSTNAME=localhost ...\\n\""
          ],
          "line": 1482
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rfbLog",
          "args": [
            "\"XOpenDisplay(\\\"%s\\\") failed.\\n\"",
            "display_name ? display_name : \"\""
          ],
          "line": 1480
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"XAUTHLOCALHOSTNAME\""
          ],
          "line": 1478
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"NO_XAUTHLOCALHOSTNAME\""
          ],
          "line": 1477
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"XOpenDisplay_wr: %s  %p\\n\"",
            "display_name",
            "(void *)d"
          ],
          "line": 1475
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rfbLog",
          "args": [
            "\"This x11vnc was built without X11 support (-rawfb only).\\n\""
          ],
          "line": 1469
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nDisplay *XOpenDisplay_wr(char *display_name);\n\nDisplay *XOpenDisplay_wr(char *display_name) {\n\tDisplay *d = NULL;\n\tint db = 0;\n\n\tif (! xauth_raw(1)) {\n\t\treturn NULL;\n\t}\n#if NO_X11\n\trfbLog(\"This x11vnc was built without X11 support (-rawfb only).\\n\");\n\tif (!display_name || !d || !db) {}\n\treturn NULL;\n#else\n\n\td = XOpenDisplay(display_name);\n\tif (db) fprintf(stderr, \"XOpenDisplay_wr: %s  %p\\n\", display_name, (void *)d);\n\n\tif (d == NULL && !getenv(\"NO_XAUTHLOCALHOSTNAME\")) {\n\t\tchar *xalhn = getenv(\"XAUTHLOCALHOSTNAME\");\n\t\tif (1 || !xalhn) {\n\t\t\trfbLog(\"XOpenDisplay(\\\"%s\\\") failed.\\n\",\n\t\t\t    display_name ? display_name : \"\");\n\t\t\trfbLog(\"Trying again with XAUTHLOCALHOSTNAME=localhost ...\\n\");\n\t\t\tset_env(\"XAUTHLOCALHOSTNAME\", \"localhost\");\n\t\t\td = XOpenDisplay(display_name);\n\t\t\tif (d == NULL && xalhn) {\n\t\t\t\tchar *ptr = getenv(\"XAUTHLOCALHOSTNAME\");\n\t\t\t\tif (ptr) {\n\t\t\t\t\t*(ptr-2) = '_';\t/* yow */\n\t\t\t\t\trfbLog(\"XOpenDisplay(\\\"%s\\\") failed.\\n\",\n\t\t\t\t\t    display_name ? display_name : \"\");\n\t\t\t\t\trfbLog(\"Trying again with unset XAUTHLOCALHOSTNAME ...\\n\");\n\t\t\t\t\td = XOpenDisplay(display_name);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\txauth_raw(0);\n\n\treturn d;\n#endif\t/* NO_X11 */\n}"
  },
  {
    "function_name": "xauth_raw",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "1405-1459",
    "snippet": "int xauth_raw(int on) {\n\tchar tmp[] = \"/tmp/x11vnc-xauth.XXXXXX\";\n\tint tmp_fd = -1;\n\tstatic char *old_xauthority = NULL;\n\tstatic char *old_tmp = NULL;\n\tint db = 0;\n\n\tif (on) {\n\t\tif (old_xauthority) {\n\t\t\tfree(old_xauthority);\n\t\t\told_xauthority = NULL;\n\t\t}\n\t\tif (old_tmp) {\n\t\t\tfree(old_tmp);\n\t\t\told_tmp = NULL;\n\t\t}\n\t\tif (xauth_raw_data) {\n\t\t\ttmp_fd = mkstemp(tmp);\n\t\t\tif (tmp_fd < 0) {\n\t\t\t\trfbLog(\"could not create tmp xauth file: %s\\n\", tmp);\t\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tif (db) fprintf(stderr, \"XAUTHORITY tmp: %s\\n\", tmp);\n\t\t\twrite(tmp_fd, xauth_raw_data, xauth_raw_len);\n\t\t\tclose(tmp_fd);\n\t\t\tif (getenv(\"XAUTHORITY\")) {\n\t\t\t\told_xauthority = strdup(getenv(\"XAUTHORITY\"));\n\t\t\t} else {\n\t\t\t\told_xauthority = strdup(\"\");\n\t\t\t}\n\t\t\tset_env(\"XAUTHORITY\", tmp);\n\t\t\told_tmp = strdup(tmp);\n\t\t}\n\t\treturn 1;\n\t} else {\n\t\tif (old_xauthority) {\n\t\t\tif (!strcmp(old_xauthority, \"\")) {\n\t\t\t\tchar *xauth = getenv(\"XAUTHORITY\");\n\t\t\t\tif (xauth) {\n\t\t\t\t\t*(xauth-2) = '_';\t/* yow */\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tset_env(\"XAUTHORITY\", old_xauthority);\n\t\t\t}\n\t\t\tfree(old_xauthority);\n\t\t\told_xauthority = NULL;\n\t\t}\n\t\tif (old_tmp) {\n\t\t\tunlink(old_tmp);\n\t\t\tfree(old_tmp);\n\t\t\told_tmp = NULL;\n\t\t}\n\t\treturn 1;\n\t}\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int xauth_raw(int on);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "old_tmp"
          ],
          "line": 1454
        },
        "resolved": true,
        "details": {
          "function_name": "free_rect",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/userinput.c",
          "lines": "6200-6247",
          "snippet": "int free_rect(int idx) {\n\tint n, ok = 0;\n\tsraRegionPtr r1, r2;\n\tint x, y, w, h;\n\n\tif (idx < 0 || idx >= cache_list_num) {\nif (0) fprintf(stderr, \"free_rect: bad index: %d\\n\", idx);\n\t\tclean_up_exit(1);\n\t}\n\n\tx = cache_list[idx].bs_x;\n\ty = cache_list[idx].bs_y;\n\tw = cache_list[idx].bs_w;\n\th = cache_list[idx].bs_h;\n\n\tif (x < 0) {\n\t\tCLEAR(idx);\nif (dnow() > last_client + 5 && ncdb) fprintf(stderr, \"free_rect: already bs_x invalidated: %d bs_x: %d\\n\", idx, x);\n\t\treturn 1;\n\t}\n\n\tr2 = sraRgnCreateRect(x, y, x+w, y+h);\n\n\tn = get_bs_n(y);\n\tif (n >= 0) {\n\t\tr1 = rect_reg[n];\n\t\tsraRgnOr(r1, r2);\n\t\tok = 1;\n\t}\n\n\tif (zero_rects) {\n\t\tsraRgnOr(zero_rects, r2);\n\t\tx = cache_list[idx].su_x;\n\t\ty = cache_list[idx].su_y;\n\t\tw = cache_list[idx].su_w;\n\t\th = cache_list[idx].su_h;\n\t\tif (x >= 0) {\n\t\t\tsraRgnDestroy(r2);\n\t\t\tr2 = sraRgnCreateRect(x, y, x+w, y+h);\n\t\t\tsraRgnOr(zero_rects, r2);\n\t\t}\n\t}\n\tsraRgnDestroy(r2);\n\n\tCLEAR(idx);\nif (! ok && ncdb) fprintf(stderr, \"**** free_rect: not-found %d\\n\", idx);\n\treturn ok;\n}",
          "includes": [
            "#include \"default8x16.h\"",
            "#include \"connections.h\"",
            "#include \"screen.h\"",
            "#include \"cursor.h\"",
            "#include \"macosxCGS.h\"",
            "#include \"macosx.h\"",
            "#include \"unixpw.h\"",
            "#include \"8to24.h\"",
            "#include \"xrandr.h\"",
            "#include \"solid.h\"",
            "#include \"keyboard.h\"",
            "#include \"rates.h\"",
            "#include \"pointer.h\"",
            "#include \"cleanup.h\"",
            "#include \"scan.h\"",
            "#include \"user.h\"",
            "#include \"xevents.h\"",
            "#include \"win_utils.h\"",
            "#include \"xinerama.h\"",
            "#include \"xrecord.h\"",
            "#include \"xdamage.h\"",
            "#include \"xwrappers.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void mark_for_xdamage(int x, int y, int w, int h);",
            "void set_xdamage_mark(int x, int y, int w, int h);",
            "int find_rect(int idx, int x, int y, int w, int h);",
            "winattr_t *cache_list;",
            "int clipped(int idx);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"default8x16.h\"\n#include \"connections.h\"\n#include \"screen.h\"\n#include \"cursor.h\"\n#include \"macosxCGS.h\"\n#include \"macosx.h\"\n#include \"unixpw.h\"\n#include \"8to24.h\"\n#include \"xrandr.h\"\n#include \"solid.h\"\n#include \"keyboard.h\"\n#include \"rates.h\"\n#include \"pointer.h\"\n#include \"cleanup.h\"\n#include \"scan.h\"\n#include \"user.h\"\n#include \"xevents.h\"\n#include \"win_utils.h\"\n#include \"xinerama.h\"\n#include \"xrecord.h\"\n#include \"xdamage.h\"\n#include \"xwrappers.h\"\n#include \"x11vnc.h\"\n\nvoid mark_for_xdamage(int x, int y, int w, int h);\nvoid set_xdamage_mark(int x, int y, int w, int h);\nint find_rect(int idx, int x, int y, int w, int h);\nwinattr_t *cache_list;\nint clipped(int idx);\n\nint free_rect(int idx) {\n\tint n, ok = 0;\n\tsraRegionPtr r1, r2;\n\tint x, y, w, h;\n\n\tif (idx < 0 || idx >= cache_list_num) {\nif (0) fprintf(stderr, \"free_rect: bad index: %d\\n\", idx);\n\t\tclean_up_exit(1);\n\t}\n\n\tx = cache_list[idx].bs_x;\n\ty = cache_list[idx].bs_y;\n\tw = cache_list[idx].bs_w;\n\th = cache_list[idx].bs_h;\n\n\tif (x < 0) {\n\t\tCLEAR(idx);\nif (dnow() > last_client + 5 && ncdb) fprintf(stderr, \"free_rect: already bs_x invalidated: %d bs_x: %d\\n\", idx, x);\n\t\treturn 1;\n\t}\n\n\tr2 = sraRgnCreateRect(x, y, x+w, y+h);\n\n\tn = get_bs_n(y);\n\tif (n >= 0) {\n\t\tr1 = rect_reg[n];\n\t\tsraRgnOr(r1, r2);\n\t\tok = 1;\n\t}\n\n\tif (zero_rects) {\n\t\tsraRgnOr(zero_rects, r2);\n\t\tx = cache_list[idx].su_x;\n\t\ty = cache_list[idx].su_y;\n\t\tw = cache_list[idx].su_w;\n\t\th = cache_list[idx].su_h;\n\t\tif (x >= 0) {\n\t\t\tsraRgnDestroy(r2);\n\t\t\tr2 = sraRgnCreateRect(x, y, x+w, y+h);\n\t\t\tsraRgnOr(zero_rects, r2);\n\t\t}\n\t}\n\tsraRgnDestroy(r2);\n\n\tCLEAR(idx);\nif (! ok && ncdb) fprintf(stderr, \"**** free_rect: not-found %d\\n\", idx);\n\treturn ok;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "old_tmp"
          ],
          "line": 1453
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_env",
          "args": [
            "\"XAUTHORITY\"",
            "old_xauthority"
          ],
          "line": 1447
        },
        "resolved": true,
        "details": {
          "function_name": "set_env",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/util.c",
          "lines": "239-249",
          "snippet": "void set_env(char *name, char *value) {\n\tchar *str;\n\tif (! name) {\n\t\treturn;\n\t}\n\tif (! value) {\n\t\tvalue = \"\";\n\t}\n\n\tsetenv(name, value, 1);\n}",
          "includes": [
            "#include \"connections.h\"",
            "#include \"unixpw.h\"",
            "#include \"win_utils.h\"",
            "#include \"cleanup.h\"",
            "#include \"x11vnc.h\"",
            "#include <stdlib.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "void lowercase(char *str);",
            "void uppercase(char *str);",
            "char *lblanks(char *str);",
            "void strzero(char *str);",
            "void set_env(char *name, char *value);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"connections.h\"\n#include \"unixpw.h\"\n#include \"win_utils.h\"\n#include \"cleanup.h\"\n#include \"x11vnc.h\"\n#include <stdlib.h>\n\nvoid lowercase(char *str);\nvoid uppercase(char *str);\nchar *lblanks(char *str);\nvoid strzero(char *str);\nvoid set_env(char *name, char *value);\n\nvoid set_env(char *name, char *value) {\n\tchar *str;\n\tif (! name) {\n\t\treturn;\n\t}\n\tif (! value) {\n\t\tvalue = \"\";\n\t}\n\n\tsetenv(name, value, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"XAUTHORITY\""
          ],
          "line": 1442
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "old_xauthority",
            "\"\""
          ],
          "line": 1441
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "tmp"
          ],
          "line": 1436
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "\"\""
          ],
          "line": 1433
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "getenv(\"XAUTHORITY\")"
          ],
          "line": 1431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"XAUTHORITY\""
          ],
          "line": 1431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"XAUTHORITY\""
          ],
          "line": 1430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "close",
          "args": [
            "tmp_fd"
          ],
          "line": 1429
        },
        "resolved": true,
        "details": {
          "function_name": "close_alarm",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/unixpw.c",
          "lines": "666-672",
          "snippet": "static void close_alarm (int sig) {\n\tif (slave_fd >= 0) {\n\t\tclose(slave_fd);\n\t}\n\talarm_fired = 1;\n\tif (0) sig = 0;\t/* compiler warning */\n}",
          "includes": [
            "#include <sys/stropts.h>",
            "#include <termios.h>",
            "#include <sys/ioctl.h>",
            "#include <shadow.h>",
            "#include \"default8x16.h\"",
            "#include \"rates.h\"",
            "#include \"cursor.h\"",
            "#include \"sslhelper.h\"",
            "#include \"connections.h\"",
            "#include \"user.h\"",
            "#include \"connections.h\"",
            "#include \"xinerama.h\"",
            "#include \"cleanup.h\"",
            "#include \"scan.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int slave_fd = -1, alarm_fired = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <sys/stropts.h>\n#include <termios.h>\n#include <sys/ioctl.h>\n#include <shadow.h>\n#include \"default8x16.h\"\n#include \"rates.h\"\n#include \"cursor.h\"\n#include \"sslhelper.h\"\n#include \"connections.h\"\n#include \"user.h\"\n#include \"connections.h\"\n#include \"xinerama.h\"\n#include \"cleanup.h\"\n#include \"scan.h\"\n#include \"x11vnc.h\"\n\nstatic int slave_fd = -1, alarm_fired = 0;\n\nstatic void close_alarm (int sig) {\n\tif (slave_fd >= 0) {\n\t\tclose(slave_fd);\n\t}\n\talarm_fired = 1;\n\tif (0) sig = 0;\t/* compiler warning */\n}"
        }
      },
      {
        "call_info": {
          "callee": "write",
          "args": [
            "tmp_fd",
            "xauth_raw_data",
            "xauth_raw_len"
          ],
          "line": 1428
        },
        "resolved": true,
        "details": {
          "function_name": "write_exact",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/sslhelper.c",
          "lines": "1319-1344",
          "snippet": "static int write_exact(int sock, char *buf, int len) {\n\tint n, fail = 0;\n\tif (sock < 0) {\n\t\treturn 0;\n\t}\n\twhile (len > 0) {\n\t\tn = write(sock, buf, len);\n\t\tif (n > 0) {\n\t\t\tbuf += n;\n\t\t\tlen -= n;\n\t\t} else if (n == 0) {\n\t\t\tfail = 1;\n\t\t\tbreak;\n\t\t} else if (n < 0 && (errno == EAGAIN || errno == EWOULDBLOCK)) {\n\t\t\tusleep(10*1000);\n\t\t} else if (n < 0 && errno != EINTR) {\n\t\t\tfail = 1;\n\t\t\tbreak;\n\t\t}\n\t}\n\tif (fail) {\n\t\treturn 0;\n\t} else {\n\t\treturn 1;\n\t}\n}",
          "includes": [
            "#include <openssl/rand.h>",
            "#include <openssl/err.h>",
            "#include <openssl/ssl.h>",
            "#include \"user.h\"",
            "#include \"unixpw.h\"",
            "#include \"sslcmds.h\"",
            "#include \"connections.h\"",
            "#include \"scan.h\"",
            "#include \"screen.h\"",
            "#include \"cleanup.h\"",
            "#include \"inet.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void ssl_helper_pid(pid_t pid, int sock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/rand.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n#include \"user.h\"\n#include \"unixpw.h\"\n#include \"sslcmds.h\"\n#include \"connections.h\"\n#include \"scan.h\"\n#include \"screen.h\"\n#include \"cleanup.h\"\n#include \"inet.h\"\n#include \"x11vnc.h\"\n\nvoid ssl_helper_pid(pid_t pid, int sock);\n\nstatic int write_exact(int sock, char *buf, int len) {\n\tint n, fail = 0;\n\tif (sock < 0) {\n\t\treturn 0;\n\t}\n\twhile (len > 0) {\n\t\tn = write(sock, buf, len);\n\t\tif (n > 0) {\n\t\t\tbuf += n;\n\t\t\tlen -= n;\n\t\t} else if (n == 0) {\n\t\t\tfail = 1;\n\t\t\tbreak;\n\t\t} else if (n < 0 && (errno == EAGAIN || errno == EWOULDBLOCK)) {\n\t\t\tusleep(10*1000);\n\t\t} else if (n < 0 && errno != EINTR) {\n\t\t\tfail = 1;\n\t\t\tbreak;\n\t\t}\n\t}\n\tif (fail) {\n\t\treturn 0;\n\t} else {\n\t\treturn 1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"XAUTHORITY tmp: %s\\n\"",
            "tmp"
          ],
          "line": 1427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rfbLog",
          "args": [
            "\"could not create tmp xauth file: %s\\n\"",
            "tmp"
          ],
          "line": 1424
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mkstemp",
          "args": [
            "tmp"
          ],
          "line": 1422
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint xauth_raw(int on);\n\nint xauth_raw(int on) {\n\tchar tmp[] = \"/tmp/x11vnc-xauth.XXXXXX\";\n\tint tmp_fd = -1;\n\tstatic char *old_xauthority = NULL;\n\tstatic char *old_tmp = NULL;\n\tint db = 0;\n\n\tif (on) {\n\t\tif (old_xauthority) {\n\t\t\tfree(old_xauthority);\n\t\t\told_xauthority = NULL;\n\t\t}\n\t\tif (old_tmp) {\n\t\t\tfree(old_tmp);\n\t\t\told_tmp = NULL;\n\t\t}\n\t\tif (xauth_raw_data) {\n\t\t\ttmp_fd = mkstemp(tmp);\n\t\t\tif (tmp_fd < 0) {\n\t\t\t\trfbLog(\"could not create tmp xauth file: %s\\n\", tmp);\t\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tif (db) fprintf(stderr, \"XAUTHORITY tmp: %s\\n\", tmp);\n\t\t\twrite(tmp_fd, xauth_raw_data, xauth_raw_len);\n\t\t\tclose(tmp_fd);\n\t\t\tif (getenv(\"XAUTHORITY\")) {\n\t\t\t\told_xauthority = strdup(getenv(\"XAUTHORITY\"));\n\t\t\t} else {\n\t\t\t\told_xauthority = strdup(\"\");\n\t\t\t}\n\t\t\tset_env(\"XAUTHORITY\", tmp);\n\t\t\told_tmp = strdup(tmp);\n\t\t}\n\t\treturn 1;\n\t} else {\n\t\tif (old_xauthority) {\n\t\t\tif (!strcmp(old_xauthority, \"\")) {\n\t\t\t\tchar *xauth = getenv(\"XAUTHORITY\");\n\t\t\t\tif (xauth) {\n\t\t\t\t\t*(xauth-2) = '_';\t/* yow */\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tset_env(\"XAUTHORITY\", old_xauthority);\n\t\t\t}\n\t\t\tfree(old_xauthority);\n\t\t\told_xauthority = NULL;\n\t\t}\n\t\tif (old_tmp) {\n\t\t\tunlink(old_tmp);\n\t\t\tfree(old_tmp);\n\t\t\told_tmp = NULL;\n\t\t}\n\t\treturn 1;\n\t}\n}"
  },
  {
    "function_name": "XInputQueryVersion_wr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "1385-1402",
    "snippet": "Bool XInputQueryVersion_wr(Display *dpy, int *maj, int *min) {\n\tRAWFB_RET(False)\n#if NO_X11\n\trfbLog(\"This x11vnc was built without X11 support (-rawfb only).\\n\");\n\tif (!dpy || !maj || !min) {}\n\treturn NULL;\n#else\n\tint ignore;\n\tif(! XQueryExtension (dpy, \"XInputExtension\", &ignore, &ignore, &ignore))\n\t  return False;\n#ifdef HAVE_XI2\n\tif (XIQueryVersion(dpy, maj, min) != Success)\n\t  return False;\n#endif\n\n\treturn True;\n#endif\t/* NO_X11 */\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "Bool XTestQueryExtension_wr(Display *dpy, int *ev, int *er, int *maj,\n    int *min);",
      "void XTestDiscard_wr(Display *dpy);",
      "Bool XRecordQueryVersion_wr(Display *dpy, int *maj, int *min);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "XIQueryVersion",
          "args": [
            "dpy",
            "maj",
            "min"
          ],
          "line": 1396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XQueryExtension",
          "args": [
            "dpy",
            "\"XInputExtension\"",
            "&ignore",
            "&ignore",
            "&ignore"
          ],
          "line": 1393
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rfbLog",
          "args": [
            "\"This x11vnc was built without X11 support (-rawfb only).\\n\""
          ],
          "line": 1388
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nBool XTestQueryExtension_wr(Display *dpy, int *ev, int *er, int *maj,\n    int *min);\nvoid XTestDiscard_wr(Display *dpy);\nBool XRecordQueryVersion_wr(Display *dpy, int *maj, int *min);\n\nBool XInputQueryVersion_wr(Display *dpy, int *maj, int *min) {\n\tRAWFB_RET(False)\n#if NO_X11\n\trfbLog(\"This x11vnc was built without X11 support (-rawfb only).\\n\");\n\tif (!dpy || !maj || !min) {}\n\treturn NULL;\n#else\n\tint ignore;\n\tif(! XQueryExtension (dpy, \"XInputExtension\", &ignore, &ignore, &ignore))\n\t  return False;\n#ifdef HAVE_XI2\n\tif (XIQueryVersion(dpy, maj, min) != Success)\n\t  return False;\n#endif\n\n\treturn True;\n#endif\t/* NO_X11 */\n}"
  },
  {
    "function_name": "XRecordQueryVersion_wr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "1374-1382",
    "snippet": "Bool XRecordQueryVersion_wr(Display *dpy, int *maj, int *min) {\n\tRAWFB_RET(False)\n#if HAVE_RECORD\n\treturn XRecordQueryVersion(dpy, maj, min);\n#else\n\tif (!dpy || !maj || !min) {}\n\treturn False;\n#endif\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "Bool XTestQueryExtension_wr(Display *dpy, int *ev, int *er, int *maj,\n    int *min);",
      "void XTestDiscard_wr(Display *dpy);",
      "Bool XRecordQueryVersion_wr(Display *dpy, int *maj, int *min);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "XRecordQueryVersion",
          "args": [
            "dpy",
            "maj",
            "min"
          ],
          "line": 1377
        },
        "resolved": true,
        "details": {
          "function_name": "XRecordQueryVersion_wr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "1374-1382",
          "snippet": "Bool XRecordQueryVersion_wr(Display *dpy, int *maj, int *min) {\n\tRAWFB_RET(False)\n#if HAVE_RECORD\n\treturn XRecordQueryVersion(dpy, maj, min);\n#else\n\tif (!dpy || !maj || !min) {}\n\treturn False;\n#endif\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nBool XTestQueryExtension_wr(Display *dpy, int *ev, int *er, int *maj,\n    int *min);\nvoid XTestDiscard_wr(Display *dpy);\nBool XRecordQueryVersion_wr(Display *dpy, int *maj, int *min);\n\nBool XRecordQueryVersion_wr(Display *dpy, int *maj, int *min) {\n\tRAWFB_RET(False)\n#if HAVE_RECORD\n\treturn XRecordQueryVersion(dpy, maj, min);\n#else\n\tif (!dpy || !maj || !min) {}\n\treturn False;\n#endif\n}"
  },
  {
    "function_name": "disable_grabserver",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "1313-1372",
    "snippet": "void disable_grabserver(Display *in_dpy, int change) {\n\tint ok = 0;\n\tstatic int didmsg = 0;\n\n\tif (debug_grabs) {\n\t\tfprintf(stderr, \"disable_grabserver/%d %.5f\\n\",\n\t\t\txserver_grabbed, dnowx());\n\t\tdidmsg = 0;\n\t}\n\n\tif (! xtrap_input) {\n\t\tif (XTestGrabControl_wr(in_dpy, True)) {\n\t\t\tif (change) {\n\t\t\t\tXTRAP_GrabControl_wr(in_dpy, False);\n\t\t\t}\n\t\t\tif (! didmsg && ! raw_fb_str) {\n\t\t\t\trfbLog(\"GrabServer control via XTEST.\\n\"); \n\t\t\t\tdidmsg = 1;\n\t\t\t}\n\t\t\tok = 1;\n\t\t} else {\n\t\t\tif (XTRAP_GrabControl_wr(in_dpy, True)) {\n\t\t\t\tok = 1;\n\t\t\t\tif (! didmsg && ! raw_fb_str) {\n\t\t\t\t\trfbLog(\"Using DEC-XTRAP for protection\"\n\t\t\t\t\t    \" from XGrabServer.\\n\");\n\t\t\t\t\tdidmsg = 1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif (XTRAP_GrabControl_wr(in_dpy, True)) {\n\t\t\tif (change) {\n\t\t\t\tXTestGrabControl_wr(in_dpy, False);\n\t\t\t}\n\t\t\tif (! didmsg && ! raw_fb_str) {\n\t\t\t\trfbLog(\"GrabServer control via DEC-XTRAP.\\n\"); \n\t\t\t\tdidmsg = 1;\n\t\t\t}\n\t\t\tok = 1;\n\t\t} else {\n\t\t\tif (XTestGrabControl_wr(in_dpy, True)) {\n\t\t\t\tok = 1;\n\t\t\t\tif (! didmsg && ! raw_fb_str) {\n\t\t\t\t\trfbLog(\"DEC-XTRAP XGrabServer \"\n\t\t\t\t\t    \"protection not available, \"\n\t\t\t\t\t    \"using XTEST.\\n\");\n\t\t\t\t\tdidmsg = 1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tif (! ok && ! didmsg) {\n\t\trfbLog(\"*********************************************************\\n\");\n\t\trfbLog(\"* No XTEST or DEC-XTRAP protection from XGrabServer !!! *\\n\");\n\t\trfbLog(\"* DEADLOCK if your window manager calls XGrabServer !!! *\\n\");\n\t\trfbLog(\"*********************************************************\\n\");\n\t}\n\tXFlush_wr(in_dpy);\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void disable_grabserver(Display *in_dpy, int change);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "XFlush_wr",
          "args": [
            "in_dpy"
          ],
          "line": 1371
        },
        "resolved": true,
        "details": {
          "function_name": "XFlush_wr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "154-165",
          "snippet": "int XFlush_wr(Display *disp) {\n#if NO_X11\n\tif (!disp) {}\n\treturn 1;\n#else\n\tif (disp) {\n\t\treturn XFlush(disp);\n\t} else {\n\t\treturn 1;\n\t}\n#endif\t/* NO_X11 */\n}",
          "includes": [
            "#include \"nox11_funcs.h\"",
            "#include \"xwrappers.h\"",
            "#include \"xi2_devices.h\"",
            "#include \"macosx.h\"",
            "#include \"cleanup.h\"",
            "#include \"connections.h\"",
            "#include \"xevents.h\"",
            "#include \"keyboard.h\"",
            "#include \"xrecord.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int XFlush_wr(Display *disp);",
            "Bool XShmQueryExtension_wr(Display *disp);",
            "int XShmGetEventBase_wr(Display *disp);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint XFlush_wr(Display *disp);\nBool XShmQueryExtension_wr(Display *disp);\nint XShmGetEventBase_wr(Display *disp);\n\nint XFlush_wr(Display *disp) {\n#if NO_X11\n\tif (!disp) {}\n\treturn 1;\n#else\n\tif (disp) {\n\t\treturn XFlush(disp);\n\t} else {\n\t\treturn 1;\n\t}\n#endif\t/* NO_X11 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "rfbLog",
          "args": [
            "\"*********************************************************\\n\""
          ],
          "line": 1369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rfbLog",
          "args": [
            "\"* DEADLOCK if your window manager calls XGrabServer !!! *\\n\""
          ],
          "line": 1368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rfbLog",
          "args": [
            "\"* No XTEST or DEC-XTRAP protection from XGrabServer !!! *\\n\""
          ],
          "line": 1367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rfbLog",
          "args": [
            "\"*********************************************************\\n\""
          ],
          "line": 1366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rfbLog",
          "args": [
            "\"DEC-XTRAP XGrabServer \"\n\t\t\t\t\t    \"protection not available, \"\n\t\t\t\t\t    \"using XTEST.\\n\""
          ],
          "line": 1357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XTestGrabControl_wr",
          "args": [
            "in_dpy",
            "True"
          ],
          "line": 1354
        },
        "resolved": true,
        "details": {
          "function_name": "XTestGrabControl_wr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "1260-1272",
          "snippet": "int XTestGrabControl_wr(Display *dpy, Bool impervious) {\n\tif (! xtest_present) {\n\t\treturn 0;\n\t}\n\tRAWFB_RET(0)\n#if HAVE_XTEST && HAVE_XTESTGRABCONTROL\n\tXTestGrabControl(dpy, impervious);\n\treturn 1;\n#else\n\tif (!dpy || !impervious) {}\n\treturn 0;\n#endif\n}",
          "includes": [
            "#include \"nox11_funcs.h\"",
            "#include \"xwrappers.h\"",
            "#include \"xi2_devices.h\"",
            "#include \"macosx.h\"",
            "#include \"cleanup.h\"",
            "#include \"connections.h\"",
            "#include \"xevents.h\"",
            "#include \"keyboard.h\"",
            "#include \"xrecord.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int xtest_present = 0;",
            "void XTestDiscard_wr(Display *dpy);",
            "int XTestGrabControl_wr(Display *dpy, Bool impervious);",
            "int XTRAP_GrabControl_wr(Display *dpy, Bool impervious);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint xtest_present = 0;\nvoid XTestDiscard_wr(Display *dpy);\nint XTestGrabControl_wr(Display *dpy, Bool impervious);\nint XTRAP_GrabControl_wr(Display *dpy, Bool impervious);\n\nint XTestGrabControl_wr(Display *dpy, Bool impervious) {\n\tif (! xtest_present) {\n\t\treturn 0;\n\t}\n\tRAWFB_RET(0)\n#if HAVE_XTEST && HAVE_XTESTGRABCONTROL\n\tXTestGrabControl(dpy, impervious);\n\treturn 1;\n#else\n\tif (!dpy || !impervious) {}\n\treturn 0;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "rfbLog",
          "args": [
            "\"GrabServer control via DEC-XTRAP.\\n\""
          ],
          "line": 1349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XTRAP_GrabControl_wr",
          "args": [
            "in_dpy",
            "True"
          ],
          "line": 1344
        },
        "resolved": true,
        "details": {
          "function_name": "XTRAP_GrabControl_wr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "1274-1311",
          "snippet": "int XTRAP_GrabControl_wr(Display *dpy, Bool impervious) {\n\tif (! xtrap_present) {\n\t\t/* unused vars warning: */\n\t\tif (dpy || impervious) {}\n\t\treturn 0;\n\t}\n\tRAWFB_RET(0)\n#if HAVE_LIBXTRAP\n\t  else {\n\t\tReqFlags requests;\n\n\t\tif (! impervious) {\n\t\t\tif (trap_ctx) {\n\t\t\t\tXEFreeTC(trap_ctx);\n\t\t\t}\n\t\t\ttrap_ctx = NULL;\n\t\t\treturn 1;\n\t\t}\n\n\t\tif (! trap_ctx) {\n\t\t\ttrap_ctx = XECreateTC(dpy, 0, NULL);\n\t\t\tif (! trap_ctx) {\n\t\t\t\trfbLog(\"DEC-XTRAP XECreateTC failed.  Watch \"\n\t\t\t\t    \"out for XGrabServer from wm's\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tXEStartTrapRequest(trap_ctx);\n\t\t\tmemset(requests, 0, sizeof(requests));\n\t\t\tBitTrue(requests, X_GrabServer);\n\t\t\tBitTrue(requests, X_UngrabServer);\n\t\t\tXETrapSetRequests(trap_ctx, True, requests);\n\t\t\tXETrapSetGrabServer(trap_ctx, True);\n\t\t}\n\t\treturn 1;\n\t}\n#endif\n\treturn 0;\n}",
          "includes": [
            "#include \"nox11_funcs.h\"",
            "#include \"xwrappers.h\"",
            "#include \"xi2_devices.h\"",
            "#include \"macosx.h\"",
            "#include \"cleanup.h\"",
            "#include \"connections.h\"",
            "#include \"xevents.h\"",
            "#include \"keyboard.h\"",
            "#include \"xrecord.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int xtrap_present = 0;",
            "void XTestDiscard_wr(Display *dpy);",
            "int XTestGrabControl_wr(Display *dpy, Bool impervious);",
            "int XTRAP_GrabControl_wr(Display *dpy, Bool impervious);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint xtrap_present = 0;\nvoid XTestDiscard_wr(Display *dpy);\nint XTestGrabControl_wr(Display *dpy, Bool impervious);\nint XTRAP_GrabControl_wr(Display *dpy, Bool impervious);\n\nint XTRAP_GrabControl_wr(Display *dpy, Bool impervious) {\n\tif (! xtrap_present) {\n\t\t/* unused vars warning: */\n\t\tif (dpy || impervious) {}\n\t\treturn 0;\n\t}\n\tRAWFB_RET(0)\n#if HAVE_LIBXTRAP\n\t  else {\n\t\tReqFlags requests;\n\n\t\tif (! impervious) {\n\t\t\tif (trap_ctx) {\n\t\t\t\tXEFreeTC(trap_ctx);\n\t\t\t}\n\t\t\ttrap_ctx = NULL;\n\t\t\treturn 1;\n\t\t}\n\n\t\tif (! trap_ctx) {\n\t\t\ttrap_ctx = XECreateTC(dpy, 0, NULL);\n\t\t\tif (! trap_ctx) {\n\t\t\t\trfbLog(\"DEC-XTRAP XECreateTC failed.  Watch \"\n\t\t\t\t    \"out for XGrabServer from wm's\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tXEStartTrapRequest(trap_ctx);\n\t\t\tmemset(requests, 0, sizeof(requests));\n\t\t\tBitTrue(requests, X_GrabServer);\n\t\t\tBitTrue(requests, X_UngrabServer);\n\t\t\tXETrapSetRequests(trap_ctx, True, requests);\n\t\t\tXETrapSetGrabServer(trap_ctx, True);\n\t\t}\n\t\treturn 1;\n\t}\n#endif\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rfbLog",
          "args": [
            "\"Using DEC-XTRAP for protection\"\n\t\t\t\t\t    \" from XGrabServer.\\n\""
          ],
          "line": 1337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rfbLog",
          "args": [
            "\"GrabServer control via XTEST.\\n\""
          ],
          "line": 1329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"disable_grabserver/%d %.5f\\n\"",
            "xserver_grabbed",
            "dnowx()"
          ],
          "line": 1318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dnowx",
          "args": [],
          "line": 1319
        },
        "resolved": true,
        "details": {
          "function_name": "dnowx",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/util.c",
          "lines": "439-441",
          "snippet": "double dnowx(void) {\n\treturn dnow() - x11vnc_start;\n}",
          "includes": [
            "#include \"connections.h\"",
            "#include \"unixpw.h\"",
            "#include \"win_utils.h\"",
            "#include \"cleanup.h\"",
            "#include \"x11vnc.h\"",
            "#include <stdlib.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "double dnow(void);",
            "double dnowx(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"connections.h\"\n#include \"unixpw.h\"\n#include \"win_utils.h\"\n#include \"cleanup.h\"\n#include \"x11vnc.h\"\n#include <stdlib.h>\n\ndouble dnow(void);\ndouble dnowx(void);\n\ndouble dnowx(void) {\n\treturn dnow() - x11vnc_start;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nvoid disable_grabserver(Display *in_dpy, int change);\n\nvoid disable_grabserver(Display *in_dpy, int change) {\n\tint ok = 0;\n\tstatic int didmsg = 0;\n\n\tif (debug_grabs) {\n\t\tfprintf(stderr, \"disable_grabserver/%d %.5f\\n\",\n\t\t\txserver_grabbed, dnowx());\n\t\tdidmsg = 0;\n\t}\n\n\tif (! xtrap_input) {\n\t\tif (XTestGrabControl_wr(in_dpy, True)) {\n\t\t\tif (change) {\n\t\t\t\tXTRAP_GrabControl_wr(in_dpy, False);\n\t\t\t}\n\t\t\tif (! didmsg && ! raw_fb_str) {\n\t\t\t\trfbLog(\"GrabServer control via XTEST.\\n\"); \n\t\t\t\tdidmsg = 1;\n\t\t\t}\n\t\t\tok = 1;\n\t\t} else {\n\t\t\tif (XTRAP_GrabControl_wr(in_dpy, True)) {\n\t\t\t\tok = 1;\n\t\t\t\tif (! didmsg && ! raw_fb_str) {\n\t\t\t\t\trfbLog(\"Using DEC-XTRAP for protection\"\n\t\t\t\t\t    \" from XGrabServer.\\n\");\n\t\t\t\t\tdidmsg = 1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif (XTRAP_GrabControl_wr(in_dpy, True)) {\n\t\t\tif (change) {\n\t\t\t\tXTestGrabControl_wr(in_dpy, False);\n\t\t\t}\n\t\t\tif (! didmsg && ! raw_fb_str) {\n\t\t\t\trfbLog(\"GrabServer control via DEC-XTRAP.\\n\"); \n\t\t\t\tdidmsg = 1;\n\t\t\t}\n\t\t\tok = 1;\n\t\t} else {\n\t\t\tif (XTestGrabControl_wr(in_dpy, True)) {\n\t\t\t\tok = 1;\n\t\t\t\tif (! didmsg && ! raw_fb_str) {\n\t\t\t\t\trfbLog(\"DEC-XTRAP XGrabServer \"\n\t\t\t\t\t    \"protection not available, \"\n\t\t\t\t\t    \"using XTEST.\\n\");\n\t\t\t\t\tdidmsg = 1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tif (! ok && ! didmsg) {\n\t\trfbLog(\"*********************************************************\\n\");\n\t\trfbLog(\"* No XTEST or DEC-XTRAP protection from XGrabServer !!! *\\n\");\n\t\trfbLog(\"* DEADLOCK if your window manager calls XGrabServer !!! *\\n\");\n\t\trfbLog(\"*********************************************************\\n\");\n\t}\n\tXFlush_wr(in_dpy);\n}"
  },
  {
    "function_name": "XTRAP_GrabControl_wr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "1274-1311",
    "snippet": "int XTRAP_GrabControl_wr(Display *dpy, Bool impervious) {\n\tif (! xtrap_present) {\n\t\t/* unused vars warning: */\n\t\tif (dpy || impervious) {}\n\t\treturn 0;\n\t}\n\tRAWFB_RET(0)\n#if HAVE_LIBXTRAP\n\t  else {\n\t\tReqFlags requests;\n\n\t\tif (! impervious) {\n\t\t\tif (trap_ctx) {\n\t\t\t\tXEFreeTC(trap_ctx);\n\t\t\t}\n\t\t\ttrap_ctx = NULL;\n\t\t\treturn 1;\n\t\t}\n\n\t\tif (! trap_ctx) {\n\t\t\ttrap_ctx = XECreateTC(dpy, 0, NULL);\n\t\t\tif (! trap_ctx) {\n\t\t\t\trfbLog(\"DEC-XTRAP XECreateTC failed.  Watch \"\n\t\t\t\t    \"out for XGrabServer from wm's\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tXEStartTrapRequest(trap_ctx);\n\t\t\tmemset(requests, 0, sizeof(requests));\n\t\t\tBitTrue(requests, X_GrabServer);\n\t\t\tBitTrue(requests, X_UngrabServer);\n\t\t\tXETrapSetRequests(trap_ctx, True, requests);\n\t\t\tXETrapSetGrabServer(trap_ctx, True);\n\t\t}\n\t\treturn 1;\n\t}\n#endif\n\treturn 0;\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int xtrap_present = 0;",
      "void XTestDiscard_wr(Display *dpy);",
      "int XTestGrabControl_wr(Display *dpy, Bool impervious);",
      "int XTRAP_GrabControl_wr(Display *dpy, Bool impervious);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "XETrapSetGrabServer",
          "args": [
            "trap_ctx",
            "True"
          ],
          "line": 1305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XETrapSetRequests",
          "args": [
            "trap_ctx",
            "True",
            "requests"
          ],
          "line": 1304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BitTrue",
          "args": [
            "requests",
            "X_UngrabServer"
          ],
          "line": 1303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BitTrue",
          "args": [
            "requests",
            "X_GrabServer"
          ],
          "line": 1302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "requests",
            "0",
            "sizeof(requests)"
          ],
          "line": 1301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XEStartTrapRequest",
          "args": [
            "trap_ctx"
          ],
          "line": 1300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rfbLog",
          "args": [
            "\"DEC-XTRAP XECreateTC failed.  Watch \"\n\t\t\t\t    \"out for XGrabServer from wm's\\n\""
          ],
          "line": 1296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XECreateTC",
          "args": [
            "dpy",
            "0",
            "NULL"
          ],
          "line": 1294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XEFreeTC",
          "args": [
            "trap_ctx"
          ],
          "line": 1287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RAWFB_RET",
          "args": [
            "0"
          ],
          "line": 1280
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint xtrap_present = 0;\nvoid XTestDiscard_wr(Display *dpy);\nint XTestGrabControl_wr(Display *dpy, Bool impervious);\nint XTRAP_GrabControl_wr(Display *dpy, Bool impervious);\n\nint XTRAP_GrabControl_wr(Display *dpy, Bool impervious) {\n\tif (! xtrap_present) {\n\t\t/* unused vars warning: */\n\t\tif (dpy || impervious) {}\n\t\treturn 0;\n\t}\n\tRAWFB_RET(0)\n#if HAVE_LIBXTRAP\n\t  else {\n\t\tReqFlags requests;\n\n\t\tif (! impervious) {\n\t\t\tif (trap_ctx) {\n\t\t\t\tXEFreeTC(trap_ctx);\n\t\t\t}\n\t\t\ttrap_ctx = NULL;\n\t\t\treturn 1;\n\t\t}\n\n\t\tif (! trap_ctx) {\n\t\t\ttrap_ctx = XECreateTC(dpy, 0, NULL);\n\t\t\tif (! trap_ctx) {\n\t\t\t\trfbLog(\"DEC-XTRAP XECreateTC failed.  Watch \"\n\t\t\t\t    \"out for XGrabServer from wm's\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tXEStartTrapRequest(trap_ctx);\n\t\t\tmemset(requests, 0, sizeof(requests));\n\t\t\tBitTrue(requests, X_GrabServer);\n\t\t\tBitTrue(requests, X_UngrabServer);\n\t\t\tXETrapSetRequests(trap_ctx, True, requests);\n\t\t\tXETrapSetGrabServer(trap_ctx, True);\n\t\t}\n\t\treturn 1;\n\t}\n#endif\n\treturn 0;\n}"
  },
  {
    "function_name": "XTestGrabControl_wr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "1260-1272",
    "snippet": "int XTestGrabControl_wr(Display *dpy, Bool impervious) {\n\tif (! xtest_present) {\n\t\treturn 0;\n\t}\n\tRAWFB_RET(0)\n#if HAVE_XTEST && HAVE_XTESTGRABCONTROL\n\tXTestGrabControl(dpy, impervious);\n\treturn 1;\n#else\n\tif (!dpy || !impervious) {}\n\treturn 0;\n#endif\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int xtest_present = 0;",
      "void XTestDiscard_wr(Display *dpy);",
      "int XTestGrabControl_wr(Display *dpy, Bool impervious);",
      "int XTRAP_GrabControl_wr(Display *dpy, Bool impervious);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "XTestGrabControl",
          "args": [
            "dpy",
            "impervious"
          ],
          "line": 1266
        },
        "resolved": true,
        "details": {
          "function_name": "XTestGrabControl_wr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "1260-1272",
          "snippet": "int XTestGrabControl_wr(Display *dpy, Bool impervious) {\n\tif (! xtest_present) {\n\t\treturn 0;\n\t}\n\tRAWFB_RET(0)\n#if HAVE_XTEST && HAVE_XTESTGRABCONTROL\n\tXTestGrabControl(dpy, impervious);\n\treturn 1;\n#else\n\tif (!dpy || !impervious) {}\n\treturn 0;\n#endif\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "RAWFB_RET",
          "args": [
            "0"
          ],
          "line": 1264
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint xtest_present = 0;\nvoid XTestDiscard_wr(Display *dpy);\nint XTestGrabControl_wr(Display *dpy, Bool impervious);\nint XTRAP_GrabControl_wr(Display *dpy, Bool impervious);\n\nint XTestGrabControl_wr(Display *dpy, Bool impervious) {\n\tif (! xtest_present) {\n\t\treturn 0;\n\t}\n\tRAWFB_RET(0)\n#if HAVE_XTEST && HAVE_XTESTGRABCONTROL\n\tXTestGrabControl(dpy, impervious);\n\treturn 1;\n#else\n\tif (!dpy || !impervious) {}\n\treturn 0;\n#endif\n}"
  },
  {
    "function_name": "XETrapQueryExtension_wr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "1248-1258",
    "snippet": "Bool XETrapQueryExtension_wr(Display *dpy, int *ev, int *er, int *op) {\n\tRAWFB_RET(False)\n#if HAVE_LIBXTRAP\n\treturn XETrapQueryExtension(dpy, (INT32 *)ev, (INT32 *)er,\n\t    (INT32 *)op);\n#else\n\t/* unused vars warning: */\n\tif (ev || er || op) {}\n\treturn False;\n#endif\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void XTestDiscard_wr(Display *dpy);",
      "Bool XETrapQueryExtension_wr(Display *dpy, int *ev, int *er, int *op);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "XETrapQueryExtension",
          "args": [
            "dpy",
            "(INT32 *)ev",
            "(INT32 *)er",
            "(INT32 *)op"
          ],
          "line": 1251
        },
        "resolved": true,
        "details": {
          "function_name": "XETrapQueryExtension_wr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "1248-1258",
          "snippet": "Bool XETrapQueryExtension_wr(Display *dpy, int *ev, int *er, int *op) {\n\tRAWFB_RET(False)\n#if HAVE_LIBXTRAP\n\treturn XETrapQueryExtension(dpy, (INT32 *)ev, (INT32 *)er,\n\t    (INT32 *)op);\n#else\n\t/* unused vars warning: */\n\tif (ev || er || op) {}\n\treturn False;\n#endif\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nvoid XTestDiscard_wr(Display *dpy);\nBool XETrapQueryExtension_wr(Display *dpy, int *ev, int *er, int *op);\n\nBool XETrapQueryExtension_wr(Display *dpy, int *ev, int *er, int *op) {\n\tRAWFB_RET(False)\n#if HAVE_LIBXTRAP\n\treturn XETrapQueryExtension(dpy, (INT32 *)ev, (INT32 *)er,\n\t    (INT32 *)op);\n#else\n\t/* unused vars warning: */\n\tif (ev || er || op) {}\n\treturn False;\n#endif\n}"
  },
  {
    "function_name": "XTestDiscard_wr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "1236-1246",
    "snippet": "void XTestDiscard_wr(Display *dpy) {\n\tif (! xtest_present) {\n\t\treturn;\n\t}\n\tRAWFB_RET_VOID\n#if HAVE_XTEST\n\tXTestDiscard(dpy);\n#else\n\tif (!dpy) {}\n#endif\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int xtest_present = 0;",
      "void XTestDiscard_wr(Display *dpy);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "XTestDiscard",
          "args": [
            "dpy"
          ],
          "line": 1242
        },
        "resolved": true,
        "details": {
          "function_name": "XTestDiscard_wr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "1236-1246",
          "snippet": "void XTestDiscard_wr(Display *dpy) {\n\tif (! xtest_present) {\n\t\treturn;\n\t}\n\tRAWFB_RET_VOID\n#if HAVE_XTEST\n\tXTestDiscard(dpy);\n#else\n\tif (!dpy) {}\n#endif\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint xtest_present = 0;\nvoid XTestDiscard_wr(Display *dpy);\n\nvoid XTestDiscard_wr(Display *dpy) {\n\tif (! xtest_present) {\n\t\treturn;\n\t}\n\tRAWFB_RET_VOID\n#if HAVE_XTEST\n\tXTestDiscard(dpy);\n#else\n\tif (!dpy) {}\n#endif\n}"
  },
  {
    "function_name": "XTestQueryExtension_wr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "1225-1234",
    "snippet": "Bool XTestQueryExtension_wr(Display *dpy, int *ev, int *er, int *maj,\n    int *min) {\n\tRAWFB_RET(False)\n#if HAVE_XTEST\n\treturn XTestQueryExtension(dpy, ev, er, maj, min);\n#else\n\tif (!dpy || !ev || !er || !maj || !min) {}\n\treturn False;\n#endif\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "Bool XTestQueryExtension_wr(Display *dpy, int *ev, int *er, int *maj,\n    int *min);",
      "void XTestDiscard_wr(Display *dpy);",
      "Bool XRecordQueryVersion_wr(Display *dpy, int *maj, int *min);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "XTestQueryExtension",
          "args": [
            "dpy",
            "ev",
            "er",
            "maj",
            "min"
          ],
          "line": 1229
        },
        "resolved": true,
        "details": {
          "function_name": "XTestQueryExtension_wr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "1225-1234",
          "snippet": "Bool XTestQueryExtension_wr(Display *dpy, int *ev, int *er, int *maj,\n    int *min) {\n\tRAWFB_RET(False)\n#if HAVE_XTEST\n\treturn XTestQueryExtension(dpy, ev, er, maj, min);\n#else\n\tif (!dpy || !ev || !er || !maj || !min) {}\n\treturn False;\n#endif\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nBool XTestQueryExtension_wr(Display *dpy, int *ev, int *er, int *maj,\n    int *min);\nvoid XTestDiscard_wr(Display *dpy);\nBool XRecordQueryVersion_wr(Display *dpy, int *maj, int *min);\n\nBool XTestQueryExtension_wr(Display *dpy, int *ev, int *er, int *maj,\n    int *min) {\n\tRAWFB_RET(False)\n#if HAVE_XTEST\n\treturn XTestQueryExtension(dpy, ev, er, maj, min);\n#else\n\tif (!dpy || !ev || !er || !maj || !min) {}\n\treturn False;\n#endif\n}"
  },
  {
    "function_name": "XTestCompareCursorWithWindow_wr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "1212-1223",
    "snippet": "Bool XTestCompareCursorWithWindow_wr(Display* dpy, Window w, Cursor cursor) {\n\tif (! xtest_present) {\n\t\treturn False;\n\t}\n\tRAWFB_RET(False)\n#if HAVE_XTEST\n\treturn XTestCompareCursorWithWindow(dpy, w, cursor);\n#else\n\tif (!dpy || !w || !cursor) {}\n\treturn False;\n#endif\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int xtest_present = 0;",
      "Bool XTestCompareCurrentCursorWithWindow_wr(Display* dpy, Window w);",
      "Bool XTestCompareCursorWithWindow_wr(Display* dpy, Window w, Cursor cursor);",
      "void XTestDiscard_wr(Display *dpy);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "XTestCompareCursorWithWindow",
          "args": [
            "dpy",
            "w",
            "cursor"
          ],
          "line": 1218
        },
        "resolved": true,
        "details": {
          "function_name": "XTestCompareCursorWithWindow_wr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "1212-1223",
          "snippet": "Bool XTestCompareCursorWithWindow_wr(Display* dpy, Window w, Cursor cursor) {\n\tif (! xtest_present) {\n\t\treturn False;\n\t}\n\tRAWFB_RET(False)\n#if HAVE_XTEST\n\treturn XTestCompareCursorWithWindow(dpy, w, cursor);\n#else\n\tif (!dpy || !w || !cursor) {}\n\treturn False;\n#endif\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint xtest_present = 0;\nBool XTestCompareCurrentCursorWithWindow_wr(Display* dpy, Window w);\nBool XTestCompareCursorWithWindow_wr(Display* dpy, Window w, Cursor cursor);\nvoid XTestDiscard_wr(Display *dpy);\n\nBool XTestCompareCursorWithWindow_wr(Display* dpy, Window w, Cursor cursor) {\n\tif (! xtest_present) {\n\t\treturn False;\n\t}\n\tRAWFB_RET(False)\n#if HAVE_XTEST\n\treturn XTestCompareCursorWithWindow(dpy, w, cursor);\n#else\n\tif (!dpy || !w || !cursor) {}\n\treturn False;\n#endif\n}"
  },
  {
    "function_name": "XTestCompareCurrentCursorWithWindow_wr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "1198-1210",
    "snippet": "Bool XTestCompareCurrentCursorWithWindow_wr(Display* dpy, Window w) {\n\tif (! xtest_present) {\n\t\treturn False;\n\t}\n\tRAWFB_RET(False)\n\n#if HAVE_XTEST\n\treturn XTestCompareCurrentCursorWithWindow(dpy, w);\n#else\n\tif (!w) {}\n\treturn False;\n#endif\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int xtest_present = 0;",
      "Bool XTestCompareCurrentCursorWithWindow_wr(Display* dpy, Window w);",
      "void XTestDiscard_wr(Display *dpy);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "XTestCompareCurrentCursorWithWindow",
          "args": [
            "dpy",
            "w"
          ],
          "line": 1205
        },
        "resolved": true,
        "details": {
          "function_name": "XTestCompareCurrentCursorWithWindow_wr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "1198-1210",
          "snippet": "Bool XTestCompareCurrentCursorWithWindow_wr(Display* dpy, Window w) {\n\tif (! xtest_present) {\n\t\treturn False;\n\t}\n\tRAWFB_RET(False)\n\n#if HAVE_XTEST\n\treturn XTestCompareCurrentCursorWithWindow(dpy, w);\n#else\n\tif (!w) {}\n\treturn False;\n#endif\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint xtest_present = 0;\nBool XTestCompareCurrentCursorWithWindow_wr(Display* dpy, Window w);\nvoid XTestDiscard_wr(Display *dpy);\n\nBool XTestCompareCurrentCursorWithWindow_wr(Display* dpy, Window w) {\n\tif (! xtest_present) {\n\t\treturn False;\n\t}\n\tRAWFB_RET(False)\n\n#if HAVE_XTEST\n\treturn XTestCompareCurrentCursorWithWindow(dpy, w);\n#else\n\tif (!w) {}\n\treturn False;\n#endif\n}"
  },
  {
    "function_name": "XTestFakeMotionEvent_wr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "1137-1196",
    "snippet": "void XTestFakeMotionEvent_wr(Display* dpy, int dev_id, int screen, int x, int y,\n    unsigned long delay) {\n\tint regrab = 0;\n\n\tRAWFB_RET_VOID\n#if NO_X11\n\tnox11_exit(1);\n\tif (!dpy || !screen || !x || !y || !delay) {}\n\treturn;\n#else\n\n\tif (grab_ptr) {\n\t\tXUngrabPointer(dpy, CurrentTime);\n\t\tregrab = 1;\n\t}\n\tif (grab_kbd && ungrab_both) {\n\t\tXUngrabKeyboard(dpy, CurrentTime);\n\t\tregrab = 1;\n\t}\n\n\tif (xtrap_input) {\n\t\tXTRAP_FakeMotionEvent_wr(dpy, screen, x, y, delay);\n\t\tif (regrab) {\n\t\t\tadjust_grabs(1, 1);\n\t\t}\n\t\treturn;\n\t}\n\n\tif (debug_pointer) {\n\t\trfbLog(\"calling XTestFakeMotionEvent(%d, %d)  %.4f\\n\",\n\t\t    x, y, dnowx());\t\n\t}\n#if HAVE_XTEST\n#ifdef HAVE_XI2\n    if(use_multipointer && dev_id >= 0)\n      {\n        XErrorHandler old_handler;\n        int axes[] = {x, y};\n\tXDevice xdev;\n\txdev.device_id = dev_id;\n\n        /* there can be a race condition where this is called when the XI2 device has not yet been created */\n        old_handler = XSetErrorHandler(trap_xerror);\n        trapped_xerror = 0;\n\n        XTestFakeDeviceMotionEvent(dpy, &xdev, 0, 0, axes, 2, delay);\n\n        XSetErrorHandler(old_handler);\n        if (trapped_xerror) \n          trapped_xerror = 0;\n      }\n    else\n#endif\n          XTestFakeMotionEvent(dpy, screen, x, y, delay);\n#endif\n\tif (regrab) {\n\t\tadjust_grabs(1, 1);\n\t}\n#endif\t/* NO_X11 */\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "void XTRAP_FakeKeyEvent_wr(Display* dpy, KeyCode key, Bool down,\n    unsigned long delay);",
      "void XTestFakeKeyEvent_wr(Display* dpy, int dev_id, KeyCode key, Bool down,\n    unsigned long delay);",
      "void XTRAP_FakeButtonEvent_wr(Display* dpy, unsigned int button, Bool is_press,\n    unsigned long delay);",
      "void XTestFakeButtonEvent_wr(Display* dpy, int dev_id, unsigned int button, Bool is_press,\n    unsigned long delay);",
      "void XTRAP_FakeMotionEvent_wr(Display* dpy, int screen, int x, int y,\n    unsigned long delay);",
      "void XTestFakeMotionEvent_wr(Display* dpy, int dev_id, int screen, int x, int y,\n    unsigned long delay);",
      "void XTestDiscard_wr(Display *dpy);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "adjust_grabs",
          "args": [
            "1",
            "1"
          ],
          "line": 1193
        },
        "resolved": true,
        "details": {
          "function_name": "adjust_grabs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/connections.c",
          "lines": "4335-4372",
          "snippet": "void adjust_grabs(int grab, int quiet) {\n\tRAWFB_RET_VOID\n#if NO_X11\n\tif (!grab || !quiet) {}\n\treturn;\n#else\n\t/* n.b. caller decides to X_LOCK or not. */\n\tif (grab) {\n\t\tif (grab_kbd) {\n\t\t\tif (! quiet) {\n\t\t\t\trfbLog(\"grabbing keyboard with XGrabKeyboard\\n\");\n\t\t\t}\n\t\t\tXGrabKeyboard(dpy, window, False, GrabModeAsync,\n\t\t\t    GrabModeAsync, CurrentTime);\n\t\t}\n\t\tif (grab_ptr) {\n\t\t\tif (! quiet) {\n\t\t\t\trfbLog(\"grabbing pointer with XGrabPointer\\n\");\n\t\t\t}\n\t\t\tXGrabPointer(dpy, window, False, 0, GrabModeAsync,\n\t\t\t    GrabModeAsync, None, None, CurrentTime);\n\t\t}\n\t} else {\n\t\tif (grab_kbd) {\n\t\t\tif (! quiet) {\n\t\t\t\trfbLog(\"ungrabbing keyboard with XUngrabKeyboard\\n\");\n\t\t\t}\n\t\t\tXUngrabKeyboard(dpy, CurrentTime);\n\t\t}\n\t\tif (grab_ptr) {\n\t\t\tif (! quiet) {\n\t\t\t\trfbLog(\"ungrabbing pointer with XUngrabPointer\\n\");\n\t\t\t}\n\t\t\tXUngrabPointer(dpy, CurrentTime);\n\t\t}\n\t}\n#endif\t/* NO_X11 */\n}",
          "includes": [
            "#include \"xi2_devices.h\"",
            "#include \"xrandr.h\"",
            "#include \"pointer.h\"",
            "#include \"userinput.h\"",
            "#include \"macosxCG.h\"",
            "#include \"macosx.h\"",
            "#include \"win_utils.h\"",
            "#include \"xevents.h\"",
            "#include \"xwrappers.h\"",
            "#include \"sslhelper.h\"",
            "#include \"sslcmds.h\"",
            "#include \"scan.h\"",
            "#include \"user.h\"",
            "#include \"unixpw.h\"",
            "#include \"screen.h\"",
            "#include \"rates.h\"",
            "#include \"solid.h\"",
            "#include \"gui.h\"",
            "#include \"cleanup.h\"",
            "#include \"keyboard.h\"",
            "#include \"remote.h\"",
            "#include \"inet.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void adjust_grabs(int grab, int quiet);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xi2_devices.h\"\n#include \"xrandr.h\"\n#include \"pointer.h\"\n#include \"userinput.h\"\n#include \"macosxCG.h\"\n#include \"macosx.h\"\n#include \"win_utils.h\"\n#include \"xevents.h\"\n#include \"xwrappers.h\"\n#include \"sslhelper.h\"\n#include \"sslcmds.h\"\n#include \"scan.h\"\n#include \"user.h\"\n#include \"unixpw.h\"\n#include \"screen.h\"\n#include \"rates.h\"\n#include \"solid.h\"\n#include \"gui.h\"\n#include \"cleanup.h\"\n#include \"keyboard.h\"\n#include \"remote.h\"\n#include \"inet.h\"\n#include \"x11vnc.h\"\n\nvoid adjust_grabs(int grab, int quiet);\n\nvoid adjust_grabs(int grab, int quiet) {\n\tRAWFB_RET_VOID\n#if NO_X11\n\tif (!grab || !quiet) {}\n\treturn;\n#else\n\t/* n.b. caller decides to X_LOCK or not. */\n\tif (grab) {\n\t\tif (grab_kbd) {\n\t\t\tif (! quiet) {\n\t\t\t\trfbLog(\"grabbing keyboard with XGrabKeyboard\\n\");\n\t\t\t}\n\t\t\tXGrabKeyboard(dpy, window, False, GrabModeAsync,\n\t\t\t    GrabModeAsync, CurrentTime);\n\t\t}\n\t\tif (grab_ptr) {\n\t\t\tif (! quiet) {\n\t\t\t\trfbLog(\"grabbing pointer with XGrabPointer\\n\");\n\t\t\t}\n\t\t\tXGrabPointer(dpy, window, False, 0, GrabModeAsync,\n\t\t\t    GrabModeAsync, None, None, CurrentTime);\n\t\t}\n\t} else {\n\t\tif (grab_kbd) {\n\t\t\tif (! quiet) {\n\t\t\t\trfbLog(\"ungrabbing keyboard with XUngrabKeyboard\\n\");\n\t\t\t}\n\t\t\tXUngrabKeyboard(dpy, CurrentTime);\n\t\t}\n\t\tif (grab_ptr) {\n\t\t\tif (! quiet) {\n\t\t\t\trfbLog(\"ungrabbing pointer with XUngrabPointer\\n\");\n\t\t\t}\n\t\t\tXUngrabPointer(dpy, CurrentTime);\n\t\t}\n\t}\n#endif\t/* NO_X11 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "XTestFakeMotionEvent",
          "args": [
            "dpy",
            "screen",
            "x",
            "y",
            "delay"
          ],
          "line": 1190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XSetErrorHandler",
          "args": [
            "old_handler"
          ],
          "line": 1184
        },
        "resolved": true,
        "details": {
          "function_name": "XSetErrorHandler",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/nox11_funcs.h",
          "lines": "2819-2821",
          "snippet": "XErrorHandler XSetErrorHandler (XErrorHandler h) {\n\treturn h;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "XErrorHandler XSetErrorHandler (XErrorHandler h) {\n\treturn h;\n}"
        }
      },
      {
        "call_info": {
          "callee": "XTestFakeDeviceMotionEvent",
          "args": [
            "dpy",
            "&xdev",
            "0",
            "0",
            "axes",
            "2",
            "delay"
          ],
          "line": 1182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rfbLog",
          "args": [
            "\"calling XTestFakeMotionEvent(%d, %d)  %.4f\\n\"",
            "x",
            "y",
            "dnowx()"
          ],
          "line": 1166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dnowx",
          "args": [],
          "line": 1167
        },
        "resolved": true,
        "details": {
          "function_name": "dnowx",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/util.c",
          "lines": "439-441",
          "snippet": "double dnowx(void) {\n\treturn dnow() - x11vnc_start;\n}",
          "includes": [
            "#include \"connections.h\"",
            "#include \"unixpw.h\"",
            "#include \"win_utils.h\"",
            "#include \"cleanup.h\"",
            "#include \"x11vnc.h\"",
            "#include <stdlib.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "double dnow(void);",
            "double dnowx(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"connections.h\"\n#include \"unixpw.h\"\n#include \"win_utils.h\"\n#include \"cleanup.h\"\n#include \"x11vnc.h\"\n#include <stdlib.h>\n\ndouble dnow(void);\ndouble dnowx(void);\n\ndouble dnowx(void) {\n\treturn dnow() - x11vnc_start;\n}"
        }
      },
      {
        "call_info": {
          "callee": "XTRAP_FakeMotionEvent_wr",
          "args": [
            "dpy",
            "screen",
            "x",
            "y",
            "delay"
          ],
          "line": 1158
        },
        "resolved": true,
        "details": {
          "function_name": "XTRAP_FakeMotionEvent_wr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "1111-1135",
          "snippet": "void XTRAP_FakeMotionEvent_wr(Display* dpy, int screen, int x, int y,\n    unsigned long delay) {\n\n\tRAWFB_RET_VOID\n\n#if NO_X11\n\tnox11_exit(1);\n\tif (!dpy || !screen || !x || !y || !delay) {}\n\treturn;\n#else\n\tif (! xtrap_present) {\n\t\tDEBUG_SKIPPED_INPUT(debug_keyboard, \"motion: no-XTRAP\");\n\t\treturn;\n\t}\n\t/* unused vars warning: */\n\tif (dpy || screen || x || y || delay) {}\n\n#if HAVE_LIBXTRAP\n\tXESimulateXEventRequest(trap_ctx, MotionNotify, 0, x, y, 0);\n#else\n\tDEBUG_SKIPPED_INPUT(debug_keyboard, \"motion: no-XTRAP-build\");\n#endif\n\n#endif\t/* NO_X11 */\n}",
          "includes": [
            "#include \"nox11_funcs.h\"",
            "#include \"xwrappers.h\"",
            "#include \"xi2_devices.h\"",
            "#include \"macosx.h\"",
            "#include \"cleanup.h\"",
            "#include \"connections.h\"",
            "#include \"xevents.h\"",
            "#include \"keyboard.h\"",
            "#include \"xrecord.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int xtrap_present = 0;",
            "void XTRAP_FakeKeyEvent_wr(Display* dpy, KeyCode key, Bool down,\n    unsigned long delay);",
            "void XTestFakeKeyEvent_wr(Display* dpy, int dev_id, KeyCode key, Bool down,\n    unsigned long delay);",
            "void XTRAP_FakeButtonEvent_wr(Display* dpy, unsigned int button, Bool is_press,\n    unsigned long delay);",
            "void XTestFakeButtonEvent_wr(Display* dpy, int dev_id, unsigned int button, Bool is_press,\n    unsigned long delay);",
            "void XTRAP_FakeMotionEvent_wr(Display* dpy, int screen, int x, int y,\n    unsigned long delay);",
            "void XTestFakeMotionEvent_wr(Display* dpy, int dev_id, int screen, int x, int y,\n    unsigned long delay);",
            "void XTestDiscard_wr(Display *dpy);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint xtrap_present = 0;\nvoid XTRAP_FakeKeyEvent_wr(Display* dpy, KeyCode key, Bool down,\n    unsigned long delay);\nvoid XTestFakeKeyEvent_wr(Display* dpy, int dev_id, KeyCode key, Bool down,\n    unsigned long delay);\nvoid XTRAP_FakeButtonEvent_wr(Display* dpy, unsigned int button, Bool is_press,\n    unsigned long delay);\nvoid XTestFakeButtonEvent_wr(Display* dpy, int dev_id, unsigned int button, Bool is_press,\n    unsigned long delay);\nvoid XTRAP_FakeMotionEvent_wr(Display* dpy, int screen, int x, int y,\n    unsigned long delay);\nvoid XTestFakeMotionEvent_wr(Display* dpy, int dev_id, int screen, int x, int y,\n    unsigned long delay);\nvoid XTestDiscard_wr(Display *dpy);\n\nvoid XTRAP_FakeMotionEvent_wr(Display* dpy, int screen, int x, int y,\n    unsigned long delay) {\n\n\tRAWFB_RET_VOID\n\n#if NO_X11\n\tnox11_exit(1);\n\tif (!dpy || !screen || !x || !y || !delay) {}\n\treturn;\n#else\n\tif (! xtrap_present) {\n\t\tDEBUG_SKIPPED_INPUT(debug_keyboard, \"motion: no-XTRAP\");\n\t\treturn;\n\t}\n\t/* unused vars warning: */\n\tif (dpy || screen || x || y || delay) {}\n\n#if HAVE_LIBXTRAP\n\tXESimulateXEventRequest(trap_ctx, MotionNotify, 0, x, y, 0);\n#else\n\tDEBUG_SKIPPED_INPUT(debug_keyboard, \"motion: no-XTRAP-build\");\n#endif\n\n#endif\t/* NO_X11 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "XUngrabKeyboard",
          "args": [
            "dpy",
            "CurrentTime"
          ],
          "line": 1153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XUngrabPointer",
          "args": [
            "dpy",
            "CurrentTime"
          ],
          "line": 1149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nox11_exit",
          "args": [
            "1"
          ],
          "line": 1143
        },
        "resolved": true,
        "details": {
          "function_name": "nox11_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "1711-1718",
          "snippet": "void nox11_exit(int rc) {\n#if NO_X11\n\trfbLog(\"This x11vnc was not built with X11 support.\\n\");\n\tclean_up_exit(rc);\n#else\n\tif (0) {rc = 0;}\n#endif\n}",
          "includes": [
            "#include \"nox11_funcs.h\"",
            "#include \"xwrappers.h\"",
            "#include \"xi2_devices.h\"",
            "#include \"macosx.h\"",
            "#include \"cleanup.h\"",
            "#include \"connections.h\"",
            "#include \"xevents.h\"",
            "#include \"keyboard.h\"",
            "#include \"xrecord.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nvoid nox11_exit(int rc) {\n#if NO_X11\n\trfbLog(\"This x11vnc was not built with X11 support.\\n\");\n\tclean_up_exit(rc);\n#else\n\tif (0) {rc = 0;}\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nvoid XTRAP_FakeKeyEvent_wr(Display* dpy, KeyCode key, Bool down,\n    unsigned long delay);\nvoid XTestFakeKeyEvent_wr(Display* dpy, int dev_id, KeyCode key, Bool down,\n    unsigned long delay);\nvoid XTRAP_FakeButtonEvent_wr(Display* dpy, unsigned int button, Bool is_press,\n    unsigned long delay);\nvoid XTestFakeButtonEvent_wr(Display* dpy, int dev_id, unsigned int button, Bool is_press,\n    unsigned long delay);\nvoid XTRAP_FakeMotionEvent_wr(Display* dpy, int screen, int x, int y,\n    unsigned long delay);\nvoid XTestFakeMotionEvent_wr(Display* dpy, int dev_id, int screen, int x, int y,\n    unsigned long delay);\nvoid XTestDiscard_wr(Display *dpy);\n\nvoid XTestFakeMotionEvent_wr(Display* dpy, int dev_id, int screen, int x, int y,\n    unsigned long delay) {\n\tint regrab = 0;\n\n\tRAWFB_RET_VOID\n#if NO_X11\n\tnox11_exit(1);\n\tif (!dpy || !screen || !x || !y || !delay) {}\n\treturn;\n#else\n\n\tif (grab_ptr) {\n\t\tXUngrabPointer(dpy, CurrentTime);\n\t\tregrab = 1;\n\t}\n\tif (grab_kbd && ungrab_both) {\n\t\tXUngrabKeyboard(dpy, CurrentTime);\n\t\tregrab = 1;\n\t}\n\n\tif (xtrap_input) {\n\t\tXTRAP_FakeMotionEvent_wr(dpy, screen, x, y, delay);\n\t\tif (regrab) {\n\t\t\tadjust_grabs(1, 1);\n\t\t}\n\t\treturn;\n\t}\n\n\tif (debug_pointer) {\n\t\trfbLog(\"calling XTestFakeMotionEvent(%d, %d)  %.4f\\n\",\n\t\t    x, y, dnowx());\t\n\t}\n#if HAVE_XTEST\n#ifdef HAVE_XI2\n    if(use_multipointer && dev_id >= 0)\n      {\n        XErrorHandler old_handler;\n        int axes[] = {x, y};\n\tXDevice xdev;\n\txdev.device_id = dev_id;\n\n        /* there can be a race condition where this is called when the XI2 device has not yet been created */\n        old_handler = XSetErrorHandler(trap_xerror);\n        trapped_xerror = 0;\n\n        XTestFakeDeviceMotionEvent(dpy, &xdev, 0, 0, axes, 2, delay);\n\n        XSetErrorHandler(old_handler);\n        if (trapped_xerror) \n          trapped_xerror = 0;\n      }\n    else\n#endif\n          XTestFakeMotionEvent(dpy, screen, x, y, delay);\n#endif\n\tif (regrab) {\n\t\tadjust_grabs(1, 1);\n\t}\n#endif\t/* NO_X11 */\n}"
  },
  {
    "function_name": "XTRAP_FakeMotionEvent_wr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "1111-1135",
    "snippet": "void XTRAP_FakeMotionEvent_wr(Display* dpy, int screen, int x, int y,\n    unsigned long delay) {\n\n\tRAWFB_RET_VOID\n\n#if NO_X11\n\tnox11_exit(1);\n\tif (!dpy || !screen || !x || !y || !delay) {}\n\treturn;\n#else\n\tif (! xtrap_present) {\n\t\tDEBUG_SKIPPED_INPUT(debug_keyboard, \"motion: no-XTRAP\");\n\t\treturn;\n\t}\n\t/* unused vars warning: */\n\tif (dpy || screen || x || y || delay) {}\n\n#if HAVE_LIBXTRAP\n\tXESimulateXEventRequest(trap_ctx, MotionNotify, 0, x, y, 0);\n#else\n\tDEBUG_SKIPPED_INPUT(debug_keyboard, \"motion: no-XTRAP-build\");\n#endif\n\n#endif\t/* NO_X11 */\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int xtrap_present = 0;",
      "void XTRAP_FakeKeyEvent_wr(Display* dpy, KeyCode key, Bool down,\n    unsigned long delay);",
      "void XTestFakeKeyEvent_wr(Display* dpy, int dev_id, KeyCode key, Bool down,\n    unsigned long delay);",
      "void XTRAP_FakeButtonEvent_wr(Display* dpy, unsigned int button, Bool is_press,\n    unsigned long delay);",
      "void XTestFakeButtonEvent_wr(Display* dpy, int dev_id, unsigned int button, Bool is_press,\n    unsigned long delay);",
      "void XTRAP_FakeMotionEvent_wr(Display* dpy, int screen, int x, int y,\n    unsigned long delay);",
      "void XTestFakeMotionEvent_wr(Display* dpy, int dev_id, int screen, int x, int y,\n    unsigned long delay);",
      "void XTestDiscard_wr(Display *dpy);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "DEBUG_SKIPPED_INPUT",
          "args": [
            "debug_keyboard",
            "\"motion: no-XTRAP-build\""
          ],
          "line": 1131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XESimulateXEventRequest",
          "args": [
            "trap_ctx",
            "MotionNotify",
            "0",
            "x",
            "y",
            "0"
          ],
          "line": 1129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DEBUG_SKIPPED_INPUT",
          "args": [
            "debug_keyboard",
            "\"motion: no-XTRAP\""
          ],
          "line": 1122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nox11_exit",
          "args": [
            "1"
          ],
          "line": 1117
        },
        "resolved": true,
        "details": {
          "function_name": "nox11_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "1711-1718",
          "snippet": "void nox11_exit(int rc) {\n#if NO_X11\n\trfbLog(\"This x11vnc was not built with X11 support.\\n\");\n\tclean_up_exit(rc);\n#else\n\tif (0) {rc = 0;}\n#endif\n}",
          "includes": [
            "#include \"nox11_funcs.h\"",
            "#include \"xwrappers.h\"",
            "#include \"xi2_devices.h\"",
            "#include \"macosx.h\"",
            "#include \"cleanup.h\"",
            "#include \"connections.h\"",
            "#include \"xevents.h\"",
            "#include \"keyboard.h\"",
            "#include \"xrecord.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nvoid nox11_exit(int rc) {\n#if NO_X11\n\trfbLog(\"This x11vnc was not built with X11 support.\\n\");\n\tclean_up_exit(rc);\n#else\n\tif (0) {rc = 0;}\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint xtrap_present = 0;\nvoid XTRAP_FakeKeyEvent_wr(Display* dpy, KeyCode key, Bool down,\n    unsigned long delay);\nvoid XTestFakeKeyEvent_wr(Display* dpy, int dev_id, KeyCode key, Bool down,\n    unsigned long delay);\nvoid XTRAP_FakeButtonEvent_wr(Display* dpy, unsigned int button, Bool is_press,\n    unsigned long delay);\nvoid XTestFakeButtonEvent_wr(Display* dpy, int dev_id, unsigned int button, Bool is_press,\n    unsigned long delay);\nvoid XTRAP_FakeMotionEvent_wr(Display* dpy, int screen, int x, int y,\n    unsigned long delay);\nvoid XTestFakeMotionEvent_wr(Display* dpy, int dev_id, int screen, int x, int y,\n    unsigned long delay);\nvoid XTestDiscard_wr(Display *dpy);\n\nvoid XTRAP_FakeMotionEvent_wr(Display* dpy, int screen, int x, int y,\n    unsigned long delay) {\n\n\tRAWFB_RET_VOID\n\n#if NO_X11\n\tnox11_exit(1);\n\tif (!dpy || !screen || !x || !y || !delay) {}\n\treturn;\n#else\n\tif (! xtrap_present) {\n\t\tDEBUG_SKIPPED_INPUT(debug_keyboard, \"motion: no-XTRAP\");\n\t\treturn;\n\t}\n\t/* unused vars warning: */\n\tif (dpy || screen || x || y || delay) {}\n\n#if HAVE_LIBXTRAP\n\tXESimulateXEventRequest(trap_ctx, MotionNotify, 0, x, y, 0);\n#else\n\tDEBUG_SKIPPED_INPUT(debug_keyboard, \"motion: no-XTRAP-build\");\n#endif\n\n#endif\t/* NO_X11 */\n}"
  },
  {
    "function_name": "XTestFakeButtonEvent_wr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "1046-1108",
    "snippet": "void XTestFakeButtonEvent_wr(Display* dpy, int dev_id, unsigned int button, Bool is_press,\n    unsigned long delay) {\n\tint regrab = 0;\n\n\tRAWFB_RET_VOID\n#if NO_X11\n\tnox11_exit(1);\n\tif (!dpy || !button || !is_press || !delay) {}\n\treturn;\n#else\n\n\tif (grab_ptr) {\n\t\tXUngrabPointer(dpy, CurrentTime);\n\t\tregrab = 1;\n\t}\n\tif (grab_kbd && ungrab_both) {\n\t\tXUngrabKeyboard(dpy, CurrentTime);\n\t\tregrab = 1;\n\t}\n\n\tif (xtrap_input) {\n\t\tXTRAP_FakeButtonEvent_wr(dpy, button, is_press, delay);\n\t\tif (regrab) {\n\t\t\tadjust_grabs(1, 1);\n\t\t}\n\t\treturn;\n\t}\n\n\tif (! xtest_present) {\n\t\tDEBUG_SKIPPED_INPUT(debug_keyboard, \"button: no-XTEST\");\n\t\treturn;\n\t}\n\tif (debug_pointer) {\n\t\trfbLog(\"calling XTestFakeButtonEvent(%d, %d)  %.4f\\n\",\n\t\t    button, is_press, dnowx());\t\n\t}\n#if HAVE_XTEST\n#ifdef HAVE_XI2\n    if(use_multipointer && dev_id >= 0)\n      {\n        XErrorHandler old_handler;\n        XDevice xdev;\n\txdev.device_id = dev_id;\n\n        /* there can be a race condition where this is called when the XI2 device has not yet been created */\n        old_handler = XSetErrorHandler(trap_xerror);\n        trapped_xerror = 0;\n\n        XTestFakeDeviceButtonEvent(dpy, &xdev, button, is_press, NULL, 0, delay);\t  \n\n        XSetErrorHandler(old_handler);\n        if (trapped_xerror) \n          trapped_xerror = 0;\n      }\n    else\n#endif\n        XTestFakeButtonEvent(dpy, button, is_press, delay);\n#endif\n\tif (regrab) {\n\t\tadjust_grabs(1, 1);\n\t}\n#endif\t/* NO_X11 */\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int xtest_present = 0;",
      "void XTRAP_FakeKeyEvent_wr(Display* dpy, KeyCode key, Bool down,\n    unsigned long delay);",
      "void XTestFakeKeyEvent_wr(Display* dpy, int dev_id, KeyCode key, Bool down,\n    unsigned long delay);",
      "void XTRAP_FakeButtonEvent_wr(Display* dpy, unsigned int button, Bool is_press,\n    unsigned long delay);",
      "void XTestFakeButtonEvent_wr(Display* dpy, int dev_id, unsigned int button, Bool is_press,\n    unsigned long delay);",
      "void XTRAP_FakeMotionEvent_wr(Display* dpy, int screen, int x, int y,\n    unsigned long delay);",
      "void XTestFakeMotionEvent_wr(Display* dpy, int dev_id, int screen, int x, int y,\n    unsigned long delay);",
      "void XTestDiscard_wr(Display *dpy);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "adjust_grabs",
          "args": [
            "1",
            "1"
          ],
          "line": 1105
        },
        "resolved": true,
        "details": {
          "function_name": "adjust_grabs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/connections.c",
          "lines": "4335-4372",
          "snippet": "void adjust_grabs(int grab, int quiet) {\n\tRAWFB_RET_VOID\n#if NO_X11\n\tif (!grab || !quiet) {}\n\treturn;\n#else\n\t/* n.b. caller decides to X_LOCK or not. */\n\tif (grab) {\n\t\tif (grab_kbd) {\n\t\t\tif (! quiet) {\n\t\t\t\trfbLog(\"grabbing keyboard with XGrabKeyboard\\n\");\n\t\t\t}\n\t\t\tXGrabKeyboard(dpy, window, False, GrabModeAsync,\n\t\t\t    GrabModeAsync, CurrentTime);\n\t\t}\n\t\tif (grab_ptr) {\n\t\t\tif (! quiet) {\n\t\t\t\trfbLog(\"grabbing pointer with XGrabPointer\\n\");\n\t\t\t}\n\t\t\tXGrabPointer(dpy, window, False, 0, GrabModeAsync,\n\t\t\t    GrabModeAsync, None, None, CurrentTime);\n\t\t}\n\t} else {\n\t\tif (grab_kbd) {\n\t\t\tif (! quiet) {\n\t\t\t\trfbLog(\"ungrabbing keyboard with XUngrabKeyboard\\n\");\n\t\t\t}\n\t\t\tXUngrabKeyboard(dpy, CurrentTime);\n\t\t}\n\t\tif (grab_ptr) {\n\t\t\tif (! quiet) {\n\t\t\t\trfbLog(\"ungrabbing pointer with XUngrabPointer\\n\");\n\t\t\t}\n\t\t\tXUngrabPointer(dpy, CurrentTime);\n\t\t}\n\t}\n#endif\t/* NO_X11 */\n}",
          "includes": [
            "#include \"xi2_devices.h\"",
            "#include \"xrandr.h\"",
            "#include \"pointer.h\"",
            "#include \"userinput.h\"",
            "#include \"macosxCG.h\"",
            "#include \"macosx.h\"",
            "#include \"win_utils.h\"",
            "#include \"xevents.h\"",
            "#include \"xwrappers.h\"",
            "#include \"sslhelper.h\"",
            "#include \"sslcmds.h\"",
            "#include \"scan.h\"",
            "#include \"user.h\"",
            "#include \"unixpw.h\"",
            "#include \"screen.h\"",
            "#include \"rates.h\"",
            "#include \"solid.h\"",
            "#include \"gui.h\"",
            "#include \"cleanup.h\"",
            "#include \"keyboard.h\"",
            "#include \"remote.h\"",
            "#include \"inet.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void adjust_grabs(int grab, int quiet);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xi2_devices.h\"\n#include \"xrandr.h\"\n#include \"pointer.h\"\n#include \"userinput.h\"\n#include \"macosxCG.h\"\n#include \"macosx.h\"\n#include \"win_utils.h\"\n#include \"xevents.h\"\n#include \"xwrappers.h\"\n#include \"sslhelper.h\"\n#include \"sslcmds.h\"\n#include \"scan.h\"\n#include \"user.h\"\n#include \"unixpw.h\"\n#include \"screen.h\"\n#include \"rates.h\"\n#include \"solid.h\"\n#include \"gui.h\"\n#include \"cleanup.h\"\n#include \"keyboard.h\"\n#include \"remote.h\"\n#include \"inet.h\"\n#include \"x11vnc.h\"\n\nvoid adjust_grabs(int grab, int quiet);\n\nvoid adjust_grabs(int grab, int quiet) {\n\tRAWFB_RET_VOID\n#if NO_X11\n\tif (!grab || !quiet) {}\n\treturn;\n#else\n\t/* n.b. caller decides to X_LOCK or not. */\n\tif (grab) {\n\t\tif (grab_kbd) {\n\t\t\tif (! quiet) {\n\t\t\t\trfbLog(\"grabbing keyboard with XGrabKeyboard\\n\");\n\t\t\t}\n\t\t\tXGrabKeyboard(dpy, window, False, GrabModeAsync,\n\t\t\t    GrabModeAsync, CurrentTime);\n\t\t}\n\t\tif (grab_ptr) {\n\t\t\tif (! quiet) {\n\t\t\t\trfbLog(\"grabbing pointer with XGrabPointer\\n\");\n\t\t\t}\n\t\t\tXGrabPointer(dpy, window, False, 0, GrabModeAsync,\n\t\t\t    GrabModeAsync, None, None, CurrentTime);\n\t\t}\n\t} else {\n\t\tif (grab_kbd) {\n\t\t\tif (! quiet) {\n\t\t\t\trfbLog(\"ungrabbing keyboard with XUngrabKeyboard\\n\");\n\t\t\t}\n\t\t\tXUngrabKeyboard(dpy, CurrentTime);\n\t\t}\n\t\tif (grab_ptr) {\n\t\t\tif (! quiet) {\n\t\t\t\trfbLog(\"ungrabbing pointer with XUngrabPointer\\n\");\n\t\t\t}\n\t\t\tXUngrabPointer(dpy, CurrentTime);\n\t\t}\n\t}\n#endif\t/* NO_X11 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "XTestFakeButtonEvent",
          "args": [
            "dpy",
            "button",
            "is_press",
            "delay"
          ],
          "line": 1102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XSetErrorHandler",
          "args": [
            "old_handler"
          ],
          "line": 1096
        },
        "resolved": true,
        "details": {
          "function_name": "XSetErrorHandler",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/nox11_funcs.h",
          "lines": "2819-2821",
          "snippet": "XErrorHandler XSetErrorHandler (XErrorHandler h) {\n\treturn h;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "XErrorHandler XSetErrorHandler (XErrorHandler h) {\n\treturn h;\n}"
        }
      },
      {
        "call_info": {
          "callee": "XTestFakeDeviceButtonEvent",
          "args": [
            "dpy",
            "&xdev",
            "button",
            "is_press",
            "NULL",
            "0",
            "delay"
          ],
          "line": 1094
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rfbLog",
          "args": [
            "\"calling XTestFakeButtonEvent(%d, %d)  %.4f\\n\"",
            "button",
            "is_press",
            "dnowx()"
          ],
          "line": 1079
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dnowx",
          "args": [],
          "line": 1080
        },
        "resolved": true,
        "details": {
          "function_name": "dnowx",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/util.c",
          "lines": "439-441",
          "snippet": "double dnowx(void) {\n\treturn dnow() - x11vnc_start;\n}",
          "includes": [
            "#include \"connections.h\"",
            "#include \"unixpw.h\"",
            "#include \"win_utils.h\"",
            "#include \"cleanup.h\"",
            "#include \"x11vnc.h\"",
            "#include <stdlib.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "double dnow(void);",
            "double dnowx(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"connections.h\"\n#include \"unixpw.h\"\n#include \"win_utils.h\"\n#include \"cleanup.h\"\n#include \"x11vnc.h\"\n#include <stdlib.h>\n\ndouble dnow(void);\ndouble dnowx(void);\n\ndouble dnowx(void) {\n\treturn dnow() - x11vnc_start;\n}"
        }
      },
      {
        "call_info": {
          "callee": "DEBUG_SKIPPED_INPUT",
          "args": [
            "debug_keyboard",
            "\"button: no-XTEST\""
          ],
          "line": 1075
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XTRAP_FakeButtonEvent_wr",
          "args": [
            "dpy",
            "button",
            "is_press",
            "delay"
          ],
          "line": 1067
        },
        "resolved": true,
        "details": {
          "function_name": "XTRAP_FakeButtonEvent_wr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "1019-1044",
          "snippet": "void XTRAP_FakeButtonEvent_wr(Display* dpy, unsigned int button, Bool is_press,\n    unsigned long delay) {\n\n\tRAWFB_RET_VOID\n#if NO_X11\n\tnox11_exit(1);\n\tif (!dpy || !button || !is_press || !delay) {}\n\treturn;\n#else\n\n\tif (! xtrap_present) {\n\t\tDEBUG_SKIPPED_INPUT(debug_keyboard, \"button: no-XTRAP\");\n\t\treturn;\n\t}\n\t/* unused vars warning: */\n\tif (button || is_press || delay) {}\n\n#if HAVE_LIBXTRAP\n\tXESimulateXEventRequest(trap_ctx,\n\t    is_press ? ButtonPress : ButtonRelease, button, 0, 0, 0);\n#else\n\tDEBUG_SKIPPED_INPUT(debug_keyboard, \"button: no-XTRAP-build\");\n#endif\n\n#endif\t/* NO_X11 */\n}",
          "includes": [
            "#include \"nox11_funcs.h\"",
            "#include \"xwrappers.h\"",
            "#include \"xi2_devices.h\"",
            "#include \"macosx.h\"",
            "#include \"cleanup.h\"",
            "#include \"connections.h\"",
            "#include \"xevents.h\"",
            "#include \"keyboard.h\"",
            "#include \"xrecord.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int xtrap_present = 0;",
            "void XTRAP_FakeKeyEvent_wr(Display* dpy, KeyCode key, Bool down,\n    unsigned long delay);",
            "void XTestFakeKeyEvent_wr(Display* dpy, int dev_id, KeyCode key, Bool down,\n    unsigned long delay);",
            "void XTRAP_FakeButtonEvent_wr(Display* dpy, unsigned int button, Bool is_press,\n    unsigned long delay);",
            "void XTestFakeButtonEvent_wr(Display* dpy, int dev_id, unsigned int button, Bool is_press,\n    unsigned long delay);",
            "void XTRAP_FakeMotionEvent_wr(Display* dpy, int screen, int x, int y,\n    unsigned long delay);",
            "void XTestFakeMotionEvent_wr(Display* dpy, int dev_id, int screen, int x, int y,\n    unsigned long delay);",
            "void XTestDiscard_wr(Display *dpy);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint xtrap_present = 0;\nvoid XTRAP_FakeKeyEvent_wr(Display* dpy, KeyCode key, Bool down,\n    unsigned long delay);\nvoid XTestFakeKeyEvent_wr(Display* dpy, int dev_id, KeyCode key, Bool down,\n    unsigned long delay);\nvoid XTRAP_FakeButtonEvent_wr(Display* dpy, unsigned int button, Bool is_press,\n    unsigned long delay);\nvoid XTestFakeButtonEvent_wr(Display* dpy, int dev_id, unsigned int button, Bool is_press,\n    unsigned long delay);\nvoid XTRAP_FakeMotionEvent_wr(Display* dpy, int screen, int x, int y,\n    unsigned long delay);\nvoid XTestFakeMotionEvent_wr(Display* dpy, int dev_id, int screen, int x, int y,\n    unsigned long delay);\nvoid XTestDiscard_wr(Display *dpy);\n\nvoid XTRAP_FakeButtonEvent_wr(Display* dpy, unsigned int button, Bool is_press,\n    unsigned long delay) {\n\n\tRAWFB_RET_VOID\n#if NO_X11\n\tnox11_exit(1);\n\tif (!dpy || !button || !is_press || !delay) {}\n\treturn;\n#else\n\n\tif (! xtrap_present) {\n\t\tDEBUG_SKIPPED_INPUT(debug_keyboard, \"button: no-XTRAP\");\n\t\treturn;\n\t}\n\t/* unused vars warning: */\n\tif (button || is_press || delay) {}\n\n#if HAVE_LIBXTRAP\n\tXESimulateXEventRequest(trap_ctx,\n\t    is_press ? ButtonPress : ButtonRelease, button, 0, 0, 0);\n#else\n\tDEBUG_SKIPPED_INPUT(debug_keyboard, \"button: no-XTRAP-build\");\n#endif\n\n#endif\t/* NO_X11 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "XUngrabKeyboard",
          "args": [
            "dpy",
            "CurrentTime"
          ],
          "line": 1062
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XUngrabPointer",
          "args": [
            "dpy",
            "CurrentTime"
          ],
          "line": 1058
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nox11_exit",
          "args": [
            "1"
          ],
          "line": 1052
        },
        "resolved": true,
        "details": {
          "function_name": "nox11_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "1711-1718",
          "snippet": "void nox11_exit(int rc) {\n#if NO_X11\n\trfbLog(\"This x11vnc was not built with X11 support.\\n\");\n\tclean_up_exit(rc);\n#else\n\tif (0) {rc = 0;}\n#endif\n}",
          "includes": [
            "#include \"nox11_funcs.h\"",
            "#include \"xwrappers.h\"",
            "#include \"xi2_devices.h\"",
            "#include \"macosx.h\"",
            "#include \"cleanup.h\"",
            "#include \"connections.h\"",
            "#include \"xevents.h\"",
            "#include \"keyboard.h\"",
            "#include \"xrecord.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nvoid nox11_exit(int rc) {\n#if NO_X11\n\trfbLog(\"This x11vnc was not built with X11 support.\\n\");\n\tclean_up_exit(rc);\n#else\n\tif (0) {rc = 0;}\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint xtest_present = 0;\nvoid XTRAP_FakeKeyEvent_wr(Display* dpy, KeyCode key, Bool down,\n    unsigned long delay);\nvoid XTestFakeKeyEvent_wr(Display* dpy, int dev_id, KeyCode key, Bool down,\n    unsigned long delay);\nvoid XTRAP_FakeButtonEvent_wr(Display* dpy, unsigned int button, Bool is_press,\n    unsigned long delay);\nvoid XTestFakeButtonEvent_wr(Display* dpy, int dev_id, unsigned int button, Bool is_press,\n    unsigned long delay);\nvoid XTRAP_FakeMotionEvent_wr(Display* dpy, int screen, int x, int y,\n    unsigned long delay);\nvoid XTestFakeMotionEvent_wr(Display* dpy, int dev_id, int screen, int x, int y,\n    unsigned long delay);\nvoid XTestDiscard_wr(Display *dpy);\n\nvoid XTestFakeButtonEvent_wr(Display* dpy, int dev_id, unsigned int button, Bool is_press,\n    unsigned long delay) {\n\tint regrab = 0;\n\n\tRAWFB_RET_VOID\n#if NO_X11\n\tnox11_exit(1);\n\tif (!dpy || !button || !is_press || !delay) {}\n\treturn;\n#else\n\n\tif (grab_ptr) {\n\t\tXUngrabPointer(dpy, CurrentTime);\n\t\tregrab = 1;\n\t}\n\tif (grab_kbd && ungrab_both) {\n\t\tXUngrabKeyboard(dpy, CurrentTime);\n\t\tregrab = 1;\n\t}\n\n\tif (xtrap_input) {\n\t\tXTRAP_FakeButtonEvent_wr(dpy, button, is_press, delay);\n\t\tif (regrab) {\n\t\t\tadjust_grabs(1, 1);\n\t\t}\n\t\treturn;\n\t}\n\n\tif (! xtest_present) {\n\t\tDEBUG_SKIPPED_INPUT(debug_keyboard, \"button: no-XTEST\");\n\t\treturn;\n\t}\n\tif (debug_pointer) {\n\t\trfbLog(\"calling XTestFakeButtonEvent(%d, %d)  %.4f\\n\",\n\t\t    button, is_press, dnowx());\t\n\t}\n#if HAVE_XTEST\n#ifdef HAVE_XI2\n    if(use_multipointer && dev_id >= 0)\n      {\n        XErrorHandler old_handler;\n        XDevice xdev;\n\txdev.device_id = dev_id;\n\n        /* there can be a race condition where this is called when the XI2 device has not yet been created */\n        old_handler = XSetErrorHandler(trap_xerror);\n        trapped_xerror = 0;\n\n        XTestFakeDeviceButtonEvent(dpy, &xdev, button, is_press, NULL, 0, delay);\t  \n\n        XSetErrorHandler(old_handler);\n        if (trapped_xerror) \n          trapped_xerror = 0;\n      }\n    else\n#endif\n        XTestFakeButtonEvent(dpy, button, is_press, delay);\n#endif\n\tif (regrab) {\n\t\tadjust_grabs(1, 1);\n\t}\n#endif\t/* NO_X11 */\n}"
  },
  {
    "function_name": "XTRAP_FakeButtonEvent_wr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "1019-1044",
    "snippet": "void XTRAP_FakeButtonEvent_wr(Display* dpy, unsigned int button, Bool is_press,\n    unsigned long delay) {\n\n\tRAWFB_RET_VOID\n#if NO_X11\n\tnox11_exit(1);\n\tif (!dpy || !button || !is_press || !delay) {}\n\treturn;\n#else\n\n\tif (! xtrap_present) {\n\t\tDEBUG_SKIPPED_INPUT(debug_keyboard, \"button: no-XTRAP\");\n\t\treturn;\n\t}\n\t/* unused vars warning: */\n\tif (button || is_press || delay) {}\n\n#if HAVE_LIBXTRAP\n\tXESimulateXEventRequest(trap_ctx,\n\t    is_press ? ButtonPress : ButtonRelease, button, 0, 0, 0);\n#else\n\tDEBUG_SKIPPED_INPUT(debug_keyboard, \"button: no-XTRAP-build\");\n#endif\n\n#endif\t/* NO_X11 */\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int xtrap_present = 0;",
      "void XTRAP_FakeKeyEvent_wr(Display* dpy, KeyCode key, Bool down,\n    unsigned long delay);",
      "void XTestFakeKeyEvent_wr(Display* dpy, int dev_id, KeyCode key, Bool down,\n    unsigned long delay);",
      "void XTRAP_FakeButtonEvent_wr(Display* dpy, unsigned int button, Bool is_press,\n    unsigned long delay);",
      "void XTestFakeButtonEvent_wr(Display* dpy, int dev_id, unsigned int button, Bool is_press,\n    unsigned long delay);",
      "void XTRAP_FakeMotionEvent_wr(Display* dpy, int screen, int x, int y,\n    unsigned long delay);",
      "void XTestFakeMotionEvent_wr(Display* dpy, int dev_id, int screen, int x, int y,\n    unsigned long delay);",
      "void XTestDiscard_wr(Display *dpy);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "DEBUG_SKIPPED_INPUT",
          "args": [
            "debug_keyboard",
            "\"button: no-XTRAP-build\""
          ],
          "line": 1040
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XESimulateXEventRequest",
          "args": [
            "trap_ctx",
            "is_press ? ButtonPress : ButtonRelease",
            "button",
            "0",
            "0",
            "0"
          ],
          "line": 1037
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DEBUG_SKIPPED_INPUT",
          "args": [
            "debug_keyboard",
            "\"button: no-XTRAP\""
          ],
          "line": 1030
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nox11_exit",
          "args": [
            "1"
          ],
          "line": 1024
        },
        "resolved": true,
        "details": {
          "function_name": "nox11_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "1711-1718",
          "snippet": "void nox11_exit(int rc) {\n#if NO_X11\n\trfbLog(\"This x11vnc was not built with X11 support.\\n\");\n\tclean_up_exit(rc);\n#else\n\tif (0) {rc = 0;}\n#endif\n}",
          "includes": [
            "#include \"nox11_funcs.h\"",
            "#include \"xwrappers.h\"",
            "#include \"xi2_devices.h\"",
            "#include \"macosx.h\"",
            "#include \"cleanup.h\"",
            "#include \"connections.h\"",
            "#include \"xevents.h\"",
            "#include \"keyboard.h\"",
            "#include \"xrecord.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nvoid nox11_exit(int rc) {\n#if NO_X11\n\trfbLog(\"This x11vnc was not built with X11 support.\\n\");\n\tclean_up_exit(rc);\n#else\n\tif (0) {rc = 0;}\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint xtrap_present = 0;\nvoid XTRAP_FakeKeyEvent_wr(Display* dpy, KeyCode key, Bool down,\n    unsigned long delay);\nvoid XTestFakeKeyEvent_wr(Display* dpy, int dev_id, KeyCode key, Bool down,\n    unsigned long delay);\nvoid XTRAP_FakeButtonEvent_wr(Display* dpy, unsigned int button, Bool is_press,\n    unsigned long delay);\nvoid XTestFakeButtonEvent_wr(Display* dpy, int dev_id, unsigned int button, Bool is_press,\n    unsigned long delay);\nvoid XTRAP_FakeMotionEvent_wr(Display* dpy, int screen, int x, int y,\n    unsigned long delay);\nvoid XTestFakeMotionEvent_wr(Display* dpy, int dev_id, int screen, int x, int y,\n    unsigned long delay);\nvoid XTestDiscard_wr(Display *dpy);\n\nvoid XTRAP_FakeButtonEvent_wr(Display* dpy, unsigned int button, Bool is_press,\n    unsigned long delay) {\n\n\tRAWFB_RET_VOID\n#if NO_X11\n\tnox11_exit(1);\n\tif (!dpy || !button || !is_press || !delay) {}\n\treturn;\n#else\n\n\tif (! xtrap_present) {\n\t\tDEBUG_SKIPPED_INPUT(debug_keyboard, \"button: no-XTRAP\");\n\t\treturn;\n\t}\n\t/* unused vars warning: */\n\tif (button || is_press || delay) {}\n\n#if HAVE_LIBXTRAP\n\tXESimulateXEventRequest(trap_ctx,\n\t    is_press ? ButtonPress : ButtonRelease, button, 0, 0, 0);\n#else\n\tDEBUG_SKIPPED_INPUT(debug_keyboard, \"button: no-XTRAP-build\");\n#endif\n\n#endif\t/* NO_X11 */\n}"
  },
  {
    "function_name": "XTestFakeKeyEvent_wr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "933-1017",
    "snippet": "void XTestFakeKeyEvent_wr(Display* dpy, int dev_id, KeyCode key, Bool down,\n    unsigned long delay) {\n\tstatic int first = 1;\n\tint regrab = 0;\n\n\tRAWFB_RET_VOID\n\n#if NO_X11\n\tnox11_exit(1);\n\tif (!dpy || !key || !down || !delay || !first) {}\n\treturn;\n#else\n\tif (debug_keyboard) {\n\t\tchar *str = XKeysymToString(XKeycodeToKeysym_wr(dpy, key, 0));\n\t\trfbLog(\"XTestFakeKeyEvent(dpy, keycode=0x%x \\\"%s\\\", %s)\\n\",\n\t\t    key, str ? str : \"null\", down ? \"down\":\"up\");\n\t}\n\tif (first) { \n\t\tinit_track_keycode_state();\n\t\tfirst = 0;\n\t}\n\tif (down) {\n\t\tlast_keyboard_keycode = -key;\n\t} else {\n\t\tlast_keyboard_keycode = key;\n\t}\n\n\tif (grab_kbd) {\n\t\tXUngrabKeyboard(dpy, CurrentTime);\n\t\tregrab = 1;\n\t}\n\tif (grab_ptr && ungrab_both) {\n\t\tXUngrabPointer(dpy, CurrentTime);\n\t\tregrab = 1;\n\t}\n\n\tif (xtrap_input) {\n\t\tXTRAP_FakeKeyEvent_wr(dpy, key, down, delay);\n\t\tif (regrab) {\n\t\t\tadjust_grabs(1, 1);\n\t\t}\n\t\treturn;\n\t}\n\n\tif (! xtest_present) {\n\t\tDEBUG_SKIPPED_INPUT(debug_keyboard, \"keyboard: no-XTEST\");\n\t\treturn;\n\t}\n\tif (debug_keyboard) {\n\t\trfbLog(\"calling XTestFakeKeyEvent(%d, %d)  %.4f\\n\",\n\t\t    key, down, dnowx());\t\n\t}\n#if HAVE_XTEST\n#ifdef HAVE_XI2\n    if(use_multipointer && dev_id >= 0)\n      {\n        XErrorHandler old_handler;\n\tXDevice xdev;\n        xdev.device_id = dev_id;\n\n        /* there can be a race condition where this is called when the XI2 device has not yet been created */\n        old_handler = XSetErrorHandler(trap_xerror);\n        trapped_xerror = 0;\n\n\tXTestFakeDeviceKeyEvent(dpy, &xdev, key, down, NULL, 0, delay);        \n\n        XSetErrorHandler(old_handler);\n        if (trapped_xerror) \n          trapped_xerror = 0;\n      }\n    else\n#endif\n        XTestFakeKeyEvent(dpy, key, down, delay);\n\n\tif (regrab) {\n\t\tadjust_grabs(1, 1);\n\t}\n\tif (debug_keyboard) {\n\t\tupup_downdown_warning(key, down);\n\t}\n\tkeycode_state[(int) key] = down ? 1 : 0;\n#endif\n\n#endif\t/* NO_X11 */\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int xtest_present = 0;",
      "int keycode_state[256];",
      "void init_track_keycode_state(void);",
      "void XTRAP_FakeKeyEvent_wr(Display* dpy, KeyCode key, Bool down,\n    unsigned long delay);",
      "void XTestFakeKeyEvent_wr(Display* dpy, int dev_id, KeyCode key, Bool down,\n    unsigned long delay);",
      "void XTRAP_FakeButtonEvent_wr(Display* dpy, unsigned int button, Bool is_press,\n    unsigned long delay);",
      "void XTestFakeButtonEvent_wr(Display* dpy, int dev_id, unsigned int button, Bool is_press,\n    unsigned long delay);",
      "void XTRAP_FakeMotionEvent_wr(Display* dpy, int screen, int x, int y,\n    unsigned long delay);",
      "void XTestFakeMotionEvent_wr(Display* dpy, int dev_id, int screen, int x, int y,\n    unsigned long delay);",
      "void XTestDiscard_wr(Display *dpy);",
      "static void upup_downdown_warning(KeyCode key, Bool down);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "upup_downdown_warning",
          "args": [
            "key",
            "down"
          ],
          "line": 1011
        },
        "resolved": true,
        "details": {
          "function_name": "upup_downdown_warning",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "883-895",
          "snippet": "static void upup_downdown_warning(KeyCode key, Bool down) {\n\tRAWFB_RET_VOID\n#if NO_X11\n\tif (!key || !down) {}\n\treturn;\n#else\n\tif ((down ? 1:0) == keycode_state[(int) key]) {\n\t\tchar *str = XKeysymToString(XKeycodeToKeysym_wr(dpy, key, 0));\n\t\trfbLog(\"XTestFakeKeyEvent: keycode=0x%x \\\"%s\\\" is *already* \"\n\t\t    \"%s\\n\", key, str ? str : \"null\", down ? \"down\":\"up\");\n\t}\n#endif\t/* NO_X11 */\n}",
          "includes": [
            "#include \"nox11_funcs.h\"",
            "#include \"xwrappers.h\"",
            "#include \"xi2_devices.h\"",
            "#include \"macosx.h\"",
            "#include \"cleanup.h\"",
            "#include \"connections.h\"",
            "#include \"xevents.h\"",
            "#include \"keyboard.h\"",
            "#include \"xrecord.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int keycode_state[256];",
            "void XTestDiscard_wr(Display *dpy);",
            "static void upup_downdown_warning(KeyCode key, Bool down);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint keycode_state[256];\nvoid XTestDiscard_wr(Display *dpy);\nstatic void upup_downdown_warning(KeyCode key, Bool down);\n\nstatic void upup_downdown_warning(KeyCode key, Bool down) {\n\tRAWFB_RET_VOID\n#if NO_X11\n\tif (!key || !down) {}\n\treturn;\n#else\n\tif ((down ? 1:0) == keycode_state[(int) key]) {\n\t\tchar *str = XKeysymToString(XKeycodeToKeysym_wr(dpy, key, 0));\n\t\trfbLog(\"XTestFakeKeyEvent: keycode=0x%x \\\"%s\\\" is *already* \"\n\t\t    \"%s\\n\", key, str ? str : \"null\", down ? \"down\":\"up\");\n\t}\n#endif\t/* NO_X11 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "adjust_grabs",
          "args": [
            "1",
            "1"
          ],
          "line": 1008
        },
        "resolved": true,
        "details": {
          "function_name": "adjust_grabs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/connections.c",
          "lines": "4335-4372",
          "snippet": "void adjust_grabs(int grab, int quiet) {\n\tRAWFB_RET_VOID\n#if NO_X11\n\tif (!grab || !quiet) {}\n\treturn;\n#else\n\t/* n.b. caller decides to X_LOCK or not. */\n\tif (grab) {\n\t\tif (grab_kbd) {\n\t\t\tif (! quiet) {\n\t\t\t\trfbLog(\"grabbing keyboard with XGrabKeyboard\\n\");\n\t\t\t}\n\t\t\tXGrabKeyboard(dpy, window, False, GrabModeAsync,\n\t\t\t    GrabModeAsync, CurrentTime);\n\t\t}\n\t\tif (grab_ptr) {\n\t\t\tif (! quiet) {\n\t\t\t\trfbLog(\"grabbing pointer with XGrabPointer\\n\");\n\t\t\t}\n\t\t\tXGrabPointer(dpy, window, False, 0, GrabModeAsync,\n\t\t\t    GrabModeAsync, None, None, CurrentTime);\n\t\t}\n\t} else {\n\t\tif (grab_kbd) {\n\t\t\tif (! quiet) {\n\t\t\t\trfbLog(\"ungrabbing keyboard with XUngrabKeyboard\\n\");\n\t\t\t}\n\t\t\tXUngrabKeyboard(dpy, CurrentTime);\n\t\t}\n\t\tif (grab_ptr) {\n\t\t\tif (! quiet) {\n\t\t\t\trfbLog(\"ungrabbing pointer with XUngrabPointer\\n\");\n\t\t\t}\n\t\t\tXUngrabPointer(dpy, CurrentTime);\n\t\t}\n\t}\n#endif\t/* NO_X11 */\n}",
          "includes": [
            "#include \"xi2_devices.h\"",
            "#include \"xrandr.h\"",
            "#include \"pointer.h\"",
            "#include \"userinput.h\"",
            "#include \"macosxCG.h\"",
            "#include \"macosx.h\"",
            "#include \"win_utils.h\"",
            "#include \"xevents.h\"",
            "#include \"xwrappers.h\"",
            "#include \"sslhelper.h\"",
            "#include \"sslcmds.h\"",
            "#include \"scan.h\"",
            "#include \"user.h\"",
            "#include \"unixpw.h\"",
            "#include \"screen.h\"",
            "#include \"rates.h\"",
            "#include \"solid.h\"",
            "#include \"gui.h\"",
            "#include \"cleanup.h\"",
            "#include \"keyboard.h\"",
            "#include \"remote.h\"",
            "#include \"inet.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void adjust_grabs(int grab, int quiet);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xi2_devices.h\"\n#include \"xrandr.h\"\n#include \"pointer.h\"\n#include \"userinput.h\"\n#include \"macosxCG.h\"\n#include \"macosx.h\"\n#include \"win_utils.h\"\n#include \"xevents.h\"\n#include \"xwrappers.h\"\n#include \"sslhelper.h\"\n#include \"sslcmds.h\"\n#include \"scan.h\"\n#include \"user.h\"\n#include \"unixpw.h\"\n#include \"screen.h\"\n#include \"rates.h\"\n#include \"solid.h\"\n#include \"gui.h\"\n#include \"cleanup.h\"\n#include \"keyboard.h\"\n#include \"remote.h\"\n#include \"inet.h\"\n#include \"x11vnc.h\"\n\nvoid adjust_grabs(int grab, int quiet);\n\nvoid adjust_grabs(int grab, int quiet) {\n\tRAWFB_RET_VOID\n#if NO_X11\n\tif (!grab || !quiet) {}\n\treturn;\n#else\n\t/* n.b. caller decides to X_LOCK or not. */\n\tif (grab) {\n\t\tif (grab_kbd) {\n\t\t\tif (! quiet) {\n\t\t\t\trfbLog(\"grabbing keyboard with XGrabKeyboard\\n\");\n\t\t\t}\n\t\t\tXGrabKeyboard(dpy, window, False, GrabModeAsync,\n\t\t\t    GrabModeAsync, CurrentTime);\n\t\t}\n\t\tif (grab_ptr) {\n\t\t\tif (! quiet) {\n\t\t\t\trfbLog(\"grabbing pointer with XGrabPointer\\n\");\n\t\t\t}\n\t\t\tXGrabPointer(dpy, window, False, 0, GrabModeAsync,\n\t\t\t    GrabModeAsync, None, None, CurrentTime);\n\t\t}\n\t} else {\n\t\tif (grab_kbd) {\n\t\t\tif (! quiet) {\n\t\t\t\trfbLog(\"ungrabbing keyboard with XUngrabKeyboard\\n\");\n\t\t\t}\n\t\t\tXUngrabKeyboard(dpy, CurrentTime);\n\t\t}\n\t\tif (grab_ptr) {\n\t\t\tif (! quiet) {\n\t\t\t\trfbLog(\"ungrabbing pointer with XUngrabPointer\\n\");\n\t\t\t}\n\t\t\tXUngrabPointer(dpy, CurrentTime);\n\t\t}\n\t}\n#endif\t/* NO_X11 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "XTestFakeKeyEvent",
          "args": [
            "dpy",
            "key",
            "down",
            "delay"
          ],
          "line": 1005
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XSetErrorHandler",
          "args": [
            "old_handler"
          ],
          "line": 999
        },
        "resolved": true,
        "details": {
          "function_name": "XSetErrorHandler",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/nox11_funcs.h",
          "lines": "2819-2821",
          "snippet": "XErrorHandler XSetErrorHandler (XErrorHandler h) {\n\treturn h;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "XErrorHandler XSetErrorHandler (XErrorHandler h) {\n\treturn h;\n}"
        }
      },
      {
        "call_info": {
          "callee": "XTestFakeDeviceKeyEvent",
          "args": [
            "dpy",
            "&xdev",
            "key",
            "down",
            "NULL",
            "0",
            "delay"
          ],
          "line": 997
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rfbLog",
          "args": [
            "\"calling XTestFakeKeyEvent(%d, %d)  %.4f\\n\"",
            "key",
            "down",
            "dnowx()"
          ],
          "line": 982
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dnowx",
          "args": [],
          "line": 983
        },
        "resolved": true,
        "details": {
          "function_name": "dnowx",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/util.c",
          "lines": "439-441",
          "snippet": "double dnowx(void) {\n\treturn dnow() - x11vnc_start;\n}",
          "includes": [
            "#include \"connections.h\"",
            "#include \"unixpw.h\"",
            "#include \"win_utils.h\"",
            "#include \"cleanup.h\"",
            "#include \"x11vnc.h\"",
            "#include <stdlib.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "double dnow(void);",
            "double dnowx(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"connections.h\"\n#include \"unixpw.h\"\n#include \"win_utils.h\"\n#include \"cleanup.h\"\n#include \"x11vnc.h\"\n#include <stdlib.h>\n\ndouble dnow(void);\ndouble dnowx(void);\n\ndouble dnowx(void) {\n\treturn dnow() - x11vnc_start;\n}"
        }
      },
      {
        "call_info": {
          "callee": "DEBUG_SKIPPED_INPUT",
          "args": [
            "debug_keyboard",
            "\"keyboard: no-XTEST\""
          ],
          "line": 978
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XTRAP_FakeKeyEvent_wr",
          "args": [
            "dpy",
            "key",
            "down",
            "delay"
          ],
          "line": 970
        },
        "resolved": true,
        "details": {
          "function_name": "XTRAP_FakeKeyEvent_wr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "902-931",
          "snippet": "void XTRAP_FakeKeyEvent_wr(Display* dpy, KeyCode key, Bool down,\n    unsigned long delay) {\n\n\tRAWFB_RET_VOID\n#if NO_X11\n\tnox11_exit(1);\n\tif (!dpy || !key || !down || !delay) {}\n\treturn;\n#else\n\n\tif (! xtrap_present) {\n\t\tDEBUG_SKIPPED_INPUT(debug_keyboard, \"keyboard: no-XTRAP\");\n\t\treturn;\n\t}\n\t/* unused vars warning: */\n\tif (key || down || delay) {}\n\n# if HAVE_LIBXTRAP\n\tXESimulateXEventRequest(trap_ctx, down ? KeyPress : KeyRelease,\n\t    key, 0, 0, 0);\n\tif (debug_keyboard) {\n\t\tupup_downdown_warning(key, down);\n\t}\n\tkeycode_state[(int) key] = down ? 1 : 0;\n# else\n\tDEBUG_SKIPPED_INPUT(debug_keyboard, \"keyboard: no-XTRAP-build\");\n# endif\n\n#endif\t/* NO_X11 */\n}",
          "includes": [
            "#include \"nox11_funcs.h\"",
            "#include \"xwrappers.h\"",
            "#include \"xi2_devices.h\"",
            "#include \"macosx.h\"",
            "#include \"cleanup.h\"",
            "#include \"connections.h\"",
            "#include \"xevents.h\"",
            "#include \"keyboard.h\"",
            "#include \"xrecord.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int xtrap_present = 0;",
            "int keycode_state[256];",
            "void XTRAP_FakeKeyEvent_wr(Display* dpy, KeyCode key, Bool down,\n    unsigned long delay);",
            "void XTestFakeKeyEvent_wr(Display* dpy, int dev_id, KeyCode key, Bool down,\n    unsigned long delay);",
            "void XTRAP_FakeButtonEvent_wr(Display* dpy, unsigned int button, Bool is_press,\n    unsigned long delay);",
            "void XTestFakeButtonEvent_wr(Display* dpy, int dev_id, unsigned int button, Bool is_press,\n    unsigned long delay);",
            "void XTRAP_FakeMotionEvent_wr(Display* dpy, int screen, int x, int y,\n    unsigned long delay);",
            "void XTestFakeMotionEvent_wr(Display* dpy, int dev_id, int screen, int x, int y,\n    unsigned long delay);",
            "void XTestDiscard_wr(Display *dpy);",
            "static void upup_downdown_warning(KeyCode key, Bool down);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint xtrap_present = 0;\nint keycode_state[256];\nvoid XTRAP_FakeKeyEvent_wr(Display* dpy, KeyCode key, Bool down,\n    unsigned long delay);\nvoid XTestFakeKeyEvent_wr(Display* dpy, int dev_id, KeyCode key, Bool down,\n    unsigned long delay);\nvoid XTRAP_FakeButtonEvent_wr(Display* dpy, unsigned int button, Bool is_press,\n    unsigned long delay);\nvoid XTestFakeButtonEvent_wr(Display* dpy, int dev_id, unsigned int button, Bool is_press,\n    unsigned long delay);\nvoid XTRAP_FakeMotionEvent_wr(Display* dpy, int screen, int x, int y,\n    unsigned long delay);\nvoid XTestFakeMotionEvent_wr(Display* dpy, int dev_id, int screen, int x, int y,\n    unsigned long delay);\nvoid XTestDiscard_wr(Display *dpy);\nstatic void upup_downdown_warning(KeyCode key, Bool down);\n\nvoid XTRAP_FakeKeyEvent_wr(Display* dpy, KeyCode key, Bool down,\n    unsigned long delay) {\n\n\tRAWFB_RET_VOID\n#if NO_X11\n\tnox11_exit(1);\n\tif (!dpy || !key || !down || !delay) {}\n\treturn;\n#else\n\n\tif (! xtrap_present) {\n\t\tDEBUG_SKIPPED_INPUT(debug_keyboard, \"keyboard: no-XTRAP\");\n\t\treturn;\n\t}\n\t/* unused vars warning: */\n\tif (key || down || delay) {}\n\n# if HAVE_LIBXTRAP\n\tXESimulateXEventRequest(trap_ctx, down ? KeyPress : KeyRelease,\n\t    key, 0, 0, 0);\n\tif (debug_keyboard) {\n\t\tupup_downdown_warning(key, down);\n\t}\n\tkeycode_state[(int) key] = down ? 1 : 0;\n# else\n\tDEBUG_SKIPPED_INPUT(debug_keyboard, \"keyboard: no-XTRAP-build\");\n# endif\n\n#endif\t/* NO_X11 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "XUngrabPointer",
          "args": [
            "dpy",
            "CurrentTime"
          ],
          "line": 965
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XUngrabKeyboard",
          "args": [
            "dpy",
            "CurrentTime"
          ],
          "line": 961
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_track_keycode_state",
          "args": [],
          "line": 951
        },
        "resolved": true,
        "details": {
          "function_name": "init_track_keycode_state",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "875-881",
          "snippet": "void init_track_keycode_state(void) {\n\tint i;\n\tfor (i=0; i<256; i++) {\n\t\tkeycode_state[i] = 0;\n\t}\n\tget_keystate(keycode_state);\n}",
          "includes": [
            "#include \"nox11_funcs.h\"",
            "#include \"xwrappers.h\"",
            "#include \"xi2_devices.h\"",
            "#include \"macosx.h\"",
            "#include \"cleanup.h\"",
            "#include \"connections.h\"",
            "#include \"xevents.h\"",
            "#include \"keyboard.h\"",
            "#include \"xrecord.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int keycode_state[256];",
            "void init_track_keycode_state(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint keycode_state[256];\nvoid init_track_keycode_state(void);\n\nvoid init_track_keycode_state(void) {\n\tint i;\n\tfor (i=0; i<256; i++) {\n\t\tkeycode_state[i] = 0;\n\t}\n\tget_keystate(keycode_state);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rfbLog",
          "args": [
            "\"XTestFakeKeyEvent(dpy, keycode=0x%x \\\"%s\\\", %s)\\n\"",
            "key",
            "str ? str : \"null\"",
            "down ? \"down\":\"up\""
          ],
          "line": 947
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XKeysymToString",
          "args": [
            "XKeycodeToKeysym_wr(dpy, key, 0)"
          ],
          "line": 946
        },
        "resolved": true,
        "details": {
          "function_name": "XKeysymToString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/nox11_funcs.h",
          "lines": "1449-2807",
          "snippet": "char *XKeysymToString(KeySym k) {\n#ifndef XK_0_nosuch\n\tif (k == XK_VoidSymbol) return \"VoidSymbol\";\n#ifdef XK_MISCELLANY\n\tif (k == XK_BackSpace) return \"BackSpace\";\n\tif (k == XK_Tab) return \"Tab\";\n\tif (k == XK_Linefeed) return \"Linefeed\";\n\tif (k == XK_Clear) return \"Clear\";\n\tif (k == XK_Return) return \"Return\";\n\tif (k == XK_Pause) return \"Pause\";\n\tif (k == XK_Scroll_Lock) return \"Scroll_Lock\";\n\tif (k == XK_Sys_Req) return \"Sys_Req\";\n\tif (k == XK_Escape) return \"Escape\";\n\tif (k == XK_Delete) return \"Delete\";\n\tif (k == XK_Multi_key) return \"Multi_key\";\n\tif (k == XK_SingleCandidate) return \"SingleCandidate\";\n\tif (k == XK_MultipleCandidate) return \"MultipleCandidate\";\n\tif (k == XK_PreviousCandidate) return \"PreviousCandidate\";\n\tif (k == XK_Kanji) return \"Kanji\";\n\tif (k == XK_Muhenkan) return \"Muhenkan\";\n\tif (k == XK_Henkan_Mode) return \"Henkan_Mode\";\n\tif (k == XK_Henkan) return \"Henkan\";\n\tif (k == XK_Romaji) return \"Romaji\";\n\tif (k == XK_Hiragana) return \"Hiragana\";\n\tif (k == XK_Katakana) return \"Katakana\";\n\tif (k == XK_Hiragana_Katakana) return \"Hiragana_Katakana\";\n\tif (k == XK_Zenkaku) return \"Zenkaku\";\n\tif (k == XK_Hankaku) return \"Hankaku\";\n\tif (k == XK_Zenkaku_Hankaku) return \"Zenkaku_Hankaku\";\n\tif (k == XK_Touroku) return \"Touroku\";\n\tif (k == XK_Massyo) return \"Massyo\";\n\tif (k == XK_Kana_Lock) return \"Kana_Lock\";\n\tif (k == XK_Kana_Shift) return \"Kana_Shift\";\n\tif (k == XK_Eisu_Shift) return \"Eisu_Shift\";\n\tif (k == XK_Eisu_toggle) return \"Eisu_toggle\";\n\tif (k == XK_Zen_Koho) return \"Zen_Koho\";\n\tif (k == XK_Mae_Koho) return \"Mae_Koho\";\n\tif (k == XK_Home) return \"Home\";\n\tif (k == XK_Left) return \"Left\";\n\tif (k == XK_Up) return \"Up\";\n\tif (k == XK_Right) return \"Right\";\n\tif (k == XK_Down) return \"Down\";\n\tif (k == XK_Prior) return \"Prior\";\n\tif (k == XK_Page_Up) return \"Page_Up\";\n\tif (k == XK_Next) return \"Next\";\n\tif (k == XK_Page_Down) return \"Page_Down\";\n\tif (k == XK_End) return \"End\";\n\tif (k == XK_Begin) return \"Begin\";\n\tif (k == XK_Select) return \"Select\";\n\tif (k == XK_Print) return \"Print\";\n\tif (k == XK_Execute) return \"Execute\";\n\tif (k == XK_Insert) return \"Insert\";\n\tif (k == XK_Undo) return \"Undo\";\n\tif (k == XK_Redo) return \"Redo\";\n\tif (k == XK_Menu) return \"Menu\";\n\tif (k == XK_Find) return \"Find\";\n\tif (k == XK_Cancel) return \"Cancel\";\n\tif (k == XK_Help) return \"Help\";\n\tif (k == XK_Break) return \"Break\";\n\tif (k == XK_Mode_switch) return \"Mode_switch\";\n\tif (k == XK_script_switch) return \"script_switch\";\n\tif (k == XK_Num_Lock) return \"Num_Lock\";\n\tif (k == XK_KP_Space) return \"KP_Space\";\n\tif (k == XK_KP_Tab) return \"KP_Tab\";\n\tif (k == XK_KP_Enter) return \"KP_Enter\";\n\tif (k == XK_KP_F1) return \"KP_F1\";\n\tif (k == XK_KP_F2) return \"KP_F2\";\n\tif (k == XK_KP_F3) return \"KP_F3\";\n\tif (k == XK_KP_F4) return \"KP_F4\";\n\tif (k == XK_KP_Home) return \"KP_Home\";\n\tif (k == XK_KP_Left) return \"KP_Left\";\n\tif (k == XK_KP_Up) return \"KP_Up\";\n\tif (k == XK_KP_Right) return \"KP_Right\";\n\tif (k == XK_KP_Down) return \"KP_Down\";\n\tif (k == XK_KP_Prior) return \"KP_Prior\";\n\tif (k == XK_KP_Page_Up) return \"KP_Page_Up\";\n\tif (k == XK_KP_Next) return \"KP_Next\";\n\tif (k == XK_KP_Page_Down) return \"KP_Page_Down\";\n\tif (k == XK_KP_End) return \"KP_End\";\n\tif (k == XK_KP_Begin) return \"KP_Begin\";\n\tif (k == XK_KP_Insert) return \"KP_Insert\";\n\tif (k == XK_KP_Delete) return \"KP_Delete\";\n\tif (k == XK_KP_Equal) return \"KP_Equal\";\n\tif (k == XK_KP_Multiply) return \"KP_Multiply\";\n\tif (k == XK_KP_Add) return \"KP_Add\";\n\tif (k == XK_KP_Separator) return \"KP_Separator\";\n\tif (k == XK_KP_Subtract) return \"KP_Subtract\";\n\tif (k == XK_KP_Decimal) return \"KP_Decimal\";\n\tif (k == XK_KP_Divide) return \"KP_Divide\";\n\tif (k == XK_KP_0) return \"KP_0\";\n\tif (k == XK_KP_1) return \"KP_1\";\n\tif (k == XK_KP_2) return \"KP_2\";\n\tif (k == XK_KP_3) return \"KP_3\";\n\tif (k == XK_KP_4) return \"KP_4\";\n\tif (k == XK_KP_5) return \"KP_5\";\n\tif (k == XK_KP_6) return \"KP_6\";\n\tif (k == XK_KP_7) return \"KP_7\";\n\tif (k == XK_KP_8) return \"KP_8\";\n\tif (k == XK_KP_9) return \"KP_9\";\n\tif (k == XK_F1) return \"F1\";\n\tif (k == XK_F2) return \"F2\";\n\tif (k == XK_F3) return \"F3\";\n\tif (k == XK_F4) return \"F4\";\n\tif (k == XK_F5) return \"F5\";\n\tif (k == XK_F6) return \"F6\";\n\tif (k == XK_F7) return \"F7\";\n\tif (k == XK_F8) return \"F8\";\n\tif (k == XK_F9) return \"F9\";\n\tif (k == XK_F10) return \"F10\";\n\tif (k == XK_F11) return \"F11\";\n\tif (k == XK_L1) return \"L1\";\n\tif (k == XK_F12) return \"F12\";\n\tif (k == XK_L2) return \"L2\";\n\tif (k == XK_F13) return \"F13\";\n\tif (k == XK_L3) return \"L3\";\n\tif (k == XK_F14) return \"F14\";\n\tif (k == XK_L4) return \"L4\";\n\tif (k == XK_F15) return \"F15\";\n\tif (k == XK_L5) return \"L5\";\n\tif (k == XK_F16) return \"F16\";\n\tif (k == XK_L6) return \"L6\";\n\tif (k == XK_F17) return \"F17\";\n\tif (k == XK_L7) return \"L7\";\n\tif (k == XK_F18) return \"F18\";\n\tif (k == XK_L8) return \"L8\";\n\tif (k == XK_F19) return \"F19\";\n\tif (k == XK_L9) return \"L9\";\n\tif (k == XK_F20) return \"F20\";\n\tif (k == XK_L10) return \"L10\";\n\tif (k == XK_F21) return \"F21\";\n\tif (k == XK_R1) return \"R1\";\n\tif (k == XK_F22) return \"F22\";\n\tif (k == XK_R2) return \"R2\";\n\tif (k == XK_F23) return \"F23\";\n\tif (k == XK_R3) return \"R3\";\n\tif (k == XK_F24) return \"F24\";\n\tif (k == XK_R4) return \"R4\";\n\tif (k == XK_F25) return \"F25\";\n\tif (k == XK_R5) return \"R5\";\n\tif (k == XK_F26) return \"F26\";\n\tif (k == XK_R6) return \"R6\";\n\tif (k == XK_F27) return \"F27\";\n\tif (k == XK_R7) return \"R7\";\n\tif (k == XK_F28) return \"F28\";\n\tif (k == XK_R8) return \"R8\";\n\tif (k == XK_F29) return \"F29\";\n\tif (k == XK_R9) return \"R9\";\n\tif (k == XK_F30) return \"F30\";\n\tif (k == XK_R10) return \"R10\";\n\tif (k == XK_F31) return \"F31\";\n\tif (k == XK_R11) return \"R11\";\n\tif (k == XK_F32) return \"F32\";\n\tif (k == XK_R12) return \"R12\";\n\tif (k == XK_F33) return \"F33\";\n\tif (k == XK_R13) return \"R13\";\n\tif (k == XK_F34) return \"F34\";\n\tif (k == XK_R14) return \"R14\";\n\tif (k == XK_F35) return \"F35\";\n\tif (k == XK_R15) return \"R15\";\n\tif (k == XK_Shift_L) return \"Shift_L\";\n\tif (k == XK_Shift_R) return \"Shift_R\";\n\tif (k == XK_Control_L) return \"Control_L\";\n\tif (k == XK_Control_R) return \"Control_R\";\n\tif (k == XK_Caps_Lock) return \"Caps_Lock\";\n\tif (k == XK_Shift_Lock) return \"Shift_Lock\";\n\tif (k == XK_Meta_L) return \"Meta_L\";\n\tif (k == XK_Meta_R) return \"Meta_R\";\n\tif (k == XK_Alt_L) return \"Alt_L\";\n\tif (k == XK_Alt_R) return \"Alt_R\";\n\tif (k == XK_Super_L) return \"Super_L\";\n\tif (k == XK_Super_R) return \"Super_R\";\n\tif (k == XK_Hyper_L) return \"Hyper_L\";\n\tif (k == XK_Hyper_R) return \"Hyper_R\";\n#endif /* XK_MISCELLANY */\n#ifdef XK_XKB_KEYS\n\tif (k == XK_ISO_Lock) return \"ISO_Lock\";\n\tif (k == XK_ISO_Level2_Latch) return \"ISO_Level2_Latch\";\n\tif (k == XK_ISO_Level3_Shift) return \"ISO_Level3_Shift\";\n\tif (k == XK_ISO_Level3_Latch) return \"ISO_Level3_Latch\";\n\tif (k == XK_ISO_Level3_Lock) return \"ISO_Level3_Lock\";\n\tif (k == XK_ISO_Group_Shift) return \"ISO_Group_Shift\";\n\tif (k == XK_ISO_Group_Latch) return \"ISO_Group_Latch\";\n\tif (k == XK_ISO_Group_Lock) return \"ISO_Group_Lock\";\n\tif (k == XK_ISO_Next_Group) return \"ISO_Next_Group\";\n\tif (k == XK_ISO_Next_Group_Lock) return \"ISO_Next_Group_Lock\";\n\tif (k == XK_ISO_Prev_Group) return \"ISO_Prev_Group\";\n\tif (k == XK_ISO_Prev_Group_Lock) return \"ISO_Prev_Group_Lock\";\n\tif (k == XK_ISO_First_Group) return \"ISO_First_Group\";\n\tif (k == XK_ISO_First_Group_Lock) return \"ISO_First_Group_Lock\";\n\tif (k == XK_ISO_Last_Group) return \"ISO_Last_Group\";\n\tif (k == XK_ISO_Last_Group_Lock) return \"ISO_Last_Group_Lock\";\n\tif (k == XK_ISO_Left_Tab) return \"ISO_Left_Tab\";\n\tif (k == XK_ISO_Move_Line_Up) return \"ISO_Move_Line_Up\";\n\tif (k == XK_ISO_Move_Line_Down) return \"ISO_Move_Line_Down\";\n\tif (k == XK_ISO_Partial_Line_Up) return \"ISO_Partial_Line_Up\";\n\tif (k == XK_ISO_Partial_Line_Down) return \"ISO_Partial_Line_Down\";\n\tif (k == XK_ISO_Partial_Space_Left) return \"ISO_Partial_Space_Left\";\n\tif (k == XK_ISO_Partial_Space_Right) return \"ISO_Partial_Space_Right\";\n\tif (k == XK_ISO_Set_Margin_Left) return \"ISO_Set_Margin_Left\";\n\tif (k == XK_ISO_Set_Margin_Right) return \"ISO_Set_Margin_Right\";\n\tif (k == XK_ISO_Release_Margin_Left) return \"ISO_Release_Margin_Left\";\n\tif (k == XK_ISO_Release_Margin_Right) return \"ISO_Release_Margin_Right\";\n\tif (k == XK_ISO_Release_Both_Margins) return \"ISO_Release_Both_Margins\";\n\tif (k == XK_ISO_Fast_Cursor_Left) return \"ISO_Fast_Cursor_Left\";\n\tif (k == XK_ISO_Fast_Cursor_Right) return \"ISO_Fast_Cursor_Right\";\n\tif (k == XK_ISO_Fast_Cursor_Up) return \"ISO_Fast_Cursor_Up\";\n\tif (k == XK_ISO_Fast_Cursor_Down) return \"ISO_Fast_Cursor_Down\";\n\tif (k == XK_ISO_Continuous_Underline) return \"ISO_Continuous_Underline\";\n\tif (k == XK_ISO_Discontinuous_Underline) return \"ISO_Discontinuous_Underline\";\n\tif (k == XK_ISO_Emphasize) return \"ISO_Emphasize\";\n\tif (k == XK_ISO_Center_Object) return \"ISO_Center_Object\";\n\tif (k == XK_ISO_Enter) return \"ISO_Enter\";\n\tif (k == XK_dead_grave) return \"dead_grave\";\n\tif (k == XK_dead_acute) return \"dead_acute\";\n\tif (k == XK_dead_circumflex) return \"dead_circumflex\";\n\tif (k == XK_dead_tilde) return \"dead_tilde\";\n\tif (k == XK_dead_macron) return \"dead_macron\";\n\tif (k == XK_dead_breve) return \"dead_breve\";\n\tif (k == XK_dead_abovedot) return \"dead_abovedot\";\n\tif (k == XK_dead_diaeresis) return \"dead_diaeresis\";\n\tif (k == XK_dead_abovering) return \"dead_abovering\";\n\tif (k == XK_dead_doubleacute) return \"dead_doubleacute\";\n\tif (k == XK_dead_caron) return \"dead_caron\";\n\tif (k == XK_dead_cedilla) return \"dead_cedilla\";\n\tif (k == XK_dead_ogonek) return \"dead_ogonek\";\n\tif (k == XK_dead_iota) return \"dead_iota\";\n\tif (k == XK_dead_voiced_sound) return \"dead_voiced_sound\";\n\tif (k == XK_dead_semivoiced_sound) return \"dead_semivoiced_sound\";\n\tif (k == XK_dead_belowdot) return \"dead_belowdot\";\n\tif (k == XK_First_Virtual_Screen) return \"First_Virtual_Screen\";\n\tif (k == XK_Prev_Virtual_Screen) return \"Prev_Virtual_Screen\";\n\tif (k == XK_Next_Virtual_Screen) return \"Next_Virtual_Screen\";\n\tif (k == XK_Last_Virtual_Screen) return \"Last_Virtual_Screen\";\n\tif (k == XK_Terminate_Server) return \"Terminate_Server\";\n\tif (k == XK_AccessX_Enable) return \"AccessX_Enable\";\n\tif (k == XK_AccessX_Feedback_Enable) return \"AccessX_Feedback_Enable\";\n\tif (k == XK_RepeatKeys_Enable) return \"RepeatKeys_Enable\";\n\tif (k == XK_SlowKeys_Enable) return \"SlowKeys_Enable\";\n\tif (k == XK_BounceKeys_Enable) return \"BounceKeys_Enable\";\n\tif (k == XK_StickyKeys_Enable) return \"StickyKeys_Enable\";\n\tif (k == XK_MouseKeys_Enable) return \"MouseKeys_Enable\";\n\tif (k == XK_MouseKeys_Accel_Enable) return \"MouseKeys_Accel_Enable\";\n\tif (k == XK_Overlay1_Enable) return \"Overlay1_Enable\";\n\tif (k == XK_Overlay2_Enable) return \"Overlay2_Enable\";\n\tif (k == XK_AudibleBell_Enable) return \"AudibleBell_Enable\";\n\tif (k == XK_Pointer_Left) return \"Pointer_Left\";\n\tif (k == XK_Pointer_Right) return \"Pointer_Right\";\n\tif (k == XK_Pointer_Up) return \"Pointer_Up\";\n\tif (k == XK_Pointer_Down) return \"Pointer_Down\";\n\tif (k == XK_Pointer_UpLeft) return \"Pointer_UpLeft\";\n\tif (k == XK_Pointer_UpRight) return \"Pointer_UpRight\";\n\tif (k == XK_Pointer_DownLeft) return \"Pointer_DownLeft\";\n\tif (k == XK_Pointer_DownRight) return \"Pointer_DownRight\";\n\tif (k == XK_Pointer_Button_Dflt) return \"Pointer_Button_Dflt\";\n\tif (k == XK_Pointer_Button1) return \"Pointer_Button1\";\n\tif (k == XK_Pointer_Button2) return \"Pointer_Button2\";\n\tif (k == XK_Pointer_Button3) return \"Pointer_Button3\";\n\tif (k == XK_Pointer_Button4) return \"Pointer_Button4\";\n\tif (k == XK_Pointer_Button5) return \"Pointer_Button5\";\n\tif (k == XK_Pointer_DblClick_Dflt) return \"Pointer_DblClick_Dflt\";\n\tif (k == XK_Pointer_DblClick1) return \"Pointer_DblClick1\";\n\tif (k == XK_Pointer_DblClick2) return \"Pointer_DblClick2\";\n\tif (k == XK_Pointer_DblClick3) return \"Pointer_DblClick3\";\n\tif (k == XK_Pointer_DblClick4) return \"Pointer_DblClick4\";\n\tif (k == XK_Pointer_DblClick5) return \"Pointer_DblClick5\";\n\tif (k == XK_Pointer_Drag_Dflt) return \"Pointer_Drag_Dflt\";\n\tif (k == XK_Pointer_Drag1) return \"Pointer_Drag1\";\n\tif (k == XK_Pointer_Drag2) return \"Pointer_Drag2\";\n\tif (k == XK_Pointer_Drag3) return \"Pointer_Drag3\";\n\tif (k == XK_Pointer_Drag4) return \"Pointer_Drag4\";\n\tif (k == XK_Pointer_Drag5) return \"Pointer_Drag5\";\n\tif (k == XK_Pointer_EnableKeys) return \"Pointer_EnableKeys\";\n\tif (k == XK_Pointer_Accelerate) return \"Pointer_Accelerate\";\n\tif (k == XK_Pointer_DfltBtnNext) return \"Pointer_DfltBtnNext\";\n\tif (k == XK_Pointer_DfltBtnPrev) return \"Pointer_DfltBtnPrev\";\n#endif\n#ifdef XK_3270\n\tif (k == XK_3270_Duplicate) return \"3270_Duplicate\";\n\tif (k == XK_3270_FieldMark) return \"3270_FieldMark\";\n\tif (k == XK_3270_Right2) return \"3270_Right2\";\n\tif (k == XK_3270_Left2) return \"3270_Left2\";\n\tif (k == XK_3270_BackTab) return \"3270_BackTab\";\n\tif (k == XK_3270_EraseEOF) return \"3270_EraseEOF\";\n\tif (k == XK_3270_EraseInput) return \"3270_EraseInput\";\n\tif (k == XK_3270_Reset) return \"3270_Reset\";\n\tif (k == XK_3270_Quit) return \"3270_Quit\";\n\tif (k == XK_3270_PA1) return \"3270_PA1\";\n\tif (k == XK_3270_PA2) return \"3270_PA2\";\n\tif (k == XK_3270_PA3) return \"3270_PA3\";\n\tif (k == XK_3270_Test) return \"3270_Test\";\n\tif (k == XK_3270_Attn) return \"3270_Attn\";\n\tif (k == XK_3270_CursorBlink) return \"3270_CursorBlink\";\n\tif (k == XK_3270_AltCursor) return \"3270_AltCursor\";\n\tif (k == XK_3270_KeyClick) return \"3270_KeyClick\";\n\tif (k == XK_3270_Jump) return \"3270_Jump\";\n\tif (k == XK_3270_Ident) return \"3270_Ident\";\n\tif (k == XK_3270_Rule) return \"3270_Rule\";\n\tif (k == XK_3270_Copy) return \"3270_Copy\";\n\tif (k == XK_3270_Play) return \"3270_Play\";\n\tif (k == XK_3270_Setup) return \"3270_Setup\";\n\tif (k == XK_3270_Record) return \"3270_Record\";\n\tif (k == XK_3270_ChangeScreen) return \"3270_ChangeScreen\";\n\tif (k == XK_3270_DeleteWord) return \"3270_DeleteWord\";\n\tif (k == XK_3270_ExSelect) return \"3270_ExSelect\";\n\tif (k == XK_3270_CursorSelect) return \"3270_CursorSelect\";\n\tif (k == XK_3270_PrintScreen) return \"3270_PrintScreen\";\n\tif (k == XK_3270_Enter) return \"3270_Enter\";\n#endif\n#ifdef XK_LATIN1\n\tif (k == XK_space) return \"space\";\n\tif (k == XK_exclam) return \"exclam\";\n\tif (k == XK_quotedbl) return \"quotedbl\";\n\tif (k == XK_numbersign) return \"numbersign\";\n\tif (k == XK_dollar) return \"dollar\";\n\tif (k == XK_percent) return \"percent\";\n\tif (k == XK_ampersand) return \"ampersand\";\n\tif (k == XK_apostrophe) return \"apostrophe\";\n\tif (k == XK_quoteright) return \"quoteright\";\n\tif (k == XK_parenleft) return \"parenleft\";\n\tif (k == XK_parenright) return \"parenright\";\n\tif (k == XK_asterisk) return \"asterisk\";\n\tif (k == XK_plus) return \"plus\";\n\tif (k == XK_comma) return \"comma\";\n\tif (k == XK_minus) return \"minus\";\n\tif (k == XK_period) return \"period\";\n\tif (k == XK_slash) return \"slash\";\n\tif (k == XK_0) return \"0\";\n\tif (k == XK_1) return \"1\";\n\tif (k == XK_2) return \"2\";\n\tif (k == XK_3) return \"3\";\n\tif (k == XK_4) return \"4\";\n\tif (k == XK_5) return \"5\";\n\tif (k == XK_6) return \"6\";\n\tif (k == XK_7) return \"7\";\n\tif (k == XK_8) return \"8\";\n\tif (k == XK_9) return \"9\";\n\tif (k == XK_colon) return \"colon\";\n\tif (k == XK_semicolon) return \"semicolon\";\n\tif (k == XK_less) return \"less\";\n\tif (k == XK_equal) return \"equal\";\n\tif (k == XK_greater) return \"greater\";\n\tif (k == XK_question) return \"question\";\n\tif (k == XK_at) return \"at\";\n\tif (k == XK_A) return \"A\";\n\tif (k == XK_B) return \"B\";\n\tif (k == XK_C) return \"C\";\n\tif (k == XK_D) return \"D\";\n\tif (k == XK_E) return \"E\";\n\tif (k == XK_F) return \"F\";\n\tif (k == XK_G) return \"G\";\n\tif (k == XK_H) return \"H\";\n\tif (k == XK_I) return \"I\";\n\tif (k == XK_J) return \"J\";\n\tif (k == XK_K) return \"K\";\n\tif (k == XK_L) return \"L\";\n\tif (k == XK_M) return \"M\";\n\tif (k == XK_N) return \"N\";\n\tif (k == XK_O) return \"O\";\n\tif (k == XK_P) return \"P\";\n\tif (k == XK_Q) return \"Q\";\n\tif (k == XK_R) return \"R\";\n\tif (k == XK_S) return \"S\";\n\tif (k == XK_T) return \"T\";\n\tif (k == XK_U) return \"U\";\n\tif (k == XK_V) return \"V\";\n\tif (k == XK_W) return \"W\";\n\tif (k == XK_X) return \"X\";\n\tif (k == XK_Y) return \"Y\";\n\tif (k == XK_Z) return \"Z\";\n\tif (k == XK_bracketleft) return \"bracketleft\";\n\tif (k == XK_backslash) return \"backslash\";\n\tif (k == XK_bracketright) return \"bracketright\";\n\tif (k == XK_asciicircum) return \"asciicircum\";\n\tif (k == XK_underscore) return \"underscore\";\n\tif (k == XK_grave) return \"grave\";\n\tif (k == XK_quoteleft) return \"quoteleft\";\n\tif (k == XK_a) return \"a\";\n\tif (k == XK_b) return \"b\";\n\tif (k == XK_c) return \"c\";\n\tif (k == XK_d) return \"d\";\n\tif (k == XK_e) return \"e\";\n\tif (k == XK_f) return \"f\";\n\tif (k == XK_g) return \"g\";\n\tif (k == XK_h) return \"h\";\n\tif (k == XK_i) return \"i\";\n\tif (k == XK_j) return \"j\";\n\tif (k == XK_k) return \"k\";\n\tif (k == XK_l) return \"l\";\n\tif (k == XK_m) return \"m\";\n\tif (k == XK_n) return \"n\";\n\tif (k == XK_o) return \"o\";\n\tif (k == XK_p) return \"p\";\n\tif (k == XK_q) return \"q\";\n\tif (k == XK_r) return \"r\";\n\tif (k == XK_s) return \"s\";\n\tif (k == XK_t) return \"t\";\n\tif (k == XK_u) return \"u\";\n\tif (k == XK_v) return \"v\";\n\tif (k == XK_w) return \"w\";\n\tif (k == XK_x) return \"x\";\n\tif (k == XK_y) return \"y\";\n\tif (k == XK_z) return \"z\";\n\tif (k == XK_braceleft) return \"braceleft\";\n\tif (k == XK_bar) return \"bar\";\n\tif (k == XK_braceright) return \"braceright\";\n\tif (k == XK_asciitilde) return \"asciitilde\";\n\tif (k == XK_nobreakspace) return \"nobreakspace\";\n\tif (k == XK_exclamdown) return \"exclamdown\";\n\tif (k == XK_cent) return \"cent\";\n\tif (k == XK_sterling) return \"sterling\";\n\tif (k == XK_currency) return \"currency\";\n\tif (k == XK_yen) return \"yen\";\n\tif (k == XK_brokenbar) return \"brokenbar\";\n\tif (k == XK_section) return \"section\";\n\tif (k == XK_diaeresis) return \"diaeresis\";\n\tif (k == XK_copyright) return \"copyright\";\n\tif (k == XK_ordfeminine) return \"ordfeminine\";\n\tif (k == XK_guillemotleft) return \"guillemotleft\";\n\tif (k == XK_notsign) return \"notsign\";\n\tif (k == XK_hyphen) return \"hyphen\";\n\tif (k == XK_registered) return \"registered\";\n\tif (k == XK_macron) return \"macron\";\n\tif (k == XK_degree) return \"degree\";\n\tif (k == XK_plusminus) return \"plusminus\";\n\tif (k == XK_twosuperior) return \"twosuperior\";\n\tif (k == XK_threesuperior) return \"threesuperior\";\n\tif (k == XK_acute) return \"acute\";\n\tif (k == XK_mu) return \"mu\";\n\tif (k == XK_paragraph) return \"paragraph\";\n\tif (k == XK_periodcentered) return \"periodcentered\";\n\tif (k == XK_cedilla) return \"cedilla\";\n\tif (k == XK_onesuperior) return \"onesuperior\";\n\tif (k == XK_masculine) return \"masculine\";\n\tif (k == XK_guillemotright) return \"guillemotright\";\n\tif (k == XK_onequarter) return \"onequarter\";\n\tif (k == XK_onehalf) return \"onehalf\";\n\tif (k == XK_threequarters) return \"threequarters\";\n\tif (k == XK_questiondown) return \"questiondown\";\n\tif (k == XK_Agrave) return \"Agrave\";\n\tif (k == XK_Aacute) return \"Aacute\";\n\tif (k == XK_Acircumflex) return \"Acircumflex\";\n\tif (k == XK_Atilde) return \"Atilde\";\n\tif (k == XK_Adiaeresis) return \"Adiaeresis\";\n\tif (k == XK_Aring) return \"Aring\";\n\tif (k == XK_AE) return \"AE\";\n\tif (k == XK_Ccedilla) return \"Ccedilla\";\n\tif (k == XK_Egrave) return \"Egrave\";\n\tif (k == XK_Eacute) return \"Eacute\";\n\tif (k == XK_Ecircumflex) return \"Ecircumflex\";\n\tif (k == XK_Ediaeresis) return \"Ediaeresis\";\n\tif (k == XK_Igrave) return \"Igrave\";\n\tif (k == XK_Iacute) return \"Iacute\";\n\tif (k == XK_Icircumflex) return \"Icircumflex\";\n\tif (k == XK_Idiaeresis) return \"Idiaeresis\";\n\tif (k == XK_ETH) return \"ETH\";\n\tif (k == XK_Eth) return \"Eth\";\n\tif (k == XK_Ntilde) return \"Ntilde\";\n\tif (k == XK_Ograve) return \"Ograve\";\n\tif (k == XK_Oacute) return \"Oacute\";\n\tif (k == XK_Ocircumflex) return \"Ocircumflex\";\n\tif (k == XK_Otilde) return \"Otilde\";\n\tif (k == XK_Odiaeresis) return \"Odiaeresis\";\n\tif (k == XK_multiply) return \"multiply\";\n\tif (k == XK_Ooblique) return \"Ooblique\";\n\tif (k == XK_Ugrave) return \"Ugrave\";\n\tif (k == XK_Uacute) return \"Uacute\";\n\tif (k == XK_Ucircumflex) return \"Ucircumflex\";\n\tif (k == XK_Udiaeresis) return \"Udiaeresis\";\n\tif (k == XK_Yacute) return \"Yacute\";\n\tif (k == XK_THORN) return \"THORN\";\n\tif (k == XK_Thorn) return \"Thorn\";\n\tif (k == XK_ssharp) return \"ssharp\";\n\tif (k == XK_agrave) return \"agrave\";\n\tif (k == XK_aacute) return \"aacute\";\n\tif (k == XK_acircumflex) return \"acircumflex\";\n\tif (k == XK_atilde) return \"atilde\";\n\tif (k == XK_adiaeresis) return \"adiaeresis\";\n\tif (k == XK_aring) return \"aring\";\n\tif (k == XK_ae) return \"ae\";\n\tif (k == XK_ccedilla) return \"ccedilla\";\n\tif (k == XK_egrave) return \"egrave\";\n\tif (k == XK_eacute) return \"eacute\";\n\tif (k == XK_ecircumflex) return \"ecircumflex\";\n\tif (k == XK_ediaeresis) return \"ediaeresis\";\n\tif (k == XK_igrave) return \"igrave\";\n\tif (k == XK_iacute) return \"iacute\";\n\tif (k == XK_icircumflex) return \"icircumflex\";\n\tif (k == XK_idiaeresis) return \"idiaeresis\";\n\tif (k == XK_eth) return \"eth\";\n\tif (k == XK_ntilde) return \"ntilde\";\n\tif (k == XK_ograve) return \"ograve\";\n\tif (k == XK_oacute) return \"oacute\";\n\tif (k == XK_ocircumflex) return \"ocircumflex\";\n\tif (k == XK_otilde) return \"otilde\";\n\tif (k == XK_odiaeresis) return \"odiaeresis\";\n\tif (k == XK_division) return \"division\";\n\tif (k == XK_oslash) return \"oslash\";\n\tif (k == XK_ugrave) return \"ugrave\";\n\tif (k == XK_uacute) return \"uacute\";\n\tif (k == XK_ucircumflex) return \"ucircumflex\";\n\tif (k == XK_udiaeresis) return \"udiaeresis\";\n\tif (k == XK_yacute) return \"yacute\";\n\tif (k == XK_thorn) return \"thorn\";\n\tif (k == XK_ydiaeresis) return \"ydiaeresis\";\n#endif /* XK_LATIN1 */\n#ifdef XK_LATIN2\n\tif (k == XK_Aogonek) return \"Aogonek\";\n\tif (k == XK_breve) return \"breve\";\n\tif (k == XK_Lstroke) return \"Lstroke\";\n\tif (k == XK_Lcaron) return \"Lcaron\";\n\tif (k == XK_Sacute) return \"Sacute\";\n\tif (k == XK_Scaron) return \"Scaron\";\n\tif (k == XK_Scedilla) return \"Scedilla\";\n\tif (k == XK_Tcaron) return \"Tcaron\";\n\tif (k == XK_Zacute) return \"Zacute\";\n\tif (k == XK_Zcaron) return \"Zcaron\";\n\tif (k == XK_Zabovedot) return \"Zabovedot\";\n\tif (k == XK_aogonek) return \"aogonek\";\n\tif (k == XK_ogonek) return \"ogonek\";\n\tif (k == XK_lstroke) return \"lstroke\";\n\tif (k == XK_lcaron) return \"lcaron\";\n\tif (k == XK_sacute) return \"sacute\";\n\tif (k == XK_caron) return \"caron\";\n\tif (k == XK_scaron) return \"scaron\";\n\tif (k == XK_scedilla) return \"scedilla\";\n\tif (k == XK_tcaron) return \"tcaron\";\n\tif (k == XK_zacute) return \"zacute\";\n\tif (k == XK_doubleacute) return \"doubleacute\";\n\tif (k == XK_zcaron) return \"zcaron\";\n\tif (k == XK_zabovedot) return \"zabovedot\";\n\tif (k == XK_Racute) return \"Racute\";\n\tif (k == XK_Abreve) return \"Abreve\";\n\tif (k == XK_Lacute) return \"Lacute\";\n\tif (k == XK_Cacute) return \"Cacute\";\n\tif (k == XK_Ccaron) return \"Ccaron\";\n\tif (k == XK_Eogonek) return \"Eogonek\";\n\tif (k == XK_Ecaron) return \"Ecaron\";\n\tif (k == XK_Dcaron) return \"Dcaron\";\n\tif (k == XK_Dstroke) return \"Dstroke\";\n\tif (k == XK_Nacute) return \"Nacute\";\n\tif (k == XK_Ncaron) return \"Ncaron\";\n\tif (k == XK_Odoubleacute) return \"Odoubleacute\";\n\tif (k == XK_Rcaron) return \"Rcaron\";\n\tif (k == XK_Uring) return \"Uring\";\n\tif (k == XK_Udoubleacute) return \"Udoubleacute\";\n\tif (k == XK_Tcedilla) return \"Tcedilla\";\n\tif (k == XK_racute) return \"racute\";\n\tif (k == XK_abreve) return \"abreve\";\n\tif (k == XK_lacute) return \"lacute\";\n\tif (k == XK_cacute) return \"cacute\";\n\tif (k == XK_ccaron) return \"ccaron\";\n\tif (k == XK_eogonek) return \"eogonek\";\n\tif (k == XK_ecaron) return \"ecaron\";\n\tif (k == XK_dcaron) return \"dcaron\";\n\tif (k == XK_dstroke) return \"dstroke\";\n\tif (k == XK_nacute) return \"nacute\";\n\tif (k == XK_ncaron) return \"ncaron\";\n\tif (k == XK_odoubleacute) return \"odoubleacute\";\n\tif (k == XK_udoubleacute) return \"udoubleacute\";\n\tif (k == XK_rcaron) return \"rcaron\";\n\tif (k == XK_uring) return \"uring\";\n\tif (k == XK_tcedilla) return \"tcedilla\";\n\tif (k == XK_abovedot) return \"abovedot\";\n#endif /* XK_LATIN2 */\n#ifdef XK_LATIN3\n\tif (k == XK_Hstroke) return \"Hstroke\";\n\tif (k == XK_Hcircumflex) return \"Hcircumflex\";\n\tif (k == XK_Iabovedot) return \"Iabovedot\";\n\tif (k == XK_Gbreve) return \"Gbreve\";\n\tif (k == XK_Jcircumflex) return \"Jcircumflex\";\n\tif (k == XK_hstroke) return \"hstroke\";\n\tif (k == XK_hcircumflex) return \"hcircumflex\";\n\tif (k == XK_idotless) return \"idotless\";\n\tif (k == XK_gbreve) return \"gbreve\";\n\tif (k == XK_jcircumflex) return \"jcircumflex\";\n\tif (k == XK_Cabovedot) return \"Cabovedot\";\n\tif (k == XK_Ccircumflex) return \"Ccircumflex\";\n\tif (k == XK_Gabovedot) return \"Gabovedot\";\n\tif (k == XK_Gcircumflex) return \"Gcircumflex\";\n\tif (k == XK_Ubreve) return \"Ubreve\";\n\tif (k == XK_Scircumflex) return \"Scircumflex\";\n\tif (k == XK_cabovedot) return \"cabovedot\";\n\tif (k == XK_ccircumflex) return \"ccircumflex\";\n\tif (k == XK_gabovedot) return \"gabovedot\";\n\tif (k == XK_gcircumflex) return \"gcircumflex\";\n\tif (k == XK_ubreve) return \"ubreve\";\n\tif (k == XK_scircumflex) return \"scircumflex\";\n#endif /* XK_LATIN3 */\n#ifdef XK_LATIN4\n\tif (k == XK_kra) return \"kra\";\n\tif (k == XK_kappa) return \"kappa\";\n\tif (k == XK_Rcedilla) return \"Rcedilla\";\n\tif (k == XK_Itilde) return \"Itilde\";\n\tif (k == XK_Lcedilla) return \"Lcedilla\";\n\tif (k == XK_Emacron) return \"Emacron\";\n\tif (k == XK_Gcedilla) return \"Gcedilla\";\n\tif (k == XK_Tslash) return \"Tslash\";\n\tif (k == XK_rcedilla) return \"rcedilla\";\n\tif (k == XK_itilde) return \"itilde\";\n\tif (k == XK_lcedilla) return \"lcedilla\";\n\tif (k == XK_emacron) return \"emacron\";\n\tif (k == XK_gcedilla) return \"gcedilla\";\n\tif (k == XK_tslash) return \"tslash\";\n\tif (k == XK_ENG) return \"ENG\";\n\tif (k == XK_eng) return \"eng\";\n\tif (k == XK_Amacron) return \"Amacron\";\n\tif (k == XK_Iogonek) return \"Iogonek\";\n\tif (k == XK_Eabovedot) return \"Eabovedot\";\n\tif (k == XK_Imacron) return \"Imacron\";\n\tif (k == XK_Ncedilla) return \"Ncedilla\";\n\tif (k == XK_Omacron) return \"Omacron\";\n\tif (k == XK_Kcedilla) return \"Kcedilla\";\n\tif (k == XK_Uogonek) return \"Uogonek\";\n\tif (k == XK_Utilde) return \"Utilde\";\n\tif (k == XK_Umacron) return \"Umacron\";\n\tif (k == XK_amacron) return \"amacron\";\n\tif (k == XK_iogonek) return \"iogonek\";\n\tif (k == XK_eabovedot) return \"eabovedot\";\n\tif (k == XK_imacron) return \"imacron\";\n\tif (k == XK_ncedilla) return \"ncedilla\";\n\tif (k == XK_omacron) return \"omacron\";\n\tif (k == XK_kcedilla) return \"kcedilla\";\n\tif (k == XK_uogonek) return \"uogonek\";\n\tif (k == XK_utilde) return \"utilde\";\n\tif (k == XK_umacron) return \"umacron\";\n#endif /* XK_LATIN4 */\n#ifdef XK_KATAKANA\n\tif (k == XK_overline) return \"overline\";\n\tif (k == XK_kana_fullstop) return \"kana_fullstop\";\n\tif (k == XK_kana_openingbracket) return \"kana_openingbracket\";\n\tif (k == XK_kana_closingbracket) return \"kana_closingbracket\";\n\tif (k == XK_kana_comma) return \"kana_comma\";\n\tif (k == XK_kana_conjunctive) return \"kana_conjunctive\";\n\tif (k == XK_kana_middledot) return \"kana_middledot\";\n\tif (k == XK_kana_WO) return \"kana_WO\";\n\tif (k == XK_kana_a) return \"kana_a\";\n\tif (k == XK_kana_i) return \"kana_i\";\n\tif (k == XK_kana_u) return \"kana_u\";\n\tif (k == XK_kana_e) return \"kana_e\";\n\tif (k == XK_kana_o) return \"kana_o\";\n\tif (k == XK_kana_ya) return \"kana_ya\";\n\tif (k == XK_kana_yu) return \"kana_yu\";\n\tif (k == XK_kana_yo) return \"kana_yo\";\n\tif (k == XK_kana_tsu) return \"kana_tsu\";\n\tif (k == XK_kana_tu) return \"kana_tu\";\n\tif (k == XK_prolongedsound) return \"prolongedsound\";\n\tif (k == XK_kana_A) return \"kana_A\";\n\tif (k == XK_kana_I) return \"kana_I\";\n\tif (k == XK_kana_U) return \"kana_U\";\n\tif (k == XK_kana_E) return \"kana_E\";\n\tif (k == XK_kana_O) return \"kana_O\";\n\tif (k == XK_kana_KA) return \"kana_KA\";\n\tif (k == XK_kana_KI) return \"kana_KI\";\n\tif (k == XK_kana_KU) return \"kana_KU\";\n\tif (k == XK_kana_KE) return \"kana_KE\";\n\tif (k == XK_kana_KO) return \"kana_KO\";\n\tif (k == XK_kana_SA) return \"kana_SA\";\n\tif (k == XK_kana_SHI) return \"kana_SHI\";\n\tif (k == XK_kana_SU) return \"kana_SU\";\n\tif (k == XK_kana_SE) return \"kana_SE\";\n\tif (k == XK_kana_SO) return \"kana_SO\";\n\tif (k == XK_kana_TA) return \"kana_TA\";\n\tif (k == XK_kana_CHI) return \"kana_CHI\";\n\tif (k == XK_kana_TI) return \"kana_TI\";\n\tif (k == XK_kana_TSU) return \"kana_TSU\";\n\tif (k == XK_kana_TU) return \"kana_TU\";\n\tif (k == XK_kana_TE) return \"kana_TE\";\n\tif (k == XK_kana_TO) return \"kana_TO\";\n\tif (k == XK_kana_NA) return \"kana_NA\";\n\tif (k == XK_kana_NI) return \"kana_NI\";\n\tif (k == XK_kana_NU) return \"kana_NU\";\n\tif (k == XK_kana_NE) return \"kana_NE\";\n\tif (k == XK_kana_NO) return \"kana_NO\";\n\tif (k == XK_kana_HA) return \"kana_HA\";\n\tif (k == XK_kana_HI) return \"kana_HI\";\n\tif (k == XK_kana_FU) return \"kana_FU\";\n\tif (k == XK_kana_HU) return \"kana_HU\";\n\tif (k == XK_kana_HE) return \"kana_HE\";\n\tif (k == XK_kana_HO) return \"kana_HO\";\n\tif (k == XK_kana_MA) return \"kana_MA\";\n\tif (k == XK_kana_MI) return \"kana_MI\";\n\tif (k == XK_kana_MU) return \"kana_MU\";\n\tif (k == XK_kana_ME) return \"kana_ME\";\n\tif (k == XK_kana_MO) return \"kana_MO\";\n\tif (k == XK_kana_YA) return \"kana_YA\";\n\tif (k == XK_kana_YU) return \"kana_YU\";\n\tif (k == XK_kana_YO) return \"kana_YO\";\n\tif (k == XK_kana_RA) return \"kana_RA\";\n\tif (k == XK_kana_RI) return \"kana_RI\";\n\tif (k == XK_kana_RU) return \"kana_RU\";\n\tif (k == XK_kana_RE) return \"kana_RE\";\n\tif (k == XK_kana_RO) return \"kana_RO\";\n\tif (k == XK_kana_WA) return \"kana_WA\";\n\tif (k == XK_kana_N) return \"kana_N\";\n\tif (k == XK_voicedsound) return \"voicedsound\";\n\tif (k == XK_semivoicedsound) return \"semivoicedsound\";\n\tif (k == XK_kana_switch) return \"kana_switch\";\n#endif /* XK_KATAKANA */\n#ifdef XK_ARABIC\n\tif (k == XK_Arabic_comma) return \"Arabic_comma\";\n\tif (k == XK_Arabic_semicolon) return \"Arabic_semicolon\";\n\tif (k == XK_Arabic_question_mark) return \"Arabic_question_mark\";\n\tif (k == XK_Arabic_hamza) return \"Arabic_hamza\";\n\tif (k == XK_Arabic_maddaonalef) return \"Arabic_maddaonalef\";\n\tif (k == XK_Arabic_hamzaonalef) return \"Arabic_hamzaonalef\";\n\tif (k == XK_Arabic_hamzaonwaw) return \"Arabic_hamzaonwaw\";\n\tif (k == XK_Arabic_hamzaunderalef) return \"Arabic_hamzaunderalef\";\n\tif (k == XK_Arabic_hamzaonyeh) return \"Arabic_hamzaonyeh\";\n\tif (k == XK_Arabic_alef) return \"Arabic_alef\";\n\tif (k == XK_Arabic_beh) return \"Arabic_beh\";\n\tif (k == XK_Arabic_tehmarbuta) return \"Arabic_tehmarbuta\";\n\tif (k == XK_Arabic_teh) return \"Arabic_teh\";\n\tif (k == XK_Arabic_theh) return \"Arabic_theh\";\n\tif (k == XK_Arabic_jeem) return \"Arabic_jeem\";\n\tif (k == XK_Arabic_hah) return \"Arabic_hah\";\n\tif (k == XK_Arabic_khah) return \"Arabic_khah\";\n\tif (k == XK_Arabic_dal) return \"Arabic_dal\";\n\tif (k == XK_Arabic_thal) return \"Arabic_thal\";\n\tif (k == XK_Arabic_ra) return \"Arabic_ra\";\n\tif (k == XK_Arabic_zain) return \"Arabic_zain\";\n\tif (k == XK_Arabic_seen) return \"Arabic_seen\";\n\tif (k == XK_Arabic_sheen) return \"Arabic_sheen\";\n\tif (k == XK_Arabic_sad) return \"Arabic_sad\";\n\tif (k == XK_Arabic_dad) return \"Arabic_dad\";\n\tif (k == XK_Arabic_tah) return \"Arabic_tah\";\n\tif (k == XK_Arabic_zah) return \"Arabic_zah\";\n\tif (k == XK_Arabic_ain) return \"Arabic_ain\";\n\tif (k == XK_Arabic_ghain) return \"Arabic_ghain\";\n\tif (k == XK_Arabic_tatweel) return \"Arabic_tatweel\";\n\tif (k == XK_Arabic_feh) return \"Arabic_feh\";\n\tif (k == XK_Arabic_qaf) return \"Arabic_qaf\";\n\tif (k == XK_Arabic_kaf) return \"Arabic_kaf\";\n\tif (k == XK_Arabic_lam) return \"Arabic_lam\";\n\tif (k == XK_Arabic_meem) return \"Arabic_meem\";\n\tif (k == XK_Arabic_noon) return \"Arabic_noon\";\n\tif (k == XK_Arabic_ha) return \"Arabic_ha\";\n\tif (k == XK_Arabic_heh) return \"Arabic_heh\";\n\tif (k == XK_Arabic_waw) return \"Arabic_waw\";\n\tif (k == XK_Arabic_alefmaksura) return \"Arabic_alefmaksura\";\n\tif (k == XK_Arabic_yeh) return \"Arabic_yeh\";\n\tif (k == XK_Arabic_fathatan) return \"Arabic_fathatan\";\n\tif (k == XK_Arabic_dammatan) return \"Arabic_dammatan\";\n\tif (k == XK_Arabic_kasratan) return \"Arabic_kasratan\";\n\tif (k == XK_Arabic_fatha) return \"Arabic_fatha\";\n\tif (k == XK_Arabic_damma) return \"Arabic_damma\";\n\tif (k == XK_Arabic_kasra) return \"Arabic_kasra\";\n\tif (k == XK_Arabic_shadda) return \"Arabic_shadda\";\n\tif (k == XK_Arabic_sukun) return \"Arabic_sukun\";\n\tif (k == XK_Arabic_switch) return \"Arabic_switch\";\n#endif /* XK_ARABIC */\n#ifdef XK_CYRILLIC\n\tif (k == XK_Serbian_dje) return \"Serbian_dje\";\n\tif (k == XK_Macedonia_gje) return \"Macedonia_gje\";\n\tif (k == XK_Cyrillic_io) return \"Cyrillic_io\";\n\tif (k == XK_Ukrainian_ie) return \"Ukrainian_ie\";\n\tif (k == XK_Ukranian_je) return \"Ukranian_je\";\n\tif (k == XK_Macedonia_dse) return \"Macedonia_dse\";\n\tif (k == XK_Ukrainian_i) return \"Ukrainian_i\";\n\tif (k == XK_Ukranian_i) return \"Ukranian_i\";\n\tif (k == XK_Ukrainian_yi) return \"Ukrainian_yi\";\n\tif (k == XK_Ukranian_yi) return \"Ukranian_yi\";\n\tif (k == XK_Cyrillic_je) return \"Cyrillic_je\";\n\tif (k == XK_Serbian_je) return \"Serbian_je\";\n\tif (k == XK_Cyrillic_lje) return \"Cyrillic_lje\";\n\tif (k == XK_Serbian_lje) return \"Serbian_lje\";\n\tif (k == XK_Cyrillic_nje) return \"Cyrillic_nje\";\n\tif (k == XK_Serbian_nje) return \"Serbian_nje\";\n\tif (k == XK_Serbian_tshe) return \"Serbian_tshe\";\n\tif (k == XK_Macedonia_kje) return \"Macedonia_kje\";\n\tif (k == XK_Byelorussian_shortu) return \"Byelorussian_shortu\";\n\tif (k == XK_Cyrillic_dzhe) return \"Cyrillic_dzhe\";\n\tif (k == XK_Serbian_dze) return \"Serbian_dze\";\n\tif (k == XK_numerosign) return \"numerosign\";\n\tif (k == XK_Serbian_DJE) return \"Serbian_DJE\";\n\tif (k == XK_Macedonia_GJE) return \"Macedonia_GJE\";\n\tif (k == XK_Cyrillic_IO) return \"Cyrillic_IO\";\n\tif (k == XK_Ukrainian_IE) return \"Ukrainian_IE\";\n\tif (k == XK_Ukranian_JE) return \"Ukranian_JE\";\n\tif (k == XK_Macedonia_DSE) return \"Macedonia_DSE\";\n\tif (k == XK_Ukrainian_I) return \"Ukrainian_I\";\n\tif (k == XK_Ukranian_I) return \"Ukranian_I\";\n\tif (k == XK_Ukrainian_YI) return \"Ukrainian_YI\";\n\tif (k == XK_Ukranian_YI) return \"Ukranian_YI\";\n\tif (k == XK_Cyrillic_JE) return \"Cyrillic_JE\";\n\tif (k == XK_Serbian_JE) return \"Serbian_JE\";\n\tif (k == XK_Cyrillic_LJE) return \"Cyrillic_LJE\";\n\tif (k == XK_Serbian_LJE) return \"Serbian_LJE\";\n\tif (k == XK_Cyrillic_NJE) return \"Cyrillic_NJE\";\n\tif (k == XK_Serbian_NJE) return \"Serbian_NJE\";\n\tif (k == XK_Serbian_TSHE) return \"Serbian_TSHE\";\n\tif (k == XK_Macedonia_KJE) return \"Macedonia_KJE\";\n\tif (k == XK_Byelorussian_SHORTU) return \"Byelorussian_SHORTU\";\n\tif (k == XK_Cyrillic_DZHE) return \"Cyrillic_DZHE\";\n\tif (k == XK_Serbian_DZE) return \"Serbian_DZE\";\n\tif (k == XK_Cyrillic_yu) return \"Cyrillic_yu\";\n\tif (k == XK_Cyrillic_a) return \"Cyrillic_a\";\n\tif (k == XK_Cyrillic_be) return \"Cyrillic_be\";\n\tif (k == XK_Cyrillic_tse) return \"Cyrillic_tse\";\n\tif (k == XK_Cyrillic_de) return \"Cyrillic_de\";\n\tif (k == XK_Cyrillic_ie) return \"Cyrillic_ie\";\n\tif (k == XK_Cyrillic_ef) return \"Cyrillic_ef\";\n\tif (k == XK_Cyrillic_ghe) return \"Cyrillic_ghe\";\n\tif (k == XK_Cyrillic_ha) return \"Cyrillic_ha\";\n\tif (k == XK_Cyrillic_i) return \"Cyrillic_i\";\n\tif (k == XK_Cyrillic_shorti) return \"Cyrillic_shorti\";\n\tif (k == XK_Cyrillic_ka) return \"Cyrillic_ka\";\n\tif (k == XK_Cyrillic_el) return \"Cyrillic_el\";\n\tif (k == XK_Cyrillic_em) return \"Cyrillic_em\";\n\tif (k == XK_Cyrillic_en) return \"Cyrillic_en\";\n\tif (k == XK_Cyrillic_o) return \"Cyrillic_o\";\n\tif (k == XK_Cyrillic_pe) return \"Cyrillic_pe\";\n\tif (k == XK_Cyrillic_ya) return \"Cyrillic_ya\";\n\tif (k == XK_Cyrillic_er) return \"Cyrillic_er\";\n\tif (k == XK_Cyrillic_es) return \"Cyrillic_es\";\n\tif (k == XK_Cyrillic_te) return \"Cyrillic_te\";\n\tif (k == XK_Cyrillic_u) return \"Cyrillic_u\";\n\tif (k == XK_Cyrillic_zhe) return \"Cyrillic_zhe\";\n\tif (k == XK_Cyrillic_ve) return \"Cyrillic_ve\";\n\tif (k == XK_Cyrillic_softsign) return \"Cyrillic_softsign\";\n\tif (k == XK_Cyrillic_yeru) return \"Cyrillic_yeru\";\n\tif (k == XK_Cyrillic_ze) return \"Cyrillic_ze\";\n\tif (k == XK_Cyrillic_sha) return \"Cyrillic_sha\";\n\tif (k == XK_Cyrillic_e) return \"Cyrillic_e\";\n\tif (k == XK_Cyrillic_shcha) return \"Cyrillic_shcha\";\n\tif (k == XK_Cyrillic_che) return \"Cyrillic_che\";\n\tif (k == XK_Cyrillic_hardsign) return \"Cyrillic_hardsign\";\n\tif (k == XK_Cyrillic_YU) return \"Cyrillic_YU\";\n\tif (k == XK_Cyrillic_A) return \"Cyrillic_A\";\n\tif (k == XK_Cyrillic_BE) return \"Cyrillic_BE\";\n\tif (k == XK_Cyrillic_TSE) return \"Cyrillic_TSE\";\n\tif (k == XK_Cyrillic_DE) return \"Cyrillic_DE\";\n\tif (k == XK_Cyrillic_IE) return \"Cyrillic_IE\";\n\tif (k == XK_Cyrillic_EF) return \"Cyrillic_EF\";\n\tif (k == XK_Cyrillic_GHE) return \"Cyrillic_GHE\";\n\tif (k == XK_Cyrillic_HA) return \"Cyrillic_HA\";\n\tif (k == XK_Cyrillic_I) return \"Cyrillic_I\";\n\tif (k == XK_Cyrillic_SHORTI) return \"Cyrillic_SHORTI\";\n\tif (k == XK_Cyrillic_KA) return \"Cyrillic_KA\";\n\tif (k == XK_Cyrillic_EL) return \"Cyrillic_EL\";\n\tif (k == XK_Cyrillic_EM) return \"Cyrillic_EM\";\n\tif (k == XK_Cyrillic_EN) return \"Cyrillic_EN\";\n\tif (k == XK_Cyrillic_O) return \"Cyrillic_O\";\n\tif (k == XK_Cyrillic_PE) return \"Cyrillic_PE\";\n\tif (k == XK_Cyrillic_YA) return \"Cyrillic_YA\";\n\tif (k == XK_Cyrillic_ER) return \"Cyrillic_ER\";\n\tif (k == XK_Cyrillic_ES) return \"Cyrillic_ES\";\n\tif (k == XK_Cyrillic_TE) return \"Cyrillic_TE\";\n\tif (k == XK_Cyrillic_U) return \"Cyrillic_U\";\n\tif (k == XK_Cyrillic_ZHE) return \"Cyrillic_ZHE\";\n\tif (k == XK_Cyrillic_VE) return \"Cyrillic_VE\";\n\tif (k == XK_Cyrillic_SOFTSIGN) return \"Cyrillic_SOFTSIGN\";\n\tif (k == XK_Cyrillic_YERU) return \"Cyrillic_YERU\";\n\tif (k == XK_Cyrillic_ZE) return \"Cyrillic_ZE\";\n\tif (k == XK_Cyrillic_SHA) return \"Cyrillic_SHA\";\n\tif (k == XK_Cyrillic_E) return \"Cyrillic_E\";\n\tif (k == XK_Cyrillic_SHCHA) return \"Cyrillic_SHCHA\";\n\tif (k == XK_Cyrillic_CHE) return \"Cyrillic_CHE\";\n\tif (k == XK_Cyrillic_HARDSIGN) return \"Cyrillic_HARDSIGN\";\n#endif /* XK_CYRILLIC */\n#ifdef XK_GREEK\n\tif (k == XK_Greek_ALPHAaccent) return \"Greek_ALPHAaccent\";\n\tif (k == XK_Greek_EPSILONaccent) return \"Greek_EPSILONaccent\";\n\tif (k == XK_Greek_ETAaccent) return \"Greek_ETAaccent\";\n\tif (k == XK_Greek_IOTAaccent) return \"Greek_IOTAaccent\";\n\tif (k == XK_Greek_IOTAdieresis) return \"Greek_IOTAdieresis\";\n\tif (k == XK_Greek_OMICRONaccent) return \"Greek_OMICRONaccent\";\n\tif (k == XK_Greek_UPSILONaccent) return \"Greek_UPSILONaccent\";\n\tif (k == XK_Greek_UPSILONdieresis) return \"Greek_UPSILONdieresis\";\n\tif (k == XK_Greek_OMEGAaccent) return \"Greek_OMEGAaccent\";\n\tif (k == XK_Greek_accentdieresis) return \"Greek_accentdieresis\";\n\tif (k == XK_Greek_horizbar) return \"Greek_horizbar\";\n\tif (k == XK_Greek_alphaaccent) return \"Greek_alphaaccent\";\n\tif (k == XK_Greek_epsilonaccent) return \"Greek_epsilonaccent\";\n\tif (k == XK_Greek_etaaccent) return \"Greek_etaaccent\";\n\tif (k == XK_Greek_iotaaccent) return \"Greek_iotaaccent\";\n\tif (k == XK_Greek_iotadieresis) return \"Greek_iotadieresis\";\n\tif (k == XK_Greek_iotaaccentdieresis) return \"Greek_iotaaccentdieresis\";\n\tif (k == XK_Greek_omicronaccent) return \"Greek_omicronaccent\";\n\tif (k == XK_Greek_upsilonaccent) return \"Greek_upsilonaccent\";\n\tif (k == XK_Greek_upsilondieresis) return \"Greek_upsilondieresis\";\n\tif (k == XK_Greek_upsilonaccentdieresis) return \"Greek_upsilonaccentdieresis\";\n\tif (k == XK_Greek_omegaaccent) return \"Greek_omegaaccent\";\n\tif (k == XK_Greek_ALPHA) return \"Greek_ALPHA\";\n\tif (k == XK_Greek_BETA) return \"Greek_BETA\";\n\tif (k == XK_Greek_GAMMA) return \"Greek_GAMMA\";\n\tif (k == XK_Greek_DELTA) return \"Greek_DELTA\";\n\tif (k == XK_Greek_EPSILON) return \"Greek_EPSILON\";\n\tif (k == XK_Greek_ZETA) return \"Greek_ZETA\";\n\tif (k == XK_Greek_ETA) return \"Greek_ETA\";\n\tif (k == XK_Greek_THETA) return \"Greek_THETA\";\n\tif (k == XK_Greek_IOTA) return \"Greek_IOTA\";\n\tif (k == XK_Greek_KAPPA) return \"Greek_KAPPA\";\n\tif (k == XK_Greek_LAMDA) return \"Greek_LAMDA\";\n\tif (k == XK_Greek_LAMBDA) return \"Greek_LAMBDA\";\n\tif (k == XK_Greek_MU) return \"Greek_MU\";\n\tif (k == XK_Greek_NU) return \"Greek_NU\";\n\tif (k == XK_Greek_XI) return \"Greek_XI\";\n\tif (k == XK_Greek_OMICRON) return \"Greek_OMICRON\";\n\tif (k == XK_Greek_PI) return \"Greek_PI\";\n\tif (k == XK_Greek_RHO) return \"Greek_RHO\";\n\tif (k == XK_Greek_SIGMA) return \"Greek_SIGMA\";\n\tif (k == XK_Greek_TAU) return \"Greek_TAU\";\n\tif (k == XK_Greek_UPSILON) return \"Greek_UPSILON\";\n\tif (k == XK_Greek_PHI) return \"Greek_PHI\";\n\tif (k == XK_Greek_CHI) return \"Greek_CHI\";\n\tif (k == XK_Greek_PSI) return \"Greek_PSI\";\n\tif (k == XK_Greek_OMEGA) return \"Greek_OMEGA\";\n\tif (k == XK_Greek_alpha) return \"Greek_alpha\";\n\tif (k == XK_Greek_beta) return \"Greek_beta\";\n\tif (k == XK_Greek_gamma) return \"Greek_gamma\";\n\tif (k == XK_Greek_delta) return \"Greek_delta\";\n\tif (k == XK_Greek_epsilon) return \"Greek_epsilon\";\n\tif (k == XK_Greek_zeta) return \"Greek_zeta\";\n\tif (k == XK_Greek_eta) return \"Greek_eta\";\n\tif (k == XK_Greek_theta) return \"Greek_theta\";\n\tif (k == XK_Greek_iota) return \"Greek_iota\";\n\tif (k == XK_Greek_kappa) return \"Greek_kappa\";\n\tif (k == XK_Greek_lamda) return \"Greek_lamda\";\n\tif (k == XK_Greek_lambda) return \"Greek_lambda\";\n\tif (k == XK_Greek_mu) return \"Greek_mu\";\n\tif (k == XK_Greek_nu) return \"Greek_nu\";\n\tif (k == XK_Greek_xi) return \"Greek_xi\";\n\tif (k == XK_Greek_omicron) return \"Greek_omicron\";\n\tif (k == XK_Greek_pi) return \"Greek_pi\";\n\tif (k == XK_Greek_rho) return \"Greek_rho\";\n\tif (k == XK_Greek_sigma) return \"Greek_sigma\";\n\tif (k == XK_Greek_finalsmallsigma) return \"Greek_finalsmallsigma\";\n\tif (k == XK_Greek_tau) return \"Greek_tau\";\n\tif (k == XK_Greek_upsilon) return \"Greek_upsilon\";\n\tif (k == XK_Greek_phi) return \"Greek_phi\";\n\tif (k == XK_Greek_chi) return \"Greek_chi\";\n\tif (k == XK_Greek_psi) return \"Greek_psi\";\n\tif (k == XK_Greek_omega) return \"Greek_omega\";\n\tif (k == XK_Greek_switch) return \"Greek_switch\";\n#endif /* XK_GREEK */\n#ifdef XK_TECHNICAL\n\tif (k == XK_leftradical) return \"leftradical\";\n\tif (k == XK_topleftradical) return \"topleftradical\";\n\tif (k == XK_horizconnector) return \"horizconnector\";\n\tif (k == XK_topintegral) return \"topintegral\";\n\tif (k == XK_botintegral) return \"botintegral\";\n\tif (k == XK_vertconnector) return \"vertconnector\";\n\tif (k == XK_topleftsqbracket) return \"topleftsqbracket\";\n\tif (k == XK_botleftsqbracket) return \"botleftsqbracket\";\n\tif (k == XK_toprightsqbracket) return \"toprightsqbracket\";\n\tif (k == XK_botrightsqbracket) return \"botrightsqbracket\";\n\tif (k == XK_topleftparens) return \"topleftparens\";\n\tif (k == XK_botleftparens) return \"botleftparens\";\n\tif (k == XK_toprightparens) return \"toprightparens\";\n\tif (k == XK_botrightparens) return \"botrightparens\";\n\tif (k == XK_leftmiddlecurlybrace) return \"leftmiddlecurlybrace\";\n\tif (k == XK_rightmiddlecurlybrace) return \"rightmiddlecurlybrace\";\n\tif (k == XK_topleftsummation) return \"topleftsummation\";\n\tif (k == XK_botleftsummation) return \"botleftsummation\";\n\tif (k == XK_topvertsummationconnector) return \"topvertsummationconnector\";\n\tif (k == XK_botvertsummationconnector) return \"botvertsummationconnector\";\n\tif (k == XK_toprightsummation) return \"toprightsummation\";\n\tif (k == XK_botrightsummation) return \"botrightsummation\";\n\tif (k == XK_rightmiddlesummation) return \"rightmiddlesummation\";\n\tif (k == XK_lessthanequal) return \"lessthanequal\";\n\tif (k == XK_notequal) return \"notequal\";\n\tif (k == XK_greaterthanequal) return \"greaterthanequal\";\n\tif (k == XK_integral) return \"integral\";\n\tif (k == XK_therefore) return \"therefore\";\n\tif (k == XK_variation) return \"variation\";\n\tif (k == XK_infinity) return \"infinity\";\n\tif (k == XK_nabla) return \"nabla\";\n\tif (k == XK_approximate) return \"approximate\";\n\tif (k == XK_similarequal) return \"similarequal\";\n\tif (k == XK_ifonlyif) return \"ifonlyif\";\n\tif (k == XK_implies) return \"implies\";\n\tif (k == XK_identical) return \"identical\";\n\tif (k == XK_radical) return \"radical\";\n\tif (k == XK_includedin) return \"includedin\";\n\tif (k == XK_includes) return \"includes\";\n\tif (k == XK_intersection) return \"intersection\";\n\tif (k == XK_union) return \"union\";\n\tif (k == XK_logicaland) return \"logicaland\";\n\tif (k == XK_logicalor) return \"logicalor\";\n\tif (k == XK_partialderivative) return \"partialderivative\";\n\tif (k == XK_function) return \"function\";\n\tif (k == XK_leftarrow) return \"leftarrow\";\n\tif (k == XK_uparrow) return \"uparrow\";\n\tif (k == XK_rightarrow) return \"rightarrow\";\n\tif (k == XK_downarrow) return \"downarrow\";\n#endif /* XK_TECHNICAL */\n#ifdef XK_SPECIAL\n\tif (k == XK_blank) return \"blank\";\n\tif (k == XK_soliddiamond) return \"soliddiamond\";\n\tif (k == XK_checkerboard) return \"checkerboard\";\n\tif (k == XK_ht) return \"ht\";\n\tif (k == XK_ff) return \"ff\";\n\tif (k == XK_cr) return \"cr\";\n\tif (k == XK_lf) return \"lf\";\n\tif (k == XK_nl) return \"nl\";\n\tif (k == XK_vt) return \"vt\";\n\tif (k == XK_lowrightcorner) return \"lowrightcorner\";\n\tif (k == XK_uprightcorner) return \"uprightcorner\";\n\tif (k == XK_upleftcorner) return \"upleftcorner\";\n\tif (k == XK_lowleftcorner) return \"lowleftcorner\";\n\tif (k == XK_crossinglines) return \"crossinglines\";\n\tif (k == XK_horizlinescan1) return \"horizlinescan1\";\n\tif (k == XK_horizlinescan3) return \"horizlinescan3\";\n\tif (k == XK_horizlinescan5) return \"horizlinescan5\";\n\tif (k == XK_horizlinescan7) return \"horizlinescan7\";\n\tif (k == XK_horizlinescan9) return \"horizlinescan9\";\n\tif (k == XK_leftt) return \"leftt\";\n\tif (k == XK_rightt) return \"rightt\";\n\tif (k == XK_bott) return \"bott\";\n\tif (k == XK_topt) return \"topt\";\n\tif (k == XK_vertbar) return \"vertbar\";\n#endif /* XK_SPECIAL */\n#ifdef XK_PUBLISHING\n\tif (k == XK_emspace) return \"emspace\";\n\tif (k == XK_enspace) return \"enspace\";\n\tif (k == XK_em3space) return \"em3space\";\n\tif (k == XK_em4space) return \"em4space\";\n\tif (k == XK_digitspace) return \"digitspace\";\n\tif (k == XK_punctspace) return \"punctspace\";\n\tif (k == XK_thinspace) return \"thinspace\";\n\tif (k == XK_hairspace) return \"hairspace\";\n\tif (k == XK_emdash) return \"emdash\";\n\tif (k == XK_endash) return \"endash\";\n\tif (k == XK_signifblank) return \"signifblank\";\n\tif (k == XK_ellipsis) return \"ellipsis\";\n\tif (k == XK_doubbaselinedot) return \"doubbaselinedot\";\n\tif (k == XK_onethird) return \"onethird\";\n\tif (k == XK_twothirds) return \"twothirds\";\n\tif (k == XK_onefifth) return \"onefifth\";\n\tif (k == XK_twofifths) return \"twofifths\";\n\tif (k == XK_threefifths) return \"threefifths\";\n\tif (k == XK_fourfifths) return \"fourfifths\";\n\tif (k == XK_onesixth) return \"onesixth\";\n\tif (k == XK_fivesixths) return \"fivesixths\";\n\tif (k == XK_careof) return \"careof\";\n\tif (k == XK_figdash) return \"figdash\";\n\tif (k == XK_leftanglebracket) return \"leftanglebracket\";\n\tif (k == XK_decimalpoint) return \"decimalpoint\";\n\tif (k == XK_rightanglebracket) return \"rightanglebracket\";\n\tif (k == XK_marker) return \"marker\";\n\tif (k == XK_oneeighth) return \"oneeighth\";\n\tif (k == XK_threeeighths) return \"threeeighths\";\n\tif (k == XK_fiveeighths) return \"fiveeighths\";\n\tif (k == XK_seveneighths) return \"seveneighths\";\n\tif (k == XK_trademark) return \"trademark\";\n\tif (k == XK_signaturemark) return \"signaturemark\";\n\tif (k == XK_trademarkincircle) return \"trademarkincircle\";\n\tif (k == XK_leftopentriangle) return \"leftopentriangle\";\n\tif (k == XK_rightopentriangle) return \"rightopentriangle\";\n\tif (k == XK_emopencircle) return \"emopencircle\";\n\tif (k == XK_emopenrectangle) return \"emopenrectangle\";\n\tif (k == XK_leftsinglequotemark) return \"leftsinglequotemark\";\n\tif (k == XK_rightsinglequotemark) return \"rightsinglequotemark\";\n\tif (k == XK_leftdoublequotemark) return \"leftdoublequotemark\";\n\tif (k == XK_rightdoublequotemark) return \"rightdoublequotemark\";\n\tif (k == XK_prescription) return \"prescription\";\n\tif (k == XK_minutes) return \"minutes\";\n\tif (k == XK_seconds) return \"seconds\";\n\tif (k == XK_latincross) return \"latincross\";\n\tif (k == XK_hexagram) return \"hexagram\";\n\tif (k == XK_filledrectbullet) return \"filledrectbullet\";\n\tif (k == XK_filledlefttribullet) return \"filledlefttribullet\";\n\tif (k == XK_filledrighttribullet) return \"filledrighttribullet\";\n\tif (k == XK_emfilledcircle) return \"emfilledcircle\";\n\tif (k == XK_emfilledrect) return \"emfilledrect\";\n\tif (k == XK_enopencircbullet) return \"enopencircbullet\";\n\tif (k == XK_enopensquarebullet) return \"enopensquarebullet\";\n\tif (k == XK_openrectbullet) return \"openrectbullet\";\n\tif (k == XK_opentribulletup) return \"opentribulletup\";\n\tif (k == XK_opentribulletdown) return \"opentribulletdown\";\n\tif (k == XK_openstar) return \"openstar\";\n\tif (k == XK_enfilledcircbullet) return \"enfilledcircbullet\";\n\tif (k == XK_enfilledsqbullet) return \"enfilledsqbullet\";\n\tif (k == XK_filledtribulletup) return \"filledtribulletup\";\n\tif (k == XK_filledtribulletdown) return \"filledtribulletdown\";\n\tif (k == XK_leftpointer) return \"leftpointer\";\n\tif (k == XK_rightpointer) return \"rightpointer\";\n\tif (k == XK_club) return \"club\";\n\tif (k == XK_diamond) return \"diamond\";\n\tif (k == XK_heart) return \"heart\";\n\tif (k == XK_maltesecross) return \"maltesecross\";\n\tif (k == XK_dagger) return \"dagger\";\n\tif (k == XK_doubledagger) return \"doubledagger\";\n\tif (k == XK_checkmark) return \"checkmark\";\n\tif (k == XK_ballotcross) return \"ballotcross\";\n\tif (k == XK_musicalsharp) return \"musicalsharp\";\n\tif (k == XK_musicalflat) return \"musicalflat\";\n\tif (k == XK_malesymbol) return \"malesymbol\";\n\tif (k == XK_femalesymbol) return \"femalesymbol\";\n\tif (k == XK_telephone) return \"telephone\";\n\tif (k == XK_telephonerecorder) return \"telephonerecorder\";\n\tif (k == XK_phonographcopyright) return \"phonographcopyright\";\n\tif (k == XK_caret) return \"caret\";\n\tif (k == XK_singlelowquotemark) return \"singlelowquotemark\";\n\tif (k == XK_doublelowquotemark) return \"doublelowquotemark\";\n\tif (k == XK_cursor) return \"cursor\";\n#endif /* XK_PUBLISHING */\n#ifdef XK_APL\n\tif (k == XK_leftcaret) return \"leftcaret\";\n\tif (k == XK_rightcaret) return \"rightcaret\";\n\tif (k == XK_downcaret) return \"downcaret\";\n\tif (k == XK_upcaret) return \"upcaret\";\n\tif (k == XK_overbar) return \"overbar\";\n\tif (k == XK_downtack) return \"downtack\";\n\tif (k == XK_upshoe) return \"upshoe\";\n\tif (k == XK_downstile) return \"downstile\";\n\tif (k == XK_underbar) return \"underbar\";\n\tif (k == XK_jot) return \"jot\";\n\tif (k == XK_quad) return \"quad\";\n\tif (k == XK_uptack) return \"uptack\";\n\tif (k == XK_circle) return \"circle\";\n\tif (k == XK_upstile) return \"upstile\";\n\tif (k == XK_downshoe) return \"downshoe\";\n\tif (k == XK_rightshoe) return \"rightshoe\";\n\tif (k == XK_leftshoe) return \"leftshoe\";\n\tif (k == XK_lefttack) return \"lefttack\";\n\tif (k == XK_righttack) return \"righttack\";\n#endif /* XK_APL */\n#ifdef XK_HEBREW\n\tif (k == XK_hebrew_doublelowline) return \"hebrew_doublelowline\";\n\tif (k == XK_hebrew_aleph) return \"hebrew_aleph\";\n\tif (k == XK_hebrew_bet) return \"hebrew_bet\";\n\tif (k == XK_hebrew_beth) return \"hebrew_beth\";\n\tif (k == XK_hebrew_gimel) return \"hebrew_gimel\";\n\tif (k == XK_hebrew_gimmel) return \"hebrew_gimmel\";\n\tif (k == XK_hebrew_dalet) return \"hebrew_dalet\";\n\tif (k == XK_hebrew_daleth) return \"hebrew_daleth\";\n\tif (k == XK_hebrew_he) return \"hebrew_he\";\n\tif (k == XK_hebrew_waw) return \"hebrew_waw\";\n\tif (k == XK_hebrew_zain) return \"hebrew_zain\";\n\tif (k == XK_hebrew_zayin) return \"hebrew_zayin\";\n\tif (k == XK_hebrew_chet) return \"hebrew_chet\";\n\tif (k == XK_hebrew_het) return \"hebrew_het\";\n\tif (k == XK_hebrew_tet) return \"hebrew_tet\";\n\tif (k == XK_hebrew_teth) return \"hebrew_teth\";\n\tif (k == XK_hebrew_yod) return \"hebrew_yod\";\n\tif (k == XK_hebrew_finalkaph) return \"hebrew_finalkaph\";\n\tif (k == XK_hebrew_kaph) return \"hebrew_kaph\";\n\tif (k == XK_hebrew_lamed) return \"hebrew_lamed\";\n\tif (k == XK_hebrew_finalmem) return \"hebrew_finalmem\";\n\tif (k == XK_hebrew_mem) return \"hebrew_mem\";\n\tif (k == XK_hebrew_finalnun) return \"hebrew_finalnun\";\n\tif (k == XK_hebrew_nun) return \"hebrew_nun\";\n\tif (k == XK_hebrew_samech) return \"hebrew_samech\";\n\tif (k == XK_hebrew_samekh) return \"hebrew_samekh\";\n\tif (k == XK_hebrew_ayin) return \"hebrew_ayin\";\n\tif (k == XK_hebrew_finalpe) return \"hebrew_finalpe\";\n\tif (k == XK_hebrew_pe) return \"hebrew_pe\";\n\tif (k == XK_hebrew_finalzade) return \"hebrew_finalzade\";\n\tif (k == XK_hebrew_finalzadi) return \"hebrew_finalzadi\";\n\tif (k == XK_hebrew_zade) return \"hebrew_zade\";\n\tif (k == XK_hebrew_zadi) return \"hebrew_zadi\";\n\tif (k == XK_hebrew_qoph) return \"hebrew_qoph\";\n\tif (k == XK_hebrew_kuf) return \"hebrew_kuf\";\n\tif (k == XK_hebrew_resh) return \"hebrew_resh\";\n\tif (k == XK_hebrew_shin) return \"hebrew_shin\";\n\tif (k == XK_hebrew_taw) return \"hebrew_taw\";\n\tif (k == XK_hebrew_taf) return \"hebrew_taf\";\n\tif (k == XK_Hebrew_switch) return \"Hebrew_switch\";\n#endif /* XK_HEBREW */\n#ifdef XK_THAI\n\tif (k == XK_Thai_kokai) return \"Thai_kokai\";\n\tif (k == XK_Thai_khokhai) return \"Thai_khokhai\";\n\tif (k == XK_Thai_khokhuat) return \"Thai_khokhuat\";\n\tif (k == XK_Thai_khokhwai) return \"Thai_khokhwai\";\n\tif (k == XK_Thai_khokhon) return \"Thai_khokhon\";\n\tif (k == XK_Thai_khorakhang) return \"Thai_khorakhang\";\n\tif (k == XK_Thai_ngongu) return \"Thai_ngongu\";\n\tif (k == XK_Thai_chochan) return \"Thai_chochan\";\n\tif (k == XK_Thai_choching) return \"Thai_choching\";\n\tif (k == XK_Thai_chochang) return \"Thai_chochang\";\n\tif (k == XK_Thai_soso) return \"Thai_soso\";\n\tif (k == XK_Thai_chochoe) return \"Thai_chochoe\";\n\tif (k == XK_Thai_yoying) return \"Thai_yoying\";\n\tif (k == XK_Thai_dochada) return \"Thai_dochada\";\n\tif (k == XK_Thai_topatak) return \"Thai_topatak\";\n\tif (k == XK_Thai_thothan) return \"Thai_thothan\";\n\tif (k == XK_Thai_thonangmontho) return \"Thai_thonangmontho\";\n\tif (k == XK_Thai_thophuthao) return \"Thai_thophuthao\";\n\tif (k == XK_Thai_nonen) return \"Thai_nonen\";\n\tif (k == XK_Thai_dodek) return \"Thai_dodek\";\n\tif (k == XK_Thai_totao) return \"Thai_totao\";\n\tif (k == XK_Thai_thothung) return \"Thai_thothung\";\n\tif (k == XK_Thai_thothahan) return \"Thai_thothahan\";\n\tif (k == XK_Thai_thothong) return \"Thai_thothong\";\n\tif (k == XK_Thai_nonu) return \"Thai_nonu\";\n\tif (k == XK_Thai_bobaimai) return \"Thai_bobaimai\";\n\tif (k == XK_Thai_popla) return \"Thai_popla\";\n\tif (k == XK_Thai_phophung) return \"Thai_phophung\";\n\tif (k == XK_Thai_fofa) return \"Thai_fofa\";\n\tif (k == XK_Thai_phophan) return \"Thai_phophan\";\n\tif (k == XK_Thai_fofan) return \"Thai_fofan\";\n\tif (k == XK_Thai_phosamphao) return \"Thai_phosamphao\";\n\tif (k == XK_Thai_moma) return \"Thai_moma\";\n\tif (k == XK_Thai_yoyak) return \"Thai_yoyak\";\n\tif (k == XK_Thai_rorua) return \"Thai_rorua\";\n\tif (k == XK_Thai_ru) return \"Thai_ru\";\n\tif (k == XK_Thai_loling) return \"Thai_loling\";\n\tif (k == XK_Thai_lu) return \"Thai_lu\";\n\tif (k == XK_Thai_wowaen) return \"Thai_wowaen\";\n\tif (k == XK_Thai_sosala) return \"Thai_sosala\";\n\tif (k == XK_Thai_sorusi) return \"Thai_sorusi\";\n\tif (k == XK_Thai_sosua) return \"Thai_sosua\";\n\tif (k == XK_Thai_hohip) return \"Thai_hohip\";\n\tif (k == XK_Thai_lochula) return \"Thai_lochula\";\n\tif (k == XK_Thai_oang) return \"Thai_oang\";\n\tif (k == XK_Thai_honokhuk) return \"Thai_honokhuk\";\n\tif (k == XK_Thai_paiyannoi) return \"Thai_paiyannoi\";\n\tif (k == XK_Thai_saraa) return \"Thai_saraa\";\n\tif (k == XK_Thai_maihanakat) return \"Thai_maihanakat\";\n\tif (k == XK_Thai_saraaa) return \"Thai_saraaa\";\n\tif (k == XK_Thai_saraam) return \"Thai_saraam\";\n\tif (k == XK_Thai_sarai) return \"Thai_sarai\";\n\tif (k == XK_Thai_saraii) return \"Thai_saraii\";\n\tif (k == XK_Thai_saraue) return \"Thai_saraue\";\n\tif (k == XK_Thai_sarauee) return \"Thai_sarauee\";\n\tif (k == XK_Thai_sarau) return \"Thai_sarau\";\n\tif (k == XK_Thai_sarauu) return \"Thai_sarauu\";\n\tif (k == XK_Thai_phinthu) return \"Thai_phinthu\";\n\tif (k == XK_Thai_maihanakat_maitho) return \"Thai_maihanakat_maitho\";\n\tif (k == XK_Thai_baht) return \"Thai_baht\";\n\tif (k == XK_Thai_sarae) return \"Thai_sarae\";\n\tif (k == XK_Thai_saraae) return \"Thai_saraae\";\n\tif (k == XK_Thai_sarao) return \"Thai_sarao\";\n\tif (k == XK_Thai_saraaimaimuan) return \"Thai_saraaimaimuan\";\n\tif (k == XK_Thai_saraaimaimalai) return \"Thai_saraaimaimalai\";\n\tif (k == XK_Thai_lakkhangyao) return \"Thai_lakkhangyao\";\n\tif (k == XK_Thai_maiyamok) return \"Thai_maiyamok\";\n\tif (k == XK_Thai_maitaikhu) return \"Thai_maitaikhu\";\n\tif (k == XK_Thai_maiek) return \"Thai_maiek\";\n\tif (k == XK_Thai_maitho) return \"Thai_maitho\";\n\tif (k == XK_Thai_maitri) return \"Thai_maitri\";\n\tif (k == XK_Thai_maichattawa) return \"Thai_maichattawa\";\n\tif (k == XK_Thai_thanthakhat) return \"Thai_thanthakhat\";\n\tif (k == XK_Thai_nikhahit) return \"Thai_nikhahit\";\n\tif (k == XK_Thai_leksun) return \"Thai_leksun\";\n\tif (k == XK_Thai_leknung) return \"Thai_leknung\";\n\tif (k == XK_Thai_leksong) return \"Thai_leksong\";\n\tif (k == XK_Thai_leksam) return \"Thai_leksam\";\n\tif (k == XK_Thai_leksi) return \"Thai_leksi\";\n\tif (k == XK_Thai_lekha) return \"Thai_lekha\";\n\tif (k == XK_Thai_lekhok) return \"Thai_lekhok\";\n\tif (k == XK_Thai_lekchet) return \"Thai_lekchet\";\n\tif (k == XK_Thai_lekpaet) return \"Thai_lekpaet\";\n\tif (k == XK_Thai_lekkao) return \"Thai_lekkao\";\n#endif /* XK_THAI */\n#ifdef XK_KOREAN\n\tif (k == XK_Hangul) return \"Hangul\";\n\tif (k == XK_Hangul_Start) return \"Hangul_Start\";\n\tif (k == XK_Hangul_End) return \"Hangul_End\";\n\tif (k == XK_Hangul_Hanja) return \"Hangul_Hanja\";\n\tif (k == XK_Hangul_Jamo) return \"Hangul_Jamo\";\n\tif (k == XK_Hangul_Romaja) return \"Hangul_Romaja\";\n\tif (k == XK_Hangul_Codeinput) return \"Hangul_Codeinput\";\n\tif (k == XK_Hangul_Jeonja) return \"Hangul_Jeonja\";\n\tif (k == XK_Hangul_Banja) return \"Hangul_Banja\";\n\tif (k == XK_Hangul_PreHanja) return \"Hangul_PreHanja\";\n\tif (k == XK_Hangul_PostHanja) return \"Hangul_PostHanja\";\n\tif (k == XK_Hangul_SingleCandidate) return \"Hangul_SingleCandidate\";\n\tif (k == XK_Hangul_MultipleCandidate) return \"Hangul_MultipleCandidate\";\n\tif (k == XK_Hangul_PreviousCandidate) return \"Hangul_PreviousCandidate\";\n\tif (k == XK_Hangul_Special) return \"Hangul_Special\";\n\tif (k == XK_Hangul_switch) return \"Hangul_switch\";\n\tif (k == XK_Hangul_Kiyeog) return \"Hangul_Kiyeog\";\n\tif (k == XK_Hangul_SsangKiyeog) return \"Hangul_SsangKiyeog\";\n\tif (k == XK_Hangul_KiyeogSios) return \"Hangul_KiyeogSios\";\n\tif (k == XK_Hangul_Nieun) return \"Hangul_Nieun\";\n\tif (k == XK_Hangul_NieunJieuj) return \"Hangul_NieunJieuj\";\n\tif (k == XK_Hangul_NieunHieuh) return \"Hangul_NieunHieuh\";\n\tif (k == XK_Hangul_Dikeud) return \"Hangul_Dikeud\";\n\tif (k == XK_Hangul_SsangDikeud) return \"Hangul_SsangDikeud\";\n\tif (k == XK_Hangul_Rieul) return \"Hangul_Rieul\";\n\tif (k == XK_Hangul_RieulKiyeog) return \"Hangul_RieulKiyeog\";\n\tif (k == XK_Hangul_RieulMieum) return \"Hangul_RieulMieum\";\n\tif (k == XK_Hangul_RieulPieub) return \"Hangul_RieulPieub\";\n\tif (k == XK_Hangul_RieulSios) return \"Hangul_RieulSios\";\n\tif (k == XK_Hangul_RieulTieut) return \"Hangul_RieulTieut\";\n\tif (k == XK_Hangul_RieulPhieuf) return \"Hangul_RieulPhieuf\";\n\tif (k == XK_Hangul_RieulHieuh) return \"Hangul_RieulHieuh\";\n\tif (k == XK_Hangul_Mieum) return \"Hangul_Mieum\";\n\tif (k == XK_Hangul_Pieub) return \"Hangul_Pieub\";\n\tif (k == XK_Hangul_SsangPieub) return \"Hangul_SsangPieub\";\n\tif (k == XK_Hangul_PieubSios) return \"Hangul_PieubSios\";\n\tif (k == XK_Hangul_Sios) return \"Hangul_Sios\";\n\tif (k == XK_Hangul_SsangSios) return \"Hangul_SsangSios\";\n\tif (k == XK_Hangul_Ieung) return \"Hangul_Ieung\";\n\tif (k == XK_Hangul_Jieuj) return \"Hangul_Jieuj\";\n\tif (k == XK_Hangul_SsangJieuj) return \"Hangul_SsangJieuj\";\n\tif (k == XK_Hangul_Cieuc) return \"Hangul_Cieuc\";\n\tif (k == XK_Hangul_Khieuq) return \"Hangul_Khieuq\";\n\tif (k == XK_Hangul_Tieut) return \"Hangul_Tieut\";\n\tif (k == XK_Hangul_Phieuf) return \"Hangul_Phieuf\";\n\tif (k == XK_Hangul_Hieuh) return \"Hangul_Hieuh\";\n\tif (k == XK_Hangul_A) return \"Hangul_A\";\n\tif (k == XK_Hangul_AE) return \"Hangul_AE\";\n\tif (k == XK_Hangul_YA) return \"Hangul_YA\";\n\tif (k == XK_Hangul_YAE) return \"Hangul_YAE\";\n\tif (k == XK_Hangul_EO) return \"Hangul_EO\";\n\tif (k == XK_Hangul_E) return \"Hangul_E\";\n\tif (k == XK_Hangul_YEO) return \"Hangul_YEO\";\n\tif (k == XK_Hangul_YE) return \"Hangul_YE\";\n\tif (k == XK_Hangul_O) return \"Hangul_O\";\n\tif (k == XK_Hangul_WA) return \"Hangul_WA\";\n\tif (k == XK_Hangul_WAE) return \"Hangul_WAE\";\n\tif (k == XK_Hangul_OE) return \"Hangul_OE\";\n\tif (k == XK_Hangul_YO) return \"Hangul_YO\";\n\tif (k == XK_Hangul_U) return \"Hangul_U\";\n\tif (k == XK_Hangul_WEO) return \"Hangul_WEO\";\n\tif (k == XK_Hangul_WE) return \"Hangul_WE\";\n\tif (k == XK_Hangul_WI) return \"Hangul_WI\";\n\tif (k == XK_Hangul_YU) return \"Hangul_YU\";\n\tif (k == XK_Hangul_EU) return \"Hangul_EU\";\n\tif (k == XK_Hangul_YI) return \"Hangul_YI\";\n\tif (k == XK_Hangul_I) return \"Hangul_I\";\n\tif (k == XK_Hangul_J_Kiyeog) return \"Hangul_J_Kiyeog\";\n\tif (k == XK_Hangul_J_SsangKiyeog) return \"Hangul_J_SsangKiyeog\";\n\tif (k == XK_Hangul_J_KiyeogSios) return \"Hangul_J_KiyeogSios\";\n\tif (k == XK_Hangul_J_Nieun) return \"Hangul_J_Nieun\";\n\tif (k == XK_Hangul_J_NieunJieuj) return \"Hangul_J_NieunJieuj\";\n\tif (k == XK_Hangul_J_NieunHieuh) return \"Hangul_J_NieunHieuh\";\n\tif (k == XK_Hangul_J_Dikeud) return \"Hangul_J_Dikeud\";\n\tif (k == XK_Hangul_J_Rieul) return \"Hangul_J_Rieul\";\n\tif (k == XK_Hangul_J_RieulKiyeog) return \"Hangul_J_RieulKiyeog\";\n\tif (k == XK_Hangul_J_RieulMieum) return \"Hangul_J_RieulMieum\";\n\tif (k == XK_Hangul_J_RieulPieub) return \"Hangul_J_RieulPieub\";\n\tif (k == XK_Hangul_J_RieulSios) return \"Hangul_J_RieulSios\";\n\tif (k == XK_Hangul_J_RieulTieut) return \"Hangul_J_RieulTieut\";\n\tif (k == XK_Hangul_J_RieulPhieuf) return \"Hangul_J_RieulPhieuf\";\n\tif (k == XK_Hangul_J_RieulHieuh) return \"Hangul_J_RieulHieuh\";\n\tif (k == XK_Hangul_J_Mieum) return \"Hangul_J_Mieum\";\n\tif (k == XK_Hangul_J_Pieub) return \"Hangul_J_Pieub\";\n\tif (k == XK_Hangul_J_PieubSios) return \"Hangul_J_PieubSios\";\n\tif (k == XK_Hangul_J_Sios) return \"Hangul_J_Sios\";\n\tif (k == XK_Hangul_J_SsangSios) return \"Hangul_J_SsangSios\";\n\tif (k == XK_Hangul_J_Ieung) return \"Hangul_J_Ieung\";\n\tif (k == XK_Hangul_J_Jieuj) return \"Hangul_J_Jieuj\";\n\tif (k == XK_Hangul_J_Cieuc) return \"Hangul_J_Cieuc\";\n\tif (k == XK_Hangul_J_Khieuq) return \"Hangul_J_Khieuq\";\n\tif (k == XK_Hangul_J_Tieut) return \"Hangul_J_Tieut\";\n\tif (k == XK_Hangul_J_Phieuf) return \"Hangul_J_Phieuf\";\n\tif (k == XK_Hangul_J_Hieuh) return \"Hangul_J_Hieuh\";\n\tif (k == XK_Hangul_RieulYeorinHieuh) return \"Hangul_RieulYeorinHieuh\";\n\tif (k == XK_Hangul_SunkyeongeumMieum) return \"Hangul_SunkyeongeumMieum\";\n\tif (k == XK_Hangul_SunkyeongeumPieub) return \"Hangul_SunkyeongeumPieub\";\n\tif (k == XK_Hangul_PanSios) return \"Hangul_PanSios\";\n\tif (k == XK_Hangul_KkogjiDalrinIeung) return \"Hangul_KkogjiDalrinIeung\";\n\tif (k == XK_Hangul_SunkyeongeumPhieuf) return \"Hangul_SunkyeongeumPhieuf\";\n\tif (k == XK_Hangul_YeorinHieuh) return \"Hangul_YeorinHieuh\";\n\tif (k == XK_Hangul_AraeA) return \"Hangul_AraeA\";\n\tif (k == XK_Hangul_AraeAE) return \"Hangul_AraeAE\";\n\tif (k == XK_Hangul_J_PanSios) return \"Hangul_J_PanSios\";\n\tif (k == XK_Hangul_J_KkogjiDalrinIeung) return \"Hangul_J_KkogjiDalrinIeung\";\n\tif (k == XK_Hangul_J_YeorinHieuh) return \"Hangul_J_YeorinHieuh\";\n\tif (k == XK_Korean_Won) return \"Korean_Won\";\n#endif /* XK_KOREAN */\n\tif (k == XK_EuroSign) return \"EuroSign\";\n#endif\n\treturn NULL;\t\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "char *XKeysymToString(KeySym k) {\n#ifndef XK_0_nosuch\n\tif (k == XK_VoidSymbol) return \"VoidSymbol\";\n#ifdef XK_MISCELLANY\n\tif (k == XK_BackSpace) return \"BackSpace\";\n\tif (k == XK_Tab) return \"Tab\";\n\tif (k == XK_Linefeed) return \"Linefeed\";\n\tif (k == XK_Clear) return \"Clear\";\n\tif (k == XK_Return) return \"Return\";\n\tif (k == XK_Pause) return \"Pause\";\n\tif (k == XK_Scroll_Lock) return \"Scroll_Lock\";\n\tif (k == XK_Sys_Req) return \"Sys_Req\";\n\tif (k == XK_Escape) return \"Escape\";\n\tif (k == XK_Delete) return \"Delete\";\n\tif (k == XK_Multi_key) return \"Multi_key\";\n\tif (k == XK_SingleCandidate) return \"SingleCandidate\";\n\tif (k == XK_MultipleCandidate) return \"MultipleCandidate\";\n\tif (k == XK_PreviousCandidate) return \"PreviousCandidate\";\n\tif (k == XK_Kanji) return \"Kanji\";\n\tif (k == XK_Muhenkan) return \"Muhenkan\";\n\tif (k == XK_Henkan_Mode) return \"Henkan_Mode\";\n\tif (k == XK_Henkan) return \"Henkan\";\n\tif (k == XK_Romaji) return \"Romaji\";\n\tif (k == XK_Hiragana) return \"Hiragana\";\n\tif (k == XK_Katakana) return \"Katakana\";\n\tif (k == XK_Hiragana_Katakana) return \"Hiragana_Katakana\";\n\tif (k == XK_Zenkaku) return \"Zenkaku\";\n\tif (k == XK_Hankaku) return \"Hankaku\";\n\tif (k == XK_Zenkaku_Hankaku) return \"Zenkaku_Hankaku\";\n\tif (k == XK_Touroku) return \"Touroku\";\n\tif (k == XK_Massyo) return \"Massyo\";\n\tif (k == XK_Kana_Lock) return \"Kana_Lock\";\n\tif (k == XK_Kana_Shift) return \"Kana_Shift\";\n\tif (k == XK_Eisu_Shift) return \"Eisu_Shift\";\n\tif (k == XK_Eisu_toggle) return \"Eisu_toggle\";\n\tif (k == XK_Zen_Koho) return \"Zen_Koho\";\n\tif (k == XK_Mae_Koho) return \"Mae_Koho\";\n\tif (k == XK_Home) return \"Home\";\n\tif (k == XK_Left) return \"Left\";\n\tif (k == XK_Up) return \"Up\";\n\tif (k == XK_Right) return \"Right\";\n\tif (k == XK_Down) return \"Down\";\n\tif (k == XK_Prior) return \"Prior\";\n\tif (k == XK_Page_Up) return \"Page_Up\";\n\tif (k == XK_Next) return \"Next\";\n\tif (k == XK_Page_Down) return \"Page_Down\";\n\tif (k == XK_End) return \"End\";\n\tif (k == XK_Begin) return \"Begin\";\n\tif (k == XK_Select) return \"Select\";\n\tif (k == XK_Print) return \"Print\";\n\tif (k == XK_Execute) return \"Execute\";\n\tif (k == XK_Insert) return \"Insert\";\n\tif (k == XK_Undo) return \"Undo\";\n\tif (k == XK_Redo) return \"Redo\";\n\tif (k == XK_Menu) return \"Menu\";\n\tif (k == XK_Find) return \"Find\";\n\tif (k == XK_Cancel) return \"Cancel\";\n\tif (k == XK_Help) return \"Help\";\n\tif (k == XK_Break) return \"Break\";\n\tif (k == XK_Mode_switch) return \"Mode_switch\";\n\tif (k == XK_script_switch) return \"script_switch\";\n\tif (k == XK_Num_Lock) return \"Num_Lock\";\n\tif (k == XK_KP_Space) return \"KP_Space\";\n\tif (k == XK_KP_Tab) return \"KP_Tab\";\n\tif (k == XK_KP_Enter) return \"KP_Enter\";\n\tif (k == XK_KP_F1) return \"KP_F1\";\n\tif (k == XK_KP_F2) return \"KP_F2\";\n\tif (k == XK_KP_F3) return \"KP_F3\";\n\tif (k == XK_KP_F4) return \"KP_F4\";\n\tif (k == XK_KP_Home) return \"KP_Home\";\n\tif (k == XK_KP_Left) return \"KP_Left\";\n\tif (k == XK_KP_Up) return \"KP_Up\";\n\tif (k == XK_KP_Right) return \"KP_Right\";\n\tif (k == XK_KP_Down) return \"KP_Down\";\n\tif (k == XK_KP_Prior) return \"KP_Prior\";\n\tif (k == XK_KP_Page_Up) return \"KP_Page_Up\";\n\tif (k == XK_KP_Next) return \"KP_Next\";\n\tif (k == XK_KP_Page_Down) return \"KP_Page_Down\";\n\tif (k == XK_KP_End) return \"KP_End\";\n\tif (k == XK_KP_Begin) return \"KP_Begin\";\n\tif (k == XK_KP_Insert) return \"KP_Insert\";\n\tif (k == XK_KP_Delete) return \"KP_Delete\";\n\tif (k == XK_KP_Equal) return \"KP_Equal\";\n\tif (k == XK_KP_Multiply) return \"KP_Multiply\";\n\tif (k == XK_KP_Add) return \"KP_Add\";\n\tif (k == XK_KP_Separator) return \"KP_Separator\";\n\tif (k == XK_KP_Subtract) return \"KP_Subtract\";\n\tif (k == XK_KP_Decimal) return \"KP_Decimal\";\n\tif (k == XK_KP_Divide) return \"KP_Divide\";\n\tif (k == XK_KP_0) return \"KP_0\";\n\tif (k == XK_KP_1) return \"KP_1\";\n\tif (k == XK_KP_2) return \"KP_2\";\n\tif (k == XK_KP_3) return \"KP_3\";\n\tif (k == XK_KP_4) return \"KP_4\";\n\tif (k == XK_KP_5) return \"KP_5\";\n\tif (k == XK_KP_6) return \"KP_6\";\n\tif (k == XK_KP_7) return \"KP_7\";\n\tif (k == XK_KP_8) return \"KP_8\";\n\tif (k == XK_KP_9) return \"KP_9\";\n\tif (k == XK_F1) return \"F1\";\n\tif (k == XK_F2) return \"F2\";\n\tif (k == XK_F3) return \"F3\";\n\tif (k == XK_F4) return \"F4\";\n\tif (k == XK_F5) return \"F5\";\n\tif (k == XK_F6) return \"F6\";\n\tif (k == XK_F7) return \"F7\";\n\tif (k == XK_F8) return \"F8\";\n\tif (k == XK_F9) return \"F9\";\n\tif (k == XK_F10) return \"F10\";\n\tif (k == XK_F11) return \"F11\";\n\tif (k == XK_L1) return \"L1\";\n\tif (k == XK_F12) return \"F12\";\n\tif (k == XK_L2) return \"L2\";\n\tif (k == XK_F13) return \"F13\";\n\tif (k == XK_L3) return \"L3\";\n\tif (k == XK_F14) return \"F14\";\n\tif (k == XK_L4) return \"L4\";\n\tif (k == XK_F15) return \"F15\";\n\tif (k == XK_L5) return \"L5\";\n\tif (k == XK_F16) return \"F16\";\n\tif (k == XK_L6) return \"L6\";\n\tif (k == XK_F17) return \"F17\";\n\tif (k == XK_L7) return \"L7\";\n\tif (k == XK_F18) return \"F18\";\n\tif (k == XK_L8) return \"L8\";\n\tif (k == XK_F19) return \"F19\";\n\tif (k == XK_L9) return \"L9\";\n\tif (k == XK_F20) return \"F20\";\n\tif (k == XK_L10) return \"L10\";\n\tif (k == XK_F21) return \"F21\";\n\tif (k == XK_R1) return \"R1\";\n\tif (k == XK_F22) return \"F22\";\n\tif (k == XK_R2) return \"R2\";\n\tif (k == XK_F23) return \"F23\";\n\tif (k == XK_R3) return \"R3\";\n\tif (k == XK_F24) return \"F24\";\n\tif (k == XK_R4) return \"R4\";\n\tif (k == XK_F25) return \"F25\";\n\tif (k == XK_R5) return \"R5\";\n\tif (k == XK_F26) return \"F26\";\n\tif (k == XK_R6) return \"R6\";\n\tif (k == XK_F27) return \"F27\";\n\tif (k == XK_R7) return \"R7\";\n\tif (k == XK_F28) return \"F28\";\n\tif (k == XK_R8) return \"R8\";\n\tif (k == XK_F29) return \"F29\";\n\tif (k == XK_R9) return \"R9\";\n\tif (k == XK_F30) return \"F30\";\n\tif (k == XK_R10) return \"R10\";\n\tif (k == XK_F31) return \"F31\";\n\tif (k == XK_R11) return \"R11\";\n\tif (k == XK_F32) return \"F32\";\n\tif (k == XK_R12) return \"R12\";\n\tif (k == XK_F33) return \"F33\";\n\tif (k == XK_R13) return \"R13\";\n\tif (k == XK_F34) return \"F34\";\n\tif (k == XK_R14) return \"R14\";\n\tif (k == XK_F35) return \"F35\";\n\tif (k == XK_R15) return \"R15\";\n\tif (k == XK_Shift_L) return \"Shift_L\";\n\tif (k == XK_Shift_R) return \"Shift_R\";\n\tif (k == XK_Control_L) return \"Control_L\";\n\tif (k == XK_Control_R) return \"Control_R\";\n\tif (k == XK_Caps_Lock) return \"Caps_Lock\";\n\tif (k == XK_Shift_Lock) return \"Shift_Lock\";\n\tif (k == XK_Meta_L) return \"Meta_L\";\n\tif (k == XK_Meta_R) return \"Meta_R\";\n\tif (k == XK_Alt_L) return \"Alt_L\";\n\tif (k == XK_Alt_R) return \"Alt_R\";\n\tif (k == XK_Super_L) return \"Super_L\";\n\tif (k == XK_Super_R) return \"Super_R\";\n\tif (k == XK_Hyper_L) return \"Hyper_L\";\n\tif (k == XK_Hyper_R) return \"Hyper_R\";\n#endif /* XK_MISCELLANY */\n#ifdef XK_XKB_KEYS\n\tif (k == XK_ISO_Lock) return \"ISO_Lock\";\n\tif (k == XK_ISO_Level2_Latch) return \"ISO_Level2_Latch\";\n\tif (k == XK_ISO_Level3_Shift) return \"ISO_Level3_Shift\";\n\tif (k == XK_ISO_Level3_Latch) return \"ISO_Level3_Latch\";\n\tif (k == XK_ISO_Level3_Lock) return \"ISO_Level3_Lock\";\n\tif (k == XK_ISO_Group_Shift) return \"ISO_Group_Shift\";\n\tif (k == XK_ISO_Group_Latch) return \"ISO_Group_Latch\";\n\tif (k == XK_ISO_Group_Lock) return \"ISO_Group_Lock\";\n\tif (k == XK_ISO_Next_Group) return \"ISO_Next_Group\";\n\tif (k == XK_ISO_Next_Group_Lock) return \"ISO_Next_Group_Lock\";\n\tif (k == XK_ISO_Prev_Group) return \"ISO_Prev_Group\";\n\tif (k == XK_ISO_Prev_Group_Lock) return \"ISO_Prev_Group_Lock\";\n\tif (k == XK_ISO_First_Group) return \"ISO_First_Group\";\n\tif (k == XK_ISO_First_Group_Lock) return \"ISO_First_Group_Lock\";\n\tif (k == XK_ISO_Last_Group) return \"ISO_Last_Group\";\n\tif (k == XK_ISO_Last_Group_Lock) return \"ISO_Last_Group_Lock\";\n\tif (k == XK_ISO_Left_Tab) return \"ISO_Left_Tab\";\n\tif (k == XK_ISO_Move_Line_Up) return \"ISO_Move_Line_Up\";\n\tif (k == XK_ISO_Move_Line_Down) return \"ISO_Move_Line_Down\";\n\tif (k == XK_ISO_Partial_Line_Up) return \"ISO_Partial_Line_Up\";\n\tif (k == XK_ISO_Partial_Line_Down) return \"ISO_Partial_Line_Down\";\n\tif (k == XK_ISO_Partial_Space_Left) return \"ISO_Partial_Space_Left\";\n\tif (k == XK_ISO_Partial_Space_Right) return \"ISO_Partial_Space_Right\";\n\tif (k == XK_ISO_Set_Margin_Left) return \"ISO_Set_Margin_Left\";\n\tif (k == XK_ISO_Set_Margin_Right) return \"ISO_Set_Margin_Right\";\n\tif (k == XK_ISO_Release_Margin_Left) return \"ISO_Release_Margin_Left\";\n\tif (k == XK_ISO_Release_Margin_Right) return \"ISO_Release_Margin_Right\";\n\tif (k == XK_ISO_Release_Both_Margins) return \"ISO_Release_Both_Margins\";\n\tif (k == XK_ISO_Fast_Cursor_Left) return \"ISO_Fast_Cursor_Left\";\n\tif (k == XK_ISO_Fast_Cursor_Right) return \"ISO_Fast_Cursor_Right\";\n\tif (k == XK_ISO_Fast_Cursor_Up) return \"ISO_Fast_Cursor_Up\";\n\tif (k == XK_ISO_Fast_Cursor_Down) return \"ISO_Fast_Cursor_Down\";\n\tif (k == XK_ISO_Continuous_Underline) return \"ISO_Continuous_Underline\";\n\tif (k == XK_ISO_Discontinuous_Underline) return \"ISO_Discontinuous_Underline\";\n\tif (k == XK_ISO_Emphasize) return \"ISO_Emphasize\";\n\tif (k == XK_ISO_Center_Object) return \"ISO_Center_Object\";\n\tif (k == XK_ISO_Enter) return \"ISO_Enter\";\n\tif (k == XK_dead_grave) return \"dead_grave\";\n\tif (k == XK_dead_acute) return \"dead_acute\";\n\tif (k == XK_dead_circumflex) return \"dead_circumflex\";\n\tif (k == XK_dead_tilde) return \"dead_tilde\";\n\tif (k == XK_dead_macron) return \"dead_macron\";\n\tif (k == XK_dead_breve) return \"dead_breve\";\n\tif (k == XK_dead_abovedot) return \"dead_abovedot\";\n\tif (k == XK_dead_diaeresis) return \"dead_diaeresis\";\n\tif (k == XK_dead_abovering) return \"dead_abovering\";\n\tif (k == XK_dead_doubleacute) return \"dead_doubleacute\";\n\tif (k == XK_dead_caron) return \"dead_caron\";\n\tif (k == XK_dead_cedilla) return \"dead_cedilla\";\n\tif (k == XK_dead_ogonek) return \"dead_ogonek\";\n\tif (k == XK_dead_iota) return \"dead_iota\";\n\tif (k == XK_dead_voiced_sound) return \"dead_voiced_sound\";\n\tif (k == XK_dead_semivoiced_sound) return \"dead_semivoiced_sound\";\n\tif (k == XK_dead_belowdot) return \"dead_belowdot\";\n\tif (k == XK_First_Virtual_Screen) return \"First_Virtual_Screen\";\n\tif (k == XK_Prev_Virtual_Screen) return \"Prev_Virtual_Screen\";\n\tif (k == XK_Next_Virtual_Screen) return \"Next_Virtual_Screen\";\n\tif (k == XK_Last_Virtual_Screen) return \"Last_Virtual_Screen\";\n\tif (k == XK_Terminate_Server) return \"Terminate_Server\";\n\tif (k == XK_AccessX_Enable) return \"AccessX_Enable\";\n\tif (k == XK_AccessX_Feedback_Enable) return \"AccessX_Feedback_Enable\";\n\tif (k == XK_RepeatKeys_Enable) return \"RepeatKeys_Enable\";\n\tif (k == XK_SlowKeys_Enable) return \"SlowKeys_Enable\";\n\tif (k == XK_BounceKeys_Enable) return \"BounceKeys_Enable\";\n\tif (k == XK_StickyKeys_Enable) return \"StickyKeys_Enable\";\n\tif (k == XK_MouseKeys_Enable) return \"MouseKeys_Enable\";\n\tif (k == XK_MouseKeys_Accel_Enable) return \"MouseKeys_Accel_Enable\";\n\tif (k == XK_Overlay1_Enable) return \"Overlay1_Enable\";\n\tif (k == XK_Overlay2_Enable) return \"Overlay2_Enable\";\n\tif (k == XK_AudibleBell_Enable) return \"AudibleBell_Enable\";\n\tif (k == XK_Pointer_Left) return \"Pointer_Left\";\n\tif (k == XK_Pointer_Right) return \"Pointer_Right\";\n\tif (k == XK_Pointer_Up) return \"Pointer_Up\";\n\tif (k == XK_Pointer_Down) return \"Pointer_Down\";\n\tif (k == XK_Pointer_UpLeft) return \"Pointer_UpLeft\";\n\tif (k == XK_Pointer_UpRight) return \"Pointer_UpRight\";\n\tif (k == XK_Pointer_DownLeft) return \"Pointer_DownLeft\";\n\tif (k == XK_Pointer_DownRight) return \"Pointer_DownRight\";\n\tif (k == XK_Pointer_Button_Dflt) return \"Pointer_Button_Dflt\";\n\tif (k == XK_Pointer_Button1) return \"Pointer_Button1\";\n\tif (k == XK_Pointer_Button2) return \"Pointer_Button2\";\n\tif (k == XK_Pointer_Button3) return \"Pointer_Button3\";\n\tif (k == XK_Pointer_Button4) return \"Pointer_Button4\";\n\tif (k == XK_Pointer_Button5) return \"Pointer_Button5\";\n\tif (k == XK_Pointer_DblClick_Dflt) return \"Pointer_DblClick_Dflt\";\n\tif (k == XK_Pointer_DblClick1) return \"Pointer_DblClick1\";\n\tif (k == XK_Pointer_DblClick2) return \"Pointer_DblClick2\";\n\tif (k == XK_Pointer_DblClick3) return \"Pointer_DblClick3\";\n\tif (k == XK_Pointer_DblClick4) return \"Pointer_DblClick4\";\n\tif (k == XK_Pointer_DblClick5) return \"Pointer_DblClick5\";\n\tif (k == XK_Pointer_Drag_Dflt) return \"Pointer_Drag_Dflt\";\n\tif (k == XK_Pointer_Drag1) return \"Pointer_Drag1\";\n\tif (k == XK_Pointer_Drag2) return \"Pointer_Drag2\";\n\tif (k == XK_Pointer_Drag3) return \"Pointer_Drag3\";\n\tif (k == XK_Pointer_Drag4) return \"Pointer_Drag4\";\n\tif (k == XK_Pointer_Drag5) return \"Pointer_Drag5\";\n\tif (k == XK_Pointer_EnableKeys) return \"Pointer_EnableKeys\";\n\tif (k == XK_Pointer_Accelerate) return \"Pointer_Accelerate\";\n\tif (k == XK_Pointer_DfltBtnNext) return \"Pointer_DfltBtnNext\";\n\tif (k == XK_Pointer_DfltBtnPrev) return \"Pointer_DfltBtnPrev\";\n#endif\n#ifdef XK_3270\n\tif (k == XK_3270_Duplicate) return \"3270_Duplicate\";\n\tif (k == XK_3270_FieldMark) return \"3270_FieldMark\";\n\tif (k == XK_3270_Right2) return \"3270_Right2\";\n\tif (k == XK_3270_Left2) return \"3270_Left2\";\n\tif (k == XK_3270_BackTab) return \"3270_BackTab\";\n\tif (k == XK_3270_EraseEOF) return \"3270_EraseEOF\";\n\tif (k == XK_3270_EraseInput) return \"3270_EraseInput\";\n\tif (k == XK_3270_Reset) return \"3270_Reset\";\n\tif (k == XK_3270_Quit) return \"3270_Quit\";\n\tif (k == XK_3270_PA1) return \"3270_PA1\";\n\tif (k == XK_3270_PA2) return \"3270_PA2\";\n\tif (k == XK_3270_PA3) return \"3270_PA3\";\n\tif (k == XK_3270_Test) return \"3270_Test\";\n\tif (k == XK_3270_Attn) return \"3270_Attn\";\n\tif (k == XK_3270_CursorBlink) return \"3270_CursorBlink\";\n\tif (k == XK_3270_AltCursor) return \"3270_AltCursor\";\n\tif (k == XK_3270_KeyClick) return \"3270_KeyClick\";\n\tif (k == XK_3270_Jump) return \"3270_Jump\";\n\tif (k == XK_3270_Ident) return \"3270_Ident\";\n\tif (k == XK_3270_Rule) return \"3270_Rule\";\n\tif (k == XK_3270_Copy) return \"3270_Copy\";\n\tif (k == XK_3270_Play) return \"3270_Play\";\n\tif (k == XK_3270_Setup) return \"3270_Setup\";\n\tif (k == XK_3270_Record) return \"3270_Record\";\n\tif (k == XK_3270_ChangeScreen) return \"3270_ChangeScreen\";\n\tif (k == XK_3270_DeleteWord) return \"3270_DeleteWord\";\n\tif (k == XK_3270_ExSelect) return \"3270_ExSelect\";\n\tif (k == XK_3270_CursorSelect) return \"3270_CursorSelect\";\n\tif (k == XK_3270_PrintScreen) return \"3270_PrintScreen\";\n\tif (k == XK_3270_Enter) return \"3270_Enter\";\n#endif\n#ifdef XK_LATIN1\n\tif (k == XK_space) return \"space\";\n\tif (k == XK_exclam) return \"exclam\";\n\tif (k == XK_quotedbl) return \"quotedbl\";\n\tif (k == XK_numbersign) return \"numbersign\";\n\tif (k == XK_dollar) return \"dollar\";\n\tif (k == XK_percent) return \"percent\";\n\tif (k == XK_ampersand) return \"ampersand\";\n\tif (k == XK_apostrophe) return \"apostrophe\";\n\tif (k == XK_quoteright) return \"quoteright\";\n\tif (k == XK_parenleft) return \"parenleft\";\n\tif (k == XK_parenright) return \"parenright\";\n\tif (k == XK_asterisk) return \"asterisk\";\n\tif (k == XK_plus) return \"plus\";\n\tif (k == XK_comma) return \"comma\";\n\tif (k == XK_minus) return \"minus\";\n\tif (k == XK_period) return \"period\";\n\tif (k == XK_slash) return \"slash\";\n\tif (k == XK_0) return \"0\";\n\tif (k == XK_1) return \"1\";\n\tif (k == XK_2) return \"2\";\n\tif (k == XK_3) return \"3\";\n\tif (k == XK_4) return \"4\";\n\tif (k == XK_5) return \"5\";\n\tif (k == XK_6) return \"6\";\n\tif (k == XK_7) return \"7\";\n\tif (k == XK_8) return \"8\";\n\tif (k == XK_9) return \"9\";\n\tif (k == XK_colon) return \"colon\";\n\tif (k == XK_semicolon) return \"semicolon\";\n\tif (k == XK_less) return \"less\";\n\tif (k == XK_equal) return \"equal\";\n\tif (k == XK_greater) return \"greater\";\n\tif (k == XK_question) return \"question\";\n\tif (k == XK_at) return \"at\";\n\tif (k == XK_A) return \"A\";\n\tif (k == XK_B) return \"B\";\n\tif (k == XK_C) return \"C\";\n\tif (k == XK_D) return \"D\";\n\tif (k == XK_E) return \"E\";\n\tif (k == XK_F) return \"F\";\n\tif (k == XK_G) return \"G\";\n\tif (k == XK_H) return \"H\";\n\tif (k == XK_I) return \"I\";\n\tif (k == XK_J) return \"J\";\n\tif (k == XK_K) return \"K\";\n\tif (k == XK_L) return \"L\";\n\tif (k == XK_M) return \"M\";\n\tif (k == XK_N) return \"N\";\n\tif (k == XK_O) return \"O\";\n\tif (k == XK_P) return \"P\";\n\tif (k == XK_Q) return \"Q\";\n\tif (k == XK_R) return \"R\";\n\tif (k == XK_S) return \"S\";\n\tif (k == XK_T) return \"T\";\n\tif (k == XK_U) return \"U\";\n\tif (k == XK_V) return \"V\";\n\tif (k == XK_W) return \"W\";\n\tif (k == XK_X) return \"X\";\n\tif (k == XK_Y) return \"Y\";\n\tif (k == XK_Z) return \"Z\";\n\tif (k == XK_bracketleft) return \"bracketleft\";\n\tif (k == XK_backslash) return \"backslash\";\n\tif (k == XK_bracketright) return \"bracketright\";\n\tif (k == XK_asciicircum) return \"asciicircum\";\n\tif (k == XK_underscore) return \"underscore\";\n\tif (k == XK_grave) return \"grave\";\n\tif (k == XK_quoteleft) return \"quoteleft\";\n\tif (k == XK_a) return \"a\";\n\tif (k == XK_b) return \"b\";\n\tif (k == XK_c) return \"c\";\n\tif (k == XK_d) return \"d\";\n\tif (k == XK_e) return \"e\";\n\tif (k == XK_f) return \"f\";\n\tif (k == XK_g) return \"g\";\n\tif (k == XK_h) return \"h\";\n\tif (k == XK_i) return \"i\";\n\tif (k == XK_j) return \"j\";\n\tif (k == XK_k) return \"k\";\n\tif (k == XK_l) return \"l\";\n\tif (k == XK_m) return \"m\";\n\tif (k == XK_n) return \"n\";\n\tif (k == XK_o) return \"o\";\n\tif (k == XK_p) return \"p\";\n\tif (k == XK_q) return \"q\";\n\tif (k == XK_r) return \"r\";\n\tif (k == XK_s) return \"s\";\n\tif (k == XK_t) return \"t\";\n\tif (k == XK_u) return \"u\";\n\tif (k == XK_v) return \"v\";\n\tif (k == XK_w) return \"w\";\n\tif (k == XK_x) return \"x\";\n\tif (k == XK_y) return \"y\";\n\tif (k == XK_z) return \"z\";\n\tif (k == XK_braceleft) return \"braceleft\";\n\tif (k == XK_bar) return \"bar\";\n\tif (k == XK_braceright) return \"braceright\";\n\tif (k == XK_asciitilde) return \"asciitilde\";\n\tif (k == XK_nobreakspace) return \"nobreakspace\";\n\tif (k == XK_exclamdown) return \"exclamdown\";\n\tif (k == XK_cent) return \"cent\";\n\tif (k == XK_sterling) return \"sterling\";\n\tif (k == XK_currency) return \"currency\";\n\tif (k == XK_yen) return \"yen\";\n\tif (k == XK_brokenbar) return \"brokenbar\";\n\tif (k == XK_section) return \"section\";\n\tif (k == XK_diaeresis) return \"diaeresis\";\n\tif (k == XK_copyright) return \"copyright\";\n\tif (k == XK_ordfeminine) return \"ordfeminine\";\n\tif (k == XK_guillemotleft) return \"guillemotleft\";\n\tif (k == XK_notsign) return \"notsign\";\n\tif (k == XK_hyphen) return \"hyphen\";\n\tif (k == XK_registered) return \"registered\";\n\tif (k == XK_macron) return \"macron\";\n\tif (k == XK_degree) return \"degree\";\n\tif (k == XK_plusminus) return \"plusminus\";\n\tif (k == XK_twosuperior) return \"twosuperior\";\n\tif (k == XK_threesuperior) return \"threesuperior\";\n\tif (k == XK_acute) return \"acute\";\n\tif (k == XK_mu) return \"mu\";\n\tif (k == XK_paragraph) return \"paragraph\";\n\tif (k == XK_periodcentered) return \"periodcentered\";\n\tif (k == XK_cedilla) return \"cedilla\";\n\tif (k == XK_onesuperior) return \"onesuperior\";\n\tif (k == XK_masculine) return \"masculine\";\n\tif (k == XK_guillemotright) return \"guillemotright\";\n\tif (k == XK_onequarter) return \"onequarter\";\n\tif (k == XK_onehalf) return \"onehalf\";\n\tif (k == XK_threequarters) return \"threequarters\";\n\tif (k == XK_questiondown) return \"questiondown\";\n\tif (k == XK_Agrave) return \"Agrave\";\n\tif (k == XK_Aacute) return \"Aacute\";\n\tif (k == XK_Acircumflex) return \"Acircumflex\";\n\tif (k == XK_Atilde) return \"Atilde\";\n\tif (k == XK_Adiaeresis) return \"Adiaeresis\";\n\tif (k == XK_Aring) return \"Aring\";\n\tif (k == XK_AE) return \"AE\";\n\tif (k == XK_Ccedilla) return \"Ccedilla\";\n\tif (k == XK_Egrave) return \"Egrave\";\n\tif (k == XK_Eacute) return \"Eacute\";\n\tif (k == XK_Ecircumflex) return \"Ecircumflex\";\n\tif (k == XK_Ediaeresis) return \"Ediaeresis\";\n\tif (k == XK_Igrave) return \"Igrave\";\n\tif (k == XK_Iacute) return \"Iacute\";\n\tif (k == XK_Icircumflex) return \"Icircumflex\";\n\tif (k == XK_Idiaeresis) return \"Idiaeresis\";\n\tif (k == XK_ETH) return \"ETH\";\n\tif (k == XK_Eth) return \"Eth\";\n\tif (k == XK_Ntilde) return \"Ntilde\";\n\tif (k == XK_Ograve) return \"Ograve\";\n\tif (k == XK_Oacute) return \"Oacute\";\n\tif (k == XK_Ocircumflex) return \"Ocircumflex\";\n\tif (k == XK_Otilde) return \"Otilde\";\n\tif (k == XK_Odiaeresis) return \"Odiaeresis\";\n\tif (k == XK_multiply) return \"multiply\";\n\tif (k == XK_Ooblique) return \"Ooblique\";\n\tif (k == XK_Ugrave) return \"Ugrave\";\n\tif (k == XK_Uacute) return \"Uacute\";\n\tif (k == XK_Ucircumflex) return \"Ucircumflex\";\n\tif (k == XK_Udiaeresis) return \"Udiaeresis\";\n\tif (k == XK_Yacute) return \"Yacute\";\n\tif (k == XK_THORN) return \"THORN\";\n\tif (k == XK_Thorn) return \"Thorn\";\n\tif (k == XK_ssharp) return \"ssharp\";\n\tif (k == XK_agrave) return \"agrave\";\n\tif (k == XK_aacute) return \"aacute\";\n\tif (k == XK_acircumflex) return \"acircumflex\";\n\tif (k == XK_atilde) return \"atilde\";\n\tif (k == XK_adiaeresis) return \"adiaeresis\";\n\tif (k == XK_aring) return \"aring\";\n\tif (k == XK_ae) return \"ae\";\n\tif (k == XK_ccedilla) return \"ccedilla\";\n\tif (k == XK_egrave) return \"egrave\";\n\tif (k == XK_eacute) return \"eacute\";\n\tif (k == XK_ecircumflex) return \"ecircumflex\";\n\tif (k == XK_ediaeresis) return \"ediaeresis\";\n\tif (k == XK_igrave) return \"igrave\";\n\tif (k == XK_iacute) return \"iacute\";\n\tif (k == XK_icircumflex) return \"icircumflex\";\n\tif (k == XK_idiaeresis) return \"idiaeresis\";\n\tif (k == XK_eth) return \"eth\";\n\tif (k == XK_ntilde) return \"ntilde\";\n\tif (k == XK_ograve) return \"ograve\";\n\tif (k == XK_oacute) return \"oacute\";\n\tif (k == XK_ocircumflex) return \"ocircumflex\";\n\tif (k == XK_otilde) return \"otilde\";\n\tif (k == XK_odiaeresis) return \"odiaeresis\";\n\tif (k == XK_division) return \"division\";\n\tif (k == XK_oslash) return \"oslash\";\n\tif (k == XK_ugrave) return \"ugrave\";\n\tif (k == XK_uacute) return \"uacute\";\n\tif (k == XK_ucircumflex) return \"ucircumflex\";\n\tif (k == XK_udiaeresis) return \"udiaeresis\";\n\tif (k == XK_yacute) return \"yacute\";\n\tif (k == XK_thorn) return \"thorn\";\n\tif (k == XK_ydiaeresis) return \"ydiaeresis\";\n#endif /* XK_LATIN1 */\n#ifdef XK_LATIN2\n\tif (k == XK_Aogonek) return \"Aogonek\";\n\tif (k == XK_breve) return \"breve\";\n\tif (k == XK_Lstroke) return \"Lstroke\";\n\tif (k == XK_Lcaron) return \"Lcaron\";\n\tif (k == XK_Sacute) return \"Sacute\";\n\tif (k == XK_Scaron) return \"Scaron\";\n\tif (k == XK_Scedilla) return \"Scedilla\";\n\tif (k == XK_Tcaron) return \"Tcaron\";\n\tif (k == XK_Zacute) return \"Zacute\";\n\tif (k == XK_Zcaron) return \"Zcaron\";\n\tif (k == XK_Zabovedot) return \"Zabovedot\";\n\tif (k == XK_aogonek) return \"aogonek\";\n\tif (k == XK_ogonek) return \"ogonek\";\n\tif (k == XK_lstroke) return \"lstroke\";\n\tif (k == XK_lcaron) return \"lcaron\";\n\tif (k == XK_sacute) return \"sacute\";\n\tif (k == XK_caron) return \"caron\";\n\tif (k == XK_scaron) return \"scaron\";\n\tif (k == XK_scedilla) return \"scedilla\";\n\tif (k == XK_tcaron) return \"tcaron\";\n\tif (k == XK_zacute) return \"zacute\";\n\tif (k == XK_doubleacute) return \"doubleacute\";\n\tif (k == XK_zcaron) return \"zcaron\";\n\tif (k == XK_zabovedot) return \"zabovedot\";\n\tif (k == XK_Racute) return \"Racute\";\n\tif (k == XK_Abreve) return \"Abreve\";\n\tif (k == XK_Lacute) return \"Lacute\";\n\tif (k == XK_Cacute) return \"Cacute\";\n\tif (k == XK_Ccaron) return \"Ccaron\";\n\tif (k == XK_Eogonek) return \"Eogonek\";\n\tif (k == XK_Ecaron) return \"Ecaron\";\n\tif (k == XK_Dcaron) return \"Dcaron\";\n\tif (k == XK_Dstroke) return \"Dstroke\";\n\tif (k == XK_Nacute) return \"Nacute\";\n\tif (k == XK_Ncaron) return \"Ncaron\";\n\tif (k == XK_Odoubleacute) return \"Odoubleacute\";\n\tif (k == XK_Rcaron) return \"Rcaron\";\n\tif (k == XK_Uring) return \"Uring\";\n\tif (k == XK_Udoubleacute) return \"Udoubleacute\";\n\tif (k == XK_Tcedilla) return \"Tcedilla\";\n\tif (k == XK_racute) return \"racute\";\n\tif (k == XK_abreve) return \"abreve\";\n\tif (k == XK_lacute) return \"lacute\";\n\tif (k == XK_cacute) return \"cacute\";\n\tif (k == XK_ccaron) return \"ccaron\";\n\tif (k == XK_eogonek) return \"eogonek\";\n\tif (k == XK_ecaron) return \"ecaron\";\n\tif (k == XK_dcaron) return \"dcaron\";\n\tif (k == XK_dstroke) return \"dstroke\";\n\tif (k == XK_nacute) return \"nacute\";\n\tif (k == XK_ncaron) return \"ncaron\";\n\tif (k == XK_odoubleacute) return \"odoubleacute\";\n\tif (k == XK_udoubleacute) return \"udoubleacute\";\n\tif (k == XK_rcaron) return \"rcaron\";\n\tif (k == XK_uring) return \"uring\";\n\tif (k == XK_tcedilla) return \"tcedilla\";\n\tif (k == XK_abovedot) return \"abovedot\";\n#endif /* XK_LATIN2 */\n#ifdef XK_LATIN3\n\tif (k == XK_Hstroke) return \"Hstroke\";\n\tif (k == XK_Hcircumflex) return \"Hcircumflex\";\n\tif (k == XK_Iabovedot) return \"Iabovedot\";\n\tif (k == XK_Gbreve) return \"Gbreve\";\n\tif (k == XK_Jcircumflex) return \"Jcircumflex\";\n\tif (k == XK_hstroke) return \"hstroke\";\n\tif (k == XK_hcircumflex) return \"hcircumflex\";\n\tif (k == XK_idotless) return \"idotless\";\n\tif (k == XK_gbreve) return \"gbreve\";\n\tif (k == XK_jcircumflex) return \"jcircumflex\";\n\tif (k == XK_Cabovedot) return \"Cabovedot\";\n\tif (k == XK_Ccircumflex) return \"Ccircumflex\";\n\tif (k == XK_Gabovedot) return \"Gabovedot\";\n\tif (k == XK_Gcircumflex) return \"Gcircumflex\";\n\tif (k == XK_Ubreve) return \"Ubreve\";\n\tif (k == XK_Scircumflex) return \"Scircumflex\";\n\tif (k == XK_cabovedot) return \"cabovedot\";\n\tif (k == XK_ccircumflex) return \"ccircumflex\";\n\tif (k == XK_gabovedot) return \"gabovedot\";\n\tif (k == XK_gcircumflex) return \"gcircumflex\";\n\tif (k == XK_ubreve) return \"ubreve\";\n\tif (k == XK_scircumflex) return \"scircumflex\";\n#endif /* XK_LATIN3 */\n#ifdef XK_LATIN4\n\tif (k == XK_kra) return \"kra\";\n\tif (k == XK_kappa) return \"kappa\";\n\tif (k == XK_Rcedilla) return \"Rcedilla\";\n\tif (k == XK_Itilde) return \"Itilde\";\n\tif (k == XK_Lcedilla) return \"Lcedilla\";\n\tif (k == XK_Emacron) return \"Emacron\";\n\tif (k == XK_Gcedilla) return \"Gcedilla\";\n\tif (k == XK_Tslash) return \"Tslash\";\n\tif (k == XK_rcedilla) return \"rcedilla\";\n\tif (k == XK_itilde) return \"itilde\";\n\tif (k == XK_lcedilla) return \"lcedilla\";\n\tif (k == XK_emacron) return \"emacron\";\n\tif (k == XK_gcedilla) return \"gcedilla\";\n\tif (k == XK_tslash) return \"tslash\";\n\tif (k == XK_ENG) return \"ENG\";\n\tif (k == XK_eng) return \"eng\";\n\tif (k == XK_Amacron) return \"Amacron\";\n\tif (k == XK_Iogonek) return \"Iogonek\";\n\tif (k == XK_Eabovedot) return \"Eabovedot\";\n\tif (k == XK_Imacron) return \"Imacron\";\n\tif (k == XK_Ncedilla) return \"Ncedilla\";\n\tif (k == XK_Omacron) return \"Omacron\";\n\tif (k == XK_Kcedilla) return \"Kcedilla\";\n\tif (k == XK_Uogonek) return \"Uogonek\";\n\tif (k == XK_Utilde) return \"Utilde\";\n\tif (k == XK_Umacron) return \"Umacron\";\n\tif (k == XK_amacron) return \"amacron\";\n\tif (k == XK_iogonek) return \"iogonek\";\n\tif (k == XK_eabovedot) return \"eabovedot\";\n\tif (k == XK_imacron) return \"imacron\";\n\tif (k == XK_ncedilla) return \"ncedilla\";\n\tif (k == XK_omacron) return \"omacron\";\n\tif (k == XK_kcedilla) return \"kcedilla\";\n\tif (k == XK_uogonek) return \"uogonek\";\n\tif (k == XK_utilde) return \"utilde\";\n\tif (k == XK_umacron) return \"umacron\";\n#endif /* XK_LATIN4 */\n#ifdef XK_KATAKANA\n\tif (k == XK_overline) return \"overline\";\n\tif (k == XK_kana_fullstop) return \"kana_fullstop\";\n\tif (k == XK_kana_openingbracket) return \"kana_openingbracket\";\n\tif (k == XK_kana_closingbracket) return \"kana_closingbracket\";\n\tif (k == XK_kana_comma) return \"kana_comma\";\n\tif (k == XK_kana_conjunctive) return \"kana_conjunctive\";\n\tif (k == XK_kana_middledot) return \"kana_middledot\";\n\tif (k == XK_kana_WO) return \"kana_WO\";\n\tif (k == XK_kana_a) return \"kana_a\";\n\tif (k == XK_kana_i) return \"kana_i\";\n\tif (k == XK_kana_u) return \"kana_u\";\n\tif (k == XK_kana_e) return \"kana_e\";\n\tif (k == XK_kana_o) return \"kana_o\";\n\tif (k == XK_kana_ya) return \"kana_ya\";\n\tif (k == XK_kana_yu) return \"kana_yu\";\n\tif (k == XK_kana_yo) return \"kana_yo\";\n\tif (k == XK_kana_tsu) return \"kana_tsu\";\n\tif (k == XK_kana_tu) return \"kana_tu\";\n\tif (k == XK_prolongedsound) return \"prolongedsound\";\n\tif (k == XK_kana_A) return \"kana_A\";\n\tif (k == XK_kana_I) return \"kana_I\";\n\tif (k == XK_kana_U) return \"kana_U\";\n\tif (k == XK_kana_E) return \"kana_E\";\n\tif (k == XK_kana_O) return \"kana_O\";\n\tif (k == XK_kana_KA) return \"kana_KA\";\n\tif (k == XK_kana_KI) return \"kana_KI\";\n\tif (k == XK_kana_KU) return \"kana_KU\";\n\tif (k == XK_kana_KE) return \"kana_KE\";\n\tif (k == XK_kana_KO) return \"kana_KO\";\n\tif (k == XK_kana_SA) return \"kana_SA\";\n\tif (k == XK_kana_SHI) return \"kana_SHI\";\n\tif (k == XK_kana_SU) return \"kana_SU\";\n\tif (k == XK_kana_SE) return \"kana_SE\";\n\tif (k == XK_kana_SO) return \"kana_SO\";\n\tif (k == XK_kana_TA) return \"kana_TA\";\n\tif (k == XK_kana_CHI) return \"kana_CHI\";\n\tif (k == XK_kana_TI) return \"kana_TI\";\n\tif (k == XK_kana_TSU) return \"kana_TSU\";\n\tif (k == XK_kana_TU) return \"kana_TU\";\n\tif (k == XK_kana_TE) return \"kana_TE\";\n\tif (k == XK_kana_TO) return \"kana_TO\";\n\tif (k == XK_kana_NA) return \"kana_NA\";\n\tif (k == XK_kana_NI) return \"kana_NI\";\n\tif (k == XK_kana_NU) return \"kana_NU\";\n\tif (k == XK_kana_NE) return \"kana_NE\";\n\tif (k == XK_kana_NO) return \"kana_NO\";\n\tif (k == XK_kana_HA) return \"kana_HA\";\n\tif (k == XK_kana_HI) return \"kana_HI\";\n\tif (k == XK_kana_FU) return \"kana_FU\";\n\tif (k == XK_kana_HU) return \"kana_HU\";\n\tif (k == XK_kana_HE) return \"kana_HE\";\n\tif (k == XK_kana_HO) return \"kana_HO\";\n\tif (k == XK_kana_MA) return \"kana_MA\";\n\tif (k == XK_kana_MI) return \"kana_MI\";\n\tif (k == XK_kana_MU) return \"kana_MU\";\n\tif (k == XK_kana_ME) return \"kana_ME\";\n\tif (k == XK_kana_MO) return \"kana_MO\";\n\tif (k == XK_kana_YA) return \"kana_YA\";\n\tif (k == XK_kana_YU) return \"kana_YU\";\n\tif (k == XK_kana_YO) return \"kana_YO\";\n\tif (k == XK_kana_RA) return \"kana_RA\";\n\tif (k == XK_kana_RI) return \"kana_RI\";\n\tif (k == XK_kana_RU) return \"kana_RU\";\n\tif (k == XK_kana_RE) return \"kana_RE\";\n\tif (k == XK_kana_RO) return \"kana_RO\";\n\tif (k == XK_kana_WA) return \"kana_WA\";\n\tif (k == XK_kana_N) return \"kana_N\";\n\tif (k == XK_voicedsound) return \"voicedsound\";\n\tif (k == XK_semivoicedsound) return \"semivoicedsound\";\n\tif (k == XK_kana_switch) return \"kana_switch\";\n#endif /* XK_KATAKANA */\n#ifdef XK_ARABIC\n\tif (k == XK_Arabic_comma) return \"Arabic_comma\";\n\tif (k == XK_Arabic_semicolon) return \"Arabic_semicolon\";\n\tif (k == XK_Arabic_question_mark) return \"Arabic_question_mark\";\n\tif (k == XK_Arabic_hamza) return \"Arabic_hamza\";\n\tif (k == XK_Arabic_maddaonalef) return \"Arabic_maddaonalef\";\n\tif (k == XK_Arabic_hamzaonalef) return \"Arabic_hamzaonalef\";\n\tif (k == XK_Arabic_hamzaonwaw) return \"Arabic_hamzaonwaw\";\n\tif (k == XK_Arabic_hamzaunderalef) return \"Arabic_hamzaunderalef\";\n\tif (k == XK_Arabic_hamzaonyeh) return \"Arabic_hamzaonyeh\";\n\tif (k == XK_Arabic_alef) return \"Arabic_alef\";\n\tif (k == XK_Arabic_beh) return \"Arabic_beh\";\n\tif (k == XK_Arabic_tehmarbuta) return \"Arabic_tehmarbuta\";\n\tif (k == XK_Arabic_teh) return \"Arabic_teh\";\n\tif (k == XK_Arabic_theh) return \"Arabic_theh\";\n\tif (k == XK_Arabic_jeem) return \"Arabic_jeem\";\n\tif (k == XK_Arabic_hah) return \"Arabic_hah\";\n\tif (k == XK_Arabic_khah) return \"Arabic_khah\";\n\tif (k == XK_Arabic_dal) return \"Arabic_dal\";\n\tif (k == XK_Arabic_thal) return \"Arabic_thal\";\n\tif (k == XK_Arabic_ra) return \"Arabic_ra\";\n\tif (k == XK_Arabic_zain) return \"Arabic_zain\";\n\tif (k == XK_Arabic_seen) return \"Arabic_seen\";\n\tif (k == XK_Arabic_sheen) return \"Arabic_sheen\";\n\tif (k == XK_Arabic_sad) return \"Arabic_sad\";\n\tif (k == XK_Arabic_dad) return \"Arabic_dad\";\n\tif (k == XK_Arabic_tah) return \"Arabic_tah\";\n\tif (k == XK_Arabic_zah) return \"Arabic_zah\";\n\tif (k == XK_Arabic_ain) return \"Arabic_ain\";\n\tif (k == XK_Arabic_ghain) return \"Arabic_ghain\";\n\tif (k == XK_Arabic_tatweel) return \"Arabic_tatweel\";\n\tif (k == XK_Arabic_feh) return \"Arabic_feh\";\n\tif (k == XK_Arabic_qaf) return \"Arabic_qaf\";\n\tif (k == XK_Arabic_kaf) return \"Arabic_kaf\";\n\tif (k == XK_Arabic_lam) return \"Arabic_lam\";\n\tif (k == XK_Arabic_meem) return \"Arabic_meem\";\n\tif (k == XK_Arabic_noon) return \"Arabic_noon\";\n\tif (k == XK_Arabic_ha) return \"Arabic_ha\";\n\tif (k == XK_Arabic_heh) return \"Arabic_heh\";\n\tif (k == XK_Arabic_waw) return \"Arabic_waw\";\n\tif (k == XK_Arabic_alefmaksura) return \"Arabic_alefmaksura\";\n\tif (k == XK_Arabic_yeh) return \"Arabic_yeh\";\n\tif (k == XK_Arabic_fathatan) return \"Arabic_fathatan\";\n\tif (k == XK_Arabic_dammatan) return \"Arabic_dammatan\";\n\tif (k == XK_Arabic_kasratan) return \"Arabic_kasratan\";\n\tif (k == XK_Arabic_fatha) return \"Arabic_fatha\";\n\tif (k == XK_Arabic_damma) return \"Arabic_damma\";\n\tif (k == XK_Arabic_kasra) return \"Arabic_kasra\";\n\tif (k == XK_Arabic_shadda) return \"Arabic_shadda\";\n\tif (k == XK_Arabic_sukun) return \"Arabic_sukun\";\n\tif (k == XK_Arabic_switch) return \"Arabic_switch\";\n#endif /* XK_ARABIC */\n#ifdef XK_CYRILLIC\n\tif (k == XK_Serbian_dje) return \"Serbian_dje\";\n\tif (k == XK_Macedonia_gje) return \"Macedonia_gje\";\n\tif (k == XK_Cyrillic_io) return \"Cyrillic_io\";\n\tif (k == XK_Ukrainian_ie) return \"Ukrainian_ie\";\n\tif (k == XK_Ukranian_je) return \"Ukranian_je\";\n\tif (k == XK_Macedonia_dse) return \"Macedonia_dse\";\n\tif (k == XK_Ukrainian_i) return \"Ukrainian_i\";\n\tif (k == XK_Ukranian_i) return \"Ukranian_i\";\n\tif (k == XK_Ukrainian_yi) return \"Ukrainian_yi\";\n\tif (k == XK_Ukranian_yi) return \"Ukranian_yi\";\n\tif (k == XK_Cyrillic_je) return \"Cyrillic_je\";\n\tif (k == XK_Serbian_je) return \"Serbian_je\";\n\tif (k == XK_Cyrillic_lje) return \"Cyrillic_lje\";\n\tif (k == XK_Serbian_lje) return \"Serbian_lje\";\n\tif (k == XK_Cyrillic_nje) return \"Cyrillic_nje\";\n\tif (k == XK_Serbian_nje) return \"Serbian_nje\";\n\tif (k == XK_Serbian_tshe) return \"Serbian_tshe\";\n\tif (k == XK_Macedonia_kje) return \"Macedonia_kje\";\n\tif (k == XK_Byelorussian_shortu) return \"Byelorussian_shortu\";\n\tif (k == XK_Cyrillic_dzhe) return \"Cyrillic_dzhe\";\n\tif (k == XK_Serbian_dze) return \"Serbian_dze\";\n\tif (k == XK_numerosign) return \"numerosign\";\n\tif (k == XK_Serbian_DJE) return \"Serbian_DJE\";\n\tif (k == XK_Macedonia_GJE) return \"Macedonia_GJE\";\n\tif (k == XK_Cyrillic_IO) return \"Cyrillic_IO\";\n\tif (k == XK_Ukrainian_IE) return \"Ukrainian_IE\";\n\tif (k == XK_Ukranian_JE) return \"Ukranian_JE\";\n\tif (k == XK_Macedonia_DSE) return \"Macedonia_DSE\";\n\tif (k == XK_Ukrainian_I) return \"Ukrainian_I\";\n\tif (k == XK_Ukranian_I) return \"Ukranian_I\";\n\tif (k == XK_Ukrainian_YI) return \"Ukrainian_YI\";\n\tif (k == XK_Ukranian_YI) return \"Ukranian_YI\";\n\tif (k == XK_Cyrillic_JE) return \"Cyrillic_JE\";\n\tif (k == XK_Serbian_JE) return \"Serbian_JE\";\n\tif (k == XK_Cyrillic_LJE) return \"Cyrillic_LJE\";\n\tif (k == XK_Serbian_LJE) return \"Serbian_LJE\";\n\tif (k == XK_Cyrillic_NJE) return \"Cyrillic_NJE\";\n\tif (k == XK_Serbian_NJE) return \"Serbian_NJE\";\n\tif (k == XK_Serbian_TSHE) return \"Serbian_TSHE\";\n\tif (k == XK_Macedonia_KJE) return \"Macedonia_KJE\";\n\tif (k == XK_Byelorussian_SHORTU) return \"Byelorussian_SHORTU\";\n\tif (k == XK_Cyrillic_DZHE) return \"Cyrillic_DZHE\";\n\tif (k == XK_Serbian_DZE) return \"Serbian_DZE\";\n\tif (k == XK_Cyrillic_yu) return \"Cyrillic_yu\";\n\tif (k == XK_Cyrillic_a) return \"Cyrillic_a\";\n\tif (k == XK_Cyrillic_be) return \"Cyrillic_be\";\n\tif (k == XK_Cyrillic_tse) return \"Cyrillic_tse\";\n\tif (k == XK_Cyrillic_de) return \"Cyrillic_de\";\n\tif (k == XK_Cyrillic_ie) return \"Cyrillic_ie\";\n\tif (k == XK_Cyrillic_ef) return \"Cyrillic_ef\";\n\tif (k == XK_Cyrillic_ghe) return \"Cyrillic_ghe\";\n\tif (k == XK_Cyrillic_ha) return \"Cyrillic_ha\";\n\tif (k == XK_Cyrillic_i) return \"Cyrillic_i\";\n\tif (k == XK_Cyrillic_shorti) return \"Cyrillic_shorti\";\n\tif (k == XK_Cyrillic_ka) return \"Cyrillic_ka\";\n\tif (k == XK_Cyrillic_el) return \"Cyrillic_el\";\n\tif (k == XK_Cyrillic_em) return \"Cyrillic_em\";\n\tif (k == XK_Cyrillic_en) return \"Cyrillic_en\";\n\tif (k == XK_Cyrillic_o) return \"Cyrillic_o\";\n\tif (k == XK_Cyrillic_pe) return \"Cyrillic_pe\";\n\tif (k == XK_Cyrillic_ya) return \"Cyrillic_ya\";\n\tif (k == XK_Cyrillic_er) return \"Cyrillic_er\";\n\tif (k == XK_Cyrillic_es) return \"Cyrillic_es\";\n\tif (k == XK_Cyrillic_te) return \"Cyrillic_te\";\n\tif (k == XK_Cyrillic_u) return \"Cyrillic_u\";\n\tif (k == XK_Cyrillic_zhe) return \"Cyrillic_zhe\";\n\tif (k == XK_Cyrillic_ve) return \"Cyrillic_ve\";\n\tif (k == XK_Cyrillic_softsign) return \"Cyrillic_softsign\";\n\tif (k == XK_Cyrillic_yeru) return \"Cyrillic_yeru\";\n\tif (k == XK_Cyrillic_ze) return \"Cyrillic_ze\";\n\tif (k == XK_Cyrillic_sha) return \"Cyrillic_sha\";\n\tif (k == XK_Cyrillic_e) return \"Cyrillic_e\";\n\tif (k == XK_Cyrillic_shcha) return \"Cyrillic_shcha\";\n\tif (k == XK_Cyrillic_che) return \"Cyrillic_che\";\n\tif (k == XK_Cyrillic_hardsign) return \"Cyrillic_hardsign\";\n\tif (k == XK_Cyrillic_YU) return \"Cyrillic_YU\";\n\tif (k == XK_Cyrillic_A) return \"Cyrillic_A\";\n\tif (k == XK_Cyrillic_BE) return \"Cyrillic_BE\";\n\tif (k == XK_Cyrillic_TSE) return \"Cyrillic_TSE\";\n\tif (k == XK_Cyrillic_DE) return \"Cyrillic_DE\";\n\tif (k == XK_Cyrillic_IE) return \"Cyrillic_IE\";\n\tif (k == XK_Cyrillic_EF) return \"Cyrillic_EF\";\n\tif (k == XK_Cyrillic_GHE) return \"Cyrillic_GHE\";\n\tif (k == XK_Cyrillic_HA) return \"Cyrillic_HA\";\n\tif (k == XK_Cyrillic_I) return \"Cyrillic_I\";\n\tif (k == XK_Cyrillic_SHORTI) return \"Cyrillic_SHORTI\";\n\tif (k == XK_Cyrillic_KA) return \"Cyrillic_KA\";\n\tif (k == XK_Cyrillic_EL) return \"Cyrillic_EL\";\n\tif (k == XK_Cyrillic_EM) return \"Cyrillic_EM\";\n\tif (k == XK_Cyrillic_EN) return \"Cyrillic_EN\";\n\tif (k == XK_Cyrillic_O) return \"Cyrillic_O\";\n\tif (k == XK_Cyrillic_PE) return \"Cyrillic_PE\";\n\tif (k == XK_Cyrillic_YA) return \"Cyrillic_YA\";\n\tif (k == XK_Cyrillic_ER) return \"Cyrillic_ER\";\n\tif (k == XK_Cyrillic_ES) return \"Cyrillic_ES\";\n\tif (k == XK_Cyrillic_TE) return \"Cyrillic_TE\";\n\tif (k == XK_Cyrillic_U) return \"Cyrillic_U\";\n\tif (k == XK_Cyrillic_ZHE) return \"Cyrillic_ZHE\";\n\tif (k == XK_Cyrillic_VE) return \"Cyrillic_VE\";\n\tif (k == XK_Cyrillic_SOFTSIGN) return \"Cyrillic_SOFTSIGN\";\n\tif (k == XK_Cyrillic_YERU) return \"Cyrillic_YERU\";\n\tif (k == XK_Cyrillic_ZE) return \"Cyrillic_ZE\";\n\tif (k == XK_Cyrillic_SHA) return \"Cyrillic_SHA\";\n\tif (k == XK_Cyrillic_E) return \"Cyrillic_E\";\n\tif (k == XK_Cyrillic_SHCHA) return \"Cyrillic_SHCHA\";\n\tif (k == XK_Cyrillic_CHE) return \"Cyrillic_CHE\";\n\tif (k == XK_Cyrillic_HARDSIGN) return \"Cyrillic_HARDSIGN\";\n#endif /* XK_CYRILLIC */\n#ifdef XK_GREEK\n\tif (k == XK_Greek_ALPHAaccent) return \"Greek_ALPHAaccent\";\n\tif (k == XK_Greek_EPSILONaccent) return \"Greek_EPSILONaccent\";\n\tif (k == XK_Greek_ETAaccent) return \"Greek_ETAaccent\";\n\tif (k == XK_Greek_IOTAaccent) return \"Greek_IOTAaccent\";\n\tif (k == XK_Greek_IOTAdieresis) return \"Greek_IOTAdieresis\";\n\tif (k == XK_Greek_OMICRONaccent) return \"Greek_OMICRONaccent\";\n\tif (k == XK_Greek_UPSILONaccent) return \"Greek_UPSILONaccent\";\n\tif (k == XK_Greek_UPSILONdieresis) return \"Greek_UPSILONdieresis\";\n\tif (k == XK_Greek_OMEGAaccent) return \"Greek_OMEGAaccent\";\n\tif (k == XK_Greek_accentdieresis) return \"Greek_accentdieresis\";\n\tif (k == XK_Greek_horizbar) return \"Greek_horizbar\";\n\tif (k == XK_Greek_alphaaccent) return \"Greek_alphaaccent\";\n\tif (k == XK_Greek_epsilonaccent) return \"Greek_epsilonaccent\";\n\tif (k == XK_Greek_etaaccent) return \"Greek_etaaccent\";\n\tif (k == XK_Greek_iotaaccent) return \"Greek_iotaaccent\";\n\tif (k == XK_Greek_iotadieresis) return \"Greek_iotadieresis\";\n\tif (k == XK_Greek_iotaaccentdieresis) return \"Greek_iotaaccentdieresis\";\n\tif (k == XK_Greek_omicronaccent) return \"Greek_omicronaccent\";\n\tif (k == XK_Greek_upsilonaccent) return \"Greek_upsilonaccent\";\n\tif (k == XK_Greek_upsilondieresis) return \"Greek_upsilondieresis\";\n\tif (k == XK_Greek_upsilonaccentdieresis) return \"Greek_upsilonaccentdieresis\";\n\tif (k == XK_Greek_omegaaccent) return \"Greek_omegaaccent\";\n\tif (k == XK_Greek_ALPHA) return \"Greek_ALPHA\";\n\tif (k == XK_Greek_BETA) return \"Greek_BETA\";\n\tif (k == XK_Greek_GAMMA) return \"Greek_GAMMA\";\n\tif (k == XK_Greek_DELTA) return \"Greek_DELTA\";\n\tif (k == XK_Greek_EPSILON) return \"Greek_EPSILON\";\n\tif (k == XK_Greek_ZETA) return \"Greek_ZETA\";\n\tif (k == XK_Greek_ETA) return \"Greek_ETA\";\n\tif (k == XK_Greek_THETA) return \"Greek_THETA\";\n\tif (k == XK_Greek_IOTA) return \"Greek_IOTA\";\n\tif (k == XK_Greek_KAPPA) return \"Greek_KAPPA\";\n\tif (k == XK_Greek_LAMDA) return \"Greek_LAMDA\";\n\tif (k == XK_Greek_LAMBDA) return \"Greek_LAMBDA\";\n\tif (k == XK_Greek_MU) return \"Greek_MU\";\n\tif (k == XK_Greek_NU) return \"Greek_NU\";\n\tif (k == XK_Greek_XI) return \"Greek_XI\";\n\tif (k == XK_Greek_OMICRON) return \"Greek_OMICRON\";\n\tif (k == XK_Greek_PI) return \"Greek_PI\";\n\tif (k == XK_Greek_RHO) return \"Greek_RHO\";\n\tif (k == XK_Greek_SIGMA) return \"Greek_SIGMA\";\n\tif (k == XK_Greek_TAU) return \"Greek_TAU\";\n\tif (k == XK_Greek_UPSILON) return \"Greek_UPSILON\";\n\tif (k == XK_Greek_PHI) return \"Greek_PHI\";\n\tif (k == XK_Greek_CHI) return \"Greek_CHI\";\n\tif (k == XK_Greek_PSI) return \"Greek_PSI\";\n\tif (k == XK_Greek_OMEGA) return \"Greek_OMEGA\";\n\tif (k == XK_Greek_alpha) return \"Greek_alpha\";\n\tif (k == XK_Greek_beta) return \"Greek_beta\";\n\tif (k == XK_Greek_gamma) return \"Greek_gamma\";\n\tif (k == XK_Greek_delta) return \"Greek_delta\";\n\tif (k == XK_Greek_epsilon) return \"Greek_epsilon\";\n\tif (k == XK_Greek_zeta) return \"Greek_zeta\";\n\tif (k == XK_Greek_eta) return \"Greek_eta\";\n\tif (k == XK_Greek_theta) return \"Greek_theta\";\n\tif (k == XK_Greek_iota) return \"Greek_iota\";\n\tif (k == XK_Greek_kappa) return \"Greek_kappa\";\n\tif (k == XK_Greek_lamda) return \"Greek_lamda\";\n\tif (k == XK_Greek_lambda) return \"Greek_lambda\";\n\tif (k == XK_Greek_mu) return \"Greek_mu\";\n\tif (k == XK_Greek_nu) return \"Greek_nu\";\n\tif (k == XK_Greek_xi) return \"Greek_xi\";\n\tif (k == XK_Greek_omicron) return \"Greek_omicron\";\n\tif (k == XK_Greek_pi) return \"Greek_pi\";\n\tif (k == XK_Greek_rho) return \"Greek_rho\";\n\tif (k == XK_Greek_sigma) return \"Greek_sigma\";\n\tif (k == XK_Greek_finalsmallsigma) return \"Greek_finalsmallsigma\";\n\tif (k == XK_Greek_tau) return \"Greek_tau\";\n\tif (k == XK_Greek_upsilon) return \"Greek_upsilon\";\n\tif (k == XK_Greek_phi) return \"Greek_phi\";\n\tif (k == XK_Greek_chi) return \"Greek_chi\";\n\tif (k == XK_Greek_psi) return \"Greek_psi\";\n\tif (k == XK_Greek_omega) return \"Greek_omega\";\n\tif (k == XK_Greek_switch) return \"Greek_switch\";\n#endif /* XK_GREEK */\n#ifdef XK_TECHNICAL\n\tif (k == XK_leftradical) return \"leftradical\";\n\tif (k == XK_topleftradical) return \"topleftradical\";\n\tif (k == XK_horizconnector) return \"horizconnector\";\n\tif (k == XK_topintegral) return \"topintegral\";\n\tif (k == XK_botintegral) return \"botintegral\";\n\tif (k == XK_vertconnector) return \"vertconnector\";\n\tif (k == XK_topleftsqbracket) return \"topleftsqbracket\";\n\tif (k == XK_botleftsqbracket) return \"botleftsqbracket\";\n\tif (k == XK_toprightsqbracket) return \"toprightsqbracket\";\n\tif (k == XK_botrightsqbracket) return \"botrightsqbracket\";\n\tif (k == XK_topleftparens) return \"topleftparens\";\n\tif (k == XK_botleftparens) return \"botleftparens\";\n\tif (k == XK_toprightparens) return \"toprightparens\";\n\tif (k == XK_botrightparens) return \"botrightparens\";\n\tif (k == XK_leftmiddlecurlybrace) return \"leftmiddlecurlybrace\";\n\tif (k == XK_rightmiddlecurlybrace) return \"rightmiddlecurlybrace\";\n\tif (k == XK_topleftsummation) return \"topleftsummation\";\n\tif (k == XK_botleftsummation) return \"botleftsummation\";\n\tif (k == XK_topvertsummationconnector) return \"topvertsummationconnector\";\n\tif (k == XK_botvertsummationconnector) return \"botvertsummationconnector\";\n\tif (k == XK_toprightsummation) return \"toprightsummation\";\n\tif (k == XK_botrightsummation) return \"botrightsummation\";\n\tif (k == XK_rightmiddlesummation) return \"rightmiddlesummation\";\n\tif (k == XK_lessthanequal) return \"lessthanequal\";\n\tif (k == XK_notequal) return \"notequal\";\n\tif (k == XK_greaterthanequal) return \"greaterthanequal\";\n\tif (k == XK_integral) return \"integral\";\n\tif (k == XK_therefore) return \"therefore\";\n\tif (k == XK_variation) return \"variation\";\n\tif (k == XK_infinity) return \"infinity\";\n\tif (k == XK_nabla) return \"nabla\";\n\tif (k == XK_approximate) return \"approximate\";\n\tif (k == XK_similarequal) return \"similarequal\";\n\tif (k == XK_ifonlyif) return \"ifonlyif\";\n\tif (k == XK_implies) return \"implies\";\n\tif (k == XK_identical) return \"identical\";\n\tif (k == XK_radical) return \"radical\";\n\tif (k == XK_includedin) return \"includedin\";\n\tif (k == XK_includes) return \"includes\";\n\tif (k == XK_intersection) return \"intersection\";\n\tif (k == XK_union) return \"union\";\n\tif (k == XK_logicaland) return \"logicaland\";\n\tif (k == XK_logicalor) return \"logicalor\";\n\tif (k == XK_partialderivative) return \"partialderivative\";\n\tif (k == XK_function) return \"function\";\n\tif (k == XK_leftarrow) return \"leftarrow\";\n\tif (k == XK_uparrow) return \"uparrow\";\n\tif (k == XK_rightarrow) return \"rightarrow\";\n\tif (k == XK_downarrow) return \"downarrow\";\n#endif /* XK_TECHNICAL */\n#ifdef XK_SPECIAL\n\tif (k == XK_blank) return \"blank\";\n\tif (k == XK_soliddiamond) return \"soliddiamond\";\n\tif (k == XK_checkerboard) return \"checkerboard\";\n\tif (k == XK_ht) return \"ht\";\n\tif (k == XK_ff) return \"ff\";\n\tif (k == XK_cr) return \"cr\";\n\tif (k == XK_lf) return \"lf\";\n\tif (k == XK_nl) return \"nl\";\n\tif (k == XK_vt) return \"vt\";\n\tif (k == XK_lowrightcorner) return \"lowrightcorner\";\n\tif (k == XK_uprightcorner) return \"uprightcorner\";\n\tif (k == XK_upleftcorner) return \"upleftcorner\";\n\tif (k == XK_lowleftcorner) return \"lowleftcorner\";\n\tif (k == XK_crossinglines) return \"crossinglines\";\n\tif (k == XK_horizlinescan1) return \"horizlinescan1\";\n\tif (k == XK_horizlinescan3) return \"horizlinescan3\";\n\tif (k == XK_horizlinescan5) return \"horizlinescan5\";\n\tif (k == XK_horizlinescan7) return \"horizlinescan7\";\n\tif (k == XK_horizlinescan9) return \"horizlinescan9\";\n\tif (k == XK_leftt) return \"leftt\";\n\tif (k == XK_rightt) return \"rightt\";\n\tif (k == XK_bott) return \"bott\";\n\tif (k == XK_topt) return \"topt\";\n\tif (k == XK_vertbar) return \"vertbar\";\n#endif /* XK_SPECIAL */\n#ifdef XK_PUBLISHING\n\tif (k == XK_emspace) return \"emspace\";\n\tif (k == XK_enspace) return \"enspace\";\n\tif (k == XK_em3space) return \"em3space\";\n\tif (k == XK_em4space) return \"em4space\";\n\tif (k == XK_digitspace) return \"digitspace\";\n\tif (k == XK_punctspace) return \"punctspace\";\n\tif (k == XK_thinspace) return \"thinspace\";\n\tif (k == XK_hairspace) return \"hairspace\";\n\tif (k == XK_emdash) return \"emdash\";\n\tif (k == XK_endash) return \"endash\";\n\tif (k == XK_signifblank) return \"signifblank\";\n\tif (k == XK_ellipsis) return \"ellipsis\";\n\tif (k == XK_doubbaselinedot) return \"doubbaselinedot\";\n\tif (k == XK_onethird) return \"onethird\";\n\tif (k == XK_twothirds) return \"twothirds\";\n\tif (k == XK_onefifth) return \"onefifth\";\n\tif (k == XK_twofifths) return \"twofifths\";\n\tif (k == XK_threefifths) return \"threefifths\";\n\tif (k == XK_fourfifths) return \"fourfifths\";\n\tif (k == XK_onesixth) return \"onesixth\";\n\tif (k == XK_fivesixths) return \"fivesixths\";\n\tif (k == XK_careof) return \"careof\";\n\tif (k == XK_figdash) return \"figdash\";\n\tif (k == XK_leftanglebracket) return \"leftanglebracket\";\n\tif (k == XK_decimalpoint) return \"decimalpoint\";\n\tif (k == XK_rightanglebracket) return \"rightanglebracket\";\n\tif (k == XK_marker) return \"marker\";\n\tif (k == XK_oneeighth) return \"oneeighth\";\n\tif (k == XK_threeeighths) return \"threeeighths\";\n\tif (k == XK_fiveeighths) return \"fiveeighths\";\n\tif (k == XK_seveneighths) return \"seveneighths\";\n\tif (k == XK_trademark) return \"trademark\";\n\tif (k == XK_signaturemark) return \"signaturemark\";\n\tif (k == XK_trademarkincircle) return \"trademarkincircle\";\n\tif (k == XK_leftopentriangle) return \"leftopentriangle\";\n\tif (k == XK_rightopentriangle) return \"rightopentriangle\";\n\tif (k == XK_emopencircle) return \"emopencircle\";\n\tif (k == XK_emopenrectangle) return \"emopenrectangle\";\n\tif (k == XK_leftsinglequotemark) return \"leftsinglequotemark\";\n\tif (k == XK_rightsinglequotemark) return \"rightsinglequotemark\";\n\tif (k == XK_leftdoublequotemark) return \"leftdoublequotemark\";\n\tif (k == XK_rightdoublequotemark) return \"rightdoublequotemark\";\n\tif (k == XK_prescription) return \"prescription\";\n\tif (k == XK_minutes) return \"minutes\";\n\tif (k == XK_seconds) return \"seconds\";\n\tif (k == XK_latincross) return \"latincross\";\n\tif (k == XK_hexagram) return \"hexagram\";\n\tif (k == XK_filledrectbullet) return \"filledrectbullet\";\n\tif (k == XK_filledlefttribullet) return \"filledlefttribullet\";\n\tif (k == XK_filledrighttribullet) return \"filledrighttribullet\";\n\tif (k == XK_emfilledcircle) return \"emfilledcircle\";\n\tif (k == XK_emfilledrect) return \"emfilledrect\";\n\tif (k == XK_enopencircbullet) return \"enopencircbullet\";\n\tif (k == XK_enopensquarebullet) return \"enopensquarebullet\";\n\tif (k == XK_openrectbullet) return \"openrectbullet\";\n\tif (k == XK_opentribulletup) return \"opentribulletup\";\n\tif (k == XK_opentribulletdown) return \"opentribulletdown\";\n\tif (k == XK_openstar) return \"openstar\";\n\tif (k == XK_enfilledcircbullet) return \"enfilledcircbullet\";\n\tif (k == XK_enfilledsqbullet) return \"enfilledsqbullet\";\n\tif (k == XK_filledtribulletup) return \"filledtribulletup\";\n\tif (k == XK_filledtribulletdown) return \"filledtribulletdown\";\n\tif (k == XK_leftpointer) return \"leftpointer\";\n\tif (k == XK_rightpointer) return \"rightpointer\";\n\tif (k == XK_club) return \"club\";\n\tif (k == XK_diamond) return \"diamond\";\n\tif (k == XK_heart) return \"heart\";\n\tif (k == XK_maltesecross) return \"maltesecross\";\n\tif (k == XK_dagger) return \"dagger\";\n\tif (k == XK_doubledagger) return \"doubledagger\";\n\tif (k == XK_checkmark) return \"checkmark\";\n\tif (k == XK_ballotcross) return \"ballotcross\";\n\tif (k == XK_musicalsharp) return \"musicalsharp\";\n\tif (k == XK_musicalflat) return \"musicalflat\";\n\tif (k == XK_malesymbol) return \"malesymbol\";\n\tif (k == XK_femalesymbol) return \"femalesymbol\";\n\tif (k == XK_telephone) return \"telephone\";\n\tif (k == XK_telephonerecorder) return \"telephonerecorder\";\n\tif (k == XK_phonographcopyright) return \"phonographcopyright\";\n\tif (k == XK_caret) return \"caret\";\n\tif (k == XK_singlelowquotemark) return \"singlelowquotemark\";\n\tif (k == XK_doublelowquotemark) return \"doublelowquotemark\";\n\tif (k == XK_cursor) return \"cursor\";\n#endif /* XK_PUBLISHING */\n#ifdef XK_APL\n\tif (k == XK_leftcaret) return \"leftcaret\";\n\tif (k == XK_rightcaret) return \"rightcaret\";\n\tif (k == XK_downcaret) return \"downcaret\";\n\tif (k == XK_upcaret) return \"upcaret\";\n\tif (k == XK_overbar) return \"overbar\";\n\tif (k == XK_downtack) return \"downtack\";\n\tif (k == XK_upshoe) return \"upshoe\";\n\tif (k == XK_downstile) return \"downstile\";\n\tif (k == XK_underbar) return \"underbar\";\n\tif (k == XK_jot) return \"jot\";\n\tif (k == XK_quad) return \"quad\";\n\tif (k == XK_uptack) return \"uptack\";\n\tif (k == XK_circle) return \"circle\";\n\tif (k == XK_upstile) return \"upstile\";\n\tif (k == XK_downshoe) return \"downshoe\";\n\tif (k == XK_rightshoe) return \"rightshoe\";\n\tif (k == XK_leftshoe) return \"leftshoe\";\n\tif (k == XK_lefttack) return \"lefttack\";\n\tif (k == XK_righttack) return \"righttack\";\n#endif /* XK_APL */\n#ifdef XK_HEBREW\n\tif (k == XK_hebrew_doublelowline) return \"hebrew_doublelowline\";\n\tif (k == XK_hebrew_aleph) return \"hebrew_aleph\";\n\tif (k == XK_hebrew_bet) return \"hebrew_bet\";\n\tif (k == XK_hebrew_beth) return \"hebrew_beth\";\n\tif (k == XK_hebrew_gimel) return \"hebrew_gimel\";\n\tif (k == XK_hebrew_gimmel) return \"hebrew_gimmel\";\n\tif (k == XK_hebrew_dalet) return \"hebrew_dalet\";\n\tif (k == XK_hebrew_daleth) return \"hebrew_daleth\";\n\tif (k == XK_hebrew_he) return \"hebrew_he\";\n\tif (k == XK_hebrew_waw) return \"hebrew_waw\";\n\tif (k == XK_hebrew_zain) return \"hebrew_zain\";\n\tif (k == XK_hebrew_zayin) return \"hebrew_zayin\";\n\tif (k == XK_hebrew_chet) return \"hebrew_chet\";\n\tif (k == XK_hebrew_het) return \"hebrew_het\";\n\tif (k == XK_hebrew_tet) return \"hebrew_tet\";\n\tif (k == XK_hebrew_teth) return \"hebrew_teth\";\n\tif (k == XK_hebrew_yod) return \"hebrew_yod\";\n\tif (k == XK_hebrew_finalkaph) return \"hebrew_finalkaph\";\n\tif (k == XK_hebrew_kaph) return \"hebrew_kaph\";\n\tif (k == XK_hebrew_lamed) return \"hebrew_lamed\";\n\tif (k == XK_hebrew_finalmem) return \"hebrew_finalmem\";\n\tif (k == XK_hebrew_mem) return \"hebrew_mem\";\n\tif (k == XK_hebrew_finalnun) return \"hebrew_finalnun\";\n\tif (k == XK_hebrew_nun) return \"hebrew_nun\";\n\tif (k == XK_hebrew_samech) return \"hebrew_samech\";\n\tif (k == XK_hebrew_samekh) return \"hebrew_samekh\";\n\tif (k == XK_hebrew_ayin) return \"hebrew_ayin\";\n\tif (k == XK_hebrew_finalpe) return \"hebrew_finalpe\";\n\tif (k == XK_hebrew_pe) return \"hebrew_pe\";\n\tif (k == XK_hebrew_finalzade) return \"hebrew_finalzade\";\n\tif (k == XK_hebrew_finalzadi) return \"hebrew_finalzadi\";\n\tif (k == XK_hebrew_zade) return \"hebrew_zade\";\n\tif (k == XK_hebrew_zadi) return \"hebrew_zadi\";\n\tif (k == XK_hebrew_qoph) return \"hebrew_qoph\";\n\tif (k == XK_hebrew_kuf) return \"hebrew_kuf\";\n\tif (k == XK_hebrew_resh) return \"hebrew_resh\";\n\tif (k == XK_hebrew_shin) return \"hebrew_shin\";\n\tif (k == XK_hebrew_taw) return \"hebrew_taw\";\n\tif (k == XK_hebrew_taf) return \"hebrew_taf\";\n\tif (k == XK_Hebrew_switch) return \"Hebrew_switch\";\n#endif /* XK_HEBREW */\n#ifdef XK_THAI\n\tif (k == XK_Thai_kokai) return \"Thai_kokai\";\n\tif (k == XK_Thai_khokhai) return \"Thai_khokhai\";\n\tif (k == XK_Thai_khokhuat) return \"Thai_khokhuat\";\n\tif (k == XK_Thai_khokhwai) return \"Thai_khokhwai\";\n\tif (k == XK_Thai_khokhon) return \"Thai_khokhon\";\n\tif (k == XK_Thai_khorakhang) return \"Thai_khorakhang\";\n\tif (k == XK_Thai_ngongu) return \"Thai_ngongu\";\n\tif (k == XK_Thai_chochan) return \"Thai_chochan\";\n\tif (k == XK_Thai_choching) return \"Thai_choching\";\n\tif (k == XK_Thai_chochang) return \"Thai_chochang\";\n\tif (k == XK_Thai_soso) return \"Thai_soso\";\n\tif (k == XK_Thai_chochoe) return \"Thai_chochoe\";\n\tif (k == XK_Thai_yoying) return \"Thai_yoying\";\n\tif (k == XK_Thai_dochada) return \"Thai_dochada\";\n\tif (k == XK_Thai_topatak) return \"Thai_topatak\";\n\tif (k == XK_Thai_thothan) return \"Thai_thothan\";\n\tif (k == XK_Thai_thonangmontho) return \"Thai_thonangmontho\";\n\tif (k == XK_Thai_thophuthao) return \"Thai_thophuthao\";\n\tif (k == XK_Thai_nonen) return \"Thai_nonen\";\n\tif (k == XK_Thai_dodek) return \"Thai_dodek\";\n\tif (k == XK_Thai_totao) return \"Thai_totao\";\n\tif (k == XK_Thai_thothung) return \"Thai_thothung\";\n\tif (k == XK_Thai_thothahan) return \"Thai_thothahan\";\n\tif (k == XK_Thai_thothong) return \"Thai_thothong\";\n\tif (k == XK_Thai_nonu) return \"Thai_nonu\";\n\tif (k == XK_Thai_bobaimai) return \"Thai_bobaimai\";\n\tif (k == XK_Thai_popla) return \"Thai_popla\";\n\tif (k == XK_Thai_phophung) return \"Thai_phophung\";\n\tif (k == XK_Thai_fofa) return \"Thai_fofa\";\n\tif (k == XK_Thai_phophan) return \"Thai_phophan\";\n\tif (k == XK_Thai_fofan) return \"Thai_fofan\";\n\tif (k == XK_Thai_phosamphao) return \"Thai_phosamphao\";\n\tif (k == XK_Thai_moma) return \"Thai_moma\";\n\tif (k == XK_Thai_yoyak) return \"Thai_yoyak\";\n\tif (k == XK_Thai_rorua) return \"Thai_rorua\";\n\tif (k == XK_Thai_ru) return \"Thai_ru\";\n\tif (k == XK_Thai_loling) return \"Thai_loling\";\n\tif (k == XK_Thai_lu) return \"Thai_lu\";\n\tif (k == XK_Thai_wowaen) return \"Thai_wowaen\";\n\tif (k == XK_Thai_sosala) return \"Thai_sosala\";\n\tif (k == XK_Thai_sorusi) return \"Thai_sorusi\";\n\tif (k == XK_Thai_sosua) return \"Thai_sosua\";\n\tif (k == XK_Thai_hohip) return \"Thai_hohip\";\n\tif (k == XK_Thai_lochula) return \"Thai_lochula\";\n\tif (k == XK_Thai_oang) return \"Thai_oang\";\n\tif (k == XK_Thai_honokhuk) return \"Thai_honokhuk\";\n\tif (k == XK_Thai_paiyannoi) return \"Thai_paiyannoi\";\n\tif (k == XK_Thai_saraa) return \"Thai_saraa\";\n\tif (k == XK_Thai_maihanakat) return \"Thai_maihanakat\";\n\tif (k == XK_Thai_saraaa) return \"Thai_saraaa\";\n\tif (k == XK_Thai_saraam) return \"Thai_saraam\";\n\tif (k == XK_Thai_sarai) return \"Thai_sarai\";\n\tif (k == XK_Thai_saraii) return \"Thai_saraii\";\n\tif (k == XK_Thai_saraue) return \"Thai_saraue\";\n\tif (k == XK_Thai_sarauee) return \"Thai_sarauee\";\n\tif (k == XK_Thai_sarau) return \"Thai_sarau\";\n\tif (k == XK_Thai_sarauu) return \"Thai_sarauu\";\n\tif (k == XK_Thai_phinthu) return \"Thai_phinthu\";\n\tif (k == XK_Thai_maihanakat_maitho) return \"Thai_maihanakat_maitho\";\n\tif (k == XK_Thai_baht) return \"Thai_baht\";\n\tif (k == XK_Thai_sarae) return \"Thai_sarae\";\n\tif (k == XK_Thai_saraae) return \"Thai_saraae\";\n\tif (k == XK_Thai_sarao) return \"Thai_sarao\";\n\tif (k == XK_Thai_saraaimaimuan) return \"Thai_saraaimaimuan\";\n\tif (k == XK_Thai_saraaimaimalai) return \"Thai_saraaimaimalai\";\n\tif (k == XK_Thai_lakkhangyao) return \"Thai_lakkhangyao\";\n\tif (k == XK_Thai_maiyamok) return \"Thai_maiyamok\";\n\tif (k == XK_Thai_maitaikhu) return \"Thai_maitaikhu\";\n\tif (k == XK_Thai_maiek) return \"Thai_maiek\";\n\tif (k == XK_Thai_maitho) return \"Thai_maitho\";\n\tif (k == XK_Thai_maitri) return \"Thai_maitri\";\n\tif (k == XK_Thai_maichattawa) return \"Thai_maichattawa\";\n\tif (k == XK_Thai_thanthakhat) return \"Thai_thanthakhat\";\n\tif (k == XK_Thai_nikhahit) return \"Thai_nikhahit\";\n\tif (k == XK_Thai_leksun) return \"Thai_leksun\";\n\tif (k == XK_Thai_leknung) return \"Thai_leknung\";\n\tif (k == XK_Thai_leksong) return \"Thai_leksong\";\n\tif (k == XK_Thai_leksam) return \"Thai_leksam\";\n\tif (k == XK_Thai_leksi) return \"Thai_leksi\";\n\tif (k == XK_Thai_lekha) return \"Thai_lekha\";\n\tif (k == XK_Thai_lekhok) return \"Thai_lekhok\";\n\tif (k == XK_Thai_lekchet) return \"Thai_lekchet\";\n\tif (k == XK_Thai_lekpaet) return \"Thai_lekpaet\";\n\tif (k == XK_Thai_lekkao) return \"Thai_lekkao\";\n#endif /* XK_THAI */\n#ifdef XK_KOREAN\n\tif (k == XK_Hangul) return \"Hangul\";\n\tif (k == XK_Hangul_Start) return \"Hangul_Start\";\n\tif (k == XK_Hangul_End) return \"Hangul_End\";\n\tif (k == XK_Hangul_Hanja) return \"Hangul_Hanja\";\n\tif (k == XK_Hangul_Jamo) return \"Hangul_Jamo\";\n\tif (k == XK_Hangul_Romaja) return \"Hangul_Romaja\";\n\tif (k == XK_Hangul_Codeinput) return \"Hangul_Codeinput\";\n\tif (k == XK_Hangul_Jeonja) return \"Hangul_Jeonja\";\n\tif (k == XK_Hangul_Banja) return \"Hangul_Banja\";\n\tif (k == XK_Hangul_PreHanja) return \"Hangul_PreHanja\";\n\tif (k == XK_Hangul_PostHanja) return \"Hangul_PostHanja\";\n\tif (k == XK_Hangul_SingleCandidate) return \"Hangul_SingleCandidate\";\n\tif (k == XK_Hangul_MultipleCandidate) return \"Hangul_MultipleCandidate\";\n\tif (k == XK_Hangul_PreviousCandidate) return \"Hangul_PreviousCandidate\";\n\tif (k == XK_Hangul_Special) return \"Hangul_Special\";\n\tif (k == XK_Hangul_switch) return \"Hangul_switch\";\n\tif (k == XK_Hangul_Kiyeog) return \"Hangul_Kiyeog\";\n\tif (k == XK_Hangul_SsangKiyeog) return \"Hangul_SsangKiyeog\";\n\tif (k == XK_Hangul_KiyeogSios) return \"Hangul_KiyeogSios\";\n\tif (k == XK_Hangul_Nieun) return \"Hangul_Nieun\";\n\tif (k == XK_Hangul_NieunJieuj) return \"Hangul_NieunJieuj\";\n\tif (k == XK_Hangul_NieunHieuh) return \"Hangul_NieunHieuh\";\n\tif (k == XK_Hangul_Dikeud) return \"Hangul_Dikeud\";\n\tif (k == XK_Hangul_SsangDikeud) return \"Hangul_SsangDikeud\";\n\tif (k == XK_Hangul_Rieul) return \"Hangul_Rieul\";\n\tif (k == XK_Hangul_RieulKiyeog) return \"Hangul_RieulKiyeog\";\n\tif (k == XK_Hangul_RieulMieum) return \"Hangul_RieulMieum\";\n\tif (k == XK_Hangul_RieulPieub) return \"Hangul_RieulPieub\";\n\tif (k == XK_Hangul_RieulSios) return \"Hangul_RieulSios\";\n\tif (k == XK_Hangul_RieulTieut) return \"Hangul_RieulTieut\";\n\tif (k == XK_Hangul_RieulPhieuf) return \"Hangul_RieulPhieuf\";\n\tif (k == XK_Hangul_RieulHieuh) return \"Hangul_RieulHieuh\";\n\tif (k == XK_Hangul_Mieum) return \"Hangul_Mieum\";\n\tif (k == XK_Hangul_Pieub) return \"Hangul_Pieub\";\n\tif (k == XK_Hangul_SsangPieub) return \"Hangul_SsangPieub\";\n\tif (k == XK_Hangul_PieubSios) return \"Hangul_PieubSios\";\n\tif (k == XK_Hangul_Sios) return \"Hangul_Sios\";\n\tif (k == XK_Hangul_SsangSios) return \"Hangul_SsangSios\";\n\tif (k == XK_Hangul_Ieung) return \"Hangul_Ieung\";\n\tif (k == XK_Hangul_Jieuj) return \"Hangul_Jieuj\";\n\tif (k == XK_Hangul_SsangJieuj) return \"Hangul_SsangJieuj\";\n\tif (k == XK_Hangul_Cieuc) return \"Hangul_Cieuc\";\n\tif (k == XK_Hangul_Khieuq) return \"Hangul_Khieuq\";\n\tif (k == XK_Hangul_Tieut) return \"Hangul_Tieut\";\n\tif (k == XK_Hangul_Phieuf) return \"Hangul_Phieuf\";\n\tif (k == XK_Hangul_Hieuh) return \"Hangul_Hieuh\";\n\tif (k == XK_Hangul_A) return \"Hangul_A\";\n\tif (k == XK_Hangul_AE) return \"Hangul_AE\";\n\tif (k == XK_Hangul_YA) return \"Hangul_YA\";\n\tif (k == XK_Hangul_YAE) return \"Hangul_YAE\";\n\tif (k == XK_Hangul_EO) return \"Hangul_EO\";\n\tif (k == XK_Hangul_E) return \"Hangul_E\";\n\tif (k == XK_Hangul_YEO) return \"Hangul_YEO\";\n\tif (k == XK_Hangul_YE) return \"Hangul_YE\";\n\tif (k == XK_Hangul_O) return \"Hangul_O\";\n\tif (k == XK_Hangul_WA) return \"Hangul_WA\";\n\tif (k == XK_Hangul_WAE) return \"Hangul_WAE\";\n\tif (k == XK_Hangul_OE) return \"Hangul_OE\";\n\tif (k == XK_Hangul_YO) return \"Hangul_YO\";\n\tif (k == XK_Hangul_U) return \"Hangul_U\";\n\tif (k == XK_Hangul_WEO) return \"Hangul_WEO\";\n\tif (k == XK_Hangul_WE) return \"Hangul_WE\";\n\tif (k == XK_Hangul_WI) return \"Hangul_WI\";\n\tif (k == XK_Hangul_YU) return \"Hangul_YU\";\n\tif (k == XK_Hangul_EU) return \"Hangul_EU\";\n\tif (k == XK_Hangul_YI) return \"Hangul_YI\";\n\tif (k == XK_Hangul_I) return \"Hangul_I\";\n\tif (k == XK_Hangul_J_Kiyeog) return \"Hangul_J_Kiyeog\";\n\tif (k == XK_Hangul_J_SsangKiyeog) return \"Hangul_J_SsangKiyeog\";\n\tif (k == XK_Hangul_J_KiyeogSios) return \"Hangul_J_KiyeogSios\";\n\tif (k == XK_Hangul_J_Nieun) return \"Hangul_J_Nieun\";\n\tif (k == XK_Hangul_J_NieunJieuj) return \"Hangul_J_NieunJieuj\";\n\tif (k == XK_Hangul_J_NieunHieuh) return \"Hangul_J_NieunHieuh\";\n\tif (k == XK_Hangul_J_Dikeud) return \"Hangul_J_Dikeud\";\n\tif (k == XK_Hangul_J_Rieul) return \"Hangul_J_Rieul\";\n\tif (k == XK_Hangul_J_RieulKiyeog) return \"Hangul_J_RieulKiyeog\";\n\tif (k == XK_Hangul_J_RieulMieum) return \"Hangul_J_RieulMieum\";\n\tif (k == XK_Hangul_J_RieulPieub) return \"Hangul_J_RieulPieub\";\n\tif (k == XK_Hangul_J_RieulSios) return \"Hangul_J_RieulSios\";\n\tif (k == XK_Hangul_J_RieulTieut) return \"Hangul_J_RieulTieut\";\n\tif (k == XK_Hangul_J_RieulPhieuf) return \"Hangul_J_RieulPhieuf\";\n\tif (k == XK_Hangul_J_RieulHieuh) return \"Hangul_J_RieulHieuh\";\n\tif (k == XK_Hangul_J_Mieum) return \"Hangul_J_Mieum\";\n\tif (k == XK_Hangul_J_Pieub) return \"Hangul_J_Pieub\";\n\tif (k == XK_Hangul_J_PieubSios) return \"Hangul_J_PieubSios\";\n\tif (k == XK_Hangul_J_Sios) return \"Hangul_J_Sios\";\n\tif (k == XK_Hangul_J_SsangSios) return \"Hangul_J_SsangSios\";\n\tif (k == XK_Hangul_J_Ieung) return \"Hangul_J_Ieung\";\n\tif (k == XK_Hangul_J_Jieuj) return \"Hangul_J_Jieuj\";\n\tif (k == XK_Hangul_J_Cieuc) return \"Hangul_J_Cieuc\";\n\tif (k == XK_Hangul_J_Khieuq) return \"Hangul_J_Khieuq\";\n\tif (k == XK_Hangul_J_Tieut) return \"Hangul_J_Tieut\";\n\tif (k == XK_Hangul_J_Phieuf) return \"Hangul_J_Phieuf\";\n\tif (k == XK_Hangul_J_Hieuh) return \"Hangul_J_Hieuh\";\n\tif (k == XK_Hangul_RieulYeorinHieuh) return \"Hangul_RieulYeorinHieuh\";\n\tif (k == XK_Hangul_SunkyeongeumMieum) return \"Hangul_SunkyeongeumMieum\";\n\tif (k == XK_Hangul_SunkyeongeumPieub) return \"Hangul_SunkyeongeumPieub\";\n\tif (k == XK_Hangul_PanSios) return \"Hangul_PanSios\";\n\tif (k == XK_Hangul_KkogjiDalrinIeung) return \"Hangul_KkogjiDalrinIeung\";\n\tif (k == XK_Hangul_SunkyeongeumPhieuf) return \"Hangul_SunkyeongeumPhieuf\";\n\tif (k == XK_Hangul_YeorinHieuh) return \"Hangul_YeorinHieuh\";\n\tif (k == XK_Hangul_AraeA) return \"Hangul_AraeA\";\n\tif (k == XK_Hangul_AraeAE) return \"Hangul_AraeAE\";\n\tif (k == XK_Hangul_J_PanSios) return \"Hangul_J_PanSios\";\n\tif (k == XK_Hangul_J_KkogjiDalrinIeung) return \"Hangul_J_KkogjiDalrinIeung\";\n\tif (k == XK_Hangul_J_YeorinHieuh) return \"Hangul_J_YeorinHieuh\";\n\tif (k == XK_Korean_Won) return \"Korean_Won\";\n#endif /* XK_KOREAN */\n\tif (k == XK_EuroSign) return \"EuroSign\";\n#endif\n\treturn NULL;\t\n}"
        }
      },
      {
        "call_info": {
          "callee": "XKeycodeToKeysym_wr",
          "args": [
            "dpy",
            "key",
            "0"
          ],
          "line": 946
        },
        "resolved": true,
        "details": {
          "function_name": "XKeycodeToKeysym_wr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "1699-1709",
          "snippet": "KeySym XKeycodeToKeysym_wr(Display *display, KeyCode keycode, int index) {\n#if NO_X11\n\treturn 0;\n#else\n#if !HAVE_XKEYBOARD || SKIP_XKB\n\treturn XKeycodeToKeysym(display, keycode, index);\n#else\n\treturn XkbKeycodeToKeysym(display, keycode, 0, index);\n#endif\n#endif\n}",
          "includes": [
            "#include \"nox11_funcs.h\"",
            "#include \"xwrappers.h\"",
            "#include \"xi2_devices.h\"",
            "#include \"macosx.h\"",
            "#include \"cleanup.h\"",
            "#include \"connections.h\"",
            "#include \"xevents.h\"",
            "#include \"keyboard.h\"",
            "#include \"xrecord.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int XCloseDisplay_wr(Display *display);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint XCloseDisplay_wr(Display *display);\n\nKeySym XKeycodeToKeysym_wr(Display *display, KeyCode keycode, int index) {\n#if NO_X11\n\treturn 0;\n#else\n#if !HAVE_XKEYBOARD || SKIP_XKB\n\treturn XKeycodeToKeysym(display, keycode, index);\n#else\n\treturn XkbKeycodeToKeysym(display, keycode, 0, index);\n#endif\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "nox11_exit",
          "args": [
            "1"
          ],
          "line": 941
        },
        "resolved": true,
        "details": {
          "function_name": "nox11_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "1711-1718",
          "snippet": "void nox11_exit(int rc) {\n#if NO_X11\n\trfbLog(\"This x11vnc was not built with X11 support.\\n\");\n\tclean_up_exit(rc);\n#else\n\tif (0) {rc = 0;}\n#endif\n}",
          "includes": [
            "#include \"nox11_funcs.h\"",
            "#include \"xwrappers.h\"",
            "#include \"xi2_devices.h\"",
            "#include \"macosx.h\"",
            "#include \"cleanup.h\"",
            "#include \"connections.h\"",
            "#include \"xevents.h\"",
            "#include \"keyboard.h\"",
            "#include \"xrecord.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nvoid nox11_exit(int rc) {\n#if NO_X11\n\trfbLog(\"This x11vnc was not built with X11 support.\\n\");\n\tclean_up_exit(rc);\n#else\n\tif (0) {rc = 0;}\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint xtest_present = 0;\nint keycode_state[256];\nvoid init_track_keycode_state(void);\nvoid XTRAP_FakeKeyEvent_wr(Display* dpy, KeyCode key, Bool down,\n    unsigned long delay);\nvoid XTestFakeKeyEvent_wr(Display* dpy, int dev_id, KeyCode key, Bool down,\n    unsigned long delay);\nvoid XTRAP_FakeButtonEvent_wr(Display* dpy, unsigned int button, Bool is_press,\n    unsigned long delay);\nvoid XTestFakeButtonEvent_wr(Display* dpy, int dev_id, unsigned int button, Bool is_press,\n    unsigned long delay);\nvoid XTRAP_FakeMotionEvent_wr(Display* dpy, int screen, int x, int y,\n    unsigned long delay);\nvoid XTestFakeMotionEvent_wr(Display* dpy, int dev_id, int screen, int x, int y,\n    unsigned long delay);\nvoid XTestDiscard_wr(Display *dpy);\nstatic void upup_downdown_warning(KeyCode key, Bool down);\n\nvoid XTestFakeKeyEvent_wr(Display* dpy, int dev_id, KeyCode key, Bool down,\n    unsigned long delay) {\n\tstatic int first = 1;\n\tint regrab = 0;\n\n\tRAWFB_RET_VOID\n\n#if NO_X11\n\tnox11_exit(1);\n\tif (!dpy || !key || !down || !delay || !first) {}\n\treturn;\n#else\n\tif (debug_keyboard) {\n\t\tchar *str = XKeysymToString(XKeycodeToKeysym_wr(dpy, key, 0));\n\t\trfbLog(\"XTestFakeKeyEvent(dpy, keycode=0x%x \\\"%s\\\", %s)\\n\",\n\t\t    key, str ? str : \"null\", down ? \"down\":\"up\");\n\t}\n\tif (first) { \n\t\tinit_track_keycode_state();\n\t\tfirst = 0;\n\t}\n\tif (down) {\n\t\tlast_keyboard_keycode = -key;\n\t} else {\n\t\tlast_keyboard_keycode = key;\n\t}\n\n\tif (grab_kbd) {\n\t\tXUngrabKeyboard(dpy, CurrentTime);\n\t\tregrab = 1;\n\t}\n\tif (grab_ptr && ungrab_both) {\n\t\tXUngrabPointer(dpy, CurrentTime);\n\t\tregrab = 1;\n\t}\n\n\tif (xtrap_input) {\n\t\tXTRAP_FakeKeyEvent_wr(dpy, key, down, delay);\n\t\tif (regrab) {\n\t\t\tadjust_grabs(1, 1);\n\t\t}\n\t\treturn;\n\t}\n\n\tif (! xtest_present) {\n\t\tDEBUG_SKIPPED_INPUT(debug_keyboard, \"keyboard: no-XTEST\");\n\t\treturn;\n\t}\n\tif (debug_keyboard) {\n\t\trfbLog(\"calling XTestFakeKeyEvent(%d, %d)  %.4f\\n\",\n\t\t    key, down, dnowx());\t\n\t}\n#if HAVE_XTEST\n#ifdef HAVE_XI2\n    if(use_multipointer && dev_id >= 0)\n      {\n        XErrorHandler old_handler;\n\tXDevice xdev;\n        xdev.device_id = dev_id;\n\n        /* there can be a race condition where this is called when the XI2 device has not yet been created */\n        old_handler = XSetErrorHandler(trap_xerror);\n        trapped_xerror = 0;\n\n\tXTestFakeDeviceKeyEvent(dpy, &xdev, key, down, NULL, 0, delay);        \n\n        XSetErrorHandler(old_handler);\n        if (trapped_xerror) \n          trapped_xerror = 0;\n      }\n    else\n#endif\n        XTestFakeKeyEvent(dpy, key, down, delay);\n\n\tif (regrab) {\n\t\tadjust_grabs(1, 1);\n\t}\n\tif (debug_keyboard) {\n\t\tupup_downdown_warning(key, down);\n\t}\n\tkeycode_state[(int) key] = down ? 1 : 0;\n#endif\n\n#endif\t/* NO_X11 */\n}"
  },
  {
    "function_name": "XTRAP_FakeKeyEvent_wr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "902-931",
    "snippet": "void XTRAP_FakeKeyEvent_wr(Display* dpy, KeyCode key, Bool down,\n    unsigned long delay) {\n\n\tRAWFB_RET_VOID\n#if NO_X11\n\tnox11_exit(1);\n\tif (!dpy || !key || !down || !delay) {}\n\treturn;\n#else\n\n\tif (! xtrap_present) {\n\t\tDEBUG_SKIPPED_INPUT(debug_keyboard, \"keyboard: no-XTRAP\");\n\t\treturn;\n\t}\n\t/* unused vars warning: */\n\tif (key || down || delay) {}\n\n# if HAVE_LIBXTRAP\n\tXESimulateXEventRequest(trap_ctx, down ? KeyPress : KeyRelease,\n\t    key, 0, 0, 0);\n\tif (debug_keyboard) {\n\t\tupup_downdown_warning(key, down);\n\t}\n\tkeycode_state[(int) key] = down ? 1 : 0;\n# else\n\tDEBUG_SKIPPED_INPUT(debug_keyboard, \"keyboard: no-XTRAP-build\");\n# endif\n\n#endif\t/* NO_X11 */\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int xtrap_present = 0;",
      "int keycode_state[256];",
      "void XTRAP_FakeKeyEvent_wr(Display* dpy, KeyCode key, Bool down,\n    unsigned long delay);",
      "void XTestFakeKeyEvent_wr(Display* dpy, int dev_id, KeyCode key, Bool down,\n    unsigned long delay);",
      "void XTRAP_FakeButtonEvent_wr(Display* dpy, unsigned int button, Bool is_press,\n    unsigned long delay);",
      "void XTestFakeButtonEvent_wr(Display* dpy, int dev_id, unsigned int button, Bool is_press,\n    unsigned long delay);",
      "void XTRAP_FakeMotionEvent_wr(Display* dpy, int screen, int x, int y,\n    unsigned long delay);",
      "void XTestFakeMotionEvent_wr(Display* dpy, int dev_id, int screen, int x, int y,\n    unsigned long delay);",
      "void XTestDiscard_wr(Display *dpy);",
      "static void upup_downdown_warning(KeyCode key, Bool down);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "DEBUG_SKIPPED_INPUT",
          "args": [
            "debug_keyboard",
            "\"keyboard: no-XTRAP-build\""
          ],
          "line": 927
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "upup_downdown_warning",
          "args": [
            "key",
            "down"
          ],
          "line": 923
        },
        "resolved": true,
        "details": {
          "function_name": "upup_downdown_warning",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "883-895",
          "snippet": "static void upup_downdown_warning(KeyCode key, Bool down) {\n\tRAWFB_RET_VOID\n#if NO_X11\n\tif (!key || !down) {}\n\treturn;\n#else\n\tif ((down ? 1:0) == keycode_state[(int) key]) {\n\t\tchar *str = XKeysymToString(XKeycodeToKeysym_wr(dpy, key, 0));\n\t\trfbLog(\"XTestFakeKeyEvent: keycode=0x%x \\\"%s\\\" is *already* \"\n\t\t    \"%s\\n\", key, str ? str : \"null\", down ? \"down\":\"up\");\n\t}\n#endif\t/* NO_X11 */\n}",
          "includes": [
            "#include \"nox11_funcs.h\"",
            "#include \"xwrappers.h\"",
            "#include \"xi2_devices.h\"",
            "#include \"macosx.h\"",
            "#include \"cleanup.h\"",
            "#include \"connections.h\"",
            "#include \"xevents.h\"",
            "#include \"keyboard.h\"",
            "#include \"xrecord.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int keycode_state[256];",
            "void XTestDiscard_wr(Display *dpy);",
            "static void upup_downdown_warning(KeyCode key, Bool down);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint keycode_state[256];\nvoid XTestDiscard_wr(Display *dpy);\nstatic void upup_downdown_warning(KeyCode key, Bool down);\n\nstatic void upup_downdown_warning(KeyCode key, Bool down) {\n\tRAWFB_RET_VOID\n#if NO_X11\n\tif (!key || !down) {}\n\treturn;\n#else\n\tif ((down ? 1:0) == keycode_state[(int) key]) {\n\t\tchar *str = XKeysymToString(XKeycodeToKeysym_wr(dpy, key, 0));\n\t\trfbLog(\"XTestFakeKeyEvent: keycode=0x%x \\\"%s\\\" is *already* \"\n\t\t    \"%s\\n\", key, str ? str : \"null\", down ? \"down\":\"up\");\n\t}\n#endif\t/* NO_X11 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "XESimulateXEventRequest",
          "args": [
            "trap_ctx",
            "down ? KeyPress : KeyRelease",
            "key",
            "0",
            "0",
            "0"
          ],
          "line": 920
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DEBUG_SKIPPED_INPUT",
          "args": [
            "debug_keyboard",
            "\"keyboard: no-XTRAP\""
          ],
          "line": 913
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nox11_exit",
          "args": [
            "1"
          ],
          "line": 907
        },
        "resolved": true,
        "details": {
          "function_name": "nox11_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "1711-1718",
          "snippet": "void nox11_exit(int rc) {\n#if NO_X11\n\trfbLog(\"This x11vnc was not built with X11 support.\\n\");\n\tclean_up_exit(rc);\n#else\n\tif (0) {rc = 0;}\n#endif\n}",
          "includes": [
            "#include \"nox11_funcs.h\"",
            "#include \"xwrappers.h\"",
            "#include \"xi2_devices.h\"",
            "#include \"macosx.h\"",
            "#include \"cleanup.h\"",
            "#include \"connections.h\"",
            "#include \"xevents.h\"",
            "#include \"keyboard.h\"",
            "#include \"xrecord.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nvoid nox11_exit(int rc) {\n#if NO_X11\n\trfbLog(\"This x11vnc was not built with X11 support.\\n\");\n\tclean_up_exit(rc);\n#else\n\tif (0) {rc = 0;}\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint xtrap_present = 0;\nint keycode_state[256];\nvoid XTRAP_FakeKeyEvent_wr(Display* dpy, KeyCode key, Bool down,\n    unsigned long delay);\nvoid XTestFakeKeyEvent_wr(Display* dpy, int dev_id, KeyCode key, Bool down,\n    unsigned long delay);\nvoid XTRAP_FakeButtonEvent_wr(Display* dpy, unsigned int button, Bool is_press,\n    unsigned long delay);\nvoid XTestFakeButtonEvent_wr(Display* dpy, int dev_id, unsigned int button, Bool is_press,\n    unsigned long delay);\nvoid XTRAP_FakeMotionEvent_wr(Display* dpy, int screen, int x, int y,\n    unsigned long delay);\nvoid XTestFakeMotionEvent_wr(Display* dpy, int dev_id, int screen, int x, int y,\n    unsigned long delay);\nvoid XTestDiscard_wr(Display *dpy);\nstatic void upup_downdown_warning(KeyCode key, Bool down);\n\nvoid XTRAP_FakeKeyEvent_wr(Display* dpy, KeyCode key, Bool down,\n    unsigned long delay) {\n\n\tRAWFB_RET_VOID\n#if NO_X11\n\tnox11_exit(1);\n\tif (!dpy || !key || !down || !delay) {}\n\treturn;\n#else\n\n\tif (! xtrap_present) {\n\t\tDEBUG_SKIPPED_INPUT(debug_keyboard, \"keyboard: no-XTRAP\");\n\t\treturn;\n\t}\n\t/* unused vars warning: */\n\tif (key || down || delay) {}\n\n# if HAVE_LIBXTRAP\n\tXESimulateXEventRequest(trap_ctx, down ? KeyPress : KeyRelease,\n\t    key, 0, 0, 0);\n\tif (debug_keyboard) {\n\t\tupup_downdown_warning(key, down);\n\t}\n\tkeycode_state[(int) key] = down ? 1 : 0;\n# else\n\tDEBUG_SKIPPED_INPUT(debug_keyboard, \"keyboard: no-XTRAP-build\");\n# endif\n\n#endif\t/* NO_X11 */\n}"
  },
  {
    "function_name": "upup_downdown_warning",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "883-895",
    "snippet": "static void upup_downdown_warning(KeyCode key, Bool down) {\n\tRAWFB_RET_VOID\n#if NO_X11\n\tif (!key || !down) {}\n\treturn;\n#else\n\tif ((down ? 1:0) == keycode_state[(int) key]) {\n\t\tchar *str = XKeysymToString(XKeycodeToKeysym_wr(dpy, key, 0));\n\t\trfbLog(\"XTestFakeKeyEvent: keycode=0x%x \\\"%s\\\" is *already* \"\n\t\t    \"%s\\n\", key, str ? str : \"null\", down ? \"down\":\"up\");\n\t}\n#endif\t/* NO_X11 */\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int keycode_state[256];",
      "void XTestDiscard_wr(Display *dpy);",
      "static void upup_downdown_warning(KeyCode key, Bool down);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "rfbLog",
          "args": [
            "\"XTestFakeKeyEvent: keycode=0x%x \\\"%s\\\" is *already* \"\n\t\t    \"%s\\n\"",
            "key",
            "str ? str : \"null\"",
            "down ? \"down\":\"up\""
          ],
          "line": 891
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XKeysymToString",
          "args": [
            "XKeycodeToKeysym_wr(dpy, key, 0)"
          ],
          "line": 890
        },
        "resolved": true,
        "details": {
          "function_name": "XKeysymToString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/nox11_funcs.h",
          "lines": "1449-2807",
          "snippet": "char *XKeysymToString(KeySym k) {\n#ifndef XK_0_nosuch\n\tif (k == XK_VoidSymbol) return \"VoidSymbol\";\n#ifdef XK_MISCELLANY\n\tif (k == XK_BackSpace) return \"BackSpace\";\n\tif (k == XK_Tab) return \"Tab\";\n\tif (k == XK_Linefeed) return \"Linefeed\";\n\tif (k == XK_Clear) return \"Clear\";\n\tif (k == XK_Return) return \"Return\";\n\tif (k == XK_Pause) return \"Pause\";\n\tif (k == XK_Scroll_Lock) return \"Scroll_Lock\";\n\tif (k == XK_Sys_Req) return \"Sys_Req\";\n\tif (k == XK_Escape) return \"Escape\";\n\tif (k == XK_Delete) return \"Delete\";\n\tif (k == XK_Multi_key) return \"Multi_key\";\n\tif (k == XK_SingleCandidate) return \"SingleCandidate\";\n\tif (k == XK_MultipleCandidate) return \"MultipleCandidate\";\n\tif (k == XK_PreviousCandidate) return \"PreviousCandidate\";\n\tif (k == XK_Kanji) return \"Kanji\";\n\tif (k == XK_Muhenkan) return \"Muhenkan\";\n\tif (k == XK_Henkan_Mode) return \"Henkan_Mode\";\n\tif (k == XK_Henkan) return \"Henkan\";\n\tif (k == XK_Romaji) return \"Romaji\";\n\tif (k == XK_Hiragana) return \"Hiragana\";\n\tif (k == XK_Katakana) return \"Katakana\";\n\tif (k == XK_Hiragana_Katakana) return \"Hiragana_Katakana\";\n\tif (k == XK_Zenkaku) return \"Zenkaku\";\n\tif (k == XK_Hankaku) return \"Hankaku\";\n\tif (k == XK_Zenkaku_Hankaku) return \"Zenkaku_Hankaku\";\n\tif (k == XK_Touroku) return \"Touroku\";\n\tif (k == XK_Massyo) return \"Massyo\";\n\tif (k == XK_Kana_Lock) return \"Kana_Lock\";\n\tif (k == XK_Kana_Shift) return \"Kana_Shift\";\n\tif (k == XK_Eisu_Shift) return \"Eisu_Shift\";\n\tif (k == XK_Eisu_toggle) return \"Eisu_toggle\";\n\tif (k == XK_Zen_Koho) return \"Zen_Koho\";\n\tif (k == XK_Mae_Koho) return \"Mae_Koho\";\n\tif (k == XK_Home) return \"Home\";\n\tif (k == XK_Left) return \"Left\";\n\tif (k == XK_Up) return \"Up\";\n\tif (k == XK_Right) return \"Right\";\n\tif (k == XK_Down) return \"Down\";\n\tif (k == XK_Prior) return \"Prior\";\n\tif (k == XK_Page_Up) return \"Page_Up\";\n\tif (k == XK_Next) return \"Next\";\n\tif (k == XK_Page_Down) return \"Page_Down\";\n\tif (k == XK_End) return \"End\";\n\tif (k == XK_Begin) return \"Begin\";\n\tif (k == XK_Select) return \"Select\";\n\tif (k == XK_Print) return \"Print\";\n\tif (k == XK_Execute) return \"Execute\";\n\tif (k == XK_Insert) return \"Insert\";\n\tif (k == XK_Undo) return \"Undo\";\n\tif (k == XK_Redo) return \"Redo\";\n\tif (k == XK_Menu) return \"Menu\";\n\tif (k == XK_Find) return \"Find\";\n\tif (k == XK_Cancel) return \"Cancel\";\n\tif (k == XK_Help) return \"Help\";\n\tif (k == XK_Break) return \"Break\";\n\tif (k == XK_Mode_switch) return \"Mode_switch\";\n\tif (k == XK_script_switch) return \"script_switch\";\n\tif (k == XK_Num_Lock) return \"Num_Lock\";\n\tif (k == XK_KP_Space) return \"KP_Space\";\n\tif (k == XK_KP_Tab) return \"KP_Tab\";\n\tif (k == XK_KP_Enter) return \"KP_Enter\";\n\tif (k == XK_KP_F1) return \"KP_F1\";\n\tif (k == XK_KP_F2) return \"KP_F2\";\n\tif (k == XK_KP_F3) return \"KP_F3\";\n\tif (k == XK_KP_F4) return \"KP_F4\";\n\tif (k == XK_KP_Home) return \"KP_Home\";\n\tif (k == XK_KP_Left) return \"KP_Left\";\n\tif (k == XK_KP_Up) return \"KP_Up\";\n\tif (k == XK_KP_Right) return \"KP_Right\";\n\tif (k == XK_KP_Down) return \"KP_Down\";\n\tif (k == XK_KP_Prior) return \"KP_Prior\";\n\tif (k == XK_KP_Page_Up) return \"KP_Page_Up\";\n\tif (k == XK_KP_Next) return \"KP_Next\";\n\tif (k == XK_KP_Page_Down) return \"KP_Page_Down\";\n\tif (k == XK_KP_End) return \"KP_End\";\n\tif (k == XK_KP_Begin) return \"KP_Begin\";\n\tif (k == XK_KP_Insert) return \"KP_Insert\";\n\tif (k == XK_KP_Delete) return \"KP_Delete\";\n\tif (k == XK_KP_Equal) return \"KP_Equal\";\n\tif (k == XK_KP_Multiply) return \"KP_Multiply\";\n\tif (k == XK_KP_Add) return \"KP_Add\";\n\tif (k == XK_KP_Separator) return \"KP_Separator\";\n\tif (k == XK_KP_Subtract) return \"KP_Subtract\";\n\tif (k == XK_KP_Decimal) return \"KP_Decimal\";\n\tif (k == XK_KP_Divide) return \"KP_Divide\";\n\tif (k == XK_KP_0) return \"KP_0\";\n\tif (k == XK_KP_1) return \"KP_1\";\n\tif (k == XK_KP_2) return \"KP_2\";\n\tif (k == XK_KP_3) return \"KP_3\";\n\tif (k == XK_KP_4) return \"KP_4\";\n\tif (k == XK_KP_5) return \"KP_5\";\n\tif (k == XK_KP_6) return \"KP_6\";\n\tif (k == XK_KP_7) return \"KP_7\";\n\tif (k == XK_KP_8) return \"KP_8\";\n\tif (k == XK_KP_9) return \"KP_9\";\n\tif (k == XK_F1) return \"F1\";\n\tif (k == XK_F2) return \"F2\";\n\tif (k == XK_F3) return \"F3\";\n\tif (k == XK_F4) return \"F4\";\n\tif (k == XK_F5) return \"F5\";\n\tif (k == XK_F6) return \"F6\";\n\tif (k == XK_F7) return \"F7\";\n\tif (k == XK_F8) return \"F8\";\n\tif (k == XK_F9) return \"F9\";\n\tif (k == XK_F10) return \"F10\";\n\tif (k == XK_F11) return \"F11\";\n\tif (k == XK_L1) return \"L1\";\n\tif (k == XK_F12) return \"F12\";\n\tif (k == XK_L2) return \"L2\";\n\tif (k == XK_F13) return \"F13\";\n\tif (k == XK_L3) return \"L3\";\n\tif (k == XK_F14) return \"F14\";\n\tif (k == XK_L4) return \"L4\";\n\tif (k == XK_F15) return \"F15\";\n\tif (k == XK_L5) return \"L5\";\n\tif (k == XK_F16) return \"F16\";\n\tif (k == XK_L6) return \"L6\";\n\tif (k == XK_F17) return \"F17\";\n\tif (k == XK_L7) return \"L7\";\n\tif (k == XK_F18) return \"F18\";\n\tif (k == XK_L8) return \"L8\";\n\tif (k == XK_F19) return \"F19\";\n\tif (k == XK_L9) return \"L9\";\n\tif (k == XK_F20) return \"F20\";\n\tif (k == XK_L10) return \"L10\";\n\tif (k == XK_F21) return \"F21\";\n\tif (k == XK_R1) return \"R1\";\n\tif (k == XK_F22) return \"F22\";\n\tif (k == XK_R2) return \"R2\";\n\tif (k == XK_F23) return \"F23\";\n\tif (k == XK_R3) return \"R3\";\n\tif (k == XK_F24) return \"F24\";\n\tif (k == XK_R4) return \"R4\";\n\tif (k == XK_F25) return \"F25\";\n\tif (k == XK_R5) return \"R5\";\n\tif (k == XK_F26) return \"F26\";\n\tif (k == XK_R6) return \"R6\";\n\tif (k == XK_F27) return \"F27\";\n\tif (k == XK_R7) return \"R7\";\n\tif (k == XK_F28) return \"F28\";\n\tif (k == XK_R8) return \"R8\";\n\tif (k == XK_F29) return \"F29\";\n\tif (k == XK_R9) return \"R9\";\n\tif (k == XK_F30) return \"F30\";\n\tif (k == XK_R10) return \"R10\";\n\tif (k == XK_F31) return \"F31\";\n\tif (k == XK_R11) return \"R11\";\n\tif (k == XK_F32) return \"F32\";\n\tif (k == XK_R12) return \"R12\";\n\tif (k == XK_F33) return \"F33\";\n\tif (k == XK_R13) return \"R13\";\n\tif (k == XK_F34) return \"F34\";\n\tif (k == XK_R14) return \"R14\";\n\tif (k == XK_F35) return \"F35\";\n\tif (k == XK_R15) return \"R15\";\n\tif (k == XK_Shift_L) return \"Shift_L\";\n\tif (k == XK_Shift_R) return \"Shift_R\";\n\tif (k == XK_Control_L) return \"Control_L\";\n\tif (k == XK_Control_R) return \"Control_R\";\n\tif (k == XK_Caps_Lock) return \"Caps_Lock\";\n\tif (k == XK_Shift_Lock) return \"Shift_Lock\";\n\tif (k == XK_Meta_L) return \"Meta_L\";\n\tif (k == XK_Meta_R) return \"Meta_R\";\n\tif (k == XK_Alt_L) return \"Alt_L\";\n\tif (k == XK_Alt_R) return \"Alt_R\";\n\tif (k == XK_Super_L) return \"Super_L\";\n\tif (k == XK_Super_R) return \"Super_R\";\n\tif (k == XK_Hyper_L) return \"Hyper_L\";\n\tif (k == XK_Hyper_R) return \"Hyper_R\";\n#endif /* XK_MISCELLANY */\n#ifdef XK_XKB_KEYS\n\tif (k == XK_ISO_Lock) return \"ISO_Lock\";\n\tif (k == XK_ISO_Level2_Latch) return \"ISO_Level2_Latch\";\n\tif (k == XK_ISO_Level3_Shift) return \"ISO_Level3_Shift\";\n\tif (k == XK_ISO_Level3_Latch) return \"ISO_Level3_Latch\";\n\tif (k == XK_ISO_Level3_Lock) return \"ISO_Level3_Lock\";\n\tif (k == XK_ISO_Group_Shift) return \"ISO_Group_Shift\";\n\tif (k == XK_ISO_Group_Latch) return \"ISO_Group_Latch\";\n\tif (k == XK_ISO_Group_Lock) return \"ISO_Group_Lock\";\n\tif (k == XK_ISO_Next_Group) return \"ISO_Next_Group\";\n\tif (k == XK_ISO_Next_Group_Lock) return \"ISO_Next_Group_Lock\";\n\tif (k == XK_ISO_Prev_Group) return \"ISO_Prev_Group\";\n\tif (k == XK_ISO_Prev_Group_Lock) return \"ISO_Prev_Group_Lock\";\n\tif (k == XK_ISO_First_Group) return \"ISO_First_Group\";\n\tif (k == XK_ISO_First_Group_Lock) return \"ISO_First_Group_Lock\";\n\tif (k == XK_ISO_Last_Group) return \"ISO_Last_Group\";\n\tif (k == XK_ISO_Last_Group_Lock) return \"ISO_Last_Group_Lock\";\n\tif (k == XK_ISO_Left_Tab) return \"ISO_Left_Tab\";\n\tif (k == XK_ISO_Move_Line_Up) return \"ISO_Move_Line_Up\";\n\tif (k == XK_ISO_Move_Line_Down) return \"ISO_Move_Line_Down\";\n\tif (k == XK_ISO_Partial_Line_Up) return \"ISO_Partial_Line_Up\";\n\tif (k == XK_ISO_Partial_Line_Down) return \"ISO_Partial_Line_Down\";\n\tif (k == XK_ISO_Partial_Space_Left) return \"ISO_Partial_Space_Left\";\n\tif (k == XK_ISO_Partial_Space_Right) return \"ISO_Partial_Space_Right\";\n\tif (k == XK_ISO_Set_Margin_Left) return \"ISO_Set_Margin_Left\";\n\tif (k == XK_ISO_Set_Margin_Right) return \"ISO_Set_Margin_Right\";\n\tif (k == XK_ISO_Release_Margin_Left) return \"ISO_Release_Margin_Left\";\n\tif (k == XK_ISO_Release_Margin_Right) return \"ISO_Release_Margin_Right\";\n\tif (k == XK_ISO_Release_Both_Margins) return \"ISO_Release_Both_Margins\";\n\tif (k == XK_ISO_Fast_Cursor_Left) return \"ISO_Fast_Cursor_Left\";\n\tif (k == XK_ISO_Fast_Cursor_Right) return \"ISO_Fast_Cursor_Right\";\n\tif (k == XK_ISO_Fast_Cursor_Up) return \"ISO_Fast_Cursor_Up\";\n\tif (k == XK_ISO_Fast_Cursor_Down) return \"ISO_Fast_Cursor_Down\";\n\tif (k == XK_ISO_Continuous_Underline) return \"ISO_Continuous_Underline\";\n\tif (k == XK_ISO_Discontinuous_Underline) return \"ISO_Discontinuous_Underline\";\n\tif (k == XK_ISO_Emphasize) return \"ISO_Emphasize\";\n\tif (k == XK_ISO_Center_Object) return \"ISO_Center_Object\";\n\tif (k == XK_ISO_Enter) return \"ISO_Enter\";\n\tif (k == XK_dead_grave) return \"dead_grave\";\n\tif (k == XK_dead_acute) return \"dead_acute\";\n\tif (k == XK_dead_circumflex) return \"dead_circumflex\";\n\tif (k == XK_dead_tilde) return \"dead_tilde\";\n\tif (k == XK_dead_macron) return \"dead_macron\";\n\tif (k == XK_dead_breve) return \"dead_breve\";\n\tif (k == XK_dead_abovedot) return \"dead_abovedot\";\n\tif (k == XK_dead_diaeresis) return \"dead_diaeresis\";\n\tif (k == XK_dead_abovering) return \"dead_abovering\";\n\tif (k == XK_dead_doubleacute) return \"dead_doubleacute\";\n\tif (k == XK_dead_caron) return \"dead_caron\";\n\tif (k == XK_dead_cedilla) return \"dead_cedilla\";\n\tif (k == XK_dead_ogonek) return \"dead_ogonek\";\n\tif (k == XK_dead_iota) return \"dead_iota\";\n\tif (k == XK_dead_voiced_sound) return \"dead_voiced_sound\";\n\tif (k == XK_dead_semivoiced_sound) return \"dead_semivoiced_sound\";\n\tif (k == XK_dead_belowdot) return \"dead_belowdot\";\n\tif (k == XK_First_Virtual_Screen) return \"First_Virtual_Screen\";\n\tif (k == XK_Prev_Virtual_Screen) return \"Prev_Virtual_Screen\";\n\tif (k == XK_Next_Virtual_Screen) return \"Next_Virtual_Screen\";\n\tif (k == XK_Last_Virtual_Screen) return \"Last_Virtual_Screen\";\n\tif (k == XK_Terminate_Server) return \"Terminate_Server\";\n\tif (k == XK_AccessX_Enable) return \"AccessX_Enable\";\n\tif (k == XK_AccessX_Feedback_Enable) return \"AccessX_Feedback_Enable\";\n\tif (k == XK_RepeatKeys_Enable) return \"RepeatKeys_Enable\";\n\tif (k == XK_SlowKeys_Enable) return \"SlowKeys_Enable\";\n\tif (k == XK_BounceKeys_Enable) return \"BounceKeys_Enable\";\n\tif (k == XK_StickyKeys_Enable) return \"StickyKeys_Enable\";\n\tif (k == XK_MouseKeys_Enable) return \"MouseKeys_Enable\";\n\tif (k == XK_MouseKeys_Accel_Enable) return \"MouseKeys_Accel_Enable\";\n\tif (k == XK_Overlay1_Enable) return \"Overlay1_Enable\";\n\tif (k == XK_Overlay2_Enable) return \"Overlay2_Enable\";\n\tif (k == XK_AudibleBell_Enable) return \"AudibleBell_Enable\";\n\tif (k == XK_Pointer_Left) return \"Pointer_Left\";\n\tif (k == XK_Pointer_Right) return \"Pointer_Right\";\n\tif (k == XK_Pointer_Up) return \"Pointer_Up\";\n\tif (k == XK_Pointer_Down) return \"Pointer_Down\";\n\tif (k == XK_Pointer_UpLeft) return \"Pointer_UpLeft\";\n\tif (k == XK_Pointer_UpRight) return \"Pointer_UpRight\";\n\tif (k == XK_Pointer_DownLeft) return \"Pointer_DownLeft\";\n\tif (k == XK_Pointer_DownRight) return \"Pointer_DownRight\";\n\tif (k == XK_Pointer_Button_Dflt) return \"Pointer_Button_Dflt\";\n\tif (k == XK_Pointer_Button1) return \"Pointer_Button1\";\n\tif (k == XK_Pointer_Button2) return \"Pointer_Button2\";\n\tif (k == XK_Pointer_Button3) return \"Pointer_Button3\";\n\tif (k == XK_Pointer_Button4) return \"Pointer_Button4\";\n\tif (k == XK_Pointer_Button5) return \"Pointer_Button5\";\n\tif (k == XK_Pointer_DblClick_Dflt) return \"Pointer_DblClick_Dflt\";\n\tif (k == XK_Pointer_DblClick1) return \"Pointer_DblClick1\";\n\tif (k == XK_Pointer_DblClick2) return \"Pointer_DblClick2\";\n\tif (k == XK_Pointer_DblClick3) return \"Pointer_DblClick3\";\n\tif (k == XK_Pointer_DblClick4) return \"Pointer_DblClick4\";\n\tif (k == XK_Pointer_DblClick5) return \"Pointer_DblClick5\";\n\tif (k == XK_Pointer_Drag_Dflt) return \"Pointer_Drag_Dflt\";\n\tif (k == XK_Pointer_Drag1) return \"Pointer_Drag1\";\n\tif (k == XK_Pointer_Drag2) return \"Pointer_Drag2\";\n\tif (k == XK_Pointer_Drag3) return \"Pointer_Drag3\";\n\tif (k == XK_Pointer_Drag4) return \"Pointer_Drag4\";\n\tif (k == XK_Pointer_Drag5) return \"Pointer_Drag5\";\n\tif (k == XK_Pointer_EnableKeys) return \"Pointer_EnableKeys\";\n\tif (k == XK_Pointer_Accelerate) return \"Pointer_Accelerate\";\n\tif (k == XK_Pointer_DfltBtnNext) return \"Pointer_DfltBtnNext\";\n\tif (k == XK_Pointer_DfltBtnPrev) return \"Pointer_DfltBtnPrev\";\n#endif\n#ifdef XK_3270\n\tif (k == XK_3270_Duplicate) return \"3270_Duplicate\";\n\tif (k == XK_3270_FieldMark) return \"3270_FieldMark\";\n\tif (k == XK_3270_Right2) return \"3270_Right2\";\n\tif (k == XK_3270_Left2) return \"3270_Left2\";\n\tif (k == XK_3270_BackTab) return \"3270_BackTab\";\n\tif (k == XK_3270_EraseEOF) return \"3270_EraseEOF\";\n\tif (k == XK_3270_EraseInput) return \"3270_EraseInput\";\n\tif (k == XK_3270_Reset) return \"3270_Reset\";\n\tif (k == XK_3270_Quit) return \"3270_Quit\";\n\tif (k == XK_3270_PA1) return \"3270_PA1\";\n\tif (k == XK_3270_PA2) return \"3270_PA2\";\n\tif (k == XK_3270_PA3) return \"3270_PA3\";\n\tif (k == XK_3270_Test) return \"3270_Test\";\n\tif (k == XK_3270_Attn) return \"3270_Attn\";\n\tif (k == XK_3270_CursorBlink) return \"3270_CursorBlink\";\n\tif (k == XK_3270_AltCursor) return \"3270_AltCursor\";\n\tif (k == XK_3270_KeyClick) return \"3270_KeyClick\";\n\tif (k == XK_3270_Jump) return \"3270_Jump\";\n\tif (k == XK_3270_Ident) return \"3270_Ident\";\n\tif (k == XK_3270_Rule) return \"3270_Rule\";\n\tif (k == XK_3270_Copy) return \"3270_Copy\";\n\tif (k == XK_3270_Play) return \"3270_Play\";\n\tif (k == XK_3270_Setup) return \"3270_Setup\";\n\tif (k == XK_3270_Record) return \"3270_Record\";\n\tif (k == XK_3270_ChangeScreen) return \"3270_ChangeScreen\";\n\tif (k == XK_3270_DeleteWord) return \"3270_DeleteWord\";\n\tif (k == XK_3270_ExSelect) return \"3270_ExSelect\";\n\tif (k == XK_3270_CursorSelect) return \"3270_CursorSelect\";\n\tif (k == XK_3270_PrintScreen) return \"3270_PrintScreen\";\n\tif (k == XK_3270_Enter) return \"3270_Enter\";\n#endif\n#ifdef XK_LATIN1\n\tif (k == XK_space) return \"space\";\n\tif (k == XK_exclam) return \"exclam\";\n\tif (k == XK_quotedbl) return \"quotedbl\";\n\tif (k == XK_numbersign) return \"numbersign\";\n\tif (k == XK_dollar) return \"dollar\";\n\tif (k == XK_percent) return \"percent\";\n\tif (k == XK_ampersand) return \"ampersand\";\n\tif (k == XK_apostrophe) return \"apostrophe\";\n\tif (k == XK_quoteright) return \"quoteright\";\n\tif (k == XK_parenleft) return \"parenleft\";\n\tif (k == XK_parenright) return \"parenright\";\n\tif (k == XK_asterisk) return \"asterisk\";\n\tif (k == XK_plus) return \"plus\";\n\tif (k == XK_comma) return \"comma\";\n\tif (k == XK_minus) return \"minus\";\n\tif (k == XK_period) return \"period\";\n\tif (k == XK_slash) return \"slash\";\n\tif (k == XK_0) return \"0\";\n\tif (k == XK_1) return \"1\";\n\tif (k == XK_2) return \"2\";\n\tif (k == XK_3) return \"3\";\n\tif (k == XK_4) return \"4\";\n\tif (k == XK_5) return \"5\";\n\tif (k == XK_6) return \"6\";\n\tif (k == XK_7) return \"7\";\n\tif (k == XK_8) return \"8\";\n\tif (k == XK_9) return \"9\";\n\tif (k == XK_colon) return \"colon\";\n\tif (k == XK_semicolon) return \"semicolon\";\n\tif (k == XK_less) return \"less\";\n\tif (k == XK_equal) return \"equal\";\n\tif (k == XK_greater) return \"greater\";\n\tif (k == XK_question) return \"question\";\n\tif (k == XK_at) return \"at\";\n\tif (k == XK_A) return \"A\";\n\tif (k == XK_B) return \"B\";\n\tif (k == XK_C) return \"C\";\n\tif (k == XK_D) return \"D\";\n\tif (k == XK_E) return \"E\";\n\tif (k == XK_F) return \"F\";\n\tif (k == XK_G) return \"G\";\n\tif (k == XK_H) return \"H\";\n\tif (k == XK_I) return \"I\";\n\tif (k == XK_J) return \"J\";\n\tif (k == XK_K) return \"K\";\n\tif (k == XK_L) return \"L\";\n\tif (k == XK_M) return \"M\";\n\tif (k == XK_N) return \"N\";\n\tif (k == XK_O) return \"O\";\n\tif (k == XK_P) return \"P\";\n\tif (k == XK_Q) return \"Q\";\n\tif (k == XK_R) return \"R\";\n\tif (k == XK_S) return \"S\";\n\tif (k == XK_T) return \"T\";\n\tif (k == XK_U) return \"U\";\n\tif (k == XK_V) return \"V\";\n\tif (k == XK_W) return \"W\";\n\tif (k == XK_X) return \"X\";\n\tif (k == XK_Y) return \"Y\";\n\tif (k == XK_Z) return \"Z\";\n\tif (k == XK_bracketleft) return \"bracketleft\";\n\tif (k == XK_backslash) return \"backslash\";\n\tif (k == XK_bracketright) return \"bracketright\";\n\tif (k == XK_asciicircum) return \"asciicircum\";\n\tif (k == XK_underscore) return \"underscore\";\n\tif (k == XK_grave) return \"grave\";\n\tif (k == XK_quoteleft) return \"quoteleft\";\n\tif (k == XK_a) return \"a\";\n\tif (k == XK_b) return \"b\";\n\tif (k == XK_c) return \"c\";\n\tif (k == XK_d) return \"d\";\n\tif (k == XK_e) return \"e\";\n\tif (k == XK_f) return \"f\";\n\tif (k == XK_g) return \"g\";\n\tif (k == XK_h) return \"h\";\n\tif (k == XK_i) return \"i\";\n\tif (k == XK_j) return \"j\";\n\tif (k == XK_k) return \"k\";\n\tif (k == XK_l) return \"l\";\n\tif (k == XK_m) return \"m\";\n\tif (k == XK_n) return \"n\";\n\tif (k == XK_o) return \"o\";\n\tif (k == XK_p) return \"p\";\n\tif (k == XK_q) return \"q\";\n\tif (k == XK_r) return \"r\";\n\tif (k == XK_s) return \"s\";\n\tif (k == XK_t) return \"t\";\n\tif (k == XK_u) return \"u\";\n\tif (k == XK_v) return \"v\";\n\tif (k == XK_w) return \"w\";\n\tif (k == XK_x) return \"x\";\n\tif (k == XK_y) return \"y\";\n\tif (k == XK_z) return \"z\";\n\tif (k == XK_braceleft) return \"braceleft\";\n\tif (k == XK_bar) return \"bar\";\n\tif (k == XK_braceright) return \"braceright\";\n\tif (k == XK_asciitilde) return \"asciitilde\";\n\tif (k == XK_nobreakspace) return \"nobreakspace\";\n\tif (k == XK_exclamdown) return \"exclamdown\";\n\tif (k == XK_cent) return \"cent\";\n\tif (k == XK_sterling) return \"sterling\";\n\tif (k == XK_currency) return \"currency\";\n\tif (k == XK_yen) return \"yen\";\n\tif (k == XK_brokenbar) return \"brokenbar\";\n\tif (k == XK_section) return \"section\";\n\tif (k == XK_diaeresis) return \"diaeresis\";\n\tif (k == XK_copyright) return \"copyright\";\n\tif (k == XK_ordfeminine) return \"ordfeminine\";\n\tif (k == XK_guillemotleft) return \"guillemotleft\";\n\tif (k == XK_notsign) return \"notsign\";\n\tif (k == XK_hyphen) return \"hyphen\";\n\tif (k == XK_registered) return \"registered\";\n\tif (k == XK_macron) return \"macron\";\n\tif (k == XK_degree) return \"degree\";\n\tif (k == XK_plusminus) return \"plusminus\";\n\tif (k == XK_twosuperior) return \"twosuperior\";\n\tif (k == XK_threesuperior) return \"threesuperior\";\n\tif (k == XK_acute) return \"acute\";\n\tif (k == XK_mu) return \"mu\";\n\tif (k == XK_paragraph) return \"paragraph\";\n\tif (k == XK_periodcentered) return \"periodcentered\";\n\tif (k == XK_cedilla) return \"cedilla\";\n\tif (k == XK_onesuperior) return \"onesuperior\";\n\tif (k == XK_masculine) return \"masculine\";\n\tif (k == XK_guillemotright) return \"guillemotright\";\n\tif (k == XK_onequarter) return \"onequarter\";\n\tif (k == XK_onehalf) return \"onehalf\";\n\tif (k == XK_threequarters) return \"threequarters\";\n\tif (k == XK_questiondown) return \"questiondown\";\n\tif (k == XK_Agrave) return \"Agrave\";\n\tif (k == XK_Aacute) return \"Aacute\";\n\tif (k == XK_Acircumflex) return \"Acircumflex\";\n\tif (k == XK_Atilde) return \"Atilde\";\n\tif (k == XK_Adiaeresis) return \"Adiaeresis\";\n\tif (k == XK_Aring) return \"Aring\";\n\tif (k == XK_AE) return \"AE\";\n\tif (k == XK_Ccedilla) return \"Ccedilla\";\n\tif (k == XK_Egrave) return \"Egrave\";\n\tif (k == XK_Eacute) return \"Eacute\";\n\tif (k == XK_Ecircumflex) return \"Ecircumflex\";\n\tif (k == XK_Ediaeresis) return \"Ediaeresis\";\n\tif (k == XK_Igrave) return \"Igrave\";\n\tif (k == XK_Iacute) return \"Iacute\";\n\tif (k == XK_Icircumflex) return \"Icircumflex\";\n\tif (k == XK_Idiaeresis) return \"Idiaeresis\";\n\tif (k == XK_ETH) return \"ETH\";\n\tif (k == XK_Eth) return \"Eth\";\n\tif (k == XK_Ntilde) return \"Ntilde\";\n\tif (k == XK_Ograve) return \"Ograve\";\n\tif (k == XK_Oacute) return \"Oacute\";\n\tif (k == XK_Ocircumflex) return \"Ocircumflex\";\n\tif (k == XK_Otilde) return \"Otilde\";\n\tif (k == XK_Odiaeresis) return \"Odiaeresis\";\n\tif (k == XK_multiply) return \"multiply\";\n\tif (k == XK_Ooblique) return \"Ooblique\";\n\tif (k == XK_Ugrave) return \"Ugrave\";\n\tif (k == XK_Uacute) return \"Uacute\";\n\tif (k == XK_Ucircumflex) return \"Ucircumflex\";\n\tif (k == XK_Udiaeresis) return \"Udiaeresis\";\n\tif (k == XK_Yacute) return \"Yacute\";\n\tif (k == XK_THORN) return \"THORN\";\n\tif (k == XK_Thorn) return \"Thorn\";\n\tif (k == XK_ssharp) return \"ssharp\";\n\tif (k == XK_agrave) return \"agrave\";\n\tif (k == XK_aacute) return \"aacute\";\n\tif (k == XK_acircumflex) return \"acircumflex\";\n\tif (k == XK_atilde) return \"atilde\";\n\tif (k == XK_adiaeresis) return \"adiaeresis\";\n\tif (k == XK_aring) return \"aring\";\n\tif (k == XK_ae) return \"ae\";\n\tif (k == XK_ccedilla) return \"ccedilla\";\n\tif (k == XK_egrave) return \"egrave\";\n\tif (k == XK_eacute) return \"eacute\";\n\tif (k == XK_ecircumflex) return \"ecircumflex\";\n\tif (k == XK_ediaeresis) return \"ediaeresis\";\n\tif (k == XK_igrave) return \"igrave\";\n\tif (k == XK_iacute) return \"iacute\";\n\tif (k == XK_icircumflex) return \"icircumflex\";\n\tif (k == XK_idiaeresis) return \"idiaeresis\";\n\tif (k == XK_eth) return \"eth\";\n\tif (k == XK_ntilde) return \"ntilde\";\n\tif (k == XK_ograve) return \"ograve\";\n\tif (k == XK_oacute) return \"oacute\";\n\tif (k == XK_ocircumflex) return \"ocircumflex\";\n\tif (k == XK_otilde) return \"otilde\";\n\tif (k == XK_odiaeresis) return \"odiaeresis\";\n\tif (k == XK_division) return \"division\";\n\tif (k == XK_oslash) return \"oslash\";\n\tif (k == XK_ugrave) return \"ugrave\";\n\tif (k == XK_uacute) return \"uacute\";\n\tif (k == XK_ucircumflex) return \"ucircumflex\";\n\tif (k == XK_udiaeresis) return \"udiaeresis\";\n\tif (k == XK_yacute) return \"yacute\";\n\tif (k == XK_thorn) return \"thorn\";\n\tif (k == XK_ydiaeresis) return \"ydiaeresis\";\n#endif /* XK_LATIN1 */\n#ifdef XK_LATIN2\n\tif (k == XK_Aogonek) return \"Aogonek\";\n\tif (k == XK_breve) return \"breve\";\n\tif (k == XK_Lstroke) return \"Lstroke\";\n\tif (k == XK_Lcaron) return \"Lcaron\";\n\tif (k == XK_Sacute) return \"Sacute\";\n\tif (k == XK_Scaron) return \"Scaron\";\n\tif (k == XK_Scedilla) return \"Scedilla\";\n\tif (k == XK_Tcaron) return \"Tcaron\";\n\tif (k == XK_Zacute) return \"Zacute\";\n\tif (k == XK_Zcaron) return \"Zcaron\";\n\tif (k == XK_Zabovedot) return \"Zabovedot\";\n\tif (k == XK_aogonek) return \"aogonek\";\n\tif (k == XK_ogonek) return \"ogonek\";\n\tif (k == XK_lstroke) return \"lstroke\";\n\tif (k == XK_lcaron) return \"lcaron\";\n\tif (k == XK_sacute) return \"sacute\";\n\tif (k == XK_caron) return \"caron\";\n\tif (k == XK_scaron) return \"scaron\";\n\tif (k == XK_scedilla) return \"scedilla\";\n\tif (k == XK_tcaron) return \"tcaron\";\n\tif (k == XK_zacute) return \"zacute\";\n\tif (k == XK_doubleacute) return \"doubleacute\";\n\tif (k == XK_zcaron) return \"zcaron\";\n\tif (k == XK_zabovedot) return \"zabovedot\";\n\tif (k == XK_Racute) return \"Racute\";\n\tif (k == XK_Abreve) return \"Abreve\";\n\tif (k == XK_Lacute) return \"Lacute\";\n\tif (k == XK_Cacute) return \"Cacute\";\n\tif (k == XK_Ccaron) return \"Ccaron\";\n\tif (k == XK_Eogonek) return \"Eogonek\";\n\tif (k == XK_Ecaron) return \"Ecaron\";\n\tif (k == XK_Dcaron) return \"Dcaron\";\n\tif (k == XK_Dstroke) return \"Dstroke\";\n\tif (k == XK_Nacute) return \"Nacute\";\n\tif (k == XK_Ncaron) return \"Ncaron\";\n\tif (k == XK_Odoubleacute) return \"Odoubleacute\";\n\tif (k == XK_Rcaron) return \"Rcaron\";\n\tif (k == XK_Uring) return \"Uring\";\n\tif (k == XK_Udoubleacute) return \"Udoubleacute\";\n\tif (k == XK_Tcedilla) return \"Tcedilla\";\n\tif (k == XK_racute) return \"racute\";\n\tif (k == XK_abreve) return \"abreve\";\n\tif (k == XK_lacute) return \"lacute\";\n\tif (k == XK_cacute) return \"cacute\";\n\tif (k == XK_ccaron) return \"ccaron\";\n\tif (k == XK_eogonek) return \"eogonek\";\n\tif (k == XK_ecaron) return \"ecaron\";\n\tif (k == XK_dcaron) return \"dcaron\";\n\tif (k == XK_dstroke) return \"dstroke\";\n\tif (k == XK_nacute) return \"nacute\";\n\tif (k == XK_ncaron) return \"ncaron\";\n\tif (k == XK_odoubleacute) return \"odoubleacute\";\n\tif (k == XK_udoubleacute) return \"udoubleacute\";\n\tif (k == XK_rcaron) return \"rcaron\";\n\tif (k == XK_uring) return \"uring\";\n\tif (k == XK_tcedilla) return \"tcedilla\";\n\tif (k == XK_abovedot) return \"abovedot\";\n#endif /* XK_LATIN2 */\n#ifdef XK_LATIN3\n\tif (k == XK_Hstroke) return \"Hstroke\";\n\tif (k == XK_Hcircumflex) return \"Hcircumflex\";\n\tif (k == XK_Iabovedot) return \"Iabovedot\";\n\tif (k == XK_Gbreve) return \"Gbreve\";\n\tif (k == XK_Jcircumflex) return \"Jcircumflex\";\n\tif (k == XK_hstroke) return \"hstroke\";\n\tif (k == XK_hcircumflex) return \"hcircumflex\";\n\tif (k == XK_idotless) return \"idotless\";\n\tif (k == XK_gbreve) return \"gbreve\";\n\tif (k == XK_jcircumflex) return \"jcircumflex\";\n\tif (k == XK_Cabovedot) return \"Cabovedot\";\n\tif (k == XK_Ccircumflex) return \"Ccircumflex\";\n\tif (k == XK_Gabovedot) return \"Gabovedot\";\n\tif (k == XK_Gcircumflex) return \"Gcircumflex\";\n\tif (k == XK_Ubreve) return \"Ubreve\";\n\tif (k == XK_Scircumflex) return \"Scircumflex\";\n\tif (k == XK_cabovedot) return \"cabovedot\";\n\tif (k == XK_ccircumflex) return \"ccircumflex\";\n\tif (k == XK_gabovedot) return \"gabovedot\";\n\tif (k == XK_gcircumflex) return \"gcircumflex\";\n\tif (k == XK_ubreve) return \"ubreve\";\n\tif (k == XK_scircumflex) return \"scircumflex\";\n#endif /* XK_LATIN3 */\n#ifdef XK_LATIN4\n\tif (k == XK_kra) return \"kra\";\n\tif (k == XK_kappa) return \"kappa\";\n\tif (k == XK_Rcedilla) return \"Rcedilla\";\n\tif (k == XK_Itilde) return \"Itilde\";\n\tif (k == XK_Lcedilla) return \"Lcedilla\";\n\tif (k == XK_Emacron) return \"Emacron\";\n\tif (k == XK_Gcedilla) return \"Gcedilla\";\n\tif (k == XK_Tslash) return \"Tslash\";\n\tif (k == XK_rcedilla) return \"rcedilla\";\n\tif (k == XK_itilde) return \"itilde\";\n\tif (k == XK_lcedilla) return \"lcedilla\";\n\tif (k == XK_emacron) return \"emacron\";\n\tif (k == XK_gcedilla) return \"gcedilla\";\n\tif (k == XK_tslash) return \"tslash\";\n\tif (k == XK_ENG) return \"ENG\";\n\tif (k == XK_eng) return \"eng\";\n\tif (k == XK_Amacron) return \"Amacron\";\n\tif (k == XK_Iogonek) return \"Iogonek\";\n\tif (k == XK_Eabovedot) return \"Eabovedot\";\n\tif (k == XK_Imacron) return \"Imacron\";\n\tif (k == XK_Ncedilla) return \"Ncedilla\";\n\tif (k == XK_Omacron) return \"Omacron\";\n\tif (k == XK_Kcedilla) return \"Kcedilla\";\n\tif (k == XK_Uogonek) return \"Uogonek\";\n\tif (k == XK_Utilde) return \"Utilde\";\n\tif (k == XK_Umacron) return \"Umacron\";\n\tif (k == XK_amacron) return \"amacron\";\n\tif (k == XK_iogonek) return \"iogonek\";\n\tif (k == XK_eabovedot) return \"eabovedot\";\n\tif (k == XK_imacron) return \"imacron\";\n\tif (k == XK_ncedilla) return \"ncedilla\";\n\tif (k == XK_omacron) return \"omacron\";\n\tif (k == XK_kcedilla) return \"kcedilla\";\n\tif (k == XK_uogonek) return \"uogonek\";\n\tif (k == XK_utilde) return \"utilde\";\n\tif (k == XK_umacron) return \"umacron\";\n#endif /* XK_LATIN4 */\n#ifdef XK_KATAKANA\n\tif (k == XK_overline) return \"overline\";\n\tif (k == XK_kana_fullstop) return \"kana_fullstop\";\n\tif (k == XK_kana_openingbracket) return \"kana_openingbracket\";\n\tif (k == XK_kana_closingbracket) return \"kana_closingbracket\";\n\tif (k == XK_kana_comma) return \"kana_comma\";\n\tif (k == XK_kana_conjunctive) return \"kana_conjunctive\";\n\tif (k == XK_kana_middledot) return \"kana_middledot\";\n\tif (k == XK_kana_WO) return \"kana_WO\";\n\tif (k == XK_kana_a) return \"kana_a\";\n\tif (k == XK_kana_i) return \"kana_i\";\n\tif (k == XK_kana_u) return \"kana_u\";\n\tif (k == XK_kana_e) return \"kana_e\";\n\tif (k == XK_kana_o) return \"kana_o\";\n\tif (k == XK_kana_ya) return \"kana_ya\";\n\tif (k == XK_kana_yu) return \"kana_yu\";\n\tif (k == XK_kana_yo) return \"kana_yo\";\n\tif (k == XK_kana_tsu) return \"kana_tsu\";\n\tif (k == XK_kana_tu) return \"kana_tu\";\n\tif (k == XK_prolongedsound) return \"prolongedsound\";\n\tif (k == XK_kana_A) return \"kana_A\";\n\tif (k == XK_kana_I) return \"kana_I\";\n\tif (k == XK_kana_U) return \"kana_U\";\n\tif (k == XK_kana_E) return \"kana_E\";\n\tif (k == XK_kana_O) return \"kana_O\";\n\tif (k == XK_kana_KA) return \"kana_KA\";\n\tif (k == XK_kana_KI) return \"kana_KI\";\n\tif (k == XK_kana_KU) return \"kana_KU\";\n\tif (k == XK_kana_KE) return \"kana_KE\";\n\tif (k == XK_kana_KO) return \"kana_KO\";\n\tif (k == XK_kana_SA) return \"kana_SA\";\n\tif (k == XK_kana_SHI) return \"kana_SHI\";\n\tif (k == XK_kana_SU) return \"kana_SU\";\n\tif (k == XK_kana_SE) return \"kana_SE\";\n\tif (k == XK_kana_SO) return \"kana_SO\";\n\tif (k == XK_kana_TA) return \"kana_TA\";\n\tif (k == XK_kana_CHI) return \"kana_CHI\";\n\tif (k == XK_kana_TI) return \"kana_TI\";\n\tif (k == XK_kana_TSU) return \"kana_TSU\";\n\tif (k == XK_kana_TU) return \"kana_TU\";\n\tif (k == XK_kana_TE) return \"kana_TE\";\n\tif (k == XK_kana_TO) return \"kana_TO\";\n\tif (k == XK_kana_NA) return \"kana_NA\";\n\tif (k == XK_kana_NI) return \"kana_NI\";\n\tif (k == XK_kana_NU) return \"kana_NU\";\n\tif (k == XK_kana_NE) return \"kana_NE\";\n\tif (k == XK_kana_NO) return \"kana_NO\";\n\tif (k == XK_kana_HA) return \"kana_HA\";\n\tif (k == XK_kana_HI) return \"kana_HI\";\n\tif (k == XK_kana_FU) return \"kana_FU\";\n\tif (k == XK_kana_HU) return \"kana_HU\";\n\tif (k == XK_kana_HE) return \"kana_HE\";\n\tif (k == XK_kana_HO) return \"kana_HO\";\n\tif (k == XK_kana_MA) return \"kana_MA\";\n\tif (k == XK_kana_MI) return \"kana_MI\";\n\tif (k == XK_kana_MU) return \"kana_MU\";\n\tif (k == XK_kana_ME) return \"kana_ME\";\n\tif (k == XK_kana_MO) return \"kana_MO\";\n\tif (k == XK_kana_YA) return \"kana_YA\";\n\tif (k == XK_kana_YU) return \"kana_YU\";\n\tif (k == XK_kana_YO) return \"kana_YO\";\n\tif (k == XK_kana_RA) return \"kana_RA\";\n\tif (k == XK_kana_RI) return \"kana_RI\";\n\tif (k == XK_kana_RU) return \"kana_RU\";\n\tif (k == XK_kana_RE) return \"kana_RE\";\n\tif (k == XK_kana_RO) return \"kana_RO\";\n\tif (k == XK_kana_WA) return \"kana_WA\";\n\tif (k == XK_kana_N) return \"kana_N\";\n\tif (k == XK_voicedsound) return \"voicedsound\";\n\tif (k == XK_semivoicedsound) return \"semivoicedsound\";\n\tif (k == XK_kana_switch) return \"kana_switch\";\n#endif /* XK_KATAKANA */\n#ifdef XK_ARABIC\n\tif (k == XK_Arabic_comma) return \"Arabic_comma\";\n\tif (k == XK_Arabic_semicolon) return \"Arabic_semicolon\";\n\tif (k == XK_Arabic_question_mark) return \"Arabic_question_mark\";\n\tif (k == XK_Arabic_hamza) return \"Arabic_hamza\";\n\tif (k == XK_Arabic_maddaonalef) return \"Arabic_maddaonalef\";\n\tif (k == XK_Arabic_hamzaonalef) return \"Arabic_hamzaonalef\";\n\tif (k == XK_Arabic_hamzaonwaw) return \"Arabic_hamzaonwaw\";\n\tif (k == XK_Arabic_hamzaunderalef) return \"Arabic_hamzaunderalef\";\n\tif (k == XK_Arabic_hamzaonyeh) return \"Arabic_hamzaonyeh\";\n\tif (k == XK_Arabic_alef) return \"Arabic_alef\";\n\tif (k == XK_Arabic_beh) return \"Arabic_beh\";\n\tif (k == XK_Arabic_tehmarbuta) return \"Arabic_tehmarbuta\";\n\tif (k == XK_Arabic_teh) return \"Arabic_teh\";\n\tif (k == XK_Arabic_theh) return \"Arabic_theh\";\n\tif (k == XK_Arabic_jeem) return \"Arabic_jeem\";\n\tif (k == XK_Arabic_hah) return \"Arabic_hah\";\n\tif (k == XK_Arabic_khah) return \"Arabic_khah\";\n\tif (k == XK_Arabic_dal) return \"Arabic_dal\";\n\tif (k == XK_Arabic_thal) return \"Arabic_thal\";\n\tif (k == XK_Arabic_ra) return \"Arabic_ra\";\n\tif (k == XK_Arabic_zain) return \"Arabic_zain\";\n\tif (k == XK_Arabic_seen) return \"Arabic_seen\";\n\tif (k == XK_Arabic_sheen) return \"Arabic_sheen\";\n\tif (k == XK_Arabic_sad) return \"Arabic_sad\";\n\tif (k == XK_Arabic_dad) return \"Arabic_dad\";\n\tif (k == XK_Arabic_tah) return \"Arabic_tah\";\n\tif (k == XK_Arabic_zah) return \"Arabic_zah\";\n\tif (k == XK_Arabic_ain) return \"Arabic_ain\";\n\tif (k == XK_Arabic_ghain) return \"Arabic_ghain\";\n\tif (k == XK_Arabic_tatweel) return \"Arabic_tatweel\";\n\tif (k == XK_Arabic_feh) return \"Arabic_feh\";\n\tif (k == XK_Arabic_qaf) return \"Arabic_qaf\";\n\tif (k == XK_Arabic_kaf) return \"Arabic_kaf\";\n\tif (k == XK_Arabic_lam) return \"Arabic_lam\";\n\tif (k == XK_Arabic_meem) return \"Arabic_meem\";\n\tif (k == XK_Arabic_noon) return \"Arabic_noon\";\n\tif (k == XK_Arabic_ha) return \"Arabic_ha\";\n\tif (k == XK_Arabic_heh) return \"Arabic_heh\";\n\tif (k == XK_Arabic_waw) return \"Arabic_waw\";\n\tif (k == XK_Arabic_alefmaksura) return \"Arabic_alefmaksura\";\n\tif (k == XK_Arabic_yeh) return \"Arabic_yeh\";\n\tif (k == XK_Arabic_fathatan) return \"Arabic_fathatan\";\n\tif (k == XK_Arabic_dammatan) return \"Arabic_dammatan\";\n\tif (k == XK_Arabic_kasratan) return \"Arabic_kasratan\";\n\tif (k == XK_Arabic_fatha) return \"Arabic_fatha\";\n\tif (k == XK_Arabic_damma) return \"Arabic_damma\";\n\tif (k == XK_Arabic_kasra) return \"Arabic_kasra\";\n\tif (k == XK_Arabic_shadda) return \"Arabic_shadda\";\n\tif (k == XK_Arabic_sukun) return \"Arabic_sukun\";\n\tif (k == XK_Arabic_switch) return \"Arabic_switch\";\n#endif /* XK_ARABIC */\n#ifdef XK_CYRILLIC\n\tif (k == XK_Serbian_dje) return \"Serbian_dje\";\n\tif (k == XK_Macedonia_gje) return \"Macedonia_gje\";\n\tif (k == XK_Cyrillic_io) return \"Cyrillic_io\";\n\tif (k == XK_Ukrainian_ie) return \"Ukrainian_ie\";\n\tif (k == XK_Ukranian_je) return \"Ukranian_je\";\n\tif (k == XK_Macedonia_dse) return \"Macedonia_dse\";\n\tif (k == XK_Ukrainian_i) return \"Ukrainian_i\";\n\tif (k == XK_Ukranian_i) return \"Ukranian_i\";\n\tif (k == XK_Ukrainian_yi) return \"Ukrainian_yi\";\n\tif (k == XK_Ukranian_yi) return \"Ukranian_yi\";\n\tif (k == XK_Cyrillic_je) return \"Cyrillic_je\";\n\tif (k == XK_Serbian_je) return \"Serbian_je\";\n\tif (k == XK_Cyrillic_lje) return \"Cyrillic_lje\";\n\tif (k == XK_Serbian_lje) return \"Serbian_lje\";\n\tif (k == XK_Cyrillic_nje) return \"Cyrillic_nje\";\n\tif (k == XK_Serbian_nje) return \"Serbian_nje\";\n\tif (k == XK_Serbian_tshe) return \"Serbian_tshe\";\n\tif (k == XK_Macedonia_kje) return \"Macedonia_kje\";\n\tif (k == XK_Byelorussian_shortu) return \"Byelorussian_shortu\";\n\tif (k == XK_Cyrillic_dzhe) return \"Cyrillic_dzhe\";\n\tif (k == XK_Serbian_dze) return \"Serbian_dze\";\n\tif (k == XK_numerosign) return \"numerosign\";\n\tif (k == XK_Serbian_DJE) return \"Serbian_DJE\";\n\tif (k == XK_Macedonia_GJE) return \"Macedonia_GJE\";\n\tif (k == XK_Cyrillic_IO) return \"Cyrillic_IO\";\n\tif (k == XK_Ukrainian_IE) return \"Ukrainian_IE\";\n\tif (k == XK_Ukranian_JE) return \"Ukranian_JE\";\n\tif (k == XK_Macedonia_DSE) return \"Macedonia_DSE\";\n\tif (k == XK_Ukrainian_I) return \"Ukrainian_I\";\n\tif (k == XK_Ukranian_I) return \"Ukranian_I\";\n\tif (k == XK_Ukrainian_YI) return \"Ukrainian_YI\";\n\tif (k == XK_Ukranian_YI) return \"Ukranian_YI\";\n\tif (k == XK_Cyrillic_JE) return \"Cyrillic_JE\";\n\tif (k == XK_Serbian_JE) return \"Serbian_JE\";\n\tif (k == XK_Cyrillic_LJE) return \"Cyrillic_LJE\";\n\tif (k == XK_Serbian_LJE) return \"Serbian_LJE\";\n\tif (k == XK_Cyrillic_NJE) return \"Cyrillic_NJE\";\n\tif (k == XK_Serbian_NJE) return \"Serbian_NJE\";\n\tif (k == XK_Serbian_TSHE) return \"Serbian_TSHE\";\n\tif (k == XK_Macedonia_KJE) return \"Macedonia_KJE\";\n\tif (k == XK_Byelorussian_SHORTU) return \"Byelorussian_SHORTU\";\n\tif (k == XK_Cyrillic_DZHE) return \"Cyrillic_DZHE\";\n\tif (k == XK_Serbian_DZE) return \"Serbian_DZE\";\n\tif (k == XK_Cyrillic_yu) return \"Cyrillic_yu\";\n\tif (k == XK_Cyrillic_a) return \"Cyrillic_a\";\n\tif (k == XK_Cyrillic_be) return \"Cyrillic_be\";\n\tif (k == XK_Cyrillic_tse) return \"Cyrillic_tse\";\n\tif (k == XK_Cyrillic_de) return \"Cyrillic_de\";\n\tif (k == XK_Cyrillic_ie) return \"Cyrillic_ie\";\n\tif (k == XK_Cyrillic_ef) return \"Cyrillic_ef\";\n\tif (k == XK_Cyrillic_ghe) return \"Cyrillic_ghe\";\n\tif (k == XK_Cyrillic_ha) return \"Cyrillic_ha\";\n\tif (k == XK_Cyrillic_i) return \"Cyrillic_i\";\n\tif (k == XK_Cyrillic_shorti) return \"Cyrillic_shorti\";\n\tif (k == XK_Cyrillic_ka) return \"Cyrillic_ka\";\n\tif (k == XK_Cyrillic_el) return \"Cyrillic_el\";\n\tif (k == XK_Cyrillic_em) return \"Cyrillic_em\";\n\tif (k == XK_Cyrillic_en) return \"Cyrillic_en\";\n\tif (k == XK_Cyrillic_o) return \"Cyrillic_o\";\n\tif (k == XK_Cyrillic_pe) return \"Cyrillic_pe\";\n\tif (k == XK_Cyrillic_ya) return \"Cyrillic_ya\";\n\tif (k == XK_Cyrillic_er) return \"Cyrillic_er\";\n\tif (k == XK_Cyrillic_es) return \"Cyrillic_es\";\n\tif (k == XK_Cyrillic_te) return \"Cyrillic_te\";\n\tif (k == XK_Cyrillic_u) return \"Cyrillic_u\";\n\tif (k == XK_Cyrillic_zhe) return \"Cyrillic_zhe\";\n\tif (k == XK_Cyrillic_ve) return \"Cyrillic_ve\";\n\tif (k == XK_Cyrillic_softsign) return \"Cyrillic_softsign\";\n\tif (k == XK_Cyrillic_yeru) return \"Cyrillic_yeru\";\n\tif (k == XK_Cyrillic_ze) return \"Cyrillic_ze\";\n\tif (k == XK_Cyrillic_sha) return \"Cyrillic_sha\";\n\tif (k == XK_Cyrillic_e) return \"Cyrillic_e\";\n\tif (k == XK_Cyrillic_shcha) return \"Cyrillic_shcha\";\n\tif (k == XK_Cyrillic_che) return \"Cyrillic_che\";\n\tif (k == XK_Cyrillic_hardsign) return \"Cyrillic_hardsign\";\n\tif (k == XK_Cyrillic_YU) return \"Cyrillic_YU\";\n\tif (k == XK_Cyrillic_A) return \"Cyrillic_A\";\n\tif (k == XK_Cyrillic_BE) return \"Cyrillic_BE\";\n\tif (k == XK_Cyrillic_TSE) return \"Cyrillic_TSE\";\n\tif (k == XK_Cyrillic_DE) return \"Cyrillic_DE\";\n\tif (k == XK_Cyrillic_IE) return \"Cyrillic_IE\";\n\tif (k == XK_Cyrillic_EF) return \"Cyrillic_EF\";\n\tif (k == XK_Cyrillic_GHE) return \"Cyrillic_GHE\";\n\tif (k == XK_Cyrillic_HA) return \"Cyrillic_HA\";\n\tif (k == XK_Cyrillic_I) return \"Cyrillic_I\";\n\tif (k == XK_Cyrillic_SHORTI) return \"Cyrillic_SHORTI\";\n\tif (k == XK_Cyrillic_KA) return \"Cyrillic_KA\";\n\tif (k == XK_Cyrillic_EL) return \"Cyrillic_EL\";\n\tif (k == XK_Cyrillic_EM) return \"Cyrillic_EM\";\n\tif (k == XK_Cyrillic_EN) return \"Cyrillic_EN\";\n\tif (k == XK_Cyrillic_O) return \"Cyrillic_O\";\n\tif (k == XK_Cyrillic_PE) return \"Cyrillic_PE\";\n\tif (k == XK_Cyrillic_YA) return \"Cyrillic_YA\";\n\tif (k == XK_Cyrillic_ER) return \"Cyrillic_ER\";\n\tif (k == XK_Cyrillic_ES) return \"Cyrillic_ES\";\n\tif (k == XK_Cyrillic_TE) return \"Cyrillic_TE\";\n\tif (k == XK_Cyrillic_U) return \"Cyrillic_U\";\n\tif (k == XK_Cyrillic_ZHE) return \"Cyrillic_ZHE\";\n\tif (k == XK_Cyrillic_VE) return \"Cyrillic_VE\";\n\tif (k == XK_Cyrillic_SOFTSIGN) return \"Cyrillic_SOFTSIGN\";\n\tif (k == XK_Cyrillic_YERU) return \"Cyrillic_YERU\";\n\tif (k == XK_Cyrillic_ZE) return \"Cyrillic_ZE\";\n\tif (k == XK_Cyrillic_SHA) return \"Cyrillic_SHA\";\n\tif (k == XK_Cyrillic_E) return \"Cyrillic_E\";\n\tif (k == XK_Cyrillic_SHCHA) return \"Cyrillic_SHCHA\";\n\tif (k == XK_Cyrillic_CHE) return \"Cyrillic_CHE\";\n\tif (k == XK_Cyrillic_HARDSIGN) return \"Cyrillic_HARDSIGN\";\n#endif /* XK_CYRILLIC */\n#ifdef XK_GREEK\n\tif (k == XK_Greek_ALPHAaccent) return \"Greek_ALPHAaccent\";\n\tif (k == XK_Greek_EPSILONaccent) return \"Greek_EPSILONaccent\";\n\tif (k == XK_Greek_ETAaccent) return \"Greek_ETAaccent\";\n\tif (k == XK_Greek_IOTAaccent) return \"Greek_IOTAaccent\";\n\tif (k == XK_Greek_IOTAdieresis) return \"Greek_IOTAdieresis\";\n\tif (k == XK_Greek_OMICRONaccent) return \"Greek_OMICRONaccent\";\n\tif (k == XK_Greek_UPSILONaccent) return \"Greek_UPSILONaccent\";\n\tif (k == XK_Greek_UPSILONdieresis) return \"Greek_UPSILONdieresis\";\n\tif (k == XK_Greek_OMEGAaccent) return \"Greek_OMEGAaccent\";\n\tif (k == XK_Greek_accentdieresis) return \"Greek_accentdieresis\";\n\tif (k == XK_Greek_horizbar) return \"Greek_horizbar\";\n\tif (k == XK_Greek_alphaaccent) return \"Greek_alphaaccent\";\n\tif (k == XK_Greek_epsilonaccent) return \"Greek_epsilonaccent\";\n\tif (k == XK_Greek_etaaccent) return \"Greek_etaaccent\";\n\tif (k == XK_Greek_iotaaccent) return \"Greek_iotaaccent\";\n\tif (k == XK_Greek_iotadieresis) return \"Greek_iotadieresis\";\n\tif (k == XK_Greek_iotaaccentdieresis) return \"Greek_iotaaccentdieresis\";\n\tif (k == XK_Greek_omicronaccent) return \"Greek_omicronaccent\";\n\tif (k == XK_Greek_upsilonaccent) return \"Greek_upsilonaccent\";\n\tif (k == XK_Greek_upsilondieresis) return \"Greek_upsilondieresis\";\n\tif (k == XK_Greek_upsilonaccentdieresis) return \"Greek_upsilonaccentdieresis\";\n\tif (k == XK_Greek_omegaaccent) return \"Greek_omegaaccent\";\n\tif (k == XK_Greek_ALPHA) return \"Greek_ALPHA\";\n\tif (k == XK_Greek_BETA) return \"Greek_BETA\";\n\tif (k == XK_Greek_GAMMA) return \"Greek_GAMMA\";\n\tif (k == XK_Greek_DELTA) return \"Greek_DELTA\";\n\tif (k == XK_Greek_EPSILON) return \"Greek_EPSILON\";\n\tif (k == XK_Greek_ZETA) return \"Greek_ZETA\";\n\tif (k == XK_Greek_ETA) return \"Greek_ETA\";\n\tif (k == XK_Greek_THETA) return \"Greek_THETA\";\n\tif (k == XK_Greek_IOTA) return \"Greek_IOTA\";\n\tif (k == XK_Greek_KAPPA) return \"Greek_KAPPA\";\n\tif (k == XK_Greek_LAMDA) return \"Greek_LAMDA\";\n\tif (k == XK_Greek_LAMBDA) return \"Greek_LAMBDA\";\n\tif (k == XK_Greek_MU) return \"Greek_MU\";\n\tif (k == XK_Greek_NU) return \"Greek_NU\";\n\tif (k == XK_Greek_XI) return \"Greek_XI\";\n\tif (k == XK_Greek_OMICRON) return \"Greek_OMICRON\";\n\tif (k == XK_Greek_PI) return \"Greek_PI\";\n\tif (k == XK_Greek_RHO) return \"Greek_RHO\";\n\tif (k == XK_Greek_SIGMA) return \"Greek_SIGMA\";\n\tif (k == XK_Greek_TAU) return \"Greek_TAU\";\n\tif (k == XK_Greek_UPSILON) return \"Greek_UPSILON\";\n\tif (k == XK_Greek_PHI) return \"Greek_PHI\";\n\tif (k == XK_Greek_CHI) return \"Greek_CHI\";\n\tif (k == XK_Greek_PSI) return \"Greek_PSI\";\n\tif (k == XK_Greek_OMEGA) return \"Greek_OMEGA\";\n\tif (k == XK_Greek_alpha) return \"Greek_alpha\";\n\tif (k == XK_Greek_beta) return \"Greek_beta\";\n\tif (k == XK_Greek_gamma) return \"Greek_gamma\";\n\tif (k == XK_Greek_delta) return \"Greek_delta\";\n\tif (k == XK_Greek_epsilon) return \"Greek_epsilon\";\n\tif (k == XK_Greek_zeta) return \"Greek_zeta\";\n\tif (k == XK_Greek_eta) return \"Greek_eta\";\n\tif (k == XK_Greek_theta) return \"Greek_theta\";\n\tif (k == XK_Greek_iota) return \"Greek_iota\";\n\tif (k == XK_Greek_kappa) return \"Greek_kappa\";\n\tif (k == XK_Greek_lamda) return \"Greek_lamda\";\n\tif (k == XK_Greek_lambda) return \"Greek_lambda\";\n\tif (k == XK_Greek_mu) return \"Greek_mu\";\n\tif (k == XK_Greek_nu) return \"Greek_nu\";\n\tif (k == XK_Greek_xi) return \"Greek_xi\";\n\tif (k == XK_Greek_omicron) return \"Greek_omicron\";\n\tif (k == XK_Greek_pi) return \"Greek_pi\";\n\tif (k == XK_Greek_rho) return \"Greek_rho\";\n\tif (k == XK_Greek_sigma) return \"Greek_sigma\";\n\tif (k == XK_Greek_finalsmallsigma) return \"Greek_finalsmallsigma\";\n\tif (k == XK_Greek_tau) return \"Greek_tau\";\n\tif (k == XK_Greek_upsilon) return \"Greek_upsilon\";\n\tif (k == XK_Greek_phi) return \"Greek_phi\";\n\tif (k == XK_Greek_chi) return \"Greek_chi\";\n\tif (k == XK_Greek_psi) return \"Greek_psi\";\n\tif (k == XK_Greek_omega) return \"Greek_omega\";\n\tif (k == XK_Greek_switch) return \"Greek_switch\";\n#endif /* XK_GREEK */\n#ifdef XK_TECHNICAL\n\tif (k == XK_leftradical) return \"leftradical\";\n\tif (k == XK_topleftradical) return \"topleftradical\";\n\tif (k == XK_horizconnector) return \"horizconnector\";\n\tif (k == XK_topintegral) return \"topintegral\";\n\tif (k == XK_botintegral) return \"botintegral\";\n\tif (k == XK_vertconnector) return \"vertconnector\";\n\tif (k == XK_topleftsqbracket) return \"topleftsqbracket\";\n\tif (k == XK_botleftsqbracket) return \"botleftsqbracket\";\n\tif (k == XK_toprightsqbracket) return \"toprightsqbracket\";\n\tif (k == XK_botrightsqbracket) return \"botrightsqbracket\";\n\tif (k == XK_topleftparens) return \"topleftparens\";\n\tif (k == XK_botleftparens) return \"botleftparens\";\n\tif (k == XK_toprightparens) return \"toprightparens\";\n\tif (k == XK_botrightparens) return \"botrightparens\";\n\tif (k == XK_leftmiddlecurlybrace) return \"leftmiddlecurlybrace\";\n\tif (k == XK_rightmiddlecurlybrace) return \"rightmiddlecurlybrace\";\n\tif (k == XK_topleftsummation) return \"topleftsummation\";\n\tif (k == XK_botleftsummation) return \"botleftsummation\";\n\tif (k == XK_topvertsummationconnector) return \"topvertsummationconnector\";\n\tif (k == XK_botvertsummationconnector) return \"botvertsummationconnector\";\n\tif (k == XK_toprightsummation) return \"toprightsummation\";\n\tif (k == XK_botrightsummation) return \"botrightsummation\";\n\tif (k == XK_rightmiddlesummation) return \"rightmiddlesummation\";\n\tif (k == XK_lessthanequal) return \"lessthanequal\";\n\tif (k == XK_notequal) return \"notequal\";\n\tif (k == XK_greaterthanequal) return \"greaterthanequal\";\n\tif (k == XK_integral) return \"integral\";\n\tif (k == XK_therefore) return \"therefore\";\n\tif (k == XK_variation) return \"variation\";\n\tif (k == XK_infinity) return \"infinity\";\n\tif (k == XK_nabla) return \"nabla\";\n\tif (k == XK_approximate) return \"approximate\";\n\tif (k == XK_similarequal) return \"similarequal\";\n\tif (k == XK_ifonlyif) return \"ifonlyif\";\n\tif (k == XK_implies) return \"implies\";\n\tif (k == XK_identical) return \"identical\";\n\tif (k == XK_radical) return \"radical\";\n\tif (k == XK_includedin) return \"includedin\";\n\tif (k == XK_includes) return \"includes\";\n\tif (k == XK_intersection) return \"intersection\";\n\tif (k == XK_union) return \"union\";\n\tif (k == XK_logicaland) return \"logicaland\";\n\tif (k == XK_logicalor) return \"logicalor\";\n\tif (k == XK_partialderivative) return \"partialderivative\";\n\tif (k == XK_function) return \"function\";\n\tif (k == XK_leftarrow) return \"leftarrow\";\n\tif (k == XK_uparrow) return \"uparrow\";\n\tif (k == XK_rightarrow) return \"rightarrow\";\n\tif (k == XK_downarrow) return \"downarrow\";\n#endif /* XK_TECHNICAL */\n#ifdef XK_SPECIAL\n\tif (k == XK_blank) return \"blank\";\n\tif (k == XK_soliddiamond) return \"soliddiamond\";\n\tif (k == XK_checkerboard) return \"checkerboard\";\n\tif (k == XK_ht) return \"ht\";\n\tif (k == XK_ff) return \"ff\";\n\tif (k == XK_cr) return \"cr\";\n\tif (k == XK_lf) return \"lf\";\n\tif (k == XK_nl) return \"nl\";\n\tif (k == XK_vt) return \"vt\";\n\tif (k == XK_lowrightcorner) return \"lowrightcorner\";\n\tif (k == XK_uprightcorner) return \"uprightcorner\";\n\tif (k == XK_upleftcorner) return \"upleftcorner\";\n\tif (k == XK_lowleftcorner) return \"lowleftcorner\";\n\tif (k == XK_crossinglines) return \"crossinglines\";\n\tif (k == XK_horizlinescan1) return \"horizlinescan1\";\n\tif (k == XK_horizlinescan3) return \"horizlinescan3\";\n\tif (k == XK_horizlinescan5) return \"horizlinescan5\";\n\tif (k == XK_horizlinescan7) return \"horizlinescan7\";\n\tif (k == XK_horizlinescan9) return \"horizlinescan9\";\n\tif (k == XK_leftt) return \"leftt\";\n\tif (k == XK_rightt) return \"rightt\";\n\tif (k == XK_bott) return \"bott\";\n\tif (k == XK_topt) return \"topt\";\n\tif (k == XK_vertbar) return \"vertbar\";\n#endif /* XK_SPECIAL */\n#ifdef XK_PUBLISHING\n\tif (k == XK_emspace) return \"emspace\";\n\tif (k == XK_enspace) return \"enspace\";\n\tif (k == XK_em3space) return \"em3space\";\n\tif (k == XK_em4space) return \"em4space\";\n\tif (k == XK_digitspace) return \"digitspace\";\n\tif (k == XK_punctspace) return \"punctspace\";\n\tif (k == XK_thinspace) return \"thinspace\";\n\tif (k == XK_hairspace) return \"hairspace\";\n\tif (k == XK_emdash) return \"emdash\";\n\tif (k == XK_endash) return \"endash\";\n\tif (k == XK_signifblank) return \"signifblank\";\n\tif (k == XK_ellipsis) return \"ellipsis\";\n\tif (k == XK_doubbaselinedot) return \"doubbaselinedot\";\n\tif (k == XK_onethird) return \"onethird\";\n\tif (k == XK_twothirds) return \"twothirds\";\n\tif (k == XK_onefifth) return \"onefifth\";\n\tif (k == XK_twofifths) return \"twofifths\";\n\tif (k == XK_threefifths) return \"threefifths\";\n\tif (k == XK_fourfifths) return \"fourfifths\";\n\tif (k == XK_onesixth) return \"onesixth\";\n\tif (k == XK_fivesixths) return \"fivesixths\";\n\tif (k == XK_careof) return \"careof\";\n\tif (k == XK_figdash) return \"figdash\";\n\tif (k == XK_leftanglebracket) return \"leftanglebracket\";\n\tif (k == XK_decimalpoint) return \"decimalpoint\";\n\tif (k == XK_rightanglebracket) return \"rightanglebracket\";\n\tif (k == XK_marker) return \"marker\";\n\tif (k == XK_oneeighth) return \"oneeighth\";\n\tif (k == XK_threeeighths) return \"threeeighths\";\n\tif (k == XK_fiveeighths) return \"fiveeighths\";\n\tif (k == XK_seveneighths) return \"seveneighths\";\n\tif (k == XK_trademark) return \"trademark\";\n\tif (k == XK_signaturemark) return \"signaturemark\";\n\tif (k == XK_trademarkincircle) return \"trademarkincircle\";\n\tif (k == XK_leftopentriangle) return \"leftopentriangle\";\n\tif (k == XK_rightopentriangle) return \"rightopentriangle\";\n\tif (k == XK_emopencircle) return \"emopencircle\";\n\tif (k == XK_emopenrectangle) return \"emopenrectangle\";\n\tif (k == XK_leftsinglequotemark) return \"leftsinglequotemark\";\n\tif (k == XK_rightsinglequotemark) return \"rightsinglequotemark\";\n\tif (k == XK_leftdoublequotemark) return \"leftdoublequotemark\";\n\tif (k == XK_rightdoublequotemark) return \"rightdoublequotemark\";\n\tif (k == XK_prescription) return \"prescription\";\n\tif (k == XK_minutes) return \"minutes\";\n\tif (k == XK_seconds) return \"seconds\";\n\tif (k == XK_latincross) return \"latincross\";\n\tif (k == XK_hexagram) return \"hexagram\";\n\tif (k == XK_filledrectbullet) return \"filledrectbullet\";\n\tif (k == XK_filledlefttribullet) return \"filledlefttribullet\";\n\tif (k == XK_filledrighttribullet) return \"filledrighttribullet\";\n\tif (k == XK_emfilledcircle) return \"emfilledcircle\";\n\tif (k == XK_emfilledrect) return \"emfilledrect\";\n\tif (k == XK_enopencircbullet) return \"enopencircbullet\";\n\tif (k == XK_enopensquarebullet) return \"enopensquarebullet\";\n\tif (k == XK_openrectbullet) return \"openrectbullet\";\n\tif (k == XK_opentribulletup) return \"opentribulletup\";\n\tif (k == XK_opentribulletdown) return \"opentribulletdown\";\n\tif (k == XK_openstar) return \"openstar\";\n\tif (k == XK_enfilledcircbullet) return \"enfilledcircbullet\";\n\tif (k == XK_enfilledsqbullet) return \"enfilledsqbullet\";\n\tif (k == XK_filledtribulletup) return \"filledtribulletup\";\n\tif (k == XK_filledtribulletdown) return \"filledtribulletdown\";\n\tif (k == XK_leftpointer) return \"leftpointer\";\n\tif (k == XK_rightpointer) return \"rightpointer\";\n\tif (k == XK_club) return \"club\";\n\tif (k == XK_diamond) return \"diamond\";\n\tif (k == XK_heart) return \"heart\";\n\tif (k == XK_maltesecross) return \"maltesecross\";\n\tif (k == XK_dagger) return \"dagger\";\n\tif (k == XK_doubledagger) return \"doubledagger\";\n\tif (k == XK_checkmark) return \"checkmark\";\n\tif (k == XK_ballotcross) return \"ballotcross\";\n\tif (k == XK_musicalsharp) return \"musicalsharp\";\n\tif (k == XK_musicalflat) return \"musicalflat\";\n\tif (k == XK_malesymbol) return \"malesymbol\";\n\tif (k == XK_femalesymbol) return \"femalesymbol\";\n\tif (k == XK_telephone) return \"telephone\";\n\tif (k == XK_telephonerecorder) return \"telephonerecorder\";\n\tif (k == XK_phonographcopyright) return \"phonographcopyright\";\n\tif (k == XK_caret) return \"caret\";\n\tif (k == XK_singlelowquotemark) return \"singlelowquotemark\";\n\tif (k == XK_doublelowquotemark) return \"doublelowquotemark\";\n\tif (k == XK_cursor) return \"cursor\";\n#endif /* XK_PUBLISHING */\n#ifdef XK_APL\n\tif (k == XK_leftcaret) return \"leftcaret\";\n\tif (k == XK_rightcaret) return \"rightcaret\";\n\tif (k == XK_downcaret) return \"downcaret\";\n\tif (k == XK_upcaret) return \"upcaret\";\n\tif (k == XK_overbar) return \"overbar\";\n\tif (k == XK_downtack) return \"downtack\";\n\tif (k == XK_upshoe) return \"upshoe\";\n\tif (k == XK_downstile) return \"downstile\";\n\tif (k == XK_underbar) return \"underbar\";\n\tif (k == XK_jot) return \"jot\";\n\tif (k == XK_quad) return \"quad\";\n\tif (k == XK_uptack) return \"uptack\";\n\tif (k == XK_circle) return \"circle\";\n\tif (k == XK_upstile) return \"upstile\";\n\tif (k == XK_downshoe) return \"downshoe\";\n\tif (k == XK_rightshoe) return \"rightshoe\";\n\tif (k == XK_leftshoe) return \"leftshoe\";\n\tif (k == XK_lefttack) return \"lefttack\";\n\tif (k == XK_righttack) return \"righttack\";\n#endif /* XK_APL */\n#ifdef XK_HEBREW\n\tif (k == XK_hebrew_doublelowline) return \"hebrew_doublelowline\";\n\tif (k == XK_hebrew_aleph) return \"hebrew_aleph\";\n\tif (k == XK_hebrew_bet) return \"hebrew_bet\";\n\tif (k == XK_hebrew_beth) return \"hebrew_beth\";\n\tif (k == XK_hebrew_gimel) return \"hebrew_gimel\";\n\tif (k == XK_hebrew_gimmel) return \"hebrew_gimmel\";\n\tif (k == XK_hebrew_dalet) return \"hebrew_dalet\";\n\tif (k == XK_hebrew_daleth) return \"hebrew_daleth\";\n\tif (k == XK_hebrew_he) return \"hebrew_he\";\n\tif (k == XK_hebrew_waw) return \"hebrew_waw\";\n\tif (k == XK_hebrew_zain) return \"hebrew_zain\";\n\tif (k == XK_hebrew_zayin) return \"hebrew_zayin\";\n\tif (k == XK_hebrew_chet) return \"hebrew_chet\";\n\tif (k == XK_hebrew_het) return \"hebrew_het\";\n\tif (k == XK_hebrew_tet) return \"hebrew_tet\";\n\tif (k == XK_hebrew_teth) return \"hebrew_teth\";\n\tif (k == XK_hebrew_yod) return \"hebrew_yod\";\n\tif (k == XK_hebrew_finalkaph) return \"hebrew_finalkaph\";\n\tif (k == XK_hebrew_kaph) return \"hebrew_kaph\";\n\tif (k == XK_hebrew_lamed) return \"hebrew_lamed\";\n\tif (k == XK_hebrew_finalmem) return \"hebrew_finalmem\";\n\tif (k == XK_hebrew_mem) return \"hebrew_mem\";\n\tif (k == XK_hebrew_finalnun) return \"hebrew_finalnun\";\n\tif (k == XK_hebrew_nun) return \"hebrew_nun\";\n\tif (k == XK_hebrew_samech) return \"hebrew_samech\";\n\tif (k == XK_hebrew_samekh) return \"hebrew_samekh\";\n\tif (k == XK_hebrew_ayin) return \"hebrew_ayin\";\n\tif (k == XK_hebrew_finalpe) return \"hebrew_finalpe\";\n\tif (k == XK_hebrew_pe) return \"hebrew_pe\";\n\tif (k == XK_hebrew_finalzade) return \"hebrew_finalzade\";\n\tif (k == XK_hebrew_finalzadi) return \"hebrew_finalzadi\";\n\tif (k == XK_hebrew_zade) return \"hebrew_zade\";\n\tif (k == XK_hebrew_zadi) return \"hebrew_zadi\";\n\tif (k == XK_hebrew_qoph) return \"hebrew_qoph\";\n\tif (k == XK_hebrew_kuf) return \"hebrew_kuf\";\n\tif (k == XK_hebrew_resh) return \"hebrew_resh\";\n\tif (k == XK_hebrew_shin) return \"hebrew_shin\";\n\tif (k == XK_hebrew_taw) return \"hebrew_taw\";\n\tif (k == XK_hebrew_taf) return \"hebrew_taf\";\n\tif (k == XK_Hebrew_switch) return \"Hebrew_switch\";\n#endif /* XK_HEBREW */\n#ifdef XK_THAI\n\tif (k == XK_Thai_kokai) return \"Thai_kokai\";\n\tif (k == XK_Thai_khokhai) return \"Thai_khokhai\";\n\tif (k == XK_Thai_khokhuat) return \"Thai_khokhuat\";\n\tif (k == XK_Thai_khokhwai) return \"Thai_khokhwai\";\n\tif (k == XK_Thai_khokhon) return \"Thai_khokhon\";\n\tif (k == XK_Thai_khorakhang) return \"Thai_khorakhang\";\n\tif (k == XK_Thai_ngongu) return \"Thai_ngongu\";\n\tif (k == XK_Thai_chochan) return \"Thai_chochan\";\n\tif (k == XK_Thai_choching) return \"Thai_choching\";\n\tif (k == XK_Thai_chochang) return \"Thai_chochang\";\n\tif (k == XK_Thai_soso) return \"Thai_soso\";\n\tif (k == XK_Thai_chochoe) return \"Thai_chochoe\";\n\tif (k == XK_Thai_yoying) return \"Thai_yoying\";\n\tif (k == XK_Thai_dochada) return \"Thai_dochada\";\n\tif (k == XK_Thai_topatak) return \"Thai_topatak\";\n\tif (k == XK_Thai_thothan) return \"Thai_thothan\";\n\tif (k == XK_Thai_thonangmontho) return \"Thai_thonangmontho\";\n\tif (k == XK_Thai_thophuthao) return \"Thai_thophuthao\";\n\tif (k == XK_Thai_nonen) return \"Thai_nonen\";\n\tif (k == XK_Thai_dodek) return \"Thai_dodek\";\n\tif (k == XK_Thai_totao) return \"Thai_totao\";\n\tif (k == XK_Thai_thothung) return \"Thai_thothung\";\n\tif (k == XK_Thai_thothahan) return \"Thai_thothahan\";\n\tif (k == XK_Thai_thothong) return \"Thai_thothong\";\n\tif (k == XK_Thai_nonu) return \"Thai_nonu\";\n\tif (k == XK_Thai_bobaimai) return \"Thai_bobaimai\";\n\tif (k == XK_Thai_popla) return \"Thai_popla\";\n\tif (k == XK_Thai_phophung) return \"Thai_phophung\";\n\tif (k == XK_Thai_fofa) return \"Thai_fofa\";\n\tif (k == XK_Thai_phophan) return \"Thai_phophan\";\n\tif (k == XK_Thai_fofan) return \"Thai_fofan\";\n\tif (k == XK_Thai_phosamphao) return \"Thai_phosamphao\";\n\tif (k == XK_Thai_moma) return \"Thai_moma\";\n\tif (k == XK_Thai_yoyak) return \"Thai_yoyak\";\n\tif (k == XK_Thai_rorua) return \"Thai_rorua\";\n\tif (k == XK_Thai_ru) return \"Thai_ru\";\n\tif (k == XK_Thai_loling) return \"Thai_loling\";\n\tif (k == XK_Thai_lu) return \"Thai_lu\";\n\tif (k == XK_Thai_wowaen) return \"Thai_wowaen\";\n\tif (k == XK_Thai_sosala) return \"Thai_sosala\";\n\tif (k == XK_Thai_sorusi) return \"Thai_sorusi\";\n\tif (k == XK_Thai_sosua) return \"Thai_sosua\";\n\tif (k == XK_Thai_hohip) return \"Thai_hohip\";\n\tif (k == XK_Thai_lochula) return \"Thai_lochula\";\n\tif (k == XK_Thai_oang) return \"Thai_oang\";\n\tif (k == XK_Thai_honokhuk) return \"Thai_honokhuk\";\n\tif (k == XK_Thai_paiyannoi) return \"Thai_paiyannoi\";\n\tif (k == XK_Thai_saraa) return \"Thai_saraa\";\n\tif (k == XK_Thai_maihanakat) return \"Thai_maihanakat\";\n\tif (k == XK_Thai_saraaa) return \"Thai_saraaa\";\n\tif (k == XK_Thai_saraam) return \"Thai_saraam\";\n\tif (k == XK_Thai_sarai) return \"Thai_sarai\";\n\tif (k == XK_Thai_saraii) return \"Thai_saraii\";\n\tif (k == XK_Thai_saraue) return \"Thai_saraue\";\n\tif (k == XK_Thai_sarauee) return \"Thai_sarauee\";\n\tif (k == XK_Thai_sarau) return \"Thai_sarau\";\n\tif (k == XK_Thai_sarauu) return \"Thai_sarauu\";\n\tif (k == XK_Thai_phinthu) return \"Thai_phinthu\";\n\tif (k == XK_Thai_maihanakat_maitho) return \"Thai_maihanakat_maitho\";\n\tif (k == XK_Thai_baht) return \"Thai_baht\";\n\tif (k == XK_Thai_sarae) return \"Thai_sarae\";\n\tif (k == XK_Thai_saraae) return \"Thai_saraae\";\n\tif (k == XK_Thai_sarao) return \"Thai_sarao\";\n\tif (k == XK_Thai_saraaimaimuan) return \"Thai_saraaimaimuan\";\n\tif (k == XK_Thai_saraaimaimalai) return \"Thai_saraaimaimalai\";\n\tif (k == XK_Thai_lakkhangyao) return \"Thai_lakkhangyao\";\n\tif (k == XK_Thai_maiyamok) return \"Thai_maiyamok\";\n\tif (k == XK_Thai_maitaikhu) return \"Thai_maitaikhu\";\n\tif (k == XK_Thai_maiek) return \"Thai_maiek\";\n\tif (k == XK_Thai_maitho) return \"Thai_maitho\";\n\tif (k == XK_Thai_maitri) return \"Thai_maitri\";\n\tif (k == XK_Thai_maichattawa) return \"Thai_maichattawa\";\n\tif (k == XK_Thai_thanthakhat) return \"Thai_thanthakhat\";\n\tif (k == XK_Thai_nikhahit) return \"Thai_nikhahit\";\n\tif (k == XK_Thai_leksun) return \"Thai_leksun\";\n\tif (k == XK_Thai_leknung) return \"Thai_leknung\";\n\tif (k == XK_Thai_leksong) return \"Thai_leksong\";\n\tif (k == XK_Thai_leksam) return \"Thai_leksam\";\n\tif (k == XK_Thai_leksi) return \"Thai_leksi\";\n\tif (k == XK_Thai_lekha) return \"Thai_lekha\";\n\tif (k == XK_Thai_lekhok) return \"Thai_lekhok\";\n\tif (k == XK_Thai_lekchet) return \"Thai_lekchet\";\n\tif (k == XK_Thai_lekpaet) return \"Thai_lekpaet\";\n\tif (k == XK_Thai_lekkao) return \"Thai_lekkao\";\n#endif /* XK_THAI */\n#ifdef XK_KOREAN\n\tif (k == XK_Hangul) return \"Hangul\";\n\tif (k == XK_Hangul_Start) return \"Hangul_Start\";\n\tif (k == XK_Hangul_End) return \"Hangul_End\";\n\tif (k == XK_Hangul_Hanja) return \"Hangul_Hanja\";\n\tif (k == XK_Hangul_Jamo) return \"Hangul_Jamo\";\n\tif (k == XK_Hangul_Romaja) return \"Hangul_Romaja\";\n\tif (k == XK_Hangul_Codeinput) return \"Hangul_Codeinput\";\n\tif (k == XK_Hangul_Jeonja) return \"Hangul_Jeonja\";\n\tif (k == XK_Hangul_Banja) return \"Hangul_Banja\";\n\tif (k == XK_Hangul_PreHanja) return \"Hangul_PreHanja\";\n\tif (k == XK_Hangul_PostHanja) return \"Hangul_PostHanja\";\n\tif (k == XK_Hangul_SingleCandidate) return \"Hangul_SingleCandidate\";\n\tif (k == XK_Hangul_MultipleCandidate) return \"Hangul_MultipleCandidate\";\n\tif (k == XK_Hangul_PreviousCandidate) return \"Hangul_PreviousCandidate\";\n\tif (k == XK_Hangul_Special) return \"Hangul_Special\";\n\tif (k == XK_Hangul_switch) return \"Hangul_switch\";\n\tif (k == XK_Hangul_Kiyeog) return \"Hangul_Kiyeog\";\n\tif (k == XK_Hangul_SsangKiyeog) return \"Hangul_SsangKiyeog\";\n\tif (k == XK_Hangul_KiyeogSios) return \"Hangul_KiyeogSios\";\n\tif (k == XK_Hangul_Nieun) return \"Hangul_Nieun\";\n\tif (k == XK_Hangul_NieunJieuj) return \"Hangul_NieunJieuj\";\n\tif (k == XK_Hangul_NieunHieuh) return \"Hangul_NieunHieuh\";\n\tif (k == XK_Hangul_Dikeud) return \"Hangul_Dikeud\";\n\tif (k == XK_Hangul_SsangDikeud) return \"Hangul_SsangDikeud\";\n\tif (k == XK_Hangul_Rieul) return \"Hangul_Rieul\";\n\tif (k == XK_Hangul_RieulKiyeog) return \"Hangul_RieulKiyeog\";\n\tif (k == XK_Hangul_RieulMieum) return \"Hangul_RieulMieum\";\n\tif (k == XK_Hangul_RieulPieub) return \"Hangul_RieulPieub\";\n\tif (k == XK_Hangul_RieulSios) return \"Hangul_RieulSios\";\n\tif (k == XK_Hangul_RieulTieut) return \"Hangul_RieulTieut\";\n\tif (k == XK_Hangul_RieulPhieuf) return \"Hangul_RieulPhieuf\";\n\tif (k == XK_Hangul_RieulHieuh) return \"Hangul_RieulHieuh\";\n\tif (k == XK_Hangul_Mieum) return \"Hangul_Mieum\";\n\tif (k == XK_Hangul_Pieub) return \"Hangul_Pieub\";\n\tif (k == XK_Hangul_SsangPieub) return \"Hangul_SsangPieub\";\n\tif (k == XK_Hangul_PieubSios) return \"Hangul_PieubSios\";\n\tif (k == XK_Hangul_Sios) return \"Hangul_Sios\";\n\tif (k == XK_Hangul_SsangSios) return \"Hangul_SsangSios\";\n\tif (k == XK_Hangul_Ieung) return \"Hangul_Ieung\";\n\tif (k == XK_Hangul_Jieuj) return \"Hangul_Jieuj\";\n\tif (k == XK_Hangul_SsangJieuj) return \"Hangul_SsangJieuj\";\n\tif (k == XK_Hangul_Cieuc) return \"Hangul_Cieuc\";\n\tif (k == XK_Hangul_Khieuq) return \"Hangul_Khieuq\";\n\tif (k == XK_Hangul_Tieut) return \"Hangul_Tieut\";\n\tif (k == XK_Hangul_Phieuf) return \"Hangul_Phieuf\";\n\tif (k == XK_Hangul_Hieuh) return \"Hangul_Hieuh\";\n\tif (k == XK_Hangul_A) return \"Hangul_A\";\n\tif (k == XK_Hangul_AE) return \"Hangul_AE\";\n\tif (k == XK_Hangul_YA) return \"Hangul_YA\";\n\tif (k == XK_Hangul_YAE) return \"Hangul_YAE\";\n\tif (k == XK_Hangul_EO) return \"Hangul_EO\";\n\tif (k == XK_Hangul_E) return \"Hangul_E\";\n\tif (k == XK_Hangul_YEO) return \"Hangul_YEO\";\n\tif (k == XK_Hangul_YE) return \"Hangul_YE\";\n\tif (k == XK_Hangul_O) return \"Hangul_O\";\n\tif (k == XK_Hangul_WA) return \"Hangul_WA\";\n\tif (k == XK_Hangul_WAE) return \"Hangul_WAE\";\n\tif (k == XK_Hangul_OE) return \"Hangul_OE\";\n\tif (k == XK_Hangul_YO) return \"Hangul_YO\";\n\tif (k == XK_Hangul_U) return \"Hangul_U\";\n\tif (k == XK_Hangul_WEO) return \"Hangul_WEO\";\n\tif (k == XK_Hangul_WE) return \"Hangul_WE\";\n\tif (k == XK_Hangul_WI) return \"Hangul_WI\";\n\tif (k == XK_Hangul_YU) return \"Hangul_YU\";\n\tif (k == XK_Hangul_EU) return \"Hangul_EU\";\n\tif (k == XK_Hangul_YI) return \"Hangul_YI\";\n\tif (k == XK_Hangul_I) return \"Hangul_I\";\n\tif (k == XK_Hangul_J_Kiyeog) return \"Hangul_J_Kiyeog\";\n\tif (k == XK_Hangul_J_SsangKiyeog) return \"Hangul_J_SsangKiyeog\";\n\tif (k == XK_Hangul_J_KiyeogSios) return \"Hangul_J_KiyeogSios\";\n\tif (k == XK_Hangul_J_Nieun) return \"Hangul_J_Nieun\";\n\tif (k == XK_Hangul_J_NieunJieuj) return \"Hangul_J_NieunJieuj\";\n\tif (k == XK_Hangul_J_NieunHieuh) return \"Hangul_J_NieunHieuh\";\n\tif (k == XK_Hangul_J_Dikeud) return \"Hangul_J_Dikeud\";\n\tif (k == XK_Hangul_J_Rieul) return \"Hangul_J_Rieul\";\n\tif (k == XK_Hangul_J_RieulKiyeog) return \"Hangul_J_RieulKiyeog\";\n\tif (k == XK_Hangul_J_RieulMieum) return \"Hangul_J_RieulMieum\";\n\tif (k == XK_Hangul_J_RieulPieub) return \"Hangul_J_RieulPieub\";\n\tif (k == XK_Hangul_J_RieulSios) return \"Hangul_J_RieulSios\";\n\tif (k == XK_Hangul_J_RieulTieut) return \"Hangul_J_RieulTieut\";\n\tif (k == XK_Hangul_J_RieulPhieuf) return \"Hangul_J_RieulPhieuf\";\n\tif (k == XK_Hangul_J_RieulHieuh) return \"Hangul_J_RieulHieuh\";\n\tif (k == XK_Hangul_J_Mieum) return \"Hangul_J_Mieum\";\n\tif (k == XK_Hangul_J_Pieub) return \"Hangul_J_Pieub\";\n\tif (k == XK_Hangul_J_PieubSios) return \"Hangul_J_PieubSios\";\n\tif (k == XK_Hangul_J_Sios) return \"Hangul_J_Sios\";\n\tif (k == XK_Hangul_J_SsangSios) return \"Hangul_J_SsangSios\";\n\tif (k == XK_Hangul_J_Ieung) return \"Hangul_J_Ieung\";\n\tif (k == XK_Hangul_J_Jieuj) return \"Hangul_J_Jieuj\";\n\tif (k == XK_Hangul_J_Cieuc) return \"Hangul_J_Cieuc\";\n\tif (k == XK_Hangul_J_Khieuq) return \"Hangul_J_Khieuq\";\n\tif (k == XK_Hangul_J_Tieut) return \"Hangul_J_Tieut\";\n\tif (k == XK_Hangul_J_Phieuf) return \"Hangul_J_Phieuf\";\n\tif (k == XK_Hangul_J_Hieuh) return \"Hangul_J_Hieuh\";\n\tif (k == XK_Hangul_RieulYeorinHieuh) return \"Hangul_RieulYeorinHieuh\";\n\tif (k == XK_Hangul_SunkyeongeumMieum) return \"Hangul_SunkyeongeumMieum\";\n\tif (k == XK_Hangul_SunkyeongeumPieub) return \"Hangul_SunkyeongeumPieub\";\n\tif (k == XK_Hangul_PanSios) return \"Hangul_PanSios\";\n\tif (k == XK_Hangul_KkogjiDalrinIeung) return \"Hangul_KkogjiDalrinIeung\";\n\tif (k == XK_Hangul_SunkyeongeumPhieuf) return \"Hangul_SunkyeongeumPhieuf\";\n\tif (k == XK_Hangul_YeorinHieuh) return \"Hangul_YeorinHieuh\";\n\tif (k == XK_Hangul_AraeA) return \"Hangul_AraeA\";\n\tif (k == XK_Hangul_AraeAE) return \"Hangul_AraeAE\";\n\tif (k == XK_Hangul_J_PanSios) return \"Hangul_J_PanSios\";\n\tif (k == XK_Hangul_J_KkogjiDalrinIeung) return \"Hangul_J_KkogjiDalrinIeung\";\n\tif (k == XK_Hangul_J_YeorinHieuh) return \"Hangul_J_YeorinHieuh\";\n\tif (k == XK_Korean_Won) return \"Korean_Won\";\n#endif /* XK_KOREAN */\n\tif (k == XK_EuroSign) return \"EuroSign\";\n#endif\n\treturn NULL;\t\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "char *XKeysymToString(KeySym k) {\n#ifndef XK_0_nosuch\n\tif (k == XK_VoidSymbol) return \"VoidSymbol\";\n#ifdef XK_MISCELLANY\n\tif (k == XK_BackSpace) return \"BackSpace\";\n\tif (k == XK_Tab) return \"Tab\";\n\tif (k == XK_Linefeed) return \"Linefeed\";\n\tif (k == XK_Clear) return \"Clear\";\n\tif (k == XK_Return) return \"Return\";\n\tif (k == XK_Pause) return \"Pause\";\n\tif (k == XK_Scroll_Lock) return \"Scroll_Lock\";\n\tif (k == XK_Sys_Req) return \"Sys_Req\";\n\tif (k == XK_Escape) return \"Escape\";\n\tif (k == XK_Delete) return \"Delete\";\n\tif (k == XK_Multi_key) return \"Multi_key\";\n\tif (k == XK_SingleCandidate) return \"SingleCandidate\";\n\tif (k == XK_MultipleCandidate) return \"MultipleCandidate\";\n\tif (k == XK_PreviousCandidate) return \"PreviousCandidate\";\n\tif (k == XK_Kanji) return \"Kanji\";\n\tif (k == XK_Muhenkan) return \"Muhenkan\";\n\tif (k == XK_Henkan_Mode) return \"Henkan_Mode\";\n\tif (k == XK_Henkan) return \"Henkan\";\n\tif (k == XK_Romaji) return \"Romaji\";\n\tif (k == XK_Hiragana) return \"Hiragana\";\n\tif (k == XK_Katakana) return \"Katakana\";\n\tif (k == XK_Hiragana_Katakana) return \"Hiragana_Katakana\";\n\tif (k == XK_Zenkaku) return \"Zenkaku\";\n\tif (k == XK_Hankaku) return \"Hankaku\";\n\tif (k == XK_Zenkaku_Hankaku) return \"Zenkaku_Hankaku\";\n\tif (k == XK_Touroku) return \"Touroku\";\n\tif (k == XK_Massyo) return \"Massyo\";\n\tif (k == XK_Kana_Lock) return \"Kana_Lock\";\n\tif (k == XK_Kana_Shift) return \"Kana_Shift\";\n\tif (k == XK_Eisu_Shift) return \"Eisu_Shift\";\n\tif (k == XK_Eisu_toggle) return \"Eisu_toggle\";\n\tif (k == XK_Zen_Koho) return \"Zen_Koho\";\n\tif (k == XK_Mae_Koho) return \"Mae_Koho\";\n\tif (k == XK_Home) return \"Home\";\n\tif (k == XK_Left) return \"Left\";\n\tif (k == XK_Up) return \"Up\";\n\tif (k == XK_Right) return \"Right\";\n\tif (k == XK_Down) return \"Down\";\n\tif (k == XK_Prior) return \"Prior\";\n\tif (k == XK_Page_Up) return \"Page_Up\";\n\tif (k == XK_Next) return \"Next\";\n\tif (k == XK_Page_Down) return \"Page_Down\";\n\tif (k == XK_End) return \"End\";\n\tif (k == XK_Begin) return \"Begin\";\n\tif (k == XK_Select) return \"Select\";\n\tif (k == XK_Print) return \"Print\";\n\tif (k == XK_Execute) return \"Execute\";\n\tif (k == XK_Insert) return \"Insert\";\n\tif (k == XK_Undo) return \"Undo\";\n\tif (k == XK_Redo) return \"Redo\";\n\tif (k == XK_Menu) return \"Menu\";\n\tif (k == XK_Find) return \"Find\";\n\tif (k == XK_Cancel) return \"Cancel\";\n\tif (k == XK_Help) return \"Help\";\n\tif (k == XK_Break) return \"Break\";\n\tif (k == XK_Mode_switch) return \"Mode_switch\";\n\tif (k == XK_script_switch) return \"script_switch\";\n\tif (k == XK_Num_Lock) return \"Num_Lock\";\n\tif (k == XK_KP_Space) return \"KP_Space\";\n\tif (k == XK_KP_Tab) return \"KP_Tab\";\n\tif (k == XK_KP_Enter) return \"KP_Enter\";\n\tif (k == XK_KP_F1) return \"KP_F1\";\n\tif (k == XK_KP_F2) return \"KP_F2\";\n\tif (k == XK_KP_F3) return \"KP_F3\";\n\tif (k == XK_KP_F4) return \"KP_F4\";\n\tif (k == XK_KP_Home) return \"KP_Home\";\n\tif (k == XK_KP_Left) return \"KP_Left\";\n\tif (k == XK_KP_Up) return \"KP_Up\";\n\tif (k == XK_KP_Right) return \"KP_Right\";\n\tif (k == XK_KP_Down) return \"KP_Down\";\n\tif (k == XK_KP_Prior) return \"KP_Prior\";\n\tif (k == XK_KP_Page_Up) return \"KP_Page_Up\";\n\tif (k == XK_KP_Next) return \"KP_Next\";\n\tif (k == XK_KP_Page_Down) return \"KP_Page_Down\";\n\tif (k == XK_KP_End) return \"KP_End\";\n\tif (k == XK_KP_Begin) return \"KP_Begin\";\n\tif (k == XK_KP_Insert) return \"KP_Insert\";\n\tif (k == XK_KP_Delete) return \"KP_Delete\";\n\tif (k == XK_KP_Equal) return \"KP_Equal\";\n\tif (k == XK_KP_Multiply) return \"KP_Multiply\";\n\tif (k == XK_KP_Add) return \"KP_Add\";\n\tif (k == XK_KP_Separator) return \"KP_Separator\";\n\tif (k == XK_KP_Subtract) return \"KP_Subtract\";\n\tif (k == XK_KP_Decimal) return \"KP_Decimal\";\n\tif (k == XK_KP_Divide) return \"KP_Divide\";\n\tif (k == XK_KP_0) return \"KP_0\";\n\tif (k == XK_KP_1) return \"KP_1\";\n\tif (k == XK_KP_2) return \"KP_2\";\n\tif (k == XK_KP_3) return \"KP_3\";\n\tif (k == XK_KP_4) return \"KP_4\";\n\tif (k == XK_KP_5) return \"KP_5\";\n\tif (k == XK_KP_6) return \"KP_6\";\n\tif (k == XK_KP_7) return \"KP_7\";\n\tif (k == XK_KP_8) return \"KP_8\";\n\tif (k == XK_KP_9) return \"KP_9\";\n\tif (k == XK_F1) return \"F1\";\n\tif (k == XK_F2) return \"F2\";\n\tif (k == XK_F3) return \"F3\";\n\tif (k == XK_F4) return \"F4\";\n\tif (k == XK_F5) return \"F5\";\n\tif (k == XK_F6) return \"F6\";\n\tif (k == XK_F7) return \"F7\";\n\tif (k == XK_F8) return \"F8\";\n\tif (k == XK_F9) return \"F9\";\n\tif (k == XK_F10) return \"F10\";\n\tif (k == XK_F11) return \"F11\";\n\tif (k == XK_L1) return \"L1\";\n\tif (k == XK_F12) return \"F12\";\n\tif (k == XK_L2) return \"L2\";\n\tif (k == XK_F13) return \"F13\";\n\tif (k == XK_L3) return \"L3\";\n\tif (k == XK_F14) return \"F14\";\n\tif (k == XK_L4) return \"L4\";\n\tif (k == XK_F15) return \"F15\";\n\tif (k == XK_L5) return \"L5\";\n\tif (k == XK_F16) return \"F16\";\n\tif (k == XK_L6) return \"L6\";\n\tif (k == XK_F17) return \"F17\";\n\tif (k == XK_L7) return \"L7\";\n\tif (k == XK_F18) return \"F18\";\n\tif (k == XK_L8) return \"L8\";\n\tif (k == XK_F19) return \"F19\";\n\tif (k == XK_L9) return \"L9\";\n\tif (k == XK_F20) return \"F20\";\n\tif (k == XK_L10) return \"L10\";\n\tif (k == XK_F21) return \"F21\";\n\tif (k == XK_R1) return \"R1\";\n\tif (k == XK_F22) return \"F22\";\n\tif (k == XK_R2) return \"R2\";\n\tif (k == XK_F23) return \"F23\";\n\tif (k == XK_R3) return \"R3\";\n\tif (k == XK_F24) return \"F24\";\n\tif (k == XK_R4) return \"R4\";\n\tif (k == XK_F25) return \"F25\";\n\tif (k == XK_R5) return \"R5\";\n\tif (k == XK_F26) return \"F26\";\n\tif (k == XK_R6) return \"R6\";\n\tif (k == XK_F27) return \"F27\";\n\tif (k == XK_R7) return \"R7\";\n\tif (k == XK_F28) return \"F28\";\n\tif (k == XK_R8) return \"R8\";\n\tif (k == XK_F29) return \"F29\";\n\tif (k == XK_R9) return \"R9\";\n\tif (k == XK_F30) return \"F30\";\n\tif (k == XK_R10) return \"R10\";\n\tif (k == XK_F31) return \"F31\";\n\tif (k == XK_R11) return \"R11\";\n\tif (k == XK_F32) return \"F32\";\n\tif (k == XK_R12) return \"R12\";\n\tif (k == XK_F33) return \"F33\";\n\tif (k == XK_R13) return \"R13\";\n\tif (k == XK_F34) return \"F34\";\n\tif (k == XK_R14) return \"R14\";\n\tif (k == XK_F35) return \"F35\";\n\tif (k == XK_R15) return \"R15\";\n\tif (k == XK_Shift_L) return \"Shift_L\";\n\tif (k == XK_Shift_R) return \"Shift_R\";\n\tif (k == XK_Control_L) return \"Control_L\";\n\tif (k == XK_Control_R) return \"Control_R\";\n\tif (k == XK_Caps_Lock) return \"Caps_Lock\";\n\tif (k == XK_Shift_Lock) return \"Shift_Lock\";\n\tif (k == XK_Meta_L) return \"Meta_L\";\n\tif (k == XK_Meta_R) return \"Meta_R\";\n\tif (k == XK_Alt_L) return \"Alt_L\";\n\tif (k == XK_Alt_R) return \"Alt_R\";\n\tif (k == XK_Super_L) return \"Super_L\";\n\tif (k == XK_Super_R) return \"Super_R\";\n\tif (k == XK_Hyper_L) return \"Hyper_L\";\n\tif (k == XK_Hyper_R) return \"Hyper_R\";\n#endif /* XK_MISCELLANY */\n#ifdef XK_XKB_KEYS\n\tif (k == XK_ISO_Lock) return \"ISO_Lock\";\n\tif (k == XK_ISO_Level2_Latch) return \"ISO_Level2_Latch\";\n\tif (k == XK_ISO_Level3_Shift) return \"ISO_Level3_Shift\";\n\tif (k == XK_ISO_Level3_Latch) return \"ISO_Level3_Latch\";\n\tif (k == XK_ISO_Level3_Lock) return \"ISO_Level3_Lock\";\n\tif (k == XK_ISO_Group_Shift) return \"ISO_Group_Shift\";\n\tif (k == XK_ISO_Group_Latch) return \"ISO_Group_Latch\";\n\tif (k == XK_ISO_Group_Lock) return \"ISO_Group_Lock\";\n\tif (k == XK_ISO_Next_Group) return \"ISO_Next_Group\";\n\tif (k == XK_ISO_Next_Group_Lock) return \"ISO_Next_Group_Lock\";\n\tif (k == XK_ISO_Prev_Group) return \"ISO_Prev_Group\";\n\tif (k == XK_ISO_Prev_Group_Lock) return \"ISO_Prev_Group_Lock\";\n\tif (k == XK_ISO_First_Group) return \"ISO_First_Group\";\n\tif (k == XK_ISO_First_Group_Lock) return \"ISO_First_Group_Lock\";\n\tif (k == XK_ISO_Last_Group) return \"ISO_Last_Group\";\n\tif (k == XK_ISO_Last_Group_Lock) return \"ISO_Last_Group_Lock\";\n\tif (k == XK_ISO_Left_Tab) return \"ISO_Left_Tab\";\n\tif (k == XK_ISO_Move_Line_Up) return \"ISO_Move_Line_Up\";\n\tif (k == XK_ISO_Move_Line_Down) return \"ISO_Move_Line_Down\";\n\tif (k == XK_ISO_Partial_Line_Up) return \"ISO_Partial_Line_Up\";\n\tif (k == XK_ISO_Partial_Line_Down) return \"ISO_Partial_Line_Down\";\n\tif (k == XK_ISO_Partial_Space_Left) return \"ISO_Partial_Space_Left\";\n\tif (k == XK_ISO_Partial_Space_Right) return \"ISO_Partial_Space_Right\";\n\tif (k == XK_ISO_Set_Margin_Left) return \"ISO_Set_Margin_Left\";\n\tif (k == XK_ISO_Set_Margin_Right) return \"ISO_Set_Margin_Right\";\n\tif (k == XK_ISO_Release_Margin_Left) return \"ISO_Release_Margin_Left\";\n\tif (k == XK_ISO_Release_Margin_Right) return \"ISO_Release_Margin_Right\";\n\tif (k == XK_ISO_Release_Both_Margins) return \"ISO_Release_Both_Margins\";\n\tif (k == XK_ISO_Fast_Cursor_Left) return \"ISO_Fast_Cursor_Left\";\n\tif (k == XK_ISO_Fast_Cursor_Right) return \"ISO_Fast_Cursor_Right\";\n\tif (k == XK_ISO_Fast_Cursor_Up) return \"ISO_Fast_Cursor_Up\";\n\tif (k == XK_ISO_Fast_Cursor_Down) return \"ISO_Fast_Cursor_Down\";\n\tif (k == XK_ISO_Continuous_Underline) return \"ISO_Continuous_Underline\";\n\tif (k == XK_ISO_Discontinuous_Underline) return \"ISO_Discontinuous_Underline\";\n\tif (k == XK_ISO_Emphasize) return \"ISO_Emphasize\";\n\tif (k == XK_ISO_Center_Object) return \"ISO_Center_Object\";\n\tif (k == XK_ISO_Enter) return \"ISO_Enter\";\n\tif (k == XK_dead_grave) return \"dead_grave\";\n\tif (k == XK_dead_acute) return \"dead_acute\";\n\tif (k == XK_dead_circumflex) return \"dead_circumflex\";\n\tif (k == XK_dead_tilde) return \"dead_tilde\";\n\tif (k == XK_dead_macron) return \"dead_macron\";\n\tif (k == XK_dead_breve) return \"dead_breve\";\n\tif (k == XK_dead_abovedot) return \"dead_abovedot\";\n\tif (k == XK_dead_diaeresis) return \"dead_diaeresis\";\n\tif (k == XK_dead_abovering) return \"dead_abovering\";\n\tif (k == XK_dead_doubleacute) return \"dead_doubleacute\";\n\tif (k == XK_dead_caron) return \"dead_caron\";\n\tif (k == XK_dead_cedilla) return \"dead_cedilla\";\n\tif (k == XK_dead_ogonek) return \"dead_ogonek\";\n\tif (k == XK_dead_iota) return \"dead_iota\";\n\tif (k == XK_dead_voiced_sound) return \"dead_voiced_sound\";\n\tif (k == XK_dead_semivoiced_sound) return \"dead_semivoiced_sound\";\n\tif (k == XK_dead_belowdot) return \"dead_belowdot\";\n\tif (k == XK_First_Virtual_Screen) return \"First_Virtual_Screen\";\n\tif (k == XK_Prev_Virtual_Screen) return \"Prev_Virtual_Screen\";\n\tif (k == XK_Next_Virtual_Screen) return \"Next_Virtual_Screen\";\n\tif (k == XK_Last_Virtual_Screen) return \"Last_Virtual_Screen\";\n\tif (k == XK_Terminate_Server) return \"Terminate_Server\";\n\tif (k == XK_AccessX_Enable) return \"AccessX_Enable\";\n\tif (k == XK_AccessX_Feedback_Enable) return \"AccessX_Feedback_Enable\";\n\tif (k == XK_RepeatKeys_Enable) return \"RepeatKeys_Enable\";\n\tif (k == XK_SlowKeys_Enable) return \"SlowKeys_Enable\";\n\tif (k == XK_BounceKeys_Enable) return \"BounceKeys_Enable\";\n\tif (k == XK_StickyKeys_Enable) return \"StickyKeys_Enable\";\n\tif (k == XK_MouseKeys_Enable) return \"MouseKeys_Enable\";\n\tif (k == XK_MouseKeys_Accel_Enable) return \"MouseKeys_Accel_Enable\";\n\tif (k == XK_Overlay1_Enable) return \"Overlay1_Enable\";\n\tif (k == XK_Overlay2_Enable) return \"Overlay2_Enable\";\n\tif (k == XK_AudibleBell_Enable) return \"AudibleBell_Enable\";\n\tif (k == XK_Pointer_Left) return \"Pointer_Left\";\n\tif (k == XK_Pointer_Right) return \"Pointer_Right\";\n\tif (k == XK_Pointer_Up) return \"Pointer_Up\";\n\tif (k == XK_Pointer_Down) return \"Pointer_Down\";\n\tif (k == XK_Pointer_UpLeft) return \"Pointer_UpLeft\";\n\tif (k == XK_Pointer_UpRight) return \"Pointer_UpRight\";\n\tif (k == XK_Pointer_DownLeft) return \"Pointer_DownLeft\";\n\tif (k == XK_Pointer_DownRight) return \"Pointer_DownRight\";\n\tif (k == XK_Pointer_Button_Dflt) return \"Pointer_Button_Dflt\";\n\tif (k == XK_Pointer_Button1) return \"Pointer_Button1\";\n\tif (k == XK_Pointer_Button2) return \"Pointer_Button2\";\n\tif (k == XK_Pointer_Button3) return \"Pointer_Button3\";\n\tif (k == XK_Pointer_Button4) return \"Pointer_Button4\";\n\tif (k == XK_Pointer_Button5) return \"Pointer_Button5\";\n\tif (k == XK_Pointer_DblClick_Dflt) return \"Pointer_DblClick_Dflt\";\n\tif (k == XK_Pointer_DblClick1) return \"Pointer_DblClick1\";\n\tif (k == XK_Pointer_DblClick2) return \"Pointer_DblClick2\";\n\tif (k == XK_Pointer_DblClick3) return \"Pointer_DblClick3\";\n\tif (k == XK_Pointer_DblClick4) return \"Pointer_DblClick4\";\n\tif (k == XK_Pointer_DblClick5) return \"Pointer_DblClick5\";\n\tif (k == XK_Pointer_Drag_Dflt) return \"Pointer_Drag_Dflt\";\n\tif (k == XK_Pointer_Drag1) return \"Pointer_Drag1\";\n\tif (k == XK_Pointer_Drag2) return \"Pointer_Drag2\";\n\tif (k == XK_Pointer_Drag3) return \"Pointer_Drag3\";\n\tif (k == XK_Pointer_Drag4) return \"Pointer_Drag4\";\n\tif (k == XK_Pointer_Drag5) return \"Pointer_Drag5\";\n\tif (k == XK_Pointer_EnableKeys) return \"Pointer_EnableKeys\";\n\tif (k == XK_Pointer_Accelerate) return \"Pointer_Accelerate\";\n\tif (k == XK_Pointer_DfltBtnNext) return \"Pointer_DfltBtnNext\";\n\tif (k == XK_Pointer_DfltBtnPrev) return \"Pointer_DfltBtnPrev\";\n#endif\n#ifdef XK_3270\n\tif (k == XK_3270_Duplicate) return \"3270_Duplicate\";\n\tif (k == XK_3270_FieldMark) return \"3270_FieldMark\";\n\tif (k == XK_3270_Right2) return \"3270_Right2\";\n\tif (k == XK_3270_Left2) return \"3270_Left2\";\n\tif (k == XK_3270_BackTab) return \"3270_BackTab\";\n\tif (k == XK_3270_EraseEOF) return \"3270_EraseEOF\";\n\tif (k == XK_3270_EraseInput) return \"3270_EraseInput\";\n\tif (k == XK_3270_Reset) return \"3270_Reset\";\n\tif (k == XK_3270_Quit) return \"3270_Quit\";\n\tif (k == XK_3270_PA1) return \"3270_PA1\";\n\tif (k == XK_3270_PA2) return \"3270_PA2\";\n\tif (k == XK_3270_PA3) return \"3270_PA3\";\n\tif (k == XK_3270_Test) return \"3270_Test\";\n\tif (k == XK_3270_Attn) return \"3270_Attn\";\n\tif (k == XK_3270_CursorBlink) return \"3270_CursorBlink\";\n\tif (k == XK_3270_AltCursor) return \"3270_AltCursor\";\n\tif (k == XK_3270_KeyClick) return \"3270_KeyClick\";\n\tif (k == XK_3270_Jump) return \"3270_Jump\";\n\tif (k == XK_3270_Ident) return \"3270_Ident\";\n\tif (k == XK_3270_Rule) return \"3270_Rule\";\n\tif (k == XK_3270_Copy) return \"3270_Copy\";\n\tif (k == XK_3270_Play) return \"3270_Play\";\n\tif (k == XK_3270_Setup) return \"3270_Setup\";\n\tif (k == XK_3270_Record) return \"3270_Record\";\n\tif (k == XK_3270_ChangeScreen) return \"3270_ChangeScreen\";\n\tif (k == XK_3270_DeleteWord) return \"3270_DeleteWord\";\n\tif (k == XK_3270_ExSelect) return \"3270_ExSelect\";\n\tif (k == XK_3270_CursorSelect) return \"3270_CursorSelect\";\n\tif (k == XK_3270_PrintScreen) return \"3270_PrintScreen\";\n\tif (k == XK_3270_Enter) return \"3270_Enter\";\n#endif\n#ifdef XK_LATIN1\n\tif (k == XK_space) return \"space\";\n\tif (k == XK_exclam) return \"exclam\";\n\tif (k == XK_quotedbl) return \"quotedbl\";\n\tif (k == XK_numbersign) return \"numbersign\";\n\tif (k == XK_dollar) return \"dollar\";\n\tif (k == XK_percent) return \"percent\";\n\tif (k == XK_ampersand) return \"ampersand\";\n\tif (k == XK_apostrophe) return \"apostrophe\";\n\tif (k == XK_quoteright) return \"quoteright\";\n\tif (k == XK_parenleft) return \"parenleft\";\n\tif (k == XK_parenright) return \"parenright\";\n\tif (k == XK_asterisk) return \"asterisk\";\n\tif (k == XK_plus) return \"plus\";\n\tif (k == XK_comma) return \"comma\";\n\tif (k == XK_minus) return \"minus\";\n\tif (k == XK_period) return \"period\";\n\tif (k == XK_slash) return \"slash\";\n\tif (k == XK_0) return \"0\";\n\tif (k == XK_1) return \"1\";\n\tif (k == XK_2) return \"2\";\n\tif (k == XK_3) return \"3\";\n\tif (k == XK_4) return \"4\";\n\tif (k == XK_5) return \"5\";\n\tif (k == XK_6) return \"6\";\n\tif (k == XK_7) return \"7\";\n\tif (k == XK_8) return \"8\";\n\tif (k == XK_9) return \"9\";\n\tif (k == XK_colon) return \"colon\";\n\tif (k == XK_semicolon) return \"semicolon\";\n\tif (k == XK_less) return \"less\";\n\tif (k == XK_equal) return \"equal\";\n\tif (k == XK_greater) return \"greater\";\n\tif (k == XK_question) return \"question\";\n\tif (k == XK_at) return \"at\";\n\tif (k == XK_A) return \"A\";\n\tif (k == XK_B) return \"B\";\n\tif (k == XK_C) return \"C\";\n\tif (k == XK_D) return \"D\";\n\tif (k == XK_E) return \"E\";\n\tif (k == XK_F) return \"F\";\n\tif (k == XK_G) return \"G\";\n\tif (k == XK_H) return \"H\";\n\tif (k == XK_I) return \"I\";\n\tif (k == XK_J) return \"J\";\n\tif (k == XK_K) return \"K\";\n\tif (k == XK_L) return \"L\";\n\tif (k == XK_M) return \"M\";\n\tif (k == XK_N) return \"N\";\n\tif (k == XK_O) return \"O\";\n\tif (k == XK_P) return \"P\";\n\tif (k == XK_Q) return \"Q\";\n\tif (k == XK_R) return \"R\";\n\tif (k == XK_S) return \"S\";\n\tif (k == XK_T) return \"T\";\n\tif (k == XK_U) return \"U\";\n\tif (k == XK_V) return \"V\";\n\tif (k == XK_W) return \"W\";\n\tif (k == XK_X) return \"X\";\n\tif (k == XK_Y) return \"Y\";\n\tif (k == XK_Z) return \"Z\";\n\tif (k == XK_bracketleft) return \"bracketleft\";\n\tif (k == XK_backslash) return \"backslash\";\n\tif (k == XK_bracketright) return \"bracketright\";\n\tif (k == XK_asciicircum) return \"asciicircum\";\n\tif (k == XK_underscore) return \"underscore\";\n\tif (k == XK_grave) return \"grave\";\n\tif (k == XK_quoteleft) return \"quoteleft\";\n\tif (k == XK_a) return \"a\";\n\tif (k == XK_b) return \"b\";\n\tif (k == XK_c) return \"c\";\n\tif (k == XK_d) return \"d\";\n\tif (k == XK_e) return \"e\";\n\tif (k == XK_f) return \"f\";\n\tif (k == XK_g) return \"g\";\n\tif (k == XK_h) return \"h\";\n\tif (k == XK_i) return \"i\";\n\tif (k == XK_j) return \"j\";\n\tif (k == XK_k) return \"k\";\n\tif (k == XK_l) return \"l\";\n\tif (k == XK_m) return \"m\";\n\tif (k == XK_n) return \"n\";\n\tif (k == XK_o) return \"o\";\n\tif (k == XK_p) return \"p\";\n\tif (k == XK_q) return \"q\";\n\tif (k == XK_r) return \"r\";\n\tif (k == XK_s) return \"s\";\n\tif (k == XK_t) return \"t\";\n\tif (k == XK_u) return \"u\";\n\tif (k == XK_v) return \"v\";\n\tif (k == XK_w) return \"w\";\n\tif (k == XK_x) return \"x\";\n\tif (k == XK_y) return \"y\";\n\tif (k == XK_z) return \"z\";\n\tif (k == XK_braceleft) return \"braceleft\";\n\tif (k == XK_bar) return \"bar\";\n\tif (k == XK_braceright) return \"braceright\";\n\tif (k == XK_asciitilde) return \"asciitilde\";\n\tif (k == XK_nobreakspace) return \"nobreakspace\";\n\tif (k == XK_exclamdown) return \"exclamdown\";\n\tif (k == XK_cent) return \"cent\";\n\tif (k == XK_sterling) return \"sterling\";\n\tif (k == XK_currency) return \"currency\";\n\tif (k == XK_yen) return \"yen\";\n\tif (k == XK_brokenbar) return \"brokenbar\";\n\tif (k == XK_section) return \"section\";\n\tif (k == XK_diaeresis) return \"diaeresis\";\n\tif (k == XK_copyright) return \"copyright\";\n\tif (k == XK_ordfeminine) return \"ordfeminine\";\n\tif (k == XK_guillemotleft) return \"guillemotleft\";\n\tif (k == XK_notsign) return \"notsign\";\n\tif (k == XK_hyphen) return \"hyphen\";\n\tif (k == XK_registered) return \"registered\";\n\tif (k == XK_macron) return \"macron\";\n\tif (k == XK_degree) return \"degree\";\n\tif (k == XK_plusminus) return \"plusminus\";\n\tif (k == XK_twosuperior) return \"twosuperior\";\n\tif (k == XK_threesuperior) return \"threesuperior\";\n\tif (k == XK_acute) return \"acute\";\n\tif (k == XK_mu) return \"mu\";\n\tif (k == XK_paragraph) return \"paragraph\";\n\tif (k == XK_periodcentered) return \"periodcentered\";\n\tif (k == XK_cedilla) return \"cedilla\";\n\tif (k == XK_onesuperior) return \"onesuperior\";\n\tif (k == XK_masculine) return \"masculine\";\n\tif (k == XK_guillemotright) return \"guillemotright\";\n\tif (k == XK_onequarter) return \"onequarter\";\n\tif (k == XK_onehalf) return \"onehalf\";\n\tif (k == XK_threequarters) return \"threequarters\";\n\tif (k == XK_questiondown) return \"questiondown\";\n\tif (k == XK_Agrave) return \"Agrave\";\n\tif (k == XK_Aacute) return \"Aacute\";\n\tif (k == XK_Acircumflex) return \"Acircumflex\";\n\tif (k == XK_Atilde) return \"Atilde\";\n\tif (k == XK_Adiaeresis) return \"Adiaeresis\";\n\tif (k == XK_Aring) return \"Aring\";\n\tif (k == XK_AE) return \"AE\";\n\tif (k == XK_Ccedilla) return \"Ccedilla\";\n\tif (k == XK_Egrave) return \"Egrave\";\n\tif (k == XK_Eacute) return \"Eacute\";\n\tif (k == XK_Ecircumflex) return \"Ecircumflex\";\n\tif (k == XK_Ediaeresis) return \"Ediaeresis\";\n\tif (k == XK_Igrave) return \"Igrave\";\n\tif (k == XK_Iacute) return \"Iacute\";\n\tif (k == XK_Icircumflex) return \"Icircumflex\";\n\tif (k == XK_Idiaeresis) return \"Idiaeresis\";\n\tif (k == XK_ETH) return \"ETH\";\n\tif (k == XK_Eth) return \"Eth\";\n\tif (k == XK_Ntilde) return \"Ntilde\";\n\tif (k == XK_Ograve) return \"Ograve\";\n\tif (k == XK_Oacute) return \"Oacute\";\n\tif (k == XK_Ocircumflex) return \"Ocircumflex\";\n\tif (k == XK_Otilde) return \"Otilde\";\n\tif (k == XK_Odiaeresis) return \"Odiaeresis\";\n\tif (k == XK_multiply) return \"multiply\";\n\tif (k == XK_Ooblique) return \"Ooblique\";\n\tif (k == XK_Ugrave) return \"Ugrave\";\n\tif (k == XK_Uacute) return \"Uacute\";\n\tif (k == XK_Ucircumflex) return \"Ucircumflex\";\n\tif (k == XK_Udiaeresis) return \"Udiaeresis\";\n\tif (k == XK_Yacute) return \"Yacute\";\n\tif (k == XK_THORN) return \"THORN\";\n\tif (k == XK_Thorn) return \"Thorn\";\n\tif (k == XK_ssharp) return \"ssharp\";\n\tif (k == XK_agrave) return \"agrave\";\n\tif (k == XK_aacute) return \"aacute\";\n\tif (k == XK_acircumflex) return \"acircumflex\";\n\tif (k == XK_atilde) return \"atilde\";\n\tif (k == XK_adiaeresis) return \"adiaeresis\";\n\tif (k == XK_aring) return \"aring\";\n\tif (k == XK_ae) return \"ae\";\n\tif (k == XK_ccedilla) return \"ccedilla\";\n\tif (k == XK_egrave) return \"egrave\";\n\tif (k == XK_eacute) return \"eacute\";\n\tif (k == XK_ecircumflex) return \"ecircumflex\";\n\tif (k == XK_ediaeresis) return \"ediaeresis\";\n\tif (k == XK_igrave) return \"igrave\";\n\tif (k == XK_iacute) return \"iacute\";\n\tif (k == XK_icircumflex) return \"icircumflex\";\n\tif (k == XK_idiaeresis) return \"idiaeresis\";\n\tif (k == XK_eth) return \"eth\";\n\tif (k == XK_ntilde) return \"ntilde\";\n\tif (k == XK_ograve) return \"ograve\";\n\tif (k == XK_oacute) return \"oacute\";\n\tif (k == XK_ocircumflex) return \"ocircumflex\";\n\tif (k == XK_otilde) return \"otilde\";\n\tif (k == XK_odiaeresis) return \"odiaeresis\";\n\tif (k == XK_division) return \"division\";\n\tif (k == XK_oslash) return \"oslash\";\n\tif (k == XK_ugrave) return \"ugrave\";\n\tif (k == XK_uacute) return \"uacute\";\n\tif (k == XK_ucircumflex) return \"ucircumflex\";\n\tif (k == XK_udiaeresis) return \"udiaeresis\";\n\tif (k == XK_yacute) return \"yacute\";\n\tif (k == XK_thorn) return \"thorn\";\n\tif (k == XK_ydiaeresis) return \"ydiaeresis\";\n#endif /* XK_LATIN1 */\n#ifdef XK_LATIN2\n\tif (k == XK_Aogonek) return \"Aogonek\";\n\tif (k == XK_breve) return \"breve\";\n\tif (k == XK_Lstroke) return \"Lstroke\";\n\tif (k == XK_Lcaron) return \"Lcaron\";\n\tif (k == XK_Sacute) return \"Sacute\";\n\tif (k == XK_Scaron) return \"Scaron\";\n\tif (k == XK_Scedilla) return \"Scedilla\";\n\tif (k == XK_Tcaron) return \"Tcaron\";\n\tif (k == XK_Zacute) return \"Zacute\";\n\tif (k == XK_Zcaron) return \"Zcaron\";\n\tif (k == XK_Zabovedot) return \"Zabovedot\";\n\tif (k == XK_aogonek) return \"aogonek\";\n\tif (k == XK_ogonek) return \"ogonek\";\n\tif (k == XK_lstroke) return \"lstroke\";\n\tif (k == XK_lcaron) return \"lcaron\";\n\tif (k == XK_sacute) return \"sacute\";\n\tif (k == XK_caron) return \"caron\";\n\tif (k == XK_scaron) return \"scaron\";\n\tif (k == XK_scedilla) return \"scedilla\";\n\tif (k == XK_tcaron) return \"tcaron\";\n\tif (k == XK_zacute) return \"zacute\";\n\tif (k == XK_doubleacute) return \"doubleacute\";\n\tif (k == XK_zcaron) return \"zcaron\";\n\tif (k == XK_zabovedot) return \"zabovedot\";\n\tif (k == XK_Racute) return \"Racute\";\n\tif (k == XK_Abreve) return \"Abreve\";\n\tif (k == XK_Lacute) return \"Lacute\";\n\tif (k == XK_Cacute) return \"Cacute\";\n\tif (k == XK_Ccaron) return \"Ccaron\";\n\tif (k == XK_Eogonek) return \"Eogonek\";\n\tif (k == XK_Ecaron) return \"Ecaron\";\n\tif (k == XK_Dcaron) return \"Dcaron\";\n\tif (k == XK_Dstroke) return \"Dstroke\";\n\tif (k == XK_Nacute) return \"Nacute\";\n\tif (k == XK_Ncaron) return \"Ncaron\";\n\tif (k == XK_Odoubleacute) return \"Odoubleacute\";\n\tif (k == XK_Rcaron) return \"Rcaron\";\n\tif (k == XK_Uring) return \"Uring\";\n\tif (k == XK_Udoubleacute) return \"Udoubleacute\";\n\tif (k == XK_Tcedilla) return \"Tcedilla\";\n\tif (k == XK_racute) return \"racute\";\n\tif (k == XK_abreve) return \"abreve\";\n\tif (k == XK_lacute) return \"lacute\";\n\tif (k == XK_cacute) return \"cacute\";\n\tif (k == XK_ccaron) return \"ccaron\";\n\tif (k == XK_eogonek) return \"eogonek\";\n\tif (k == XK_ecaron) return \"ecaron\";\n\tif (k == XK_dcaron) return \"dcaron\";\n\tif (k == XK_dstroke) return \"dstroke\";\n\tif (k == XK_nacute) return \"nacute\";\n\tif (k == XK_ncaron) return \"ncaron\";\n\tif (k == XK_odoubleacute) return \"odoubleacute\";\n\tif (k == XK_udoubleacute) return \"udoubleacute\";\n\tif (k == XK_rcaron) return \"rcaron\";\n\tif (k == XK_uring) return \"uring\";\n\tif (k == XK_tcedilla) return \"tcedilla\";\n\tif (k == XK_abovedot) return \"abovedot\";\n#endif /* XK_LATIN2 */\n#ifdef XK_LATIN3\n\tif (k == XK_Hstroke) return \"Hstroke\";\n\tif (k == XK_Hcircumflex) return \"Hcircumflex\";\n\tif (k == XK_Iabovedot) return \"Iabovedot\";\n\tif (k == XK_Gbreve) return \"Gbreve\";\n\tif (k == XK_Jcircumflex) return \"Jcircumflex\";\n\tif (k == XK_hstroke) return \"hstroke\";\n\tif (k == XK_hcircumflex) return \"hcircumflex\";\n\tif (k == XK_idotless) return \"idotless\";\n\tif (k == XK_gbreve) return \"gbreve\";\n\tif (k == XK_jcircumflex) return \"jcircumflex\";\n\tif (k == XK_Cabovedot) return \"Cabovedot\";\n\tif (k == XK_Ccircumflex) return \"Ccircumflex\";\n\tif (k == XK_Gabovedot) return \"Gabovedot\";\n\tif (k == XK_Gcircumflex) return \"Gcircumflex\";\n\tif (k == XK_Ubreve) return \"Ubreve\";\n\tif (k == XK_Scircumflex) return \"Scircumflex\";\n\tif (k == XK_cabovedot) return \"cabovedot\";\n\tif (k == XK_ccircumflex) return \"ccircumflex\";\n\tif (k == XK_gabovedot) return \"gabovedot\";\n\tif (k == XK_gcircumflex) return \"gcircumflex\";\n\tif (k == XK_ubreve) return \"ubreve\";\n\tif (k == XK_scircumflex) return \"scircumflex\";\n#endif /* XK_LATIN3 */\n#ifdef XK_LATIN4\n\tif (k == XK_kra) return \"kra\";\n\tif (k == XK_kappa) return \"kappa\";\n\tif (k == XK_Rcedilla) return \"Rcedilla\";\n\tif (k == XK_Itilde) return \"Itilde\";\n\tif (k == XK_Lcedilla) return \"Lcedilla\";\n\tif (k == XK_Emacron) return \"Emacron\";\n\tif (k == XK_Gcedilla) return \"Gcedilla\";\n\tif (k == XK_Tslash) return \"Tslash\";\n\tif (k == XK_rcedilla) return \"rcedilla\";\n\tif (k == XK_itilde) return \"itilde\";\n\tif (k == XK_lcedilla) return \"lcedilla\";\n\tif (k == XK_emacron) return \"emacron\";\n\tif (k == XK_gcedilla) return \"gcedilla\";\n\tif (k == XK_tslash) return \"tslash\";\n\tif (k == XK_ENG) return \"ENG\";\n\tif (k == XK_eng) return \"eng\";\n\tif (k == XK_Amacron) return \"Amacron\";\n\tif (k == XK_Iogonek) return \"Iogonek\";\n\tif (k == XK_Eabovedot) return \"Eabovedot\";\n\tif (k == XK_Imacron) return \"Imacron\";\n\tif (k == XK_Ncedilla) return \"Ncedilla\";\n\tif (k == XK_Omacron) return \"Omacron\";\n\tif (k == XK_Kcedilla) return \"Kcedilla\";\n\tif (k == XK_Uogonek) return \"Uogonek\";\n\tif (k == XK_Utilde) return \"Utilde\";\n\tif (k == XK_Umacron) return \"Umacron\";\n\tif (k == XK_amacron) return \"amacron\";\n\tif (k == XK_iogonek) return \"iogonek\";\n\tif (k == XK_eabovedot) return \"eabovedot\";\n\tif (k == XK_imacron) return \"imacron\";\n\tif (k == XK_ncedilla) return \"ncedilla\";\n\tif (k == XK_omacron) return \"omacron\";\n\tif (k == XK_kcedilla) return \"kcedilla\";\n\tif (k == XK_uogonek) return \"uogonek\";\n\tif (k == XK_utilde) return \"utilde\";\n\tif (k == XK_umacron) return \"umacron\";\n#endif /* XK_LATIN4 */\n#ifdef XK_KATAKANA\n\tif (k == XK_overline) return \"overline\";\n\tif (k == XK_kana_fullstop) return \"kana_fullstop\";\n\tif (k == XK_kana_openingbracket) return \"kana_openingbracket\";\n\tif (k == XK_kana_closingbracket) return \"kana_closingbracket\";\n\tif (k == XK_kana_comma) return \"kana_comma\";\n\tif (k == XK_kana_conjunctive) return \"kana_conjunctive\";\n\tif (k == XK_kana_middledot) return \"kana_middledot\";\n\tif (k == XK_kana_WO) return \"kana_WO\";\n\tif (k == XK_kana_a) return \"kana_a\";\n\tif (k == XK_kana_i) return \"kana_i\";\n\tif (k == XK_kana_u) return \"kana_u\";\n\tif (k == XK_kana_e) return \"kana_e\";\n\tif (k == XK_kana_o) return \"kana_o\";\n\tif (k == XK_kana_ya) return \"kana_ya\";\n\tif (k == XK_kana_yu) return \"kana_yu\";\n\tif (k == XK_kana_yo) return \"kana_yo\";\n\tif (k == XK_kana_tsu) return \"kana_tsu\";\n\tif (k == XK_kana_tu) return \"kana_tu\";\n\tif (k == XK_prolongedsound) return \"prolongedsound\";\n\tif (k == XK_kana_A) return \"kana_A\";\n\tif (k == XK_kana_I) return \"kana_I\";\n\tif (k == XK_kana_U) return \"kana_U\";\n\tif (k == XK_kana_E) return \"kana_E\";\n\tif (k == XK_kana_O) return \"kana_O\";\n\tif (k == XK_kana_KA) return \"kana_KA\";\n\tif (k == XK_kana_KI) return \"kana_KI\";\n\tif (k == XK_kana_KU) return \"kana_KU\";\n\tif (k == XK_kana_KE) return \"kana_KE\";\n\tif (k == XK_kana_KO) return \"kana_KO\";\n\tif (k == XK_kana_SA) return \"kana_SA\";\n\tif (k == XK_kana_SHI) return \"kana_SHI\";\n\tif (k == XK_kana_SU) return \"kana_SU\";\n\tif (k == XK_kana_SE) return \"kana_SE\";\n\tif (k == XK_kana_SO) return \"kana_SO\";\n\tif (k == XK_kana_TA) return \"kana_TA\";\n\tif (k == XK_kana_CHI) return \"kana_CHI\";\n\tif (k == XK_kana_TI) return \"kana_TI\";\n\tif (k == XK_kana_TSU) return \"kana_TSU\";\n\tif (k == XK_kana_TU) return \"kana_TU\";\n\tif (k == XK_kana_TE) return \"kana_TE\";\n\tif (k == XK_kana_TO) return \"kana_TO\";\n\tif (k == XK_kana_NA) return \"kana_NA\";\n\tif (k == XK_kana_NI) return \"kana_NI\";\n\tif (k == XK_kana_NU) return \"kana_NU\";\n\tif (k == XK_kana_NE) return \"kana_NE\";\n\tif (k == XK_kana_NO) return \"kana_NO\";\n\tif (k == XK_kana_HA) return \"kana_HA\";\n\tif (k == XK_kana_HI) return \"kana_HI\";\n\tif (k == XK_kana_FU) return \"kana_FU\";\n\tif (k == XK_kana_HU) return \"kana_HU\";\n\tif (k == XK_kana_HE) return \"kana_HE\";\n\tif (k == XK_kana_HO) return \"kana_HO\";\n\tif (k == XK_kana_MA) return \"kana_MA\";\n\tif (k == XK_kana_MI) return \"kana_MI\";\n\tif (k == XK_kana_MU) return \"kana_MU\";\n\tif (k == XK_kana_ME) return \"kana_ME\";\n\tif (k == XK_kana_MO) return \"kana_MO\";\n\tif (k == XK_kana_YA) return \"kana_YA\";\n\tif (k == XK_kana_YU) return \"kana_YU\";\n\tif (k == XK_kana_YO) return \"kana_YO\";\n\tif (k == XK_kana_RA) return \"kana_RA\";\n\tif (k == XK_kana_RI) return \"kana_RI\";\n\tif (k == XK_kana_RU) return \"kana_RU\";\n\tif (k == XK_kana_RE) return \"kana_RE\";\n\tif (k == XK_kana_RO) return \"kana_RO\";\n\tif (k == XK_kana_WA) return \"kana_WA\";\n\tif (k == XK_kana_N) return \"kana_N\";\n\tif (k == XK_voicedsound) return \"voicedsound\";\n\tif (k == XK_semivoicedsound) return \"semivoicedsound\";\n\tif (k == XK_kana_switch) return \"kana_switch\";\n#endif /* XK_KATAKANA */\n#ifdef XK_ARABIC\n\tif (k == XK_Arabic_comma) return \"Arabic_comma\";\n\tif (k == XK_Arabic_semicolon) return \"Arabic_semicolon\";\n\tif (k == XK_Arabic_question_mark) return \"Arabic_question_mark\";\n\tif (k == XK_Arabic_hamza) return \"Arabic_hamza\";\n\tif (k == XK_Arabic_maddaonalef) return \"Arabic_maddaonalef\";\n\tif (k == XK_Arabic_hamzaonalef) return \"Arabic_hamzaonalef\";\n\tif (k == XK_Arabic_hamzaonwaw) return \"Arabic_hamzaonwaw\";\n\tif (k == XK_Arabic_hamzaunderalef) return \"Arabic_hamzaunderalef\";\n\tif (k == XK_Arabic_hamzaonyeh) return \"Arabic_hamzaonyeh\";\n\tif (k == XK_Arabic_alef) return \"Arabic_alef\";\n\tif (k == XK_Arabic_beh) return \"Arabic_beh\";\n\tif (k == XK_Arabic_tehmarbuta) return \"Arabic_tehmarbuta\";\n\tif (k == XK_Arabic_teh) return \"Arabic_teh\";\n\tif (k == XK_Arabic_theh) return \"Arabic_theh\";\n\tif (k == XK_Arabic_jeem) return \"Arabic_jeem\";\n\tif (k == XK_Arabic_hah) return \"Arabic_hah\";\n\tif (k == XK_Arabic_khah) return \"Arabic_khah\";\n\tif (k == XK_Arabic_dal) return \"Arabic_dal\";\n\tif (k == XK_Arabic_thal) return \"Arabic_thal\";\n\tif (k == XK_Arabic_ra) return \"Arabic_ra\";\n\tif (k == XK_Arabic_zain) return \"Arabic_zain\";\n\tif (k == XK_Arabic_seen) return \"Arabic_seen\";\n\tif (k == XK_Arabic_sheen) return \"Arabic_sheen\";\n\tif (k == XK_Arabic_sad) return \"Arabic_sad\";\n\tif (k == XK_Arabic_dad) return \"Arabic_dad\";\n\tif (k == XK_Arabic_tah) return \"Arabic_tah\";\n\tif (k == XK_Arabic_zah) return \"Arabic_zah\";\n\tif (k == XK_Arabic_ain) return \"Arabic_ain\";\n\tif (k == XK_Arabic_ghain) return \"Arabic_ghain\";\n\tif (k == XK_Arabic_tatweel) return \"Arabic_tatweel\";\n\tif (k == XK_Arabic_feh) return \"Arabic_feh\";\n\tif (k == XK_Arabic_qaf) return \"Arabic_qaf\";\n\tif (k == XK_Arabic_kaf) return \"Arabic_kaf\";\n\tif (k == XK_Arabic_lam) return \"Arabic_lam\";\n\tif (k == XK_Arabic_meem) return \"Arabic_meem\";\n\tif (k == XK_Arabic_noon) return \"Arabic_noon\";\n\tif (k == XK_Arabic_ha) return \"Arabic_ha\";\n\tif (k == XK_Arabic_heh) return \"Arabic_heh\";\n\tif (k == XK_Arabic_waw) return \"Arabic_waw\";\n\tif (k == XK_Arabic_alefmaksura) return \"Arabic_alefmaksura\";\n\tif (k == XK_Arabic_yeh) return \"Arabic_yeh\";\n\tif (k == XK_Arabic_fathatan) return \"Arabic_fathatan\";\n\tif (k == XK_Arabic_dammatan) return \"Arabic_dammatan\";\n\tif (k == XK_Arabic_kasratan) return \"Arabic_kasratan\";\n\tif (k == XK_Arabic_fatha) return \"Arabic_fatha\";\n\tif (k == XK_Arabic_damma) return \"Arabic_damma\";\n\tif (k == XK_Arabic_kasra) return \"Arabic_kasra\";\n\tif (k == XK_Arabic_shadda) return \"Arabic_shadda\";\n\tif (k == XK_Arabic_sukun) return \"Arabic_sukun\";\n\tif (k == XK_Arabic_switch) return \"Arabic_switch\";\n#endif /* XK_ARABIC */\n#ifdef XK_CYRILLIC\n\tif (k == XK_Serbian_dje) return \"Serbian_dje\";\n\tif (k == XK_Macedonia_gje) return \"Macedonia_gje\";\n\tif (k == XK_Cyrillic_io) return \"Cyrillic_io\";\n\tif (k == XK_Ukrainian_ie) return \"Ukrainian_ie\";\n\tif (k == XK_Ukranian_je) return \"Ukranian_je\";\n\tif (k == XK_Macedonia_dse) return \"Macedonia_dse\";\n\tif (k == XK_Ukrainian_i) return \"Ukrainian_i\";\n\tif (k == XK_Ukranian_i) return \"Ukranian_i\";\n\tif (k == XK_Ukrainian_yi) return \"Ukrainian_yi\";\n\tif (k == XK_Ukranian_yi) return \"Ukranian_yi\";\n\tif (k == XK_Cyrillic_je) return \"Cyrillic_je\";\n\tif (k == XK_Serbian_je) return \"Serbian_je\";\n\tif (k == XK_Cyrillic_lje) return \"Cyrillic_lje\";\n\tif (k == XK_Serbian_lje) return \"Serbian_lje\";\n\tif (k == XK_Cyrillic_nje) return \"Cyrillic_nje\";\n\tif (k == XK_Serbian_nje) return \"Serbian_nje\";\n\tif (k == XK_Serbian_tshe) return \"Serbian_tshe\";\n\tif (k == XK_Macedonia_kje) return \"Macedonia_kje\";\n\tif (k == XK_Byelorussian_shortu) return \"Byelorussian_shortu\";\n\tif (k == XK_Cyrillic_dzhe) return \"Cyrillic_dzhe\";\n\tif (k == XK_Serbian_dze) return \"Serbian_dze\";\n\tif (k == XK_numerosign) return \"numerosign\";\n\tif (k == XK_Serbian_DJE) return \"Serbian_DJE\";\n\tif (k == XK_Macedonia_GJE) return \"Macedonia_GJE\";\n\tif (k == XK_Cyrillic_IO) return \"Cyrillic_IO\";\n\tif (k == XK_Ukrainian_IE) return \"Ukrainian_IE\";\n\tif (k == XK_Ukranian_JE) return \"Ukranian_JE\";\n\tif (k == XK_Macedonia_DSE) return \"Macedonia_DSE\";\n\tif (k == XK_Ukrainian_I) return \"Ukrainian_I\";\n\tif (k == XK_Ukranian_I) return \"Ukranian_I\";\n\tif (k == XK_Ukrainian_YI) return \"Ukrainian_YI\";\n\tif (k == XK_Ukranian_YI) return \"Ukranian_YI\";\n\tif (k == XK_Cyrillic_JE) return \"Cyrillic_JE\";\n\tif (k == XK_Serbian_JE) return \"Serbian_JE\";\n\tif (k == XK_Cyrillic_LJE) return \"Cyrillic_LJE\";\n\tif (k == XK_Serbian_LJE) return \"Serbian_LJE\";\n\tif (k == XK_Cyrillic_NJE) return \"Cyrillic_NJE\";\n\tif (k == XK_Serbian_NJE) return \"Serbian_NJE\";\n\tif (k == XK_Serbian_TSHE) return \"Serbian_TSHE\";\n\tif (k == XK_Macedonia_KJE) return \"Macedonia_KJE\";\n\tif (k == XK_Byelorussian_SHORTU) return \"Byelorussian_SHORTU\";\n\tif (k == XK_Cyrillic_DZHE) return \"Cyrillic_DZHE\";\n\tif (k == XK_Serbian_DZE) return \"Serbian_DZE\";\n\tif (k == XK_Cyrillic_yu) return \"Cyrillic_yu\";\n\tif (k == XK_Cyrillic_a) return \"Cyrillic_a\";\n\tif (k == XK_Cyrillic_be) return \"Cyrillic_be\";\n\tif (k == XK_Cyrillic_tse) return \"Cyrillic_tse\";\n\tif (k == XK_Cyrillic_de) return \"Cyrillic_de\";\n\tif (k == XK_Cyrillic_ie) return \"Cyrillic_ie\";\n\tif (k == XK_Cyrillic_ef) return \"Cyrillic_ef\";\n\tif (k == XK_Cyrillic_ghe) return \"Cyrillic_ghe\";\n\tif (k == XK_Cyrillic_ha) return \"Cyrillic_ha\";\n\tif (k == XK_Cyrillic_i) return \"Cyrillic_i\";\n\tif (k == XK_Cyrillic_shorti) return \"Cyrillic_shorti\";\n\tif (k == XK_Cyrillic_ka) return \"Cyrillic_ka\";\n\tif (k == XK_Cyrillic_el) return \"Cyrillic_el\";\n\tif (k == XK_Cyrillic_em) return \"Cyrillic_em\";\n\tif (k == XK_Cyrillic_en) return \"Cyrillic_en\";\n\tif (k == XK_Cyrillic_o) return \"Cyrillic_o\";\n\tif (k == XK_Cyrillic_pe) return \"Cyrillic_pe\";\n\tif (k == XK_Cyrillic_ya) return \"Cyrillic_ya\";\n\tif (k == XK_Cyrillic_er) return \"Cyrillic_er\";\n\tif (k == XK_Cyrillic_es) return \"Cyrillic_es\";\n\tif (k == XK_Cyrillic_te) return \"Cyrillic_te\";\n\tif (k == XK_Cyrillic_u) return \"Cyrillic_u\";\n\tif (k == XK_Cyrillic_zhe) return \"Cyrillic_zhe\";\n\tif (k == XK_Cyrillic_ve) return \"Cyrillic_ve\";\n\tif (k == XK_Cyrillic_softsign) return \"Cyrillic_softsign\";\n\tif (k == XK_Cyrillic_yeru) return \"Cyrillic_yeru\";\n\tif (k == XK_Cyrillic_ze) return \"Cyrillic_ze\";\n\tif (k == XK_Cyrillic_sha) return \"Cyrillic_sha\";\n\tif (k == XK_Cyrillic_e) return \"Cyrillic_e\";\n\tif (k == XK_Cyrillic_shcha) return \"Cyrillic_shcha\";\n\tif (k == XK_Cyrillic_che) return \"Cyrillic_che\";\n\tif (k == XK_Cyrillic_hardsign) return \"Cyrillic_hardsign\";\n\tif (k == XK_Cyrillic_YU) return \"Cyrillic_YU\";\n\tif (k == XK_Cyrillic_A) return \"Cyrillic_A\";\n\tif (k == XK_Cyrillic_BE) return \"Cyrillic_BE\";\n\tif (k == XK_Cyrillic_TSE) return \"Cyrillic_TSE\";\n\tif (k == XK_Cyrillic_DE) return \"Cyrillic_DE\";\n\tif (k == XK_Cyrillic_IE) return \"Cyrillic_IE\";\n\tif (k == XK_Cyrillic_EF) return \"Cyrillic_EF\";\n\tif (k == XK_Cyrillic_GHE) return \"Cyrillic_GHE\";\n\tif (k == XK_Cyrillic_HA) return \"Cyrillic_HA\";\n\tif (k == XK_Cyrillic_I) return \"Cyrillic_I\";\n\tif (k == XK_Cyrillic_SHORTI) return \"Cyrillic_SHORTI\";\n\tif (k == XK_Cyrillic_KA) return \"Cyrillic_KA\";\n\tif (k == XK_Cyrillic_EL) return \"Cyrillic_EL\";\n\tif (k == XK_Cyrillic_EM) return \"Cyrillic_EM\";\n\tif (k == XK_Cyrillic_EN) return \"Cyrillic_EN\";\n\tif (k == XK_Cyrillic_O) return \"Cyrillic_O\";\n\tif (k == XK_Cyrillic_PE) return \"Cyrillic_PE\";\n\tif (k == XK_Cyrillic_YA) return \"Cyrillic_YA\";\n\tif (k == XK_Cyrillic_ER) return \"Cyrillic_ER\";\n\tif (k == XK_Cyrillic_ES) return \"Cyrillic_ES\";\n\tif (k == XK_Cyrillic_TE) return \"Cyrillic_TE\";\n\tif (k == XK_Cyrillic_U) return \"Cyrillic_U\";\n\tif (k == XK_Cyrillic_ZHE) return \"Cyrillic_ZHE\";\n\tif (k == XK_Cyrillic_VE) return \"Cyrillic_VE\";\n\tif (k == XK_Cyrillic_SOFTSIGN) return \"Cyrillic_SOFTSIGN\";\n\tif (k == XK_Cyrillic_YERU) return \"Cyrillic_YERU\";\n\tif (k == XK_Cyrillic_ZE) return \"Cyrillic_ZE\";\n\tif (k == XK_Cyrillic_SHA) return \"Cyrillic_SHA\";\n\tif (k == XK_Cyrillic_E) return \"Cyrillic_E\";\n\tif (k == XK_Cyrillic_SHCHA) return \"Cyrillic_SHCHA\";\n\tif (k == XK_Cyrillic_CHE) return \"Cyrillic_CHE\";\n\tif (k == XK_Cyrillic_HARDSIGN) return \"Cyrillic_HARDSIGN\";\n#endif /* XK_CYRILLIC */\n#ifdef XK_GREEK\n\tif (k == XK_Greek_ALPHAaccent) return \"Greek_ALPHAaccent\";\n\tif (k == XK_Greek_EPSILONaccent) return \"Greek_EPSILONaccent\";\n\tif (k == XK_Greek_ETAaccent) return \"Greek_ETAaccent\";\n\tif (k == XK_Greek_IOTAaccent) return \"Greek_IOTAaccent\";\n\tif (k == XK_Greek_IOTAdieresis) return \"Greek_IOTAdieresis\";\n\tif (k == XK_Greek_OMICRONaccent) return \"Greek_OMICRONaccent\";\n\tif (k == XK_Greek_UPSILONaccent) return \"Greek_UPSILONaccent\";\n\tif (k == XK_Greek_UPSILONdieresis) return \"Greek_UPSILONdieresis\";\n\tif (k == XK_Greek_OMEGAaccent) return \"Greek_OMEGAaccent\";\n\tif (k == XK_Greek_accentdieresis) return \"Greek_accentdieresis\";\n\tif (k == XK_Greek_horizbar) return \"Greek_horizbar\";\n\tif (k == XK_Greek_alphaaccent) return \"Greek_alphaaccent\";\n\tif (k == XK_Greek_epsilonaccent) return \"Greek_epsilonaccent\";\n\tif (k == XK_Greek_etaaccent) return \"Greek_etaaccent\";\n\tif (k == XK_Greek_iotaaccent) return \"Greek_iotaaccent\";\n\tif (k == XK_Greek_iotadieresis) return \"Greek_iotadieresis\";\n\tif (k == XK_Greek_iotaaccentdieresis) return \"Greek_iotaaccentdieresis\";\n\tif (k == XK_Greek_omicronaccent) return \"Greek_omicronaccent\";\n\tif (k == XK_Greek_upsilonaccent) return \"Greek_upsilonaccent\";\n\tif (k == XK_Greek_upsilondieresis) return \"Greek_upsilondieresis\";\n\tif (k == XK_Greek_upsilonaccentdieresis) return \"Greek_upsilonaccentdieresis\";\n\tif (k == XK_Greek_omegaaccent) return \"Greek_omegaaccent\";\n\tif (k == XK_Greek_ALPHA) return \"Greek_ALPHA\";\n\tif (k == XK_Greek_BETA) return \"Greek_BETA\";\n\tif (k == XK_Greek_GAMMA) return \"Greek_GAMMA\";\n\tif (k == XK_Greek_DELTA) return \"Greek_DELTA\";\n\tif (k == XK_Greek_EPSILON) return \"Greek_EPSILON\";\n\tif (k == XK_Greek_ZETA) return \"Greek_ZETA\";\n\tif (k == XK_Greek_ETA) return \"Greek_ETA\";\n\tif (k == XK_Greek_THETA) return \"Greek_THETA\";\n\tif (k == XK_Greek_IOTA) return \"Greek_IOTA\";\n\tif (k == XK_Greek_KAPPA) return \"Greek_KAPPA\";\n\tif (k == XK_Greek_LAMDA) return \"Greek_LAMDA\";\n\tif (k == XK_Greek_LAMBDA) return \"Greek_LAMBDA\";\n\tif (k == XK_Greek_MU) return \"Greek_MU\";\n\tif (k == XK_Greek_NU) return \"Greek_NU\";\n\tif (k == XK_Greek_XI) return \"Greek_XI\";\n\tif (k == XK_Greek_OMICRON) return \"Greek_OMICRON\";\n\tif (k == XK_Greek_PI) return \"Greek_PI\";\n\tif (k == XK_Greek_RHO) return \"Greek_RHO\";\n\tif (k == XK_Greek_SIGMA) return \"Greek_SIGMA\";\n\tif (k == XK_Greek_TAU) return \"Greek_TAU\";\n\tif (k == XK_Greek_UPSILON) return \"Greek_UPSILON\";\n\tif (k == XK_Greek_PHI) return \"Greek_PHI\";\n\tif (k == XK_Greek_CHI) return \"Greek_CHI\";\n\tif (k == XK_Greek_PSI) return \"Greek_PSI\";\n\tif (k == XK_Greek_OMEGA) return \"Greek_OMEGA\";\n\tif (k == XK_Greek_alpha) return \"Greek_alpha\";\n\tif (k == XK_Greek_beta) return \"Greek_beta\";\n\tif (k == XK_Greek_gamma) return \"Greek_gamma\";\n\tif (k == XK_Greek_delta) return \"Greek_delta\";\n\tif (k == XK_Greek_epsilon) return \"Greek_epsilon\";\n\tif (k == XK_Greek_zeta) return \"Greek_zeta\";\n\tif (k == XK_Greek_eta) return \"Greek_eta\";\n\tif (k == XK_Greek_theta) return \"Greek_theta\";\n\tif (k == XK_Greek_iota) return \"Greek_iota\";\n\tif (k == XK_Greek_kappa) return \"Greek_kappa\";\n\tif (k == XK_Greek_lamda) return \"Greek_lamda\";\n\tif (k == XK_Greek_lambda) return \"Greek_lambda\";\n\tif (k == XK_Greek_mu) return \"Greek_mu\";\n\tif (k == XK_Greek_nu) return \"Greek_nu\";\n\tif (k == XK_Greek_xi) return \"Greek_xi\";\n\tif (k == XK_Greek_omicron) return \"Greek_omicron\";\n\tif (k == XK_Greek_pi) return \"Greek_pi\";\n\tif (k == XK_Greek_rho) return \"Greek_rho\";\n\tif (k == XK_Greek_sigma) return \"Greek_sigma\";\n\tif (k == XK_Greek_finalsmallsigma) return \"Greek_finalsmallsigma\";\n\tif (k == XK_Greek_tau) return \"Greek_tau\";\n\tif (k == XK_Greek_upsilon) return \"Greek_upsilon\";\n\tif (k == XK_Greek_phi) return \"Greek_phi\";\n\tif (k == XK_Greek_chi) return \"Greek_chi\";\n\tif (k == XK_Greek_psi) return \"Greek_psi\";\n\tif (k == XK_Greek_omega) return \"Greek_omega\";\n\tif (k == XK_Greek_switch) return \"Greek_switch\";\n#endif /* XK_GREEK */\n#ifdef XK_TECHNICAL\n\tif (k == XK_leftradical) return \"leftradical\";\n\tif (k == XK_topleftradical) return \"topleftradical\";\n\tif (k == XK_horizconnector) return \"horizconnector\";\n\tif (k == XK_topintegral) return \"topintegral\";\n\tif (k == XK_botintegral) return \"botintegral\";\n\tif (k == XK_vertconnector) return \"vertconnector\";\n\tif (k == XK_topleftsqbracket) return \"topleftsqbracket\";\n\tif (k == XK_botleftsqbracket) return \"botleftsqbracket\";\n\tif (k == XK_toprightsqbracket) return \"toprightsqbracket\";\n\tif (k == XK_botrightsqbracket) return \"botrightsqbracket\";\n\tif (k == XK_topleftparens) return \"topleftparens\";\n\tif (k == XK_botleftparens) return \"botleftparens\";\n\tif (k == XK_toprightparens) return \"toprightparens\";\n\tif (k == XK_botrightparens) return \"botrightparens\";\n\tif (k == XK_leftmiddlecurlybrace) return \"leftmiddlecurlybrace\";\n\tif (k == XK_rightmiddlecurlybrace) return \"rightmiddlecurlybrace\";\n\tif (k == XK_topleftsummation) return \"topleftsummation\";\n\tif (k == XK_botleftsummation) return \"botleftsummation\";\n\tif (k == XK_topvertsummationconnector) return \"topvertsummationconnector\";\n\tif (k == XK_botvertsummationconnector) return \"botvertsummationconnector\";\n\tif (k == XK_toprightsummation) return \"toprightsummation\";\n\tif (k == XK_botrightsummation) return \"botrightsummation\";\n\tif (k == XK_rightmiddlesummation) return \"rightmiddlesummation\";\n\tif (k == XK_lessthanequal) return \"lessthanequal\";\n\tif (k == XK_notequal) return \"notequal\";\n\tif (k == XK_greaterthanequal) return \"greaterthanequal\";\n\tif (k == XK_integral) return \"integral\";\n\tif (k == XK_therefore) return \"therefore\";\n\tif (k == XK_variation) return \"variation\";\n\tif (k == XK_infinity) return \"infinity\";\n\tif (k == XK_nabla) return \"nabla\";\n\tif (k == XK_approximate) return \"approximate\";\n\tif (k == XK_similarequal) return \"similarequal\";\n\tif (k == XK_ifonlyif) return \"ifonlyif\";\n\tif (k == XK_implies) return \"implies\";\n\tif (k == XK_identical) return \"identical\";\n\tif (k == XK_radical) return \"radical\";\n\tif (k == XK_includedin) return \"includedin\";\n\tif (k == XK_includes) return \"includes\";\n\tif (k == XK_intersection) return \"intersection\";\n\tif (k == XK_union) return \"union\";\n\tif (k == XK_logicaland) return \"logicaland\";\n\tif (k == XK_logicalor) return \"logicalor\";\n\tif (k == XK_partialderivative) return \"partialderivative\";\n\tif (k == XK_function) return \"function\";\n\tif (k == XK_leftarrow) return \"leftarrow\";\n\tif (k == XK_uparrow) return \"uparrow\";\n\tif (k == XK_rightarrow) return \"rightarrow\";\n\tif (k == XK_downarrow) return \"downarrow\";\n#endif /* XK_TECHNICAL */\n#ifdef XK_SPECIAL\n\tif (k == XK_blank) return \"blank\";\n\tif (k == XK_soliddiamond) return \"soliddiamond\";\n\tif (k == XK_checkerboard) return \"checkerboard\";\n\tif (k == XK_ht) return \"ht\";\n\tif (k == XK_ff) return \"ff\";\n\tif (k == XK_cr) return \"cr\";\n\tif (k == XK_lf) return \"lf\";\n\tif (k == XK_nl) return \"nl\";\n\tif (k == XK_vt) return \"vt\";\n\tif (k == XK_lowrightcorner) return \"lowrightcorner\";\n\tif (k == XK_uprightcorner) return \"uprightcorner\";\n\tif (k == XK_upleftcorner) return \"upleftcorner\";\n\tif (k == XK_lowleftcorner) return \"lowleftcorner\";\n\tif (k == XK_crossinglines) return \"crossinglines\";\n\tif (k == XK_horizlinescan1) return \"horizlinescan1\";\n\tif (k == XK_horizlinescan3) return \"horizlinescan3\";\n\tif (k == XK_horizlinescan5) return \"horizlinescan5\";\n\tif (k == XK_horizlinescan7) return \"horizlinescan7\";\n\tif (k == XK_horizlinescan9) return \"horizlinescan9\";\n\tif (k == XK_leftt) return \"leftt\";\n\tif (k == XK_rightt) return \"rightt\";\n\tif (k == XK_bott) return \"bott\";\n\tif (k == XK_topt) return \"topt\";\n\tif (k == XK_vertbar) return \"vertbar\";\n#endif /* XK_SPECIAL */\n#ifdef XK_PUBLISHING\n\tif (k == XK_emspace) return \"emspace\";\n\tif (k == XK_enspace) return \"enspace\";\n\tif (k == XK_em3space) return \"em3space\";\n\tif (k == XK_em4space) return \"em4space\";\n\tif (k == XK_digitspace) return \"digitspace\";\n\tif (k == XK_punctspace) return \"punctspace\";\n\tif (k == XK_thinspace) return \"thinspace\";\n\tif (k == XK_hairspace) return \"hairspace\";\n\tif (k == XK_emdash) return \"emdash\";\n\tif (k == XK_endash) return \"endash\";\n\tif (k == XK_signifblank) return \"signifblank\";\n\tif (k == XK_ellipsis) return \"ellipsis\";\n\tif (k == XK_doubbaselinedot) return \"doubbaselinedot\";\n\tif (k == XK_onethird) return \"onethird\";\n\tif (k == XK_twothirds) return \"twothirds\";\n\tif (k == XK_onefifth) return \"onefifth\";\n\tif (k == XK_twofifths) return \"twofifths\";\n\tif (k == XK_threefifths) return \"threefifths\";\n\tif (k == XK_fourfifths) return \"fourfifths\";\n\tif (k == XK_onesixth) return \"onesixth\";\n\tif (k == XK_fivesixths) return \"fivesixths\";\n\tif (k == XK_careof) return \"careof\";\n\tif (k == XK_figdash) return \"figdash\";\n\tif (k == XK_leftanglebracket) return \"leftanglebracket\";\n\tif (k == XK_decimalpoint) return \"decimalpoint\";\n\tif (k == XK_rightanglebracket) return \"rightanglebracket\";\n\tif (k == XK_marker) return \"marker\";\n\tif (k == XK_oneeighth) return \"oneeighth\";\n\tif (k == XK_threeeighths) return \"threeeighths\";\n\tif (k == XK_fiveeighths) return \"fiveeighths\";\n\tif (k == XK_seveneighths) return \"seveneighths\";\n\tif (k == XK_trademark) return \"trademark\";\n\tif (k == XK_signaturemark) return \"signaturemark\";\n\tif (k == XK_trademarkincircle) return \"trademarkincircle\";\n\tif (k == XK_leftopentriangle) return \"leftopentriangle\";\n\tif (k == XK_rightopentriangle) return \"rightopentriangle\";\n\tif (k == XK_emopencircle) return \"emopencircle\";\n\tif (k == XK_emopenrectangle) return \"emopenrectangle\";\n\tif (k == XK_leftsinglequotemark) return \"leftsinglequotemark\";\n\tif (k == XK_rightsinglequotemark) return \"rightsinglequotemark\";\n\tif (k == XK_leftdoublequotemark) return \"leftdoublequotemark\";\n\tif (k == XK_rightdoublequotemark) return \"rightdoublequotemark\";\n\tif (k == XK_prescription) return \"prescription\";\n\tif (k == XK_minutes) return \"minutes\";\n\tif (k == XK_seconds) return \"seconds\";\n\tif (k == XK_latincross) return \"latincross\";\n\tif (k == XK_hexagram) return \"hexagram\";\n\tif (k == XK_filledrectbullet) return \"filledrectbullet\";\n\tif (k == XK_filledlefttribullet) return \"filledlefttribullet\";\n\tif (k == XK_filledrighttribullet) return \"filledrighttribullet\";\n\tif (k == XK_emfilledcircle) return \"emfilledcircle\";\n\tif (k == XK_emfilledrect) return \"emfilledrect\";\n\tif (k == XK_enopencircbullet) return \"enopencircbullet\";\n\tif (k == XK_enopensquarebullet) return \"enopensquarebullet\";\n\tif (k == XK_openrectbullet) return \"openrectbullet\";\n\tif (k == XK_opentribulletup) return \"opentribulletup\";\n\tif (k == XK_opentribulletdown) return \"opentribulletdown\";\n\tif (k == XK_openstar) return \"openstar\";\n\tif (k == XK_enfilledcircbullet) return \"enfilledcircbullet\";\n\tif (k == XK_enfilledsqbullet) return \"enfilledsqbullet\";\n\tif (k == XK_filledtribulletup) return \"filledtribulletup\";\n\tif (k == XK_filledtribulletdown) return \"filledtribulletdown\";\n\tif (k == XK_leftpointer) return \"leftpointer\";\n\tif (k == XK_rightpointer) return \"rightpointer\";\n\tif (k == XK_club) return \"club\";\n\tif (k == XK_diamond) return \"diamond\";\n\tif (k == XK_heart) return \"heart\";\n\tif (k == XK_maltesecross) return \"maltesecross\";\n\tif (k == XK_dagger) return \"dagger\";\n\tif (k == XK_doubledagger) return \"doubledagger\";\n\tif (k == XK_checkmark) return \"checkmark\";\n\tif (k == XK_ballotcross) return \"ballotcross\";\n\tif (k == XK_musicalsharp) return \"musicalsharp\";\n\tif (k == XK_musicalflat) return \"musicalflat\";\n\tif (k == XK_malesymbol) return \"malesymbol\";\n\tif (k == XK_femalesymbol) return \"femalesymbol\";\n\tif (k == XK_telephone) return \"telephone\";\n\tif (k == XK_telephonerecorder) return \"telephonerecorder\";\n\tif (k == XK_phonographcopyright) return \"phonographcopyright\";\n\tif (k == XK_caret) return \"caret\";\n\tif (k == XK_singlelowquotemark) return \"singlelowquotemark\";\n\tif (k == XK_doublelowquotemark) return \"doublelowquotemark\";\n\tif (k == XK_cursor) return \"cursor\";\n#endif /* XK_PUBLISHING */\n#ifdef XK_APL\n\tif (k == XK_leftcaret) return \"leftcaret\";\n\tif (k == XK_rightcaret) return \"rightcaret\";\n\tif (k == XK_downcaret) return \"downcaret\";\n\tif (k == XK_upcaret) return \"upcaret\";\n\tif (k == XK_overbar) return \"overbar\";\n\tif (k == XK_downtack) return \"downtack\";\n\tif (k == XK_upshoe) return \"upshoe\";\n\tif (k == XK_downstile) return \"downstile\";\n\tif (k == XK_underbar) return \"underbar\";\n\tif (k == XK_jot) return \"jot\";\n\tif (k == XK_quad) return \"quad\";\n\tif (k == XK_uptack) return \"uptack\";\n\tif (k == XK_circle) return \"circle\";\n\tif (k == XK_upstile) return \"upstile\";\n\tif (k == XK_downshoe) return \"downshoe\";\n\tif (k == XK_rightshoe) return \"rightshoe\";\n\tif (k == XK_leftshoe) return \"leftshoe\";\n\tif (k == XK_lefttack) return \"lefttack\";\n\tif (k == XK_righttack) return \"righttack\";\n#endif /* XK_APL */\n#ifdef XK_HEBREW\n\tif (k == XK_hebrew_doublelowline) return \"hebrew_doublelowline\";\n\tif (k == XK_hebrew_aleph) return \"hebrew_aleph\";\n\tif (k == XK_hebrew_bet) return \"hebrew_bet\";\n\tif (k == XK_hebrew_beth) return \"hebrew_beth\";\n\tif (k == XK_hebrew_gimel) return \"hebrew_gimel\";\n\tif (k == XK_hebrew_gimmel) return \"hebrew_gimmel\";\n\tif (k == XK_hebrew_dalet) return \"hebrew_dalet\";\n\tif (k == XK_hebrew_daleth) return \"hebrew_daleth\";\n\tif (k == XK_hebrew_he) return \"hebrew_he\";\n\tif (k == XK_hebrew_waw) return \"hebrew_waw\";\n\tif (k == XK_hebrew_zain) return \"hebrew_zain\";\n\tif (k == XK_hebrew_zayin) return \"hebrew_zayin\";\n\tif (k == XK_hebrew_chet) return \"hebrew_chet\";\n\tif (k == XK_hebrew_het) return \"hebrew_het\";\n\tif (k == XK_hebrew_tet) return \"hebrew_tet\";\n\tif (k == XK_hebrew_teth) return \"hebrew_teth\";\n\tif (k == XK_hebrew_yod) return \"hebrew_yod\";\n\tif (k == XK_hebrew_finalkaph) return \"hebrew_finalkaph\";\n\tif (k == XK_hebrew_kaph) return \"hebrew_kaph\";\n\tif (k == XK_hebrew_lamed) return \"hebrew_lamed\";\n\tif (k == XK_hebrew_finalmem) return \"hebrew_finalmem\";\n\tif (k == XK_hebrew_mem) return \"hebrew_mem\";\n\tif (k == XK_hebrew_finalnun) return \"hebrew_finalnun\";\n\tif (k == XK_hebrew_nun) return \"hebrew_nun\";\n\tif (k == XK_hebrew_samech) return \"hebrew_samech\";\n\tif (k == XK_hebrew_samekh) return \"hebrew_samekh\";\n\tif (k == XK_hebrew_ayin) return \"hebrew_ayin\";\n\tif (k == XK_hebrew_finalpe) return \"hebrew_finalpe\";\n\tif (k == XK_hebrew_pe) return \"hebrew_pe\";\n\tif (k == XK_hebrew_finalzade) return \"hebrew_finalzade\";\n\tif (k == XK_hebrew_finalzadi) return \"hebrew_finalzadi\";\n\tif (k == XK_hebrew_zade) return \"hebrew_zade\";\n\tif (k == XK_hebrew_zadi) return \"hebrew_zadi\";\n\tif (k == XK_hebrew_qoph) return \"hebrew_qoph\";\n\tif (k == XK_hebrew_kuf) return \"hebrew_kuf\";\n\tif (k == XK_hebrew_resh) return \"hebrew_resh\";\n\tif (k == XK_hebrew_shin) return \"hebrew_shin\";\n\tif (k == XK_hebrew_taw) return \"hebrew_taw\";\n\tif (k == XK_hebrew_taf) return \"hebrew_taf\";\n\tif (k == XK_Hebrew_switch) return \"Hebrew_switch\";\n#endif /* XK_HEBREW */\n#ifdef XK_THAI\n\tif (k == XK_Thai_kokai) return \"Thai_kokai\";\n\tif (k == XK_Thai_khokhai) return \"Thai_khokhai\";\n\tif (k == XK_Thai_khokhuat) return \"Thai_khokhuat\";\n\tif (k == XK_Thai_khokhwai) return \"Thai_khokhwai\";\n\tif (k == XK_Thai_khokhon) return \"Thai_khokhon\";\n\tif (k == XK_Thai_khorakhang) return \"Thai_khorakhang\";\n\tif (k == XK_Thai_ngongu) return \"Thai_ngongu\";\n\tif (k == XK_Thai_chochan) return \"Thai_chochan\";\n\tif (k == XK_Thai_choching) return \"Thai_choching\";\n\tif (k == XK_Thai_chochang) return \"Thai_chochang\";\n\tif (k == XK_Thai_soso) return \"Thai_soso\";\n\tif (k == XK_Thai_chochoe) return \"Thai_chochoe\";\n\tif (k == XK_Thai_yoying) return \"Thai_yoying\";\n\tif (k == XK_Thai_dochada) return \"Thai_dochada\";\n\tif (k == XK_Thai_topatak) return \"Thai_topatak\";\n\tif (k == XK_Thai_thothan) return \"Thai_thothan\";\n\tif (k == XK_Thai_thonangmontho) return \"Thai_thonangmontho\";\n\tif (k == XK_Thai_thophuthao) return \"Thai_thophuthao\";\n\tif (k == XK_Thai_nonen) return \"Thai_nonen\";\n\tif (k == XK_Thai_dodek) return \"Thai_dodek\";\n\tif (k == XK_Thai_totao) return \"Thai_totao\";\n\tif (k == XK_Thai_thothung) return \"Thai_thothung\";\n\tif (k == XK_Thai_thothahan) return \"Thai_thothahan\";\n\tif (k == XK_Thai_thothong) return \"Thai_thothong\";\n\tif (k == XK_Thai_nonu) return \"Thai_nonu\";\n\tif (k == XK_Thai_bobaimai) return \"Thai_bobaimai\";\n\tif (k == XK_Thai_popla) return \"Thai_popla\";\n\tif (k == XK_Thai_phophung) return \"Thai_phophung\";\n\tif (k == XK_Thai_fofa) return \"Thai_fofa\";\n\tif (k == XK_Thai_phophan) return \"Thai_phophan\";\n\tif (k == XK_Thai_fofan) return \"Thai_fofan\";\n\tif (k == XK_Thai_phosamphao) return \"Thai_phosamphao\";\n\tif (k == XK_Thai_moma) return \"Thai_moma\";\n\tif (k == XK_Thai_yoyak) return \"Thai_yoyak\";\n\tif (k == XK_Thai_rorua) return \"Thai_rorua\";\n\tif (k == XK_Thai_ru) return \"Thai_ru\";\n\tif (k == XK_Thai_loling) return \"Thai_loling\";\n\tif (k == XK_Thai_lu) return \"Thai_lu\";\n\tif (k == XK_Thai_wowaen) return \"Thai_wowaen\";\n\tif (k == XK_Thai_sosala) return \"Thai_sosala\";\n\tif (k == XK_Thai_sorusi) return \"Thai_sorusi\";\n\tif (k == XK_Thai_sosua) return \"Thai_sosua\";\n\tif (k == XK_Thai_hohip) return \"Thai_hohip\";\n\tif (k == XK_Thai_lochula) return \"Thai_lochula\";\n\tif (k == XK_Thai_oang) return \"Thai_oang\";\n\tif (k == XK_Thai_honokhuk) return \"Thai_honokhuk\";\n\tif (k == XK_Thai_paiyannoi) return \"Thai_paiyannoi\";\n\tif (k == XK_Thai_saraa) return \"Thai_saraa\";\n\tif (k == XK_Thai_maihanakat) return \"Thai_maihanakat\";\n\tif (k == XK_Thai_saraaa) return \"Thai_saraaa\";\n\tif (k == XK_Thai_saraam) return \"Thai_saraam\";\n\tif (k == XK_Thai_sarai) return \"Thai_sarai\";\n\tif (k == XK_Thai_saraii) return \"Thai_saraii\";\n\tif (k == XK_Thai_saraue) return \"Thai_saraue\";\n\tif (k == XK_Thai_sarauee) return \"Thai_sarauee\";\n\tif (k == XK_Thai_sarau) return \"Thai_sarau\";\n\tif (k == XK_Thai_sarauu) return \"Thai_sarauu\";\n\tif (k == XK_Thai_phinthu) return \"Thai_phinthu\";\n\tif (k == XK_Thai_maihanakat_maitho) return \"Thai_maihanakat_maitho\";\n\tif (k == XK_Thai_baht) return \"Thai_baht\";\n\tif (k == XK_Thai_sarae) return \"Thai_sarae\";\n\tif (k == XK_Thai_saraae) return \"Thai_saraae\";\n\tif (k == XK_Thai_sarao) return \"Thai_sarao\";\n\tif (k == XK_Thai_saraaimaimuan) return \"Thai_saraaimaimuan\";\n\tif (k == XK_Thai_saraaimaimalai) return \"Thai_saraaimaimalai\";\n\tif (k == XK_Thai_lakkhangyao) return \"Thai_lakkhangyao\";\n\tif (k == XK_Thai_maiyamok) return \"Thai_maiyamok\";\n\tif (k == XK_Thai_maitaikhu) return \"Thai_maitaikhu\";\n\tif (k == XK_Thai_maiek) return \"Thai_maiek\";\n\tif (k == XK_Thai_maitho) return \"Thai_maitho\";\n\tif (k == XK_Thai_maitri) return \"Thai_maitri\";\n\tif (k == XK_Thai_maichattawa) return \"Thai_maichattawa\";\n\tif (k == XK_Thai_thanthakhat) return \"Thai_thanthakhat\";\n\tif (k == XK_Thai_nikhahit) return \"Thai_nikhahit\";\n\tif (k == XK_Thai_leksun) return \"Thai_leksun\";\n\tif (k == XK_Thai_leknung) return \"Thai_leknung\";\n\tif (k == XK_Thai_leksong) return \"Thai_leksong\";\n\tif (k == XK_Thai_leksam) return \"Thai_leksam\";\n\tif (k == XK_Thai_leksi) return \"Thai_leksi\";\n\tif (k == XK_Thai_lekha) return \"Thai_lekha\";\n\tif (k == XK_Thai_lekhok) return \"Thai_lekhok\";\n\tif (k == XK_Thai_lekchet) return \"Thai_lekchet\";\n\tif (k == XK_Thai_lekpaet) return \"Thai_lekpaet\";\n\tif (k == XK_Thai_lekkao) return \"Thai_lekkao\";\n#endif /* XK_THAI */\n#ifdef XK_KOREAN\n\tif (k == XK_Hangul) return \"Hangul\";\n\tif (k == XK_Hangul_Start) return \"Hangul_Start\";\n\tif (k == XK_Hangul_End) return \"Hangul_End\";\n\tif (k == XK_Hangul_Hanja) return \"Hangul_Hanja\";\n\tif (k == XK_Hangul_Jamo) return \"Hangul_Jamo\";\n\tif (k == XK_Hangul_Romaja) return \"Hangul_Romaja\";\n\tif (k == XK_Hangul_Codeinput) return \"Hangul_Codeinput\";\n\tif (k == XK_Hangul_Jeonja) return \"Hangul_Jeonja\";\n\tif (k == XK_Hangul_Banja) return \"Hangul_Banja\";\n\tif (k == XK_Hangul_PreHanja) return \"Hangul_PreHanja\";\n\tif (k == XK_Hangul_PostHanja) return \"Hangul_PostHanja\";\n\tif (k == XK_Hangul_SingleCandidate) return \"Hangul_SingleCandidate\";\n\tif (k == XK_Hangul_MultipleCandidate) return \"Hangul_MultipleCandidate\";\n\tif (k == XK_Hangul_PreviousCandidate) return \"Hangul_PreviousCandidate\";\n\tif (k == XK_Hangul_Special) return \"Hangul_Special\";\n\tif (k == XK_Hangul_switch) return \"Hangul_switch\";\n\tif (k == XK_Hangul_Kiyeog) return \"Hangul_Kiyeog\";\n\tif (k == XK_Hangul_SsangKiyeog) return \"Hangul_SsangKiyeog\";\n\tif (k == XK_Hangul_KiyeogSios) return \"Hangul_KiyeogSios\";\n\tif (k == XK_Hangul_Nieun) return \"Hangul_Nieun\";\n\tif (k == XK_Hangul_NieunJieuj) return \"Hangul_NieunJieuj\";\n\tif (k == XK_Hangul_NieunHieuh) return \"Hangul_NieunHieuh\";\n\tif (k == XK_Hangul_Dikeud) return \"Hangul_Dikeud\";\n\tif (k == XK_Hangul_SsangDikeud) return \"Hangul_SsangDikeud\";\n\tif (k == XK_Hangul_Rieul) return \"Hangul_Rieul\";\n\tif (k == XK_Hangul_RieulKiyeog) return \"Hangul_RieulKiyeog\";\n\tif (k == XK_Hangul_RieulMieum) return \"Hangul_RieulMieum\";\n\tif (k == XK_Hangul_RieulPieub) return \"Hangul_RieulPieub\";\n\tif (k == XK_Hangul_RieulSios) return \"Hangul_RieulSios\";\n\tif (k == XK_Hangul_RieulTieut) return \"Hangul_RieulTieut\";\n\tif (k == XK_Hangul_RieulPhieuf) return \"Hangul_RieulPhieuf\";\n\tif (k == XK_Hangul_RieulHieuh) return \"Hangul_RieulHieuh\";\n\tif (k == XK_Hangul_Mieum) return \"Hangul_Mieum\";\n\tif (k == XK_Hangul_Pieub) return \"Hangul_Pieub\";\n\tif (k == XK_Hangul_SsangPieub) return \"Hangul_SsangPieub\";\n\tif (k == XK_Hangul_PieubSios) return \"Hangul_PieubSios\";\n\tif (k == XK_Hangul_Sios) return \"Hangul_Sios\";\n\tif (k == XK_Hangul_SsangSios) return \"Hangul_SsangSios\";\n\tif (k == XK_Hangul_Ieung) return \"Hangul_Ieung\";\n\tif (k == XK_Hangul_Jieuj) return \"Hangul_Jieuj\";\n\tif (k == XK_Hangul_SsangJieuj) return \"Hangul_SsangJieuj\";\n\tif (k == XK_Hangul_Cieuc) return \"Hangul_Cieuc\";\n\tif (k == XK_Hangul_Khieuq) return \"Hangul_Khieuq\";\n\tif (k == XK_Hangul_Tieut) return \"Hangul_Tieut\";\n\tif (k == XK_Hangul_Phieuf) return \"Hangul_Phieuf\";\n\tif (k == XK_Hangul_Hieuh) return \"Hangul_Hieuh\";\n\tif (k == XK_Hangul_A) return \"Hangul_A\";\n\tif (k == XK_Hangul_AE) return \"Hangul_AE\";\n\tif (k == XK_Hangul_YA) return \"Hangul_YA\";\n\tif (k == XK_Hangul_YAE) return \"Hangul_YAE\";\n\tif (k == XK_Hangul_EO) return \"Hangul_EO\";\n\tif (k == XK_Hangul_E) return \"Hangul_E\";\n\tif (k == XK_Hangul_YEO) return \"Hangul_YEO\";\n\tif (k == XK_Hangul_YE) return \"Hangul_YE\";\n\tif (k == XK_Hangul_O) return \"Hangul_O\";\n\tif (k == XK_Hangul_WA) return \"Hangul_WA\";\n\tif (k == XK_Hangul_WAE) return \"Hangul_WAE\";\n\tif (k == XK_Hangul_OE) return \"Hangul_OE\";\n\tif (k == XK_Hangul_YO) return \"Hangul_YO\";\n\tif (k == XK_Hangul_U) return \"Hangul_U\";\n\tif (k == XK_Hangul_WEO) return \"Hangul_WEO\";\n\tif (k == XK_Hangul_WE) return \"Hangul_WE\";\n\tif (k == XK_Hangul_WI) return \"Hangul_WI\";\n\tif (k == XK_Hangul_YU) return \"Hangul_YU\";\n\tif (k == XK_Hangul_EU) return \"Hangul_EU\";\n\tif (k == XK_Hangul_YI) return \"Hangul_YI\";\n\tif (k == XK_Hangul_I) return \"Hangul_I\";\n\tif (k == XK_Hangul_J_Kiyeog) return \"Hangul_J_Kiyeog\";\n\tif (k == XK_Hangul_J_SsangKiyeog) return \"Hangul_J_SsangKiyeog\";\n\tif (k == XK_Hangul_J_KiyeogSios) return \"Hangul_J_KiyeogSios\";\n\tif (k == XK_Hangul_J_Nieun) return \"Hangul_J_Nieun\";\n\tif (k == XK_Hangul_J_NieunJieuj) return \"Hangul_J_NieunJieuj\";\n\tif (k == XK_Hangul_J_NieunHieuh) return \"Hangul_J_NieunHieuh\";\n\tif (k == XK_Hangul_J_Dikeud) return \"Hangul_J_Dikeud\";\n\tif (k == XK_Hangul_J_Rieul) return \"Hangul_J_Rieul\";\n\tif (k == XK_Hangul_J_RieulKiyeog) return \"Hangul_J_RieulKiyeog\";\n\tif (k == XK_Hangul_J_RieulMieum) return \"Hangul_J_RieulMieum\";\n\tif (k == XK_Hangul_J_RieulPieub) return \"Hangul_J_RieulPieub\";\n\tif (k == XK_Hangul_J_RieulSios) return \"Hangul_J_RieulSios\";\n\tif (k == XK_Hangul_J_RieulTieut) return \"Hangul_J_RieulTieut\";\n\tif (k == XK_Hangul_J_RieulPhieuf) return \"Hangul_J_RieulPhieuf\";\n\tif (k == XK_Hangul_J_RieulHieuh) return \"Hangul_J_RieulHieuh\";\n\tif (k == XK_Hangul_J_Mieum) return \"Hangul_J_Mieum\";\n\tif (k == XK_Hangul_J_Pieub) return \"Hangul_J_Pieub\";\n\tif (k == XK_Hangul_J_PieubSios) return \"Hangul_J_PieubSios\";\n\tif (k == XK_Hangul_J_Sios) return \"Hangul_J_Sios\";\n\tif (k == XK_Hangul_J_SsangSios) return \"Hangul_J_SsangSios\";\n\tif (k == XK_Hangul_J_Ieung) return \"Hangul_J_Ieung\";\n\tif (k == XK_Hangul_J_Jieuj) return \"Hangul_J_Jieuj\";\n\tif (k == XK_Hangul_J_Cieuc) return \"Hangul_J_Cieuc\";\n\tif (k == XK_Hangul_J_Khieuq) return \"Hangul_J_Khieuq\";\n\tif (k == XK_Hangul_J_Tieut) return \"Hangul_J_Tieut\";\n\tif (k == XK_Hangul_J_Phieuf) return \"Hangul_J_Phieuf\";\n\tif (k == XK_Hangul_J_Hieuh) return \"Hangul_J_Hieuh\";\n\tif (k == XK_Hangul_RieulYeorinHieuh) return \"Hangul_RieulYeorinHieuh\";\n\tif (k == XK_Hangul_SunkyeongeumMieum) return \"Hangul_SunkyeongeumMieum\";\n\tif (k == XK_Hangul_SunkyeongeumPieub) return \"Hangul_SunkyeongeumPieub\";\n\tif (k == XK_Hangul_PanSios) return \"Hangul_PanSios\";\n\tif (k == XK_Hangul_KkogjiDalrinIeung) return \"Hangul_KkogjiDalrinIeung\";\n\tif (k == XK_Hangul_SunkyeongeumPhieuf) return \"Hangul_SunkyeongeumPhieuf\";\n\tif (k == XK_Hangul_YeorinHieuh) return \"Hangul_YeorinHieuh\";\n\tif (k == XK_Hangul_AraeA) return \"Hangul_AraeA\";\n\tif (k == XK_Hangul_AraeAE) return \"Hangul_AraeAE\";\n\tif (k == XK_Hangul_J_PanSios) return \"Hangul_J_PanSios\";\n\tif (k == XK_Hangul_J_KkogjiDalrinIeung) return \"Hangul_J_KkogjiDalrinIeung\";\n\tif (k == XK_Hangul_J_YeorinHieuh) return \"Hangul_J_YeorinHieuh\";\n\tif (k == XK_Korean_Won) return \"Korean_Won\";\n#endif /* XK_KOREAN */\n\tif (k == XK_EuroSign) return \"EuroSign\";\n#endif\n\treturn NULL;\t\n}"
        }
      },
      {
        "call_info": {
          "callee": "XKeycodeToKeysym_wr",
          "args": [
            "dpy",
            "key",
            "0"
          ],
          "line": 890
        },
        "resolved": true,
        "details": {
          "function_name": "XKeycodeToKeysym_wr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "1699-1709",
          "snippet": "KeySym XKeycodeToKeysym_wr(Display *display, KeyCode keycode, int index) {\n#if NO_X11\n\treturn 0;\n#else\n#if !HAVE_XKEYBOARD || SKIP_XKB\n\treturn XKeycodeToKeysym(display, keycode, index);\n#else\n\treturn XkbKeycodeToKeysym(display, keycode, 0, index);\n#endif\n#endif\n}",
          "includes": [
            "#include \"nox11_funcs.h\"",
            "#include \"xwrappers.h\"",
            "#include \"xi2_devices.h\"",
            "#include \"macosx.h\"",
            "#include \"cleanup.h\"",
            "#include \"connections.h\"",
            "#include \"xevents.h\"",
            "#include \"keyboard.h\"",
            "#include \"xrecord.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int XCloseDisplay_wr(Display *display);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint XCloseDisplay_wr(Display *display);\n\nKeySym XKeycodeToKeysym_wr(Display *display, KeyCode keycode, int index) {\n#if NO_X11\n\treturn 0;\n#else\n#if !HAVE_XKEYBOARD || SKIP_XKB\n\treturn XKeycodeToKeysym(display, keycode, index);\n#else\n\treturn XkbKeycodeToKeysym(display, keycode, 0, index);\n#endif\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint keycode_state[256];\nvoid XTestDiscard_wr(Display *dpy);\nstatic void upup_downdown_warning(KeyCode key, Bool down);\n\nstatic void upup_downdown_warning(KeyCode key, Bool down) {\n\tRAWFB_RET_VOID\n#if NO_X11\n\tif (!key || !down) {}\n\treturn;\n#else\n\tif ((down ? 1:0) == keycode_state[(int) key]) {\n\t\tchar *str = XKeysymToString(XKeycodeToKeysym_wr(dpy, key, 0));\n\t\trfbLog(\"XTestFakeKeyEvent: keycode=0x%x \\\"%s\\\" is *already* \"\n\t\t    \"%s\\n\", key, str ? str : \"null\", down ? \"down\":\"up\");\n\t}\n#endif\t/* NO_X11 */\n}"
  },
  {
    "function_name": "init_track_keycode_state",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "875-881",
    "snippet": "void init_track_keycode_state(void) {\n\tint i;\n\tfor (i=0; i<256; i++) {\n\t\tkeycode_state[i] = 0;\n\t}\n\tget_keystate(keycode_state);\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int keycode_state[256];",
      "void init_track_keycode_state(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_keystate",
          "args": [
            "keycode_state"
          ],
          "line": 880
        },
        "resolved": true,
        "details": {
          "function_name": "get_keystate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/keyboard.c",
          "lines": "94-120",
          "snippet": "void get_keystate(int *keystate) {\n#if NO_X11\n\tRAWFB_RET_VOID\n\tif (!keystate) {}\n\treturn;\n#else\n\tint i, k;\n\tchar keys[32];\n\n\tRAWFB_RET_VOID\n\t\n\t/* n.b. caller decides to X_LOCK or not. */\n\tXQueryKeymap(dpy, keys);\n\tfor (i=0; i<32; i++) {\n\t\tchar c = keys[i];\n\n\t\tfor (k=0; k < 8; k++) {\n\t\t\tif (c & 0x1) {\n\t\t\t\tkeystate[8*i + k] = 1;\n\t\t\t} else {\n\t\t\t\tkeystate[8*i + k] = 0;\n\t\t\t}\n\t\t\tc = c >> 1;\n\t\t}\n\t}\n#endif\t/* NO_X11 */\n}",
          "includes": [
            "#include \"xi2_devices.h\"",
            "#include \"screen.h\"",
            "#include \"macosx.h\"",
            "#include \"uinput.h\"",
            "#include \"linuxfb.h\"",
            "#include \"v4l.h\"",
            "#include \"unixpw.h\"",
            "#include \"allowed_input_t.h\"",
            "#include \"cleanup.h\"",
            "#include \"rates.h\"",
            "#include \"win_utils.h\"",
            "#include \"userinput.h\"",
            "#include \"pointer.h\"",
            "#include \"xinerama.h\"",
            "#include \"xrecord.h\"",
            "#include \"xwrappers.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void get_keystate(int *keystate);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xi2_devices.h\"\n#include \"screen.h\"\n#include \"macosx.h\"\n#include \"uinput.h\"\n#include \"linuxfb.h\"\n#include \"v4l.h\"\n#include \"unixpw.h\"\n#include \"allowed_input_t.h\"\n#include \"cleanup.h\"\n#include \"rates.h\"\n#include \"win_utils.h\"\n#include \"userinput.h\"\n#include \"pointer.h\"\n#include \"xinerama.h\"\n#include \"xrecord.h\"\n#include \"xwrappers.h\"\n#include \"x11vnc.h\"\n\nvoid get_keystate(int *keystate);\n\nvoid get_keystate(int *keystate) {\n#if NO_X11\n\tRAWFB_RET_VOID\n\tif (!keystate) {}\n\treturn;\n#else\n\tint i, k;\n\tchar keys[32];\n\n\tRAWFB_RET_VOID\n\t\n\t/* n.b. caller decides to X_LOCK or not. */\n\tXQueryKeymap(dpy, keys);\n\tfor (i=0; i<32; i++) {\n\t\tchar c = keys[i];\n\n\t\tfor (k=0; k < 8; k++) {\n\t\t\tif (c & 0x1) {\n\t\t\t\tkeystate[8*i + k] = 1;\n\t\t\t} else {\n\t\t\t\tkeystate[8*i + k] = 0;\n\t\t\t}\n\t\t\tc = c >> 1;\n\t\t}\n\t}\n#endif\t/* NO_X11 */\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint keycode_state[256];\nvoid init_track_keycode_state(void);\n\nvoid init_track_keycode_state(void) {\n\tint i;\n\tfor (i=0; i<256; i++) {\n\t\tkeycode_state[i] = 0;\n\t}\n\tget_keystate(keycode_state);\n}"
  },
  {
    "function_name": "copy_image",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "832-868",
    "snippet": "void copy_image(XImage *dest, int x, int y, unsigned int w, unsigned int h) {\n\t/* default (w=0, h=0) is the fill the entire XImage */\n\tif (dest == NULL) {\n\t\treturn;\n\t}\n\tif (w < 1)  {\n\t\tw = dest->width;\n\t}\n\tif (h < 1)  {\n\t\th = dest->height;\n\t}\n\n\tif (raw_fb) {\n\t\tcopy_raw_fb(dest, x, y, w, h);\n\n\t} else if (use_snapfb && snap_fb && dest != snaprect) {\n\t\tchar *src, *dst;\n\t\tunsigned int line;\n\t\tint pixelsize = bpp/8;\n\n\t\tsrc = snap->data + snap->bytes_per_line*y + pixelsize*x;\n\t\tdst = dest->data;\n\t\tfor (line = 0; line < h; line++) {\n\t\t\tmemcpy(dst, src, w * pixelsize);\n\t\t\tsrc += snap->bytes_per_line;\n\t\t\tdst += dest->bytes_per_line;\n\t\t}\n\n\t} else if ((using_shm && ! xform24to32) && (int) w == dest->width &&\n\t    (int) h == dest->height) {\n\t\tXShmGetImage_wr(dpy, window, dest, x, y, AllPlanes);\n\n\t} else {\n\t\tXGetSubImage_wr(dpy, window, x, y, w, h, AllPlanes,\n\t\t    ZPixmap, dest, 0, 0);\n\t}\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "XImage *XShmCreateImage_wr(Display* disp, Visual* vis, unsigned int depth,\n    int format, char* data, XShmSegmentInfo* shminfo, unsigned int width,\n    unsigned int height);",
      "XImage *XCreateImage_wr(Display *disp, Visual *visual, unsigned int depth,\n    int format, int offset, char *data, unsigned int width,\n    unsigned int height, int bitmap_pad, int bytes_per_line);",
      "void copy_image(XImage *dest, int x, int y, unsigned int w, unsigned int h);",
      "Bool XTestCompareCurrentCursorWithWindow_wr(Display* dpy, Window w);",
      "void XTestDiscard_wr(Display *dpy);",
      "int XFree_wr(void *data);",
      "void copy_raw_fb(XImage *dest, int x, int y, unsigned int w, unsigned int h);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "XGetSubImage_wr",
          "args": [
            "dpy",
            "window",
            "x",
            "y",
            "w",
            "h",
            "AllPlanes",
            "ZPixmap",
            "dest",
            "0",
            "0"
          ],
          "line": 865
        },
        "resolved": true,
        "details": {
          "function_name": "XGetSubImage_wr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "293-338",
          "snippet": "XImage *XGetSubImage_wr(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, unsigned long plane_mask,\n    int format, XImage *dest_image, int dest_x, int dest_y) {\n#if NO_X11\n\tnox11_exit(1);\n\tif (!disp || !d || !x || !y || !width || !height || !plane_mask || !format || !dest_image || !dest_x || !dest_y) {}\n\treturn NULL;\n#else\n\tADJUST_ROOTSHIFT\n\n\tif (overlay && dest_x == 0 && dest_y == 0) {\n\t\tsize_t size = dest_image->height * dest_image->bytes_per_line;\n\t\tXImage *xi;\n\n\t\txi = xreadscreen(disp, d, x, y, width, height,\n\t\t    (Bool) overlay_cursor);\n\n\t\tif (! xi) return NULL;\n\n\t\t/*\n\t\t * There is extra overhead from memcpy and free...\n\t\t * this is not like the real XGetSubImage().  We hope\n\t\t * this significant overhead is still small compared to\n\t\t * the time to retrieve the fb data.\n\t\t */\n\t\tmemcpy(dest_image->data, xi->data, size);\n\n\t\tXDestroyImage(xi);\n\t\treturn (dest_image);\n\t}\n#if HAVE_LIBXCOMPOSITE\n\tif(use_xcomposite && subwin && !rootshift) {\n\t  XErrorHandler old_handler = XSetErrorHandler(trap_xerror);\n\t  Pixmap pixmap = XCompositeNameWindowPixmap(disp, d);\n\t  XImage* xi =  XGetSubImage(disp, pixmap, x, y, width, height, plane_mask,\n\t\t\t     format, dest_image, dest_x, dest_y);\n\t  XFreePixmap(dpy, pixmap);\n\t  XSetErrorHandler(old_handler);\n\t  if(!trapped_xerror)\n\t    return xi;\n\t}\n#endif\n\treturn XGetSubImage(disp, d, x, y, width, height, plane_mask,\n\t    format, dest_image, dest_x, dest_y);\n#endif\t/* NO_X11 */\n}",
          "includes": [
            "#include \"nox11_funcs.h\"",
            "#include \"xwrappers.h\"",
            "#include \"xi2_devices.h\"",
            "#include \"macosx.h\"",
            "#include \"cleanup.h\"",
            "#include \"connections.h\"",
            "#include \"xevents.h\"",
            "#include \"keyboard.h\"",
            "#include \"xrecord.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [
            "#define ADJUST_ROOTSHIFT \\\n\tif (rootshift && subwin) { \\\n\t\td = rootwin; \\\n\t\tx += off_x; \\\n\t\ty += off_y; \\\n\t} \\\n\tif (clipshift) { \\\n\t\tx += coff_x; \\\n\t\ty += coff_y; \\\n\t}"
          ],
          "globals_used": [
            "int rootshift = 0;",
            "int XFlush_wr(Display *disp);",
            "XImage *XShmCreateImage_wr(Display* disp, Visual* vis, unsigned int depth,\n    int format, char* data, XShmSegmentInfo* shminfo, unsigned int width,\n    unsigned int height);",
            "Bool XShmQueryExtension_wr(Display *disp);",
            "int XShmGetEventBase_wr(Display *disp);",
            "XImage *XGetSubImage_wr(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, unsigned long plane_mask,\n    int format, XImage *dest_image, int dest_x, int dest_y);",
            "XImage *XGetImage_wr(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, unsigned long plane_mask,\n    int format);",
            "XImage *XCreateImage_wr(Display *disp, Visual *visual, unsigned int depth,\n    int format, int offset, char *data, unsigned int width,\n    unsigned int height, int bitmap_pad, int bytes_per_line);",
            "void XTestDiscard_wr(Display *dpy);",
            "int XFree_wr(void *data);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\n#define ADJUST_ROOTSHIFT \\\n\tif (rootshift && subwin) { \\\n\t\td = rootwin; \\\n\t\tx += off_x; \\\n\t\ty += off_y; \\\n\t} \\\n\tif (clipshift) { \\\n\t\tx += coff_x; \\\n\t\ty += coff_y; \\\n\t}\n\nint rootshift = 0;\nint XFlush_wr(Display *disp);\nXImage *XShmCreateImage_wr(Display* disp, Visual* vis, unsigned int depth,\n    int format, char* data, XShmSegmentInfo* shminfo, unsigned int width,\n    unsigned int height);\nBool XShmQueryExtension_wr(Display *disp);\nint XShmGetEventBase_wr(Display *disp);\nXImage *XGetSubImage_wr(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, unsigned long plane_mask,\n    int format, XImage *dest_image, int dest_x, int dest_y);\nXImage *XGetImage_wr(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, unsigned long plane_mask,\n    int format);\nXImage *XCreateImage_wr(Display *disp, Visual *visual, unsigned int depth,\n    int format, int offset, char *data, unsigned int width,\n    unsigned int height, int bitmap_pad, int bytes_per_line);\nvoid XTestDiscard_wr(Display *dpy);\nint XFree_wr(void *data);\n\nXImage *XGetSubImage_wr(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, unsigned long plane_mask,\n    int format, XImage *dest_image, int dest_x, int dest_y) {\n#if NO_X11\n\tnox11_exit(1);\n\tif (!disp || !d || !x || !y || !width || !height || !plane_mask || !format || !dest_image || !dest_x || !dest_y) {}\n\treturn NULL;\n#else\n\tADJUST_ROOTSHIFT\n\n\tif (overlay && dest_x == 0 && dest_y == 0) {\n\t\tsize_t size = dest_image->height * dest_image->bytes_per_line;\n\t\tXImage *xi;\n\n\t\txi = xreadscreen(disp, d, x, y, width, height,\n\t\t    (Bool) overlay_cursor);\n\n\t\tif (! xi) return NULL;\n\n\t\t/*\n\t\t * There is extra overhead from memcpy and free...\n\t\t * this is not like the real XGetSubImage().  We hope\n\t\t * this significant overhead is still small compared to\n\t\t * the time to retrieve the fb data.\n\t\t */\n\t\tmemcpy(dest_image->data, xi->data, size);\n\n\t\tXDestroyImage(xi);\n\t\treturn (dest_image);\n\t}\n#if HAVE_LIBXCOMPOSITE\n\tif(use_xcomposite && subwin && !rootshift) {\n\t  XErrorHandler old_handler = XSetErrorHandler(trap_xerror);\n\t  Pixmap pixmap = XCompositeNameWindowPixmap(disp, d);\n\t  XImage* xi =  XGetSubImage(disp, pixmap, x, y, width, height, plane_mask,\n\t\t\t     format, dest_image, dest_x, dest_y);\n\t  XFreePixmap(dpy, pixmap);\n\t  XSetErrorHandler(old_handler);\n\t  if(!trapped_xerror)\n\t    return xi;\n\t}\n#endif\n\treturn XGetSubImage(disp, d, x, y, width, height, plane_mask,\n\t    format, dest_image, dest_x, dest_y);\n#endif\t/* NO_X11 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "XShmGetImage_wr",
          "args": [
            "dpy",
            "window",
            "dest",
            "x",
            "y",
            "AllPlanes"
          ],
          "line": 862
        },
        "resolved": true,
        "details": {
          "function_name": "XShmGetImage_wr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "187-211",
          "snippet": "Status XShmGetImage_wr(Display *disp, Drawable d, XImage *image, int x, int y,\n    unsigned long mask) {\n\n\tADJUST_ROOTSHIFT\n\n\t/* Note: the Solaris overlay stuff is all non-shm (using_shm = 0) */\n\n#if HAVE_XSHM\n#if HAVE_LIBXCOMPOSITE\n\tif(use_xcomposite && subwin && !rootshift) {\n\t  XErrorHandler old_handler = XSetErrorHandler(trap_xerror);\n\t  Pixmap pixmap = XCompositeNameWindowPixmap(disp, d);\n\t  Status s = XShmGetImage(disp, pixmap, image, x, y, mask);\n\t  XFreePixmap(dpy, pixmap);\n\t  XSetErrorHandler(old_handler);\n\t  if(!trapped_xerror)\n\t    return s;\n\t}\n#endif\n\t  return XShmGetImage(disp, d, image, x, y, mask); \n#else\n\tif (!disp || !d || !image || !x || !y || !mask) {}\n\treturn (Status) 0;\n#endif\n}",
          "includes": [
            "#include \"nox11_funcs.h\"",
            "#include \"xwrappers.h\"",
            "#include \"xi2_devices.h\"",
            "#include \"macosx.h\"",
            "#include \"cleanup.h\"",
            "#include \"connections.h\"",
            "#include \"xevents.h\"",
            "#include \"keyboard.h\"",
            "#include \"xrecord.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [
            "#define ADJUST_ROOTSHIFT \\\n\tif (rootshift && subwin) { \\\n\t\td = rootwin; \\\n\t\tx += off_x; \\\n\t\ty += off_y; \\\n\t} \\\n\tif (clipshift) { \\\n\t\tx += coff_x; \\\n\t\ty += coff_y; \\\n\t}"
          ],
          "globals_used": [
            "int rootshift = 0;",
            "int XFlush_wr(Display *disp);",
            "Status XShmGetImage_wr(Display *disp, Drawable d, XImage *image, int x, int y,\n    unsigned long mask);",
            "Bool XShmQueryExtension_wr(Display *disp);",
            "int XShmGetEventBase_wr(Display *disp);",
            "void XTestDiscard_wr(Display *dpy);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\n#define ADJUST_ROOTSHIFT \\\n\tif (rootshift && subwin) { \\\n\t\td = rootwin; \\\n\t\tx += off_x; \\\n\t\ty += off_y; \\\n\t} \\\n\tif (clipshift) { \\\n\t\tx += coff_x; \\\n\t\ty += coff_y; \\\n\t}\n\nint rootshift = 0;\nint XFlush_wr(Display *disp);\nStatus XShmGetImage_wr(Display *disp, Drawable d, XImage *image, int x, int y,\n    unsigned long mask);\nBool XShmQueryExtension_wr(Display *disp);\nint XShmGetEventBase_wr(Display *disp);\nvoid XTestDiscard_wr(Display *dpy);\n\nStatus XShmGetImage_wr(Display *disp, Drawable d, XImage *image, int x, int y,\n    unsigned long mask) {\n\n\tADJUST_ROOTSHIFT\n\n\t/* Note: the Solaris overlay stuff is all non-shm (using_shm = 0) */\n\n#if HAVE_XSHM\n#if HAVE_LIBXCOMPOSITE\n\tif(use_xcomposite && subwin && !rootshift) {\n\t  XErrorHandler old_handler = XSetErrorHandler(trap_xerror);\n\t  Pixmap pixmap = XCompositeNameWindowPixmap(disp, d);\n\t  Status s = XShmGetImage(disp, pixmap, image, x, y, mask);\n\t  XFreePixmap(dpy, pixmap);\n\t  XSetErrorHandler(old_handler);\n\t  if(!trapped_xerror)\n\t    return s;\n\t}\n#endif\n\t  return XShmGetImage(disp, d, image, x, y, mask); \n#else\n\tif (!disp || !d || !image || !x || !y || !mask) {}\n\treturn (Status) 0;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "dst",
            "src",
            "w * pixelsize"
          ],
          "line": 855
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_raw_fb",
          "args": [
            "dest",
            "x",
            "y",
            "w",
            "h"
          ],
          "line": 845
        },
        "resolved": true,
        "details": {
          "function_name": "copy_raw_fb",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "724-830",
          "snippet": "void copy_raw_fb(XImage *dest, int x, int y, unsigned int w, unsigned int h) {\n\tchar *src, *dst;\n\tunsigned int line;\n\tint pixelsize = bpp/8;\n\tstatic int db = -1;\n\n#ifdef MACOSX\n\tif (macosx_console && macosx_read_opengl) {\n\t\tmacosx_copy_opengl(dest->data, x, y, w, h);\n\t\treturn;\n\t}\n#endif\n\n\tif (xform24to32) {\n\t\tcopy_raw_fb_24_to_32(dest, x, y, w, h);\n\t\treturn;\n\t}\n\tif (raw_fb_native_bpp < 8) {\n\t\tcopy_raw_fb_low_bpp(dest, x, y, w, h);\n\t\treturn;\n\t}\n\tif (db < 0) {\n\t\tif (getenv(\"DEBUG_COPY_RAW_FB\")) {\n\t\t\tdb = atoi(getenv(\"DEBUG_COPY_RAW_FB\"));\n\t\t} else {\n\t\t\tdb = 0;\n\t\t}\n\t}\n\n\tif (clipshift && ! use_snapfb) {\n\t\tx += coff_x;\n\t\ty += coff_y;\n\t}\n\n\n\tif (use_snapfb && dest != snap) {\n\t\t/* snapfb src */\n\t\tsrc = snap->data + snap->bytes_per_line*y + pixelsize*x;\n\t\tdst = dest->data;\n\nif (db) fprintf(stderr, \"snap->bytes_per_line: %d, dest->bytes_per_line: %d, w: %d h: %d dpy_x: %d wdpy_x: %d cdpy_x: %d bpp: %d pixelsize: %d\\n\", snap->bytes_per_line, dest->bytes_per_line, w, h, dpy_x, wdpy_x, cdpy_x, bpp, pixelsize);\n\n\t\tfor (line = 0; line < h; line++) {\n\t\t\tmemcpy(dst, src, w * pixelsize);\n\t\t\tsrc += snap->bytes_per_line;\n\t\t\tdst += dest->bytes_per_line;\n\t\t}\n\n\t} else if (! raw_fb_seek) {\n\t\t/* mmap */\n\t\tint bpl = raw_fb_bytes_per_line;\n\n\t\tif (clipshift && wdpy_x != cdpy_x) {\n\t\t\tbpl = wdpy_x * pixelsize;\n\t\t}\n\n\t\tsrc = raw_fb_addr + raw_fb_offset + bpl*y + pixelsize*x;\n\t\tdst = dest->data;\n\nif (db) fprintf(stderr, \"bpl: %d, dest->bytes_per_line: %d, w: %d h: %d dpy_x: %d wdpy_x: %d cdpy_x: %d bpp: %d pixelsize: %d\\n\", bpl, dest->bytes_per_line, w, h, dpy_x, wdpy_x, cdpy_x, bpp, pixelsize);\n\n\t\tfor (line = 0; line < h; line++) {\n\t\t\tmemcpy(dst, src, w * pixelsize);\n\t\t\tsrc += bpl;\n\t\t\tdst += dest->bytes_per_line;\n\t\t}\n\n\t} else {\n\t\t/* lseek */\n\t\tint n, len, del, sz = w * pixelsize;\n\t\toff_t off;\n\t\tint bpl = raw_fb_bytes_per_line;\n\n\t\tif (clipshift && wdpy_x != cdpy_x) {\n\t\t\tbpl = wdpy_x * pixelsize;\n\t\t}\n\n\t\toff = (off_t) (raw_fb_offset + bpl*y + pixelsize*x);\n\n\t\tlseek(raw_fb_fd, off, SEEK_SET);\n\t\tdst = dest->data;\n\nif (db) fprintf(stderr, \"lseek 0 ps: %d  sz: %d off: %d bpl: %d\\n\", pixelsize, sz, (int) off, bpl);\n\n\t\tfor (line = 0; line < h; line++) {\n\t\t\tlen = sz;\n\t\t\tdel = 0;\n\t\t\twhile (len > 0) {\n\t\t\t\tn = read(raw_fb_fd, dst + del, len);\n\n\t\t\t\tif (n > 0) {\n\t\t\t\t\tdel += n;\n\t\t\t\t\tlen -= n;\n\t\t\t\t} else if (n == 0) {\n\t\t\t\t\tbreak;\n\t\t\t\t} else if (errno != EINTR && errno != EAGAIN) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (bpl > sz) {\n\t\t\t\toff = (off_t) (bpl - sz);\n\t\t\t\tlseek(raw_fb_fd, off, SEEK_CUR);\n\t\t\t}\n\t\t\tdst += dest->bytes_per_line;\n\t\t}\n\t}\n}",
          "includes": [
            "#include \"nox11_funcs.h\"",
            "#include \"xwrappers.h\"",
            "#include \"xi2_devices.h\"",
            "#include \"macosx.h\"",
            "#include \"cleanup.h\"",
            "#include \"connections.h\"",
            "#include \"xevents.h\"",
            "#include \"keyboard.h\"",
            "#include \"xrecord.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int clipshift = 0;",
            "XImage *XCreateImage_wr(Display *disp, Visual *visual, unsigned int depth,\n    int format, int offset, char *data, unsigned int width,\n    unsigned int height, int bitmap_pad, int bytes_per_line);",
            "void copy_image(XImage *dest, int x, int y, unsigned int w, unsigned int h);",
            "Bool XTestCompareCurrentCursorWithWindow_wr(Display* dpy, Window w);",
            "int XFree_wr(void *data);",
            "void copy_raw_fb(XImage *dest, int x, int y, unsigned int w, unsigned int h);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint clipshift = 0;\nXImage *XCreateImage_wr(Display *disp, Visual *visual, unsigned int depth,\n    int format, int offset, char *data, unsigned int width,\n    unsigned int height, int bitmap_pad, int bytes_per_line);\nvoid copy_image(XImage *dest, int x, int y, unsigned int w, unsigned int h);\nBool XTestCompareCurrentCursorWithWindow_wr(Display* dpy, Window w);\nint XFree_wr(void *data);\nvoid copy_raw_fb(XImage *dest, int x, int y, unsigned int w, unsigned int h);\n\nvoid copy_raw_fb(XImage *dest, int x, int y, unsigned int w, unsigned int h) {\n\tchar *src, *dst;\n\tunsigned int line;\n\tint pixelsize = bpp/8;\n\tstatic int db = -1;\n\n#ifdef MACOSX\n\tif (macosx_console && macosx_read_opengl) {\n\t\tmacosx_copy_opengl(dest->data, x, y, w, h);\n\t\treturn;\n\t}\n#endif\n\n\tif (xform24to32) {\n\t\tcopy_raw_fb_24_to_32(dest, x, y, w, h);\n\t\treturn;\n\t}\n\tif (raw_fb_native_bpp < 8) {\n\t\tcopy_raw_fb_low_bpp(dest, x, y, w, h);\n\t\treturn;\n\t}\n\tif (db < 0) {\n\t\tif (getenv(\"DEBUG_COPY_RAW_FB\")) {\n\t\t\tdb = atoi(getenv(\"DEBUG_COPY_RAW_FB\"));\n\t\t} else {\n\t\t\tdb = 0;\n\t\t}\n\t}\n\n\tif (clipshift && ! use_snapfb) {\n\t\tx += coff_x;\n\t\ty += coff_y;\n\t}\n\n\n\tif (use_snapfb && dest != snap) {\n\t\t/* snapfb src */\n\t\tsrc = snap->data + snap->bytes_per_line*y + pixelsize*x;\n\t\tdst = dest->data;\n\nif (db) fprintf(stderr, \"snap->bytes_per_line: %d, dest->bytes_per_line: %d, w: %d h: %d dpy_x: %d wdpy_x: %d cdpy_x: %d bpp: %d pixelsize: %d\\n\", snap->bytes_per_line, dest->bytes_per_line, w, h, dpy_x, wdpy_x, cdpy_x, bpp, pixelsize);\n\n\t\tfor (line = 0; line < h; line++) {\n\t\t\tmemcpy(dst, src, w * pixelsize);\n\t\t\tsrc += snap->bytes_per_line;\n\t\t\tdst += dest->bytes_per_line;\n\t\t}\n\n\t} else if (! raw_fb_seek) {\n\t\t/* mmap */\n\t\tint bpl = raw_fb_bytes_per_line;\n\n\t\tif (clipshift && wdpy_x != cdpy_x) {\n\t\t\tbpl = wdpy_x * pixelsize;\n\t\t}\n\n\t\tsrc = raw_fb_addr + raw_fb_offset + bpl*y + pixelsize*x;\n\t\tdst = dest->data;\n\nif (db) fprintf(stderr, \"bpl: %d, dest->bytes_per_line: %d, w: %d h: %d dpy_x: %d wdpy_x: %d cdpy_x: %d bpp: %d pixelsize: %d\\n\", bpl, dest->bytes_per_line, w, h, dpy_x, wdpy_x, cdpy_x, bpp, pixelsize);\n\n\t\tfor (line = 0; line < h; line++) {\n\t\t\tmemcpy(dst, src, w * pixelsize);\n\t\t\tsrc += bpl;\n\t\t\tdst += dest->bytes_per_line;\n\t\t}\n\n\t} else {\n\t\t/* lseek */\n\t\tint n, len, del, sz = w * pixelsize;\n\t\toff_t off;\n\t\tint bpl = raw_fb_bytes_per_line;\n\n\t\tif (clipshift && wdpy_x != cdpy_x) {\n\t\t\tbpl = wdpy_x * pixelsize;\n\t\t}\n\n\t\toff = (off_t) (raw_fb_offset + bpl*y + pixelsize*x);\n\n\t\tlseek(raw_fb_fd, off, SEEK_SET);\n\t\tdst = dest->data;\n\nif (db) fprintf(stderr, \"lseek 0 ps: %d  sz: %d off: %d bpl: %d\\n\", pixelsize, sz, (int) off, bpl);\n\n\t\tfor (line = 0; line < h; line++) {\n\t\t\tlen = sz;\n\t\t\tdel = 0;\n\t\t\twhile (len > 0) {\n\t\t\t\tn = read(raw_fb_fd, dst + del, len);\n\n\t\t\t\tif (n > 0) {\n\t\t\t\t\tdel += n;\n\t\t\t\t\tlen -= n;\n\t\t\t\t} else if (n == 0) {\n\t\t\t\t\tbreak;\n\t\t\t\t} else if (errno != EINTR && errno != EAGAIN) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (bpl > sz) {\n\t\t\t\toff = (off_t) (bpl - sz);\n\t\t\t\tlseek(raw_fb_fd, off, SEEK_CUR);\n\t\t\t}\n\t\t\tdst += dest->bytes_per_line;\n\t\t}\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nXImage *XShmCreateImage_wr(Display* disp, Visual* vis, unsigned int depth,\n    int format, char* data, XShmSegmentInfo* shminfo, unsigned int width,\n    unsigned int height);\nXImage *XCreateImage_wr(Display *disp, Visual *visual, unsigned int depth,\n    int format, int offset, char *data, unsigned int width,\n    unsigned int height, int bitmap_pad, int bytes_per_line);\nvoid copy_image(XImage *dest, int x, int y, unsigned int w, unsigned int h);\nBool XTestCompareCurrentCursorWithWindow_wr(Display* dpy, Window w);\nvoid XTestDiscard_wr(Display *dpy);\nint XFree_wr(void *data);\nvoid copy_raw_fb(XImage *dest, int x, int y, unsigned int w, unsigned int h);\n\nvoid copy_image(XImage *dest, int x, int y, unsigned int w, unsigned int h) {\n\t/* default (w=0, h=0) is the fill the entire XImage */\n\tif (dest == NULL) {\n\t\treturn;\n\t}\n\tif (w < 1)  {\n\t\tw = dest->width;\n\t}\n\tif (h < 1)  {\n\t\th = dest->height;\n\t}\n\n\tif (raw_fb) {\n\t\tcopy_raw_fb(dest, x, y, w, h);\n\n\t} else if (use_snapfb && snap_fb && dest != snaprect) {\n\t\tchar *src, *dst;\n\t\tunsigned int line;\n\t\tint pixelsize = bpp/8;\n\n\t\tsrc = snap->data + snap->bytes_per_line*y + pixelsize*x;\n\t\tdst = dest->data;\n\t\tfor (line = 0; line < h; line++) {\n\t\t\tmemcpy(dst, src, w * pixelsize);\n\t\t\tsrc += snap->bytes_per_line;\n\t\t\tdst += dest->bytes_per_line;\n\t\t}\n\n\t} else if ((using_shm && ! xform24to32) && (int) w == dest->width &&\n\t    (int) h == dest->height) {\n\t\tXShmGetImage_wr(dpy, window, dest, x, y, AllPlanes);\n\n\t} else {\n\t\tXGetSubImage_wr(dpy, window, x, y, w, h, AllPlanes,\n\t\t    ZPixmap, dest, 0, 0);\n\t}\n}"
  },
  {
    "function_name": "copy_raw_fb",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "724-830",
    "snippet": "void copy_raw_fb(XImage *dest, int x, int y, unsigned int w, unsigned int h) {\n\tchar *src, *dst;\n\tunsigned int line;\n\tint pixelsize = bpp/8;\n\tstatic int db = -1;\n\n#ifdef MACOSX\n\tif (macosx_console && macosx_read_opengl) {\n\t\tmacosx_copy_opengl(dest->data, x, y, w, h);\n\t\treturn;\n\t}\n#endif\n\n\tif (xform24to32) {\n\t\tcopy_raw_fb_24_to_32(dest, x, y, w, h);\n\t\treturn;\n\t}\n\tif (raw_fb_native_bpp < 8) {\n\t\tcopy_raw_fb_low_bpp(dest, x, y, w, h);\n\t\treturn;\n\t}\n\tif (db < 0) {\n\t\tif (getenv(\"DEBUG_COPY_RAW_FB\")) {\n\t\t\tdb = atoi(getenv(\"DEBUG_COPY_RAW_FB\"));\n\t\t} else {\n\t\t\tdb = 0;\n\t\t}\n\t}\n\n\tif (clipshift && ! use_snapfb) {\n\t\tx += coff_x;\n\t\ty += coff_y;\n\t}\n\n\n\tif (use_snapfb && dest != snap) {\n\t\t/* snapfb src */\n\t\tsrc = snap->data + snap->bytes_per_line*y + pixelsize*x;\n\t\tdst = dest->data;\n\nif (db) fprintf(stderr, \"snap->bytes_per_line: %d, dest->bytes_per_line: %d, w: %d h: %d dpy_x: %d wdpy_x: %d cdpy_x: %d bpp: %d pixelsize: %d\\n\", snap->bytes_per_line, dest->bytes_per_line, w, h, dpy_x, wdpy_x, cdpy_x, bpp, pixelsize);\n\n\t\tfor (line = 0; line < h; line++) {\n\t\t\tmemcpy(dst, src, w * pixelsize);\n\t\t\tsrc += snap->bytes_per_line;\n\t\t\tdst += dest->bytes_per_line;\n\t\t}\n\n\t} else if (! raw_fb_seek) {\n\t\t/* mmap */\n\t\tint bpl = raw_fb_bytes_per_line;\n\n\t\tif (clipshift && wdpy_x != cdpy_x) {\n\t\t\tbpl = wdpy_x * pixelsize;\n\t\t}\n\n\t\tsrc = raw_fb_addr + raw_fb_offset + bpl*y + pixelsize*x;\n\t\tdst = dest->data;\n\nif (db) fprintf(stderr, \"bpl: %d, dest->bytes_per_line: %d, w: %d h: %d dpy_x: %d wdpy_x: %d cdpy_x: %d bpp: %d pixelsize: %d\\n\", bpl, dest->bytes_per_line, w, h, dpy_x, wdpy_x, cdpy_x, bpp, pixelsize);\n\n\t\tfor (line = 0; line < h; line++) {\n\t\t\tmemcpy(dst, src, w * pixelsize);\n\t\t\tsrc += bpl;\n\t\t\tdst += dest->bytes_per_line;\n\t\t}\n\n\t} else {\n\t\t/* lseek */\n\t\tint n, len, del, sz = w * pixelsize;\n\t\toff_t off;\n\t\tint bpl = raw_fb_bytes_per_line;\n\n\t\tif (clipshift && wdpy_x != cdpy_x) {\n\t\t\tbpl = wdpy_x * pixelsize;\n\t\t}\n\n\t\toff = (off_t) (raw_fb_offset + bpl*y + pixelsize*x);\n\n\t\tlseek(raw_fb_fd, off, SEEK_SET);\n\t\tdst = dest->data;\n\nif (db) fprintf(stderr, \"lseek 0 ps: %d  sz: %d off: %d bpl: %d\\n\", pixelsize, sz, (int) off, bpl);\n\n\t\tfor (line = 0; line < h; line++) {\n\t\t\tlen = sz;\n\t\t\tdel = 0;\n\t\t\twhile (len > 0) {\n\t\t\t\tn = read(raw_fb_fd, dst + del, len);\n\n\t\t\t\tif (n > 0) {\n\t\t\t\t\tdel += n;\n\t\t\t\t\tlen -= n;\n\t\t\t\t} else if (n == 0) {\n\t\t\t\t\tbreak;\n\t\t\t\t} else if (errno != EINTR && errno != EAGAIN) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (bpl > sz) {\n\t\t\t\toff = (off_t) (bpl - sz);\n\t\t\t\tlseek(raw_fb_fd, off, SEEK_CUR);\n\t\t\t}\n\t\t\tdst += dest->bytes_per_line;\n\t\t}\n\t}\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int clipshift = 0;",
      "XImage *XCreateImage_wr(Display *disp, Visual *visual, unsigned int depth,\n    int format, int offset, char *data, unsigned int width,\n    unsigned int height, int bitmap_pad, int bytes_per_line);",
      "void copy_image(XImage *dest, int x, int y, unsigned int w, unsigned int h);",
      "Bool XTestCompareCurrentCursorWithWindow_wr(Display* dpy, Window w);",
      "int XFree_wr(void *data);",
      "void copy_raw_fb(XImage *dest, int x, int y, unsigned int w, unsigned int h);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lseek",
          "args": [
            "raw_fb_fd",
            "off",
            "SEEK_CUR"
          ],
          "line": 825
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "bpl - sz"
          ],
          "line": 824
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "read",
          "args": [
            "raw_fb_fd",
            "dst + del",
            "len"
          ],
          "line": 812
        },
        "resolved": true,
        "details": {
          "function_name": "read_exact",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/sslhelper.c",
          "lines": "1292-1317",
          "snippet": "static int read_exact(int sock, char *buf, int len) {\n\tint n, fail = 0;\n\tif (sock < 0) {\n\t\treturn 0;\n\t}\n\twhile (len > 0) {\n\t\tn = read(sock, buf, len);\n\t\tif (n > 0) {\n\t\t\tbuf += n;\n\t\t\tlen -= n;\n\t\t} else if (n == 0) {\n\t\t\tfail = 1;\n\t\t\tbreak;\n\t\t} else if (n < 0 && (errno == EAGAIN || errno == EWOULDBLOCK)) {\n\t\t\tusleep(10*1000);\n\t\t} else if (n < 0 && errno != EINTR) {\n\t\t\tfail = 1;\n\t\t\tbreak;\n\t\t}\n\t}\n\tif (fail) {\n\t\treturn 0;\n\t} else {\n\t\treturn 1;\n\t}\n}",
          "includes": [
            "#include <openssl/rand.h>",
            "#include <openssl/err.h>",
            "#include <openssl/ssl.h>",
            "#include \"user.h\"",
            "#include \"unixpw.h\"",
            "#include \"sslcmds.h\"",
            "#include \"connections.h\"",
            "#include \"scan.h\"",
            "#include \"screen.h\"",
            "#include \"cleanup.h\"",
            "#include \"inet.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void ssl_helper_pid(pid_t pid, int sock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/rand.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n#include \"user.h\"\n#include \"unixpw.h\"\n#include \"sslcmds.h\"\n#include \"connections.h\"\n#include \"scan.h\"\n#include \"screen.h\"\n#include \"cleanup.h\"\n#include \"inet.h\"\n#include \"x11vnc.h\"\n\nvoid ssl_helper_pid(pid_t pid, int sock);\n\nstatic int read_exact(int sock, char *buf, int len) {\n\tint n, fail = 0;\n\tif (sock < 0) {\n\t\treturn 0;\n\t}\n\twhile (len > 0) {\n\t\tn = read(sock, buf, len);\n\t\tif (n > 0) {\n\t\t\tbuf += n;\n\t\t\tlen -= n;\n\t\t} else if (n == 0) {\n\t\t\tfail = 1;\n\t\t\tbreak;\n\t\t} else if (n < 0 && (errno == EAGAIN || errno == EWOULDBLOCK)) {\n\t\t\tusleep(10*1000);\n\t\t} else if (n < 0 && errno != EINTR) {\n\t\t\tfail = 1;\n\t\t\tbreak;\n\t\t}\n\t}\n\tif (fail) {\n\t\treturn 0;\n\t} else {\n\t\treturn 1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"lseek 0 ps: %d  sz: %d off: %d bpl: %d\\n\"",
            "pixelsize",
            "sz",
            "(int) off",
            "bpl"
          ],
          "line": 806
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lseek",
          "args": [
            "raw_fb_fd",
            "off",
            "SEEK_SET"
          ],
          "line": 803
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "raw_fb_offset + bpl*y + pixelsize*x"
          ],
          "line": 801
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "dst",
            "src",
            "w * pixelsize"
          ],
          "line": 786
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"bpl: %d, dest->bytes_per_line: %d, w: %d h: %d dpy_x: %d wdpy_x: %d cdpy_x: %d bpp: %d pixelsize: %d\\n\"",
            "bpl",
            "dest->bytes_per_line",
            "w",
            "h",
            "dpy_x",
            "wdpy_x",
            "cdpy_x",
            "bpp",
            "pixelsize"
          ],
          "line": 783
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "dst",
            "src",
            "w * pixelsize"
          ],
          "line": 767
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"snap->bytes_per_line: %d, dest->bytes_per_line: %d, w: %d h: %d dpy_x: %d wdpy_x: %d cdpy_x: %d bpp: %d pixelsize: %d\\n\"",
            "snap->bytes_per_line",
            "dest->bytes_per_line",
            "w",
            "h",
            "dpy_x",
            "wdpy_x",
            "cdpy_x",
            "bpp",
            "pixelsize"
          ],
          "line": 764
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atoi",
          "args": [
            "getenv(\"DEBUG_COPY_RAW_FB\")"
          ],
          "line": 747
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"DEBUG_COPY_RAW_FB\""
          ],
          "line": 747
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"DEBUG_COPY_RAW_FB\""
          ],
          "line": 746
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_raw_fb_low_bpp",
          "args": [
            "dest",
            "x",
            "y",
            "w",
            "h"
          ],
          "line": 742
        },
        "resolved": true,
        "details": {
          "function_name": "copy_raw_fb_low_bpp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "431-583",
          "snippet": "static void copy_raw_fb_low_bpp(XImage *dest, int x, int y, unsigned int w,\n    unsigned int h) {\n\tchar *src, *dst;\n\tunsigned int line;\n\tstatic char *buf = NULL;\n\tstatic int buflen = -1;\n\tint bpl = wdpy_x * raw_fb_native_bpp / 8;\n\tint n, ix, len, del, sz = wdpy_x * raw_fb_expand_bytes;\n\n\tunsigned int rm_n = raw_fb_native_red_mask;\n\tunsigned int gm_n = raw_fb_native_green_mask;\n\tunsigned int bm_n = raw_fb_native_blue_mask;\n\tunsigned int rm_f = main_red_mask;\n\tunsigned int gm_f = main_green_mask;\n\tunsigned int bm_f = main_blue_mask;\n\n\tunsigned int rs_n = raw_fb_native_red_shift;\n\tunsigned int gs_n = raw_fb_native_green_shift;\n\tunsigned int bs_n = raw_fb_native_blue_shift;\n\tunsigned int rs_f = main_red_shift;\n\tunsigned int gs_f = main_green_shift;\n\tunsigned int bs_f = main_blue_shift;\n\n\tunsigned int rx_n = raw_fb_native_red_max;\n\tunsigned int gx_n = raw_fb_native_green_max;\n\tunsigned int bx_n = raw_fb_native_blue_max;\n\tunsigned int rx_f = main_red_max;\n\tunsigned int gx_f = main_green_max;\n\tunsigned int bx_f = main_blue_max;\n\n\tstatic unsigned int msk[8];\n\tstatic int last_bpp = -1;\n\tstatic int cga = -1;\n\n\tif (rm_f | gm_f | bm_f) {}\n\n\tif (cga < 0) {\n\t\tif (getenv(\"RAWFB_CGA\")) {\n\t\t\tcga = 1;\n\t\t} else {\n\t\t\tcga = 0;\n\t\t}\n\t}\n\n\tif (sz > buflen || buf == NULL) {\n\t\tif (buf) {\n\t\t\tfree(buf);\n\t\t}\n\t\tbuflen = sz + 1000;\n\t\tbuf = (char *) malloc(buflen);\n\t}\n\n\tif (clipshift && ! use_snapfb) {\n\t\tx += coff_x;\n\t\ty += coff_y;\n\t}\n\n\tif (last_bpp != raw_fb_native_bpp) {\n\t\tint br;\n\t\tfor (br = 0; br < 8; br++) {\n\t\t\tunsigned int pbit, k, m = 0;\n\t\t\t\n\t\t\tfor (k=0; k < (unsigned int) raw_fb_native_bpp; k++) {\n\t\t\t\tpbit = 1 << (br+k);\n\t\t\t\tm |= pbit;\n\t\t\t}\n\t\t\tmsk[br] = m;\n\t\t}\n\t\tlast_bpp = raw_fb_native_bpp;\n\t}\n\n\tdst = dest->data;\nif (0) fprintf(stderr, \"x=%d y=%d w=%d h=%d bpl=%d d_bpl=%d-%dx%dx%d/%d %p\\n\",\n    x, y, w, h, bpl, dest->bytes_per_line, dest->width, dest->height, dest->bits_per_pixel, dest->depth, dst);\n\n\tfor (line = 0; line < h; line++) {\n\n\t\tif (! raw_fb_seek) {\n\t\t\t/* mmap */\n\t\t\tsrc = raw_fb_addr + raw_fb_offset + bpl*(y+line);\n\n\t\t\tmemcpy(buf, src, bpl);\n\t\t} else {\n\t\t\t/* lseek */\n\t\t\toff_t off;\n\t\t\toff = (off_t) (raw_fb_offset + bpl*(y+line));\n\n\t\t\tlseek(raw_fb_fd, off, SEEK_SET);\n\n\t\t\tlen = bpl;\n\t\t\tdel = 0;\n\t\t\twhile (len > 0) {\n\t\t\t\tn = read(raw_fb_fd, buf + del, len);\n\n\t\t\t\tif (n > 0) {\n\t\t\t\t\tdel += n;\n\t\t\t\t\tlen -= n;\n\t\t\t\t} else if (n == 0) {\n\t\t\t\t\tbreak;\n\t\t\t\t} else if (errno != EINTR && errno != EAGAIN) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (ix = 0; ix < (int) w; ix++) {\n\t\t\tint bx = (x + ix) * raw_fb_native_bpp;\n\t\t\tint ib = bx / 8;\n\t\t\tint br = bx - ib * 8;\n\t\t\tunsigned char val;\n\n\t\t\tval = *((unsigned char*) (buf + ib));\n\n\t\t\tval = msk[br] & val;\n\t\t\tval = val >> br;\n\n\t\t\tif (cga) {\n\t\t\t\t/* this is expt for CGA */\n\t\t\t\tdouble r, g, b;\n\t\t\t\tint ir, ig, ib;\n\t\t\t\tr = (2./3)*(val & 4) + (1./3)*(val & 8);\n\t\t\t\tg = (2./3)*(val & 2) + (1./3)*(val & 8);\n\t\t\t\tb = (2./3)*(val & 1) + (1./3)*(val & 8);\n\t\t\t\tif (val == 6) {\n\t\t\t\t\tg = g/2.;\n\t\t\t\t}\n\t\t\t\tir = rx_f * r;\n\t\t\t\tig = gx_f * g;\n\t\t\t\tib = bx_f * b;\n\t\t\t\tval = (ib << bs_f) | (ig << gs_f) | (ir << rs_f);\n\t\t\t} else {\n\t\t\t\tunsigned char rval, gval, bval;\n\t\t\t\t\n\t\t\t\trval = (val & rm_n) >> rs_n;\n\t\t\t\tgval = (val & gm_n) >> gs_n;\n\t\t\t\tbval = (val & bm_n) >> bs_n;\n\n\t\t\t\trval = (rx_f * rval) / rx_n;\n\t\t\t\tgval = (gx_f * gval) / gx_n;\n\t\t\t\tbval = (bx_f * bval) / bx_n;\n\n\t\t\t\trval = rval << rs_f;\n\t\t\t\tgval = gval << gs_f;\n\t\t\t\tbval = bval << bs_f;\n\n\t\t\t\tval = rval | gval | bval;\n\t\t\t}\n\n\t\t\t*(dst+ix) = (char) val;\n\t\t}\n\n\t\tdst += dest->bytes_per_line;\n\t}\n}",
          "includes": [
            "#include \"nox11_funcs.h\"",
            "#include \"xwrappers.h\"",
            "#include \"xi2_devices.h\"",
            "#include \"macosx.h\"",
            "#include \"cleanup.h\"",
            "#include \"connections.h\"",
            "#include \"xevents.h\"",
            "#include \"keyboard.h\"",
            "#include \"xrecord.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int clipshift = 0;",
            "int guess_bits_per_color(int bits_per_pixel);",
            "XImage *XShmCreateImage_wr(Display* disp, Visual* vis, unsigned int depth,\n    int format, char* data, XShmSegmentInfo* shminfo, unsigned int width,\n    unsigned int height);",
            "XImage *XCreateImage_wr(Display *disp, Visual *visual, unsigned int depth,\n    int format, int offset, char *data, unsigned int width,\n    unsigned int height, int bitmap_pad, int bytes_per_line);",
            "void copy_image(XImage *dest, int x, int y, unsigned int w, unsigned int h);",
            "Bool XTestCompareCurrentCursorWithWindow_wr(Display* dpy, Window w);",
            "int XFree_wr(void *data);",
            "void copy_raw_fb(XImage *dest, int x, int y, unsigned int w, unsigned int h);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint clipshift = 0;\nint guess_bits_per_color(int bits_per_pixel);\nXImage *XShmCreateImage_wr(Display* disp, Visual* vis, unsigned int depth,\n    int format, char* data, XShmSegmentInfo* shminfo, unsigned int width,\n    unsigned int height);\nXImage *XCreateImage_wr(Display *disp, Visual *visual, unsigned int depth,\n    int format, int offset, char *data, unsigned int width,\n    unsigned int height, int bitmap_pad, int bytes_per_line);\nvoid copy_image(XImage *dest, int x, int y, unsigned int w, unsigned int h);\nBool XTestCompareCurrentCursorWithWindow_wr(Display* dpy, Window w);\nint XFree_wr(void *data);\nvoid copy_raw_fb(XImage *dest, int x, int y, unsigned int w, unsigned int h);\n\nstatic void copy_raw_fb_low_bpp(XImage *dest, int x, int y, unsigned int w,\n    unsigned int h) {\n\tchar *src, *dst;\n\tunsigned int line;\n\tstatic char *buf = NULL;\n\tstatic int buflen = -1;\n\tint bpl = wdpy_x * raw_fb_native_bpp / 8;\n\tint n, ix, len, del, sz = wdpy_x * raw_fb_expand_bytes;\n\n\tunsigned int rm_n = raw_fb_native_red_mask;\n\tunsigned int gm_n = raw_fb_native_green_mask;\n\tunsigned int bm_n = raw_fb_native_blue_mask;\n\tunsigned int rm_f = main_red_mask;\n\tunsigned int gm_f = main_green_mask;\n\tunsigned int bm_f = main_blue_mask;\n\n\tunsigned int rs_n = raw_fb_native_red_shift;\n\tunsigned int gs_n = raw_fb_native_green_shift;\n\tunsigned int bs_n = raw_fb_native_blue_shift;\n\tunsigned int rs_f = main_red_shift;\n\tunsigned int gs_f = main_green_shift;\n\tunsigned int bs_f = main_blue_shift;\n\n\tunsigned int rx_n = raw_fb_native_red_max;\n\tunsigned int gx_n = raw_fb_native_green_max;\n\tunsigned int bx_n = raw_fb_native_blue_max;\n\tunsigned int rx_f = main_red_max;\n\tunsigned int gx_f = main_green_max;\n\tunsigned int bx_f = main_blue_max;\n\n\tstatic unsigned int msk[8];\n\tstatic int last_bpp = -1;\n\tstatic int cga = -1;\n\n\tif (rm_f | gm_f | bm_f) {}\n\n\tif (cga < 0) {\n\t\tif (getenv(\"RAWFB_CGA\")) {\n\t\t\tcga = 1;\n\t\t} else {\n\t\t\tcga = 0;\n\t\t}\n\t}\n\n\tif (sz > buflen || buf == NULL) {\n\t\tif (buf) {\n\t\t\tfree(buf);\n\t\t}\n\t\tbuflen = sz + 1000;\n\t\tbuf = (char *) malloc(buflen);\n\t}\n\n\tif (clipshift && ! use_snapfb) {\n\t\tx += coff_x;\n\t\ty += coff_y;\n\t}\n\n\tif (last_bpp != raw_fb_native_bpp) {\n\t\tint br;\n\t\tfor (br = 0; br < 8; br++) {\n\t\t\tunsigned int pbit, k, m = 0;\n\t\t\t\n\t\t\tfor (k=0; k < (unsigned int) raw_fb_native_bpp; k++) {\n\t\t\t\tpbit = 1 << (br+k);\n\t\t\t\tm |= pbit;\n\t\t\t}\n\t\t\tmsk[br] = m;\n\t\t}\n\t\tlast_bpp = raw_fb_native_bpp;\n\t}\n\n\tdst = dest->data;\nif (0) fprintf(stderr, \"x=%d y=%d w=%d h=%d bpl=%d d_bpl=%d-%dx%dx%d/%d %p\\n\",\n    x, y, w, h, bpl, dest->bytes_per_line, dest->width, dest->height, dest->bits_per_pixel, dest->depth, dst);\n\n\tfor (line = 0; line < h; line++) {\n\n\t\tif (! raw_fb_seek) {\n\t\t\t/* mmap */\n\t\t\tsrc = raw_fb_addr + raw_fb_offset + bpl*(y+line);\n\n\t\t\tmemcpy(buf, src, bpl);\n\t\t} else {\n\t\t\t/* lseek */\n\t\t\toff_t off;\n\t\t\toff = (off_t) (raw_fb_offset + bpl*(y+line));\n\n\t\t\tlseek(raw_fb_fd, off, SEEK_SET);\n\n\t\t\tlen = bpl;\n\t\t\tdel = 0;\n\t\t\twhile (len > 0) {\n\t\t\t\tn = read(raw_fb_fd, buf + del, len);\n\n\t\t\t\tif (n > 0) {\n\t\t\t\t\tdel += n;\n\t\t\t\t\tlen -= n;\n\t\t\t\t} else if (n == 0) {\n\t\t\t\t\tbreak;\n\t\t\t\t} else if (errno != EINTR && errno != EAGAIN) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (ix = 0; ix < (int) w; ix++) {\n\t\t\tint bx = (x + ix) * raw_fb_native_bpp;\n\t\t\tint ib = bx / 8;\n\t\t\tint br = bx - ib * 8;\n\t\t\tunsigned char val;\n\n\t\t\tval = *((unsigned char*) (buf + ib));\n\n\t\t\tval = msk[br] & val;\n\t\t\tval = val >> br;\n\n\t\t\tif (cga) {\n\t\t\t\t/* this is expt for CGA */\n\t\t\t\tdouble r, g, b;\n\t\t\t\tint ir, ig, ib;\n\t\t\t\tr = (2./3)*(val & 4) + (1./3)*(val & 8);\n\t\t\t\tg = (2./3)*(val & 2) + (1./3)*(val & 8);\n\t\t\t\tb = (2./3)*(val & 1) + (1./3)*(val & 8);\n\t\t\t\tif (val == 6) {\n\t\t\t\t\tg = g/2.;\n\t\t\t\t}\n\t\t\t\tir = rx_f * r;\n\t\t\t\tig = gx_f * g;\n\t\t\t\tib = bx_f * b;\n\t\t\t\tval = (ib << bs_f) | (ig << gs_f) | (ir << rs_f);\n\t\t\t} else {\n\t\t\t\tunsigned char rval, gval, bval;\n\t\t\t\t\n\t\t\t\trval = (val & rm_n) >> rs_n;\n\t\t\t\tgval = (val & gm_n) >> gs_n;\n\t\t\t\tbval = (val & bm_n) >> bs_n;\n\n\t\t\t\trval = (rx_f * rval) / rx_n;\n\t\t\t\tgval = (gx_f * gval) / gx_n;\n\t\t\t\tbval = (bx_f * bval) / bx_n;\n\n\t\t\t\trval = rval << rs_f;\n\t\t\t\tgval = gval << gs_f;\n\t\t\t\tbval = bval << bs_f;\n\n\t\t\t\tval = rval | gval | bval;\n\t\t\t}\n\n\t\t\t*(dst+ix) = (char) val;\n\t\t}\n\n\t\tdst += dest->bytes_per_line;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "copy_raw_fb_24_to_32",
          "args": [
            "dest",
            "x",
            "y",
            "w",
            "h"
          ],
          "line": 738
        },
        "resolved": true,
        "details": {
          "function_name": "copy_raw_fb_24_to_32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "585-718",
          "snippet": "static void copy_raw_fb_24_to_32(XImage *dest, int x, int y, unsigned int w,\n    unsigned int h) {\n\t/*\n\t * kludge to read 1 byte at a time and dynamically transform\n\t * 24bpp -> 32bpp by inserting a extra 0 byte into dst.\n\t */\n\tchar *src, *dst;\n\tunsigned int line;\n\tstatic char *buf = NULL;\n\tstatic int buflen = -1;\n\tint bpl = wdpy_x * 3;\t/* pixelsize == 3 */\n\tint LE, n, stp, len, del, sz = w * 3;\n\tint insert_zeroes = 1;\n\n#define INSERT_ZEROES  \\\n\tlen = sz; \\\n\tdel = 0; \\\n\tstp = 0; \\\n\twhile (len > 0) { \\\n\t\tif (insert_zeroes && (del - LE) % 4 == 0) { \\\n\t\t\t*(dst + del) = 0; \\\n\t\t\tdel++; \\\n\t\t} \\\n\t\t*(dst + del) = *(buf + stp); \\\n\t\tdel++; \\\n\t\tlen--; \\\n\t\tstp++; \\\n\t}\n\n\tif (rfbEndianTest) {\n\t\tLE = 3;\t/* little endian */\n\t} else {\n\t\tLE = 0; /* big endian */\n\t}\n\n\tif (sz > buflen || buf == NULL) {\n\t\tif (buf) {\n\t\t\tfree(buf);\n\t\t}\n\t\tbuf = (char *) malloc(4*(sz + 1000));\n\t}\n\n\tif (clipshift && ! use_snapfb) {\n\t\tx += coff_x;\n\t\ty += coff_y;\n\t}\n\n\tif (use_snapfb && dest != snap) {\n\t\t/* snapfb src */\n\t\tsrc = snap->data + snap->bytes_per_line*y + 3*x;\n\t\tdst = dest->data;\n\t\tfor (line = 0; line < h; line++) {\n\t\t\tmemcpy(buf, src, sz);\n\n\t\t\tINSERT_ZEROES\n\n\t\t\tsrc += snap->bytes_per_line;\n\t\t\tdst += dest->bytes_per_line;\n\t\t}\n\n\t} else if (! raw_fb_seek) {\n\t\t/* mmap */\n\t\tbpl = raw_fb_bytes_per_line;\n\t\tif (clipshift && wdpy_x != cdpy_x) {\n\t\t\tbpl = wdpy_x * 3;\n\t\t}\n\t\tsrc = raw_fb_addr + raw_fb_offset + bpl*y + 3*x;\n\t\tdst = dest->data;\n\n\t\tif (use_snapfb && dest == snap) {\n\t\t\t/*\n\t\t\t * writing *to* snap_fb: need the x,y offset,\n\t\t\t * and also do not do inserts.\n\t\t\t */\n\t\t\tdst += bpl*y + 3*x;\n\t\t\tinsert_zeroes = 0;\n\t\t}\n\n\t\tfor (line = 0; line < h; line++) {\n\t\t\tmemcpy(buf, src, sz);\n\n\t\t\tINSERT_ZEROES\n\n\t\t\tsrc += bpl;\n\t\t\tdst += dest->bytes_per_line;\n\t\t}\n\n\t} else {\n\t\t/* lseek */\n\t\toff_t off;\n\t\tbpl = raw_fb_bytes_per_line;\n\t\tif (clipshift && wdpy_x != cdpy_x) {\n\t\t\tbpl = wdpy_x * 3;\n\t\t}\n\t\toff = (off_t) (raw_fb_offset + bpl*y + 3*x);\n\n\t\tlseek(raw_fb_fd, off, SEEK_SET);\n\t\tdst = dest->data;\n\n\t\tif (use_snapfb && dest == snap) {\n\t\t\t/*\n\t\t\t * writing *to* snap_fb: need the x,y offset,\n\t\t\t * and also do not do inserts.\n\t\t\t */\n\t\t\tdst += bpl*y + 3*x;\n\t\t\tinsert_zeroes = 0;\n\t\t}\n\n\t\tfor (line = 0; line < h; line++) {\n\t\t\tlen = sz;\n\t\t\tdel = 0;\n\t\t\twhile (len > 0) {\n\t\t\t\tn = read(raw_fb_fd, buf + del, len);\n\n\t\t\t\tif (n > 0) {\n\t\t\t\t\tdel += n;\n\t\t\t\t\tlen -= n;\n\t\t\t\t} else if (n == 0) {\n\t\t\t\t\tbreak;\n\t\t\t\t} else if (errno != EINTR && errno != EAGAIN) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tINSERT_ZEROES\n\n\t\t\tif (bpl > sz) {\n\t\t\t\toff = (off_t) (bpl - sz);\n\t\t\t\tlseek(raw_fb_fd, off, SEEK_CUR);\n\t\t\t}\n\t\t\tdst += dest->bytes_per_line;\n\t\t}\n\t}\n}",
          "includes": [
            "#include \"nox11_funcs.h\"",
            "#include \"xwrappers.h\"",
            "#include \"xi2_devices.h\"",
            "#include \"macosx.h\"",
            "#include \"cleanup.h\"",
            "#include \"connections.h\"",
            "#include \"xevents.h\"",
            "#include \"keyboard.h\"",
            "#include \"xrecord.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [
            "#define INSERT_ZEROES  \\\n\tlen = sz; \\\n\tdel = 0; \\\n\tstp = 0; \\\n\twhile (len > 0) { \\\n\t\tif (insert_zeroes && (del - LE) % 4 == 0) { \\\n\t\t\t*(dst + del) = 0; \\\n\t\t\tdel++; \\\n\t\t} \\\n\t\t*(dst + del) = *(buf + stp); \\\n\t\tdel++; \\\n\t\tlen--; \\\n\t\tstp++; \\\n\t}"
          ],
          "globals_used": [
            "int clipshift = 0;",
            "XImage *XCreateImage_wr(Display *disp, Visual *visual, unsigned int depth,\n    int format, int offset, char *data, unsigned int width,\n    unsigned int height, int bitmap_pad, int bytes_per_line);",
            "void copy_image(XImage *dest, int x, int y, unsigned int w, unsigned int h);",
            "Bool XTestCompareCurrentCursorWithWindow_wr(Display* dpy, Window w);",
            "int XFree_wr(void *data);",
            "void copy_raw_fb(XImage *dest, int x, int y, unsigned int w, unsigned int h);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\n#define INSERT_ZEROES  \\\n\tlen = sz; \\\n\tdel = 0; \\\n\tstp = 0; \\\n\twhile (len > 0) { \\\n\t\tif (insert_zeroes && (del - LE) % 4 == 0) { \\\n\t\t\t*(dst + del) = 0; \\\n\t\t\tdel++; \\\n\t\t} \\\n\t\t*(dst + del) = *(buf + stp); \\\n\t\tdel++; \\\n\t\tlen--; \\\n\t\tstp++; \\\n\t}\n\nint clipshift = 0;\nXImage *XCreateImage_wr(Display *disp, Visual *visual, unsigned int depth,\n    int format, int offset, char *data, unsigned int width,\n    unsigned int height, int bitmap_pad, int bytes_per_line);\nvoid copy_image(XImage *dest, int x, int y, unsigned int w, unsigned int h);\nBool XTestCompareCurrentCursorWithWindow_wr(Display* dpy, Window w);\nint XFree_wr(void *data);\nvoid copy_raw_fb(XImage *dest, int x, int y, unsigned int w, unsigned int h);\n\nstatic void copy_raw_fb_24_to_32(XImage *dest, int x, int y, unsigned int w,\n    unsigned int h) {\n\t/*\n\t * kludge to read 1 byte at a time and dynamically transform\n\t * 24bpp -> 32bpp by inserting a extra 0 byte into dst.\n\t */\n\tchar *src, *dst;\n\tunsigned int line;\n\tstatic char *buf = NULL;\n\tstatic int buflen = -1;\n\tint bpl = wdpy_x * 3;\t/* pixelsize == 3 */\n\tint LE, n, stp, len, del, sz = w * 3;\n\tint insert_zeroes = 1;\n\n#define INSERT_ZEROES  \\\n\tlen = sz; \\\n\tdel = 0; \\\n\tstp = 0; \\\n\twhile (len > 0) { \\\n\t\tif (insert_zeroes && (del - LE) % 4 == 0) { \\\n\t\t\t*(dst + del) = 0; \\\n\t\t\tdel++; \\\n\t\t} \\\n\t\t*(dst + del) = *(buf + stp); \\\n\t\tdel++; \\\n\t\tlen--; \\\n\t\tstp++; \\\n\t}\n\n\tif (rfbEndianTest) {\n\t\tLE = 3;\t/* little endian */\n\t} else {\n\t\tLE = 0; /* big endian */\n\t}\n\n\tif (sz > buflen || buf == NULL) {\n\t\tif (buf) {\n\t\t\tfree(buf);\n\t\t}\n\t\tbuf = (char *) malloc(4*(sz + 1000));\n\t}\n\n\tif (clipshift && ! use_snapfb) {\n\t\tx += coff_x;\n\t\ty += coff_y;\n\t}\n\n\tif (use_snapfb && dest != snap) {\n\t\t/* snapfb src */\n\t\tsrc = snap->data + snap->bytes_per_line*y + 3*x;\n\t\tdst = dest->data;\n\t\tfor (line = 0; line < h; line++) {\n\t\t\tmemcpy(buf, src, sz);\n\n\t\t\tINSERT_ZEROES\n\n\t\t\tsrc += snap->bytes_per_line;\n\t\t\tdst += dest->bytes_per_line;\n\t\t}\n\n\t} else if (! raw_fb_seek) {\n\t\t/* mmap */\n\t\tbpl = raw_fb_bytes_per_line;\n\t\tif (clipshift && wdpy_x != cdpy_x) {\n\t\t\tbpl = wdpy_x * 3;\n\t\t}\n\t\tsrc = raw_fb_addr + raw_fb_offset + bpl*y + 3*x;\n\t\tdst = dest->data;\n\n\t\tif (use_snapfb && dest == snap) {\n\t\t\t/*\n\t\t\t * writing *to* snap_fb: need the x,y offset,\n\t\t\t * and also do not do inserts.\n\t\t\t */\n\t\t\tdst += bpl*y + 3*x;\n\t\t\tinsert_zeroes = 0;\n\t\t}\n\n\t\tfor (line = 0; line < h; line++) {\n\t\t\tmemcpy(buf, src, sz);\n\n\t\t\tINSERT_ZEROES\n\n\t\t\tsrc += bpl;\n\t\t\tdst += dest->bytes_per_line;\n\t\t}\n\n\t} else {\n\t\t/* lseek */\n\t\toff_t off;\n\t\tbpl = raw_fb_bytes_per_line;\n\t\tif (clipshift && wdpy_x != cdpy_x) {\n\t\t\tbpl = wdpy_x * 3;\n\t\t}\n\t\toff = (off_t) (raw_fb_offset + bpl*y + 3*x);\n\n\t\tlseek(raw_fb_fd, off, SEEK_SET);\n\t\tdst = dest->data;\n\n\t\tif (use_snapfb && dest == snap) {\n\t\t\t/*\n\t\t\t * writing *to* snap_fb: need the x,y offset,\n\t\t\t * and also do not do inserts.\n\t\t\t */\n\t\t\tdst += bpl*y + 3*x;\n\t\t\tinsert_zeroes = 0;\n\t\t}\n\n\t\tfor (line = 0; line < h; line++) {\n\t\t\tlen = sz;\n\t\t\tdel = 0;\n\t\t\twhile (len > 0) {\n\t\t\t\tn = read(raw_fb_fd, buf + del, len);\n\n\t\t\t\tif (n > 0) {\n\t\t\t\t\tdel += n;\n\t\t\t\t\tlen -= n;\n\t\t\t\t} else if (n == 0) {\n\t\t\t\t\tbreak;\n\t\t\t\t} else if (errno != EINTR && errno != EAGAIN) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tINSERT_ZEROES\n\n\t\t\tif (bpl > sz) {\n\t\t\t\toff = (off_t) (bpl - sz);\n\t\t\t\tlseek(raw_fb_fd, off, SEEK_CUR);\n\t\t\t}\n\t\t\tdst += dest->bytes_per_line;\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "macosx_copy_opengl",
          "args": [
            "dest->data",
            "x",
            "y",
            "w",
            "h"
          ],
          "line": 732
        },
        "resolved": true,
        "details": {
          "function_name": "macosx_copy_opengl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/macosx_opengl.c",
          "lines": "140-171",
          "snippet": "void macosx_copy_opengl(char *dest, int x, int y, unsigned int w, unsigned int h) {\n\tint yflip = macosx_opengl_height - y - h; \n\n\tCGLSetCurrentContext(glContextObj);\n\n\tglReadPixels((GLint) x, (GLint) yflip, (int) w, (int) h,\n\t    GL_BGRA, GL_UNSIGNED_INT_8_8_8_8_REV, dest);\n\n\tif (h > 1) {\n\t\tstatic char *pbuf = NULL;\n\t\tstatic int buflen = 0;\n\t\tint top = 0, bot = h - 1, rowlen = w * macosx_opengl_bpp/8;\n\t\tchar *ptop, *pbot;\n\n\t\tif (rowlen > buflen || buflen == 0)  {\n\t\t\tbuflen = rowlen + 128;\n\t\t\tif (pbuf) {\n\t\t\t\tfree(pbuf);\n\t\t\t}\n\t\t\tpbuf = (char *) malloc(buflen);\n\t\t}\n\t\twhile (top < bot) {\n\t\t\tptop = dest + top * rowlen;\n\t\t\tpbot = dest + bot * rowlen;\n\t\t\tmemcpy(pbuf, ptop, rowlen);\n\t\t\tmemcpy(ptop, pbot, rowlen);\n\t\t\tmemcpy(pbot, pbuf, rowlen);\n\t\t\ttop++;\n\t\t\tbot--;\n\t\t}\n\t}\n}",
          "includes": [
            "#include <OpenGL/gl.h>",
            "#include <OpenGL/OpenGL.h>",
            "#include <rfb/rfb.h>",
            "#include \"config.h\"",
            "#include <ApplicationServices/ApplicationServices.h>",
            "#include <CoreFoundation/CoreFoundation.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <OpenGL/gl.h>\n#include <OpenGL/OpenGL.h>\n#include <rfb/rfb.h>\n#include \"config.h\"\n#include <ApplicationServices/ApplicationServices.h>\n#include <CoreFoundation/CoreFoundation.h>\n\nvoid macosx_copy_opengl(char *dest, int x, int y, unsigned int w, unsigned int h) {\n\tint yflip = macosx_opengl_height - y - h; \n\n\tCGLSetCurrentContext(glContextObj);\n\n\tglReadPixels((GLint) x, (GLint) yflip, (int) w, (int) h,\n\t    GL_BGRA, GL_UNSIGNED_INT_8_8_8_8_REV, dest);\n\n\tif (h > 1) {\n\t\tstatic char *pbuf = NULL;\n\t\tstatic int buflen = 0;\n\t\tint top = 0, bot = h - 1, rowlen = w * macosx_opengl_bpp/8;\n\t\tchar *ptop, *pbot;\n\n\t\tif (rowlen > buflen || buflen == 0)  {\n\t\t\tbuflen = rowlen + 128;\n\t\t\tif (pbuf) {\n\t\t\t\tfree(pbuf);\n\t\t\t}\n\t\t\tpbuf = (char *) malloc(buflen);\n\t\t}\n\t\twhile (top < bot) {\n\t\t\tptop = dest + top * rowlen;\n\t\t\tpbot = dest + bot * rowlen;\n\t\t\tmemcpy(pbuf, ptop, rowlen);\n\t\t\tmemcpy(ptop, pbot, rowlen);\n\t\t\tmemcpy(pbot, pbuf, rowlen);\n\t\t\ttop++;\n\t\t\tbot--;\n\t\t}\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint clipshift = 0;\nXImage *XCreateImage_wr(Display *disp, Visual *visual, unsigned int depth,\n    int format, int offset, char *data, unsigned int width,\n    unsigned int height, int bitmap_pad, int bytes_per_line);\nvoid copy_image(XImage *dest, int x, int y, unsigned int w, unsigned int h);\nBool XTestCompareCurrentCursorWithWindow_wr(Display* dpy, Window w);\nint XFree_wr(void *data);\nvoid copy_raw_fb(XImage *dest, int x, int y, unsigned int w, unsigned int h);\n\nvoid copy_raw_fb(XImage *dest, int x, int y, unsigned int w, unsigned int h) {\n\tchar *src, *dst;\n\tunsigned int line;\n\tint pixelsize = bpp/8;\n\tstatic int db = -1;\n\n#ifdef MACOSX\n\tif (macosx_console && macosx_read_opengl) {\n\t\tmacosx_copy_opengl(dest->data, x, y, w, h);\n\t\treturn;\n\t}\n#endif\n\n\tif (xform24to32) {\n\t\tcopy_raw_fb_24_to_32(dest, x, y, w, h);\n\t\treturn;\n\t}\n\tif (raw_fb_native_bpp < 8) {\n\t\tcopy_raw_fb_low_bpp(dest, x, y, w, h);\n\t\treturn;\n\t}\n\tif (db < 0) {\n\t\tif (getenv(\"DEBUG_COPY_RAW_FB\")) {\n\t\t\tdb = atoi(getenv(\"DEBUG_COPY_RAW_FB\"));\n\t\t} else {\n\t\t\tdb = 0;\n\t\t}\n\t}\n\n\tif (clipshift && ! use_snapfb) {\n\t\tx += coff_x;\n\t\ty += coff_y;\n\t}\n\n\n\tif (use_snapfb && dest != snap) {\n\t\t/* snapfb src */\n\t\tsrc = snap->data + snap->bytes_per_line*y + pixelsize*x;\n\t\tdst = dest->data;\n\nif (db) fprintf(stderr, \"snap->bytes_per_line: %d, dest->bytes_per_line: %d, w: %d h: %d dpy_x: %d wdpy_x: %d cdpy_x: %d bpp: %d pixelsize: %d\\n\", snap->bytes_per_line, dest->bytes_per_line, w, h, dpy_x, wdpy_x, cdpy_x, bpp, pixelsize);\n\n\t\tfor (line = 0; line < h; line++) {\n\t\t\tmemcpy(dst, src, w * pixelsize);\n\t\t\tsrc += snap->bytes_per_line;\n\t\t\tdst += dest->bytes_per_line;\n\t\t}\n\n\t} else if (! raw_fb_seek) {\n\t\t/* mmap */\n\t\tint bpl = raw_fb_bytes_per_line;\n\n\t\tif (clipshift && wdpy_x != cdpy_x) {\n\t\t\tbpl = wdpy_x * pixelsize;\n\t\t}\n\n\t\tsrc = raw_fb_addr + raw_fb_offset + bpl*y + pixelsize*x;\n\t\tdst = dest->data;\n\nif (db) fprintf(stderr, \"bpl: %d, dest->bytes_per_line: %d, w: %d h: %d dpy_x: %d wdpy_x: %d cdpy_x: %d bpp: %d pixelsize: %d\\n\", bpl, dest->bytes_per_line, w, h, dpy_x, wdpy_x, cdpy_x, bpp, pixelsize);\n\n\t\tfor (line = 0; line < h; line++) {\n\t\t\tmemcpy(dst, src, w * pixelsize);\n\t\t\tsrc += bpl;\n\t\t\tdst += dest->bytes_per_line;\n\t\t}\n\n\t} else {\n\t\t/* lseek */\n\t\tint n, len, del, sz = w * pixelsize;\n\t\toff_t off;\n\t\tint bpl = raw_fb_bytes_per_line;\n\n\t\tif (clipshift && wdpy_x != cdpy_x) {\n\t\t\tbpl = wdpy_x * pixelsize;\n\t\t}\n\n\t\toff = (off_t) (raw_fb_offset + bpl*y + pixelsize*x);\n\n\t\tlseek(raw_fb_fd, off, SEEK_SET);\n\t\tdst = dest->data;\n\nif (db) fprintf(stderr, \"lseek 0 ps: %d  sz: %d off: %d bpl: %d\\n\", pixelsize, sz, (int) off, bpl);\n\n\t\tfor (line = 0; line < h; line++) {\n\t\t\tlen = sz;\n\t\t\tdel = 0;\n\t\t\twhile (len > 0) {\n\t\t\t\tn = read(raw_fb_fd, dst + del, len);\n\n\t\t\t\tif (n > 0) {\n\t\t\t\t\tdel += n;\n\t\t\t\t\tlen -= n;\n\t\t\t\t} else if (n == 0) {\n\t\t\t\t\tbreak;\n\t\t\t\t} else if (errno != EINTR && errno != EAGAIN) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (bpl > sz) {\n\t\t\t\toff = (off_t) (bpl - sz);\n\t\t\t\tlseek(raw_fb_fd, off, SEEK_CUR);\n\t\t\t}\n\t\t\tdst += dest->bytes_per_line;\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "copy_raw_fb_24_to_32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "585-718",
    "snippet": "static void copy_raw_fb_24_to_32(XImage *dest, int x, int y, unsigned int w,\n    unsigned int h) {\n\t/*\n\t * kludge to read 1 byte at a time and dynamically transform\n\t * 24bpp -> 32bpp by inserting a extra 0 byte into dst.\n\t */\n\tchar *src, *dst;\n\tunsigned int line;\n\tstatic char *buf = NULL;\n\tstatic int buflen = -1;\n\tint bpl = wdpy_x * 3;\t/* pixelsize == 3 */\n\tint LE, n, stp, len, del, sz = w * 3;\n\tint insert_zeroes = 1;\n\n#define INSERT_ZEROES  \\\n\tlen = sz; \\\n\tdel = 0; \\\n\tstp = 0; \\\n\twhile (len > 0) { \\\n\t\tif (insert_zeroes && (del - LE) % 4 == 0) { \\\n\t\t\t*(dst + del) = 0; \\\n\t\t\tdel++; \\\n\t\t} \\\n\t\t*(dst + del) = *(buf + stp); \\\n\t\tdel++; \\\n\t\tlen--; \\\n\t\tstp++; \\\n\t}\n\n\tif (rfbEndianTest) {\n\t\tLE = 3;\t/* little endian */\n\t} else {\n\t\tLE = 0; /* big endian */\n\t}\n\n\tif (sz > buflen || buf == NULL) {\n\t\tif (buf) {\n\t\t\tfree(buf);\n\t\t}\n\t\tbuf = (char *) malloc(4*(sz + 1000));\n\t}\n\n\tif (clipshift && ! use_snapfb) {\n\t\tx += coff_x;\n\t\ty += coff_y;\n\t}\n\n\tif (use_snapfb && dest != snap) {\n\t\t/* snapfb src */\n\t\tsrc = snap->data + snap->bytes_per_line*y + 3*x;\n\t\tdst = dest->data;\n\t\tfor (line = 0; line < h; line++) {\n\t\t\tmemcpy(buf, src, sz);\n\n\t\t\tINSERT_ZEROES\n\n\t\t\tsrc += snap->bytes_per_line;\n\t\t\tdst += dest->bytes_per_line;\n\t\t}\n\n\t} else if (! raw_fb_seek) {\n\t\t/* mmap */\n\t\tbpl = raw_fb_bytes_per_line;\n\t\tif (clipshift && wdpy_x != cdpy_x) {\n\t\t\tbpl = wdpy_x * 3;\n\t\t}\n\t\tsrc = raw_fb_addr + raw_fb_offset + bpl*y + 3*x;\n\t\tdst = dest->data;\n\n\t\tif (use_snapfb && dest == snap) {\n\t\t\t/*\n\t\t\t * writing *to* snap_fb: need the x,y offset,\n\t\t\t * and also do not do inserts.\n\t\t\t */\n\t\t\tdst += bpl*y + 3*x;\n\t\t\tinsert_zeroes = 0;\n\t\t}\n\n\t\tfor (line = 0; line < h; line++) {\n\t\t\tmemcpy(buf, src, sz);\n\n\t\t\tINSERT_ZEROES\n\n\t\t\tsrc += bpl;\n\t\t\tdst += dest->bytes_per_line;\n\t\t}\n\n\t} else {\n\t\t/* lseek */\n\t\toff_t off;\n\t\tbpl = raw_fb_bytes_per_line;\n\t\tif (clipshift && wdpy_x != cdpy_x) {\n\t\t\tbpl = wdpy_x * 3;\n\t\t}\n\t\toff = (off_t) (raw_fb_offset + bpl*y + 3*x);\n\n\t\tlseek(raw_fb_fd, off, SEEK_SET);\n\t\tdst = dest->data;\n\n\t\tif (use_snapfb && dest == snap) {\n\t\t\t/*\n\t\t\t * writing *to* snap_fb: need the x,y offset,\n\t\t\t * and also do not do inserts.\n\t\t\t */\n\t\t\tdst += bpl*y + 3*x;\n\t\t\tinsert_zeroes = 0;\n\t\t}\n\n\t\tfor (line = 0; line < h; line++) {\n\t\t\tlen = sz;\n\t\t\tdel = 0;\n\t\t\twhile (len > 0) {\n\t\t\t\tn = read(raw_fb_fd, buf + del, len);\n\n\t\t\t\tif (n > 0) {\n\t\t\t\t\tdel += n;\n\t\t\t\t\tlen -= n;\n\t\t\t\t} else if (n == 0) {\n\t\t\t\t\tbreak;\n\t\t\t\t} else if (errno != EINTR && errno != EAGAIN) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tINSERT_ZEROES\n\n\t\t\tif (bpl > sz) {\n\t\t\t\toff = (off_t) (bpl - sz);\n\t\t\t\tlseek(raw_fb_fd, off, SEEK_CUR);\n\t\t\t}\n\t\t\tdst += dest->bytes_per_line;\n\t\t}\n\t}\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [
      "#define INSERT_ZEROES  \\\n\tlen = sz; \\\n\tdel = 0; \\\n\tstp = 0; \\\n\twhile (len > 0) { \\\n\t\tif (insert_zeroes && (del - LE) % 4 == 0) { \\\n\t\t\t*(dst + del) = 0; \\\n\t\t\tdel++; \\\n\t\t} \\\n\t\t*(dst + del) = *(buf + stp); \\\n\t\tdel++; \\\n\t\tlen--; \\\n\t\tstp++; \\\n\t}"
    ],
    "globals_used": [
      "int clipshift = 0;",
      "XImage *XCreateImage_wr(Display *disp, Visual *visual, unsigned int depth,\n    int format, int offset, char *data, unsigned int width,\n    unsigned int height, int bitmap_pad, int bytes_per_line);",
      "void copy_image(XImage *dest, int x, int y, unsigned int w, unsigned int h);",
      "Bool XTestCompareCurrentCursorWithWindow_wr(Display* dpy, Window w);",
      "int XFree_wr(void *data);",
      "void copy_raw_fb(XImage *dest, int x, int y, unsigned int w, unsigned int h);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "lseek",
          "args": [
            "raw_fb_fd",
            "off",
            "SEEK_CUR"
          ],
          "line": 713
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "bpl - sz"
          ],
          "line": 712
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "read",
          "args": [
            "raw_fb_fd",
            "buf + del",
            "len"
          ],
          "line": 697
        },
        "resolved": true,
        "details": {
          "function_name": "read_exact",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/sslhelper.c",
          "lines": "1292-1317",
          "snippet": "static int read_exact(int sock, char *buf, int len) {\n\tint n, fail = 0;\n\tif (sock < 0) {\n\t\treturn 0;\n\t}\n\twhile (len > 0) {\n\t\tn = read(sock, buf, len);\n\t\tif (n > 0) {\n\t\t\tbuf += n;\n\t\t\tlen -= n;\n\t\t} else if (n == 0) {\n\t\t\tfail = 1;\n\t\t\tbreak;\n\t\t} else if (n < 0 && (errno == EAGAIN || errno == EWOULDBLOCK)) {\n\t\t\tusleep(10*1000);\n\t\t} else if (n < 0 && errno != EINTR) {\n\t\t\tfail = 1;\n\t\t\tbreak;\n\t\t}\n\t}\n\tif (fail) {\n\t\treturn 0;\n\t} else {\n\t\treturn 1;\n\t}\n}",
          "includes": [
            "#include <openssl/rand.h>",
            "#include <openssl/err.h>",
            "#include <openssl/ssl.h>",
            "#include \"user.h\"",
            "#include \"unixpw.h\"",
            "#include \"sslcmds.h\"",
            "#include \"connections.h\"",
            "#include \"scan.h\"",
            "#include \"screen.h\"",
            "#include \"cleanup.h\"",
            "#include \"inet.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void ssl_helper_pid(pid_t pid, int sock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/rand.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n#include \"user.h\"\n#include \"unixpw.h\"\n#include \"sslcmds.h\"\n#include \"connections.h\"\n#include \"scan.h\"\n#include \"screen.h\"\n#include \"cleanup.h\"\n#include \"inet.h\"\n#include \"x11vnc.h\"\n\nvoid ssl_helper_pid(pid_t pid, int sock);\n\nstatic int read_exact(int sock, char *buf, int len) {\n\tint n, fail = 0;\n\tif (sock < 0) {\n\t\treturn 0;\n\t}\n\twhile (len > 0) {\n\t\tn = read(sock, buf, len);\n\t\tif (n > 0) {\n\t\t\tbuf += n;\n\t\t\tlen -= n;\n\t\t} else if (n == 0) {\n\t\t\tfail = 1;\n\t\t\tbreak;\n\t\t} else if (n < 0 && (errno == EAGAIN || errno == EWOULDBLOCK)) {\n\t\t\tusleep(10*1000);\n\t\t} else if (n < 0 && errno != EINTR) {\n\t\t\tfail = 1;\n\t\t\tbreak;\n\t\t}\n\t}\n\tif (fail) {\n\t\treturn 0;\n\t} else {\n\t\treturn 1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "lseek",
          "args": [
            "raw_fb_fd",
            "off",
            "SEEK_SET"
          ],
          "line": 681
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "raw_fb_offset + bpl*y + 3*x"
          ],
          "line": 679
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "buf",
            "src",
            "sz"
          ],
          "line": 664
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "buf",
            "src",
            "sz"
          ],
          "line": 637
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "4*(sz + 1000)"
          ],
          "line": 624
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "buf"
          ],
          "line": 622
        },
        "resolved": true,
        "details": {
          "function_name": "free_rect",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/userinput.c",
          "lines": "6200-6247",
          "snippet": "int free_rect(int idx) {\n\tint n, ok = 0;\n\tsraRegionPtr r1, r2;\n\tint x, y, w, h;\n\n\tif (idx < 0 || idx >= cache_list_num) {\nif (0) fprintf(stderr, \"free_rect: bad index: %d\\n\", idx);\n\t\tclean_up_exit(1);\n\t}\n\n\tx = cache_list[idx].bs_x;\n\ty = cache_list[idx].bs_y;\n\tw = cache_list[idx].bs_w;\n\th = cache_list[idx].bs_h;\n\n\tif (x < 0) {\n\t\tCLEAR(idx);\nif (dnow() > last_client + 5 && ncdb) fprintf(stderr, \"free_rect: already bs_x invalidated: %d bs_x: %d\\n\", idx, x);\n\t\treturn 1;\n\t}\n\n\tr2 = sraRgnCreateRect(x, y, x+w, y+h);\n\n\tn = get_bs_n(y);\n\tif (n >= 0) {\n\t\tr1 = rect_reg[n];\n\t\tsraRgnOr(r1, r2);\n\t\tok = 1;\n\t}\n\n\tif (zero_rects) {\n\t\tsraRgnOr(zero_rects, r2);\n\t\tx = cache_list[idx].su_x;\n\t\ty = cache_list[idx].su_y;\n\t\tw = cache_list[idx].su_w;\n\t\th = cache_list[idx].su_h;\n\t\tif (x >= 0) {\n\t\t\tsraRgnDestroy(r2);\n\t\t\tr2 = sraRgnCreateRect(x, y, x+w, y+h);\n\t\t\tsraRgnOr(zero_rects, r2);\n\t\t}\n\t}\n\tsraRgnDestroy(r2);\n\n\tCLEAR(idx);\nif (! ok && ncdb) fprintf(stderr, \"**** free_rect: not-found %d\\n\", idx);\n\treturn ok;\n}",
          "includes": [
            "#include \"default8x16.h\"",
            "#include \"connections.h\"",
            "#include \"screen.h\"",
            "#include \"cursor.h\"",
            "#include \"macosxCGS.h\"",
            "#include \"macosx.h\"",
            "#include \"unixpw.h\"",
            "#include \"8to24.h\"",
            "#include \"xrandr.h\"",
            "#include \"solid.h\"",
            "#include \"keyboard.h\"",
            "#include \"rates.h\"",
            "#include \"pointer.h\"",
            "#include \"cleanup.h\"",
            "#include \"scan.h\"",
            "#include \"user.h\"",
            "#include \"xevents.h\"",
            "#include \"win_utils.h\"",
            "#include \"xinerama.h\"",
            "#include \"xrecord.h\"",
            "#include \"xdamage.h\"",
            "#include \"xwrappers.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void mark_for_xdamage(int x, int y, int w, int h);",
            "void set_xdamage_mark(int x, int y, int w, int h);",
            "int find_rect(int idx, int x, int y, int w, int h);",
            "winattr_t *cache_list;",
            "int clipped(int idx);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"default8x16.h\"\n#include \"connections.h\"\n#include \"screen.h\"\n#include \"cursor.h\"\n#include \"macosxCGS.h\"\n#include \"macosx.h\"\n#include \"unixpw.h\"\n#include \"8to24.h\"\n#include \"xrandr.h\"\n#include \"solid.h\"\n#include \"keyboard.h\"\n#include \"rates.h\"\n#include \"pointer.h\"\n#include \"cleanup.h\"\n#include \"scan.h\"\n#include \"user.h\"\n#include \"xevents.h\"\n#include \"win_utils.h\"\n#include \"xinerama.h\"\n#include \"xrecord.h\"\n#include \"xdamage.h\"\n#include \"xwrappers.h\"\n#include \"x11vnc.h\"\n\nvoid mark_for_xdamage(int x, int y, int w, int h);\nvoid set_xdamage_mark(int x, int y, int w, int h);\nint find_rect(int idx, int x, int y, int w, int h);\nwinattr_t *cache_list;\nint clipped(int idx);\n\nint free_rect(int idx) {\n\tint n, ok = 0;\n\tsraRegionPtr r1, r2;\n\tint x, y, w, h;\n\n\tif (idx < 0 || idx >= cache_list_num) {\nif (0) fprintf(stderr, \"free_rect: bad index: %d\\n\", idx);\n\t\tclean_up_exit(1);\n\t}\n\n\tx = cache_list[idx].bs_x;\n\ty = cache_list[idx].bs_y;\n\tw = cache_list[idx].bs_w;\n\th = cache_list[idx].bs_h;\n\n\tif (x < 0) {\n\t\tCLEAR(idx);\nif (dnow() > last_client + 5 && ncdb) fprintf(stderr, \"free_rect: already bs_x invalidated: %d bs_x: %d\\n\", idx, x);\n\t\treturn 1;\n\t}\n\n\tr2 = sraRgnCreateRect(x, y, x+w, y+h);\n\n\tn = get_bs_n(y);\n\tif (n >= 0) {\n\t\tr1 = rect_reg[n];\n\t\tsraRgnOr(r1, r2);\n\t\tok = 1;\n\t}\n\n\tif (zero_rects) {\n\t\tsraRgnOr(zero_rects, r2);\n\t\tx = cache_list[idx].su_x;\n\t\ty = cache_list[idx].su_y;\n\t\tw = cache_list[idx].su_w;\n\t\th = cache_list[idx].su_h;\n\t\tif (x >= 0) {\n\t\t\tsraRgnDestroy(r2);\n\t\t\tr2 = sraRgnCreateRect(x, y, x+w, y+h);\n\t\t\tsraRgnOr(zero_rects, r2);\n\t\t}\n\t}\n\tsraRgnDestroy(r2);\n\n\tCLEAR(idx);\nif (! ok && ncdb) fprintf(stderr, \"**** free_rect: not-found %d\\n\", idx);\n\treturn ok;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\n#define INSERT_ZEROES  \\\n\tlen = sz; \\\n\tdel = 0; \\\n\tstp = 0; \\\n\twhile (len > 0) { \\\n\t\tif (insert_zeroes && (del - LE) % 4 == 0) { \\\n\t\t\t*(dst + del) = 0; \\\n\t\t\tdel++; \\\n\t\t} \\\n\t\t*(dst + del) = *(buf + stp); \\\n\t\tdel++; \\\n\t\tlen--; \\\n\t\tstp++; \\\n\t}\n\nint clipshift = 0;\nXImage *XCreateImage_wr(Display *disp, Visual *visual, unsigned int depth,\n    int format, int offset, char *data, unsigned int width,\n    unsigned int height, int bitmap_pad, int bytes_per_line);\nvoid copy_image(XImage *dest, int x, int y, unsigned int w, unsigned int h);\nBool XTestCompareCurrentCursorWithWindow_wr(Display* dpy, Window w);\nint XFree_wr(void *data);\nvoid copy_raw_fb(XImage *dest, int x, int y, unsigned int w, unsigned int h);\n\nstatic void copy_raw_fb_24_to_32(XImage *dest, int x, int y, unsigned int w,\n    unsigned int h) {\n\t/*\n\t * kludge to read 1 byte at a time and dynamically transform\n\t * 24bpp -> 32bpp by inserting a extra 0 byte into dst.\n\t */\n\tchar *src, *dst;\n\tunsigned int line;\n\tstatic char *buf = NULL;\n\tstatic int buflen = -1;\n\tint bpl = wdpy_x * 3;\t/* pixelsize == 3 */\n\tint LE, n, stp, len, del, sz = w * 3;\n\tint insert_zeroes = 1;\n\n#define INSERT_ZEROES  \\\n\tlen = sz; \\\n\tdel = 0; \\\n\tstp = 0; \\\n\twhile (len > 0) { \\\n\t\tif (insert_zeroes && (del - LE) % 4 == 0) { \\\n\t\t\t*(dst + del) = 0; \\\n\t\t\tdel++; \\\n\t\t} \\\n\t\t*(dst + del) = *(buf + stp); \\\n\t\tdel++; \\\n\t\tlen--; \\\n\t\tstp++; \\\n\t}\n\n\tif (rfbEndianTest) {\n\t\tLE = 3;\t/* little endian */\n\t} else {\n\t\tLE = 0; /* big endian */\n\t}\n\n\tif (sz > buflen || buf == NULL) {\n\t\tif (buf) {\n\t\t\tfree(buf);\n\t\t}\n\t\tbuf = (char *) malloc(4*(sz + 1000));\n\t}\n\n\tif (clipshift && ! use_snapfb) {\n\t\tx += coff_x;\n\t\ty += coff_y;\n\t}\n\n\tif (use_snapfb && dest != snap) {\n\t\t/* snapfb src */\n\t\tsrc = snap->data + snap->bytes_per_line*y + 3*x;\n\t\tdst = dest->data;\n\t\tfor (line = 0; line < h; line++) {\n\t\t\tmemcpy(buf, src, sz);\n\n\t\t\tINSERT_ZEROES\n\n\t\t\tsrc += snap->bytes_per_line;\n\t\t\tdst += dest->bytes_per_line;\n\t\t}\n\n\t} else if (! raw_fb_seek) {\n\t\t/* mmap */\n\t\tbpl = raw_fb_bytes_per_line;\n\t\tif (clipshift && wdpy_x != cdpy_x) {\n\t\t\tbpl = wdpy_x * 3;\n\t\t}\n\t\tsrc = raw_fb_addr + raw_fb_offset + bpl*y + 3*x;\n\t\tdst = dest->data;\n\n\t\tif (use_snapfb && dest == snap) {\n\t\t\t/*\n\t\t\t * writing *to* snap_fb: need the x,y offset,\n\t\t\t * and also do not do inserts.\n\t\t\t */\n\t\t\tdst += bpl*y + 3*x;\n\t\t\tinsert_zeroes = 0;\n\t\t}\n\n\t\tfor (line = 0; line < h; line++) {\n\t\t\tmemcpy(buf, src, sz);\n\n\t\t\tINSERT_ZEROES\n\n\t\t\tsrc += bpl;\n\t\t\tdst += dest->bytes_per_line;\n\t\t}\n\n\t} else {\n\t\t/* lseek */\n\t\toff_t off;\n\t\tbpl = raw_fb_bytes_per_line;\n\t\tif (clipshift && wdpy_x != cdpy_x) {\n\t\t\tbpl = wdpy_x * 3;\n\t\t}\n\t\toff = (off_t) (raw_fb_offset + bpl*y + 3*x);\n\n\t\tlseek(raw_fb_fd, off, SEEK_SET);\n\t\tdst = dest->data;\n\n\t\tif (use_snapfb && dest == snap) {\n\t\t\t/*\n\t\t\t * writing *to* snap_fb: need the x,y offset,\n\t\t\t * and also do not do inserts.\n\t\t\t */\n\t\t\tdst += bpl*y + 3*x;\n\t\t\tinsert_zeroes = 0;\n\t\t}\n\n\t\tfor (line = 0; line < h; line++) {\n\t\t\tlen = sz;\n\t\t\tdel = 0;\n\t\t\twhile (len > 0) {\n\t\t\t\tn = read(raw_fb_fd, buf + del, len);\n\n\t\t\t\tif (n > 0) {\n\t\t\t\t\tdel += n;\n\t\t\t\t\tlen -= n;\n\t\t\t\t} else if (n == 0) {\n\t\t\t\t\tbreak;\n\t\t\t\t} else if (errno != EINTR && errno != EAGAIN) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tINSERT_ZEROES\n\n\t\t\tif (bpl > sz) {\n\t\t\t\toff = (off_t) (bpl - sz);\n\t\t\t\tlseek(raw_fb_fd, off, SEEK_CUR);\n\t\t\t}\n\t\t\tdst += dest->bytes_per_line;\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "copy_raw_fb_low_bpp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "431-583",
    "snippet": "static void copy_raw_fb_low_bpp(XImage *dest, int x, int y, unsigned int w,\n    unsigned int h) {\n\tchar *src, *dst;\n\tunsigned int line;\n\tstatic char *buf = NULL;\n\tstatic int buflen = -1;\n\tint bpl = wdpy_x * raw_fb_native_bpp / 8;\n\tint n, ix, len, del, sz = wdpy_x * raw_fb_expand_bytes;\n\n\tunsigned int rm_n = raw_fb_native_red_mask;\n\tunsigned int gm_n = raw_fb_native_green_mask;\n\tunsigned int bm_n = raw_fb_native_blue_mask;\n\tunsigned int rm_f = main_red_mask;\n\tunsigned int gm_f = main_green_mask;\n\tunsigned int bm_f = main_blue_mask;\n\n\tunsigned int rs_n = raw_fb_native_red_shift;\n\tunsigned int gs_n = raw_fb_native_green_shift;\n\tunsigned int bs_n = raw_fb_native_blue_shift;\n\tunsigned int rs_f = main_red_shift;\n\tunsigned int gs_f = main_green_shift;\n\tunsigned int bs_f = main_blue_shift;\n\n\tunsigned int rx_n = raw_fb_native_red_max;\n\tunsigned int gx_n = raw_fb_native_green_max;\n\tunsigned int bx_n = raw_fb_native_blue_max;\n\tunsigned int rx_f = main_red_max;\n\tunsigned int gx_f = main_green_max;\n\tunsigned int bx_f = main_blue_max;\n\n\tstatic unsigned int msk[8];\n\tstatic int last_bpp = -1;\n\tstatic int cga = -1;\n\n\tif (rm_f | gm_f | bm_f) {}\n\n\tif (cga < 0) {\n\t\tif (getenv(\"RAWFB_CGA\")) {\n\t\t\tcga = 1;\n\t\t} else {\n\t\t\tcga = 0;\n\t\t}\n\t}\n\n\tif (sz > buflen || buf == NULL) {\n\t\tif (buf) {\n\t\t\tfree(buf);\n\t\t}\n\t\tbuflen = sz + 1000;\n\t\tbuf = (char *) malloc(buflen);\n\t}\n\n\tif (clipshift && ! use_snapfb) {\n\t\tx += coff_x;\n\t\ty += coff_y;\n\t}\n\n\tif (last_bpp != raw_fb_native_bpp) {\n\t\tint br;\n\t\tfor (br = 0; br < 8; br++) {\n\t\t\tunsigned int pbit, k, m = 0;\n\t\t\t\n\t\t\tfor (k=0; k < (unsigned int) raw_fb_native_bpp; k++) {\n\t\t\t\tpbit = 1 << (br+k);\n\t\t\t\tm |= pbit;\n\t\t\t}\n\t\t\tmsk[br] = m;\n\t\t}\n\t\tlast_bpp = raw_fb_native_bpp;\n\t}\n\n\tdst = dest->data;\nif (0) fprintf(stderr, \"x=%d y=%d w=%d h=%d bpl=%d d_bpl=%d-%dx%dx%d/%d %p\\n\",\n    x, y, w, h, bpl, dest->bytes_per_line, dest->width, dest->height, dest->bits_per_pixel, dest->depth, dst);\n\n\tfor (line = 0; line < h; line++) {\n\n\t\tif (! raw_fb_seek) {\n\t\t\t/* mmap */\n\t\t\tsrc = raw_fb_addr + raw_fb_offset + bpl*(y+line);\n\n\t\t\tmemcpy(buf, src, bpl);\n\t\t} else {\n\t\t\t/* lseek */\n\t\t\toff_t off;\n\t\t\toff = (off_t) (raw_fb_offset + bpl*(y+line));\n\n\t\t\tlseek(raw_fb_fd, off, SEEK_SET);\n\n\t\t\tlen = bpl;\n\t\t\tdel = 0;\n\t\t\twhile (len > 0) {\n\t\t\t\tn = read(raw_fb_fd, buf + del, len);\n\n\t\t\t\tif (n > 0) {\n\t\t\t\t\tdel += n;\n\t\t\t\t\tlen -= n;\n\t\t\t\t} else if (n == 0) {\n\t\t\t\t\tbreak;\n\t\t\t\t} else if (errno != EINTR && errno != EAGAIN) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (ix = 0; ix < (int) w; ix++) {\n\t\t\tint bx = (x + ix) * raw_fb_native_bpp;\n\t\t\tint ib = bx / 8;\n\t\t\tint br = bx - ib * 8;\n\t\t\tunsigned char val;\n\n\t\t\tval = *((unsigned char*) (buf + ib));\n\n\t\t\tval = msk[br] & val;\n\t\t\tval = val >> br;\n\n\t\t\tif (cga) {\n\t\t\t\t/* this is expt for CGA */\n\t\t\t\tdouble r, g, b;\n\t\t\t\tint ir, ig, ib;\n\t\t\t\tr = (2./3)*(val & 4) + (1./3)*(val & 8);\n\t\t\t\tg = (2./3)*(val & 2) + (1./3)*(val & 8);\n\t\t\t\tb = (2./3)*(val & 1) + (1./3)*(val & 8);\n\t\t\t\tif (val == 6) {\n\t\t\t\t\tg = g/2.;\n\t\t\t\t}\n\t\t\t\tir = rx_f * r;\n\t\t\t\tig = gx_f * g;\n\t\t\t\tib = bx_f * b;\n\t\t\t\tval = (ib << bs_f) | (ig << gs_f) | (ir << rs_f);\n\t\t\t} else {\n\t\t\t\tunsigned char rval, gval, bval;\n\t\t\t\t\n\t\t\t\trval = (val & rm_n) >> rs_n;\n\t\t\t\tgval = (val & gm_n) >> gs_n;\n\t\t\t\tbval = (val & bm_n) >> bs_n;\n\n\t\t\t\trval = (rx_f * rval) / rx_n;\n\t\t\t\tgval = (gx_f * gval) / gx_n;\n\t\t\t\tbval = (bx_f * bval) / bx_n;\n\n\t\t\t\trval = rval << rs_f;\n\t\t\t\tgval = gval << gs_f;\n\t\t\t\tbval = bval << bs_f;\n\n\t\t\t\tval = rval | gval | bval;\n\t\t\t}\n\n\t\t\t*(dst+ix) = (char) val;\n\t\t}\n\n\t\tdst += dest->bytes_per_line;\n\t}\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int clipshift = 0;",
      "int guess_bits_per_color(int bits_per_pixel);",
      "XImage *XShmCreateImage_wr(Display* disp, Visual* vis, unsigned int depth,\n    int format, char* data, XShmSegmentInfo* shminfo, unsigned int width,\n    unsigned int height);",
      "XImage *XCreateImage_wr(Display *disp, Visual *visual, unsigned int depth,\n    int format, int offset, char *data, unsigned int width,\n    unsigned int height, int bitmap_pad, int bytes_per_line);",
      "void copy_image(XImage *dest, int x, int y, unsigned int w, unsigned int h);",
      "Bool XTestCompareCurrentCursorWithWindow_wr(Display* dpy, Window w);",
      "int XFree_wr(void *data);",
      "void copy_raw_fb(XImage *dest, int x, int y, unsigned int w, unsigned int h);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "read",
          "args": [
            "raw_fb_fd",
            "buf + del",
            "len"
          ],
          "line": 523
        },
        "resolved": true,
        "details": {
          "function_name": "read_exact",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/sslhelper.c",
          "lines": "1292-1317",
          "snippet": "static int read_exact(int sock, char *buf, int len) {\n\tint n, fail = 0;\n\tif (sock < 0) {\n\t\treturn 0;\n\t}\n\twhile (len > 0) {\n\t\tn = read(sock, buf, len);\n\t\tif (n > 0) {\n\t\t\tbuf += n;\n\t\t\tlen -= n;\n\t\t} else if (n == 0) {\n\t\t\tfail = 1;\n\t\t\tbreak;\n\t\t} else if (n < 0 && (errno == EAGAIN || errno == EWOULDBLOCK)) {\n\t\t\tusleep(10*1000);\n\t\t} else if (n < 0 && errno != EINTR) {\n\t\t\tfail = 1;\n\t\t\tbreak;\n\t\t}\n\t}\n\tif (fail) {\n\t\treturn 0;\n\t} else {\n\t\treturn 1;\n\t}\n}",
          "includes": [
            "#include <openssl/rand.h>",
            "#include <openssl/err.h>",
            "#include <openssl/ssl.h>",
            "#include \"user.h\"",
            "#include \"unixpw.h\"",
            "#include \"sslcmds.h\"",
            "#include \"connections.h\"",
            "#include \"scan.h\"",
            "#include \"screen.h\"",
            "#include \"cleanup.h\"",
            "#include \"inet.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void ssl_helper_pid(pid_t pid, int sock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/rand.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n#include \"user.h\"\n#include \"unixpw.h\"\n#include \"sslcmds.h\"\n#include \"connections.h\"\n#include \"scan.h\"\n#include \"screen.h\"\n#include \"cleanup.h\"\n#include \"inet.h\"\n#include \"x11vnc.h\"\n\nvoid ssl_helper_pid(pid_t pid, int sock);\n\nstatic int read_exact(int sock, char *buf, int len) {\n\tint n, fail = 0;\n\tif (sock < 0) {\n\t\treturn 0;\n\t}\n\twhile (len > 0) {\n\t\tn = read(sock, buf, len);\n\t\tif (n > 0) {\n\t\t\tbuf += n;\n\t\t\tlen -= n;\n\t\t} else if (n == 0) {\n\t\t\tfail = 1;\n\t\t\tbreak;\n\t\t} else if (n < 0 && (errno == EAGAIN || errno == EWOULDBLOCK)) {\n\t\t\tusleep(10*1000);\n\t\t} else if (n < 0 && errno != EINTR) {\n\t\t\tfail = 1;\n\t\t\tbreak;\n\t\t}\n\t}\n\tif (fail) {\n\t\treturn 0;\n\t} else {\n\t\treturn 1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "lseek",
          "args": [
            "raw_fb_fd",
            "off",
            "SEEK_SET"
          ],
          "line": 518
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "raw_fb_offset + bpl*(y+line)"
          ],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "buf",
            "src",
            "bpl"
          ],
          "line": 512
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"x=%d y=%d w=%d h=%d bpl=%d d_bpl=%d-%dx%dx%d/%d %p\\n\"",
            "x",
            "y",
            "w",
            "h",
            "bpl",
            "dest->bytes_per_line",
            "dest->width",
            "dest->height",
            "dest->bits_per_pixel",
            "dest->depth",
            "dst"
          ],
          "line": 503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "buflen"
          ],
          "line": 480
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "buf"
          ],
          "line": 477
        },
        "resolved": true,
        "details": {
          "function_name": "free_rect",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/userinput.c",
          "lines": "6200-6247",
          "snippet": "int free_rect(int idx) {\n\tint n, ok = 0;\n\tsraRegionPtr r1, r2;\n\tint x, y, w, h;\n\n\tif (idx < 0 || idx >= cache_list_num) {\nif (0) fprintf(stderr, \"free_rect: bad index: %d\\n\", idx);\n\t\tclean_up_exit(1);\n\t}\n\n\tx = cache_list[idx].bs_x;\n\ty = cache_list[idx].bs_y;\n\tw = cache_list[idx].bs_w;\n\th = cache_list[idx].bs_h;\n\n\tif (x < 0) {\n\t\tCLEAR(idx);\nif (dnow() > last_client + 5 && ncdb) fprintf(stderr, \"free_rect: already bs_x invalidated: %d bs_x: %d\\n\", idx, x);\n\t\treturn 1;\n\t}\n\n\tr2 = sraRgnCreateRect(x, y, x+w, y+h);\n\n\tn = get_bs_n(y);\n\tif (n >= 0) {\n\t\tr1 = rect_reg[n];\n\t\tsraRgnOr(r1, r2);\n\t\tok = 1;\n\t}\n\n\tif (zero_rects) {\n\t\tsraRgnOr(zero_rects, r2);\n\t\tx = cache_list[idx].su_x;\n\t\ty = cache_list[idx].su_y;\n\t\tw = cache_list[idx].su_w;\n\t\th = cache_list[idx].su_h;\n\t\tif (x >= 0) {\n\t\t\tsraRgnDestroy(r2);\n\t\t\tr2 = sraRgnCreateRect(x, y, x+w, y+h);\n\t\t\tsraRgnOr(zero_rects, r2);\n\t\t}\n\t}\n\tsraRgnDestroy(r2);\n\n\tCLEAR(idx);\nif (! ok && ncdb) fprintf(stderr, \"**** free_rect: not-found %d\\n\", idx);\n\treturn ok;\n}",
          "includes": [
            "#include \"default8x16.h\"",
            "#include \"connections.h\"",
            "#include \"screen.h\"",
            "#include \"cursor.h\"",
            "#include \"macosxCGS.h\"",
            "#include \"macosx.h\"",
            "#include \"unixpw.h\"",
            "#include \"8to24.h\"",
            "#include \"xrandr.h\"",
            "#include \"solid.h\"",
            "#include \"keyboard.h\"",
            "#include \"rates.h\"",
            "#include \"pointer.h\"",
            "#include \"cleanup.h\"",
            "#include \"scan.h\"",
            "#include \"user.h\"",
            "#include \"xevents.h\"",
            "#include \"win_utils.h\"",
            "#include \"xinerama.h\"",
            "#include \"xrecord.h\"",
            "#include \"xdamage.h\"",
            "#include \"xwrappers.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void mark_for_xdamage(int x, int y, int w, int h);",
            "void set_xdamage_mark(int x, int y, int w, int h);",
            "int find_rect(int idx, int x, int y, int w, int h);",
            "winattr_t *cache_list;",
            "int clipped(int idx);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"default8x16.h\"\n#include \"connections.h\"\n#include \"screen.h\"\n#include \"cursor.h\"\n#include \"macosxCGS.h\"\n#include \"macosx.h\"\n#include \"unixpw.h\"\n#include \"8to24.h\"\n#include \"xrandr.h\"\n#include \"solid.h\"\n#include \"keyboard.h\"\n#include \"rates.h\"\n#include \"pointer.h\"\n#include \"cleanup.h\"\n#include \"scan.h\"\n#include \"user.h\"\n#include \"xevents.h\"\n#include \"win_utils.h\"\n#include \"xinerama.h\"\n#include \"xrecord.h\"\n#include \"xdamage.h\"\n#include \"xwrappers.h\"\n#include \"x11vnc.h\"\n\nvoid mark_for_xdamage(int x, int y, int w, int h);\nvoid set_xdamage_mark(int x, int y, int w, int h);\nint find_rect(int idx, int x, int y, int w, int h);\nwinattr_t *cache_list;\nint clipped(int idx);\n\nint free_rect(int idx) {\n\tint n, ok = 0;\n\tsraRegionPtr r1, r2;\n\tint x, y, w, h;\n\n\tif (idx < 0 || idx >= cache_list_num) {\nif (0) fprintf(stderr, \"free_rect: bad index: %d\\n\", idx);\n\t\tclean_up_exit(1);\n\t}\n\n\tx = cache_list[idx].bs_x;\n\ty = cache_list[idx].bs_y;\n\tw = cache_list[idx].bs_w;\n\th = cache_list[idx].bs_h;\n\n\tif (x < 0) {\n\t\tCLEAR(idx);\nif (dnow() > last_client + 5 && ncdb) fprintf(stderr, \"free_rect: already bs_x invalidated: %d bs_x: %d\\n\", idx, x);\n\t\treturn 1;\n\t}\n\n\tr2 = sraRgnCreateRect(x, y, x+w, y+h);\n\n\tn = get_bs_n(y);\n\tif (n >= 0) {\n\t\tr1 = rect_reg[n];\n\t\tsraRgnOr(r1, r2);\n\t\tok = 1;\n\t}\n\n\tif (zero_rects) {\n\t\tsraRgnOr(zero_rects, r2);\n\t\tx = cache_list[idx].su_x;\n\t\ty = cache_list[idx].su_y;\n\t\tw = cache_list[idx].su_w;\n\t\th = cache_list[idx].su_h;\n\t\tif (x >= 0) {\n\t\t\tsraRgnDestroy(r2);\n\t\t\tr2 = sraRgnCreateRect(x, y, x+w, y+h);\n\t\t\tsraRgnOr(zero_rects, r2);\n\t\t}\n\t}\n\tsraRgnDestroy(r2);\n\n\tCLEAR(idx);\nif (! ok && ncdb) fprintf(stderr, \"**** free_rect: not-found %d\\n\", idx);\n\treturn ok;\n}"
        }
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"RAWFB_CGA\""
          ],
          "line": 468
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint clipshift = 0;\nint guess_bits_per_color(int bits_per_pixel);\nXImage *XShmCreateImage_wr(Display* disp, Visual* vis, unsigned int depth,\n    int format, char* data, XShmSegmentInfo* shminfo, unsigned int width,\n    unsigned int height);\nXImage *XCreateImage_wr(Display *disp, Visual *visual, unsigned int depth,\n    int format, int offset, char *data, unsigned int width,\n    unsigned int height, int bitmap_pad, int bytes_per_line);\nvoid copy_image(XImage *dest, int x, int y, unsigned int w, unsigned int h);\nBool XTestCompareCurrentCursorWithWindow_wr(Display* dpy, Window w);\nint XFree_wr(void *data);\nvoid copy_raw_fb(XImage *dest, int x, int y, unsigned int w, unsigned int h);\n\nstatic void copy_raw_fb_low_bpp(XImage *dest, int x, int y, unsigned int w,\n    unsigned int h) {\n\tchar *src, *dst;\n\tunsigned int line;\n\tstatic char *buf = NULL;\n\tstatic int buflen = -1;\n\tint bpl = wdpy_x * raw_fb_native_bpp / 8;\n\tint n, ix, len, del, sz = wdpy_x * raw_fb_expand_bytes;\n\n\tunsigned int rm_n = raw_fb_native_red_mask;\n\tunsigned int gm_n = raw_fb_native_green_mask;\n\tunsigned int bm_n = raw_fb_native_blue_mask;\n\tunsigned int rm_f = main_red_mask;\n\tunsigned int gm_f = main_green_mask;\n\tunsigned int bm_f = main_blue_mask;\n\n\tunsigned int rs_n = raw_fb_native_red_shift;\n\tunsigned int gs_n = raw_fb_native_green_shift;\n\tunsigned int bs_n = raw_fb_native_blue_shift;\n\tunsigned int rs_f = main_red_shift;\n\tunsigned int gs_f = main_green_shift;\n\tunsigned int bs_f = main_blue_shift;\n\n\tunsigned int rx_n = raw_fb_native_red_max;\n\tunsigned int gx_n = raw_fb_native_green_max;\n\tunsigned int bx_n = raw_fb_native_blue_max;\n\tunsigned int rx_f = main_red_max;\n\tunsigned int gx_f = main_green_max;\n\tunsigned int bx_f = main_blue_max;\n\n\tstatic unsigned int msk[8];\n\tstatic int last_bpp = -1;\n\tstatic int cga = -1;\n\n\tif (rm_f | gm_f | bm_f) {}\n\n\tif (cga < 0) {\n\t\tif (getenv(\"RAWFB_CGA\")) {\n\t\t\tcga = 1;\n\t\t} else {\n\t\t\tcga = 0;\n\t\t}\n\t}\n\n\tif (sz > buflen || buf == NULL) {\n\t\tif (buf) {\n\t\t\tfree(buf);\n\t\t}\n\t\tbuflen = sz + 1000;\n\t\tbuf = (char *) malloc(buflen);\n\t}\n\n\tif (clipshift && ! use_snapfb) {\n\t\tx += coff_x;\n\t\ty += coff_y;\n\t}\n\n\tif (last_bpp != raw_fb_native_bpp) {\n\t\tint br;\n\t\tfor (br = 0; br < 8; br++) {\n\t\t\tunsigned int pbit, k, m = 0;\n\t\t\t\n\t\t\tfor (k=0; k < (unsigned int) raw_fb_native_bpp; k++) {\n\t\t\t\tpbit = 1 << (br+k);\n\t\t\t\tm |= pbit;\n\t\t\t}\n\t\t\tmsk[br] = m;\n\t\t}\n\t\tlast_bpp = raw_fb_native_bpp;\n\t}\n\n\tdst = dest->data;\nif (0) fprintf(stderr, \"x=%d y=%d w=%d h=%d bpl=%d d_bpl=%d-%dx%dx%d/%d %p\\n\",\n    x, y, w, h, bpl, dest->bytes_per_line, dest->width, dest->height, dest->bits_per_pixel, dest->depth, dst);\n\n\tfor (line = 0; line < h; line++) {\n\n\t\tif (! raw_fb_seek) {\n\t\t\t/* mmap */\n\t\t\tsrc = raw_fb_addr + raw_fb_offset + bpl*(y+line);\n\n\t\t\tmemcpy(buf, src, bpl);\n\t\t} else {\n\t\t\t/* lseek */\n\t\t\toff_t off;\n\t\t\toff = (off_t) (raw_fb_offset + bpl*(y+line));\n\n\t\t\tlseek(raw_fb_fd, off, SEEK_SET);\n\n\t\t\tlen = bpl;\n\t\t\tdel = 0;\n\t\t\twhile (len > 0) {\n\t\t\t\tn = read(raw_fb_fd, buf + del, len);\n\n\t\t\t\tif (n > 0) {\n\t\t\t\t\tdel += n;\n\t\t\t\t\tlen -= n;\n\t\t\t\t} else if (n == 0) {\n\t\t\t\t\tbreak;\n\t\t\t\t} else if (errno != EINTR && errno != EAGAIN) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (ix = 0; ix < (int) w; ix++) {\n\t\t\tint bx = (x + ix) * raw_fb_native_bpp;\n\t\t\tint ib = bx / 8;\n\t\t\tint br = bx - ib * 8;\n\t\t\tunsigned char val;\n\n\t\t\tval = *((unsigned char*) (buf + ib));\n\n\t\t\tval = msk[br] & val;\n\t\t\tval = val >> br;\n\n\t\t\tif (cga) {\n\t\t\t\t/* this is expt for CGA */\n\t\t\t\tdouble r, g, b;\n\t\t\t\tint ir, ig, ib;\n\t\t\t\tr = (2./3)*(val & 4) + (1./3)*(val & 8);\n\t\t\t\tg = (2./3)*(val & 2) + (1./3)*(val & 8);\n\t\t\t\tb = (2./3)*(val & 1) + (1./3)*(val & 8);\n\t\t\t\tif (val == 6) {\n\t\t\t\t\tg = g/2.;\n\t\t\t\t}\n\t\t\t\tir = rx_f * r;\n\t\t\t\tig = gx_f * g;\n\t\t\t\tib = bx_f * b;\n\t\t\t\tval = (ib << bs_f) | (ig << gs_f) | (ir << rs_f);\n\t\t\t} else {\n\t\t\t\tunsigned char rval, gval, bval;\n\t\t\t\t\n\t\t\t\trval = (val & rm_n) >> rs_n;\n\t\t\t\tgval = (val & gm_n) >> gs_n;\n\t\t\t\tbval = (val & bm_n) >> bs_n;\n\n\t\t\t\trval = (rx_f * rval) / rx_n;\n\t\t\t\tgval = (gx_f * gval) / gx_n;\n\t\t\t\tbval = (bx_f * bval) / bx_n;\n\n\t\t\t\trval = rval << rs_f;\n\t\t\t\tgval = gval << gs_f;\n\t\t\t\tbval = bval << bs_f;\n\n\t\t\t\tval = rval | gval | bval;\n\t\t\t}\n\n\t\t\t*(dst+ix) = (char) val;\n\t\t}\n\n\t\tdst += dest->bytes_per_line;\n\t}\n}"
  },
  {
    "function_name": "XCreateImage_wr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "370-429",
    "snippet": "XImage *XCreateImage_wr(Display *disp, Visual *visual, unsigned int depth,\n    int format, int offset, char *data, unsigned int width,\n    unsigned int height, int bitmap_pad, int bytes_per_line) {\n\t/*\n\t * This is a kludge to get a created XImage to exactly match what\n\t * XReadScreen returns: we noticed the rgb masks are different\n\t * from XCreateImage with the high color visual (red mask <->\n\t * blue mask).  Note we read from the root window(!) then free\n\t * the data.\n\t */\n\n\tif (raw_fb) {\t/* raw_fb hack */\n\t\tXImage *xi;\n\t\txi = (XImage *) malloc(sizeof(XImage));\n\t\tmemset(xi, 0, sizeof(XImage));\n\t\txi->depth = depth;\n\t\tif (depth >= 24) {\n\t\t\txi->bits_per_pixel = 32;\n\t\t} else if (depth > 16) {\n\t\t\txi->bits_per_pixel = 24;\n\t\t} else if (depth > 8) {\n\t\t\txi->bits_per_pixel = 16;\n\t\t} else {\n\t\t\txi->bits_per_pixel = 8;\n\t\t}\n\t\txi->format = format;\n\t\txi->xoffset = offset;\n\t\txi->data = data;\n\t\txi->width = width;\n\t\txi->height = height;\n\t\txi->bitmap_pad = bitmap_pad;\n\t\txi->bytes_per_line = bytes_per_line ? bytes_per_line : \n\t\t    xi->width * xi->bits_per_pixel / 8;\n\t\txi->bitmap_unit = -1;\t/* hint to not call XDestroyImage */\n\t\treturn xi;\n\t}\n\n#if NO_X11\n\tnox11_exit(1);\n\tif (!disp || !visual || !depth || !format || !offset || !data || !width\n\t    || !height || !width || !bitmap_pad || !bytes_per_line) {}\n\treturn NULL;\n#else\n\tif (overlay) {\n\t\tXImage *xi;\n\t\txi = xreadscreen(disp, window, 0, 0, width, height, False);\n\t\tif (xi == NULL) {\n\t\t\treturn xi;\n\t\t}\n\t\tif (xi->data != NULL) {\n\t\t\tfree(xi->data);\n\t\t}\n\t\txi->data = data;\n\t\treturn xi;\n\t}\n\n\treturn XCreateImage(disp, visual, depth, format, offset, data,\n\t    width, height, bitmap_pad, bytes_per_line);\n#endif\t/* NO_X11 */\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int guess_bits_per_color(int bits_per_pixel);",
      "int XFlush_wr(Display *disp);",
      "Status XShmGetImage_wr(Display *disp, Drawable d, XImage *image, int x, int y,\n    unsigned long mask);",
      "XImage *XShmCreateImage_wr(Display* disp, Visual* vis, unsigned int depth,\n    int format, char* data, XShmSegmentInfo* shminfo, unsigned int width,\n    unsigned int height);",
      "Bool XShmQueryExtension_wr(Display *disp);",
      "int XShmGetEventBase_wr(Display *disp);",
      "XImage *XGetImage_wr(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, unsigned long plane_mask,\n    int format);",
      "XImage *XCreateImage_wr(Display *disp, Visual *visual, unsigned int depth,\n    int format, int offset, char *data, unsigned int width,\n    unsigned int height, int bitmap_pad, int bytes_per_line);",
      "int XFree_wr(void *data);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "XCreateImage",
          "args": [
            "disp",
            "visual",
            "depth",
            "format",
            "offset",
            "data",
            "width",
            "height",
            "bitmap_pad",
            "bytes_per_line"
          ],
          "line": 426
        },
        "resolved": true,
        "details": {
          "function_name": "XCreateImage_wr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "370-429",
          "snippet": "XImage *XCreateImage_wr(Display *disp, Visual *visual, unsigned int depth,\n    int format, int offset, char *data, unsigned int width,\n    unsigned int height, int bitmap_pad, int bytes_per_line) {\n\t/*\n\t * This is a kludge to get a created XImage to exactly match what\n\t * XReadScreen returns: we noticed the rgb masks are different\n\t * from XCreateImage with the high color visual (red mask <->\n\t * blue mask).  Note we read from the root window(!) then free\n\t * the data.\n\t */\n\n\tif (raw_fb) {\t/* raw_fb hack */\n\t\tXImage *xi;\n\t\txi = (XImage *) malloc(sizeof(XImage));\n\t\tmemset(xi, 0, sizeof(XImage));\n\t\txi->depth = depth;\n\t\tif (depth >= 24) {\n\t\t\txi->bits_per_pixel = 32;\n\t\t} else if (depth > 16) {\n\t\t\txi->bits_per_pixel = 24;\n\t\t} else if (depth > 8) {\n\t\t\txi->bits_per_pixel = 16;\n\t\t} else {\n\t\t\txi->bits_per_pixel = 8;\n\t\t}\n\t\txi->format = format;\n\t\txi->xoffset = offset;\n\t\txi->data = data;\n\t\txi->width = width;\n\t\txi->height = height;\n\t\txi->bitmap_pad = bitmap_pad;\n\t\txi->bytes_per_line = bytes_per_line ? bytes_per_line : \n\t\t    xi->width * xi->bits_per_pixel / 8;\n\t\txi->bitmap_unit = -1;\t/* hint to not call XDestroyImage */\n\t\treturn xi;\n\t}\n\n#if NO_X11\n\tnox11_exit(1);\n\tif (!disp || !visual || !depth || !format || !offset || !data || !width\n\t    || !height || !width || !bitmap_pad || !bytes_per_line) {}\n\treturn NULL;\n#else\n\tif (overlay) {\n\t\tXImage *xi;\n\t\txi = xreadscreen(disp, window, 0, 0, width, height, False);\n\t\tif (xi == NULL) {\n\t\t\treturn xi;\n\t\t}\n\t\tif (xi->data != NULL) {\n\t\t\tfree(xi->data);\n\t\t}\n\t\txi->data = data;\n\t\treturn xi;\n\t}\n\n\treturn XCreateImage(disp, visual, depth, format, offset, data,\n\t    width, height, bitmap_pad, bytes_per_line);\n#endif\t/* NO_X11 */\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "xi->data"
          ],
          "line": 420
        },
        "resolved": true,
        "details": {
          "function_name": "free_rect",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/userinput.c",
          "lines": "6200-6247",
          "snippet": "int free_rect(int idx) {\n\tint n, ok = 0;\n\tsraRegionPtr r1, r2;\n\tint x, y, w, h;\n\n\tif (idx < 0 || idx >= cache_list_num) {\nif (0) fprintf(stderr, \"free_rect: bad index: %d\\n\", idx);\n\t\tclean_up_exit(1);\n\t}\n\n\tx = cache_list[idx].bs_x;\n\ty = cache_list[idx].bs_y;\n\tw = cache_list[idx].bs_w;\n\th = cache_list[idx].bs_h;\n\n\tif (x < 0) {\n\t\tCLEAR(idx);\nif (dnow() > last_client + 5 && ncdb) fprintf(stderr, \"free_rect: already bs_x invalidated: %d bs_x: %d\\n\", idx, x);\n\t\treturn 1;\n\t}\n\n\tr2 = sraRgnCreateRect(x, y, x+w, y+h);\n\n\tn = get_bs_n(y);\n\tif (n >= 0) {\n\t\tr1 = rect_reg[n];\n\t\tsraRgnOr(r1, r2);\n\t\tok = 1;\n\t}\n\n\tif (zero_rects) {\n\t\tsraRgnOr(zero_rects, r2);\n\t\tx = cache_list[idx].su_x;\n\t\ty = cache_list[idx].su_y;\n\t\tw = cache_list[idx].su_w;\n\t\th = cache_list[idx].su_h;\n\t\tif (x >= 0) {\n\t\t\tsraRgnDestroy(r2);\n\t\t\tr2 = sraRgnCreateRect(x, y, x+w, y+h);\n\t\t\tsraRgnOr(zero_rects, r2);\n\t\t}\n\t}\n\tsraRgnDestroy(r2);\n\n\tCLEAR(idx);\nif (! ok && ncdb) fprintf(stderr, \"**** free_rect: not-found %d\\n\", idx);\n\treturn ok;\n}",
          "includes": [
            "#include \"default8x16.h\"",
            "#include \"connections.h\"",
            "#include \"screen.h\"",
            "#include \"cursor.h\"",
            "#include \"macosxCGS.h\"",
            "#include \"macosx.h\"",
            "#include \"unixpw.h\"",
            "#include \"8to24.h\"",
            "#include \"xrandr.h\"",
            "#include \"solid.h\"",
            "#include \"keyboard.h\"",
            "#include \"rates.h\"",
            "#include \"pointer.h\"",
            "#include \"cleanup.h\"",
            "#include \"scan.h\"",
            "#include \"user.h\"",
            "#include \"xevents.h\"",
            "#include \"win_utils.h\"",
            "#include \"xinerama.h\"",
            "#include \"xrecord.h\"",
            "#include \"xdamage.h\"",
            "#include \"xwrappers.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void mark_for_xdamage(int x, int y, int w, int h);",
            "void set_xdamage_mark(int x, int y, int w, int h);",
            "int find_rect(int idx, int x, int y, int w, int h);",
            "winattr_t *cache_list;",
            "int clipped(int idx);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"default8x16.h\"\n#include \"connections.h\"\n#include \"screen.h\"\n#include \"cursor.h\"\n#include \"macosxCGS.h\"\n#include \"macosx.h\"\n#include \"unixpw.h\"\n#include \"8to24.h\"\n#include \"xrandr.h\"\n#include \"solid.h\"\n#include \"keyboard.h\"\n#include \"rates.h\"\n#include \"pointer.h\"\n#include \"cleanup.h\"\n#include \"scan.h\"\n#include \"user.h\"\n#include \"xevents.h\"\n#include \"win_utils.h\"\n#include \"xinerama.h\"\n#include \"xrecord.h\"\n#include \"xdamage.h\"\n#include \"xwrappers.h\"\n#include \"x11vnc.h\"\n\nvoid mark_for_xdamage(int x, int y, int w, int h);\nvoid set_xdamage_mark(int x, int y, int w, int h);\nint find_rect(int idx, int x, int y, int w, int h);\nwinattr_t *cache_list;\nint clipped(int idx);\n\nint free_rect(int idx) {\n\tint n, ok = 0;\n\tsraRegionPtr r1, r2;\n\tint x, y, w, h;\n\n\tif (idx < 0 || idx >= cache_list_num) {\nif (0) fprintf(stderr, \"free_rect: bad index: %d\\n\", idx);\n\t\tclean_up_exit(1);\n\t}\n\n\tx = cache_list[idx].bs_x;\n\ty = cache_list[idx].bs_y;\n\tw = cache_list[idx].bs_w;\n\th = cache_list[idx].bs_h;\n\n\tif (x < 0) {\n\t\tCLEAR(idx);\nif (dnow() > last_client + 5 && ncdb) fprintf(stderr, \"free_rect: already bs_x invalidated: %d bs_x: %d\\n\", idx, x);\n\t\treturn 1;\n\t}\n\n\tr2 = sraRgnCreateRect(x, y, x+w, y+h);\n\n\tn = get_bs_n(y);\n\tif (n >= 0) {\n\t\tr1 = rect_reg[n];\n\t\tsraRgnOr(r1, r2);\n\t\tok = 1;\n\t}\n\n\tif (zero_rects) {\n\t\tsraRgnOr(zero_rects, r2);\n\t\tx = cache_list[idx].su_x;\n\t\ty = cache_list[idx].su_y;\n\t\tw = cache_list[idx].su_w;\n\t\th = cache_list[idx].su_h;\n\t\tif (x >= 0) {\n\t\t\tsraRgnDestroy(r2);\n\t\t\tr2 = sraRgnCreateRect(x, y, x+w, y+h);\n\t\t\tsraRgnOr(zero_rects, r2);\n\t\t}\n\t}\n\tsraRgnDestroy(r2);\n\n\tCLEAR(idx);\nif (! ok && ncdb) fprintf(stderr, \"**** free_rect: not-found %d\\n\", idx);\n\treturn ok;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xreadscreen",
          "args": [
            "disp",
            "window",
            "0",
            "0",
            "width",
            "height",
            "False"
          ],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "xreadscreen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "265-291",
          "snippet": "XImage *xreadscreen(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, Bool show_cursor) {\n#if NO_X11\n\tif (!disp || !d || !x || !y || !width || !height || !show_cursor) {}\n\treturn NULL;\n#else\n\n#ifdef SOLARIS_OVERLAY\n\treturn XReadScreen(disp, d, x, y, width, height,\n\t    show_cursor);\n#else\n#  ifdef IRIX_OVERLAY\n\t{\tunsigned long hints = 0, hints_ret;\n\t\tif (show_cursor) hints |= XRD_READ_POINTER;\n\t\treturn XReadDisplay(disp, d, x, y, width, height,\n\t\t    hints, &hints_ret);\n\t}\n#  else\n\t/* unused vars warning: */\n\tif (disp || d || x || y || width || height || show_cursor) {}\n\n\treturn NULL;\n#  endif\n#endif\n\n#endif\t/* NO_X11 */\n}",
          "includes": [
            "#include \"nox11_funcs.h\"",
            "#include \"xwrappers.h\"",
            "#include \"xi2_devices.h\"",
            "#include \"macosx.h\"",
            "#include \"cleanup.h\"",
            "#include \"connections.h\"",
            "#include \"xevents.h\"",
            "#include \"keyboard.h\"",
            "#include \"xrecord.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int XFlush_wr(Display *disp);",
            "XImage *XShmCreateImage_wr(Display* disp, Visual* vis, unsigned int depth,\n    int format, char* data, XShmSegmentInfo* shminfo, unsigned int width,\n    unsigned int height);",
            "Bool XShmQueryExtension_wr(Display *disp);",
            "int XShmGetEventBase_wr(Display *disp);",
            "XImage *xreadscreen(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, Bool show_cursor);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint XFlush_wr(Display *disp);\nXImage *XShmCreateImage_wr(Display* disp, Visual* vis, unsigned int depth,\n    int format, char* data, XShmSegmentInfo* shminfo, unsigned int width,\n    unsigned int height);\nBool XShmQueryExtension_wr(Display *disp);\nint XShmGetEventBase_wr(Display *disp);\nXImage *xreadscreen(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, Bool show_cursor);\n\nXImage *xreadscreen(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, Bool show_cursor) {\n#if NO_X11\n\tif (!disp || !d || !x || !y || !width || !height || !show_cursor) {}\n\treturn NULL;\n#else\n\n#ifdef SOLARIS_OVERLAY\n\treturn XReadScreen(disp, d, x, y, width, height,\n\t    show_cursor);\n#else\n#  ifdef IRIX_OVERLAY\n\t{\tunsigned long hints = 0, hints_ret;\n\t\tif (show_cursor) hints |= XRD_READ_POINTER;\n\t\treturn XReadDisplay(disp, d, x, y, width, height,\n\t\t    hints, &hints_ret);\n\t}\n#  else\n\t/* unused vars warning: */\n\tif (disp || d || x || y || width || height || show_cursor) {}\n\n\treturn NULL;\n#  endif\n#endif\n\n#endif\t/* NO_X11 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "nox11_exit",
          "args": [
            "1"
          ],
          "line": 408
        },
        "resolved": true,
        "details": {
          "function_name": "nox11_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "1711-1718",
          "snippet": "void nox11_exit(int rc) {\n#if NO_X11\n\trfbLog(\"This x11vnc was not built with X11 support.\\n\");\n\tclean_up_exit(rc);\n#else\n\tif (0) {rc = 0;}\n#endif\n}",
          "includes": [
            "#include \"nox11_funcs.h\"",
            "#include \"xwrappers.h\"",
            "#include \"xi2_devices.h\"",
            "#include \"macosx.h\"",
            "#include \"cleanup.h\"",
            "#include \"connections.h\"",
            "#include \"xevents.h\"",
            "#include \"keyboard.h\"",
            "#include \"xrecord.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nvoid nox11_exit(int rc) {\n#if NO_X11\n\trfbLog(\"This x11vnc was not built with X11 support.\\n\");\n\tclean_up_exit(rc);\n#else\n\tif (0) {rc = 0;}\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "xi",
            "0",
            "sizeof(XImage)"
          ],
          "line": 384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(XImage)"
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint guess_bits_per_color(int bits_per_pixel);\nint XFlush_wr(Display *disp);\nStatus XShmGetImage_wr(Display *disp, Drawable d, XImage *image, int x, int y,\n    unsigned long mask);\nXImage *XShmCreateImage_wr(Display* disp, Visual* vis, unsigned int depth,\n    int format, char* data, XShmSegmentInfo* shminfo, unsigned int width,\n    unsigned int height);\nBool XShmQueryExtension_wr(Display *disp);\nint XShmGetEventBase_wr(Display *disp);\nXImage *XGetImage_wr(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, unsigned long plane_mask,\n    int format);\nXImage *XCreateImage_wr(Display *disp, Visual *visual, unsigned int depth,\n    int format, int offset, char *data, unsigned int width,\n    unsigned int height, int bitmap_pad, int bytes_per_line);\nint XFree_wr(void *data);\n\nXImage *XCreateImage_wr(Display *disp, Visual *visual, unsigned int depth,\n    int format, int offset, char *data, unsigned int width,\n    unsigned int height, int bitmap_pad, int bytes_per_line) {\n\t/*\n\t * This is a kludge to get a created XImage to exactly match what\n\t * XReadScreen returns: we noticed the rgb masks are different\n\t * from XCreateImage with the high color visual (red mask <->\n\t * blue mask).  Note we read from the root window(!) then free\n\t * the data.\n\t */\n\n\tif (raw_fb) {\t/* raw_fb hack */\n\t\tXImage *xi;\n\t\txi = (XImage *) malloc(sizeof(XImage));\n\t\tmemset(xi, 0, sizeof(XImage));\n\t\txi->depth = depth;\n\t\tif (depth >= 24) {\n\t\t\txi->bits_per_pixel = 32;\n\t\t} else if (depth > 16) {\n\t\t\txi->bits_per_pixel = 24;\n\t\t} else if (depth > 8) {\n\t\t\txi->bits_per_pixel = 16;\n\t\t} else {\n\t\t\txi->bits_per_pixel = 8;\n\t\t}\n\t\txi->format = format;\n\t\txi->xoffset = offset;\n\t\txi->data = data;\n\t\txi->width = width;\n\t\txi->height = height;\n\t\txi->bitmap_pad = bitmap_pad;\n\t\txi->bytes_per_line = bytes_per_line ? bytes_per_line : \n\t\t    xi->width * xi->bits_per_pixel / 8;\n\t\txi->bitmap_unit = -1;\t/* hint to not call XDestroyImage */\n\t\treturn xi;\n\t}\n\n#if NO_X11\n\tnox11_exit(1);\n\tif (!disp || !visual || !depth || !format || !offset || !data || !width\n\t    || !height || !width || !bitmap_pad || !bytes_per_line) {}\n\treturn NULL;\n#else\n\tif (overlay) {\n\t\tXImage *xi;\n\t\txi = xreadscreen(disp, window, 0, 0, width, height, False);\n\t\tif (xi == NULL) {\n\t\t\treturn xi;\n\t\t}\n\t\tif (xi->data != NULL) {\n\t\t\tfree(xi->data);\n\t\t}\n\t\txi->data = data;\n\t\treturn xi;\n\t}\n\n\treturn XCreateImage(disp, visual, depth, format, offset, data,\n\t    width, height, bitmap_pad, bytes_per_line);\n#endif\t/* NO_X11 */\n}"
  },
  {
    "function_name": "XGetImage_wr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "340-368",
    "snippet": "XImage *XGetImage_wr(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, unsigned long plane_mask,\n    int format) {\n#if NO_X11\n\tif (!disp || !d || !x || !y || !width || !height || !plane_mask || !format) {}\n\tnox11_exit(1);\n\treturn NULL;\n#else\n\n\tADJUST_ROOTSHIFT\n\n\tif (overlay) {\n\t\treturn xreadscreen(disp, d, x, y, width, height,\n\t\t    (Bool) overlay_cursor);\n\t}\n#if HAVE_LIBXCOMPOSITE\n\tif(use_xcomposite && subwin  && !rootshift) {\n\t  XErrorHandler old_handler = XSetErrorHandler(trap_xerror);\n\t  Pixmap pixmap = XCompositeNameWindowPixmap(disp, d);\n\t  XImage* xi = XGetImage(disp, pixmap, x, y, width, height, plane_mask, format);\n\t  XFreePixmap(dpy, pixmap);\n\t  XSetErrorHandler(old_handler);\n\t  if(!trapped_xerror)\n\t    return xi;\n\t}\n#endif\n\treturn XGetImage(disp, d, x, y, width, height, plane_mask, format);\n#endif\t/* NO_X11 */\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [
      "#define ADJUST_ROOTSHIFT \\\n\tif (rootshift && subwin) { \\\n\t\td = rootwin; \\\n\t\tx += off_x; \\\n\t\ty += off_y; \\\n\t} \\\n\tif (clipshift) { \\\n\t\tx += coff_x; \\\n\t\ty += coff_y; \\\n\t}"
    ],
    "globals_used": [
      "int rootshift = 0;",
      "int XFlush_wr(Display *disp);",
      "XImage *XShmCreateImage_wr(Display* disp, Visual* vis, unsigned int depth,\n    int format, char* data, XShmSegmentInfo* shminfo, unsigned int width,\n    unsigned int height);",
      "Bool XShmQueryExtension_wr(Display *disp);",
      "int XShmGetEventBase_wr(Display *disp);",
      "XImage *XGetImage_wr(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, unsigned long plane_mask,\n    int format);",
      "void XTestDiscard_wr(Display *dpy);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "XGetImage",
          "args": [
            "disp",
            "d",
            "x",
            "y",
            "width",
            "height",
            "plane_mask",
            "format"
          ],
          "line": 366
        },
        "resolved": true,
        "details": {
          "function_name": "XGetImage_wr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "340-368",
          "snippet": "XImage *XGetImage_wr(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, unsigned long plane_mask,\n    int format) {\n#if NO_X11\n\tif (!disp || !d || !x || !y || !width || !height || !plane_mask || !format) {}\n\tnox11_exit(1);\n\treturn NULL;\n#else\n\n\tADJUST_ROOTSHIFT\n\n\tif (overlay) {\n\t\treturn xreadscreen(disp, d, x, y, width, height,\n\t\t    (Bool) overlay_cursor);\n\t}\n#if HAVE_LIBXCOMPOSITE\n\tif(use_xcomposite && subwin  && !rootshift) {\n\t  XErrorHandler old_handler = XSetErrorHandler(trap_xerror);\n\t  Pixmap pixmap = XCompositeNameWindowPixmap(disp, d);\n\t  XImage* xi = XGetImage(disp, pixmap, x, y, width, height, plane_mask, format);\n\t  XFreePixmap(dpy, pixmap);\n\t  XSetErrorHandler(old_handler);\n\t  if(!trapped_xerror)\n\t    return xi;\n\t}\n#endif\n\treturn XGetImage(disp, d, x, y, width, height, plane_mask, format);\n#endif\t/* NO_X11 */\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "XSetErrorHandler",
          "args": [
            "old_handler"
          ],
          "line": 361
        },
        "resolved": true,
        "details": {
          "function_name": "XSetErrorHandler",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/nox11_funcs.h",
          "lines": "2819-2821",
          "snippet": "XErrorHandler XSetErrorHandler (XErrorHandler h) {\n\treturn h;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "XErrorHandler XSetErrorHandler (XErrorHandler h) {\n\treturn h;\n}"
        }
      },
      {
        "call_info": {
          "callee": "XFreePixmap",
          "args": [
            "dpy",
            "pixmap"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XCompositeNameWindowPixmap",
          "args": [
            "disp",
            "d"
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xreadscreen",
          "args": [
            "disp",
            "d",
            "x",
            "y",
            "width",
            "height",
            "(Bool) overlay_cursor"
          ],
          "line": 352
        },
        "resolved": true,
        "details": {
          "function_name": "xreadscreen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "265-291",
          "snippet": "XImage *xreadscreen(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, Bool show_cursor) {\n#if NO_X11\n\tif (!disp || !d || !x || !y || !width || !height || !show_cursor) {}\n\treturn NULL;\n#else\n\n#ifdef SOLARIS_OVERLAY\n\treturn XReadScreen(disp, d, x, y, width, height,\n\t    show_cursor);\n#else\n#  ifdef IRIX_OVERLAY\n\t{\tunsigned long hints = 0, hints_ret;\n\t\tif (show_cursor) hints |= XRD_READ_POINTER;\n\t\treturn XReadDisplay(disp, d, x, y, width, height,\n\t\t    hints, &hints_ret);\n\t}\n#  else\n\t/* unused vars warning: */\n\tif (disp || d || x || y || width || height || show_cursor) {}\n\n\treturn NULL;\n#  endif\n#endif\n\n#endif\t/* NO_X11 */\n}",
          "includes": [
            "#include \"nox11_funcs.h\"",
            "#include \"xwrappers.h\"",
            "#include \"xi2_devices.h\"",
            "#include \"macosx.h\"",
            "#include \"cleanup.h\"",
            "#include \"connections.h\"",
            "#include \"xevents.h\"",
            "#include \"keyboard.h\"",
            "#include \"xrecord.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int XFlush_wr(Display *disp);",
            "XImage *XShmCreateImage_wr(Display* disp, Visual* vis, unsigned int depth,\n    int format, char* data, XShmSegmentInfo* shminfo, unsigned int width,\n    unsigned int height);",
            "Bool XShmQueryExtension_wr(Display *disp);",
            "int XShmGetEventBase_wr(Display *disp);",
            "XImage *xreadscreen(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, Bool show_cursor);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint XFlush_wr(Display *disp);\nXImage *XShmCreateImage_wr(Display* disp, Visual* vis, unsigned int depth,\n    int format, char* data, XShmSegmentInfo* shminfo, unsigned int width,\n    unsigned int height);\nBool XShmQueryExtension_wr(Display *disp);\nint XShmGetEventBase_wr(Display *disp);\nXImage *xreadscreen(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, Bool show_cursor);\n\nXImage *xreadscreen(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, Bool show_cursor) {\n#if NO_X11\n\tif (!disp || !d || !x || !y || !width || !height || !show_cursor) {}\n\treturn NULL;\n#else\n\n#ifdef SOLARIS_OVERLAY\n\treturn XReadScreen(disp, d, x, y, width, height,\n\t    show_cursor);\n#else\n#  ifdef IRIX_OVERLAY\n\t{\tunsigned long hints = 0, hints_ret;\n\t\tif (show_cursor) hints |= XRD_READ_POINTER;\n\t\treturn XReadDisplay(disp, d, x, y, width, height,\n\t\t    hints, &hints_ret);\n\t}\n#  else\n\t/* unused vars warning: */\n\tif (disp || d || x || y || width || height || show_cursor) {}\n\n\treturn NULL;\n#  endif\n#endif\n\n#endif\t/* NO_X11 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "nox11_exit",
          "args": [
            "1"
          ],
          "line": 345
        },
        "resolved": true,
        "details": {
          "function_name": "nox11_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "1711-1718",
          "snippet": "void nox11_exit(int rc) {\n#if NO_X11\n\trfbLog(\"This x11vnc was not built with X11 support.\\n\");\n\tclean_up_exit(rc);\n#else\n\tif (0) {rc = 0;}\n#endif\n}",
          "includes": [
            "#include \"nox11_funcs.h\"",
            "#include \"xwrappers.h\"",
            "#include \"xi2_devices.h\"",
            "#include \"macosx.h\"",
            "#include \"cleanup.h\"",
            "#include \"connections.h\"",
            "#include \"xevents.h\"",
            "#include \"keyboard.h\"",
            "#include \"xrecord.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nvoid nox11_exit(int rc) {\n#if NO_X11\n\trfbLog(\"This x11vnc was not built with X11 support.\\n\");\n\tclean_up_exit(rc);\n#else\n\tif (0) {rc = 0;}\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\n#define ADJUST_ROOTSHIFT \\\n\tif (rootshift && subwin) { \\\n\t\td = rootwin; \\\n\t\tx += off_x; \\\n\t\ty += off_y; \\\n\t} \\\n\tif (clipshift) { \\\n\t\tx += coff_x; \\\n\t\ty += coff_y; \\\n\t}\n\nint rootshift = 0;\nint XFlush_wr(Display *disp);\nXImage *XShmCreateImage_wr(Display* disp, Visual* vis, unsigned int depth,\n    int format, char* data, XShmSegmentInfo* shminfo, unsigned int width,\n    unsigned int height);\nBool XShmQueryExtension_wr(Display *disp);\nint XShmGetEventBase_wr(Display *disp);\nXImage *XGetImage_wr(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, unsigned long plane_mask,\n    int format);\nvoid XTestDiscard_wr(Display *dpy);\n\nXImage *XGetImage_wr(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, unsigned long plane_mask,\n    int format) {\n#if NO_X11\n\tif (!disp || !d || !x || !y || !width || !height || !plane_mask || !format) {}\n\tnox11_exit(1);\n\treturn NULL;\n#else\n\n\tADJUST_ROOTSHIFT\n\n\tif (overlay) {\n\t\treturn xreadscreen(disp, d, x, y, width, height,\n\t\t    (Bool) overlay_cursor);\n\t}\n#if HAVE_LIBXCOMPOSITE\n\tif(use_xcomposite && subwin  && !rootshift) {\n\t  XErrorHandler old_handler = XSetErrorHandler(trap_xerror);\n\t  Pixmap pixmap = XCompositeNameWindowPixmap(disp, d);\n\t  XImage* xi = XGetImage(disp, pixmap, x, y, width, height, plane_mask, format);\n\t  XFreePixmap(dpy, pixmap);\n\t  XSetErrorHandler(old_handler);\n\t  if(!trapped_xerror)\n\t    return xi;\n\t}\n#endif\n\treturn XGetImage(disp, d, x, y, width, height, plane_mask, format);\n#endif\t/* NO_X11 */\n}"
  },
  {
    "function_name": "XGetSubImage_wr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "293-338",
    "snippet": "XImage *XGetSubImage_wr(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, unsigned long plane_mask,\n    int format, XImage *dest_image, int dest_x, int dest_y) {\n#if NO_X11\n\tnox11_exit(1);\n\tif (!disp || !d || !x || !y || !width || !height || !plane_mask || !format || !dest_image || !dest_x || !dest_y) {}\n\treturn NULL;\n#else\n\tADJUST_ROOTSHIFT\n\n\tif (overlay && dest_x == 0 && dest_y == 0) {\n\t\tsize_t size = dest_image->height * dest_image->bytes_per_line;\n\t\tXImage *xi;\n\n\t\txi = xreadscreen(disp, d, x, y, width, height,\n\t\t    (Bool) overlay_cursor);\n\n\t\tif (! xi) return NULL;\n\n\t\t/*\n\t\t * There is extra overhead from memcpy and free...\n\t\t * this is not like the real XGetSubImage().  We hope\n\t\t * this significant overhead is still small compared to\n\t\t * the time to retrieve the fb data.\n\t\t */\n\t\tmemcpy(dest_image->data, xi->data, size);\n\n\t\tXDestroyImage(xi);\n\t\treturn (dest_image);\n\t}\n#if HAVE_LIBXCOMPOSITE\n\tif(use_xcomposite && subwin && !rootshift) {\n\t  XErrorHandler old_handler = XSetErrorHandler(trap_xerror);\n\t  Pixmap pixmap = XCompositeNameWindowPixmap(disp, d);\n\t  XImage* xi =  XGetSubImage(disp, pixmap, x, y, width, height, plane_mask,\n\t\t\t     format, dest_image, dest_x, dest_y);\n\t  XFreePixmap(dpy, pixmap);\n\t  XSetErrorHandler(old_handler);\n\t  if(!trapped_xerror)\n\t    return xi;\n\t}\n#endif\n\treturn XGetSubImage(disp, d, x, y, width, height, plane_mask,\n\t    format, dest_image, dest_x, dest_y);\n#endif\t/* NO_X11 */\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [
      "#define ADJUST_ROOTSHIFT \\\n\tif (rootshift && subwin) { \\\n\t\td = rootwin; \\\n\t\tx += off_x; \\\n\t\ty += off_y; \\\n\t} \\\n\tif (clipshift) { \\\n\t\tx += coff_x; \\\n\t\ty += coff_y; \\\n\t}"
    ],
    "globals_used": [
      "int rootshift = 0;",
      "int XFlush_wr(Display *disp);",
      "XImage *XShmCreateImage_wr(Display* disp, Visual* vis, unsigned int depth,\n    int format, char* data, XShmSegmentInfo* shminfo, unsigned int width,\n    unsigned int height);",
      "Bool XShmQueryExtension_wr(Display *disp);",
      "int XShmGetEventBase_wr(Display *disp);",
      "XImage *XGetSubImage_wr(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, unsigned long plane_mask,\n    int format, XImage *dest_image, int dest_x, int dest_y);",
      "XImage *XGetImage_wr(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, unsigned long plane_mask,\n    int format);",
      "XImage *XCreateImage_wr(Display *disp, Visual *visual, unsigned int depth,\n    int format, int offset, char *data, unsigned int width,\n    unsigned int height, int bitmap_pad, int bytes_per_line);",
      "void XTestDiscard_wr(Display *dpy);",
      "int XFree_wr(void *data);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "XGetSubImage",
          "args": [
            "disp",
            "d",
            "x",
            "y",
            "width",
            "height",
            "plane_mask",
            "format",
            "dest_image",
            "dest_x",
            "dest_y"
          ],
          "line": 335
        },
        "resolved": true,
        "details": {
          "function_name": "XGetSubImage_wr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "293-338",
          "snippet": "XImage *XGetSubImage_wr(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, unsigned long plane_mask,\n    int format, XImage *dest_image, int dest_x, int dest_y) {\n#if NO_X11\n\tnox11_exit(1);\n\tif (!disp || !d || !x || !y || !width || !height || !plane_mask || !format || !dest_image || !dest_x || !dest_y) {}\n\treturn NULL;\n#else\n\tADJUST_ROOTSHIFT\n\n\tif (overlay && dest_x == 0 && dest_y == 0) {\n\t\tsize_t size = dest_image->height * dest_image->bytes_per_line;\n\t\tXImage *xi;\n\n\t\txi = xreadscreen(disp, d, x, y, width, height,\n\t\t    (Bool) overlay_cursor);\n\n\t\tif (! xi) return NULL;\n\n\t\t/*\n\t\t * There is extra overhead from memcpy and free...\n\t\t * this is not like the real XGetSubImage().  We hope\n\t\t * this significant overhead is still small compared to\n\t\t * the time to retrieve the fb data.\n\t\t */\n\t\tmemcpy(dest_image->data, xi->data, size);\n\n\t\tXDestroyImage(xi);\n\t\treturn (dest_image);\n\t}\n#if HAVE_LIBXCOMPOSITE\n\tif(use_xcomposite && subwin && !rootshift) {\n\t  XErrorHandler old_handler = XSetErrorHandler(trap_xerror);\n\t  Pixmap pixmap = XCompositeNameWindowPixmap(disp, d);\n\t  XImage* xi =  XGetSubImage(disp, pixmap, x, y, width, height, plane_mask,\n\t\t\t     format, dest_image, dest_x, dest_y);\n\t  XFreePixmap(dpy, pixmap);\n\t  XSetErrorHandler(old_handler);\n\t  if(!trapped_xerror)\n\t    return xi;\n\t}\n#endif\n\treturn XGetSubImage(disp, d, x, y, width, height, plane_mask,\n\t    format, dest_image, dest_x, dest_y);\n#endif\t/* NO_X11 */\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "XSetErrorHandler",
          "args": [
            "old_handler"
          ],
          "line": 330
        },
        "resolved": true,
        "details": {
          "function_name": "XSetErrorHandler",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/nox11_funcs.h",
          "lines": "2819-2821",
          "snippet": "XErrorHandler XSetErrorHandler (XErrorHandler h) {\n\treturn h;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "XErrorHandler XSetErrorHandler (XErrorHandler h) {\n\treturn h;\n}"
        }
      },
      {
        "call_info": {
          "callee": "XFreePixmap",
          "args": [
            "dpy",
            "pixmap"
          ],
          "line": 329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XCompositeNameWindowPixmap",
          "args": [
            "disp",
            "d"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XDestroyImage",
          "args": [
            "xi"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "dest_image->data",
            "xi->data",
            "size"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xreadscreen",
          "args": [
            "disp",
            "d",
            "x",
            "y",
            "width",
            "height",
            "(Bool) overlay_cursor"
          ],
          "line": 307
        },
        "resolved": true,
        "details": {
          "function_name": "xreadscreen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "265-291",
          "snippet": "XImage *xreadscreen(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, Bool show_cursor) {\n#if NO_X11\n\tif (!disp || !d || !x || !y || !width || !height || !show_cursor) {}\n\treturn NULL;\n#else\n\n#ifdef SOLARIS_OVERLAY\n\treturn XReadScreen(disp, d, x, y, width, height,\n\t    show_cursor);\n#else\n#  ifdef IRIX_OVERLAY\n\t{\tunsigned long hints = 0, hints_ret;\n\t\tif (show_cursor) hints |= XRD_READ_POINTER;\n\t\treturn XReadDisplay(disp, d, x, y, width, height,\n\t\t    hints, &hints_ret);\n\t}\n#  else\n\t/* unused vars warning: */\n\tif (disp || d || x || y || width || height || show_cursor) {}\n\n\treturn NULL;\n#  endif\n#endif\n\n#endif\t/* NO_X11 */\n}",
          "includes": [
            "#include \"nox11_funcs.h\"",
            "#include \"xwrappers.h\"",
            "#include \"xi2_devices.h\"",
            "#include \"macosx.h\"",
            "#include \"cleanup.h\"",
            "#include \"connections.h\"",
            "#include \"xevents.h\"",
            "#include \"keyboard.h\"",
            "#include \"xrecord.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int XFlush_wr(Display *disp);",
            "XImage *XShmCreateImage_wr(Display* disp, Visual* vis, unsigned int depth,\n    int format, char* data, XShmSegmentInfo* shminfo, unsigned int width,\n    unsigned int height);",
            "Bool XShmQueryExtension_wr(Display *disp);",
            "int XShmGetEventBase_wr(Display *disp);",
            "XImage *xreadscreen(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, Bool show_cursor);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint XFlush_wr(Display *disp);\nXImage *XShmCreateImage_wr(Display* disp, Visual* vis, unsigned int depth,\n    int format, char* data, XShmSegmentInfo* shminfo, unsigned int width,\n    unsigned int height);\nBool XShmQueryExtension_wr(Display *disp);\nint XShmGetEventBase_wr(Display *disp);\nXImage *xreadscreen(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, Bool show_cursor);\n\nXImage *xreadscreen(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, Bool show_cursor) {\n#if NO_X11\n\tif (!disp || !d || !x || !y || !width || !height || !show_cursor) {}\n\treturn NULL;\n#else\n\n#ifdef SOLARIS_OVERLAY\n\treturn XReadScreen(disp, d, x, y, width, height,\n\t    show_cursor);\n#else\n#  ifdef IRIX_OVERLAY\n\t{\tunsigned long hints = 0, hints_ret;\n\t\tif (show_cursor) hints |= XRD_READ_POINTER;\n\t\treturn XReadDisplay(disp, d, x, y, width, height,\n\t\t    hints, &hints_ret);\n\t}\n#  else\n\t/* unused vars warning: */\n\tif (disp || d || x || y || width || height || show_cursor) {}\n\n\treturn NULL;\n#  endif\n#endif\n\n#endif\t/* NO_X11 */\n}"
        }
      },
      {
        "call_info": {
          "callee": "nox11_exit",
          "args": [
            "1"
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "nox11_exit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "1711-1718",
          "snippet": "void nox11_exit(int rc) {\n#if NO_X11\n\trfbLog(\"This x11vnc was not built with X11 support.\\n\");\n\tclean_up_exit(rc);\n#else\n\tif (0) {rc = 0;}\n#endif\n}",
          "includes": [
            "#include \"nox11_funcs.h\"",
            "#include \"xwrappers.h\"",
            "#include \"xi2_devices.h\"",
            "#include \"macosx.h\"",
            "#include \"cleanup.h\"",
            "#include \"connections.h\"",
            "#include \"xevents.h\"",
            "#include \"keyboard.h\"",
            "#include \"xrecord.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nvoid nox11_exit(int rc) {\n#if NO_X11\n\trfbLog(\"This x11vnc was not built with X11 support.\\n\");\n\tclean_up_exit(rc);\n#else\n\tif (0) {rc = 0;}\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\n#define ADJUST_ROOTSHIFT \\\n\tif (rootshift && subwin) { \\\n\t\td = rootwin; \\\n\t\tx += off_x; \\\n\t\ty += off_y; \\\n\t} \\\n\tif (clipshift) { \\\n\t\tx += coff_x; \\\n\t\ty += coff_y; \\\n\t}\n\nint rootshift = 0;\nint XFlush_wr(Display *disp);\nXImage *XShmCreateImage_wr(Display* disp, Visual* vis, unsigned int depth,\n    int format, char* data, XShmSegmentInfo* shminfo, unsigned int width,\n    unsigned int height);\nBool XShmQueryExtension_wr(Display *disp);\nint XShmGetEventBase_wr(Display *disp);\nXImage *XGetSubImage_wr(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, unsigned long plane_mask,\n    int format, XImage *dest_image, int dest_x, int dest_y);\nXImage *XGetImage_wr(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, unsigned long plane_mask,\n    int format);\nXImage *XCreateImage_wr(Display *disp, Visual *visual, unsigned int depth,\n    int format, int offset, char *data, unsigned int width,\n    unsigned int height, int bitmap_pad, int bytes_per_line);\nvoid XTestDiscard_wr(Display *dpy);\nint XFree_wr(void *data);\n\nXImage *XGetSubImage_wr(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, unsigned long plane_mask,\n    int format, XImage *dest_image, int dest_x, int dest_y) {\n#if NO_X11\n\tnox11_exit(1);\n\tif (!disp || !d || !x || !y || !width || !height || !plane_mask || !format || !dest_image || !dest_x || !dest_y) {}\n\treturn NULL;\n#else\n\tADJUST_ROOTSHIFT\n\n\tif (overlay && dest_x == 0 && dest_y == 0) {\n\t\tsize_t size = dest_image->height * dest_image->bytes_per_line;\n\t\tXImage *xi;\n\n\t\txi = xreadscreen(disp, d, x, y, width, height,\n\t\t    (Bool) overlay_cursor);\n\n\t\tif (! xi) return NULL;\n\n\t\t/*\n\t\t * There is extra overhead from memcpy and free...\n\t\t * this is not like the real XGetSubImage().  We hope\n\t\t * this significant overhead is still small compared to\n\t\t * the time to retrieve the fb data.\n\t\t */\n\t\tmemcpy(dest_image->data, xi->data, size);\n\n\t\tXDestroyImage(xi);\n\t\treturn (dest_image);\n\t}\n#if HAVE_LIBXCOMPOSITE\n\tif(use_xcomposite && subwin && !rootshift) {\n\t  XErrorHandler old_handler = XSetErrorHandler(trap_xerror);\n\t  Pixmap pixmap = XCompositeNameWindowPixmap(disp, d);\n\t  XImage* xi =  XGetSubImage(disp, pixmap, x, y, width, height, plane_mask,\n\t\t\t     format, dest_image, dest_x, dest_y);\n\t  XFreePixmap(dpy, pixmap);\n\t  XSetErrorHandler(old_handler);\n\t  if(!trapped_xerror)\n\t    return xi;\n\t}\n#endif\n\treturn XGetSubImage(disp, d, x, y, width, height, plane_mask,\n\t    format, dest_image, dest_x, dest_y);\n#endif\t/* NO_X11 */\n}"
  },
  {
    "function_name": "xreadscreen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "265-291",
    "snippet": "XImage *xreadscreen(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, Bool show_cursor) {\n#if NO_X11\n\tif (!disp || !d || !x || !y || !width || !height || !show_cursor) {}\n\treturn NULL;\n#else\n\n#ifdef SOLARIS_OVERLAY\n\treturn XReadScreen(disp, d, x, y, width, height,\n\t    show_cursor);\n#else\n#  ifdef IRIX_OVERLAY\n\t{\tunsigned long hints = 0, hints_ret;\n\t\tif (show_cursor) hints |= XRD_READ_POINTER;\n\t\treturn XReadDisplay(disp, d, x, y, width, height,\n\t\t    hints, &hints_ret);\n\t}\n#  else\n\t/* unused vars warning: */\n\tif (disp || d || x || y || width || height || show_cursor) {}\n\n\treturn NULL;\n#  endif\n#endif\n\n#endif\t/* NO_X11 */\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int XFlush_wr(Display *disp);",
      "XImage *XShmCreateImage_wr(Display* disp, Visual* vis, unsigned int depth,\n    int format, char* data, XShmSegmentInfo* shminfo, unsigned int width,\n    unsigned int height);",
      "Bool XShmQueryExtension_wr(Display *disp);",
      "int XShmGetEventBase_wr(Display *disp);",
      "XImage *xreadscreen(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, Bool show_cursor);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "XReadDisplay",
          "args": [
            "disp",
            "d",
            "x",
            "y",
            "width",
            "height",
            "hints",
            "&hints_ret"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XReadScreen",
          "args": [
            "disp",
            "d",
            "x",
            "y",
            "width",
            "height",
            "show_cursor"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint XFlush_wr(Display *disp);\nXImage *XShmCreateImage_wr(Display* disp, Visual* vis, unsigned int depth,\n    int format, char* data, XShmSegmentInfo* shminfo, unsigned int width,\n    unsigned int height);\nBool XShmQueryExtension_wr(Display *disp);\nint XShmGetEventBase_wr(Display *disp);\nXImage *xreadscreen(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, Bool show_cursor);\n\nXImage *xreadscreen(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, Bool show_cursor) {\n#if NO_X11\n\tif (!disp || !d || !x || !y || !width || !height || !show_cursor) {}\n\treturn NULL;\n#else\n\n#ifdef SOLARIS_OVERLAY\n\treturn XReadScreen(disp, d, x, y, width, height,\n\t    show_cursor);\n#else\n#  ifdef IRIX_OVERLAY\n\t{\tunsigned long hints = 0, hints_ret;\n\t\tif (show_cursor) hints |= XRD_READ_POINTER;\n\t\treturn XReadDisplay(disp, d, x, y, width, height,\n\t\t    hints, &hints_ret);\n\t}\n#  else\n\t/* unused vars warning: */\n\tif (disp || d || x || y || width || height || show_cursor) {}\n\n\treturn NULL;\n#  endif\n#endif\n\n#endif\t/* NO_X11 */\n}"
  },
  {
    "function_name": "XShmGetEventBase_wr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "254-261",
    "snippet": "int XShmGetEventBase_wr(Display *disp) {\n#if HAVE_XSHM\n\treturn XShmGetEventBase(disp);\n#else\n\tif (!disp) {}\n\treturn 0;\n#endif\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int XFlush_wr(Display *disp);",
      "Bool XShmQueryExtension_wr(Display *disp);",
      "int XShmGetEventBase_wr(Display *disp);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "XShmGetEventBase",
          "args": [
            "disp"
          ],
          "line": 256
        },
        "resolved": true,
        "details": {
          "function_name": "XShmGetEventBase_wr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "254-261",
          "snippet": "int XShmGetEventBase_wr(Display *disp) {\n#if HAVE_XSHM\n\treturn XShmGetEventBase(disp);\n#else\n\tif (!disp) {}\n\treturn 0;\n#endif\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint XFlush_wr(Display *disp);\nBool XShmQueryExtension_wr(Display *disp);\nint XShmGetEventBase_wr(Display *disp);\n\nint XShmGetEventBase_wr(Display *disp) {\n#if HAVE_XSHM\n\treturn XShmGetEventBase(disp);\n#else\n\tif (!disp) {}\n\treturn 0;\n#endif\n}"
  },
  {
    "function_name": "XShmQueryExtension_wr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "245-252",
    "snippet": "Bool XShmQueryExtension_wr(Display *disp) {\n#if HAVE_XSHM\n\treturn XShmQueryExtension(disp);\n#else\n\tif (!disp) {}\n\treturn False;\n#endif\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int XFlush_wr(Display *disp);",
      "Bool XShmQueryExtension_wr(Display *disp);",
      "int XShmGetEventBase_wr(Display *disp);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "XShmQueryExtension",
          "args": [
            "disp"
          ],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "XShmQueryExtension_wr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "245-252",
          "snippet": "Bool XShmQueryExtension_wr(Display *disp) {\n#if HAVE_XSHM\n\treturn XShmQueryExtension(disp);\n#else\n\tif (!disp) {}\n\treturn False;\n#endif\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint XFlush_wr(Display *disp);\nBool XShmQueryExtension_wr(Display *disp);\nint XShmGetEventBase_wr(Display *disp);\n\nBool XShmQueryExtension_wr(Display *disp) {\n#if HAVE_XSHM\n\treturn XShmQueryExtension(disp);\n#else\n\tif (!disp) {}\n\treturn False;\n#endif\n}"
  },
  {
    "function_name": "XShmDetach_wr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "235-243",
    "snippet": "Status XShmDetach_wr(Display *disp, XShmSegmentInfo *shminfo) {\n#if HAVE_XSHM\n\tif (getenv(\"X11VNC_SHM_DEBUG\")) fprintf(stderr, \"XShmDetach_wr: %p disp: %p\\n\", (void *)shminfo, (void *)disp);\n\treturn XShmDetach(disp, shminfo);\n#else\n\tif (!disp || !shminfo) {}\n\treturn (Status) 0;\n#endif\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int XFlush_wr(Display *disp);",
      "Status XShmAttach_wr(Display *disp, XShmSegmentInfo *shminfo);",
      "Status XShmDetach_wr(Display *disp, XShmSegmentInfo *shminfo);",
      "Bool XShmQueryExtension_wr(Display *disp);",
      "int XShmGetEventBase_wr(Display *disp);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "XShmDetach",
          "args": [
            "disp",
            "shminfo"
          ],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "XShmDetach_wr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "235-243",
          "snippet": "Status XShmDetach_wr(Display *disp, XShmSegmentInfo *shminfo) {\n#if HAVE_XSHM\n\tif (getenv(\"X11VNC_SHM_DEBUG\")) fprintf(stderr, \"XShmDetach_wr: %p disp: %p\\n\", (void *)shminfo, (void *)disp);\n\treturn XShmDetach(disp, shminfo);\n#else\n\tif (!disp || !shminfo) {}\n\treturn (Status) 0;\n#endif\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"XShmDetach_wr: %p disp: %p\\n\"",
            "(void *)shminfo",
            "(void *)disp"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"X11VNC_SHM_DEBUG\""
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint XFlush_wr(Display *disp);\nStatus XShmAttach_wr(Display *disp, XShmSegmentInfo *shminfo);\nStatus XShmDetach_wr(Display *disp, XShmSegmentInfo *shminfo);\nBool XShmQueryExtension_wr(Display *disp);\nint XShmGetEventBase_wr(Display *disp);\n\nStatus XShmDetach_wr(Display *disp, XShmSegmentInfo *shminfo) {\n#if HAVE_XSHM\n\tif (getenv(\"X11VNC_SHM_DEBUG\")) fprintf(stderr, \"XShmDetach_wr: %p disp: %p\\n\", (void *)shminfo, (void *)disp);\n\treturn XShmDetach(disp, shminfo);\n#else\n\tif (!disp || !shminfo) {}\n\treturn (Status) 0;\n#endif\n}"
  },
  {
    "function_name": "XShmAttach_wr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "226-233",
    "snippet": "Status XShmAttach_wr(Display *disp, XShmSegmentInfo *shminfo) {\n#if HAVE_XSHM\n\treturn XShmAttach(disp, shminfo);\n#else\n\tif (!disp || !shminfo) {}\n\treturn (Status) 0;\n#endif\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int XFlush_wr(Display *disp);",
      "Status XShmAttach_wr(Display *disp, XShmSegmentInfo *shminfo);",
      "Status XShmDetach_wr(Display *disp, XShmSegmentInfo *shminfo);",
      "Bool XShmQueryExtension_wr(Display *disp);",
      "int XShmGetEventBase_wr(Display *disp);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "XShmAttach",
          "args": [
            "disp",
            "shminfo"
          ],
          "line": 228
        },
        "resolved": true,
        "details": {
          "function_name": "XShmAttach_wr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "226-233",
          "snippet": "Status XShmAttach_wr(Display *disp, XShmSegmentInfo *shminfo) {\n#if HAVE_XSHM\n\treturn XShmAttach(disp, shminfo);\n#else\n\tif (!disp || !shminfo) {}\n\treturn (Status) 0;\n#endif\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint XFlush_wr(Display *disp);\nStatus XShmAttach_wr(Display *disp, XShmSegmentInfo *shminfo);\nStatus XShmDetach_wr(Display *disp, XShmSegmentInfo *shminfo);\nBool XShmQueryExtension_wr(Display *disp);\nint XShmGetEventBase_wr(Display *disp);\n\nStatus XShmAttach_wr(Display *disp, XShmSegmentInfo *shminfo) {\n#if HAVE_XSHM\n\treturn XShmAttach(disp, shminfo);\n#else\n\tif (!disp || !shminfo) {}\n\treturn (Status) 0;\n#endif\n}"
  },
  {
    "function_name": "XShmCreateImage_wr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "213-224",
    "snippet": "XImage *XShmCreateImage_wr(Display* disp, Visual* vis, unsigned int depth,\n    int format, char* data, XShmSegmentInfo* shminfo, unsigned int width,\n    unsigned int height) {\n\n#if HAVE_XSHM\n\treturn XShmCreateImage(disp, vis, depth, format, data, shminfo,\n\t    width, height); \n#else\n\tif (!disp || !vis || !depth || !format || !data || !shminfo || !width || !height) {}\n\treturn (XImage *) 0;\n#endif\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int XFlush_wr(Display *disp);",
      "XImage *XShmCreateImage_wr(Display* disp, Visual* vis, unsigned int depth,\n    int format, char* data, XShmSegmentInfo* shminfo, unsigned int width,\n    unsigned int height);",
      "Status XShmAttach_wr(Display *disp, XShmSegmentInfo *shminfo);",
      "Status XShmDetach_wr(Display *disp, XShmSegmentInfo *shminfo);",
      "Bool XShmQueryExtension_wr(Display *disp);",
      "int XShmGetEventBase_wr(Display *disp);",
      "XImage *XGetImage_wr(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, unsigned long plane_mask,\n    int format);",
      "int XFree_wr(void *data);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "XShmCreateImage",
          "args": [
            "disp",
            "vis",
            "depth",
            "format",
            "data",
            "shminfo",
            "width",
            "height"
          ],
          "line": 218
        },
        "resolved": true,
        "details": {
          "function_name": "XShmCreateImage_wr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "213-224",
          "snippet": "XImage *XShmCreateImage_wr(Display* disp, Visual* vis, unsigned int depth,\n    int format, char* data, XShmSegmentInfo* shminfo, unsigned int width,\n    unsigned int height) {\n\n#if HAVE_XSHM\n\treturn XShmCreateImage(disp, vis, depth, format, data, shminfo,\n\t    width, height); \n#else\n\tif (!disp || !vis || !depth || !format || !data || !shminfo || !width || !height) {}\n\treturn (XImage *) 0;\n#endif\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint XFlush_wr(Display *disp);\nXImage *XShmCreateImage_wr(Display* disp, Visual* vis, unsigned int depth,\n    int format, char* data, XShmSegmentInfo* shminfo, unsigned int width,\n    unsigned int height);\nStatus XShmAttach_wr(Display *disp, XShmSegmentInfo *shminfo);\nStatus XShmDetach_wr(Display *disp, XShmSegmentInfo *shminfo);\nBool XShmQueryExtension_wr(Display *disp);\nint XShmGetEventBase_wr(Display *disp);\nXImage *XGetImage_wr(Display *disp, Drawable d, int x, int y,\n    unsigned int width, unsigned int height, unsigned long plane_mask,\n    int format);\nint XFree_wr(void *data);\n\nXImage *XShmCreateImage_wr(Display* disp, Visual* vis, unsigned int depth,\n    int format, char* data, XShmSegmentInfo* shminfo, unsigned int width,\n    unsigned int height) {\n\n#if HAVE_XSHM\n\treturn XShmCreateImage(disp, vis, depth, format, data, shminfo,\n\t    width, height); \n#else\n\tif (!disp || !vis || !depth || !format || !data || !shminfo || !width || !height) {}\n\treturn (XImage *) 0;\n#endif\n}"
  },
  {
    "function_name": "XShmGetImage_wr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "187-211",
    "snippet": "Status XShmGetImage_wr(Display *disp, Drawable d, XImage *image, int x, int y,\n    unsigned long mask) {\n\n\tADJUST_ROOTSHIFT\n\n\t/* Note: the Solaris overlay stuff is all non-shm (using_shm = 0) */\n\n#if HAVE_XSHM\n#if HAVE_LIBXCOMPOSITE\n\tif(use_xcomposite && subwin && !rootshift) {\n\t  XErrorHandler old_handler = XSetErrorHandler(trap_xerror);\n\t  Pixmap pixmap = XCompositeNameWindowPixmap(disp, d);\n\t  Status s = XShmGetImage(disp, pixmap, image, x, y, mask);\n\t  XFreePixmap(dpy, pixmap);\n\t  XSetErrorHandler(old_handler);\n\t  if(!trapped_xerror)\n\t    return s;\n\t}\n#endif\n\t  return XShmGetImage(disp, d, image, x, y, mask); \n#else\n\tif (!disp || !d || !image || !x || !y || !mask) {}\n\treturn (Status) 0;\n#endif\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [
      "#define ADJUST_ROOTSHIFT \\\n\tif (rootshift && subwin) { \\\n\t\td = rootwin; \\\n\t\tx += off_x; \\\n\t\ty += off_y; \\\n\t} \\\n\tif (clipshift) { \\\n\t\tx += coff_x; \\\n\t\ty += coff_y; \\\n\t}"
    ],
    "globals_used": [
      "int rootshift = 0;",
      "int XFlush_wr(Display *disp);",
      "Status XShmGetImage_wr(Display *disp, Drawable d, XImage *image, int x, int y,\n    unsigned long mask);",
      "Bool XShmQueryExtension_wr(Display *disp);",
      "int XShmGetEventBase_wr(Display *disp);",
      "void XTestDiscard_wr(Display *dpy);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "XShmGetImage",
          "args": [
            "disp",
            "d",
            "image",
            "x",
            "y",
            "mask"
          ],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "XShmGetImage_wr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "187-211",
          "snippet": "Status XShmGetImage_wr(Display *disp, Drawable d, XImage *image, int x, int y,\n    unsigned long mask) {\n\n\tADJUST_ROOTSHIFT\n\n\t/* Note: the Solaris overlay stuff is all non-shm (using_shm = 0) */\n\n#if HAVE_XSHM\n#if HAVE_LIBXCOMPOSITE\n\tif(use_xcomposite && subwin && !rootshift) {\n\t  XErrorHandler old_handler = XSetErrorHandler(trap_xerror);\n\t  Pixmap pixmap = XCompositeNameWindowPixmap(disp, d);\n\t  Status s = XShmGetImage(disp, pixmap, image, x, y, mask);\n\t  XFreePixmap(dpy, pixmap);\n\t  XSetErrorHandler(old_handler);\n\t  if(!trapped_xerror)\n\t    return s;\n\t}\n#endif\n\t  return XShmGetImage(disp, d, image, x, y, mask); \n#else\n\tif (!disp || !d || !image || !x || !y || !mask) {}\n\treturn (Status) 0;\n#endif\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "XSetErrorHandler",
          "args": [
            "old_handler"
          ],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "XSetErrorHandler",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/nox11_funcs.h",
          "lines": "2819-2821",
          "snippet": "XErrorHandler XSetErrorHandler (XErrorHandler h) {\n\treturn h;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "XErrorHandler XSetErrorHandler (XErrorHandler h) {\n\treturn h;\n}"
        }
      },
      {
        "call_info": {
          "callee": "XFreePixmap",
          "args": [
            "dpy",
            "pixmap"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XCompositeNameWindowPixmap",
          "args": [
            "disp",
            "d"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\n#define ADJUST_ROOTSHIFT \\\n\tif (rootshift && subwin) { \\\n\t\td = rootwin; \\\n\t\tx += off_x; \\\n\t\ty += off_y; \\\n\t} \\\n\tif (clipshift) { \\\n\t\tx += coff_x; \\\n\t\ty += coff_y; \\\n\t}\n\nint rootshift = 0;\nint XFlush_wr(Display *disp);\nStatus XShmGetImage_wr(Display *disp, Drawable d, XImage *image, int x, int y,\n    unsigned long mask);\nBool XShmQueryExtension_wr(Display *disp);\nint XShmGetEventBase_wr(Display *disp);\nvoid XTestDiscard_wr(Display *dpy);\n\nStatus XShmGetImage_wr(Display *disp, Drawable d, XImage *image, int x, int y,\n    unsigned long mask) {\n\n\tADJUST_ROOTSHIFT\n\n\t/* Note: the Solaris overlay stuff is all non-shm (using_shm = 0) */\n\n#if HAVE_XSHM\n#if HAVE_LIBXCOMPOSITE\n\tif(use_xcomposite && subwin && !rootshift) {\n\t  XErrorHandler old_handler = XSetErrorHandler(trap_xerror);\n\t  Pixmap pixmap = XCompositeNameWindowPixmap(disp, d);\n\t  Status s = XShmGetImage(disp, pixmap, image, x, y, mask);\n\t  XFreePixmap(dpy, pixmap);\n\t  XSetErrorHandler(old_handler);\n\t  if(!trapped_xerror)\n\t    return s;\n\t}\n#endif\n\t  return XShmGetImage(disp, d, image, x, y, mask); \n#else\n\tif (!disp || !d || !image || !x || !y || !mask) {}\n\treturn (Status) 0;\n#endif\n}"
  },
  {
    "function_name": "XFlush_wr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "154-165",
    "snippet": "int XFlush_wr(Display *disp) {\n#if NO_X11\n\tif (!disp) {}\n\treturn 1;\n#else\n\tif (disp) {\n\t\treturn XFlush(disp);\n\t} else {\n\t\treturn 1;\n\t}\n#endif\t/* NO_X11 */\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int XFlush_wr(Display *disp);",
      "Bool XShmQueryExtension_wr(Display *disp);",
      "int XShmGetEventBase_wr(Display *disp);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "XFlush",
          "args": [
            "disp"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "XFlush_wr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
          "lines": "154-165",
          "snippet": "int XFlush_wr(Display *disp) {\n#if NO_X11\n\tif (!disp) {}\n\treturn 1;\n#else\n\tif (disp) {\n\t\treturn XFlush(disp);\n\t} else {\n\t\treturn 1;\n\t}\n#endif\t/* NO_X11 */\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint XFlush_wr(Display *disp);\nBool XShmQueryExtension_wr(Display *disp);\nint XShmGetEventBase_wr(Display *disp);\n\nint XFlush_wr(Display *disp) {\n#if NO_X11\n\tif (!disp) {}\n\treturn 1;\n#else\n\tif (disp) {\n\t\treturn XFlush(disp);\n\t} else {\n\t\treturn 1;\n\t}\n#endif\t/* NO_X11 */\n}"
  },
  {
    "function_name": "guess_bits_per_color",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/xwrappers.c",
    "lines": "134-152",
    "snippet": "int guess_bits_per_color(int bits_per_pixel) {\n\tint bits_per_color;\n\t\n\t/* first guess, spread them \"evenly\" over R, G, and B */\n\tbits_per_color = bits_per_pixel/3;\n\tif (bits_per_color < 1) {\n\t\tbits_per_color = 1;\t/* 1bpp, 2bpp... */\n\t}\n\n\t/* choose safe values for usual cases: */\n\tif (bits_per_pixel == 8) {\n\t\tbits_per_color = 2;\n\t} else if (bits_per_pixel == 15 || bits_per_pixel == 16) {\n\t\tbits_per_color = 5;\n\t} else if (bits_per_pixel == 24 || bits_per_pixel == 32) {\n\t\tbits_per_color = 8;\n\t}\n\treturn bits_per_color;\n}",
    "includes": [
      "#include \"nox11_funcs.h\"",
      "#include \"xwrappers.h\"",
      "#include \"xi2_devices.h\"",
      "#include \"macosx.h\"",
      "#include \"cleanup.h\"",
      "#include \"connections.h\"",
      "#include \"xevents.h\"",
      "#include \"keyboard.h\"",
      "#include \"xrecord.h\"",
      "#include \"x11vnc.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "int guess_bits_per_color(int bits_per_pixel);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"nox11_funcs.h\"\n#include \"xwrappers.h\"\n#include \"xi2_devices.h\"\n#include \"macosx.h\"\n#include \"cleanup.h\"\n#include \"connections.h\"\n#include \"xevents.h\"\n#include \"keyboard.h\"\n#include \"xrecord.h\"\n#include \"x11vnc.h\"\n\nint guess_bits_per_color(int bits_per_pixel);\n\nint guess_bits_per_color(int bits_per_pixel) {\n\tint bits_per_color;\n\t\n\t/* first guess, spread them \"evenly\" over R, G, and B */\n\tbits_per_color = bits_per_pixel/3;\n\tif (bits_per_color < 1) {\n\t\tbits_per_color = 1;\t/* 1bpp, 2bpp... */\n\t}\n\n\t/* choose safe values for usual cases: */\n\tif (bits_per_pixel == 8) {\n\t\tbits_per_color = 2;\n\t} else if (bits_per_pixel == 15 || bits_per_pixel == 16) {\n\t\tbits_per_color = 5;\n\t} else if (bits_per_pixel == 24 || bits_per_pixel == 32) {\n\t\tbits_per_color = 8;\n\t}\n\treturn bits_per_color;\n}"
  }
]