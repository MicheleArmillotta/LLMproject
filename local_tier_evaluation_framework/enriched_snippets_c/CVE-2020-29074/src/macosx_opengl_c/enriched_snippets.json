[
  {
    "function_name": "macosx_copy_opengl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/macosx_opengl.c",
    "lines": "140-171",
    "snippet": "void macosx_copy_opengl(char *dest, int x, int y, unsigned int w, unsigned int h) {\n\tint yflip = macosx_opengl_height - y - h; \n\n\tCGLSetCurrentContext(glContextObj);\n\n\tglReadPixels((GLint) x, (GLint) yflip, (int) w, (int) h,\n\t    GL_BGRA, GL_UNSIGNED_INT_8_8_8_8_REV, dest);\n\n\tif (h > 1) {\n\t\tstatic char *pbuf = NULL;\n\t\tstatic int buflen = 0;\n\t\tint top = 0, bot = h - 1, rowlen = w * macosx_opengl_bpp/8;\n\t\tchar *ptop, *pbot;\n\n\t\tif (rowlen > buflen || buflen == 0)  {\n\t\t\tbuflen = rowlen + 128;\n\t\t\tif (pbuf) {\n\t\t\t\tfree(pbuf);\n\t\t\t}\n\t\t\tpbuf = (char *) malloc(buflen);\n\t\t}\n\t\twhile (top < bot) {\n\t\t\tptop = dest + top * rowlen;\n\t\t\tpbot = dest + bot * rowlen;\n\t\t\tmemcpy(pbuf, ptop, rowlen);\n\t\t\tmemcpy(ptop, pbot, rowlen);\n\t\t\tmemcpy(pbot, pbuf, rowlen);\n\t\t\ttop++;\n\t\t\tbot--;\n\t\t}\n\t}\n}",
    "includes": [
      "#include <OpenGL/gl.h>",
      "#include <OpenGL/OpenGL.h>",
      "#include <rfb/rfb.h>",
      "#include \"config.h\"",
      "#include <ApplicationServices/ApplicationServices.h>",
      "#include <CoreFoundation/CoreFoundation.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "pbot",
            "pbuf",
            "rowlen"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ptop",
            "pbot",
            "rowlen"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "pbuf",
            "ptop",
            "rowlen"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "buflen"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "pbuf"
          ],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "free_rect",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/userinput.c",
          "lines": "6200-6247",
          "snippet": "int free_rect(int idx) {\n\tint n, ok = 0;\n\tsraRegionPtr r1, r2;\n\tint x, y, w, h;\n\n\tif (idx < 0 || idx >= cache_list_num) {\nif (0) fprintf(stderr, \"free_rect: bad index: %d\\n\", idx);\n\t\tclean_up_exit(1);\n\t}\n\n\tx = cache_list[idx].bs_x;\n\ty = cache_list[idx].bs_y;\n\tw = cache_list[idx].bs_w;\n\th = cache_list[idx].bs_h;\n\n\tif (x < 0) {\n\t\tCLEAR(idx);\nif (dnow() > last_client + 5 && ncdb) fprintf(stderr, \"free_rect: already bs_x invalidated: %d bs_x: %d\\n\", idx, x);\n\t\treturn 1;\n\t}\n\n\tr2 = sraRgnCreateRect(x, y, x+w, y+h);\n\n\tn = get_bs_n(y);\n\tif (n >= 0) {\n\t\tr1 = rect_reg[n];\n\t\tsraRgnOr(r1, r2);\n\t\tok = 1;\n\t}\n\n\tif (zero_rects) {\n\t\tsraRgnOr(zero_rects, r2);\n\t\tx = cache_list[idx].su_x;\n\t\ty = cache_list[idx].su_y;\n\t\tw = cache_list[idx].su_w;\n\t\th = cache_list[idx].su_h;\n\t\tif (x >= 0) {\n\t\t\tsraRgnDestroy(r2);\n\t\t\tr2 = sraRgnCreateRect(x, y, x+w, y+h);\n\t\t\tsraRgnOr(zero_rects, r2);\n\t\t}\n\t}\n\tsraRgnDestroy(r2);\n\n\tCLEAR(idx);\nif (! ok && ncdb) fprintf(stderr, \"**** free_rect: not-found %d\\n\", idx);\n\treturn ok;\n}",
          "includes": [
            "#include \"default8x16.h\"",
            "#include \"connections.h\"",
            "#include \"screen.h\"",
            "#include \"cursor.h\"",
            "#include \"macosxCGS.h\"",
            "#include \"macosx.h\"",
            "#include \"unixpw.h\"",
            "#include \"8to24.h\"",
            "#include \"xrandr.h\"",
            "#include \"solid.h\"",
            "#include \"keyboard.h\"",
            "#include \"rates.h\"",
            "#include \"pointer.h\"",
            "#include \"cleanup.h\"",
            "#include \"scan.h\"",
            "#include \"user.h\"",
            "#include \"xevents.h\"",
            "#include \"win_utils.h\"",
            "#include \"xinerama.h\"",
            "#include \"xrecord.h\"",
            "#include \"xdamage.h\"",
            "#include \"xwrappers.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "void mark_for_xdamage(int x, int y, int w, int h);",
            "void set_xdamage_mark(int x, int y, int w, int h);",
            "int find_rect(int idx, int x, int y, int w, int h);",
            "winattr_t *cache_list;",
            "int clipped(int idx);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"default8x16.h\"\n#include \"connections.h\"\n#include \"screen.h\"\n#include \"cursor.h\"\n#include \"macosxCGS.h\"\n#include \"macosx.h\"\n#include \"unixpw.h\"\n#include \"8to24.h\"\n#include \"xrandr.h\"\n#include \"solid.h\"\n#include \"keyboard.h\"\n#include \"rates.h\"\n#include \"pointer.h\"\n#include \"cleanup.h\"\n#include \"scan.h\"\n#include \"user.h\"\n#include \"xevents.h\"\n#include \"win_utils.h\"\n#include \"xinerama.h\"\n#include \"xrecord.h\"\n#include \"xdamage.h\"\n#include \"xwrappers.h\"\n#include \"x11vnc.h\"\n\nvoid mark_for_xdamage(int x, int y, int w, int h);\nvoid set_xdamage_mark(int x, int y, int w, int h);\nint find_rect(int idx, int x, int y, int w, int h);\nwinattr_t *cache_list;\nint clipped(int idx);\n\nint free_rect(int idx) {\n\tint n, ok = 0;\n\tsraRegionPtr r1, r2;\n\tint x, y, w, h;\n\n\tif (idx < 0 || idx >= cache_list_num) {\nif (0) fprintf(stderr, \"free_rect: bad index: %d\\n\", idx);\n\t\tclean_up_exit(1);\n\t}\n\n\tx = cache_list[idx].bs_x;\n\ty = cache_list[idx].bs_y;\n\tw = cache_list[idx].bs_w;\n\th = cache_list[idx].bs_h;\n\n\tif (x < 0) {\n\t\tCLEAR(idx);\nif (dnow() > last_client + 5 && ncdb) fprintf(stderr, \"free_rect: already bs_x invalidated: %d bs_x: %d\\n\", idx, x);\n\t\treturn 1;\n\t}\n\n\tr2 = sraRgnCreateRect(x, y, x+w, y+h);\n\n\tn = get_bs_n(y);\n\tif (n >= 0) {\n\t\tr1 = rect_reg[n];\n\t\tsraRgnOr(r1, r2);\n\t\tok = 1;\n\t}\n\n\tif (zero_rects) {\n\t\tsraRgnOr(zero_rects, r2);\n\t\tx = cache_list[idx].su_x;\n\t\ty = cache_list[idx].su_y;\n\t\tw = cache_list[idx].su_w;\n\t\th = cache_list[idx].su_h;\n\t\tif (x >= 0) {\n\t\t\tsraRgnDestroy(r2);\n\t\t\tr2 = sraRgnCreateRect(x, y, x+w, y+h);\n\t\t\tsraRgnOr(zero_rects, r2);\n\t\t}\n\t}\n\tsraRgnDestroy(r2);\n\n\tCLEAR(idx);\nif (! ok && ncdb) fprintf(stderr, \"**** free_rect: not-found %d\\n\", idx);\n\treturn ok;\n}"
        }
      },
      {
        "call_info": {
          "callee": "glReadPixels",
          "args": [
            "(GLint) x",
            "(GLint) yflip",
            "(int) w",
            "(int) h",
            "GL_BGRA",
            "GL_UNSIGNED_INT_8_8_8_8_REV",
            "dest"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CGLSetCurrentContext",
          "args": [
            "glContextObj"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <OpenGL/gl.h>\n#include <OpenGL/OpenGL.h>\n#include <rfb/rfb.h>\n#include \"config.h\"\n#include <ApplicationServices/ApplicationServices.h>\n#include <CoreFoundation/CoreFoundation.h>\n\nvoid macosx_copy_opengl(char *dest, int x, int y, unsigned int w, unsigned int h) {\n\tint yflip = macosx_opengl_height - y - h; \n\n\tCGLSetCurrentContext(glContextObj);\n\n\tglReadPixels((GLint) x, (GLint) yflip, (int) w, (int) h,\n\t    GL_BGRA, GL_UNSIGNED_INT_8_8_8_8_REV, dest);\n\n\tif (h > 1) {\n\t\tstatic char *pbuf = NULL;\n\t\tstatic int buflen = 0;\n\t\tint top = 0, bot = h - 1, rowlen = w * macosx_opengl_bpp/8;\n\t\tchar *ptop, *pbot;\n\n\t\tif (rowlen > buflen || buflen == 0)  {\n\t\t\tbuflen = rowlen + 128;\n\t\t\tif (pbuf) {\n\t\t\t\tfree(pbuf);\n\t\t\t}\n\t\t\tpbuf = (char *) malloc(buflen);\n\t\t}\n\t\twhile (top < bot) {\n\t\t\tptop = dest + top * rowlen;\n\t\t\tpbot = dest + bot * rowlen;\n\t\t\tmemcpy(pbuf, ptop, rowlen);\n\t\t\tmemcpy(ptop, pbot, rowlen);\n\t\t\tmemcpy(pbot, pbuf, rowlen);\n\t\t\ttop++;\n\t\t\tbot--;\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "macosx_opengl_fini",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/macosx_opengl.c",
    "lines": "131-138",
    "snippet": "void macosx_opengl_fini(void) {\n\tif (!macosx_read_opengl) {\n\t\treturn;\n\t}\n\tCGLSetCurrentContext(NULL);\n\tCGLClearDrawable(glContextObj);\n\tCGLDestroyContext(glContextObj);\n}",
    "includes": [
      "#include <OpenGL/gl.h>",
      "#include <OpenGL/OpenGL.h>",
      "#include <rfb/rfb.h>",
      "#include \"config.h\"",
      "#include <ApplicationServices/ApplicationServices.h>",
      "#include <CoreFoundation/CoreFoundation.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CGLDestroyContext",
          "args": [
            "glContextObj"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CGLClearDrawable",
          "args": [
            "glContextObj"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CGLSetCurrentContext",
          "args": [
            "NULL"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <OpenGL/gl.h>\n#include <OpenGL/OpenGL.h>\n#include <rfb/rfb.h>\n#include \"config.h\"\n#include <ApplicationServices/ApplicationServices.h>\n#include <CoreFoundation/CoreFoundation.h>\n\nvoid macosx_opengl_fini(void) {\n\tif (!macosx_read_opengl) {\n\t\treturn;\n\t}\n\tCGLSetCurrentContext(NULL);\n\tCGLClearDrawable(glContextObj);\n\tCGLDestroyContext(glContextObj);\n}"
  },
  {
    "function_name": "macosx_opengl_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/macosx_opengl.c",
    "lines": "82-129",
    "snippet": "void macosx_opengl_init(void) {\n\tCGLPixelFormatObj pixelFormatObj;\n\tGLint numPixelFormats;\n\tCGLPixelFormatAttribute attribs[] = {\n\t\tkCGLPFAFullScreen,\n\t\tkCGLPFADisplayMask,\n\t\t0,\n\t\t0\n\t};\n\n\tif (macosx_no_opengl) {\n\t\treturn;\n\t}\n\n\tattribs[2] = CGDisplayIDToOpenGLDisplayMask(displayID);\n\n\tCGLChoosePixelFormat(attribs, &pixelFormatObj, &numPixelFormats);\n\tif (pixelFormatObj == NULL) {\n\t\trfbLog(\"macosx_opengl_init: CGLChoosePixelFormat failed. Not using OpenGL.\\n\");\n\t\treturn;\n\t}\n\n\tCGLCreateContext(pixelFormatObj, NULL, &glContextObj);\n\tCGLDestroyPixelFormat(pixelFormatObj);\n\n\tif (glContextObj == NULL) {\n\t\trfbLog(\"macosx_opengl_init: CGLCreateContext failed. Not using OpenGL.\\n\");\n\t\treturn;\n\t}\n\n\tCGLSetCurrentContext(glContextObj);\n\tCGLSetFullScreen(glContextObj);\n\n\tmacosx_opengl_width  = macosx_opengl_get_width();\n\tmacosx_opengl_height = macosx_opengl_get_height();\n\n\tmacosx_opengl_bpp = macosx_opengl_get_bpp();\n\n\tglFinish();\n\n\tglPixelStorei(GL_PACK_ALIGNMENT, 4);\n\tglPixelStorei(GL_PACK_ROW_LENGTH, 0);\n\tglPixelStorei(GL_PACK_SKIP_ROWS, 0);\n\tglPixelStorei(GL_PACK_SKIP_PIXELS, 0);\n\n\trfbLog(\"macosx_opengl_init: Using OpenGL for screen capture.\\n\");\n\tmacosx_read_opengl = 1;\n}",
    "includes": [
      "#include <OpenGL/gl.h>",
      "#include <OpenGL/OpenGL.h>",
      "#include <rfb/rfb.h>",
      "#include \"config.h\"",
      "#include <ApplicationServices/ApplicationServices.h>",
      "#include <CoreFoundation/CoreFoundation.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rfbLog",
          "args": [
            "\"macosx_opengl_init: Using OpenGL for screen capture.\\n\""
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "glPixelStorei",
          "args": [
            "GL_PACK_SKIP_PIXELS",
            "0"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "glPixelStorei",
          "args": [
            "GL_PACK_SKIP_ROWS",
            "0"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "glPixelStorei",
          "args": [
            "GL_PACK_ROW_LENGTH",
            "0"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "glPixelStorei",
          "args": [
            "GL_PACK_ALIGNMENT",
            "4"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "glFinish",
          "args": [],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "macosx_opengl_get_bpp",
          "args": [],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "macosx_opengl_get_bpp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/macosx_opengl.c",
          "lines": "70-72",
          "snippet": "int macosx_opengl_get_bpp(void) {\n\treturn 32;\n}",
          "includes": [
            "#include <OpenGL/gl.h>",
            "#include <OpenGL/OpenGL.h>",
            "#include <rfb/rfb.h>",
            "#include \"config.h\"",
            "#include <ApplicationServices/ApplicationServices.h>",
            "#include <CoreFoundation/CoreFoundation.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <OpenGL/gl.h>\n#include <OpenGL/OpenGL.h>\n#include <rfb/rfb.h>\n#include \"config.h\"\n#include <ApplicationServices/ApplicationServices.h>\n#include <CoreFoundation/CoreFoundation.h>\n\nint macosx_opengl_get_bpp(void) {\n\treturn 32;\n}"
        }
      },
      {
        "call_info": {
          "callee": "macosx_opengl_get_height",
          "args": [],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "macosx_opengl_get_height",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/macosx_opengl.c",
          "lines": "63-68",
          "snippet": "int macosx_opengl_get_height(void) {\n\tGLint viewport[4];\n\n\tglGetIntegerv(GL_VIEWPORT, viewport);\n\treturn (int) viewport[3];\n}",
          "includes": [
            "#include <OpenGL/gl.h>",
            "#include <OpenGL/OpenGL.h>",
            "#include <rfb/rfb.h>",
            "#include \"config.h\"",
            "#include <ApplicationServices/ApplicationServices.h>",
            "#include <CoreFoundation/CoreFoundation.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <OpenGL/gl.h>\n#include <OpenGL/OpenGL.h>\n#include <rfb/rfb.h>\n#include \"config.h\"\n#include <ApplicationServices/ApplicationServices.h>\n#include <CoreFoundation/CoreFoundation.h>\n\nint macosx_opengl_get_height(void) {\n\tGLint viewport[4];\n\n\tglGetIntegerv(GL_VIEWPORT, viewport);\n\treturn (int) viewport[3];\n}"
        }
      },
      {
        "call_info": {
          "callee": "macosx_opengl_get_width",
          "args": [],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "macosx_opengl_get_width",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/macosx_opengl.c",
          "lines": "56-61",
          "snippet": "int macosx_opengl_get_width(void) {\n\tGLint viewport[4];\n\n\tglGetIntegerv(GL_VIEWPORT, viewport);\n\treturn (int) viewport[2];\n}",
          "includes": [
            "#include <OpenGL/gl.h>",
            "#include <OpenGL/OpenGL.h>",
            "#include <rfb/rfb.h>",
            "#include \"config.h\"",
            "#include <ApplicationServices/ApplicationServices.h>",
            "#include <CoreFoundation/CoreFoundation.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <OpenGL/gl.h>\n#include <OpenGL/OpenGL.h>\n#include <rfb/rfb.h>\n#include \"config.h\"\n#include <ApplicationServices/ApplicationServices.h>\n#include <CoreFoundation/CoreFoundation.h>\n\nint macosx_opengl_get_width(void) {\n\tGLint viewport[4];\n\n\tglGetIntegerv(GL_VIEWPORT, viewport);\n\treturn (int) viewport[2];\n}"
        }
      },
      {
        "call_info": {
          "callee": "CGLSetFullScreen",
          "args": [
            "glContextObj"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CGLSetCurrentContext",
          "args": [
            "glContextObj"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rfbLog",
          "args": [
            "\"macosx_opengl_init: CGLCreateContext failed. Not using OpenGL.\\n\""
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CGLDestroyPixelFormat",
          "args": [
            "pixelFormatObj"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CGLCreateContext",
          "args": [
            "pixelFormatObj",
            "NULL",
            "&glContextObj"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rfbLog",
          "args": [
            "\"macosx_opengl_init: CGLChoosePixelFormat failed. Not using OpenGL.\\n\""
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CGLChoosePixelFormat",
          "args": [
            "attribs",
            "&pixelFormatObj",
            "&numPixelFormats"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CGDisplayIDToOpenGLDisplayMask",
          "args": [
            "displayID"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <OpenGL/gl.h>\n#include <OpenGL/OpenGL.h>\n#include <rfb/rfb.h>\n#include \"config.h\"\n#include <ApplicationServices/ApplicationServices.h>\n#include <CoreFoundation/CoreFoundation.h>\n\nvoid macosx_opengl_init(void) {\n\tCGLPixelFormatObj pixelFormatObj;\n\tGLint numPixelFormats;\n\tCGLPixelFormatAttribute attribs[] = {\n\t\tkCGLPFAFullScreen,\n\t\tkCGLPFADisplayMask,\n\t\t0,\n\t\t0\n\t};\n\n\tif (macosx_no_opengl) {\n\t\treturn;\n\t}\n\n\tattribs[2] = CGDisplayIDToOpenGLDisplayMask(displayID);\n\n\tCGLChoosePixelFormat(attribs, &pixelFormatObj, &numPixelFormats);\n\tif (pixelFormatObj == NULL) {\n\t\trfbLog(\"macosx_opengl_init: CGLChoosePixelFormat failed. Not using OpenGL.\\n\");\n\t\treturn;\n\t}\n\n\tCGLCreateContext(pixelFormatObj, NULL, &glContextObj);\n\tCGLDestroyPixelFormat(pixelFormatObj);\n\n\tif (glContextObj == NULL) {\n\t\trfbLog(\"macosx_opengl_init: CGLCreateContext failed. Not using OpenGL.\\n\");\n\t\treturn;\n\t}\n\n\tCGLSetCurrentContext(glContextObj);\n\tCGLSetFullScreen(glContextObj);\n\n\tmacosx_opengl_width  = macosx_opengl_get_width();\n\tmacosx_opengl_height = macosx_opengl_get_height();\n\n\tmacosx_opengl_bpp = macosx_opengl_get_bpp();\n\n\tglFinish();\n\n\tglPixelStorei(GL_PACK_ALIGNMENT, 4);\n\tglPixelStorei(GL_PACK_ROW_LENGTH, 0);\n\tglPixelStorei(GL_PACK_SKIP_ROWS, 0);\n\tglPixelStorei(GL_PACK_SKIP_PIXELS, 0);\n\n\trfbLog(\"macosx_opengl_init: Using OpenGL for screen capture.\\n\");\n\tmacosx_read_opengl = 1;\n}"
  },
  {
    "function_name": "macosx_opengl_get_spp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/macosx_opengl.c",
    "lines": "78-80",
    "snippet": "int macosx_opengl_get_spp(void) {\n\treturn 3;\n}",
    "includes": [
      "#include <OpenGL/gl.h>",
      "#include <OpenGL/OpenGL.h>",
      "#include <rfb/rfb.h>",
      "#include \"config.h\"",
      "#include <ApplicationServices/ApplicationServices.h>",
      "#include <CoreFoundation/CoreFoundation.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <OpenGL/gl.h>\n#include <OpenGL/OpenGL.h>\n#include <rfb/rfb.h>\n#include \"config.h\"\n#include <ApplicationServices/ApplicationServices.h>\n#include <CoreFoundation/CoreFoundation.h>\n\nint macosx_opengl_get_spp(void) {\n\treturn 3;\n}"
  },
  {
    "function_name": "macosx_opengl_get_bps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/macosx_opengl.c",
    "lines": "74-76",
    "snippet": "int macosx_opengl_get_bps(void) {\n\treturn 8;\n}",
    "includes": [
      "#include <OpenGL/gl.h>",
      "#include <OpenGL/OpenGL.h>",
      "#include <rfb/rfb.h>",
      "#include \"config.h\"",
      "#include <ApplicationServices/ApplicationServices.h>",
      "#include <CoreFoundation/CoreFoundation.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <OpenGL/gl.h>\n#include <OpenGL/OpenGL.h>\n#include <rfb/rfb.h>\n#include \"config.h\"\n#include <ApplicationServices/ApplicationServices.h>\n#include <CoreFoundation/CoreFoundation.h>\n\nint macosx_opengl_get_bps(void) {\n\treturn 8;\n}"
  },
  {
    "function_name": "macosx_opengl_get_bpp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/macosx_opengl.c",
    "lines": "70-72",
    "snippet": "int macosx_opengl_get_bpp(void) {\n\treturn 32;\n}",
    "includes": [
      "#include <OpenGL/gl.h>",
      "#include <OpenGL/OpenGL.h>",
      "#include <rfb/rfb.h>",
      "#include \"config.h\"",
      "#include <ApplicationServices/ApplicationServices.h>",
      "#include <CoreFoundation/CoreFoundation.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <OpenGL/gl.h>\n#include <OpenGL/OpenGL.h>\n#include <rfb/rfb.h>\n#include \"config.h\"\n#include <ApplicationServices/ApplicationServices.h>\n#include <CoreFoundation/CoreFoundation.h>\n\nint macosx_opengl_get_bpp(void) {\n\treturn 32;\n}"
  },
  {
    "function_name": "macosx_opengl_get_height",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/macosx_opengl.c",
    "lines": "63-68",
    "snippet": "int macosx_opengl_get_height(void) {\n\tGLint viewport[4];\n\n\tglGetIntegerv(GL_VIEWPORT, viewport);\n\treturn (int) viewport[3];\n}",
    "includes": [
      "#include <OpenGL/gl.h>",
      "#include <OpenGL/OpenGL.h>",
      "#include <rfb/rfb.h>",
      "#include \"config.h\"",
      "#include <ApplicationServices/ApplicationServices.h>",
      "#include <CoreFoundation/CoreFoundation.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "glGetIntegerv",
          "args": [
            "GL_VIEWPORT",
            "viewport"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <OpenGL/gl.h>\n#include <OpenGL/OpenGL.h>\n#include <rfb/rfb.h>\n#include \"config.h\"\n#include <ApplicationServices/ApplicationServices.h>\n#include <CoreFoundation/CoreFoundation.h>\n\nint macosx_opengl_get_height(void) {\n\tGLint viewport[4];\n\n\tglGetIntegerv(GL_VIEWPORT, viewport);\n\treturn (int) viewport[3];\n}"
  },
  {
    "function_name": "macosx_opengl_get_width",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/macosx_opengl.c",
    "lines": "56-61",
    "snippet": "int macosx_opengl_get_width(void) {\n\tGLint viewport[4];\n\n\tglGetIntegerv(GL_VIEWPORT, viewport);\n\treturn (int) viewport[2];\n}",
    "includes": [
      "#include <OpenGL/gl.h>",
      "#include <OpenGL/OpenGL.h>",
      "#include <rfb/rfb.h>",
      "#include \"config.h\"",
      "#include <ApplicationServices/ApplicationServices.h>",
      "#include <CoreFoundation/CoreFoundation.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "glGetIntegerv",
          "args": [
            "GL_VIEWPORT",
            "viewport"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <OpenGL/gl.h>\n#include <OpenGL/OpenGL.h>\n#include <rfb/rfb.h>\n#include \"config.h\"\n#include <ApplicationServices/ApplicationServices.h>\n#include <CoreFoundation/CoreFoundation.h>\n\nint macosx_opengl_get_width(void) {\n\tGLint viewport[4];\n\n\tglGetIntegerv(GL_VIEWPORT, viewport);\n\treturn (int) viewport[2];\n}"
  }
]