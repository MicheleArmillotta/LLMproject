[
  {
    "function_name": "macosxCGP_dim_shutdown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/macosxCGP.c",
    "lines": "202-217",
    "snippet": "int macosxCGP_dim_shutdown(void) {\n\tif (! initialized) {\n\t\treturn 0;\n\t}\n\tif (dim_time_saved) {\n\t\tif (! macosxCGP_restore_dim()) {\n\t\t\treturn 0;\n\t\t}\n\t}\n\tif (sleep_time_saved) {\n\t\tif (! macosxCGP_restore_sleep()) {\n\t\t\treturn 0;\n\t\t}\n\t}\n\treturn 1;\n}",
    "includes": [
      "#include <IOKit/pwr_mgt/IOPM.h>",
      "#include <IOKit/pwr_mgt/IOPMLib.h>",
      "#include <Carbon/Carbon.h>",
      "#include <Cocoa/Cocoa.h>",
      "#include <ApplicationServices/ApplicationServices.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "macosxCGP_restore_sleep",
          "args": [],
          "line": 212
        },
        "resolved": true,
        "details": {
          "function_name": "macosxCGP_restore_sleep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/macosxCGP.c",
          "lines": "127-138",
          "snippet": "int macosxCGP_restore_sleep(void) {\n\tif (! sleep_time_saved) {\n\t\treturn 0;\n\t}\n\tif (IOPMSetAggressiveness(power_mgt, kPMMinutesToSleep,\n\t    dim_time) != kIOReturnSuccess) {\n\t\treturn 0;\n\t}\n\tsleep_time_saved = 0;\n\tsleep_time = 0;\n\treturn 1;\n}",
          "includes": [
            "#include <IOKit/pwr_mgt/IOPM.h>",
            "#include <IOKit/pwr_mgt/IOPMLib.h>",
            "#include <Carbon/Carbon.h>",
            "#include <Cocoa/Cocoa.h>",
            "#include <ApplicationServices/ApplicationServices.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <IOKit/pwr_mgt/IOPM.h>\n#include <IOKit/pwr_mgt/IOPMLib.h>\n#include <Carbon/Carbon.h>\n#include <Cocoa/Cocoa.h>\n#include <ApplicationServices/ApplicationServices.h>\n\nint macosxCGP_restore_sleep(void) {\n\tif (! sleep_time_saved) {\n\t\treturn 0;\n\t}\n\tif (IOPMSetAggressiveness(power_mgt, kPMMinutesToSleep,\n\t    dim_time) != kIOReturnSuccess) {\n\t\treturn 0;\n\t}\n\tsleep_time_saved = 0;\n\tsleep_time = 0;\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "macosxCGP_restore_dim",
          "args": [],
          "line": 207
        },
        "resolved": true,
        "details": {
          "function_name": "macosxCGP_restore_dim",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/macosxCGP.c",
          "lines": "105-116",
          "snippet": "int macosxCGP_restore_dim(void) {\n\tif (! dim_time_saved) {\n\t\treturn 0;\n\t}\n\tif (IOPMSetAggressiveness(power_mgt, kPMMinutesToDim,\n\t    dim_time) != kIOReturnSuccess) {\n\t\treturn 0;\n\t}\n\tdim_time_saved = 0;\n\tdim_time = 0;\n\treturn 1;\n}",
          "includes": [
            "#include <IOKit/pwr_mgt/IOPM.h>",
            "#include <IOKit/pwr_mgt/IOPMLib.h>",
            "#include <Carbon/Carbon.h>",
            "#include <Cocoa/Cocoa.h>",
            "#include <ApplicationServices/ApplicationServices.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <IOKit/pwr_mgt/IOPM.h>\n#include <IOKit/pwr_mgt/IOPMLib.h>\n#include <Carbon/Carbon.h>\n#include <Cocoa/Cocoa.h>\n#include <ApplicationServices/ApplicationServices.h>\n\nint macosxCGP_restore_dim(void) {\n\tif (! dim_time_saved) {\n\t\treturn 0;\n\t}\n\tif (IOPMSetAggressiveness(power_mgt, kPMMinutesToDim,\n\t    dim_time) != kIOReturnSuccess) {\n\t\treturn 0;\n\t}\n\tdim_time_saved = 0;\n\tdim_time = 0;\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <IOKit/pwr_mgt/IOPM.h>\n#include <IOKit/pwr_mgt/IOPMLib.h>\n#include <Carbon/Carbon.h>\n#include <Cocoa/Cocoa.h>\n#include <ApplicationServices/ApplicationServices.h>\n\nint macosxCGP_dim_shutdown(void) {\n\tif (! initialized) {\n\t\treturn 0;\n\t}\n\tif (dim_time_saved) {\n\t\tif (! macosxCGP_restore_dim()) {\n\t\t\treturn 0;\n\t\t}\n\t}\n\tif (sleep_time_saved) {\n\t\tif (! macosxCGP_restore_sleep()) {\n\t\t\treturn 0;\n\t\t}\n\t}\n\treturn 1;\n}"
  },
  {
    "function_name": "macosxCGP_undim",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/macosxCGP.c",
    "lines": "171-200",
    "snippet": "int macosxCGP_undim(void) {\n\tif (! initialized) {\n\t\treturn 0;\n\t}\n\tif (! macosx_nodimming) {\n\t\tif (! macosxCGP_save_dim()) {\n\t\t\treturn 0;\n\t\t}\n\t\tif (IOPMSetAggressiveness(power_mgt, kPMMinutesToDim, 0)\n\t\t    != kIOReturnSuccess) {\n\t\t\treturn 0;\n\t\t}\n\t\tif (! macosxCGP_restore_dim()) {\n\t\t\treturn 0;\n\t\t}\n\t}\n\tif (! macosx_nosleep) {\n\t\tif (! macosxCGP_save_sleep()) {\n\t\t\treturn 0;\n\t\t}\n\t\tif (IOPMSetAggressiveness(power_mgt, kPMMinutesToSleep, 0)\n\t\t    != kIOReturnSuccess) {\n\t\t\treturn 0;\n\t\t}\n\t\tif (! macosxCGP_restore_sleep()) {\n\t\t\treturn 0;\n\t\t}\n\t}\n\treturn 1;\n}",
    "includes": [
      "#include <IOKit/pwr_mgt/IOPM.h>",
      "#include <IOKit/pwr_mgt/IOPMLib.h>",
      "#include <Carbon/Carbon.h>",
      "#include <Cocoa/Cocoa.h>",
      "#include <ApplicationServices/ApplicationServices.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "macosxCGP_restore_sleep",
          "args": [],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "macosxCGP_restore_sleep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/macosxCGP.c",
          "lines": "127-138",
          "snippet": "int macosxCGP_restore_sleep(void) {\n\tif (! sleep_time_saved) {\n\t\treturn 0;\n\t}\n\tif (IOPMSetAggressiveness(power_mgt, kPMMinutesToSleep,\n\t    dim_time) != kIOReturnSuccess) {\n\t\treturn 0;\n\t}\n\tsleep_time_saved = 0;\n\tsleep_time = 0;\n\treturn 1;\n}",
          "includes": [
            "#include <IOKit/pwr_mgt/IOPM.h>",
            "#include <IOKit/pwr_mgt/IOPMLib.h>",
            "#include <Carbon/Carbon.h>",
            "#include <Cocoa/Cocoa.h>",
            "#include <ApplicationServices/ApplicationServices.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <IOKit/pwr_mgt/IOPM.h>\n#include <IOKit/pwr_mgt/IOPMLib.h>\n#include <Carbon/Carbon.h>\n#include <Cocoa/Cocoa.h>\n#include <ApplicationServices/ApplicationServices.h>\n\nint macosxCGP_restore_sleep(void) {\n\tif (! sleep_time_saved) {\n\t\treturn 0;\n\t}\n\tif (IOPMSetAggressiveness(power_mgt, kPMMinutesToSleep,\n\t    dim_time) != kIOReturnSuccess) {\n\t\treturn 0;\n\t}\n\tsleep_time_saved = 0;\n\tsleep_time = 0;\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IOPMSetAggressiveness",
          "args": [
            "power_mgt",
            "kPMMinutesToSleep",
            "0"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "macosxCGP_save_sleep",
          "args": [],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "macosxCGP_save_sleep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/macosxCGP.c",
          "lines": "118-125",
          "snippet": "int macosxCGP_save_sleep(void) {\n\tif (IOPMGetAggressiveness(power_mgt, kPMMinutesToSleep,\n\t    &sleep_time) != kIOReturnSuccess) {\n\t\treturn 0;\n\t}\n\tsleep_time_saved = 1;\n\treturn 1;\n}",
          "includes": [
            "#include <IOKit/pwr_mgt/IOPM.h>",
            "#include <IOKit/pwr_mgt/IOPMLib.h>",
            "#include <Carbon/Carbon.h>",
            "#include <Cocoa/Cocoa.h>",
            "#include <ApplicationServices/ApplicationServices.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <IOKit/pwr_mgt/IOPM.h>\n#include <IOKit/pwr_mgt/IOPMLib.h>\n#include <Carbon/Carbon.h>\n#include <Cocoa/Cocoa.h>\n#include <ApplicationServices/ApplicationServices.h>\n\nint macosxCGP_save_sleep(void) {\n\tif (IOPMGetAggressiveness(power_mgt, kPMMinutesToSleep,\n\t    &sleep_time) != kIOReturnSuccess) {\n\t\treturn 0;\n\t}\n\tsleep_time_saved = 1;\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "macosxCGP_restore_dim",
          "args": [],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "macosxCGP_restore_dim",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/macosxCGP.c",
          "lines": "105-116",
          "snippet": "int macosxCGP_restore_dim(void) {\n\tif (! dim_time_saved) {\n\t\treturn 0;\n\t}\n\tif (IOPMSetAggressiveness(power_mgt, kPMMinutesToDim,\n\t    dim_time) != kIOReturnSuccess) {\n\t\treturn 0;\n\t}\n\tdim_time_saved = 0;\n\tdim_time = 0;\n\treturn 1;\n}",
          "includes": [
            "#include <IOKit/pwr_mgt/IOPM.h>",
            "#include <IOKit/pwr_mgt/IOPMLib.h>",
            "#include <Carbon/Carbon.h>",
            "#include <Cocoa/Cocoa.h>",
            "#include <ApplicationServices/ApplicationServices.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <IOKit/pwr_mgt/IOPM.h>\n#include <IOKit/pwr_mgt/IOPMLib.h>\n#include <Carbon/Carbon.h>\n#include <Cocoa/Cocoa.h>\n#include <ApplicationServices/ApplicationServices.h>\n\nint macosxCGP_restore_dim(void) {\n\tif (! dim_time_saved) {\n\t\treturn 0;\n\t}\n\tif (IOPMSetAggressiveness(power_mgt, kPMMinutesToDim,\n\t    dim_time) != kIOReturnSuccess) {\n\t\treturn 0;\n\t}\n\tdim_time_saved = 0;\n\tdim_time = 0;\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IOPMSetAggressiveness",
          "args": [
            "power_mgt",
            "kPMMinutesToDim",
            "0"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "macosxCGP_save_dim",
          "args": [],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "macosxCGP_save_dim",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/macosxCGP.c",
          "lines": "96-103",
          "snippet": "int macosxCGP_save_dim(void) {\n\tif (IOPMGetAggressiveness(power_mgt, kPMMinutesToDim,\n\t    &dim_time) != kIOReturnSuccess) {\n\t\treturn 0;\n\t}\n\tdim_time_saved = 1;\n\treturn 1;\n}",
          "includes": [
            "#include <IOKit/pwr_mgt/IOPM.h>",
            "#include <IOKit/pwr_mgt/IOPMLib.h>",
            "#include <Carbon/Carbon.h>",
            "#include <Cocoa/Cocoa.h>",
            "#include <ApplicationServices/ApplicationServices.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <IOKit/pwr_mgt/IOPM.h>\n#include <IOKit/pwr_mgt/IOPMLib.h>\n#include <Carbon/Carbon.h>\n#include <Cocoa/Cocoa.h>\n#include <ApplicationServices/ApplicationServices.h>\n\nint macosxCGP_save_dim(void) {\n\tif (IOPMGetAggressiveness(power_mgt, kPMMinutesToDim,\n\t    &dim_time) != kIOReturnSuccess) {\n\t\treturn 0;\n\t}\n\tdim_time_saved = 1;\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <IOKit/pwr_mgt/IOPM.h>\n#include <IOKit/pwr_mgt/IOPMLib.h>\n#include <Carbon/Carbon.h>\n#include <Cocoa/Cocoa.h>\n#include <ApplicationServices/ApplicationServices.h>\n\nint macosxCGP_undim(void) {\n\tif (! initialized) {\n\t\treturn 0;\n\t}\n\tif (! macosx_nodimming) {\n\t\tif (! macosxCGP_save_dim()) {\n\t\t\treturn 0;\n\t\t}\n\t\tif (IOPMSetAggressiveness(power_mgt, kPMMinutesToDim, 0)\n\t\t    != kIOReturnSuccess) {\n\t\t\treturn 0;\n\t\t}\n\t\tif (! macosxCGP_restore_dim()) {\n\t\t\treturn 0;\n\t\t}\n\t}\n\tif (! macosx_nosleep) {\n\t\tif (! macosxCGP_save_sleep()) {\n\t\t\treturn 0;\n\t\t}\n\t\tif (IOPMSetAggressiveness(power_mgt, kPMMinutesToSleep, 0)\n\t\t    != kIOReturnSuccess) {\n\t\t\treturn 0;\n\t\t}\n\t\tif (! macosxCGP_restore_sleep()) {\n\t\t\treturn 0;\n\t\t}\n\t}\n\treturn 1;\n}"
  },
  {
    "function_name": "macosxCGP_init_dimming",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/macosxCGP.c",
    "lines": "140-169",
    "snippet": "int macosxCGP_init_dimming(void) {\n\tif (IOMasterPort(bootstrap_port, &master_dev_port) != \n\t    kIOReturnSuccess) {\n\t\treturn 0;\n\t}\n\tif (!(power_mgt = IOPMFindPowerManagement(master_dev_port))) {\n\t\treturn 0;\n\t}\n\tif (macosx_nodimming) {\n\t\tif (! macosxCGP_save_dim()) {\n\t\t\treturn 0;\n\t\t}\n\t\tif (IOPMSetAggressiveness(power_mgt, kPMMinutesToDim, 0)\n\t\t    != kIOReturnSuccess) {\n\t\t\treturn 0;\n\t\t}\n\t}\n\tif (macosx_nosleep) {\n\t\tif (! macosxCGP_save_sleep()) {\n\t\t\treturn 0;\n\t\t}\n\t\tif (IOPMSetAggressiveness(power_mgt, kPMMinutesToSleep, 0)\n\t\t    != kIOReturnSuccess) {\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\tinitialized = 1;\n\treturn 1;\n}",
    "includes": [
      "#include <IOKit/pwr_mgt/IOPM.h>",
      "#include <IOKit/pwr_mgt/IOPMLib.h>",
      "#include <Carbon/Carbon.h>",
      "#include <Cocoa/Cocoa.h>",
      "#include <ApplicationServices/ApplicationServices.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IOPMSetAggressiveness",
          "args": [
            "power_mgt",
            "kPMMinutesToSleep",
            "0"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "macosxCGP_save_sleep",
          "args": [],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "macosxCGP_save_sleep",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/macosxCGP.c",
          "lines": "118-125",
          "snippet": "int macosxCGP_save_sleep(void) {\n\tif (IOPMGetAggressiveness(power_mgt, kPMMinutesToSleep,\n\t    &sleep_time) != kIOReturnSuccess) {\n\t\treturn 0;\n\t}\n\tsleep_time_saved = 1;\n\treturn 1;\n}",
          "includes": [
            "#include <IOKit/pwr_mgt/IOPM.h>",
            "#include <IOKit/pwr_mgt/IOPMLib.h>",
            "#include <Carbon/Carbon.h>",
            "#include <Cocoa/Cocoa.h>",
            "#include <ApplicationServices/ApplicationServices.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <IOKit/pwr_mgt/IOPM.h>\n#include <IOKit/pwr_mgt/IOPMLib.h>\n#include <Carbon/Carbon.h>\n#include <Cocoa/Cocoa.h>\n#include <ApplicationServices/ApplicationServices.h>\n\nint macosxCGP_save_sleep(void) {\n\tif (IOPMGetAggressiveness(power_mgt, kPMMinutesToSleep,\n\t    &sleep_time) != kIOReturnSuccess) {\n\t\treturn 0;\n\t}\n\tsleep_time_saved = 1;\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IOPMSetAggressiveness",
          "args": [
            "power_mgt",
            "kPMMinutesToDim",
            "0"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "macosxCGP_save_dim",
          "args": [],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "macosxCGP_save_dim",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/macosxCGP.c",
          "lines": "96-103",
          "snippet": "int macosxCGP_save_dim(void) {\n\tif (IOPMGetAggressiveness(power_mgt, kPMMinutesToDim,\n\t    &dim_time) != kIOReturnSuccess) {\n\t\treturn 0;\n\t}\n\tdim_time_saved = 1;\n\treturn 1;\n}",
          "includes": [
            "#include <IOKit/pwr_mgt/IOPM.h>",
            "#include <IOKit/pwr_mgt/IOPMLib.h>",
            "#include <Carbon/Carbon.h>",
            "#include <Cocoa/Cocoa.h>",
            "#include <ApplicationServices/ApplicationServices.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <IOKit/pwr_mgt/IOPM.h>\n#include <IOKit/pwr_mgt/IOPMLib.h>\n#include <Carbon/Carbon.h>\n#include <Cocoa/Cocoa.h>\n#include <ApplicationServices/ApplicationServices.h>\n\nint macosxCGP_save_dim(void) {\n\tif (IOPMGetAggressiveness(power_mgt, kPMMinutesToDim,\n\t    &dim_time) != kIOReturnSuccess) {\n\t\treturn 0;\n\t}\n\tdim_time_saved = 1;\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IOPMFindPowerManagement",
          "args": [
            "master_dev_port"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IOMasterPort",
          "args": [
            "bootstrap_port",
            "&master_dev_port"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <IOKit/pwr_mgt/IOPM.h>\n#include <IOKit/pwr_mgt/IOPMLib.h>\n#include <Carbon/Carbon.h>\n#include <Cocoa/Cocoa.h>\n#include <ApplicationServices/ApplicationServices.h>\n\nint macosxCGP_init_dimming(void) {\n\tif (IOMasterPort(bootstrap_port, &master_dev_port) != \n\t    kIOReturnSuccess) {\n\t\treturn 0;\n\t}\n\tif (!(power_mgt = IOPMFindPowerManagement(master_dev_port))) {\n\t\treturn 0;\n\t}\n\tif (macosx_nodimming) {\n\t\tif (! macosxCGP_save_dim()) {\n\t\t\treturn 0;\n\t\t}\n\t\tif (IOPMSetAggressiveness(power_mgt, kPMMinutesToDim, 0)\n\t\t    != kIOReturnSuccess) {\n\t\t\treturn 0;\n\t\t}\n\t}\n\tif (macosx_nosleep) {\n\t\tif (! macosxCGP_save_sleep()) {\n\t\t\treturn 0;\n\t\t}\n\t\tif (IOPMSetAggressiveness(power_mgt, kPMMinutesToSleep, 0)\n\t\t    != kIOReturnSuccess) {\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\tinitialized = 1;\n\treturn 1;\n}"
  },
  {
    "function_name": "macosxCGP_restore_sleep",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/macosxCGP.c",
    "lines": "127-138",
    "snippet": "int macosxCGP_restore_sleep(void) {\n\tif (! sleep_time_saved) {\n\t\treturn 0;\n\t}\n\tif (IOPMSetAggressiveness(power_mgt, kPMMinutesToSleep,\n\t    dim_time) != kIOReturnSuccess) {\n\t\treturn 0;\n\t}\n\tsleep_time_saved = 0;\n\tsleep_time = 0;\n\treturn 1;\n}",
    "includes": [
      "#include <IOKit/pwr_mgt/IOPM.h>",
      "#include <IOKit/pwr_mgt/IOPMLib.h>",
      "#include <Carbon/Carbon.h>",
      "#include <Cocoa/Cocoa.h>",
      "#include <ApplicationServices/ApplicationServices.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IOPMSetAggressiveness",
          "args": [
            "power_mgt",
            "kPMMinutesToSleep",
            "dim_time"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <IOKit/pwr_mgt/IOPM.h>\n#include <IOKit/pwr_mgt/IOPMLib.h>\n#include <Carbon/Carbon.h>\n#include <Cocoa/Cocoa.h>\n#include <ApplicationServices/ApplicationServices.h>\n\nint macosxCGP_restore_sleep(void) {\n\tif (! sleep_time_saved) {\n\t\treturn 0;\n\t}\n\tif (IOPMSetAggressiveness(power_mgt, kPMMinutesToSleep,\n\t    dim_time) != kIOReturnSuccess) {\n\t\treturn 0;\n\t}\n\tsleep_time_saved = 0;\n\tsleep_time = 0;\n\treturn 1;\n}"
  },
  {
    "function_name": "macosxCGP_save_sleep",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/macosxCGP.c",
    "lines": "118-125",
    "snippet": "int macosxCGP_save_sleep(void) {\n\tif (IOPMGetAggressiveness(power_mgt, kPMMinutesToSleep,\n\t    &sleep_time) != kIOReturnSuccess) {\n\t\treturn 0;\n\t}\n\tsleep_time_saved = 1;\n\treturn 1;\n}",
    "includes": [
      "#include <IOKit/pwr_mgt/IOPM.h>",
      "#include <IOKit/pwr_mgt/IOPMLib.h>",
      "#include <Carbon/Carbon.h>",
      "#include <Cocoa/Cocoa.h>",
      "#include <ApplicationServices/ApplicationServices.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IOPMGetAggressiveness",
          "args": [
            "power_mgt",
            "kPMMinutesToSleep",
            "&sleep_time"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <IOKit/pwr_mgt/IOPM.h>\n#include <IOKit/pwr_mgt/IOPMLib.h>\n#include <Carbon/Carbon.h>\n#include <Cocoa/Cocoa.h>\n#include <ApplicationServices/ApplicationServices.h>\n\nint macosxCGP_save_sleep(void) {\n\tif (IOPMGetAggressiveness(power_mgt, kPMMinutesToSleep,\n\t    &sleep_time) != kIOReturnSuccess) {\n\t\treturn 0;\n\t}\n\tsleep_time_saved = 1;\n\treturn 1;\n}"
  },
  {
    "function_name": "macosxCGP_restore_dim",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/macosxCGP.c",
    "lines": "105-116",
    "snippet": "int macosxCGP_restore_dim(void) {\n\tif (! dim_time_saved) {\n\t\treturn 0;\n\t}\n\tif (IOPMSetAggressiveness(power_mgt, kPMMinutesToDim,\n\t    dim_time) != kIOReturnSuccess) {\n\t\treturn 0;\n\t}\n\tdim_time_saved = 0;\n\tdim_time = 0;\n\treturn 1;\n}",
    "includes": [
      "#include <IOKit/pwr_mgt/IOPM.h>",
      "#include <IOKit/pwr_mgt/IOPMLib.h>",
      "#include <Carbon/Carbon.h>",
      "#include <Cocoa/Cocoa.h>",
      "#include <ApplicationServices/ApplicationServices.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IOPMSetAggressiveness",
          "args": [
            "power_mgt",
            "kPMMinutesToDim",
            "dim_time"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <IOKit/pwr_mgt/IOPM.h>\n#include <IOKit/pwr_mgt/IOPMLib.h>\n#include <Carbon/Carbon.h>\n#include <Cocoa/Cocoa.h>\n#include <ApplicationServices/ApplicationServices.h>\n\nint macosxCGP_restore_dim(void) {\n\tif (! dim_time_saved) {\n\t\treturn 0;\n\t}\n\tif (IOPMSetAggressiveness(power_mgt, kPMMinutesToDim,\n\t    dim_time) != kIOReturnSuccess) {\n\t\treturn 0;\n\t}\n\tdim_time_saved = 0;\n\tdim_time = 0;\n\treturn 1;\n}"
  },
  {
    "function_name": "macosxCGP_save_dim",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/macosxCGP.c",
    "lines": "96-103",
    "snippet": "int macosxCGP_save_dim(void) {\n\tif (IOPMGetAggressiveness(power_mgt, kPMMinutesToDim,\n\t    &dim_time) != kIOReturnSuccess) {\n\t\treturn 0;\n\t}\n\tdim_time_saved = 1;\n\treturn 1;\n}",
    "includes": [
      "#include <IOKit/pwr_mgt/IOPM.h>",
      "#include <IOKit/pwr_mgt/IOPMLib.h>",
      "#include <Carbon/Carbon.h>",
      "#include <Cocoa/Cocoa.h>",
      "#include <ApplicationServices/ApplicationServices.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IOPMGetAggressiveness",
          "args": [
            "power_mgt",
            "kPMMinutesToDim",
            "&dim_time"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <IOKit/pwr_mgt/IOPM.h>\n#include <IOKit/pwr_mgt/IOPMLib.h>\n#include <Carbon/Carbon.h>\n#include <Cocoa/Cocoa.h>\n#include <ApplicationServices/ApplicationServices.h>\n\nint macosxCGP_save_dim(void) {\n\tif (IOPMGetAggressiveness(power_mgt, kPMMinutesToDim,\n\t    &dim_time) != kIOReturnSuccess) {\n\t\treturn 0;\n\t}\n\tdim_time_saved = 1;\n\treturn 1;\n}"
  },
  {
    "function_name": "macosxCGP_screensaver_timer_on",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/macosxCGP.c",
    "lines": "89-94",
    "snippet": "void macosxCGP_screensaver_timer_on(void) {\n\tif (0) fprintf(stderr, \"macosxCGP_screensaver_timer_on: %d\\n\", (int) time(0));\n\tsstimerUPP = NewEventLoopTimerUPP(macosxCG_screensaver_timer);\n\tInstallEventLoopTimer(GetMainEventLoop(), kEventDurationSecond * 30,\n\t    kEventDurationSecond * 30, sstimerUPP, NULL, &sstimer);\n}",
    "includes": [
      "#include <IOKit/pwr_mgt/IOPM.h>",
      "#include <IOKit/pwr_mgt/IOPMLib.h>",
      "#include <Carbon/Carbon.h>",
      "#include <Cocoa/Cocoa.h>",
      "#include <ApplicationServices/ApplicationServices.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "InstallEventLoopTimer",
          "args": [
            "GetMainEventLoop()",
            "kEventDurationSecond * 30",
            "kEventDurationSecond * 30",
            "sstimerUPP",
            "NULL",
            "&sstimer"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetMainEventLoop",
          "args": [],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NewEventLoopTimerUPP",
          "args": [
            "macosxCG_screensaver_timer"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"macosxCGP_screensaver_timer_on: %d\\n\"",
            "(int) time(0)"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "time",
          "args": [
            "0"
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "csock_timeout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/sslhelper.c",
          "lines": "3270-3276",
          "snippet": "static void csock_timeout (int sig) {\n\trfbLog(\"sig: %d, csock_timeout.\\n\", sig);\n\tif (csock_timeout_sock >= 0) {\n\t\tclose(csock_timeout_sock);\n\t\tcsock_timeout_sock = -1;\n\t}\n}",
          "includes": [
            "#include <openssl/rand.h>",
            "#include <openssl/err.h>",
            "#include <openssl/ssl.h>",
            "#include \"user.h\"",
            "#include \"unixpw.h\"",
            "#include \"sslcmds.h\"",
            "#include \"connections.h\"",
            "#include \"scan.h\"",
            "#include \"screen.h\"",
            "#include \"cleanup.h\"",
            "#include \"inet.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int csock_timeout_sock = -1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/rand.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n#include \"user.h\"\n#include \"unixpw.h\"\n#include \"sslcmds.h\"\n#include \"connections.h\"\n#include \"scan.h\"\n#include \"screen.h\"\n#include \"cleanup.h\"\n#include \"inet.h\"\n#include \"x11vnc.h\"\n\nstatic int csock_timeout_sock = -1;\n\nstatic void csock_timeout (int sig) {\n\trfbLog(\"sig: %d, csock_timeout.\\n\", sig);\n\tif (csock_timeout_sock >= 0) {\n\t\tclose(csock_timeout_sock);\n\t\tcsock_timeout_sock = -1;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <IOKit/pwr_mgt/IOPM.h>\n#include <IOKit/pwr_mgt/IOPMLib.h>\n#include <Carbon/Carbon.h>\n#include <Cocoa/Cocoa.h>\n#include <ApplicationServices/ApplicationServices.h>\n\nvoid macosxCGP_screensaver_timer_on(void) {\n\tif (0) fprintf(stderr, \"macosxCGP_screensaver_timer_on: %d\\n\", (int) time(0));\n\tsstimerUPP = NewEventLoopTimerUPP(macosxCG_screensaver_timer);\n\tInstallEventLoopTimer(GetMainEventLoop(), kEventDurationSecond * 30,\n\t    kEventDurationSecond * 30, sstimerUPP, NULL, &sstimer);\n}"
  },
  {
    "function_name": "macosxCGP_screensaver_timer_off",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/macosxCGP.c",
    "lines": "83-87",
    "snippet": "void macosxCGP_screensaver_timer_off(void) {\n\tif (0) fprintf(stderr, \"macosxCGP_screensaver_timer_off: %d\\n\", (int) time(0));\n\tRemoveEventLoopTimer(sstimer);\n\tDisposeEventLoopTimerUPP(sstimerUPP);\n}",
    "includes": [
      "#include <IOKit/pwr_mgt/IOPM.h>",
      "#include <IOKit/pwr_mgt/IOPMLib.h>",
      "#include <Carbon/Carbon.h>",
      "#include <Cocoa/Cocoa.h>",
      "#include <ApplicationServices/ApplicationServices.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DisposeEventLoopTimerUPP",
          "args": [
            "sstimerUPP"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RemoveEventLoopTimer",
          "args": [
            "sstimer"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"macosxCGP_screensaver_timer_off: %d\\n\"",
            "(int) time(0)"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "time",
          "args": [
            "0"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "csock_timeout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/sslhelper.c",
          "lines": "3270-3276",
          "snippet": "static void csock_timeout (int sig) {\n\trfbLog(\"sig: %d, csock_timeout.\\n\", sig);\n\tif (csock_timeout_sock >= 0) {\n\t\tclose(csock_timeout_sock);\n\t\tcsock_timeout_sock = -1;\n\t}\n}",
          "includes": [
            "#include <openssl/rand.h>",
            "#include <openssl/err.h>",
            "#include <openssl/ssl.h>",
            "#include \"user.h\"",
            "#include \"unixpw.h\"",
            "#include \"sslcmds.h\"",
            "#include \"connections.h\"",
            "#include \"scan.h\"",
            "#include \"screen.h\"",
            "#include \"cleanup.h\"",
            "#include \"inet.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int csock_timeout_sock = -1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/rand.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n#include \"user.h\"\n#include \"unixpw.h\"\n#include \"sslcmds.h\"\n#include \"connections.h\"\n#include \"scan.h\"\n#include \"screen.h\"\n#include \"cleanup.h\"\n#include \"inet.h\"\n#include \"x11vnc.h\"\n\nstatic int csock_timeout_sock = -1;\n\nstatic void csock_timeout (int sig) {\n\trfbLog(\"sig: %d, csock_timeout.\\n\", sig);\n\tif (csock_timeout_sock >= 0) {\n\t\tclose(csock_timeout_sock);\n\t\tcsock_timeout_sock = -1;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <IOKit/pwr_mgt/IOPM.h>\n#include <IOKit/pwr_mgt/IOPMLib.h>\n#include <Carbon/Carbon.h>\n#include <Cocoa/Cocoa.h>\n#include <ApplicationServices/ApplicationServices.h>\n\nvoid macosxCGP_screensaver_timer_off(void) {\n\tif (0) fprintf(stderr, \"macosxCGP_screensaver_timer_off: %d\\n\", (int) time(0));\n\tRemoveEventLoopTimer(sstimer);\n\tDisposeEventLoopTimerUPP(sstimerUPP);\n}"
  },
  {
    "function_name": "macosxCG_screensaver_timer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/macosxCGP.c",
    "lines": "74-81",
    "snippet": "void macosxCG_screensaver_timer(EventLoopTimerRef timer, void *data) {\n\tif (0) fprintf(stderr, \"macosxCG_screensaver_timer: %d\\n\", (int) time(0));\n\tif (!timer || !data) {}\n\tif (macosx_nosleep && client_count) {\n\t\tif (0) fprintf(stderr, \"UpdateSystemActivity: %d\\n\", (int) time(0));\n\t\tUpdateSystemActivity(IdleActivity);\n\t}\n}",
    "includes": [
      "#include <IOKit/pwr_mgt/IOPM.h>",
      "#include <IOKit/pwr_mgt/IOPMLib.h>",
      "#include <Carbon/Carbon.h>",
      "#include <Cocoa/Cocoa.h>",
      "#include <ApplicationServices/ApplicationServices.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "UpdateSystemActivity",
          "args": [
            "IdleActivity"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"UpdateSystemActivity: %d\\n\"",
            "(int) time(0)"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "time",
          "args": [
            "0"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "csock_timeout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/sslhelper.c",
          "lines": "3270-3276",
          "snippet": "static void csock_timeout (int sig) {\n\trfbLog(\"sig: %d, csock_timeout.\\n\", sig);\n\tif (csock_timeout_sock >= 0) {\n\t\tclose(csock_timeout_sock);\n\t\tcsock_timeout_sock = -1;\n\t}\n}",
          "includes": [
            "#include <openssl/rand.h>",
            "#include <openssl/err.h>",
            "#include <openssl/ssl.h>",
            "#include \"user.h\"",
            "#include \"unixpw.h\"",
            "#include \"sslcmds.h\"",
            "#include \"connections.h\"",
            "#include \"scan.h\"",
            "#include \"screen.h\"",
            "#include \"cleanup.h\"",
            "#include \"inet.h\"",
            "#include \"x11vnc.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int csock_timeout_sock = -1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/rand.h>\n#include <openssl/err.h>\n#include <openssl/ssl.h>\n#include \"user.h\"\n#include \"unixpw.h\"\n#include \"sslcmds.h\"\n#include \"connections.h\"\n#include \"scan.h\"\n#include \"screen.h\"\n#include \"cleanup.h\"\n#include \"inet.h\"\n#include \"x11vnc.h\"\n\nstatic int csock_timeout_sock = -1;\n\nstatic void csock_timeout (int sig) {\n\trfbLog(\"sig: %d, csock_timeout.\\n\", sig);\n\tif (csock_timeout_sock >= 0) {\n\t\tclose(csock_timeout_sock);\n\t\tcsock_timeout_sock = -1;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"macosxCG_screensaver_timer: %d\\n\"",
            "(int) time(0)"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <IOKit/pwr_mgt/IOPM.h>\n#include <IOKit/pwr_mgt/IOPMLib.h>\n#include <Carbon/Carbon.h>\n#include <Cocoa/Cocoa.h>\n#include <ApplicationServices/ApplicationServices.h>\n\nvoid macosxCG_screensaver_timer(EventLoopTimerRef timer, void *data) {\n\tif (0) fprintf(stderr, \"macosxCG_screensaver_timer: %d\\n\", (int) time(0));\n\tif (!timer || !data) {}\n\tif (macosx_nosleep && client_count) {\n\t\tif (0) fprintf(stderr, \"UpdateSystemActivity: %d\\n\", (int) time(0));\n\t\tUpdateSystemActivity(IdleActivity);\n\t}\n}"
  },
  {
    "function_name": "macosxCGP_unused",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-29074/repo/src/macosxCGP.c",
    "lines": "35-35",
    "snippet": "void macosxCGP_unused(void) {}",
    "includes": [
      "#include <IOKit/pwr_mgt/IOPM.h>",
      "#include <IOKit/pwr_mgt/IOPMLib.h>",
      "#include <Carbon/Carbon.h>",
      "#include <Cocoa/Cocoa.h>",
      "#include <ApplicationServices/ApplicationServices.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <IOKit/pwr_mgt/IOPM.h>\n#include <IOKit/pwr_mgt/IOPMLib.h>\n#include <Carbon/Carbon.h>\n#include <Cocoa/Cocoa.h>\n#include <ApplicationServices/ApplicationServices.h>\n\nvoid macosxCGP_unused(void) {}"
  }
]