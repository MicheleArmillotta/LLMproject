[
  {
    "function_name": "UpnpString_casecmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/UpnpString.c",
    "lines": "199-205",
    "snippet": "int UpnpString_casecmp(UpnpString *p, UpnpString *q)\n{\n\tconst char *cp = UpnpString_get_String(p);\n\tconst char *cq = UpnpString_get_String(q);\n\n\treturn strcasecmp(cp, cq);\n}",
    "includes": [
      "#include <string.h> /* for strlen(), strdup() */",
      "#include <stdlib.h> /* for calloc(), free() */",
      "#include \"UpnpString.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [
      "#define strcasecmp stricmp"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcasecmp",
          "args": [
            "cp",
            "cq"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "UpnpString_get_String",
          "args": [
            "q"
          ],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "UpnpString_get_String",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/UpnpString.c",
          "lines": "155-158",
          "snippet": "const char *UpnpString_get_String(const UpnpString *p)\n{\n\treturn ((struct SUpnpString *)p)->m_string;\n}",
          "includes": [
            "#include <string.h> /* for strlen(), strdup() */",
            "#include <stdlib.h> /* for calloc(), free() */",
            "#include \"UpnpString.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h> /* for strlen(), strdup() */\n#include <stdlib.h> /* for calloc(), free() */\n#include \"UpnpString.h\"\n#include \"config.h\"\n\nconst char *UpnpString_get_String(const UpnpString *p)\n{\n\treturn ((struct SUpnpString *)p)->m_string;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h> /* for strlen(), strdup() */\n#include <stdlib.h> /* for calloc(), free() */\n#include \"UpnpString.h\"\n#include \"config.h\"\n\n#define strcasecmp stricmp\n\nint UpnpString_casecmp(UpnpString *p, UpnpString *q)\n{\n\tconst char *cp = UpnpString_get_String(p);\n\tconst char *cq = UpnpString_get_String(q);\n\n\treturn strcasecmp(cp, cq);\n}"
  },
  {
    "function_name": "UpnpString_cmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/UpnpString.c",
    "lines": "191-197",
    "snippet": "int UpnpString_cmp(UpnpString *p, UpnpString *q)\n{\n\tconst char *cp = UpnpString_get_String(p);\n\tconst char *cq = UpnpString_get_String(q);\n\n\treturn strcmp(cp, cq);\n}",
    "includes": [
      "#include <string.h> /* for strlen(), strdup() */",
      "#include <stdlib.h> /* for calloc(), free() */",
      "#include \"UpnpString.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "cp",
            "cq"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "UpnpString_get_String",
          "args": [
            "q"
          ],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "UpnpString_get_String",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/UpnpString.c",
          "lines": "155-158",
          "snippet": "const char *UpnpString_get_String(const UpnpString *p)\n{\n\treturn ((struct SUpnpString *)p)->m_string;\n}",
          "includes": [
            "#include <string.h> /* for strlen(), strdup() */",
            "#include <stdlib.h> /* for calloc(), free() */",
            "#include \"UpnpString.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h> /* for strlen(), strdup() */\n#include <stdlib.h> /* for calloc(), free() */\n#include \"UpnpString.h\"\n#include \"config.h\"\n\nconst char *UpnpString_get_String(const UpnpString *p)\n{\n\treturn ((struct SUpnpString *)p)->m_string;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h> /* for strlen(), strdup() */\n#include <stdlib.h> /* for calloc(), free() */\n#include \"UpnpString.h\"\n#include \"config.h\"\n\nint UpnpString_cmp(UpnpString *p, UpnpString *q)\n{\n\tconst char *cp = UpnpString_get_String(p);\n\tconst char *cq = UpnpString_get_String(q);\n\n\treturn strcmp(cp, cq);\n}"
  },
  {
    "function_name": "UpnpString_clear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/UpnpString.c",
    "lines": "184-189",
    "snippet": "void UpnpString_clear(UpnpString *p)\n{\n\t((struct SUpnpString *)p)->m_length = (size_t)0;\n\t/* No need to realloc now, will do later when needed. */\n\t((struct SUpnpString *)p)->m_string[0] = 0;\n}",
    "includes": [
      "#include <string.h> /* for strlen(), strdup() */",
      "#include <stdlib.h> /* for calloc(), free() */",
      "#include \"UpnpString.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <string.h> /* for strlen(), strdup() */\n#include <stdlib.h> /* for calloc(), free() */\n#include \"UpnpString.h\"\n#include \"config.h\"\n\nvoid UpnpString_clear(UpnpString *p)\n{\n\t((struct SUpnpString *)p)->m_length = (size_t)0;\n\t/* No need to realloc now, will do later when needed. */\n\t((struct SUpnpString *)p)->m_string[0] = 0;\n}"
  },
  {
    "function_name": "UpnpString_set_StringN",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/UpnpString.c",
    "lines": "172-182",
    "snippet": "int UpnpString_set_StringN(UpnpString *p, const char *s, size_t n)\n{\n\tchar *q = strndup(s, n);\n\tif (!q) goto error_handler1;\n\tfree(((struct SUpnpString *)p)->m_string);\n\t((struct SUpnpString *)p)->m_length = strlen(q);\n\t((struct SUpnpString *)p)->m_string = q;\n\nerror_handler1:\n\treturn q != NULL;\n}",
    "includes": [
      "#include <string.h> /* for strlen(), strdup() */",
      "#include <stdlib.h> /* for calloc(), free() */",
      "#include \"UpnpString.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "q"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "((struct SUpnpString *)p)->m_string"
          ],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "free_notify_struct",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/gena/gena_device.c",
          "lines": "144-157",
          "snippet": "static void free_notify_struct(\n\t/*! [in] Notify structure. */\n\tnotify_thread_struct *input)\n{\n\t(*input->reference_count)--;\n\tif (*input->reference_count == 0) {\n\t\tfree(input->headers);\n\t\tixmlFreeDOMString(input->propertySet);\n\t\tfree(input->servId);\n\t\tfree(input->UDN);\n\t\tfree(input->reference_count);\n\t}\n\tfree(input);\n}",
          "includes": [
            "#include \"uuid.h\"",
            "#include \"upnpapi.h\"",
            "#include \"unixutil.h\"",
            "#include \"sysdep.h\"",
            "#include \"statcodes.h\"",
            "#include \"ssdplib.h\"",
            "#include \"parsetools.h\"",
            "#include \"httpreadwrite.h\"",
            "#include \"httpparser.h\"",
            "#include \"gena.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"uuid.h\"\n#include \"upnpapi.h\"\n#include \"unixutil.h\"\n#include \"sysdep.h\"\n#include \"statcodes.h\"\n#include \"ssdplib.h\"\n#include \"parsetools.h\"\n#include \"httpreadwrite.h\"\n#include \"httpparser.h\"\n#include \"gena.h\"\n#include \"config.h\"\n\nstatic void free_notify_struct(\n\t/*! [in] Notify structure. */\n\tnotify_thread_struct *input)\n{\n\t(*input->reference_count)--;\n\tif (*input->reference_count == 0) {\n\t\tfree(input->headers);\n\t\tixmlFreeDOMString(input->propertySet);\n\t\tfree(input->servId);\n\t\tfree(input->UDN);\n\t\tfree(input->reference_count);\n\t}\n\tfree(input);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strndup",
          "args": [
            "s",
            "n"
          ],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "strndup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/UpnpString.c",
          "lines": "45-56",
          "snippet": "static char *strndup(const char *__string, size_t __n)\n\t{\n\t\tsize_t strsize = strnlen(__string, __n);\n\t\tchar *newstr = (char *)malloc(strsize + 1);\n\t\tif (newstr == NULL)\n\t\t\treturn NULL;\n\n\t\tstrncpy(newstr, __string, strsize);\n\t\tnewstr[strsize] = 0;\n\n\t\treturn newstr;\n\t}",
          "includes": [
            "#include <string.h> /* for strlen(), strdup() */",
            "#include <stdlib.h> /* for calloc(), free() */",
            "#include \"UpnpString.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h> /* for strlen(), strdup() */\n#include <stdlib.h> /* for calloc(), free() */\n#include \"UpnpString.h\"\n#include \"config.h\"\n\nstatic char *strndup(const char *__string, size_t __n)\n\t{\n\t\tsize_t strsize = strnlen(__string, __n);\n\t\tchar *newstr = (char *)malloc(strsize + 1);\n\t\tif (newstr == NULL)\n\t\t\treturn NULL;\n\n\t\tstrncpy(newstr, __string, strsize);\n\t\tnewstr[strsize] = 0;\n\n\t\treturn newstr;\n\t}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h> /* for strlen(), strdup() */\n#include <stdlib.h> /* for calloc(), free() */\n#include \"UpnpString.h\"\n#include \"config.h\"\n\nint UpnpString_set_StringN(UpnpString *p, const char *s, size_t n)\n{\n\tchar *q = strndup(s, n);\n\tif (!q) goto error_handler1;\n\tfree(((struct SUpnpString *)p)->m_string);\n\t((struct SUpnpString *)p)->m_length = strlen(q);\n\t((struct SUpnpString *)p)->m_string = q;\n\nerror_handler1:\n\treturn q != NULL;\n}"
  },
  {
    "function_name": "UpnpString_set_String",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/UpnpString.c",
    "lines": "160-170",
    "snippet": "int UpnpString_set_String(UpnpString *p, const char *s)\n{\n\tchar *q = strdup(s);\n\tif (!q) goto error_handler1;\n\tfree(((struct SUpnpString *)p)->m_string);\n\t((struct SUpnpString *)p)->m_length = strlen(q);\n\t((struct SUpnpString *)p)->m_string = q;\n\nerror_handler1:\n\treturn q != NULL;\n}",
    "includes": [
      "#include <string.h> /* for strlen(), strdup() */",
      "#include <stdlib.h> /* for calloc(), free() */",
      "#include \"UpnpString.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "q"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "((struct SUpnpString *)p)->m_string"
          ],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "free_notify_struct",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/gena/gena_device.c",
          "lines": "144-157",
          "snippet": "static void free_notify_struct(\n\t/*! [in] Notify structure. */\n\tnotify_thread_struct *input)\n{\n\t(*input->reference_count)--;\n\tif (*input->reference_count == 0) {\n\t\tfree(input->headers);\n\t\tixmlFreeDOMString(input->propertySet);\n\t\tfree(input->servId);\n\t\tfree(input->UDN);\n\t\tfree(input->reference_count);\n\t}\n\tfree(input);\n}",
          "includes": [
            "#include \"uuid.h\"",
            "#include \"upnpapi.h\"",
            "#include \"unixutil.h\"",
            "#include \"sysdep.h\"",
            "#include \"statcodes.h\"",
            "#include \"ssdplib.h\"",
            "#include \"parsetools.h\"",
            "#include \"httpreadwrite.h\"",
            "#include \"httpparser.h\"",
            "#include \"gena.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"uuid.h\"\n#include \"upnpapi.h\"\n#include \"unixutil.h\"\n#include \"sysdep.h\"\n#include \"statcodes.h\"\n#include \"ssdplib.h\"\n#include \"parsetools.h\"\n#include \"httpreadwrite.h\"\n#include \"httpparser.h\"\n#include \"gena.h\"\n#include \"config.h\"\n\nstatic void free_notify_struct(\n\t/*! [in] Notify structure. */\n\tnotify_thread_struct *input)\n{\n\t(*input->reference_count)--;\n\tif (*input->reference_count == 0) {\n\t\tfree(input->headers);\n\t\tixmlFreeDOMString(input->propertySet);\n\t\tfree(input->servId);\n\t\tfree(input->UDN);\n\t\tfree(input->reference_count);\n\t}\n\tfree(input);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "s"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h> /* for strlen(), strdup() */\n#include <stdlib.h> /* for calloc(), free() */\n#include \"UpnpString.h\"\n#include \"config.h\"\n\nint UpnpString_set_String(UpnpString *p, const char *s)\n{\n\tchar *q = strdup(s);\n\tif (!q) goto error_handler1;\n\tfree(((struct SUpnpString *)p)->m_string);\n\t((struct SUpnpString *)p)->m_length = strlen(q);\n\t((struct SUpnpString *)p)->m_string = q;\n\nerror_handler1:\n\treturn q != NULL;\n}"
  },
  {
    "function_name": "UpnpString_get_String",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/UpnpString.c",
    "lines": "155-158",
    "snippet": "const char *UpnpString_get_String(const UpnpString *p)\n{\n\treturn ((struct SUpnpString *)p)->m_string;\n}",
    "includes": [
      "#include <string.h> /* for strlen(), strdup() */",
      "#include <stdlib.h> /* for calloc(), free() */",
      "#include \"UpnpString.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <string.h> /* for strlen(), strdup() */\n#include <stdlib.h> /* for calloc(), free() */\n#include \"UpnpString.h\"\n#include \"config.h\"\n\nconst char *UpnpString_get_String(const UpnpString *p)\n{\n\treturn ((struct SUpnpString *)p)->m_string;\n}"
  },
  {
    "function_name": "UpnpString_set_Length",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/UpnpString.c",
    "lines": "146-153",
    "snippet": "void UpnpString_set_Length(UpnpString *p, size_t n)\n{\n\tif (((struct SUpnpString *)p)->m_length > n) {\n\t\t((struct SUpnpString *)p)->m_length = n;\n\t\t/* No need to realloc now, will do later when needed. */\n\t\t((struct SUpnpString *)p)->m_string[n] = 0;\n\t}\n}",
    "includes": [
      "#include <string.h> /* for strlen(), strdup() */",
      "#include <stdlib.h> /* for calloc(), free() */",
      "#include \"UpnpString.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <string.h> /* for strlen(), strdup() */\n#include <stdlib.h> /* for calloc(), free() */\n#include \"UpnpString.h\"\n#include \"config.h\"\n\nvoid UpnpString_set_Length(UpnpString *p, size_t n)\n{\n\tif (((struct SUpnpString *)p)->m_length > n) {\n\t\t((struct SUpnpString *)p)->m_length = n;\n\t\t/* No need to realloc now, will do later when needed. */\n\t\t((struct SUpnpString *)p)->m_string[n] = 0;\n\t}\n}"
  },
  {
    "function_name": "UpnpString_get_Length",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/UpnpString.c",
    "lines": "141-144",
    "snippet": "size_t UpnpString_get_Length(const UpnpString *p)\n{\n\treturn ((struct SUpnpString *)p)->m_length;\n}",
    "includes": [
      "#include <string.h> /* for strlen(), strdup() */",
      "#include <stdlib.h> /* for calloc(), free() */",
      "#include \"UpnpString.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <string.h> /* for strlen(), strdup() */\n#include <stdlib.h> /* for calloc(), free() */\n#include \"UpnpString.h\"\n#include \"config.h\"\n\nsize_t UpnpString_get_Length(const UpnpString *p)\n{\n\treturn ((struct SUpnpString *)p)->m_length;\n}"
  },
  {
    "function_name": "UpnpString_assign",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/UpnpString.c",
    "lines": "134-139",
    "snippet": "void UpnpString_assign(UpnpString *p, const UpnpString *q)\n{\n\tif (p != q) {\n\t\tUpnpString_set_String(p, UpnpString_get_String(q));\n\t}\n}",
    "includes": [
      "#include <string.h> /* for strlen(), strdup() */",
      "#include <stdlib.h> /* for calloc(), free() */",
      "#include \"UpnpString.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "UpnpString_set_String",
          "args": [
            "p",
            "UpnpString_get_String(q)"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "UpnpString_set_String",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/UpnpString.c",
          "lines": "160-170",
          "snippet": "int UpnpString_set_String(UpnpString *p, const char *s)\n{\n\tchar *q = strdup(s);\n\tif (!q) goto error_handler1;\n\tfree(((struct SUpnpString *)p)->m_string);\n\t((struct SUpnpString *)p)->m_length = strlen(q);\n\t((struct SUpnpString *)p)->m_string = q;\n\nerror_handler1:\n\treturn q != NULL;\n}",
          "includes": [
            "#include <string.h> /* for strlen(), strdup() */",
            "#include <stdlib.h> /* for calloc(), free() */",
            "#include \"UpnpString.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h> /* for strlen(), strdup() */\n#include <stdlib.h> /* for calloc(), free() */\n#include \"UpnpString.h\"\n#include \"config.h\"\n\nint UpnpString_set_String(UpnpString *p, const char *s)\n{\n\tchar *q = strdup(s);\n\tif (!q) goto error_handler1;\n\tfree(((struct SUpnpString *)p)->m_string);\n\t((struct SUpnpString *)p)->m_length = strlen(q);\n\t((struct SUpnpString *)p)->m_string = q;\n\nerror_handler1:\n\treturn q != NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "UpnpString_get_String",
          "args": [
            "q"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "UpnpString_get_String",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/UpnpString.c",
          "lines": "155-158",
          "snippet": "const char *UpnpString_get_String(const UpnpString *p)\n{\n\treturn ((struct SUpnpString *)p)->m_string;\n}",
          "includes": [
            "#include <string.h> /* for strlen(), strdup() */",
            "#include <stdlib.h> /* for calloc(), free() */",
            "#include \"UpnpString.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h> /* for strlen(), strdup() */\n#include <stdlib.h> /* for calloc(), free() */\n#include \"UpnpString.h\"\n#include \"config.h\"\n\nconst char *UpnpString_get_String(const UpnpString *p)\n{\n\treturn ((struct SUpnpString *)p)->m_string;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h> /* for strlen(), strdup() */\n#include <stdlib.h> /* for calloc(), free() */\n#include \"UpnpString.h\"\n#include \"config.h\"\n\nvoid UpnpString_assign(UpnpString *p, const UpnpString *q)\n{\n\tif (p != q) {\n\t\tUpnpString_set_String(p, UpnpString_get_String(q));\n\t}\n}"
  },
  {
    "function_name": "UpnpString_dup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/UpnpString.c",
    "lines": "113-132",
    "snippet": "UpnpString *UpnpString_dup(const UpnpString *p)\n{\n\tstruct SUpnpString *q = calloc((size_t)1, sizeof (struct SUpnpString));\n\tif (q == NULL) {\n\t\tgoto error_handler1;\n\t}\n\tq->m_length = ((struct SUpnpString *)p)->m_length;\n\tq->m_string = strdup(((struct SUpnpString *)p)->m_string);\n\tif (q->m_string == NULL) {\n\t\tgoto error_handler2;\n\t}\n\n\treturn (UpnpString *)q;\n\n\t/*free(q->m_string); */\nerror_handler2:\n\tfree(q);\nerror_handler1:\n\treturn NULL;\n}",
    "includes": [
      "#include <string.h> /* for strlen(), strdup() */",
      "#include <stdlib.h> /* for calloc(), free() */",
      "#include \"UpnpString.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "q"
          ],
          "line": 129
        },
        "resolved": true,
        "details": {
          "function_name": "free_notify_struct",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/gena/gena_device.c",
          "lines": "144-157",
          "snippet": "static void free_notify_struct(\n\t/*! [in] Notify structure. */\n\tnotify_thread_struct *input)\n{\n\t(*input->reference_count)--;\n\tif (*input->reference_count == 0) {\n\t\tfree(input->headers);\n\t\tixmlFreeDOMString(input->propertySet);\n\t\tfree(input->servId);\n\t\tfree(input->UDN);\n\t\tfree(input->reference_count);\n\t}\n\tfree(input);\n}",
          "includes": [
            "#include \"uuid.h\"",
            "#include \"upnpapi.h\"",
            "#include \"unixutil.h\"",
            "#include \"sysdep.h\"",
            "#include \"statcodes.h\"",
            "#include \"ssdplib.h\"",
            "#include \"parsetools.h\"",
            "#include \"httpreadwrite.h\"",
            "#include \"httpparser.h\"",
            "#include \"gena.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"uuid.h\"\n#include \"upnpapi.h\"\n#include \"unixutil.h\"\n#include \"sysdep.h\"\n#include \"statcodes.h\"\n#include \"ssdplib.h\"\n#include \"parsetools.h\"\n#include \"httpreadwrite.h\"\n#include \"httpparser.h\"\n#include \"gena.h\"\n#include \"config.h\"\n\nstatic void free_notify_struct(\n\t/*! [in] Notify structure. */\n\tnotify_thread_struct *input)\n{\n\t(*input->reference_count)--;\n\tif (*input->reference_count == 0) {\n\t\tfree(input->headers);\n\t\tixmlFreeDOMString(input->propertySet);\n\t\tfree(input->servId);\n\t\tfree(input->UDN);\n\t\tfree(input->reference_count);\n\t}\n\tfree(input);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strdup",
          "args": [
            "((struct SUpnpString *)p)->m_string"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "calloc",
          "args": [
            "(size_t)1",
            "sizeof (struct SUpnpString)"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h> /* for strlen(), strdup() */\n#include <stdlib.h> /* for calloc(), free() */\n#include \"UpnpString.h\"\n#include \"config.h\"\n\nUpnpString *UpnpString_dup(const UpnpString *p)\n{\n\tstruct SUpnpString *q = calloc((size_t)1, sizeof (struct SUpnpString));\n\tif (q == NULL) {\n\t\tgoto error_handler1;\n\t}\n\tq->m_length = ((struct SUpnpString *)p)->m_length;\n\tq->m_string = strdup(((struct SUpnpString *)p)->m_string);\n\tif (q->m_string == NULL) {\n\t\tgoto error_handler2;\n\t}\n\n\treturn (UpnpString *)q;\n\n\t/*free(q->m_string); */\nerror_handler2:\n\tfree(q);\nerror_handler1:\n\treturn NULL;\n}"
  },
  {
    "function_name": "UpnpString_delete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/UpnpString.c",
    "lines": "99-111",
    "snippet": "void UpnpString_delete(UpnpString *p)\n{\n\tstruct SUpnpString *q = (struct SUpnpString *)p;\n\t\t\n\tif (!q) return;\n\n\tq->m_length = (size_t)0;\n\n\tfree(q->m_string);\n\tq->m_string = NULL;\n\n\tfree(p);\n}",
    "includes": [
      "#include <string.h> /* for strlen(), strdup() */",
      "#include <stdlib.h> /* for calloc(), free() */",
      "#include \"UpnpString.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "p"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "free_notify_struct",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/gena/gena_device.c",
          "lines": "144-157",
          "snippet": "static void free_notify_struct(\n\t/*! [in] Notify structure. */\n\tnotify_thread_struct *input)\n{\n\t(*input->reference_count)--;\n\tif (*input->reference_count == 0) {\n\t\tfree(input->headers);\n\t\tixmlFreeDOMString(input->propertySet);\n\t\tfree(input->servId);\n\t\tfree(input->UDN);\n\t\tfree(input->reference_count);\n\t}\n\tfree(input);\n}",
          "includes": [
            "#include \"uuid.h\"",
            "#include \"upnpapi.h\"",
            "#include \"unixutil.h\"",
            "#include \"sysdep.h\"",
            "#include \"statcodes.h\"",
            "#include \"ssdplib.h\"",
            "#include \"parsetools.h\"",
            "#include \"httpreadwrite.h\"",
            "#include \"httpparser.h\"",
            "#include \"gena.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"uuid.h\"\n#include \"upnpapi.h\"\n#include \"unixutil.h\"\n#include \"sysdep.h\"\n#include \"statcodes.h\"\n#include \"ssdplib.h\"\n#include \"parsetools.h\"\n#include \"httpreadwrite.h\"\n#include \"httpparser.h\"\n#include \"gena.h\"\n#include \"config.h\"\n\nstatic void free_notify_struct(\n\t/*! [in] Notify structure. */\n\tnotify_thread_struct *input)\n{\n\t(*input->reference_count)--;\n\tif (*input->reference_count == 0) {\n\t\tfree(input->headers);\n\t\tixmlFreeDOMString(input->propertySet);\n\t\tfree(input->servId);\n\t\tfree(input->UDN);\n\t\tfree(input->reference_count);\n\t}\n\tfree(input);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h> /* for strlen(), strdup() */\n#include <stdlib.h> /* for calloc(), free() */\n#include \"UpnpString.h\"\n#include \"config.h\"\n\nvoid UpnpString_delete(UpnpString *p)\n{\n\tstruct SUpnpString *q = (struct SUpnpString *)p;\n\t\t\n\tif (!q) return;\n\n\tq->m_length = (size_t)0;\n\n\tfree(q->m_string);\n\tq->m_string = NULL;\n\n\tfree(p);\n}"
  },
  {
    "function_name": "UpnpString_new",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/UpnpString.c",
    "lines": "73-97",
    "snippet": "UpnpString *UpnpString_new()\n{\n\t/* All bytes are zero, and so is the length of the string. */\n\tstruct SUpnpString *p = calloc((size_t)1, sizeof (struct SUpnpString));\n\tif (p == NULL) {\n\t\tgoto error_handler1;\n\t}\n#if 0\n\tp->m_length = 0;\n#endif\n\n\t/* This byte is zero, calloc does initialize it. */\n\tp->m_string = calloc((size_t)1, (size_t)1);\n\tif (p->m_string == NULL) {\n\t\tgoto error_handler2;\n\t}\n\n\treturn (UpnpString *)p;\n\n\t/*free(p->m_string); */\nerror_handler2:\n\tfree(p);\nerror_handler1:\n\treturn NULL;\n}",
    "includes": [
      "#include <string.h> /* for strlen(), strdup() */",
      "#include <stdlib.h> /* for calloc(), free() */",
      "#include \"UpnpString.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "p"
          ],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "free_notify_struct",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/gena/gena_device.c",
          "lines": "144-157",
          "snippet": "static void free_notify_struct(\n\t/*! [in] Notify structure. */\n\tnotify_thread_struct *input)\n{\n\t(*input->reference_count)--;\n\tif (*input->reference_count == 0) {\n\t\tfree(input->headers);\n\t\tixmlFreeDOMString(input->propertySet);\n\t\tfree(input->servId);\n\t\tfree(input->UDN);\n\t\tfree(input->reference_count);\n\t}\n\tfree(input);\n}",
          "includes": [
            "#include \"uuid.h\"",
            "#include \"upnpapi.h\"",
            "#include \"unixutil.h\"",
            "#include \"sysdep.h\"",
            "#include \"statcodes.h\"",
            "#include \"ssdplib.h\"",
            "#include \"parsetools.h\"",
            "#include \"httpreadwrite.h\"",
            "#include \"httpparser.h\"",
            "#include \"gena.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"uuid.h\"\n#include \"upnpapi.h\"\n#include \"unixutil.h\"\n#include \"sysdep.h\"\n#include \"statcodes.h\"\n#include \"ssdplib.h\"\n#include \"parsetools.h\"\n#include \"httpreadwrite.h\"\n#include \"httpparser.h\"\n#include \"gena.h\"\n#include \"config.h\"\n\nstatic void free_notify_struct(\n\t/*! [in] Notify structure. */\n\tnotify_thread_struct *input)\n{\n\t(*input->reference_count)--;\n\tif (*input->reference_count == 0) {\n\t\tfree(input->headers);\n\t\tixmlFreeDOMString(input->propertySet);\n\t\tfree(input->servId);\n\t\tfree(input->UDN);\n\t\tfree(input->reference_count);\n\t}\n\tfree(input);\n}"
        }
      },
      {
        "call_info": {
          "callee": "calloc",
          "args": [
            "(size_t)1",
            "(size_t)1"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "calloc",
          "args": [
            "(size_t)1",
            "sizeof (struct SUpnpString)"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h> /* for strlen(), strdup() */\n#include <stdlib.h> /* for calloc(), free() */\n#include \"UpnpString.h\"\n#include \"config.h\"\n\nUpnpString *UpnpString_new()\n{\n\t/* All bytes are zero, and so is the length of the string. */\n\tstruct SUpnpString *p = calloc((size_t)1, sizeof (struct SUpnpString));\n\tif (p == NULL) {\n\t\tgoto error_handler1;\n\t}\n#if 0\n\tp->m_length = 0;\n#endif\n\n\t/* This byte is zero, calloc does initialize it. */\n\tp->m_string = calloc((size_t)1, (size_t)1);\n\tif (p->m_string == NULL) {\n\t\tgoto error_handler2;\n\t}\n\n\treturn (UpnpString *)p;\n\n\t/*free(p->m_string); */\nerror_handler2:\n\tfree(p);\nerror_handler1:\n\treturn NULL;\n}"
  },
  {
    "function_name": "strndup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/UpnpString.c",
    "lines": "45-56",
    "snippet": "static char *strndup(const char *__string, size_t __n)\n\t{\n\t\tsize_t strsize = strnlen(__string, __n);\n\t\tchar *newstr = (char *)malloc(strsize + 1);\n\t\tif (newstr == NULL)\n\t\t\treturn NULL;\n\n\t\tstrncpy(newstr, __string, strsize);\n\t\tnewstr[strsize] = 0;\n\n\t\treturn newstr;\n\t}",
    "includes": [
      "#include <string.h> /* for strlen(), strdup() */",
      "#include <stdlib.h> /* for calloc(), free() */",
      "#include \"UpnpString.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strncpy",
          "args": [
            "newstr",
            "__string",
            "strsize"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "strsize + 1"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strnlen",
          "args": [
            "__string",
            "__n"
          ],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "strnlen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/UpnpString.c",
          "lines": "35-39",
          "snippet": "static size_t strnlen(const char *s, size_t n)\n\t\t{\n\t\t\tconst char *p = (const char *)memchr(s, 0, n);\n\t\t\treturn p ? p - s : n;\n\t\t}",
          "includes": [
            "#include <string.h> /* for strlen(), strdup() */",
            "#include <stdlib.h> /* for calloc(), free() */",
            "#include \"UpnpString.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h> /* for strlen(), strdup() */\n#include <stdlib.h> /* for calloc(), free() */\n#include \"UpnpString.h\"\n#include \"config.h\"\n\nstatic size_t strnlen(const char *s, size_t n)\n\t\t{\n\t\t\tconst char *p = (const char *)memchr(s, 0, n);\n\t\t\treturn p ? p - s : n;\n\t\t}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h> /* for strlen(), strdup() */\n#include <stdlib.h> /* for calloc(), free() */\n#include \"UpnpString.h\"\n#include \"config.h\"\n\nstatic char *strndup(const char *__string, size_t __n)\n\t{\n\t\tsize_t strsize = strnlen(__string, __n);\n\t\tchar *newstr = (char *)malloc(strsize + 1);\n\t\tif (newstr == NULL)\n\t\t\treturn NULL;\n\n\t\tstrncpy(newstr, __string, strsize);\n\t\tnewstr[strsize] = 0;\n\n\t\treturn newstr;\n\t}"
  },
  {
    "function_name": "strnlen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/UpnpString.c",
    "lines": "35-39",
    "snippet": "static size_t strnlen(const char *s, size_t n)\n\t\t{\n\t\t\tconst char *p = (const char *)memchr(s, 0, n);\n\t\t\treturn p ? p - s : n;\n\t\t}",
    "includes": [
      "#include <string.h> /* for strlen(), strdup() */",
      "#include <stdlib.h> /* for calloc(), free() */",
      "#include \"UpnpString.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memchr",
          "args": [
            "s",
            "0",
            "n"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h> /* for strlen(), strdup() */\n#include <stdlib.h> /* for calloc(), free() */\n#include \"UpnpString.h\"\n#include \"config.h\"\n\nstatic size_t strnlen(const char *s, size_t n)\n\t\t{\n\t\t\tconst char *p = (const char *)memchr(s, 0, n);\n\t\t\treturn p ? p - s : n;\n\t\t}"
  }
]