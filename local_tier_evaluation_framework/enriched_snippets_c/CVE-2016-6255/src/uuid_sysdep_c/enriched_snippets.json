[
  {
    "function_name": "get_random_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/uuid/sysdep.c",
    "lines": "129-150",
    "snippet": "void get_random_info(unsigned char seed[16])\n{\n\tMD5_CTX c;\n\ttypedef struct {\n\t\t/*struct sysinfo s; */\n\t\tstruct timeval t;\n\t\tchar hostname[257];\n\t} randomness;\n\trandomness r;\n\n\t/* Initialize memory area so that valgrind does not complain. */\n\tmemset(&r, 0, sizeof r);\n\n\t/* Get some random stuff. */\n\tgettimeofday(&r.t, (struct timezone *)0);\n\tgethostname(r.hostname, 256);\n\n\t/* MD5 it */\n\tMD5Init(&c);\n\tMD5Update(&c, (unsigned char *)&r, sizeof r);\n\tMD5Final(seed, &c);\n}",
    "includes": [
      "#include <stdio.h>",
      "#include <string.h>",
      "#include \"UpnpInet.h\"",
      "#include \"sysdep.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "MD5Final",
          "args": [
            "seed",
            "&c"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "MD5Final",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/uuid/md5.c",
          "lines": "163-186",
          "snippet": "void\nMD5Final(unsigned char digest[16], MD5_CTX *context)\n{\n    unsigned char bits[8];\n    unsigned int index;\n    unsigned int padLen;\n\n    /* Save number of bits */\n    Encode(bits, context->count, 8);\n\n    /* Pad out to 56 mod 64. */\n    index = (unsigned int)((context->count[0] >> 3) & 0x3f);\n    padLen = (index < 56) ? (56 - index) : (120 - index);\n    MD5Update(context, PADDING, padLen);\n\n    /* Append length (before padding) */\n    MD5Update(context, bits, 8);\n\n    /* Store state in digest */\n    Encode(digest, context->state, 16);\n\n    /* Zeroize sensitive information. */\n    MD5_memset((POINTER)context, 0, sizeof(*context));\n}",
          "includes": [
            "#include \"md5.h\"",
            "#include \"global.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void Encode",
            "static void MD5_memset",
            "static unsigned char PADDING[64] = {\n    0x80, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"global.h\"\n#include \"config.h\"\n\nstatic void Encode;\nstatic void MD5_memset;\nstatic unsigned char PADDING[64] = {\n    0x80, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0\n};\n\nvoid\nMD5Final(unsigned char digest[16], MD5_CTX *context)\n{\n    unsigned char bits[8];\n    unsigned int index;\n    unsigned int padLen;\n\n    /* Save number of bits */\n    Encode(bits, context->count, 8);\n\n    /* Pad out to 56 mod 64. */\n    index = (unsigned int)((context->count[0] >> 3) & 0x3f);\n    padLen = (index < 56) ? (56 - index) : (120 - index);\n    MD5Update(context, PADDING, padLen);\n\n    /* Append length (before padding) */\n    MD5Update(context, bits, 8);\n\n    /* Store state in digest */\n    Encode(digest, context->state, 16);\n\n    /* Zeroize sensitive information. */\n    MD5_memset((POINTER)context, 0, sizeof(*context));\n}"
        }
      },
      {
        "call_info": {
          "callee": "MD5Update",
          "args": [
            "&c",
            "(unsigned char *)&r",
            "sizeof r"
          ],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "MD5Update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/uuid/md5.c",
          "lines": "126-157",
          "snippet": "void\nMD5Update(MD5_CTX *context, unsigned char *input, unsigned int inputLen)\n{\n\tunsigned int i;\n\tunsigned int index;\n\tunsigned int partLen;\n\n\t/* Compute number of bytes mod 64 */\n\tindex = (unsigned int)((context->count[0] >> 3) & 0x3F);\n\n\t/* Update number of bits */\n\tif ((context->count[0] += ((UINT4)inputLen << 3)) < ((UINT4)inputLen << 3)) {\n\t\tcontext->count[1]++;\n\t}\n\tcontext->count[1] += ((UINT4)inputLen >> 29);\n\tpartLen = 64 - index;\n\n\t/* Transform as many times as possible. */\n\tif (inputLen >= partLen) {\n\t\tMD5_memcpy((POINTER)&context->buffer[index], (POINTER)input, partLen);\n\t\tMD5Transform(context->state, context->buffer);\n\t\tfor (i = partLen; i + 63 < inputLen; i += 64) {\n\t\t\tMD5Transform(context->state, &input[i]);\n\t\t}\n\t\tindex = 0;\n\t} else {\n\t\ti = 0;\n\t}\n\n\t/* Buffer remaining input */\n\tMD5_memcpy((POINTER)&context->buffer[index], (POINTER)&input[i], inputLen - i);\n}",
          "includes": [
            "#include \"md5.h\"",
            "#include \"global.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void MD5Transform",
            "static void MD5_memcpy"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"global.h\"\n#include \"config.h\"\n\nstatic void MD5Transform;\nstatic void MD5_memcpy;\n\nvoid\nMD5Update(MD5_CTX *context, unsigned char *input, unsigned int inputLen)\n{\n\tunsigned int i;\n\tunsigned int index;\n\tunsigned int partLen;\n\n\t/* Compute number of bytes mod 64 */\n\tindex = (unsigned int)((context->count[0] >> 3) & 0x3F);\n\n\t/* Update number of bits */\n\tif ((context->count[0] += ((UINT4)inputLen << 3)) < ((UINT4)inputLen << 3)) {\n\t\tcontext->count[1]++;\n\t}\n\tcontext->count[1] += ((UINT4)inputLen >> 29);\n\tpartLen = 64 - index;\n\n\t/* Transform as many times as possible. */\n\tif (inputLen >= partLen) {\n\t\tMD5_memcpy((POINTER)&context->buffer[index], (POINTER)input, partLen);\n\t\tMD5Transform(context->state, context->buffer);\n\t\tfor (i = partLen; i + 63 < inputLen; i += 64) {\n\t\t\tMD5Transform(context->state, &input[i]);\n\t\t}\n\t\tindex = 0;\n\t} else {\n\t\ti = 0;\n\t}\n\n\t/* Buffer remaining input */\n\tMD5_memcpy((POINTER)&context->buffer[index], (POINTER)&input[i], inputLen - i);\n}"
        }
      },
      {
        "call_info": {
          "callee": "MD5Init",
          "args": [
            "&c"
          ],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "MD5Init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/uuid/md5.c",
          "lines": "109-118",
          "snippet": "void\nMD5Init(MD5_CTX * context)\n{\n    context->count[0] = context->count[1] = 0;\n    /* Load magic initialization constants. */\n    context->state[0] = 0x67452301;\n    context->state[1] = 0xefcdab89;\n    context->state[2] = 0x98badcfe;\n    context->state[3] = 0x10325476;\n}",
          "includes": [
            "#include \"md5.h\"",
            "#include \"global.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"global.h\"\n#include \"config.h\"\n\nvoid\nMD5Init(MD5_CTX * context)\n{\n    context->count[0] = context->count[1] = 0;\n    /* Load magic initialization constants. */\n    context->state[0] = 0x67452301;\n    context->state[1] = 0xefcdab89;\n    context->state[2] = 0x98badcfe;\n    context->state[3] = 0x10325476;\n}"
        }
      },
      {
        "call_info": {
          "callee": "gethostname",
          "args": [
            "r.hostname",
            "256"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gettimeofday",
          "args": [
            "&r.t",
            "(struct timezone *)0"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&r",
            "0",
            "sizeof r"
          ],
          "line": 140
        },
        "resolved": true,
        "details": {
          "function_name": "MD5_memset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/uuid/md5.c",
          "lines": "345-352",
          "snippet": "static void\nMD5_memset(POINTER output, int value, unsigned int len)\n{\n\tunsigned int i;\n\tfor (i = 0; i < len; ++i) {\n\t\t((char *)output)[i] = (char)value;\n\t}\n}",
          "includes": [
            "#include \"md5.h\"",
            "#include \"global.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void MD5_memset"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"global.h\"\n#include \"config.h\"\n\nstatic void MD5_memset;\n\nstatic void\nMD5_memset(POINTER output, int value, unsigned int len)\n{\n\tunsigned int i;\n\tfor (i = 0; i < len; ++i) {\n\t\t((char *)output)[i] = (char)value;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdio.h>\n#include <string.h>\n#include \"UpnpInet.h\"\n#include \"sysdep.h\"\n#include \"config.h\"\n\nvoid get_random_info(unsigned char seed[16])\n{\n\tMD5_CTX c;\n\ttypedef struct {\n\t\t/*struct sysinfo s; */\n\t\tstruct timeval t;\n\t\tchar hostname[257];\n\t} randomness;\n\trandomness r;\n\n\t/* Initialize memory area so that valgrind does not complain. */\n\tmemset(&r, 0, sizeof r);\n\n\t/* Get some random stuff. */\n\tgettimeofday(&r.t, (struct timezone *)0);\n\tgethostname(r.hostname, 256);\n\n\t/* MD5 it */\n\tMD5Init(&c);\n\tMD5Update(&c, (unsigned char *)&r, sizeof r);\n\tMD5Final(seed, &c);\n}"
  },
  {
    "function_name": "get_system_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/uuid/sysdep.c",
    "lines": "115-127",
    "snippet": "void get_system_time(uuid_time_t *uuid_time)\n{\n\tstruct timeval tp;\n\n\tgettimeofday(&tp, (struct timezone *)0);\n\t/* Offset between UUID formatted times and Unix formatted times.\n\t * UUID UTC base time is October 15, 1582.\n\t * Unix base time is January 1, 1970. */\n\t*uuid_time =\n\t\t(uuid_time_t)tp.tv_sec * 10000000 +\n\t\t(uuid_time_t)tp.tv_usec * 10 +\n\t\t0x01B21DD213814000LL;\n}",
    "includes": [
      "#include <stdio.h>",
      "#include <string.h>",
      "#include \"UpnpInet.h\"",
      "#include \"sysdep.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gettimeofday",
          "args": [
            "&tp",
            "(struct timezone *)0"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdio.h>\n#include <string.h>\n#include \"UpnpInet.h\"\n#include \"sysdep.h\"\n#include \"config.h\"\n\nvoid get_system_time(uuid_time_t *uuid_time)\n{\n\tstruct timeval tp;\n\n\tgettimeofday(&tp, (struct timezone *)0);\n\t/* Offset between UUID formatted times and Unix formatted times.\n\t * UUID UTC base time is October 15, 1582.\n\t * Unix base time is January 1, 1970. */\n\t*uuid_time =\n\t\t(uuid_time_t)tp.tv_sec * 10000000 +\n\t\t(uuid_time_t)tp.tv_usec * 10 +\n\t\t0x01B21DD213814000LL;\n}"
  },
  {
    "function_name": "get_random_info",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/uuid/sysdep.c",
    "lines": "79-111",
    "snippet": "void get_random_info(unsigned char seed[16])\n{\n\tMD5_CTX c;\n\ttypedef struct {\n\t\tMEMORYSTATUS m;\n\t\tSYSTEM_INFO s;\n\t\tFILETIME t;\n\t\tLARGE_INTEGER pc;\n\t\tDWORD tc;\n\t\tDWORD l;\n\t\tchar hostname[MAX_COMPUTERNAME_LENGTH + 1];\n\t} randomness;\n\trandomness r;\n\n\t/* Initialize memory area so that valgrind does not complain */\n\tmemset(&r, 0, sizeof r);\n\t/* memory usage stats */\n\tGlobalMemoryStatus( &r.m );\n\t/* random system stats */\n\tGetSystemInfo( &r.s );\n\t/* 100ns resolution (nominally) time of day */\n\tGetSystemTimeAsFileTime( &r.t );\n\t/* high resolution performance counter */\n\tQueryPerformanceCounter( &r.pc );\n\t/* milliseconds since last boot */\n\tr.tc = GetTickCount();\n\tr.l = MAX_COMPUTERNAME_LENGTH + 1;\n\tGetComputerName( r.hostname, &r.l );\n\t/* MD5 it */\n\tMD5Init(&c);\n\tMD5Update(&c, (unsigned char *)(&r), sizeof r);\n\tMD5Final(seed, &c);\n}",
    "includes": [
      "#include <stdio.h>",
      "#include <string.h>",
      "#include \"UpnpInet.h\"",
      "#include \"sysdep.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "MD5Final",
          "args": [
            "seed",
            "&c"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "MD5Final",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/uuid/md5.c",
          "lines": "163-186",
          "snippet": "void\nMD5Final(unsigned char digest[16], MD5_CTX *context)\n{\n    unsigned char bits[8];\n    unsigned int index;\n    unsigned int padLen;\n\n    /* Save number of bits */\n    Encode(bits, context->count, 8);\n\n    /* Pad out to 56 mod 64. */\n    index = (unsigned int)((context->count[0] >> 3) & 0x3f);\n    padLen = (index < 56) ? (56 - index) : (120 - index);\n    MD5Update(context, PADDING, padLen);\n\n    /* Append length (before padding) */\n    MD5Update(context, bits, 8);\n\n    /* Store state in digest */\n    Encode(digest, context->state, 16);\n\n    /* Zeroize sensitive information. */\n    MD5_memset((POINTER)context, 0, sizeof(*context));\n}",
          "includes": [
            "#include \"md5.h\"",
            "#include \"global.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void Encode",
            "static void MD5_memset",
            "static unsigned char PADDING[64] = {\n    0x80, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"global.h\"\n#include \"config.h\"\n\nstatic void Encode;\nstatic void MD5_memset;\nstatic unsigned char PADDING[64] = {\n    0x80, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0\n};\n\nvoid\nMD5Final(unsigned char digest[16], MD5_CTX *context)\n{\n    unsigned char bits[8];\n    unsigned int index;\n    unsigned int padLen;\n\n    /* Save number of bits */\n    Encode(bits, context->count, 8);\n\n    /* Pad out to 56 mod 64. */\n    index = (unsigned int)((context->count[0] >> 3) & 0x3f);\n    padLen = (index < 56) ? (56 - index) : (120 - index);\n    MD5Update(context, PADDING, padLen);\n\n    /* Append length (before padding) */\n    MD5Update(context, bits, 8);\n\n    /* Store state in digest */\n    Encode(digest, context->state, 16);\n\n    /* Zeroize sensitive information. */\n    MD5_memset((POINTER)context, 0, sizeof(*context));\n}"
        }
      },
      {
        "call_info": {
          "callee": "MD5Update",
          "args": [
            "&c",
            "(unsigned char *)(&r)",
            "sizeof r"
          ],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "MD5Update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/uuid/md5.c",
          "lines": "126-157",
          "snippet": "void\nMD5Update(MD5_CTX *context, unsigned char *input, unsigned int inputLen)\n{\n\tunsigned int i;\n\tunsigned int index;\n\tunsigned int partLen;\n\n\t/* Compute number of bytes mod 64 */\n\tindex = (unsigned int)((context->count[0] >> 3) & 0x3F);\n\n\t/* Update number of bits */\n\tif ((context->count[0] += ((UINT4)inputLen << 3)) < ((UINT4)inputLen << 3)) {\n\t\tcontext->count[1]++;\n\t}\n\tcontext->count[1] += ((UINT4)inputLen >> 29);\n\tpartLen = 64 - index;\n\n\t/* Transform as many times as possible. */\n\tif (inputLen >= partLen) {\n\t\tMD5_memcpy((POINTER)&context->buffer[index], (POINTER)input, partLen);\n\t\tMD5Transform(context->state, context->buffer);\n\t\tfor (i = partLen; i + 63 < inputLen; i += 64) {\n\t\t\tMD5Transform(context->state, &input[i]);\n\t\t}\n\t\tindex = 0;\n\t} else {\n\t\ti = 0;\n\t}\n\n\t/* Buffer remaining input */\n\tMD5_memcpy((POINTER)&context->buffer[index], (POINTER)&input[i], inputLen - i);\n}",
          "includes": [
            "#include \"md5.h\"",
            "#include \"global.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void MD5Transform",
            "static void MD5_memcpy"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"global.h\"\n#include \"config.h\"\n\nstatic void MD5Transform;\nstatic void MD5_memcpy;\n\nvoid\nMD5Update(MD5_CTX *context, unsigned char *input, unsigned int inputLen)\n{\n\tunsigned int i;\n\tunsigned int index;\n\tunsigned int partLen;\n\n\t/* Compute number of bytes mod 64 */\n\tindex = (unsigned int)((context->count[0] >> 3) & 0x3F);\n\n\t/* Update number of bits */\n\tif ((context->count[0] += ((UINT4)inputLen << 3)) < ((UINT4)inputLen << 3)) {\n\t\tcontext->count[1]++;\n\t}\n\tcontext->count[1] += ((UINT4)inputLen >> 29);\n\tpartLen = 64 - index;\n\n\t/* Transform as many times as possible. */\n\tif (inputLen >= partLen) {\n\t\tMD5_memcpy((POINTER)&context->buffer[index], (POINTER)input, partLen);\n\t\tMD5Transform(context->state, context->buffer);\n\t\tfor (i = partLen; i + 63 < inputLen; i += 64) {\n\t\t\tMD5Transform(context->state, &input[i]);\n\t\t}\n\t\tindex = 0;\n\t} else {\n\t\ti = 0;\n\t}\n\n\t/* Buffer remaining input */\n\tMD5_memcpy((POINTER)&context->buffer[index], (POINTER)&input[i], inputLen - i);\n}"
        }
      },
      {
        "call_info": {
          "callee": "MD5Init",
          "args": [
            "&c"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "MD5Init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/uuid/md5.c",
          "lines": "109-118",
          "snippet": "void\nMD5Init(MD5_CTX * context)\n{\n    context->count[0] = context->count[1] = 0;\n    /* Load magic initialization constants. */\n    context->state[0] = 0x67452301;\n    context->state[1] = 0xefcdab89;\n    context->state[2] = 0x98badcfe;\n    context->state[3] = 0x10325476;\n}",
          "includes": [
            "#include \"md5.h\"",
            "#include \"global.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"global.h\"\n#include \"config.h\"\n\nvoid\nMD5Init(MD5_CTX * context)\n{\n    context->count[0] = context->count[1] = 0;\n    /* Load magic initialization constants. */\n    context->state[0] = 0x67452301;\n    context->state[1] = 0xefcdab89;\n    context->state[2] = 0x98badcfe;\n    context->state[3] = 0x10325476;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetComputerName",
          "args": [
            "r.hostname",
            "&r.l"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetTickCount",
          "args": [],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QueryPerformanceCounter",
          "args": [
            "&r.pc"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetSystemTimeAsFileTime",
          "args": [
            "&r.t"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetSystemInfo",
          "args": [
            "&r.s"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GlobalMemoryStatus",
          "args": [
            "&r.m"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&r",
            "0",
            "sizeof r"
          ],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "MD5_memset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/uuid/md5.c",
          "lines": "345-352",
          "snippet": "static void\nMD5_memset(POINTER output, int value, unsigned int len)\n{\n\tunsigned int i;\n\tfor (i = 0; i < len; ++i) {\n\t\t((char *)output)[i] = (char)value;\n\t}\n}",
          "includes": [
            "#include \"md5.h\"",
            "#include \"global.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void MD5_memset"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"global.h\"\n#include \"config.h\"\n\nstatic void MD5_memset;\n\nstatic void\nMD5_memset(POINTER output, int value, unsigned int len)\n{\n\tunsigned int i;\n\tfor (i = 0; i < len; ++i) {\n\t\t((char *)output)[i] = (char)value;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdio.h>\n#include <string.h>\n#include \"UpnpInet.h\"\n#include \"sysdep.h\"\n#include \"config.h\"\n\nvoid get_random_info(unsigned char seed[16])\n{\n\tMD5_CTX c;\n\ttypedef struct {\n\t\tMEMORYSTATUS m;\n\t\tSYSTEM_INFO s;\n\t\tFILETIME t;\n\t\tLARGE_INTEGER pc;\n\t\tDWORD tc;\n\t\tDWORD l;\n\t\tchar hostname[MAX_COMPUTERNAME_LENGTH + 1];\n\t} randomness;\n\trandomness r;\n\n\t/* Initialize memory area so that valgrind does not complain */\n\tmemset(&r, 0, sizeof r);\n\t/* memory usage stats */\n\tGlobalMemoryStatus( &r.m );\n\t/* random system stats */\n\tGetSystemInfo( &r.s );\n\t/* 100ns resolution (nominally) time of day */\n\tGetSystemTimeAsFileTime( &r.t );\n\t/* high resolution performance counter */\n\tQueryPerformanceCounter( &r.pc );\n\t/* milliseconds since last boot */\n\tr.tc = GetTickCount();\n\tr.l = MAX_COMPUTERNAME_LENGTH + 1;\n\tGetComputerName( r.hostname, &r.l );\n\t/* MD5 it */\n\tMD5Init(&c);\n\tMD5Update(&c, (unsigned char *)(&r), sizeof r);\n\tMD5Final(seed, &c);\n}"
  },
  {
    "function_name": "get_system_time",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/uuid/sysdep.c",
    "lines": "62-77",
    "snippet": "void get_system_time(uuid_time_t *uuid_time)\n{\n\tULARGE_INTEGER time;\n\n\tGetSystemTimeAsFileTime((FILETIME *) & time);\n\t/*\n\t   NT keeps time in FILETIME format which is 100ns ticks since\n\t   Jan 1, 1601.  UUIDs use time in 100ns ticks since Oct 15, 1582.\n\t   The difference is 17 Days in Oct + 30 (Nov) + 31 (Dec)\n\t   + 18 years and 5 leap days.\n\t */\n\ttime.QuadPart += (unsigned __int64)(1000 * 1000 * 10)\t/* seconds */\n\t    *(unsigned __int64)(60 * 60 * 24)\t/* days */\n\t    *(unsigned __int64)(17 + 30 + 31 + 365 * 18 + 5);\t/* # of days */\n\t*uuid_time = time.QuadPart;\n}",
    "includes": [
      "#include <stdio.h>",
      "#include <string.h>",
      "#include \"UpnpInet.h\"",
      "#include \"sysdep.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetSystemTimeAsFileTime",
          "args": [
            "(FILETIME *) & time"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdio.h>\n#include <string.h>\n#include \"UpnpInet.h\"\n#include \"sysdep.h\"\n#include \"config.h\"\n\nvoid get_system_time(uuid_time_t *uuid_time)\n{\n\tULARGE_INTEGER time;\n\n\tGetSystemTimeAsFileTime((FILETIME *) & time);\n\t/*\n\t   NT keeps time in FILETIME format which is 100ns ticks since\n\t   Jan 1, 1601.  UUIDs use time in 100ns ticks since Oct 15, 1582.\n\t   The difference is 17 Days in Oct + 30 (Nov) + 31 (Dec)\n\t   + 18 years and 5 leap days.\n\t */\n\ttime.QuadPart += (unsigned __int64)(1000 * 1000 * 10)\t/* seconds */\n\t    *(unsigned __int64)(60 * 60 * 24)\t/* days */\n\t    *(unsigned __int64)(17 + 30 + 31 + 365 * 18 + 5);\t/* # of days */\n\t*uuid_time = time.QuadPart;\n}"
  },
  {
    "function_name": "get_ieee_node_identifier",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/uuid/sysdep.c",
    "lines": "38-51",
    "snippet": "void get_ieee_node_identifier(uuid_node_t *node)\n{\n\tunsigned char seed[16];\n\tstatic int inited = 0;\n\tstatic uuid_node_t saved_node;\n\n\tif (!inited) {\n\t\tget_random_info(seed);\n\t\tseed[0] |= 0x80;\n\t\tmemcpy(&saved_node, seed, sizeof(uuid_node_t));\n\t\tinited = 1;\n\t};\n\t*node = saved_node;\n}",
    "includes": [
      "#include <stdio.h>",
      "#include <string.h>",
      "#include \"UpnpInet.h\"",
      "#include \"sysdep.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&saved_node",
            "seed",
            "sizeof(uuid_node_t)"
          ],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "MD5_memcpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/uuid/md5.c",
          "lines": "333-340",
          "snippet": "static void\nMD5_memcpy(POINTER  output, POINTER  input, unsigned int len)\n{\n\tunsigned int i;\n\tfor (i = 0; i < len; ++i) {\n\t\toutput[i] = input[i];\n\t}\n}",
          "includes": [
            "#include \"md5.h\"",
            "#include \"global.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void MD5_memcpy"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"global.h\"\n#include \"config.h\"\n\nstatic void MD5_memcpy;\n\nstatic void\nMD5_memcpy(POINTER  output, POINTER  input, unsigned int len)\n{\n\tunsigned int i;\n\tfor (i = 0; i < len; ++i) {\n\t\toutput[i] = input[i];\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_random_info",
          "args": [
            "seed"
          ],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "get_random_info",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/uuid/sysdep.c",
          "lines": "129-150",
          "snippet": "void get_random_info(unsigned char seed[16])\n{\n\tMD5_CTX c;\n\ttypedef struct {\n\t\t/*struct sysinfo s; */\n\t\tstruct timeval t;\n\t\tchar hostname[257];\n\t} randomness;\n\trandomness r;\n\n\t/* Initialize memory area so that valgrind does not complain. */\n\tmemset(&r, 0, sizeof r);\n\n\t/* Get some random stuff. */\n\tgettimeofday(&r.t, (struct timezone *)0);\n\tgethostname(r.hostname, 256);\n\n\t/* MD5 it */\n\tMD5Init(&c);\n\tMD5Update(&c, (unsigned char *)&r, sizeof r);\n\tMD5Final(seed, &c);\n}",
          "includes": [
            "#include <stdio.h>",
            "#include <string.h>",
            "#include \"UpnpInet.h\"",
            "#include \"sysdep.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <string.h>\n#include \"UpnpInet.h\"\n#include \"sysdep.h\"\n#include \"config.h\"\n\nvoid get_random_info(unsigned char seed[16])\n{\n\tMD5_CTX c;\n\ttypedef struct {\n\t\t/*struct sysinfo s; */\n\t\tstruct timeval t;\n\t\tchar hostname[257];\n\t} randomness;\n\trandomness r;\n\n\t/* Initialize memory area so that valgrind does not complain. */\n\tmemset(&r, 0, sizeof r);\n\n\t/* Get some random stuff. */\n\tgettimeofday(&r.t, (struct timezone *)0);\n\tgethostname(r.hostname, 256);\n\n\t/* MD5 it */\n\tMD5Init(&c);\n\tMD5Update(&c, (unsigned char *)&r, sizeof r);\n\tMD5Final(seed, &c);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdio.h>\n#include <string.h>\n#include \"UpnpInet.h\"\n#include \"sysdep.h\"\n#include \"config.h\"\n\nvoid get_ieee_node_identifier(uuid_node_t *node)\n{\n\tunsigned char seed[16];\n\tstatic int inited = 0;\n\tstatic uuid_node_t saved_node;\n\n\tif (!inited) {\n\t\tget_random_info(seed);\n\t\tseed[0] |= 0x80;\n\t\tmemcpy(&saved_node, seed, sizeof(uuid_node_t));\n\t\tinited = 1;\n\t};\n\t*node = saved_node;\n}"
  }
]