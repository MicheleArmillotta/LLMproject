[
  {
    "function_name": "GetClientSubActualSID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/client_table/client_table.c",
    "lines": "101-115",
    "snippet": "GenlibClientSubscription *GetClientSubActualSID(GenlibClientSubscription *head, token *sid)\n{\n\tGenlibClientSubscription *next = head;\n\twhile (next) {\n\t\tif (!memcmp(\n\t\t\tGenlibClientSubscription_get_ActualSID_cstr(next),\n\t\t\tsid->buff, sid->size)) {\n\t\t\tbreak;\n\t\t} else {\n\t\t\tnext = GenlibClientSubscription_get_Next(next);\n\t\t}\n\t}\n\n\treturn next;\n}",
    "includes": [
      "#include <stdlib.h> /* for calloc(), free() */",
      "#include \"client_table.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GenlibClientSubscription_get_Next",
          "args": [
            "next"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "GenlibClientSubscription_get_ActualSID_cstr(next)",
            "sid->buff",
            "sid->size"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GenlibClientSubscription_get_ActualSID_cstr",
          "args": [
            "next"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdlib.h> /* for calloc(), free() */\n#include \"client_table.h\"\n#include \"config.h\"\n\nGenlibClientSubscription *GetClientSubActualSID(GenlibClientSubscription *head, token *sid)\n{\n\tGenlibClientSubscription *next = head;\n\twhile (next) {\n\t\tif (!memcmp(\n\t\t\tGenlibClientSubscription_get_ActualSID_cstr(next),\n\t\t\tsid->buff, sid->size)) {\n\t\t\tbreak;\n\t\t} else {\n\t\t\tnext = GenlibClientSubscription_get_Next(next);\n\t\t}\n\t}\n\n\treturn next;\n}"
  },
  {
    "function_name": "GetClientSubClientSID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/client_table/client_table.c",
    "lines": "82-98",
    "snippet": "GenlibClientSubscription *GetClientSubClientSID(GenlibClientSubscription *head, const UpnpString *sid)\n{\n\tGenlibClientSubscription *next = head;\n\tint found = 0;\n\twhile (next) {\n\t\tfound = !strcmp(\n\t\t\tGenlibClientSubscription_get_SID_cstr(next),\n\t\t\tUpnpString_get_String(sid));\n\t\tif(found) {\n\t\t\tbreak;\n\t\t} else {\n\t\t\tnext = GenlibClientSubscription_get_Next(next);\n\t\t}\n\t}\n\n\treturn next;\n}",
    "includes": [
      "#include <stdlib.h> /* for calloc(), free() */",
      "#include \"client_table.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GenlibClientSubscription_get_Next",
          "args": [
            "next"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "GenlibClientSubscription_get_SID_cstr(next)",
            "UpnpString_get_String(sid)"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "UpnpString_get_String",
          "args": [
            "sid"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "UpnpString_get_String",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/UpnpString.c",
          "lines": "155-158",
          "snippet": "const char *UpnpString_get_String(const UpnpString *p)\n{\n\treturn ((struct SUpnpString *)p)->m_string;\n}",
          "includes": [
            "#include <string.h> /* for strlen(), strdup() */",
            "#include <stdlib.h> /* for calloc(), free() */",
            "#include \"UpnpString.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h> /* for strlen(), strdup() */\n#include <stdlib.h> /* for calloc(), free() */\n#include \"UpnpString.h\"\n#include \"config.h\"\n\nconst char *UpnpString_get_String(const UpnpString *p)\n{\n\treturn ((struct SUpnpString *)p)->m_string;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GenlibClientSubscription_get_SID_cstr",
          "args": [
            "next"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdlib.h> /* for calloc(), free() */\n#include \"client_table.h\"\n#include \"config.h\"\n\nGenlibClientSubscription *GetClientSubClientSID(GenlibClientSubscription *head, const UpnpString *sid)\n{\n\tGenlibClientSubscription *next = head;\n\tint found = 0;\n\twhile (next) {\n\t\tfound = !strcmp(\n\t\t\tGenlibClientSubscription_get_SID_cstr(next),\n\t\t\tUpnpString_get_String(sid));\n\t\tif(found) {\n\t\t\tbreak;\n\t\t} else {\n\t\t\tnext = GenlibClientSubscription_get_Next(next);\n\t\t}\n\t}\n\n\treturn next;\n}"
  },
  {
    "function_name": "RemoveClientSubClientSID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/client_table/client_table.c",
    "lines": "55-79",
    "snippet": "void RemoveClientSubClientSID(GenlibClientSubscription **head, const UpnpString *sid)\n{\n\tGenlibClientSubscription *finger = *head;\n\tGenlibClientSubscription *previous = NULL;\n\tint found = 0;\n\twhile (finger) {\n\t\tfound = !strcmp(\n\t\t\tUpnpString_get_String(sid),\n\t\t\tGenlibClientSubscription_get_SID_cstr(finger));\n\t\tif (found) {\n\t\t\tif (previous) {\n\t\t\t\tGenlibClientSubscription_set_Next(previous,\n\t\t\t\t\tGenlibClientSubscription_get_Next(finger));\n\t\t\t} else {\n\t\t\t\t*head = GenlibClientSubscription_get_Next(finger);\n\t\t\t}\n\t\t\tGenlibClientSubscription_set_Next(finger, NULL);\n\t\t\tfreeClientSubList(finger);\n\t\t\tfinger = NULL;\n\t\t} else {\n\t\t\tprevious = finger;\n\t\t\tfinger = GenlibClientSubscription_get_Next(finger);\n\t\t}\n\t}\n}",
    "includes": [
      "#include <stdlib.h> /* for calloc(), free() */",
      "#include \"client_table.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GenlibClientSubscription_get_Next",
          "args": [
            "finger"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "freeClientSubList",
          "args": [
            "finger"
          ],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "freeClientSubList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/client_table/client_table.c",
          "lines": "43-52",
          "snippet": "void freeClientSubList(GenlibClientSubscription *list)\n{\n\tGenlibClientSubscription *next;\n\twhile (list) {\n\t\tfree_client_subscription(list);\n\t\tnext = GenlibClientSubscription_get_Next(list);\n\t\tGenlibClientSubscription_delete(list);\n\t\tlist = next;\n\t}\n}",
          "includes": [
            "#include <stdlib.h> /* for calloc(), free() */",
            "#include \"client_table.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdlib.h> /* for calloc(), free() */\n#include \"client_table.h\"\n#include \"config.h\"\n\nvoid freeClientSubList(GenlibClientSubscription *list)\n{\n\tGenlibClientSubscription *next;\n\twhile (list) {\n\t\tfree_client_subscription(list);\n\t\tnext = GenlibClientSubscription_get_Next(list);\n\t\tGenlibClientSubscription_delete(list);\n\t\tlist = next;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "GenlibClientSubscription_set_Next",
          "args": [
            "finger",
            "NULL"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GenlibClientSubscription_get_Next",
          "args": [
            "finger"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GenlibClientSubscription_set_Next",
          "args": [
            "previous",
            "GenlibClientSubscription_get_Next(finger)"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GenlibClientSubscription_get_Next",
          "args": [
            "finger"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "UpnpString_get_String(sid)",
            "GenlibClientSubscription_get_SID_cstr(finger)"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GenlibClientSubscription_get_SID_cstr",
          "args": [
            "finger"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "UpnpString_get_String",
          "args": [
            "sid"
          ],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "UpnpString_get_String",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/UpnpString.c",
          "lines": "155-158",
          "snippet": "const char *UpnpString_get_String(const UpnpString *p)\n{\n\treturn ((struct SUpnpString *)p)->m_string;\n}",
          "includes": [
            "#include <string.h> /* for strlen(), strdup() */",
            "#include <stdlib.h> /* for calloc(), free() */",
            "#include \"UpnpString.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h> /* for strlen(), strdup() */\n#include <stdlib.h> /* for calloc(), free() */\n#include \"UpnpString.h\"\n#include \"config.h\"\n\nconst char *UpnpString_get_String(const UpnpString *p)\n{\n\treturn ((struct SUpnpString *)p)->m_string;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdlib.h> /* for calloc(), free() */\n#include \"client_table.h\"\n#include \"config.h\"\n\nvoid RemoveClientSubClientSID(GenlibClientSubscription **head, const UpnpString *sid)\n{\n\tGenlibClientSubscription *finger = *head;\n\tGenlibClientSubscription *previous = NULL;\n\tint found = 0;\n\twhile (finger) {\n\t\tfound = !strcmp(\n\t\t\tUpnpString_get_String(sid),\n\t\t\tGenlibClientSubscription_get_SID_cstr(finger));\n\t\tif (found) {\n\t\t\tif (previous) {\n\t\t\t\tGenlibClientSubscription_set_Next(previous,\n\t\t\t\t\tGenlibClientSubscription_get_Next(finger));\n\t\t\t} else {\n\t\t\t\t*head = GenlibClientSubscription_get_Next(finger);\n\t\t\t}\n\t\t\tGenlibClientSubscription_set_Next(finger, NULL);\n\t\t\tfreeClientSubList(finger);\n\t\t\tfinger = NULL;\n\t\t} else {\n\t\t\tprevious = finger;\n\t\t\tfinger = GenlibClientSubscription_get_Next(finger);\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "freeClientSubList",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/client_table/client_table.c",
    "lines": "43-52",
    "snippet": "void freeClientSubList(GenlibClientSubscription *list)\n{\n\tGenlibClientSubscription *next;\n\twhile (list) {\n\t\tfree_client_subscription(list);\n\t\tnext = GenlibClientSubscription_get_Next(list);\n\t\tGenlibClientSubscription_delete(list);\n\t\tlist = next;\n\t}\n}",
    "includes": [
      "#include <stdlib.h> /* for calloc(), free() */",
      "#include \"client_table.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GenlibClientSubscription_delete",
          "args": [
            "list"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GenlibClientSubscription_get_Next",
          "args": [
            "list"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free_client_subscription",
          "args": [
            "list"
          ],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "free_client_subscription",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/client_table/client_table.c",
          "lines": "22-40",
          "snippet": "void free_client_subscription(GenlibClientSubscription *sub)\n{\n\tupnp_timeout *event;\n\tThreadPoolJob tempJob;\n\tif (sub) {\n\t\tint renewEventId = GenlibClientSubscription_get_RenewEventId(sub);\n\t\tGenlibClientSubscription_strcpy_ActualSID(sub, \"\");\n\t\tGenlibClientSubscription_strcpy_EventURL(sub, \"\");\n\t\tif (renewEventId != -1) {\n\t\t\t/* do not remove timer event of copy */\n\t\t\t/* invalid timer event id */\n\t\t\tif (TimerThreadRemove(&gTimerThread, renewEventId, &tempJob) == 0) {\n\t\t\t\tevent = (upnp_timeout *)tempJob.arg;\n\t\t\t\tfree_upnp_timeout(event);\n\t\t\t}\n\t\t}\n\t\tGenlibClientSubscription_set_RenewEventId(sub, -1);\n\t}\n}",
          "includes": [
            "#include <stdlib.h> /* for calloc(), free() */",
            "#include \"client_table.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdlib.h> /* for calloc(), free() */\n#include \"client_table.h\"\n#include \"config.h\"\n\nvoid free_client_subscription(GenlibClientSubscription *sub)\n{\n\tupnp_timeout *event;\n\tThreadPoolJob tempJob;\n\tif (sub) {\n\t\tint renewEventId = GenlibClientSubscription_get_RenewEventId(sub);\n\t\tGenlibClientSubscription_strcpy_ActualSID(sub, \"\");\n\t\tGenlibClientSubscription_strcpy_EventURL(sub, \"\");\n\t\tif (renewEventId != -1) {\n\t\t\t/* do not remove timer event of copy */\n\t\t\t/* invalid timer event id */\n\t\t\tif (TimerThreadRemove(&gTimerThread, renewEventId, &tempJob) == 0) {\n\t\t\t\tevent = (upnp_timeout *)tempJob.arg;\n\t\t\t\tfree_upnp_timeout(event);\n\t\t\t}\n\t\t}\n\t\tGenlibClientSubscription_set_RenewEventId(sub, -1);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdlib.h> /* for calloc(), free() */\n#include \"client_table.h\"\n#include \"config.h\"\n\nvoid freeClientSubList(GenlibClientSubscription *list)\n{\n\tGenlibClientSubscription *next;\n\twhile (list) {\n\t\tfree_client_subscription(list);\n\t\tnext = GenlibClientSubscription_get_Next(list);\n\t\tGenlibClientSubscription_delete(list);\n\t\tlist = next;\n\t}\n}"
  },
  {
    "function_name": "free_client_subscription",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/client_table/client_table.c",
    "lines": "22-40",
    "snippet": "void free_client_subscription(GenlibClientSubscription *sub)\n{\n\tupnp_timeout *event;\n\tThreadPoolJob tempJob;\n\tif (sub) {\n\t\tint renewEventId = GenlibClientSubscription_get_RenewEventId(sub);\n\t\tGenlibClientSubscription_strcpy_ActualSID(sub, \"\");\n\t\tGenlibClientSubscription_strcpy_EventURL(sub, \"\");\n\t\tif (renewEventId != -1) {\n\t\t\t/* do not remove timer event of copy */\n\t\t\t/* invalid timer event id */\n\t\t\tif (TimerThreadRemove(&gTimerThread, renewEventId, &tempJob) == 0) {\n\t\t\t\tevent = (upnp_timeout *)tempJob.arg;\n\t\t\t\tfree_upnp_timeout(event);\n\t\t\t}\n\t\t}\n\t\tGenlibClientSubscription_set_RenewEventId(sub, -1);\n\t}\n}",
    "includes": [
      "#include <stdlib.h> /* for calloc(), free() */",
      "#include \"client_table.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GenlibClientSubscription_set_RenewEventId",
          "args": [
            "sub",
            "-1"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free_upnp_timeout",
          "args": [
            "event"
          ],
          "line": 35
        },
        "resolved": true,
        "details": {
          "function_name": "free_upnp_timeout",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/util/upnp_timeout.c",
          "lines": "50-58",
          "snippet": "void free_upnp_timeout(upnp_timeout *event)\n{\n\tif (event) {\n\t\tif (event->Event) {\n\t\t\tfree(event->Event);\n\t\t}\n\t\tfree(event);\n\t}\n}",
          "includes": [
            "#include <stdlib.h> /* for free() */",
            "#include \"upnp_timeout.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdlib.h> /* for free() */\n#include \"upnp_timeout.h\"\n#include \"config.h\"\n\nvoid free_upnp_timeout(upnp_timeout *event)\n{\n\tif (event) {\n\t\tif (event->Event) {\n\t\t\tfree(event->Event);\n\t\t}\n\t\tfree(event);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "TimerThreadRemove",
          "args": [
            "&gTimerThread",
            "renewEventId",
            "&tempJob"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GenlibClientSubscription_strcpy_EventURL",
          "args": [
            "sub",
            "\"\""
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GenlibClientSubscription_strcpy_ActualSID",
          "args": [
            "sub",
            "\"\""
          ],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GenlibClientSubscription_get_RenewEventId",
          "args": [
            "sub"
          ],
          "line": 27
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdlib.h> /* for calloc(), free() */\n#include \"client_table.h\"\n#include \"config.h\"\n\nvoid free_client_subscription(GenlibClientSubscription *sub)\n{\n\tupnp_timeout *event;\n\tThreadPoolJob tempJob;\n\tif (sub) {\n\t\tint renewEventId = GenlibClientSubscription_get_RenewEventId(sub);\n\t\tGenlibClientSubscription_strcpy_ActualSID(sub, \"\");\n\t\tGenlibClientSubscription_strcpy_EventURL(sub, \"\");\n\t\tif (renewEventId != -1) {\n\t\t\t/* do not remove timer event of copy */\n\t\t\t/* invalid timer event id */\n\t\t\tif (TimerThreadRemove(&gTimerThread, renewEventId, &tempJob) == 0) {\n\t\t\t\tevent = (upnp_timeout *)tempJob.arg;\n\t\t\t\tfree_upnp_timeout(event);\n\t\t\t}\n\t\t}\n\t\tGenlibClientSubscription_set_RenewEventId(sub, -1);\n\t}\n}"
  }
]