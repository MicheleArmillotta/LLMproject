[
  {
    "function_name": "http_get_code_text",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/net/http/statcodes.c",
    "lines": "178-216",
    "snippet": "const char *\nhttp_get_code_text( int statusCode )\n{\n    int index;\n    int table_num;\n\n    if( !gInitialized ) {\n        init_tables();\n    }\n\n    if( statusCode < 100 || statusCode >= 600 ) {\n        return NULL;\n    }\n\n    index = statusCode % 100;\n    table_num = statusCode / 100;\n\n    if( table_num == 1 && index < NUM_1XX_CODES ) {\n        return Http1xxCodes[index];\n    }\n\n    if( table_num == 2 && index < NUM_2XX_CODES ) {\n        return Http2xxCodes[index];\n    }\n\n    if( table_num == 3 && index < NUM_3XX_CODES ) {\n        return Http3xxCodes[index];\n    }\n\n    if( table_num == 4 && index < NUM_4XX_CODES ) {\n        return Http4xxCodes[index];\n    }\n\n    if( table_num == 5 && index < NUM_5XX_CODES ) {\n        return Http5xxCodes[index];\n    }\n\n    return NULL;\n}",
    "includes": [
      "#include \"unixutil.h\"",
      "#include \"statcodes.h\"",
      "#include \"upnputil.h\"",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [
      "#define NUM_5XX_CODES   11",
      "#define NUM_4XX_CODES   18",
      "#define NUM_3XX_CODES   8",
      "#define NUM_2XX_CODES   7",
      "#define NUM_1XX_CODES   2"
    ],
    "globals_used": [
      "static const char *Http1xxCodes[NUM_1XX_CODES];",
      "static const char *Http2xxCodes[NUM_2XX_CODES];",
      "static const char *Http3xxCodes[NUM_3XX_CODES];",
      "static const char *Http4xxCodes[NUM_4XX_CODES];",
      "static const char *Http5xxCodes[NUM_5XX_CODES];",
      "static int gInitialized = FALSE;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "init_tables",
          "args": [],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "init_tables",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/net/http/statcodes.c",
          "lines": "153-163",
          "snippet": "static UPNP_INLINE void\ninit_tables( void )\n{\n    init_table( Http1xxStr, Http1xxCodes, NUM_1XX_CODES );\n    init_table( Http2xxStr, Http2xxCodes, NUM_2XX_CODES );\n    init_table( Http3xxStr, Http3xxCodes, NUM_3XX_CODES );\n    init_table( Http4xxStr, Http4xxCodes, NUM_4XX_CODES );\n    init_table( Http5xxStr, Http5xxCodes, NUM_5XX_CODES );\n\n    gInitialized = TRUE;        /* mark only after complete */\n}",
          "includes": [
            "#include \"unixutil.h\"",
            "#include \"statcodes.h\"",
            "#include \"upnputil.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [
            "#define NUM_5XX_CODES   11",
            "#define NUM_4XX_CODES   18",
            "#define NUM_3XX_CODES   8",
            "#define NUM_2XX_CODES   7",
            "#define NUM_1XX_CODES   2"
          ],
          "globals_used": [
            "static const char *Http1xxCodes[NUM_1XX_CODES];",
            "static const char *Http1xxStr = \"Continue\\0\" \"Switching Protocols\\0\";",
            "static const char *Http2xxCodes[NUM_2XX_CODES];",
            "static const char *Http2xxStr =\n    \"OK\\0\"\n    \"Created\\0\"\n    \"Accepted\\0\"\n    \"Non-Authoratative Information\\0\"\n    \"No Content\\0\" \"Reset Content\\0\" \"Partial Content\\0\";",
            "static const char *Http3xxCodes[NUM_3XX_CODES];",
            "static const char *Http3xxStr =\n    \"Multiple Choices\\0\"\n    \"Moved Permanently\\0\"\n    \"Found\\0\"\n    \"See Other\\0\"\n    \"Not Modified\\0\" \"Use Proxy\\0\" \"\\0\" \"Temporary Redirect\\0\";",
            "static const char *Http4xxCodes[NUM_4XX_CODES];",
            "static const char *Http4xxStr =\n    \"Bad Request\\0\"\n    \"Unauthorized\\0\"\n    \"Payment Required\\0\"\n    \"Forbidden\\0\"\n    \"Not Found\\0\"\n    \"Method Not Allowed\\0\"\n    \"Not Acceptable\\0\"\n    \"Proxy Authentication Required\\0\"\n    \"Request Timeout\\0\"\n    \"Conflict\\0\"\n    \"Gone\\0\"\n    \"Length Required\\0\"\n    \"Precondition Failed\\0\"\n    \"Request Entity Too Large\\0\"\n    \"Request-URI Too Long\\0\"\n    \"Unsupported Media Type\\0\"\n    \"Requested Range Not Satisfiable\\0\" \"Expectation Failed\\0\";",
            "static const char *Http5xxCodes[NUM_5XX_CODES];",
            "static const char *Http5xxStr =\n    \"Internal Server Error\\0\"\n    \"Not Implemented\\0\"\n    \"Bad Gateway\\0\"\n    \"Service Unavailable\\0\"\n    \"Gateway Timeout\\0\"\n    \"HTTP Version Not Supported\\0\"\n    \"Variant Also Negotiates\\0\"\n    \"Insufficient Storage\\0\"\n    \"Loop Detected\\0\"\n    \"\\0\" \"Not Extended\\0\";",
            "static int gInitialized = FALSE;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"unixutil.h\"\n#include \"statcodes.h\"\n#include \"upnputil.h\"\n#include <string.h>\n#include <stdio.h>\n#include \"config.h\"\n\n#define NUM_5XX_CODES   11\n#define NUM_4XX_CODES   18\n#define NUM_3XX_CODES   8\n#define NUM_2XX_CODES   7\n#define NUM_1XX_CODES   2\n\nstatic const char *Http1xxCodes[NUM_1XX_CODES];\nstatic const char *Http1xxStr = \"Continue\\0\" \"Switching Protocols\\0\";\nstatic const char *Http2xxCodes[NUM_2XX_CODES];\nstatic const char *Http2xxStr =\n    \"OK\\0\"\n    \"Created\\0\"\n    \"Accepted\\0\"\n    \"Non-Authoratative Information\\0\"\n    \"No Content\\0\" \"Reset Content\\0\" \"Partial Content\\0\";\nstatic const char *Http3xxCodes[NUM_3XX_CODES];\nstatic const char *Http3xxStr =\n    \"Multiple Choices\\0\"\n    \"Moved Permanently\\0\"\n    \"Found\\0\"\n    \"See Other\\0\"\n    \"Not Modified\\0\" \"Use Proxy\\0\" \"\\0\" \"Temporary Redirect\\0\";\nstatic const char *Http4xxCodes[NUM_4XX_CODES];\nstatic const char *Http4xxStr =\n    \"Bad Request\\0\"\n    \"Unauthorized\\0\"\n    \"Payment Required\\0\"\n    \"Forbidden\\0\"\n    \"Not Found\\0\"\n    \"Method Not Allowed\\0\"\n    \"Not Acceptable\\0\"\n    \"Proxy Authentication Required\\0\"\n    \"Request Timeout\\0\"\n    \"Conflict\\0\"\n    \"Gone\\0\"\n    \"Length Required\\0\"\n    \"Precondition Failed\\0\"\n    \"Request Entity Too Large\\0\"\n    \"Request-URI Too Long\\0\"\n    \"Unsupported Media Type\\0\"\n    \"Requested Range Not Satisfiable\\0\" \"Expectation Failed\\0\";\nstatic const char *Http5xxCodes[NUM_5XX_CODES];\nstatic const char *Http5xxStr =\n    \"Internal Server Error\\0\"\n    \"Not Implemented\\0\"\n    \"Bad Gateway\\0\"\n    \"Service Unavailable\\0\"\n    \"Gateway Timeout\\0\"\n    \"HTTP Version Not Supported\\0\"\n    \"Variant Also Negotiates\\0\"\n    \"Insufficient Storage\\0\"\n    \"Loop Detected\\0\"\n    \"\\0\" \"Not Extended\\0\";\nstatic int gInitialized = FALSE;\n\nstatic UPNP_INLINE void\ninit_tables( void )\n{\n    init_table( Http1xxStr, Http1xxCodes, NUM_1XX_CODES );\n    init_table( Http2xxStr, Http2xxCodes, NUM_2XX_CODES );\n    init_table( Http3xxStr, Http3xxCodes, NUM_3XX_CODES );\n    init_table( Http4xxStr, Http4xxCodes, NUM_4XX_CODES );\n    init_table( Http5xxStr, Http5xxCodes, NUM_5XX_CODES );\n\n    gInitialized = TRUE;        /* mark only after complete */\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"unixutil.h\"\n#include \"statcodes.h\"\n#include \"upnputil.h\"\n#include <string.h>\n#include <stdio.h>\n#include \"config.h\"\n\n#define NUM_5XX_CODES   11\n#define NUM_4XX_CODES   18\n#define NUM_3XX_CODES   8\n#define NUM_2XX_CODES   7\n#define NUM_1XX_CODES   2\n\nstatic const char *Http1xxCodes[NUM_1XX_CODES];\nstatic const char *Http2xxCodes[NUM_2XX_CODES];\nstatic const char *Http3xxCodes[NUM_3XX_CODES];\nstatic const char *Http4xxCodes[NUM_4XX_CODES];\nstatic const char *Http5xxCodes[NUM_5XX_CODES];\nstatic int gInitialized = FALSE;\n\nconst char *\nhttp_get_code_text( int statusCode )\n{\n    int index;\n    int table_num;\n\n    if( !gInitialized ) {\n        init_tables();\n    }\n\n    if( statusCode < 100 || statusCode >= 600 ) {\n        return NULL;\n    }\n\n    index = statusCode % 100;\n    table_num = statusCode / 100;\n\n    if( table_num == 1 && index < NUM_1XX_CODES ) {\n        return Http1xxCodes[index];\n    }\n\n    if( table_num == 2 && index < NUM_2XX_CODES ) {\n        return Http2xxCodes[index];\n    }\n\n    if( table_num == 3 && index < NUM_3XX_CODES ) {\n        return Http3xxCodes[index];\n    }\n\n    if( table_num == 4 && index < NUM_4XX_CODES ) {\n        return Http4xxCodes[index];\n    }\n\n    if( table_num == 5 && index < NUM_5XX_CODES ) {\n        return Http5xxCodes[index];\n    }\n\n    return NULL;\n}"
  },
  {
    "function_name": "init_tables",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/net/http/statcodes.c",
    "lines": "153-163",
    "snippet": "static UPNP_INLINE void\ninit_tables( void )\n{\n    init_table( Http1xxStr, Http1xxCodes, NUM_1XX_CODES );\n    init_table( Http2xxStr, Http2xxCodes, NUM_2XX_CODES );\n    init_table( Http3xxStr, Http3xxCodes, NUM_3XX_CODES );\n    init_table( Http4xxStr, Http4xxCodes, NUM_4XX_CODES );\n    init_table( Http5xxStr, Http5xxCodes, NUM_5XX_CODES );\n\n    gInitialized = TRUE;        /* mark only after complete */\n}",
    "includes": [
      "#include \"unixutil.h\"",
      "#include \"statcodes.h\"",
      "#include \"upnputil.h\"",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [
      "#define NUM_5XX_CODES   11",
      "#define NUM_4XX_CODES   18",
      "#define NUM_3XX_CODES   8",
      "#define NUM_2XX_CODES   7",
      "#define NUM_1XX_CODES   2"
    ],
    "globals_used": [
      "static const char *Http1xxCodes[NUM_1XX_CODES];",
      "static const char *Http1xxStr = \"Continue\\0\" \"Switching Protocols\\0\";",
      "static const char *Http2xxCodes[NUM_2XX_CODES];",
      "static const char *Http2xxStr =\n    \"OK\\0\"\n    \"Created\\0\"\n    \"Accepted\\0\"\n    \"Non-Authoratative Information\\0\"\n    \"No Content\\0\" \"Reset Content\\0\" \"Partial Content\\0\";",
      "static const char *Http3xxCodes[NUM_3XX_CODES];",
      "static const char *Http3xxStr =\n    \"Multiple Choices\\0\"\n    \"Moved Permanently\\0\"\n    \"Found\\0\"\n    \"See Other\\0\"\n    \"Not Modified\\0\" \"Use Proxy\\0\" \"\\0\" \"Temporary Redirect\\0\";",
      "static const char *Http4xxCodes[NUM_4XX_CODES];",
      "static const char *Http4xxStr =\n    \"Bad Request\\0\"\n    \"Unauthorized\\0\"\n    \"Payment Required\\0\"\n    \"Forbidden\\0\"\n    \"Not Found\\0\"\n    \"Method Not Allowed\\0\"\n    \"Not Acceptable\\0\"\n    \"Proxy Authentication Required\\0\"\n    \"Request Timeout\\0\"\n    \"Conflict\\0\"\n    \"Gone\\0\"\n    \"Length Required\\0\"\n    \"Precondition Failed\\0\"\n    \"Request Entity Too Large\\0\"\n    \"Request-URI Too Long\\0\"\n    \"Unsupported Media Type\\0\"\n    \"Requested Range Not Satisfiable\\0\" \"Expectation Failed\\0\";",
      "static const char *Http5xxCodes[NUM_5XX_CODES];",
      "static const char *Http5xxStr =\n    \"Internal Server Error\\0\"\n    \"Not Implemented\\0\"\n    \"Bad Gateway\\0\"\n    \"Service Unavailable\\0\"\n    \"Gateway Timeout\\0\"\n    \"HTTP Version Not Supported\\0\"\n    \"Variant Also Negotiates\\0\"\n    \"Insufficient Storage\\0\"\n    \"Loop Detected\\0\"\n    \"\\0\" \"Not Extended\\0\";",
      "static int gInitialized = FALSE;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "init_table",
          "args": [
            "Http5xxStr",
            "Http5xxCodes",
            "NUM_5XX_CODES"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "init_table",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/net/http/statcodes.c",
          "lines": "127-139",
          "snippet": "static UPNP_INLINE void\ninit_table( IN const char *encoded_str,\n            OUT const char *table[],\n            IN int tbl_size )\n{\n    int i;\n    const char *s = encoded_str;\n\n    for( i = 0; i < tbl_size; i++ ) {\n        table[i] = s;\n        s += strlen( s ) + (size_t)1;   /* next entry */\n    }\n}",
          "includes": [
            "#include \"unixutil.h\"",
            "#include \"statcodes.h\"",
            "#include \"upnputil.h\"",
            "#include <string.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"unixutil.h\"\n#include \"statcodes.h\"\n#include \"upnputil.h\"\n#include <string.h>\n#include <stdio.h>\n#include \"config.h\"\n\nstatic UPNP_INLINE void\ninit_table( IN const char *encoded_str,\n            OUT const char *table[],\n            IN int tbl_size )\n{\n    int i;\n    const char *s = encoded_str;\n\n    for( i = 0; i < tbl_size; i++ ) {\n        table[i] = s;\n        s += strlen( s ) + (size_t)1;   /* next entry */\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"unixutil.h\"\n#include \"statcodes.h\"\n#include \"upnputil.h\"\n#include <string.h>\n#include <stdio.h>\n#include \"config.h\"\n\n#define NUM_5XX_CODES   11\n#define NUM_4XX_CODES   18\n#define NUM_3XX_CODES   8\n#define NUM_2XX_CODES   7\n#define NUM_1XX_CODES   2\n\nstatic const char *Http1xxCodes[NUM_1XX_CODES];\nstatic const char *Http1xxStr = \"Continue\\0\" \"Switching Protocols\\0\";\nstatic const char *Http2xxCodes[NUM_2XX_CODES];\nstatic const char *Http2xxStr =\n    \"OK\\0\"\n    \"Created\\0\"\n    \"Accepted\\0\"\n    \"Non-Authoratative Information\\0\"\n    \"No Content\\0\" \"Reset Content\\0\" \"Partial Content\\0\";\nstatic const char *Http3xxCodes[NUM_3XX_CODES];\nstatic const char *Http3xxStr =\n    \"Multiple Choices\\0\"\n    \"Moved Permanently\\0\"\n    \"Found\\0\"\n    \"See Other\\0\"\n    \"Not Modified\\0\" \"Use Proxy\\0\" \"\\0\" \"Temporary Redirect\\0\";\nstatic const char *Http4xxCodes[NUM_4XX_CODES];\nstatic const char *Http4xxStr =\n    \"Bad Request\\0\"\n    \"Unauthorized\\0\"\n    \"Payment Required\\0\"\n    \"Forbidden\\0\"\n    \"Not Found\\0\"\n    \"Method Not Allowed\\0\"\n    \"Not Acceptable\\0\"\n    \"Proxy Authentication Required\\0\"\n    \"Request Timeout\\0\"\n    \"Conflict\\0\"\n    \"Gone\\0\"\n    \"Length Required\\0\"\n    \"Precondition Failed\\0\"\n    \"Request Entity Too Large\\0\"\n    \"Request-URI Too Long\\0\"\n    \"Unsupported Media Type\\0\"\n    \"Requested Range Not Satisfiable\\0\" \"Expectation Failed\\0\";\nstatic const char *Http5xxCodes[NUM_5XX_CODES];\nstatic const char *Http5xxStr =\n    \"Internal Server Error\\0\"\n    \"Not Implemented\\0\"\n    \"Bad Gateway\\0\"\n    \"Service Unavailable\\0\"\n    \"Gateway Timeout\\0\"\n    \"HTTP Version Not Supported\\0\"\n    \"Variant Also Negotiates\\0\"\n    \"Insufficient Storage\\0\"\n    \"Loop Detected\\0\"\n    \"\\0\" \"Not Extended\\0\";\nstatic int gInitialized = FALSE;\n\nstatic UPNP_INLINE void\ninit_tables( void )\n{\n    init_table( Http1xxStr, Http1xxCodes, NUM_1XX_CODES );\n    init_table( Http2xxStr, Http2xxCodes, NUM_2XX_CODES );\n    init_table( Http3xxStr, Http3xxCodes, NUM_3XX_CODES );\n    init_table( Http4xxStr, Http4xxCodes, NUM_4XX_CODES );\n    init_table( Http5xxStr, Http5xxCodes, NUM_5XX_CODES );\n\n    gInitialized = TRUE;        /* mark only after complete */\n}"
  },
  {
    "function_name": "init_table",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/net/http/statcodes.c",
    "lines": "127-139",
    "snippet": "static UPNP_INLINE void\ninit_table( IN const char *encoded_str,\n            OUT const char *table[],\n            IN int tbl_size )\n{\n    int i;\n    const char *s = encoded_str;\n\n    for( i = 0; i < tbl_size; i++ ) {\n        table[i] = s;\n        s += strlen( s ) + (size_t)1;   /* next entry */\n    }\n}",
    "includes": [
      "#include \"unixutil.h\"",
      "#include \"statcodes.h\"",
      "#include \"upnputil.h\"",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "s"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"unixutil.h\"\n#include \"statcodes.h\"\n#include \"upnputil.h\"\n#include <string.h>\n#include <stdio.h>\n#include \"config.h\"\n\nstatic UPNP_INLINE void\ninit_table( IN const char *encoded_str,\n            OUT const char *table[],\n            IN int tbl_size )\n{\n    int i;\n    const char *s = encoded_str;\n\n    for( i = 0; i < tbl_size; i++ ) {\n        table[i] = s;\n        s += strlen( s ) + (size_t)1;   /* next entry */\n    }\n}"
  }
]