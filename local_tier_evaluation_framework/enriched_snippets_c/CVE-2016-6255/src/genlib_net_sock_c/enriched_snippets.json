[
  {
    "function_name": "sock_make_no_blocking",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/net/sock.c",
    "lines": "294-308",
    "snippet": "int sock_make_no_blocking(SOCKET sock)\n{\n#ifdef WIN32\n\tu_long val = 1;\n\treturn ioctlsocket(sock, FIONBIO, &val);\n#else /* WIN32 */\n\tint val;\n\n\tval = fcntl(sock, F_GETFL, 0);\n\tif (fcntl(sock, F_SETFL, val | O_NONBLOCK) == -1) {\n\t\treturn -1;\n\t}\n#endif /* WIN32 */\n\treturn 0;\n}",
    "includes": [
      "#include <openssl/ssl.h>",
      "#include <string.h>",
      "#include <time.h>",
      "#include <fcntl.h>\t/* for F_GETFL, F_SETFL, O_NONBLOCK */",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"upnputil.h\"",
      "#include \"upnpdebug.h\"",
      "#include \"UpnpStdInt.h\" /* for ssize_t */",
      "#include \"upnp.h\"",
      "#include \"unixutil.h\"\t/* for socklen_t, EAFNOSUPPORT */",
      "#include \"sock.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fcntl",
          "args": [
            "sock",
            "F_SETFL",
            "val | O_NONBLOCK"
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fcntl",
          "args": [
            "sock",
            "F_GETFL",
            "0"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ioctlsocket",
          "args": [
            "sock",
            "FIONBIO",
            "&val"
          ],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <openssl/ssl.h>\n#include <string.h>\n#include <time.h>\n#include <fcntl.h>\t/* for F_GETFL, F_SETFL, O_NONBLOCK */\n#include <errno.h>\n#include <assert.h>\n#include \"upnputil.h\"\n#include \"upnpdebug.h\"\n#include \"UpnpStdInt.h\" /* for ssize_t */\n#include \"upnp.h\"\n#include \"unixutil.h\"\t/* for socklen_t, EAFNOSUPPORT */\n#include \"sock.h\"\n#include \"config.h\"\n\nint sock_make_no_blocking(SOCKET sock)\n{\n#ifdef WIN32\n\tu_long val = 1;\n\treturn ioctlsocket(sock, FIONBIO, &val);\n#else /* WIN32 */\n\tint val;\n\n\tval = fcntl(sock, F_GETFL, 0);\n\tif (fcntl(sock, F_SETFL, val | O_NONBLOCK) == -1) {\n\t\treturn -1;\n\t}\n#endif /* WIN32 */\n\treturn 0;\n}"
  },
  {
    "function_name": "sock_make_blocking",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/net/sock.c",
    "lines": "277-291",
    "snippet": "int sock_make_blocking(SOCKET sock)\n{\n#ifdef WIN32\n\tu_long val = 0;\n\treturn ioctlsocket(sock, FIONBIO, &val);\n#else\n\tint val;\n\n\tval = fcntl(sock, F_GETFL, 0);\n\tif (fcntl(sock, F_SETFL, val & ~O_NONBLOCK) == -1) {\n\t\treturn -1;\n\t}\n#endif\n\treturn 0;\n}",
    "includes": [
      "#include <openssl/ssl.h>",
      "#include <string.h>",
      "#include <time.h>",
      "#include <fcntl.h>\t/* for F_GETFL, F_SETFL, O_NONBLOCK */",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"upnputil.h\"",
      "#include \"upnpdebug.h\"",
      "#include \"UpnpStdInt.h\" /* for ssize_t */",
      "#include \"upnp.h\"",
      "#include \"unixutil.h\"\t/* for socklen_t, EAFNOSUPPORT */",
      "#include \"sock.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fcntl",
          "args": [
            "sock",
            "F_SETFL",
            "val & ~O_NONBLOCK"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fcntl",
          "args": [
            "sock",
            "F_GETFL",
            "0"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ioctlsocket",
          "args": [
            "sock",
            "FIONBIO",
            "&val"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <openssl/ssl.h>\n#include <string.h>\n#include <time.h>\n#include <fcntl.h>\t/* for F_GETFL, F_SETFL, O_NONBLOCK */\n#include <errno.h>\n#include <assert.h>\n#include \"upnputil.h\"\n#include \"upnpdebug.h\"\n#include \"UpnpStdInt.h\" /* for ssize_t */\n#include \"upnp.h\"\n#include \"unixutil.h\"\t/* for socklen_t, EAFNOSUPPORT */\n#include \"sock.h\"\n#include \"config.h\"\n\nint sock_make_blocking(SOCKET sock)\n{\n#ifdef WIN32\n\tu_long val = 0;\n\treturn ioctlsocket(sock, FIONBIO, &val);\n#else\n\tint val;\n\n\tval = fcntl(sock, F_GETFL, 0);\n\tif (fcntl(sock, F_SETFL, val & ~O_NONBLOCK) == -1) {\n\t\treturn -1;\n\t}\n#endif\n\treturn 0;\n}"
  },
  {
    "function_name": "sock_write",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/net/sock.c",
    "lines": "271-275",
    "snippet": "int sock_write(SOCKINFO *info, const char *buffer, size_t bufsize, int *timeoutSecs)\n{\n\t/* Consciently removing constness. */\n\treturn sock_read_write(info, (char *)buffer, bufsize, timeoutSecs, FALSE);\n}",
    "includes": [
      "#include <openssl/ssl.h>",
      "#include <string.h>",
      "#include <time.h>",
      "#include <fcntl.h>\t/* for F_GETFL, F_SETFL, O_NONBLOCK */",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"upnputil.h\"",
      "#include \"upnpdebug.h\"",
      "#include \"UpnpStdInt.h\" /* for ssize_t */",
      "#include \"upnp.h\"",
      "#include \"unixutil.h\"\t/* for socklen_t, EAFNOSUPPORT */",
      "#include \"sock.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sock_read_write",
          "args": [
            "info",
            "(char *)buffer",
            "bufsize",
            "timeoutSecs",
            "FALSE"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <openssl/ssl.h>\n#include <string.h>\n#include <time.h>\n#include <fcntl.h>\t/* for F_GETFL, F_SETFL, O_NONBLOCK */\n#include <errno.h>\n#include <assert.h>\n#include \"upnputil.h\"\n#include \"upnpdebug.h\"\n#include \"UpnpStdInt.h\" /* for ssize_t */\n#include \"upnp.h\"\n#include \"unixutil.h\"\t/* for socklen_t, EAFNOSUPPORT */\n#include \"sock.h\"\n#include \"config.h\"\n\nint sock_write(SOCKINFO *info, const char *buffer, size_t bufsize, int *timeoutSecs)\n{\n\t/* Consciently removing constness. */\n\treturn sock_read_write(info, (char *)buffer, bufsize, timeoutSecs, FALSE);\n}"
  },
  {
    "function_name": "sock_read",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/net/sock.c",
    "lines": "266-269",
    "snippet": "int sock_read(SOCKINFO *info, char *buffer, size_t bufsize, int *timeoutSecs)\n{\n\treturn sock_read_write(info, buffer, bufsize, timeoutSecs, TRUE);\n}",
    "includes": [
      "#include <openssl/ssl.h>",
      "#include <string.h>",
      "#include <time.h>",
      "#include <fcntl.h>\t/* for F_GETFL, F_SETFL, O_NONBLOCK */",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"upnputil.h\"",
      "#include \"upnpdebug.h\"",
      "#include \"UpnpStdInt.h\" /* for ssize_t */",
      "#include \"upnp.h\"",
      "#include \"unixutil.h\"\t/* for socklen_t, EAFNOSUPPORT */",
      "#include \"sock.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sock_read_write",
          "args": [
            "info",
            "buffer",
            "bufsize",
            "timeoutSecs",
            "TRUE"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <openssl/ssl.h>\n#include <string.h>\n#include <time.h>\n#include <fcntl.h>\t/* for F_GETFL, F_SETFL, O_NONBLOCK */\n#include <errno.h>\n#include <assert.h>\n#include \"upnputil.h\"\n#include \"upnpdebug.h\"\n#include \"UpnpStdInt.h\" /* for ssize_t */\n#include \"upnp.h\"\n#include \"unixutil.h\"\t/* for socklen_t, EAFNOSUPPORT */\n#include \"sock.h\"\n#include \"config.h\"\n\nint sock_read(SOCKINFO *info, char *buffer, size_t bufsize, int *timeoutSecs)\n{\n\treturn sock_read_write(info, buffer, bufsize, timeoutSecs, TRUE);\n}"
  },
  {
    "function_name": "sock_destroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/net/sock.c",
    "lines": "118-143",
    "snippet": "int sock_destroy(SOCKINFO *info, int ShutdownMethod)\n{\n\tint ret = UPNP_E_SUCCESS;\n\tchar errorBuffer[ERROR_BUFFER_LEN];\n\n\tif (info->socket != INVALID_SOCKET) {\n#ifdef UPNP_ENABLE_OPEN_SSL\n\t\tif (info->ssl) {\n\t\t\tSSL_shutdown(info->ssl);\n\t\t\tSSL_free(info->ssl);\n\t\t\tinfo->ssl = NULL;\n\t\t}\n#endif\n\t\tif (shutdown(info->socket, ShutdownMethod) == -1) {\n\t\t\tstrerror_r(errno, errorBuffer, ERROR_BUFFER_LEN);\n\t\t\tUpnpPrintf(UPNP_INFO, HTTP, __FILE__, __LINE__,\n\t\t\t\t   \"Error in shutdown: %s\\n\", errorBuffer);\n\t\t}\n\t\tif (sock_close(info->socket) == -1) {\n\t\t\tret = UPNP_E_SOCKET_ERROR;\n\t\t}\n\t\tinfo->socket = INVALID_SOCKET;\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include <openssl/ssl.h>",
      "#include <string.h>",
      "#include <time.h>",
      "#include <fcntl.h>\t/* for F_GETFL, F_SETFL, O_NONBLOCK */",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"upnputil.h\"",
      "#include \"upnpdebug.h\"",
      "#include \"UpnpStdInt.h\" /* for ssize_t */",
      "#include \"upnp.h\"",
      "#include \"unixutil.h\"\t/* for socklen_t, EAFNOSUPPORT */",
      "#include \"sock.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sock_close",
          "args": [
            "info->socket"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "sock_close",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/inc/sock.h",
          "lines": "79-89",
          "snippet": "static UPNP_INLINE int sock_close(\n\t/*! Socket descriptor. */\n\tSOCKET sock)\n{\n\tint ret = -1;\n\n\tif (sock != INVALID_SOCKET)\n\t\tret = UpnpCloseSocket(sock);\n\n\treturn ret;\n}",
          "includes": [
            "#include <openssl/ssl.h>",
            "#include \"UpnpGlobal.h\"\t\t/* for UPNP_INLINE */",
            "#include \"UpnpInet.h\"\t\t/* for SOCKET, netinet/in */",
            "#include \"upnpconfig.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/ssl.h>\n#include \"UpnpGlobal.h\"\t\t/* for UPNP_INLINE */\n#include \"UpnpInet.h\"\t\t/* for SOCKET, netinet/in */\n#include \"upnpconfig.h\"\n\nstatic UPNP_INLINE int sock_close(\n\t/*! Socket descriptor. */\n\tSOCKET sock)\n{\n\tint ret = -1;\n\n\tif (sock != INVALID_SOCKET)\n\t\tret = UpnpCloseSocket(sock);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "UpnpPrintf",
          "args": [
            "UPNP_INFO",
            "HTTP",
            "__FILE__",
            "__LINE__",
            "\"Error in shutdown: %s\\n\"",
            "errorBuffer"
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "UpnpPrintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/upnpdebug.c",
          "lines": "124-154",
          "snippet": "void UpnpPrintf(Upnp_LogLevel DLevel,\n\t\tDbg_Module Module,\n\t\tconst char *DbgFileName, int DbgLineNo, const char *FmtStr, ...)\n{\n\tva_list ArgList;\n\n\tif (!DebugAtThisLevel(DLevel, Module))\n\t\treturn;\n\tithread_mutex_lock(&GlobalDebugMutex);\n\tva_start(ArgList, FmtStr);\n\tif (!DEBUG_TARGET) {\n\t\tif (DbgFileName)\n\t\t\tUpnpDisplayFileAndLine(stdout, DbgFileName, DbgLineNo);\n\t\tvfprintf(stdout, FmtStr, ArgList);\n\t\tfflush(stdout);\n\t} else if (DLevel == 0) {\n\t\tif (DbgFileName)\n\t\t\tUpnpDisplayFileAndLine(ErrFileHnd, DbgFileName,\n\t\t\t\t\t       DbgLineNo);\n\t\tvfprintf(ErrFileHnd, FmtStr, ArgList);\n\t\tfflush(ErrFileHnd);\n\t} else {\n\t\tif (DbgFileName)\n\t\t\tUpnpDisplayFileAndLine(InfoFileHnd, DbgFileName,\n\t\t\t\t\t       DbgLineNo);\n\t\tvfprintf(InfoFileHnd, FmtStr, ArgList);\n\t\tfflush(InfoFileHnd);\n\t}\n\tva_end(ArgList);\n\tithread_mutex_unlock(&GlobalDebugMutex);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include \"upnpdebug.h\"",
            "#include \"upnp.h\"",
            "#include \"ixml.h\"",
            "#include \"ithread.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include \"upnpdebug.h\"\n#include \"upnp.h\"\n#include \"ixml.h\"\n#include \"ithread.h\"\n#include \"config.h\"\n\nvoid UpnpPrintf(Upnp_LogLevel DLevel,\n\t\tDbg_Module Module,\n\t\tconst char *DbgFileName, int DbgLineNo, const char *FmtStr, ...)\n{\n\tva_list ArgList;\n\n\tif (!DebugAtThisLevel(DLevel, Module))\n\t\treturn;\n\tithread_mutex_lock(&GlobalDebugMutex);\n\tva_start(ArgList, FmtStr);\n\tif (!DEBUG_TARGET) {\n\t\tif (DbgFileName)\n\t\t\tUpnpDisplayFileAndLine(stdout, DbgFileName, DbgLineNo);\n\t\tvfprintf(stdout, FmtStr, ArgList);\n\t\tfflush(stdout);\n\t} else if (DLevel == 0) {\n\t\tif (DbgFileName)\n\t\t\tUpnpDisplayFileAndLine(ErrFileHnd, DbgFileName,\n\t\t\t\t\t       DbgLineNo);\n\t\tvfprintf(ErrFileHnd, FmtStr, ArgList);\n\t\tfflush(ErrFileHnd);\n\t} else {\n\t\tif (DbgFileName)\n\t\t\tUpnpDisplayFileAndLine(InfoFileHnd, DbgFileName,\n\t\t\t\t\t       DbgLineNo);\n\t\tvfprintf(InfoFileHnd, FmtStr, ArgList);\n\t\tfflush(InfoFileHnd);\n\t}\n\tva_end(ArgList);\n\tithread_mutex_unlock(&GlobalDebugMutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strerror_r",
          "args": [
            "errno",
            "errorBuffer",
            "ERROR_BUFFER_LEN"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shutdown",
          "args": [
            "info->socket",
            "ShutdownMethod"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SSL_free",
          "args": [
            "info->ssl"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SSL_shutdown",
          "args": [
            "info->ssl"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <openssl/ssl.h>\n#include <string.h>\n#include <time.h>\n#include <fcntl.h>\t/* for F_GETFL, F_SETFL, O_NONBLOCK */\n#include <errno.h>\n#include <assert.h>\n#include \"upnputil.h\"\n#include \"upnpdebug.h\"\n#include \"UpnpStdInt.h\" /* for ssize_t */\n#include \"upnp.h\"\n#include \"unixutil.h\"\t/* for socklen_t, EAFNOSUPPORT */\n#include \"sock.h\"\n#include \"config.h\"\n\nint sock_destroy(SOCKINFO *info, int ShutdownMethod)\n{\n\tint ret = UPNP_E_SUCCESS;\n\tchar errorBuffer[ERROR_BUFFER_LEN];\n\n\tif (info->socket != INVALID_SOCKET) {\n#ifdef UPNP_ENABLE_OPEN_SSL\n\t\tif (info->ssl) {\n\t\t\tSSL_shutdown(info->ssl);\n\t\t\tSSL_free(info->ssl);\n\t\t\tinfo->ssl = NULL;\n\t\t}\n#endif\n\t\tif (shutdown(info->socket, ShutdownMethod) == -1) {\n\t\t\tstrerror_r(errno, errorBuffer, ERROR_BUFFER_LEN);\n\t\t\tUpnpPrintf(UPNP_INFO, HTTP, __FILE__, __LINE__,\n\t\t\t\t   \"Error in shutdown: %s\\n\", errorBuffer);\n\t\t}\n\t\tif (sock_close(info->socket) == -1) {\n\t\t\tret = UPNP_E_SOCKET_ERROR;\n\t\t}\n\t\tinfo->socket = INVALID_SOCKET;\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "sock_ssl_connect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/net/sock.c",
    "lines": "100-115",
    "snippet": "int sock_ssl_connect(SOCKINFO *info)\n{\n\tint status = 0;\n\tinfo->ssl = SSL_new(gSslCtx);\n\tif (!info->ssl) {\n\t\treturn UPNP_E_SOCKET_ERROR;\n\t}\n\tstatus = SSL_set_fd(info->ssl, info->socket);\n\tif (status == 1) {\n\t\tstatus = SSL_connect(info->ssl);\n\t}\n\tif (status == 1) {\n\t\treturn UPNP_E_SUCCESS;\n\t}\n\treturn UPNP_E_SOCKET_ERROR;\n}",
    "includes": [
      "#include <openssl/ssl.h>",
      "#include <string.h>",
      "#include <time.h>",
      "#include <fcntl.h>\t/* for F_GETFL, F_SETFL, O_NONBLOCK */",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"upnputil.h\"",
      "#include \"upnpdebug.h\"",
      "#include \"UpnpStdInt.h\" /* for ssize_t */",
      "#include \"upnp.h\"",
      "#include \"unixutil.h\"\t/* for socklen_t, EAFNOSUPPORT */",
      "#include \"sock.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SSL_connect",
          "args": [
            "info->ssl"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SSL_set_fd",
          "args": [
            "info->ssl",
            "info->socket"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SSL_new",
          "args": [
            "gSslCtx"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <openssl/ssl.h>\n#include <string.h>\n#include <time.h>\n#include <fcntl.h>\t/* for F_GETFL, F_SETFL, O_NONBLOCK */\n#include <errno.h>\n#include <assert.h>\n#include \"upnputil.h\"\n#include \"upnpdebug.h\"\n#include \"UpnpStdInt.h\" /* for ssize_t */\n#include \"upnp.h\"\n#include \"unixutil.h\"\t/* for socklen_t, EAFNOSUPPORT */\n#include \"sock.h\"\n#include \"config.h\"\n\nint sock_ssl_connect(SOCKINFO *info)\n{\n\tint status = 0;\n\tinfo->ssl = SSL_new(gSslCtx);\n\tif (!info->ssl) {\n\t\treturn UPNP_E_SOCKET_ERROR;\n\t}\n\tstatus = SSL_set_fd(info->ssl, info->socket);\n\tif (status == 1) {\n\t\tstatus = SSL_connect(info->ssl);\n\t}\n\tif (status == 1) {\n\t\treturn UPNP_E_SUCCESS;\n\t}\n\treturn UPNP_E_SOCKET_ERROR;\n}"
  },
  {
    "function_name": "sock_init_with_ip",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/net/sock.c",
    "lines": "83-97",
    "snippet": "int sock_init_with_ip(SOCKINFO *info, SOCKET sockfd,\n\tstruct sockaddr *foreign_sockaddr)\n{\n\tint ret;\n\n\tret = sock_init(info, sockfd);\n\tif (ret != UPNP_E_SUCCESS) {\n\t\treturn ret;\n\t}\n\n\tmemcpy(&info->foreign_sockaddr, foreign_sockaddr,\n\t       sizeof(info->foreign_sockaddr));\n\n\treturn UPNP_E_SUCCESS;\n}",
    "includes": [
      "#include <openssl/ssl.h>",
      "#include <string.h>",
      "#include <time.h>",
      "#include <fcntl.h>\t/* for F_GETFL, F_SETFL, O_NONBLOCK */",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"upnputil.h\"",
      "#include \"upnpdebug.h\"",
      "#include \"UpnpStdInt.h\" /* for ssize_t */",
      "#include \"upnp.h\"",
      "#include \"unixutil.h\"\t/* for socklen_t, EAFNOSUPPORT */",
      "#include \"sock.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&info->foreign_sockaddr",
            "foreign_sockaddr",
            "sizeof(info->foreign_sockaddr)"
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "MD5_memcpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/uuid/md5.c",
          "lines": "333-340",
          "snippet": "static void\nMD5_memcpy(POINTER  output, POINTER  input, unsigned int len)\n{\n\tunsigned int i;\n\tfor (i = 0; i < len; ++i) {\n\t\toutput[i] = input[i];\n\t}\n}",
          "includes": [
            "#include \"md5.h\"",
            "#include \"global.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void MD5_memcpy"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"global.h\"\n#include \"config.h\"\n\nstatic void MD5_memcpy;\n\nstatic void\nMD5_memcpy(POINTER  output, POINTER  input, unsigned int len)\n{\n\tunsigned int i;\n\tfor (i = 0; i < len; ++i) {\n\t\toutput[i] = input[i];\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "sock_init",
          "args": [
            "info",
            "sockfd"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "sock_init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/net/sock.c",
          "lines": "73-81",
          "snippet": "int sock_init(SOCKINFO *info, SOCKET sockfd)\n{\n\tassert(info);\n\n\tmemset(info, 0, sizeof(SOCKINFO));\n\tinfo->socket = sockfd;\n\n\treturn UPNP_E_SUCCESS;\n}",
          "includes": [
            "#include <openssl/ssl.h>",
            "#include <string.h>",
            "#include <time.h>",
            "#include <fcntl.h>\t/* for F_GETFL, F_SETFL, O_NONBLOCK */",
            "#include <errno.h>",
            "#include <assert.h>",
            "#include \"upnputil.h\"",
            "#include \"upnpdebug.h\"",
            "#include \"UpnpStdInt.h\" /* for ssize_t */",
            "#include \"upnp.h\"",
            "#include \"unixutil.h\"\t/* for socklen_t, EAFNOSUPPORT */",
            "#include \"sock.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/ssl.h>\n#include <string.h>\n#include <time.h>\n#include <fcntl.h>\t/* for F_GETFL, F_SETFL, O_NONBLOCK */\n#include <errno.h>\n#include <assert.h>\n#include \"upnputil.h\"\n#include \"upnpdebug.h\"\n#include \"UpnpStdInt.h\" /* for ssize_t */\n#include \"upnp.h\"\n#include \"unixutil.h\"\t/* for socklen_t, EAFNOSUPPORT */\n#include \"sock.h\"\n#include \"config.h\"\n\nint sock_init(SOCKINFO *info, SOCKET sockfd)\n{\n\tassert(info);\n\n\tmemset(info, 0, sizeof(SOCKINFO));\n\tinfo->socket = sockfd;\n\n\treturn UPNP_E_SUCCESS;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <openssl/ssl.h>\n#include <string.h>\n#include <time.h>\n#include <fcntl.h>\t/* for F_GETFL, F_SETFL, O_NONBLOCK */\n#include <errno.h>\n#include <assert.h>\n#include \"upnputil.h\"\n#include \"upnpdebug.h\"\n#include \"UpnpStdInt.h\" /* for ssize_t */\n#include \"upnp.h\"\n#include \"unixutil.h\"\t/* for socklen_t, EAFNOSUPPORT */\n#include \"sock.h\"\n#include \"config.h\"\n\nint sock_init_with_ip(SOCKINFO *info, SOCKET sockfd,\n\tstruct sockaddr *foreign_sockaddr)\n{\n\tint ret;\n\n\tret = sock_init(info, sockfd);\n\tif (ret != UPNP_E_SUCCESS) {\n\t\treturn ret;\n\t}\n\n\tmemcpy(&info->foreign_sockaddr, foreign_sockaddr,\n\t       sizeof(info->foreign_sockaddr));\n\n\treturn UPNP_E_SUCCESS;\n}"
  },
  {
    "function_name": "sock_init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/net/sock.c",
    "lines": "73-81",
    "snippet": "int sock_init(SOCKINFO *info, SOCKET sockfd)\n{\n\tassert(info);\n\n\tmemset(info, 0, sizeof(SOCKINFO));\n\tinfo->socket = sockfd;\n\n\treturn UPNP_E_SUCCESS;\n}",
    "includes": [
      "#include <openssl/ssl.h>",
      "#include <string.h>",
      "#include <time.h>",
      "#include <fcntl.h>\t/* for F_GETFL, F_SETFL, O_NONBLOCK */",
      "#include <errno.h>",
      "#include <assert.h>",
      "#include \"upnputil.h\"",
      "#include \"upnpdebug.h\"",
      "#include \"UpnpStdInt.h\" /* for ssize_t */",
      "#include \"upnp.h\"",
      "#include \"unixutil.h\"\t/* for socklen_t, EAFNOSUPPORT */",
      "#include \"sock.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "info",
            "0",
            "sizeof(SOCKINFO)"
          ],
          "line": 77
        },
        "resolved": true,
        "details": {
          "function_name": "MD5_memset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/uuid/md5.c",
          "lines": "345-352",
          "snippet": "static void\nMD5_memset(POINTER output, int value, unsigned int len)\n{\n\tunsigned int i;\n\tfor (i = 0; i < len; ++i) {\n\t\t((char *)output)[i] = (char)value;\n\t}\n}",
          "includes": [
            "#include \"md5.h\"",
            "#include \"global.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void MD5_memset"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"global.h\"\n#include \"config.h\"\n\nstatic void MD5_memset;\n\nstatic void\nMD5_memset(POINTER output, int value, unsigned int len)\n{\n\tunsigned int i;\n\tfor (i = 0; i < len; ++i) {\n\t\t((char *)output)[i] = (char)value;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "info"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <openssl/ssl.h>\n#include <string.h>\n#include <time.h>\n#include <fcntl.h>\t/* for F_GETFL, F_SETFL, O_NONBLOCK */\n#include <errno.h>\n#include <assert.h>\n#include \"upnputil.h\"\n#include \"upnpdebug.h\"\n#include \"UpnpStdInt.h\" /* for ssize_t */\n#include \"upnp.h\"\n#include \"unixutil.h\"\t/* for socklen_t, EAFNOSUPPORT */\n#include \"sock.h\"\n#include \"config.h\"\n\nint sock_init(SOCKINFO *info, SOCKET sockfd)\n{\n\tassert(info);\n\n\tmemset(info, 0, sizeof(SOCKINFO));\n\tinfo->socket = sockfd;\n\n\treturn UPNP_E_SUCCESS;\n}"
  }
]