[
  {
    "function_name": "UpnpDisplayBanner",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/upnpdebug.c",
    "lines": "199-246",
    "snippet": "void UpnpDisplayBanner(FILE * fd,\n\t\t       const char **lines, size_t size, size_t starLength)\n{\n\tsize_t leftMarginLength = starLength / 2 + 1;\n\tsize_t rightMarginLength = starLength / 2 + 1;\n\tsize_t i = 0;\n\tsize_t LineSize = 0;\n\tsize_t starLengthMinus2 = starLength - 2;\n\n\tchar *leftMargin = malloc(leftMarginLength);\n\tchar *rightMargin = malloc(rightMarginLength);\n\tchar *stars = malloc(starLength + 1);\n\tchar *currentLine = malloc(starLength + 1);\n\tconst char *line = NULL;\n\n\tmemset(stars, '*', starLength);\n\tstars[starLength] = 0;\n\tmemset(leftMargin, 0, leftMarginLength);\n\tmemset(rightMargin, 0, rightMarginLength);\n\tfprintf(fd, \"\\n%s\\n\", stars);\n\tfor (i = 0; i < size; i++) {\n\t\tLineSize = strlen(lines[i]);\n\t\tline = lines[i];\n\t\twhile (LineSize > starLengthMinus2) {\n\t\t\tmemcpy(currentLine, line, starLengthMinus2);\n\t\t\tcurrentLine[starLengthMinus2] = 0;\n\t\t\tfprintf(fd, \"*%s*\\n\", currentLine);\n\t\t\tLineSize -= starLengthMinus2;\n\t\t\tline += starLengthMinus2;\n\t\t}\n\t\tleftMarginLength = (starLengthMinus2 - LineSize) / 2;\n\t\tif (LineSize % 2 == 0)\n\t\t\trightMarginLength = leftMarginLength;\n\t\telse\n\t\t\trightMarginLength = leftMarginLength + 1;\n\t\tmemset(leftMargin, ' ', leftMarginLength);\n\t\tmemset(rightMargin, ' ', rightMarginLength);\n\t\tleftMargin[leftMarginLength] = 0;\n\t\trightMargin[rightMarginLength] = 0;\n\t\tfprintf(fd, \"*%s%s%s*\\n\", leftMargin, line, rightMargin);\n\t}\n\tfprintf(fd, \"%s\\n\\n\", stars);\n\n\tfree(currentLine);\n\tfree(stars);\n\tfree(rightMargin);\n\tfree(leftMargin);\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <stdarg.h>",
      "#include \"upnpdebug.h\"",
      "#include \"upnp.h\"",
      "#include \"ixml.h\"",
      "#include \"ithread.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "leftMargin"
          ],
          "line": 245
        },
        "resolved": true,
        "details": {
          "function_name": "free_notify_struct",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/gena/gena_device.c",
          "lines": "144-157",
          "snippet": "static void free_notify_struct(\n\t/*! [in] Notify structure. */\n\tnotify_thread_struct *input)\n{\n\t(*input->reference_count)--;\n\tif (*input->reference_count == 0) {\n\t\tfree(input->headers);\n\t\tixmlFreeDOMString(input->propertySet);\n\t\tfree(input->servId);\n\t\tfree(input->UDN);\n\t\tfree(input->reference_count);\n\t}\n\tfree(input);\n}",
          "includes": [
            "#include \"uuid.h\"",
            "#include \"upnpapi.h\"",
            "#include \"unixutil.h\"",
            "#include \"sysdep.h\"",
            "#include \"statcodes.h\"",
            "#include \"ssdplib.h\"",
            "#include \"parsetools.h\"",
            "#include \"httpreadwrite.h\"",
            "#include \"httpparser.h\"",
            "#include \"gena.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"uuid.h\"\n#include \"upnpapi.h\"\n#include \"unixutil.h\"\n#include \"sysdep.h\"\n#include \"statcodes.h\"\n#include \"ssdplib.h\"\n#include \"parsetools.h\"\n#include \"httpreadwrite.h\"\n#include \"httpparser.h\"\n#include \"gena.h\"\n#include \"config.h\"\n\nstatic void free_notify_struct(\n\t/*! [in] Notify structure. */\n\tnotify_thread_struct *input)\n{\n\t(*input->reference_count)--;\n\tif (*input->reference_count == 0) {\n\t\tfree(input->headers);\n\t\tixmlFreeDOMString(input->propertySet);\n\t\tfree(input->servId);\n\t\tfree(input->UDN);\n\t\tfree(input->reference_count);\n\t}\n\tfree(input);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "fd",
            "\"%s\\n\\n\"",
            "stars"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "fd",
            "\"*%s%s%s*\\n\"",
            "leftMargin",
            "line",
            "rightMargin"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "rightMargin",
            "' '",
            "rightMarginLength"
          ],
          "line": 235
        },
        "resolved": true,
        "details": {
          "function_name": "MD5_memset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/uuid/md5.c",
          "lines": "345-352",
          "snippet": "static void\nMD5_memset(POINTER output, int value, unsigned int len)\n{\n\tunsigned int i;\n\tfor (i = 0; i < len; ++i) {\n\t\t((char *)output)[i] = (char)value;\n\t}\n}",
          "includes": [
            "#include \"md5.h\"",
            "#include \"global.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void MD5_memset"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"global.h\"\n#include \"config.h\"\n\nstatic void MD5_memset;\n\nstatic void\nMD5_memset(POINTER output, int value, unsigned int len)\n{\n\tunsigned int i;\n\tfor (i = 0; i < len; ++i) {\n\t\t((char *)output)[i] = (char)value;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "fd",
            "\"*%s*\\n\"",
            "currentLine"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "currentLine",
            "line",
            "starLengthMinus2"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "MD5_memcpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/uuid/md5.c",
          "lines": "333-340",
          "snippet": "static void\nMD5_memcpy(POINTER  output, POINTER  input, unsigned int len)\n{\n\tunsigned int i;\n\tfor (i = 0; i < len; ++i) {\n\t\toutput[i] = input[i];\n\t}\n}",
          "includes": [
            "#include \"md5.h\"",
            "#include \"global.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void MD5_memcpy"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"global.h\"\n#include \"config.h\"\n\nstatic void MD5_memcpy;\n\nstatic void\nMD5_memcpy(POINTER  output, POINTER  input, unsigned int len)\n{\n\tunsigned int i;\n\tfor (i = 0; i < len; ++i) {\n\t\toutput[i] = input[i];\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "lines[i]"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "fd",
            "\"\\n%s\\n\"",
            "stars"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "starLength + 1"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "starLength + 1"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "rightMarginLength"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "leftMarginLength"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include \"upnpdebug.h\"\n#include \"upnp.h\"\n#include \"ixml.h\"\n#include \"ithread.h\"\n#include \"config.h\"\n\nvoid UpnpDisplayBanner(FILE * fd,\n\t\t       const char **lines, size_t size, size_t starLength)\n{\n\tsize_t leftMarginLength = starLength / 2 + 1;\n\tsize_t rightMarginLength = starLength / 2 + 1;\n\tsize_t i = 0;\n\tsize_t LineSize = 0;\n\tsize_t starLengthMinus2 = starLength - 2;\n\n\tchar *leftMargin = malloc(leftMarginLength);\n\tchar *rightMargin = malloc(rightMarginLength);\n\tchar *stars = malloc(starLength + 1);\n\tchar *currentLine = malloc(starLength + 1);\n\tconst char *line = NULL;\n\n\tmemset(stars, '*', starLength);\n\tstars[starLength] = 0;\n\tmemset(leftMargin, 0, leftMarginLength);\n\tmemset(rightMargin, 0, rightMarginLength);\n\tfprintf(fd, \"\\n%s\\n\", stars);\n\tfor (i = 0; i < size; i++) {\n\t\tLineSize = strlen(lines[i]);\n\t\tline = lines[i];\n\t\twhile (LineSize > starLengthMinus2) {\n\t\t\tmemcpy(currentLine, line, starLengthMinus2);\n\t\t\tcurrentLine[starLengthMinus2] = 0;\n\t\t\tfprintf(fd, \"*%s*\\n\", currentLine);\n\t\t\tLineSize -= starLengthMinus2;\n\t\t\tline += starLengthMinus2;\n\t\t}\n\t\tleftMarginLength = (starLengthMinus2 - LineSize) / 2;\n\t\tif (LineSize % 2 == 0)\n\t\t\trightMarginLength = leftMarginLength;\n\t\telse\n\t\t\trightMarginLength = leftMarginLength + 1;\n\t\tmemset(leftMargin, ' ', leftMarginLength);\n\t\tmemset(rightMargin, ' ', rightMarginLength);\n\t\tleftMargin[leftMarginLength] = 0;\n\t\trightMargin[rightMarginLength] = 0;\n\t\tfprintf(fd, \"*%s%s%s*\\n\", leftMargin, line, rightMargin);\n\t}\n\tfprintf(fd, \"%s\\n\\n\", stars);\n\n\tfree(currentLine);\n\tfree(stars);\n\tfree(rightMargin);\n\tfree(leftMargin);\n}"
  },
  {
    "function_name": "UpnpDisplayFileAndLine",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/upnpdebug.c",
    "lines": "172-197",
    "snippet": "void UpnpDisplayFileAndLine(FILE *fd, const char *DbgFileName, int DbgLineNo)\n{\n#define NLINES 2\n#define MAX_LINE_SIZE 512\n#define NUMBER_OF_STARS 80\n\tconst char *lines[NLINES];\n\tchar buf[NLINES][MAX_LINE_SIZE];\n\tint i;\n\n\t/* Initialize the pointer array */\n\tfor (i = 0; i < NLINES; i++)\n\t\tlines[i] = buf[i];\n\t/* Put the debug lines in the buffer */\n\tsprintf(buf[0], \"DEBUG - THREAD ID: 0x%lX\",\n#ifdef WIN32\n\t\t(unsigned long int)ithread_self().p\n#else\n\t\t(unsigned long int)ithread_self()\n#endif\n\t    );\n\tif (DbgFileName)\n\t\tsprintf(buf[1], \"FILE: %s, LINE: %d\", DbgFileName, DbgLineNo);\n\t/* Show the lines centered */\n\tUpnpDisplayBanner(fd, lines, NLINES, NUMBER_OF_STARS);\n\tfflush(fd);\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <stdarg.h>",
      "#include \"upnpdebug.h\"",
      "#include \"upnp.h\"",
      "#include \"ixml.h\"",
      "#include \"ithread.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [
      "#define NUMBER_OF_STARS 80",
      "#define MAX_LINE_SIZE 512",
      "#define NLINES 2"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fflush",
          "args": [
            "fd"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "UpnpDisplayBanner",
          "args": [
            "fd",
            "lines",
            "NLINES",
            "NUMBER_OF_STARS"
          ],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "UpnpDisplayBanner",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/upnpdebug.c",
          "lines": "199-246",
          "snippet": "void UpnpDisplayBanner(FILE * fd,\n\t\t       const char **lines, size_t size, size_t starLength)\n{\n\tsize_t leftMarginLength = starLength / 2 + 1;\n\tsize_t rightMarginLength = starLength / 2 + 1;\n\tsize_t i = 0;\n\tsize_t LineSize = 0;\n\tsize_t starLengthMinus2 = starLength - 2;\n\n\tchar *leftMargin = malloc(leftMarginLength);\n\tchar *rightMargin = malloc(rightMarginLength);\n\tchar *stars = malloc(starLength + 1);\n\tchar *currentLine = malloc(starLength + 1);\n\tconst char *line = NULL;\n\n\tmemset(stars, '*', starLength);\n\tstars[starLength] = 0;\n\tmemset(leftMargin, 0, leftMarginLength);\n\tmemset(rightMargin, 0, rightMarginLength);\n\tfprintf(fd, \"\\n%s\\n\", stars);\n\tfor (i = 0; i < size; i++) {\n\t\tLineSize = strlen(lines[i]);\n\t\tline = lines[i];\n\t\twhile (LineSize > starLengthMinus2) {\n\t\t\tmemcpy(currentLine, line, starLengthMinus2);\n\t\t\tcurrentLine[starLengthMinus2] = 0;\n\t\t\tfprintf(fd, \"*%s*\\n\", currentLine);\n\t\t\tLineSize -= starLengthMinus2;\n\t\t\tline += starLengthMinus2;\n\t\t}\n\t\tleftMarginLength = (starLengthMinus2 - LineSize) / 2;\n\t\tif (LineSize % 2 == 0)\n\t\t\trightMarginLength = leftMarginLength;\n\t\telse\n\t\t\trightMarginLength = leftMarginLength + 1;\n\t\tmemset(leftMargin, ' ', leftMarginLength);\n\t\tmemset(rightMargin, ' ', rightMarginLength);\n\t\tleftMargin[leftMarginLength] = 0;\n\t\trightMargin[rightMarginLength] = 0;\n\t\tfprintf(fd, \"*%s%s%s*\\n\", leftMargin, line, rightMargin);\n\t}\n\tfprintf(fd, \"%s\\n\\n\", stars);\n\n\tfree(currentLine);\n\tfree(stars);\n\tfree(rightMargin);\n\tfree(leftMargin);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include \"upnpdebug.h\"",
            "#include \"upnp.h\"",
            "#include \"ixml.h\"",
            "#include \"ithread.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include \"upnpdebug.h\"\n#include \"upnp.h\"\n#include \"ixml.h\"\n#include \"ithread.h\"\n#include \"config.h\"\n\nvoid UpnpDisplayBanner(FILE * fd,\n\t\t       const char **lines, size_t size, size_t starLength)\n{\n\tsize_t leftMarginLength = starLength / 2 + 1;\n\tsize_t rightMarginLength = starLength / 2 + 1;\n\tsize_t i = 0;\n\tsize_t LineSize = 0;\n\tsize_t starLengthMinus2 = starLength - 2;\n\n\tchar *leftMargin = malloc(leftMarginLength);\n\tchar *rightMargin = malloc(rightMarginLength);\n\tchar *stars = malloc(starLength + 1);\n\tchar *currentLine = malloc(starLength + 1);\n\tconst char *line = NULL;\n\n\tmemset(stars, '*', starLength);\n\tstars[starLength] = 0;\n\tmemset(leftMargin, 0, leftMarginLength);\n\tmemset(rightMargin, 0, rightMarginLength);\n\tfprintf(fd, \"\\n%s\\n\", stars);\n\tfor (i = 0; i < size; i++) {\n\t\tLineSize = strlen(lines[i]);\n\t\tline = lines[i];\n\t\twhile (LineSize > starLengthMinus2) {\n\t\t\tmemcpy(currentLine, line, starLengthMinus2);\n\t\t\tcurrentLine[starLengthMinus2] = 0;\n\t\t\tfprintf(fd, \"*%s*\\n\", currentLine);\n\t\t\tLineSize -= starLengthMinus2;\n\t\t\tline += starLengthMinus2;\n\t\t}\n\t\tleftMarginLength = (starLengthMinus2 - LineSize) / 2;\n\t\tif (LineSize % 2 == 0)\n\t\t\trightMarginLength = leftMarginLength;\n\t\telse\n\t\t\trightMarginLength = leftMarginLength + 1;\n\t\tmemset(leftMargin, ' ', leftMarginLength);\n\t\tmemset(rightMargin, ' ', rightMarginLength);\n\t\tleftMargin[leftMarginLength] = 0;\n\t\trightMargin[rightMarginLength] = 0;\n\t\tfprintf(fd, \"*%s%s%s*\\n\", leftMargin, line, rightMargin);\n\t}\n\tfprintf(fd, \"%s\\n\\n\", stars);\n\n\tfree(currentLine);\n\tfree(stars);\n\tfree(rightMargin);\n\tfree(leftMargin);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf[1]",
            "\"FILE: %s, LINE: %d\"",
            "DbgFileName",
            "DbgLineNo"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf[0]",
            "\"DEBUG - THREAD ID: 0x%lX\"",
            "#ifdef WIN32\n\t\t(unsigned long int)ithread_self().p\n#else\n\t\t(unsigned long int)ithread_self()#endif"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ithread_self",
          "args": [],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ithread_self",
          "args": [
            "unsignedlong int"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ithread_self",
          "args": [],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WIN32",
          "args": [
            "unsignedlong int"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include \"upnpdebug.h\"\n#include \"upnp.h\"\n#include \"ixml.h\"\n#include \"ithread.h\"\n#include \"config.h\"\n\n#define NUMBER_OF_STARS 80\n#define MAX_LINE_SIZE 512\n#define NLINES 2\n\nvoid UpnpDisplayFileAndLine(FILE *fd, const char *DbgFileName, int DbgLineNo)\n{\n#define NLINES 2\n#define MAX_LINE_SIZE 512\n#define NUMBER_OF_STARS 80\n\tconst char *lines[NLINES];\n\tchar buf[NLINES][MAX_LINE_SIZE];\n\tint i;\n\n\t/* Initialize the pointer array */\n\tfor (i = 0; i < NLINES; i++)\n\t\tlines[i] = buf[i];\n\t/* Put the debug lines in the buffer */\n\tsprintf(buf[0], \"DEBUG - THREAD ID: 0x%lX\",\n#ifdef WIN32\n\t\t(unsigned long int)ithread_self().p\n#else\n\t\t(unsigned long int)ithread_self()\n#endif\n\t    );\n\tif (DbgFileName)\n\t\tsprintf(buf[1], \"FILE: %s, LINE: %d\", DbgFileName, DbgLineNo);\n\t/* Show the lines centered */\n\tUpnpDisplayBanner(fd, lines, NLINES, NUMBER_OF_STARS);\n\tfflush(fd);\n}"
  },
  {
    "function_name": "GetDebugFile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/upnpdebug.c",
    "lines": "156-170",
    "snippet": "FILE *GetDebugFile(Upnp_LogLevel DLevel, Dbg_Module Module)\n{\n\tFILE *ret;\n\n\tif (!DebugAtThisLevel(DLevel, Module))\n\t\tret = NULL;\n\tif (!DEBUG_TARGET)\n\t\tret = stdout;\n\telse if (DLevel == 0)\n\t\tret = ErrFileHnd;\n\telse\n\t\tret = InfoFileHnd;\n\n\treturn ret;\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <stdarg.h>",
      "#include \"upnpdebug.h\"",
      "#include \"upnp.h\"",
      "#include \"ixml.h\"",
      "#include \"ithread.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DebugAtThisLevel",
          "args": [
            "DLevel",
            "Module"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "DebugAtThisLevel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/upnpdebug.c",
          "lines": "108-122",
          "snippet": "int DebugAtThisLevel(Upnp_LogLevel DLevel, Dbg_Module Module)\n{\n\tint ret = DLevel <= g_log_level;\n\tret &=\n\t    DEBUG_ALL ||\n\t    (Module == SSDP && DEBUG_SSDP) ||\n\t    (Module == SOAP && DEBUG_SOAP) ||\n\t    (Module == GENA && DEBUG_GENA) ||\n\t    (Module == TPOOL && DEBUG_TPOOL) ||\n\t    (Module == MSERV && DEBUG_MSERV) ||\n\t    (Module == DOM && DEBUG_DOM) || (Module == HTTP && DEBUG_HTTP);\n\n\treturn ret;\n\tModule = Module; /* VC complains about this being unreferenced */\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include \"upnpdebug.h\"",
            "#include \"upnp.h\"",
            "#include \"ixml.h\"",
            "#include \"ithread.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include \"upnpdebug.h\"\n#include \"upnp.h\"\n#include \"ixml.h\"\n#include \"ithread.h\"\n#include \"config.h\"\n\nint DebugAtThisLevel(Upnp_LogLevel DLevel, Dbg_Module Module)\n{\n\tint ret = DLevel <= g_log_level;\n\tret &=\n\t    DEBUG_ALL ||\n\t    (Module == SSDP && DEBUG_SSDP) ||\n\t    (Module == SOAP && DEBUG_SOAP) ||\n\t    (Module == GENA && DEBUG_GENA) ||\n\t    (Module == TPOOL && DEBUG_TPOOL) ||\n\t    (Module == MSERV && DEBUG_MSERV) ||\n\t    (Module == DOM && DEBUG_DOM) || (Module == HTTP && DEBUG_HTTP);\n\n\treturn ret;\n\tModule = Module; /* VC complains about this being unreferenced */\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include \"upnpdebug.h\"\n#include \"upnp.h\"\n#include \"ixml.h\"\n#include \"ithread.h\"\n#include \"config.h\"\n\nFILE *GetDebugFile(Upnp_LogLevel DLevel, Dbg_Module Module)\n{\n\tFILE *ret;\n\n\tif (!DebugAtThisLevel(DLevel, Module))\n\t\tret = NULL;\n\tif (!DEBUG_TARGET)\n\t\tret = stdout;\n\telse if (DLevel == 0)\n\t\tret = ErrFileHnd;\n\telse\n\t\tret = InfoFileHnd;\n\n\treturn ret;\n}"
  },
  {
    "function_name": "UpnpPrintf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/upnpdebug.c",
    "lines": "124-154",
    "snippet": "void UpnpPrintf(Upnp_LogLevel DLevel,\n\t\tDbg_Module Module,\n\t\tconst char *DbgFileName, int DbgLineNo, const char *FmtStr, ...)\n{\n\tva_list ArgList;\n\n\tif (!DebugAtThisLevel(DLevel, Module))\n\t\treturn;\n\tithread_mutex_lock(&GlobalDebugMutex);\n\tva_start(ArgList, FmtStr);\n\tif (!DEBUG_TARGET) {\n\t\tif (DbgFileName)\n\t\t\tUpnpDisplayFileAndLine(stdout, DbgFileName, DbgLineNo);\n\t\tvfprintf(stdout, FmtStr, ArgList);\n\t\tfflush(stdout);\n\t} else if (DLevel == 0) {\n\t\tif (DbgFileName)\n\t\t\tUpnpDisplayFileAndLine(ErrFileHnd, DbgFileName,\n\t\t\t\t\t       DbgLineNo);\n\t\tvfprintf(ErrFileHnd, FmtStr, ArgList);\n\t\tfflush(ErrFileHnd);\n\t} else {\n\t\tif (DbgFileName)\n\t\t\tUpnpDisplayFileAndLine(InfoFileHnd, DbgFileName,\n\t\t\t\t\t       DbgLineNo);\n\t\tvfprintf(InfoFileHnd, FmtStr, ArgList);\n\t\tfflush(InfoFileHnd);\n\t}\n\tva_end(ArgList);\n\tithread_mutex_unlock(&GlobalDebugMutex);\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <stdarg.h>",
      "#include \"upnpdebug.h\"",
      "#include \"upnp.h\"",
      "#include \"ixml.h\"",
      "#include \"ithread.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ithread_mutex_unlock",
          "args": [
            "&GlobalDebugMutex"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ArgList"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fflush",
          "args": [
            "InfoFileHnd"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vfprintf",
          "args": [
            "InfoFileHnd",
            "FmtStr",
            "ArgList"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "UpnpDisplayFileAndLine",
          "args": [
            "InfoFileHnd",
            "DbgFileName",
            "DbgLineNo"
          ],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "UpnpDisplayFileAndLine",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/upnpdebug.c",
          "lines": "172-197",
          "snippet": "void UpnpDisplayFileAndLine(FILE *fd, const char *DbgFileName, int DbgLineNo)\n{\n#define NLINES 2\n#define MAX_LINE_SIZE 512\n#define NUMBER_OF_STARS 80\n\tconst char *lines[NLINES];\n\tchar buf[NLINES][MAX_LINE_SIZE];\n\tint i;\n\n\t/* Initialize the pointer array */\n\tfor (i = 0; i < NLINES; i++)\n\t\tlines[i] = buf[i];\n\t/* Put the debug lines in the buffer */\n\tsprintf(buf[0], \"DEBUG - THREAD ID: 0x%lX\",\n#ifdef WIN32\n\t\t(unsigned long int)ithread_self().p\n#else\n\t\t(unsigned long int)ithread_self()\n#endif\n\t    );\n\tif (DbgFileName)\n\t\tsprintf(buf[1], \"FILE: %s, LINE: %d\", DbgFileName, DbgLineNo);\n\t/* Show the lines centered */\n\tUpnpDisplayBanner(fd, lines, NLINES, NUMBER_OF_STARS);\n\tfflush(fd);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include \"upnpdebug.h\"",
            "#include \"upnp.h\"",
            "#include \"ixml.h\"",
            "#include \"ithread.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [
            "#define NUMBER_OF_STARS 80",
            "#define MAX_LINE_SIZE 512",
            "#define NLINES 2"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include \"upnpdebug.h\"\n#include \"upnp.h\"\n#include \"ixml.h\"\n#include \"ithread.h\"\n#include \"config.h\"\n\n#define NUMBER_OF_STARS 80\n#define MAX_LINE_SIZE 512\n#define NLINES 2\n\nvoid UpnpDisplayFileAndLine(FILE *fd, const char *DbgFileName, int DbgLineNo)\n{\n#define NLINES 2\n#define MAX_LINE_SIZE 512\n#define NUMBER_OF_STARS 80\n\tconst char *lines[NLINES];\n\tchar buf[NLINES][MAX_LINE_SIZE];\n\tint i;\n\n\t/* Initialize the pointer array */\n\tfor (i = 0; i < NLINES; i++)\n\t\tlines[i] = buf[i];\n\t/* Put the debug lines in the buffer */\n\tsprintf(buf[0], \"DEBUG - THREAD ID: 0x%lX\",\n#ifdef WIN32\n\t\t(unsigned long int)ithread_self().p\n#else\n\t\t(unsigned long int)ithread_self()\n#endif\n\t    );\n\tif (DbgFileName)\n\t\tsprintf(buf[1], \"FILE: %s, LINE: %d\", DbgFileName, DbgLineNo);\n\t/* Show the lines centered */\n\tUpnpDisplayBanner(fd, lines, NLINES, NUMBER_OF_STARS);\n\tfflush(fd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "fflush",
          "args": [
            "ErrFileHnd"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vfprintf",
          "args": [
            "ErrFileHnd",
            "FmtStr",
            "ArgList"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fflush",
          "args": [
            "stdout"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vfprintf",
          "args": [
            "stdout",
            "FmtStr",
            "ArgList"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ArgList",
            "FmtStr"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ithread_mutex_lock",
          "args": [
            "&GlobalDebugMutex"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DebugAtThisLevel",
          "args": [
            "DLevel",
            "Module"
          ],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "DebugAtThisLevel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/upnpdebug.c",
          "lines": "108-122",
          "snippet": "int DebugAtThisLevel(Upnp_LogLevel DLevel, Dbg_Module Module)\n{\n\tint ret = DLevel <= g_log_level;\n\tret &=\n\t    DEBUG_ALL ||\n\t    (Module == SSDP && DEBUG_SSDP) ||\n\t    (Module == SOAP && DEBUG_SOAP) ||\n\t    (Module == GENA && DEBUG_GENA) ||\n\t    (Module == TPOOL && DEBUG_TPOOL) ||\n\t    (Module == MSERV && DEBUG_MSERV) ||\n\t    (Module == DOM && DEBUG_DOM) || (Module == HTTP && DEBUG_HTTP);\n\n\treturn ret;\n\tModule = Module; /* VC complains about this being unreferenced */\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include \"upnpdebug.h\"",
            "#include \"upnp.h\"",
            "#include \"ixml.h\"",
            "#include \"ithread.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include \"upnpdebug.h\"\n#include \"upnp.h\"\n#include \"ixml.h\"\n#include \"ithread.h\"\n#include \"config.h\"\n\nint DebugAtThisLevel(Upnp_LogLevel DLevel, Dbg_Module Module)\n{\n\tint ret = DLevel <= g_log_level;\n\tret &=\n\t    DEBUG_ALL ||\n\t    (Module == SSDP && DEBUG_SSDP) ||\n\t    (Module == SOAP && DEBUG_SOAP) ||\n\t    (Module == GENA && DEBUG_GENA) ||\n\t    (Module == TPOOL && DEBUG_TPOOL) ||\n\t    (Module == MSERV && DEBUG_MSERV) ||\n\t    (Module == DOM && DEBUG_DOM) || (Module == HTTP && DEBUG_HTTP);\n\n\treturn ret;\n\tModule = Module; /* VC complains about this being unreferenced */\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include \"upnpdebug.h\"\n#include \"upnp.h\"\n#include \"ixml.h\"\n#include \"ithread.h\"\n#include \"config.h\"\n\nvoid UpnpPrintf(Upnp_LogLevel DLevel,\n\t\tDbg_Module Module,\n\t\tconst char *DbgFileName, int DbgLineNo, const char *FmtStr, ...)\n{\n\tva_list ArgList;\n\n\tif (!DebugAtThisLevel(DLevel, Module))\n\t\treturn;\n\tithread_mutex_lock(&GlobalDebugMutex);\n\tva_start(ArgList, FmtStr);\n\tif (!DEBUG_TARGET) {\n\t\tif (DbgFileName)\n\t\t\tUpnpDisplayFileAndLine(stdout, DbgFileName, DbgLineNo);\n\t\tvfprintf(stdout, FmtStr, ArgList);\n\t\tfflush(stdout);\n\t} else if (DLevel == 0) {\n\t\tif (DbgFileName)\n\t\t\tUpnpDisplayFileAndLine(ErrFileHnd, DbgFileName,\n\t\t\t\t\t       DbgLineNo);\n\t\tvfprintf(ErrFileHnd, FmtStr, ArgList);\n\t\tfflush(ErrFileHnd);\n\t} else {\n\t\tif (DbgFileName)\n\t\t\tUpnpDisplayFileAndLine(InfoFileHnd, DbgFileName,\n\t\t\t\t\t       DbgLineNo);\n\t\tvfprintf(InfoFileHnd, FmtStr, ArgList);\n\t\tfflush(InfoFileHnd);\n\t}\n\tva_end(ArgList);\n\tithread_mutex_unlock(&GlobalDebugMutex);\n}"
  },
  {
    "function_name": "DebugAtThisLevel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/upnpdebug.c",
    "lines": "108-122",
    "snippet": "int DebugAtThisLevel(Upnp_LogLevel DLevel, Dbg_Module Module)\n{\n\tint ret = DLevel <= g_log_level;\n\tret &=\n\t    DEBUG_ALL ||\n\t    (Module == SSDP && DEBUG_SSDP) ||\n\t    (Module == SOAP && DEBUG_SOAP) ||\n\t    (Module == GENA && DEBUG_GENA) ||\n\t    (Module == TPOOL && DEBUG_TPOOL) ||\n\t    (Module == MSERV && DEBUG_MSERV) ||\n\t    (Module == DOM && DEBUG_DOM) || (Module == HTTP && DEBUG_HTTP);\n\n\treturn ret;\n\tModule = Module; /* VC complains about this being unreferenced */\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <stdarg.h>",
      "#include \"upnpdebug.h\"",
      "#include \"upnp.h\"",
      "#include \"ixml.h\"",
      "#include \"ithread.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include \"upnpdebug.h\"\n#include \"upnp.h\"\n#include \"ixml.h\"\n#include \"ithread.h\"\n#include \"config.h\"\n\nint DebugAtThisLevel(Upnp_LogLevel DLevel, Dbg_Module Module)\n{\n\tint ret = DLevel <= g_log_level;\n\tret &=\n\t    DEBUG_ALL ||\n\t    (Module == SSDP && DEBUG_SSDP) ||\n\t    (Module == SOAP && DEBUG_SOAP) ||\n\t    (Module == GENA && DEBUG_GENA) ||\n\t    (Module == TPOOL && DEBUG_TPOOL) ||\n\t    (Module == MSERV && DEBUG_MSERV) ||\n\t    (Module == DOM && DEBUG_DOM) || (Module == HTTP && DEBUG_HTTP);\n\n\treturn ret;\n\tModule = Module; /* VC complains about this being unreferenced */\n}"
  },
  {
    "function_name": "UpnpSetLogFileNames",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/upnpdebug.c",
    "lines": "98-106",
    "snippet": "void UpnpSetLogFileNames(const char *ErrFileName, const char *InfoFileName)\n{\n\tif (ErrFileName) {\n\t\terrFileName = ErrFileName;\n\t}\n\tif (InfoFileName) {\n\t\tinfoFileName = InfoFileName;\n\t}\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <stdarg.h>",
      "#include \"upnpdebug.h\"",
      "#include \"upnp.h\"",
      "#include \"ixml.h\"",
      "#include \"ithread.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include \"upnpdebug.h\"\n#include \"upnp.h\"\n#include \"ixml.h\"\n#include \"ithread.h\"\n#include \"config.h\"\n\nvoid UpnpSetLogFileNames(const char *ErrFileName, const char *InfoFileName)\n{\n\tif (ErrFileName) {\n\t\terrFileName = ErrFileName;\n\t}\n\tif (InfoFileName) {\n\t\tinfoFileName = InfoFileName;\n\t}\n}"
  },
  {
    "function_name": "UpnpCloseLog",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/upnpdebug.c",
    "lines": "87-96",
    "snippet": "void UpnpCloseLog(void)\n{\n\tif (DEBUG_TARGET == 1) {\n\t\tfflush(ErrFileHnd);\n\t\tfflush(InfoFileHnd);\n\t\tfclose(ErrFileHnd);\n\t\tfclose(InfoFileHnd);\n\t}\n\tithread_mutex_destroy(&GlobalDebugMutex);\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <stdarg.h>",
      "#include \"upnpdebug.h\"",
      "#include \"upnp.h\"",
      "#include \"ixml.h\"",
      "#include \"ithread.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ithread_mutex_destroy",
          "args": [
            "&GlobalDebugMutex"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fclose",
          "args": [
            "InfoFileHnd"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fclose",
          "args": [
            "ErrFileHnd"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fflush",
          "args": [
            "InfoFileHnd"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fflush",
          "args": [
            "ErrFileHnd"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include \"upnpdebug.h\"\n#include \"upnp.h\"\n#include \"ixml.h\"\n#include \"ithread.h\"\n#include \"config.h\"\n\nvoid UpnpCloseLog(void)\n{\n\tif (DEBUG_TARGET == 1) {\n\t\tfflush(ErrFileHnd);\n\t\tfflush(InfoFileHnd);\n\t\tfclose(ErrFileHnd);\n\t\tfclose(InfoFileHnd);\n\t}\n\tithread_mutex_destroy(&GlobalDebugMutex);\n}"
  },
  {
    "function_name": "UpnpSetLogLevel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/upnpdebug.c",
    "lines": "82-85",
    "snippet": "void UpnpSetLogLevel(Upnp_LogLevel log_level)\n{\n\tg_log_level = log_level;\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <stdarg.h>",
      "#include \"upnpdebug.h\"",
      "#include \"upnp.h\"",
      "#include \"ixml.h\"",
      "#include \"ithread.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include \"upnpdebug.h\"\n#include \"upnp.h\"\n#include \"ixml.h\"\n#include \"ithread.h\"\n#include \"config.h\"\n\nvoid UpnpSetLogLevel(Upnp_LogLevel log_level)\n{\n\tg_log_level = log_level;\n}"
  },
  {
    "function_name": "UpnpInitLog",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/upnpdebug.c",
    "lines": "68-80",
    "snippet": "int UpnpInitLog(void)\n{\n\tithread_mutex_init(&GlobalDebugMutex, NULL);\n\tif (DEBUG_TARGET == 1) {\n\t\tif ((ErrFileHnd = fopen(errFileName, \"a\")) == NULL) {\n\t\t\treturn -1;\n\t\t}\n\t\tif ((InfoFileHnd = fopen(infoFileName, \"a\")) == NULL) {\n\t\t\treturn -1;\n\t\t}\n\t}\n\treturn UPNP_E_SUCCESS;\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <stdlib.h>",
      "#include <stdarg.h>",
      "#include \"upnpdebug.h\"",
      "#include \"upnp.h\"",
      "#include \"ixml.h\"",
      "#include \"ithread.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "infoFileName",
            "\"a\""
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "errFileName",
            "\"a\""
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ithread_mutex_init",
          "args": [
            "&GlobalDebugMutex",
            "NULL"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include \"upnpdebug.h\"\n#include \"upnp.h\"\n#include \"ixml.h\"\n#include \"ithread.h\"\n#include \"config.h\"\n\nint UpnpInitLog(void)\n{\n\tithread_mutex_init(&GlobalDebugMutex, NULL);\n\tif (DEBUG_TARGET == 1) {\n\t\tif ((ErrFileHnd = fopen(errFileName, \"a\")) == NULL) {\n\t\t\treturn -1;\n\t\t}\n\t\tif ((InfoFileHnd = fopen(infoFileName, \"a\")) == NULL) {\n\t\t\treturn -1;\n\t\t}\n\t}\n\treturn UPNP_E_SUCCESS;\n}"
  }
]