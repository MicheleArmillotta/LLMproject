[
  {
    "function_name": "getServiceTable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
    "lines": "1043-1070",
    "snippet": "int\ngetServiceTable( IXML_Node * node,\n                 service_table * out,\n                 const char *DefaultURLBase )\n{\n    IXML_Node *root = NULL;\n    IXML_Node *URLBase = NULL;\n\n    if( getSubElement( \"root\", node, &root ) ) {\n        if( getSubElement( \"URLBase\", root, &URLBase ) ) {\n            out->URLBase = getElementValue( URLBase );\n        } else {\n            if( DefaultURLBase ) {\n                out->URLBase = ixmlCloneDOMString( DefaultURLBase );\n            } else {\n                out->URLBase = ixmlCloneDOMString( \"\" );\n            }\n        }\n\n        if( ( out->serviceList = getAllServiceList(\n            root, out->URLBase, &out->endServiceList ) ) ) {\n            return 1;\n        }\n\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"service_table.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "getAllServiceList",
          "args": [
            "root",
            "out->URLBase",
            "&out->endServiceList"
          ],
          "line": 1062
        },
        "resolved": true,
        "details": {
          "function_name": "getAllServiceList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
          "lines": "860-896",
          "snippet": "service_info *\ngetAllServiceList( IXML_Node * node,\n                   char *URLBase,\n                   service_info ** out_end )\n{\n\tservice_info *head = NULL;\n\tservice_info *end = NULL;\n\tservice_info *next_end = NULL;\n\tIXML_NodeList *deviceList = NULL;\n\tIXML_Node *currentDevice = NULL;\n\n\tlong unsigned int NumOfDevices = 0lu;\n\tlong unsigned int i = 0lu;\n\n\t(*out_end) = NULL;\n\n\tdeviceList = ixmlElement_getElementsByTagName(\n\t\t(IXML_Element *)node, \"device\");\n\tif (deviceList) {\n\t\tNumOfDevices = ixmlNodeList_length(deviceList);\n\t\tfor (i = 0lu; i < NumOfDevices; i++) {\n\t\t\tcurrentDevice = ixmlNodeList_item(deviceList, i);\n\t\t\tif (head) {\n\t\t\t\tend->next = getServiceList(currentDevice,\n\t\t\t\t\t&next_end, URLBase);\n\t\t\t\tif (next_end)\n\t\t\t\t\tend = next_end;\n\t\t\t} else\n\t\t\t\thead = getServiceList(currentDevice, &end,\n\t\t\t\t\tURLBase);\n\t\t}\n\t\tixmlNodeList_free(deviceList);\n\t}\n\n\t(*out_end) = end;\n\treturn head;\n}",
          "includes": [
            "#include \"service_table.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nservice_info *\ngetAllServiceList( IXML_Node * node,\n                   char *URLBase,\n                   service_info ** out_end )\n{\n\tservice_info *head = NULL;\n\tservice_info *end = NULL;\n\tservice_info *next_end = NULL;\n\tIXML_NodeList *deviceList = NULL;\n\tIXML_Node *currentDevice = NULL;\n\n\tlong unsigned int NumOfDevices = 0lu;\n\tlong unsigned int i = 0lu;\n\n\t(*out_end) = NULL;\n\n\tdeviceList = ixmlElement_getElementsByTagName(\n\t\t(IXML_Element *)node, \"device\");\n\tif (deviceList) {\n\t\tNumOfDevices = ixmlNodeList_length(deviceList);\n\t\tfor (i = 0lu; i < NumOfDevices; i++) {\n\t\t\tcurrentDevice = ixmlNodeList_item(deviceList, i);\n\t\t\tif (head) {\n\t\t\t\tend->next = getServiceList(currentDevice,\n\t\t\t\t\t&next_end, URLBase);\n\t\t\t\tif (next_end)\n\t\t\t\t\tend = next_end;\n\t\t\t} else\n\t\t\t\thead = getServiceList(currentDevice, &end,\n\t\t\t\t\tURLBase);\n\t\t}\n\t\tixmlNodeList_free(deviceList);\n\t}\n\n\t(*out_end) = end;\n\treturn head;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ixmlCloneDOMString",
          "args": [
            "\"\""
          ],
          "line": 1058
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ixmlCloneDOMString",
          "args": [
            "DefaultURLBase"
          ],
          "line": 1056
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getElementValue",
          "args": [
            "URLBase"
          ],
          "line": 1053
        },
        "resolved": true,
        "details": {
          "function_name": "getElementValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
          "lines": "643-655",
          "snippet": "DOMString\ngetElementValue( IXML_Node * node )\n{\n    IXML_Node *child = ( IXML_Node * ) ixmlNode_getFirstChild( node );\n    const DOMString temp = NULL;\n\n    if( ( child != 0 ) && ( ixmlNode_getNodeType( child ) == eTEXT_NODE ) ) {\n        temp = ixmlNode_getNodeValue( child );\n        return ixmlCloneDOMString( temp );\n    } else {\n        return NULL;\n    }\n}",
          "includes": [
            "#include \"service_table.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nDOMString\ngetElementValue( IXML_Node * node )\n{\n    IXML_Node *child = ( IXML_Node * ) ixmlNode_getFirstChild( node );\n    const DOMString temp = NULL;\n\n    if( ( child != 0 ) && ( ixmlNode_getNodeType( child ) == eTEXT_NODE ) ) {\n        temp = ixmlNode_getNodeValue( child );\n        return ixmlCloneDOMString( temp );\n    } else {\n        return NULL;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getSubElement",
          "args": [
            "\"URLBase\"",
            "root",
            "&URLBase"
          ],
          "line": 1052
        },
        "resolved": true,
        "details": {
          "function_name": "getSubElement",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
          "lines": "676-710",
          "snippet": "int\ngetSubElement( const char *element_name,\n               IXML_Node * node,\n               IXML_Node ** out )\n{\n\n    const DOMString NodeName = NULL;\n    int found = 0;\n\n    IXML_Node *child = ( IXML_Node * ) ixmlNode_getFirstChild( node );\n\n    ( *out ) = NULL;\n\n    while( ( child != NULL ) && ( !found ) ) {\n\n        switch ( ixmlNode_getNodeType( child ) ) {\n            case eELEMENT_NODE:\n\n                NodeName = ixmlNode_getNodeName( child );\n                if( !strcmp( NodeName, element_name ) ) {\n                    ( *out ) = child;\n                    found = 1;\n                    return found;\n                }\n                break;\n\n            default:\n                break;\n        }\n\n        child = ( IXML_Node * ) ixmlNode_getNextSibling( child );\n    }\n\n    return found;\n}",
          "includes": [
            "#include \"service_table.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nint\ngetSubElement( const char *element_name,\n               IXML_Node * node,\n               IXML_Node ** out )\n{\n\n    const DOMString NodeName = NULL;\n    int found = 0;\n\n    IXML_Node *child = ( IXML_Node * ) ixmlNode_getFirstChild( node );\n\n    ( *out ) = NULL;\n\n    while( ( child != NULL ) && ( !found ) ) {\n\n        switch ( ixmlNode_getNodeType( child ) ) {\n            case eELEMENT_NODE:\n\n                NodeName = ixmlNode_getNodeName( child );\n                if( !strcmp( NodeName, element_name ) ) {\n                    ( *out ) = child;\n                    found = 1;\n                    return found;\n                }\n                break;\n\n            default:\n                break;\n        }\n\n        child = ( IXML_Node * ) ixmlNode_getNextSibling( child );\n    }\n\n    return found;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nint\ngetServiceTable( IXML_Node * node,\n                 service_table * out,\n                 const char *DefaultURLBase )\n{\n    IXML_Node *root = NULL;\n    IXML_Node *URLBase = NULL;\n\n    if( getSubElement( \"root\", node, &root ) ) {\n        if( getSubElement( \"URLBase\", root, &URLBase ) ) {\n            out->URLBase = getElementValue( URLBase );\n        } else {\n            if( DefaultURLBase ) {\n                out->URLBase = ixmlCloneDOMString( DefaultURLBase );\n            } else {\n                out->URLBase = ixmlCloneDOMString( \"\" );\n            }\n        }\n\n        if( ( out->serviceList = getAllServiceList(\n            root, out->URLBase, &out->endServiceList ) ) ) {\n            return 1;\n        }\n\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "addServiceTable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
    "lines": "990-1025",
    "snippet": "int\naddServiceTable( IXML_Node * node,\n                 service_table * in,\n                 const char *DefaultURLBase )\n{\n    IXML_Node *root = NULL;\n    IXML_Node *URLBase = NULL;\n\n    service_info *tempEnd = NULL;\n\n    if( in->URLBase ) {\n        free( in->URLBase );\n        in->URLBase = NULL;\n    }\n\n    if( getSubElement( \"root\", node, &root ) ) {\n        if( getSubElement( \"URLBase\", root, &URLBase ) ) {\n            in->URLBase = getElementValue( URLBase );\n        } else {\n            if( DefaultURLBase ) {\n                in->URLBase = ixmlCloneDOMString( DefaultURLBase );\n            } else {\n                in->URLBase = ixmlCloneDOMString( \"\" );\n            }\n        }\n\n        if( ( in->endServiceList->next =\n              getAllServiceList( root, in->URLBase, &tempEnd ) ) ) {\n            in->endServiceList = tempEnd;\n            return 1;\n        }\n\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"service_table.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "getAllServiceList",
          "args": [
            "root",
            "in->URLBase",
            "&tempEnd"
          ],
          "line": 1017
        },
        "resolved": true,
        "details": {
          "function_name": "getAllServiceList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
          "lines": "860-896",
          "snippet": "service_info *\ngetAllServiceList( IXML_Node * node,\n                   char *URLBase,\n                   service_info ** out_end )\n{\n\tservice_info *head = NULL;\n\tservice_info *end = NULL;\n\tservice_info *next_end = NULL;\n\tIXML_NodeList *deviceList = NULL;\n\tIXML_Node *currentDevice = NULL;\n\n\tlong unsigned int NumOfDevices = 0lu;\n\tlong unsigned int i = 0lu;\n\n\t(*out_end) = NULL;\n\n\tdeviceList = ixmlElement_getElementsByTagName(\n\t\t(IXML_Element *)node, \"device\");\n\tif (deviceList) {\n\t\tNumOfDevices = ixmlNodeList_length(deviceList);\n\t\tfor (i = 0lu; i < NumOfDevices; i++) {\n\t\t\tcurrentDevice = ixmlNodeList_item(deviceList, i);\n\t\t\tif (head) {\n\t\t\t\tend->next = getServiceList(currentDevice,\n\t\t\t\t\t&next_end, URLBase);\n\t\t\t\tif (next_end)\n\t\t\t\t\tend = next_end;\n\t\t\t} else\n\t\t\t\thead = getServiceList(currentDevice, &end,\n\t\t\t\t\tURLBase);\n\t\t}\n\t\tixmlNodeList_free(deviceList);\n\t}\n\n\t(*out_end) = end;\n\treturn head;\n}",
          "includes": [
            "#include \"service_table.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nservice_info *\ngetAllServiceList( IXML_Node * node,\n                   char *URLBase,\n                   service_info ** out_end )\n{\n\tservice_info *head = NULL;\n\tservice_info *end = NULL;\n\tservice_info *next_end = NULL;\n\tIXML_NodeList *deviceList = NULL;\n\tIXML_Node *currentDevice = NULL;\n\n\tlong unsigned int NumOfDevices = 0lu;\n\tlong unsigned int i = 0lu;\n\n\t(*out_end) = NULL;\n\n\tdeviceList = ixmlElement_getElementsByTagName(\n\t\t(IXML_Element *)node, \"device\");\n\tif (deviceList) {\n\t\tNumOfDevices = ixmlNodeList_length(deviceList);\n\t\tfor (i = 0lu; i < NumOfDevices; i++) {\n\t\t\tcurrentDevice = ixmlNodeList_item(deviceList, i);\n\t\t\tif (head) {\n\t\t\t\tend->next = getServiceList(currentDevice,\n\t\t\t\t\t&next_end, URLBase);\n\t\t\t\tif (next_end)\n\t\t\t\t\tend = next_end;\n\t\t\t} else\n\t\t\t\thead = getServiceList(currentDevice, &end,\n\t\t\t\t\tURLBase);\n\t\t}\n\t\tixmlNodeList_free(deviceList);\n\t}\n\n\t(*out_end) = end;\n\treturn head;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ixmlCloneDOMString",
          "args": [
            "\"\""
          ],
          "line": 1012
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ixmlCloneDOMString",
          "args": [
            "DefaultURLBase"
          ],
          "line": 1010
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getElementValue",
          "args": [
            "URLBase"
          ],
          "line": 1007
        },
        "resolved": true,
        "details": {
          "function_name": "getElementValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
          "lines": "643-655",
          "snippet": "DOMString\ngetElementValue( IXML_Node * node )\n{\n    IXML_Node *child = ( IXML_Node * ) ixmlNode_getFirstChild( node );\n    const DOMString temp = NULL;\n\n    if( ( child != 0 ) && ( ixmlNode_getNodeType( child ) == eTEXT_NODE ) ) {\n        temp = ixmlNode_getNodeValue( child );\n        return ixmlCloneDOMString( temp );\n    } else {\n        return NULL;\n    }\n}",
          "includes": [
            "#include \"service_table.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nDOMString\ngetElementValue( IXML_Node * node )\n{\n    IXML_Node *child = ( IXML_Node * ) ixmlNode_getFirstChild( node );\n    const DOMString temp = NULL;\n\n    if( ( child != 0 ) && ( ixmlNode_getNodeType( child ) == eTEXT_NODE ) ) {\n        temp = ixmlNode_getNodeValue( child );\n        return ixmlCloneDOMString( temp );\n    } else {\n        return NULL;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getSubElement",
          "args": [
            "\"URLBase\"",
            "root",
            "&URLBase"
          ],
          "line": 1006
        },
        "resolved": true,
        "details": {
          "function_name": "getSubElement",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
          "lines": "676-710",
          "snippet": "int\ngetSubElement( const char *element_name,\n               IXML_Node * node,\n               IXML_Node ** out )\n{\n\n    const DOMString NodeName = NULL;\n    int found = 0;\n\n    IXML_Node *child = ( IXML_Node * ) ixmlNode_getFirstChild( node );\n\n    ( *out ) = NULL;\n\n    while( ( child != NULL ) && ( !found ) ) {\n\n        switch ( ixmlNode_getNodeType( child ) ) {\n            case eELEMENT_NODE:\n\n                NodeName = ixmlNode_getNodeName( child );\n                if( !strcmp( NodeName, element_name ) ) {\n                    ( *out ) = child;\n                    found = 1;\n                    return found;\n                }\n                break;\n\n            default:\n                break;\n        }\n\n        child = ( IXML_Node * ) ixmlNode_getNextSibling( child );\n    }\n\n    return found;\n}",
          "includes": [
            "#include \"service_table.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nint\ngetSubElement( const char *element_name,\n               IXML_Node * node,\n               IXML_Node ** out )\n{\n\n    const DOMString NodeName = NULL;\n    int found = 0;\n\n    IXML_Node *child = ( IXML_Node * ) ixmlNode_getFirstChild( node );\n\n    ( *out ) = NULL;\n\n    while( ( child != NULL ) && ( !found ) ) {\n\n        switch ( ixmlNode_getNodeType( child ) ) {\n            case eELEMENT_NODE:\n\n                NodeName = ixmlNode_getNodeName( child );\n                if( !strcmp( NodeName, element_name ) ) {\n                    ( *out ) = child;\n                    found = 1;\n                    return found;\n                }\n                break;\n\n            default:\n                break;\n        }\n\n        child = ( IXML_Node * ) ixmlNode_getNextSibling( child );\n    }\n\n    return found;\n}"
        }
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "in->URLBase"
          ],
          "line": 1001
        },
        "resolved": true,
        "details": {
          "function_name": "freeServiceTable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
          "lines": "621-628",
          "snippet": "void\nfreeServiceTable( service_table * table )\n{\n    ixmlFreeDOMString( table->URLBase );\n    freeServiceList( table->serviceList );\n    table->serviceList = NULL;\n    table->endServiceList = NULL;\n}",
          "includes": [
            "#include \"service_table.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nvoid\nfreeServiceTable( service_table * table )\n{\n    ixmlFreeDOMString( table->URLBase );\n    freeServiceList( table->serviceList );\n    table->serviceList = NULL;\n    table->endServiceList = NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nint\naddServiceTable( IXML_Node * node,\n                 service_table * in,\n                 const char *DefaultURLBase )\n{\n    IXML_Node *root = NULL;\n    IXML_Node *URLBase = NULL;\n\n    service_info *tempEnd = NULL;\n\n    if( in->URLBase ) {\n        free( in->URLBase );\n        in->URLBase = NULL;\n    }\n\n    if( getSubElement( \"root\", node, &root ) ) {\n        if( getSubElement( \"URLBase\", root, &URLBase ) ) {\n            in->URLBase = getElementValue( URLBase );\n        } else {\n            if( DefaultURLBase ) {\n                in->URLBase = ixmlCloneDOMString( DefaultURLBase );\n            } else {\n                in->URLBase = ixmlCloneDOMString( \"\" );\n            }\n        }\n\n        if( ( in->endServiceList->next =\n              getAllServiceList( root, in->URLBase, &tempEnd ) ) ) {\n            in->endServiceList = tempEnd;\n            return 1;\n        }\n\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "removeServiceTable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
    "lines": "915-972",
    "snippet": "int\nremoveServiceTable( IXML_Node * node,\n                    service_table * in )\n{\n    IXML_Node *root = NULL;\n    IXML_Node *currentUDN = NULL;\n    DOMString UDN = NULL;\n    IXML_NodeList *deviceList = NULL;\n    service_info *current_service = NULL;\n    service_info *start_search = NULL;\n    service_info *prev_service = NULL;\n    long unsigned int NumOfDevices = 0lu;\n    long unsigned int i = 0lu;\n\n    if( getSubElement( \"root\", node, &root ) ) {\n        start_search = in->serviceList;\n        deviceList =\n            ixmlElement_getElementsByTagName( ( IXML_Element * ) root,\n                                              \"device\" );\n        if( deviceList != NULL ) {\n            NumOfDevices = ixmlNodeList_length( deviceList );\n            for( i = 0lu; i < NumOfDevices; i++ ) {\n                if( ( start_search )\n                    && ( ( getSubElement( \"UDN\", node, &currentUDN ) )\n                         && ( UDN = getElementValue( currentUDN ) ) ) ) {\n                    current_service = start_search;\n                    /*Services are put in the service table in the order in which they appear in the  */\n                    /*description document, therefore we go through the list only once to remove a particular */\n                    /*root device */\n                    while( ( current_service )\n                           && ( strcmp( current_service->UDN, UDN ) ) ) {\n                        current_service = current_service->next;\n\t\t\tif( current_service != NULL) \n                        \tprev_service = current_service->next;\n                    }\n                    while( ( current_service )\n                           && ( !strcmp( current_service->UDN, UDN ) ) ) {\n                        if( prev_service ) {\n                            prev_service->next = current_service->next;\n                        } else {\n                            in->serviceList = current_service->next;\n                        }\n                        if( current_service == in->endServiceList )\n                            in->endServiceList = prev_service;\n                        start_search = current_service->next;\n                        freeService( current_service );\n                        current_service = start_search;\n                    }\n                    ixmlFreeDOMString( UDN );\n                    UDN = NULL;\n                }\n            }\n\n            ixmlNodeList_free( deviceList );\n        }\n    }\n    return 1;\n}",
    "includes": [
      "#include \"service_table.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ixmlNodeList_free",
          "args": [
            "deviceList"
          ],
          "line": 968
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ixmlFreeDOMString",
          "args": [
            "UDN"
          ],
          "line": 963
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "freeService",
          "args": [
            "current_service"
          ],
          "line": 960
        },
        "resolved": true,
        "details": {
          "function_name": "freeServiceTable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
          "lines": "621-628",
          "snippet": "void\nfreeServiceTable( service_table * table )\n{\n    ixmlFreeDOMString( table->URLBase );\n    freeServiceList( table->serviceList );\n    table->serviceList = NULL;\n    table->endServiceList = NULL;\n}",
          "includes": [
            "#include \"service_table.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nvoid\nfreeServiceTable( service_table * table )\n{\n    ixmlFreeDOMString( table->URLBase );\n    freeServiceList( table->serviceList );\n    table->serviceList = NULL;\n    table->endServiceList = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "current_service->UDN",
            "UDN"
          ],
          "line": 951
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "current_service->UDN",
            "UDN"
          ],
          "line": 945
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getElementValue",
          "args": [
            "currentUDN"
          ],
          "line": 939
        },
        "resolved": true,
        "details": {
          "function_name": "getElementValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
          "lines": "643-655",
          "snippet": "DOMString\ngetElementValue( IXML_Node * node )\n{\n    IXML_Node *child = ( IXML_Node * ) ixmlNode_getFirstChild( node );\n    const DOMString temp = NULL;\n\n    if( ( child != 0 ) && ( ixmlNode_getNodeType( child ) == eTEXT_NODE ) ) {\n        temp = ixmlNode_getNodeValue( child );\n        return ixmlCloneDOMString( temp );\n    } else {\n        return NULL;\n    }\n}",
          "includes": [
            "#include \"service_table.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nDOMString\ngetElementValue( IXML_Node * node )\n{\n    IXML_Node *child = ( IXML_Node * ) ixmlNode_getFirstChild( node );\n    const DOMString temp = NULL;\n\n    if( ( child != 0 ) && ( ixmlNode_getNodeType( child ) == eTEXT_NODE ) ) {\n        temp = ixmlNode_getNodeValue( child );\n        return ixmlCloneDOMString( temp );\n    } else {\n        return NULL;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getSubElement",
          "args": [
            "\"UDN\"",
            "node",
            "&currentUDN"
          ],
          "line": 938
        },
        "resolved": true,
        "details": {
          "function_name": "getSubElement",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
          "lines": "676-710",
          "snippet": "int\ngetSubElement( const char *element_name,\n               IXML_Node * node,\n               IXML_Node ** out )\n{\n\n    const DOMString NodeName = NULL;\n    int found = 0;\n\n    IXML_Node *child = ( IXML_Node * ) ixmlNode_getFirstChild( node );\n\n    ( *out ) = NULL;\n\n    while( ( child != NULL ) && ( !found ) ) {\n\n        switch ( ixmlNode_getNodeType( child ) ) {\n            case eELEMENT_NODE:\n\n                NodeName = ixmlNode_getNodeName( child );\n                if( !strcmp( NodeName, element_name ) ) {\n                    ( *out ) = child;\n                    found = 1;\n                    return found;\n                }\n                break;\n\n            default:\n                break;\n        }\n\n        child = ( IXML_Node * ) ixmlNode_getNextSibling( child );\n    }\n\n    return found;\n}",
          "includes": [
            "#include \"service_table.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nint\ngetSubElement( const char *element_name,\n               IXML_Node * node,\n               IXML_Node ** out )\n{\n\n    const DOMString NodeName = NULL;\n    int found = 0;\n\n    IXML_Node *child = ( IXML_Node * ) ixmlNode_getFirstChild( node );\n\n    ( *out ) = NULL;\n\n    while( ( child != NULL ) && ( !found ) ) {\n\n        switch ( ixmlNode_getNodeType( child ) ) {\n            case eELEMENT_NODE:\n\n                NodeName = ixmlNode_getNodeName( child );\n                if( !strcmp( NodeName, element_name ) ) {\n                    ( *out ) = child;\n                    found = 1;\n                    return found;\n                }\n                break;\n\n            default:\n                break;\n        }\n\n        child = ( IXML_Node * ) ixmlNode_getNextSibling( child );\n    }\n\n    return found;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ixmlNodeList_length",
          "args": [
            "deviceList"
          ],
          "line": 935
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ixmlElement_getElementsByTagName",
          "args": [
            "( IXML_Element * ) root",
            "\"device\""
          ],
          "line": 932
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nint\nremoveServiceTable( IXML_Node * node,\n                    service_table * in )\n{\n    IXML_Node *root = NULL;\n    IXML_Node *currentUDN = NULL;\n    DOMString UDN = NULL;\n    IXML_NodeList *deviceList = NULL;\n    service_info *current_service = NULL;\n    service_info *start_search = NULL;\n    service_info *prev_service = NULL;\n    long unsigned int NumOfDevices = 0lu;\n    long unsigned int i = 0lu;\n\n    if( getSubElement( \"root\", node, &root ) ) {\n        start_search = in->serviceList;\n        deviceList =\n            ixmlElement_getElementsByTagName( ( IXML_Element * ) root,\n                                              \"device\" );\n        if( deviceList != NULL ) {\n            NumOfDevices = ixmlNodeList_length( deviceList );\n            for( i = 0lu; i < NumOfDevices; i++ ) {\n                if( ( start_search )\n                    && ( ( getSubElement( \"UDN\", node, &currentUDN ) )\n                         && ( UDN = getElementValue( currentUDN ) ) ) ) {\n                    current_service = start_search;\n                    /*Services are put in the service table in the order in which they appear in the  */\n                    /*description document, therefore we go through the list only once to remove a particular */\n                    /*root device */\n                    while( ( current_service )\n                           && ( strcmp( current_service->UDN, UDN ) ) ) {\n                        current_service = current_service->next;\n\t\t\tif( current_service != NULL) \n                        \tprev_service = current_service->next;\n                    }\n                    while( ( current_service )\n                           && ( !strcmp( current_service->UDN, UDN ) ) ) {\n                        if( prev_service ) {\n                            prev_service->next = current_service->next;\n                        } else {\n                            in->serviceList = current_service->next;\n                        }\n                        if( current_service == in->endServiceList )\n                            in->endServiceList = prev_service;\n                        start_search = current_service->next;\n                        freeService( current_service );\n                        current_service = start_search;\n                    }\n                    ixmlFreeDOMString( UDN );\n                    UDN = NULL;\n                }\n            }\n\n            ixmlNodeList_free( deviceList );\n        }\n    }\n    return 1;\n}"
  },
  {
    "function_name": "getAllServiceList",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
    "lines": "860-896",
    "snippet": "service_info *\ngetAllServiceList( IXML_Node * node,\n                   char *URLBase,\n                   service_info ** out_end )\n{\n\tservice_info *head = NULL;\n\tservice_info *end = NULL;\n\tservice_info *next_end = NULL;\n\tIXML_NodeList *deviceList = NULL;\n\tIXML_Node *currentDevice = NULL;\n\n\tlong unsigned int NumOfDevices = 0lu;\n\tlong unsigned int i = 0lu;\n\n\t(*out_end) = NULL;\n\n\tdeviceList = ixmlElement_getElementsByTagName(\n\t\t(IXML_Element *)node, \"device\");\n\tif (deviceList) {\n\t\tNumOfDevices = ixmlNodeList_length(deviceList);\n\t\tfor (i = 0lu; i < NumOfDevices; i++) {\n\t\t\tcurrentDevice = ixmlNodeList_item(deviceList, i);\n\t\t\tif (head) {\n\t\t\t\tend->next = getServiceList(currentDevice,\n\t\t\t\t\t&next_end, URLBase);\n\t\t\t\tif (next_end)\n\t\t\t\t\tend = next_end;\n\t\t\t} else\n\t\t\t\thead = getServiceList(currentDevice, &end,\n\t\t\t\t\tURLBase);\n\t\t}\n\t\tixmlNodeList_free(deviceList);\n\t}\n\n\t(*out_end) = end;\n\treturn head;\n}",
    "includes": [
      "#include \"service_table.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ixmlNodeList_free",
          "args": [
            "deviceList"
          ],
          "line": 891
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getServiceList",
          "args": [
            "currentDevice",
            "&end",
            "URLBase"
          ],
          "line": 888
        },
        "resolved": true,
        "details": {
          "function_name": "getServiceList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
          "lines": "728-842",
          "snippet": "service_info *getServiceList(\n\tIXML_Node *node,\n\tservice_info **end,\n\tchar *URLBase)\n{\n\tIXML_Node *serviceList = NULL;\n\tIXML_Node *current_service = NULL;\n\tIXML_Node *UDN = NULL;\n\n\tIXML_Node *serviceType = NULL;\n\tIXML_Node *serviceId = NULL;\n\tIXML_Node *SCPDURL = NULL;\n\tIXML_Node *controlURL = NULL;\n\tIXML_Node *eventURL = NULL;\n\tDOMString tempDOMString = NULL;\n\tservice_info *head = NULL;\n\tservice_info *current = NULL;\n\tservice_info *previous = NULL;\n\tIXML_NodeList *serviceNodeList = NULL;\n\tlong unsigned int NumOfServices = 0lu;\n\tlong unsigned int i = 0lu;\n\tint fail = 0;\n\n\tif (getSubElement(\"UDN\", node, &UDN) &&\n\t    getSubElement(\"serviceList\", node, &serviceList)) {\n\t\tserviceNodeList = ixmlElement_getElementsByTagName(\n\t\t\t(IXML_Element *)serviceList, \"service\");\n\t\tif (serviceNodeList != NULL) {\n\t\t\tNumOfServices = ixmlNodeList_length(serviceNodeList);\n\t\t\tfor (i = 0lu; i < NumOfServices; i++) {\n\t\t\t\tcurrent_service =\n\t\t\t\t    ixmlNodeList_item(serviceNodeList, i);\n\t\t\t\tfail = 0;\n\t\t\t\tif (current) {\n\t\t\t\t\tcurrent->next = malloc(sizeof(service_info));\n\t\t\t\t\tprevious = current;\n\t\t\t\t\tcurrent = current->next;\n\t\t\t\t} else {\n\t\t\t\t\thead = malloc(sizeof(service_info));\n\t\t\t\t\tcurrent = head;\n\t\t\t\t}\n\t\t\t\tif (!current) {\n\t\t\t\t\tfreeServiceList(head);\n\t\t\t\t\tixmlNodeList_free(serviceNodeList);\n\t\t\t\t\treturn NULL;\n\t\t\t\t}\n\t\t\t\tcurrent->next = NULL;\n\t\t\t\tcurrent->controlURL = NULL;\n\t\t\t\tcurrent->eventURL = NULL;\n\t\t\t\tcurrent->serviceType = NULL;\n\t\t\t\tcurrent->serviceId = NULL;\n\t\t\t\tcurrent->SCPDURL = NULL;\n\t\t\t\tcurrent->active = 1;\n\t\t\t\tcurrent->subscriptionList = NULL;\n\t\t\t\tcurrent->TotalSubscriptions = 0;\n\t\t\t\tif (!(current->UDN = getElementValue(UDN)))\n\t\t\t\t\tfail = 1;\n\t\t\t\tif (!getSubElement(\"serviceType\", current_service, &serviceType) ||\n\t\t\t\t    !(current->serviceType = getElementValue(serviceType)))\n\t\t\t\t\tfail = 1;\n\t\t\t\tif (!getSubElement(\"serviceId\", current_service, &serviceId) ||\n\t\t\t\t    !(current->serviceId = getElementValue(serviceId)))\n\t\t\t\t\tfail = 1;\n\t\t\t\tif (!getSubElement(\"SCPDURL\", current_service, &SCPDURL) ||\n\t\t\t\t    !(tempDOMString = getElementValue(SCPDURL)) ||\n\t\t\t\t    !(current->SCPDURL = resolve_rel_url(URLBase, tempDOMString)))\n\t\t\t\t\tfail = 1;\n\t\t\t\tixmlFreeDOMString(tempDOMString);\n\t\t\t\ttempDOMString = NULL;\n\t\t\t\tif (!(getSubElement(\"controlURL\", current_service, &controlURL)) ||\n\t\t\t\t    !(tempDOMString = getElementValue(controlURL)) ||\n\t\t\t\t    !(current->controlURL = resolve_rel_url(URLBase, tempDOMString))) {\n\t\t\t\t\tUpnpPrintf(UPNP_INFO, GENA, __FILE__,\n\t\t\t\t\t\t   __LINE__,\n\t\t\t\t\t\t   \"BAD OR MISSING CONTROL URL\");\n\t\t\t\t\tUpnpPrintf(UPNP_INFO, GENA, __FILE__,\n\t\t\t\t\t\t   __LINE__,\n\t\t\t\t\t\t   \"CONTROL URL SET TO NULL IN SERVICE INFO\");\n\t\t\t\t\tcurrent->controlURL = NULL;\n\t\t\t\t\tfail = 0;\n\t\t\t\t}\n\t\t\t\tixmlFreeDOMString(tempDOMString);\n\t\t\t\ttempDOMString = NULL;\n\t\t\t\tif (!getSubElement(\"eventSubURL\", current_service, &eventURL) ||\n\t\t\t\t    !(tempDOMString = getElementValue(eventURL)) ||\n\t\t\t\t    !(current->eventURL = resolve_rel_url(URLBase, tempDOMString))) {\n\t\t\t\t\tUpnpPrintf(UPNP_INFO, GENA, __FILE__,\n\t\t\t\t\t\t   __LINE__,\n\t\t\t\t\t\t   \"BAD OR MISSING EVENT URL\");\n\t\t\t\t\tUpnpPrintf(UPNP_INFO, GENA, __FILE__,\n\t\t\t\t\t\t   __LINE__,\n\t\t\t\t\t\t   \"EVENT URL SET TO NULL IN SERVICE INFO\");\n\t\t\t\t\tcurrent->eventURL = NULL;\n\t\t\t\t\tfail = 0;\n\t\t\t\t}\n\t\t\t\tixmlFreeDOMString(tempDOMString);\n\t\t\t\ttempDOMString = NULL;\n\t\t\t\tif (fail) {\n\t\t\t\t\tfreeServiceList(current);\n\t\t\t\t\tif (previous)\n\t\t\t\t\t\tprevious->next = NULL;\n\t\t\t\t\telse\n\t\t\t\t\t\thead = NULL;\n\t\t\t\t\tcurrent = previous;\n\t\t\t\t}\n\t\t\t}\n\t\t\tixmlNodeList_free(serviceNodeList);\n\t\t}\n\t\t(*end) = current;\n\t\treturn head;\n\t} else {\n\t\t(*end) = NULL;\n\t\treturn NULL;\n\t}\n}",
          "includes": [
            "#include \"service_table.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nservice_info *getServiceList(\n\tIXML_Node *node,\n\tservice_info **end,\n\tchar *URLBase)\n{\n\tIXML_Node *serviceList = NULL;\n\tIXML_Node *current_service = NULL;\n\tIXML_Node *UDN = NULL;\n\n\tIXML_Node *serviceType = NULL;\n\tIXML_Node *serviceId = NULL;\n\tIXML_Node *SCPDURL = NULL;\n\tIXML_Node *controlURL = NULL;\n\tIXML_Node *eventURL = NULL;\n\tDOMString tempDOMString = NULL;\n\tservice_info *head = NULL;\n\tservice_info *current = NULL;\n\tservice_info *previous = NULL;\n\tIXML_NodeList *serviceNodeList = NULL;\n\tlong unsigned int NumOfServices = 0lu;\n\tlong unsigned int i = 0lu;\n\tint fail = 0;\n\n\tif (getSubElement(\"UDN\", node, &UDN) &&\n\t    getSubElement(\"serviceList\", node, &serviceList)) {\n\t\tserviceNodeList = ixmlElement_getElementsByTagName(\n\t\t\t(IXML_Element *)serviceList, \"service\");\n\t\tif (serviceNodeList != NULL) {\n\t\t\tNumOfServices = ixmlNodeList_length(serviceNodeList);\n\t\t\tfor (i = 0lu; i < NumOfServices; i++) {\n\t\t\t\tcurrent_service =\n\t\t\t\t    ixmlNodeList_item(serviceNodeList, i);\n\t\t\t\tfail = 0;\n\t\t\t\tif (current) {\n\t\t\t\t\tcurrent->next = malloc(sizeof(service_info));\n\t\t\t\t\tprevious = current;\n\t\t\t\t\tcurrent = current->next;\n\t\t\t\t} else {\n\t\t\t\t\thead = malloc(sizeof(service_info));\n\t\t\t\t\tcurrent = head;\n\t\t\t\t}\n\t\t\t\tif (!current) {\n\t\t\t\t\tfreeServiceList(head);\n\t\t\t\t\tixmlNodeList_free(serviceNodeList);\n\t\t\t\t\treturn NULL;\n\t\t\t\t}\n\t\t\t\tcurrent->next = NULL;\n\t\t\t\tcurrent->controlURL = NULL;\n\t\t\t\tcurrent->eventURL = NULL;\n\t\t\t\tcurrent->serviceType = NULL;\n\t\t\t\tcurrent->serviceId = NULL;\n\t\t\t\tcurrent->SCPDURL = NULL;\n\t\t\t\tcurrent->active = 1;\n\t\t\t\tcurrent->subscriptionList = NULL;\n\t\t\t\tcurrent->TotalSubscriptions = 0;\n\t\t\t\tif (!(current->UDN = getElementValue(UDN)))\n\t\t\t\t\tfail = 1;\n\t\t\t\tif (!getSubElement(\"serviceType\", current_service, &serviceType) ||\n\t\t\t\t    !(current->serviceType = getElementValue(serviceType)))\n\t\t\t\t\tfail = 1;\n\t\t\t\tif (!getSubElement(\"serviceId\", current_service, &serviceId) ||\n\t\t\t\t    !(current->serviceId = getElementValue(serviceId)))\n\t\t\t\t\tfail = 1;\n\t\t\t\tif (!getSubElement(\"SCPDURL\", current_service, &SCPDURL) ||\n\t\t\t\t    !(tempDOMString = getElementValue(SCPDURL)) ||\n\t\t\t\t    !(current->SCPDURL = resolve_rel_url(URLBase, tempDOMString)))\n\t\t\t\t\tfail = 1;\n\t\t\t\tixmlFreeDOMString(tempDOMString);\n\t\t\t\ttempDOMString = NULL;\n\t\t\t\tif (!(getSubElement(\"controlURL\", current_service, &controlURL)) ||\n\t\t\t\t    !(tempDOMString = getElementValue(controlURL)) ||\n\t\t\t\t    !(current->controlURL = resolve_rel_url(URLBase, tempDOMString))) {\n\t\t\t\t\tUpnpPrintf(UPNP_INFO, GENA, __FILE__,\n\t\t\t\t\t\t   __LINE__,\n\t\t\t\t\t\t   \"BAD OR MISSING CONTROL URL\");\n\t\t\t\t\tUpnpPrintf(UPNP_INFO, GENA, __FILE__,\n\t\t\t\t\t\t   __LINE__,\n\t\t\t\t\t\t   \"CONTROL URL SET TO NULL IN SERVICE INFO\");\n\t\t\t\t\tcurrent->controlURL = NULL;\n\t\t\t\t\tfail = 0;\n\t\t\t\t}\n\t\t\t\tixmlFreeDOMString(tempDOMString);\n\t\t\t\ttempDOMString = NULL;\n\t\t\t\tif (!getSubElement(\"eventSubURL\", current_service, &eventURL) ||\n\t\t\t\t    !(tempDOMString = getElementValue(eventURL)) ||\n\t\t\t\t    !(current->eventURL = resolve_rel_url(URLBase, tempDOMString))) {\n\t\t\t\t\tUpnpPrintf(UPNP_INFO, GENA, __FILE__,\n\t\t\t\t\t\t   __LINE__,\n\t\t\t\t\t\t   \"BAD OR MISSING EVENT URL\");\n\t\t\t\t\tUpnpPrintf(UPNP_INFO, GENA, __FILE__,\n\t\t\t\t\t\t   __LINE__,\n\t\t\t\t\t\t   \"EVENT URL SET TO NULL IN SERVICE INFO\");\n\t\t\t\t\tcurrent->eventURL = NULL;\n\t\t\t\t\tfail = 0;\n\t\t\t\t}\n\t\t\t\tixmlFreeDOMString(tempDOMString);\n\t\t\t\ttempDOMString = NULL;\n\t\t\t\tif (fail) {\n\t\t\t\t\tfreeServiceList(current);\n\t\t\t\t\tif (previous)\n\t\t\t\t\t\tprevious->next = NULL;\n\t\t\t\t\telse\n\t\t\t\t\t\thead = NULL;\n\t\t\t\t\tcurrent = previous;\n\t\t\t\t}\n\t\t\t}\n\t\t\tixmlNodeList_free(serviceNodeList);\n\t\t}\n\t\t(*end) = current;\n\t\treturn head;\n\t} else {\n\t\t(*end) = NULL;\n\t\treturn NULL;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ixmlNodeList_item",
          "args": [
            "deviceList",
            "i"
          ],
          "line": 881
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ixmlNodeList_length",
          "args": [
            "deviceList"
          ],
          "line": 879
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ixmlElement_getElementsByTagName",
          "args": [
            "(IXML_Element *)node",
            "\"device\""
          ],
          "line": 876
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nservice_info *\ngetAllServiceList( IXML_Node * node,\n                   char *URLBase,\n                   service_info ** out_end )\n{\n\tservice_info *head = NULL;\n\tservice_info *end = NULL;\n\tservice_info *next_end = NULL;\n\tIXML_NodeList *deviceList = NULL;\n\tIXML_Node *currentDevice = NULL;\n\n\tlong unsigned int NumOfDevices = 0lu;\n\tlong unsigned int i = 0lu;\n\n\t(*out_end) = NULL;\n\n\tdeviceList = ixmlElement_getElementsByTagName(\n\t\t(IXML_Element *)node, \"device\");\n\tif (deviceList) {\n\t\tNumOfDevices = ixmlNodeList_length(deviceList);\n\t\tfor (i = 0lu; i < NumOfDevices; i++) {\n\t\t\tcurrentDevice = ixmlNodeList_item(deviceList, i);\n\t\t\tif (head) {\n\t\t\t\tend->next = getServiceList(currentDevice,\n\t\t\t\t\t&next_end, URLBase);\n\t\t\t\tif (next_end)\n\t\t\t\t\tend = next_end;\n\t\t\t} else\n\t\t\t\thead = getServiceList(currentDevice, &end,\n\t\t\t\t\tURLBase);\n\t\t}\n\t\tixmlNodeList_free(deviceList);\n\t}\n\n\t(*out_end) = end;\n\treturn head;\n}"
  },
  {
    "function_name": "getServiceList",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
    "lines": "728-842",
    "snippet": "service_info *getServiceList(\n\tIXML_Node *node,\n\tservice_info **end,\n\tchar *URLBase)\n{\n\tIXML_Node *serviceList = NULL;\n\tIXML_Node *current_service = NULL;\n\tIXML_Node *UDN = NULL;\n\n\tIXML_Node *serviceType = NULL;\n\tIXML_Node *serviceId = NULL;\n\tIXML_Node *SCPDURL = NULL;\n\tIXML_Node *controlURL = NULL;\n\tIXML_Node *eventURL = NULL;\n\tDOMString tempDOMString = NULL;\n\tservice_info *head = NULL;\n\tservice_info *current = NULL;\n\tservice_info *previous = NULL;\n\tIXML_NodeList *serviceNodeList = NULL;\n\tlong unsigned int NumOfServices = 0lu;\n\tlong unsigned int i = 0lu;\n\tint fail = 0;\n\n\tif (getSubElement(\"UDN\", node, &UDN) &&\n\t    getSubElement(\"serviceList\", node, &serviceList)) {\n\t\tserviceNodeList = ixmlElement_getElementsByTagName(\n\t\t\t(IXML_Element *)serviceList, \"service\");\n\t\tif (serviceNodeList != NULL) {\n\t\t\tNumOfServices = ixmlNodeList_length(serviceNodeList);\n\t\t\tfor (i = 0lu; i < NumOfServices; i++) {\n\t\t\t\tcurrent_service =\n\t\t\t\t    ixmlNodeList_item(serviceNodeList, i);\n\t\t\t\tfail = 0;\n\t\t\t\tif (current) {\n\t\t\t\t\tcurrent->next = malloc(sizeof(service_info));\n\t\t\t\t\tprevious = current;\n\t\t\t\t\tcurrent = current->next;\n\t\t\t\t} else {\n\t\t\t\t\thead = malloc(sizeof(service_info));\n\t\t\t\t\tcurrent = head;\n\t\t\t\t}\n\t\t\t\tif (!current) {\n\t\t\t\t\tfreeServiceList(head);\n\t\t\t\t\tixmlNodeList_free(serviceNodeList);\n\t\t\t\t\treturn NULL;\n\t\t\t\t}\n\t\t\t\tcurrent->next = NULL;\n\t\t\t\tcurrent->controlURL = NULL;\n\t\t\t\tcurrent->eventURL = NULL;\n\t\t\t\tcurrent->serviceType = NULL;\n\t\t\t\tcurrent->serviceId = NULL;\n\t\t\t\tcurrent->SCPDURL = NULL;\n\t\t\t\tcurrent->active = 1;\n\t\t\t\tcurrent->subscriptionList = NULL;\n\t\t\t\tcurrent->TotalSubscriptions = 0;\n\t\t\t\tif (!(current->UDN = getElementValue(UDN)))\n\t\t\t\t\tfail = 1;\n\t\t\t\tif (!getSubElement(\"serviceType\", current_service, &serviceType) ||\n\t\t\t\t    !(current->serviceType = getElementValue(serviceType)))\n\t\t\t\t\tfail = 1;\n\t\t\t\tif (!getSubElement(\"serviceId\", current_service, &serviceId) ||\n\t\t\t\t    !(current->serviceId = getElementValue(serviceId)))\n\t\t\t\t\tfail = 1;\n\t\t\t\tif (!getSubElement(\"SCPDURL\", current_service, &SCPDURL) ||\n\t\t\t\t    !(tempDOMString = getElementValue(SCPDURL)) ||\n\t\t\t\t    !(current->SCPDURL = resolve_rel_url(URLBase, tempDOMString)))\n\t\t\t\t\tfail = 1;\n\t\t\t\tixmlFreeDOMString(tempDOMString);\n\t\t\t\ttempDOMString = NULL;\n\t\t\t\tif (!(getSubElement(\"controlURL\", current_service, &controlURL)) ||\n\t\t\t\t    !(tempDOMString = getElementValue(controlURL)) ||\n\t\t\t\t    !(current->controlURL = resolve_rel_url(URLBase, tempDOMString))) {\n\t\t\t\t\tUpnpPrintf(UPNP_INFO, GENA, __FILE__,\n\t\t\t\t\t\t   __LINE__,\n\t\t\t\t\t\t   \"BAD OR MISSING CONTROL URL\");\n\t\t\t\t\tUpnpPrintf(UPNP_INFO, GENA, __FILE__,\n\t\t\t\t\t\t   __LINE__,\n\t\t\t\t\t\t   \"CONTROL URL SET TO NULL IN SERVICE INFO\");\n\t\t\t\t\tcurrent->controlURL = NULL;\n\t\t\t\t\tfail = 0;\n\t\t\t\t}\n\t\t\t\tixmlFreeDOMString(tempDOMString);\n\t\t\t\ttempDOMString = NULL;\n\t\t\t\tif (!getSubElement(\"eventSubURL\", current_service, &eventURL) ||\n\t\t\t\t    !(tempDOMString = getElementValue(eventURL)) ||\n\t\t\t\t    !(current->eventURL = resolve_rel_url(URLBase, tempDOMString))) {\n\t\t\t\t\tUpnpPrintf(UPNP_INFO, GENA, __FILE__,\n\t\t\t\t\t\t   __LINE__,\n\t\t\t\t\t\t   \"BAD OR MISSING EVENT URL\");\n\t\t\t\t\tUpnpPrintf(UPNP_INFO, GENA, __FILE__,\n\t\t\t\t\t\t   __LINE__,\n\t\t\t\t\t\t   \"EVENT URL SET TO NULL IN SERVICE INFO\");\n\t\t\t\t\tcurrent->eventURL = NULL;\n\t\t\t\t\tfail = 0;\n\t\t\t\t}\n\t\t\t\tixmlFreeDOMString(tempDOMString);\n\t\t\t\ttempDOMString = NULL;\n\t\t\t\tif (fail) {\n\t\t\t\t\tfreeServiceList(current);\n\t\t\t\t\tif (previous)\n\t\t\t\t\t\tprevious->next = NULL;\n\t\t\t\t\telse\n\t\t\t\t\t\thead = NULL;\n\t\t\t\t\tcurrent = previous;\n\t\t\t\t}\n\t\t\t}\n\t\t\tixmlNodeList_free(serviceNodeList);\n\t\t}\n\t\t(*end) = current;\n\t\treturn head;\n\t} else {\n\t\t(*end) = NULL;\n\t\treturn NULL;\n\t}\n}",
    "includes": [
      "#include \"service_table.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ixmlNodeList_free",
          "args": [
            "serviceNodeList"
          ],
          "line": 834
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "freeServiceList",
          "args": [
            "current"
          ],
          "line": 826
        },
        "resolved": true,
        "details": {
          "function_name": "freeServiceList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
          "lines": "579-605",
          "snippet": "void\nfreeServiceList( service_info * head )\n{\n    service_info *next = NULL;\n\n    while( head ) {\n        if( head->serviceType )\n            ixmlFreeDOMString( head->serviceType );\n        if( head->serviceId )\n            ixmlFreeDOMString( head->serviceId );\n        if( head->SCPDURL )\n            free( head->SCPDURL );\n        if( head->controlURL )\n            free( head->controlURL );\n        if( head->eventURL )\n            free( head->eventURL );\n        if( head->UDN )\n            ixmlFreeDOMString( head->UDN );\n        if( head->subscriptionList )\n            freeSubscriptionList( head->subscriptionList );\n\n        head->TotalSubscriptions = 0;\n        next = head->next;\n        free( head );\n        head = next;\n    }\n}",
          "includes": [
            "#include \"service_table.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nvoid\nfreeServiceList( service_info * head )\n{\n    service_info *next = NULL;\n\n    while( head ) {\n        if( head->serviceType )\n            ixmlFreeDOMString( head->serviceType );\n        if( head->serviceId )\n            ixmlFreeDOMString( head->serviceId );\n        if( head->SCPDURL )\n            free( head->SCPDURL );\n        if( head->controlURL )\n            free( head->controlURL );\n        if( head->eventURL )\n            free( head->eventURL );\n        if( head->UDN )\n            ixmlFreeDOMString( head->UDN );\n        if( head->subscriptionList )\n            freeSubscriptionList( head->subscriptionList );\n\n        head->TotalSubscriptions = 0;\n        next = head->next;\n        free( head );\n        head = next;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ixmlFreeDOMString",
          "args": [
            "tempDOMString"
          ],
          "line": 823
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "UpnpPrintf",
          "args": [
            "UPNP_INFO",
            "GENA",
            "__FILE__",
            "__LINE__",
            "\"EVENT URL SET TO NULL IN SERVICE INFO\""
          ],
          "line": 817
        },
        "resolved": true,
        "details": {
          "function_name": "UpnpPrintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/upnpdebug.c",
          "lines": "124-154",
          "snippet": "void UpnpPrintf(Upnp_LogLevel DLevel,\n\t\tDbg_Module Module,\n\t\tconst char *DbgFileName, int DbgLineNo, const char *FmtStr, ...)\n{\n\tva_list ArgList;\n\n\tif (!DebugAtThisLevel(DLevel, Module))\n\t\treturn;\n\tithread_mutex_lock(&GlobalDebugMutex);\n\tva_start(ArgList, FmtStr);\n\tif (!DEBUG_TARGET) {\n\t\tif (DbgFileName)\n\t\t\tUpnpDisplayFileAndLine(stdout, DbgFileName, DbgLineNo);\n\t\tvfprintf(stdout, FmtStr, ArgList);\n\t\tfflush(stdout);\n\t} else if (DLevel == 0) {\n\t\tif (DbgFileName)\n\t\t\tUpnpDisplayFileAndLine(ErrFileHnd, DbgFileName,\n\t\t\t\t\t       DbgLineNo);\n\t\tvfprintf(ErrFileHnd, FmtStr, ArgList);\n\t\tfflush(ErrFileHnd);\n\t} else {\n\t\tif (DbgFileName)\n\t\t\tUpnpDisplayFileAndLine(InfoFileHnd, DbgFileName,\n\t\t\t\t\t       DbgLineNo);\n\t\tvfprintf(InfoFileHnd, FmtStr, ArgList);\n\t\tfflush(InfoFileHnd);\n\t}\n\tva_end(ArgList);\n\tithread_mutex_unlock(&GlobalDebugMutex);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include \"upnpdebug.h\"",
            "#include \"upnp.h\"",
            "#include \"ixml.h\"",
            "#include \"ithread.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include \"upnpdebug.h\"\n#include \"upnp.h\"\n#include \"ixml.h\"\n#include \"ithread.h\"\n#include \"config.h\"\n\nvoid UpnpPrintf(Upnp_LogLevel DLevel,\n\t\tDbg_Module Module,\n\t\tconst char *DbgFileName, int DbgLineNo, const char *FmtStr, ...)\n{\n\tva_list ArgList;\n\n\tif (!DebugAtThisLevel(DLevel, Module))\n\t\treturn;\n\tithread_mutex_lock(&GlobalDebugMutex);\n\tva_start(ArgList, FmtStr);\n\tif (!DEBUG_TARGET) {\n\t\tif (DbgFileName)\n\t\t\tUpnpDisplayFileAndLine(stdout, DbgFileName, DbgLineNo);\n\t\tvfprintf(stdout, FmtStr, ArgList);\n\t\tfflush(stdout);\n\t} else if (DLevel == 0) {\n\t\tif (DbgFileName)\n\t\t\tUpnpDisplayFileAndLine(ErrFileHnd, DbgFileName,\n\t\t\t\t\t       DbgLineNo);\n\t\tvfprintf(ErrFileHnd, FmtStr, ArgList);\n\t\tfflush(ErrFileHnd);\n\t} else {\n\t\tif (DbgFileName)\n\t\t\tUpnpDisplayFileAndLine(InfoFileHnd, DbgFileName,\n\t\t\t\t\t       DbgLineNo);\n\t\tvfprintf(InfoFileHnd, FmtStr, ArgList);\n\t\tfflush(InfoFileHnd);\n\t}\n\tva_end(ArgList);\n\tithread_mutex_unlock(&GlobalDebugMutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "resolve_rel_url",
          "args": [
            "URLBase",
            "tempDOMString"
          ],
          "line": 813
        },
        "resolved": true,
        "details": {
          "function_name": "resolve_rel_url",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/net/uri/uri.c",
          "lines": "593-704",
          "snippet": "char *resolve_rel_url(char *base_url, char *rel_url)\n{\n    uri_type base;\n    uri_type rel;\n    int rv;\n\n    if (!base_url) {\n        if (!rel_url)\n            return NULL;\n        return strdup(rel_url);\n    }\n\n    size_t len_rel = strlen(rel_url);\n    if (parse_uri(rel_url, len_rel, &rel) != HTTP_SUCCESS)\n        return NULL;\n    if (rel.type == (enum uriType)ABSOLUTE)\n        return strdup(rel_url);\n\n    size_t len_base = strlen(base_url);\n    if ((parse_uri(base_url, len_base, &base) != HTTP_SUCCESS)\n            || (base.type != (enum uriType)ABSOLUTE))\n        return NULL;\n    if (len_rel == (size_t)0)\n        return strdup(base_url);\n\n    size_t len = len_base + len_rel + (size_t)2;\n    char *out = (char *)malloc(len);\n    if (out == NULL)\n        return NULL;\n    memset(out, 0, len);\n    char *out_finger = out;\n\n    /* scheme */\n    rv = snprintf(out_finger, len, \"%.*s:\", (int)base.scheme.size, base.scheme.buff);\n    if (rv < 0 || rv >= len)\n        goto error;\n    out_finger += rv;\n    len -= rv;\n\n    /* authority */\n    if (rel.hostport.text.size > (size_t)0) {\n        rv = snprintf(out_finger, len, \"%s\", rel_url);\n        if (rv < 0 || rv >= len)\n            goto error;\n        return out;\n    }\n    if (base.hostport.text.size > (size_t)0) {\n\trv = snprintf(out_finger, len, \"//%.*s\", (int)base.hostport.text.size, base.hostport.text.buff);\n\tif (rv < 0 || rv >= len)\n\t    goto error;\n\tout_finger += rv;\n\tlen -= rv;\n    }\n\n    /* path */\n    char *path = out_finger;\n    if (rel.path_type == (enum pathType)ABS_PATH) {\n\trv = snprintf(out_finger, len, \"%s\", rel_url);\n    } else if (base.pathquery.size == (size_t)0) {\n\trv = snprintf(out_finger, len, \"/%s\", rel_url);\n    } else {\n\tif (rel.pathquery.size == (size_t)0) {\n\t    rv = snprintf(out_finger, len, \"%.*s\", (int)base.pathquery.size, base.pathquery.buff);\n\t} else {\n\t    if (len < base.pathquery.size)\n\t\tgoto error;\n\t    size_t i = (size_t)0, prefix = (size_t)1;\n\t    while (i < base.pathquery.size) {\n\t\tout_finger[i] = base.pathquery.buff[i];\n\t\tswitch (base.pathquery.buff[i++]) {\n\t\t    case '/':\n\t\t\tprefix = i;\n\t\t\t/* fall-through */\n\t\t    default:\n\t\t\tcontinue;\n\t\t    case '?': /* query */\n\t\t\tif (rel.pathquery.buff[0] == '?')\n\t\t\t    prefix = --i;\n\t\t}\n\t\tbreak;\n\t    }\n\t    out_finger += prefix;\n\t    len -= prefix;\n\t    rv = snprintf(out_finger, len, \"%.*s\", (int)rel.pathquery.size, rel.pathquery.buff);\n\t}\n\tif (rv < 0 || rv >= len)\n\t    goto error;\n\tout_finger += rv;\n\tlen -= rv;\n\n\t/* fragment */\n\tif (rel.fragment.size > (size_t)0)\n\t    rv = snprintf(out_finger, len, \"#%.*s\", (int)rel.fragment.size, rel.fragment.buff);\n\telse if (base.fragment.size > (size_t)0)\n\t    rv = snprintf(out_finger, len, \"#%.*s\", (int)base.fragment.size, base.fragment.buff);\n\telse\n\t    rv = 0;\n    }\n    if (rv < 0 || rv >= len)\n\tgoto error;\n    out_finger += rv;\n    len -= rv;\n\n    if (remove_dots(path, out_finger - path) != UPNP_E_SUCCESS)\n\tgoto error;\n\n    return out;\n\nerror:\n    free(out);\n    return NULL;\n}",
          "includes": [
            "#include \"upnpapi.h\"",
            "#include \"uri.h\"",
            "#include \"config.h\"",
            "#include <assert.h>",
            "#include <lwres/netdb.h>",
            "#include <osreldate.h>"
          ],
          "macros_used": [
            "#define snprintf _snprintf"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"upnpapi.h\"\n#include \"uri.h\"\n#include \"config.h\"\n#include <assert.h>\n#include <lwres/netdb.h>\n#include <osreldate.h>\n\n#define snprintf _snprintf\n\nchar *resolve_rel_url(char *base_url, char *rel_url)\n{\n    uri_type base;\n    uri_type rel;\n    int rv;\n\n    if (!base_url) {\n        if (!rel_url)\n            return NULL;\n        return strdup(rel_url);\n    }\n\n    size_t len_rel = strlen(rel_url);\n    if (parse_uri(rel_url, len_rel, &rel) != HTTP_SUCCESS)\n        return NULL;\n    if (rel.type == (enum uriType)ABSOLUTE)\n        return strdup(rel_url);\n\n    size_t len_base = strlen(base_url);\n    if ((parse_uri(base_url, len_base, &base) != HTTP_SUCCESS)\n            || (base.type != (enum uriType)ABSOLUTE))\n        return NULL;\n    if (len_rel == (size_t)0)\n        return strdup(base_url);\n\n    size_t len = len_base + len_rel + (size_t)2;\n    char *out = (char *)malloc(len);\n    if (out == NULL)\n        return NULL;\n    memset(out, 0, len);\n    char *out_finger = out;\n\n    /* scheme */\n    rv = snprintf(out_finger, len, \"%.*s:\", (int)base.scheme.size, base.scheme.buff);\n    if (rv < 0 || rv >= len)\n        goto error;\n    out_finger += rv;\n    len -= rv;\n\n    /* authority */\n    if (rel.hostport.text.size > (size_t)0) {\n        rv = snprintf(out_finger, len, \"%s\", rel_url);\n        if (rv < 0 || rv >= len)\n            goto error;\n        return out;\n    }\n    if (base.hostport.text.size > (size_t)0) {\n\trv = snprintf(out_finger, len, \"//%.*s\", (int)base.hostport.text.size, base.hostport.text.buff);\n\tif (rv < 0 || rv >= len)\n\t    goto error;\n\tout_finger += rv;\n\tlen -= rv;\n    }\n\n    /* path */\n    char *path = out_finger;\n    if (rel.path_type == (enum pathType)ABS_PATH) {\n\trv = snprintf(out_finger, len, \"%s\", rel_url);\n    } else if (base.pathquery.size == (size_t)0) {\n\trv = snprintf(out_finger, len, \"/%s\", rel_url);\n    } else {\n\tif (rel.pathquery.size == (size_t)0) {\n\t    rv = snprintf(out_finger, len, \"%.*s\", (int)base.pathquery.size, base.pathquery.buff);\n\t} else {\n\t    if (len < base.pathquery.size)\n\t\tgoto error;\n\t    size_t i = (size_t)0, prefix = (size_t)1;\n\t    while (i < base.pathquery.size) {\n\t\tout_finger[i] = base.pathquery.buff[i];\n\t\tswitch (base.pathquery.buff[i++]) {\n\t\t    case '/':\n\t\t\tprefix = i;\n\t\t\t/* fall-through */\n\t\t    default:\n\t\t\tcontinue;\n\t\t    case '?': /* query */\n\t\t\tif (rel.pathquery.buff[0] == '?')\n\t\t\t    prefix = --i;\n\t\t}\n\t\tbreak;\n\t    }\n\t    out_finger += prefix;\n\t    len -= prefix;\n\t    rv = snprintf(out_finger, len, \"%.*s\", (int)rel.pathquery.size, rel.pathquery.buff);\n\t}\n\tif (rv < 0 || rv >= len)\n\t    goto error;\n\tout_finger += rv;\n\tlen -= rv;\n\n\t/* fragment */\n\tif (rel.fragment.size > (size_t)0)\n\t    rv = snprintf(out_finger, len, \"#%.*s\", (int)rel.fragment.size, rel.fragment.buff);\n\telse if (base.fragment.size > (size_t)0)\n\t    rv = snprintf(out_finger, len, \"#%.*s\", (int)base.fragment.size, base.fragment.buff);\n\telse\n\t    rv = 0;\n    }\n    if (rv < 0 || rv >= len)\n\tgoto error;\n    out_finger += rv;\n    len -= rv;\n\n    if (remove_dots(path, out_finger - path) != UPNP_E_SUCCESS)\n\tgoto error;\n\n    return out;\n\nerror:\n    free(out);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "getElementValue",
          "args": [
            "eventURL"
          ],
          "line": 812
        },
        "resolved": true,
        "details": {
          "function_name": "getElementValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
          "lines": "643-655",
          "snippet": "DOMString\ngetElementValue( IXML_Node * node )\n{\n    IXML_Node *child = ( IXML_Node * ) ixmlNode_getFirstChild( node );\n    const DOMString temp = NULL;\n\n    if( ( child != 0 ) && ( ixmlNode_getNodeType( child ) == eTEXT_NODE ) ) {\n        temp = ixmlNode_getNodeValue( child );\n        return ixmlCloneDOMString( temp );\n    } else {\n        return NULL;\n    }\n}",
          "includes": [
            "#include \"service_table.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nDOMString\ngetElementValue( IXML_Node * node )\n{\n    IXML_Node *child = ( IXML_Node * ) ixmlNode_getFirstChild( node );\n    const DOMString temp = NULL;\n\n    if( ( child != 0 ) && ( ixmlNode_getNodeType( child ) == eTEXT_NODE ) ) {\n        temp = ixmlNode_getNodeValue( child );\n        return ixmlCloneDOMString( temp );\n    } else {\n        return NULL;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getSubElement",
          "args": [
            "\"eventSubURL\"",
            "current_service",
            "&eventURL"
          ],
          "line": 811
        },
        "resolved": true,
        "details": {
          "function_name": "getSubElement",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
          "lines": "676-710",
          "snippet": "int\ngetSubElement( const char *element_name,\n               IXML_Node * node,\n               IXML_Node ** out )\n{\n\n    const DOMString NodeName = NULL;\n    int found = 0;\n\n    IXML_Node *child = ( IXML_Node * ) ixmlNode_getFirstChild( node );\n\n    ( *out ) = NULL;\n\n    while( ( child != NULL ) && ( !found ) ) {\n\n        switch ( ixmlNode_getNodeType( child ) ) {\n            case eELEMENT_NODE:\n\n                NodeName = ixmlNode_getNodeName( child );\n                if( !strcmp( NodeName, element_name ) ) {\n                    ( *out ) = child;\n                    found = 1;\n                    return found;\n                }\n                break;\n\n            default:\n                break;\n        }\n\n        child = ( IXML_Node * ) ixmlNode_getNextSibling( child );\n    }\n\n    return found;\n}",
          "includes": [
            "#include \"service_table.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nint\ngetSubElement( const char *element_name,\n               IXML_Node * node,\n               IXML_Node ** out )\n{\n\n    const DOMString NodeName = NULL;\n    int found = 0;\n\n    IXML_Node *child = ( IXML_Node * ) ixmlNode_getFirstChild( node );\n\n    ( *out ) = NULL;\n\n    while( ( child != NULL ) && ( !found ) ) {\n\n        switch ( ixmlNode_getNodeType( child ) ) {\n            case eELEMENT_NODE:\n\n                NodeName = ixmlNode_getNodeName( child );\n                if( !strcmp( NodeName, element_name ) ) {\n                    ( *out ) = child;\n                    found = 1;\n                    return found;\n                }\n                break;\n\n            default:\n                break;\n        }\n\n        child = ( IXML_Node * ) ixmlNode_getNextSibling( child );\n    }\n\n    return found;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ixmlFreeDOMString",
          "args": [
            "tempDOMString"
          ],
          "line": 809
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ixmlFreeDOMString",
          "args": [
            "tempDOMString"
          ],
          "line": 795
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ixmlNodeList_free",
          "args": [
            "serviceNodeList"
          ],
          "line": 771
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(service_info)"
          ],
          "line": 766
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "sizeof(service_info)"
          ],
          "line": 762
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ixmlNodeList_item",
          "args": [
            "serviceNodeList",
            "i"
          ],
          "line": 759
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ixmlNodeList_length",
          "args": [
            "serviceNodeList"
          ],
          "line": 756
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ixmlElement_getElementsByTagName",
          "args": [
            "(IXML_Element *)serviceList",
            "\"service\""
          ],
          "line": 753
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nservice_info *getServiceList(\n\tIXML_Node *node,\n\tservice_info **end,\n\tchar *URLBase)\n{\n\tIXML_Node *serviceList = NULL;\n\tIXML_Node *current_service = NULL;\n\tIXML_Node *UDN = NULL;\n\n\tIXML_Node *serviceType = NULL;\n\tIXML_Node *serviceId = NULL;\n\tIXML_Node *SCPDURL = NULL;\n\tIXML_Node *controlURL = NULL;\n\tIXML_Node *eventURL = NULL;\n\tDOMString tempDOMString = NULL;\n\tservice_info *head = NULL;\n\tservice_info *current = NULL;\n\tservice_info *previous = NULL;\n\tIXML_NodeList *serviceNodeList = NULL;\n\tlong unsigned int NumOfServices = 0lu;\n\tlong unsigned int i = 0lu;\n\tint fail = 0;\n\n\tif (getSubElement(\"UDN\", node, &UDN) &&\n\t    getSubElement(\"serviceList\", node, &serviceList)) {\n\t\tserviceNodeList = ixmlElement_getElementsByTagName(\n\t\t\t(IXML_Element *)serviceList, \"service\");\n\t\tif (serviceNodeList != NULL) {\n\t\t\tNumOfServices = ixmlNodeList_length(serviceNodeList);\n\t\t\tfor (i = 0lu; i < NumOfServices; i++) {\n\t\t\t\tcurrent_service =\n\t\t\t\t    ixmlNodeList_item(serviceNodeList, i);\n\t\t\t\tfail = 0;\n\t\t\t\tif (current) {\n\t\t\t\t\tcurrent->next = malloc(sizeof(service_info));\n\t\t\t\t\tprevious = current;\n\t\t\t\t\tcurrent = current->next;\n\t\t\t\t} else {\n\t\t\t\t\thead = malloc(sizeof(service_info));\n\t\t\t\t\tcurrent = head;\n\t\t\t\t}\n\t\t\t\tif (!current) {\n\t\t\t\t\tfreeServiceList(head);\n\t\t\t\t\tixmlNodeList_free(serviceNodeList);\n\t\t\t\t\treturn NULL;\n\t\t\t\t}\n\t\t\t\tcurrent->next = NULL;\n\t\t\t\tcurrent->controlURL = NULL;\n\t\t\t\tcurrent->eventURL = NULL;\n\t\t\t\tcurrent->serviceType = NULL;\n\t\t\t\tcurrent->serviceId = NULL;\n\t\t\t\tcurrent->SCPDURL = NULL;\n\t\t\t\tcurrent->active = 1;\n\t\t\t\tcurrent->subscriptionList = NULL;\n\t\t\t\tcurrent->TotalSubscriptions = 0;\n\t\t\t\tif (!(current->UDN = getElementValue(UDN)))\n\t\t\t\t\tfail = 1;\n\t\t\t\tif (!getSubElement(\"serviceType\", current_service, &serviceType) ||\n\t\t\t\t    !(current->serviceType = getElementValue(serviceType)))\n\t\t\t\t\tfail = 1;\n\t\t\t\tif (!getSubElement(\"serviceId\", current_service, &serviceId) ||\n\t\t\t\t    !(current->serviceId = getElementValue(serviceId)))\n\t\t\t\t\tfail = 1;\n\t\t\t\tif (!getSubElement(\"SCPDURL\", current_service, &SCPDURL) ||\n\t\t\t\t    !(tempDOMString = getElementValue(SCPDURL)) ||\n\t\t\t\t    !(current->SCPDURL = resolve_rel_url(URLBase, tempDOMString)))\n\t\t\t\t\tfail = 1;\n\t\t\t\tixmlFreeDOMString(tempDOMString);\n\t\t\t\ttempDOMString = NULL;\n\t\t\t\tif (!(getSubElement(\"controlURL\", current_service, &controlURL)) ||\n\t\t\t\t    !(tempDOMString = getElementValue(controlURL)) ||\n\t\t\t\t    !(current->controlURL = resolve_rel_url(URLBase, tempDOMString))) {\n\t\t\t\t\tUpnpPrintf(UPNP_INFO, GENA, __FILE__,\n\t\t\t\t\t\t   __LINE__,\n\t\t\t\t\t\t   \"BAD OR MISSING CONTROL URL\");\n\t\t\t\t\tUpnpPrintf(UPNP_INFO, GENA, __FILE__,\n\t\t\t\t\t\t   __LINE__,\n\t\t\t\t\t\t   \"CONTROL URL SET TO NULL IN SERVICE INFO\");\n\t\t\t\t\tcurrent->controlURL = NULL;\n\t\t\t\t\tfail = 0;\n\t\t\t\t}\n\t\t\t\tixmlFreeDOMString(tempDOMString);\n\t\t\t\ttempDOMString = NULL;\n\t\t\t\tif (!getSubElement(\"eventSubURL\", current_service, &eventURL) ||\n\t\t\t\t    !(tempDOMString = getElementValue(eventURL)) ||\n\t\t\t\t    !(current->eventURL = resolve_rel_url(URLBase, tempDOMString))) {\n\t\t\t\t\tUpnpPrintf(UPNP_INFO, GENA, __FILE__,\n\t\t\t\t\t\t   __LINE__,\n\t\t\t\t\t\t   \"BAD OR MISSING EVENT URL\");\n\t\t\t\t\tUpnpPrintf(UPNP_INFO, GENA, __FILE__,\n\t\t\t\t\t\t   __LINE__,\n\t\t\t\t\t\t   \"EVENT URL SET TO NULL IN SERVICE INFO\");\n\t\t\t\t\tcurrent->eventURL = NULL;\n\t\t\t\t\tfail = 0;\n\t\t\t\t}\n\t\t\t\tixmlFreeDOMString(tempDOMString);\n\t\t\t\ttempDOMString = NULL;\n\t\t\t\tif (fail) {\n\t\t\t\t\tfreeServiceList(current);\n\t\t\t\t\tif (previous)\n\t\t\t\t\t\tprevious->next = NULL;\n\t\t\t\t\telse\n\t\t\t\t\t\thead = NULL;\n\t\t\t\t\tcurrent = previous;\n\t\t\t\t}\n\t\t\t}\n\t\t\tixmlNodeList_free(serviceNodeList);\n\t\t}\n\t\t(*end) = current;\n\t\treturn head;\n\t} else {\n\t\t(*end) = NULL;\n\t\treturn NULL;\n\t}\n}"
  },
  {
    "function_name": "getSubElement",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
    "lines": "676-710",
    "snippet": "int\ngetSubElement( const char *element_name,\n               IXML_Node * node,\n               IXML_Node ** out )\n{\n\n    const DOMString NodeName = NULL;\n    int found = 0;\n\n    IXML_Node *child = ( IXML_Node * ) ixmlNode_getFirstChild( node );\n\n    ( *out ) = NULL;\n\n    while( ( child != NULL ) && ( !found ) ) {\n\n        switch ( ixmlNode_getNodeType( child ) ) {\n            case eELEMENT_NODE:\n\n                NodeName = ixmlNode_getNodeName( child );\n                if( !strcmp( NodeName, element_name ) ) {\n                    ( *out ) = child;\n                    found = 1;\n                    return found;\n                }\n                break;\n\n            default:\n                break;\n        }\n\n        child = ( IXML_Node * ) ixmlNode_getNextSibling( child );\n    }\n\n    return found;\n}",
    "includes": [
      "#include \"service_table.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ixmlNode_getNextSibling",
          "args": [
            "child"
          ],
          "line": 706
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "NodeName",
            "element_name"
          ],
          "line": 695
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ixmlNode_getNodeName",
          "args": [
            "child"
          ],
          "line": 694
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ixmlNode_getNodeType",
          "args": [
            "child"
          ],
          "line": 691
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ixmlNode_getFirstChild",
          "args": [
            "node"
          ],
          "line": 685
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nint\ngetSubElement( const char *element_name,\n               IXML_Node * node,\n               IXML_Node ** out )\n{\n\n    const DOMString NodeName = NULL;\n    int found = 0;\n\n    IXML_Node *child = ( IXML_Node * ) ixmlNode_getFirstChild( node );\n\n    ( *out ) = NULL;\n\n    while( ( child != NULL ) && ( !found ) ) {\n\n        switch ( ixmlNode_getNodeType( child ) ) {\n            case eELEMENT_NODE:\n\n                NodeName = ixmlNode_getNodeName( child );\n                if( !strcmp( NodeName, element_name ) ) {\n                    ( *out ) = child;\n                    found = 1;\n                    return found;\n                }\n                break;\n\n            default:\n                break;\n        }\n\n        child = ( IXML_Node * ) ixmlNode_getNextSibling( child );\n    }\n\n    return found;\n}"
  },
  {
    "function_name": "getElementValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
    "lines": "643-655",
    "snippet": "DOMString\ngetElementValue( IXML_Node * node )\n{\n    IXML_Node *child = ( IXML_Node * ) ixmlNode_getFirstChild( node );\n    const DOMString temp = NULL;\n\n    if( ( child != 0 ) && ( ixmlNode_getNodeType( child ) == eTEXT_NODE ) ) {\n        temp = ixmlNode_getNodeValue( child );\n        return ixmlCloneDOMString( temp );\n    } else {\n        return NULL;\n    }\n}",
    "includes": [
      "#include \"service_table.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ixmlCloneDOMString",
          "args": [
            "temp"
          ],
          "line": 651
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ixmlNode_getNodeValue",
          "args": [
            "child"
          ],
          "line": 650
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ixmlNode_getNodeType",
          "args": [
            "child"
          ],
          "line": 649
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ixmlNode_getFirstChild",
          "args": [
            "node"
          ],
          "line": 646
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nDOMString\ngetElementValue( IXML_Node * node )\n{\n    IXML_Node *child = ( IXML_Node * ) ixmlNode_getFirstChild( node );\n    const DOMString temp = NULL;\n\n    if( ( child != 0 ) && ( ixmlNode_getNodeType( child ) == eTEXT_NODE ) ) {\n        temp = ixmlNode_getNodeValue( child );\n        return ixmlCloneDOMString( temp );\n    } else {\n        return NULL;\n    }\n}"
  },
  {
    "function_name": "freeServiceTable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
    "lines": "621-628",
    "snippet": "void\nfreeServiceTable( service_table * table )\n{\n    ixmlFreeDOMString( table->URLBase );\n    freeServiceList( table->serviceList );\n    table->serviceList = NULL;\n    table->endServiceList = NULL;\n}",
    "includes": [
      "#include \"service_table.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "freeServiceList",
          "args": [
            "table->serviceList"
          ],
          "line": 625
        },
        "resolved": true,
        "details": {
          "function_name": "freeServiceList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
          "lines": "579-605",
          "snippet": "void\nfreeServiceList( service_info * head )\n{\n    service_info *next = NULL;\n\n    while( head ) {\n        if( head->serviceType )\n            ixmlFreeDOMString( head->serviceType );\n        if( head->serviceId )\n            ixmlFreeDOMString( head->serviceId );\n        if( head->SCPDURL )\n            free( head->SCPDURL );\n        if( head->controlURL )\n            free( head->controlURL );\n        if( head->eventURL )\n            free( head->eventURL );\n        if( head->UDN )\n            ixmlFreeDOMString( head->UDN );\n        if( head->subscriptionList )\n            freeSubscriptionList( head->subscriptionList );\n\n        head->TotalSubscriptions = 0;\n        next = head->next;\n        free( head );\n        head = next;\n    }\n}",
          "includes": [
            "#include \"service_table.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nvoid\nfreeServiceList( service_info * head )\n{\n    service_info *next = NULL;\n\n    while( head ) {\n        if( head->serviceType )\n            ixmlFreeDOMString( head->serviceType );\n        if( head->serviceId )\n            ixmlFreeDOMString( head->serviceId );\n        if( head->SCPDURL )\n            free( head->SCPDURL );\n        if( head->controlURL )\n            free( head->controlURL );\n        if( head->eventURL )\n            free( head->eventURL );\n        if( head->UDN )\n            ixmlFreeDOMString( head->UDN );\n        if( head->subscriptionList )\n            freeSubscriptionList( head->subscriptionList );\n\n        head->TotalSubscriptions = 0;\n        next = head->next;\n        free( head );\n        head = next;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ixmlFreeDOMString",
          "args": [
            "table->URLBase"
          ],
          "line": 624
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nvoid\nfreeServiceTable( service_table * table )\n{\n    ixmlFreeDOMString( table->URLBase );\n    freeServiceList( table->serviceList );\n    table->serviceList = NULL;\n    table->endServiceList = NULL;\n}"
  },
  {
    "function_name": "freeServiceList",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
    "lines": "579-605",
    "snippet": "void\nfreeServiceList( service_info * head )\n{\n    service_info *next = NULL;\n\n    while( head ) {\n        if( head->serviceType )\n            ixmlFreeDOMString( head->serviceType );\n        if( head->serviceId )\n            ixmlFreeDOMString( head->serviceId );\n        if( head->SCPDURL )\n            free( head->SCPDURL );\n        if( head->controlURL )\n            free( head->controlURL );\n        if( head->eventURL )\n            free( head->eventURL );\n        if( head->UDN )\n            ixmlFreeDOMString( head->UDN );\n        if( head->subscriptionList )\n            freeSubscriptionList( head->subscriptionList );\n\n        head->TotalSubscriptions = 0;\n        next = head->next;\n        free( head );\n        head = next;\n    }\n}",
    "includes": [
      "#include \"service_table.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "head"
          ],
          "line": 602
        },
        "resolved": true,
        "details": {
          "function_name": "freeServiceTable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
          "lines": "621-628",
          "snippet": "void\nfreeServiceTable( service_table * table )\n{\n    ixmlFreeDOMString( table->URLBase );\n    freeServiceList( table->serviceList );\n    table->serviceList = NULL;\n    table->endServiceList = NULL;\n}",
          "includes": [
            "#include \"service_table.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nvoid\nfreeServiceTable( service_table * table )\n{\n    ixmlFreeDOMString( table->URLBase );\n    freeServiceList( table->serviceList );\n    table->serviceList = NULL;\n    table->endServiceList = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "freeSubscriptionList",
          "args": [
            "head->subscriptionList"
          ],
          "line": 598
        },
        "resolved": true,
        "details": {
          "function_name": "freeSubscriptionList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
          "lines": "226-237",
          "snippet": "void\nfreeSubscriptionList( subscription * head )\n{\n    subscription *next = NULL;\n\n    while( head ) {\n        next = head->next;\n        freeSubscription( head );\n        free( head );\n        head = next;\n    }\n}",
          "includes": [
            "#include \"service_table.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nvoid\nfreeSubscriptionList( subscription * head )\n{\n    subscription *next = NULL;\n\n    while( head ) {\n        next = head->next;\n        freeSubscription( head );\n        free( head );\n        head = next;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ixmlFreeDOMString",
          "args": [
            "head->UDN"
          ],
          "line": 596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ixmlFreeDOMString",
          "args": [
            "head->serviceId"
          ],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ixmlFreeDOMString",
          "args": [
            "head->serviceType"
          ],
          "line": 586
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nvoid\nfreeServiceList( service_info * head )\n{\n    service_info *next = NULL;\n\n    while( head ) {\n        if( head->serviceType )\n            ixmlFreeDOMString( head->serviceType );\n        if( head->serviceId )\n            ixmlFreeDOMString( head->serviceId );\n        if( head->SCPDURL )\n            free( head->SCPDURL );\n        if( head->controlURL )\n            free( head->controlURL );\n        if( head->eventURL )\n            free( head->eventURL );\n        if( head->UDN )\n            ixmlFreeDOMString( head->UDN );\n        if( head->subscriptionList )\n            freeSubscriptionList( head->subscriptionList );\n\n        head->TotalSubscriptions = 0;\n        next = head->next;\n        free( head );\n        head = next;\n    }\n}"
  },
  {
    "function_name": "freeService",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
    "lines": "537-564",
    "snippet": "void freeService( service_info * in )\n{\n    if( in ) {\n        if( in->serviceType )\n            ixmlFreeDOMString( in->serviceType );\n\n        if( in->serviceId )\n            ixmlFreeDOMString( in->serviceId );\n\n        if( in->SCPDURL )\n            free( in->SCPDURL );\n\n        if( in->controlURL )\n            free( in->controlURL );\n\n        if( in->eventURL )\n            free( in->eventURL );\n\n        if( in->UDN )\n            ixmlFreeDOMString( in->UDN );\n\n        if( in->subscriptionList )\n            freeSubscriptionList( in->subscriptionList );\n\n        in->TotalSubscriptions = 0;\n        free( in );\n    }\n}",
    "includes": [
      "#include \"service_table.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "in"
          ],
          "line": 562
        },
        "resolved": true,
        "details": {
          "function_name": "freeServiceTable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
          "lines": "621-628",
          "snippet": "void\nfreeServiceTable( service_table * table )\n{\n    ixmlFreeDOMString( table->URLBase );\n    freeServiceList( table->serviceList );\n    table->serviceList = NULL;\n    table->endServiceList = NULL;\n}",
          "includes": [
            "#include \"service_table.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nvoid\nfreeServiceTable( service_table * table )\n{\n    ixmlFreeDOMString( table->URLBase );\n    freeServiceList( table->serviceList );\n    table->serviceList = NULL;\n    table->endServiceList = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "freeSubscriptionList",
          "args": [
            "in->subscriptionList"
          ],
          "line": 559
        },
        "resolved": true,
        "details": {
          "function_name": "freeSubscriptionList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
          "lines": "226-237",
          "snippet": "void\nfreeSubscriptionList( subscription * head )\n{\n    subscription *next = NULL;\n\n    while( head ) {\n        next = head->next;\n        freeSubscription( head );\n        free( head );\n        head = next;\n    }\n}",
          "includes": [
            "#include \"service_table.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nvoid\nfreeSubscriptionList( subscription * head )\n{\n    subscription *next = NULL;\n\n    while( head ) {\n        next = head->next;\n        freeSubscription( head );\n        free( head );\n        head = next;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ixmlFreeDOMString",
          "args": [
            "in->UDN"
          ],
          "line": 556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ixmlFreeDOMString",
          "args": [
            "in->serviceId"
          ],
          "line": 544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ixmlFreeDOMString",
          "args": [
            "in->serviceType"
          ],
          "line": 541
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nvoid freeService( service_info * in )\n{\n    if( in ) {\n        if( in->serviceType )\n            ixmlFreeDOMString( in->serviceType );\n\n        if( in->serviceId )\n            ixmlFreeDOMString( in->serviceId );\n\n        if( in->SCPDURL )\n            free( in->SCPDURL );\n\n        if( in->controlURL )\n            free( in->controlURL );\n\n        if( in->eventURL )\n            free( in->eventURL );\n\n        if( in->UDN )\n            ixmlFreeDOMString( in->UDN );\n\n        if( in->subscriptionList )\n            freeSubscriptionList( in->subscriptionList );\n\n        in->TotalSubscriptions = 0;\n        free( in );\n    }\n}"
  },
  {
    "function_name": "printServiceTable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
    "lines": "511-520",
    "snippet": "void printServiceTable(\n    service_table * table,\n    Upnp_LogLevel level,\n    Dbg_Module module )\n{\n    UpnpPrintf( level, module, __FILE__, __LINE__,\n        \"URL_BASE: %s\\n\", table->URLBase );\n    UpnpPrintf( level, module, __FILE__, __LINE__,\n        \"Services: \\n\" );\n    printServiceList( table->serviceList, level, module );}",
    "includes": [
      "#include \"service_table.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printServiceList",
          "args": [
            "table->serviceList",
            "level",
            "module"
          ],
          "line": 520
        },
        "resolved": true,
        "details": {
          "function_name": "printServiceList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
          "lines": "452-491",
          "snippet": "void printServiceList(\n    service_info * service,\n    Upnp_LogLevel level,\n    Dbg_Module module )\n{\n    while( service ) {\n        if( service->serviceType ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"serviceType: %s\\n\", service->serviceType );\n        }\n        if( service->serviceId ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"serviceId: %s\\n\", service->serviceId );\n        }\n        if( service->SCPDURL ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"SCPDURL: %s\\n\", service->SCPDURL );\n        }\n        if( service->controlURL ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"controlURL: %s\\n\", service->controlURL );\n        }\n        if( service->eventURL ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"eventURL: %s\\n\", service->eventURL );\n        }\n        if( service->UDN ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"UDN: %s\\n\\n\", service->UDN );\n        }\n        if( service->active ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"Service is active\\n\" );\n        } else {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"Service is inactive\\n\" );\n        }\n        service = service->next;\n    }\n}",
          "includes": [
            "#include \"service_table.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nvoid printServiceList(\n    service_info * service,\n    Upnp_LogLevel level,\n    Dbg_Module module )\n{\n    while( service ) {\n        if( service->serviceType ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"serviceType: %s\\n\", service->serviceType );\n        }\n        if( service->serviceId ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"serviceId: %s\\n\", service->serviceId );\n        }\n        if( service->SCPDURL ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"SCPDURL: %s\\n\", service->SCPDURL );\n        }\n        if( service->controlURL ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"controlURL: %s\\n\", service->controlURL );\n        }\n        if( service->eventURL ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"eventURL: %s\\n\", service->eventURL );\n        }\n        if( service->UDN ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"UDN: %s\\n\\n\", service->UDN );\n        }\n        if( service->active ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"Service is active\\n\" );\n        } else {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"Service is inactive\\n\" );\n        }\n        service = service->next;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "UpnpPrintf",
          "args": [
            "level",
            "module",
            "__FILE__",
            "__LINE__",
            "\"Services: \\n\""
          ],
          "line": 518
        },
        "resolved": true,
        "details": {
          "function_name": "UpnpPrintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/upnpdebug.c",
          "lines": "124-154",
          "snippet": "void UpnpPrintf(Upnp_LogLevel DLevel,\n\t\tDbg_Module Module,\n\t\tconst char *DbgFileName, int DbgLineNo, const char *FmtStr, ...)\n{\n\tva_list ArgList;\n\n\tif (!DebugAtThisLevel(DLevel, Module))\n\t\treturn;\n\tithread_mutex_lock(&GlobalDebugMutex);\n\tva_start(ArgList, FmtStr);\n\tif (!DEBUG_TARGET) {\n\t\tif (DbgFileName)\n\t\t\tUpnpDisplayFileAndLine(stdout, DbgFileName, DbgLineNo);\n\t\tvfprintf(stdout, FmtStr, ArgList);\n\t\tfflush(stdout);\n\t} else if (DLevel == 0) {\n\t\tif (DbgFileName)\n\t\t\tUpnpDisplayFileAndLine(ErrFileHnd, DbgFileName,\n\t\t\t\t\t       DbgLineNo);\n\t\tvfprintf(ErrFileHnd, FmtStr, ArgList);\n\t\tfflush(ErrFileHnd);\n\t} else {\n\t\tif (DbgFileName)\n\t\t\tUpnpDisplayFileAndLine(InfoFileHnd, DbgFileName,\n\t\t\t\t\t       DbgLineNo);\n\t\tvfprintf(InfoFileHnd, FmtStr, ArgList);\n\t\tfflush(InfoFileHnd);\n\t}\n\tva_end(ArgList);\n\tithread_mutex_unlock(&GlobalDebugMutex);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include \"upnpdebug.h\"",
            "#include \"upnp.h\"",
            "#include \"ixml.h\"",
            "#include \"ithread.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include \"upnpdebug.h\"\n#include \"upnp.h\"\n#include \"ixml.h\"\n#include \"ithread.h\"\n#include \"config.h\"\n\nvoid UpnpPrintf(Upnp_LogLevel DLevel,\n\t\tDbg_Module Module,\n\t\tconst char *DbgFileName, int DbgLineNo, const char *FmtStr, ...)\n{\n\tva_list ArgList;\n\n\tif (!DebugAtThisLevel(DLevel, Module))\n\t\treturn;\n\tithread_mutex_lock(&GlobalDebugMutex);\n\tva_start(ArgList, FmtStr);\n\tif (!DEBUG_TARGET) {\n\t\tif (DbgFileName)\n\t\t\tUpnpDisplayFileAndLine(stdout, DbgFileName, DbgLineNo);\n\t\tvfprintf(stdout, FmtStr, ArgList);\n\t\tfflush(stdout);\n\t} else if (DLevel == 0) {\n\t\tif (DbgFileName)\n\t\t\tUpnpDisplayFileAndLine(ErrFileHnd, DbgFileName,\n\t\t\t\t\t       DbgLineNo);\n\t\tvfprintf(ErrFileHnd, FmtStr, ArgList);\n\t\tfflush(ErrFileHnd);\n\t} else {\n\t\tif (DbgFileName)\n\t\t\tUpnpDisplayFileAndLine(InfoFileHnd, DbgFileName,\n\t\t\t\t\t       DbgLineNo);\n\t\tvfprintf(InfoFileHnd, FmtStr, ArgList);\n\t\tfflush(InfoFileHnd);\n\t}\n\tva_end(ArgList);\n\tithread_mutex_unlock(&GlobalDebugMutex);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nvoid printServiceTable(\n    service_table * table,\n    Upnp_LogLevel level,\n    Dbg_Module module )\n{\n    UpnpPrintf( level, module, __FILE__, __LINE__,\n        \"URL_BASE: %s\\n\", table->URLBase );\n    UpnpPrintf( level, module, __FILE__, __LINE__,\n        \"Services: \\n\" );\n    printServiceList( table->serviceList, level, module );}"
  },
  {
    "function_name": "printServiceList",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
    "lines": "452-491",
    "snippet": "void printServiceList(\n    service_info * service,\n    Upnp_LogLevel level,\n    Dbg_Module module )\n{\n    while( service ) {\n        if( service->serviceType ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"serviceType: %s\\n\", service->serviceType );\n        }\n        if( service->serviceId ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"serviceId: %s\\n\", service->serviceId );\n        }\n        if( service->SCPDURL ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"SCPDURL: %s\\n\", service->SCPDURL );\n        }\n        if( service->controlURL ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"controlURL: %s\\n\", service->controlURL );\n        }\n        if( service->eventURL ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"eventURL: %s\\n\", service->eventURL );\n        }\n        if( service->UDN ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"UDN: %s\\n\\n\", service->UDN );\n        }\n        if( service->active ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"Service is active\\n\" );\n        } else {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"Service is inactive\\n\" );\n        }\n        service = service->next;\n    }\n}",
    "includes": [
      "#include \"service_table.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "UpnpPrintf",
          "args": [
            "level",
            "module",
            "__FILE__",
            "__LINE__",
            "\"Service is inactive\\n\""
          ],
          "line": 486
        },
        "resolved": true,
        "details": {
          "function_name": "UpnpPrintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/upnpdebug.c",
          "lines": "124-154",
          "snippet": "void UpnpPrintf(Upnp_LogLevel DLevel,\n\t\tDbg_Module Module,\n\t\tconst char *DbgFileName, int DbgLineNo, const char *FmtStr, ...)\n{\n\tva_list ArgList;\n\n\tif (!DebugAtThisLevel(DLevel, Module))\n\t\treturn;\n\tithread_mutex_lock(&GlobalDebugMutex);\n\tva_start(ArgList, FmtStr);\n\tif (!DEBUG_TARGET) {\n\t\tif (DbgFileName)\n\t\t\tUpnpDisplayFileAndLine(stdout, DbgFileName, DbgLineNo);\n\t\tvfprintf(stdout, FmtStr, ArgList);\n\t\tfflush(stdout);\n\t} else if (DLevel == 0) {\n\t\tif (DbgFileName)\n\t\t\tUpnpDisplayFileAndLine(ErrFileHnd, DbgFileName,\n\t\t\t\t\t       DbgLineNo);\n\t\tvfprintf(ErrFileHnd, FmtStr, ArgList);\n\t\tfflush(ErrFileHnd);\n\t} else {\n\t\tif (DbgFileName)\n\t\t\tUpnpDisplayFileAndLine(InfoFileHnd, DbgFileName,\n\t\t\t\t\t       DbgLineNo);\n\t\tvfprintf(InfoFileHnd, FmtStr, ArgList);\n\t\tfflush(InfoFileHnd);\n\t}\n\tva_end(ArgList);\n\tithread_mutex_unlock(&GlobalDebugMutex);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include \"upnpdebug.h\"",
            "#include \"upnp.h\"",
            "#include \"ixml.h\"",
            "#include \"ithread.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include \"upnpdebug.h\"\n#include \"upnp.h\"\n#include \"ixml.h\"\n#include \"ithread.h\"\n#include \"config.h\"\n\nvoid UpnpPrintf(Upnp_LogLevel DLevel,\n\t\tDbg_Module Module,\n\t\tconst char *DbgFileName, int DbgLineNo, const char *FmtStr, ...)\n{\n\tva_list ArgList;\n\n\tif (!DebugAtThisLevel(DLevel, Module))\n\t\treturn;\n\tithread_mutex_lock(&GlobalDebugMutex);\n\tva_start(ArgList, FmtStr);\n\tif (!DEBUG_TARGET) {\n\t\tif (DbgFileName)\n\t\t\tUpnpDisplayFileAndLine(stdout, DbgFileName, DbgLineNo);\n\t\tvfprintf(stdout, FmtStr, ArgList);\n\t\tfflush(stdout);\n\t} else if (DLevel == 0) {\n\t\tif (DbgFileName)\n\t\t\tUpnpDisplayFileAndLine(ErrFileHnd, DbgFileName,\n\t\t\t\t\t       DbgLineNo);\n\t\tvfprintf(ErrFileHnd, FmtStr, ArgList);\n\t\tfflush(ErrFileHnd);\n\t} else {\n\t\tif (DbgFileName)\n\t\t\tUpnpDisplayFileAndLine(InfoFileHnd, DbgFileName,\n\t\t\t\t\t       DbgLineNo);\n\t\tvfprintf(InfoFileHnd, FmtStr, ArgList);\n\t\tfflush(InfoFileHnd);\n\t}\n\tva_end(ArgList);\n\tithread_mutex_unlock(&GlobalDebugMutex);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nvoid printServiceList(\n    service_info * service,\n    Upnp_LogLevel level,\n    Dbg_Module module )\n{\n    while( service ) {\n        if( service->serviceType ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"serviceType: %s\\n\", service->serviceType );\n        }\n        if( service->serviceId ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"serviceId: %s\\n\", service->serviceId );\n        }\n        if( service->SCPDURL ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"SCPDURL: %s\\n\", service->SCPDURL );\n        }\n        if( service->controlURL ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"controlURL: %s\\n\", service->controlURL );\n        }\n        if( service->eventURL ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"eventURL: %s\\n\", service->eventURL );\n        }\n        if( service->UDN ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"UDN: %s\\n\\n\", service->UDN );\n        }\n        if( service->active ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"Service is active\\n\" );\n        } else {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"Service is inactive\\n\" );\n        }\n        service = service->next;\n    }\n}"
  },
  {
    "function_name": "printService",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
    "lines": "395-433",
    "snippet": "void printService(\n    service_info *service,\n    Upnp_LogLevel level,\n    Dbg_Module module )\n{\n    if( service ) {\n        if( service->serviceType ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"serviceType: %s\\n\", service->serviceType );\n        }\n        if( service->serviceId ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"serviceId: %s\\n\", service->serviceId );\n        }\n\tif( service->SCPDURL ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"SCPDURL: %s\\n\", service->SCPDURL );\n        }\n\tif( service->controlURL ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"controlURL: %s\\n\", service->controlURL );\n        }\n\tif( service->eventURL ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"eventURL: %s\\n\", service->eventURL );\n        }\n\tif( service->UDN ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"UDN: %s\\n\\n\", service->UDN );\n        }\n\tif( service->active ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n            \"Service is active\\n\" );\n        } else {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n            \"Service is inactive\\n\" );\n        }\n    }\n}",
    "includes": [
      "#include \"service_table.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "UpnpPrintf",
          "args": [
            "level",
            "module",
            "__FILE__",
            "__LINE__",
            "\"Service is inactive\\n\""
          ],
          "line": 429
        },
        "resolved": true,
        "details": {
          "function_name": "UpnpPrintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/api/upnpdebug.c",
          "lines": "124-154",
          "snippet": "void UpnpPrintf(Upnp_LogLevel DLevel,\n\t\tDbg_Module Module,\n\t\tconst char *DbgFileName, int DbgLineNo, const char *FmtStr, ...)\n{\n\tva_list ArgList;\n\n\tif (!DebugAtThisLevel(DLevel, Module))\n\t\treturn;\n\tithread_mutex_lock(&GlobalDebugMutex);\n\tva_start(ArgList, FmtStr);\n\tif (!DEBUG_TARGET) {\n\t\tif (DbgFileName)\n\t\t\tUpnpDisplayFileAndLine(stdout, DbgFileName, DbgLineNo);\n\t\tvfprintf(stdout, FmtStr, ArgList);\n\t\tfflush(stdout);\n\t} else if (DLevel == 0) {\n\t\tif (DbgFileName)\n\t\t\tUpnpDisplayFileAndLine(ErrFileHnd, DbgFileName,\n\t\t\t\t\t       DbgLineNo);\n\t\tvfprintf(ErrFileHnd, FmtStr, ArgList);\n\t\tfflush(ErrFileHnd);\n\t} else {\n\t\tif (DbgFileName)\n\t\t\tUpnpDisplayFileAndLine(InfoFileHnd, DbgFileName,\n\t\t\t\t\t       DbgLineNo);\n\t\tvfprintf(InfoFileHnd, FmtStr, ArgList);\n\t\tfflush(InfoFileHnd);\n\t}\n\tva_end(ArgList);\n\tithread_mutex_unlock(&GlobalDebugMutex);\n}",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdlib.h>",
            "#include <stdarg.h>",
            "#include \"upnpdebug.h\"",
            "#include \"upnp.h\"",
            "#include \"ixml.h\"",
            "#include \"ithread.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <stdarg.h>\n#include \"upnpdebug.h\"\n#include \"upnp.h\"\n#include \"ixml.h\"\n#include \"ithread.h\"\n#include \"config.h\"\n\nvoid UpnpPrintf(Upnp_LogLevel DLevel,\n\t\tDbg_Module Module,\n\t\tconst char *DbgFileName, int DbgLineNo, const char *FmtStr, ...)\n{\n\tva_list ArgList;\n\n\tif (!DebugAtThisLevel(DLevel, Module))\n\t\treturn;\n\tithread_mutex_lock(&GlobalDebugMutex);\n\tva_start(ArgList, FmtStr);\n\tif (!DEBUG_TARGET) {\n\t\tif (DbgFileName)\n\t\t\tUpnpDisplayFileAndLine(stdout, DbgFileName, DbgLineNo);\n\t\tvfprintf(stdout, FmtStr, ArgList);\n\t\tfflush(stdout);\n\t} else if (DLevel == 0) {\n\t\tif (DbgFileName)\n\t\t\tUpnpDisplayFileAndLine(ErrFileHnd, DbgFileName,\n\t\t\t\t\t       DbgLineNo);\n\t\tvfprintf(ErrFileHnd, FmtStr, ArgList);\n\t\tfflush(ErrFileHnd);\n\t} else {\n\t\tif (DbgFileName)\n\t\t\tUpnpDisplayFileAndLine(InfoFileHnd, DbgFileName,\n\t\t\t\t\t       DbgLineNo);\n\t\tvfprintf(InfoFileHnd, FmtStr, ArgList);\n\t\tfflush(InfoFileHnd);\n\t}\n\tva_end(ArgList);\n\tithread_mutex_unlock(&GlobalDebugMutex);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nvoid printService(\n    service_info *service,\n    Upnp_LogLevel level,\n    Dbg_Module module )\n{\n    if( service ) {\n        if( service->serviceType ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"serviceType: %s\\n\", service->serviceType );\n        }\n        if( service->serviceId ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"serviceId: %s\\n\", service->serviceId );\n        }\n\tif( service->SCPDURL ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"SCPDURL: %s\\n\", service->SCPDURL );\n        }\n\tif( service->controlURL ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"controlURL: %s\\n\", service->controlURL );\n        }\n\tif( service->eventURL ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"eventURL: %s\\n\", service->eventURL );\n        }\n\tif( service->UDN ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n                \"UDN: %s\\n\\n\", service->UDN );\n        }\n\tif( service->active ) {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n            \"Service is active\\n\" );\n        } else {\n            UpnpPrintf( level, module, __FILE__, __LINE__,\n            \"Service is inactive\\n\" );\n        }\n    }\n}"
  },
  {
    "function_name": "FindServiceControlURLPath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
    "lines": "346-376",
    "snippet": "service_info *\nFindServiceControlURLPath( service_table * table,\n                           const char *controlURLPath )\n{\n    service_info *finger = NULL;\n    uri_type parsed_url;\n    uri_type parsed_url_in;\n\n    if( ( table )\n        &&\n        ( parse_uri\n          ( controlURLPath, strlen( controlURLPath ),\n            &parsed_url_in ) == HTTP_SUCCESS ) ) {\n        finger = table->serviceList;\n        while( finger ) {\n            if( finger->controlURL )\n                if( ( parse_uri\n                      ( finger->controlURL, strlen( finger->controlURL ),\n                        &parsed_url ) == HTTP_SUCCESS) ) {\n                    if( !token_cmp\n                        ( &parsed_url.pathquery,\n                          &parsed_url_in.pathquery ) )\n                        return finger;\n                }\n            finger = finger->next;\n        }\n    }\n\n    return NULL;\n\n}",
    "includes": [
      "#include \"service_table.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "token_cmp",
          "args": [
            "&parsed_url.pathquery",
            "&parsed_url_in.pathquery"
          ],
          "line": 365
        },
        "resolved": true,
        "details": {
          "function_name": "token_cmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/net/uri/uri.c",
          "lines": "308-314",
          "snippet": "int token_cmp(token *in1, token *in2)\n{\n\tif (in1->size != in2->size)\n\t\treturn 1;\n\telse\n\t\treturn memcmp(in1->buff, in2->buff, in1->size);\n}",
          "includes": [
            "#include \"upnpapi.h\"",
            "#include \"uri.h\"",
            "#include \"config.h\"",
            "#include <assert.h>",
            "#include <lwres/netdb.h>",
            "#include <osreldate.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"upnpapi.h\"\n#include \"uri.h\"\n#include \"config.h\"\n#include <assert.h>\n#include <lwres/netdb.h>\n#include <osreldate.h>\n\nint token_cmp(token *in1, token *in2)\n{\n\tif (in1->size != in2->size)\n\t\treturn 1;\n\telse\n\t\treturn memcmp(in1->buff, in2->buff, in1->size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "parse_uri",
          "args": [
            "finger->controlURL",
            "strlen( finger->controlURL )",
            "&parsed_url"
          ],
          "line": 362
        },
        "resolved": true,
        "details": {
          "function_name": "parse_uri_and_unescape",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/net/uri/uri.c",
          "lines": "759-775",
          "snippet": "int parse_uri_and_unescape(char *in, size_t max, uri_type *out)\n{\n\tint ret = parse_uri(in, max, out);\n\n\tif (ret != HTTP_SUCCESS) {\n\t\treturn ret;\n\t}\n\n\tif (out->pathquery.size > (size_t)0) {\n\t\tremove_escaped_chars((char *)out->pathquery.buff, &out->pathquery.size);\n\t}\n\tif (out->fragment.size > (size_t)0) {\n\t\tremove_escaped_chars((char *)out->fragment.buff, &out->fragment.size);\n\t}\n\n\treturn HTTP_SUCCESS;\n}",
          "includes": [
            "#include \"upnpapi.h\"",
            "#include \"uri.h\"",
            "#include \"config.h\"",
            "#include <assert.h>",
            "#include <lwres/netdb.h>",
            "#include <osreldate.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"upnpapi.h\"\n#include \"uri.h\"\n#include \"config.h\"\n#include <assert.h>\n#include <lwres/netdb.h>\n#include <osreldate.h>\n\nint parse_uri_and_unescape(char *in, size_t max, uri_type *out)\n{\n\tint ret = parse_uri(in, max, out);\n\n\tif (ret != HTTP_SUCCESS) {\n\t\treturn ret;\n\t}\n\n\tif (out->pathquery.size > (size_t)0) {\n\t\tremove_escaped_chars((char *)out->pathquery.buff, &out->pathquery.size);\n\t}\n\tif (out->fragment.size > (size_t)0) {\n\t\tremove_escaped_chars((char *)out->fragment.buff, &out->fragment.size);\n\t}\n\n\treturn HTTP_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "finger->controlURL"
          ],
          "line": 363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "controlURLPath"
          ],
          "line": 357
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nservice_info *\nFindServiceControlURLPath( service_table * table,\n                           const char *controlURLPath )\n{\n    service_info *finger = NULL;\n    uri_type parsed_url;\n    uri_type parsed_url_in;\n\n    if( ( table )\n        &&\n        ( parse_uri\n          ( controlURLPath, strlen( controlURLPath ),\n            &parsed_url_in ) == HTTP_SUCCESS ) ) {\n        finger = table->serviceList;\n        while( finger ) {\n            if( finger->controlURL )\n                if( ( parse_uri\n                      ( finger->controlURL, strlen( finger->controlURL ),\n                        &parsed_url ) == HTTP_SUCCESS) ) {\n                    if( !token_cmp\n                        ( &parsed_url.pathquery,\n                          &parsed_url_in.pathquery ) )\n                        return finger;\n                }\n            finger = finger->next;\n        }\n    }\n\n    return NULL;\n\n}"
  },
  {
    "function_name": "FindServiceEventURLPath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
    "lines": "294-326",
    "snippet": "service_info *\nFindServiceEventURLPath( service_table * table,\n                         char *eventURLPath )\n{\n    service_info *finger = NULL;\n    uri_type parsed_url;\n    uri_type parsed_url_in;\n\n    if( ( table )\n        &&\n        ( parse_uri( eventURLPath,\n                     strlen( eventURLPath ),\n                     &parsed_url_in ) == HTTP_SUCCESS ) ) {\n\n        finger = table->serviceList;\n        while( finger ) {\n            if( finger->eventURL )\n                if( ( parse_uri\n                      ( finger->eventURL, strlen( finger->eventURL ),\n                        &parsed_url ) == HTTP_SUCCESS ) ) {\n\n                    if( !token_cmp\n                        ( &parsed_url.pathquery,\n                          &parsed_url_in.pathquery ) )\n                        return finger;\n\n                }\n            finger = finger->next;\n        }\n    }\n\n    return NULL;\n}",
    "includes": [
      "#include \"service_table.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "token_cmp",
          "args": [
            "&parsed_url.pathquery",
            "&parsed_url_in.pathquery"
          ],
          "line": 315
        },
        "resolved": true,
        "details": {
          "function_name": "token_cmp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/net/uri/uri.c",
          "lines": "308-314",
          "snippet": "int token_cmp(token *in1, token *in2)\n{\n\tif (in1->size != in2->size)\n\t\treturn 1;\n\telse\n\t\treturn memcmp(in1->buff, in2->buff, in1->size);\n}",
          "includes": [
            "#include \"upnpapi.h\"",
            "#include \"uri.h\"",
            "#include \"config.h\"",
            "#include <assert.h>",
            "#include <lwres/netdb.h>",
            "#include <osreldate.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"upnpapi.h\"\n#include \"uri.h\"\n#include \"config.h\"\n#include <assert.h>\n#include <lwres/netdb.h>\n#include <osreldate.h>\n\nint token_cmp(token *in1, token *in2)\n{\n\tif (in1->size != in2->size)\n\t\treturn 1;\n\telse\n\t\treturn memcmp(in1->buff, in2->buff, in1->size);\n}"
        }
      },
      {
        "call_info": {
          "callee": "parse_uri",
          "args": [
            "finger->eventURL",
            "strlen( finger->eventURL )",
            "&parsed_url"
          ],
          "line": 311
        },
        "resolved": true,
        "details": {
          "function_name": "parse_uri_and_unescape",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/net/uri/uri.c",
          "lines": "759-775",
          "snippet": "int parse_uri_and_unescape(char *in, size_t max, uri_type *out)\n{\n\tint ret = parse_uri(in, max, out);\n\n\tif (ret != HTTP_SUCCESS) {\n\t\treturn ret;\n\t}\n\n\tif (out->pathquery.size > (size_t)0) {\n\t\tremove_escaped_chars((char *)out->pathquery.buff, &out->pathquery.size);\n\t}\n\tif (out->fragment.size > (size_t)0) {\n\t\tremove_escaped_chars((char *)out->fragment.buff, &out->fragment.size);\n\t}\n\n\treturn HTTP_SUCCESS;\n}",
          "includes": [
            "#include \"upnpapi.h\"",
            "#include \"uri.h\"",
            "#include \"config.h\"",
            "#include <assert.h>",
            "#include <lwres/netdb.h>",
            "#include <osreldate.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"upnpapi.h\"\n#include \"uri.h\"\n#include \"config.h\"\n#include <assert.h>\n#include <lwres/netdb.h>\n#include <osreldate.h>\n\nint parse_uri_and_unescape(char *in, size_t max, uri_type *out)\n{\n\tint ret = parse_uri(in, max, out);\n\n\tif (ret != HTTP_SUCCESS) {\n\t\treturn ret;\n\t}\n\n\tif (out->pathquery.size > (size_t)0) {\n\t\tremove_escaped_chars((char *)out->pathquery.buff, &out->pathquery.size);\n\t}\n\tif (out->fragment.size > (size_t)0) {\n\t\tremove_escaped_chars((char *)out->fragment.buff, &out->fragment.size);\n\t}\n\n\treturn HTTP_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "finger->eventURL"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "eventURLPath"
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nservice_info *\nFindServiceEventURLPath( service_table * table,\n                         char *eventURLPath )\n{\n    service_info *finger = NULL;\n    uri_type parsed_url;\n    uri_type parsed_url_in;\n\n    if( ( table )\n        &&\n        ( parse_uri( eventURLPath,\n                     strlen( eventURLPath ),\n                     &parsed_url_in ) == HTTP_SUCCESS ) ) {\n\n        finger = table->serviceList;\n        while( finger ) {\n            if( finger->eventURL )\n                if( ( parse_uri\n                      ( finger->eventURL, strlen( finger->eventURL ),\n                        &parsed_url ) == HTTP_SUCCESS ) ) {\n\n                    if( !token_cmp\n                        ( &parsed_url.pathquery,\n                          &parsed_url_in.pathquery ) )\n                        return finger;\n\n                }\n            finger = finger->next;\n        }\n    }\n\n    return NULL;\n}"
  },
  {
    "function_name": "FindServiceId",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
    "lines": "257-276",
    "snippet": "service_info *\nFindServiceId( service_table * table,\n               const char *serviceId,\n               const char *UDN )\n{\n    service_info *finger = NULL;\n\n    if( table ) {\n        finger = table->serviceList;\n        while( finger ) {\n            if( ( !strcmp( serviceId, finger->serviceId ) ) &&\n                ( !strcmp( UDN, finger->UDN ) ) ) {\n                return finger;\n            }\n            finger = finger->next;\n        }\n    }\n\n    return NULL;\n}",
    "includes": [
      "#include \"service_table.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "UDN",
            "finger->UDN"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "serviceId",
            "finger->serviceId"
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nservice_info *\nFindServiceId( service_table * table,\n               const char *serviceId,\n               const char *UDN )\n{\n    service_info *finger = NULL;\n\n    if( table ) {\n        finger = table->serviceList;\n        while( finger ) {\n            if( ( !strcmp( serviceId, finger->serviceId ) ) &&\n                ( !strcmp( UDN, finger->UDN ) ) ) {\n                return finger;\n            }\n            finger = finger->next;\n        }\n    }\n\n    return NULL;\n}"
  },
  {
    "function_name": "freeSubscriptionList",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
    "lines": "226-237",
    "snippet": "void\nfreeSubscriptionList( subscription * head )\n{\n    subscription *next = NULL;\n\n    while( head ) {\n        next = head->next;\n        freeSubscription( head );\n        free( head );\n        head = next;\n    }\n}",
    "includes": [
      "#include \"service_table.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "head"
          ],
          "line": 234
        },
        "resolved": true,
        "details": {
          "function_name": "freeServiceTable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
          "lines": "621-628",
          "snippet": "void\nfreeServiceTable( service_table * table )\n{\n    ixmlFreeDOMString( table->URLBase );\n    freeServiceList( table->serviceList );\n    table->serviceList = NULL;\n    table->endServiceList = NULL;\n}",
          "includes": [
            "#include \"service_table.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nvoid\nfreeServiceTable( service_table * table )\n{\n    ixmlFreeDOMString( table->URLBase );\n    freeServiceList( table->serviceList );\n    table->serviceList = NULL;\n    table->endServiceList = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "freeSubscription",
          "args": [
            "head"
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "freeSubscriptionList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
          "lines": "226-237",
          "snippet": "void\nfreeSubscriptionList( subscription * head )\n{\n    subscription *next = NULL;\n\n    while( head ) {\n        next = head->next;\n        freeSubscription( head );\n        free( head );\n        head = next;\n    }\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nvoid\nfreeSubscriptionList( subscription * head )\n{\n    subscription *next = NULL;\n\n    while( head ) {\n        next = head->next;\n        freeSubscription( head );\n        free( head );\n        head = next;\n    }\n}"
  },
  {
    "function_name": "freeSubscription",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
    "lines": "206-211",
    "snippet": "void freeSubscription(subscription *sub)\n{\n\tif (sub) {\n\t\tfree_URL_list(&sub->DeliveryURLs);\n\t}\n}",
    "includes": [
      "#include \"service_table.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free_URL_list",
          "args": [
            "&sub->DeliveryURLs"
          ],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "free_URL_list",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/net/uri/uri.c",
          "lines": "252-261",
          "snippet": "void free_URL_list(URL_list *list)\n{\n\tif (list->URLs) {\n\t\tfree(list->URLs);\n\t}\n\tif (list->parsedURLs) {\n\t\tfree(list->parsedURLs);\n\t}\n\tlist->size = (size_t)0;\n}",
          "includes": [
            "#include \"upnpapi.h\"",
            "#include \"uri.h\"",
            "#include \"config.h\"",
            "#include <assert.h>",
            "#include <lwres/netdb.h>",
            "#include <osreldate.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"upnpapi.h\"\n#include \"uri.h\"\n#include \"config.h\"\n#include <assert.h>\n#include <lwres/netdb.h>\n#include <osreldate.h>\n\nvoid free_URL_list(URL_list *list)\n{\n\tif (list->URLs) {\n\t\tfree(list->URLs);\n\t}\n\tif (list->parsedURLs) {\n\t\tfree(list->parsedURLs);\n\t}\n\tlist->size = (size_t)0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nvoid freeSubscription(subscription *sub)\n{\n\tif (sub) {\n\t\tfree_URL_list(&sub->DeliveryURLs);\n\t}\n}"
  },
  {
    "function_name": "GetFirstSubscription",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
    "lines": "192-203",
    "snippet": "subscription *GetFirstSubscription(service_info *service)\n{\n\tsubscription temp;\n\tsubscription *next = NULL;\n\n\ttemp.next = service->subscriptionList;\n\tnext = GetNextSubscription(service, &temp);\n\tservice->subscriptionList = temp.next;\n\t/* service->subscriptionList = next; */\n\t\n\treturn next;\n}",
    "includes": [
      "#include \"service_table.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetNextSubscription",
          "args": [
            "service",
            "&temp"
          ],
          "line": 198
        },
        "resolved": true,
        "details": {
          "function_name": "GetNextSubscription",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
          "lines": "159-189",
          "snippet": "subscription *GetNextSubscription(service_info *service, subscription *current)\n{\n    time_t current_time;\n    subscription *next = NULL;\n    subscription *previous = NULL;\n    int notDone = 1;\n\n    /* get the current_time */\n    time( &current_time );\n    while( ( notDone ) && ( current ) ) {\n        previous = current;\n        current = current->next;\n\n        if( current == NULL ) {\n            notDone = 0;\n            next = current;\n        } else\n            if( ( current->expireTime != 0 )\n                && ( current->expireTime < current_time ) ) {\n            previous->next = current->next;\n            current->next = NULL;\n            freeSubscriptionList( current );\n            current = previous;\n            service->TotalSubscriptions--;\n        } else if( current->active ) {\n            notDone = 0;\n            next = current;\n        }\n    }\n    return next;\n}",
          "includes": [
            "#include \"service_table.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nsubscription *GetNextSubscription(service_info *service, subscription *current)\n{\n    time_t current_time;\n    subscription *next = NULL;\n    subscription *previous = NULL;\n    int notDone = 1;\n\n    /* get the current_time */\n    time( &current_time );\n    while( ( notDone ) && ( current ) ) {\n        previous = current;\n        current = current->next;\n\n        if( current == NULL ) {\n            notDone = 0;\n            next = current;\n        } else\n            if( ( current->expireTime != 0 )\n                && ( current->expireTime < current_time ) ) {\n            previous->next = current->next;\n            current->next = NULL;\n            freeSubscriptionList( current );\n            current = previous;\n            service->TotalSubscriptions--;\n        } else if( current->active ) {\n            notDone = 0;\n            next = current;\n        }\n    }\n    return next;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nsubscription *GetFirstSubscription(service_info *service)\n{\n\tsubscription temp;\n\tsubscription *next = NULL;\n\n\ttemp.next = service->subscriptionList;\n\tnext = GetNextSubscription(service, &temp);\n\tservice->subscriptionList = temp.next;\n\t/* service->subscriptionList = next; */\n\t\n\treturn next;\n}"
  },
  {
    "function_name": "GetNextSubscription",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
    "lines": "159-189",
    "snippet": "subscription *GetNextSubscription(service_info *service, subscription *current)\n{\n    time_t current_time;\n    subscription *next = NULL;\n    subscription *previous = NULL;\n    int notDone = 1;\n\n    /* get the current_time */\n    time( &current_time );\n    while( ( notDone ) && ( current ) ) {\n        previous = current;\n        current = current->next;\n\n        if( current == NULL ) {\n            notDone = 0;\n            next = current;\n        } else\n            if( ( current->expireTime != 0 )\n                && ( current->expireTime < current_time ) ) {\n            previous->next = current->next;\n            current->next = NULL;\n            freeSubscriptionList( current );\n            current = previous;\n            service->TotalSubscriptions--;\n        } else if( current->active ) {\n            notDone = 0;\n            next = current;\n        }\n    }\n    return next;\n}",
    "includes": [
      "#include \"service_table.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "freeSubscriptionList",
          "args": [
            "current"
          ],
          "line": 180
        },
        "resolved": true,
        "details": {
          "function_name": "freeSubscriptionList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
          "lines": "226-237",
          "snippet": "void\nfreeSubscriptionList( subscription * head )\n{\n    subscription *next = NULL;\n\n    while( head ) {\n        next = head->next;\n        freeSubscription( head );\n        free( head );\n        head = next;\n    }\n}",
          "includes": [
            "#include \"service_table.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nvoid\nfreeSubscriptionList( subscription * head )\n{\n    subscription *next = NULL;\n\n    while( head ) {\n        next = head->next;\n        freeSubscription( head );\n        free( head );\n        head = next;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "time",
          "args": [
            "&current_time"
          ],
          "line": 167
        },
        "resolved": true,
        "details": {
          "function_name": "get_system_time",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/uuid/sysdep.c",
          "lines": "115-127",
          "snippet": "void get_system_time(uuid_time_t *uuid_time)\n{\n\tstruct timeval tp;\n\n\tgettimeofday(&tp, (struct timezone *)0);\n\t/* Offset between UUID formatted times and Unix formatted times.\n\t * UUID UTC base time is October 15, 1582.\n\t * Unix base time is January 1, 1970. */\n\t*uuid_time =\n\t\t(uuid_time_t)tp.tv_sec * 10000000 +\n\t\t(uuid_time_t)tp.tv_usec * 10 +\n\t\t0x01B21DD213814000LL;\n}",
          "includes": [
            "#include <stdio.h>",
            "#include <string.h>",
            "#include \"UpnpInet.h\"",
            "#include \"sysdep.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <string.h>\n#include \"UpnpInet.h\"\n#include \"sysdep.h\"\n#include \"config.h\"\n\nvoid get_system_time(uuid_time_t *uuid_time)\n{\n\tstruct timeval tp;\n\n\tgettimeofday(&tp, (struct timezone *)0);\n\t/* Offset between UUID formatted times and Unix formatted times.\n\t * UUID UTC base time is October 15, 1582.\n\t * Unix base time is January 1, 1970. */\n\t*uuid_time =\n\t\t(uuid_time_t)tp.tv_sec * 10000000 +\n\t\t(uuid_time_t)tp.tv_usec * 10 +\n\t\t0x01B21DD213814000LL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nsubscription *GetNextSubscription(service_info *service, subscription *current)\n{\n    time_t current_time;\n    subscription *next = NULL;\n    subscription *previous = NULL;\n    int notDone = 1;\n\n    /* get the current_time */\n    time( &current_time );\n    while( ( notDone ) && ( current ) ) {\n        previous = current;\n        current = current->next;\n\n        if( current == NULL ) {\n            notDone = 0;\n            next = current;\n        } else\n            if( ( current->expireTime != 0 )\n                && ( current->expireTime < current_time ) ) {\n            previous->next = current->next;\n            current->next = NULL;\n            freeSubscriptionList( current );\n            current = previous;\n            service->TotalSubscriptions--;\n        } else if( current->active ) {\n            notDone = 0;\n            next = current;\n        }\n    }\n    return next;\n}"
  },
  {
    "function_name": "GetSubscriptionSID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
    "lines": "123-156",
    "snippet": "subscription *GetSubscriptionSID(const Upnp_SID sid, service_info *service)\n{\n    subscription *next = service->subscriptionList;\n    subscription *previous = NULL;\n    subscription *found = NULL;\n\n    time_t current_time;\n\n    while( ( next ) && ( found == NULL ) ) {\n        if( !strcmp( next->sid, sid ) )\n            found = next;\n        else {\n            previous = next;\n            next = next->next;\n        }\n    }\n    if( found ) {\n        /*get the current_time */\n        time( &current_time );\n        if( ( found->expireTime != 0 )\n            && ( found->expireTime < current_time ) ) {\n            if( previous )\n                previous->next = found->next;\n            else\n                service->subscriptionList = found->next;\n            found->next = NULL;\n            freeSubscriptionList( found );\n            found = NULL;\n            service->TotalSubscriptions--;\n        }\n    }\n    return found;\n\n}",
    "includes": [
      "#include \"service_table.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "freeSubscriptionList",
          "args": [
            "found"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "freeSubscriptionList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
          "lines": "226-237",
          "snippet": "void\nfreeSubscriptionList( subscription * head )\n{\n    subscription *next = NULL;\n\n    while( head ) {\n        next = head->next;\n        freeSubscription( head );\n        free( head );\n        head = next;\n    }\n}",
          "includes": [
            "#include \"service_table.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nvoid\nfreeSubscriptionList( subscription * head )\n{\n    subscription *next = NULL;\n\n    while( head ) {\n        next = head->next;\n        freeSubscription( head );\n        free( head );\n        head = next;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "time",
          "args": [
            "&current_time"
          ],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "get_system_time",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/uuid/sysdep.c",
          "lines": "115-127",
          "snippet": "void get_system_time(uuid_time_t *uuid_time)\n{\n\tstruct timeval tp;\n\n\tgettimeofday(&tp, (struct timezone *)0);\n\t/* Offset between UUID formatted times and Unix formatted times.\n\t * UUID UTC base time is October 15, 1582.\n\t * Unix base time is January 1, 1970. */\n\t*uuid_time =\n\t\t(uuid_time_t)tp.tv_sec * 10000000 +\n\t\t(uuid_time_t)tp.tv_usec * 10 +\n\t\t0x01B21DD213814000LL;\n}",
          "includes": [
            "#include <stdio.h>",
            "#include <string.h>",
            "#include \"UpnpInet.h\"",
            "#include \"sysdep.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <string.h>\n#include \"UpnpInet.h\"\n#include \"sysdep.h\"\n#include \"config.h\"\n\nvoid get_system_time(uuid_time_t *uuid_time)\n{\n\tstruct timeval tp;\n\n\tgettimeofday(&tp, (struct timezone *)0);\n\t/* Offset between UUID formatted times and Unix formatted times.\n\t * UUID UTC base time is October 15, 1582.\n\t * Unix base time is January 1, 1970. */\n\t*uuid_time =\n\t\t(uuid_time_t)tp.tv_sec * 10000000 +\n\t\t(uuid_time_t)tp.tv_usec * 10 +\n\t\t0x01B21DD213814000LL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "next->sid",
            "sid"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nsubscription *GetSubscriptionSID(const Upnp_SID sid, service_info *service)\n{\n    subscription *next = service->subscriptionList;\n    subscription *previous = NULL;\n    subscription *found = NULL;\n\n    time_t current_time;\n\n    while( ( next ) && ( found == NULL ) ) {\n        if( !strcmp( next->sid, sid ) )\n            found = next;\n        else {\n            previous = next;\n            next = next->next;\n        }\n    }\n    if( found ) {\n        /*get the current_time */\n        time( &current_time );\n        if( ( found->expireTime != 0 )\n            && ( found->expireTime < current_time ) ) {\n            if( previous )\n                previous->next = found->next;\n            else\n                service->subscriptionList = found->next;\n            found->next = NULL;\n            freeSubscriptionList( found );\n            found = NULL;\n            service->TotalSubscriptions--;\n        }\n    }\n    return found;\n\n}"
  },
  {
    "function_name": "RemoveSubscriptionSID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
    "lines": "97-120",
    "snippet": "void\nRemoveSubscriptionSID( Upnp_SID sid,\n                       service_info * service )\n{\n    subscription *finger = service->subscriptionList;\n    subscription *previous = NULL;\n\n    while( finger ) {\n        if( !( strcmp( sid, finger->sid ) ) ) {\n            if( previous )\n                previous->next = finger->next;\n            else\n                service->subscriptionList = finger->next;\n            finger->next = NULL;\n            freeSubscriptionList( finger );\n            finger = NULL;\n            service->TotalSubscriptions--;\n        } else {\n            previous = finger;\n            finger = finger->next;\n        }\n    }\n\n}",
    "includes": [
      "#include \"service_table.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "freeSubscriptionList",
          "args": [
            "finger"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "freeSubscriptionList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
          "lines": "226-237",
          "snippet": "void\nfreeSubscriptionList( subscription * head )\n{\n    subscription *next = NULL;\n\n    while( head ) {\n        next = head->next;\n        freeSubscription( head );\n        free( head );\n        head = next;\n    }\n}",
          "includes": [
            "#include \"service_table.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nvoid\nfreeSubscriptionList( subscription * head )\n{\n    subscription *next = NULL;\n\n    while( head ) {\n        next = head->next;\n        freeSubscription( head );\n        free( head );\n        head = next;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "sid",
            "finger->sid"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nvoid\nRemoveSubscriptionSID( Upnp_SID sid,\n                       service_info * service )\n{\n    subscription *finger = service->subscriptionList;\n    subscription *previous = NULL;\n\n    while( finger ) {\n        if( !( strcmp( sid, finger->sid ) ) ) {\n            if( previous )\n                previous->next = finger->next;\n            else\n                service->subscriptionList = finger->next;\n            finger->next = NULL;\n            freeSubscriptionList( finger );\n            finger = NULL;\n            service->TotalSubscriptions--;\n        } else {\n            previous = finger;\n            finger = finger->next;\n        }\n    }\n\n}"
  },
  {
    "function_name": "copy_subscription",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/service_table/service_table.c",
    "lines": "61-79",
    "snippet": "int\ncopy_subscription( subscription * in,\n                   subscription * out )\n{\n    int return_code = HTTP_SUCCESS;\n\n    memcpy( out->sid, in->sid, SID_SIZE );\n    out->sid[SID_SIZE] = 0;\n    out->eventKey = in->eventKey;\n    out->ToSendEventKey = in->ToSendEventKey;\n    out->expireTime = in->expireTime;\n    out->active = in->active;\n    if( ( return_code =\n          copy_URL_list( &in->DeliveryURLs, &out->DeliveryURLs ) )\n        != HTTP_SUCCESS )\n        return return_code;\n    out->next = NULL;\n    return HTTP_SUCCESS;\n}",
    "includes": [
      "#include \"service_table.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "copy_URL_list",
          "args": [
            "&in->DeliveryURLs",
            "&out->DeliveryURLs"
          ],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "copy_URL_list",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/net/uri/uri.c",
          "lines": "214-249",
          "snippet": "int copy_URL_list(URL_list *in, URL_list *out)\n{\n    size_t len = strlen(in->URLs) + (size_t)1;\n    size_t i = (size_t)0;\n\n    out->URLs = NULL;\n    out->parsedURLs = NULL;\n    out->size = (size_t)0;\n\n    out->URLs = malloc(len);\n    out->parsedURLs = malloc(sizeof(uri_type) * in->size);\n\n    if ( !out->URLs || !out->parsedURLs)\n        return UPNP_E_OUTOF_MEMORY;\n    memcpy(out->URLs, in->URLs, len);\n    for( i = (size_t)0; i < in->size; i++ ) {\n        /*copy the parsed uri */\n        out->parsedURLs[i].type = in->parsedURLs[i].type;\n        copy_token( &in->parsedURLs[i].scheme, in->URLs,\n                    &out->parsedURLs[i].scheme, out->URLs );\n        out->parsedURLs[i].path_type = in->parsedURLs[i].path_type;\n        copy_token( &in->parsedURLs[i].pathquery, in->URLs,\n                    &out->parsedURLs[i].pathquery, out->URLs );\n        copy_token( &in->parsedURLs[i].fragment, in->URLs,\n                    &out->parsedURLs[i].fragment, out->URLs );\n        copy_token( &in->parsedURLs[i].hostport.text,\n                    in->URLs, &out->parsedURLs[i].hostport.text,\n                    out->URLs );\n        memcpy( &out->parsedURLs[i].hostport.IPaddress,\n            &in->parsedURLs[i].hostport.IPaddress, \n            sizeof(struct sockaddr_storage) );\n    }\n    out->size = in->size;\n\n    return HTTP_SUCCESS;\n}",
          "includes": [
            "#include \"upnpapi.h\"",
            "#include \"uri.h\"",
            "#include \"config.h\"",
            "#include <assert.h>",
            "#include <lwres/netdb.h>",
            "#include <osreldate.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"upnpapi.h\"\n#include \"uri.h\"\n#include \"config.h\"\n#include <assert.h>\n#include <lwres/netdb.h>\n#include <osreldate.h>\n\nint copy_URL_list(URL_list *in, URL_list *out)\n{\n    size_t len = strlen(in->URLs) + (size_t)1;\n    size_t i = (size_t)0;\n\n    out->URLs = NULL;\n    out->parsedURLs = NULL;\n    out->size = (size_t)0;\n\n    out->URLs = malloc(len);\n    out->parsedURLs = malloc(sizeof(uri_type) * in->size);\n\n    if ( !out->URLs || !out->parsedURLs)\n        return UPNP_E_OUTOF_MEMORY;\n    memcpy(out->URLs, in->URLs, len);\n    for( i = (size_t)0; i < in->size; i++ ) {\n        /*copy the parsed uri */\n        out->parsedURLs[i].type = in->parsedURLs[i].type;\n        copy_token( &in->parsedURLs[i].scheme, in->URLs,\n                    &out->parsedURLs[i].scheme, out->URLs );\n        out->parsedURLs[i].path_type = in->parsedURLs[i].path_type;\n        copy_token( &in->parsedURLs[i].pathquery, in->URLs,\n                    &out->parsedURLs[i].pathquery, out->URLs );\n        copy_token( &in->parsedURLs[i].fragment, in->URLs,\n                    &out->parsedURLs[i].fragment, out->URLs );\n        copy_token( &in->parsedURLs[i].hostport.text,\n                    in->URLs, &out->parsedURLs[i].hostport.text,\n                    out->URLs );\n        memcpy( &out->parsedURLs[i].hostport.IPaddress,\n            &in->parsedURLs[i].hostport.IPaddress, \n            sizeof(struct sockaddr_storage) );\n    }\n    out->size = in->size;\n\n    return HTTP_SUCCESS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "out->sid",
            "in->sid",
            "SID_SIZE"
          ],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "MD5_memcpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/uuid/md5.c",
          "lines": "333-340",
          "snippet": "static void\nMD5_memcpy(POINTER  output, POINTER  input, unsigned int len)\n{\n\tunsigned int i;\n\tfor (i = 0; i < len; ++i) {\n\t\toutput[i] = input[i];\n\t}\n}",
          "includes": [
            "#include \"md5.h\"",
            "#include \"global.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void MD5_memcpy"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"md5.h\"\n#include \"global.h\"\n#include \"config.h\"\n\nstatic void MD5_memcpy;\n\nstatic void\nMD5_memcpy(POINTER  output, POINTER  input, unsigned int len)\n{\n\tunsigned int i;\n\tfor (i = 0; i < len; ++i) {\n\t\toutput[i] = input[i];\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"service_table.h\"\n#include \"config.h\"\n\nint\ncopy_subscription( subscription * in,\n                   subscription * out )\n{\n    int return_code = HTTP_SUCCESS;\n\n    memcpy( out->sid, in->sid, SID_SIZE );\n    out->sid[SID_SIZE] = 0;\n    out->eventKey = in->eventKey;\n    out->ToSendEventKey = in->ToSendEventKey;\n    out->expireTime = in->expireTime;\n    out->active = in->active;\n    if( ( return_code =\n          copy_URL_list( &in->DeliveryURLs, &out->DeliveryURLs ) )\n        != HTTP_SUCCESS )\n        return return_code;\n    out->next = NULL;\n    return HTTP_SUCCESS;\n}"
  }
]