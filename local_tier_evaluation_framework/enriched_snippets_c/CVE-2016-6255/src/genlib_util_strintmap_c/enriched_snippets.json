[
  {
    "function_name": "map_int_to_str",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/util/strintmap.c",
    "lines": "122-135",
    "snippet": "int\nmap_int_to_str( IN int id,\n                IN str_int_entry * table,\n                IN int num_entries )\n{\n    int i;\n\n    for( i = 0; i < num_entries; i++ ) {\n        if( table[i].id == id ) {\n            return i;\n        }\n    }\n    return -1;\n}",
    "includes": [
      "#include \"membuffer.h\"",
      "#include \"strintmap.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"membuffer.h\"\n#include \"strintmap.h\"\n#include \"config.h\"\n\nint\nmap_int_to_str( IN int id,\n                IN str_int_entry * table,\n                IN int num_entries )\n{\n    int i;\n\n    for( i = 0; i < num_entries; i++ ) {\n        if( table[i].id == id ) {\n            return i;\n        }\n    }\n    return -1;\n}"
  },
  {
    "function_name": "map_str_to_int",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/util/strintmap.c",
    "lines": "63-103",
    "snippet": "int\nmap_str_to_int( IN const char *name,\n                IN size_t name_len,\n                IN str_int_entry * table,\n                IN int num_entries,\n                IN int case_sensitive )\n{\n    int top,\n      mid,\n      bot;\n    int cmp;\n    memptr name_ptr;\n\n    name_ptr.buf = ( char * )name;\n    name_ptr.length = name_len;\n\n    top = 0;\n    bot = num_entries - 1;\n\n    while( top <= bot ) {\n        mid = ( top + bot ) / 2;\n        if( case_sensitive ) {\n            /*cmp = strcmp( name, table[mid].name ); */\n            cmp = memptr_cmp( &name_ptr, table[mid].name );\n        } else {\n            /*cmp = strcasecmp( name, table[mid].name ); */\n            cmp = memptr_cmp_nocase( &name_ptr, table[mid].name );\n        }\n\n        if( cmp > 0 ) {\n            top = mid + 1;      /* look below mid */\n        } else if( cmp < 0 ) {\n            bot = mid - 1;      /* look above mid */\n        } else                  /* cmp == 0 */\n        {\n            return mid;         /* match; return table index */\n        }\n    }\n\n    return -1;                  /* header name not found */\n}",
    "includes": [
      "#include \"membuffer.h\"",
      "#include \"strintmap.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memptr_cmp_nocase",
          "args": [
            "&name_ptr",
            "table[mid].name"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "memptr_cmp_nocase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2016-6255/repo/upnp/src/genlib/util/membuffer.c",
          "lines": "78-90",
          "snippet": "int memptr_cmp_nocase(memptr * m, const char *s)\n{\n\tint cmp;\n\n\tcmp = strncasecmp(m->buf, s, m->length);\n\tif (cmp == 0 && m->length < strlen(s)) {\n\t\t/* both strings equal for 'm->length' chars */\n\t\t/*  if m is shorter than s, then s is greater */\n\t\treturn -1;\n\t}\n\n\treturn cmp;\n}",
          "includes": [
            "#include \"unixutil.h\"",
            "#include \"upnp.h\"",
            "#include \"membuffer.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <assert.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"unixutil.h\"\n#include \"upnp.h\"\n#include \"membuffer.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <assert.h>\n#include \"config.h\"\n\nint memptr_cmp_nocase(memptr * m, const char *s)\n{\n\tint cmp;\n\n\tcmp = strncasecmp(m->buf, s, m->length);\n\tif (cmp == 0 && m->length < strlen(s)) {\n\t\t/* both strings equal for 'm->length' chars */\n\t\t/*  if m is shorter than s, then s is greater */\n\t\treturn -1;\n\t}\n\n\treturn cmp;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"membuffer.h\"\n#include \"strintmap.h\"\n#include \"config.h\"\n\nint\nmap_str_to_int( IN const char *name,\n                IN size_t name_len,\n                IN str_int_entry * table,\n                IN int num_entries,\n                IN int case_sensitive )\n{\n    int top,\n      mid,\n      bot;\n    int cmp;\n    memptr name_ptr;\n\n    name_ptr.buf = ( char * )name;\n    name_ptr.length = name_len;\n\n    top = 0;\n    bot = num_entries - 1;\n\n    while( top <= bot ) {\n        mid = ( top + bot ) / 2;\n        if( case_sensitive ) {\n            /*cmp = strcmp( name, table[mid].name ); */\n            cmp = memptr_cmp( &name_ptr, table[mid].name );\n        } else {\n            /*cmp = strcasecmp( name, table[mid].name ); */\n            cmp = memptr_cmp_nocase( &name_ptr, table[mid].name );\n        }\n\n        if( cmp > 0 ) {\n            top = mid + 1;      /* look below mid */\n        } else if( cmp < 0 ) {\n            bot = mid - 1;      /* look above mid */\n        } else                  /* cmp == 0 */\n        {\n            return mid;         /* match; return table index */\n        }\n    }\n\n    return -1;                  /* header name not found */\n}"
  }
]