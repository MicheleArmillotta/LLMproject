[
  {
    "function_name": "filter_irq_stacks",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/stacktrace.c",
    "lines": "393-404",
    "snippet": "unsigned int filter_irq_stacks(unsigned long *entries, unsigned int nr_entries)\n{\n\tunsigned int i;\n\n\tfor (i = 0; i < nr_entries; i++) {\n\t\tif (in_irqentry_text(entries[i])) {\n\t\t\t/* Include the irqentry function into the stack. */\n\t\t\treturn i + 1;\n\t\t}\n\t}\n\treturn nr_entries;\n}",
    "includes": [
      "#include <linux/interrupt.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/task_stack.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "in_irqentry_text",
          "args": [
            "entries[i]"
          ],
          "line": 398
        },
        "resolved": true,
        "details": {
          "function_name": "in_irqentry_text",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/stacktrace.c",
          "lines": "378-384",
          "snippet": "static inline bool in_irqentry_text(unsigned long ptr)\n{\n\treturn (ptr >= (unsigned long)&__irqentry_text_start &&\n\t\tptr < (unsigned long)&__irqentry_text_end) ||\n\t\t(ptr >= (unsigned long)&__softirqentry_text_start &&\n\t\t ptr < (unsigned long)&__softirqentry_text_end);\n}",
          "includes": [
            "#include <linux/interrupt.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/task_stack.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/interrupt.h>\n#include <linux/stacktrace.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/task_stack.h>\n\nstatic inline bool in_irqentry_text(unsigned long ptr)\n{\n\treturn (ptr >= (unsigned long)&__irqentry_text_start &&\n\t\tptr < (unsigned long)&__irqentry_text_end) ||\n\t\t(ptr >= (unsigned long)&__softirqentry_text_start &&\n\t\t ptr < (unsigned long)&__softirqentry_text_end);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/interrupt.h>\n#include <linux/stacktrace.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/task_stack.h>\n\nunsigned int filter_irq_stacks(unsigned long *entries, unsigned int nr_entries)\n{\n\tunsigned int i;\n\n\tfor (i = 0; i < nr_entries; i++) {\n\t\tif (in_irqentry_text(entries[i])) {\n\t\t\t/* Include the irqentry function into the stack. */\n\t\t\treturn i + 1;\n\t\t}\n\t}\n\treturn nr_entries;\n}"
  },
  {
    "function_name": "in_irqentry_text",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/stacktrace.c",
    "lines": "378-384",
    "snippet": "static inline bool in_irqentry_text(unsigned long ptr)\n{\n\treturn (ptr >= (unsigned long)&__irqentry_text_start &&\n\t\tptr < (unsigned long)&__irqentry_text_end) ||\n\t\t(ptr >= (unsigned long)&__softirqentry_text_start &&\n\t\t ptr < (unsigned long)&__softirqentry_text_end);\n}",
    "includes": [
      "#include <linux/interrupt.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/task_stack.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/interrupt.h>\n#include <linux/stacktrace.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/task_stack.h>\n\nstatic inline bool in_irqentry_text(unsigned long ptr)\n{\n\treturn (ptr >= (unsigned long)&__irqentry_text_start &&\n\t\tptr < (unsigned long)&__irqentry_text_end) ||\n\t\t(ptr >= (unsigned long)&__softirqentry_text_start &&\n\t\t ptr < (unsigned long)&__softirqentry_text_end);\n}"
  },
  {
    "function_name": "stack_trace_save_user",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/stacktrace.c",
    "lines": "364-373",
    "snippet": "unsigned int stack_trace_save_user(unsigned long *store, unsigned int size)\n{\n\tstruct stack_trace trace = {\n\t\t.entries\t= store,\n\t\t.max_entries\t= size,\n\t};\n\n\tsave_stack_trace_user(&trace);\n\treturn trace.nr_entries;\n}",
    "includes": [
      "#include <linux/interrupt.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/task_stack.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "save_stack_trace_user",
          "args": [
            "&trace"
          ],
          "line": 371
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/interrupt.h>\n#include <linux/stacktrace.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/task_stack.h>\n\nunsigned int stack_trace_save_user(unsigned long *store, unsigned int size)\n{\n\tstruct stack_trace trace = {\n\t\t.entries\t= store,\n\t\t.max_entries\t= size,\n\t};\n\n\tsave_stack_trace_user(&trace);\n\treturn trace.nr_entries;\n}"
  },
  {
    "function_name": "stack_trace_save_tsk_reliable",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/stacktrace.c",
    "lines": "343-353",
    "snippet": "int stack_trace_save_tsk_reliable(struct task_struct *tsk, unsigned long *store,\n\t\t\t\t  unsigned int size)\n{\n\tstruct stack_trace trace = {\n\t\t.entries\t= store,\n\t\t.max_entries\t= size,\n\t};\n\tint ret = save_stack_trace_tsk_reliable(tsk, &trace);\n\n\treturn ret ? ret : trace.nr_entries;\n}",
    "includes": [
      "#include <linux/interrupt.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/task_stack.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "save_stack_trace_tsk_reliable",
          "args": [
            "tsk",
            "&trace"
          ],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/interrupt.h>\n#include <linux/stacktrace.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/task_stack.h>\n\nint stack_trace_save_tsk_reliable(struct task_struct *tsk, unsigned long *store,\n\t\t\t\t  unsigned int size)\n{\n\tstruct stack_trace trace = {\n\t\t.entries\t= store,\n\t\t.max_entries\t= size,\n\t};\n\tint ret = save_stack_trace_tsk_reliable(tsk, &trace);\n\n\treturn ret ? ret : trace.nr_entries;\n}"
  },
  {
    "function_name": "stack_trace_save_regs",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/stacktrace.c",
    "lines": "317-328",
    "snippet": "unsigned int stack_trace_save_regs(struct pt_regs *regs, unsigned long *store,\n\t\t\t\t   unsigned int size, unsigned int skipnr)\n{\n\tstruct stack_trace trace = {\n\t\t.entries\t= store,\n\t\t.max_entries\t= size,\n\t\t.skip\t\t= skipnr,\n\t};\n\n\tsave_stack_trace_regs(regs, &trace);\n\treturn trace.nr_entries;\n}",
    "includes": [
      "#include <linux/interrupt.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/task_stack.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "save_stack_trace_regs",
          "args": [
            "regs",
            "&trace"
          ],
          "line": 326
        },
        "resolved": true,
        "details": {
          "function_name": "save_stack_trace_regs",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/stacktrace.c",
          "lines": "256-260",
          "snippet": "__weak void\nsave_stack_trace_regs(struct pt_regs *regs, struct stack_trace *trace)\n{\n\tWARN_ONCE(1, KERN_INFO \"save_stack_trace_regs() not implemented yet.\\n\");\n}",
          "includes": [
            "#include <linux/interrupt.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/task_stack.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/interrupt.h>\n#include <linux/stacktrace.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/task_stack.h>\n\n__weak void\nsave_stack_trace_regs(struct pt_regs *regs, struct stack_trace *trace)\n{\n\tWARN_ONCE(1, KERN_INFO \"save_stack_trace_regs() not implemented yet.\\n\");\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/interrupt.h>\n#include <linux/stacktrace.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/task_stack.h>\n\nunsigned int stack_trace_save_regs(struct pt_regs *regs, unsigned long *store,\n\t\t\t\t   unsigned int size, unsigned int skipnr)\n{\n\tstruct stack_trace trace = {\n\t\t.entries\t= store,\n\t\t.max_entries\t= size,\n\t\t.skip\t\t= skipnr,\n\t};\n\n\tsave_stack_trace_regs(regs, &trace);\n\treturn trace.nr_entries;\n}"
  },
  {
    "function_name": "stack_trace_save_tsk",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/stacktrace.c",
    "lines": "293-306",
    "snippet": "unsigned int stack_trace_save_tsk(struct task_struct *task,\n\t\t\t\t  unsigned long *store, unsigned int size,\n\t\t\t\t  unsigned int skipnr)\n{\n\tstruct stack_trace trace = {\n\t\t.entries\t= store,\n\t\t.max_entries\t= size,\n\t\t/* skip this function if they are tracing us */\n\t\t.skip\t= skipnr + (current == task),\n\t};\n\n\tsave_stack_trace_tsk(task, &trace);\n\treturn trace.nr_entries;\n}",
    "includes": [
      "#include <linux/interrupt.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/task_stack.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "save_stack_trace_tsk",
          "args": [
            "task",
            "&trace"
          ],
          "line": 304
        },
        "resolved": true,
        "details": {
          "function_name": "save_stack_trace_tsk",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/stacktrace.c",
          "lines": "250-254",
          "snippet": "__weak void\nsave_stack_trace_tsk(struct task_struct *tsk, struct stack_trace *trace)\n{\n\tWARN_ONCE(1, KERN_INFO \"save_stack_trace_tsk() not implemented yet.\\n\");\n}",
          "includes": [
            "#include <linux/interrupt.h>",
            "#include <linux/stacktrace.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>",
            "#include <linux/sched.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/task_stack.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/interrupt.h>\n#include <linux/stacktrace.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/task_stack.h>\n\n__weak void\nsave_stack_trace_tsk(struct task_struct *tsk, struct stack_trace *trace)\n{\n\tWARN_ONCE(1, KERN_INFO \"save_stack_trace_tsk() not implemented yet.\\n\");\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/interrupt.h>\n#include <linux/stacktrace.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/task_stack.h>\n\nunsigned int stack_trace_save_tsk(struct task_struct *task,\n\t\t\t\t  unsigned long *store, unsigned int size,\n\t\t\t\t  unsigned int skipnr)\n{\n\tstruct stack_trace trace = {\n\t\t.entries\t= store,\n\t\t.max_entries\t= size,\n\t\t/* skip this function if they are tracing us */\n\t\t.skip\t= skipnr + (current == task),\n\t};\n\n\tsave_stack_trace_tsk(task, &trace);\n\treturn trace.nr_entries;\n}"
  },
  {
    "function_name": "stack_trace_save",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/stacktrace.c",
    "lines": "270-281",
    "snippet": "unsigned int stack_trace_save(unsigned long *store, unsigned int size,\n\t\t\t      unsigned int skipnr)\n{\n\tstruct stack_trace trace = {\n\t\t.entries\t= store,\n\t\t.max_entries\t= size,\n\t\t.skip\t\t= skipnr + 1,\n\t};\n\n\tsave_stack_trace(&trace);\n\treturn trace.nr_entries;\n}",
    "includes": [
      "#include <linux/interrupt.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/task_stack.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "save_stack_trace",
          "args": [
            "&trace"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/interrupt.h>\n#include <linux/stacktrace.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/task_stack.h>\n\nunsigned int stack_trace_save(unsigned long *store, unsigned int size,\n\t\t\t      unsigned int skipnr)\n{\n\tstruct stack_trace trace = {\n\t\t.entries\t= store,\n\t\t.max_entries\t= size,\n\t\t.skip\t\t= skipnr + 1,\n\t};\n\n\tsave_stack_trace(&trace);\n\treturn trace.nr_entries;\n}"
  },
  {
    "function_name": "save_stack_trace_regs",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/stacktrace.c",
    "lines": "256-260",
    "snippet": "__weak void\nsave_stack_trace_regs(struct pt_regs *regs, struct stack_trace *trace)\n{\n\tWARN_ONCE(1, KERN_INFO \"save_stack_trace_regs() not implemented yet.\\n\");\n}",
    "includes": [
      "#include <linux/interrupt.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/task_stack.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ONCE",
          "args": [
            "1",
            "KERN_INFO \"save_stack_trace_regs() not implemented yet.\\n\""
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/interrupt.h>\n#include <linux/stacktrace.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/task_stack.h>\n\n__weak void\nsave_stack_trace_regs(struct pt_regs *regs, struct stack_trace *trace)\n{\n\tWARN_ONCE(1, KERN_INFO \"save_stack_trace_regs() not implemented yet.\\n\");\n}"
  },
  {
    "function_name": "save_stack_trace_tsk",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/stacktrace.c",
    "lines": "250-254",
    "snippet": "__weak void\nsave_stack_trace_tsk(struct task_struct *tsk, struct stack_trace *trace)\n{\n\tWARN_ONCE(1, KERN_INFO \"save_stack_trace_tsk() not implemented yet.\\n\");\n}",
    "includes": [
      "#include <linux/interrupt.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/task_stack.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ONCE",
          "args": [
            "1",
            "KERN_INFO \"save_stack_trace_tsk() not implemented yet.\\n\""
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/interrupt.h>\n#include <linux/stacktrace.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/task_stack.h>\n\n__weak void\nsave_stack_trace_tsk(struct task_struct *tsk, struct stack_trace *trace)\n{\n\tWARN_ONCE(1, KERN_INFO \"save_stack_trace_tsk() not implemented yet.\\n\");\n}"
  },
  {
    "function_name": "stack_trace_save_user",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/stacktrace.c",
    "lines": "222-240",
    "snippet": "unsigned int stack_trace_save_user(unsigned long *store, unsigned int size)\n{\n\tstack_trace_consume_fn consume_entry = stack_trace_consume_entry;\n\tstruct stacktrace_cookie c = {\n\t\t.store\t= store,\n\t\t.size\t= size,\n\t};\n\tmm_segment_t fs;\n\n\t/* Trace user stack if not a kernel thread */\n\tif (current->flags & PF_KTHREAD)\n\t\treturn 0;\n\n\tfs = force_uaccess_begin();\n\tarch_stack_walk_user(consume_entry, &c, task_pt_regs(current));\n\tforce_uaccess_end(fs);\n\n\treturn c.len;\n}",
    "includes": [
      "#include <linux/interrupt.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/task_stack.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "force_uaccess_end",
          "args": [
            "fs"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arch_stack_walk_user",
          "args": [
            "consume_entry",
            "&c",
            "task_pt_regs(current)"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "task_pt_regs",
          "args": [
            "current"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "force_uaccess_begin",
          "args": [],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/interrupt.h>\n#include <linux/stacktrace.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/task_stack.h>\n\nunsigned int stack_trace_save_user(unsigned long *store, unsigned int size)\n{\n\tstack_trace_consume_fn consume_entry = stack_trace_consume_entry;\n\tstruct stacktrace_cookie c = {\n\t\t.store\t= store,\n\t\t.size\t= size,\n\t};\n\tmm_segment_t fs;\n\n\t/* Trace user stack if not a kernel thread */\n\tif (current->flags & PF_KTHREAD)\n\t\treturn 0;\n\n\tfs = force_uaccess_begin();\n\tarch_stack_walk_user(consume_entry, &c, task_pt_regs(current));\n\tforce_uaccess_end(fs);\n\n\treturn c.len;\n}"
  },
  {
    "function_name": "stack_trace_save_tsk_reliable",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/stacktrace.c",
    "lines": "191-211",
    "snippet": "int stack_trace_save_tsk_reliable(struct task_struct *tsk, unsigned long *store,\n\t\t\t\t  unsigned int size)\n{\n\tstack_trace_consume_fn consume_entry = stack_trace_consume_entry;\n\tstruct stacktrace_cookie c = {\n\t\t.store\t= store,\n\t\t.size\t= size,\n\t};\n\tint ret;\n\n\t/*\n\t * If the task doesn't have a stack (e.g., a zombie), the stack is\n\t * \"reliably\" empty.\n\t */\n\tif (!try_get_task_stack(tsk))\n\t\treturn 0;\n\n\tret = arch_stack_walk_reliable(consume_entry, &c, tsk);\n\tput_task_stack(tsk);\n\treturn ret ? ret : c.len;\n}",
    "includes": [
      "#include <linux/interrupt.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/task_stack.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_task_stack",
          "args": [
            "tsk"
          ],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "put_task_stack",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/fork.c",
          "lines": "442-446",
          "snippet": "void put_task_stack(struct task_struct *tsk)\n{\n\tif (refcount_dec_and_test(&tsk->stack_refcount))\n\t\trelease_task_stack(tsk);\n}",
          "includes": [
            "#include <linux/init_task.h>",
            "#include <trace/events/task.h>",
            "#include <trace/events/sched.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/cacheflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/pgalloc.h>",
            "#include <linux/bpf.h>",
            "#include <linux/io_uring.h>",
            "#include <linux/scs.h>",
            "#include <linux/kasan.h>",
            "#include <linux/stackleak.h>",
            "#include <linux/thread_info.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/kcov.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/compiler.h>",
            "#include <linux/aio.h>",
            "#include <linux/uprobes.h>",
            "#include <linux/signalfd.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/oom.h>",
            "#include <linux/user-return-notifier.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/magic.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/tty.h>",
            "#include <linux/random.h>",
            "#include <linux/taskstats_kern.h>",
            "#include <linux/delayacct.h>",
            "#include <linux/freezer.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <linux/acct.h>",
            "#include <linux/ksm.h>",
            "#include <linux/rmap.h>",
            "#include <linux/profile.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/audit.h>",
            "#include <linux/mount.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/kthread.h>",
            "#include <linux/compat.h>",
            "#include <linux/futex.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/swap.h>",
            "#include <linux/seccomp.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/security.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/vmacache.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/mmu_notifier.h>",
            "#include <linux/mman.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/key.h>",
            "#include <linux/iocontext.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/sem.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/personality.h>",
            "#include <linux/completion.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/module.h>",
            "#include <linux/unistd.h>",
            "#include <linux/init.h>",
            "#include <linux/rtmutex.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/stat.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/user.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/autogroup.h>",
            "#include <linux/slab.h>",
            "#include <linux/anon_inodes.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __latent_entropy struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/init_task.h>\n#include <trace/events/task.h>\n#include <trace/events/sched.h>\n#include <asm/tlbflush.h>\n#include <asm/cacheflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <asm/pgalloc.h>\n#include <linux/bpf.h>\n#include <linux/io_uring.h>\n#include <linux/scs.h>\n#include <linux/kasan.h>\n#include <linux/stackleak.h>\n#include <linux/thread_info.h>\n#include <linux/livepatch.h>\n#include <linux/kcov.h>\n#include <linux/sysctl.h>\n#include <linux/compiler.h>\n#include <linux/aio.h>\n#include <linux/uprobes.h>\n#include <linux/signalfd.h>\n#include <linux/khugepaged.h>\n#include <linux/oom.h>\n#include <linux/user-return-notifier.h>\n#include <linux/posix-timers.h>\n#include <linux/perf_event.h>\n#include <linux/magic.h>\n#include <linux/fs_struct.h>\n#include <linux/tty.h>\n#include <linux/random.h>\n#include <linux/taskstats_kern.h>\n#include <linux/delayacct.h>\n#include <linux/freezer.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/userfaultfd_k.h>\n#include <linux/acct.h>\n#include <linux/ksm.h>\n#include <linux/rmap.h>\n#include <linux/profile.h>\n#include <linux/proc_fs.h>\n#include <linux/ftrace.h>\n#include <linux/memcontrol.h>\n#include <linux/audit.h>\n#include <linux/mount.h>\n#include <linux/ptrace.h>\n#include <linux/rcupdate.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/kthread.h>\n#include <linux/compat.h>\n#include <linux/futex.h>\n#include <linux/jiffies.h>\n#include <linux/syscalls.h>\n#include <linux/swap.h>\n#include <linux/seccomp.h>\n#include <linux/hugetlb.h>\n#include <linux/security.h>\n#include <linux/cgroup.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/nsproxy.h>\n#include <linux/vmacache.h>\n#include <linux/mm_inline.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/mmu_notifier.h>\n#include <linux/mman.h>\n#include <linux/binfmts.h>\n#include <linux/key.h>\n#include <linux/iocontext.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/sem.h>\n#include <linux/mempolicy.h>\n#include <linux/personality.h>\n#include <linux/completion.h>\n#include <linux/vmalloc.h>\n#include <linux/module.h>\n#include <linux/unistd.h>\n#include <linux/init.h>\n#include <linux/rtmutex.h>\n#include <linux/seq_file.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/user.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/autogroup.h>\n#include <linux/slab.h>\n#include <linux/anon_inodes.h>\n\nstatic __latent_entropy struct;\n\nvoid put_task_stack(struct task_struct *tsk)\n{\n\tif (refcount_dec_and_test(&tsk->stack_refcount))\n\t\trelease_task_stack(tsk);\n}"
        }
      },
      {
        "call_info": {
          "callee": "arch_stack_walk_reliable",
          "args": [
            "consume_entry",
            "&c",
            "tsk"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "try_get_task_stack",
          "args": [
            "tsk"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/interrupt.h>\n#include <linux/stacktrace.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/task_stack.h>\n\nint stack_trace_save_tsk_reliable(struct task_struct *tsk, unsigned long *store,\n\t\t\t\t  unsigned int size)\n{\n\tstack_trace_consume_fn consume_entry = stack_trace_consume_entry;\n\tstruct stacktrace_cookie c = {\n\t\t.store\t= store,\n\t\t.size\t= size,\n\t};\n\tint ret;\n\n\t/*\n\t * If the task doesn't have a stack (e.g., a zombie), the stack is\n\t * \"reliably\" empty.\n\t */\n\tif (!try_get_task_stack(tsk))\n\t\treturn 0;\n\n\tret = arch_stack_walk_reliable(consume_entry, &c, tsk);\n\tput_task_stack(tsk);\n\treturn ret ? ret : c.len;\n}"
  },
  {
    "function_name": "stack_trace_save_regs",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/stacktrace.c",
    "lines": "164-176",
    "snippet": "unsigned int stack_trace_save_regs(struct pt_regs *regs, unsigned long *store,\n\t\t\t\t   unsigned int size, unsigned int skipnr)\n{\n\tstack_trace_consume_fn consume_entry = stack_trace_consume_entry;\n\tstruct stacktrace_cookie c = {\n\t\t.store\t= store,\n\t\t.size\t= size,\n\t\t.skip\t= skipnr,\n\t};\n\n\tarch_stack_walk(consume_entry, &c, current, regs);\n\treturn c.len;\n}",
    "includes": [
      "#include <linux/interrupt.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/task_stack.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "arch_stack_walk",
          "args": [
            "consume_entry",
            "&c",
            "current",
            "regs"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/interrupt.h>\n#include <linux/stacktrace.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/task_stack.h>\n\nunsigned int stack_trace_save_regs(struct pt_regs *regs, unsigned long *store,\n\t\t\t\t   unsigned int size, unsigned int skipnr)\n{\n\tstack_trace_consume_fn consume_entry = stack_trace_consume_entry;\n\tstruct stacktrace_cookie c = {\n\t\t.store\t= store,\n\t\t.size\t= size,\n\t\t.skip\t= skipnr,\n\t};\n\n\tarch_stack_walk(consume_entry, &c, current, regs);\n\treturn c.len;\n}"
  },
  {
    "function_name": "stack_trace_save_tsk",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/stacktrace.c",
    "lines": "136-153",
    "snippet": "unsigned int stack_trace_save_tsk(struct task_struct *tsk, unsigned long *store,\n\t\t\t\t  unsigned int size, unsigned int skipnr)\n{\n\tstack_trace_consume_fn consume_entry = stack_trace_consume_entry_nosched;\n\tstruct stacktrace_cookie c = {\n\t\t.store\t= store,\n\t\t.size\t= size,\n\t\t/* skip this function if they are tracing us */\n\t\t.skip\t= skipnr + (current == tsk),\n\t};\n\n\tif (!try_get_task_stack(tsk))\n\t\treturn 0;\n\n\tarch_stack_walk(consume_entry, &c, tsk, NULL);\n\tput_task_stack(tsk);\n\treturn c.len;\n}",
    "includes": [
      "#include <linux/interrupt.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/task_stack.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "put_task_stack",
          "args": [
            "tsk"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "put_task_stack",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/fork.c",
          "lines": "442-446",
          "snippet": "void put_task_stack(struct task_struct *tsk)\n{\n\tif (refcount_dec_and_test(&tsk->stack_refcount))\n\t\trelease_task_stack(tsk);\n}",
          "includes": [
            "#include <linux/init_task.h>",
            "#include <trace/events/task.h>",
            "#include <trace/events/sched.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/cacheflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/pgalloc.h>",
            "#include <linux/bpf.h>",
            "#include <linux/io_uring.h>",
            "#include <linux/scs.h>",
            "#include <linux/kasan.h>",
            "#include <linux/stackleak.h>",
            "#include <linux/thread_info.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/kcov.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/compiler.h>",
            "#include <linux/aio.h>",
            "#include <linux/uprobes.h>",
            "#include <linux/signalfd.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/oom.h>",
            "#include <linux/user-return-notifier.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/magic.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/tty.h>",
            "#include <linux/random.h>",
            "#include <linux/taskstats_kern.h>",
            "#include <linux/delayacct.h>",
            "#include <linux/freezer.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <linux/acct.h>",
            "#include <linux/ksm.h>",
            "#include <linux/rmap.h>",
            "#include <linux/profile.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/audit.h>",
            "#include <linux/mount.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/kthread.h>",
            "#include <linux/compat.h>",
            "#include <linux/futex.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/swap.h>",
            "#include <linux/seccomp.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/security.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/vmacache.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/mmu_notifier.h>",
            "#include <linux/mman.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/key.h>",
            "#include <linux/iocontext.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/sem.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/personality.h>",
            "#include <linux/completion.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/module.h>",
            "#include <linux/unistd.h>",
            "#include <linux/init.h>",
            "#include <linux/rtmutex.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/stat.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/user.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/autogroup.h>",
            "#include <linux/slab.h>",
            "#include <linux/anon_inodes.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __latent_entropy struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/init_task.h>\n#include <trace/events/task.h>\n#include <trace/events/sched.h>\n#include <asm/tlbflush.h>\n#include <asm/cacheflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <asm/pgalloc.h>\n#include <linux/bpf.h>\n#include <linux/io_uring.h>\n#include <linux/scs.h>\n#include <linux/kasan.h>\n#include <linux/stackleak.h>\n#include <linux/thread_info.h>\n#include <linux/livepatch.h>\n#include <linux/kcov.h>\n#include <linux/sysctl.h>\n#include <linux/compiler.h>\n#include <linux/aio.h>\n#include <linux/uprobes.h>\n#include <linux/signalfd.h>\n#include <linux/khugepaged.h>\n#include <linux/oom.h>\n#include <linux/user-return-notifier.h>\n#include <linux/posix-timers.h>\n#include <linux/perf_event.h>\n#include <linux/magic.h>\n#include <linux/fs_struct.h>\n#include <linux/tty.h>\n#include <linux/random.h>\n#include <linux/taskstats_kern.h>\n#include <linux/delayacct.h>\n#include <linux/freezer.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/userfaultfd_k.h>\n#include <linux/acct.h>\n#include <linux/ksm.h>\n#include <linux/rmap.h>\n#include <linux/profile.h>\n#include <linux/proc_fs.h>\n#include <linux/ftrace.h>\n#include <linux/memcontrol.h>\n#include <linux/audit.h>\n#include <linux/mount.h>\n#include <linux/ptrace.h>\n#include <linux/rcupdate.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/kthread.h>\n#include <linux/compat.h>\n#include <linux/futex.h>\n#include <linux/jiffies.h>\n#include <linux/syscalls.h>\n#include <linux/swap.h>\n#include <linux/seccomp.h>\n#include <linux/hugetlb.h>\n#include <linux/security.h>\n#include <linux/cgroup.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/nsproxy.h>\n#include <linux/vmacache.h>\n#include <linux/mm_inline.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/mmu_notifier.h>\n#include <linux/mman.h>\n#include <linux/binfmts.h>\n#include <linux/key.h>\n#include <linux/iocontext.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/sem.h>\n#include <linux/mempolicy.h>\n#include <linux/personality.h>\n#include <linux/completion.h>\n#include <linux/vmalloc.h>\n#include <linux/module.h>\n#include <linux/unistd.h>\n#include <linux/init.h>\n#include <linux/rtmutex.h>\n#include <linux/seq_file.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/user.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/autogroup.h>\n#include <linux/slab.h>\n#include <linux/anon_inodes.h>\n\nstatic __latent_entropy struct;\n\nvoid put_task_stack(struct task_struct *tsk)\n{\n\tif (refcount_dec_and_test(&tsk->stack_refcount))\n\t\trelease_task_stack(tsk);\n}"
        }
      },
      {
        "call_info": {
          "callee": "arch_stack_walk",
          "args": [
            "consume_entry",
            "&c",
            "tsk",
            "NULL"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "try_get_task_stack",
          "args": [
            "tsk"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/interrupt.h>\n#include <linux/stacktrace.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/task_stack.h>\n\nunsigned int stack_trace_save_tsk(struct task_struct *tsk, unsigned long *store,\n\t\t\t\t  unsigned int size, unsigned int skipnr)\n{\n\tstack_trace_consume_fn consume_entry = stack_trace_consume_entry_nosched;\n\tstruct stacktrace_cookie c = {\n\t\t.store\t= store,\n\t\t.size\t= size,\n\t\t/* skip this function if they are tracing us */\n\t\t.skip\t= skipnr + (current == tsk),\n\t};\n\n\tif (!try_get_task_stack(tsk))\n\t\treturn 0;\n\n\tarch_stack_walk(consume_entry, &c, tsk, NULL);\n\tput_task_stack(tsk);\n\treturn c.len;\n}"
  },
  {
    "function_name": "stack_trace_save",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/stacktrace.c",
    "lines": "112-124",
    "snippet": "unsigned int stack_trace_save(unsigned long *store, unsigned int size,\n\t\t\t      unsigned int skipnr)\n{\n\tstack_trace_consume_fn consume_entry = stack_trace_consume_entry;\n\tstruct stacktrace_cookie c = {\n\t\t.store\t= store,\n\t\t.size\t= size,\n\t\t.skip\t= skipnr + 1,\n\t};\n\n\tarch_stack_walk(consume_entry, &c, current, NULL);\n\treturn c.len;\n}",
    "includes": [
      "#include <linux/interrupt.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/task_stack.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "arch_stack_walk",
          "args": [
            "consume_entry",
            "&c",
            "current",
            "NULL"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/interrupt.h>\n#include <linux/stacktrace.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/task_stack.h>\n\nunsigned int stack_trace_save(unsigned long *store, unsigned int size,\n\t\t\t      unsigned int skipnr)\n{\n\tstack_trace_consume_fn consume_entry = stack_trace_consume_entry;\n\tstruct stacktrace_cookie c = {\n\t\t.store\t= store,\n\t\t.size\t= size,\n\t\t.skip\t= skipnr + 1,\n\t};\n\n\tarch_stack_walk(consume_entry, &c, current, NULL);\n\treturn c.len;\n}"
  },
  {
    "function_name": "stack_trace_consume_entry_nosched",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/stacktrace.c",
    "lines": "97-102",
    "snippet": "static bool stack_trace_consume_entry_nosched(void *cookie, unsigned long addr)\n{\n\tif (in_sched_functions(addr))\n\t\treturn true;\n\treturn stack_trace_consume_entry(cookie, addr);\n}",
    "includes": [
      "#include <linux/interrupt.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/task_stack.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "stack_trace_consume_entry",
          "args": [
            "cookie",
            "addr"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "stack_trace_consume_entry_nosched",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/stacktrace.c",
          "lines": "97-102",
          "snippet": "static bool stack_trace_consume_entry_nosched(void *cookie, unsigned long addr)\n{\n\tif (in_sched_functions(addr))\n\t\treturn true;\n\treturn stack_trace_consume_entry(cookie, addr);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "in_sched_functions",
          "args": [
            "addr"
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "in_sched_functions",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/core.c",
          "lines": "9275-9280",
          "snippet": "int in_sched_functions(unsigned long addr)\n{\n\treturn in_lock_functions(addr) ||\n\t\t(addr >= (unsigned long)__sched_text_start\n\t\t&& addr < (unsigned long)__sched_text_end);\n}",
          "includes": [
            "#include <linux/entry-common.h>",
            "#include \"features.h\"",
            "#include \"smp.h\"",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../../fs/io-wq.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/scs.h>",
            "#include <linux/kcov.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\"",
            "#include <trace/events/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/entry-common.h>\n#include \"features.h\"\n#include \"smp.h\"\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../../fs/io-wq.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/scs.h>\n#include <linux/kcov.h>\n#include <linux/blkdev.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n#include <trace/events/sched.h>\n\nint in_sched_functions(unsigned long addr)\n{\n\treturn in_lock_functions(addr) ||\n\t\t(addr >= (unsigned long)__sched_text_start\n\t\t&& addr < (unsigned long)__sched_text_end);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/interrupt.h>\n#include <linux/stacktrace.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/task_stack.h>\n\nstatic bool stack_trace_consume_entry_nosched(void *cookie, unsigned long addr)\n{\n\tif (in_sched_functions(addr))\n\t\treturn true;\n\treturn stack_trace_consume_entry(cookie, addr);\n}"
  },
  {
    "function_name": "stack_trace_consume_entry",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/stacktrace.c",
    "lines": "82-95",
    "snippet": "static bool stack_trace_consume_entry(void *cookie, unsigned long addr)\n{\n\tstruct stacktrace_cookie *c = cookie;\n\n\tif (c->len >= c->size)\n\t\treturn false;\n\n\tif (c->skip > 0) {\n\t\tc->skip--;\n\t\treturn true;\n\t}\n\tc->store[c->len++] = addr;\n\treturn c->len < c->size;\n}",
    "includes": [
      "#include <linux/interrupt.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/task_stack.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/interrupt.h>\n#include <linux/stacktrace.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/task_stack.h>\n\nstatic bool stack_trace_consume_entry(void *cookie, unsigned long addr)\n{\n\tstruct stacktrace_cookie *c = cookie;\n\n\tif (c->len >= c->size)\n\t\treturn false;\n\n\tif (c->skip > 0) {\n\t\tc->skip--;\n\t\treturn true;\n\t}\n\tc->store[c->len++] = addr;\n\treturn c->len < c->size;\n}"
  },
  {
    "function_name": "stack_trace_snprint",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/stacktrace.c",
    "lines": "47-70",
    "snippet": "int stack_trace_snprint(char *buf, size_t size, const unsigned long *entries,\n\t\t\tunsigned int nr_entries, int spaces)\n{\n\tunsigned int generated, i, total = 0;\n\n\tif (WARN_ON(!entries))\n\t\treturn 0;\n\n\tfor (i = 0; i < nr_entries && size; i++) {\n\t\tgenerated = snprintf(buf, size, \"%*c%pS\\n\", 1 + spaces, ' ',\n\t\t\t\t     (void *)entries[i]);\n\n\t\ttotal += generated;\n\t\tif (generated >= size) {\n\t\t\tbuf += size;\n\t\t\tsize = 0;\n\t\t} else {\n\t\t\tbuf += generated;\n\t\t\tsize -= generated;\n\t\t}\n\t}\n\n\treturn total;\n}",
    "includes": [
      "#include <linux/interrupt.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/task_stack.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "size",
            "\"%*c%pS\\n\"",
            "1 + spaces",
            "' '",
            "(void *)entries[i]"
          ],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "btf_type_snprintf_show",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/btf.c",
          "lines": "5994-6013",
          "snippet": "int btf_type_snprintf_show(const struct btf *btf, u32 type_id, void *obj,\n\t\t\t   char *buf, int len, u64 flags)\n{\n\tstruct btf_show_snprintf ssnprintf;\n\n\tssnprintf.show.target = buf;\n\tssnprintf.show.flags = flags;\n\tssnprintf.show.showfn = btf_snprintf_show;\n\tssnprintf.len_left = len;\n\tssnprintf.len = 0;\n\n\tbtf_type_show(btf, type_id, obj, (struct btf_show *)&ssnprintf);\n\n\t/* If we encontered an error, return it. */\n\tif (ssnprintf.show.state.status)\n\t\treturn ssnprintf.show.state.status;\n\n\t/* Otherwise return length we would have written */\n\treturn ssnprintf.len;\n}",
          "includes": [
            "#include <linux/bpf_types.h>",
            "#include \"../tools/lib/bpf/relo_core.h\"",
            "#include <net/sock.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/kobject.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/skmsg.h>",
            "#include <linux/btf_ids.h>",
            "#include <linux/btf.h>",
            "#include <linux/bpf_verifier.h>",
            "#include <linux/sort.h>",
            "#include <linux/idr.h>",
            "#include <linux/kernel.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/file.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/slab.h>",
            "#include <linux/errno.h>",
            "#include <linux/ctype.h>",
            "#include <linux/compiler.h>",
            "#include <linux/seq_file.h>",
            "#include <uapi/linux/types.h>",
            "#include <uapi/linux/bpf_perf_event.h>",
            "#include <uapi/linux/bpf.h>",
            "#include <uapi/linux/btf.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int btf_resolve(struct btf_verifier_env *env,\n\t\t       const struct btf_type *t, u32 type_id);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/bpf_types.h>\n#include \"../tools/lib/bpf/relo_core.h\"\n#include <net/sock.h>\n#include <linux/sysfs.h>\n#include <linux/kobject.h>\n#include <linux/bsearch.h>\n#include <linux/perf_event.h>\n#include <linux/skmsg.h>\n#include <linux/btf_ids.h>\n#include <linux/btf.h>\n#include <linux/bpf_verifier.h>\n#include <linux/sort.h>\n#include <linux/idr.h>\n#include <linux/kernel.h>\n#include <linux/uaccess.h>\n#include <linux/file.h>\n#include <linux/anon_inodes.h>\n#include <linux/slab.h>\n#include <linux/errno.h>\n#include <linux/ctype.h>\n#include <linux/compiler.h>\n#include <linux/seq_file.h>\n#include <uapi/linux/types.h>\n#include <uapi/linux/bpf_perf_event.h>\n#include <uapi/linux/bpf.h>\n#include <uapi/linux/btf.h>\n\nstatic int btf_resolve(struct btf_verifier_env *env,\n\t\t       const struct btf_type *t, u32 type_id);\n\nint btf_type_snprintf_show(const struct btf *btf, u32 type_id, void *obj,\n\t\t\t   char *buf, int len, u64 flags)\n{\n\tstruct btf_show_snprintf ssnprintf;\n\n\tssnprintf.show.target = buf;\n\tssnprintf.show.flags = flags;\n\tssnprintf.show.showfn = btf_snprintf_show;\n\tssnprintf.len_left = len;\n\tssnprintf.len = 0;\n\n\tbtf_type_show(btf, type_id, obj, (struct btf_show *)&ssnprintf);\n\n\t/* If we encontered an error, return it. */\n\tif (ssnprintf.show.state.status)\n\t\treturn ssnprintf.show.state.status;\n\n\t/* Otherwise return length we would have written */\n\treturn ssnprintf.len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "!entries"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/interrupt.h>\n#include <linux/stacktrace.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/task_stack.h>\n\nint stack_trace_snprint(char *buf, size_t size, const unsigned long *entries,\n\t\t\tunsigned int nr_entries, int spaces)\n{\n\tunsigned int generated, i, total = 0;\n\n\tif (WARN_ON(!entries))\n\t\treturn 0;\n\n\tfor (i = 0; i < nr_entries && size; i++) {\n\t\tgenerated = snprintf(buf, size, \"%*c%pS\\n\", 1 + spaces, ' ',\n\t\t\t\t     (void *)entries[i]);\n\n\t\ttotal += generated;\n\t\tif (generated >= size) {\n\t\t\tbuf += size;\n\t\t\tsize = 0;\n\t\t} else {\n\t\t\tbuf += generated;\n\t\t\tsize -= generated;\n\t\t}\n\t}\n\n\treturn total;\n}"
  },
  {
    "function_name": "stack_trace_print",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/stacktrace.c",
    "lines": "24-34",
    "snippet": "void stack_trace_print(const unsigned long *entries, unsigned int nr_entries,\n\t\t       int spaces)\n{\n\tunsigned int i;\n\n\tif (WARN_ON(!entries))\n\t\treturn;\n\n\tfor (i = 0; i < nr_entries; i++)\n\t\tprintk(\"%*c%pS\\n\", 1 + spaces, ' ', (void *)entries[i]);\n}",
    "includes": [
      "#include <linux/interrupt.h>",
      "#include <linux/stacktrace.h>",
      "#include <linux/kallsyms.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/sched.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/task_stack.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk",
          "args": [
            "\"%*c%pS\\n\"",
            "1 + spaces",
            "' '",
            "(void *)entries[i]"
          ],
          "line": 33
        },
        "resolved": true,
        "details": {
          "function_name": "__warn_printk",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/panic.c",
          "lines": "623-632",
          "snippet": "void __warn_printk(const char *fmt, ...)\n{\n\tva_list args;\n\n\tpr_warn(CUT_HERE);\n\n\tva_start(args, fmt);\n\tvprintk(fmt, args);\n\tva_end(args);\n}",
          "includes": [
            "#include <asm/sections.h>",
            "#include <trace/events/error_report.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/bug.h>",
            "#include <linux/console.h>",
            "#include <linux/nmi.h>",
            "#include <linux/init.h>",
            "#include <linux/sysrq.h>",
            "#include <linux/sched.h>",
            "#include <linux/panic_notifier.h>",
            "#include <linux/kexec.h>",
            "#include <linux/delay.h>",
            "#include <linux/reboot.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/random.h>",
            "#include <linux/module.h>",
            "#include <linux/vt_kern.h>",
            "#include <linux/notifier.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/kgdb.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/debug_locks.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <asm/sections.h>\n#include <trace/events/error_report.h>\n#include <linux/debugfs.h>\n#include <linux/ratelimit.h>\n#include <linux/bug.h>\n#include <linux/console.h>\n#include <linux/nmi.h>\n#include <linux/init.h>\n#include <linux/sysrq.h>\n#include <linux/sched.h>\n#include <linux/panic_notifier.h>\n#include <linux/kexec.h>\n#include <linux/delay.h>\n#include <linux/reboot.h>\n#include <linux/ftrace.h>\n#include <linux/random.h>\n#include <linux/module.h>\n#include <linux/vt_kern.h>\n#include <linux/notifier.h>\n#include <linux/kallsyms.h>\n#include <linux/kmsg_dump.h>\n#include <linux/kgdb.h>\n#include <linux/interrupt.h>\n#include <linux/sched/debug.h>\n#include <linux/debug_locks.h>\n\nvoid __warn_printk(const char *fmt, ...)\n{\n\tva_list args;\n\n\tpr_warn(CUT_HERE);\n\n\tva_start(args, fmt);\n\tvprintk(fmt, args);\n\tva_end(args);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "!entries"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/interrupt.h>\n#include <linux/stacktrace.h>\n#include <linux/kallsyms.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/sched.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/task_stack.h>\n\nvoid stack_trace_print(const unsigned long *entries, unsigned int nr_entries,\n\t\t       int spaces)\n{\n\tunsigned int i;\n\n\tif (WARN_ON(!entries))\n\t\treturn;\n\n\tfor (i = 0; i < nr_entries; i++)\n\t\tprintk(\"%*c%pS\\n\", 1 + spaces, ' ', (void *)entries[i]);\n}"
  }
]