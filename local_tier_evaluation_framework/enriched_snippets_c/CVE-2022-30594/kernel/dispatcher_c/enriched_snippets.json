[
  {
    "function_name": "bpf_dispatcher_change_prog",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/dispatcher.c",
    "lines": "132-159",
    "snippet": "void bpf_dispatcher_change_prog(struct bpf_dispatcher *d, struct bpf_prog *from,\n\t\t\t\tstruct bpf_prog *to)\n{\n\tbool changed = false;\n\tint prev_num_progs;\n\n\tif (from == to)\n\t\treturn;\n\n\tmutex_lock(&d->mutex);\n\tif (!d->image) {\n\t\td->image = bpf_jit_alloc_exec_page();\n\t\tif (!d->image)\n\t\t\tgoto out;\n\t\tbpf_image_ksym_add(d->image, &d->ksym);\n\t}\n\n\tprev_num_progs = d->num_progs;\n\tchanged |= bpf_dispatcher_remove_prog(d, from);\n\tchanged |= bpf_dispatcher_add_prog(d, to);\n\n\tif (!changed)\n\t\tgoto out;\n\n\tbpf_dispatcher_update(d, prev_num_progs);\nout:\n\tmutex_unlock(&d->mutex);\n}",
    "includes": [
      "#include <linux/filter.h>",
      "#include <linux/bpf.h>",
      "#include <linux/hash.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&d->mutex"
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "__rt_mutex_unlock",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/rtmutex.c",
          "lines": "1350-1356",
          "snippet": "static __always_inline void __rt_mutex_unlock(struct rt_mutex_base *lock)\n{\n\tif (likely(rt_mutex_cmpxchg_release(lock, current, NULL)))\n\t\treturn;\n\n\trt_mutex_slowunlock(lock);\n}",
          "includes": [
            "# include \"ww_mutex.h\"",
            "#include \"rtmutex_common.h\"",
            "#include <linux/ww_mutex.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "# include \"ww_mutex.h\"\n#include \"rtmutex_common.h\"\n#include <linux/ww_mutex.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n\nstatic __always_inline struct;\n\nstatic __always_inline void __rt_mutex_unlock(struct rt_mutex_base *lock)\n{\n\tif (likely(rt_mutex_cmpxchg_release(lock, current, NULL)))\n\t\treturn;\n\n\trt_mutex_slowunlock(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bpf_dispatcher_update",
          "args": [
            "d",
            "prev_num_progs"
          ],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_dispatcher_update",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/dispatcher.c",
          "lines": "105-130",
          "snippet": "static void bpf_dispatcher_update(struct bpf_dispatcher *d, int prev_num_progs)\n{\n\tvoid *old, *new;\n\tu32 noff;\n\tint err;\n\n\tif (!prev_num_progs) {\n\t\told = NULL;\n\t\tnoff = 0;\n\t} else {\n\t\told = d->image + d->image_off;\n\t\tnoff = d->image_off ^ (PAGE_SIZE / 2);\n\t}\n\n\tnew = d->num_progs ? d->image + noff : NULL;\n\tif (new) {\n\t\tif (bpf_dispatcher_prepare(d, new))\n\t\t\treturn;\n\t}\n\n\terr = bpf_arch_text_poke(d->func, BPF_MOD_JUMP, old, new);\n\tif (err || !new)\n\t\treturn;\n\n\td->image_off = noff;\n}",
          "includes": [
            "#include <linux/filter.h>",
            "#include <linux/bpf.h>",
            "#include <linux/hash.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/filter.h>\n#include <linux/bpf.h>\n#include <linux/hash.h>\n\nstatic void bpf_dispatcher_update(struct bpf_dispatcher *d, int prev_num_progs)\n{\n\tvoid *old, *new;\n\tu32 noff;\n\tint err;\n\n\tif (!prev_num_progs) {\n\t\told = NULL;\n\t\tnoff = 0;\n\t} else {\n\t\told = d->image + d->image_off;\n\t\tnoff = d->image_off ^ (PAGE_SIZE / 2);\n\t}\n\n\tnew = d->num_progs ? d->image + noff : NULL;\n\tif (new) {\n\t\tif (bpf_dispatcher_prepare(d, new))\n\t\t\treturn;\n\t}\n\n\terr = bpf_arch_text_poke(d->func, BPF_MOD_JUMP, old, new);\n\tif (err || !new)\n\t\treturn;\n\n\td->image_off = noff;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bpf_dispatcher_add_prog",
          "args": [
            "d",
            "to"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_dispatcher_add_prog",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/dispatcher.c",
          "lines": "42-65",
          "snippet": "static bool bpf_dispatcher_add_prog(struct bpf_dispatcher *d,\n\t\t\t\t    struct bpf_prog *prog)\n{\n\tstruct bpf_dispatcher_prog *entry;\n\n\tif (!prog)\n\t\treturn false;\n\n\tentry = bpf_dispatcher_find_prog(d, prog);\n\tif (entry) {\n\t\trefcount_inc(&entry->users);\n\t\treturn false;\n\t}\n\n\tentry = bpf_dispatcher_find_free(d);\n\tif (!entry)\n\t\treturn false;\n\n\tbpf_prog_inc(prog);\n\tentry->prog = prog;\n\trefcount_set(&entry->users, 1);\n\td->num_progs++;\n\treturn true;\n}",
          "includes": [
            "#include <linux/filter.h>",
            "#include <linux/bpf.h>",
            "#include <linux/hash.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/filter.h>\n#include <linux/bpf.h>\n#include <linux/hash.h>\n\nstatic bool bpf_dispatcher_add_prog(struct bpf_dispatcher *d,\n\t\t\t\t    struct bpf_prog *prog)\n{\n\tstruct bpf_dispatcher_prog *entry;\n\n\tif (!prog)\n\t\treturn false;\n\n\tentry = bpf_dispatcher_find_prog(d, prog);\n\tif (entry) {\n\t\trefcount_inc(&entry->users);\n\t\treturn false;\n\t}\n\n\tentry = bpf_dispatcher_find_free(d);\n\tif (!entry)\n\t\treturn false;\n\n\tbpf_prog_inc(prog);\n\tentry->prog = prog;\n\trefcount_set(&entry->users, 1);\n\td->num_progs++;\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bpf_dispatcher_remove_prog",
          "args": [
            "d",
            "from"
          ],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_dispatcher_remove_prog",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/dispatcher.c",
          "lines": "67-86",
          "snippet": "static bool bpf_dispatcher_remove_prog(struct bpf_dispatcher *d,\n\t\t\t\t       struct bpf_prog *prog)\n{\n\tstruct bpf_dispatcher_prog *entry;\n\n\tif (!prog)\n\t\treturn false;\n\n\tentry = bpf_dispatcher_find_prog(d, prog);\n\tif (!entry)\n\t\treturn false;\n\n\tif (refcount_dec_and_test(&entry->users)) {\n\t\tentry->prog = NULL;\n\t\tbpf_prog_put(prog);\n\t\td->num_progs--;\n\t\treturn true;\n\t}\n\treturn false;\n}",
          "includes": [
            "#include <linux/filter.h>",
            "#include <linux/bpf.h>",
            "#include <linux/hash.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/filter.h>\n#include <linux/bpf.h>\n#include <linux/hash.h>\n\nstatic bool bpf_dispatcher_remove_prog(struct bpf_dispatcher *d,\n\t\t\t\t       struct bpf_prog *prog)\n{\n\tstruct bpf_dispatcher_prog *entry;\n\n\tif (!prog)\n\t\treturn false;\n\n\tentry = bpf_dispatcher_find_prog(d, prog);\n\tif (!entry)\n\t\treturn false;\n\n\tif (refcount_dec_and_test(&entry->users)) {\n\t\tentry->prog = NULL;\n\t\tbpf_prog_put(prog);\n\t\td->num_progs--;\n\t\treturn true;\n\t}\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bpf_image_ksym_add",
          "args": [
            "d->image",
            "&d->ksym"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_image_ksym_add",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/trampoline.c",
          "lines": "54-61",
          "snippet": "void bpf_image_ksym_add(void *data, struct bpf_ksym *ksym)\n{\n\tksym->start = (unsigned long) data;\n\tksym->end = ksym->start + PAGE_SIZE;\n\tbpf_ksym_add(ksym);\n\tperf_event_ksymbol(PERF_RECORD_KSYMBOL_TYPE_BPF, ksym->start,\n\t\t\t   PAGE_SIZE, false, ksym->name);\n}",
          "includes": [
            "#include <linux/static_call.h>",
            "#include <linux/module.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/rcupdate_trace.h>",
            "#include <linux/btf.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/rbtree_latch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/filter.h>",
            "#include <linux/bpf.h>",
            "#include <linux/hash.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/static_call.h>\n#include <linux/module.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/rcupdate_trace.h>\n#include <linux/btf.h>\n#include <linux/perf_event.h>\n#include <linux/rbtree_latch.h>\n#include <linux/ftrace.h>\n#include <linux/filter.h>\n#include <linux/bpf.h>\n#include <linux/hash.h>\n\nvoid bpf_image_ksym_add(void *data, struct bpf_ksym *ksym)\n{\n\tksym->start = (unsigned long) data;\n\tksym->end = ksym->start + PAGE_SIZE;\n\tbpf_ksym_add(ksym);\n\tperf_event_ksymbol(PERF_RECORD_KSYMBOL_TYPE_BPF, ksym->start,\n\t\t\t   PAGE_SIZE, false, ksym->name);\n}"
        }
      },
      {
        "call_info": {
          "callee": "bpf_jit_alloc_exec_page",
          "args": [],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_jit_alloc_exec_page",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/trampoline.c",
          "lines": "38-52",
          "snippet": "void *bpf_jit_alloc_exec_page(void)\n{\n\tvoid *image;\n\n\timage = bpf_jit_alloc_exec(PAGE_SIZE);\n\tif (!image)\n\t\treturn NULL;\n\n\tset_vm_flush_reset_perms(image);\n\t/* Keep image as writeable. The alternative is to keep flipping ro/rw\n\t * everytime new program is attached or detached.\n\t */\n\tset_memory_x((long)image, 1);\n\treturn image;\n}",
          "includes": [
            "#include <linux/static_call.h>",
            "#include <linux/module.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/rcupdate_trace.h>",
            "#include <linux/btf.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/rbtree_latch.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/filter.h>",
            "#include <linux/bpf.h>",
            "#include <linux/hash.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/static_call.h>\n#include <linux/module.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/rcupdate_trace.h>\n#include <linux/btf.h>\n#include <linux/perf_event.h>\n#include <linux/rbtree_latch.h>\n#include <linux/ftrace.h>\n#include <linux/filter.h>\n#include <linux/bpf.h>\n#include <linux/hash.h>\n\nvoid *bpf_jit_alloc_exec_page(void)\n{\n\tvoid *image;\n\n\timage = bpf_jit_alloc_exec(PAGE_SIZE);\n\tif (!image)\n\t\treturn NULL;\n\n\tset_vm_flush_reset_perms(image);\n\t/* Keep image as writeable. The alternative is to keep flipping ro/rw\n\t * everytime new program is attached or detached.\n\t */\n\tset_memory_x((long)image, 1);\n\treturn image;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&d->mutex"
          ],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "mutex_lock_io",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/rtmutex_api.c",
          "lines": "580-586",
          "snippet": "void __sched mutex_lock_io(struct mutex *lock)\n{\n\tint token = io_schedule_prepare();\n\n\t__mutex_lock_common(lock, TASK_UNINTERRUPTIBLE, 0, NULL, _RET_IP_);\n\tio_schedule_finish(token);\n}",
          "includes": [
            "#include \"rtmutex.c\"",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex.c\"\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nvoid __sched mutex_lock_io(struct mutex *lock)\n{\n\tint token = io_schedule_prepare();\n\n\t__mutex_lock_common(lock, TASK_UNINTERRUPTIBLE, 0, NULL, _RET_IP_);\n\tio_schedule_finish(token);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/filter.h>\n#include <linux/bpf.h>\n#include <linux/hash.h>\n\nvoid bpf_dispatcher_change_prog(struct bpf_dispatcher *d, struct bpf_prog *from,\n\t\t\t\tstruct bpf_prog *to)\n{\n\tbool changed = false;\n\tint prev_num_progs;\n\n\tif (from == to)\n\t\treturn;\n\n\tmutex_lock(&d->mutex);\n\tif (!d->image) {\n\t\td->image = bpf_jit_alloc_exec_page();\n\t\tif (!d->image)\n\t\t\tgoto out;\n\t\tbpf_image_ksym_add(d->image, &d->ksym);\n\t}\n\n\tprev_num_progs = d->num_progs;\n\tchanged |= bpf_dispatcher_remove_prog(d, from);\n\tchanged |= bpf_dispatcher_add_prog(d, to);\n\n\tif (!changed)\n\t\tgoto out;\n\n\tbpf_dispatcher_update(d, prev_num_progs);\nout:\n\tmutex_unlock(&d->mutex);\n}"
  },
  {
    "function_name": "bpf_dispatcher_update",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/dispatcher.c",
    "lines": "105-130",
    "snippet": "static void bpf_dispatcher_update(struct bpf_dispatcher *d, int prev_num_progs)\n{\n\tvoid *old, *new;\n\tu32 noff;\n\tint err;\n\n\tif (!prev_num_progs) {\n\t\told = NULL;\n\t\tnoff = 0;\n\t} else {\n\t\told = d->image + d->image_off;\n\t\tnoff = d->image_off ^ (PAGE_SIZE / 2);\n\t}\n\n\tnew = d->num_progs ? d->image + noff : NULL;\n\tif (new) {\n\t\tif (bpf_dispatcher_prepare(d, new))\n\t\t\treturn;\n\t}\n\n\terr = bpf_arch_text_poke(d->func, BPF_MOD_JUMP, old, new);\n\tif (err || !new)\n\t\treturn;\n\n\td->image_off = noff;\n}",
    "includes": [
      "#include <linux/filter.h>",
      "#include <linux/bpf.h>",
      "#include <linux/hash.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bpf_arch_text_poke",
          "args": [
            "d->func",
            "BPF_MOD_JUMP",
            "old",
            "new"
          ],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_arch_text_poke",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/core.c",
          "lines": "2450-2454",
          "snippet": "int __weak bpf_arch_text_poke(void *ip, enum bpf_text_poke_type t,\n\t\t\t      void *addr1, void *addr2)\n{\n\treturn -ENOTSUPP;\n}",
          "includes": [
            "#include <linux/bpf_trace.h>",
            "#include <asm/unaligned.h>",
            "#include <asm/barrier.h>",
            "#include <linux/bpf_verifier.h>",
            "#include <linux/log2.h>",
            "#include <linux/extable.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/rbtree_latch.h>",
            "#include <linux/objtool.h>",
            "#include <linux/btf.h>",
            "#include <linux/bpf.h>",
            "#include <linux/moduleloader.h>",
            "#include <linux/random.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/skbuff.h>",
            "#include <linux/filter.h>",
            "#include <uapi/linux/btf.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "const struct bpf_func_proto bpf_map_lookup_elem_proto __weak;",
            "const struct bpf_func_proto bpf_map_update_elem_proto __weak;",
            "const struct bpf_func_proto bpf_map_delete_elem_proto __weak;",
            "const struct bpf_func_proto bpf_map_push_elem_proto __weak;",
            "const struct bpf_func_proto bpf_map_pop_elem_proto __weak;",
            "const struct bpf_func_proto bpf_map_peek_elem_proto __weak;",
            "const struct bpf_func_proto bpf_spin_lock_proto __weak;",
            "const struct bpf_func_proto bpf_spin_unlock_proto __weak;",
            "const struct bpf_func_proto bpf_jiffies64_proto __weak;",
            "const struct bpf_func_proto bpf_get_prandom_u32_proto __weak;",
            "const struct bpf_func_proto bpf_get_smp_processor_id_proto __weak;",
            "const struct bpf_func_proto bpf_get_numa_node_id_proto __weak;",
            "const struct bpf_func_proto bpf_ktime_get_ns_proto __weak;",
            "const struct bpf_func_proto bpf_ktime_get_boot_ns_proto __weak;",
            "const struct bpf_func_proto bpf_ktime_get_coarse_ns_proto __weak;",
            "const struct bpf_func_proto bpf_get_current_pid_tgid_proto __weak;",
            "const struct bpf_func_proto bpf_get_current_uid_gid_proto __weak;",
            "const struct bpf_func_proto bpf_get_current_comm_proto __weak;",
            "const struct bpf_func_proto bpf_get_current_cgroup_id_proto __weak;",
            "const struct bpf_func_proto bpf_get_current_ancestor_cgroup_id_proto __weak;",
            "const struct bpf_func_proto bpf_get_local_storage_proto __weak;",
            "const struct bpf_func_proto bpf_get_ns_current_pid_tgid_proto __weak;",
            "const struct bpf_func_proto bpf_snprintf_btf_proto __weak;",
            "const struct bpf_func_proto bpf_seq_printf_btf_proto __weak;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/bpf_trace.h>\n#include <asm/unaligned.h>\n#include <asm/barrier.h>\n#include <linux/bpf_verifier.h>\n#include <linux/log2.h>\n#include <linux/extable.h>\n#include <linux/perf_event.h>\n#include <linux/rcupdate.h>\n#include <linux/kallsyms.h>\n#include <linux/rbtree_latch.h>\n#include <linux/objtool.h>\n#include <linux/btf.h>\n#include <linux/bpf.h>\n#include <linux/moduleloader.h>\n#include <linux/random.h>\n#include <linux/vmalloc.h>\n#include <linux/skbuff.h>\n#include <linux/filter.h>\n#include <uapi/linux/btf.h>\n\nconst struct bpf_func_proto bpf_map_lookup_elem_proto __weak;\nconst struct bpf_func_proto bpf_map_update_elem_proto __weak;\nconst struct bpf_func_proto bpf_map_delete_elem_proto __weak;\nconst struct bpf_func_proto bpf_map_push_elem_proto __weak;\nconst struct bpf_func_proto bpf_map_pop_elem_proto __weak;\nconst struct bpf_func_proto bpf_map_peek_elem_proto __weak;\nconst struct bpf_func_proto bpf_spin_lock_proto __weak;\nconst struct bpf_func_proto bpf_spin_unlock_proto __weak;\nconst struct bpf_func_proto bpf_jiffies64_proto __weak;\nconst struct bpf_func_proto bpf_get_prandom_u32_proto __weak;\nconst struct bpf_func_proto bpf_get_smp_processor_id_proto __weak;\nconst struct bpf_func_proto bpf_get_numa_node_id_proto __weak;\nconst struct bpf_func_proto bpf_ktime_get_ns_proto __weak;\nconst struct bpf_func_proto bpf_ktime_get_boot_ns_proto __weak;\nconst struct bpf_func_proto bpf_ktime_get_coarse_ns_proto __weak;\nconst struct bpf_func_proto bpf_get_current_pid_tgid_proto __weak;\nconst struct bpf_func_proto bpf_get_current_uid_gid_proto __weak;\nconst struct bpf_func_proto bpf_get_current_comm_proto __weak;\nconst struct bpf_func_proto bpf_get_current_cgroup_id_proto __weak;\nconst struct bpf_func_proto bpf_get_current_ancestor_cgroup_id_proto __weak;\nconst struct bpf_func_proto bpf_get_local_storage_proto __weak;\nconst struct bpf_func_proto bpf_get_ns_current_pid_tgid_proto __weak;\nconst struct bpf_func_proto bpf_snprintf_btf_proto __weak;\nconst struct bpf_func_proto bpf_seq_printf_btf_proto __weak;\n\nint __weak bpf_arch_text_poke(void *ip, enum bpf_text_poke_type t,\n\t\t\t      void *addr1, void *addr2)\n{\n\treturn -ENOTSUPP;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bpf_dispatcher_prepare",
          "args": [
            "d",
            "new"
          ],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_dispatcher_prepare",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/dispatcher.c",
          "lines": "93-103",
          "snippet": "static int bpf_dispatcher_prepare(struct bpf_dispatcher *d, void *image)\n{\n\ts64 ips[BPF_DISPATCHER_MAX] = {}, *ipsp = &ips[0];\n\tint i;\n\n\tfor (i = 0; i < BPF_DISPATCHER_MAX; i++) {\n\t\tif (d->progs[i].prog)\n\t\t\t*ipsp++ = (s64)(uintptr_t)d->progs[i].prog->bpf_func;\n\t}\n\treturn arch_prepare_bpf_dispatcher(image, &ips[0], d->num_progs);\n}",
          "includes": [
            "#include <linux/filter.h>",
            "#include <linux/bpf.h>",
            "#include <linux/hash.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/filter.h>\n#include <linux/bpf.h>\n#include <linux/hash.h>\n\nstatic int bpf_dispatcher_prepare(struct bpf_dispatcher *d, void *image)\n{\n\ts64 ips[BPF_DISPATCHER_MAX] = {}, *ipsp = &ips[0];\n\tint i;\n\n\tfor (i = 0; i < BPF_DISPATCHER_MAX; i++) {\n\t\tif (d->progs[i].prog)\n\t\t\t*ipsp++ = (s64)(uintptr_t)d->progs[i].prog->bpf_func;\n\t}\n\treturn arch_prepare_bpf_dispatcher(image, &ips[0], d->num_progs);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/filter.h>\n#include <linux/bpf.h>\n#include <linux/hash.h>\n\nstatic void bpf_dispatcher_update(struct bpf_dispatcher *d, int prev_num_progs)\n{\n\tvoid *old, *new;\n\tu32 noff;\n\tint err;\n\n\tif (!prev_num_progs) {\n\t\told = NULL;\n\t\tnoff = 0;\n\t} else {\n\t\told = d->image + d->image_off;\n\t\tnoff = d->image_off ^ (PAGE_SIZE / 2);\n\t}\n\n\tnew = d->num_progs ? d->image + noff : NULL;\n\tif (new) {\n\t\tif (bpf_dispatcher_prepare(d, new))\n\t\t\treturn;\n\t}\n\n\terr = bpf_arch_text_poke(d->func, BPF_MOD_JUMP, old, new);\n\tif (err || !new)\n\t\treturn;\n\n\td->image_off = noff;\n}"
  },
  {
    "function_name": "bpf_dispatcher_prepare",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/dispatcher.c",
    "lines": "93-103",
    "snippet": "static int bpf_dispatcher_prepare(struct bpf_dispatcher *d, void *image)\n{\n\ts64 ips[BPF_DISPATCHER_MAX] = {}, *ipsp = &ips[0];\n\tint i;\n\n\tfor (i = 0; i < BPF_DISPATCHER_MAX; i++) {\n\t\tif (d->progs[i].prog)\n\t\t\t*ipsp++ = (s64)(uintptr_t)d->progs[i].prog->bpf_func;\n\t}\n\treturn arch_prepare_bpf_dispatcher(image, &ips[0], d->num_progs);\n}",
    "includes": [
      "#include <linux/filter.h>",
      "#include <linux/bpf.h>",
      "#include <linux/hash.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "arch_prepare_bpf_dispatcher",
          "args": [
            "image",
            "&ips[0]",
            "d->num_progs"
          ],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "arch_prepare_bpf_dispatcher",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/dispatcher.c",
          "lines": "88-91",
          "snippet": "int __weak arch_prepare_bpf_dispatcher(void *image, s64 *funcs, int num_funcs)\n{\n\treturn -ENOTSUPP;\n}",
          "includes": [
            "#include <linux/filter.h>",
            "#include <linux/bpf.h>",
            "#include <linux/hash.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/filter.h>\n#include <linux/bpf.h>\n#include <linux/hash.h>\n\nint __weak arch_prepare_bpf_dispatcher(void *image, s64 *funcs, int num_funcs)\n{\n\treturn -ENOTSUPP;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/filter.h>\n#include <linux/bpf.h>\n#include <linux/hash.h>\n\nstatic int bpf_dispatcher_prepare(struct bpf_dispatcher *d, void *image)\n{\n\ts64 ips[BPF_DISPATCHER_MAX] = {}, *ipsp = &ips[0];\n\tint i;\n\n\tfor (i = 0; i < BPF_DISPATCHER_MAX; i++) {\n\t\tif (d->progs[i].prog)\n\t\t\t*ipsp++ = (s64)(uintptr_t)d->progs[i].prog->bpf_func;\n\t}\n\treturn arch_prepare_bpf_dispatcher(image, &ips[0], d->num_progs);\n}"
  },
  {
    "function_name": "arch_prepare_bpf_dispatcher",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/dispatcher.c",
    "lines": "88-91",
    "snippet": "int __weak arch_prepare_bpf_dispatcher(void *image, s64 *funcs, int num_funcs)\n{\n\treturn -ENOTSUPP;\n}",
    "includes": [
      "#include <linux/filter.h>",
      "#include <linux/bpf.h>",
      "#include <linux/hash.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/filter.h>\n#include <linux/bpf.h>\n#include <linux/hash.h>\n\nint __weak arch_prepare_bpf_dispatcher(void *image, s64 *funcs, int num_funcs)\n{\n\treturn -ENOTSUPP;\n}"
  },
  {
    "function_name": "bpf_dispatcher_remove_prog",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/dispatcher.c",
    "lines": "67-86",
    "snippet": "static bool bpf_dispatcher_remove_prog(struct bpf_dispatcher *d,\n\t\t\t\t       struct bpf_prog *prog)\n{\n\tstruct bpf_dispatcher_prog *entry;\n\n\tif (!prog)\n\t\treturn false;\n\n\tentry = bpf_dispatcher_find_prog(d, prog);\n\tif (!entry)\n\t\treturn false;\n\n\tif (refcount_dec_and_test(&entry->users)) {\n\t\tentry->prog = NULL;\n\t\tbpf_prog_put(prog);\n\t\td->num_progs--;\n\t\treturn true;\n\t}\n\treturn false;\n}",
    "includes": [
      "#include <linux/filter.h>",
      "#include <linux/bpf.h>",
      "#include <linux/hash.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bpf_prog_put",
          "args": [
            "prog"
          ],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_prog_put",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/syscall.c",
          "lines": "1828-1831",
          "snippet": "void bpf_prog_put(struct bpf_prog *prog)\n{\n\t__bpf_prog_put(prog, true);\n}",
          "includes": [
            "#include <linux/memcontrol.h>",
            "#include <linux/rcupdate_trace.h>",
            "#include <linux/bpf-netns.h>",
            "#include <linux/poll.h>",
            "#include <linux/bpf_lsm.h>",
            "#include <linux/pgtable.h>",
            "#include <uapi/linux/btf.h>",
            "#include <linux/audit.h>",
            "#include <linux/nospec.h>",
            "#include <linux/ctype.h>",
            "#include <linux/timekeeping.h>",
            "#include <linux/cred.h>",
            "#include <linux/idr.h>",
            "#include <linux/kernel.h>",
            "#include <linux/filter.h>",
            "#include <linux/license.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/mmzone.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/slab.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/btf.h>",
            "#include <linux/bpf_verifier.h>",
            "#include <linux/bpf_lirc.h>",
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf-cgroup.h>",
            "#include <linux/bpf.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/rcupdate_trace.h>\n#include <linux/bpf-netns.h>\n#include <linux/poll.h>\n#include <linux/bpf_lsm.h>\n#include <linux/pgtable.h>\n#include <uapi/linux/btf.h>\n#include <linux/audit.h>\n#include <linux/nospec.h>\n#include <linux/ctype.h>\n#include <linux/timekeeping.h>\n#include <linux/cred.h>\n#include <linux/idr.h>\n#include <linux/kernel.h>\n#include <linux/filter.h>\n#include <linux/license.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/fdtable.h>\n#include <linux/anon_inodes.h>\n#include <linux/mmzone.h>\n#include <linux/vmalloc.h>\n#include <linux/sched/signal.h>\n#include <linux/slab.h>\n#include <linux/syscalls.h>\n#include <linux/btf.h>\n#include <linux/bpf_verifier.h>\n#include <linux/bpf_lirc.h>\n#include <linux/bpf_trace.h>\n#include <linux/bpf-cgroup.h>\n#include <linux/bpf.h>\n\nvoid bpf_prog_put(struct bpf_prog *prog)\n{\n\t__bpf_prog_put(prog, true);\n}"
        }
      },
      {
        "call_info": {
          "callee": "refcount_dec_and_test",
          "args": [
            "&entry->users"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bpf_dispatcher_find_prog",
          "args": [
            "d",
            "prog"
          ],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_dispatcher_find_prog",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/dispatcher.c",
          "lines": "24-34",
          "snippet": "static struct bpf_dispatcher_prog *bpf_dispatcher_find_prog(\n\tstruct bpf_dispatcher *d, struct bpf_prog *prog)\n{\n\tint i;\n\n\tfor (i = 0; i < BPF_DISPATCHER_MAX; i++) {\n\t\tif (prog == d->progs[i].prog)\n\t\t\treturn &d->progs[i];\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/filter.h>",
            "#include <linux/bpf.h>",
            "#include <linux/hash.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/filter.h>\n#include <linux/bpf.h>\n#include <linux/hash.h>\n\nstatic struct bpf_dispatcher_prog *bpf_dispatcher_find_prog(\n\tstruct bpf_dispatcher *d, struct bpf_prog *prog)\n{\n\tint i;\n\n\tfor (i = 0; i < BPF_DISPATCHER_MAX; i++) {\n\t\tif (prog == d->progs[i].prog)\n\t\t\treturn &d->progs[i];\n\t}\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/filter.h>\n#include <linux/bpf.h>\n#include <linux/hash.h>\n\nstatic bool bpf_dispatcher_remove_prog(struct bpf_dispatcher *d,\n\t\t\t\t       struct bpf_prog *prog)\n{\n\tstruct bpf_dispatcher_prog *entry;\n\n\tif (!prog)\n\t\treturn false;\n\n\tentry = bpf_dispatcher_find_prog(d, prog);\n\tif (!entry)\n\t\treturn false;\n\n\tif (refcount_dec_and_test(&entry->users)) {\n\t\tentry->prog = NULL;\n\t\tbpf_prog_put(prog);\n\t\td->num_progs--;\n\t\treturn true;\n\t}\n\treturn false;\n}"
  },
  {
    "function_name": "bpf_dispatcher_add_prog",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/dispatcher.c",
    "lines": "42-65",
    "snippet": "static bool bpf_dispatcher_add_prog(struct bpf_dispatcher *d,\n\t\t\t\t    struct bpf_prog *prog)\n{\n\tstruct bpf_dispatcher_prog *entry;\n\n\tif (!prog)\n\t\treturn false;\n\n\tentry = bpf_dispatcher_find_prog(d, prog);\n\tif (entry) {\n\t\trefcount_inc(&entry->users);\n\t\treturn false;\n\t}\n\n\tentry = bpf_dispatcher_find_free(d);\n\tif (!entry)\n\t\treturn false;\n\n\tbpf_prog_inc(prog);\n\tentry->prog = prog;\n\trefcount_set(&entry->users, 1);\n\td->num_progs++;\n\treturn true;\n}",
    "includes": [
      "#include <linux/filter.h>",
      "#include <linux/bpf.h>",
      "#include <linux/hash.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "refcount_set",
          "args": [
            "&entry->users",
            "1"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bpf_prog_inc",
          "args": [
            "prog"
          ],
          "line": 60
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_prog_inc_not_zero",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/syscall.c",
          "lines": "1963-1973",
          "snippet": "struct bpf_prog *bpf_prog_inc_not_zero(struct bpf_prog *prog)\n{\n\tint refold;\n\n\trefold = atomic64_fetch_add_unless(&prog->aux->refcnt, 1, 0);\n\n\tif (!refold)\n\t\treturn ERR_PTR(-ENOENT);\n\n\treturn prog;\n}",
          "includes": [
            "#include <linux/memcontrol.h>",
            "#include <linux/rcupdate_trace.h>",
            "#include <linux/bpf-netns.h>",
            "#include <linux/poll.h>",
            "#include <linux/bpf_lsm.h>",
            "#include <linux/pgtable.h>",
            "#include <uapi/linux/btf.h>",
            "#include <linux/audit.h>",
            "#include <linux/nospec.h>",
            "#include <linux/ctype.h>",
            "#include <linux/timekeeping.h>",
            "#include <linux/cred.h>",
            "#include <linux/idr.h>",
            "#include <linux/kernel.h>",
            "#include <linux/filter.h>",
            "#include <linux/license.h>",
            "#include <linux/fs.h>",
            "#include <linux/file.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/anon_inodes.h>",
            "#include <linux/mmzone.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/slab.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/btf.h>",
            "#include <linux/bpf_verifier.h>",
            "#include <linux/bpf_lirc.h>",
            "#include <linux/bpf_trace.h>",
            "#include <linux/bpf-cgroup.h>",
            "#include <linux/bpf.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/memcontrol.h>\n#include <linux/rcupdate_trace.h>\n#include <linux/bpf-netns.h>\n#include <linux/poll.h>\n#include <linux/bpf_lsm.h>\n#include <linux/pgtable.h>\n#include <uapi/linux/btf.h>\n#include <linux/audit.h>\n#include <linux/nospec.h>\n#include <linux/ctype.h>\n#include <linux/timekeeping.h>\n#include <linux/cred.h>\n#include <linux/idr.h>\n#include <linux/kernel.h>\n#include <linux/filter.h>\n#include <linux/license.h>\n#include <linux/fs.h>\n#include <linux/file.h>\n#include <linux/fdtable.h>\n#include <linux/anon_inodes.h>\n#include <linux/mmzone.h>\n#include <linux/vmalloc.h>\n#include <linux/sched/signal.h>\n#include <linux/slab.h>\n#include <linux/syscalls.h>\n#include <linux/btf.h>\n#include <linux/bpf_verifier.h>\n#include <linux/bpf_lirc.h>\n#include <linux/bpf_trace.h>\n#include <linux/bpf-cgroup.h>\n#include <linux/bpf.h>\n\nstruct bpf_prog *bpf_prog_inc_not_zero(struct bpf_prog *prog)\n{\n\tint refold;\n\n\trefold = atomic64_fetch_add_unless(&prog->aux->refcnt, 1, 0);\n\n\tif (!refold)\n\t\treturn ERR_PTR(-ENOENT);\n\n\treturn prog;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bpf_dispatcher_find_free",
          "args": [
            "d"
          ],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_dispatcher_find_free",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/dispatcher.c",
          "lines": "36-40",
          "snippet": "static struct bpf_dispatcher_prog *bpf_dispatcher_find_free(\n\tstruct bpf_dispatcher *d)\n{\n\treturn bpf_dispatcher_find_prog(d, NULL);\n}",
          "includes": [
            "#include <linux/filter.h>",
            "#include <linux/bpf.h>",
            "#include <linux/hash.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/filter.h>\n#include <linux/bpf.h>\n#include <linux/hash.h>\n\nstatic struct bpf_dispatcher_prog *bpf_dispatcher_find_free(\n\tstruct bpf_dispatcher *d)\n{\n\treturn bpf_dispatcher_find_prog(d, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "refcount_inc",
          "args": [
            "&entry->users"
          ],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "system_refcount_inc",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/trace/trace_events.c",
          "lines": "53-56",
          "snippet": "static int system_refcount_inc(struct event_subsystem *system)\n{\n\treturn system->ref_count++;\n}",
          "includes": [
            "#include \"trace_output.h\"",
            "#include <asm/setup.h>",
            "#include <trace/syscall.h>",
            "#include <trace/events/sched.h>",
            "#include <linux/delay.h>",
            "#include <linux/slab.h>",
            "#include <linux/sort.h>",
            "#include <linux/ctype.h>",
            "#include <linux/module.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/tracefs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/security.h>",
            "#include <linux/workqueue.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_output.h\"\n#include <asm/setup.h>\n#include <trace/syscall.h>\n#include <trace/events/sched.h>\n#include <linux/delay.h>\n#include <linux/slab.h>\n#include <linux/sort.h>\n#include <linux/ctype.h>\n#include <linux/module.h>\n#include <linux/uaccess.h>\n#include <linux/tracefs.h>\n#include <linux/kthread.h>\n#include <linux/spinlock.h>\n#include <linux/security.h>\n#include <linux/workqueue.h>\n\nstatic int system_refcount_inc(struct event_subsystem *system)\n{\n\treturn system->ref_count++;\n}"
        }
      },
      {
        "call_info": {
          "callee": "bpf_dispatcher_find_prog",
          "args": [
            "d",
            "prog"
          ],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_dispatcher_find_prog",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/dispatcher.c",
          "lines": "24-34",
          "snippet": "static struct bpf_dispatcher_prog *bpf_dispatcher_find_prog(\n\tstruct bpf_dispatcher *d, struct bpf_prog *prog)\n{\n\tint i;\n\n\tfor (i = 0; i < BPF_DISPATCHER_MAX; i++) {\n\t\tif (prog == d->progs[i].prog)\n\t\t\treturn &d->progs[i];\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/filter.h>",
            "#include <linux/bpf.h>",
            "#include <linux/hash.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/filter.h>\n#include <linux/bpf.h>\n#include <linux/hash.h>\n\nstatic struct bpf_dispatcher_prog *bpf_dispatcher_find_prog(\n\tstruct bpf_dispatcher *d, struct bpf_prog *prog)\n{\n\tint i;\n\n\tfor (i = 0; i < BPF_DISPATCHER_MAX; i++) {\n\t\tif (prog == d->progs[i].prog)\n\t\t\treturn &d->progs[i];\n\t}\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/filter.h>\n#include <linux/bpf.h>\n#include <linux/hash.h>\n\nstatic bool bpf_dispatcher_add_prog(struct bpf_dispatcher *d,\n\t\t\t\t    struct bpf_prog *prog)\n{\n\tstruct bpf_dispatcher_prog *entry;\n\n\tif (!prog)\n\t\treturn false;\n\n\tentry = bpf_dispatcher_find_prog(d, prog);\n\tif (entry) {\n\t\trefcount_inc(&entry->users);\n\t\treturn false;\n\t}\n\n\tentry = bpf_dispatcher_find_free(d);\n\tif (!entry)\n\t\treturn false;\n\n\tbpf_prog_inc(prog);\n\tentry->prog = prog;\n\trefcount_set(&entry->users, 1);\n\td->num_progs++;\n\treturn true;\n}"
  },
  {
    "function_name": "bpf_dispatcher_find_free",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/dispatcher.c",
    "lines": "36-40",
    "snippet": "static struct bpf_dispatcher_prog *bpf_dispatcher_find_free(\n\tstruct bpf_dispatcher *d)\n{\n\treturn bpf_dispatcher_find_prog(d, NULL);\n}",
    "includes": [
      "#include <linux/filter.h>",
      "#include <linux/bpf.h>",
      "#include <linux/hash.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "bpf_dispatcher_find_prog",
          "args": [
            "d",
            "NULL"
          ],
          "line": 39
        },
        "resolved": true,
        "details": {
          "function_name": "bpf_dispatcher_find_prog",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/dispatcher.c",
          "lines": "24-34",
          "snippet": "static struct bpf_dispatcher_prog *bpf_dispatcher_find_prog(\n\tstruct bpf_dispatcher *d, struct bpf_prog *prog)\n{\n\tint i;\n\n\tfor (i = 0; i < BPF_DISPATCHER_MAX; i++) {\n\t\tif (prog == d->progs[i].prog)\n\t\t\treturn &d->progs[i];\n\t}\n\treturn NULL;\n}",
          "includes": [
            "#include <linux/filter.h>",
            "#include <linux/bpf.h>",
            "#include <linux/hash.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/filter.h>\n#include <linux/bpf.h>\n#include <linux/hash.h>\n\nstatic struct bpf_dispatcher_prog *bpf_dispatcher_find_prog(\n\tstruct bpf_dispatcher *d, struct bpf_prog *prog)\n{\n\tint i;\n\n\tfor (i = 0; i < BPF_DISPATCHER_MAX; i++) {\n\t\tif (prog == d->progs[i].prog)\n\t\t\treturn &d->progs[i];\n\t}\n\treturn NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/filter.h>\n#include <linux/bpf.h>\n#include <linux/hash.h>\n\nstatic struct bpf_dispatcher_prog *bpf_dispatcher_find_free(\n\tstruct bpf_dispatcher *d)\n{\n\treturn bpf_dispatcher_find_prog(d, NULL);\n}"
  },
  {
    "function_name": "bpf_dispatcher_find_prog",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/dispatcher.c",
    "lines": "24-34",
    "snippet": "static struct bpf_dispatcher_prog *bpf_dispatcher_find_prog(\n\tstruct bpf_dispatcher *d, struct bpf_prog *prog)\n{\n\tint i;\n\n\tfor (i = 0; i < BPF_DISPATCHER_MAX; i++) {\n\t\tif (prog == d->progs[i].prog)\n\t\t\treturn &d->progs[i];\n\t}\n\treturn NULL;\n}",
    "includes": [
      "#include <linux/filter.h>",
      "#include <linux/bpf.h>",
      "#include <linux/hash.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/filter.h>\n#include <linux/bpf.h>\n#include <linux/hash.h>\n\nstatic struct bpf_dispatcher_prog *bpf_dispatcher_find_prog(\n\tstruct bpf_dispatcher *d, struct bpf_prog *prog)\n{\n\tint i;\n\n\tfor (i = 0; i < BPF_DISPATCHER_MAX; i++) {\n\t\tif (prog == d->progs[i].prog)\n\t\t\treturn &d->progs[i];\n\t}\n\treturn NULL;\n}"
  }
]