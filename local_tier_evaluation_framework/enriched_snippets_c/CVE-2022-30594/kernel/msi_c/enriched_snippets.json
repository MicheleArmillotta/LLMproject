[
  {
    "function_name": "msi_get_domain_info",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "1032-1035",
    "snippet": "struct msi_domain_info *msi_get_domain_info(struct irq_domain *domain)\n{\n\treturn (struct msi_domain_info *)domain->host_data;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstruct msi_domain_info *msi_get_domain_info(struct irq_domain *domain)\n{\n\treturn (struct msi_domain_info *)domain->host_data;\n}"
  },
  {
    "function_name": "msi_domain_free_irqs",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "1019-1024",
    "snippet": "void msi_domain_free_irqs(struct irq_domain *domain, struct device *dev)\n{\n\tmsi_lock_descs(dev);\n\tmsi_domain_free_irqs_descs_locked(domain, dev);\n\tmsi_unlock_descs(dev);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline int msi_sysfs_create_group(struct device *dev);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "msi_unlock_descs",
          "args": [
            "dev"
          ],
          "line": 1023
        },
        "resolved": true,
        "details": {
          "function_name": "msi_unlock_descs",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "236-241",
          "snippet": "void msi_unlock_descs(struct device *dev)\n{\n\t/* Invalidate the index wich was cached by the iterator */\n\tdev->msi.data->__iter_idx = MSI_MAX_INDEX;\n\tmutex_unlock(&dev->msi.data->mutex);\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline int msi_sysfs_create_group(struct device *dev);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nvoid msi_unlock_descs(struct device *dev)\n{\n\t/* Invalidate the index wich was cached by the iterator */\n\tdev->msi.data->__iter_idx = MSI_MAX_INDEX;\n\tmutex_unlock(&dev->msi.data->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "msi_domain_free_irqs_descs_locked",
          "args": [
            "domain",
            "dev"
          ],
          "line": 1022
        },
        "resolved": true,
        "details": {
          "function_name": "msi_domain_free_irqs_descs_locked",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "1002-1011",
          "snippet": "void msi_domain_free_irqs_descs_locked(struct irq_domain *domain, struct device *dev)\n{\n\tstruct msi_domain_info *info = domain->host_data;\n\tstruct msi_domain_ops *ops = info->ops;\n\n\tlockdep_assert_held(&dev->msi.data->mutex);\n\n\tops->domain_free_irqs(domain, dev);\n\tmsi_domain_free_msi_descs(info, dev);\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline int msi_sysfs_create_group(struct device *dev);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nvoid msi_domain_free_irqs_descs_locked(struct irq_domain *domain, struct device *dev)\n{\n\tstruct msi_domain_info *info = domain->host_data;\n\tstruct msi_domain_ops *ops = info->ops;\n\n\tlockdep_assert_held(&dev->msi.data->mutex);\n\n\tops->domain_free_irqs(domain, dev);\n\tmsi_domain_free_msi_descs(info, dev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "msi_lock_descs",
          "args": [
            "dev"
          ],
          "line": 1021
        },
        "resolved": true,
        "details": {
          "function_name": "msi_lock_descs",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "226-229",
          "snippet": "void msi_lock_descs(struct device *dev)\n{\n\tmutex_lock(&dev->msi.data->mutex);\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline int msi_sysfs_create_group(struct device *dev);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nvoid msi_lock_descs(struct device *dev)\n{\n\tmutex_lock(&dev->msi.data->mutex);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nvoid msi_domain_free_irqs(struct irq_domain *domain, struct device *dev)\n{\n\tmsi_lock_descs(dev);\n\tmsi_domain_free_irqs_descs_locked(domain, dev);\n\tmsi_unlock_descs(dev);\n}"
  },
  {
    "function_name": "msi_domain_free_irqs_descs_locked",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "1002-1011",
    "snippet": "void msi_domain_free_irqs_descs_locked(struct irq_domain *domain, struct device *dev)\n{\n\tstruct msi_domain_info *info = domain->host_data;\n\tstruct msi_domain_ops *ops = info->ops;\n\n\tlockdep_assert_held(&dev->msi.data->mutex);\n\n\tops->domain_free_irqs(domain, dev);\n\tmsi_domain_free_msi_descs(info, dev);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline int msi_sysfs_create_group(struct device *dev);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "msi_domain_free_msi_descs",
          "args": [
            "info",
            "dev"
          ],
          "line": 1010
        },
        "resolved": true,
        "details": {
          "function_name": "msi_domain_free_msi_descs",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "985-990",
          "snippet": "static void msi_domain_free_msi_descs(struct msi_domain_info *info,\n\t\t\t\t      struct device *dev)\n{\n\tif (info->flags & MSI_FLAG_FREE_MSI_DESCS)\n\t\tmsi_free_msi_descs(dev);\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline int msi_sysfs_create_group(struct device *dev);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nstatic void msi_domain_free_msi_descs(struct msi_domain_info *info,\n\t\t\t\t      struct device *dev)\n{\n\tif (info->flags & MSI_FLAG_FREE_MSI_DESCS)\n\t\tmsi_free_msi_descs(dev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ops->domain_free_irqs",
          "args": [
            "domain",
            "dev"
          ],
          "line": 1009
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lockdep_assert_held",
          "args": [
            "&dev->msi.data->mutex"
          ],
          "line": 1007
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nvoid msi_domain_free_irqs_descs_locked(struct irq_domain *domain, struct device *dev)\n{\n\tstruct msi_domain_info *info = domain->host_data;\n\tstruct msi_domain_ops *ops = info->ops;\n\n\tlockdep_assert_held(&dev->msi.data->mutex);\n\n\tops->domain_free_irqs(domain, dev);\n\tmsi_domain_free_msi_descs(info, dev);\n}"
  },
  {
    "function_name": "msi_domain_free_msi_descs",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "985-990",
    "snippet": "static void msi_domain_free_msi_descs(struct msi_domain_info *info,\n\t\t\t\t      struct device *dev)\n{\n\tif (info->flags & MSI_FLAG_FREE_MSI_DESCS)\n\t\tmsi_free_msi_descs(dev);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline int msi_sysfs_create_group(struct device *dev);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "msi_free_msi_descs",
          "args": [
            "dev"
          ],
          "line": 989
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nstatic void msi_domain_free_msi_descs(struct msi_domain_info *info,\n\t\t\t\t      struct device *dev)\n{\n\tif (info->flags & MSI_FLAG_FREE_MSI_DESCS)\n\t\tmsi_free_msi_descs(dev);\n}"
  },
  {
    "function_name": "__msi_domain_free_irqs",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "962-983",
    "snippet": "void __msi_domain_free_irqs(struct irq_domain *domain, struct device *dev)\n{\n\tstruct msi_domain_info *info = domain->host_data;\n\tstruct irq_data *irqd;\n\tstruct msi_desc *desc;\n\tint i;\n\n\t/* Only handle MSI entries which have an interrupt associated */\n\tmsi_for_each_desc(desc, dev, MSI_DESC_ASSOCIATED) {\n\t\t/* Make sure all interrupts are deactivated */\n\t\tfor (i = 0; i < desc->nvec_used; i++) {\n\t\t\tirqd = irq_domain_get_irq_data(domain, desc->irq + i);\n\t\t\tif (irqd && irqd_is_activated(irqd))\n\t\t\t\tirq_domain_deactivate_irq(irqd);\n\t\t}\n\n\t\tirq_domain_free_irqs(desc->irq, desc->nvec_used);\n\t\tif (info->flags & MSI_FLAG_DEV_SYSFS)\n\t\t\tmsi_sysfs_remove_desc(dev, desc);\n\t\tdesc->irq = 0;\n\t}\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline int msi_sysfs_create_group(struct device *dev);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "msi_sysfs_remove_desc",
          "args": [
            "dev",
            "desc"
          ],
          "line": 980
        },
        "resolved": true,
        "details": {
          "function_name": "msi_sysfs_remove_desc",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "459-459",
          "snippet": "static inline void msi_sysfs_remove_desc(struct device *dev, struct msi_desc *desc) { }",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline int msi_sysfs_create_group(struct device *dev);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nstatic inline void msi_sysfs_remove_desc(struct device *dev, struct msi_desc *desc) { }"
        }
      },
      {
        "call_info": {
          "callee": "irq_domain_free_irqs",
          "args": [
            "desc->irq",
            "desc->nvec_used"
          ],
          "line": 978
        },
        "resolved": true,
        "details": {
          "function_name": "irq_domain_free_irqs",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/irqdomain.c",
          "lines": "1687-1704",
          "snippet": "void irq_domain_free_irqs(unsigned int virq, unsigned int nr_irqs)\n{\n\tstruct irq_data *data = irq_get_irq_data(virq);\n\tint i;\n\n\tif (WARN(!data || !data->domain || !data->domain->ops->free,\n\t\t \"NULL pointer, cannot free irq\\n\"))\n\t\treturn;\n\n\tmutex_lock(&irq_domain_mutex);\n\tfor (i = 0; i < nr_irqs; i++)\n\t\tirq_domain_remove_irq(virq + i);\n\tirq_domain_free_irqs_hierarchy(data->domain, virq, nr_irqs);\n\tmutex_unlock(&irq_domain_mutex);\n\n\tirq_domain_free_irq_data(virq, nr_irqs);\n\tirq_free_descs(virq, nr_irqs);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/smp.h>",
            "#include <linux/slab.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/topology.h>",
            "#include <linux/of_irq.h>",
            "#include <linux/of_address.h>",
            "#include <linux/of.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irqdesc.h>",
            "#include <linux/irq.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/acpi.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_MUTEX(irq_domain_mutex);",
            "static void irq_domain_check_hierarchy(struct irq_domain *domain);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/smp.h>\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/topology.h>\n#include <linux/of_irq.h>\n#include <linux/of_address.h>\n#include <linux/of.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/irqdomain.h>\n#include <linux/irqdesc.h>\n#include <linux/irq.h>\n#include <linux/interrupt.h>\n#include <linux/hardirq.h>\n#include <linux/debugfs.h>\n#include <linux/acpi.h>\n\nstatic DEFINE_MUTEX(irq_domain_mutex);\nstatic void irq_domain_check_hierarchy(struct irq_domain *domain);\n\nvoid irq_domain_free_irqs(unsigned int virq, unsigned int nr_irqs)\n{\n\tstruct irq_data *data = irq_get_irq_data(virq);\n\tint i;\n\n\tif (WARN(!data || !data->domain || !data->domain->ops->free,\n\t\t \"NULL pointer, cannot free irq\\n\"))\n\t\treturn;\n\n\tmutex_lock(&irq_domain_mutex);\n\tfor (i = 0; i < nr_irqs; i++)\n\t\tirq_domain_remove_irq(virq + i);\n\tirq_domain_free_irqs_hierarchy(data->domain, virq, nr_irqs);\n\tmutex_unlock(&irq_domain_mutex);\n\n\tirq_domain_free_irq_data(virq, nr_irqs);\n\tirq_free_descs(virq, nr_irqs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "irq_domain_deactivate_irq",
          "args": [
            "irqd"
          ],
          "line": 975
        },
        "resolved": true,
        "details": {
          "function_name": "irq_domain_deactivate_irq",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/internals.h",
          "lines": "470-473",
          "snippet": "static inline void irq_domain_deactivate_irq(struct irq_data *data)\n{\n\tirqd_clr_activated(data);\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include \"settings.h\"",
            "#include \"debug.h\"",
            "#include <linux/sched/clock.h>",
            "#include <linux/pm_runtime.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/irqdesc.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include \"settings.h\"\n#include \"debug.h\"\n#include <linux/sched/clock.h>\n#include <linux/pm_runtime.h>\n#include <linux/kernel_stat.h>\n#include <linux/irqdesc.h>\n\nstatic inline void irq_domain_deactivate_irq(struct irq_data *data)\n{\n\tirqd_clr_activated(data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "irqd_is_activated",
          "args": [
            "irqd"
          ],
          "line": 974
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_domain_get_irq_data",
          "args": [
            "domain",
            "desc->irq + i"
          ],
          "line": 973
        },
        "resolved": true,
        "details": {
          "function_name": "irq_domain_get_irq_data",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/irqdomain.c",
          "lines": "1835-1841",
          "snippet": "struct irq_data *irq_domain_get_irq_data(struct irq_domain *domain,\n\t\t\t\t\t unsigned int virq)\n{\n\tstruct irq_data *irq_data = irq_get_irq_data(virq);\n\n\treturn (irq_data && irq_data->domain == domain) ? irq_data : NULL;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/smp.h>",
            "#include <linux/slab.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/topology.h>",
            "#include <linux/of_irq.h>",
            "#include <linux/of_address.h>",
            "#include <linux/of.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irqdesc.h>",
            "#include <linux/irq.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/acpi.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void irq_domain_check_hierarchy(struct irq_domain *domain);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/smp.h>\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/topology.h>\n#include <linux/of_irq.h>\n#include <linux/of_address.h>\n#include <linux/of.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/irqdomain.h>\n#include <linux/irqdesc.h>\n#include <linux/irq.h>\n#include <linux/interrupt.h>\n#include <linux/hardirq.h>\n#include <linux/debugfs.h>\n#include <linux/acpi.h>\n\nstatic void irq_domain_check_hierarchy(struct irq_domain *domain);\n\nstruct irq_data *irq_domain_get_irq_data(struct irq_domain *domain,\n\t\t\t\t\t unsigned int virq)\n{\n\tstruct irq_data *irq_data = irq_get_irq_data(virq);\n\n\treturn (irq_data && irq_data->domain == domain) ? irq_data : NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "msi_for_each_desc",
          "args": [
            "desc",
            "dev",
            "MSI_DESC_ASSOCIATED"
          ],
          "line": 970
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nvoid __msi_domain_free_irqs(struct irq_domain *domain, struct device *dev)\n{\n\tstruct msi_domain_info *info = domain->host_data;\n\tstruct irq_data *irqd;\n\tstruct msi_desc *desc;\n\tint i;\n\n\t/* Only handle MSI entries which have an interrupt associated */\n\tmsi_for_each_desc(desc, dev, MSI_DESC_ASSOCIATED) {\n\t\t/* Make sure all interrupts are deactivated */\n\t\tfor (i = 0; i < desc->nvec_used; i++) {\n\t\t\tirqd = irq_domain_get_irq_data(domain, desc->irq + i);\n\t\t\tif (irqd && irqd_is_activated(irqd))\n\t\t\t\tirq_domain_deactivate_irq(irqd);\n\t\t}\n\n\t\tirq_domain_free_irqs(desc->irq, desc->nvec_used);\n\t\tif (info->flags & MSI_FLAG_DEV_SYSFS)\n\t\t\tmsi_sysfs_remove_desc(dev, desc);\n\t\tdesc->irq = 0;\n\t}\n}"
  },
  {
    "function_name": "msi_domain_alloc_irqs",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "952-960",
    "snippet": "int msi_domain_alloc_irqs(struct irq_domain *domain, struct device *dev, int nvec)\n{\n\tint ret;\n\n\tmsi_lock_descs(dev);\n\tret = msi_domain_alloc_irqs_descs_locked(domain, dev, nvec);\n\tmsi_unlock_descs(dev);\n\treturn ret;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline int msi_sysfs_create_group(struct device *dev);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "msi_unlock_descs",
          "args": [
            "dev"
          ],
          "line": 958
        },
        "resolved": true,
        "details": {
          "function_name": "msi_unlock_descs",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "236-241",
          "snippet": "void msi_unlock_descs(struct device *dev)\n{\n\t/* Invalidate the index wich was cached by the iterator */\n\tdev->msi.data->__iter_idx = MSI_MAX_INDEX;\n\tmutex_unlock(&dev->msi.data->mutex);\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline int msi_sysfs_create_group(struct device *dev);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nvoid msi_unlock_descs(struct device *dev)\n{\n\t/* Invalidate the index wich was cached by the iterator */\n\tdev->msi.data->__iter_idx = MSI_MAX_INDEX;\n\tmutex_unlock(&dev->msi.data->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "msi_domain_alloc_irqs_descs_locked",
          "args": [
            "domain",
            "dev",
            "nvec"
          ],
          "line": 957
        },
        "resolved": true,
        "details": {
          "function_name": "msi_domain_alloc_irqs_descs_locked",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "924-941",
          "snippet": "int msi_domain_alloc_irqs_descs_locked(struct irq_domain *domain, struct device *dev,\n\t\t\t\t       int nvec)\n{\n\tstruct msi_domain_info *info = domain->host_data;\n\tstruct msi_domain_ops *ops = info->ops;\n\tint ret;\n\n\tlockdep_assert_held(&dev->msi.data->mutex);\n\n\tret = msi_domain_add_simple_msi_descs(info, dev, nvec);\n\tif (ret)\n\t\treturn ret;\n\n\tret = ops->domain_alloc_irqs(domain, dev, nvec);\n\tif (ret)\n\t\tmsi_domain_free_irqs_descs_locked(domain, dev);\n\treturn ret;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline int msi_sysfs_create_group(struct device *dev);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nint msi_domain_alloc_irqs_descs_locked(struct irq_domain *domain, struct device *dev,\n\t\t\t\t       int nvec)\n{\n\tstruct msi_domain_info *info = domain->host_data;\n\tstruct msi_domain_ops *ops = info->ops;\n\tint ret;\n\n\tlockdep_assert_held(&dev->msi.data->mutex);\n\n\tret = msi_domain_add_simple_msi_descs(info, dev, nvec);\n\tif (ret)\n\t\treturn ret;\n\n\tret = ops->domain_alloc_irqs(domain, dev, nvec);\n\tif (ret)\n\t\tmsi_domain_free_irqs_descs_locked(domain, dev);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "msi_lock_descs",
          "args": [
            "dev"
          ],
          "line": 956
        },
        "resolved": true,
        "details": {
          "function_name": "msi_lock_descs",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "226-229",
          "snippet": "void msi_lock_descs(struct device *dev)\n{\n\tmutex_lock(&dev->msi.data->mutex);\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline int msi_sysfs_create_group(struct device *dev);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nvoid msi_lock_descs(struct device *dev)\n{\n\tmutex_lock(&dev->msi.data->mutex);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nint msi_domain_alloc_irqs(struct irq_domain *domain, struct device *dev, int nvec)\n{\n\tint ret;\n\n\tmsi_lock_descs(dev);\n\tret = msi_domain_alloc_irqs_descs_locked(domain, dev, nvec);\n\tmsi_unlock_descs(dev);\n\treturn ret;\n}"
  },
  {
    "function_name": "msi_domain_alloc_irqs_descs_locked",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "924-941",
    "snippet": "int msi_domain_alloc_irqs_descs_locked(struct irq_domain *domain, struct device *dev,\n\t\t\t\t       int nvec)\n{\n\tstruct msi_domain_info *info = domain->host_data;\n\tstruct msi_domain_ops *ops = info->ops;\n\tint ret;\n\n\tlockdep_assert_held(&dev->msi.data->mutex);\n\n\tret = msi_domain_add_simple_msi_descs(info, dev, nvec);\n\tif (ret)\n\t\treturn ret;\n\n\tret = ops->domain_alloc_irqs(domain, dev, nvec);\n\tif (ret)\n\t\tmsi_domain_free_irqs_descs_locked(domain, dev);\n\treturn ret;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline int msi_sysfs_create_group(struct device *dev);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "msi_domain_free_irqs_descs_locked",
          "args": [
            "domain",
            "dev"
          ],
          "line": 939
        },
        "resolved": true,
        "details": {
          "function_name": "msi_domain_free_irqs_descs_locked",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "1002-1011",
          "snippet": "void msi_domain_free_irqs_descs_locked(struct irq_domain *domain, struct device *dev)\n{\n\tstruct msi_domain_info *info = domain->host_data;\n\tstruct msi_domain_ops *ops = info->ops;\n\n\tlockdep_assert_held(&dev->msi.data->mutex);\n\n\tops->domain_free_irqs(domain, dev);\n\tmsi_domain_free_msi_descs(info, dev);\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline int msi_sysfs_create_group(struct device *dev);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nvoid msi_domain_free_irqs_descs_locked(struct irq_domain *domain, struct device *dev)\n{\n\tstruct msi_domain_info *info = domain->host_data;\n\tstruct msi_domain_ops *ops = info->ops;\n\n\tlockdep_assert_held(&dev->msi.data->mutex);\n\n\tops->domain_free_irqs(domain, dev);\n\tmsi_domain_free_msi_descs(info, dev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ops->domain_alloc_irqs",
          "args": [
            "domain",
            "dev",
            "nvec"
          ],
          "line": 937
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "msi_domain_add_simple_msi_descs",
          "args": [
            "info",
            "dev",
            "nvec"
          ],
          "line": 933
        },
        "resolved": true,
        "details": {
          "function_name": "msi_domain_add_simple_msi_descs",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "901-909",
          "snippet": "static int msi_domain_add_simple_msi_descs(struct msi_domain_info *info,\n\t\t\t\t\t   struct device *dev,\n\t\t\t\t\t   unsigned int num_descs)\n{\n\tif (!(info->flags & MSI_FLAG_ALLOC_SIMPLE_MSI_DESCS))\n\t\treturn 0;\n\n\treturn msi_add_simple_msi_descs(dev, 0, num_descs);\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline int msi_sysfs_create_group(struct device *dev);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nstatic int msi_domain_add_simple_msi_descs(struct msi_domain_info *info,\n\t\t\t\t\t   struct device *dev,\n\t\t\t\t\t   unsigned int num_descs)\n{\n\tif (!(info->flags & MSI_FLAG_ALLOC_SIMPLE_MSI_DESCS))\n\t\treturn 0;\n\n\treturn msi_add_simple_msi_descs(dev, 0, num_descs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "lockdep_assert_held",
          "args": [
            "&dev->msi.data->mutex"
          ],
          "line": 931
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nint msi_domain_alloc_irqs_descs_locked(struct irq_domain *domain, struct device *dev,\n\t\t\t\t       int nvec)\n{\n\tstruct msi_domain_info *info = domain->host_data;\n\tstruct msi_domain_ops *ops = info->ops;\n\tint ret;\n\n\tlockdep_assert_held(&dev->msi.data->mutex);\n\n\tret = msi_domain_add_simple_msi_descs(info, dev, nvec);\n\tif (ret)\n\t\treturn ret;\n\n\tret = ops->domain_alloc_irqs(domain, dev, nvec);\n\tif (ret)\n\t\tmsi_domain_free_irqs_descs_locked(domain, dev);\n\treturn ret;\n}"
  },
  {
    "function_name": "msi_domain_add_simple_msi_descs",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "901-909",
    "snippet": "static int msi_domain_add_simple_msi_descs(struct msi_domain_info *info,\n\t\t\t\t\t   struct device *dev,\n\t\t\t\t\t   unsigned int num_descs)\n{\n\tif (!(info->flags & MSI_FLAG_ALLOC_SIMPLE_MSI_DESCS))\n\t\treturn 0;\n\n\treturn msi_add_simple_msi_descs(dev, 0, num_descs);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline int msi_sysfs_create_group(struct device *dev);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "msi_add_simple_msi_descs",
          "args": [
            "dev",
            "0",
            "num_descs"
          ],
          "line": 908
        },
        "resolved": true,
        "details": {
          "function_name": "msi_add_simple_msi_descs",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "102-125",
          "snippet": "static int msi_add_simple_msi_descs(struct device *dev, unsigned int index, unsigned int ndesc)\n{\n\tunsigned int idx, last = index + ndesc - 1;\n\tstruct msi_desc *desc;\n\tint ret;\n\n\tlockdep_assert_held(&dev->msi.data->mutex);\n\n\tfor (idx = index; idx <= last; idx++) {\n\t\tdesc = msi_alloc_desc(dev, 1, NULL);\n\t\tif (!desc)\n\t\t\tgoto fail_mem;\n\t\tret = msi_insert_desc(dev->msi.data, desc, idx);\n\t\tif (ret)\n\t\t\tgoto fail;\n\t}\n\treturn 0;\n\nfail_mem:\n\tret = -ENOMEM;\nfail:\n\tmsi_free_msi_descs_range(dev, MSI_DESC_NOTASSOCIATED, index, last);\n\treturn ret;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline int msi_sysfs_create_group(struct device *dev);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nstatic int msi_add_simple_msi_descs(struct device *dev, unsigned int index, unsigned int ndesc)\n{\n\tunsigned int idx, last = index + ndesc - 1;\n\tstruct msi_desc *desc;\n\tint ret;\n\n\tlockdep_assert_held(&dev->msi.data->mutex);\n\n\tfor (idx = index; idx <= last; idx++) {\n\t\tdesc = msi_alloc_desc(dev, 1, NULL);\n\t\tif (!desc)\n\t\t\tgoto fail_mem;\n\t\tret = msi_insert_desc(dev->msi.data, desc, idx);\n\t\tif (ret)\n\t\t\tgoto fail;\n\t}\n\treturn 0;\n\nfail_mem:\n\tret = -ENOMEM;\nfail:\n\tmsi_free_msi_descs_range(dev, MSI_DESC_NOTASSOCIATED, index, last);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nstatic int msi_domain_add_simple_msi_descs(struct msi_domain_info *info,\n\t\t\t\t\t   struct device *dev,\n\t\t\t\t\t   unsigned int num_descs)\n{\n\tif (!(info->flags & MSI_FLAG_ALLOC_SIMPLE_MSI_DESCS))\n\t\treturn 0;\n\n\treturn msi_add_simple_msi_descs(dev, 0, num_descs);\n}"
  },
  {
    "function_name": "__msi_domain_alloc_irqs",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "838-899",
    "snippet": "int __msi_domain_alloc_irqs(struct irq_domain *domain, struct device *dev,\n\t\t\t    int nvec)\n{\n\tstruct msi_domain_info *info = domain->host_data;\n\tstruct msi_domain_ops *ops = info->ops;\n\tmsi_alloc_info_t arg = { };\n\tunsigned int vflags = 0;\n\tstruct msi_desc *desc;\n\tint allocated = 0;\n\tint i, ret, virq;\n\n\tret = msi_domain_prepare_irqs(domain, dev, nvec, &arg);\n\tif (ret)\n\t\treturn ret;\n\n\t/*\n\t * This flag is set by the PCI layer as we need to activate\n\t * the MSI entries before the PCI layer enables MSI in the\n\t * card. Otherwise the card latches a random msi message.\n\t */\n\tif (info->flags & MSI_FLAG_ACTIVATE_EARLY)\n\t\tvflags |= VIRQ_ACTIVATE;\n\n\t/*\n\t * Interrupt can use a reserved vector and will not occupy\n\t * a real device vector until the interrupt is requested.\n\t */\n\tif (msi_check_reservation_mode(domain, info, dev)) {\n\t\tvflags |= VIRQ_CAN_RESERVE;\n\t\t/*\n\t\t * MSI affinity setting requires a special quirk (X86) when\n\t\t * reservation mode is active.\n\t\t */\n\t\tif (domain->flags & IRQ_DOMAIN_MSI_NOMASK_QUIRK)\n\t\t\tvflags |= VIRQ_NOMASK_QUIRK;\n\t}\n\n\tmsi_for_each_desc(desc, dev, MSI_DESC_NOTASSOCIATED) {\n\t\tops->set_desc(&arg, desc);\n\n\t\tvirq = __irq_domain_alloc_irqs(domain, -1, desc->nvec_used,\n\t\t\t\t\t       dev_to_node(dev), &arg, false,\n\t\t\t\t\t       desc->affinity);\n\t\tif (virq < 0)\n\t\t\treturn msi_handle_pci_fail(domain, desc, allocated);\n\n\t\tfor (i = 0; i < desc->nvec_used; i++) {\n\t\t\tirq_set_msi_desc_off(virq, i, desc);\n\t\t\tirq_debugfs_copy_devname(virq + i, dev);\n\t\t\tret = msi_init_virq(domain, virq + i, vflags);\n\t\t\tif (ret)\n\t\t\t\treturn ret;\n\t\t}\n\t\tif (info->flags & MSI_FLAG_DEV_SYSFS) {\n\t\t\tret = msi_sysfs_populate_desc(dev, desc);\n\t\t\tif (ret)\n\t\t\t\treturn ret;\n\t\t}\n\t\tallocated++;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [
      "#define VIRQ_NOMASK_QUIRK\t0x04",
      "#define VIRQ_ACTIVATE\t\t0x02",
      "#define VIRQ_CAN_RESERVE\t0x01"
    ],
    "globals_used": [
      "static inline int msi_sysfs_create_group(struct device *dev);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "msi_sysfs_populate_desc",
          "args": [
            "dev",
            "desc"
          ],
          "line": 892
        },
        "resolved": true,
        "details": {
          "function_name": "msi_sysfs_populate_desc",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "458-458",
          "snippet": "static inline int msi_sysfs_populate_desc(struct device *dev, struct msi_desc *desc) { return 0; }",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline int msi_sysfs_create_group(struct device *dev);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nstatic inline int msi_sysfs_populate_desc(struct device *dev, struct msi_desc *desc) { return 0; }"
        }
      },
      {
        "call_info": {
          "callee": "msi_init_virq",
          "args": [
            "domain",
            "virq + i",
            "vflags"
          ],
          "line": 887
        },
        "resolved": true,
        "details": {
          "function_name": "msi_init_virq",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "812-836",
          "snippet": "static int msi_init_virq(struct irq_domain *domain, int virq, unsigned int vflags)\n{\n\tstruct irq_data *irqd = irq_domain_get_irq_data(domain, virq);\n\tint ret;\n\n\tif (!(vflags & VIRQ_CAN_RESERVE)) {\n\t\tirqd_clr_can_reserve(irqd);\n\t\tif (vflags & VIRQ_NOMASK_QUIRK)\n\t\t\tirqd_set_msi_nomask_quirk(irqd);\n\t}\n\n\tif (!(vflags & VIRQ_ACTIVATE))\n\t\treturn 0;\n\n\tret = irq_domain_activate_irq(irqd, vflags & VIRQ_CAN_RESERVE);\n\tif (ret)\n\t\treturn ret;\n\t/*\n\t * If the interrupt uses reservation mode, clear the activated bit\n\t * so request_irq() will assign the final vector.\n\t */\n\tif (vflags & VIRQ_CAN_RESERVE)\n\t\tirqd_clr_activated(irqd);\n\treturn 0;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [
            "#define VIRQ_NOMASK_QUIRK\t0x04",
            "#define VIRQ_ACTIVATE\t\t0x02",
            "#define VIRQ_CAN_RESERVE\t0x01"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\n#define VIRQ_NOMASK_QUIRK\t0x04\n#define VIRQ_ACTIVATE\t\t0x02\n#define VIRQ_CAN_RESERVE\t0x01\n\nstatic int msi_init_virq(struct irq_domain *domain, int virq, unsigned int vflags)\n{\n\tstruct irq_data *irqd = irq_domain_get_irq_data(domain, virq);\n\tint ret;\n\n\tif (!(vflags & VIRQ_CAN_RESERVE)) {\n\t\tirqd_clr_can_reserve(irqd);\n\t\tif (vflags & VIRQ_NOMASK_QUIRK)\n\t\t\tirqd_set_msi_nomask_quirk(irqd);\n\t}\n\n\tif (!(vflags & VIRQ_ACTIVATE))\n\t\treturn 0;\n\n\tret = irq_domain_activate_irq(irqd, vflags & VIRQ_CAN_RESERVE);\n\tif (ret)\n\t\treturn ret;\n\t/*\n\t * If the interrupt uses reservation mode, clear the activated bit\n\t * so request_irq() will assign the final vector.\n\t */\n\tif (vflags & VIRQ_CAN_RESERVE)\n\t\tirqd_clr_activated(irqd);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "irq_debugfs_copy_devname",
          "args": [
            "virq + i",
            "dev"
          ],
          "line": 886
        },
        "resolved": true,
        "details": {
          "function_name": "irq_debugfs_copy_devname",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/internals.h",
          "lines": "509-511",
          "snippet": "static inline void irq_debugfs_copy_devname(int irq, struct device *dev)\n{\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include \"settings.h\"",
            "#include \"debug.h\"",
            "#include <linux/sched/clock.h>",
            "#include <linux/pm_runtime.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/irqdesc.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern bool irq_can_set_affinity_usr(unsigned int irq);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include \"settings.h\"\n#include \"debug.h\"\n#include <linux/sched/clock.h>\n#include <linux/pm_runtime.h>\n#include <linux/kernel_stat.h>\n#include <linux/irqdesc.h>\n\nextern bool irq_can_set_affinity_usr(unsigned int irq);\n\nstatic inline void irq_debugfs_copy_devname(int irq, struct device *dev)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "irq_set_msi_desc_off",
          "args": [
            "virq",
            "i",
            "desc"
          ],
          "line": 885
        },
        "resolved": true,
        "details": {
          "function_name": "irq_set_msi_desc_off",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/chip.c",
          "lines": "111-124",
          "snippet": "int irq_set_msi_desc_off(unsigned int irq_base, unsigned int irq_offset,\n\t\t\t struct msi_desc *entry)\n{\n\tunsigned long flags;\n\tstruct irq_desc *desc = irq_get_desc_lock(irq_base + irq_offset, &flags, IRQ_GET_DESC_CHECK_GLOBAL);\n\n\tif (!desc)\n\t\treturn -EINVAL;\n\tdesc->irq_common_data.msi_desc = entry;\n\tif (entry && !irq_offset)\n\t\tentry->irq = irq_base;\n\tirq_put_desc_unlock(desc, flags);\n\treturn 0;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <trace/events/irq.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/module.h>",
            "#include <linux/msi.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <trace/events/irq.h>\n#include <linux/irqdomain.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/module.h>\n#include <linux/msi.h>\n#include <linux/irq.h>\n\nint irq_set_msi_desc_off(unsigned int irq_base, unsigned int irq_offset,\n\t\t\t struct msi_desc *entry)\n{\n\tunsigned long flags;\n\tstruct irq_desc *desc = irq_get_desc_lock(irq_base + irq_offset, &flags, IRQ_GET_DESC_CHECK_GLOBAL);\n\n\tif (!desc)\n\t\treturn -EINVAL;\n\tdesc->irq_common_data.msi_desc = entry;\n\tif (entry && !irq_offset)\n\t\tentry->irq = irq_base;\n\tirq_put_desc_unlock(desc, flags);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "msi_handle_pci_fail",
          "args": [
            "domain",
            "desc",
            "allocated"
          ],
          "line": 882
        },
        "resolved": true,
        "details": {
          "function_name": "msi_handle_pci_fail",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "787-806",
          "snippet": "static int msi_handle_pci_fail(struct irq_domain *domain, struct msi_desc *desc,\n\t\t\t       int allocated)\n{\n\tswitch(domain->bus_token) {\n\tcase DOMAIN_BUS_PCI_MSI:\n\tcase DOMAIN_BUS_VMD_MSI:\n\t\tif (IS_ENABLED(CONFIG_PCI_MSI))\n\t\t\tbreak;\n\t\tfallthrough;\n\tdefault:\n\t\treturn -ENOSPC;\n\t}\n\n\t/* Let a failed PCI multi MSI allocation retry */\n\tif (desc->nvec_used > 1)\n\t\treturn 1;\n\n\t/* If there was a successful allocation let the caller know */\n\treturn allocated ? allocated : -ENOSPC;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic int msi_handle_pci_fail(struct irq_domain *domain, struct msi_desc *desc,\n\t\t\t       int allocated)\n{\n\tswitch(domain->bus_token) {\n\tcase DOMAIN_BUS_PCI_MSI:\n\tcase DOMAIN_BUS_VMD_MSI:\n\t\tif (IS_ENABLED(CONFIG_PCI_MSI))\n\t\t\tbreak;\n\t\tfallthrough;\n\tdefault:\n\t\treturn -ENOSPC;\n\t}\n\n\t/* Let a failed PCI multi MSI allocation retry */\n\tif (desc->nvec_used > 1)\n\t\treturn 1;\n\n\t/* If there was a successful allocation let the caller know */\n\treturn allocated ? allocated : -ENOSPC;\n}"
        }
      },
      {
        "call_info": {
          "callee": "__irq_domain_alloc_irqs",
          "args": [
            "domain",
            "-1",
            "desc->nvec_used",
            "dev_to_node(dev)",
            "&arg",
            "false",
            "desc->affinity"
          ],
          "line": 878
        },
        "resolved": true,
        "details": {
          "function_name": "__irq_domain_alloc_irqs",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/irqdomain.c",
          "lines": "1448-1504",
          "snippet": "int __irq_domain_alloc_irqs(struct irq_domain *domain, int irq_base,\n\t\t\t    unsigned int nr_irqs, int node, void *arg,\n\t\t\t    bool realloc, const struct irq_affinity_desc *affinity)\n{\n\tint i, ret, virq;\n\n\tif (domain == NULL) {\n\t\tdomain = irq_default_domain;\n\t\tif (WARN(!domain, \"domain is NULL; cannot allocate IRQ\\n\"))\n\t\t\treturn -EINVAL;\n\t}\n\n\tif (realloc && irq_base >= 0) {\n\t\tvirq = irq_base;\n\t} else {\n\t\tvirq = irq_domain_alloc_descs(irq_base, nr_irqs, 0, node,\n\t\t\t\t\t      affinity);\n\t\tif (virq < 0) {\n\t\t\tpr_debug(\"cannot allocate IRQ(base %d, count %d)\\n\",\n\t\t\t\t irq_base, nr_irqs);\n\t\t\treturn virq;\n\t\t}\n\t}\n\n\tif (irq_domain_alloc_irq_data(domain, virq, nr_irqs)) {\n\t\tpr_debug(\"cannot allocate memory for IRQ%d\\n\", virq);\n\t\tret = -ENOMEM;\n\t\tgoto out_free_desc;\n\t}\n\n\tmutex_lock(&irq_domain_mutex);\n\tret = irq_domain_alloc_irqs_hierarchy(domain, virq, nr_irqs, arg);\n\tif (ret < 0) {\n\t\tmutex_unlock(&irq_domain_mutex);\n\t\tgoto out_free_irq_data;\n\t}\n\n\tfor (i = 0; i < nr_irqs; i++) {\n\t\tret = irq_domain_trim_hierarchy(virq + i);\n\t\tif (ret) {\n\t\t\tmutex_unlock(&irq_domain_mutex);\n\t\t\tgoto out_free_irq_data;\n\t\t}\n\t}\n\t\n\tfor (i = 0; i < nr_irqs; i++)\n\t\tirq_domain_insert_irq(virq + i);\n\tmutex_unlock(&irq_domain_mutex);\n\n\treturn virq;\n\nout_free_irq_data:\n\tirq_domain_free_irq_data(virq, nr_irqs);\nout_free_desc:\n\tirq_free_descs(virq, nr_irqs);\n\treturn ret;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/smp.h>",
            "#include <linux/slab.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/topology.h>",
            "#include <linux/of_irq.h>",
            "#include <linux/of_address.h>",
            "#include <linux/of.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irqdesc.h>",
            "#include <linux/irq.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/acpi.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_MUTEX(irq_domain_mutex);",
            "static struct irq_domain *irq_default_domain;",
            "static void irq_domain_check_hierarchy(struct irq_domain *domain);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/smp.h>\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/topology.h>\n#include <linux/of_irq.h>\n#include <linux/of_address.h>\n#include <linux/of.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/irqdomain.h>\n#include <linux/irqdesc.h>\n#include <linux/irq.h>\n#include <linux/interrupt.h>\n#include <linux/hardirq.h>\n#include <linux/debugfs.h>\n#include <linux/acpi.h>\n\nstatic DEFINE_MUTEX(irq_domain_mutex);\nstatic struct irq_domain *irq_default_domain;\nstatic void irq_domain_check_hierarchy(struct irq_domain *domain);\n\nint __irq_domain_alloc_irqs(struct irq_domain *domain, int irq_base,\n\t\t\t    unsigned int nr_irqs, int node, void *arg,\n\t\t\t    bool realloc, const struct irq_affinity_desc *affinity)\n{\n\tint i, ret, virq;\n\n\tif (domain == NULL) {\n\t\tdomain = irq_default_domain;\n\t\tif (WARN(!domain, \"domain is NULL; cannot allocate IRQ\\n\"))\n\t\t\treturn -EINVAL;\n\t}\n\n\tif (realloc && irq_base >= 0) {\n\t\tvirq = irq_base;\n\t} else {\n\t\tvirq = irq_domain_alloc_descs(irq_base, nr_irqs, 0, node,\n\t\t\t\t\t      affinity);\n\t\tif (virq < 0) {\n\t\t\tpr_debug(\"cannot allocate IRQ(base %d, count %d)\\n\",\n\t\t\t\t irq_base, nr_irqs);\n\t\t\treturn virq;\n\t\t}\n\t}\n\n\tif (irq_domain_alloc_irq_data(domain, virq, nr_irqs)) {\n\t\tpr_debug(\"cannot allocate memory for IRQ%d\\n\", virq);\n\t\tret = -ENOMEM;\n\t\tgoto out_free_desc;\n\t}\n\n\tmutex_lock(&irq_domain_mutex);\n\tret = irq_domain_alloc_irqs_hierarchy(domain, virq, nr_irqs, arg);\n\tif (ret < 0) {\n\t\tmutex_unlock(&irq_domain_mutex);\n\t\tgoto out_free_irq_data;\n\t}\n\n\tfor (i = 0; i < nr_irqs; i++) {\n\t\tret = irq_domain_trim_hierarchy(virq + i);\n\t\tif (ret) {\n\t\t\tmutex_unlock(&irq_domain_mutex);\n\t\t\tgoto out_free_irq_data;\n\t\t}\n\t}\n\t\n\tfor (i = 0; i < nr_irqs; i++)\n\t\tirq_domain_insert_irq(virq + i);\n\tmutex_unlock(&irq_domain_mutex);\n\n\treturn virq;\n\nout_free_irq_data:\n\tirq_domain_free_irq_data(virq, nr_irqs);\nout_free_desc:\n\tirq_free_descs(virq, nr_irqs);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dev_to_node",
          "args": [
            "dev"
          ],
          "line": 879
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ops->set_desc",
          "args": [
            "&arg",
            "desc"
          ],
          "line": 876
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "msi_for_each_desc",
          "args": [
            "desc",
            "dev",
            "MSI_DESC_NOTASSOCIATED"
          ],
          "line": 875
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "msi_check_reservation_mode",
          "args": [
            "domain",
            "info",
            "dev"
          ],
          "line": 865
        },
        "resolved": true,
        "details": {
          "function_name": "msi_check_reservation_mode",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "759-785",
          "snippet": "static bool msi_check_reservation_mode(struct irq_domain *domain,\n\t\t\t\t       struct msi_domain_info *info,\n\t\t\t\t       struct device *dev)\n{\n\tstruct msi_desc *desc;\n\n\tswitch(domain->bus_token) {\n\tcase DOMAIN_BUS_PCI_MSI:\n\tcase DOMAIN_BUS_VMD_MSI:\n\t\tbreak;\n\tdefault:\n\t\treturn false;\n\t}\n\n\tif (!(info->flags & MSI_FLAG_MUST_REACTIVATE))\n\t\treturn false;\n\n\tif (IS_ENABLED(CONFIG_PCI_MSI) && pci_msi_ignore_mask)\n\t\treturn false;\n\n\t/*\n\t * Checking the first MSI descriptor is sufficient. MSIX supports\n\t * masking and MSI does so when the can_mask attribute is set.\n\t */\n\tdesc = msi_first_desc(dev, MSI_DESC_ALL);\n\treturn desc->pci.msi_attrib.is_msix || desc->pci.msi_attrib.can_mask;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline int msi_sysfs_create_group(struct device *dev);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nstatic bool msi_check_reservation_mode(struct irq_domain *domain,\n\t\t\t\t       struct msi_domain_info *info,\n\t\t\t\t       struct device *dev)\n{\n\tstruct msi_desc *desc;\n\n\tswitch(domain->bus_token) {\n\tcase DOMAIN_BUS_PCI_MSI:\n\tcase DOMAIN_BUS_VMD_MSI:\n\t\tbreak;\n\tdefault:\n\t\treturn false;\n\t}\n\n\tif (!(info->flags & MSI_FLAG_MUST_REACTIVATE))\n\t\treturn false;\n\n\tif (IS_ENABLED(CONFIG_PCI_MSI) && pci_msi_ignore_mask)\n\t\treturn false;\n\n\t/*\n\t * Checking the first MSI descriptor is sufficient. MSIX supports\n\t * masking and MSI does so when the can_mask attribute is set.\n\t */\n\tdesc = msi_first_desc(dev, MSI_DESC_ALL);\n\treturn desc->pci.msi_attrib.is_msix || desc->pci.msi_attrib.can_mask;\n}"
        }
      },
      {
        "call_info": {
          "callee": "msi_domain_prepare_irqs",
          "args": [
            "domain",
            "dev",
            "nvec",
            "&arg"
          ],
          "line": 849
        },
        "resolved": true,
        "details": {
          "function_name": "msi_domain_prepare_irqs",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "698-710",
          "snippet": "int msi_domain_prepare_irqs(struct irq_domain *domain, struct device *dev,\n\t\t\t    int nvec, msi_alloc_info_t *arg)\n{\n\tstruct msi_domain_info *info = domain->host_data;\n\tstruct msi_domain_ops *ops = info->ops;\n\tint ret;\n\n\tret = ops->msi_check(domain, info, dev);\n\tif (ret == 0)\n\t\tret = ops->msi_prepare(domain, dev, nvec, arg);\n\n\treturn ret;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline int msi_sysfs_create_group(struct device *dev);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nint msi_domain_prepare_irqs(struct irq_domain *domain, struct device *dev,\n\t\t\t    int nvec, msi_alloc_info_t *arg)\n{\n\tstruct msi_domain_info *info = domain->host_data;\n\tstruct msi_domain_ops *ops = info->ops;\n\tint ret;\n\n\tret = ops->msi_check(domain, info, dev);\n\tif (ret == 0)\n\t\tret = ops->msi_prepare(domain, dev, nvec, arg);\n\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\n#define VIRQ_NOMASK_QUIRK\t0x04\n#define VIRQ_ACTIVATE\t\t0x02\n#define VIRQ_CAN_RESERVE\t0x01\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nint __msi_domain_alloc_irqs(struct irq_domain *domain, struct device *dev,\n\t\t\t    int nvec)\n{\n\tstruct msi_domain_info *info = domain->host_data;\n\tstruct msi_domain_ops *ops = info->ops;\n\tmsi_alloc_info_t arg = { };\n\tunsigned int vflags = 0;\n\tstruct msi_desc *desc;\n\tint allocated = 0;\n\tint i, ret, virq;\n\n\tret = msi_domain_prepare_irqs(domain, dev, nvec, &arg);\n\tif (ret)\n\t\treturn ret;\n\n\t/*\n\t * This flag is set by the PCI layer as we need to activate\n\t * the MSI entries before the PCI layer enables MSI in the\n\t * card. Otherwise the card latches a random msi message.\n\t */\n\tif (info->flags & MSI_FLAG_ACTIVATE_EARLY)\n\t\tvflags |= VIRQ_ACTIVATE;\n\n\t/*\n\t * Interrupt can use a reserved vector and will not occupy\n\t * a real device vector until the interrupt is requested.\n\t */\n\tif (msi_check_reservation_mode(domain, info, dev)) {\n\t\tvflags |= VIRQ_CAN_RESERVE;\n\t\t/*\n\t\t * MSI affinity setting requires a special quirk (X86) when\n\t\t * reservation mode is active.\n\t\t */\n\t\tif (domain->flags & IRQ_DOMAIN_MSI_NOMASK_QUIRK)\n\t\t\tvflags |= VIRQ_NOMASK_QUIRK;\n\t}\n\n\tmsi_for_each_desc(desc, dev, MSI_DESC_NOTASSOCIATED) {\n\t\tops->set_desc(&arg, desc);\n\n\t\tvirq = __irq_domain_alloc_irqs(domain, -1, desc->nvec_used,\n\t\t\t\t\t       dev_to_node(dev), &arg, false,\n\t\t\t\t\t       desc->affinity);\n\t\tif (virq < 0)\n\t\t\treturn msi_handle_pci_fail(domain, desc, allocated);\n\n\t\tfor (i = 0; i < desc->nvec_used; i++) {\n\t\t\tirq_set_msi_desc_off(virq, i, desc);\n\t\t\tirq_debugfs_copy_devname(virq + i, dev);\n\t\t\tret = msi_init_virq(domain, virq + i, vflags);\n\t\t\tif (ret)\n\t\t\t\treturn ret;\n\t\t}\n\t\tif (info->flags & MSI_FLAG_DEV_SYSFS) {\n\t\t\tret = msi_sysfs_populate_desc(dev, desc);\n\t\t\tif (ret)\n\t\t\t\treturn ret;\n\t\t}\n\t\tallocated++;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "msi_init_virq",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "812-836",
    "snippet": "static int msi_init_virq(struct irq_domain *domain, int virq, unsigned int vflags)\n{\n\tstruct irq_data *irqd = irq_domain_get_irq_data(domain, virq);\n\tint ret;\n\n\tif (!(vflags & VIRQ_CAN_RESERVE)) {\n\t\tirqd_clr_can_reserve(irqd);\n\t\tif (vflags & VIRQ_NOMASK_QUIRK)\n\t\t\tirqd_set_msi_nomask_quirk(irqd);\n\t}\n\n\tif (!(vflags & VIRQ_ACTIVATE))\n\t\treturn 0;\n\n\tret = irq_domain_activate_irq(irqd, vflags & VIRQ_CAN_RESERVE);\n\tif (ret)\n\t\treturn ret;\n\t/*\n\t * If the interrupt uses reservation mode, clear the activated bit\n\t * so request_irq() will assign the final vector.\n\t */\n\tif (vflags & VIRQ_CAN_RESERVE)\n\t\tirqd_clr_activated(irqd);\n\treturn 0;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [
      "#define VIRQ_NOMASK_QUIRK\t0x04",
      "#define VIRQ_ACTIVATE\t\t0x02",
      "#define VIRQ_CAN_RESERVE\t0x01"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "irqd_clr_activated",
          "args": [
            "irqd"
          ],
          "line": 834
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_domain_activate_irq",
          "args": [
            "irqd",
            "vflags & VIRQ_CAN_RESERVE"
          ],
          "line": 826
        },
        "resolved": true,
        "details": {
          "function_name": "irq_domain_activate_irq",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/internals.h",
          "lines": "465-469",
          "snippet": "static inline int irq_domain_activate_irq(struct irq_data *data, bool reserve)\n{\n\tirqd_set_activated(data);\n\treturn 0;\n}",
          "includes": [
            "#include <linux/debugfs.h>",
            "#include \"settings.h\"",
            "#include \"debug.h\"",
            "#include <linux/sched/clock.h>",
            "#include <linux/pm_runtime.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/irqdesc.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/debugfs.h>\n#include \"settings.h\"\n#include \"debug.h\"\n#include <linux/sched/clock.h>\n#include <linux/pm_runtime.h>\n#include <linux/kernel_stat.h>\n#include <linux/irqdesc.h>\n\nstatic inline int irq_domain_activate_irq(struct irq_data *data, bool reserve)\n{\n\tirqd_set_activated(data);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "irqd_set_msi_nomask_quirk",
          "args": [
            "irqd"
          ],
          "line": 820
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irqd_clr_can_reserve",
          "args": [
            "irqd"
          ],
          "line": 818
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_domain_get_irq_data",
          "args": [
            "domain",
            "virq"
          ],
          "line": 814
        },
        "resolved": true,
        "details": {
          "function_name": "irq_domain_get_irq_data",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/irqdomain.c",
          "lines": "1835-1841",
          "snippet": "struct irq_data *irq_domain_get_irq_data(struct irq_domain *domain,\n\t\t\t\t\t unsigned int virq)\n{\n\tstruct irq_data *irq_data = irq_get_irq_data(virq);\n\n\treturn (irq_data && irq_data->domain == domain) ? irq_data : NULL;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/smp.h>",
            "#include <linux/slab.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/topology.h>",
            "#include <linux/of_irq.h>",
            "#include <linux/of_address.h>",
            "#include <linux/of.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irqdesc.h>",
            "#include <linux/irq.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/acpi.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void irq_domain_check_hierarchy(struct irq_domain *domain);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/smp.h>\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/topology.h>\n#include <linux/of_irq.h>\n#include <linux/of_address.h>\n#include <linux/of.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/irqdomain.h>\n#include <linux/irqdesc.h>\n#include <linux/irq.h>\n#include <linux/interrupt.h>\n#include <linux/hardirq.h>\n#include <linux/debugfs.h>\n#include <linux/acpi.h>\n\nstatic void irq_domain_check_hierarchy(struct irq_domain *domain);\n\nstruct irq_data *irq_domain_get_irq_data(struct irq_domain *domain,\n\t\t\t\t\t unsigned int virq)\n{\n\tstruct irq_data *irq_data = irq_get_irq_data(virq);\n\n\treturn (irq_data && irq_data->domain == domain) ? irq_data : NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\n#define VIRQ_NOMASK_QUIRK\t0x04\n#define VIRQ_ACTIVATE\t\t0x02\n#define VIRQ_CAN_RESERVE\t0x01\n\nstatic int msi_init_virq(struct irq_domain *domain, int virq, unsigned int vflags)\n{\n\tstruct irq_data *irqd = irq_domain_get_irq_data(domain, virq);\n\tint ret;\n\n\tif (!(vflags & VIRQ_CAN_RESERVE)) {\n\t\tirqd_clr_can_reserve(irqd);\n\t\tif (vflags & VIRQ_NOMASK_QUIRK)\n\t\t\tirqd_set_msi_nomask_quirk(irqd);\n\t}\n\n\tif (!(vflags & VIRQ_ACTIVATE))\n\t\treturn 0;\n\n\tret = irq_domain_activate_irq(irqd, vflags & VIRQ_CAN_RESERVE);\n\tif (ret)\n\t\treturn ret;\n\t/*\n\t * If the interrupt uses reservation mode, clear the activated bit\n\t * so request_irq() will assign the final vector.\n\t */\n\tif (vflags & VIRQ_CAN_RESERVE)\n\t\tirqd_clr_activated(irqd);\n\treturn 0;\n}"
  },
  {
    "function_name": "msi_handle_pci_fail",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "787-806",
    "snippet": "static int msi_handle_pci_fail(struct irq_domain *domain, struct msi_desc *desc,\n\t\t\t       int allocated)\n{\n\tswitch(domain->bus_token) {\n\tcase DOMAIN_BUS_PCI_MSI:\n\tcase DOMAIN_BUS_VMD_MSI:\n\t\tif (IS_ENABLED(CONFIG_PCI_MSI))\n\t\t\tbreak;\n\t\tfallthrough;\n\tdefault:\n\t\treturn -ENOSPC;\n\t}\n\n\t/* Let a failed PCI multi MSI allocation retry */\n\tif (desc->nvec_used > 1)\n\t\treturn 1;\n\n\t/* If there was a successful allocation let the caller know */\n\treturn allocated ? allocated : -ENOSPC;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_PCI_MSI"
          ],
          "line": 793
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic int msi_handle_pci_fail(struct irq_domain *domain, struct msi_desc *desc,\n\t\t\t       int allocated)\n{\n\tswitch(domain->bus_token) {\n\tcase DOMAIN_BUS_PCI_MSI:\n\tcase DOMAIN_BUS_VMD_MSI:\n\t\tif (IS_ENABLED(CONFIG_PCI_MSI))\n\t\t\tbreak;\n\t\tfallthrough;\n\tdefault:\n\t\treturn -ENOSPC;\n\t}\n\n\t/* Let a failed PCI multi MSI allocation retry */\n\tif (desc->nvec_used > 1)\n\t\treturn 1;\n\n\t/* If there was a successful allocation let the caller know */\n\treturn allocated ? allocated : -ENOSPC;\n}"
  },
  {
    "function_name": "msi_check_reservation_mode",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "759-785",
    "snippet": "static bool msi_check_reservation_mode(struct irq_domain *domain,\n\t\t\t\t       struct msi_domain_info *info,\n\t\t\t\t       struct device *dev)\n{\n\tstruct msi_desc *desc;\n\n\tswitch(domain->bus_token) {\n\tcase DOMAIN_BUS_PCI_MSI:\n\tcase DOMAIN_BUS_VMD_MSI:\n\t\tbreak;\n\tdefault:\n\t\treturn false;\n\t}\n\n\tif (!(info->flags & MSI_FLAG_MUST_REACTIVATE))\n\t\treturn false;\n\n\tif (IS_ENABLED(CONFIG_PCI_MSI) && pci_msi_ignore_mask)\n\t\treturn false;\n\n\t/*\n\t * Checking the first MSI descriptor is sufficient. MSIX supports\n\t * masking and MSI does so when the can_mask attribute is set.\n\t */\n\tdesc = msi_first_desc(dev, MSI_DESC_ALL);\n\treturn desc->pci.msi_attrib.is_msix || desc->pci.msi_attrib.can_mask;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline int msi_sysfs_create_group(struct device *dev);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "msi_first_desc",
          "args": [
            "dev",
            "MSI_DESC_ALL"
          ],
          "line": 783
        },
        "resolved": true,
        "details": {
          "function_name": "msi_first_desc",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "267-278",
          "snippet": "struct msi_desc *msi_first_desc(struct device *dev, enum msi_desc_filter filter)\n{\n\tstruct msi_device_data *md = dev->msi.data;\n\n\tif (WARN_ON_ONCE(!md))\n\t\treturn NULL;\n\n\tlockdep_assert_held(&md->mutex);\n\n\tmd->__iter_idx = 0;\n\treturn msi_find_desc(md, filter);\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline int msi_sysfs_create_group(struct device *dev);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nstruct msi_desc *msi_first_desc(struct device *dev, enum msi_desc_filter filter)\n{\n\tstruct msi_device_data *md = dev->msi.data;\n\n\tif (WARN_ON_ONCE(!md))\n\t\treturn NULL;\n\n\tlockdep_assert_held(&md->mutex);\n\n\tmd->__iter_idx = 0;\n\treturn msi_find_desc(md, filter);\n}"
        }
      },
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_PCI_MSI"
          ],
          "line": 776
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nstatic bool msi_check_reservation_mode(struct irq_domain *domain,\n\t\t\t\t       struct msi_domain_info *info,\n\t\t\t\t       struct device *dev)\n{\n\tstruct msi_desc *desc;\n\n\tswitch(domain->bus_token) {\n\tcase DOMAIN_BUS_PCI_MSI:\n\tcase DOMAIN_BUS_VMD_MSI:\n\t\tbreak;\n\tdefault:\n\t\treturn false;\n\t}\n\n\tif (!(info->flags & MSI_FLAG_MUST_REACTIVATE))\n\t\treturn false;\n\n\tif (IS_ENABLED(CONFIG_PCI_MSI) && pci_msi_ignore_mask)\n\t\treturn false;\n\n\t/*\n\t * Checking the first MSI descriptor is sufficient. MSIX supports\n\t * masking and MSI does so when the can_mask attribute is set.\n\t */\n\tdesc = msi_first_desc(dev, MSI_DESC_ALL);\n\treturn desc->pci.msi_attrib.is_msix || desc->pci.msi_attrib.can_mask;\n}"
  },
  {
    "function_name": "msi_domain_populate_irqs",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "712-746",
    "snippet": "int msi_domain_populate_irqs(struct irq_domain *domain, struct device *dev,\n\t\t\t     int virq_base, int nvec, msi_alloc_info_t *arg)\n{\n\tstruct msi_domain_info *info = domain->host_data;\n\tstruct msi_domain_ops *ops = info->ops;\n\tstruct msi_desc *desc;\n\tint ret, virq;\n\n\tmsi_lock_descs(dev);\n\tret = msi_add_simple_msi_descs(dev, virq_base, nvec);\n\tif (ret)\n\t\tgoto unlock;\n\n\tfor (virq = virq_base; virq < virq_base + nvec; virq++) {\n\t\tdesc = xa_load(&dev->msi.data->__store, virq);\n\t\tdesc->irq = virq;\n\n\t\tops->set_desc(arg, desc);\n\t\tret = irq_domain_alloc_irqs_hierarchy(domain, virq, 1, arg);\n\t\tif (ret)\n\t\t\tgoto fail;\n\n\t\tirq_set_msi_desc(virq, desc);\n\t}\n\tmsi_unlock_descs(dev);\n\treturn 0;\n\nfail:\n\tfor (--virq; virq >= virq_base; virq--)\n\t\tirq_domain_free_irqs_common(domain, virq, 1);\n\tmsi_free_msi_descs_range(dev, MSI_DESC_ALL, virq_base, virq_base + nvec - 1);\nunlock:\n\tmsi_unlock_descs(dev);\n\treturn ret;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline int msi_sysfs_create_group(struct device *dev);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "msi_unlock_descs",
          "args": [
            "dev"
          ],
          "line": 744
        },
        "resolved": true,
        "details": {
          "function_name": "msi_unlock_descs",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "236-241",
          "snippet": "void msi_unlock_descs(struct device *dev)\n{\n\t/* Invalidate the index wich was cached by the iterator */\n\tdev->msi.data->__iter_idx = MSI_MAX_INDEX;\n\tmutex_unlock(&dev->msi.data->mutex);\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline int msi_sysfs_create_group(struct device *dev);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nvoid msi_unlock_descs(struct device *dev)\n{\n\t/* Invalidate the index wich was cached by the iterator */\n\tdev->msi.data->__iter_idx = MSI_MAX_INDEX;\n\tmutex_unlock(&dev->msi.data->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "msi_free_msi_descs_range",
          "args": [
            "dev",
            "MSI_DESC_ALL",
            "virq_base",
            "virq_base + nvec - 1"
          ],
          "line": 742
        },
        "resolved": true,
        "details": {
          "function_name": "msi_free_msi_descs_range",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "148-163",
          "snippet": "void msi_free_msi_descs_range(struct device *dev, enum msi_desc_filter filter,\n\t\t\t      unsigned int first_index, unsigned int last_index)\n{\n\tstruct xarray *xa = &dev->msi.data->__store;\n\tstruct msi_desc *desc;\n\tunsigned long idx;\n\n\tlockdep_assert_held(&dev->msi.data->mutex);\n\n\txa_for_each_range(xa, idx, desc, first_index, last_index) {\n\t\tif (msi_desc_match(desc, filter)) {\n\t\t\txa_erase(xa, idx);\n\t\t\tmsi_free_desc(desc);\n\t\t}\n\t}\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline int msi_sysfs_create_group(struct device *dev);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nvoid msi_free_msi_descs_range(struct device *dev, enum msi_desc_filter filter,\n\t\t\t      unsigned int first_index, unsigned int last_index)\n{\n\tstruct xarray *xa = &dev->msi.data->__store;\n\tstruct msi_desc *desc;\n\tunsigned long idx;\n\n\tlockdep_assert_held(&dev->msi.data->mutex);\n\n\txa_for_each_range(xa, idx, desc, first_index, last_index) {\n\t\tif (msi_desc_match(desc, filter)) {\n\t\t\txa_erase(xa, idx);\n\t\t\tmsi_free_desc(desc);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "irq_domain_free_irqs_common",
          "args": [
            "domain",
            "virq",
            "1"
          ],
          "line": 741
        },
        "resolved": true,
        "details": {
          "function_name": "irq_domain_free_irqs_common",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/irqdomain.c",
          "lines": "1366-1378",
          "snippet": "void irq_domain_free_irqs_common(struct irq_domain *domain, unsigned int virq,\n\t\t\t\t unsigned int nr_irqs)\n{\n\tstruct irq_data *irq_data;\n\tint i;\n\n\tfor (i = 0; i < nr_irqs; i++) {\n\t\tirq_data = irq_domain_get_irq_data(domain, virq + i);\n\t\tif (irq_data)\n\t\t\tirq_domain_reset_irq_data(irq_data);\n\t}\n\tirq_domain_free_irqs_parent(domain, virq, nr_irqs);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/smp.h>",
            "#include <linux/slab.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/topology.h>",
            "#include <linux/of_irq.h>",
            "#include <linux/of_address.h>",
            "#include <linux/of.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irqdesc.h>",
            "#include <linux/irq.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/acpi.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void irq_domain_check_hierarchy(struct irq_domain *domain);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/smp.h>\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/topology.h>\n#include <linux/of_irq.h>\n#include <linux/of_address.h>\n#include <linux/of.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/irqdomain.h>\n#include <linux/irqdesc.h>\n#include <linux/irq.h>\n#include <linux/interrupt.h>\n#include <linux/hardirq.h>\n#include <linux/debugfs.h>\n#include <linux/acpi.h>\n\nstatic void irq_domain_check_hierarchy(struct irq_domain *domain);\n\nvoid irq_domain_free_irqs_common(struct irq_domain *domain, unsigned int virq,\n\t\t\t\t unsigned int nr_irqs)\n{\n\tstruct irq_data *irq_data;\n\tint i;\n\n\tfor (i = 0; i < nr_irqs; i++) {\n\t\tirq_data = irq_domain_get_irq_data(domain, virq + i);\n\t\tif (irq_data)\n\t\t\tirq_domain_reset_irq_data(irq_data);\n\t}\n\tirq_domain_free_irqs_parent(domain, virq, nr_irqs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "irq_set_msi_desc",
          "args": [
            "virq",
            "desc"
          ],
          "line": 734
        },
        "resolved": true,
        "details": {
          "function_name": "irq_set_msi_desc",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/chip.c",
          "lines": "133-136",
          "snippet": "int irq_set_msi_desc(unsigned int irq, struct msi_desc *entry)\n{\n\treturn irq_set_msi_desc_off(irq, 0, entry);\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <trace/events/irq.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/module.h>",
            "#include <linux/msi.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <trace/events/irq.h>\n#include <linux/irqdomain.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/module.h>\n#include <linux/msi.h>\n#include <linux/irq.h>\n\nint irq_set_msi_desc(unsigned int irq, struct msi_desc *entry)\n{\n\treturn irq_set_msi_desc_off(irq, 0, entry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "irq_domain_alloc_irqs_hierarchy",
          "args": [
            "domain",
            "virq",
            "1",
            "arg"
          ],
          "line": 730
        },
        "resolved": true,
        "details": {
          "function_name": "irq_domain_alloc_irqs_hierarchy",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/irqdomain.c",
          "lines": "1414-1424",
          "snippet": "int irq_domain_alloc_irqs_hierarchy(struct irq_domain *domain,\n\t\t\t\t    unsigned int irq_base,\n\t\t\t\t    unsigned int nr_irqs, void *arg)\n{\n\tif (!domain->ops->alloc) {\n\t\tpr_debug(\"domain->ops->alloc() is NULL\\n\");\n\t\treturn -ENOSYS;\n\t}\n\n\treturn domain->ops->alloc(domain, irq_base, nr_irqs, arg);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/smp.h>",
            "#include <linux/slab.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/topology.h>",
            "#include <linux/of_irq.h>",
            "#include <linux/of_address.h>",
            "#include <linux/of.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irqdesc.h>",
            "#include <linux/irq.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/acpi.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void irq_domain_check_hierarchy(struct irq_domain *domain);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/smp.h>\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/topology.h>\n#include <linux/of_irq.h>\n#include <linux/of_address.h>\n#include <linux/of.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/irqdomain.h>\n#include <linux/irqdesc.h>\n#include <linux/irq.h>\n#include <linux/interrupt.h>\n#include <linux/hardirq.h>\n#include <linux/debugfs.h>\n#include <linux/acpi.h>\n\nstatic void irq_domain_check_hierarchy(struct irq_domain *domain);\n\nint irq_domain_alloc_irqs_hierarchy(struct irq_domain *domain,\n\t\t\t\t    unsigned int irq_base,\n\t\t\t\t    unsigned int nr_irqs, void *arg)\n{\n\tif (!domain->ops->alloc) {\n\t\tpr_debug(\"domain->ops->alloc() is NULL\\n\");\n\t\treturn -ENOSYS;\n\t}\n\n\treturn domain->ops->alloc(domain, irq_base, nr_irqs, arg);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ops->set_desc",
          "args": [
            "arg",
            "desc"
          ],
          "line": 729
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xa_load",
          "args": [
            "&dev->msi.data->__store",
            "virq"
          ],
          "line": 726
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "msi_add_simple_msi_descs",
          "args": [
            "dev",
            "virq_base",
            "nvec"
          ],
          "line": 721
        },
        "resolved": true,
        "details": {
          "function_name": "msi_add_simple_msi_descs",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "102-125",
          "snippet": "static int msi_add_simple_msi_descs(struct device *dev, unsigned int index, unsigned int ndesc)\n{\n\tunsigned int idx, last = index + ndesc - 1;\n\tstruct msi_desc *desc;\n\tint ret;\n\n\tlockdep_assert_held(&dev->msi.data->mutex);\n\n\tfor (idx = index; idx <= last; idx++) {\n\t\tdesc = msi_alloc_desc(dev, 1, NULL);\n\t\tif (!desc)\n\t\t\tgoto fail_mem;\n\t\tret = msi_insert_desc(dev->msi.data, desc, idx);\n\t\tif (ret)\n\t\t\tgoto fail;\n\t}\n\treturn 0;\n\nfail_mem:\n\tret = -ENOMEM;\nfail:\n\tmsi_free_msi_descs_range(dev, MSI_DESC_NOTASSOCIATED, index, last);\n\treturn ret;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline int msi_sysfs_create_group(struct device *dev);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nstatic int msi_add_simple_msi_descs(struct device *dev, unsigned int index, unsigned int ndesc)\n{\n\tunsigned int idx, last = index + ndesc - 1;\n\tstruct msi_desc *desc;\n\tint ret;\n\n\tlockdep_assert_held(&dev->msi.data->mutex);\n\n\tfor (idx = index; idx <= last; idx++) {\n\t\tdesc = msi_alloc_desc(dev, 1, NULL);\n\t\tif (!desc)\n\t\t\tgoto fail_mem;\n\t\tret = msi_insert_desc(dev->msi.data, desc, idx);\n\t\tif (ret)\n\t\t\tgoto fail;\n\t}\n\treturn 0;\n\nfail_mem:\n\tret = -ENOMEM;\nfail:\n\tmsi_free_msi_descs_range(dev, MSI_DESC_NOTASSOCIATED, index, last);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "msi_lock_descs",
          "args": [
            "dev"
          ],
          "line": 720
        },
        "resolved": true,
        "details": {
          "function_name": "msi_lock_descs",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "226-229",
          "snippet": "void msi_lock_descs(struct device *dev)\n{\n\tmutex_lock(&dev->msi.data->mutex);\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline int msi_sysfs_create_group(struct device *dev);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nvoid msi_lock_descs(struct device *dev)\n{\n\tmutex_lock(&dev->msi.data->mutex);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nint msi_domain_populate_irqs(struct irq_domain *domain, struct device *dev,\n\t\t\t     int virq_base, int nvec, msi_alloc_info_t *arg)\n{\n\tstruct msi_domain_info *info = domain->host_data;\n\tstruct msi_domain_ops *ops = info->ops;\n\tstruct msi_desc *desc;\n\tint ret, virq;\n\n\tmsi_lock_descs(dev);\n\tret = msi_add_simple_msi_descs(dev, virq_base, nvec);\n\tif (ret)\n\t\tgoto unlock;\n\n\tfor (virq = virq_base; virq < virq_base + nvec; virq++) {\n\t\tdesc = xa_load(&dev->msi.data->__store, virq);\n\t\tdesc->irq = virq;\n\n\t\tops->set_desc(arg, desc);\n\t\tret = irq_domain_alloc_irqs_hierarchy(domain, virq, 1, arg);\n\t\tif (ret)\n\t\t\tgoto fail;\n\n\t\tirq_set_msi_desc(virq, desc);\n\t}\n\tmsi_unlock_descs(dev);\n\treturn 0;\n\nfail:\n\tfor (--virq; virq >= virq_base; virq--)\n\t\tirq_domain_free_irqs_common(domain, virq, 1);\n\tmsi_free_msi_descs_range(dev, MSI_DESC_ALL, virq_base, virq_base + nvec - 1);\nunlock:\n\tmsi_unlock_descs(dev);\n\treturn ret;\n}"
  },
  {
    "function_name": "msi_domain_prepare_irqs",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "698-710",
    "snippet": "int msi_domain_prepare_irqs(struct irq_domain *domain, struct device *dev,\n\t\t\t    int nvec, msi_alloc_info_t *arg)\n{\n\tstruct msi_domain_info *info = domain->host_data;\n\tstruct msi_domain_ops *ops = info->ops;\n\tint ret;\n\n\tret = ops->msi_check(domain, info, dev);\n\tif (ret == 0)\n\t\tret = ops->msi_prepare(domain, dev, nvec, arg);\n\n\treturn ret;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline int msi_sysfs_create_group(struct device *dev);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ops->msi_prepare",
          "args": [
            "domain",
            "dev",
            "nvec",
            "arg"
          ],
          "line": 707
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ops->msi_check",
          "args": [
            "domain",
            "info",
            "dev"
          ],
          "line": 705
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nint msi_domain_prepare_irqs(struct irq_domain *domain, struct device *dev,\n\t\t\t    int nvec, msi_alloc_info_t *arg)\n{\n\tstruct msi_domain_info *info = domain->host_data;\n\tstruct msi_domain_ops *ops = info->ops;\n\tint ret;\n\n\tret = ops->msi_check(domain, info, dev);\n\tif (ret == 0)\n\t\tret = ops->msi_prepare(domain, dev, nvec, arg);\n\n\treturn ret;\n}"
  },
  {
    "function_name": "msi_create_irq_domain",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "679-696",
    "snippet": "struct irq_domain *msi_create_irq_domain(struct fwnode_handle *fwnode,\n\t\t\t\t\t struct msi_domain_info *info,\n\t\t\t\t\t struct irq_domain *parent)\n{\n\tstruct irq_domain *domain;\n\n\tmsi_domain_update_dom_ops(info);\n\tif (info->flags & MSI_FLAG_USE_DEF_CHIP_OPS)\n\t\tmsi_domain_update_chip_ops(info);\n\n\tdomain = irq_domain_create_hierarchy(parent, IRQ_DOMAIN_FLAG_MSI, 0,\n\t\t\t\t\t     fwnode, &msi_domain_ops, info);\n\n\tif (domain && !domain->name && info->chip)\n\t\tdomain->name = info->chip->name;\n\n\treturn domain;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "irq_domain_create_hierarchy",
          "args": [
            "parent",
            "IRQ_DOMAIN_FLAG_MSI",
            "0",
            "fwnode",
            "&msi_domain_ops",
            "info"
          ],
          "line": 689
        },
        "resolved": true,
        "details": {
          "function_name": "irq_domain_create_hierarchy",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/irqdomain.c",
          "lines": "1093-1112",
          "snippet": "struct irq_domain *irq_domain_create_hierarchy(struct irq_domain *parent,\n\t\t\t\t\t    unsigned int flags,\n\t\t\t\t\t    unsigned int size,\n\t\t\t\t\t    struct fwnode_handle *fwnode,\n\t\t\t\t\t    const struct irq_domain_ops *ops,\n\t\t\t\t\t    void *host_data)\n{\n\tstruct irq_domain *domain;\n\n\tif (size)\n\t\tdomain = irq_domain_create_linear(fwnode, size, ops, host_data);\n\telse\n\t\tdomain = irq_domain_create_tree(fwnode, ops, host_data);\n\tif (domain) {\n\t\tdomain->parent = parent;\n\t\tdomain->flags |= flags;\n\t}\n\n\treturn domain;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/smp.h>",
            "#include <linux/slab.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/topology.h>",
            "#include <linux/of_irq.h>",
            "#include <linux/of_address.h>",
            "#include <linux/of.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irqdesc.h>",
            "#include <linux/irq.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/acpi.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void irq_domain_check_hierarchy(struct irq_domain *domain);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/smp.h>\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/topology.h>\n#include <linux/of_irq.h>\n#include <linux/of_address.h>\n#include <linux/of.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/irqdomain.h>\n#include <linux/irqdesc.h>\n#include <linux/irq.h>\n#include <linux/interrupt.h>\n#include <linux/hardirq.h>\n#include <linux/debugfs.h>\n#include <linux/acpi.h>\n\nstatic void irq_domain_check_hierarchy(struct irq_domain *domain);\n\nstruct irq_domain *irq_domain_create_hierarchy(struct irq_domain *parent,\n\t\t\t\t\t    unsigned int flags,\n\t\t\t\t\t    unsigned int size,\n\t\t\t\t\t    struct fwnode_handle *fwnode,\n\t\t\t\t\t    const struct irq_domain_ops *ops,\n\t\t\t\t\t    void *host_data)\n{\n\tstruct irq_domain *domain;\n\n\tif (size)\n\t\tdomain = irq_domain_create_linear(fwnode, size, ops, host_data);\n\telse\n\t\tdomain = irq_domain_create_tree(fwnode, ops, host_data);\n\tif (domain) {\n\t\tdomain->parent = parent;\n\t\tdomain->flags |= flags;\n\t}\n\n\treturn domain;\n}"
        }
      },
      {
        "call_info": {
          "callee": "msi_domain_update_chip_ops",
          "args": [
            "info"
          ],
          "line": 687
        },
        "resolved": true,
        "details": {
          "function_name": "msi_domain_update_chip_ops",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "662-669",
          "snippet": "static void msi_domain_update_chip_ops(struct msi_domain_info *info)\n{\n\tstruct irq_chip *chip = info->chip;\n\n\tBUG_ON(!chip || !chip->irq_mask || !chip->irq_unmask);\n\tif (!chip->irq_set_affinity)\n\t\tchip->irq_set_affinity = msi_domain_set_affinity;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic void msi_domain_update_chip_ops(struct msi_domain_info *info)\n{\n\tstruct irq_chip *chip = info->chip;\n\n\tBUG_ON(!chip || !chip->irq_mask || !chip->irq_unmask);\n\tif (!chip->irq_set_affinity)\n\t\tchip->irq_set_affinity = msi_domain_set_affinity;\n}"
        }
      },
      {
        "call_info": {
          "callee": "msi_domain_update_dom_ops",
          "args": [
            "info"
          ],
          "line": 685
        },
        "resolved": true,
        "details": {
          "function_name": "msi_domain_update_dom_ops",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "633-660",
          "snippet": "static void msi_domain_update_dom_ops(struct msi_domain_info *info)\n{\n\tstruct msi_domain_ops *ops = info->ops;\n\n\tif (ops == NULL) {\n\t\tinfo->ops = &msi_domain_ops_default;\n\t\treturn;\n\t}\n\n\tif (ops->domain_alloc_irqs == NULL)\n\t\tops->domain_alloc_irqs = msi_domain_ops_default.domain_alloc_irqs;\n\tif (ops->domain_free_irqs == NULL)\n\t\tops->domain_free_irqs = msi_domain_ops_default.domain_free_irqs;\n\n\tif (!(info->flags & MSI_FLAG_USE_DEF_DOM_OPS))\n\t\treturn;\n\n\tif (ops->get_hwirq == NULL)\n\t\tops->get_hwirq = msi_domain_ops_default.get_hwirq;\n\tif (ops->msi_init == NULL)\n\t\tops->msi_init = msi_domain_ops_default.msi_init;\n\tif (ops->msi_check == NULL)\n\t\tops->msi_check = msi_domain_ops_default.msi_check;\n\tif (ops->msi_prepare == NULL)\n\t\tops->msi_prepare = msi_domain_ops_default.msi_prepare;\n\tif (ops->set_desc == NULL)\n\t\tops->set_desc = msi_domain_ops_default.set_desc;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic void msi_domain_update_dom_ops(struct msi_domain_info *info)\n{\n\tstruct msi_domain_ops *ops = info->ops;\n\n\tif (ops == NULL) {\n\t\tinfo->ops = &msi_domain_ops_default;\n\t\treturn;\n\t}\n\n\tif (ops->domain_alloc_irqs == NULL)\n\t\tops->domain_alloc_irqs = msi_domain_ops_default.domain_alloc_irqs;\n\tif (ops->domain_free_irqs == NULL)\n\t\tops->domain_free_irqs = msi_domain_ops_default.domain_free_irqs;\n\n\tif (!(info->flags & MSI_FLAG_USE_DEF_DOM_OPS))\n\t\treturn;\n\n\tif (ops->get_hwirq == NULL)\n\t\tops->get_hwirq = msi_domain_ops_default.get_hwirq;\n\tif (ops->msi_init == NULL)\n\t\tops->msi_init = msi_domain_ops_default.msi_init;\n\tif (ops->msi_check == NULL)\n\t\tops->msi_check = msi_domain_ops_default.msi_check;\n\tif (ops->msi_prepare == NULL)\n\t\tops->msi_prepare = msi_domain_ops_default.msi_prepare;\n\tif (ops->set_desc == NULL)\n\t\tops->set_desc = msi_domain_ops_default.set_desc;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstruct irq_domain *msi_create_irq_domain(struct fwnode_handle *fwnode,\n\t\t\t\t\t struct msi_domain_info *info,\n\t\t\t\t\t struct irq_domain *parent)\n{\n\tstruct irq_domain *domain;\n\n\tmsi_domain_update_dom_ops(info);\n\tif (info->flags & MSI_FLAG_USE_DEF_CHIP_OPS)\n\t\tmsi_domain_update_chip_ops(info);\n\n\tdomain = irq_domain_create_hierarchy(parent, IRQ_DOMAIN_FLAG_MSI, 0,\n\t\t\t\t\t     fwnode, &msi_domain_ops, info);\n\n\tif (domain && !domain->name && info->chip)\n\t\tdomain->name = info->chip->name;\n\n\treturn domain;\n}"
  },
  {
    "function_name": "msi_domain_update_chip_ops",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "662-669",
    "snippet": "static void msi_domain_update_chip_ops(struct msi_domain_info *info)\n{\n\tstruct irq_chip *chip = info->chip;\n\n\tBUG_ON(!chip || !chip->irq_mask || !chip->irq_unmask);\n\tif (!chip->irq_set_affinity)\n\t\tchip->irq_set_affinity = msi_domain_set_affinity;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "!chip || !chip->irq_mask || !chip->irq_unmask"
          ],
          "line": 666
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic void msi_domain_update_chip_ops(struct msi_domain_info *info)\n{\n\tstruct irq_chip *chip = info->chip;\n\n\tBUG_ON(!chip || !chip->irq_mask || !chip->irq_unmask);\n\tif (!chip->irq_set_affinity)\n\t\tchip->irq_set_affinity = msi_domain_set_affinity;\n}"
  },
  {
    "function_name": "msi_domain_update_dom_ops",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "633-660",
    "snippet": "static void msi_domain_update_dom_ops(struct msi_domain_info *info)\n{\n\tstruct msi_domain_ops *ops = info->ops;\n\n\tif (ops == NULL) {\n\t\tinfo->ops = &msi_domain_ops_default;\n\t\treturn;\n\t}\n\n\tif (ops->domain_alloc_irqs == NULL)\n\t\tops->domain_alloc_irqs = msi_domain_ops_default.domain_alloc_irqs;\n\tif (ops->domain_free_irqs == NULL)\n\t\tops->domain_free_irqs = msi_domain_ops_default.domain_free_irqs;\n\n\tif (!(info->flags & MSI_FLAG_USE_DEF_DOM_OPS))\n\t\treturn;\n\n\tif (ops->get_hwirq == NULL)\n\t\tops->get_hwirq = msi_domain_ops_default.get_hwirq;\n\tif (ops->msi_init == NULL)\n\t\tops->msi_init = msi_domain_ops_default.msi_init;\n\tif (ops->msi_check == NULL)\n\t\tops->msi_check = msi_domain_ops_default.msi_check;\n\tif (ops->msi_prepare == NULL)\n\t\tops->msi_prepare = msi_domain_ops_default.msi_prepare;\n\tif (ops->set_desc == NULL)\n\t\tops->set_desc = msi_domain_ops_default.set_desc;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic void msi_domain_update_dom_ops(struct msi_domain_info *info)\n{\n\tstruct msi_domain_ops *ops = info->ops;\n\n\tif (ops == NULL) {\n\t\tinfo->ops = &msi_domain_ops_default;\n\t\treturn;\n\t}\n\n\tif (ops->domain_alloc_irqs == NULL)\n\t\tops->domain_alloc_irqs = msi_domain_ops_default.domain_alloc_irqs;\n\tif (ops->domain_free_irqs == NULL)\n\t\tops->domain_free_irqs = msi_domain_ops_default.domain_free_irqs;\n\n\tif (!(info->flags & MSI_FLAG_USE_DEF_DOM_OPS))\n\t\treturn;\n\n\tif (ops->get_hwirq == NULL)\n\t\tops->get_hwirq = msi_domain_ops_default.get_hwirq;\n\tif (ops->msi_init == NULL)\n\t\tops->msi_init = msi_domain_ops_default.msi_init;\n\tif (ops->msi_check == NULL)\n\t\tops->msi_check = msi_domain_ops_default.msi_check;\n\tif (ops->msi_prepare == NULL)\n\t\tops->msi_prepare = msi_domain_ops_default.msi_prepare;\n\tif (ops->set_desc == NULL)\n\t\tops->set_desc = msi_domain_ops_default.set_desc;\n}"
  },
  {
    "function_name": "msi_domain_ops_check",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "616-621",
    "snippet": "static int msi_domain_ops_check(struct irq_domain *domain,\n\t\t\t\tstruct msi_domain_info *info,\n\t\t\t\tstruct device *dev)\n{\n\treturn 0;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline int msi_sysfs_create_group(struct device *dev);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nstatic int msi_domain_ops_check(struct irq_domain *domain,\n\t\t\t\tstruct msi_domain_info *info,\n\t\t\t\tstruct device *dev)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "msi_domain_ops_init",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "601-614",
    "snippet": "static int msi_domain_ops_init(struct irq_domain *domain,\n\t\t\t       struct msi_domain_info *info,\n\t\t\t       unsigned int virq, irq_hw_number_t hwirq,\n\t\t\t       msi_alloc_info_t *arg)\n{\n\tirq_domain_set_hwirq_and_chip(domain, virq, hwirq, info->chip,\n\t\t\t\t      info->chip_data);\n\tif (info->handler && info->handler_name) {\n\t\t__irq_set_handler(virq, info->handler, 0, info->handler_name);\n\t\tif (info->handler_data)\n\t\t\tirq_set_handler_data(virq, info->handler_data);\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "irq_set_handler_data",
          "args": [
            "virq",
            "info->handler_data"
          ],
          "line": 611
        },
        "resolved": true,
        "details": {
          "function_name": "irq_set_handler_data",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/chip.c",
          "lines": "90-100",
          "snippet": "int irq_set_handler_data(unsigned int irq, void *data)\n{\n\tunsigned long flags;\n\tstruct irq_desc *desc = irq_get_desc_lock(irq, &flags, 0);\n\n\tif (!desc)\n\t\treturn -EINVAL;\n\tdesc->irq_common_data.handler_data = data;\n\tirq_put_desc_unlock(desc, flags);\n\treturn 0;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <trace/events/irq.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/module.h>",
            "#include <linux/msi.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <trace/events/irq.h>\n#include <linux/irqdomain.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/module.h>\n#include <linux/msi.h>\n#include <linux/irq.h>\n\nint irq_set_handler_data(unsigned int irq, void *data)\n{\n\tunsigned long flags;\n\tstruct irq_desc *desc = irq_get_desc_lock(irq, &flags, 0);\n\n\tif (!desc)\n\t\treturn -EINVAL;\n\tdesc->irq_common_data.handler_data = data;\n\tirq_put_desc_unlock(desc, flags);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "__irq_set_handler",
          "args": [
            "virq",
            "info->handler",
            "0",
            "info->handler_name"
          ],
          "line": 609
        },
        "resolved": true,
        "details": {
          "function_name": "__irq_set_handler",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/chip.c",
          "lines": "1043-1055",
          "snippet": "void\n__irq_set_handler(unsigned int irq, irq_flow_handler_t handle, int is_chained,\n\t\t  const char *name)\n{\n\tunsigned long flags;\n\tstruct irq_desc *desc = irq_get_desc_buslock(irq, &flags, 0);\n\n\tif (!desc)\n\t\treturn;\n\n\t__irq_do_set_handler(desc, handle, is_chained, name);\n\tirq_put_desc_busunlock(desc, flags);\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <trace/events/irq.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/module.h>",
            "#include <linux/msi.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <trace/events/irq.h>\n#include <linux/irqdomain.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/module.h>\n#include <linux/msi.h>\n#include <linux/irq.h>\n\nvoid\n__irq_set_handler(unsigned int irq, irq_flow_handler_t handle, int is_chained,\n\t\t  const char *name)\n{\n\tunsigned long flags;\n\tstruct irq_desc *desc = irq_get_desc_buslock(irq, &flags, 0);\n\n\tif (!desc)\n\t\treturn;\n\n\t__irq_do_set_handler(desc, handle, is_chained, name);\n\tirq_put_desc_busunlock(desc, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "irq_domain_set_hwirq_and_chip",
          "args": [
            "domain",
            "virq",
            "hwirq",
            "info->chip",
            "info->chip_data"
          ],
          "line": 606
        },
        "resolved": true,
        "details": {
          "function_name": "irq_domain_set_hwirq_and_chip",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/irqdomain.c",
          "lines": "1321-1335",
          "snippet": "int irq_domain_set_hwirq_and_chip(struct irq_domain *domain, unsigned int virq,\n\t\t\t\t  irq_hw_number_t hwirq, struct irq_chip *chip,\n\t\t\t\t  void *chip_data)\n{\n\tstruct irq_data *irq_data = irq_domain_get_irq_data(domain, virq);\n\n\tif (!irq_data)\n\t\treturn -ENOENT;\n\n\tirq_data->hwirq = hwirq;\n\tirq_data->chip = chip ? chip : &no_irq_chip;\n\tirq_data->chip_data = chip_data;\n\n\treturn 0;\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/smp.h>",
            "#include <linux/slab.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/topology.h>",
            "#include <linux/of_irq.h>",
            "#include <linux/of_address.h>",
            "#include <linux/of.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irqdesc.h>",
            "#include <linux/irq.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/acpi.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void irq_domain_check_hierarchy(struct irq_domain *domain);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/smp.h>\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/topology.h>\n#include <linux/of_irq.h>\n#include <linux/of_address.h>\n#include <linux/of.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/irqdomain.h>\n#include <linux/irqdesc.h>\n#include <linux/irq.h>\n#include <linux/interrupt.h>\n#include <linux/hardirq.h>\n#include <linux/debugfs.h>\n#include <linux/acpi.h>\n\nstatic void irq_domain_check_hierarchy(struct irq_domain *domain);\n\nint irq_domain_set_hwirq_and_chip(struct irq_domain *domain, unsigned int virq,\n\t\t\t\t  irq_hw_number_t hwirq, struct irq_chip *chip,\n\t\t\t\t  void *chip_data)\n{\n\tstruct irq_data *irq_data = irq_domain_get_irq_data(domain, virq);\n\n\tif (!irq_data)\n\t\treturn -ENOENT;\n\n\tirq_data->hwirq = hwirq;\n\tirq_data->chip = chip ? chip : &no_irq_chip;\n\tirq_data->chip_data = chip_data;\n\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic int msi_domain_ops_init(struct irq_domain *domain,\n\t\t\t       struct msi_domain_info *info,\n\t\t\t       unsigned int virq, irq_hw_number_t hwirq,\n\t\t\t       msi_alloc_info_t *arg)\n{\n\tirq_domain_set_hwirq_and_chip(domain, virq, hwirq, info->chip,\n\t\t\t\t      info->chip_data);\n\tif (info->handler && info->handler_name) {\n\t\t__irq_set_handler(virq, info->handler, 0, info->handler_name);\n\t\tif (info->handler_data)\n\t\t\tirq_set_handler_data(virq, info->handler_data);\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "msi_domain_ops_set_desc",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "595-599",
    "snippet": "static void msi_domain_ops_set_desc(msi_alloc_info_t *arg,\n\t\t\t\t    struct msi_desc *desc)\n{\n\targ->desc = desc;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic void msi_domain_ops_set_desc(msi_alloc_info_t *arg,\n\t\t\t\t    struct msi_desc *desc)\n{\n\targ->desc = desc;\n}"
  },
  {
    "function_name": "msi_domain_ops_prepare",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "588-593",
    "snippet": "static int msi_domain_ops_prepare(struct irq_domain *domain, struct device *dev,\n\t\t\t\t  int nvec, msi_alloc_info_t *arg)\n{\n\tmemset(arg, 0, sizeof(*arg));\n\treturn 0;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline int msi_sysfs_create_group(struct device *dev);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "arg",
            "0",
            "sizeof(*arg)"
          ],
          "line": 591
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nstatic int msi_domain_ops_prepare(struct irq_domain *domain, struct device *dev,\n\t\t\t\t  int nvec, msi_alloc_info_t *arg)\n{\n\tmemset(arg, 0, sizeof(*arg));\n\treturn 0;\n}"
  },
  {
    "function_name": "msi_domain_ops_get_hwirq",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "582-586",
    "snippet": "static irq_hw_number_t msi_domain_ops_get_hwirq(struct msi_domain_info *info,\n\t\t\t\t\t\tmsi_alloc_info_t *arg)\n{\n\treturn arg->hwirq;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic irq_hw_number_t msi_domain_ops_get_hwirq(struct msi_domain_info *info,\n\t\t\t\t\t\tmsi_alloc_info_t *arg)\n{\n\treturn arg->hwirq;\n}"
  },
  {
    "function_name": "msi_domain_free",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "562-573",
    "snippet": "static void msi_domain_free(struct irq_domain *domain, unsigned int virq,\n\t\t\t    unsigned int nr_irqs)\n{\n\tstruct msi_domain_info *info = domain->host_data;\n\tint i;\n\n\tif (info->ops->msi_free) {\n\t\tfor (i = 0; i < nr_irqs; i++)\n\t\t\tinfo->ops->msi_free(domain, info, virq + i);\n\t}\n\tirq_domain_free_irqs_top(domain, virq, nr_irqs);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "irq_domain_free_irqs_top",
          "args": [
            "domain",
            "virq",
            "nr_irqs"
          ],
          "line": 572
        },
        "resolved": true,
        "details": {
          "function_name": "irq_domain_free_irqs_top",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/irqdomain.c",
          "lines": "1387-1397",
          "snippet": "void irq_domain_free_irqs_top(struct irq_domain *domain, unsigned int virq,\n\t\t\t      unsigned int nr_irqs)\n{\n\tint i;\n\n\tfor (i = 0; i < nr_irqs; i++) {\n\t\tirq_set_handler_data(virq + i, NULL);\n\t\tirq_set_handler(virq + i, NULL);\n\t}\n\tirq_domain_free_irqs_common(domain, virq, nr_irqs);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/smp.h>",
            "#include <linux/slab.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/topology.h>",
            "#include <linux/of_irq.h>",
            "#include <linux/of_address.h>",
            "#include <linux/of.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irqdesc.h>",
            "#include <linux/irq.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/acpi.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void irq_domain_check_hierarchy(struct irq_domain *domain);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/smp.h>\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/topology.h>\n#include <linux/of_irq.h>\n#include <linux/of_address.h>\n#include <linux/of.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/irqdomain.h>\n#include <linux/irqdesc.h>\n#include <linux/irq.h>\n#include <linux/interrupt.h>\n#include <linux/hardirq.h>\n#include <linux/debugfs.h>\n#include <linux/acpi.h>\n\nstatic void irq_domain_check_hierarchy(struct irq_domain *domain);\n\nvoid irq_domain_free_irqs_top(struct irq_domain *domain, unsigned int virq,\n\t\t\t      unsigned int nr_irqs)\n{\n\tint i;\n\n\tfor (i = 0; i < nr_irqs; i++) {\n\t\tirq_set_handler_data(virq + i, NULL);\n\t\tirq_set_handler(virq + i, NULL);\n\t}\n\tirq_domain_free_irqs_common(domain, virq, nr_irqs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "info->ops->msi_free",
          "args": [
            "domain",
            "info",
            "virq + i"
          ],
          "line": 570
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic void msi_domain_free(struct irq_domain *domain, unsigned int virq,\n\t\t\t    unsigned int nr_irqs)\n{\n\tstruct msi_domain_info *info = domain->host_data;\n\tint i;\n\n\tif (info->ops->msi_free) {\n\t\tfor (i = 0; i < nr_irqs; i++)\n\t\t\tinfo->ops->msi_free(domain, info, virq + i);\n\t}\n\tirq_domain_free_irqs_top(domain, virq, nr_irqs);\n}"
  },
  {
    "function_name": "msi_domain_alloc",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "530-560",
    "snippet": "static int msi_domain_alloc(struct irq_domain *domain, unsigned int virq,\n\t\t\t    unsigned int nr_irqs, void *arg)\n{\n\tstruct msi_domain_info *info = domain->host_data;\n\tstruct msi_domain_ops *ops = info->ops;\n\tirq_hw_number_t hwirq = ops->get_hwirq(info, arg);\n\tint i, ret;\n\n\tif (irq_find_mapping(domain, hwirq) > 0)\n\t\treturn -EEXIST;\n\n\tif (domain->parent) {\n\t\tret = irq_domain_alloc_irqs_parent(domain, virq, nr_irqs, arg);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t}\n\n\tfor (i = 0; i < nr_irqs; i++) {\n\t\tret = ops->msi_init(domain, info, virq + i, hwirq + i, arg);\n\t\tif (ret < 0) {\n\t\t\tif (ops->msi_free) {\n\t\t\t\tfor (i--; i > 0; i--)\n\t\t\t\t\tops->msi_free(domain, info, virq + i);\n\t\t\t}\n\t\t\tirq_domain_free_irqs_top(domain, virq, nr_irqs);\n\t\t\treturn ret;\n\t\t}\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "irq_domain_free_irqs_top",
          "args": [
            "domain",
            "virq",
            "nr_irqs"
          ],
          "line": 554
        },
        "resolved": true,
        "details": {
          "function_name": "irq_domain_free_irqs_top",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/irqdomain.c",
          "lines": "1387-1397",
          "snippet": "void irq_domain_free_irqs_top(struct irq_domain *domain, unsigned int virq,\n\t\t\t      unsigned int nr_irqs)\n{\n\tint i;\n\n\tfor (i = 0; i < nr_irqs; i++) {\n\t\tirq_set_handler_data(virq + i, NULL);\n\t\tirq_set_handler(virq + i, NULL);\n\t}\n\tirq_domain_free_irqs_common(domain, virq, nr_irqs);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/smp.h>",
            "#include <linux/slab.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/topology.h>",
            "#include <linux/of_irq.h>",
            "#include <linux/of_address.h>",
            "#include <linux/of.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irqdesc.h>",
            "#include <linux/irq.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/acpi.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void irq_domain_check_hierarchy(struct irq_domain *domain);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/smp.h>\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/topology.h>\n#include <linux/of_irq.h>\n#include <linux/of_address.h>\n#include <linux/of.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/irqdomain.h>\n#include <linux/irqdesc.h>\n#include <linux/irq.h>\n#include <linux/interrupt.h>\n#include <linux/hardirq.h>\n#include <linux/debugfs.h>\n#include <linux/acpi.h>\n\nstatic void irq_domain_check_hierarchy(struct irq_domain *domain);\n\nvoid irq_domain_free_irqs_top(struct irq_domain *domain, unsigned int virq,\n\t\t\t      unsigned int nr_irqs)\n{\n\tint i;\n\n\tfor (i = 0; i < nr_irqs; i++) {\n\t\tirq_set_handler_data(virq + i, NULL);\n\t\tirq_set_handler(virq + i, NULL);\n\t}\n\tirq_domain_free_irqs_common(domain, virq, nr_irqs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ops->msi_free",
          "args": [
            "domain",
            "info",
            "virq + i"
          ],
          "line": 552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ops->msi_init",
          "args": [
            "domain",
            "info",
            "virq + i",
            "hwirq + i",
            "arg"
          ],
          "line": 548
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_domain_alloc_irqs_parent",
          "args": [
            "domain",
            "virq",
            "nr_irqs",
            "arg"
          ],
          "line": 542
        },
        "resolved": true,
        "details": {
          "function_name": "irq_domain_alloc_irqs_parent",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/irqdomain.c",
          "lines": "1713-1722",
          "snippet": "int irq_domain_alloc_irqs_parent(struct irq_domain *domain,\n\t\t\t\t unsigned int irq_base, unsigned int nr_irqs,\n\t\t\t\t void *arg)\n{\n\tif (!domain->parent)\n\t\treturn -ENOSYS;\n\n\treturn irq_domain_alloc_irqs_hierarchy(domain->parent, irq_base,\n\t\t\t\t\t       nr_irqs, arg);\n}",
          "includes": [
            "#include <linux/fs.h>",
            "#include <linux/smp.h>",
            "#include <linux/slab.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/topology.h>",
            "#include <linux/of_irq.h>",
            "#include <linux/of_address.h>",
            "#include <linux/of.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irqdesc.h>",
            "#include <linux/irq.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/acpi.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void irq_domain_check_hierarchy(struct irq_domain *domain);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/fs.h>\n#include <linux/smp.h>\n#include <linux/slab.h>\n#include <linux/seq_file.h>\n#include <linux/topology.h>\n#include <linux/of_irq.h>\n#include <linux/of_address.h>\n#include <linux/of.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/irqdomain.h>\n#include <linux/irqdesc.h>\n#include <linux/irq.h>\n#include <linux/interrupt.h>\n#include <linux/hardirq.h>\n#include <linux/debugfs.h>\n#include <linux/acpi.h>\n\nstatic void irq_domain_check_hierarchy(struct irq_domain *domain);\n\nint irq_domain_alloc_irqs_parent(struct irq_domain *domain,\n\t\t\t\t unsigned int irq_base, unsigned int nr_irqs,\n\t\t\t\t void *arg)\n{\n\tif (!domain->parent)\n\t\treturn -ENOSYS;\n\n\treturn irq_domain_alloc_irqs_hierarchy(domain->parent, irq_base,\n\t\t\t\t\t       nr_irqs, arg);\n}"
        }
      },
      {
        "call_info": {
          "callee": "irq_find_mapping",
          "args": [
            "domain",
            "hwirq"
          ],
          "line": 538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ops->get_hwirq",
          "args": [
            "info",
            "arg"
          ],
          "line": 535
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic int msi_domain_alloc(struct irq_domain *domain, unsigned int virq,\n\t\t\t    unsigned int nr_irqs, void *arg)\n{\n\tstruct msi_domain_info *info = domain->host_data;\n\tstruct msi_domain_ops *ops = info->ops;\n\tirq_hw_number_t hwirq = ops->get_hwirq(info, arg);\n\tint i, ret;\n\n\tif (irq_find_mapping(domain, hwirq) > 0)\n\t\treturn -EEXIST;\n\n\tif (domain->parent) {\n\t\tret = irq_domain_alloc_irqs_parent(domain, virq, nr_irqs, arg);\n\t\tif (ret < 0)\n\t\t\treturn ret;\n\t}\n\n\tfor (i = 0; i < nr_irqs; i++) {\n\t\tret = ops->msi_init(domain, info, virq + i, hwirq + i, arg);\n\t\tif (ret < 0) {\n\t\t\tif (ops->msi_free) {\n\t\t\t\tfor (i--; i > 0; i--)\n\t\t\t\t\tops->msi_free(domain, info, virq + i);\n\t\t\t}\n\t\t\tirq_domain_free_irqs_top(domain, virq, nr_irqs);\n\t\t\treturn ret;\n\t\t}\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "msi_domain_deactivate",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "521-528",
    "snippet": "static void msi_domain_deactivate(struct irq_domain *domain,\n\t\t\t\t  struct irq_data *irq_data)\n{\n\tstruct msi_msg msg[2];\n\n\tmemset(msg, 0, sizeof(msg));\n\tirq_chip_write_msi_msg(irq_data, msg);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "irq_chip_write_msi_msg",
          "args": [
            "irq_data",
            "msg"
          ],
          "line": 527
        },
        "resolved": true,
        "details": {
          "function_name": "irq_chip_write_msi_msg",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "463-467",
          "snippet": "static inline void irq_chip_write_msi_msg(struct irq_data *data,\n\t\t\t\t\t  struct msi_msg *msg)\n{\n\tdata->chip->irq_write_msi_msg(data, msg);\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline void irq_chip_write_msi_msg(struct irq_data *data,\n\t\t\t\t\t  struct msi_msg *msg)\n{\n\tdata->chip->irq_write_msi_msg(data, msg);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "msg",
            "0",
            "sizeof(msg)"
          ],
          "line": 526
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic void msi_domain_deactivate(struct irq_domain *domain,\n\t\t\t\t  struct irq_data *irq_data)\n{\n\tstruct msi_msg msg[2];\n\n\tmemset(msg, 0, sizeof(msg));\n\tirq_chip_write_msi_msg(irq_data, msg);\n}"
  },
  {
    "function_name": "msi_domain_activate",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "510-519",
    "snippet": "static int msi_domain_activate(struct irq_domain *domain,\n\t\t\t       struct irq_data *irq_data, bool early)\n{\n\tstruct msi_msg msg[2] = { [1] = { }, };\n\n\tBUG_ON(irq_chip_compose_msi_msg(irq_data, msg));\n\tmsi_check_level(irq_data->domain, msg);\n\tirq_chip_write_msi_msg(irq_data, msg);\n\treturn 0;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "irq_chip_write_msi_msg",
          "args": [
            "irq_data",
            "msg"
          ],
          "line": 517
        },
        "resolved": true,
        "details": {
          "function_name": "irq_chip_write_msi_msg",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "463-467",
          "snippet": "static inline void irq_chip_write_msi_msg(struct irq_data *data,\n\t\t\t\t\t  struct msi_msg *msg)\n{\n\tdata->chip->irq_write_msi_msg(data, msg);\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline void irq_chip_write_msi_msg(struct irq_data *data,\n\t\t\t\t\t  struct msi_msg *msg)\n{\n\tdata->chip->irq_write_msi_msg(data, msg);\n}"
        }
      },
      {
        "call_info": {
          "callee": "msi_check_level",
          "args": [
            "irq_data->domain",
            "msg"
          ],
          "line": 516
        },
        "resolved": true,
        "details": {
          "function_name": "msi_check_level",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "469-480",
          "snippet": "static void msi_check_level(struct irq_domain *domain, struct msi_msg *msg)\n{\n\tstruct msi_domain_info *info = domain->host_data;\n\n\t/*\n\t * If the MSI provider has messed with the second message and\n\t * not advertized that it is level-capable, signal the breakage.\n\t */\n\tWARN_ON(!((info->flags & MSI_FLAG_LEVEL_CAPABLE) &&\n\t\t  (info->chip->flags & IRQCHIP_SUPPORTS_LEVEL_MSI)) &&\n\t\t(msg[1].address_lo || msg[1].address_hi || msg[1].data));\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic void msi_check_level(struct irq_domain *domain, struct msi_msg *msg)\n{\n\tstruct msi_domain_info *info = domain->host_data;\n\n\t/*\n\t * If the MSI provider has messed with the second message and\n\t * not advertized that it is level-capable, signal the breakage.\n\t */\n\tWARN_ON(!((info->flags & MSI_FLAG_LEVEL_CAPABLE) &&\n\t\t  (info->chip->flags & IRQCHIP_SUPPORTS_LEVEL_MSI)) &&\n\t\t(msg[1].address_lo || msg[1].address_hi || msg[1].data));\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "irq_chip_compose_msi_msg(irq_data, msg)"
          ],
          "line": 515
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_chip_compose_msi_msg",
          "args": [
            "irq_data",
            "msg"
          ],
          "line": 515
        },
        "resolved": true,
        "details": {
          "function_name": "irq_chip_compose_msi_msg",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/chip.c",
          "lines": "1545-1559",
          "snippet": "int irq_chip_compose_msi_msg(struct irq_data *data, struct msi_msg *msg)\n{\n\tstruct irq_data *pos;\n\n\tfor (pos = NULL; !pos && data; data = irqd_get_parent_data(data)) {\n\t\tif (data->chip && data->chip->irq_compose_msi_msg)\n\t\t\tpos = data;\n\t}\n\n\tif (!pos)\n\t\treturn -ENOSYS;\n\n\tpos->chip->irq_compose_msi_msg(pos, msg);\n\treturn 0;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <trace/events/irq.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/module.h>",
            "#include <linux/msi.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <trace/events/irq.h>\n#include <linux/irqdomain.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/module.h>\n#include <linux/msi.h>\n#include <linux/irq.h>\n\nint irq_chip_compose_msi_msg(struct irq_data *data, struct msi_msg *msg)\n{\n\tstruct irq_data *pos;\n\n\tfor (pos = NULL; !pos && data; data = irqd_get_parent_data(data)) {\n\t\tif (data->chip && data->chip->irq_compose_msi_msg)\n\t\t\tpos = data;\n\t}\n\n\tif (!pos)\n\t\treturn -ENOSYS;\n\n\tpos->chip->irq_compose_msi_msg(pos, msg);\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic int msi_domain_activate(struct irq_domain *domain,\n\t\t\t       struct irq_data *irq_data, bool early)\n{\n\tstruct msi_msg msg[2] = { [1] = { }, };\n\n\tBUG_ON(irq_chip_compose_msi_msg(irq_data, msg));\n\tmsi_check_level(irq_data->domain, msg);\n\tirq_chip_write_msi_msg(irq_data, msg);\n\treturn 0;\n}"
  },
  {
    "function_name": "msi_domain_set_affinity",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "493-508",
    "snippet": "int msi_domain_set_affinity(struct irq_data *irq_data,\n\t\t\t    const struct cpumask *mask, bool force)\n{\n\tstruct irq_data *parent = irq_data->parent_data;\n\tstruct msi_msg msg[2] = { [1] = { }, };\n\tint ret;\n\n\tret = parent->chip->irq_set_affinity(parent, mask, force);\n\tif (ret >= 0 && ret != IRQ_SET_MASK_OK_DONE) {\n\t\tBUG_ON(irq_chip_compose_msi_msg(irq_data, msg));\n\t\tmsi_check_level(irq_data->domain, msg);\n\t\tirq_chip_write_msi_msg(irq_data, msg);\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "irq_chip_write_msi_msg",
          "args": [
            "irq_data",
            "msg"
          ],
          "line": 504
        },
        "resolved": true,
        "details": {
          "function_name": "irq_chip_write_msi_msg",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "463-467",
          "snippet": "static inline void irq_chip_write_msi_msg(struct irq_data *data,\n\t\t\t\t\t  struct msi_msg *msg)\n{\n\tdata->chip->irq_write_msi_msg(data, msg);\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline void irq_chip_write_msi_msg(struct irq_data *data,\n\t\t\t\t\t  struct msi_msg *msg)\n{\n\tdata->chip->irq_write_msi_msg(data, msg);\n}"
        }
      },
      {
        "call_info": {
          "callee": "msi_check_level",
          "args": [
            "irq_data->domain",
            "msg"
          ],
          "line": 503
        },
        "resolved": true,
        "details": {
          "function_name": "msi_check_level",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "469-480",
          "snippet": "static void msi_check_level(struct irq_domain *domain, struct msi_msg *msg)\n{\n\tstruct msi_domain_info *info = domain->host_data;\n\n\t/*\n\t * If the MSI provider has messed with the second message and\n\t * not advertized that it is level-capable, signal the breakage.\n\t */\n\tWARN_ON(!((info->flags & MSI_FLAG_LEVEL_CAPABLE) &&\n\t\t  (info->chip->flags & IRQCHIP_SUPPORTS_LEVEL_MSI)) &&\n\t\t(msg[1].address_lo || msg[1].address_hi || msg[1].data));\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic void msi_check_level(struct irq_domain *domain, struct msi_msg *msg)\n{\n\tstruct msi_domain_info *info = domain->host_data;\n\n\t/*\n\t * If the MSI provider has messed with the second message and\n\t * not advertized that it is level-capable, signal the breakage.\n\t */\n\tWARN_ON(!((info->flags & MSI_FLAG_LEVEL_CAPABLE) &&\n\t\t  (info->chip->flags & IRQCHIP_SUPPORTS_LEVEL_MSI)) &&\n\t\t(msg[1].address_lo || msg[1].address_hi || msg[1].data));\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUG_ON",
          "args": [
            "irq_chip_compose_msi_msg(irq_data, msg)"
          ],
          "line": 502
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_chip_compose_msi_msg",
          "args": [
            "irq_data",
            "msg"
          ],
          "line": 502
        },
        "resolved": true,
        "details": {
          "function_name": "irq_chip_compose_msi_msg",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/chip.c",
          "lines": "1545-1559",
          "snippet": "int irq_chip_compose_msi_msg(struct irq_data *data, struct msi_msg *msg)\n{\n\tstruct irq_data *pos;\n\n\tfor (pos = NULL; !pos && data; data = irqd_get_parent_data(data)) {\n\t\tif (data->chip && data->chip->irq_compose_msi_msg)\n\t\t\tpos = data;\n\t}\n\n\tif (!pos)\n\t\treturn -ENOSYS;\n\n\tpos->chip->irq_compose_msi_msg(pos, msg);\n\treturn 0;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <trace/events/irq.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/module.h>",
            "#include <linux/msi.h>",
            "#include <linux/irq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <trace/events/irq.h>\n#include <linux/irqdomain.h>\n#include <linux/kernel_stat.h>\n#include <linux/interrupt.h>\n#include <linux/module.h>\n#include <linux/msi.h>\n#include <linux/irq.h>\n\nint irq_chip_compose_msi_msg(struct irq_data *data, struct msi_msg *msg)\n{\n\tstruct irq_data *pos;\n\n\tfor (pos = NULL; !pos && data; data = irqd_get_parent_data(data)) {\n\t\tif (data->chip && data->chip->irq_compose_msi_msg)\n\t\t\tpos = data;\n\t}\n\n\tif (!pos)\n\t\treturn -ENOSYS;\n\n\tpos->chip->irq_compose_msi_msg(pos, msg);\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "parent->chip->irq_set_affinity",
          "args": [
            "parent",
            "mask",
            "force"
          ],
          "line": 500
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nint msi_domain_set_affinity(struct irq_data *irq_data,\n\t\t\t    const struct cpumask *mask, bool force)\n{\n\tstruct irq_data *parent = irq_data->parent_data;\n\tstruct msi_msg msg[2] = { [1] = { }, };\n\tint ret;\n\n\tret = parent->chip->irq_set_affinity(parent, mask, force);\n\tif (ret >= 0 && ret != IRQ_SET_MASK_OK_DONE) {\n\t\tBUG_ON(irq_chip_compose_msi_msg(irq_data, msg));\n\t\tmsi_check_level(irq_data->domain, msg);\n\t\tirq_chip_write_msi_msg(irq_data, msg);\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "msi_check_level",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "469-480",
    "snippet": "static void msi_check_level(struct irq_domain *domain, struct msi_msg *msg)\n{\n\tstruct msi_domain_info *info = domain->host_data;\n\n\t/*\n\t * If the MSI provider has messed with the second message and\n\t * not advertized that it is level-capable, signal the breakage.\n\t */\n\tWARN_ON(!((info->flags & MSI_FLAG_LEVEL_CAPABLE) &&\n\t\t  (info->chip->flags & IRQCHIP_SUPPORTS_LEVEL_MSI)) &&\n\t\t(msg[1].address_lo || msg[1].address_hi || msg[1].data));\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "!((info->flags & MSI_FLAG_LEVEL_CAPABLE) &&\n\t\t  (info->chip->flags & IRQCHIP_SUPPORTS_LEVEL_MSI)) &&\n\t\t(msg[1].address_lo || msg[1].address_hi || msg[1].data)"
          ],
          "line": 477
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic void msi_check_level(struct irq_domain *domain, struct msi_msg *msg)\n{\n\tstruct msi_domain_info *info = domain->host_data;\n\n\t/*\n\t * If the MSI provider has messed with the second message and\n\t * not advertized that it is level-capable, signal the breakage.\n\t */\n\tWARN_ON(!((info->flags & MSI_FLAG_LEVEL_CAPABLE) &&\n\t\t  (info->chip->flags & IRQCHIP_SUPPORTS_LEVEL_MSI)) &&\n\t\t(msg[1].address_lo || msg[1].address_hi || msg[1].data));\n}"
  },
  {
    "function_name": "irq_chip_write_msi_msg",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "463-467",
    "snippet": "static inline void irq_chip_write_msi_msg(struct irq_data *data,\n\t\t\t\t\t  struct msi_msg *msg)\n{\n\tdata->chip->irq_write_msi_msg(data, msg);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "data->chip->irq_write_msi_msg",
          "args": [
            "data",
            "msg"
          ],
          "line": 466
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline void irq_chip_write_msi_msg(struct irq_data *data,\n\t\t\t\t\t  struct msi_msg *msg)\n{\n\tdata->chip->irq_write_msi_msg(data, msg);\n}"
  },
  {
    "function_name": "msi_sysfs_remove_desc",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "459-459",
    "snippet": "static inline void msi_sysfs_remove_desc(struct device *dev, struct msi_desc *desc) { }",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline int msi_sysfs_create_group(struct device *dev);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nstatic inline void msi_sysfs_remove_desc(struct device *dev, struct msi_desc *desc) { }"
  },
  {
    "function_name": "msi_sysfs_populate_desc",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "458-458",
    "snippet": "static inline int msi_sysfs_populate_desc(struct device *dev, struct msi_desc *desc) { return 0; }",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline int msi_sysfs_create_group(struct device *dev);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nstatic inline int msi_sysfs_populate_desc(struct device *dev, struct msi_desc *desc) { return 0; }"
  },
  {
    "function_name": "msi_sysfs_create_group",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "457-457",
    "snippet": "static inline int msi_sysfs_create_group(struct device *dev) { return 0; }",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline int msi_sysfs_create_group(struct device *dev);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nstatic inline int msi_sysfs_create_group(struct device *dev) { return 0; }"
  },
  {
    "function_name": "msi_device_destroy_sysfs",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "448-454",
    "snippet": "void msi_device_destroy_sysfs(struct device *dev)\n{\n\tstruct msi_desc *desc;\n\n\tmsi_for_each_desc(desc, dev, MSI_DESC_ALL)\n\t\tmsi_sysfs_remove_desc(dev, desc);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline int msi_sysfs_create_group(struct device *dev);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "msi_sysfs_remove_desc",
          "args": [
            "dev",
            "desc"
          ],
          "line": 453
        },
        "resolved": true,
        "details": {
          "function_name": "msi_sysfs_remove_desc",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "459-459",
          "snippet": "static inline void msi_sysfs_remove_desc(struct device *dev, struct msi_desc *desc) { }",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline int msi_sysfs_create_group(struct device *dev);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nstatic inline void msi_sysfs_remove_desc(struct device *dev, struct msi_desc *desc) { }"
        }
      },
      {
        "call_info": {
          "callee": "msi_for_each_desc",
          "args": [
            "desc",
            "dev",
            "MSI_DESC_ALL"
          ],
          "line": 452
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nvoid msi_device_destroy_sysfs(struct device *dev)\n{\n\tstruct msi_desc *desc;\n\n\tmsi_for_each_desc(desc, dev, MSI_DESC_ALL)\n\t\tmsi_sysfs_remove_desc(dev, desc);\n}"
  },
  {
    "function_name": "msi_device_populate_sysfs",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "428-441",
    "snippet": "int msi_device_populate_sysfs(struct device *dev)\n{\n\tstruct msi_desc *desc;\n\tint ret;\n\n\tmsi_for_each_desc(desc, dev, MSI_DESC_ASSOCIATED) {\n\t\tif (desc->sysfs_attrs)\n\t\t\tcontinue;\n\t\tret = msi_sysfs_populate_desc(dev, desc);\n\t\tif (ret)\n\t\t\treturn ret;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline int msi_sysfs_create_group(struct device *dev);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "msi_sysfs_populate_desc",
          "args": [
            "dev",
            "desc"
          ],
          "line": 436
        },
        "resolved": true,
        "details": {
          "function_name": "msi_sysfs_populate_desc",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "458-458",
          "snippet": "static inline int msi_sysfs_populate_desc(struct device *dev, struct msi_desc *desc) { return 0; }",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline int msi_sysfs_create_group(struct device *dev);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nstatic inline int msi_sysfs_populate_desc(struct device *dev, struct msi_desc *desc) { return 0; }"
        }
      },
      {
        "call_info": {
          "callee": "msi_for_each_desc",
          "args": [
            "desc",
            "dev",
            "MSI_DESC_ASSOCIATED"
          ],
          "line": 433
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nint msi_device_populate_sysfs(struct device *dev)\n{\n\tstruct msi_desc *desc;\n\tint ret;\n\n\tmsi_for_each_desc(desc, dev, MSI_DESC_ASSOCIATED) {\n\t\tif (desc->sysfs_attrs)\n\t\t\tcontinue;\n\t\tret = msi_sysfs_populate_desc(dev, desc);\n\t\tif (ret)\n\t\t\treturn ret;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "msi_sysfs_populate_desc",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "389-421",
    "snippet": "static int msi_sysfs_populate_desc(struct device *dev, struct msi_desc *desc)\n{\n\tstruct device_attribute *attrs;\n\tint ret, i;\n\n\tattrs = kcalloc(desc->nvec_used, sizeof(*attrs), GFP_KERNEL);\n\tif (!attrs)\n\t\treturn -ENOMEM;\n\n\tdesc->sysfs_attrs = attrs;\n\tfor (i = 0; i < desc->nvec_used; i++) {\n\t\tsysfs_attr_init(&attrs[i].attr);\n\t\tattrs[i].attr.name = kasprintf(GFP_KERNEL, \"%d\", desc->irq + i);\n\t\tif (!attrs[i].attr.name) {\n\t\t\tret = -ENOMEM;\n\t\t\tgoto fail;\n\t\t}\n\n\t\tattrs[i].attr.mode = 0444;\n\t\tattrs[i].show = msi_mode_show;\n\n\t\tret = sysfs_add_file_to_group(&dev->kobj, &attrs[i].attr, msi_irqs_group.name);\n\t\tif (ret) {\n\t\t\tattrs[i].show = NULL;\n\t\t\tgoto fail;\n\t\t}\n\t}\n\treturn 0;\n\nfail:\n\tmsi_sysfs_remove_desc(dev, desc);\n\treturn ret;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline int msi_sysfs_create_group(struct device *dev);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "msi_sysfs_remove_desc",
          "args": [
            "dev",
            "desc"
          ],
          "line": 419
        },
        "resolved": true,
        "details": {
          "function_name": "msi_sysfs_remove_desc",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "459-459",
          "snippet": "static inline void msi_sysfs_remove_desc(struct device *dev, struct msi_desc *desc) { }",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline int msi_sysfs_create_group(struct device *dev);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nstatic inline void msi_sysfs_remove_desc(struct device *dev, struct msi_desc *desc) { }"
        }
      },
      {
        "call_info": {
          "callee": "sysfs_add_file_to_group",
          "args": [
            "&dev->kobj",
            "&attrs[i].attr",
            "msi_irqs_group.name"
          ],
          "line": 410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kasprintf",
          "args": [
            "GFP_KERNEL",
            "\"%d\"",
            "desc->irq + i"
          ],
          "line": 401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sysfs_attr_init",
          "args": [
            "&attrs[i].attr"
          ],
          "line": 400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kcalloc",
          "args": [
            "desc->nvec_used",
            "sizeof(*attrs)",
            "GFP_KERNEL"
          ],
          "line": 394
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nstatic int msi_sysfs_populate_desc(struct device *dev, struct msi_desc *desc)\n{\n\tstruct device_attribute *attrs;\n\tint ret, i;\n\n\tattrs = kcalloc(desc->nvec_used, sizeof(*attrs), GFP_KERNEL);\n\tif (!attrs)\n\t\treturn -ENOMEM;\n\n\tdesc->sysfs_attrs = attrs;\n\tfor (i = 0; i < desc->nvec_used; i++) {\n\t\tsysfs_attr_init(&attrs[i].attr);\n\t\tattrs[i].attr.name = kasprintf(GFP_KERNEL, \"%d\", desc->irq + i);\n\t\tif (!attrs[i].attr.name) {\n\t\t\tret = -ENOMEM;\n\t\t\tgoto fail;\n\t\t}\n\n\t\tattrs[i].attr.mode = 0444;\n\t\tattrs[i].show = msi_mode_show;\n\n\t\tret = sysfs_add_file_to_group(&dev->kobj, &attrs[i].attr, msi_irqs_group.name);\n\t\tif (ret) {\n\t\t\tattrs[i].show = NULL;\n\t\t\tgoto fail;\n\t\t}\n\t}\n\treturn 0;\n\nfail:\n\tmsi_sysfs_remove_desc(dev, desc);\n\treturn ret;\n}"
  },
  {
    "function_name": "msi_sysfs_remove_desc",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "372-387",
    "snippet": "static void msi_sysfs_remove_desc(struct device *dev, struct msi_desc *desc)\n{\n\tstruct device_attribute *attrs = desc->sysfs_attrs;\n\tint i;\n\n\tif (!attrs)\n\t\treturn;\n\n\tdesc->sysfs_attrs = NULL;\n\tfor (i = 0; i < desc->nvec_used; i++) {\n\t\tif (attrs[i].show)\n\t\t\tsysfs_remove_file_from_group(&dev->kobj, &attrs[i].attr, msi_irqs_group.name);\n\t\tkfree(attrs[i].attr.name);\n\t}\n\tkfree(attrs);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline int msi_sysfs_create_group(struct device *dev);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "attrs"
          ],
          "line": 386
        },
        "resolved": true,
        "details": {
          "function_name": "maybe_kfree_parameter",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/params.c",
          "lines": "62-75",
          "snippet": "static void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}",
          "includes": [
            "#include <linux/security.h>",
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(kmalloced_params);",
            "static DEFINE_SPINLOCK(kmalloced_params_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/security.h>\n#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(kmalloced_params);\nstatic DEFINE_SPINLOCK(kmalloced_params_lock);\n\nstatic void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "sysfs_remove_file_from_group",
          "args": [
            "&dev->kobj",
            "&attrs[i].attr",
            "msi_irqs_group.name"
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nstatic void msi_sysfs_remove_desc(struct device *dev, struct msi_desc *desc)\n{\n\tstruct device_attribute *attrs = desc->sysfs_attrs;\n\tint i;\n\n\tif (!attrs)\n\t\treturn;\n\n\tdesc->sysfs_attrs = NULL;\n\tfor (i = 0; i < desc->nvec_used; i++) {\n\t\tif (attrs[i].show)\n\t\t\tsysfs_remove_file_from_group(&dev->kobj, &attrs[i].attr, msi_irqs_group.name);\n\t\tkfree(attrs[i].attr.name);\n\t}\n\tkfree(attrs);\n}"
  },
  {
    "function_name": "msi_mode_show",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "363-370",
    "snippet": "static ssize_t msi_mode_show(struct device *dev, struct device_attribute *attr,\n\t\t\t     char *buf)\n{\n\t/* MSI vs. MSIX is per device not per interrupt */\n\tbool is_msix = dev_is_pci(dev) ? to_pci_dev(dev)->msix_enabled : false;\n\n\treturn sysfs_emit(buf, \"%s\\n\", is_msix ? \"msix\" : \"msi\");\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline int msi_sysfs_create_group(struct device *dev);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sysfs_emit",
          "args": [
            "buf",
            "\"%s\\n\"",
            "is_msix ? \"msix\" : \"msi\""
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to_pci_dev",
          "args": [
            "dev"
          ],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dev_is_pci",
          "args": [
            "dev"
          ],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nstatic ssize_t msi_mode_show(struct device *dev, struct device_attribute *attr,\n\t\t\t     char *buf)\n{\n\t/* MSI vs. MSIX is per device not per interrupt */\n\tbool is_msix = dev_is_pci(dev) ? to_pci_dev(dev)->msix_enabled : false;\n\n\treturn sysfs_emit(buf, \"%s\\n\", is_msix ? \"msix\" : \"msi\");\n}"
  },
  {
    "function_name": "msi_sysfs_create_group",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "358-361",
    "snippet": "static inline int msi_sysfs_create_group(struct device *dev)\n{\n\treturn devm_device_add_group(dev, &msi_irqs_group);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline int msi_sysfs_create_group(struct device *dev);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "devm_device_add_group",
          "args": [
            "dev",
            "&msi_irqs_group"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nstatic inline int msi_sysfs_create_group(struct device *dev)\n{\n\treturn devm_device_add_group(dev, &msi_irqs_group);\n}"
  },
  {
    "function_name": "msi_get_virq",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "317-345",
    "snippet": "unsigned int msi_get_virq(struct device *dev, unsigned int index)\n{\n\tstruct msi_desc *desc;\n\tunsigned int ret = 0;\n\tbool pcimsi;\n\n\tif (!dev->msi.data)\n\t\treturn 0;\n\n\tpcimsi = dev_is_pci(dev) ? to_pci_dev(dev)->msi_enabled : false;\n\n\tmsi_lock_descs(dev);\n\tdesc = xa_load(&dev->msi.data->__store, pcimsi ? 0 : index);\n\tif (desc && desc->irq) {\n\t\t/*\n\t\t * PCI-MSI has only one descriptor for multiple interrupts.\n\t\t * PCI-MSIX and platform MSI use a descriptor per\n\t\t * interrupt.\n\t\t */\n\t\tif (pcimsi) {\n\t\t\tif (index < desc->nvec_used)\n\t\t\t\tret = desc->irq + index;\n\t\t} else {\n\t\t\tret = desc->irq;\n\t\t}\n\t}\n\tmsi_unlock_descs(dev);\n\treturn ret;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline int msi_sysfs_create_group(struct device *dev);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "msi_unlock_descs",
          "args": [
            "dev"
          ],
          "line": 343
        },
        "resolved": true,
        "details": {
          "function_name": "msi_unlock_descs",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "236-241",
          "snippet": "void msi_unlock_descs(struct device *dev)\n{\n\t/* Invalidate the index wich was cached by the iterator */\n\tdev->msi.data->__iter_idx = MSI_MAX_INDEX;\n\tmutex_unlock(&dev->msi.data->mutex);\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline int msi_sysfs_create_group(struct device *dev);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nvoid msi_unlock_descs(struct device *dev)\n{\n\t/* Invalidate the index wich was cached by the iterator */\n\tdev->msi.data->__iter_idx = MSI_MAX_INDEX;\n\tmutex_unlock(&dev->msi.data->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xa_load",
          "args": [
            "&dev->msi.data->__store",
            "pcimsi ? 0 : index"
          ],
          "line": 329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "msi_lock_descs",
          "args": [
            "dev"
          ],
          "line": 328
        },
        "resolved": true,
        "details": {
          "function_name": "msi_lock_descs",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "226-229",
          "snippet": "void msi_lock_descs(struct device *dev)\n{\n\tmutex_lock(&dev->msi.data->mutex);\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline int msi_sysfs_create_group(struct device *dev);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nvoid msi_lock_descs(struct device *dev)\n{\n\tmutex_lock(&dev->msi.data->mutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "to_pci_dev",
          "args": [
            "dev"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dev_is_pci",
          "args": [
            "dev"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nunsigned int msi_get_virq(struct device *dev, unsigned int index)\n{\n\tstruct msi_desc *desc;\n\tunsigned int ret = 0;\n\tbool pcimsi;\n\n\tif (!dev->msi.data)\n\t\treturn 0;\n\n\tpcimsi = dev_is_pci(dev) ? to_pci_dev(dev)->msi_enabled : false;\n\n\tmsi_lock_descs(dev);\n\tdesc = xa_load(&dev->msi.data->__store, pcimsi ? 0 : index);\n\tif (desc && desc->irq) {\n\t\t/*\n\t\t * PCI-MSI has only one descriptor for multiple interrupts.\n\t\t * PCI-MSIX and platform MSI use a descriptor per\n\t\t * interrupt.\n\t\t */\n\t\tif (pcimsi) {\n\t\t\tif (index < desc->nvec_used)\n\t\t\t\tret = desc->irq + index;\n\t\t} else {\n\t\t\tret = desc->irq;\n\t\t}\n\t}\n\tmsi_unlock_descs(dev);\n\treturn ret;\n}"
  },
  {
    "function_name": "msi_next_desc",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "293-307",
    "snippet": "struct msi_desc *msi_next_desc(struct device *dev, enum msi_desc_filter filter)\n{\n\tstruct msi_device_data *md = dev->msi.data;\n\n\tif (WARN_ON_ONCE(!md))\n\t\treturn NULL;\n\n\tlockdep_assert_held(&md->mutex);\n\n\tif (md->__iter_idx >= (unsigned long)MSI_MAX_INDEX)\n\t\treturn NULL;\n\n\tmd->__iter_idx++;\n\treturn msi_find_desc(md, filter);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline int msi_sysfs_create_group(struct device *dev);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "msi_find_desc",
          "args": [
            "md",
            "filter"
          ],
          "line": 306
        },
        "resolved": true,
        "details": {
          "function_name": "msi_find_desc",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "244-254",
          "snippet": "static struct msi_desc *msi_find_desc(struct msi_device_data *md, enum msi_desc_filter filter)\n{\n\tstruct msi_desc *desc;\n\n\txa_for_each_start(&md->__store, md->__iter_idx, desc, md->__iter_idx) {\n\t\tif (msi_desc_match(desc, filter))\n\t\t\treturn desc;\n\t}\n\tmd->__iter_idx = MSI_MAX_INDEX;\n\treturn NULL;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic struct msi_desc *msi_find_desc(struct msi_device_data *md, enum msi_desc_filter filter)\n{\n\tstruct msi_desc *desc;\n\n\txa_for_each_start(&md->__store, md->__iter_idx, desc, md->__iter_idx) {\n\t\tif (msi_desc_match(desc, filter))\n\t\t\treturn desc;\n\t}\n\tmd->__iter_idx = MSI_MAX_INDEX;\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lockdep_assert_held",
          "args": [
            "&md->mutex"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "!md"
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nstruct msi_desc *msi_next_desc(struct device *dev, enum msi_desc_filter filter)\n{\n\tstruct msi_device_data *md = dev->msi.data;\n\n\tif (WARN_ON_ONCE(!md))\n\t\treturn NULL;\n\n\tlockdep_assert_held(&md->mutex);\n\n\tif (md->__iter_idx >= (unsigned long)MSI_MAX_INDEX)\n\t\treturn NULL;\n\n\tmd->__iter_idx++;\n\treturn msi_find_desc(md, filter);\n}"
  },
  {
    "function_name": "msi_first_desc",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "267-278",
    "snippet": "struct msi_desc *msi_first_desc(struct device *dev, enum msi_desc_filter filter)\n{\n\tstruct msi_device_data *md = dev->msi.data;\n\n\tif (WARN_ON_ONCE(!md))\n\t\treturn NULL;\n\n\tlockdep_assert_held(&md->mutex);\n\n\tmd->__iter_idx = 0;\n\treturn msi_find_desc(md, filter);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline int msi_sysfs_create_group(struct device *dev);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "msi_find_desc",
          "args": [
            "md",
            "filter"
          ],
          "line": 277
        },
        "resolved": true,
        "details": {
          "function_name": "msi_find_desc",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "244-254",
          "snippet": "static struct msi_desc *msi_find_desc(struct msi_device_data *md, enum msi_desc_filter filter)\n{\n\tstruct msi_desc *desc;\n\n\txa_for_each_start(&md->__store, md->__iter_idx, desc, md->__iter_idx) {\n\t\tif (msi_desc_match(desc, filter))\n\t\t\treturn desc;\n\t}\n\tmd->__iter_idx = MSI_MAX_INDEX;\n\treturn NULL;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic struct msi_desc *msi_find_desc(struct msi_device_data *md, enum msi_desc_filter filter)\n{\n\tstruct msi_desc *desc;\n\n\txa_for_each_start(&md->__store, md->__iter_idx, desc, md->__iter_idx) {\n\t\tif (msi_desc_match(desc, filter))\n\t\t\treturn desc;\n\t}\n\tmd->__iter_idx = MSI_MAX_INDEX;\n\treturn NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lockdep_assert_held",
          "args": [
            "&md->mutex"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "!md"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nstruct msi_desc *msi_first_desc(struct device *dev, enum msi_desc_filter filter)\n{\n\tstruct msi_device_data *md = dev->msi.data;\n\n\tif (WARN_ON_ONCE(!md))\n\t\treturn NULL;\n\n\tlockdep_assert_held(&md->mutex);\n\n\tmd->__iter_idx = 0;\n\treturn msi_find_desc(md, filter);\n}"
  },
  {
    "function_name": "msi_find_desc",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "244-254",
    "snippet": "static struct msi_desc *msi_find_desc(struct msi_device_data *md, enum msi_desc_filter filter)\n{\n\tstruct msi_desc *desc;\n\n\txa_for_each_start(&md->__store, md->__iter_idx, desc, md->__iter_idx) {\n\t\tif (msi_desc_match(desc, filter))\n\t\t\treturn desc;\n\t}\n\tmd->__iter_idx = MSI_MAX_INDEX;\n\treturn NULL;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "msi_desc_match",
          "args": [
            "desc",
            "filter"
          ],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "msi_desc_match",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "127-139",
          "snippet": "static bool msi_desc_match(struct msi_desc *desc, enum msi_desc_filter filter)\n{\n\tswitch (filter) {\n\tcase MSI_DESC_ALL:\n\t\treturn true;\n\tcase MSI_DESC_NOTASSOCIATED:\n\t\treturn !desc->irq;\n\tcase MSI_DESC_ASSOCIATED:\n\t\treturn !!desc->irq;\n\t}\n\tWARN_ON_ONCE(1);\n\treturn false;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic bool msi_desc_match(struct msi_desc *desc, enum msi_desc_filter filter)\n{\n\tswitch (filter) {\n\tcase MSI_DESC_ALL:\n\t\treturn true;\n\tcase MSI_DESC_NOTASSOCIATED:\n\t\treturn !desc->irq;\n\tcase MSI_DESC_ASSOCIATED:\n\t\treturn !!desc->irq;\n\t}\n\tWARN_ON_ONCE(1);\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xa_for_each_start",
          "args": [
            "&md->__store",
            "md->__iter_idx",
            "desc",
            "md->__iter_idx"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic struct msi_desc *msi_find_desc(struct msi_device_data *md, enum msi_desc_filter filter)\n{\n\tstruct msi_desc *desc;\n\n\txa_for_each_start(&md->__store, md->__iter_idx, desc, md->__iter_idx) {\n\t\tif (msi_desc_match(desc, filter))\n\t\t\treturn desc;\n\t}\n\tmd->__iter_idx = MSI_MAX_INDEX;\n\treturn NULL;\n}"
  },
  {
    "function_name": "msi_unlock_descs",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "236-241",
    "snippet": "void msi_unlock_descs(struct device *dev)\n{\n\t/* Invalidate the index wich was cached by the iterator */\n\tdev->msi.data->__iter_idx = MSI_MAX_INDEX;\n\tmutex_unlock(&dev->msi.data->mutex);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline int msi_sysfs_create_group(struct device *dev);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&dev->msi.data->mutex"
          ],
          "line": 240
        },
        "resolved": true,
        "details": {
          "function_name": "__rt_mutex_unlock",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/rtmutex.c",
          "lines": "1350-1356",
          "snippet": "static __always_inline void __rt_mutex_unlock(struct rt_mutex_base *lock)\n{\n\tif (likely(rt_mutex_cmpxchg_release(lock, current, NULL)))\n\t\treturn;\n\n\trt_mutex_slowunlock(lock);\n}",
          "includes": [
            "# include \"ww_mutex.h\"",
            "#include \"rtmutex_common.h\"",
            "#include <linux/ww_mutex.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "# include \"ww_mutex.h\"\n#include \"rtmutex_common.h\"\n#include <linux/ww_mutex.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n\nstatic __always_inline struct;\n\nstatic __always_inline void __rt_mutex_unlock(struct rt_mutex_base *lock)\n{\n\tif (likely(rt_mutex_cmpxchg_release(lock, current, NULL)))\n\t\treturn;\n\n\trt_mutex_slowunlock(lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nvoid msi_unlock_descs(struct device *dev)\n{\n\t/* Invalidate the index wich was cached by the iterator */\n\tdev->msi.data->__iter_idx = MSI_MAX_INDEX;\n\tmutex_unlock(&dev->msi.data->mutex);\n}"
  },
  {
    "function_name": "msi_lock_descs",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "226-229",
    "snippet": "void msi_lock_descs(struct device *dev)\n{\n\tmutex_lock(&dev->msi.data->mutex);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline int msi_sysfs_create_group(struct device *dev);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&dev->msi.data->mutex"
          ],
          "line": 228
        },
        "resolved": true,
        "details": {
          "function_name": "mutex_lock_io",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/rtmutex_api.c",
          "lines": "580-586",
          "snippet": "void __sched mutex_lock_io(struct mutex *lock)\n{\n\tint token = io_schedule_prepare();\n\n\t__mutex_lock_common(lock, TASK_UNINTERRUPTIBLE, 0, NULL, _RET_IP_);\n\tio_schedule_finish(token);\n}",
          "includes": [
            "#include \"rtmutex.c\"",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex.c\"\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nvoid __sched mutex_lock_io(struct mutex *lock)\n{\n\tint token = io_schedule_prepare();\n\n\t__mutex_lock_common(lock, TASK_UNINTERRUPTIBLE, 0, NULL, _RET_IP_);\n\tio_schedule_finish(token);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nvoid msi_lock_descs(struct device *dev)\n{\n\tmutex_lock(&dev->msi.data->mutex);\n}"
  },
  {
    "function_name": "msi_setup_device_data",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "197-220",
    "snippet": "int msi_setup_device_data(struct device *dev)\n{\n\tstruct msi_device_data *md;\n\tint ret;\n\n\tif (dev->msi.data)\n\t\treturn 0;\n\n\tmd = devres_alloc(msi_device_data_release, sizeof(*md), GFP_KERNEL);\n\tif (!md)\n\t\treturn -ENOMEM;\n\n\tret = msi_sysfs_create_group(dev);\n\tif (ret) {\n\t\tdevres_free(md);\n\t\treturn ret;\n\t}\n\n\txa_init(&md->__store);\n\tmutex_init(&md->mutex);\n\tdev->msi.data = md;\n\tdevres_add(dev, md);\n\treturn 0;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline int msi_sysfs_create_group(struct device *dev);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "devres_add",
          "args": [
            "dev",
            "md"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_init",
          "args": [
            "&md->mutex"
          ],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "rt_mutex_init_task",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/fork.c",
          "lines": "1700-1708",
          "snippet": "static void rt_mutex_init_task(struct task_struct *p)\n{\n\traw_spin_lock_init(&p->pi_lock);\n#ifdef CONFIG_RT_MUTEXES\n\tp->pi_waiters = RB_ROOT_CACHED;\n\tp->pi_top_task = NULL;\n\tp->pi_blocked_on = NULL;\n#endif\n}",
          "includes": [
            "#include <linux/init_task.h>",
            "#include <trace/events/task.h>",
            "#include <trace/events/sched.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/cacheflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/pgalloc.h>",
            "#include <linux/bpf.h>",
            "#include <linux/io_uring.h>",
            "#include <linux/scs.h>",
            "#include <linux/kasan.h>",
            "#include <linux/stackleak.h>",
            "#include <linux/thread_info.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/kcov.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/compiler.h>",
            "#include <linux/aio.h>",
            "#include <linux/uprobes.h>",
            "#include <linux/signalfd.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/oom.h>",
            "#include <linux/user-return-notifier.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/magic.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/tty.h>",
            "#include <linux/random.h>",
            "#include <linux/taskstats_kern.h>",
            "#include <linux/delayacct.h>",
            "#include <linux/freezer.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <linux/acct.h>",
            "#include <linux/ksm.h>",
            "#include <linux/rmap.h>",
            "#include <linux/profile.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/audit.h>",
            "#include <linux/mount.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/kthread.h>",
            "#include <linux/compat.h>",
            "#include <linux/futex.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/swap.h>",
            "#include <linux/seccomp.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/security.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/vmacache.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/mmu_notifier.h>",
            "#include <linux/mman.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/key.h>",
            "#include <linux/iocontext.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/sem.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/personality.h>",
            "#include <linux/completion.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/module.h>",
            "#include <linux/unistd.h>",
            "#include <linux/init.h>",
            "#include <linux/rtmutex.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/stat.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/user.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/autogroup.h>",
            "#include <linux/slab.h>",
            "#include <linux/anon_inodes.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __latent_entropy struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/init_task.h>\n#include <trace/events/task.h>\n#include <trace/events/sched.h>\n#include <asm/tlbflush.h>\n#include <asm/cacheflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <asm/pgalloc.h>\n#include <linux/bpf.h>\n#include <linux/io_uring.h>\n#include <linux/scs.h>\n#include <linux/kasan.h>\n#include <linux/stackleak.h>\n#include <linux/thread_info.h>\n#include <linux/livepatch.h>\n#include <linux/kcov.h>\n#include <linux/sysctl.h>\n#include <linux/compiler.h>\n#include <linux/aio.h>\n#include <linux/uprobes.h>\n#include <linux/signalfd.h>\n#include <linux/khugepaged.h>\n#include <linux/oom.h>\n#include <linux/user-return-notifier.h>\n#include <linux/posix-timers.h>\n#include <linux/perf_event.h>\n#include <linux/magic.h>\n#include <linux/fs_struct.h>\n#include <linux/tty.h>\n#include <linux/random.h>\n#include <linux/taskstats_kern.h>\n#include <linux/delayacct.h>\n#include <linux/freezer.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/userfaultfd_k.h>\n#include <linux/acct.h>\n#include <linux/ksm.h>\n#include <linux/rmap.h>\n#include <linux/profile.h>\n#include <linux/proc_fs.h>\n#include <linux/ftrace.h>\n#include <linux/memcontrol.h>\n#include <linux/audit.h>\n#include <linux/mount.h>\n#include <linux/ptrace.h>\n#include <linux/rcupdate.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/kthread.h>\n#include <linux/compat.h>\n#include <linux/futex.h>\n#include <linux/jiffies.h>\n#include <linux/syscalls.h>\n#include <linux/swap.h>\n#include <linux/seccomp.h>\n#include <linux/hugetlb.h>\n#include <linux/security.h>\n#include <linux/cgroup.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/nsproxy.h>\n#include <linux/vmacache.h>\n#include <linux/mm_inline.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/mmu_notifier.h>\n#include <linux/mman.h>\n#include <linux/binfmts.h>\n#include <linux/key.h>\n#include <linux/iocontext.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/sem.h>\n#include <linux/mempolicy.h>\n#include <linux/personality.h>\n#include <linux/completion.h>\n#include <linux/vmalloc.h>\n#include <linux/module.h>\n#include <linux/unistd.h>\n#include <linux/init.h>\n#include <linux/rtmutex.h>\n#include <linux/seq_file.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/user.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/autogroup.h>\n#include <linux/slab.h>\n#include <linux/anon_inodes.h>\n\nstatic __latent_entropy struct;\n\nstatic void rt_mutex_init_task(struct task_struct *p)\n{\n\traw_spin_lock_init(&p->pi_lock);\n#ifdef CONFIG_RT_MUTEXES\n\tp->pi_waiters = RB_ROOT_CACHED;\n\tp->pi_top_task = NULL;\n\tp->pi_blocked_on = NULL;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "xa_init",
          "args": [
            "&md->__store"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "devres_free",
          "args": [
            "md"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "msi_sysfs_create_group",
          "args": [
            "dev"
          ],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "msi_sysfs_create_group",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "457-457",
          "snippet": "static inline int msi_sysfs_create_group(struct device *dev) { return 0; }",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline int msi_sysfs_create_group(struct device *dev);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nstatic inline int msi_sysfs_create_group(struct device *dev) { return 0; }"
        }
      },
      {
        "call_info": {
          "callee": "devres_alloc",
          "args": [
            "msi_device_data_release",
            "sizeof(*md)",
            "GFP_KERNEL"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nint msi_setup_device_data(struct device *dev)\n{\n\tstruct msi_device_data *md;\n\tint ret;\n\n\tif (dev->msi.data)\n\t\treturn 0;\n\n\tmd = devres_alloc(msi_device_data_release, sizeof(*md), GFP_KERNEL);\n\tif (!md)\n\t\treturn -ENOMEM;\n\n\tret = msi_sysfs_create_group(dev);\n\tif (ret) {\n\t\tdevres_free(md);\n\t\treturn ret;\n\t}\n\n\txa_init(&md->__store);\n\tmutex_init(&md->mutex);\n\tdev->msi.data = md;\n\tdevres_add(dev, md);\n\treturn 0;\n}"
  },
  {
    "function_name": "msi_device_data_release",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "178-185",
    "snippet": "static void msi_device_data_release(struct device *dev, void *res)\n{\n\tstruct msi_device_data *md = res;\n\n\tWARN_ON_ONCE(!xa_empty(&md->__store));\n\txa_destroy(&md->__store);\n\tdev->msi.data = NULL;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline int msi_sysfs_create_group(struct device *dev);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "xa_destroy",
          "args": [
            "&md->__store"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "!xa_empty(&md->__store)"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xa_empty",
          "args": [
            "&md->__store"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nstatic void msi_device_data_release(struct device *dev, void *res)\n{\n\tstruct msi_device_data *md = res;\n\n\tWARN_ON_ONCE(!xa_empty(&md->__store));\n\txa_destroy(&md->__store);\n\tdev->msi.data = NULL;\n}"
  },
  {
    "function_name": "get_cached_msi_msg",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "170-175",
    "snippet": "void get_cached_msi_msg(unsigned int irq, struct msi_msg *msg)\n{\n\tstruct msi_desc *entry = irq_get_msi_desc(irq);\n\n\t__get_cached_msi_msg(entry, msg);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__get_cached_msi_msg",
          "args": [
            "entry",
            "msg"
          ],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "__get_cached_msi_msg",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "165-168",
          "snippet": "void __get_cached_msi_msg(struct msi_desc *entry, struct msi_msg *msg)\n{\n\t*msg = entry->msg;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nvoid __get_cached_msi_msg(struct msi_desc *entry, struct msi_msg *msg)\n{\n\t*msg = entry->msg;\n}"
        }
      },
      {
        "call_info": {
          "callee": "irq_get_msi_desc",
          "args": [
            "irq"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nvoid get_cached_msi_msg(unsigned int irq, struct msi_msg *msg)\n{\n\tstruct msi_desc *entry = irq_get_msi_desc(irq);\n\n\t__get_cached_msi_msg(entry, msg);\n}"
  },
  {
    "function_name": "__get_cached_msi_msg",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "165-168",
    "snippet": "void __get_cached_msi_msg(struct msi_desc *entry, struct msi_msg *msg)\n{\n\t*msg = entry->msg;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nvoid __get_cached_msi_msg(struct msi_desc *entry, struct msi_msg *msg)\n{\n\t*msg = entry->msg;\n}"
  },
  {
    "function_name": "msi_free_msi_descs_range",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "148-163",
    "snippet": "void msi_free_msi_descs_range(struct device *dev, enum msi_desc_filter filter,\n\t\t\t      unsigned int first_index, unsigned int last_index)\n{\n\tstruct xarray *xa = &dev->msi.data->__store;\n\tstruct msi_desc *desc;\n\tunsigned long idx;\n\n\tlockdep_assert_held(&dev->msi.data->mutex);\n\n\txa_for_each_range(xa, idx, desc, first_index, last_index) {\n\t\tif (msi_desc_match(desc, filter)) {\n\t\t\txa_erase(xa, idx);\n\t\t\tmsi_free_desc(desc);\n\t\t}\n\t}\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline int msi_sysfs_create_group(struct device *dev);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "msi_free_desc",
          "args": [
            "desc"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "msi_free_desc",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "55-59",
          "snippet": "static void msi_free_desc(struct msi_desc *desc)\n{\n\tkfree(desc->affinity);\n\tkfree(desc);\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic void msi_free_desc(struct msi_desc *desc)\n{\n\tkfree(desc->affinity);\n\tkfree(desc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xa_erase",
          "args": [
            "xa",
            "idx"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "msi_desc_match",
          "args": [
            "desc",
            "filter"
          ],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "msi_desc_match",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "127-139",
          "snippet": "static bool msi_desc_match(struct msi_desc *desc, enum msi_desc_filter filter)\n{\n\tswitch (filter) {\n\tcase MSI_DESC_ALL:\n\t\treturn true;\n\tcase MSI_DESC_NOTASSOCIATED:\n\t\treturn !desc->irq;\n\tcase MSI_DESC_ASSOCIATED:\n\t\treturn !!desc->irq;\n\t}\n\tWARN_ON_ONCE(1);\n\treturn false;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic bool msi_desc_match(struct msi_desc *desc, enum msi_desc_filter filter)\n{\n\tswitch (filter) {\n\tcase MSI_DESC_ALL:\n\t\treturn true;\n\tcase MSI_DESC_NOTASSOCIATED:\n\t\treturn !desc->irq;\n\tcase MSI_DESC_ASSOCIATED:\n\t\treturn !!desc->irq;\n\t}\n\tWARN_ON_ONCE(1);\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "xa_for_each_range",
          "args": [
            "xa",
            "idx",
            "desc",
            "first_index",
            "last_index"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lockdep_assert_held",
          "args": [
            "&dev->msi.data->mutex"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nvoid msi_free_msi_descs_range(struct device *dev, enum msi_desc_filter filter,\n\t\t\t      unsigned int first_index, unsigned int last_index)\n{\n\tstruct xarray *xa = &dev->msi.data->__store;\n\tstruct msi_desc *desc;\n\tunsigned long idx;\n\n\tlockdep_assert_held(&dev->msi.data->mutex);\n\n\txa_for_each_range(xa, idx, desc, first_index, last_index) {\n\t\tif (msi_desc_match(desc, filter)) {\n\t\t\txa_erase(xa, idx);\n\t\t\tmsi_free_desc(desc);\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "msi_desc_match",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "127-139",
    "snippet": "static bool msi_desc_match(struct msi_desc *desc, enum msi_desc_filter filter)\n{\n\tswitch (filter) {\n\tcase MSI_DESC_ALL:\n\t\treturn true;\n\tcase MSI_DESC_NOTASSOCIATED:\n\t\treturn !desc->irq;\n\tcase MSI_DESC_ASSOCIATED:\n\t\treturn !!desc->irq;\n\t}\n\tWARN_ON_ONCE(1);\n\treturn false;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WARN_ON_ONCE",
          "args": [
            "1"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic bool msi_desc_match(struct msi_desc *desc, enum msi_desc_filter filter)\n{\n\tswitch (filter) {\n\tcase MSI_DESC_ALL:\n\t\treturn true;\n\tcase MSI_DESC_NOTASSOCIATED:\n\t\treturn !desc->irq;\n\tcase MSI_DESC_ASSOCIATED:\n\t\treturn !!desc->irq;\n\t}\n\tWARN_ON_ONCE(1);\n\treturn false;\n}"
  },
  {
    "function_name": "msi_add_simple_msi_descs",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "102-125",
    "snippet": "static int msi_add_simple_msi_descs(struct device *dev, unsigned int index, unsigned int ndesc)\n{\n\tunsigned int idx, last = index + ndesc - 1;\n\tstruct msi_desc *desc;\n\tint ret;\n\n\tlockdep_assert_held(&dev->msi.data->mutex);\n\n\tfor (idx = index; idx <= last; idx++) {\n\t\tdesc = msi_alloc_desc(dev, 1, NULL);\n\t\tif (!desc)\n\t\t\tgoto fail_mem;\n\t\tret = msi_insert_desc(dev->msi.data, desc, idx);\n\t\tif (ret)\n\t\t\tgoto fail;\n\t}\n\treturn 0;\n\nfail_mem:\n\tret = -ENOMEM;\nfail:\n\tmsi_free_msi_descs_range(dev, MSI_DESC_NOTASSOCIATED, index, last);\n\treturn ret;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline int msi_sysfs_create_group(struct device *dev);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "msi_free_msi_descs_range",
          "args": [
            "dev",
            "MSI_DESC_NOTASSOCIATED",
            "index",
            "last"
          ],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "msi_free_msi_descs_range",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "148-163",
          "snippet": "void msi_free_msi_descs_range(struct device *dev, enum msi_desc_filter filter,\n\t\t\t      unsigned int first_index, unsigned int last_index)\n{\n\tstruct xarray *xa = &dev->msi.data->__store;\n\tstruct msi_desc *desc;\n\tunsigned long idx;\n\n\tlockdep_assert_held(&dev->msi.data->mutex);\n\n\txa_for_each_range(xa, idx, desc, first_index, last_index) {\n\t\tif (msi_desc_match(desc, filter)) {\n\t\t\txa_erase(xa, idx);\n\t\t\tmsi_free_desc(desc);\n\t\t}\n\t}\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline int msi_sysfs_create_group(struct device *dev);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nvoid msi_free_msi_descs_range(struct device *dev, enum msi_desc_filter filter,\n\t\t\t      unsigned int first_index, unsigned int last_index)\n{\n\tstruct xarray *xa = &dev->msi.data->__store;\n\tstruct msi_desc *desc;\n\tunsigned long idx;\n\n\tlockdep_assert_held(&dev->msi.data->mutex);\n\n\txa_for_each_range(xa, idx, desc, first_index, last_index) {\n\t\tif (msi_desc_match(desc, filter)) {\n\t\t\txa_erase(xa, idx);\n\t\t\tmsi_free_desc(desc);\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "msi_insert_desc",
          "args": [
            "dev->msi.data",
            "desc",
            "idx"
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "msi_insert_desc",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "61-70",
          "snippet": "static int msi_insert_desc(struct msi_device_data *md, struct msi_desc *desc, unsigned int index)\n{\n\tint ret;\n\n\tdesc->msi_index = index;\n\tret = xa_insert(&md->__store, index, desc, GFP_KERNEL);\n\tif (ret)\n\t\tmsi_free_desc(desc);\n\treturn ret;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic int msi_insert_desc(struct msi_device_data *md, struct msi_desc *desc, unsigned int index)\n{\n\tint ret;\n\n\tdesc->msi_index = index;\n\tret = xa_insert(&md->__store, index, desc, GFP_KERNEL);\n\tif (ret)\n\t\tmsi_free_desc(desc);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "msi_alloc_desc",
          "args": [
            "dev",
            "1",
            "NULL"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "msi_alloc_desc",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "35-53",
          "snippet": "static struct msi_desc *msi_alloc_desc(struct device *dev, int nvec,\n\t\t\t\t\tconst struct irq_affinity_desc *affinity)\n{\n\tstruct msi_desc *desc = kzalloc(sizeof(*desc), GFP_KERNEL);\n\n\tif (!desc)\n\t\treturn NULL;\n\n\tdesc->dev = dev;\n\tdesc->nvec_used = nvec;\n\tif (affinity) {\n\t\tdesc->affinity = kmemdup(affinity, nvec * sizeof(*desc->affinity), GFP_KERNEL);\n\t\tif (!desc->affinity) {\n\t\t\tkfree(desc);\n\t\t\treturn NULL;\n\t\t}\n\t}\n\treturn desc;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline int msi_sysfs_create_group(struct device *dev);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nstatic struct msi_desc *msi_alloc_desc(struct device *dev, int nvec,\n\t\t\t\t\tconst struct irq_affinity_desc *affinity)\n{\n\tstruct msi_desc *desc = kzalloc(sizeof(*desc), GFP_KERNEL);\n\n\tif (!desc)\n\t\treturn NULL;\n\n\tdesc->dev = dev;\n\tdesc->nvec_used = nvec;\n\tif (affinity) {\n\t\tdesc->affinity = kmemdup(affinity, nvec * sizeof(*desc->affinity), GFP_KERNEL);\n\t\tif (!desc->affinity) {\n\t\t\tkfree(desc);\n\t\t\treturn NULL;\n\t\t}\n\t}\n\treturn desc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lockdep_assert_held",
          "args": [
            "&dev->msi.data->mutex"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nstatic int msi_add_simple_msi_descs(struct device *dev, unsigned int index, unsigned int ndesc)\n{\n\tunsigned int idx, last = index + ndesc - 1;\n\tstruct msi_desc *desc;\n\tint ret;\n\n\tlockdep_assert_held(&dev->msi.data->mutex);\n\n\tfor (idx = index; idx <= last; idx++) {\n\t\tdesc = msi_alloc_desc(dev, 1, NULL);\n\t\tif (!desc)\n\t\t\tgoto fail_mem;\n\t\tret = msi_insert_desc(dev->msi.data, desc, idx);\n\t\tif (ret)\n\t\t\tgoto fail;\n\t}\n\treturn 0;\n\nfail_mem:\n\tret = -ENOMEM;\nfail:\n\tmsi_free_msi_descs_range(dev, MSI_DESC_NOTASSOCIATED, index, last);\n\treturn ret;\n}"
  },
  {
    "function_name": "msi_add_msi_desc",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "79-92",
    "snippet": "int msi_add_msi_desc(struct device *dev, struct msi_desc *init_desc)\n{\n\tstruct msi_desc *desc;\n\n\tlockdep_assert_held(&dev->msi.data->mutex);\n\n\tdesc = msi_alloc_desc(dev, init_desc->nvec_used, init_desc->affinity);\n\tif (!desc)\n\t\treturn -ENOMEM;\n\n\t/* Copy type specific data to the new descriptor. */\n\tdesc->pci = init_desc->pci;\n\treturn msi_insert_desc(dev->msi.data, desc, init_desc->msi_index);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline int msi_sysfs_create_group(struct device *dev);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "msi_insert_desc",
          "args": [
            "dev->msi.data",
            "desc",
            "init_desc->msi_index"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "msi_insert_desc",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "61-70",
          "snippet": "static int msi_insert_desc(struct msi_device_data *md, struct msi_desc *desc, unsigned int index)\n{\n\tint ret;\n\n\tdesc->msi_index = index;\n\tret = xa_insert(&md->__store, index, desc, GFP_KERNEL);\n\tif (ret)\n\t\tmsi_free_desc(desc);\n\treturn ret;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic int msi_insert_desc(struct msi_device_data *md, struct msi_desc *desc, unsigned int index)\n{\n\tint ret;\n\n\tdesc->msi_index = index;\n\tret = xa_insert(&md->__store, index, desc, GFP_KERNEL);\n\tif (ret)\n\t\tmsi_free_desc(desc);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "msi_alloc_desc",
          "args": [
            "dev",
            "init_desc->nvec_used",
            "init_desc->affinity"
          ],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "msi_alloc_desc",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "35-53",
          "snippet": "static struct msi_desc *msi_alloc_desc(struct device *dev, int nvec,\n\t\t\t\t\tconst struct irq_affinity_desc *affinity)\n{\n\tstruct msi_desc *desc = kzalloc(sizeof(*desc), GFP_KERNEL);\n\n\tif (!desc)\n\t\treturn NULL;\n\n\tdesc->dev = dev;\n\tdesc->nvec_used = nvec;\n\tif (affinity) {\n\t\tdesc->affinity = kmemdup(affinity, nvec * sizeof(*desc->affinity), GFP_KERNEL);\n\t\tif (!desc->affinity) {\n\t\t\tkfree(desc);\n\t\t\treturn NULL;\n\t\t}\n\t}\n\treturn desc;\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static inline int msi_sysfs_create_group(struct device *dev);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nstatic struct msi_desc *msi_alloc_desc(struct device *dev, int nvec,\n\t\t\t\t\tconst struct irq_affinity_desc *affinity)\n{\n\tstruct msi_desc *desc = kzalloc(sizeof(*desc), GFP_KERNEL);\n\n\tif (!desc)\n\t\treturn NULL;\n\n\tdesc->dev = dev;\n\tdesc->nvec_used = nvec;\n\tif (affinity) {\n\t\tdesc->affinity = kmemdup(affinity, nvec * sizeof(*desc->affinity), GFP_KERNEL);\n\t\tif (!desc->affinity) {\n\t\t\tkfree(desc);\n\t\t\treturn NULL;\n\t\t}\n\t}\n\treturn desc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lockdep_assert_held",
          "args": [
            "&dev->msi.data->mutex"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nint msi_add_msi_desc(struct device *dev, struct msi_desc *init_desc)\n{\n\tstruct msi_desc *desc;\n\n\tlockdep_assert_held(&dev->msi.data->mutex);\n\n\tdesc = msi_alloc_desc(dev, init_desc->nvec_used, init_desc->affinity);\n\tif (!desc)\n\t\treturn -ENOMEM;\n\n\t/* Copy type specific data to the new descriptor. */\n\tdesc->pci = init_desc->pci;\n\treturn msi_insert_desc(dev->msi.data, desc, init_desc->msi_index);\n}"
  },
  {
    "function_name": "msi_insert_desc",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "61-70",
    "snippet": "static int msi_insert_desc(struct msi_device_data *md, struct msi_desc *desc, unsigned int index)\n{\n\tint ret;\n\n\tdesc->msi_index = index;\n\tret = xa_insert(&md->__store, index, desc, GFP_KERNEL);\n\tif (ret)\n\t\tmsi_free_desc(desc);\n\treturn ret;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "msi_free_desc",
          "args": [
            "desc"
          ],
          "line": 68
        },
        "resolved": true,
        "details": {
          "function_name": "msi_free_desc",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
          "lines": "55-59",
          "snippet": "static void msi_free_desc(struct msi_desc *desc)\n{\n\tkfree(desc->affinity);\n\tkfree(desc);\n}",
          "includes": [
            "#include \"internals.h\"",
            "#include <linux/pci.h>",
            "#include <linux/sysfs.h>",
            "#include <linux/slab.h>",
            "#include <linux/msi.h>",
            "#include <linux/irqdomain.h>",
            "#include <linux/irq.h>",
            "#include <linux/device.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic void msi_free_desc(struct msi_desc *desc)\n{\n\tkfree(desc->affinity);\n\tkfree(desc);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xa_insert",
          "args": [
            "&md->__store",
            "index",
            "desc",
            "GFP_KERNEL"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic int msi_insert_desc(struct msi_device_data *md, struct msi_desc *desc, unsigned int index)\n{\n\tint ret;\n\n\tdesc->msi_index = index;\n\tret = xa_insert(&md->__store, index, desc, GFP_KERNEL);\n\tif (ret)\n\t\tmsi_free_desc(desc);\n\treturn ret;\n}"
  },
  {
    "function_name": "msi_free_desc",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "55-59",
    "snippet": "static void msi_free_desc(struct msi_desc *desc)\n{\n\tkfree(desc->affinity);\n\tkfree(desc);\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "desc"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "maybe_kfree_parameter",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/params.c",
          "lines": "62-75",
          "snippet": "static void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}",
          "includes": [
            "#include <linux/security.h>",
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(kmalloced_params);",
            "static DEFINE_SPINLOCK(kmalloced_params_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/security.h>\n#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(kmalloced_params);\nstatic DEFINE_SPINLOCK(kmalloced_params_lock);\n\nstatic void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic void msi_free_desc(struct msi_desc *desc)\n{\n\tkfree(desc->affinity);\n\tkfree(desc);\n}"
  },
  {
    "function_name": "msi_alloc_desc",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq/msi.c",
    "lines": "35-53",
    "snippet": "static struct msi_desc *msi_alloc_desc(struct device *dev, int nvec,\n\t\t\t\t\tconst struct irq_affinity_desc *affinity)\n{\n\tstruct msi_desc *desc = kzalloc(sizeof(*desc), GFP_KERNEL);\n\n\tif (!desc)\n\t\treturn NULL;\n\n\tdesc->dev = dev;\n\tdesc->nvec_used = nvec;\n\tif (affinity) {\n\t\tdesc->affinity = kmemdup(affinity, nvec * sizeof(*desc->affinity), GFP_KERNEL);\n\t\tif (!desc->affinity) {\n\t\t\tkfree(desc);\n\t\t\treturn NULL;\n\t\t}\n\t}\n\treturn desc;\n}",
    "includes": [
      "#include \"internals.h\"",
      "#include <linux/pci.h>",
      "#include <linux/sysfs.h>",
      "#include <linux/slab.h>",
      "#include <linux/msi.h>",
      "#include <linux/irqdomain.h>",
      "#include <linux/irq.h>",
      "#include <linux/device.h>",
      "#include <linux/types.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static inline int msi_sysfs_create_group(struct device *dev);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "desc"
          ],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "maybe_kfree_parameter",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/params.c",
          "lines": "62-75",
          "snippet": "static void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}",
          "includes": [
            "#include <linux/security.h>",
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(kmalloced_params);",
            "static DEFINE_SPINLOCK(kmalloced_params_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/security.h>\n#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(kmalloced_params);\nstatic DEFINE_SPINLOCK(kmalloced_params_lock);\n\nstatic void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmemdup",
          "args": [
            "affinity",
            "nvec * sizeof(*desc->affinity)",
            "GFP_KERNEL"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(*desc)",
            "GFP_KERNEL"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internals.h\"\n#include <linux/pci.h>\n#include <linux/sysfs.h>\n#include <linux/slab.h>\n#include <linux/msi.h>\n#include <linux/irqdomain.h>\n#include <linux/irq.h>\n#include <linux/device.h>\n#include <linux/types.h>\n\nstatic inline int msi_sysfs_create_group(struct device *dev);\n\nstatic struct msi_desc *msi_alloc_desc(struct device *dev, int nvec,\n\t\t\t\t\tconst struct irq_affinity_desc *affinity)\n{\n\tstruct msi_desc *desc = kzalloc(sizeof(*desc), GFP_KERNEL);\n\n\tif (!desc)\n\t\treturn NULL;\n\n\tdesc->dev = dev;\n\tdesc->nvec_used = nvec;\n\tif (affinity) {\n\t\tdesc->affinity = kmemdup(affinity, nvec * sizeof(*desc->affinity), GFP_KERNEL);\n\t\tif (!desc->affinity) {\n\t\t\tkfree(desc);\n\t\t\treturn NULL;\n\t\t}\n\t}\n\treturn desc;\n}"
  }
]