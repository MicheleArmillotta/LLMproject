[
  {
    "function_name": "__up",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/semaphore.c",
    "lines": "259-266",
    "snippet": "__sched __up(struct semaphore *sem)\n{\n\tstruct semaphore_waiter *waiter = list_first_entry(&sem->wait_list,\n\t\t\t\t\t\tstruct semaphore_waiter, list);\n\tlist_del(&waiter->list);\n\twaiter->up = true;\n\twake_up_process(waiter->task);\n}",
    "includes": [
      "#include <linux/ftrace.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/semaphore.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compiler.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static noinline void __down(struct semaphore *sem);",
      "static noinline int __down_interruptible(struct semaphore *sem);",
      "static noinline int __down_killable(struct semaphore *sem);",
      "static noinline void __up(struct semaphore *sem);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "wake_up_process",
          "args": [
            "waiter->task"
          ],
          "line": 265
        },
        "resolved": true,
        "details": {
          "function_name": "wake_up_process",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/core.c",
          "lines": "4215-4218",
          "snippet": "int wake_up_process(struct task_struct *p)\n{\n\treturn try_to_wake_up(p, TASK_NORMAL, 0);\n}",
          "includes": [
            "#include <linux/entry-common.h>",
            "#include \"features.h\"",
            "#include \"smp.h\"",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../../fs/io-wq.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/scs.h>",
            "#include <linux/kcov.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\"",
            "#include <trace/events/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/entry-common.h>\n#include \"features.h\"\n#include \"smp.h\"\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../../fs/io-wq.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/scs.h>\n#include <linux/kcov.h>\n#include <linux/blkdev.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n#include <trace/events/sched.h>\n\nstatic __always_inline struct;\n\nint wake_up_process(struct task_struct *p)\n{\n\treturn try_to_wake_up(p, TASK_NORMAL, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del",
          "args": [
            "&waiter->list"
          ],
          "line": 263
        },
        "resolved": true,
        "details": {
          "function_name": "list_del_leaf_cfs_rq",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/fair.c",
          "lines": "475-477",
          "snippet": "static inline void list_del_leaf_cfs_rq(struct cfs_rq *cfs_rq)\n{\n}",
          "includes": [
            "#include \"pelt.h\"",
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool sched_idle_cfs_rq(struct cfs_rq *cfs_rq);",
            "static void check_enqueue_throttle(struct cfs_rq *cfs_rq);",
            "static __always_inline void return_cfs_rq_runtime(struct cfs_rq *cfs_rq);",
            "static bool check_cfs_rq_runtime(struct cfs_rq *cfs_rq);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pelt.h\"\n#include \"sched.h\"\n\nstatic bool sched_idle_cfs_rq(struct cfs_rq *cfs_rq);\nstatic void check_enqueue_throttle(struct cfs_rq *cfs_rq);\nstatic __always_inline void return_cfs_rq_runtime(struct cfs_rq *cfs_rq);\nstatic bool check_cfs_rq_runtime(struct cfs_rq *cfs_rq);\n\nstatic inline void list_del_leaf_cfs_rq(struct cfs_rq *cfs_rq)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_first_entry",
          "args": [
            "&sem->wait_list",
            "structsemaphore_waiter",
            "list"
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/ftrace.h>\n#include <linux/spinlock.h>\n#include <linux/semaphore.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n\nstatic noinline void __down(struct semaphore *sem);\nstatic noinline int __down_interruptible(struct semaphore *sem);\nstatic noinline int __down_killable(struct semaphore *sem);\nstatic noinline void __up(struct semaphore *sem);\n\n__sched __up(struct semaphore *sem)\n{\n\tstruct semaphore_waiter *waiter = list_first_entry(&sem->wait_list,\n\t\t\t\t\t\tstruct semaphore_waiter, list);\n\tlist_del(&waiter->list);\n\twaiter->up = true;\n\twake_up_process(waiter->task);\n}"
  },
  {
    "function_name": "__down_timeout",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/semaphore.c",
    "lines": "254-257",
    "snippet": "__sched __down_timeout(struct semaphore *sem, long timeout)\n{\n\treturn __down_common(sem, TASK_UNINTERRUPTIBLE, timeout);\n}",
    "includes": [
      "#include <linux/ftrace.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/semaphore.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compiler.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static noinline void __down(struct semaphore *sem);",
      "static noinline int __down_interruptible(struct semaphore *sem);",
      "static noinline int __down_killable(struct semaphore *sem);",
      "static noinline int __down_timeout(struct semaphore *sem, long timeout);",
      "static noinline void __up(struct semaphore *sem);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__down_common",
          "args": [
            "sem",
            "TASK_UNINTERRUPTIBLE",
            "timeout"
          ],
          "line": 256
        },
        "resolved": true,
        "details": {
          "function_name": "__down_common",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/semaphore.c",
          "lines": "208-237",
          "snippet": "static inline int __sched __down_common(struct semaphore *sem, long state,\n\t\t\t\t\t\t\t\tlong timeout)\n{\n\tstruct semaphore_waiter waiter;\n\n\tlist_add_tail(&waiter.list, &sem->wait_list);\n\twaiter.task = current;\n\twaiter.up = false;\n\n\tfor (;;) {\n\t\tif (signal_pending_state(state, current))\n\t\t\tgoto interrupted;\n\t\tif (unlikely(timeout <= 0))\n\t\t\tgoto timed_out;\n\t\t__set_current_state(state);\n\t\traw_spin_unlock_irq(&sem->lock);\n\t\ttimeout = schedule_timeout(timeout);\n\t\traw_spin_lock_irq(&sem->lock);\n\t\tif (waiter.up)\n\t\t\treturn 0;\n\t}\n\n timed_out:\n\tlist_del(&waiter.list);\n\treturn -ETIME;\n\n interrupted:\n\tlist_del(&waiter.list);\n\treturn -EINTR;\n}",
          "includes": [
            "#include <linux/ftrace.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/semaphore.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compiler.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static noinline void __down(struct semaphore *sem);",
            "static noinline int __down_interruptible(struct semaphore *sem);",
            "static noinline int __down_killable(struct semaphore *sem);",
            "static noinline int __down_timeout(struct semaphore *sem, long timeout);",
            "static noinline void __up(struct semaphore *sem);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ftrace.h>\n#include <linux/spinlock.h>\n#include <linux/semaphore.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n\nstatic noinline void __down(struct semaphore *sem);\nstatic noinline int __down_interruptible(struct semaphore *sem);\nstatic noinline int __down_killable(struct semaphore *sem);\nstatic noinline int __down_timeout(struct semaphore *sem, long timeout);\nstatic noinline void __up(struct semaphore *sem);\n\nstatic inline int __sched __down_common(struct semaphore *sem, long state,\n\t\t\t\t\t\t\t\tlong timeout)\n{\n\tstruct semaphore_waiter waiter;\n\n\tlist_add_tail(&waiter.list, &sem->wait_list);\n\twaiter.task = current;\n\twaiter.up = false;\n\n\tfor (;;) {\n\t\tif (signal_pending_state(state, current))\n\t\t\tgoto interrupted;\n\t\tif (unlikely(timeout <= 0))\n\t\t\tgoto timed_out;\n\t\t__set_current_state(state);\n\t\traw_spin_unlock_irq(&sem->lock);\n\t\ttimeout = schedule_timeout(timeout);\n\t\traw_spin_lock_irq(&sem->lock);\n\t\tif (waiter.up)\n\t\t\treturn 0;\n\t}\n\n timed_out:\n\tlist_del(&waiter.list);\n\treturn -ETIME;\n\n interrupted:\n\tlist_del(&waiter.list);\n\treturn -EINTR;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/ftrace.h>\n#include <linux/spinlock.h>\n#include <linux/semaphore.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n\nstatic noinline void __down(struct semaphore *sem);\nstatic noinline int __down_interruptible(struct semaphore *sem);\nstatic noinline int __down_killable(struct semaphore *sem);\nstatic noinline int __down_timeout(struct semaphore *sem, long timeout);\nstatic noinline void __up(struct semaphore *sem);\n\n__sched __down_timeout(struct semaphore *sem, long timeout)\n{\n\treturn __down_common(sem, TASK_UNINTERRUPTIBLE, timeout);\n}"
  },
  {
    "function_name": "__down_killable",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/semaphore.c",
    "lines": "249-252",
    "snippet": "__sched __down_killable(struct semaphore *sem)\n{\n\treturn __down_common(sem, TASK_KILLABLE, MAX_SCHEDULE_TIMEOUT);\n}",
    "includes": [
      "#include <linux/ftrace.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/semaphore.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compiler.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static noinline void __down(struct semaphore *sem);",
      "static noinline int __down_interruptible(struct semaphore *sem);",
      "static noinline int __down_killable(struct semaphore *sem);",
      "static noinline void __up(struct semaphore *sem);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__down_common",
          "args": [
            "sem",
            "TASK_KILLABLE",
            "MAX_SCHEDULE_TIMEOUT"
          ],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "__down_common",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/semaphore.c",
          "lines": "208-237",
          "snippet": "static inline int __sched __down_common(struct semaphore *sem, long state,\n\t\t\t\t\t\t\t\tlong timeout)\n{\n\tstruct semaphore_waiter waiter;\n\n\tlist_add_tail(&waiter.list, &sem->wait_list);\n\twaiter.task = current;\n\twaiter.up = false;\n\n\tfor (;;) {\n\t\tif (signal_pending_state(state, current))\n\t\t\tgoto interrupted;\n\t\tif (unlikely(timeout <= 0))\n\t\t\tgoto timed_out;\n\t\t__set_current_state(state);\n\t\traw_spin_unlock_irq(&sem->lock);\n\t\ttimeout = schedule_timeout(timeout);\n\t\traw_spin_lock_irq(&sem->lock);\n\t\tif (waiter.up)\n\t\t\treturn 0;\n\t}\n\n timed_out:\n\tlist_del(&waiter.list);\n\treturn -ETIME;\n\n interrupted:\n\tlist_del(&waiter.list);\n\treturn -EINTR;\n}",
          "includes": [
            "#include <linux/ftrace.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/semaphore.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compiler.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static noinline void __down(struct semaphore *sem);",
            "static noinline int __down_interruptible(struct semaphore *sem);",
            "static noinline int __down_killable(struct semaphore *sem);",
            "static noinline int __down_timeout(struct semaphore *sem, long timeout);",
            "static noinline void __up(struct semaphore *sem);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ftrace.h>\n#include <linux/spinlock.h>\n#include <linux/semaphore.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n\nstatic noinline void __down(struct semaphore *sem);\nstatic noinline int __down_interruptible(struct semaphore *sem);\nstatic noinline int __down_killable(struct semaphore *sem);\nstatic noinline int __down_timeout(struct semaphore *sem, long timeout);\nstatic noinline void __up(struct semaphore *sem);\n\nstatic inline int __sched __down_common(struct semaphore *sem, long state,\n\t\t\t\t\t\t\t\tlong timeout)\n{\n\tstruct semaphore_waiter waiter;\n\n\tlist_add_tail(&waiter.list, &sem->wait_list);\n\twaiter.task = current;\n\twaiter.up = false;\n\n\tfor (;;) {\n\t\tif (signal_pending_state(state, current))\n\t\t\tgoto interrupted;\n\t\tif (unlikely(timeout <= 0))\n\t\t\tgoto timed_out;\n\t\t__set_current_state(state);\n\t\traw_spin_unlock_irq(&sem->lock);\n\t\ttimeout = schedule_timeout(timeout);\n\t\traw_spin_lock_irq(&sem->lock);\n\t\tif (waiter.up)\n\t\t\treturn 0;\n\t}\n\n timed_out:\n\tlist_del(&waiter.list);\n\treturn -ETIME;\n\n interrupted:\n\tlist_del(&waiter.list);\n\treturn -EINTR;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/ftrace.h>\n#include <linux/spinlock.h>\n#include <linux/semaphore.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n\nstatic noinline void __down(struct semaphore *sem);\nstatic noinline int __down_interruptible(struct semaphore *sem);\nstatic noinline int __down_killable(struct semaphore *sem);\nstatic noinline void __up(struct semaphore *sem);\n\n__sched __down_killable(struct semaphore *sem)\n{\n\treturn __down_common(sem, TASK_KILLABLE, MAX_SCHEDULE_TIMEOUT);\n}"
  },
  {
    "function_name": "__down_interruptible",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/semaphore.c",
    "lines": "244-247",
    "snippet": "__sched __down_interruptible(struct semaphore *sem)\n{\n\treturn __down_common(sem, TASK_INTERRUPTIBLE, MAX_SCHEDULE_TIMEOUT);\n}",
    "includes": [
      "#include <linux/ftrace.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/semaphore.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compiler.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static noinline void __down(struct semaphore *sem);",
      "static noinline int __down_interruptible(struct semaphore *sem);",
      "static noinline int __down_killable(struct semaphore *sem);",
      "static noinline void __up(struct semaphore *sem);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__down_common",
          "args": [
            "sem",
            "TASK_INTERRUPTIBLE",
            "MAX_SCHEDULE_TIMEOUT"
          ],
          "line": 246
        },
        "resolved": true,
        "details": {
          "function_name": "__down_common",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/semaphore.c",
          "lines": "208-237",
          "snippet": "static inline int __sched __down_common(struct semaphore *sem, long state,\n\t\t\t\t\t\t\t\tlong timeout)\n{\n\tstruct semaphore_waiter waiter;\n\n\tlist_add_tail(&waiter.list, &sem->wait_list);\n\twaiter.task = current;\n\twaiter.up = false;\n\n\tfor (;;) {\n\t\tif (signal_pending_state(state, current))\n\t\t\tgoto interrupted;\n\t\tif (unlikely(timeout <= 0))\n\t\t\tgoto timed_out;\n\t\t__set_current_state(state);\n\t\traw_spin_unlock_irq(&sem->lock);\n\t\ttimeout = schedule_timeout(timeout);\n\t\traw_spin_lock_irq(&sem->lock);\n\t\tif (waiter.up)\n\t\t\treturn 0;\n\t}\n\n timed_out:\n\tlist_del(&waiter.list);\n\treturn -ETIME;\n\n interrupted:\n\tlist_del(&waiter.list);\n\treturn -EINTR;\n}",
          "includes": [
            "#include <linux/ftrace.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/semaphore.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compiler.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static noinline void __down(struct semaphore *sem);",
            "static noinline int __down_interruptible(struct semaphore *sem);",
            "static noinline int __down_killable(struct semaphore *sem);",
            "static noinline int __down_timeout(struct semaphore *sem, long timeout);",
            "static noinline void __up(struct semaphore *sem);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ftrace.h>\n#include <linux/spinlock.h>\n#include <linux/semaphore.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n\nstatic noinline void __down(struct semaphore *sem);\nstatic noinline int __down_interruptible(struct semaphore *sem);\nstatic noinline int __down_killable(struct semaphore *sem);\nstatic noinline int __down_timeout(struct semaphore *sem, long timeout);\nstatic noinline void __up(struct semaphore *sem);\n\nstatic inline int __sched __down_common(struct semaphore *sem, long state,\n\t\t\t\t\t\t\t\tlong timeout)\n{\n\tstruct semaphore_waiter waiter;\n\n\tlist_add_tail(&waiter.list, &sem->wait_list);\n\twaiter.task = current;\n\twaiter.up = false;\n\n\tfor (;;) {\n\t\tif (signal_pending_state(state, current))\n\t\t\tgoto interrupted;\n\t\tif (unlikely(timeout <= 0))\n\t\t\tgoto timed_out;\n\t\t__set_current_state(state);\n\t\traw_spin_unlock_irq(&sem->lock);\n\t\ttimeout = schedule_timeout(timeout);\n\t\traw_spin_lock_irq(&sem->lock);\n\t\tif (waiter.up)\n\t\t\treturn 0;\n\t}\n\n timed_out:\n\tlist_del(&waiter.list);\n\treturn -ETIME;\n\n interrupted:\n\tlist_del(&waiter.list);\n\treturn -EINTR;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/ftrace.h>\n#include <linux/spinlock.h>\n#include <linux/semaphore.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n\nstatic noinline void __down(struct semaphore *sem);\nstatic noinline int __down_interruptible(struct semaphore *sem);\nstatic noinline int __down_killable(struct semaphore *sem);\nstatic noinline void __up(struct semaphore *sem);\n\n__sched __down_interruptible(struct semaphore *sem)\n{\n\treturn __down_common(sem, TASK_INTERRUPTIBLE, MAX_SCHEDULE_TIMEOUT);\n}"
  },
  {
    "function_name": "__down",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/semaphore.c",
    "lines": "239-242",
    "snippet": "__sched __down(struct semaphore *sem)\n{\n\t__down_common(sem, TASK_UNINTERRUPTIBLE, MAX_SCHEDULE_TIMEOUT);\n}",
    "includes": [
      "#include <linux/ftrace.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/semaphore.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compiler.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static noinline void __down(struct semaphore *sem);",
      "static noinline int __down_interruptible(struct semaphore *sem);",
      "static noinline int __down_killable(struct semaphore *sem);",
      "static noinline void __up(struct semaphore *sem);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__down_common",
          "args": [
            "sem",
            "TASK_UNINTERRUPTIBLE",
            "MAX_SCHEDULE_TIMEOUT"
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "__down_common",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/semaphore.c",
          "lines": "208-237",
          "snippet": "static inline int __sched __down_common(struct semaphore *sem, long state,\n\t\t\t\t\t\t\t\tlong timeout)\n{\n\tstruct semaphore_waiter waiter;\n\n\tlist_add_tail(&waiter.list, &sem->wait_list);\n\twaiter.task = current;\n\twaiter.up = false;\n\n\tfor (;;) {\n\t\tif (signal_pending_state(state, current))\n\t\t\tgoto interrupted;\n\t\tif (unlikely(timeout <= 0))\n\t\t\tgoto timed_out;\n\t\t__set_current_state(state);\n\t\traw_spin_unlock_irq(&sem->lock);\n\t\ttimeout = schedule_timeout(timeout);\n\t\traw_spin_lock_irq(&sem->lock);\n\t\tif (waiter.up)\n\t\t\treturn 0;\n\t}\n\n timed_out:\n\tlist_del(&waiter.list);\n\treturn -ETIME;\n\n interrupted:\n\tlist_del(&waiter.list);\n\treturn -EINTR;\n}",
          "includes": [
            "#include <linux/ftrace.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/semaphore.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compiler.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static noinline void __down(struct semaphore *sem);",
            "static noinline int __down_interruptible(struct semaphore *sem);",
            "static noinline int __down_killable(struct semaphore *sem);",
            "static noinline int __down_timeout(struct semaphore *sem, long timeout);",
            "static noinline void __up(struct semaphore *sem);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ftrace.h>\n#include <linux/spinlock.h>\n#include <linux/semaphore.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n\nstatic noinline void __down(struct semaphore *sem);\nstatic noinline int __down_interruptible(struct semaphore *sem);\nstatic noinline int __down_killable(struct semaphore *sem);\nstatic noinline int __down_timeout(struct semaphore *sem, long timeout);\nstatic noinline void __up(struct semaphore *sem);\n\nstatic inline int __sched __down_common(struct semaphore *sem, long state,\n\t\t\t\t\t\t\t\tlong timeout)\n{\n\tstruct semaphore_waiter waiter;\n\n\tlist_add_tail(&waiter.list, &sem->wait_list);\n\twaiter.task = current;\n\twaiter.up = false;\n\n\tfor (;;) {\n\t\tif (signal_pending_state(state, current))\n\t\t\tgoto interrupted;\n\t\tif (unlikely(timeout <= 0))\n\t\t\tgoto timed_out;\n\t\t__set_current_state(state);\n\t\traw_spin_unlock_irq(&sem->lock);\n\t\ttimeout = schedule_timeout(timeout);\n\t\traw_spin_lock_irq(&sem->lock);\n\t\tif (waiter.up)\n\t\t\treturn 0;\n\t}\n\n timed_out:\n\tlist_del(&waiter.list);\n\treturn -ETIME;\n\n interrupted:\n\tlist_del(&waiter.list);\n\treturn -EINTR;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/ftrace.h>\n#include <linux/spinlock.h>\n#include <linux/semaphore.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n\nstatic noinline void __down(struct semaphore *sem);\nstatic noinline int __down_interruptible(struct semaphore *sem);\nstatic noinline int __down_killable(struct semaphore *sem);\nstatic noinline void __up(struct semaphore *sem);\n\n__sched __down(struct semaphore *sem)\n{\n\t__down_common(sem, TASK_UNINTERRUPTIBLE, MAX_SCHEDULE_TIMEOUT);\n}"
  },
  {
    "function_name": "__down_common",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/semaphore.c",
    "lines": "208-237",
    "snippet": "static inline int __sched __down_common(struct semaphore *sem, long state,\n\t\t\t\t\t\t\t\tlong timeout)\n{\n\tstruct semaphore_waiter waiter;\n\n\tlist_add_tail(&waiter.list, &sem->wait_list);\n\twaiter.task = current;\n\twaiter.up = false;\n\n\tfor (;;) {\n\t\tif (signal_pending_state(state, current))\n\t\t\tgoto interrupted;\n\t\tif (unlikely(timeout <= 0))\n\t\t\tgoto timed_out;\n\t\t__set_current_state(state);\n\t\traw_spin_unlock_irq(&sem->lock);\n\t\ttimeout = schedule_timeout(timeout);\n\t\traw_spin_lock_irq(&sem->lock);\n\t\tif (waiter.up)\n\t\t\treturn 0;\n\t}\n\n timed_out:\n\tlist_del(&waiter.list);\n\treturn -ETIME;\n\n interrupted:\n\tlist_del(&waiter.list);\n\treturn -EINTR;\n}",
    "includes": [
      "#include <linux/ftrace.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/semaphore.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compiler.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static noinline void __down(struct semaphore *sem);",
      "static noinline int __down_interruptible(struct semaphore *sem);",
      "static noinline int __down_killable(struct semaphore *sem);",
      "static noinline int __down_timeout(struct semaphore *sem, long timeout);",
      "static noinline void __up(struct semaphore *sem);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_del",
          "args": [
            "&waiter.list"
          ],
          "line": 235
        },
        "resolved": true,
        "details": {
          "function_name": "list_del_leaf_cfs_rq",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/fair.c",
          "lines": "475-477",
          "snippet": "static inline void list_del_leaf_cfs_rq(struct cfs_rq *cfs_rq)\n{\n}",
          "includes": [
            "#include \"pelt.h\"",
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool sched_idle_cfs_rq(struct cfs_rq *cfs_rq);",
            "static void check_enqueue_throttle(struct cfs_rq *cfs_rq);",
            "static __always_inline void return_cfs_rq_runtime(struct cfs_rq *cfs_rq);",
            "static bool check_cfs_rq_runtime(struct cfs_rq *cfs_rq);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pelt.h\"\n#include \"sched.h\"\n\nstatic bool sched_idle_cfs_rq(struct cfs_rq *cfs_rq);\nstatic void check_enqueue_throttle(struct cfs_rq *cfs_rq);\nstatic __always_inline void return_cfs_rq_runtime(struct cfs_rq *cfs_rq);\nstatic bool check_cfs_rq_runtime(struct cfs_rq *cfs_rq);\n\nstatic inline void list_del_leaf_cfs_rq(struct cfs_rq *cfs_rq)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "raw_spin_lock_irq",
          "args": [
            "&sem->lock"
          ],
          "line": 225
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irq",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "168-171",
          "snippet": "void __lockfunc _raw_spin_lock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_lock_irq(lock);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_lock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_lock_irq(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "schedule_timeout",
          "args": [
            "timeout"
          ],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "io_schedule_timeout",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/core.c",
          "lines": "8396-8406",
          "snippet": "long __sched io_schedule_timeout(long timeout)\n{\n\tint token;\n\tlong ret;\n\n\ttoken = io_schedule_prepare();\n\tret = schedule_timeout(timeout);\n\tio_schedule_finish(token);\n\n\treturn ret;\n}",
          "includes": [
            "#include <linux/entry-common.h>",
            "#include \"features.h\"",
            "#include \"smp.h\"",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../../fs/io-wq.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/scs.h>",
            "#include <linux/kcov.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\"",
            "#include <trace/events/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __sched",
            "static void __sched"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/entry-common.h>\n#include \"features.h\"\n#include \"smp.h\"\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../../fs/io-wq.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/scs.h>\n#include <linux/kcov.h>\n#include <linux/blkdev.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n#include <trace/events/sched.h>\n\nstatic void __sched;\nstatic void __sched;\n\nlong __sched io_schedule_timeout(long timeout)\n{\n\tint token;\n\tlong ret;\n\n\ttoken = io_schedule_prepare();\n\tret = schedule_timeout(timeout);\n\tio_schedule_finish(token);\n\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "raw_spin_unlock_irq",
          "args": [
            "&sem->lock"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irq",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "200-203",
          "snippet": "void __lockfunc _raw_spin_unlock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_unlock_irq(lock);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irq(raw_spinlock_t *lock)\n{\n\t__raw_spin_unlock_irq(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__set_current_state",
          "args": [
            "state"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "timeout <= 0"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "signal_pending_state",
          "args": [
            "state",
            "current"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&waiter.list",
            "&sem->wait_list"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/ftrace.h>\n#include <linux/spinlock.h>\n#include <linux/semaphore.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n\nstatic noinline void __down(struct semaphore *sem);\nstatic noinline int __down_interruptible(struct semaphore *sem);\nstatic noinline int __down_killable(struct semaphore *sem);\nstatic noinline int __down_timeout(struct semaphore *sem, long timeout);\nstatic noinline void __up(struct semaphore *sem);\n\nstatic inline int __sched __down_common(struct semaphore *sem, long state,\n\t\t\t\t\t\t\t\tlong timeout)\n{\n\tstruct semaphore_waiter waiter;\n\n\tlist_add_tail(&waiter.list, &sem->wait_list);\n\twaiter.task = current;\n\twaiter.up = false;\n\n\tfor (;;) {\n\t\tif (signal_pending_state(state, current))\n\t\t\tgoto interrupted;\n\t\tif (unlikely(timeout <= 0))\n\t\t\tgoto timed_out;\n\t\t__set_current_state(state);\n\t\traw_spin_unlock_irq(&sem->lock);\n\t\ttimeout = schedule_timeout(timeout);\n\t\traw_spin_lock_irq(&sem->lock);\n\t\tif (waiter.up)\n\t\t\treturn 0;\n\t}\n\n timed_out:\n\tlist_del(&waiter.list);\n\treturn -ETIME;\n\n interrupted:\n\tlist_del(&waiter.list);\n\treturn -EINTR;\n}"
  },
  {
    "function_name": "up",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/semaphore.c",
    "lines": "182-192",
    "snippet": "void up(struct semaphore *sem)\n{\n\tunsigned long flags;\n\n\traw_spin_lock_irqsave(&sem->lock, flags);\n\tif (likely(list_empty(&sem->wait_list)))\n\t\tsem->count++;\n\telse\n\t\t__up(sem);\n\traw_spin_unlock_irqrestore(&sem->lock, flags);\n}",
    "includes": [
      "#include <linux/ftrace.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/semaphore.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compiler.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static noinline void __down(struct semaphore *sem);",
      "static noinline int __down_interruptible(struct semaphore *sem);",
      "static noinline int __down_killable(struct semaphore *sem);",
      "static noinline void __up(struct semaphore *sem);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "raw_spin_unlock_irqrestore",
          "args": [
            "&sem->lock",
            "flags"
          ],
          "line": 191
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irqrestore",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "192-195",
          "snippet": "void __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__up",
          "args": [
            "sem"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "__up",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/semaphore.c",
          "lines": "259-266",
          "snippet": "__sched __up(struct semaphore *sem)\n{\n\tstruct semaphore_waiter *waiter = list_first_entry(&sem->wait_list,\n\t\t\t\t\t\tstruct semaphore_waiter, list);\n\tlist_del(&waiter->list);\n\twaiter->up = true;\n\twake_up_process(waiter->task);\n}",
          "includes": [
            "#include <linux/ftrace.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/semaphore.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compiler.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static noinline void __down(struct semaphore *sem);",
            "static noinline int __down_interruptible(struct semaphore *sem);",
            "static noinline int __down_killable(struct semaphore *sem);",
            "static noinline void __up(struct semaphore *sem);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ftrace.h>\n#include <linux/spinlock.h>\n#include <linux/semaphore.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n\nstatic noinline void __down(struct semaphore *sem);\nstatic noinline int __down_interruptible(struct semaphore *sem);\nstatic noinline int __down_killable(struct semaphore *sem);\nstatic noinline void __up(struct semaphore *sem);\n\n__sched __up(struct semaphore *sem)\n{\n\tstruct semaphore_waiter *waiter = list_first_entry(&sem->wait_list,\n\t\t\t\t\t\tstruct semaphore_waiter, list);\n\tlist_del(&waiter->list);\n\twaiter->up = true;\n\twake_up_process(waiter->task);\n}"
        }
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "list_empty(&sem->wait_list)"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_empty",
          "args": [
            "&sem->wait_list"
          ],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_segcblist_empty",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu_segcblist.h",
          "lines": "41-44",
          "snippet": "static inline bool rcu_segcblist_empty(struct rcu_segcblist *rsclp)\n{\n\treturn !READ_ONCE(rsclp->head);\n}",
          "includes": [
            "#include <linux/rcu_segcblist.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "long rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_init(struct rcu_segcblist *rsclp);",
            "void rcu_segcblist_disable(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);",
            "bool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);",
            "struct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_segcblist.h>\n\nlong rcu_segcblist_n_segment_cbs(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_inc_len(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_init(struct rcu_segcblist *rsclp);\nvoid rcu_segcblist_disable(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_ready_cbs(struct rcu_segcblist *rsclp);\nbool rcu_segcblist_pend_cbs(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_cb(struct rcu_segcblist *rsclp);\nstruct rcu_head *rcu_segcblist_first_pend_cb(struct rcu_segcblist *rsclp);\n\nstatic inline bool rcu_segcblist_empty(struct rcu_segcblist *rsclp)\n{\n\treturn !READ_ONCE(rsclp->head);\n}"
        }
      },
      {
        "call_info": {
          "callee": "raw_spin_lock_irqsave",
          "args": [
            "&sem->lock",
            "flags"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irqsave_nested",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "383-393",
          "snippet": "unsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nunsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/ftrace.h>\n#include <linux/spinlock.h>\n#include <linux/semaphore.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n\nstatic noinline void __down(struct semaphore *sem);\nstatic noinline int __down_interruptible(struct semaphore *sem);\nstatic noinline int __down_killable(struct semaphore *sem);\nstatic noinline void __up(struct semaphore *sem);\n\nvoid up(struct semaphore *sem)\n{\n\tunsigned long flags;\n\n\traw_spin_lock_irqsave(&sem->lock, flags);\n\tif (likely(list_empty(&sem->wait_list)))\n\t\tsem->count++;\n\telse\n\t\t__up(sem);\n\traw_spin_unlock_irqrestore(&sem->lock, flags);\n}"
  },
  {
    "function_name": "down_timeout",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/semaphore.c",
    "lines": "158-172",
    "snippet": "int down_timeout(struct semaphore *sem, long timeout)\n{\n\tunsigned long flags;\n\tint result = 0;\n\n\tmight_sleep();\n\traw_spin_lock_irqsave(&sem->lock, flags);\n\tif (likely(sem->count > 0))\n\t\tsem->count--;\n\telse\n\t\tresult = __down_timeout(sem, timeout);\n\traw_spin_unlock_irqrestore(&sem->lock, flags);\n\n\treturn result;\n}",
    "includes": [
      "#include <linux/ftrace.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/semaphore.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compiler.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static noinline void __down(struct semaphore *sem);",
      "static noinline int __down_interruptible(struct semaphore *sem);",
      "static noinline int __down_killable(struct semaphore *sem);",
      "static noinline int __down_timeout(struct semaphore *sem, long timeout);",
      "static noinline void __up(struct semaphore *sem);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "raw_spin_unlock_irqrestore",
          "args": [
            "&sem->lock",
            "flags"
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irqrestore",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "192-195",
          "snippet": "void __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__down_timeout",
          "args": [
            "sem",
            "timeout"
          ],
          "line": 168
        },
        "resolved": true,
        "details": {
          "function_name": "__down_timeout",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/semaphore.c",
          "lines": "254-257",
          "snippet": "__sched __down_timeout(struct semaphore *sem, long timeout)\n{\n\treturn __down_common(sem, TASK_UNINTERRUPTIBLE, timeout);\n}",
          "includes": [
            "#include <linux/ftrace.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/semaphore.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compiler.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static noinline void __down(struct semaphore *sem);",
            "static noinline int __down_interruptible(struct semaphore *sem);",
            "static noinline int __down_killable(struct semaphore *sem);",
            "static noinline int __down_timeout(struct semaphore *sem, long timeout);",
            "static noinline void __up(struct semaphore *sem);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ftrace.h>\n#include <linux/spinlock.h>\n#include <linux/semaphore.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n\nstatic noinline void __down(struct semaphore *sem);\nstatic noinline int __down_interruptible(struct semaphore *sem);\nstatic noinline int __down_killable(struct semaphore *sem);\nstatic noinline int __down_timeout(struct semaphore *sem, long timeout);\nstatic noinline void __up(struct semaphore *sem);\n\n__sched __down_timeout(struct semaphore *sem, long timeout)\n{\n\treturn __down_common(sem, TASK_UNINTERRUPTIBLE, timeout);\n}"
        }
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "sem->count > 0"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raw_spin_lock_irqsave",
          "args": [
            "&sem->lock",
            "flags"
          ],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irqsave_nested",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "383-393",
          "snippet": "unsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nunsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}"
        }
      },
      {
        "call_info": {
          "callee": "might_sleep",
          "args": [],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/ftrace.h>\n#include <linux/spinlock.h>\n#include <linux/semaphore.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n\nstatic noinline void __down(struct semaphore *sem);\nstatic noinline int __down_interruptible(struct semaphore *sem);\nstatic noinline int __down_killable(struct semaphore *sem);\nstatic noinline int __down_timeout(struct semaphore *sem, long timeout);\nstatic noinline void __up(struct semaphore *sem);\n\nint down_timeout(struct semaphore *sem, long timeout)\n{\n\tunsigned long flags;\n\tint result = 0;\n\n\tmight_sleep();\n\traw_spin_lock_irqsave(&sem->lock, flags);\n\tif (likely(sem->count > 0))\n\t\tsem->count--;\n\telse\n\t\tresult = __down_timeout(sem, timeout);\n\traw_spin_unlock_irqrestore(&sem->lock, flags);\n\n\treturn result;\n}"
  },
  {
    "function_name": "down_trylock",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/semaphore.c",
    "lines": "133-145",
    "snippet": "int down_trylock(struct semaphore *sem)\n{\n\tunsigned long flags;\n\tint count;\n\n\traw_spin_lock_irqsave(&sem->lock, flags);\n\tcount = sem->count - 1;\n\tif (likely(count >= 0))\n\t\tsem->count = count;\n\traw_spin_unlock_irqrestore(&sem->lock, flags);\n\n\treturn (count < 0);\n}",
    "includes": [
      "#include <linux/ftrace.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/semaphore.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compiler.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static noinline void __down(struct semaphore *sem);",
      "static noinline int __down_interruptible(struct semaphore *sem);",
      "static noinline int __down_killable(struct semaphore *sem);",
      "static noinline void __up(struct semaphore *sem);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "raw_spin_unlock_irqrestore",
          "args": [
            "&sem->lock",
            "flags"
          ],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irqrestore",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "192-195",
          "snippet": "void __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "count >= 0"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raw_spin_lock_irqsave",
          "args": [
            "&sem->lock",
            "flags"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irqsave_nested",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "383-393",
          "snippet": "unsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nunsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/ftrace.h>\n#include <linux/spinlock.h>\n#include <linux/semaphore.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n\nstatic noinline void __down(struct semaphore *sem);\nstatic noinline int __down_interruptible(struct semaphore *sem);\nstatic noinline int __down_killable(struct semaphore *sem);\nstatic noinline void __up(struct semaphore *sem);\n\nint down_trylock(struct semaphore *sem)\n{\n\tunsigned long flags;\n\tint count;\n\n\traw_spin_lock_irqsave(&sem->lock, flags);\n\tcount = sem->count - 1;\n\tif (likely(count >= 0))\n\t\tsem->count = count;\n\traw_spin_unlock_irqrestore(&sem->lock, flags);\n\n\treturn (count < 0);\n}"
  },
  {
    "function_name": "down_killable",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/semaphore.c",
    "lines": "103-117",
    "snippet": "int down_killable(struct semaphore *sem)\n{\n\tunsigned long flags;\n\tint result = 0;\n\n\tmight_sleep();\n\traw_spin_lock_irqsave(&sem->lock, flags);\n\tif (likely(sem->count > 0))\n\t\tsem->count--;\n\telse\n\t\tresult = __down_killable(sem);\n\traw_spin_unlock_irqrestore(&sem->lock, flags);\n\n\treturn result;\n}",
    "includes": [
      "#include <linux/ftrace.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/semaphore.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compiler.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static noinline void __down(struct semaphore *sem);",
      "static noinline int __down_interruptible(struct semaphore *sem);",
      "static noinline int __down_killable(struct semaphore *sem);",
      "static noinline void __up(struct semaphore *sem);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "raw_spin_unlock_irqrestore",
          "args": [
            "&sem->lock",
            "flags"
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irqrestore",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "192-195",
          "snippet": "void __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__down_killable",
          "args": [
            "sem"
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "__down_killable",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/semaphore.c",
          "lines": "249-252",
          "snippet": "__sched __down_killable(struct semaphore *sem)\n{\n\treturn __down_common(sem, TASK_KILLABLE, MAX_SCHEDULE_TIMEOUT);\n}",
          "includes": [
            "#include <linux/ftrace.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/semaphore.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compiler.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static noinline void __down(struct semaphore *sem);",
            "static noinline int __down_interruptible(struct semaphore *sem);",
            "static noinline int __down_killable(struct semaphore *sem);",
            "static noinline void __up(struct semaphore *sem);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ftrace.h>\n#include <linux/spinlock.h>\n#include <linux/semaphore.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n\nstatic noinline void __down(struct semaphore *sem);\nstatic noinline int __down_interruptible(struct semaphore *sem);\nstatic noinline int __down_killable(struct semaphore *sem);\nstatic noinline void __up(struct semaphore *sem);\n\n__sched __down_killable(struct semaphore *sem)\n{\n\treturn __down_common(sem, TASK_KILLABLE, MAX_SCHEDULE_TIMEOUT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "sem->count > 0"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raw_spin_lock_irqsave",
          "args": [
            "&sem->lock",
            "flags"
          ],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irqsave_nested",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "383-393",
          "snippet": "unsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nunsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}"
        }
      },
      {
        "call_info": {
          "callee": "might_sleep",
          "args": [],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/ftrace.h>\n#include <linux/spinlock.h>\n#include <linux/semaphore.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n\nstatic noinline void __down(struct semaphore *sem);\nstatic noinline int __down_interruptible(struct semaphore *sem);\nstatic noinline int __down_killable(struct semaphore *sem);\nstatic noinline void __up(struct semaphore *sem);\n\nint down_killable(struct semaphore *sem)\n{\n\tunsigned long flags;\n\tint result = 0;\n\n\tmight_sleep();\n\traw_spin_lock_irqsave(&sem->lock, flags);\n\tif (likely(sem->count > 0))\n\t\tsem->count--;\n\telse\n\t\tresult = __down_killable(sem);\n\traw_spin_unlock_irqrestore(&sem->lock, flags);\n\n\treturn result;\n}"
  },
  {
    "function_name": "down_interruptible",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/semaphore.c",
    "lines": "76-90",
    "snippet": "int down_interruptible(struct semaphore *sem)\n{\n\tunsigned long flags;\n\tint result = 0;\n\n\tmight_sleep();\n\traw_spin_lock_irqsave(&sem->lock, flags);\n\tif (likely(sem->count > 0))\n\t\tsem->count--;\n\telse\n\t\tresult = __down_interruptible(sem);\n\traw_spin_unlock_irqrestore(&sem->lock, flags);\n\n\treturn result;\n}",
    "includes": [
      "#include <linux/ftrace.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/semaphore.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compiler.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static noinline void __down(struct semaphore *sem);",
      "static noinline int __down_interruptible(struct semaphore *sem);",
      "static noinline int __down_killable(struct semaphore *sem);",
      "static noinline void __up(struct semaphore *sem);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "raw_spin_unlock_irqrestore",
          "args": [
            "&sem->lock",
            "flags"
          ],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irqrestore",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "192-195",
          "snippet": "void __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__down_interruptible",
          "args": [
            "sem"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "__down_interruptible",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/semaphore.c",
          "lines": "244-247",
          "snippet": "__sched __down_interruptible(struct semaphore *sem)\n{\n\treturn __down_common(sem, TASK_INTERRUPTIBLE, MAX_SCHEDULE_TIMEOUT);\n}",
          "includes": [
            "#include <linux/ftrace.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/semaphore.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compiler.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static noinline void __down(struct semaphore *sem);",
            "static noinline int __down_interruptible(struct semaphore *sem);",
            "static noinline int __down_killable(struct semaphore *sem);",
            "static noinline void __up(struct semaphore *sem);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ftrace.h>\n#include <linux/spinlock.h>\n#include <linux/semaphore.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n\nstatic noinline void __down(struct semaphore *sem);\nstatic noinline int __down_interruptible(struct semaphore *sem);\nstatic noinline int __down_killable(struct semaphore *sem);\nstatic noinline void __up(struct semaphore *sem);\n\n__sched __down_interruptible(struct semaphore *sem)\n{\n\treturn __down_common(sem, TASK_INTERRUPTIBLE, MAX_SCHEDULE_TIMEOUT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "sem->count > 0"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raw_spin_lock_irqsave",
          "args": [
            "&sem->lock",
            "flags"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irqsave_nested",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "383-393",
          "snippet": "unsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nunsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}"
        }
      },
      {
        "call_info": {
          "callee": "might_sleep",
          "args": [],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/ftrace.h>\n#include <linux/spinlock.h>\n#include <linux/semaphore.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n\nstatic noinline void __down(struct semaphore *sem);\nstatic noinline int __down_interruptible(struct semaphore *sem);\nstatic noinline int __down_killable(struct semaphore *sem);\nstatic noinline void __up(struct semaphore *sem);\n\nint down_interruptible(struct semaphore *sem)\n{\n\tunsigned long flags;\n\tint result = 0;\n\n\tmight_sleep();\n\traw_spin_lock_irqsave(&sem->lock, flags);\n\tif (likely(sem->count > 0))\n\t\tsem->count--;\n\telse\n\t\tresult = __down_interruptible(sem);\n\traw_spin_unlock_irqrestore(&sem->lock, flags);\n\n\treturn result;\n}"
  },
  {
    "function_name": "down",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/semaphore.c",
    "lines": "53-64",
    "snippet": "void down(struct semaphore *sem)\n{\n\tunsigned long flags;\n\n\tmight_sleep();\n\traw_spin_lock_irqsave(&sem->lock, flags);\n\tif (likely(sem->count > 0))\n\t\tsem->count--;\n\telse\n\t\t__down(sem);\n\traw_spin_unlock_irqrestore(&sem->lock, flags);\n}",
    "includes": [
      "#include <linux/ftrace.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/semaphore.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/compiler.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static noinline void __down(struct semaphore *sem);",
      "static noinline int __down_interruptible(struct semaphore *sem);",
      "static noinline int __down_killable(struct semaphore *sem);",
      "static noinline void __up(struct semaphore *sem);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "raw_spin_unlock_irqrestore",
          "args": [
            "&sem->lock",
            "flags"
          ],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irqrestore",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "192-195",
          "snippet": "void __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "__down",
          "args": [
            "sem"
          ],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "__down_killable",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/semaphore.c",
          "lines": "249-252",
          "snippet": "__sched __down_killable(struct semaphore *sem)\n{\n\treturn __down_common(sem, TASK_KILLABLE, MAX_SCHEDULE_TIMEOUT);\n}",
          "includes": [
            "#include <linux/ftrace.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/semaphore.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>",
            "#include <linux/compiler.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static noinline void __down(struct semaphore *sem);",
            "static noinline int __down_interruptible(struct semaphore *sem);",
            "static noinline int __down_killable(struct semaphore *sem);",
            "static noinline void __up(struct semaphore *sem);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/ftrace.h>\n#include <linux/spinlock.h>\n#include <linux/semaphore.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n\nstatic noinline void __down(struct semaphore *sem);\nstatic noinline int __down_interruptible(struct semaphore *sem);\nstatic noinline int __down_killable(struct semaphore *sem);\nstatic noinline void __up(struct semaphore *sem);\n\n__sched __down_killable(struct semaphore *sem)\n{\n\treturn __down_common(sem, TASK_KILLABLE, MAX_SCHEDULE_TIMEOUT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "likely",
          "args": [
            "sem->count > 0"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raw_spin_lock_irqsave",
          "args": [
            "&sem->lock",
            "flags"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irqsave_nested",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "383-393",
          "snippet": "unsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nunsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}"
        }
      },
      {
        "call_info": {
          "callee": "might_sleep",
          "args": [],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/ftrace.h>\n#include <linux/spinlock.h>\n#include <linux/semaphore.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/compiler.h>\n\nstatic noinline void __down(struct semaphore *sem);\nstatic noinline int __down_interruptible(struct semaphore *sem);\nstatic noinline int __down_killable(struct semaphore *sem);\nstatic noinline void __up(struct semaphore *sem);\n\nvoid down(struct semaphore *sem)\n{\n\tunsigned long flags;\n\n\tmight_sleep();\n\traw_spin_lock_irqsave(&sem->lock, flags);\n\tif (likely(sem->count > 0))\n\t\tsem->count--;\n\telse\n\t\t__down(sem);\n\traw_spin_unlock_irqrestore(&sem->lock, flags);\n}"
  }
]