[
  {
    "function_name": "get_css_set",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/cgroup/cgroup-internal.h",
    "lines": "219-222",
    "snippet": "static inline void get_css_set(struct css_set *cset)\n{\n\trefcount_inc(&cset->refcount);\n}",
    "includes": [
      "#include <linux/fs_parser.h>",
      "#include <linux/refcount.h>",
      "#include <linux/list.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernfs.h>",
      "#include <linux/cgroup.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "refcount_inc",
          "args": [
            "&cset->refcount"
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "system_refcount_inc",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/trace/trace_events.c",
          "lines": "53-56",
          "snippet": "static int system_refcount_inc(struct event_subsystem *system)\n{\n\treturn system->ref_count++;\n}",
          "includes": [
            "#include \"trace_output.h\"",
            "#include <asm/setup.h>",
            "#include <trace/syscall.h>",
            "#include <trace/events/sched.h>",
            "#include <linux/delay.h>",
            "#include <linux/slab.h>",
            "#include <linux/sort.h>",
            "#include <linux/ctype.h>",
            "#include <linux/module.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/tracefs.h>",
            "#include <linux/kthread.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/security.h>",
            "#include <linux/workqueue.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_output.h\"\n#include <asm/setup.h>\n#include <trace/syscall.h>\n#include <trace/events/sched.h>\n#include <linux/delay.h>\n#include <linux/slab.h>\n#include <linux/sort.h>\n#include <linux/ctype.h>\n#include <linux/module.h>\n#include <linux/uaccess.h>\n#include <linux/tracefs.h>\n#include <linux/kthread.h>\n#include <linux/spinlock.h>\n#include <linux/security.h>\n#include <linux/workqueue.h>\n\nstatic int system_refcount_inc(struct event_subsystem *system)\n{\n\treturn system->ref_count++;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs_parser.h>\n#include <linux/refcount.h>\n#include <linux/list.h>\n#include <linux/workqueue.h>\n#include <linux/kernfs.h>\n#include <linux/cgroup.h>\n\nstatic inline void get_css_set(struct css_set *cset)\n{\n\trefcount_inc(&cset->refcount);\n}"
  },
  {
    "function_name": "put_css_set",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/cgroup/cgroup-internal.h",
    "lines": "199-214",
    "snippet": "static inline void put_css_set(struct css_set *cset)\n{\n\tunsigned long flags;\n\n\t/*\n\t * Ensure that the refcount doesn't hit zero while any readers\n\t * can see it. Similar to atomic_dec_and_lock(), but for an\n\t * rwlock\n\t */\n\tif (refcount_dec_not_one(&cset->refcount))\n\t\treturn;\n\n\tspin_lock_irqsave(&css_set_lock, flags);\n\tput_css_set_locked(cset);\n\tspin_unlock_irqrestore(&css_set_lock, flags);\n}",
    "includes": [
      "#include <linux/fs_parser.h>",
      "#include <linux/refcount.h>",
      "#include <linux/list.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernfs.h>",
      "#include <linux/cgroup.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock_irqrestore",
          "args": [
            "&css_set_lock",
            "flags"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irqrestore",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "192-195",
          "snippet": "void __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "put_css_set_locked",
          "args": [
            "cset"
          ],
          "line": 212
        },
        "resolved": true,
        "details": {
          "function_name": "put_css_set_locked",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cgroup/cgroup.c",
          "lines": "955-990",
          "snippet": "void put_css_set_locked(struct css_set *cset)\n{\n\tstruct cgrp_cset_link *link, *tmp_link;\n\tstruct cgroup_subsys *ss;\n\tint ssid;\n\n\tlockdep_assert_held(&css_set_lock);\n\n\tif (!refcount_dec_and_test(&cset->refcount))\n\t\treturn;\n\n\tWARN_ON_ONCE(!list_empty(&cset->threaded_csets));\n\n\t/* This css_set is dead. Unlink it and release cgroup and css refs */\n\tfor_each_subsys(ss, ssid) {\n\t\tlist_del(&cset->e_cset_node[ssid]);\n\t\tcss_put(cset->subsys[ssid]);\n\t}\n\thash_del(&cset->hlist);\n\tcss_set_count--;\n\n\tlist_for_each_entry_safe(link, tmp_link, &cset->cgrp_links, cgrp_link) {\n\t\tlist_del(&link->cset_link);\n\t\tlist_del(&link->cgrp_link);\n\t\tif (cgroup_parent(link->cgrp))\n\t\t\tcgroup_put(link->cgrp);\n\t\tkfree(link);\n\t}\n\n\tif (css_set_threaded(cset)) {\n\t\tlist_del(&cset->threaded_csets_node);\n\t\tput_css_set_locked(cset->dom_cset);\n\t}\n\n\tkfree_rcu(cset, rcu_head);\n}",
          "includes": [
            "#include <linux/cgroup_subsys.h>",
            "#include <linux/cgroup_subsys.h>",
            "#include <trace/events/cgroup.h>",
            "#include <net/sock.h>",
            "#include <linux/psi.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/fs_parser.h>",
            "#include <linux/file.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/proc_ns.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/atomic.h>",
            "#include <linux/kthread.h>",
            "#include <linux/idr.h>",
            "#include <linux/hashtable.h>",
            "#include <linux/string.h>",
            "#include <linux/percpu-rwsem.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/slab.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/pagemap.h>",
            "#include <linux/mount.h>",
            "#include <linux/mutex.h>",
            "#include <linux/magic.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init_task.h>",
            "#include <linux/errno.h>",
            "#include <linux/cred.h>",
            "#include <linux/bpf-cgroup.h>",
            "#include \"cgroup-internal.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static int cgroup_apply_control(struct cgroup *cgrp);",
            "static int cgroup_destroy_locked(struct cgroup *cgrp);",
            "static struct cgroup_subsys_state *css_create(struct cgroup *cgrp,\n\t\t\t\t\t      struct cgroup_subsys *ss);",
            "static void kill_css(struct cgroup_subsys_state *css);",
            "static int css_set_count\t= 1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/cgroup_subsys.h>\n#include <linux/cgroup_subsys.h>\n#include <trace/events/cgroup.h>\n#include <net/sock.h>\n#include <linux/psi.h>\n#include <linux/sched/cputime.h>\n#include <linux/fs_parser.h>\n#include <linux/file.h>\n#include <linux/nsproxy.h>\n#include <linux/proc_ns.h>\n#include <linux/cpuset.h>\n#include <linux/atomic.h>\n#include <linux/kthread.h>\n#include <linux/idr.h>\n#include <linux/hashtable.h>\n#include <linux/string.h>\n#include <linux/percpu-rwsem.h>\n#include <linux/spinlock.h>\n#include <linux/slab.h>\n#include <linux/sched/task.h>\n#include <linux/sched.h>\n#include <linux/rcupdate.h>\n#include <linux/proc_fs.h>\n#include <linux/pagemap.h>\n#include <linux/mount.h>\n#include <linux/mutex.h>\n#include <linux/magic.h>\n#include <linux/kernel.h>\n#include <linux/init_task.h>\n#include <linux/errno.h>\n#include <linux/cred.h>\n#include <linux/bpf-cgroup.h>\n#include \"cgroup-internal.h\"\n\nstatic int cgroup_apply_control(struct cgroup *cgrp);\nstatic int cgroup_destroy_locked(struct cgroup *cgrp);\nstatic struct cgroup_subsys_state *css_create(struct cgroup *cgrp,\n\t\t\t\t\t      struct cgroup_subsys *ss);\nstatic void kill_css(struct cgroup_subsys_state *css);\nstatic int css_set_count\t= 1;\n\nvoid put_css_set_locked(struct css_set *cset)\n{\n\tstruct cgrp_cset_link *link, *tmp_link;\n\tstruct cgroup_subsys *ss;\n\tint ssid;\n\n\tlockdep_assert_held(&css_set_lock);\n\n\tif (!refcount_dec_and_test(&cset->refcount))\n\t\treturn;\n\n\tWARN_ON_ONCE(!list_empty(&cset->threaded_csets));\n\n\t/* This css_set is dead. Unlink it and release cgroup and css refs */\n\tfor_each_subsys(ss, ssid) {\n\t\tlist_del(&cset->e_cset_node[ssid]);\n\t\tcss_put(cset->subsys[ssid]);\n\t}\n\thash_del(&cset->hlist);\n\tcss_set_count--;\n\n\tlist_for_each_entry_safe(link, tmp_link, &cset->cgrp_links, cgrp_link) {\n\t\tlist_del(&link->cset_link);\n\t\tlist_del(&link->cgrp_link);\n\t\tif (cgroup_parent(link->cgrp))\n\t\t\tcgroup_put(link->cgrp);\n\t\tkfree(link);\n\t}\n\n\tif (css_set_threaded(cset)) {\n\t\tlist_del(&cset->threaded_csets_node);\n\t\tput_css_set_locked(cset->dom_cset);\n\t}\n\n\tkfree_rcu(cset, rcu_head);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_lock_irqsave",
          "args": [
            "&css_set_lock",
            "flags"
          ],
          "line": 211
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irqsave_nested",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "383-393",
          "snippet": "unsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nunsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}"
        }
      },
      {
        "call_info": {
          "callee": "refcount_dec_not_one",
          "args": [
            "&cset->refcount"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs_parser.h>\n#include <linux/refcount.h>\n#include <linux/list.h>\n#include <linux/workqueue.h>\n#include <linux/kernfs.h>\n#include <linux/cgroup.h>\n\nstatic inline void put_css_set(struct css_set *cset)\n{\n\tunsigned long flags;\n\n\t/*\n\t * Ensure that the refcount doesn't hit zero while any readers\n\t * can see it. Similar to atomic_dec_and_lock(), but for an\n\t * rwlock\n\t */\n\tif (refcount_dec_not_one(&cset->refcount))\n\t\treturn;\n\n\tspin_lock_irqsave(&css_set_lock, flags);\n\tput_css_set_locked(cset);\n\tspin_unlock_irqrestore(&css_set_lock, flags);\n}"
  },
  {
    "function_name": "notify_on_release",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/cgroup/cgroup-internal.h",
    "lines": "192-195",
    "snippet": "static inline bool notify_on_release(const struct cgroup *cgrp)\n{\n\treturn test_bit(CGRP_NOTIFY_ON_RELEASE, &cgrp->flags);\n}",
    "includes": [
      "#include <linux/fs_parser.h>",
      "#include <linux/refcount.h>",
      "#include <linux/list.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernfs.h>",
      "#include <linux/cgroup.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "test_bit",
          "args": [
            "CGRP_NOTIFY_ON_RELEASE",
            "&cgrp->flags"
          ],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "memory_bm_test_bit",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/power/snapshot.c",
          "lines": "849-858",
          "snippet": "static int memory_bm_test_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\treturn test_bit(bit, addr);\n}",
          "includes": [
            "#include \"power.h\"",
            "#include <asm/io.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/set_memory.h>",
            "#include <linux/ktime.h>",
            "#include <linux/compiler.h>",
            "#include <linux/slab.h>",
            "#include <linux/list.h>",
            "#include <linux/highmem.h>",
            "#include <linux/console.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/nmi.h>",
            "#include <linux/memblock.h>",
            "#include <linux/init.h>",
            "#include <linux/device.h>",
            "#include <linux/pm.h>",
            "#include <linux/kernel.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/bitops.h>",
            "#include <linux/delay.h>",
            "#include <linux/suspend.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>",
            "#include <linux/version.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"power.h\"\n#include <asm/io.h>\n#include <asm/tlbflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <linux/set_memory.h>\n#include <linux/ktime.h>\n#include <linux/compiler.h>\n#include <linux/slab.h>\n#include <linux/list.h>\n#include <linux/highmem.h>\n#include <linux/console.h>\n#include <linux/syscalls.h>\n#include <linux/nmi.h>\n#include <linux/memblock.h>\n#include <linux/init.h>\n#include <linux/device.h>\n#include <linux/pm.h>\n#include <linux/kernel.h>\n#include <linux/spinlock.h>\n#include <linux/bitops.h>\n#include <linux/delay.h>\n#include <linux/suspend.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n#include <linux/version.h>\n\nstatic int memory_bm_test_bit(struct memory_bitmap *bm, unsigned long pfn)\n{\n\tvoid *addr;\n\tunsigned int bit;\n\tint error;\n\n\terror = memory_bm_find_bit(bm, pfn, &addr, &bit);\n\tBUG_ON(error);\n\treturn test_bit(bit, addr);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/fs_parser.h>\n#include <linux/refcount.h>\n#include <linux/list.h>\n#include <linux/workqueue.h>\n#include <linux/kernfs.h>\n#include <linux/cgroup.h>\n\nstatic inline bool notify_on_release(const struct cgroup *cgrp)\n{\n\treturn test_bit(CGRP_NOTIFY_ON_RELEASE, &cgrp->flags);\n}"
  },
  {
    "function_name": "cgroup_is_dead",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/cgroup/cgroup-internal.h",
    "lines": "187-190",
    "snippet": "static inline bool cgroup_is_dead(const struct cgroup *cgrp)\n{\n\treturn !(cgrp->self.flags & CSS_ONLINE);\n}",
    "includes": [
      "#include <linux/fs_parser.h>",
      "#include <linux/refcount.h>",
      "#include <linux/list.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernfs.h>",
      "#include <linux/cgroup.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/fs_parser.h>\n#include <linux/refcount.h>\n#include <linux/list.h>\n#include <linux/workqueue.h>\n#include <linux/kernfs.h>\n#include <linux/cgroup.h>\n\nstatic inline bool cgroup_is_dead(const struct cgroup *cgrp)\n{\n\treturn !(cgrp->self.flags & CSS_ONLINE);\n}"
  },
  {
    "function_name": "cgroup_fc2context",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/cgroup/cgroup-internal.h",
    "lines": "61-66",
    "snippet": "static inline struct cgroup_fs_context *cgroup_fc2context(struct fs_context *fc)\n{\n\tstruct kernfs_fs_context *kfc = fc->fs_private;\n\n\treturn container_of(kfc, struct cgroup_fs_context, kfc);\n}",
    "includes": [
      "#include <linux/fs_parser.h>",
      "#include <linux/refcount.h>",
      "#include <linux/list.h>",
      "#include <linux/workqueue.h>",
      "#include <linux/kernfs.h>",
      "#include <linux/cgroup.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "container_of",
          "args": [
            "kfc",
            "structcgroup_fs_context",
            "kfc"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/fs_parser.h>\n#include <linux/refcount.h>\n#include <linux/list.h>\n#include <linux/workqueue.h>\n#include <linux/kernfs.h>\n#include <linux/cgroup.h>\n\nstatic inline struct cgroup_fs_context *cgroup_fc2context(struct fs_context *fc)\n{\n\tstruct kernfs_fs_context *kfc = fc->fs_private;\n\n\treturn container_of(kfc, struct cgroup_fs_context, kfc);\n}"
  }
]