[
  {
    "function_name": "update_curr_stop",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/stop_task.c",
    "lines": "114-116",
    "snippet": "static void update_curr_stop(struct rq *rq)\n{\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic void update_curr_stop(struct rq *rq)\n{\n}"
  },
  {
    "function_name": "prio_changed_stop",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/stop_task.c",
    "lines": "108-112",
    "snippet": "static void\nprio_changed_stop(struct rq *rq, struct task_struct *p, int oldprio)\n{\n\tBUG(); /* how!?, what priority? */\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic void\nprio_changed_stop(struct rq *rq, struct task_struct *p, int oldprio)\n{\n\tBUG(); /* how!?, what priority? */\n}"
  },
  {
    "function_name": "switched_to_stop",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/stop_task.c",
    "lines": "103-106",
    "snippet": "static void switched_to_stop(struct rq *rq, struct task_struct *p)\n{\n\tBUG(); /* its impossible to change to this class */\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic void switched_to_stop(struct rq *rq, struct task_struct *p)\n{\n\tBUG(); /* its impossible to change to this class */\n}"
  },
  {
    "function_name": "task_tick_stop",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/stop_task.c",
    "lines": "99-101",
    "snippet": "static void task_tick_stop(struct rq *rq, struct task_struct *curr, int queued)\n{\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic void task_tick_stop(struct rq *rq, struct task_struct *curr, int queued)\n{\n}"
  },
  {
    "function_name": "put_prev_task_stop",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/stop_task.c",
    "lines": "72-89",
    "snippet": "static void put_prev_task_stop(struct rq *rq, struct task_struct *prev)\n{\n\tstruct task_struct *curr = rq->curr;\n\tu64 delta_exec;\n\n\tdelta_exec = rq_clock_task(rq) - curr->se.exec_start;\n\tif (unlikely((s64)delta_exec < 0))\n\t\tdelta_exec = 0;\n\n\tschedstat_set(curr->stats.exec_max,\n\t\t      max(curr->stats.exec_max, delta_exec));\n\n\tcurr->se.sum_exec_runtime += delta_exec;\n\taccount_group_exec_runtime(curr, delta_exec);\n\n\tcurr->se.exec_start = rq_clock_task(rq);\n\tcgroup_account_cputime(curr, delta_exec);\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cgroup_account_cputime",
          "args": [
            "curr",
            "delta_exec"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "__cgroup_account_cputime",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cgroup/rstat.c",
          "lines": "365-373",
          "snippet": "void __cgroup_account_cputime(struct cgroup *cgrp, u64 delta_exec)\n{\n\tstruct cgroup_rstat_cpu *rstatc;\n\tunsigned long flags;\n\n\trstatc = cgroup_base_stat_cputime_account_begin(cgrp, &flags);\n\trstatc->bstat.cputime.sum_exec_runtime += delta_exec;\n\tcgroup_base_stat_cputime_account_end(cgrp, rstatc, flags);\n}",
          "includes": [
            "#include <linux/sched/cputime.h>",
            "#include \"cgroup-internal.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched/cputime.h>\n#include \"cgroup-internal.h\"\n\nvoid __cgroup_account_cputime(struct cgroup *cgrp, u64 delta_exec)\n{\n\tstruct cgroup_rstat_cpu *rstatc;\n\tunsigned long flags;\n\n\trstatc = cgroup_base_stat_cputime_account_begin(cgrp, &flags);\n\trstatc->bstat.cputime.sum_exec_runtime += delta_exec;\n\tcgroup_base_stat_cputime_account_end(cgrp, rstatc, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rq_clock_task",
          "args": [
            "rq"
          ],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "rq_clock_task",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/sched.h",
          "lines": "1470-1476",
          "snippet": "static inline u64 rq_clock_task(struct rq *rq)\n{\n\tlockdep_assert_rq_held(rq);\n\tassert_clock_updated(rq);\n\n\treturn rq->clock_task;\n}",
          "includes": [
            "#include \"features.h\"",
            "#include \"features.h\"",
            "# include <linux/static_key.h>",
            "#include \"autogroup.h\"",
            "#include \"stats.h\"",
            "#include <linux/psi.h>",
            "#include <linux/cgroup.h>",
            "#include <trace/events/sched.h>",
            "#include \"cpudeadline.h\"",
            "#include \"cpupri.h\"",
            "# include <asm/paravirt.h>",
            "#include <asm/tlb.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/task_work.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/swait.h>",
            "#include <linux/suspend.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/security.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/psi.h>",
            "#include <linux/profile.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/nmi.h>",
            "#include <linux/mmu_context.h>",
            "#include <linux/migrate.h>",
            "#include <linux/membarrier.h>",
            "#include <linux/kthread.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/init_task.h>",
            "#include <linux/energy_model.h>",
            "#include <linux/delayacct.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/ctype.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/cpuidle.h>",
            "#include <linux/cpufreq.h>",
            "#include <linux/context_tracking.h>",
            "#include <linux/compat.h>",
            "#include <linux/bitops.h>",
            "#include <linux/binfmts.h>",
            "#include <uapi/linux/sched/types.h>",
            "#include <linux/sched/xacct.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/user.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/sysctl.h>",
            "#include <linux/sched/stat.h>",
            "#include <linux/sched/smt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/prio.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/nohz.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/loadavg.h>",
            "#include <linux/sched/jobctl.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/sched/init.h>",
            "#include <linux/sched/idle.h>",
            "#include <linux/sched/hotplug.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/sched/cpufreq.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched/autogroup.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern bool raw_spin_rq_trylock(struct rq *rq);",
            "extern void raw_spin_rq_unlock(struct rq *rq);",
            "extern void update_rq_clock(struct rq *rq);",
            "extern struct task_struct *pick_next_task_idle(struct rq *rq);",
            "extern void resched_curr(struct rq *rq);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"features.h\"\n#include \"features.h\"\n# include <linux/static_key.h>\n#include \"autogroup.h\"\n#include \"stats.h\"\n#include <linux/psi.h>\n#include <linux/cgroup.h>\n#include <trace/events/sched.h>\n#include \"cpudeadline.h\"\n#include \"cpupri.h\"\n# include <asm/paravirt.h>\n#include <asm/tlb.h>\n#include <linux/tsacct_kern.h>\n#include <linux/task_work.h>\n#include <linux/syscalls.h>\n#include <linux/swait.h>\n#include <linux/suspend.h>\n#include <linux/stop_machine.h>\n#include <linux/security.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/ratelimit.h>\n#include <linux/psi.h>\n#include <linux/profile.h>\n#include <linux/prefetch.h>\n#include <linux/proc_fs.h>\n#include <linux/nmi.h>\n#include <linux/mmu_context.h>\n#include <linux/migrate.h>\n#include <linux/membarrier.h>\n#include <linux/kthread.h>\n#include <linux/kprobes.h>\n#include <linux/init_task.h>\n#include <linux/energy_model.h>\n#include <linux/delayacct.h>\n#include <linux/debugfs.h>\n#include <linux/ctype.h>\n#include <linux/cpuset.h>\n#include <linux/cpuidle.h>\n#include <linux/cpufreq.h>\n#include <linux/context_tracking.h>\n#include <linux/compat.h>\n#include <linux/bitops.h>\n#include <linux/binfmts.h>\n#include <uapi/linux/sched/types.h>\n#include <linux/sched/xacct.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/user.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/sysctl.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/smt.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/prio.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/nohz.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/jobctl.h>\n#include <linux/sched/isolation.h>\n#include <linux/sched/init.h>\n#include <linux/sched/idle.h>\n#include <linux/sched/hotplug.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/cpufreq.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/clock.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n\nextern bool raw_spin_rq_trylock(struct rq *rq);\nextern void raw_spin_rq_unlock(struct rq *rq);\nextern void update_rq_clock(struct rq *rq);\nextern struct task_struct *pick_next_task_idle(struct rq *rq);\nextern void resched_curr(struct rq *rq);\n\nstatic inline u64 rq_clock_task(struct rq *rq)\n{\n\tlockdep_assert_rq_held(rq);\n\tassert_clock_updated(rq);\n\n\treturn rq->clock_task;\n}"
        }
      },
      {
        "call_info": {
          "callee": "account_group_exec_runtime",
          "args": [
            "curr",
            "delta_exec"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "schedstat_set",
          "args": [
            "curr->stats.exec_max",
            "max(curr->stats.exec_max, delta_exec)"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "max",
          "args": [
            "curr->stats.exec_max",
            "delta_exec"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "wrap_max",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/clock.c",
          "lines": "254-257",
          "snippet": "static inline u64 wrap_max(u64 x, u64 y)\n{\n\treturn (s64)(x - y) > 0 ? x : y;\n}",
          "includes": [
            "#include <linux/sched_clock.h>",
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/sched_clock.h>\n#include \"sched.h\"\n\nstatic inline u64 wrap_max(u64 x, u64 y)\n{\n\treturn (s64)(x - y) > 0 ? x : y;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "(s64)delta_exec < 0"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic void put_prev_task_stop(struct rq *rq, struct task_struct *prev)\n{\n\tstruct task_struct *curr = rq->curr;\n\tu64 delta_exec;\n\n\tdelta_exec = rq_clock_task(rq) - curr->se.exec_start;\n\tif (unlikely((s64)delta_exec < 0))\n\t\tdelta_exec = 0;\n\n\tschedstat_set(curr->stats.exec_max,\n\t\t      max(curr->stats.exec_max, delta_exec));\n\n\tcurr->se.sum_exec_runtime += delta_exec;\n\taccount_group_exec_runtime(curr, delta_exec);\n\n\tcurr->se.exec_start = rq_clock_task(rq);\n\tcgroup_account_cputime(curr, delta_exec);\n}"
  },
  {
    "function_name": "yield_task_stop",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/stop_task.c",
    "lines": "67-70",
    "snippet": "static void yield_task_stop(struct rq *rq)\n{\n\tBUG(); /* the stop task should never yield, its pointless. */\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "DEFINE_SCHED_CLASS(stop) = {\n\n\t.enqueue_task\t\t= enqueue_task_stop,\n\t.dequeue_task\t\t= dequeue_task_stop,\n\t.yield_task\t\t= yield_task_stop,\n\n\t.check_preempt_curr\t= check_preempt_curr_stop,\n\n\t.pick_next_task\t\t= pick_next_task_stop,\n\t.put_prev_task\t\t= put_prev_task_stop,\n\t.set_next_task          = set_next_task_stop,\n\n#ifdef CONFIG_SMP\n\t.balance\t\t= balance_stop,\n\t.pick_task\t\t= pick_task_stop,\n\t.select_task_rq\t\t= select_task_rq_stop,\n\t.set_cpus_allowed\t= set_cpus_allowed_common,\n#endif\n\n\t.task_tick\t\t= task_tick_stop,\n\n\t.prio_changed\t\t= prio_changed_stop,\n\t.switched_to\t\t= switched_to_stop,\n\t.update_curr\t\t= update_curr_stop,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "BUG",
          "args": [],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nDEFINE_SCHED_CLASS(stop) = {\n\n\t.enqueue_task\t\t= enqueue_task_stop,\n\t.dequeue_task\t\t= dequeue_task_stop,\n\t.yield_task\t\t= yield_task_stop,\n\n\t.check_preempt_curr\t= check_preempt_curr_stop,\n\n\t.pick_next_task\t\t= pick_next_task_stop,\n\t.put_prev_task\t\t= put_prev_task_stop,\n\t.set_next_task          = set_next_task_stop,\n\n#ifdef CONFIG_SMP\n\t.balance\t\t= balance_stop,\n\t.pick_task\t\t= pick_task_stop,\n\t.select_task_rq\t\t= select_task_rq_stop,\n\t.set_cpus_allowed\t= set_cpus_allowed_common,\n#endif\n\n\t.task_tick\t\t= task_tick_stop,\n\n\t.prio_changed\t\t= prio_changed_stop,\n\t.switched_to\t\t= switched_to_stop,\n\t.update_curr\t\t= update_curr_stop,\n};\n\nstatic void yield_task_stop(struct rq *rq)\n{\n\tBUG(); /* the stop task should never yield, its pointless. */\n}"
  },
  {
    "function_name": "dequeue_task_stop",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/stop_task.c",
    "lines": "61-65",
    "snippet": "static void\ndequeue_task_stop(struct rq *rq, struct task_struct *p, int flags)\n{\n\tsub_nr_running(rq, 1);\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sub_nr_running",
          "args": [
            "rq",
            "1"
          ],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "sub_nr_running",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/sched.h",
          "lines": "2394-2403",
          "snippet": "static inline void sub_nr_running(struct rq *rq, unsigned count)\n{\n\trq->nr_running -= count;\n\tif (trace_sched_update_nr_running_tp_enabled()) {\n\t\tcall_trace_sched_update_nr_running(rq, -count);\n\t}\n\n\t/* Check if we still need preemption */\n\tsched_update_tick_dependency(rq);\n}",
          "includes": [
            "#include \"features.h\"",
            "#include \"features.h\"",
            "# include <linux/static_key.h>",
            "#include \"autogroup.h\"",
            "#include \"stats.h\"",
            "#include <linux/psi.h>",
            "#include <linux/cgroup.h>",
            "#include <trace/events/sched.h>",
            "#include \"cpudeadline.h\"",
            "#include \"cpupri.h\"",
            "# include <asm/paravirt.h>",
            "#include <asm/tlb.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/task_work.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/swait.h>",
            "#include <linux/suspend.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/security.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/psi.h>",
            "#include <linux/profile.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/nmi.h>",
            "#include <linux/mmu_context.h>",
            "#include <linux/migrate.h>",
            "#include <linux/membarrier.h>",
            "#include <linux/kthread.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/init_task.h>",
            "#include <linux/energy_model.h>",
            "#include <linux/delayacct.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/ctype.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/cpuidle.h>",
            "#include <linux/cpufreq.h>",
            "#include <linux/context_tracking.h>",
            "#include <linux/compat.h>",
            "#include <linux/bitops.h>",
            "#include <linux/binfmts.h>",
            "#include <uapi/linux/sched/types.h>",
            "#include <linux/sched/xacct.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/user.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/sysctl.h>",
            "#include <linux/sched/stat.h>",
            "#include <linux/sched/smt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/prio.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/nohz.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/loadavg.h>",
            "#include <linux/sched/jobctl.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/sched/init.h>",
            "#include <linux/sched/idle.h>",
            "#include <linux/sched/hotplug.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/sched/cpufreq.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched/autogroup.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern void call_trace_sched_update_nr_running(struct rq *rq, int count);",
            "extern bool raw_spin_rq_trylock(struct rq *rq);",
            "extern void raw_spin_rq_unlock(struct rq *rq);",
            "extern void update_rq_clock(struct rq *rq);",
            "extern struct task_struct *pick_next_task_idle(struct rq *rq);",
            "extern void resched_curr(struct rq *rq);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"features.h\"\n#include \"features.h\"\n# include <linux/static_key.h>\n#include \"autogroup.h\"\n#include \"stats.h\"\n#include <linux/psi.h>\n#include <linux/cgroup.h>\n#include <trace/events/sched.h>\n#include \"cpudeadline.h\"\n#include \"cpupri.h\"\n# include <asm/paravirt.h>\n#include <asm/tlb.h>\n#include <linux/tsacct_kern.h>\n#include <linux/task_work.h>\n#include <linux/syscalls.h>\n#include <linux/swait.h>\n#include <linux/suspend.h>\n#include <linux/stop_machine.h>\n#include <linux/security.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/ratelimit.h>\n#include <linux/psi.h>\n#include <linux/profile.h>\n#include <linux/prefetch.h>\n#include <linux/proc_fs.h>\n#include <linux/nmi.h>\n#include <linux/mmu_context.h>\n#include <linux/migrate.h>\n#include <linux/membarrier.h>\n#include <linux/kthread.h>\n#include <linux/kprobes.h>\n#include <linux/init_task.h>\n#include <linux/energy_model.h>\n#include <linux/delayacct.h>\n#include <linux/debugfs.h>\n#include <linux/ctype.h>\n#include <linux/cpuset.h>\n#include <linux/cpuidle.h>\n#include <linux/cpufreq.h>\n#include <linux/context_tracking.h>\n#include <linux/compat.h>\n#include <linux/bitops.h>\n#include <linux/binfmts.h>\n#include <uapi/linux/sched/types.h>\n#include <linux/sched/xacct.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/user.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/sysctl.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/smt.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/prio.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/nohz.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/jobctl.h>\n#include <linux/sched/isolation.h>\n#include <linux/sched/init.h>\n#include <linux/sched/idle.h>\n#include <linux/sched/hotplug.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/cpufreq.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/clock.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n\nextern void call_trace_sched_update_nr_running(struct rq *rq, int count);\nextern bool raw_spin_rq_trylock(struct rq *rq);\nextern void raw_spin_rq_unlock(struct rq *rq);\nextern void update_rq_clock(struct rq *rq);\nextern struct task_struct *pick_next_task_idle(struct rq *rq);\nextern void resched_curr(struct rq *rq);\n\nstatic inline void sub_nr_running(struct rq *rq, unsigned count)\n{\n\trq->nr_running -= count;\n\tif (trace_sched_update_nr_running_tp_enabled()) {\n\t\tcall_trace_sched_update_nr_running(rq, -count);\n\t}\n\n\t/* Check if we still need preemption */\n\tsched_update_tick_dependency(rq);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic void\ndequeue_task_stop(struct rq *rq, struct task_struct *p, int flags)\n{\n\tsub_nr_running(rq, 1);\n}"
  },
  {
    "function_name": "enqueue_task_stop",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/stop_task.c",
    "lines": "55-59",
    "snippet": "static void\nenqueue_task_stop(struct rq *rq, struct task_struct *p, int flags)\n{\n\tadd_nr_running(rq, 1);\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "add_nr_running",
          "args": [
            "rq",
            "1"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "add_nr_running",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/sched.h",
          "lines": "2375-2392",
          "snippet": "static inline void add_nr_running(struct rq *rq, unsigned count)\n{\n\tunsigned prev_nr = rq->nr_running;\n\n\trq->nr_running = prev_nr + count;\n\tif (trace_sched_update_nr_running_tp_enabled()) {\n\t\tcall_trace_sched_update_nr_running(rq, count);\n\t}\n\n#ifdef CONFIG_SMP\n\tif (prev_nr < 2 && rq->nr_running >= 2) {\n\t\tif (!READ_ONCE(rq->rd->overload))\n\t\t\tWRITE_ONCE(rq->rd->overload, 1);\n\t}\n#endif\n\n\tsched_update_tick_dependency(rq);\n}",
          "includes": [
            "#include \"features.h\"",
            "#include \"features.h\"",
            "# include <linux/static_key.h>",
            "#include \"autogroup.h\"",
            "#include \"stats.h\"",
            "#include <linux/psi.h>",
            "#include <linux/cgroup.h>",
            "#include <trace/events/sched.h>",
            "#include \"cpudeadline.h\"",
            "#include \"cpupri.h\"",
            "# include <asm/paravirt.h>",
            "#include <asm/tlb.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/task_work.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/swait.h>",
            "#include <linux/suspend.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/security.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/psi.h>",
            "#include <linux/profile.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/nmi.h>",
            "#include <linux/mmu_context.h>",
            "#include <linux/migrate.h>",
            "#include <linux/membarrier.h>",
            "#include <linux/kthread.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/init_task.h>",
            "#include <linux/energy_model.h>",
            "#include <linux/delayacct.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/ctype.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/cpuidle.h>",
            "#include <linux/cpufreq.h>",
            "#include <linux/context_tracking.h>",
            "#include <linux/compat.h>",
            "#include <linux/bitops.h>",
            "#include <linux/binfmts.h>",
            "#include <uapi/linux/sched/types.h>",
            "#include <linux/sched/xacct.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/user.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/sysctl.h>",
            "#include <linux/sched/stat.h>",
            "#include <linux/sched/smt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/prio.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/nohz.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/loadavg.h>",
            "#include <linux/sched/jobctl.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/sched/init.h>",
            "#include <linux/sched/idle.h>",
            "#include <linux/sched/hotplug.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/sched/cpufreq.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched/autogroup.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern void call_trace_sched_update_nr_running(struct rq *rq, int count);",
            "extern bool raw_spin_rq_trylock(struct rq *rq);",
            "extern void raw_spin_rq_unlock(struct rq *rq);",
            "extern void update_rq_clock(struct rq *rq);",
            "extern struct task_struct *pick_next_task_idle(struct rq *rq);",
            "extern void resched_curr(struct rq *rq);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"features.h\"\n#include \"features.h\"\n# include <linux/static_key.h>\n#include \"autogroup.h\"\n#include \"stats.h\"\n#include <linux/psi.h>\n#include <linux/cgroup.h>\n#include <trace/events/sched.h>\n#include \"cpudeadline.h\"\n#include \"cpupri.h\"\n# include <asm/paravirt.h>\n#include <asm/tlb.h>\n#include <linux/tsacct_kern.h>\n#include <linux/task_work.h>\n#include <linux/syscalls.h>\n#include <linux/swait.h>\n#include <linux/suspend.h>\n#include <linux/stop_machine.h>\n#include <linux/security.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/ratelimit.h>\n#include <linux/psi.h>\n#include <linux/profile.h>\n#include <linux/prefetch.h>\n#include <linux/proc_fs.h>\n#include <linux/nmi.h>\n#include <linux/mmu_context.h>\n#include <linux/migrate.h>\n#include <linux/membarrier.h>\n#include <linux/kthread.h>\n#include <linux/kprobes.h>\n#include <linux/init_task.h>\n#include <linux/energy_model.h>\n#include <linux/delayacct.h>\n#include <linux/debugfs.h>\n#include <linux/ctype.h>\n#include <linux/cpuset.h>\n#include <linux/cpuidle.h>\n#include <linux/cpufreq.h>\n#include <linux/context_tracking.h>\n#include <linux/compat.h>\n#include <linux/bitops.h>\n#include <linux/binfmts.h>\n#include <uapi/linux/sched/types.h>\n#include <linux/sched/xacct.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/user.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/sysctl.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/smt.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/prio.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/nohz.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/jobctl.h>\n#include <linux/sched/isolation.h>\n#include <linux/sched/init.h>\n#include <linux/sched/idle.h>\n#include <linux/sched/hotplug.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/cpufreq.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/clock.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n\nextern void call_trace_sched_update_nr_running(struct rq *rq, int count);\nextern bool raw_spin_rq_trylock(struct rq *rq);\nextern void raw_spin_rq_unlock(struct rq *rq);\nextern void update_rq_clock(struct rq *rq);\nextern struct task_struct *pick_next_task_idle(struct rq *rq);\nextern void resched_curr(struct rq *rq);\n\nstatic inline void add_nr_running(struct rq *rq, unsigned count)\n{\n\tunsigned prev_nr = rq->nr_running;\n\n\trq->nr_running = prev_nr + count;\n\tif (trace_sched_update_nr_running_tp_enabled()) {\n\t\tcall_trace_sched_update_nr_running(rq, count);\n\t}\n\n#ifdef CONFIG_SMP\n\tif (prev_nr < 2 && rq->nr_running >= 2) {\n\t\tif (!READ_ONCE(rq->rd->overload))\n\t\t\tWRITE_ONCE(rq->rd->overload, 1);\n\t}\n#endif\n\n\tsched_update_tick_dependency(rq);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic void\nenqueue_task_stop(struct rq *rq, struct task_struct *p, int flags)\n{\n\tadd_nr_running(rq, 1);\n}"
  },
  {
    "function_name": "pick_next_task_stop",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/stop_task.c",
    "lines": "45-53",
    "snippet": "static struct task_struct *pick_next_task_stop(struct rq *rq)\n{\n\tstruct task_struct *p = pick_task_stop(rq);\n\n\tif (p)\n\t\tset_next_task_stop(rq, p, true);\n\n\treturn p;\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_next_task_stop",
          "args": [
            "rq",
            "p",
            "true"
          ],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "set_next_task_stop",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/stop_task.c",
          "lines": "32-35",
          "snippet": "static void set_next_task_stop(struct rq *rq, struct task_struct *stop, bool first)\n{\n\tstop->se.exec_start = rq_clock_task(rq);\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "DEFINE_SCHED_CLASS(stop) = {\n\n\t.enqueue_task\t\t= enqueue_task_stop,\n\t.dequeue_task\t\t= dequeue_task_stop,\n\t.yield_task\t\t= yield_task_stop,\n\n\t.check_preempt_curr\t= check_preempt_curr_stop,\n\n\t.pick_next_task\t\t= pick_next_task_stop,\n\t.put_prev_task\t\t= put_prev_task_stop,\n\t.set_next_task          = set_next_task_stop,\n\n#ifdef CONFIG_SMP\n\t.balance\t\t= balance_stop,\n\t.pick_task\t\t= pick_task_stop,\n\t.select_task_rq\t\t= select_task_rq_stop,\n\t.set_cpus_allowed\t= set_cpus_allowed_common,\n#endif\n\n\t.task_tick\t\t= task_tick_stop,\n\n\t.prio_changed\t\t= prio_changed_stop,\n\t.switched_to\t\t= switched_to_stop,\n\t.update_curr\t\t= update_curr_stop,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nDEFINE_SCHED_CLASS(stop) = {\n\n\t.enqueue_task\t\t= enqueue_task_stop,\n\t.dequeue_task\t\t= dequeue_task_stop,\n\t.yield_task\t\t= yield_task_stop,\n\n\t.check_preempt_curr\t= check_preempt_curr_stop,\n\n\t.pick_next_task\t\t= pick_next_task_stop,\n\t.put_prev_task\t\t= put_prev_task_stop,\n\t.set_next_task          = set_next_task_stop,\n\n#ifdef CONFIG_SMP\n\t.balance\t\t= balance_stop,\n\t.pick_task\t\t= pick_task_stop,\n\t.select_task_rq\t\t= select_task_rq_stop,\n\t.set_cpus_allowed\t= set_cpus_allowed_common,\n#endif\n\n\t.task_tick\t\t= task_tick_stop,\n\n\t.prio_changed\t\t= prio_changed_stop,\n\t.switched_to\t\t= switched_to_stop,\n\t.update_curr\t\t= update_curr_stop,\n};\n\nstatic void set_next_task_stop(struct rq *rq, struct task_struct *stop, bool first)\n{\n\tstop->se.exec_start = rq_clock_task(rq);\n}"
        }
      },
      {
        "call_info": {
          "callee": "pick_task_stop",
          "args": [
            "rq"
          ],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "pick_task_stop",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/stop_task.c",
          "lines": "37-43",
          "snippet": "static struct task_struct *pick_task_stop(struct rq *rq)\n{\n\tif (!sched_stop_runnable(rq))\n\t\treturn NULL;\n\n\treturn rq->stop;\n}",
          "includes": [
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "DEFINE_SCHED_CLASS(stop) = {\n\n\t.enqueue_task\t\t= enqueue_task_stop,\n\t.dequeue_task\t\t= dequeue_task_stop,\n\t.yield_task\t\t= yield_task_stop,\n\n\t.check_preempt_curr\t= check_preempt_curr_stop,\n\n\t.pick_next_task\t\t= pick_next_task_stop,\n\t.put_prev_task\t\t= put_prev_task_stop,\n\t.set_next_task          = set_next_task_stop,\n\n#ifdef CONFIG_SMP\n\t.balance\t\t= balance_stop,\n\t.pick_task\t\t= pick_task_stop,\n\t.select_task_rq\t\t= select_task_rq_stop,\n\t.set_cpus_allowed\t= set_cpus_allowed_common,\n#endif\n\n\t.task_tick\t\t= task_tick_stop,\n\n\t.prio_changed\t\t= prio_changed_stop,\n\t.switched_to\t\t= switched_to_stop,\n\t.update_curr\t\t= update_curr_stop,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"sched.h\"\n\nDEFINE_SCHED_CLASS(stop) = {\n\n\t.enqueue_task\t\t= enqueue_task_stop,\n\t.dequeue_task\t\t= dequeue_task_stop,\n\t.yield_task\t\t= yield_task_stop,\n\n\t.check_preempt_curr\t= check_preempt_curr_stop,\n\n\t.pick_next_task\t\t= pick_next_task_stop,\n\t.put_prev_task\t\t= put_prev_task_stop,\n\t.set_next_task          = set_next_task_stop,\n\n#ifdef CONFIG_SMP\n\t.balance\t\t= balance_stop,\n\t.pick_task\t\t= pick_task_stop,\n\t.select_task_rq\t\t= select_task_rq_stop,\n\t.set_cpus_allowed\t= set_cpus_allowed_common,\n#endif\n\n\t.task_tick\t\t= task_tick_stop,\n\n\t.prio_changed\t\t= prio_changed_stop,\n\t.switched_to\t\t= switched_to_stop,\n\t.update_curr\t\t= update_curr_stop,\n};\n\nstatic struct task_struct *pick_task_stop(struct rq *rq)\n{\n\tif (!sched_stop_runnable(rq))\n\t\treturn NULL;\n\n\treturn rq->stop;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic struct task_struct *pick_next_task_stop(struct rq *rq)\n{\n\tstruct task_struct *p = pick_task_stop(rq);\n\n\tif (p)\n\t\tset_next_task_stop(rq, p, true);\n\n\treturn p;\n}"
  },
  {
    "function_name": "pick_task_stop",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/stop_task.c",
    "lines": "37-43",
    "snippet": "static struct task_struct *pick_task_stop(struct rq *rq)\n{\n\tif (!sched_stop_runnable(rq))\n\t\treturn NULL;\n\n\treturn rq->stop;\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "DEFINE_SCHED_CLASS(stop) = {\n\n\t.enqueue_task\t\t= enqueue_task_stop,\n\t.dequeue_task\t\t= dequeue_task_stop,\n\t.yield_task\t\t= yield_task_stop,\n\n\t.check_preempt_curr\t= check_preempt_curr_stop,\n\n\t.pick_next_task\t\t= pick_next_task_stop,\n\t.put_prev_task\t\t= put_prev_task_stop,\n\t.set_next_task          = set_next_task_stop,\n\n#ifdef CONFIG_SMP\n\t.balance\t\t= balance_stop,\n\t.pick_task\t\t= pick_task_stop,\n\t.select_task_rq\t\t= select_task_rq_stop,\n\t.set_cpus_allowed\t= set_cpus_allowed_common,\n#endif\n\n\t.task_tick\t\t= task_tick_stop,\n\n\t.prio_changed\t\t= prio_changed_stop,\n\t.switched_to\t\t= switched_to_stop,\n\t.update_curr\t\t= update_curr_stop,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "sched_stop_runnable",
          "args": [
            "rq"
          ],
          "line": 39
        },
        "resolved": true,
        "details": {
          "function_name": "sched_stop_runnable",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/sched.h",
          "lines": "2232-2235",
          "snippet": "static inline bool sched_stop_runnable(struct rq *rq)\n{\n\treturn rq->stop && task_on_rq_queued(rq->stop);\n}",
          "includes": [
            "#include \"features.h\"",
            "#include \"features.h\"",
            "# include <linux/static_key.h>",
            "#include \"autogroup.h\"",
            "#include \"stats.h\"",
            "#include <linux/psi.h>",
            "#include <linux/cgroup.h>",
            "#include <trace/events/sched.h>",
            "#include \"cpudeadline.h\"",
            "#include \"cpupri.h\"",
            "# include <asm/paravirt.h>",
            "#include <asm/tlb.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/task_work.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/swait.h>",
            "#include <linux/suspend.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/security.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/psi.h>",
            "#include <linux/profile.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/nmi.h>",
            "#include <linux/mmu_context.h>",
            "#include <linux/migrate.h>",
            "#include <linux/membarrier.h>",
            "#include <linux/kthread.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/init_task.h>",
            "#include <linux/energy_model.h>",
            "#include <linux/delayacct.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/ctype.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/cpuidle.h>",
            "#include <linux/cpufreq.h>",
            "#include <linux/context_tracking.h>",
            "#include <linux/compat.h>",
            "#include <linux/bitops.h>",
            "#include <linux/binfmts.h>",
            "#include <uapi/linux/sched/types.h>",
            "#include <linux/sched/xacct.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/user.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/sysctl.h>",
            "#include <linux/sched/stat.h>",
            "#include <linux/sched/smt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/prio.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/nohz.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/loadavg.h>",
            "#include <linux/sched/jobctl.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/sched/init.h>",
            "#include <linux/sched/idle.h>",
            "#include <linux/sched/hotplug.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/sched/cpufreq.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched/autogroup.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern bool raw_spin_rq_trylock(struct rq *rq);",
            "extern void raw_spin_rq_unlock(struct rq *rq);",
            "extern void update_rq_clock(struct rq *rq);",
            "extern struct task_struct *pick_next_task_idle(struct rq *rq);",
            "extern void resched_curr(struct rq *rq);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"features.h\"\n#include \"features.h\"\n# include <linux/static_key.h>\n#include \"autogroup.h\"\n#include \"stats.h\"\n#include <linux/psi.h>\n#include <linux/cgroup.h>\n#include <trace/events/sched.h>\n#include \"cpudeadline.h\"\n#include \"cpupri.h\"\n# include <asm/paravirt.h>\n#include <asm/tlb.h>\n#include <linux/tsacct_kern.h>\n#include <linux/task_work.h>\n#include <linux/syscalls.h>\n#include <linux/swait.h>\n#include <linux/suspend.h>\n#include <linux/stop_machine.h>\n#include <linux/security.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/ratelimit.h>\n#include <linux/psi.h>\n#include <linux/profile.h>\n#include <linux/prefetch.h>\n#include <linux/proc_fs.h>\n#include <linux/nmi.h>\n#include <linux/mmu_context.h>\n#include <linux/migrate.h>\n#include <linux/membarrier.h>\n#include <linux/kthread.h>\n#include <linux/kprobes.h>\n#include <linux/init_task.h>\n#include <linux/energy_model.h>\n#include <linux/delayacct.h>\n#include <linux/debugfs.h>\n#include <linux/ctype.h>\n#include <linux/cpuset.h>\n#include <linux/cpuidle.h>\n#include <linux/cpufreq.h>\n#include <linux/context_tracking.h>\n#include <linux/compat.h>\n#include <linux/bitops.h>\n#include <linux/binfmts.h>\n#include <uapi/linux/sched/types.h>\n#include <linux/sched/xacct.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/user.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/sysctl.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/smt.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/prio.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/nohz.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/jobctl.h>\n#include <linux/sched/isolation.h>\n#include <linux/sched/init.h>\n#include <linux/sched/idle.h>\n#include <linux/sched/hotplug.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/cpufreq.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/clock.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n\nextern bool raw_spin_rq_trylock(struct rq *rq);\nextern void raw_spin_rq_unlock(struct rq *rq);\nextern void update_rq_clock(struct rq *rq);\nextern struct task_struct *pick_next_task_idle(struct rq *rq);\nextern void resched_curr(struct rq *rq);\n\nstatic inline bool sched_stop_runnable(struct rq *rq)\n{\n\treturn rq->stop && task_on_rq_queued(rq->stop);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nDEFINE_SCHED_CLASS(stop) = {\n\n\t.enqueue_task\t\t= enqueue_task_stop,\n\t.dequeue_task\t\t= dequeue_task_stop,\n\t.yield_task\t\t= yield_task_stop,\n\n\t.check_preempt_curr\t= check_preempt_curr_stop,\n\n\t.pick_next_task\t\t= pick_next_task_stop,\n\t.put_prev_task\t\t= put_prev_task_stop,\n\t.set_next_task          = set_next_task_stop,\n\n#ifdef CONFIG_SMP\n\t.balance\t\t= balance_stop,\n\t.pick_task\t\t= pick_task_stop,\n\t.select_task_rq\t\t= select_task_rq_stop,\n\t.set_cpus_allowed\t= set_cpus_allowed_common,\n#endif\n\n\t.task_tick\t\t= task_tick_stop,\n\n\t.prio_changed\t\t= prio_changed_stop,\n\t.switched_to\t\t= switched_to_stop,\n\t.update_curr\t\t= update_curr_stop,\n};\n\nstatic struct task_struct *pick_task_stop(struct rq *rq)\n{\n\tif (!sched_stop_runnable(rq))\n\t\treturn NULL;\n\n\treturn rq->stop;\n}"
  },
  {
    "function_name": "set_next_task_stop",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/stop_task.c",
    "lines": "32-35",
    "snippet": "static void set_next_task_stop(struct rq *rq, struct task_struct *stop, bool first)\n{\n\tstop->se.exec_start = rq_clock_task(rq);\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "DEFINE_SCHED_CLASS(stop) = {\n\n\t.enqueue_task\t\t= enqueue_task_stop,\n\t.dequeue_task\t\t= dequeue_task_stop,\n\t.yield_task\t\t= yield_task_stop,\n\n\t.check_preempt_curr\t= check_preempt_curr_stop,\n\n\t.pick_next_task\t\t= pick_next_task_stop,\n\t.put_prev_task\t\t= put_prev_task_stop,\n\t.set_next_task          = set_next_task_stop,\n\n#ifdef CONFIG_SMP\n\t.balance\t\t= balance_stop,\n\t.pick_task\t\t= pick_task_stop,\n\t.select_task_rq\t\t= select_task_rq_stop,\n\t.set_cpus_allowed\t= set_cpus_allowed_common,\n#endif\n\n\t.task_tick\t\t= task_tick_stop,\n\n\t.prio_changed\t\t= prio_changed_stop,\n\t.switched_to\t\t= switched_to_stop,\n\t.update_curr\t\t= update_curr_stop,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "rq_clock_task",
          "args": [
            "rq"
          ],
          "line": 34
        },
        "resolved": true,
        "details": {
          "function_name": "rq_clock_task",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/sched.h",
          "lines": "1470-1476",
          "snippet": "static inline u64 rq_clock_task(struct rq *rq)\n{\n\tlockdep_assert_rq_held(rq);\n\tassert_clock_updated(rq);\n\n\treturn rq->clock_task;\n}",
          "includes": [
            "#include \"features.h\"",
            "#include \"features.h\"",
            "# include <linux/static_key.h>",
            "#include \"autogroup.h\"",
            "#include \"stats.h\"",
            "#include <linux/psi.h>",
            "#include <linux/cgroup.h>",
            "#include <trace/events/sched.h>",
            "#include \"cpudeadline.h\"",
            "#include \"cpupri.h\"",
            "# include <asm/paravirt.h>",
            "#include <asm/tlb.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/task_work.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/swait.h>",
            "#include <linux/suspend.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/security.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/psi.h>",
            "#include <linux/profile.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/nmi.h>",
            "#include <linux/mmu_context.h>",
            "#include <linux/migrate.h>",
            "#include <linux/membarrier.h>",
            "#include <linux/kthread.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/init_task.h>",
            "#include <linux/energy_model.h>",
            "#include <linux/delayacct.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/ctype.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/cpuidle.h>",
            "#include <linux/cpufreq.h>",
            "#include <linux/context_tracking.h>",
            "#include <linux/compat.h>",
            "#include <linux/bitops.h>",
            "#include <linux/binfmts.h>",
            "#include <uapi/linux/sched/types.h>",
            "#include <linux/sched/xacct.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/user.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/sysctl.h>",
            "#include <linux/sched/stat.h>",
            "#include <linux/sched/smt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/prio.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/nohz.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/loadavg.h>",
            "#include <linux/sched/jobctl.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/sched/init.h>",
            "#include <linux/sched/idle.h>",
            "#include <linux/sched/hotplug.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/sched/cpufreq.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched/autogroup.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern bool raw_spin_rq_trylock(struct rq *rq);",
            "extern void raw_spin_rq_unlock(struct rq *rq);",
            "extern void update_rq_clock(struct rq *rq);",
            "extern struct task_struct *pick_next_task_idle(struct rq *rq);",
            "extern void resched_curr(struct rq *rq);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"features.h\"\n#include \"features.h\"\n# include <linux/static_key.h>\n#include \"autogroup.h\"\n#include \"stats.h\"\n#include <linux/psi.h>\n#include <linux/cgroup.h>\n#include <trace/events/sched.h>\n#include \"cpudeadline.h\"\n#include \"cpupri.h\"\n# include <asm/paravirt.h>\n#include <asm/tlb.h>\n#include <linux/tsacct_kern.h>\n#include <linux/task_work.h>\n#include <linux/syscalls.h>\n#include <linux/swait.h>\n#include <linux/suspend.h>\n#include <linux/stop_machine.h>\n#include <linux/security.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/ratelimit.h>\n#include <linux/psi.h>\n#include <linux/profile.h>\n#include <linux/prefetch.h>\n#include <linux/proc_fs.h>\n#include <linux/nmi.h>\n#include <linux/mmu_context.h>\n#include <linux/migrate.h>\n#include <linux/membarrier.h>\n#include <linux/kthread.h>\n#include <linux/kprobes.h>\n#include <linux/init_task.h>\n#include <linux/energy_model.h>\n#include <linux/delayacct.h>\n#include <linux/debugfs.h>\n#include <linux/ctype.h>\n#include <linux/cpuset.h>\n#include <linux/cpuidle.h>\n#include <linux/cpufreq.h>\n#include <linux/context_tracking.h>\n#include <linux/compat.h>\n#include <linux/bitops.h>\n#include <linux/binfmts.h>\n#include <uapi/linux/sched/types.h>\n#include <linux/sched/xacct.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/user.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/sysctl.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/smt.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/prio.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/nohz.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/jobctl.h>\n#include <linux/sched/isolation.h>\n#include <linux/sched/init.h>\n#include <linux/sched/idle.h>\n#include <linux/sched/hotplug.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/cpufreq.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/clock.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n\nextern bool raw_spin_rq_trylock(struct rq *rq);\nextern void raw_spin_rq_unlock(struct rq *rq);\nextern void update_rq_clock(struct rq *rq);\nextern struct task_struct *pick_next_task_idle(struct rq *rq);\nextern void resched_curr(struct rq *rq);\n\nstatic inline u64 rq_clock_task(struct rq *rq)\n{\n\tlockdep_assert_rq_held(rq);\n\tassert_clock_updated(rq);\n\n\treturn rq->clock_task;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nDEFINE_SCHED_CLASS(stop) = {\n\n\t.enqueue_task\t\t= enqueue_task_stop,\n\t.dequeue_task\t\t= dequeue_task_stop,\n\t.yield_task\t\t= yield_task_stop,\n\n\t.check_preempt_curr\t= check_preempt_curr_stop,\n\n\t.pick_next_task\t\t= pick_next_task_stop,\n\t.put_prev_task\t\t= put_prev_task_stop,\n\t.set_next_task          = set_next_task_stop,\n\n#ifdef CONFIG_SMP\n\t.balance\t\t= balance_stop,\n\t.pick_task\t\t= pick_task_stop,\n\t.select_task_rq\t\t= select_task_rq_stop,\n\t.set_cpus_allowed\t= set_cpus_allowed_common,\n#endif\n\n\t.task_tick\t\t= task_tick_stop,\n\n\t.prio_changed\t\t= prio_changed_stop,\n\t.switched_to\t\t= switched_to_stop,\n\t.update_curr\t\t= update_curr_stop,\n};\n\nstatic void set_next_task_stop(struct rq *rq, struct task_struct *stop, bool first)\n{\n\tstop->se.exec_start = rq_clock_task(rq);\n}"
  },
  {
    "function_name": "check_preempt_curr_stop",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/stop_task.c",
    "lines": "26-30",
    "snippet": "static void\ncheck_preempt_curr_stop(struct rq *rq, struct task_struct *p, int flags)\n{\n\t/* we're never preempted */\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic void\ncheck_preempt_curr_stop(struct rq *rq, struct task_struct *p, int flags)\n{\n\t/* we're never preempted */\n}"
  },
  {
    "function_name": "balance_stop",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/stop_task.c",
    "lines": "19-23",
    "snippet": "static int\nbalance_stop(struct rq *rq, struct task_struct *prev, struct rq_flags *rf)\n{\n\treturn sched_stop_runnable(rq);\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sched_stop_runnable",
          "args": [
            "rq"
          ],
          "line": 22
        },
        "resolved": true,
        "details": {
          "function_name": "sched_stop_runnable",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/sched.h",
          "lines": "2232-2235",
          "snippet": "static inline bool sched_stop_runnable(struct rq *rq)\n{\n\treturn rq->stop && task_on_rq_queued(rq->stop);\n}",
          "includes": [
            "#include \"features.h\"",
            "#include \"features.h\"",
            "# include <linux/static_key.h>",
            "#include \"autogroup.h\"",
            "#include \"stats.h\"",
            "#include <linux/psi.h>",
            "#include <linux/cgroup.h>",
            "#include <trace/events/sched.h>",
            "#include \"cpudeadline.h\"",
            "#include \"cpupri.h\"",
            "# include <asm/paravirt.h>",
            "#include <asm/tlb.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/task_work.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/swait.h>",
            "#include <linux/suspend.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/security.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/psi.h>",
            "#include <linux/profile.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/nmi.h>",
            "#include <linux/mmu_context.h>",
            "#include <linux/migrate.h>",
            "#include <linux/membarrier.h>",
            "#include <linux/kthread.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/init_task.h>",
            "#include <linux/energy_model.h>",
            "#include <linux/delayacct.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/ctype.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/cpuidle.h>",
            "#include <linux/cpufreq.h>",
            "#include <linux/context_tracking.h>",
            "#include <linux/compat.h>",
            "#include <linux/bitops.h>",
            "#include <linux/binfmts.h>",
            "#include <uapi/linux/sched/types.h>",
            "#include <linux/sched/xacct.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/user.h>",
            "#include <linux/sched/topology.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/sysctl.h>",
            "#include <linux/sched/stat.h>",
            "#include <linux/sched/smt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/prio.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/nohz.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/loadavg.h>",
            "#include <linux/sched/jobctl.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/sched/init.h>",
            "#include <linux/sched/idle.h>",
            "#include <linux/sched/hotplug.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/sched/cpufreq.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched/autogroup.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "extern bool raw_spin_rq_trylock(struct rq *rq);",
            "extern void raw_spin_rq_unlock(struct rq *rq);",
            "extern void update_rq_clock(struct rq *rq);",
            "extern struct task_struct *pick_next_task_idle(struct rq *rq);",
            "extern void resched_curr(struct rq *rq);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"features.h\"\n#include \"features.h\"\n# include <linux/static_key.h>\n#include \"autogroup.h\"\n#include \"stats.h\"\n#include <linux/psi.h>\n#include <linux/cgroup.h>\n#include <trace/events/sched.h>\n#include \"cpudeadline.h\"\n#include \"cpupri.h\"\n# include <asm/paravirt.h>\n#include <asm/tlb.h>\n#include <linux/tsacct_kern.h>\n#include <linux/task_work.h>\n#include <linux/syscalls.h>\n#include <linux/swait.h>\n#include <linux/suspend.h>\n#include <linux/stop_machine.h>\n#include <linux/security.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/ratelimit.h>\n#include <linux/psi.h>\n#include <linux/profile.h>\n#include <linux/prefetch.h>\n#include <linux/proc_fs.h>\n#include <linux/nmi.h>\n#include <linux/mmu_context.h>\n#include <linux/migrate.h>\n#include <linux/membarrier.h>\n#include <linux/kthread.h>\n#include <linux/kprobes.h>\n#include <linux/init_task.h>\n#include <linux/energy_model.h>\n#include <linux/delayacct.h>\n#include <linux/debugfs.h>\n#include <linux/ctype.h>\n#include <linux/cpuset.h>\n#include <linux/cpuidle.h>\n#include <linux/cpufreq.h>\n#include <linux/context_tracking.h>\n#include <linux/compat.h>\n#include <linux/bitops.h>\n#include <linux/binfmts.h>\n#include <uapi/linux/sched/types.h>\n#include <linux/sched/xacct.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/user.h>\n#include <linux/sched/topology.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/sysctl.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/smt.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/prio.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/nohz.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/loadavg.h>\n#include <linux/sched/jobctl.h>\n#include <linux/sched/isolation.h>\n#include <linux/sched/init.h>\n#include <linux/sched/idle.h>\n#include <linux/sched/hotplug.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/cpufreq.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/clock.h>\n#include <linux/sched/autogroup.h>\n#include <linux/sched.h>\n\nextern bool raw_spin_rq_trylock(struct rq *rq);\nextern void raw_spin_rq_unlock(struct rq *rq);\nextern void update_rq_clock(struct rq *rq);\nextern struct task_struct *pick_next_task_idle(struct rq *rq);\nextern void resched_curr(struct rq *rq);\n\nstatic inline bool sched_stop_runnable(struct rq *rq)\n{\n\treturn rq->stop && task_on_rq_queued(rq->stop);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nstatic int\nbalance_stop(struct rq *rq, struct task_struct *prev, struct rq_flags *rf)\n{\n\treturn sched_stop_runnable(rq);\n}"
  },
  {
    "function_name": "select_task_rq_stop",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/stop_task.c",
    "lines": "13-17",
    "snippet": "static int\nselect_task_rq_stop(struct task_struct *p, int cpu, int flags)\n{\n\treturn task_cpu(p); /* stop tasks as never migrate */\n}",
    "includes": [
      "#include \"sched.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "DEFINE_SCHED_CLASS(stop) = {\n\n\t.enqueue_task\t\t= enqueue_task_stop,\n\t.dequeue_task\t\t= dequeue_task_stop,\n\t.yield_task\t\t= yield_task_stop,\n\n\t.check_preempt_curr\t= check_preempt_curr_stop,\n\n\t.pick_next_task\t\t= pick_next_task_stop,\n\t.put_prev_task\t\t= put_prev_task_stop,\n\t.set_next_task          = set_next_task_stop,\n\n#ifdef CONFIG_SMP\n\t.balance\t\t= balance_stop,\n\t.pick_task\t\t= pick_task_stop,\n\t.select_task_rq\t\t= select_task_rq_stop,\n\t.set_cpus_allowed\t= set_cpus_allowed_common,\n#endif\n\n\t.task_tick\t\t= task_tick_stop,\n\n\t.prio_changed\t\t= prio_changed_stop,\n\t.switched_to\t\t= switched_to_stop,\n\t.update_curr\t\t= update_curr_stop,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "task_cpu",
          "args": [
            "p"
          ],
          "line": 16
        },
        "resolved": true,
        "details": {
          "function_name": "ignore_task_cpu",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/trace/ftrace.c",
          "lines": "7612-7633",
          "snippet": "static void ignore_task_cpu(void *data)\n{\n\tstruct trace_array *tr = data;\n\tstruct trace_pid_list *pid_list;\n\tstruct trace_pid_list *no_pid_list;\n\n\t/*\n\t * This function is called by on_each_cpu() while the\n\t * event_mutex is held.\n\t */\n\tpid_list = rcu_dereference_protected(tr->function_pids,\n\t\t\t\t\t     mutex_is_locked(&ftrace_lock));\n\tno_pid_list = rcu_dereference_protected(tr->function_no_pids,\n\t\t\t\t\t\tmutex_is_locked(&ftrace_lock));\n\n\tif (trace_ignore_this_task(pid_list, no_pid_list, current))\n\t\tthis_cpu_write(tr->array_buffer.data->ftrace_ignore_pid,\n\t\t\t       FTRACE_PID_IGNORE);\n\telse\n\t\tthis_cpu_write(tr->array_buffer.data->ftrace_ignore_pid,\n\t\t\t       current->pid);\n}",
          "includes": [
            "#include \"trace_stat.h\"",
            "#include \"trace_output.h\"",
            "#include \"ftrace_internal.h\"",
            "#include <asm/setup.h>",
            "#include <asm/sections.h>",
            "#include <trace/events/sched.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/hash.h>",
            "#include <linux/list.h>",
            "#include <linux/sort.h>",
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/module.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/kthread.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/tracefs.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/security.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/clocksource.h>",
            "#include <linux/stop_machine.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_stat.h\"\n#include \"trace_output.h\"\n#include \"ftrace_internal.h\"\n#include <asm/setup.h>\n#include <asm/sections.h>\n#include <trace/events/sched.h>\n#include <linux/kprobes.h>\n#include <linux/rcupdate.h>\n#include <linux/hash.h>\n#include <linux/list.h>\n#include <linux/sort.h>\n#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/sysctl.h>\n#include <linux/ftrace.h>\n#include <linux/module.h>\n#include <linux/bsearch.h>\n#include <linux/uaccess.h>\n#include <linux/kthread.h>\n#include <linux/hardirq.h>\n#include <linux/tracefs.h>\n#include <linux/seq_file.h>\n#include <linux/security.h>\n#include <linux/kallsyms.h>\n#include <linux/sched/task.h>\n#include <linux/clocksource.h>\n#include <linux/stop_machine.h>\n\nstatic void ignore_task_cpu(void *data)\n{\n\tstruct trace_array *tr = data;\n\tstruct trace_pid_list *pid_list;\n\tstruct trace_pid_list *no_pid_list;\n\n\t/*\n\t * This function is called by on_each_cpu() while the\n\t * event_mutex is held.\n\t */\n\tpid_list = rcu_dereference_protected(tr->function_pids,\n\t\t\t\t\t     mutex_is_locked(&ftrace_lock));\n\tno_pid_list = rcu_dereference_protected(tr->function_no_pids,\n\t\t\t\t\t\tmutex_is_locked(&ftrace_lock));\n\n\tif (trace_ignore_this_task(pid_list, no_pid_list, current))\n\t\tthis_cpu_write(tr->array_buffer.data->ftrace_ignore_pid,\n\t\t\t       FTRACE_PID_IGNORE);\n\telse\n\t\tthis_cpu_write(tr->array_buffer.data->ftrace_ignore_pid,\n\t\t\t       current->pid);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"sched.h\"\n\nDEFINE_SCHED_CLASS(stop) = {\n\n\t.enqueue_task\t\t= enqueue_task_stop,\n\t.dequeue_task\t\t= dequeue_task_stop,\n\t.yield_task\t\t= yield_task_stop,\n\n\t.check_preempt_curr\t= check_preempt_curr_stop,\n\n\t.pick_next_task\t\t= pick_next_task_stop,\n\t.put_prev_task\t\t= put_prev_task_stop,\n\t.set_next_task          = set_next_task_stop,\n\n#ifdef CONFIG_SMP\n\t.balance\t\t= balance_stop,\n\t.pick_task\t\t= pick_task_stop,\n\t.select_task_rq\t\t= select_task_rq_stop,\n\t.set_cpus_allowed\t= set_cpus_allowed_common,\n#endif\n\n\t.task_tick\t\t= task_tick_stop,\n\n\t.prio_changed\t\t= prio_changed_stop,\n\t.switched_to\t\t= switched_to_stop,\n\t.update_curr\t\t= update_curr_stop,\n};\n\nstatic int\nselect_task_rq_stop(struct task_struct *p, int cpu, int flags)\n{\n\treturn task_cpu(p); /* stop tasks as never migrate */\n}"
  }
]