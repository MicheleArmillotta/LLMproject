[
  {
    "function_name": "ikconfig_cleanup",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/configs.c",
    "lines": "70-73",
    "snippet": "static void __exit ikconfig_cleanup(void)\n{\n\tremove_proc_entry(\"config.gz\", NULL);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include <linux/init.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "remove_proc_entry",
          "args": [
            "\"config.gz\"",
            "NULL"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include <linux/init.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic void __exit ikconfig_cleanup(void)\n{\n\tremove_proc_entry(\"config.gz\", NULL);\n}"
  },
  {
    "function_name": "ikconfig_init",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/configs.c",
    "lines": "55-68",
    "snippet": "static int __init ikconfig_init(void)\n{\n\tstruct proc_dir_entry *entry;\n\n\t/* create the current config file */\n\tentry = proc_create(\"config.gz\", S_IFREG | S_IRUGO, NULL,\n\t\t\t    &config_gz_proc_ops);\n\tif (!entry)\n\t\treturn -ENOMEM;\n\n\tproc_set_size(entry, &kernel_config_data_end - &kernel_config_data);\n\n\treturn 0;\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include <linux/init.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "proc_set_size",
          "args": [
            "entry",
            "&kernel_config_data_end - &kernel_config_data"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "proc_create",
          "args": [
            "\"config.gz\"",
            "S_IFREG | S_IRUGO",
            "NULL",
            "&config_gz_proc_ops"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include <linux/init.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic int __init ikconfig_init(void)\n{\n\tstruct proc_dir_entry *entry;\n\n\t/* create the current config file */\n\tentry = proc_create(\"config.gz\", S_IFREG | S_IRUGO, NULL,\n\t\t\t    &config_gz_proc_ops);\n\tif (!entry)\n\t\treturn -ENOMEM;\n\n\tproc_set_size(entry, &kernel_config_data_end - &kernel_config_data);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "ikconfig_read_current",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/configs.c",
    "lines": "40-48",
    "snippet": "static ssize_t\nikconfig_read_current(struct file *file, char __user *buf,\n\t\t      size_t len, loff_t * offset)\n{\n\treturn simple_read_from_buffer(buf, len, offset,\n\t\t\t\t       &kernel_config_data,\n\t\t\t\t       &kernel_config_data_end -\n\t\t\t\t       &kernel_config_data);\n}",
    "includes": [
      "#include <linux/uaccess.h>",
      "#include <linux/init.h>",
      "#include <linux/seq_file.h>",
      "#include <linux/proc_fs.h>",
      "#include <linux/module.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "simple_read_from_buffer",
          "args": [
            "buf",
            "len",
            "offset",
            "&kernel_config_data",
            "&kernel_config_data_end -\n\t\t\t\t       &kernel_config_data"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/uaccess.h>\n#include <linux/init.h>\n#include <linux/seq_file.h>\n#include <linux/proc_fs.h>\n#include <linux/module.h>\n#include <linux/kernel.h>\n\nstatic ssize_t\nikconfig_read_current(struct file *file, char __user *buf,\n\t\t      size_t len, loff_t * offset)\n{\n\treturn simple_read_from_buffer(buf, len, offset,\n\t\t\t\t       &kernel_config_data,\n\t\t\t\t       &kernel_config_data_end -\n\t\t\t\t       &kernel_config_data);\n}"
  }
]