[
  {
    "function_name": "_braille_unregister_console",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/braille.c",
    "lines": "51-58",
    "snippet": "int\n_braille_unregister_console(struct console *console)\n{\n\tif (console->flags & CON_BRL)\n\t\treturn braille_unregister_console(console);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/console.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "braille_unregister_console",
          "args": [
            "console"
          ],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "_braille_unregister_console",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/braille.c",
          "lines": "51-58",
          "snippet": "int\n_braille_unregister_console(struct console *console)\n{\n\tif (console->flags & CON_BRL)\n\t\treturn braille_unregister_console(console);\n\n\treturn 0;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/console.h>\n#include <linux/kernel.h>\n\nint\n_braille_unregister_console(struct console *console)\n{\n\tif (console->flags & CON_BRL)\n\t\treturn braille_unregister_console(console);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "_braille_register_console",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/braille.c",
    "lines": "37-49",
    "snippet": "int\n_braille_register_console(struct console *console, struct console_cmdline *c)\n{\n\tint rtn = 0;\n\n\tif (c->brl_options) {\n\t\tconsole->flags |= CON_BRL;\n\t\trtn = braille_register_console(console, c->index, c->options,\n\t\t\t\t\t       c->brl_options);\n\t}\n\n\treturn rtn;\n}",
    "includes": [
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/console.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "braille_register_console",
          "args": [
            "console",
            "c->index",
            "c->options",
            "c->brl_options"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/console.h>\n#include <linux/kernel.h>\n\nint\n_braille_register_console(struct console *console, struct console_cmdline *c)\n{\n\tint rtn = 0;\n\n\tif (c->brl_options) {\n\t\tconsole->flags |= CON_BRL;\n\t\trtn = braille_register_console(console, c->index, c->options,\n\t\t\t\t\t       c->brl_options);\n\t}\n\n\treturn rtn;\n}"
  },
  {
    "function_name": "_braille_console_setup",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/braille.c",
    "lines": "12-35",
    "snippet": "int _braille_console_setup(char **str, char **brl_options)\n{\n\tsize_t len;\n\n\tlen = str_has_prefix(*str, \"brl,\");\n\tif (len) {\n\t\t*brl_options = \"\";\n\t\t*str += len;\n\t\treturn 0;\n\t}\n\n\tlen = str_has_prefix(*str, \"brl=\");\n\tif (len) {\n\t\t*brl_options = *str + len;\n\t\t*str = strchr(*brl_options, ',');\n\t\tif (!*str) {\n\t\t\tpr_err(\"need port name after brl=\\n\");\n\t\t\treturn -EINVAL;\n\t\t}\n\t\t*((*str)++) = 0;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include <linux/string.h>",
      "#include <linux/errno.h>",
      "#include <linux/console.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"need port name after brl=\\n\""
          ],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "*brl_options",
            "','"
          ],
          "line": 26
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str_has_prefix",
          "args": [
            "*str",
            "\"brl=\""
          ],
          "line": 23
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str_has_prefix",
          "args": [
            "*str",
            "\"brl,\""
          ],
          "line": 16
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include <linux/string.h>\n#include <linux/errno.h>\n#include <linux/console.h>\n#include <linux/kernel.h>\n\nint _braille_console_setup(char **str, char **brl_options)\n{\n\tsize_t len;\n\n\tlen = str_has_prefix(*str, \"brl,\");\n\tif (len) {\n\t\t*brl_options = \"\";\n\t\t*str += len;\n\t\treturn 0;\n\t}\n\n\tlen = str_has_prefix(*str, \"brl=\");\n\tif (len) {\n\t\t*brl_options = *str + len;\n\t\t*str = strchr(*brl_options, ',');\n\t\tif (!*str) {\n\t\t\tpr_err(\"need port name after brl=\\n\");\n\t\t\treturn -EINVAL;\n\t\t}\n\t\t*((*str)++) = 0;\n\t}\n\n\treturn 0;\n}"
  }
]