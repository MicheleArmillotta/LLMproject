[
  {
    "function_name": "cpu_pm_init",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/cpu_pm.c",
    "lines": "208-212",
    "snippet": "static int cpu_pm_init(void)\n{\n\tregister_syscore_ops(&cpu_pm_syscore_ops);\n\treturn 0;\n}",
    "includes": [
      "#include <linux/syscore_ops.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/notifier.h>",
      "#include <linux/module.h>",
      "#include <linux/cpu_pm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "register_syscore_ops",
          "args": [
            "&cpu_pm_syscore_ops"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/syscore_ops.h>\n#include <linux/spinlock.h>\n#include <linux/notifier.h>\n#include <linux/module.h>\n#include <linux/cpu_pm.h>\n#include <linux/kernel.h>\n\nstatic int cpu_pm_init(void)\n{\n\tregister_syscore_ops(&cpu_pm_syscore_ops);\n\treturn 0;\n}"
  },
  {
    "function_name": "cpu_pm_resume",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/cpu_pm.c",
    "lines": "197-201",
    "snippet": "static void cpu_pm_resume(void)\n{\n\tcpu_cluster_pm_exit();\n\tcpu_pm_exit();\n}",
    "includes": [
      "#include <linux/syscore_ops.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/notifier.h>",
      "#include <linux/module.h>",
      "#include <linux/cpu_pm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_pm_exit",
          "args": [],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_pm_exit",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cpu_pm.c",
          "lines": "135-138",
          "snippet": "int cpu_pm_exit(void)\n{\n\treturn cpu_pm_notify(CPU_PM_EXIT);\n}",
          "includes": [
            "#include <linux/syscore_ops.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/notifier.h>",
            "#include <linux/module.h>",
            "#include <linux/cpu_pm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/syscore_ops.h>\n#include <linux/spinlock.h>\n#include <linux/notifier.h>\n#include <linux/module.h>\n#include <linux/cpu_pm.h>\n#include <linux/kernel.h>\n\nint cpu_pm_exit(void)\n{\n\treturn cpu_pm_notify(CPU_PM_EXIT);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_cluster_pm_exit",
          "args": [],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_cluster_pm_exit",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cpu_pm.c",
          "lines": "178-181",
          "snippet": "int cpu_cluster_pm_exit(void)\n{\n\treturn cpu_pm_notify(CPU_CLUSTER_PM_EXIT);\n}",
          "includes": [
            "#include <linux/syscore_ops.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/notifier.h>",
            "#include <linux/module.h>",
            "#include <linux/cpu_pm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/syscore_ops.h>\n#include <linux/spinlock.h>\n#include <linux/notifier.h>\n#include <linux/module.h>\n#include <linux/cpu_pm.h>\n#include <linux/kernel.h>\n\nint cpu_cluster_pm_exit(void)\n{\n\treturn cpu_pm_notify(CPU_CLUSTER_PM_EXIT);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/syscore_ops.h>\n#include <linux/spinlock.h>\n#include <linux/notifier.h>\n#include <linux/module.h>\n#include <linux/cpu_pm.h>\n#include <linux/kernel.h>\n\nstatic void cpu_pm_resume(void)\n{\n\tcpu_cluster_pm_exit();\n\tcpu_pm_exit();\n}"
  },
  {
    "function_name": "cpu_pm_suspend",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/cpu_pm.c",
    "lines": "185-195",
    "snippet": "static int cpu_pm_suspend(void)\n{\n\tint ret;\n\n\tret = cpu_pm_enter();\n\tif (ret)\n\t\treturn ret;\n\n\tret = cpu_cluster_pm_enter();\n\treturn ret;\n}",
    "includes": [
      "#include <linux/syscore_ops.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/notifier.h>",
      "#include <linux/module.h>",
      "#include <linux/cpu_pm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_cluster_pm_enter",
          "args": [],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_cluster_pm_enter",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cpu_pm.c",
          "lines": "157-160",
          "snippet": "int cpu_cluster_pm_enter(void)\n{\n\treturn cpu_pm_notify_robust(CPU_CLUSTER_PM_ENTER, CPU_CLUSTER_PM_ENTER_FAILED);\n}",
          "includes": [
            "#include <linux/syscore_ops.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/notifier.h>",
            "#include <linux/module.h>",
            "#include <linux/cpu_pm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/syscore_ops.h>\n#include <linux/spinlock.h>\n#include <linux/notifier.h>\n#include <linux/module.h>\n#include <linux/cpu_pm.h>\n#include <linux/kernel.h>\n\nint cpu_cluster_pm_enter(void)\n{\n\treturn cpu_pm_notify_robust(CPU_CLUSTER_PM_ENTER, CPU_CLUSTER_PM_ENTER_FAILED);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_pm_enter",
          "args": [],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_pm_enter",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cpu_pm.c",
          "lines": "117-120",
          "snippet": "int cpu_pm_enter(void)\n{\n\treturn cpu_pm_notify_robust(CPU_PM_ENTER, CPU_PM_ENTER_FAILED);\n}",
          "includes": [
            "#include <linux/syscore_ops.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/notifier.h>",
            "#include <linux/module.h>",
            "#include <linux/cpu_pm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/syscore_ops.h>\n#include <linux/spinlock.h>\n#include <linux/notifier.h>\n#include <linux/module.h>\n#include <linux/cpu_pm.h>\n#include <linux/kernel.h>\n\nint cpu_pm_enter(void)\n{\n\treturn cpu_pm_notify_robust(CPU_PM_ENTER, CPU_PM_ENTER_FAILED);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/syscore_ops.h>\n#include <linux/spinlock.h>\n#include <linux/notifier.h>\n#include <linux/module.h>\n#include <linux/cpu_pm.h>\n#include <linux/kernel.h>\n\nstatic int cpu_pm_suspend(void)\n{\n\tint ret;\n\n\tret = cpu_pm_enter();\n\tif (ret)\n\t\treturn ret;\n\n\tret = cpu_cluster_pm_enter();\n\treturn ret;\n}"
  },
  {
    "function_name": "cpu_cluster_pm_exit",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/cpu_pm.c",
    "lines": "178-181",
    "snippet": "int cpu_cluster_pm_exit(void)\n{\n\treturn cpu_pm_notify(CPU_CLUSTER_PM_EXIT);\n}",
    "includes": [
      "#include <linux/syscore_ops.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/notifier.h>",
      "#include <linux/module.h>",
      "#include <linux/cpu_pm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_pm_notify",
          "args": [
            "CPU_CLUSTER_PM_EXIT"
          ],
          "line": 180
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_pm_notify",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cpu_pm.c",
          "lines": "29-45",
          "snippet": "static int cpu_pm_notify(enum cpu_pm_event event)\n{\n\tint ret;\n\n\t/*\n\t * This introduces a RCU read critical section, which could be\n\t * disfunctional in cpu idle. Copy RCU_NONIDLE code to let RCU know\n\t * this.\n\t */\n\trcu_irq_enter_irqson();\n\trcu_read_lock();\n\tret = raw_notifier_call_chain(&cpu_pm_notifier.chain, event, NULL);\n\trcu_read_unlock();\n\trcu_irq_exit_irqson();\n\n\treturn notifier_to_errno(ret);\n}",
          "includes": [
            "#include <linux/syscore_ops.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/notifier.h>",
            "#include <linux/module.h>",
            "#include <linux/cpu_pm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct {\n\tstruct raw_notifier_head chain;\n\traw_spinlock_t lock;\n} cpu_pm_notifier = {\n\t.chain = RAW_NOTIFIER_INIT(cpu_pm_notifier.chain),\n\t.lock  = __RAW_SPIN_LOCK_UNLOCKED(cpu_pm_notifier.lock),\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/syscore_ops.h>\n#include <linux/spinlock.h>\n#include <linux/notifier.h>\n#include <linux/module.h>\n#include <linux/cpu_pm.h>\n#include <linux/kernel.h>\n\nstatic struct {\n\tstruct raw_notifier_head chain;\n\traw_spinlock_t lock;\n} cpu_pm_notifier = {\n\t.chain = RAW_NOTIFIER_INIT(cpu_pm_notifier.chain),\n\t.lock  = __RAW_SPIN_LOCK_UNLOCKED(cpu_pm_notifier.lock),\n};\n\nstatic int cpu_pm_notify(enum cpu_pm_event event)\n{\n\tint ret;\n\n\t/*\n\t * This introduces a RCU read critical section, which could be\n\t * disfunctional in cpu idle. Copy RCU_NONIDLE code to let RCU know\n\t * this.\n\t */\n\trcu_irq_enter_irqson();\n\trcu_read_lock();\n\tret = raw_notifier_call_chain(&cpu_pm_notifier.chain, event, NULL);\n\trcu_read_unlock();\n\trcu_irq_exit_irqson();\n\n\treturn notifier_to_errno(ret);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/syscore_ops.h>\n#include <linux/spinlock.h>\n#include <linux/notifier.h>\n#include <linux/module.h>\n#include <linux/cpu_pm.h>\n#include <linux/kernel.h>\n\nint cpu_cluster_pm_exit(void)\n{\n\treturn cpu_pm_notify(CPU_CLUSTER_PM_EXIT);\n}"
  },
  {
    "function_name": "cpu_cluster_pm_enter",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/cpu_pm.c",
    "lines": "157-160",
    "snippet": "int cpu_cluster_pm_enter(void)\n{\n\treturn cpu_pm_notify_robust(CPU_CLUSTER_PM_ENTER, CPU_CLUSTER_PM_ENTER_FAILED);\n}",
    "includes": [
      "#include <linux/syscore_ops.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/notifier.h>",
      "#include <linux/module.h>",
      "#include <linux/cpu_pm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_pm_notify_robust",
          "args": [
            "CPU_CLUSTER_PM_ENTER",
            "CPU_CLUSTER_PM_ENTER_FAILED"
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_pm_notify_robust",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cpu_pm.c",
          "lines": "47-59",
          "snippet": "static int cpu_pm_notify_robust(enum cpu_pm_event event_up, enum cpu_pm_event event_down)\n{\n\tunsigned long flags;\n\tint ret;\n\n\trcu_irq_enter_irqson();\n\traw_spin_lock_irqsave(&cpu_pm_notifier.lock, flags);\n\tret = raw_notifier_call_chain_robust(&cpu_pm_notifier.chain, event_up, event_down, NULL);\n\traw_spin_unlock_irqrestore(&cpu_pm_notifier.lock, flags);\n\trcu_irq_exit_irqson();\n\n\treturn notifier_to_errno(ret);\n}",
          "includes": [
            "#include <linux/syscore_ops.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/notifier.h>",
            "#include <linux/module.h>",
            "#include <linux/cpu_pm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct {\n\tstruct raw_notifier_head chain;\n\traw_spinlock_t lock;\n} cpu_pm_notifier = {\n\t.chain = RAW_NOTIFIER_INIT(cpu_pm_notifier.chain),\n\t.lock  = __RAW_SPIN_LOCK_UNLOCKED(cpu_pm_notifier.lock),\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/syscore_ops.h>\n#include <linux/spinlock.h>\n#include <linux/notifier.h>\n#include <linux/module.h>\n#include <linux/cpu_pm.h>\n#include <linux/kernel.h>\n\nstatic struct {\n\tstruct raw_notifier_head chain;\n\traw_spinlock_t lock;\n} cpu_pm_notifier = {\n\t.chain = RAW_NOTIFIER_INIT(cpu_pm_notifier.chain),\n\t.lock  = __RAW_SPIN_LOCK_UNLOCKED(cpu_pm_notifier.lock),\n};\n\nstatic int cpu_pm_notify_robust(enum cpu_pm_event event_up, enum cpu_pm_event event_down)\n{\n\tunsigned long flags;\n\tint ret;\n\n\trcu_irq_enter_irqson();\n\traw_spin_lock_irqsave(&cpu_pm_notifier.lock, flags);\n\tret = raw_notifier_call_chain_robust(&cpu_pm_notifier.chain, event_up, event_down, NULL);\n\traw_spin_unlock_irqrestore(&cpu_pm_notifier.lock, flags);\n\trcu_irq_exit_irqson();\n\n\treturn notifier_to_errno(ret);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/syscore_ops.h>\n#include <linux/spinlock.h>\n#include <linux/notifier.h>\n#include <linux/module.h>\n#include <linux/cpu_pm.h>\n#include <linux/kernel.h>\n\nint cpu_cluster_pm_enter(void)\n{\n\treturn cpu_pm_notify_robust(CPU_CLUSTER_PM_ENTER, CPU_CLUSTER_PM_ENTER_FAILED);\n}"
  },
  {
    "function_name": "cpu_pm_exit",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/cpu_pm.c",
    "lines": "135-138",
    "snippet": "int cpu_pm_exit(void)\n{\n\treturn cpu_pm_notify(CPU_PM_EXIT);\n}",
    "includes": [
      "#include <linux/syscore_ops.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/notifier.h>",
      "#include <linux/module.h>",
      "#include <linux/cpu_pm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_pm_notify",
          "args": [
            "CPU_PM_EXIT"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_pm_notify",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cpu_pm.c",
          "lines": "29-45",
          "snippet": "static int cpu_pm_notify(enum cpu_pm_event event)\n{\n\tint ret;\n\n\t/*\n\t * This introduces a RCU read critical section, which could be\n\t * disfunctional in cpu idle. Copy RCU_NONIDLE code to let RCU know\n\t * this.\n\t */\n\trcu_irq_enter_irqson();\n\trcu_read_lock();\n\tret = raw_notifier_call_chain(&cpu_pm_notifier.chain, event, NULL);\n\trcu_read_unlock();\n\trcu_irq_exit_irqson();\n\n\treturn notifier_to_errno(ret);\n}",
          "includes": [
            "#include <linux/syscore_ops.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/notifier.h>",
            "#include <linux/module.h>",
            "#include <linux/cpu_pm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct {\n\tstruct raw_notifier_head chain;\n\traw_spinlock_t lock;\n} cpu_pm_notifier = {\n\t.chain = RAW_NOTIFIER_INIT(cpu_pm_notifier.chain),\n\t.lock  = __RAW_SPIN_LOCK_UNLOCKED(cpu_pm_notifier.lock),\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/syscore_ops.h>\n#include <linux/spinlock.h>\n#include <linux/notifier.h>\n#include <linux/module.h>\n#include <linux/cpu_pm.h>\n#include <linux/kernel.h>\n\nstatic struct {\n\tstruct raw_notifier_head chain;\n\traw_spinlock_t lock;\n} cpu_pm_notifier = {\n\t.chain = RAW_NOTIFIER_INIT(cpu_pm_notifier.chain),\n\t.lock  = __RAW_SPIN_LOCK_UNLOCKED(cpu_pm_notifier.lock),\n};\n\nstatic int cpu_pm_notify(enum cpu_pm_event event)\n{\n\tint ret;\n\n\t/*\n\t * This introduces a RCU read critical section, which could be\n\t * disfunctional in cpu idle. Copy RCU_NONIDLE code to let RCU know\n\t * this.\n\t */\n\trcu_irq_enter_irqson();\n\trcu_read_lock();\n\tret = raw_notifier_call_chain(&cpu_pm_notifier.chain, event, NULL);\n\trcu_read_unlock();\n\trcu_irq_exit_irqson();\n\n\treturn notifier_to_errno(ret);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/syscore_ops.h>\n#include <linux/spinlock.h>\n#include <linux/notifier.h>\n#include <linux/module.h>\n#include <linux/cpu_pm.h>\n#include <linux/kernel.h>\n\nint cpu_pm_exit(void)\n{\n\treturn cpu_pm_notify(CPU_PM_EXIT);\n}"
  },
  {
    "function_name": "cpu_pm_enter",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/cpu_pm.c",
    "lines": "117-120",
    "snippet": "int cpu_pm_enter(void)\n{\n\treturn cpu_pm_notify_robust(CPU_PM_ENTER, CPU_PM_ENTER_FAILED);\n}",
    "includes": [
      "#include <linux/syscore_ops.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/notifier.h>",
      "#include <linux/module.h>",
      "#include <linux/cpu_pm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cpu_pm_notify_robust",
          "args": [
            "CPU_PM_ENTER",
            "CPU_PM_ENTER_FAILED"
          ],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "cpu_pm_notify_robust",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cpu_pm.c",
          "lines": "47-59",
          "snippet": "static int cpu_pm_notify_robust(enum cpu_pm_event event_up, enum cpu_pm_event event_down)\n{\n\tunsigned long flags;\n\tint ret;\n\n\trcu_irq_enter_irqson();\n\traw_spin_lock_irqsave(&cpu_pm_notifier.lock, flags);\n\tret = raw_notifier_call_chain_robust(&cpu_pm_notifier.chain, event_up, event_down, NULL);\n\traw_spin_unlock_irqrestore(&cpu_pm_notifier.lock, flags);\n\trcu_irq_exit_irqson();\n\n\treturn notifier_to_errno(ret);\n}",
          "includes": [
            "#include <linux/syscore_ops.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/notifier.h>",
            "#include <linux/module.h>",
            "#include <linux/cpu_pm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct {\n\tstruct raw_notifier_head chain;\n\traw_spinlock_t lock;\n} cpu_pm_notifier = {\n\t.chain = RAW_NOTIFIER_INIT(cpu_pm_notifier.chain),\n\t.lock  = __RAW_SPIN_LOCK_UNLOCKED(cpu_pm_notifier.lock),\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/syscore_ops.h>\n#include <linux/spinlock.h>\n#include <linux/notifier.h>\n#include <linux/module.h>\n#include <linux/cpu_pm.h>\n#include <linux/kernel.h>\n\nstatic struct {\n\tstruct raw_notifier_head chain;\n\traw_spinlock_t lock;\n} cpu_pm_notifier = {\n\t.chain = RAW_NOTIFIER_INIT(cpu_pm_notifier.chain),\n\t.lock  = __RAW_SPIN_LOCK_UNLOCKED(cpu_pm_notifier.lock),\n};\n\nstatic int cpu_pm_notify_robust(enum cpu_pm_event event_up, enum cpu_pm_event event_down)\n{\n\tunsigned long flags;\n\tint ret;\n\n\trcu_irq_enter_irqson();\n\traw_spin_lock_irqsave(&cpu_pm_notifier.lock, flags);\n\tret = raw_notifier_call_chain_robust(&cpu_pm_notifier.chain, event_up, event_down, NULL);\n\traw_spin_unlock_irqrestore(&cpu_pm_notifier.lock, flags);\n\trcu_irq_exit_irqson();\n\n\treturn notifier_to_errno(ret);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/syscore_ops.h>\n#include <linux/spinlock.h>\n#include <linux/notifier.h>\n#include <linux/module.h>\n#include <linux/cpu_pm.h>\n#include <linux/kernel.h>\n\nint cpu_pm_enter(void)\n{\n\treturn cpu_pm_notify_robust(CPU_PM_ENTER, CPU_PM_ENTER_FAILED);\n}"
  },
  {
    "function_name": "cpu_pm_unregister_notifier",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/cpu_pm.c",
    "lines": "90-99",
    "snippet": "int cpu_pm_unregister_notifier(struct notifier_block *nb)\n{\n\tunsigned long flags;\n\tint ret;\n\n\traw_spin_lock_irqsave(&cpu_pm_notifier.lock, flags);\n\tret = raw_notifier_chain_unregister(&cpu_pm_notifier.chain, nb);\n\traw_spin_unlock_irqrestore(&cpu_pm_notifier.lock, flags);\n\treturn ret;\n}",
    "includes": [
      "#include <linux/syscore_ops.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/notifier.h>",
      "#include <linux/module.h>",
      "#include <linux/cpu_pm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct {\n\tstruct raw_notifier_head chain;\n\traw_spinlock_t lock;\n} cpu_pm_notifier = {\n\t.chain = RAW_NOTIFIER_INIT(cpu_pm_notifier.chain),\n\t.lock  = __RAW_SPIN_LOCK_UNLOCKED(cpu_pm_notifier.lock),\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "raw_spin_unlock_irqrestore",
          "args": [
            "&cpu_pm_notifier.lock",
            "flags"
          ],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irqrestore",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "192-195",
          "snippet": "void __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "raw_notifier_chain_unregister",
          "args": [
            "&cpu_pm_notifier.chain",
            "nb"
          ],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "raw_notifier_chain_unregister",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/notifier.c",
          "lines": "358-362",
          "snippet": "int raw_notifier_chain_unregister(struct raw_notifier_head *nh,\n\t\tstruct notifier_block *n)\n{\n\treturn notifier_chain_unregister(&nh->head, n);\n}",
          "includes": [
            "#include <linux/reboot.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/notifier.h>",
            "#include <linux/export.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/kdebug.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/reboot.h>\n#include <linux/vmalloc.h>\n#include <linux/rcupdate.h>\n#include <linux/notifier.h>\n#include <linux/export.h>\n#include <linux/kprobes.h>\n#include <linux/kdebug.h>\n\nint raw_notifier_chain_unregister(struct raw_notifier_head *nh,\n\t\tstruct notifier_block *n)\n{\n\treturn notifier_chain_unregister(&nh->head, n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "raw_spin_lock_irqsave",
          "args": [
            "&cpu_pm_notifier.lock",
            "flags"
          ],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irqsave_nested",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "383-393",
          "snippet": "unsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nunsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/syscore_ops.h>\n#include <linux/spinlock.h>\n#include <linux/notifier.h>\n#include <linux/module.h>\n#include <linux/cpu_pm.h>\n#include <linux/kernel.h>\n\nstatic struct {\n\tstruct raw_notifier_head chain;\n\traw_spinlock_t lock;\n} cpu_pm_notifier = {\n\t.chain = RAW_NOTIFIER_INIT(cpu_pm_notifier.chain),\n\t.lock  = __RAW_SPIN_LOCK_UNLOCKED(cpu_pm_notifier.lock),\n};\n\nint cpu_pm_unregister_notifier(struct notifier_block *nb)\n{\n\tunsigned long flags;\n\tint ret;\n\n\traw_spin_lock_irqsave(&cpu_pm_notifier.lock, flags);\n\tret = raw_notifier_chain_unregister(&cpu_pm_notifier.chain, nb);\n\traw_spin_unlock_irqrestore(&cpu_pm_notifier.lock, flags);\n\treturn ret;\n}"
  },
  {
    "function_name": "cpu_pm_register_notifier",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/cpu_pm.c",
    "lines": "70-79",
    "snippet": "int cpu_pm_register_notifier(struct notifier_block *nb)\n{\n\tunsigned long flags;\n\tint ret;\n\n\traw_spin_lock_irqsave(&cpu_pm_notifier.lock, flags);\n\tret = raw_notifier_chain_register(&cpu_pm_notifier.chain, nb);\n\traw_spin_unlock_irqrestore(&cpu_pm_notifier.lock, flags);\n\treturn ret;\n}",
    "includes": [
      "#include <linux/syscore_ops.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/notifier.h>",
      "#include <linux/module.h>",
      "#include <linux/cpu_pm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct {\n\tstruct raw_notifier_head chain;\n\traw_spinlock_t lock;\n} cpu_pm_notifier = {\n\t.chain = RAW_NOTIFIER_INIT(cpu_pm_notifier.chain),\n\t.lock  = __RAW_SPIN_LOCK_UNLOCKED(cpu_pm_notifier.lock),\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "raw_spin_unlock_irqrestore",
          "args": [
            "&cpu_pm_notifier.lock",
            "flags"
          ],
          "line": 77
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irqrestore",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "192-195",
          "snippet": "void __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "raw_notifier_chain_register",
          "args": [
            "&cpu_pm_notifier.chain",
            "nb"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "raw_notifier_chain_register",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/notifier.c",
          "lines": "341-345",
          "snippet": "int raw_notifier_chain_register(struct raw_notifier_head *nh,\n\t\tstruct notifier_block *n)\n{\n\treturn notifier_chain_register(&nh->head, n);\n}",
          "includes": [
            "#include <linux/reboot.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/notifier.h>",
            "#include <linux/export.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/kdebug.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/reboot.h>\n#include <linux/vmalloc.h>\n#include <linux/rcupdate.h>\n#include <linux/notifier.h>\n#include <linux/export.h>\n#include <linux/kprobes.h>\n#include <linux/kdebug.h>\n\nint raw_notifier_chain_register(struct raw_notifier_head *nh,\n\t\tstruct notifier_block *n)\n{\n\treturn notifier_chain_register(&nh->head, n);\n}"
        }
      },
      {
        "call_info": {
          "callee": "raw_spin_lock_irqsave",
          "args": [
            "&cpu_pm_notifier.lock",
            "flags"
          ],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irqsave_nested",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "383-393",
          "snippet": "unsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nunsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/syscore_ops.h>\n#include <linux/spinlock.h>\n#include <linux/notifier.h>\n#include <linux/module.h>\n#include <linux/cpu_pm.h>\n#include <linux/kernel.h>\n\nstatic struct {\n\tstruct raw_notifier_head chain;\n\traw_spinlock_t lock;\n} cpu_pm_notifier = {\n\t.chain = RAW_NOTIFIER_INIT(cpu_pm_notifier.chain),\n\t.lock  = __RAW_SPIN_LOCK_UNLOCKED(cpu_pm_notifier.lock),\n};\n\nint cpu_pm_register_notifier(struct notifier_block *nb)\n{\n\tunsigned long flags;\n\tint ret;\n\n\traw_spin_lock_irqsave(&cpu_pm_notifier.lock, flags);\n\tret = raw_notifier_chain_register(&cpu_pm_notifier.chain, nb);\n\traw_spin_unlock_irqrestore(&cpu_pm_notifier.lock, flags);\n\treturn ret;\n}"
  },
  {
    "function_name": "cpu_pm_notify_robust",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/cpu_pm.c",
    "lines": "47-59",
    "snippet": "static int cpu_pm_notify_robust(enum cpu_pm_event event_up, enum cpu_pm_event event_down)\n{\n\tunsigned long flags;\n\tint ret;\n\n\trcu_irq_enter_irqson();\n\traw_spin_lock_irqsave(&cpu_pm_notifier.lock, flags);\n\tret = raw_notifier_call_chain_robust(&cpu_pm_notifier.chain, event_up, event_down, NULL);\n\traw_spin_unlock_irqrestore(&cpu_pm_notifier.lock, flags);\n\trcu_irq_exit_irqson();\n\n\treturn notifier_to_errno(ret);\n}",
    "includes": [
      "#include <linux/syscore_ops.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/notifier.h>",
      "#include <linux/module.h>",
      "#include <linux/cpu_pm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct {\n\tstruct raw_notifier_head chain;\n\traw_spinlock_t lock;\n} cpu_pm_notifier = {\n\t.chain = RAW_NOTIFIER_INIT(cpu_pm_notifier.chain),\n\t.lock  = __RAW_SPIN_LOCK_UNLOCKED(cpu_pm_notifier.lock),\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "notifier_to_errno",
          "args": [
            "ret"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_irq_exit_irqson",
          "args": [],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_irq_exit_irqson",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/tree.c",
          "lines": "831-838",
          "snippet": "void rcu_irq_exit_irqson(void)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\trcu_irq_exit();\n\tlocal_irq_restore(flags);\n}",
          "includes": [
            "#include \"tree_plugin.h\"",
            "#include \"tree_nocb.h\"",
            "#include \"tree_exp.h\"",
            "#include \"tree_stall.h\"",
            "#include \"rcu.h\"",
            "#include \"tree.h\"",
            "#include \"../time/tick-internal.h\"",
            "#include <linux/kasan.h>",
            "#include <linux/mm.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/slab.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/smpboot.h>",
            "#include <linux/oom.h>",
            "#include <linux/gfp.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/sysrq.h>",
            "#include <linux/tick.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/suspend.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/random.h>",
            "#include <linux/delay.h>",
            "#include <linux/prefetch.h>",
            "#include <uapi/linux/sched/types.h>",
            "#include <linux/kthread.h>",
            "#include <linux/wait.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/time.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/percpu.h>",
            "#include <linux/panic_notifier.h>",
            "#include <linux/panic.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/completion.h>",
            "#include <linux/export.h>",
            "#include <linux/bitops.h>",
            "#include <linux/atomic.h>",
            "#include <linux/nmi.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/smp.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void rcu_report_qs_rnp(unsigned long mask, struct rcu_node *rnp,\n\t\t\t      unsigned long gps, unsigned long flags);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tree_plugin.h\"\n#include \"tree_nocb.h\"\n#include \"tree_exp.h\"\n#include \"tree_stall.h\"\n#include \"rcu.h\"\n#include \"tree.h\"\n#include \"../time/tick-internal.h\"\n#include <linux/kasan.h>\n#include <linux/mm.h>\n#include <linux/vmalloc.h>\n#include <linux/sched/clock.h>\n#include <linux/sched/isolation.h>\n#include <linux/slab.h>\n#include <linux/jiffies.h>\n#include <linux/smpboot.h>\n#include <linux/oom.h>\n#include <linux/gfp.h>\n#include <linux/kprobes.h>\n#include <linux/sysrq.h>\n#include <linux/tick.h>\n#include <linux/ftrace.h>\n#include <linux/suspend.h>\n#include <linux/trace_events.h>\n#include <linux/random.h>\n#include <linux/delay.h>\n#include <linux/prefetch.h>\n#include <uapi/linux/sched/types.h>\n#include <linux/kthread.h>\n#include <linux/wait.h>\n#include <linux/kernel_stat.h>\n#include <linux/time.h>\n#include <linux/mutex.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/percpu.h>\n#include <linux/panic_notifier.h>\n#include <linux/panic.h>\n#include <linux/moduleparam.h>\n#include <linux/completion.h>\n#include <linux/export.h>\n#include <linux/bitops.h>\n#include <linux/atomic.h>\n#include <linux/nmi.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/interrupt.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/smp.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic void rcu_report_qs_rnp(unsigned long mask, struct rcu_node *rnp,\n\t\t\t      unsigned long gps, unsigned long flags);\n\nvoid rcu_irq_exit_irqson(void)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\trcu_irq_exit();\n\tlocal_irq_restore(flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "raw_spin_unlock_irqrestore",
          "args": [
            "&cpu_pm_notifier.lock",
            "flags"
          ],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irqrestore",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "192-195",
          "snippet": "void __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "raw_notifier_call_chain_robust",
          "args": [
            "&cpu_pm_notifier.chain",
            "event_up",
            "event_down",
            "NULL"
          ],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "raw_notifier_call_chain_robust",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/notifier.c",
          "lines": "365-369",
          "snippet": "int raw_notifier_call_chain_robust(struct raw_notifier_head *nh,\n\t\tunsigned long val_up, unsigned long val_down, void *v)\n{\n\treturn notifier_call_chain_robust(&nh->head, val_up, val_down, v);\n}",
          "includes": [
            "#include <linux/reboot.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/notifier.h>",
            "#include <linux/export.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/kdebug.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/reboot.h>\n#include <linux/vmalloc.h>\n#include <linux/rcupdate.h>\n#include <linux/notifier.h>\n#include <linux/export.h>\n#include <linux/kprobes.h>\n#include <linux/kdebug.h>\n\nint raw_notifier_call_chain_robust(struct raw_notifier_head *nh,\n\t\tunsigned long val_up, unsigned long val_down, void *v)\n{\n\treturn notifier_call_chain_robust(&nh->head, val_up, val_down, v);\n}"
        }
      },
      {
        "call_info": {
          "callee": "raw_spin_lock_irqsave",
          "args": [
            "&cpu_pm_notifier.lock",
            "flags"
          ],
          "line": 53
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irqsave_nested",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "383-393",
          "snippet": "unsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nunsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_irq_enter_irqson",
          "args": [],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_irq_enter_irqson",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/tree.c",
          "lines": "1069-1076",
          "snippet": "void rcu_irq_enter_irqson(void)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\trcu_irq_enter();\n\tlocal_irq_restore(flags);\n}",
          "includes": [
            "#include \"tree_plugin.h\"",
            "#include \"tree_nocb.h\"",
            "#include \"tree_exp.h\"",
            "#include \"tree_stall.h\"",
            "#include \"rcu.h\"",
            "#include \"tree.h\"",
            "#include \"../time/tick-internal.h\"",
            "#include <linux/kasan.h>",
            "#include <linux/mm.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/slab.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/smpboot.h>",
            "#include <linux/oom.h>",
            "#include <linux/gfp.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/sysrq.h>",
            "#include <linux/tick.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/suspend.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/random.h>",
            "#include <linux/delay.h>",
            "#include <linux/prefetch.h>",
            "#include <uapi/linux/sched/types.h>",
            "#include <linux/kthread.h>",
            "#include <linux/wait.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/time.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/percpu.h>",
            "#include <linux/panic_notifier.h>",
            "#include <linux/panic.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/completion.h>",
            "#include <linux/export.h>",
            "#include <linux/bitops.h>",
            "#include <linux/atomic.h>",
            "#include <linux/nmi.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/smp.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void rcu_report_qs_rnp(unsigned long mask, struct rcu_node *rnp,\n\t\t\t      unsigned long gps, unsigned long flags);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tree_plugin.h\"\n#include \"tree_nocb.h\"\n#include \"tree_exp.h\"\n#include \"tree_stall.h\"\n#include \"rcu.h\"\n#include \"tree.h\"\n#include \"../time/tick-internal.h\"\n#include <linux/kasan.h>\n#include <linux/mm.h>\n#include <linux/vmalloc.h>\n#include <linux/sched/clock.h>\n#include <linux/sched/isolation.h>\n#include <linux/slab.h>\n#include <linux/jiffies.h>\n#include <linux/smpboot.h>\n#include <linux/oom.h>\n#include <linux/gfp.h>\n#include <linux/kprobes.h>\n#include <linux/sysrq.h>\n#include <linux/tick.h>\n#include <linux/ftrace.h>\n#include <linux/suspend.h>\n#include <linux/trace_events.h>\n#include <linux/random.h>\n#include <linux/delay.h>\n#include <linux/prefetch.h>\n#include <uapi/linux/sched/types.h>\n#include <linux/kthread.h>\n#include <linux/wait.h>\n#include <linux/kernel_stat.h>\n#include <linux/time.h>\n#include <linux/mutex.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/percpu.h>\n#include <linux/panic_notifier.h>\n#include <linux/panic.h>\n#include <linux/moduleparam.h>\n#include <linux/completion.h>\n#include <linux/export.h>\n#include <linux/bitops.h>\n#include <linux/atomic.h>\n#include <linux/nmi.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/interrupt.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/smp.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic void rcu_report_qs_rnp(unsigned long mask, struct rcu_node *rnp,\n\t\t\t      unsigned long gps, unsigned long flags);\n\nvoid rcu_irq_enter_irqson(void)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\trcu_irq_enter();\n\tlocal_irq_restore(flags);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/syscore_ops.h>\n#include <linux/spinlock.h>\n#include <linux/notifier.h>\n#include <linux/module.h>\n#include <linux/cpu_pm.h>\n#include <linux/kernel.h>\n\nstatic struct {\n\tstruct raw_notifier_head chain;\n\traw_spinlock_t lock;\n} cpu_pm_notifier = {\n\t.chain = RAW_NOTIFIER_INIT(cpu_pm_notifier.chain),\n\t.lock  = __RAW_SPIN_LOCK_UNLOCKED(cpu_pm_notifier.lock),\n};\n\nstatic int cpu_pm_notify_robust(enum cpu_pm_event event_up, enum cpu_pm_event event_down)\n{\n\tunsigned long flags;\n\tint ret;\n\n\trcu_irq_enter_irqson();\n\traw_spin_lock_irqsave(&cpu_pm_notifier.lock, flags);\n\tret = raw_notifier_call_chain_robust(&cpu_pm_notifier.chain, event_up, event_down, NULL);\n\traw_spin_unlock_irqrestore(&cpu_pm_notifier.lock, flags);\n\trcu_irq_exit_irqson();\n\n\treturn notifier_to_errno(ret);\n}"
  },
  {
    "function_name": "cpu_pm_notify",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/cpu_pm.c",
    "lines": "29-45",
    "snippet": "static int cpu_pm_notify(enum cpu_pm_event event)\n{\n\tint ret;\n\n\t/*\n\t * This introduces a RCU read critical section, which could be\n\t * disfunctional in cpu idle. Copy RCU_NONIDLE code to let RCU know\n\t * this.\n\t */\n\trcu_irq_enter_irqson();\n\trcu_read_lock();\n\tret = raw_notifier_call_chain(&cpu_pm_notifier.chain, event, NULL);\n\trcu_read_unlock();\n\trcu_irq_exit_irqson();\n\n\treturn notifier_to_errno(ret);\n}",
    "includes": [
      "#include <linux/syscore_ops.h>",
      "#include <linux/spinlock.h>",
      "#include <linux/notifier.h>",
      "#include <linux/module.h>",
      "#include <linux/cpu_pm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct {\n\tstruct raw_notifier_head chain;\n\traw_spinlock_t lock;\n} cpu_pm_notifier = {\n\t.chain = RAW_NOTIFIER_INIT(cpu_pm_notifier.chain),\n\t.lock  = __RAW_SPIN_LOCK_UNLOCKED(cpu_pm_notifier.lock),\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "notifier_to_errno",
          "args": [
            "ret"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_irq_exit_irqson",
          "args": [],
          "line": 42
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_irq_exit_irqson",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/tree.c",
          "lines": "831-838",
          "snippet": "void rcu_irq_exit_irqson(void)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\trcu_irq_exit();\n\tlocal_irq_restore(flags);\n}",
          "includes": [
            "#include \"tree_plugin.h\"",
            "#include \"tree_nocb.h\"",
            "#include \"tree_exp.h\"",
            "#include \"tree_stall.h\"",
            "#include \"rcu.h\"",
            "#include \"tree.h\"",
            "#include \"../time/tick-internal.h\"",
            "#include <linux/kasan.h>",
            "#include <linux/mm.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/slab.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/smpboot.h>",
            "#include <linux/oom.h>",
            "#include <linux/gfp.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/sysrq.h>",
            "#include <linux/tick.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/suspend.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/random.h>",
            "#include <linux/delay.h>",
            "#include <linux/prefetch.h>",
            "#include <uapi/linux/sched/types.h>",
            "#include <linux/kthread.h>",
            "#include <linux/wait.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/time.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/percpu.h>",
            "#include <linux/panic_notifier.h>",
            "#include <linux/panic.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/completion.h>",
            "#include <linux/export.h>",
            "#include <linux/bitops.h>",
            "#include <linux/atomic.h>",
            "#include <linux/nmi.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/smp.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void rcu_report_qs_rnp(unsigned long mask, struct rcu_node *rnp,\n\t\t\t      unsigned long gps, unsigned long flags);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tree_plugin.h\"\n#include \"tree_nocb.h\"\n#include \"tree_exp.h\"\n#include \"tree_stall.h\"\n#include \"rcu.h\"\n#include \"tree.h\"\n#include \"../time/tick-internal.h\"\n#include <linux/kasan.h>\n#include <linux/mm.h>\n#include <linux/vmalloc.h>\n#include <linux/sched/clock.h>\n#include <linux/sched/isolation.h>\n#include <linux/slab.h>\n#include <linux/jiffies.h>\n#include <linux/smpboot.h>\n#include <linux/oom.h>\n#include <linux/gfp.h>\n#include <linux/kprobes.h>\n#include <linux/sysrq.h>\n#include <linux/tick.h>\n#include <linux/ftrace.h>\n#include <linux/suspend.h>\n#include <linux/trace_events.h>\n#include <linux/random.h>\n#include <linux/delay.h>\n#include <linux/prefetch.h>\n#include <uapi/linux/sched/types.h>\n#include <linux/kthread.h>\n#include <linux/wait.h>\n#include <linux/kernel_stat.h>\n#include <linux/time.h>\n#include <linux/mutex.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/percpu.h>\n#include <linux/panic_notifier.h>\n#include <linux/panic.h>\n#include <linux/moduleparam.h>\n#include <linux/completion.h>\n#include <linux/export.h>\n#include <linux/bitops.h>\n#include <linux/atomic.h>\n#include <linux/nmi.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/interrupt.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/smp.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic void rcu_report_qs_rnp(unsigned long mask, struct rcu_node *rnp,\n\t\t\t      unsigned long gps, unsigned long flags);\n\nvoid rcu_irq_exit_irqson(void)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\trcu_irq_exit();\n\tlocal_irq_restore(flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 41
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_read_unlock_strict",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/tree_plugin.h",
          "lines": "815-824",
          "snippet": "void rcu_read_unlock_strict(void)\n{\n\tstruct rcu_data *rdp;\n\n\tif (irqs_disabled() || preempt_count() || !rcu_state.gp_kthread)\n\t\treturn;\n\trdp = this_cpu_ptr(&rcu_data);\n\trcu_report_qs_rdp(rdp);\n\tudelay(rcu_unlock_delay);\n}",
          "includes": [
            "#include \"../locking/rtmutex_common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../locking/rtmutex_common.h\"\n\nvoid rcu_read_unlock_strict(void)\n{\n\tstruct rcu_data *rdp;\n\n\tif (irqs_disabled() || preempt_count() || !rcu_state.gp_kthread)\n\t\treturn;\n\trdp = this_cpu_ptr(&rcu_data);\n\trcu_report_qs_rdp(rdp);\n\tudelay(rcu_unlock_delay);\n}"
        }
      },
      {
        "call_info": {
          "callee": "raw_notifier_call_chain",
          "args": [
            "&cpu_pm_notifier.chain",
            "event",
            "NULL"
          ],
          "line": 40
        },
        "resolved": true,
        "details": {
          "function_name": "raw_notifier_call_chain",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/notifier.c",
          "lines": "389-393",
          "snippet": "int raw_notifier_call_chain(struct raw_notifier_head *nh,\n\t\tunsigned long val, void *v)\n{\n\treturn notifier_call_chain(&nh->head, val, v, -1, NULL);\n}",
          "includes": [
            "#include <linux/reboot.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/notifier.h>",
            "#include <linux/export.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/kdebug.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/reboot.h>\n#include <linux/vmalloc.h>\n#include <linux/rcupdate.h>\n#include <linux/notifier.h>\n#include <linux/export.h>\n#include <linux/kprobes.h>\n#include <linux/kdebug.h>\n\nint raw_notifier_call_chain(struct raw_notifier_head *nh,\n\t\tunsigned long val, void *v)\n{\n\treturn notifier_call_chain(&nh->head, val, v, -1, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 39
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_read_lock_any_held",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/update.c",
          "lines": "340-351",
          "snippet": "int rcu_read_lock_any_held(void)\n{\n\tbool ret;\n\n\tif (rcu_read_lock_held_common(&ret))\n\t\treturn ret;\n\tif (lock_is_held(&rcu_lock_map) ||\n\t    lock_is_held(&rcu_bh_lock_map) ||\n\t    lock_is_held(&rcu_sched_lock_map))\n\t\treturn 1;\n\treturn !preemptible();\n}",
          "includes": [
            "#include \"tasks.h\"",
            "#include \"rcu.h\"",
            "#include <linux/rcupdate_trace.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/slab.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/tick.h>",
            "#include <linux/kthread.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/delay.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/export.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bitops.h>",
            "#include <linux/atomic.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tasks.h\"\n#include \"rcu.h\"\n#include <linux/rcupdate_trace.h>\n#include <linux/irq_work.h>\n#include <linux/slab.h>\n#include <linux/kprobes.h>\n#include <linux/sched/isolation.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/tick.h>\n#include <linux/kthread.h>\n#include <linux/moduleparam.h>\n#include <linux/delay.h>\n#include <linux/hardirq.h>\n#include <linux/export.h>\n#include <linux/mutex.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/percpu.h>\n#include <linux/bitops.h>\n#include <linux/atomic.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/signal.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nint rcu_read_lock_any_held(void)\n{\n\tbool ret;\n\n\tif (rcu_read_lock_held_common(&ret))\n\t\treturn ret;\n\tif (lock_is_held(&rcu_lock_map) ||\n\t    lock_is_held(&rcu_bh_lock_map) ||\n\t    lock_is_held(&rcu_sched_lock_map))\n\t\treturn 1;\n\treturn !preemptible();\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_irq_enter_irqson",
          "args": [],
          "line": 38
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_irq_enter_irqson",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/tree.c",
          "lines": "1069-1076",
          "snippet": "void rcu_irq_enter_irqson(void)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\trcu_irq_enter();\n\tlocal_irq_restore(flags);\n}",
          "includes": [
            "#include \"tree_plugin.h\"",
            "#include \"tree_nocb.h\"",
            "#include \"tree_exp.h\"",
            "#include \"tree_stall.h\"",
            "#include \"rcu.h\"",
            "#include \"tree.h\"",
            "#include \"../time/tick-internal.h\"",
            "#include <linux/kasan.h>",
            "#include <linux/mm.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/slab.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/smpboot.h>",
            "#include <linux/oom.h>",
            "#include <linux/gfp.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/sysrq.h>",
            "#include <linux/tick.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/suspend.h>",
            "#include <linux/trace_events.h>",
            "#include <linux/random.h>",
            "#include <linux/delay.h>",
            "#include <linux/prefetch.h>",
            "#include <uapi/linux/sched/types.h>",
            "#include <linux/kthread.h>",
            "#include <linux/wait.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/time.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/percpu.h>",
            "#include <linux/panic_notifier.h>",
            "#include <linux/panic.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/completion.h>",
            "#include <linux/export.h>",
            "#include <linux/bitops.h>",
            "#include <linux/atomic.h>",
            "#include <linux/nmi.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/smp.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void rcu_report_qs_rnp(unsigned long mask, struct rcu_node *rnp,\n\t\t\t      unsigned long gps, unsigned long flags);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"tree_plugin.h\"\n#include \"tree_nocb.h\"\n#include \"tree_exp.h\"\n#include \"tree_stall.h\"\n#include \"rcu.h\"\n#include \"tree.h\"\n#include \"../time/tick-internal.h\"\n#include <linux/kasan.h>\n#include <linux/mm.h>\n#include <linux/vmalloc.h>\n#include <linux/sched/clock.h>\n#include <linux/sched/isolation.h>\n#include <linux/slab.h>\n#include <linux/jiffies.h>\n#include <linux/smpboot.h>\n#include <linux/oom.h>\n#include <linux/gfp.h>\n#include <linux/kprobes.h>\n#include <linux/sysrq.h>\n#include <linux/tick.h>\n#include <linux/ftrace.h>\n#include <linux/suspend.h>\n#include <linux/trace_events.h>\n#include <linux/random.h>\n#include <linux/delay.h>\n#include <linux/prefetch.h>\n#include <uapi/linux/sched/types.h>\n#include <linux/kthread.h>\n#include <linux/wait.h>\n#include <linux/kernel_stat.h>\n#include <linux/time.h>\n#include <linux/mutex.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/percpu.h>\n#include <linux/panic_notifier.h>\n#include <linux/panic.h>\n#include <linux/moduleparam.h>\n#include <linux/completion.h>\n#include <linux/export.h>\n#include <linux/bitops.h>\n#include <linux/atomic.h>\n#include <linux/nmi.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n#include <linux/interrupt.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/smp.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nstatic void rcu_report_qs_rnp(unsigned long mask, struct rcu_node *rnp,\n\t\t\t      unsigned long gps, unsigned long flags);\n\nvoid rcu_irq_enter_irqson(void)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\trcu_irq_enter();\n\tlocal_irq_restore(flags);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/syscore_ops.h>\n#include <linux/spinlock.h>\n#include <linux/notifier.h>\n#include <linux/module.h>\n#include <linux/cpu_pm.h>\n#include <linux/kernel.h>\n\nstatic struct {\n\tstruct raw_notifier_head chain;\n\traw_spinlock_t lock;\n} cpu_pm_notifier = {\n\t.chain = RAW_NOTIFIER_INIT(cpu_pm_notifier.chain),\n\t.lock  = __RAW_SPIN_LOCK_UNLOCKED(cpu_pm_notifier.lock),\n};\n\nstatic int cpu_pm_notify(enum cpu_pm_event event)\n{\n\tint ret;\n\n\t/*\n\t * This introduces a RCU read critical section, which could be\n\t * disfunctional in cpu idle. Copy RCU_NONIDLE code to let RCU know\n\t * this.\n\t */\n\trcu_irq_enter_irqson();\n\trcu_read_lock();\n\tret = raw_notifier_call_chain(&cpu_pm_notifier.chain, event, NULL);\n\trcu_read_unlock();\n\trcu_irq_exit_irqson();\n\n\treturn notifier_to_errno(ret);\n}"
  }
]