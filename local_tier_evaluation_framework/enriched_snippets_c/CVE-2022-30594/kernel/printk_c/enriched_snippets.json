[
  {
    "function_name": "__printk_cpu_unlock",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "3682-3714",
    "snippet": "void __printk_cpu_unlock(void)\n{\n\tif (atomic_read(&printk_cpulock_nested)) {\n\t\tatomic_dec(&printk_cpulock_nested);\n\t\treturn;\n\t}\n\n\t/*\n\t * This CPU is finished loading/storing data:\n\t * LMM(__printk_cpu_unlock:A)\n\t */\n\n\t/*\n\t * Guarantee loads and stores from this CPU when it was the\n\t * lock owner are visible to the next lock owner. This pairs\n\t * with __printk_cpu_trylock:A.\n\t *\n\t * Memory barrier involvement:\n\t *\n\t * If __printk_cpu_trylock:A reads from __printk_cpu_unlock:B,\n\t * then __printk_cpu_trylock:B reads from __printk_cpu_unlock:A.\n\t *\n\t * Relies on:\n\t *\n\t * RELEASE from __printk_cpu_unlock:A to __printk_cpu_unlock:B\n\t * of this CPU\n\t *    matching\n\t * ACQUIRE from __printk_cpu_trylock:A to __printk_cpu_trylock:B\n\t * of the next CPU\n\t */\n\tatomic_set_release(&printk_cpulock_owner,\n\t\t\t   -1); /* LMM(__printk_cpu_unlock:B) */\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_set_release",
          "args": [
            "&printk_cpulock_owner",
            "-1"
          ],
          "line": 3712
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_dec",
          "args": [
            "&printk_cpulock_nested"
          ],
          "line": 3685
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&printk_cpulock_nested"
          ],
          "line": 3684
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nvoid __printk_cpu_unlock(void)\n{\n\tif (atomic_read(&printk_cpulock_nested)) {\n\t\tatomic_dec(&printk_cpulock_nested);\n\t\treturn;\n\t}\n\n\t/*\n\t * This CPU is finished loading/storing data:\n\t * LMM(__printk_cpu_unlock:A)\n\t */\n\n\t/*\n\t * Guarantee loads and stores from this CPU when it was the\n\t * lock owner are visible to the next lock owner. This pairs\n\t * with __printk_cpu_trylock:A.\n\t *\n\t * Memory barrier involvement:\n\t *\n\t * If __printk_cpu_trylock:A reads from __printk_cpu_unlock:B,\n\t * then __printk_cpu_trylock:B reads from __printk_cpu_unlock:A.\n\t *\n\t * Relies on:\n\t *\n\t * RELEASE from __printk_cpu_unlock:A to __printk_cpu_unlock:B\n\t * of this CPU\n\t *    matching\n\t * ACQUIRE from __printk_cpu_trylock:A to __printk_cpu_trylock:B\n\t * of the next CPU\n\t */\n\tatomic_set_release(&printk_cpulock_owner,\n\t\t\t   -1); /* LMM(__printk_cpu_unlock:B) */\n}"
  },
  {
    "function_name": "__printk_cpu_trylock",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "3631-3672",
    "snippet": "int __printk_cpu_trylock(void)\n{\n\tint cpu;\n\tint old;\n\n\tcpu = smp_processor_id();\n\n\t/*\n\t * Guarantee loads and stores from this CPU when it is the lock owner\n\t * are _not_ visible to the previous lock owner. This pairs with\n\t * __printk_cpu_unlock:B.\n\t *\n\t * Memory barrier involvement:\n\t *\n\t * If __printk_cpu_trylock:A reads from __printk_cpu_unlock:B, then\n\t * __printk_cpu_unlock:A can never read from __printk_cpu_trylock:B.\n\t *\n\t * Relies on:\n\t *\n\t * RELEASE from __printk_cpu_unlock:A to __printk_cpu_unlock:B\n\t * of the previous CPU\n\t *    matching\n\t * ACQUIRE from __printk_cpu_trylock:A to __printk_cpu_trylock:B\n\t * of this CPU\n\t */\n\told = atomic_cmpxchg_acquire(&printk_cpulock_owner, -1,\n\t\t\t\t     cpu); /* LMM(__printk_cpu_trylock:A) */\n\tif (old == -1) {\n\t\t/*\n\t\t * This CPU is now the owner and begins loading/storing\n\t\t * data: LMM(__printk_cpu_trylock:B)\n\t\t */\n\t\treturn 1;\n\n\t} else if (old == cpu) {\n\t\t/* This CPU is already the owner. */\n\t\tatomic_inc(&printk_cpulock_nested);\n\t\treturn 1;\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_inc",
          "args": [
            "&printk_cpulock_nested"
          ],
          "line": 3667
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic_cmpxchg_acquire",
          "args": [
            "&printk_cpulock_owner",
            "-1",
            "cpu"
          ],
          "line": 3656
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "smp_processor_id",
          "args": [],
          "line": 3636
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nint __printk_cpu_trylock(void)\n{\n\tint cpu;\n\tint old;\n\n\tcpu = smp_processor_id();\n\n\t/*\n\t * Guarantee loads and stores from this CPU when it is the lock owner\n\t * are _not_ visible to the previous lock owner. This pairs with\n\t * __printk_cpu_unlock:B.\n\t *\n\t * Memory barrier involvement:\n\t *\n\t * If __printk_cpu_trylock:A reads from __printk_cpu_unlock:B, then\n\t * __printk_cpu_unlock:A can never read from __printk_cpu_trylock:B.\n\t *\n\t * Relies on:\n\t *\n\t * RELEASE from __printk_cpu_unlock:A to __printk_cpu_unlock:B\n\t * of the previous CPU\n\t *    matching\n\t * ACQUIRE from __printk_cpu_trylock:A to __printk_cpu_trylock:B\n\t * of this CPU\n\t */\n\told = atomic_cmpxchg_acquire(&printk_cpulock_owner, -1,\n\t\t\t\t     cpu); /* LMM(__printk_cpu_trylock:A) */\n\tif (old == -1) {\n\t\t/*\n\t\t * This CPU is now the owner and begins loading/storing\n\t\t * data: LMM(__printk_cpu_trylock:B)\n\t\t */\n\t\treturn 1;\n\n\t} else if (old == cpu) {\n\t\t/* This CPU is already the owner. */\n\t\tatomic_inc(&printk_cpulock_nested);\n\t\treturn 1;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "__printk_wait_on_cpu_lock",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "3612-3617",
    "snippet": "void __printk_wait_on_cpu_lock(void)\n{\n\tdo {\n\t\tcpu_relax();\n\t} while (atomic_read(&printk_cpulock_owner) != -1);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic_read",
          "args": [
            "&printk_cpulock_owner"
          ],
          "line": 3616
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_relax",
          "args": [],
          "line": 3615
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nvoid __printk_wait_on_cpu_lock(void)\n{\n\tdo {\n\t\tcpu_relax();\n\t} while (atomic_read(&printk_cpulock_owner) != -1);\n}"
  },
  {
    "function_name": "kmsg_dump_rewind",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "3593-3597",
    "snippet": "void kmsg_dump_rewind(struct kmsg_dump_iter *iter)\n{\n\titer->cur_seq = latched_seq_read_nolock(&clear_seq);\n\titer->next_seq = prb_next_seq(prb);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "prb_next_seq",
          "args": [
            "prb"
          ],
          "line": 3596
        },
        "resolved": true,
        "details": {
          "function_name": "prb_next_seq",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk_ringbuffer.c",
          "lines": "2006-2015",
          "snippet": "u64 prb_next_seq(struct printk_ringbuffer *rb)\n{\n\tu64 seq = 0;\n\n\t/* Search forward from the oldest descriptor. */\n\twhile (_prb_read_valid(rb, &seq, NULL, NULL))\n\t\tseq++;\n\n\treturn seq;\n}",
          "includes": [
            "#include \"printk_ringbuffer.h\"",
            "#include <linux/bug.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/irqflags.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"printk_ringbuffer.h\"\n#include <linux/bug.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/irqflags.h>\n#include <linux/kernel.h>\n\nu64 prb_next_seq(struct printk_ringbuffer *rb)\n{\n\tu64 seq = 0;\n\n\t/* Search forward from the oldest descriptor. */\n\twhile (_prb_read_valid(rb, &seq, NULL, NULL))\n\t\tseq++;\n\n\treturn seq;\n}"
        }
      },
      {
        "call_info": {
          "callee": "latched_seq_read_nolock",
          "args": [
            "&clear_seq"
          ],
          "line": 3595
        },
        "resolved": true,
        "details": {
          "function_name": "latched_seq_read_nolock",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "448-461",
          "snippet": "static u64 latched_seq_read_nolock(struct latched_seq *ls)\n{\n\tunsigned int seq;\n\tunsigned int idx;\n\tu64 val;\n\n\tdo {\n\t\tseq = raw_read_seqcount_latch(&ls->latch);\n\t\tidx = seq & 0x1;\n\t\tval = ls->val[idx];\n\t} while (read_seqcount_latch_retry(&ls->latch, seq));\n\n\treturn val;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic u64 latched_seq_read_nolock(struct latched_seq *ls)\n{\n\tunsigned int seq;\n\tunsigned int idx;\n\tu64 val;\n\n\tdo {\n\t\tseq = raw_read_seqcount_latch(&ls->latch);\n\t\tidx = seq & 0x1;\n\t\tval = ls->val[idx];\n\t} while (read_seqcount_latch_retry(&ls->latch, seq));\n\n\treturn val;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nvoid kmsg_dump_rewind(struct kmsg_dump_iter *iter)\n{\n\titer->cur_seq = latched_seq_read_nolock(&clear_seq);\n\titer->next_seq = prb_next_seq(prb);\n}"
  },
  {
    "function_name": "kmsg_dump_get_buffer",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "3519-3582",
    "snippet": "bool kmsg_dump_get_buffer(struct kmsg_dump_iter *iter, bool syslog,\n\t\t\t  char *buf, size_t size, size_t *len_out)\n{\n\tu64 min_seq = latched_seq_read_nolock(&clear_seq);\n\tstruct printk_info info;\n\tstruct printk_record r;\n\tu64 seq;\n\tu64 next_seq;\n\tsize_t len = 0;\n\tbool ret = false;\n\tbool time = printk_time;\n\n\tif (!buf || !size)\n\t\tgoto out;\n\n\tif (iter->cur_seq < min_seq)\n\t\titer->cur_seq = min_seq;\n\n\tif (prb_read_valid_info(prb, iter->cur_seq, &info, NULL)) {\n\t\tif (info.seq != iter->cur_seq) {\n\t\t\t/* messages are gone, move to first available one */\n\t\t\titer->cur_seq = info.seq;\n\t\t}\n\t}\n\n\t/* last entry */\n\tif (iter->cur_seq >= iter->next_seq)\n\t\tgoto out;\n\n\t/*\n\t * Find first record that fits, including all following records,\n\t * into the user-provided buffer for this dump. Pass in size-1\n\t * because this function (by way of record_print_text()) will\n\t * not write more than size-1 bytes of text into @buf.\n\t */\n\tseq = find_first_fitting_seq(iter->cur_seq, iter->next_seq,\n\t\t\t\t     size - 1, syslog, time);\n\n\t/*\n\t * Next kmsg_dump_get_buffer() invocation will dump block of\n\t * older records stored right before this one.\n\t */\n\tnext_seq = seq;\n\n\tprb_rec_init_rd(&r, &info, buf, size);\n\n\tlen = 0;\n\tprb_for_each_record(seq, prb, seq, &r) {\n\t\tif (r.info->seq >= iter->next_seq)\n\t\t\tbreak;\n\n\t\tlen += record_print_text(&r, syslog, time);\n\n\t\t/* Adjust record to store to remaining buffer space. */\n\t\tprb_rec_init_rd(&r, &info, buf + len, size - len);\n\t}\n\n\titer->next_seq = next_seq;\n\tret = true;\nout:\n\tif (len_out)\n\t\t*len_out = len;\n\treturn ret;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define printk_time\t\tfalse"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "prb_rec_init_rd",
          "args": [
            "&r",
            "&info",
            "buf + len",
            "size - len"
          ],
          "line": 3573
        },
        "resolved": true,
        "details": {
          "function_name": "prb_rec_init_rd",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk_ringbuffer.h",
          "lines": "330-337",
          "snippet": "static inline void prb_rec_init_rd(struct printk_record *r,\n\t\t\t\t   struct printk_info *info,\n\t\t\t\t   char *text_buf, unsigned int text_buf_size)\n{\n\tr->info = info;\n\tr->text_buf = text_buf;\n\tr->text_buf_size = text_buf_size;\n}",
          "includes": [
            "#include <linux/dev_printk.h>",
            "#include <linux/atomic.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/dev_printk.h>\n#include <linux/atomic.h>\n\nstatic inline void prb_rec_init_rd(struct printk_record *r,\n\t\t\t\t   struct printk_info *info,\n\t\t\t\t   char *text_buf, unsigned int text_buf_size)\n{\n\tr->info = info;\n\tr->text_buf = text_buf;\n\tr->text_buf_size = text_buf_size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "record_print_text",
          "args": [
            "&r",
            "syslog",
            "time"
          ],
          "line": 3570
        },
        "resolved": true,
        "details": {
          "function_name": "record_print_text",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2286-2290",
          "snippet": "static size_t record_print_text(const struct printk_record *r,\n\t\t\t\tbool syslog, bool time)\n{\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic size_t record_print_text(const struct printk_record *r,\n\t\t\t\tbool syslog, bool time)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prb_for_each_record",
          "args": [
            "seq",
            "prb",
            "seq",
            "&r"
          ],
          "line": 3566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_first_fitting_seq",
          "args": [
            "iter->cur_seq",
            "iter->next_seq",
            "size - 1",
            "syslog",
            "time"
          ],
          "line": 3554
        },
        "resolved": true,
        "details": {
          "function_name": "find_first_fitting_seq",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "1441-1476",
          "snippet": "static u64 find_first_fitting_seq(u64 start_seq, u64 max_seq, size_t size,\n\t\t\t\t  bool syslog, bool time)\n{\n\tstruct printk_info info;\n\tunsigned int line_count;\n\tsize_t len = 0;\n\tu64 seq;\n\n\t/* Determine the size of the records up to @max_seq. */\n\tprb_for_each_info(start_seq, prb, seq, &info, &line_count) {\n\t\tif (info.seq >= max_seq)\n\t\t\tbreak;\n\t\tlen += get_record_print_text_size(&info, line_count, syslog, time);\n\t}\n\n\t/*\n\t * Adjust the upper bound for the next loop to avoid subtracting\n\t * lengths that were never added.\n\t */\n\tif (seq < max_seq)\n\t\tmax_seq = seq;\n\n\t/*\n\t * Move first record forward until length fits into the buffer. Ignore\n\t * newest messages that were not counted in the above cycle. Messages\n\t * might appear and get lost in the meantime. This is a best effort\n\t * that prevents an infinite loop that could occur with a retry.\n\t */\n\tprb_for_each_info(start_seq, prb, seq, &info, &line_count) {\n\t\tif (len <= size || info.seq >= max_seq)\n\t\t\tbreak;\n\t\tlen -= get_record_print_text_size(&info, line_count, syslog, time);\n\t}\n\n\treturn seq;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic u64 find_first_fitting_seq(u64 start_seq, u64 max_seq, size_t size,\n\t\t\t\t  bool syslog, bool time)\n{\n\tstruct printk_info info;\n\tunsigned int line_count;\n\tsize_t len = 0;\n\tu64 seq;\n\n\t/* Determine the size of the records up to @max_seq. */\n\tprb_for_each_info(start_seq, prb, seq, &info, &line_count) {\n\t\tif (info.seq >= max_seq)\n\t\t\tbreak;\n\t\tlen += get_record_print_text_size(&info, line_count, syslog, time);\n\t}\n\n\t/*\n\t * Adjust the upper bound for the next loop to avoid subtracting\n\t * lengths that were never added.\n\t */\n\tif (seq < max_seq)\n\t\tmax_seq = seq;\n\n\t/*\n\t * Move first record forward until length fits into the buffer. Ignore\n\t * newest messages that were not counted in the above cycle. Messages\n\t * might appear and get lost in the meantime. This is a best effort\n\t * that prevents an infinite loop that could occur with a retry.\n\t */\n\tprb_for_each_info(start_seq, prb, seq, &info, &line_count) {\n\t\tif (len <= size || info.seq >= max_seq)\n\t\t\tbreak;\n\t\tlen -= get_record_print_text_size(&info, line_count, syslog, time);\n\t}\n\n\treturn seq;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prb_read_valid_info",
          "args": [
            "prb",
            "iter->cur_seq",
            "&info",
            "NULL"
          ],
          "line": 3537
        },
        "resolved": true,
        "details": {
          "function_name": "prb_read_valid_info",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk_ringbuffer.c",
          "lines": "1956-1964",
          "snippet": "bool prb_read_valid_info(struct printk_ringbuffer *rb, u64 seq,\n\t\t\t struct printk_info *info, unsigned int *line_count)\n{\n\tstruct printk_record r;\n\n\tprb_rec_init_rd(&r, info, NULL, 0);\n\n\treturn _prb_read_valid(rb, &seq, &r, line_count);\n}",
          "includes": [
            "#include \"printk_ringbuffer.h\"",
            "#include <linux/bug.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/irqflags.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"printk_ringbuffer.h\"\n#include <linux/bug.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/irqflags.h>\n#include <linux/kernel.h>\n\nbool prb_read_valid_info(struct printk_ringbuffer *rb, u64 seq,\n\t\t\t struct printk_info *info, unsigned int *line_count)\n{\n\tstruct printk_record r;\n\n\tprb_rec_init_rd(&r, info, NULL, 0);\n\n\treturn _prb_read_valid(rb, &seq, &r, line_count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "latched_seq_read_nolock",
          "args": [
            "&clear_seq"
          ],
          "line": 3522
        },
        "resolved": true,
        "details": {
          "function_name": "latched_seq_read_nolock",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "448-461",
          "snippet": "static u64 latched_seq_read_nolock(struct latched_seq *ls)\n{\n\tunsigned int seq;\n\tunsigned int idx;\n\tu64 val;\n\n\tdo {\n\t\tseq = raw_read_seqcount_latch(&ls->latch);\n\t\tidx = seq & 0x1;\n\t\tval = ls->val[idx];\n\t} while (read_seqcount_latch_retry(&ls->latch, seq));\n\n\treturn val;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic u64 latched_seq_read_nolock(struct latched_seq *ls)\n{\n\tunsigned int seq;\n\tunsigned int idx;\n\tu64 val;\n\n\tdo {\n\t\tseq = raw_read_seqcount_latch(&ls->latch);\n\t\tidx = seq & 0x1;\n\t\tval = ls->val[idx];\n\t} while (read_seqcount_latch_retry(&ls->latch, seq));\n\n\treturn val;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define printk_time\t\tfalse\n\nbool kmsg_dump_get_buffer(struct kmsg_dump_iter *iter, bool syslog,\n\t\t\t  char *buf, size_t size, size_t *len_out)\n{\n\tu64 min_seq = latched_seq_read_nolock(&clear_seq);\n\tstruct printk_info info;\n\tstruct printk_record r;\n\tu64 seq;\n\tu64 next_seq;\n\tsize_t len = 0;\n\tbool ret = false;\n\tbool time = printk_time;\n\n\tif (!buf || !size)\n\t\tgoto out;\n\n\tif (iter->cur_seq < min_seq)\n\t\titer->cur_seq = min_seq;\n\n\tif (prb_read_valid_info(prb, iter->cur_seq, &info, NULL)) {\n\t\tif (info.seq != iter->cur_seq) {\n\t\t\t/* messages are gone, move to first available one */\n\t\t\titer->cur_seq = info.seq;\n\t\t}\n\t}\n\n\t/* last entry */\n\tif (iter->cur_seq >= iter->next_seq)\n\t\tgoto out;\n\n\t/*\n\t * Find first record that fits, including all following records,\n\t * into the user-provided buffer for this dump. Pass in size-1\n\t * because this function (by way of record_print_text()) will\n\t * not write more than size-1 bytes of text into @buf.\n\t */\n\tseq = find_first_fitting_seq(iter->cur_seq, iter->next_seq,\n\t\t\t\t     size - 1, syslog, time);\n\n\t/*\n\t * Next kmsg_dump_get_buffer() invocation will dump block of\n\t * older records stored right before this one.\n\t */\n\tnext_seq = seq;\n\n\tprb_rec_init_rd(&r, &info, buf, size);\n\n\tlen = 0;\n\tprb_for_each_record(seq, prb, seq, &r) {\n\t\tif (r.info->seq >= iter->next_seq)\n\t\t\tbreak;\n\n\t\tlen += record_print_text(&r, syslog, time);\n\n\t\t/* Adjust record to store to remaining buffer space. */\n\t\tprb_rec_init_rd(&r, &info, buf + len, size - len);\n\t}\n\n\titer->next_seq = next_seq;\n\tret = true;\nout:\n\tif (len_out)\n\t\t*len_out = len;\n\treturn ret;\n}"
  },
  {
    "function_name": "kmsg_dump_get_line",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "3461-3497",
    "snippet": "bool kmsg_dump_get_line(struct kmsg_dump_iter *iter, bool syslog,\n\t\t\tchar *line, size_t size, size_t *len)\n{\n\tu64 min_seq = latched_seq_read_nolock(&clear_seq);\n\tstruct printk_info info;\n\tunsigned int line_count;\n\tstruct printk_record r;\n\tsize_t l = 0;\n\tbool ret = false;\n\n\tif (iter->cur_seq < min_seq)\n\t\titer->cur_seq = min_seq;\n\n\tprb_rec_init_rd(&r, &info, line, size);\n\n\t/* Read text or count text lines? */\n\tif (line) {\n\t\tif (!prb_read_valid(prb, iter->cur_seq, &r))\n\t\t\tgoto out;\n\t\tl = record_print_text(&r, syslog, printk_time);\n\t} else {\n\t\tif (!prb_read_valid_info(prb, iter->cur_seq,\n\t\t\t\t\t &info, &line_count)) {\n\t\t\tgoto out;\n\t\t}\n\t\tl = get_record_print_text_size(&info, line_count, syslog,\n\t\t\t\t\t       printk_time);\n\n\t}\n\n\titer->cur_seq = r.info->seq + 1;\n\tret = true;\nout:\n\tif (len)\n\t\t*len = l;\n\treturn ret;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define printk_time\t\tfalse"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_record_print_text_size",
          "args": [
            "&info",
            "line_count",
            "syslog",
            "printk_time"
          ],
          "line": 3486
        },
        "resolved": true,
        "details": {
          "function_name": "get_record_print_text_size",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "1417-1432",
          "snippet": "static size_t get_record_print_text_size(struct printk_info *info,\n\t\t\t\t\t unsigned int line_count,\n\t\t\t\t\t bool syslog, bool time)\n{\n\tchar prefix[PREFIX_MAX];\n\tsize_t prefix_len;\n\n\tprefix_len = info_print_prefix(info, syslog, time, prefix);\n\n\t/*\n\t * Each line will be preceded with a prefix. The intermediate\n\t * newlines are already within the text, but a final trailing\n\t * newline will be added.\n\t */\n\treturn ((prefix_len * line_count) + info->text_len + 1);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define PREFIX_MAX\t\t32",
            "#define PREFIX_MAX\t\t48"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define PREFIX_MAX\t\t32\n#define PREFIX_MAX\t\t48\n\nstatic size_t get_record_print_text_size(struct printk_info *info,\n\t\t\t\t\t unsigned int line_count,\n\t\t\t\t\t bool syslog, bool time)\n{\n\tchar prefix[PREFIX_MAX];\n\tsize_t prefix_len;\n\n\tprefix_len = info_print_prefix(info, syslog, time, prefix);\n\n\t/*\n\t * Each line will be preceded with a prefix. The intermediate\n\t * newlines are already within the text, but a final trailing\n\t * newline will be added.\n\t */\n\treturn ((prefix_len * line_count) + info->text_len + 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prb_read_valid_info",
          "args": [
            "prb",
            "iter->cur_seq",
            "&info",
            "&line_count"
          ],
          "line": 3482
        },
        "resolved": true,
        "details": {
          "function_name": "prb_read_valid_info",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk_ringbuffer.c",
          "lines": "1956-1964",
          "snippet": "bool prb_read_valid_info(struct printk_ringbuffer *rb, u64 seq,\n\t\t\t struct printk_info *info, unsigned int *line_count)\n{\n\tstruct printk_record r;\n\n\tprb_rec_init_rd(&r, info, NULL, 0);\n\n\treturn _prb_read_valid(rb, &seq, &r, line_count);\n}",
          "includes": [
            "#include \"printk_ringbuffer.h\"",
            "#include <linux/bug.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/irqflags.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"printk_ringbuffer.h\"\n#include <linux/bug.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/irqflags.h>\n#include <linux/kernel.h>\n\nbool prb_read_valid_info(struct printk_ringbuffer *rb, u64 seq,\n\t\t\t struct printk_info *info, unsigned int *line_count)\n{\n\tstruct printk_record r;\n\n\tprb_rec_init_rd(&r, info, NULL, 0);\n\n\treturn _prb_read_valid(rb, &seq, &r, line_count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "record_print_text",
          "args": [
            "&r",
            "syslog",
            "printk_time"
          ],
          "line": 3480
        },
        "resolved": true,
        "details": {
          "function_name": "record_print_text",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2286-2290",
          "snippet": "static size_t record_print_text(const struct printk_record *r,\n\t\t\t\tbool syslog, bool time)\n{\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic size_t record_print_text(const struct printk_record *r,\n\t\t\t\tbool syslog, bool time)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prb_read_valid",
          "args": [
            "prb",
            "iter->cur_seq",
            "&r"
          ],
          "line": 3478
        },
        "resolved": true,
        "details": {
          "function_name": "prb_read_valid",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk_ringbuffer.c",
          "lines": "1926-1930",
          "snippet": "bool prb_read_valid(struct printk_ringbuffer *rb, u64 seq,\n\t\t    struct printk_record *r)\n{\n\treturn _prb_read_valid(rb, &seq, r, NULL);\n}",
          "includes": [
            "#include \"printk_ringbuffer.h\"",
            "#include <linux/bug.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/irqflags.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"printk_ringbuffer.h\"\n#include <linux/bug.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/irqflags.h>\n#include <linux/kernel.h>\n\nbool prb_read_valid(struct printk_ringbuffer *rb, u64 seq,\n\t\t    struct printk_record *r)\n{\n\treturn _prb_read_valid(rb, &seq, r, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prb_rec_init_rd",
          "args": [
            "&r",
            "&info",
            "line",
            "size"
          ],
          "line": 3474
        },
        "resolved": true,
        "details": {
          "function_name": "prb_rec_init_rd",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk_ringbuffer.h",
          "lines": "330-337",
          "snippet": "static inline void prb_rec_init_rd(struct printk_record *r,\n\t\t\t\t   struct printk_info *info,\n\t\t\t\t   char *text_buf, unsigned int text_buf_size)\n{\n\tr->info = info;\n\tr->text_buf = text_buf;\n\tr->text_buf_size = text_buf_size;\n}",
          "includes": [
            "#include <linux/dev_printk.h>",
            "#include <linux/atomic.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/dev_printk.h>\n#include <linux/atomic.h>\n\nstatic inline void prb_rec_init_rd(struct printk_record *r,\n\t\t\t\t   struct printk_info *info,\n\t\t\t\t   char *text_buf, unsigned int text_buf_size)\n{\n\tr->info = info;\n\tr->text_buf = text_buf;\n\tr->text_buf_size = text_buf_size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "latched_seq_read_nolock",
          "args": [
            "&clear_seq"
          ],
          "line": 3464
        },
        "resolved": true,
        "details": {
          "function_name": "latched_seq_read_nolock",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "448-461",
          "snippet": "static u64 latched_seq_read_nolock(struct latched_seq *ls)\n{\n\tunsigned int seq;\n\tunsigned int idx;\n\tu64 val;\n\n\tdo {\n\t\tseq = raw_read_seqcount_latch(&ls->latch);\n\t\tidx = seq & 0x1;\n\t\tval = ls->val[idx];\n\t} while (read_seqcount_latch_retry(&ls->latch, seq));\n\n\treturn val;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic u64 latched_seq_read_nolock(struct latched_seq *ls)\n{\n\tunsigned int seq;\n\tunsigned int idx;\n\tu64 val;\n\n\tdo {\n\t\tseq = raw_read_seqcount_latch(&ls->latch);\n\t\tidx = seq & 0x1;\n\t\tval = ls->val[idx];\n\t} while (read_seqcount_latch_retry(&ls->latch, seq));\n\n\treturn val;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define printk_time\t\tfalse\n\nbool kmsg_dump_get_line(struct kmsg_dump_iter *iter, bool syslog,\n\t\t\tchar *line, size_t size, size_t *len)\n{\n\tu64 min_seq = latched_seq_read_nolock(&clear_seq);\n\tstruct printk_info info;\n\tunsigned int line_count;\n\tstruct printk_record r;\n\tsize_t l = 0;\n\tbool ret = false;\n\n\tif (iter->cur_seq < min_seq)\n\t\titer->cur_seq = min_seq;\n\n\tprb_rec_init_rd(&r, &info, line, size);\n\n\t/* Read text or count text lines? */\n\tif (line) {\n\t\tif (!prb_read_valid(prb, iter->cur_seq, &r))\n\t\t\tgoto out;\n\t\tl = record_print_text(&r, syslog, printk_time);\n\t} else {\n\t\tif (!prb_read_valid_info(prb, iter->cur_seq,\n\t\t\t\t\t &info, &line_count)) {\n\t\t\tgoto out;\n\t\t}\n\t\tl = get_record_print_text_size(&info, line_count, syslog,\n\t\t\t\t\t       printk_time);\n\n\t}\n\n\titer->cur_seq = r.info->seq + 1;\n\tret = true;\nout:\n\tif (len)\n\t\t*len = l;\n\treturn ret;\n}"
  },
  {
    "function_name": "kmsg_dump",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "3419-3442",
    "snippet": "void kmsg_dump(enum kmsg_dump_reason reason)\n{\n\tstruct kmsg_dumper *dumper;\n\n\trcu_read_lock();\n\tlist_for_each_entry_rcu(dumper, &dump_list, list) {\n\t\tenum kmsg_dump_reason max_reason = dumper->max_reason;\n\n\t\t/*\n\t\t * If client has not provided a specific max_reason, default\n\t\t * to KMSG_DUMP_OOPS, unless always_kmsg_dump was set.\n\t\t */\n\t\tif (max_reason == KMSG_DUMP_UNDEF) {\n\t\t\tmax_reason = always_kmsg_dump ? KMSG_DUMP_MAX :\n\t\t\t\t\t\t\tKMSG_DUMP_OOPS;\n\t\t}\n\t\tif (reason > max_reason)\n\t\t\tcontinue;\n\n\t\t/* invoke dumper which will iterate over records */\n\t\tdumper->dump(dumper, reason);\n\t}\n\trcu_read_unlock();\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_read_unlock",
          "args": [],
          "line": 3441
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_read_unlock_strict",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/tree_plugin.h",
          "lines": "815-824",
          "snippet": "void rcu_read_unlock_strict(void)\n{\n\tstruct rcu_data *rdp;\n\n\tif (irqs_disabled() || preempt_count() || !rcu_state.gp_kthread)\n\t\treturn;\n\trdp = this_cpu_ptr(&rcu_data);\n\trcu_report_qs_rdp(rdp);\n\tudelay(rcu_unlock_delay);\n}",
          "includes": [
            "#include \"../locking/rtmutex_common.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"../locking/rtmutex_common.h\"\n\nvoid rcu_read_unlock_strict(void)\n{\n\tstruct rcu_data *rdp;\n\n\tif (irqs_disabled() || preempt_count() || !rcu_state.gp_kthread)\n\t\treturn;\n\trdp = this_cpu_ptr(&rcu_data);\n\trcu_report_qs_rdp(rdp);\n\tudelay(rcu_unlock_delay);\n}"
        }
      },
      {
        "call_info": {
          "callee": "dumper->dump",
          "args": [
            "dumper",
            "reason"
          ],
          "line": 3439
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_rcu",
          "args": [
            "dumper",
            "&dump_list",
            "list"
          ],
          "line": 3424
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_read_lock",
          "args": [],
          "line": 3423
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_read_lock_any_held",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/update.c",
          "lines": "340-351",
          "snippet": "int rcu_read_lock_any_held(void)\n{\n\tbool ret;\n\n\tif (rcu_read_lock_held_common(&ret))\n\t\treturn ret;\n\tif (lock_is_held(&rcu_lock_map) ||\n\t    lock_is_held(&rcu_bh_lock_map) ||\n\t    lock_is_held(&rcu_sched_lock_map))\n\t\treturn 1;\n\treturn !preemptible();\n}",
          "includes": [
            "#include \"tasks.h\"",
            "#include \"rcu.h\"",
            "#include <linux/rcupdate_trace.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/slab.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/tick.h>",
            "#include <linux/kthread.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/delay.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/export.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bitops.h>",
            "#include <linux/atomic.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tasks.h\"\n#include \"rcu.h\"\n#include <linux/rcupdate_trace.h>\n#include <linux/irq_work.h>\n#include <linux/slab.h>\n#include <linux/kprobes.h>\n#include <linux/sched/isolation.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/tick.h>\n#include <linux/kthread.h>\n#include <linux/moduleparam.h>\n#include <linux/delay.h>\n#include <linux/hardirq.h>\n#include <linux/export.h>\n#include <linux/mutex.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/percpu.h>\n#include <linux/bitops.h>\n#include <linux/atomic.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/signal.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nint rcu_read_lock_any_held(void)\n{\n\tbool ret;\n\n\tif (rcu_read_lock_held_common(&ret))\n\t\treturn ret;\n\tif (lock_is_held(&rcu_lock_map) ||\n\t    lock_is_held(&rcu_bh_lock_map) ||\n\t    lock_is_held(&rcu_sched_lock_map))\n\t\treturn 1;\n\treturn !preemptible();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nvoid kmsg_dump(enum kmsg_dump_reason reason)\n{\n\tstruct kmsg_dumper *dumper;\n\n\trcu_read_lock();\n\tlist_for_each_entry_rcu(dumper, &dump_list, list) {\n\t\tenum kmsg_dump_reason max_reason = dumper->max_reason;\n\n\t\t/*\n\t\t * If client has not provided a specific max_reason, default\n\t\t * to KMSG_DUMP_OOPS, unless always_kmsg_dump was set.\n\t\t */\n\t\tif (max_reason == KMSG_DUMP_UNDEF) {\n\t\t\tmax_reason = always_kmsg_dump ? KMSG_DUMP_MAX :\n\t\t\t\t\t\t\tKMSG_DUMP_OOPS;\n\t\t}\n\t\tif (reason > max_reason)\n\t\t\tcontinue;\n\n\t\t/* invoke dumper which will iterate over records */\n\t\tdumper->dump(dumper, reason);\n\t}\n\trcu_read_unlock();\n}"
  },
  {
    "function_name": "kmsg_dump_reason_str",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "3394-3408",
    "snippet": "const char *kmsg_dump_reason_str(enum kmsg_dump_reason reason)\n{\n\tswitch (reason) {\n\tcase KMSG_DUMP_PANIC:\n\t\treturn \"Panic\";\n\tcase KMSG_DUMP_OOPS:\n\t\treturn \"Oops\";\n\tcase KMSG_DUMP_EMERG:\n\t\treturn \"Emergency\";\n\tcase KMSG_DUMP_SHUTDOWN:\n\t\treturn \"Shutdown\";\n\tdefault:\n\t\treturn \"Unknown\";\n\t}\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nconst char *kmsg_dump_reason_str(enum kmsg_dump_reason reason)\n{\n\tswitch (reason) {\n\tcase KMSG_DUMP_PANIC:\n\t\treturn \"Panic\";\n\tcase KMSG_DUMP_OOPS:\n\t\treturn \"Oops\";\n\tcase KMSG_DUMP_EMERG:\n\t\treturn \"Emergency\";\n\tcase KMSG_DUMP_SHUTDOWN:\n\t\treturn \"Shutdown\";\n\tdefault:\n\t\treturn \"Unknown\";\n\t}\n}"
  },
  {
    "function_name": "kmsg_dump_unregister",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "3373-3388",
    "snippet": "int kmsg_dump_unregister(struct kmsg_dumper *dumper)\n{\n\tunsigned long flags;\n\tint err = -EINVAL;\n\n\tspin_lock_irqsave(&dump_list_lock, flags);\n\tif (dumper->registered) {\n\t\tdumper->registered = 0;\n\t\tlist_del_rcu(&dumper->list);\n\t\terr = 0;\n\t}\n\tspin_unlock_irqrestore(&dump_list_lock, flags);\n\tsynchronize_rcu();\n\n\treturn err;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "synchronize_rcu",
          "args": [],
          "line": 3385
        },
        "resolved": true,
        "details": {
          "function_name": "synchronize_rcu_expedited",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/tree_exp.h",
          "lines": "816-865",
          "snippet": "void synchronize_rcu_expedited(void)\n{\n\tbool boottime = (rcu_scheduler_active == RCU_SCHEDULER_INIT);\n\tstruct rcu_exp_work rew;\n\tstruct rcu_node *rnp;\n\tunsigned long s;\n\n\tRCU_LOCKDEP_WARN(lock_is_held(&rcu_bh_lock_map) ||\n\t\t\t lock_is_held(&rcu_lock_map) ||\n\t\t\t lock_is_held(&rcu_sched_lock_map),\n\t\t\t \"Illegal synchronize_rcu_expedited() in RCU read-side critical section\");\n\n\t/* Is the state is such that the call is a grace period? */\n\tif (rcu_blocking_is_gp())\n\t\treturn;\n\n\t/* If expedited grace periods are prohibited, fall back to normal. */\n\tif (rcu_gp_is_normal()) {\n\t\twait_rcu_gp(call_rcu);\n\t\treturn;\n\t}\n\n\t/* Take a snapshot of the sequence number.  */\n\ts = rcu_exp_gp_seq_snap();\n\tif (exp_funnel_lock(s))\n\t\treturn;  /* Someone else did our work for us. */\n\n\t/* Ensure that load happens before action based on it. */\n\tif (unlikely(boottime)) {\n\t\t/* Direct call during scheduler init and early_initcalls(). */\n\t\trcu_exp_sel_wait_wake(s);\n\t} else {\n\t\t/* Marshall arguments & schedule the expedited grace period. */\n\t\trew.rew_s = s;\n\t\tINIT_WORK_ONSTACK(&rew.rew_work, wait_rcu_exp_gp);\n\t\tqueue_work(rcu_gp_wq, &rew.rew_work);\n\t}\n\n\t/* Wait for expedited grace period to complete. */\n\trnp = rcu_get_root();\n\twait_event(rnp->exp_wq[rcu_seq_ctr(s) & 0x3],\n\t\t   sync_exp_work_done(s));\n\tsmp_mb(); /* Workqueue actions happen before return. */\n\n\t/* Let the next expedited grace period start. */\n\tmutex_unlock(&rcu_state.exp_mutex);\n\n\tif (likely(!boottime))\n\t\tdestroy_work_on_stack(&rew.rew_work);\n}",
          "includes": [
            "#include <linux/lockdep.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int rcu_print_task_exp_stall(struct rcu_node *rnp);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockdep.h>\n\nstatic int rcu_print_task_exp_stall(struct rcu_node *rnp);\n\nvoid synchronize_rcu_expedited(void)\n{\n\tbool boottime = (rcu_scheduler_active == RCU_SCHEDULER_INIT);\n\tstruct rcu_exp_work rew;\n\tstruct rcu_node *rnp;\n\tunsigned long s;\n\n\tRCU_LOCKDEP_WARN(lock_is_held(&rcu_bh_lock_map) ||\n\t\t\t lock_is_held(&rcu_lock_map) ||\n\t\t\t lock_is_held(&rcu_sched_lock_map),\n\t\t\t \"Illegal synchronize_rcu_expedited() in RCU read-side critical section\");\n\n\t/* Is the state is such that the call is a grace period? */\n\tif (rcu_blocking_is_gp())\n\t\treturn;\n\n\t/* If expedited grace periods are prohibited, fall back to normal. */\n\tif (rcu_gp_is_normal()) {\n\t\twait_rcu_gp(call_rcu);\n\t\treturn;\n\t}\n\n\t/* Take a snapshot of the sequence number.  */\n\ts = rcu_exp_gp_seq_snap();\n\tif (exp_funnel_lock(s))\n\t\treturn;  /* Someone else did our work for us. */\n\n\t/* Ensure that load happens before action based on it. */\n\tif (unlikely(boottime)) {\n\t\t/* Direct call during scheduler init and early_initcalls(). */\n\t\trcu_exp_sel_wait_wake(s);\n\t} else {\n\t\t/* Marshall arguments & schedule the expedited grace period. */\n\t\trew.rew_s = s;\n\t\tINIT_WORK_ONSTACK(&rew.rew_work, wait_rcu_exp_gp);\n\t\tqueue_work(rcu_gp_wq, &rew.rew_work);\n\t}\n\n\t/* Wait for expedited grace period to complete. */\n\trnp = rcu_get_root();\n\twait_event(rnp->exp_wq[rcu_seq_ctr(s) & 0x3],\n\t\t   sync_exp_work_done(s));\n\tsmp_mb(); /* Workqueue actions happen before return. */\n\n\t/* Let the next expedited grace period start. */\n\tmutex_unlock(&rcu_state.exp_mutex);\n\n\tif (likely(!boottime))\n\t\tdestroy_work_on_stack(&rew.rew_work);\n}"
        }
      },
      {
        "call_info": {
          "callee": "spin_unlock_irqrestore",
          "args": [
            "&dump_list_lock",
            "flags"
          ],
          "line": 3384
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irqrestore",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "192-195",
          "snippet": "void __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del_rcu",
          "args": [
            "&dumper->list"
          ],
          "line": 3381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_irqsave",
          "args": [
            "&dump_list_lock",
            "flags"
          ],
          "line": 3378
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irqsave_nested",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "383-393",
          "snippet": "unsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nunsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nint kmsg_dump_unregister(struct kmsg_dumper *dumper)\n{\n\tunsigned long flags;\n\tint err = -EINVAL;\n\n\tspin_lock_irqsave(&dump_list_lock, flags);\n\tif (dumper->registered) {\n\t\tdumper->registered = 0;\n\t\tlist_del_rcu(&dumper->list);\n\t\terr = 0;\n\t}\n\tspin_unlock_irqrestore(&dump_list_lock, flags);\n\tsynchronize_rcu();\n\n\treturn err;\n}"
  },
  {
    "function_name": "kmsg_dump_register",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "3344-3363",
    "snippet": "int kmsg_dump_register(struct kmsg_dumper *dumper)\n{\n\tunsigned long flags;\n\tint err = -EBUSY;\n\n\t/* The dump callback needs to be set */\n\tif (!dumper->dump)\n\t\treturn -EINVAL;\n\n\tspin_lock_irqsave(&dump_list_lock, flags);\n\t/* Don't allow registering multiple times */\n\tif (!dumper->registered) {\n\t\tdumper->registered = 1;\n\t\tlist_add_tail_rcu(&dumper->list, &dump_list);\n\t\terr = 0;\n\t}\n\tspin_unlock_irqrestore(&dump_list_lock, flags);\n\n\treturn err;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_unlock_irqrestore",
          "args": [
            "&dump_list_lock",
            "flags"
          ],
          "line": 3360
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_irqrestore",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "192-195",
          "snippet": "void __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_irqrestore(raw_spinlock_t *lock, unsigned long flags)\n{\n\t__raw_spin_unlock_irqrestore(lock, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_add_tail_rcu",
          "args": [
            "&dumper->list",
            "&dump_list"
          ],
          "line": 3357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_lock_irqsave",
          "args": [
            "&dump_list_lock",
            "flags"
          ],
          "line": 3353
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_irqsave_nested",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "383-393",
          "snippet": "unsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nunsigned long __lockfunc _raw_spin_lock_irqsave_nested(raw_spinlock_t *lock,\n\t\t\t\t\t\t   int subclass)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tpreempt_disable();\n\tspin_acquire(&lock->dep_map, subclass, 0, _RET_IP_);\n\tLOCK_CONTENDED(lock, do_raw_spin_trylock, do_raw_spin_lock);\n\treturn flags;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nint kmsg_dump_register(struct kmsg_dumper *dumper)\n{\n\tunsigned long flags;\n\tint err = -EBUSY;\n\n\t/* The dump callback needs to be set */\n\tif (!dumper->dump)\n\t\treturn -EINVAL;\n\n\tspin_lock_irqsave(&dump_list_lock, flags);\n\t/* Don't allow registering multiple times */\n\tif (!dumper->registered) {\n\t\tdumper->registered = 1;\n\t\tlist_add_tail_rcu(&dumper->list, &dump_list);\n\t\terr = 0;\n\t}\n\tspin_unlock_irqrestore(&dump_list_lock, flags);\n\n\treturn err;\n}"
  },
  {
    "function_name": "printk_timed_ratelimit",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "3320-3330",
    "snippet": "bool printk_timed_ratelimit(unsigned long *caller_jiffies,\n\t\t\tunsigned int interval_msecs)\n{\n\tunsigned long elapsed = jiffies - *caller_jiffies;\n\n\tif (*caller_jiffies && elapsed <= msecs_to_jiffies(interval_msecs))\n\t\treturn false;\n\n\t*caller_jiffies = jiffies;\n\treturn true;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "msecs_to_jiffies",
          "args": [
            "interval_msecs"
          ],
          "line": 3325
        },
        "resolved": true,
        "details": {
          "function_name": "__msecs_to_jiffies",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/time.c",
          "lines": "552-560",
          "snippet": "unsigned long __msecs_to_jiffies(const unsigned int m)\n{\n\t/*\n\t * Negative value, means infinite timeout:\n\t */\n\tif ((int)m < 0)\n\t\treturn MAX_JIFFY_OFFSET;\n\treturn _msecs_to_jiffies(m);\n}",
          "includes": [
            "#include \"timekeeping.h\"",
            "#include <generated/timeconst.h>",
            "#include <asm/unistd.h>",
            "#include <linux/compat.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/math64.h>",
            "#include <linux/fs.h>",
            "#include <linux/security.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/errno.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/capability.h>",
            "#include <linux/timex.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nunsigned long __msecs_to_jiffies(const unsigned int m)\n{\n\t/*\n\t * Negative value, means infinite timeout:\n\t */\n\tif ((int)m < 0)\n\t\treturn MAX_JIFFY_OFFSET;\n\treturn _msecs_to_jiffies(m);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nbool printk_timed_ratelimit(unsigned long *caller_jiffies,\n\t\t\tunsigned int interval_msecs)\n{\n\tunsigned long elapsed = jiffies - *caller_jiffies;\n\n\tif (*caller_jiffies && elapsed <= msecs_to_jiffies(interval_msecs))\n\t\treturn false;\n\n\t*caller_jiffies = jiffies;\n\treturn true;\n}"
  },
  {
    "function_name": "__printk_ratelimit",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "3305-3308",
    "snippet": "int __printk_ratelimit(const char *func)\n{\n\treturn ___ratelimit(&printk_ratelimit_state, func);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "___ratelimit",
          "args": [
            "&printk_ratelimit_state",
            "func"
          ],
          "line": 3307
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nint __printk_ratelimit(const char *func)\n{\n\treturn ___ratelimit(&printk_ratelimit_state, func);\n}"
  },
  {
    "function_name": "_printk_deferred",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "3285-3295",
    "snippet": "int _printk_deferred(const char *fmt, ...)\n{\n\tva_list args;\n\tint r;\n\n\tva_start(args, fmt);\n\tr = vprintk_deferred(fmt, args);\n\tva_end(args);\n\n\treturn r;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "args"
          ],
          "line": 3292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vprintk_deferred",
          "args": [
            "fmt",
            "args"
          ],
          "line": 3291
        },
        "resolved": true,
        "details": {
          "function_name": "vprintk_deferred",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "3275-3283",
          "snippet": "int vprintk_deferred(const char *fmt, va_list args)\n{\n\tint r;\n\n\tr = vprintk_emit(0, LOGLEVEL_SCHED, NULL, fmt, args);\n\tdefer_console_output();\n\n\treturn r;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nint vprintk_deferred(const char *fmt, va_list args)\n{\n\tint r;\n\n\tr = vprintk_emit(0, LOGLEVEL_SCHED, NULL, fmt, args);\n\tdefer_console_output();\n\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "args",
            "fmt"
          ],
          "line": 3290
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nint _printk_deferred(const char *fmt, ...)\n{\n\tva_list args;\n\tint r;\n\n\tva_start(args, fmt);\n\tr = vprintk_deferred(fmt, args);\n\tva_end(args);\n\n\treturn r;\n}"
  },
  {
    "function_name": "vprintk_deferred",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "3275-3283",
    "snippet": "int vprintk_deferred(const char *fmt, va_list args)\n{\n\tint r;\n\n\tr = vprintk_emit(0, LOGLEVEL_SCHED, NULL, fmt, args);\n\tdefer_console_output();\n\n\treturn r;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "defer_console_output",
          "args": [],
          "line": 3280
        },
        "resolved": true,
        "details": {
          "function_name": "defer_console_output",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "3259-3268",
          "snippet": "void defer_console_output(void)\n{\n\tif (!printk_percpu_data_ready())\n\t\treturn;\n\n\tpreempt_disable();\n\t__this_cpu_or(printk_pending, PRINTK_PENDING_OUTPUT);\n\tirq_work_queue(this_cpu_ptr(&wake_up_klogd_work));\n\tpreempt_enable();\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define PRINTK_PENDING_OUTPUT\t0x02"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define PRINTK_PENDING_OUTPUT\t0x02\n\nvoid defer_console_output(void)\n{\n\tif (!printk_percpu_data_ready())\n\t\treturn;\n\n\tpreempt_disable();\n\t__this_cpu_or(printk_pending, PRINTK_PENDING_OUTPUT);\n\tirq_work_queue(this_cpu_ptr(&wake_up_klogd_work));\n\tpreempt_enable();\n}"
        }
      },
      {
        "call_info": {
          "callee": "vprintk_emit",
          "args": [
            "0",
            "LOGLEVEL_SCHED",
            "NULL",
            "fmt",
            "args"
          ],
          "line": 3279
        },
        "resolved": true,
        "details": {
          "function_name": "vprintk_emit",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2210-2251",
          "snippet": "asmlinkage int vprintk_emit(int facility, int level,\n\t\t\t    const struct dev_printk_info *dev_info,\n\t\t\t    const char *fmt, va_list args)\n{\n\tint printed_len;\n\tbool in_sched = false;\n\n\t/* Suppress unimportant messages after panic happens */\n\tif (unlikely(suppress_printk))\n\t\treturn 0;\n\n\tif (level == LOGLEVEL_SCHED) {\n\t\tlevel = LOGLEVEL_DEFAULT;\n\t\tin_sched = true;\n\t}\n\n\tboot_delay_msec(level);\n\tprintk_delay();\n\n\tprinted_len = vprintk_store(facility, level, dev_info, fmt, args);\n\n\t/* If called from the scheduler, we can not call up(). */\n\tif (!in_sched) {\n\t\t/*\n\t\t * Disable preemption to avoid being preempted while holding\n\t\t * console_sem which would prevent anyone from printing to\n\t\t * console\n\t\t */\n\t\tpreempt_disable();\n\t\t/*\n\t\t * Try to acquire and then immediately release the console\n\t\t * semaphore.  The release will print out buffers and wake up\n\t\t * /dev/kmsg and syslog() users.\n\t\t */\n\t\tif (console_trylock_spinning())\n\t\t\tconsole_unlock();\n\t\tpreempt_enable();\n\t}\n\n\twake_up_klogd();\n\treturn printed_len;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SEMAPHORE(console_sem);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic DEFINE_SEMAPHORE(console_sem);\n\nasmlinkage int vprintk_emit(int facility, int level,\n\t\t\t    const struct dev_printk_info *dev_info,\n\t\t\t    const char *fmt, va_list args)\n{\n\tint printed_len;\n\tbool in_sched = false;\n\n\t/* Suppress unimportant messages after panic happens */\n\tif (unlikely(suppress_printk))\n\t\treturn 0;\n\n\tif (level == LOGLEVEL_SCHED) {\n\t\tlevel = LOGLEVEL_DEFAULT;\n\t\tin_sched = true;\n\t}\n\n\tboot_delay_msec(level);\n\tprintk_delay();\n\n\tprinted_len = vprintk_store(facility, level, dev_info, fmt, args);\n\n\t/* If called from the scheduler, we can not call up(). */\n\tif (!in_sched) {\n\t\t/*\n\t\t * Disable preemption to avoid being preempted while holding\n\t\t * console_sem which would prevent anyone from printing to\n\t\t * console\n\t\t */\n\t\tpreempt_disable();\n\t\t/*\n\t\t * Try to acquire and then immediately release the console\n\t\t * semaphore.  The release will print out buffers and wake up\n\t\t * /dev/kmsg and syslog() users.\n\t\t */\n\t\tif (console_trylock_spinning())\n\t\t\tconsole_unlock();\n\t\tpreempt_enable();\n\t}\n\n\twake_up_klogd();\n\treturn printed_len;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nint vprintk_deferred(const char *fmt, va_list args)\n{\n\tint r;\n\n\tr = vprintk_emit(0, LOGLEVEL_SCHED, NULL, fmt, args);\n\tdefer_console_output();\n\n\treturn r;\n}"
  },
  {
    "function_name": "printk_trigger_flush",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "3270-3273",
    "snippet": "void printk_trigger_flush(void)\n{\n\tdefer_console_output();\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "defer_console_output",
          "args": [],
          "line": 3272
        },
        "resolved": true,
        "details": {
          "function_name": "defer_console_output",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "3259-3268",
          "snippet": "void defer_console_output(void)\n{\n\tif (!printk_percpu_data_ready())\n\t\treturn;\n\n\tpreempt_disable();\n\t__this_cpu_or(printk_pending, PRINTK_PENDING_OUTPUT);\n\tirq_work_queue(this_cpu_ptr(&wake_up_klogd_work));\n\tpreempt_enable();\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define PRINTK_PENDING_OUTPUT\t0x02"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define PRINTK_PENDING_OUTPUT\t0x02\n\nvoid defer_console_output(void)\n{\n\tif (!printk_percpu_data_ready())\n\t\treturn;\n\n\tpreempt_disable();\n\t__this_cpu_or(printk_pending, PRINTK_PENDING_OUTPUT);\n\tirq_work_queue(this_cpu_ptr(&wake_up_klogd_work));\n\tpreempt_enable();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nvoid printk_trigger_flush(void)\n{\n\tdefer_console_output();\n}"
  },
  {
    "function_name": "defer_console_output",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "3259-3268",
    "snippet": "void defer_console_output(void)\n{\n\tif (!printk_percpu_data_ready())\n\t\treturn;\n\n\tpreempt_disable();\n\t__this_cpu_or(printk_pending, PRINTK_PENDING_OUTPUT);\n\tirq_work_queue(this_cpu_ptr(&wake_up_klogd_work));\n\tpreempt_enable();\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define PRINTK_PENDING_OUTPUT\t0x02"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 3267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_work_queue",
          "args": [
            "this_cpu_ptr(&wake_up_klogd_work)"
          ],
          "line": 3266
        },
        "resolved": true,
        "details": {
          "function_name": "irq_work_queue",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq_work.c",
          "lines": "106-118",
          "snippet": "bool irq_work_queue(struct irq_work *work)\n{\n\t/* Only queue if not already pending */\n\tif (!irq_work_claim(work))\n\t\treturn false;\n\n\t/* Queue the entry and raise the IPI if needed. */\n\tpreempt_disable();\n\t__irq_work_queue_local(work);\n\tpreempt_enable();\n\n\treturn true;\n}",
          "includes": [
            "#include <linux/kasan.h>",
            "#include <asm/processor.h>",
            "#include <linux/smpboot.h>",
            "#include <linux/smp.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/tick.h>",
            "#include <linux/sched.h>",
            "#include <linux/irqflags.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/percpu.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>",
            "#include <linux/bug.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kasan.h>\n#include <asm/processor.h>\n#include <linux/smpboot.h>\n#include <linux/smp.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/tick.h>\n#include <linux/sched.h>\n#include <linux/irqflags.h>\n#include <linux/hardirq.h>\n#include <linux/percpu.h>\n#include <linux/irq_work.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/bug.h>\n\nbool irq_work_queue(struct irq_work *work)\n{\n\t/* Only queue if not already pending */\n\tif (!irq_work_claim(work))\n\t\treturn false;\n\n\t/* Queue the entry and raise the IPI if needed. */\n\tpreempt_disable();\n\t__irq_work_queue_local(work);\n\tpreempt_enable();\n\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "this_cpu_ptr",
          "args": [
            "&wake_up_klogd_work"
          ],
          "line": 3266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__this_cpu_or",
          "args": [
            "printk_pending",
            "PRINTK_PENDING_OUTPUT"
          ],
          "line": 3265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "preempt_disable",
          "args": [],
          "line": 3264
        },
        "resolved": true,
        "details": {
          "function_name": "schedule_preempt_disabled",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/core.c",
          "lines": "6425-6430",
          "snippet": "void __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}",
          "includes": [
            "#include <linux/entry-common.h>",
            "#include \"features.h\"",
            "#include \"smp.h\"",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../../fs/io-wq.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/scs.h>",
            "#include <linux/kcov.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\"",
            "#include <trace/events/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __sched",
            "static void __sched"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/entry-common.h>\n#include \"features.h\"\n#include \"smp.h\"\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../../fs/io-wq.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/scs.h>\n#include <linux/kcov.h>\n#include <linux/blkdev.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n#include <trace/events/sched.h>\n\nstatic void __sched;\nstatic void __sched;\n\nvoid __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk_percpu_data_ready",
          "args": [],
          "line": 3261
        },
        "resolved": true,
        "details": {
          "function_name": "printk_percpu_data_ready",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "433-436",
          "snippet": "bool printk_percpu_data_ready(void)\n{\n\treturn __printk_percpu_data_ready;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nbool printk_percpu_data_ready(void)\n{\n\treturn __printk_percpu_data_ready;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define PRINTK_PENDING_OUTPUT\t0x02\n\nvoid defer_console_output(void)\n{\n\tif (!printk_percpu_data_ready())\n\t\treturn;\n\n\tpreempt_disable();\n\t__this_cpu_or(printk_pending, PRINTK_PENDING_OUTPUT);\n\tirq_work_queue(this_cpu_ptr(&wake_up_klogd_work));\n\tpreempt_enable();\n}"
  },
  {
    "function_name": "wake_up_klogd",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "3246-3257",
    "snippet": "void wake_up_klogd(void)\n{\n\tif (!printk_percpu_data_ready())\n\t\treturn;\n\n\tpreempt_disable();\n\tif (waitqueue_active(&log_wait)) {\n\t\tthis_cpu_or(printk_pending, PRINTK_PENDING_WAKEUP);\n\t\tirq_work_queue(this_cpu_ptr(&wake_up_klogd_work));\n\t}\n\tpreempt_enable();\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define PRINTK_PENDING_WAKEUP\t0x01"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 3256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irq_work_queue",
          "args": [
            "this_cpu_ptr(&wake_up_klogd_work)"
          ],
          "line": 3254
        },
        "resolved": true,
        "details": {
          "function_name": "irq_work_queue",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/irq_work.c",
          "lines": "106-118",
          "snippet": "bool irq_work_queue(struct irq_work *work)\n{\n\t/* Only queue if not already pending */\n\tif (!irq_work_claim(work))\n\t\treturn false;\n\n\t/* Queue the entry and raise the IPI if needed. */\n\tpreempt_disable();\n\t__irq_work_queue_local(work);\n\tpreempt_enable();\n\n\treturn true;\n}",
          "includes": [
            "#include <linux/kasan.h>",
            "#include <asm/processor.h>",
            "#include <linux/smpboot.h>",
            "#include <linux/smp.h>",
            "#include <linux/notifier.h>",
            "#include <linux/cpu.h>",
            "#include <linux/tick.h>",
            "#include <linux/sched.h>",
            "#include <linux/irqflags.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/percpu.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>",
            "#include <linux/bug.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/kasan.h>\n#include <asm/processor.h>\n#include <linux/smpboot.h>\n#include <linux/smp.h>\n#include <linux/notifier.h>\n#include <linux/cpu.h>\n#include <linux/tick.h>\n#include <linux/sched.h>\n#include <linux/irqflags.h>\n#include <linux/hardirq.h>\n#include <linux/percpu.h>\n#include <linux/irq_work.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/bug.h>\n\nbool irq_work_queue(struct irq_work *work)\n{\n\t/* Only queue if not already pending */\n\tif (!irq_work_claim(work))\n\t\treturn false;\n\n\t/* Queue the entry and raise the IPI if needed. */\n\tpreempt_disable();\n\t__irq_work_queue_local(work);\n\tpreempt_enable();\n\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "this_cpu_ptr",
          "args": [
            "&wake_up_klogd_work"
          ],
          "line": 3254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this_cpu_or",
          "args": [
            "printk_pending",
            "PRINTK_PENDING_WAKEUP"
          ],
          "line": 3253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "waitqueue_active",
          "args": [
            "&log_wait"
          ],
          "line": 3252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "preempt_disable",
          "args": [],
          "line": 3251
        },
        "resolved": true,
        "details": {
          "function_name": "schedule_preempt_disabled",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/core.c",
          "lines": "6425-6430",
          "snippet": "void __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}",
          "includes": [
            "#include <linux/entry-common.h>",
            "#include \"features.h\"",
            "#include \"smp.h\"",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../../fs/io-wq.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/scs.h>",
            "#include <linux/kcov.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\"",
            "#include <trace/events/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __sched",
            "static void __sched"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/entry-common.h>\n#include \"features.h\"\n#include \"smp.h\"\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../../fs/io-wq.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/scs.h>\n#include <linux/kcov.h>\n#include <linux/blkdev.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n#include <trace/events/sched.h>\n\nstatic void __sched;\nstatic void __sched;\n\nvoid __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk_percpu_data_ready",
          "args": [],
          "line": 3248
        },
        "resolved": true,
        "details": {
          "function_name": "printk_percpu_data_ready",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "433-436",
          "snippet": "bool printk_percpu_data_ready(void)\n{\n\treturn __printk_percpu_data_ready;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nbool printk_percpu_data_ready(void)\n{\n\treturn __printk_percpu_data_ready;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define PRINTK_PENDING_WAKEUP\t0x01\n\nvoid wake_up_klogd(void)\n{\n\tif (!printk_percpu_data_ready())\n\t\treturn;\n\n\tpreempt_disable();\n\tif (waitqueue_active(&log_wait)) {\n\t\tthis_cpu_or(printk_pending, PRINTK_PENDING_WAKEUP);\n\t\tirq_work_queue(this_cpu_ptr(&wake_up_klogd_work));\n\t}\n\tpreempt_enable();\n}"
  },
  {
    "function_name": "wake_up_klogd_work_func",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "3229-3241",
    "snippet": "static void wake_up_klogd_work_func(struct irq_work *irq_work)\n{\n\tint pending = __this_cpu_xchg(printk_pending, 0);\n\n\tif (pending & PRINTK_PENDING_OUTPUT) {\n\t\t/* If trylock fails, someone else is doing the printing */\n\t\tif (console_trylock())\n\t\t\tconsole_unlock();\n\t}\n\n\tif (pending & PRINTK_PENDING_WAKEUP)\n\t\twake_up_interruptible(&log_wait);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define PRINTK_PENDING_OUTPUT\t0x02",
      "#define PRINTK_PENDING_WAKEUP\t0x01"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wake_up_interruptible",
          "args": [
            "&log_wait"
          ],
          "line": 3240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "console_unlock",
          "args": [],
          "line": 3236
        },
        "resolved": true,
        "details": {
          "function_name": "console_unlock",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2602-2738",
          "snippet": "void console_unlock(void)\n{\n\tstatic char ext_text[CONSOLE_EXT_LOG_MAX];\n\tstatic char text[CONSOLE_LOG_MAX];\n\tunsigned long flags;\n\tbool do_cond_resched, retry;\n\tstruct printk_info info;\n\tstruct printk_record r;\n\tu64 __maybe_unused next_seq;\n\n\tif (console_suspended) {\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tprb_rec_init_rd(&r, &info, text, sizeof(text));\n\n\t/*\n\t * Console drivers are called with interrupts disabled, so\n\t * @console_may_schedule should be cleared before; however, we may\n\t * end up dumping a lot of lines, for example, if called from\n\t * console registration path, and should invoke cond_resched()\n\t * between lines if allowable.  Not doing so can cause a very long\n\t * scheduling stall on a slow console leading to RCU stall and\n\t * softlockup warnings which exacerbate the issue with more\n\t * messages practically incapacitating the system.\n\t *\n\t * console_trylock() is not able to detect the preemptive\n\t * context reliably. Therefore the value must be stored before\n\t * and cleared after the \"again\" goto label.\n\t */\n\tdo_cond_resched = console_may_schedule;\nagain:\n\tconsole_may_schedule = 0;\n\n\t/*\n\t * We released the console_sem lock, so we need to recheck if\n\t * cpu is online and (if not) is there at least one CON_ANYTIME\n\t * console.\n\t */\n\tif (!can_use_console()) {\n\t\tconsole_locked = 0;\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tfor (;;) {\n\t\tsize_t ext_len = 0;\n\t\tint handover;\n\t\tsize_t len;\n\nskip:\n\t\tif (!prb_read_valid(prb, console_seq, &r))\n\t\t\tbreak;\n\n\t\tif (console_seq != r.info->seq) {\n\t\t\tconsole_dropped += r.info->seq - console_seq;\n\t\t\tconsole_seq = r.info->seq;\n\t\t}\n\n\t\tif (suppress_message_printing(r.info->level)) {\n\t\t\t/*\n\t\t\t * Skip record we have buffered and already printed\n\t\t\t * directly to the console when we received it, and\n\t\t\t * record that has level above the console loglevel.\n\t\t\t */\n\t\t\tconsole_seq++;\n\t\t\tgoto skip;\n\t\t}\n\n\t\t/* Output to all consoles once old messages replayed. */\n\t\tif (unlikely(exclusive_console &&\n\t\t\t     console_seq >= exclusive_console_stop_seq)) {\n\t\t\texclusive_console = NULL;\n\t\t}\n\n\t\t/*\n\t\t * Handle extended console text first because later\n\t\t * record_print_text() will modify the record buffer in-place.\n\t\t */\n\t\tif (nr_ext_console_drivers) {\n\t\t\text_len = info_print_ext_header(ext_text,\n\t\t\t\t\t\tsizeof(ext_text),\n\t\t\t\t\t\tr.info);\n\t\t\text_len += msg_print_ext_body(ext_text + ext_len,\n\t\t\t\t\t\tsizeof(ext_text) - ext_len,\n\t\t\t\t\t\t&r.text_buf[0],\n\t\t\t\t\t\tr.info->text_len,\n\t\t\t\t\t\t&r.info->dev_info);\n\t\t}\n\t\tlen = record_print_text(&r,\n\t\t\t\tconsole_msg_format & MSG_FORMAT_SYSLOG,\n\t\t\t\tprintk_time);\n\t\tconsole_seq++;\n\n\t\t/*\n\t\t * While actively printing out messages, if another printk()\n\t\t * were to occur on another CPU, it may wait for this one to\n\t\t * finish. This task can not be preempted if there is a\n\t\t * waiter waiting to take over.\n\t\t *\n\t\t * Interrupts are disabled because the hand over to a waiter\n\t\t * must not be interrupted until the hand over is completed\n\t\t * (@console_waiter is cleared).\n\t\t */\n\t\tprintk_safe_enter_irqsave(flags);\n\t\tconsole_lock_spinning_enable();\n\n\t\tstop_critical_timings();\t/* don't trace print latency */\n\t\tcall_console_drivers(ext_text, ext_len, text, len);\n\t\tstart_critical_timings();\n\n\t\thandover = console_lock_spinning_disable_and_check();\n\t\tprintk_safe_exit_irqrestore(flags);\n\t\tif (handover)\n\t\t\treturn;\n\n\t\tif (do_cond_resched)\n\t\t\tcond_resched();\n\t}\n\n\t/* Get consistent value of the next-to-be-used sequence number. */\n\tnext_seq = console_seq;\n\n\tconsole_locked = 0;\n\tup_console_sem();\n\n\t/*\n\t * Someone could have filled up the buffer again, so re-check if there's\n\t * something to flush. In case we cannot trylock the console_sem again,\n\t * there's a new owner and the console_unlock() from them will do the\n\t * flush, no worries.\n\t */\n\tretry = prb_read_valid(prb, next_seq, NULL);\n\tif (retry && console_trylock())\n\t\tgoto again;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define printk_time\t\tfalse",
            "#define CONSOLE_LOG_MAX\t\t0",
            "#define CONSOLE_LOG_MAX\t\t1024"
          ],
          "globals_used": [
            "static DEFINE_SEMAPHORE(console_sem);",
            "static int nr_ext_console_drivers;",
            "static int console_locked, console_suspended;",
            "static struct console *exclusive_console;",
            "static int console_may_schedule;",
            "static int console_msg_format = MSG_FORMAT_DEFAULT;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define printk_time\t\tfalse\n#define CONSOLE_LOG_MAX\t\t0\n#define CONSOLE_LOG_MAX\t\t1024\n\nstatic DEFINE_SEMAPHORE(console_sem);\nstatic int nr_ext_console_drivers;\nstatic int console_locked, console_suspended;\nstatic struct console *exclusive_console;\nstatic int console_may_schedule;\nstatic int console_msg_format = MSG_FORMAT_DEFAULT;\n\nvoid console_unlock(void)\n{\n\tstatic char ext_text[CONSOLE_EXT_LOG_MAX];\n\tstatic char text[CONSOLE_LOG_MAX];\n\tunsigned long flags;\n\tbool do_cond_resched, retry;\n\tstruct printk_info info;\n\tstruct printk_record r;\n\tu64 __maybe_unused next_seq;\n\n\tif (console_suspended) {\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tprb_rec_init_rd(&r, &info, text, sizeof(text));\n\n\t/*\n\t * Console drivers are called with interrupts disabled, so\n\t * @console_may_schedule should be cleared before; however, we may\n\t * end up dumping a lot of lines, for example, if called from\n\t * console registration path, and should invoke cond_resched()\n\t * between lines if allowable.  Not doing so can cause a very long\n\t * scheduling stall on a slow console leading to RCU stall and\n\t * softlockup warnings which exacerbate the issue with more\n\t * messages practically incapacitating the system.\n\t *\n\t * console_trylock() is not able to detect the preemptive\n\t * context reliably. Therefore the value must be stored before\n\t * and cleared after the \"again\" goto label.\n\t */\n\tdo_cond_resched = console_may_schedule;\nagain:\n\tconsole_may_schedule = 0;\n\n\t/*\n\t * We released the console_sem lock, so we need to recheck if\n\t * cpu is online and (if not) is there at least one CON_ANYTIME\n\t * console.\n\t */\n\tif (!can_use_console()) {\n\t\tconsole_locked = 0;\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tfor (;;) {\n\t\tsize_t ext_len = 0;\n\t\tint handover;\n\t\tsize_t len;\n\nskip:\n\t\tif (!prb_read_valid(prb, console_seq, &r))\n\t\t\tbreak;\n\n\t\tif (console_seq != r.info->seq) {\n\t\t\tconsole_dropped += r.info->seq - console_seq;\n\t\t\tconsole_seq = r.info->seq;\n\t\t}\n\n\t\tif (suppress_message_printing(r.info->level)) {\n\t\t\t/*\n\t\t\t * Skip record we have buffered and already printed\n\t\t\t * directly to the console when we received it, and\n\t\t\t * record that has level above the console loglevel.\n\t\t\t */\n\t\t\tconsole_seq++;\n\t\t\tgoto skip;\n\t\t}\n\n\t\t/* Output to all consoles once old messages replayed. */\n\t\tif (unlikely(exclusive_console &&\n\t\t\t     console_seq >= exclusive_console_stop_seq)) {\n\t\t\texclusive_console = NULL;\n\t\t}\n\n\t\t/*\n\t\t * Handle extended console text first because later\n\t\t * record_print_text() will modify the record buffer in-place.\n\t\t */\n\t\tif (nr_ext_console_drivers) {\n\t\t\text_len = info_print_ext_header(ext_text,\n\t\t\t\t\t\tsizeof(ext_text),\n\t\t\t\t\t\tr.info);\n\t\t\text_len += msg_print_ext_body(ext_text + ext_len,\n\t\t\t\t\t\tsizeof(ext_text) - ext_len,\n\t\t\t\t\t\t&r.text_buf[0],\n\t\t\t\t\t\tr.info->text_len,\n\t\t\t\t\t\t&r.info->dev_info);\n\t\t}\n\t\tlen = record_print_text(&r,\n\t\t\t\tconsole_msg_format & MSG_FORMAT_SYSLOG,\n\t\t\t\tprintk_time);\n\t\tconsole_seq++;\n\n\t\t/*\n\t\t * While actively printing out messages, if another printk()\n\t\t * were to occur on another CPU, it may wait for this one to\n\t\t * finish. This task can not be preempted if there is a\n\t\t * waiter waiting to take over.\n\t\t *\n\t\t * Interrupts are disabled because the hand over to a waiter\n\t\t * must not be interrupted until the hand over is completed\n\t\t * (@console_waiter is cleared).\n\t\t */\n\t\tprintk_safe_enter_irqsave(flags);\n\t\tconsole_lock_spinning_enable();\n\n\t\tstop_critical_timings();\t/* don't trace print latency */\n\t\tcall_console_drivers(ext_text, ext_len, text, len);\n\t\tstart_critical_timings();\n\n\t\thandover = console_lock_spinning_disable_and_check();\n\t\tprintk_safe_exit_irqrestore(flags);\n\t\tif (handover)\n\t\t\treturn;\n\n\t\tif (do_cond_resched)\n\t\t\tcond_resched();\n\t}\n\n\t/* Get consistent value of the next-to-be-used sequence number. */\n\tnext_seq = console_seq;\n\n\tconsole_locked = 0;\n\tup_console_sem();\n\n\t/*\n\t * Someone could have filled up the buffer again, so re-check if there's\n\t * something to flush. In case we cannot trylock the console_sem again,\n\t * there's a new owner and the console_unlock() from them will do the\n\t * flush, no worries.\n\t */\n\tretry = prb_read_valid(prb, next_seq, NULL);\n\tif (retry && console_trylock())\n\t\tgoto again;\n}"
        }
      },
      {
        "call_info": {
          "callee": "console_trylock",
          "args": [],
          "line": 3235
        },
        "resolved": true,
        "details": {
          "function_name": "console_trylock",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2540-2551",
          "snippet": "int console_trylock(void)\n{\n\tif (down_trylock_console_sem())\n\t\treturn 0;\n\tif (console_suspended) {\n\t\tup_console_sem();\n\t\treturn 0;\n\t}\n\tconsole_locked = 1;\n\tconsole_may_schedule = 0;\n\treturn 1;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int console_locked, console_suspended;",
            "static int console_may_schedule;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic int console_locked, console_suspended;\nstatic int console_may_schedule;\n\nint console_trylock(void)\n{\n\tif (down_trylock_console_sem())\n\t\treturn 0;\n\tif (console_suspended) {\n\t\tup_console_sem();\n\t\treturn 0;\n\t}\n\tconsole_locked = 1;\n\tconsole_may_schedule = 0;\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "__this_cpu_xchg",
          "args": [
            "printk_pending",
            "0"
          ],
          "line": 3231
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define PRINTK_PENDING_OUTPUT\t0x02\n#define PRINTK_PENDING_WAKEUP\t0x01\n\nstatic void wake_up_klogd_work_func(struct irq_work *irq_work)\n{\n\tint pending = __this_cpu_xchg(printk_pending, 0);\n\n\tif (pending & PRINTK_PENDING_OUTPUT) {\n\t\t/* If trylock fails, someone else is doing the printing */\n\t\tif (console_trylock())\n\t\t\tconsole_unlock();\n\t}\n\n\tif (pending & PRINTK_PENDING_WAKEUP)\n\t\twake_up_interruptible(&log_wait);\n}"
  },
  {
    "function_name": "printk_late_init",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "3184-3217",
    "snippet": "static int __init printk_late_init(void)\n{\n\tstruct console *con;\n\tint ret;\n\n\tfor_each_console(con) {\n\t\tif (!(con->flags & CON_BOOT))\n\t\t\tcontinue;\n\n\t\t/* Check addresses that might be used for enabled consoles. */\n\t\tif (init_section_intersects(con, sizeof(*con)) ||\n\t\t    init_section_contains(con->write, 0) ||\n\t\t    init_section_contains(con->read, 0) ||\n\t\t    init_section_contains(con->device, 0) ||\n\t\t    init_section_contains(con->unblank, 0) ||\n\t\t    init_section_contains(con->data, 0)) {\n\t\t\t/*\n\t\t\t * Please, consider moving the reported consoles out\n\t\t\t * of the init section.\n\t\t\t */\n\t\t\tpr_warn(\"bootconsole [%s%d] uses init memory and must be disabled even before the real one is ready\\n\",\n\t\t\t\tcon->name, con->index);\n\t\t\tunregister_console(con);\n\t\t}\n\t}\n\tret = cpuhp_setup_state_nocalls(CPUHP_PRINTK_DEAD, \"printk:dead\", NULL,\n\t\t\t\t\tconsole_cpu_notify);\n\tWARN_ON(ret < 0);\n\tret = cpuhp_setup_state_nocalls(CPUHP_AP_ONLINE_DYN, \"printk:online\",\n\t\t\t\t\tconsole_cpu_notify, NULL);\n\tWARN_ON(ret < 0);\n\tprintk_sysctl_init();\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk_sysctl_init",
          "args": [],
          "line": 3215
        },
        "resolved": true,
        "details": {
          "function_name": "printk_sysctl_init",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/sysctl.c",
          "lines": "82-85",
          "snippet": "void __init printk_sysctl_init(void)\n{\n\tregister_sysctl_init(\"kernel\", printk_sysctls);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include <linux/ratelimit.h>",
            "#include <linux/capability.h>",
            "#include <linux/printk.h>",
            "#include <linux/sysctl.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct ctl_table printk_sysctls[] = {\n\t{\n\t\t.procname\t= \"printk\",\n\t\t.data\t\t= &console_loglevel,\n\t\t.maxlen\t\t= 4*sizeof(int),\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= proc_dointvec,\n\t},\n\t{\n\t\t.procname\t= \"printk_ratelimit\",\n\t\t.data\t\t= &printk_ratelimit_state.interval,\n\t\t.maxlen\t\t= sizeof(int),\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= proc_dointvec_jiffies,\n\t},\n\t{\n\t\t.procname\t= \"printk_ratelimit_burst\",\n\t\t.data\t\t= &printk_ratelimit_state.burst,\n\t\t.maxlen\t\t= sizeof(int),\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= proc_dointvec,\n\t},\n\t{\n\t\t.procname\t= \"printk_delay\",\n\t\t.data\t\t= &printk_delay_msec,\n\t\t.maxlen\t\t= sizeof(int),\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= proc_dointvec_minmax,\n\t\t.extra1\t\t= SYSCTL_ZERO,\n\t\t.extra2\t\t= (void *)&ten_thousand,\n\t},\n\t{\n\t\t.procname\t= \"printk_devkmsg\",\n\t\t.data\t\t= devkmsg_log_str,\n\t\t.maxlen\t\t= DEVKMSG_STR_MAX_SIZE,\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= devkmsg_sysctl_set_loglvl,\n\t},\n\t{\n\t\t.procname\t= \"dmesg_restrict\",\n\t\t.data\t\t= &dmesg_restrict,\n\t\t.maxlen\t\t= sizeof(int),\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= proc_dointvec_minmax_sysadmin,\n\t\t.extra1\t\t= SYSCTL_ZERO,\n\t\t.extra2\t\t= SYSCTL_ONE,\n\t},\n\t{\n\t\t.procname\t= \"kptr_restrict\",\n\t\t.data\t\t= &kptr_restrict,\n\t\t.maxlen\t\t= sizeof(int),\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= proc_dointvec_minmax_sysadmin,\n\t\t.extra1\t\t= SYSCTL_ZERO,\n\t\t.extra2\t\t= SYSCTL_TWO,\n\t},\n\t{}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include <linux/ratelimit.h>\n#include <linux/capability.h>\n#include <linux/printk.h>\n#include <linux/sysctl.h>\n\nstatic struct ctl_table printk_sysctls[] = {\n\t{\n\t\t.procname\t= \"printk\",\n\t\t.data\t\t= &console_loglevel,\n\t\t.maxlen\t\t= 4*sizeof(int),\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= proc_dointvec,\n\t},\n\t{\n\t\t.procname\t= \"printk_ratelimit\",\n\t\t.data\t\t= &printk_ratelimit_state.interval,\n\t\t.maxlen\t\t= sizeof(int),\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= proc_dointvec_jiffies,\n\t},\n\t{\n\t\t.procname\t= \"printk_ratelimit_burst\",\n\t\t.data\t\t= &printk_ratelimit_state.burst,\n\t\t.maxlen\t\t= sizeof(int),\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= proc_dointvec,\n\t},\n\t{\n\t\t.procname\t= \"printk_delay\",\n\t\t.data\t\t= &printk_delay_msec,\n\t\t.maxlen\t\t= sizeof(int),\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= proc_dointvec_minmax,\n\t\t.extra1\t\t= SYSCTL_ZERO,\n\t\t.extra2\t\t= (void *)&ten_thousand,\n\t},\n\t{\n\t\t.procname\t= \"printk_devkmsg\",\n\t\t.data\t\t= devkmsg_log_str,\n\t\t.maxlen\t\t= DEVKMSG_STR_MAX_SIZE,\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= devkmsg_sysctl_set_loglvl,\n\t},\n\t{\n\t\t.procname\t= \"dmesg_restrict\",\n\t\t.data\t\t= &dmesg_restrict,\n\t\t.maxlen\t\t= sizeof(int),\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= proc_dointvec_minmax_sysadmin,\n\t\t.extra1\t\t= SYSCTL_ZERO,\n\t\t.extra2\t\t= SYSCTL_ONE,\n\t},\n\t{\n\t\t.procname\t= \"kptr_restrict\",\n\t\t.data\t\t= &kptr_restrict,\n\t\t.maxlen\t\t= sizeof(int),\n\t\t.mode\t\t= 0644,\n\t\t.proc_handler\t= proc_dointvec_minmax_sysadmin,\n\t\t.extra1\t\t= SYSCTL_ZERO,\n\t\t.extra2\t\t= SYSCTL_TWO,\n\t},\n\t{}\n};\n\nvoid __init printk_sysctl_init(void)\n{\n\tregister_sysctl_init(\"kernel\", printk_sysctls);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "ret < 0"
          ],
          "line": 3214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpuhp_setup_state_nocalls",
          "args": [
            "CPUHP_AP_ONLINE_DYN",
            "\"printk:online\"",
            "console_cpu_notify",
            "NULL"
          ],
          "line": 3212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN_ON",
          "args": [
            "ret < 0"
          ],
          "line": 3211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpuhp_setup_state_nocalls",
          "args": [
            "CPUHP_PRINTK_DEAD",
            "\"printk:dead\"",
            "NULL",
            "console_cpu_notify"
          ],
          "line": 3209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unregister_console",
          "args": [
            "con"
          ],
          "line": 3206
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_console",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "3080-3137",
          "snippet": "int unregister_console(struct console *console)\n{\n\tstruct console *con;\n\tint res;\n\n\tpr_info(\"%sconsole [%s%d] disabled\\n\",\n\t\t(console->flags & CON_BOOT) ? \"boot\" : \"\" ,\n\t\tconsole->name, console->index);\n\n\tres = _braille_unregister_console(console);\n\tif (res < 0)\n\t\treturn res;\n\tif (res > 0)\n\t\treturn 0;\n\n\tres = -ENODEV;\n\tconsole_lock();\n\tif (console_drivers == console) {\n\t\tconsole_drivers=console->next;\n\t\tres = 0;\n\t} else {\n\t\tfor_each_console(con) {\n\t\t\tif (con->next == console) {\n\t\t\t\tcon->next = console->next;\n\t\t\t\tres = 0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (res)\n\t\tgoto out_disable_unlock;\n\n\tif (console->flags & CON_EXTENDED)\n\t\tnr_ext_console_drivers--;\n\n\t/*\n\t * If this isn't the last console and it has CON_CONSDEV set, we\n\t * need to set it on the next preferred console.\n\t */\n\tif (console_drivers != NULL && console->flags & CON_CONSDEV)\n\t\tconsole_drivers->flags |= CON_CONSDEV;\n\n\tconsole->flags &= ~CON_ENABLED;\n\tconsole_unlock();\n\tconsole_sysfs_notify();\n\n\tif (console->exit)\n\t\tres = console->exit(console);\n\n\treturn res;\n\nout_disable_unlock:\n\tconsole->flags &= ~CON_ENABLED;\n\tconsole_unlock();\n\n\treturn res;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct console *console_drivers;",
            "static int nr_ext_console_drivers;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstruct console *console_drivers;\nstatic int nr_ext_console_drivers;\n\nint unregister_console(struct console *console)\n{\n\tstruct console *con;\n\tint res;\n\n\tpr_info(\"%sconsole [%s%d] disabled\\n\",\n\t\t(console->flags & CON_BOOT) ? \"boot\" : \"\" ,\n\t\tconsole->name, console->index);\n\n\tres = _braille_unregister_console(console);\n\tif (res < 0)\n\t\treturn res;\n\tif (res > 0)\n\t\treturn 0;\n\n\tres = -ENODEV;\n\tconsole_lock();\n\tif (console_drivers == console) {\n\t\tconsole_drivers=console->next;\n\t\tres = 0;\n\t} else {\n\t\tfor_each_console(con) {\n\t\t\tif (con->next == console) {\n\t\t\t\tcon->next = console->next;\n\t\t\t\tres = 0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (res)\n\t\tgoto out_disable_unlock;\n\n\tif (console->flags & CON_EXTENDED)\n\t\tnr_ext_console_drivers--;\n\n\t/*\n\t * If this isn't the last console and it has CON_CONSDEV set, we\n\t * need to set it on the next preferred console.\n\t */\n\tif (console_drivers != NULL && console->flags & CON_CONSDEV)\n\t\tconsole_drivers->flags |= CON_CONSDEV;\n\n\tconsole->flags &= ~CON_ENABLED;\n\tconsole_unlock();\n\tconsole_sysfs_notify();\n\n\tif (console->exit)\n\t\tres = console->exit(console);\n\n\treturn res;\n\nout_disable_unlock:\n\tconsole->flags &= ~CON_ENABLED;\n\tconsole_unlock();\n\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_warn",
          "args": [
            "\"bootconsole [%s%d] uses init memory and must be disabled even before the real one is ready\\n\"",
            "con->name",
            "con->index"
          ],
          "line": 3204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_section_contains",
          "args": [
            "con->data",
            "0"
          ],
          "line": 3199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_section_contains",
          "args": [
            "con->unblank",
            "0"
          ],
          "line": 3198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_section_contains",
          "args": [
            "con->device",
            "0"
          ],
          "line": 3197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_section_contains",
          "args": [
            "con->read",
            "0"
          ],
          "line": 3196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_section_contains",
          "args": [
            "con->write",
            "0"
          ],
          "line": 3195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init_section_intersects",
          "args": [
            "con",
            "sizeof(*con)"
          ],
          "line": 3194
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic int __init printk_late_init(void)\n{\n\tstruct console *con;\n\tint ret;\n\n\tfor_each_console(con) {\n\t\tif (!(con->flags & CON_BOOT))\n\t\t\tcontinue;\n\n\t\t/* Check addresses that might be used for enabled consoles. */\n\t\tif (init_section_intersects(con, sizeof(*con)) ||\n\t\t    init_section_contains(con->write, 0) ||\n\t\t    init_section_contains(con->read, 0) ||\n\t\t    init_section_contains(con->device, 0) ||\n\t\t    init_section_contains(con->unblank, 0) ||\n\t\t    init_section_contains(con->data, 0)) {\n\t\t\t/*\n\t\t\t * Please, consider moving the reported consoles out\n\t\t\t * of the init section.\n\t\t\t */\n\t\t\tpr_warn(\"bootconsole [%s%d] uses init memory and must be disabled even before the real one is ready\\n\",\n\t\t\t\tcon->name, con->index);\n\t\t\tunregister_console(con);\n\t\t}\n\t}\n\tret = cpuhp_setup_state_nocalls(CPUHP_PRINTK_DEAD, \"printk:dead\", NULL,\n\t\t\t\t\tconsole_cpu_notify);\n\tWARN_ON(ret < 0);\n\tret = cpuhp_setup_state_nocalls(CPUHP_AP_ONLINE_DYN, \"printk:online\",\n\t\t\t\t\tconsole_cpu_notify, NULL);\n\tWARN_ON(ret < 0);\n\tprintk_sysctl_init();\n\treturn 0;\n}"
  },
  {
    "function_name": "console_init",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "3146-3168",
    "snippet": "void __init console_init(void)\n{\n\tint ret;\n\tinitcall_t call;\n\tinitcall_entry_t *ce;\n\n\t/* Setup the default TTY line discipline. */\n\tn_tty_init();\n\n\t/*\n\t * set up the console device so that later boot sequences can\n\t * inform about problems etc..\n\t */\n\tce = __con_initcall_start;\n\ttrace_initcall_level(\"console\");\n\twhile (ce < __con_initcall_end) {\n\t\tcall = initcall_from_entry(ce);\n\t\ttrace_initcall_start(call);\n\t\tret = call();\n\t\ttrace_initcall_finish(call, ret);\n\t\tce++;\n\t}\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "trace_initcall_finish",
          "args": [
            "call",
            "ret"
          ],
          "line": 3165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "call",
          "args": [],
          "line": 3164
        },
        "resolved": true,
        "details": {
          "function_name": "have_callable_console",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2564-2574",
          "snippet": "static int have_callable_console(void)\n{\n\tstruct console *con;\n\n\tfor_each_console(con)\n\t\tif ((con->flags & CON_ENABLED) &&\n\t\t\t\t(con->flags & CON_ANYTIME))\n\t\t\treturn 1;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic int have_callable_console(void)\n{\n\tstruct console *con;\n\n\tfor_each_console(con)\n\t\tif ((con->flags & CON_ENABLED) &&\n\t\t\t\t(con->flags & CON_ANYTIME))\n\t\t\treturn 1;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "trace_initcall_start",
          "args": [
            "call"
          ],
          "line": 3163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "initcall_from_entry",
          "args": [
            "ce"
          ],
          "line": 3162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trace_initcall_level",
          "args": [
            "\"console\""
          ],
          "line": 3160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "n_tty_init",
          "args": [],
          "line": 3153
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nvoid __init console_init(void)\n{\n\tint ret;\n\tinitcall_t call;\n\tinitcall_entry_t *ce;\n\n\t/* Setup the default TTY line discipline. */\n\tn_tty_init();\n\n\t/*\n\t * set up the console device so that later boot sequences can\n\t * inform about problems etc..\n\t */\n\tce = __con_initcall_start;\n\ttrace_initcall_level(\"console\");\n\twhile (ce < __con_initcall_end) {\n\t\tcall = initcall_from_entry(ce);\n\t\ttrace_initcall_start(call);\n\t\tret = call();\n\t\ttrace_initcall_finish(call, ret);\n\t\tce++;\n\t}\n}"
  },
  {
    "function_name": "unregister_console",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "3080-3137",
    "snippet": "int unregister_console(struct console *console)\n{\n\tstruct console *con;\n\tint res;\n\n\tpr_info(\"%sconsole [%s%d] disabled\\n\",\n\t\t(console->flags & CON_BOOT) ? \"boot\" : \"\" ,\n\t\tconsole->name, console->index);\n\n\tres = _braille_unregister_console(console);\n\tif (res < 0)\n\t\treturn res;\n\tif (res > 0)\n\t\treturn 0;\n\n\tres = -ENODEV;\n\tconsole_lock();\n\tif (console_drivers == console) {\n\t\tconsole_drivers=console->next;\n\t\tres = 0;\n\t} else {\n\t\tfor_each_console(con) {\n\t\t\tif (con->next == console) {\n\t\t\t\tcon->next = console->next;\n\t\t\t\tres = 0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (res)\n\t\tgoto out_disable_unlock;\n\n\tif (console->flags & CON_EXTENDED)\n\t\tnr_ext_console_drivers--;\n\n\t/*\n\t * If this isn't the last console and it has CON_CONSDEV set, we\n\t * need to set it on the next preferred console.\n\t */\n\tif (console_drivers != NULL && console->flags & CON_CONSDEV)\n\t\tconsole_drivers->flags |= CON_CONSDEV;\n\n\tconsole->flags &= ~CON_ENABLED;\n\tconsole_unlock();\n\tconsole_sysfs_notify();\n\n\tif (console->exit)\n\t\tres = console->exit(console);\n\n\treturn res;\n\nout_disable_unlock:\n\tconsole->flags &= ~CON_ENABLED;\n\tconsole_unlock();\n\n\treturn res;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct console *console_drivers;",
      "static int nr_ext_console_drivers;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "console_unlock",
          "args": [],
          "line": 3134
        },
        "resolved": true,
        "details": {
          "function_name": "console_unlock",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2602-2738",
          "snippet": "void console_unlock(void)\n{\n\tstatic char ext_text[CONSOLE_EXT_LOG_MAX];\n\tstatic char text[CONSOLE_LOG_MAX];\n\tunsigned long flags;\n\tbool do_cond_resched, retry;\n\tstruct printk_info info;\n\tstruct printk_record r;\n\tu64 __maybe_unused next_seq;\n\n\tif (console_suspended) {\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tprb_rec_init_rd(&r, &info, text, sizeof(text));\n\n\t/*\n\t * Console drivers are called with interrupts disabled, so\n\t * @console_may_schedule should be cleared before; however, we may\n\t * end up dumping a lot of lines, for example, if called from\n\t * console registration path, and should invoke cond_resched()\n\t * between lines if allowable.  Not doing so can cause a very long\n\t * scheduling stall on a slow console leading to RCU stall and\n\t * softlockup warnings which exacerbate the issue with more\n\t * messages practically incapacitating the system.\n\t *\n\t * console_trylock() is not able to detect the preemptive\n\t * context reliably. Therefore the value must be stored before\n\t * and cleared after the \"again\" goto label.\n\t */\n\tdo_cond_resched = console_may_schedule;\nagain:\n\tconsole_may_schedule = 0;\n\n\t/*\n\t * We released the console_sem lock, so we need to recheck if\n\t * cpu is online and (if not) is there at least one CON_ANYTIME\n\t * console.\n\t */\n\tif (!can_use_console()) {\n\t\tconsole_locked = 0;\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tfor (;;) {\n\t\tsize_t ext_len = 0;\n\t\tint handover;\n\t\tsize_t len;\n\nskip:\n\t\tif (!prb_read_valid(prb, console_seq, &r))\n\t\t\tbreak;\n\n\t\tif (console_seq != r.info->seq) {\n\t\t\tconsole_dropped += r.info->seq - console_seq;\n\t\t\tconsole_seq = r.info->seq;\n\t\t}\n\n\t\tif (suppress_message_printing(r.info->level)) {\n\t\t\t/*\n\t\t\t * Skip record we have buffered and already printed\n\t\t\t * directly to the console when we received it, and\n\t\t\t * record that has level above the console loglevel.\n\t\t\t */\n\t\t\tconsole_seq++;\n\t\t\tgoto skip;\n\t\t}\n\n\t\t/* Output to all consoles once old messages replayed. */\n\t\tif (unlikely(exclusive_console &&\n\t\t\t     console_seq >= exclusive_console_stop_seq)) {\n\t\t\texclusive_console = NULL;\n\t\t}\n\n\t\t/*\n\t\t * Handle extended console text first because later\n\t\t * record_print_text() will modify the record buffer in-place.\n\t\t */\n\t\tif (nr_ext_console_drivers) {\n\t\t\text_len = info_print_ext_header(ext_text,\n\t\t\t\t\t\tsizeof(ext_text),\n\t\t\t\t\t\tr.info);\n\t\t\text_len += msg_print_ext_body(ext_text + ext_len,\n\t\t\t\t\t\tsizeof(ext_text) - ext_len,\n\t\t\t\t\t\t&r.text_buf[0],\n\t\t\t\t\t\tr.info->text_len,\n\t\t\t\t\t\t&r.info->dev_info);\n\t\t}\n\t\tlen = record_print_text(&r,\n\t\t\t\tconsole_msg_format & MSG_FORMAT_SYSLOG,\n\t\t\t\tprintk_time);\n\t\tconsole_seq++;\n\n\t\t/*\n\t\t * While actively printing out messages, if another printk()\n\t\t * were to occur on another CPU, it may wait for this one to\n\t\t * finish. This task can not be preempted if there is a\n\t\t * waiter waiting to take over.\n\t\t *\n\t\t * Interrupts are disabled because the hand over to a waiter\n\t\t * must not be interrupted until the hand over is completed\n\t\t * (@console_waiter is cleared).\n\t\t */\n\t\tprintk_safe_enter_irqsave(flags);\n\t\tconsole_lock_spinning_enable();\n\n\t\tstop_critical_timings();\t/* don't trace print latency */\n\t\tcall_console_drivers(ext_text, ext_len, text, len);\n\t\tstart_critical_timings();\n\n\t\thandover = console_lock_spinning_disable_and_check();\n\t\tprintk_safe_exit_irqrestore(flags);\n\t\tif (handover)\n\t\t\treturn;\n\n\t\tif (do_cond_resched)\n\t\t\tcond_resched();\n\t}\n\n\t/* Get consistent value of the next-to-be-used sequence number. */\n\tnext_seq = console_seq;\n\n\tconsole_locked = 0;\n\tup_console_sem();\n\n\t/*\n\t * Someone could have filled up the buffer again, so re-check if there's\n\t * something to flush. In case we cannot trylock the console_sem again,\n\t * there's a new owner and the console_unlock() from them will do the\n\t * flush, no worries.\n\t */\n\tretry = prb_read_valid(prb, next_seq, NULL);\n\tif (retry && console_trylock())\n\t\tgoto again;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define printk_time\t\tfalse",
            "#define CONSOLE_LOG_MAX\t\t0",
            "#define CONSOLE_LOG_MAX\t\t1024"
          ],
          "globals_used": [
            "static DEFINE_SEMAPHORE(console_sem);",
            "static int nr_ext_console_drivers;",
            "static int console_locked, console_suspended;",
            "static struct console *exclusive_console;",
            "static int console_may_schedule;",
            "static int console_msg_format = MSG_FORMAT_DEFAULT;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define printk_time\t\tfalse\n#define CONSOLE_LOG_MAX\t\t0\n#define CONSOLE_LOG_MAX\t\t1024\n\nstatic DEFINE_SEMAPHORE(console_sem);\nstatic int nr_ext_console_drivers;\nstatic int console_locked, console_suspended;\nstatic struct console *exclusive_console;\nstatic int console_may_schedule;\nstatic int console_msg_format = MSG_FORMAT_DEFAULT;\n\nvoid console_unlock(void)\n{\n\tstatic char ext_text[CONSOLE_EXT_LOG_MAX];\n\tstatic char text[CONSOLE_LOG_MAX];\n\tunsigned long flags;\n\tbool do_cond_resched, retry;\n\tstruct printk_info info;\n\tstruct printk_record r;\n\tu64 __maybe_unused next_seq;\n\n\tif (console_suspended) {\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tprb_rec_init_rd(&r, &info, text, sizeof(text));\n\n\t/*\n\t * Console drivers are called with interrupts disabled, so\n\t * @console_may_schedule should be cleared before; however, we may\n\t * end up dumping a lot of lines, for example, if called from\n\t * console registration path, and should invoke cond_resched()\n\t * between lines if allowable.  Not doing so can cause a very long\n\t * scheduling stall on a slow console leading to RCU stall and\n\t * softlockup warnings which exacerbate the issue with more\n\t * messages practically incapacitating the system.\n\t *\n\t * console_trylock() is not able to detect the preemptive\n\t * context reliably. Therefore the value must be stored before\n\t * and cleared after the \"again\" goto label.\n\t */\n\tdo_cond_resched = console_may_schedule;\nagain:\n\tconsole_may_schedule = 0;\n\n\t/*\n\t * We released the console_sem lock, so we need to recheck if\n\t * cpu is online and (if not) is there at least one CON_ANYTIME\n\t * console.\n\t */\n\tif (!can_use_console()) {\n\t\tconsole_locked = 0;\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tfor (;;) {\n\t\tsize_t ext_len = 0;\n\t\tint handover;\n\t\tsize_t len;\n\nskip:\n\t\tif (!prb_read_valid(prb, console_seq, &r))\n\t\t\tbreak;\n\n\t\tif (console_seq != r.info->seq) {\n\t\t\tconsole_dropped += r.info->seq - console_seq;\n\t\t\tconsole_seq = r.info->seq;\n\t\t}\n\n\t\tif (suppress_message_printing(r.info->level)) {\n\t\t\t/*\n\t\t\t * Skip record we have buffered and already printed\n\t\t\t * directly to the console when we received it, and\n\t\t\t * record that has level above the console loglevel.\n\t\t\t */\n\t\t\tconsole_seq++;\n\t\t\tgoto skip;\n\t\t}\n\n\t\t/* Output to all consoles once old messages replayed. */\n\t\tif (unlikely(exclusive_console &&\n\t\t\t     console_seq >= exclusive_console_stop_seq)) {\n\t\t\texclusive_console = NULL;\n\t\t}\n\n\t\t/*\n\t\t * Handle extended console text first because later\n\t\t * record_print_text() will modify the record buffer in-place.\n\t\t */\n\t\tif (nr_ext_console_drivers) {\n\t\t\text_len = info_print_ext_header(ext_text,\n\t\t\t\t\t\tsizeof(ext_text),\n\t\t\t\t\t\tr.info);\n\t\t\text_len += msg_print_ext_body(ext_text + ext_len,\n\t\t\t\t\t\tsizeof(ext_text) - ext_len,\n\t\t\t\t\t\t&r.text_buf[0],\n\t\t\t\t\t\tr.info->text_len,\n\t\t\t\t\t\t&r.info->dev_info);\n\t\t}\n\t\tlen = record_print_text(&r,\n\t\t\t\tconsole_msg_format & MSG_FORMAT_SYSLOG,\n\t\t\t\tprintk_time);\n\t\tconsole_seq++;\n\n\t\t/*\n\t\t * While actively printing out messages, if another printk()\n\t\t * were to occur on another CPU, it may wait for this one to\n\t\t * finish. This task can not be preempted if there is a\n\t\t * waiter waiting to take over.\n\t\t *\n\t\t * Interrupts are disabled because the hand over to a waiter\n\t\t * must not be interrupted until the hand over is completed\n\t\t * (@console_waiter is cleared).\n\t\t */\n\t\tprintk_safe_enter_irqsave(flags);\n\t\tconsole_lock_spinning_enable();\n\n\t\tstop_critical_timings();\t/* don't trace print latency */\n\t\tcall_console_drivers(ext_text, ext_len, text, len);\n\t\tstart_critical_timings();\n\n\t\thandover = console_lock_spinning_disable_and_check();\n\t\tprintk_safe_exit_irqrestore(flags);\n\t\tif (handover)\n\t\t\treturn;\n\n\t\tif (do_cond_resched)\n\t\t\tcond_resched();\n\t}\n\n\t/* Get consistent value of the next-to-be-used sequence number. */\n\tnext_seq = console_seq;\n\n\tconsole_locked = 0;\n\tup_console_sem();\n\n\t/*\n\t * Someone could have filled up the buffer again, so re-check if there's\n\t * something to flush. In case we cannot trylock the console_sem again,\n\t * there's a new owner and the console_unlock() from them will do the\n\t * flush, no worries.\n\t */\n\tretry = prb_read_valid(prb, next_seq, NULL);\n\tif (retry && console_trylock())\n\t\tgoto again;\n}"
        }
      },
      {
        "call_info": {
          "callee": "console->exit",
          "args": [
            "console"
          ],
          "line": 3128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "console_sysfs_notify",
          "args": [],
          "line": 3125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "console_lock",
          "args": [],
          "line": 3096
        },
        "resolved": true,
        "details": {
          "function_name": "is_console_locked",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2554-2557",
          "snippet": "int is_console_locked(void)\n{\n\treturn console_locked;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nint is_console_locked(void)\n{\n\treturn console_locked;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_braille_unregister_console",
          "args": [
            "console"
          ],
          "line": 3089
        },
        "resolved": true,
        "details": {
          "function_name": "_braille_unregister_console",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/braille.h",
          "lines": "48-52",
          "snippet": "static inline int\n_braille_unregister_console(struct console *console)\n{\n\treturn 0;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline int\n_braille_unregister_console(struct console *console)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"%sconsole [%s%d] disabled\\n\"",
            "(console->flags & CON_BOOT) ? \"boot\" : \"\"",
            "console->name",
            "console->index"
          ],
          "line": 3085
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstruct console *console_drivers;\nstatic int nr_ext_console_drivers;\n\nint unregister_console(struct console *console)\n{\n\tstruct console *con;\n\tint res;\n\n\tpr_info(\"%sconsole [%s%d] disabled\\n\",\n\t\t(console->flags & CON_BOOT) ? \"boot\" : \"\" ,\n\t\tconsole->name, console->index);\n\n\tres = _braille_unregister_console(console);\n\tif (res < 0)\n\t\treturn res;\n\tif (res > 0)\n\t\treturn 0;\n\n\tres = -ENODEV;\n\tconsole_lock();\n\tif (console_drivers == console) {\n\t\tconsole_drivers=console->next;\n\t\tres = 0;\n\t} else {\n\t\tfor_each_console(con) {\n\t\t\tif (con->next == console) {\n\t\t\t\tcon->next = console->next;\n\t\t\t\tres = 0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (res)\n\t\tgoto out_disable_unlock;\n\n\tif (console->flags & CON_EXTENDED)\n\t\tnr_ext_console_drivers--;\n\n\t/*\n\t * If this isn't the last console and it has CON_CONSDEV set, we\n\t * need to set it on the next preferred console.\n\t */\n\tif (console_drivers != NULL && console->flags & CON_CONSDEV)\n\t\tconsole_drivers->flags |= CON_CONSDEV;\n\n\tconsole->flags &= ~CON_ENABLED;\n\tconsole_unlock();\n\tconsole_sysfs_notify();\n\n\tif (console->exit)\n\t\tres = console->exit(console);\n\n\treturn res;\n\nout_disable_unlock:\n\tconsole->flags &= ~CON_ENABLED;\n\tconsole_unlock();\n\n\treturn res;\n}"
  },
  {
    "function_name": "register_console",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2945-3077",
    "snippet": "void register_console(struct console *newcon)\n{\n\tstruct console *con;\n\tbool bootcon_enabled = false;\n\tbool realcon_enabled = false;\n\tint err;\n\n\tfor_each_console(con) {\n\t\tif (WARN(con == newcon, \"console '%s%d' already registered\\n\",\n\t\t\t\t\t con->name, con->index))\n\t\t\treturn;\n\t}\n\n\tfor_each_console(con) {\n\t\tif (con->flags & CON_BOOT)\n\t\t\tbootcon_enabled = true;\n\t\telse\n\t\t\trealcon_enabled = true;\n\t}\n\n\t/* Do not register boot consoles when there already is a real one. */\n\tif (newcon->flags & CON_BOOT && realcon_enabled) {\n\t\tpr_info(\"Too late to register bootconsole %s%d\\n\",\n\t\t\tnewcon->name, newcon->index);\n\t\treturn;\n\t}\n\n\t/*\n\t * See if we want to enable this console driver by default.\n\t *\n\t * Nope when a console is preferred by the command line, device\n\t * tree, or SPCR.\n\t *\n\t * The first real console with tty binding (driver) wins. More\n\t * consoles might get enabled before the right one is found.\n\t *\n\t * Note that a console with tty binding will have CON_CONSDEV\n\t * flag set and will be first in the list.\n\t */\n\tif (preferred_console < 0) {\n\t\tif (!console_drivers || !console_drivers->device ||\n\t\t    console_drivers->flags & CON_BOOT) {\n\t\t\ttry_enable_default_console(newcon);\n\t\t}\n\t}\n\n\t/* See if this console matches one we selected on the command line */\n\terr = try_enable_preferred_console(newcon, true);\n\n\t/* If not, try to match against the platform default(s) */\n\tif (err == -ENOENT)\n\t\terr = try_enable_preferred_console(newcon, false);\n\n\t/* printk() messages are not printed to the Braille console. */\n\tif (err || newcon->flags & CON_BRL)\n\t\treturn;\n\n\t/*\n\t * If we have a bootconsole, and are switching to a real console,\n\t * don't print everything out again, since when the boot console, and\n\t * the real console are the same physical device, it's annoying to\n\t * see the beginning boot messages twice\n\t */\n\tif (bootcon_enabled &&\n\t    ((newcon->flags & (CON_CONSDEV | CON_BOOT)) == CON_CONSDEV)) {\n\t\tnewcon->flags &= ~CON_PRINTBUFFER;\n\t}\n\n\t/*\n\t *\tPut this console in the list - keep the\n\t *\tpreferred driver at the head of the list.\n\t */\n\tconsole_lock();\n\tif ((newcon->flags & CON_CONSDEV) || console_drivers == NULL) {\n\t\tnewcon->next = console_drivers;\n\t\tconsole_drivers = newcon;\n\t\tif (newcon->next)\n\t\t\tnewcon->next->flags &= ~CON_CONSDEV;\n\t\t/* Ensure this flag is always set for the head of the list */\n\t\tnewcon->flags |= CON_CONSDEV;\n\t} else {\n\t\tnewcon->next = console_drivers->next;\n\t\tconsole_drivers->next = newcon;\n\t}\n\n\tif (newcon->flags & CON_EXTENDED)\n\t\tnr_ext_console_drivers++;\n\n\tif (newcon->flags & CON_PRINTBUFFER) {\n\t\t/*\n\t\t * console_unlock(); will print out the buffered messages\n\t\t * for us.\n\t\t *\n\t\t * We're about to replay the log buffer.  Only do this to the\n\t\t * just-registered console to avoid excessive message spam to\n\t\t * the already-registered consoles.\n\t\t *\n\t\t * Set exclusive_console with disabled interrupts to reduce\n\t\t * race window with eventual console_flush_on_panic() that\n\t\t * ignores console_lock.\n\t\t */\n\t\texclusive_console = newcon;\n\t\texclusive_console_stop_seq = console_seq;\n\n\t\t/* Get a consistent copy of @syslog_seq. */\n\t\tmutex_lock(&syslog_lock);\n\t\tconsole_seq = syslog_seq;\n\t\tmutex_unlock(&syslog_lock);\n\t}\n\tconsole_unlock();\n\tconsole_sysfs_notify();\n\n\t/*\n\t * By unregistering the bootconsoles after we enable the real console\n\t * we get the \"console xxx enabled\" message on all the consoles -\n\t * boot consoles, real consoles, etc - this is to ensure that end\n\t * users know there might be something in the kernel's log buffer that\n\t * went to the bootconsole (that they do not see on the real console)\n\t */\n\tpr_info(\"%sconsole [%s%d] enabled\\n\",\n\t\t(newcon->flags & CON_BOOT) ? \"boot\" : \"\" ,\n\t\tnewcon->name, newcon->index);\n\tif (bootcon_enabled &&\n\t    ((newcon->flags & (CON_CONSDEV | CON_BOOT)) == CON_CONSDEV) &&\n\t    !keep_bootcon) {\n\t\t/* We need to iterate through all boot consoles, to make\n\t\t * sure we print everything out, before we unregister them.\n\t\t */\n\t\tfor_each_console(con)\n\t\t\tif (con->flags & CON_BOOT)\n\t\t\t\tunregister_console(con);\n\t}\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct console *console_drivers;",
      "static int nr_ext_console_drivers;",
      "static struct console *exclusive_console;",
      "static int preferred_console = -1;",
      "static DEFINE_MUTEX(syslog_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "unregister_console",
          "args": [
            "con"
          ],
          "line": 3075
        },
        "resolved": true,
        "details": {
          "function_name": "unregister_console",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "3080-3137",
          "snippet": "int unregister_console(struct console *console)\n{\n\tstruct console *con;\n\tint res;\n\n\tpr_info(\"%sconsole [%s%d] disabled\\n\",\n\t\t(console->flags & CON_BOOT) ? \"boot\" : \"\" ,\n\t\tconsole->name, console->index);\n\n\tres = _braille_unregister_console(console);\n\tif (res < 0)\n\t\treturn res;\n\tif (res > 0)\n\t\treturn 0;\n\n\tres = -ENODEV;\n\tconsole_lock();\n\tif (console_drivers == console) {\n\t\tconsole_drivers=console->next;\n\t\tres = 0;\n\t} else {\n\t\tfor_each_console(con) {\n\t\t\tif (con->next == console) {\n\t\t\t\tcon->next = console->next;\n\t\t\t\tres = 0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (res)\n\t\tgoto out_disable_unlock;\n\n\tif (console->flags & CON_EXTENDED)\n\t\tnr_ext_console_drivers--;\n\n\t/*\n\t * If this isn't the last console and it has CON_CONSDEV set, we\n\t * need to set it on the next preferred console.\n\t */\n\tif (console_drivers != NULL && console->flags & CON_CONSDEV)\n\t\tconsole_drivers->flags |= CON_CONSDEV;\n\n\tconsole->flags &= ~CON_ENABLED;\n\tconsole_unlock();\n\tconsole_sysfs_notify();\n\n\tif (console->exit)\n\t\tres = console->exit(console);\n\n\treturn res;\n\nout_disable_unlock:\n\tconsole->flags &= ~CON_ENABLED;\n\tconsole_unlock();\n\n\treturn res;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct console *console_drivers;",
            "static int nr_ext_console_drivers;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstruct console *console_drivers;\nstatic int nr_ext_console_drivers;\n\nint unregister_console(struct console *console)\n{\n\tstruct console *con;\n\tint res;\n\n\tpr_info(\"%sconsole [%s%d] disabled\\n\",\n\t\t(console->flags & CON_BOOT) ? \"boot\" : \"\" ,\n\t\tconsole->name, console->index);\n\n\tres = _braille_unregister_console(console);\n\tif (res < 0)\n\t\treturn res;\n\tif (res > 0)\n\t\treturn 0;\n\n\tres = -ENODEV;\n\tconsole_lock();\n\tif (console_drivers == console) {\n\t\tconsole_drivers=console->next;\n\t\tres = 0;\n\t} else {\n\t\tfor_each_console(con) {\n\t\t\tif (con->next == console) {\n\t\t\t\tcon->next = console->next;\n\t\t\t\tres = 0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (res)\n\t\tgoto out_disable_unlock;\n\n\tif (console->flags & CON_EXTENDED)\n\t\tnr_ext_console_drivers--;\n\n\t/*\n\t * If this isn't the last console and it has CON_CONSDEV set, we\n\t * need to set it on the next preferred console.\n\t */\n\tif (console_drivers != NULL && console->flags & CON_CONSDEV)\n\t\tconsole_drivers->flags |= CON_CONSDEV;\n\n\tconsole->flags &= ~CON_ENABLED;\n\tconsole_unlock();\n\tconsole_sysfs_notify();\n\n\tif (console->exit)\n\t\tres = console->exit(console);\n\n\treturn res;\n\nout_disable_unlock:\n\tconsole->flags &= ~CON_ENABLED;\n\tconsole_unlock();\n\n\treturn res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"%sconsole [%s%d] enabled\\n\"",
            "(newcon->flags & CON_BOOT) ? \"boot\" : \"\"",
            "newcon->name",
            "newcon->index"
          ],
          "line": 3064
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "console_sysfs_notify",
          "args": [],
          "line": 3055
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "console_unlock",
          "args": [],
          "line": 3054
        },
        "resolved": true,
        "details": {
          "function_name": "console_unlock",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2602-2738",
          "snippet": "void console_unlock(void)\n{\n\tstatic char ext_text[CONSOLE_EXT_LOG_MAX];\n\tstatic char text[CONSOLE_LOG_MAX];\n\tunsigned long flags;\n\tbool do_cond_resched, retry;\n\tstruct printk_info info;\n\tstruct printk_record r;\n\tu64 __maybe_unused next_seq;\n\n\tif (console_suspended) {\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tprb_rec_init_rd(&r, &info, text, sizeof(text));\n\n\t/*\n\t * Console drivers are called with interrupts disabled, so\n\t * @console_may_schedule should be cleared before; however, we may\n\t * end up dumping a lot of lines, for example, if called from\n\t * console registration path, and should invoke cond_resched()\n\t * between lines if allowable.  Not doing so can cause a very long\n\t * scheduling stall on a slow console leading to RCU stall and\n\t * softlockup warnings which exacerbate the issue with more\n\t * messages practically incapacitating the system.\n\t *\n\t * console_trylock() is not able to detect the preemptive\n\t * context reliably. Therefore the value must be stored before\n\t * and cleared after the \"again\" goto label.\n\t */\n\tdo_cond_resched = console_may_schedule;\nagain:\n\tconsole_may_schedule = 0;\n\n\t/*\n\t * We released the console_sem lock, so we need to recheck if\n\t * cpu is online and (if not) is there at least one CON_ANYTIME\n\t * console.\n\t */\n\tif (!can_use_console()) {\n\t\tconsole_locked = 0;\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tfor (;;) {\n\t\tsize_t ext_len = 0;\n\t\tint handover;\n\t\tsize_t len;\n\nskip:\n\t\tif (!prb_read_valid(prb, console_seq, &r))\n\t\t\tbreak;\n\n\t\tif (console_seq != r.info->seq) {\n\t\t\tconsole_dropped += r.info->seq - console_seq;\n\t\t\tconsole_seq = r.info->seq;\n\t\t}\n\n\t\tif (suppress_message_printing(r.info->level)) {\n\t\t\t/*\n\t\t\t * Skip record we have buffered and already printed\n\t\t\t * directly to the console when we received it, and\n\t\t\t * record that has level above the console loglevel.\n\t\t\t */\n\t\t\tconsole_seq++;\n\t\t\tgoto skip;\n\t\t}\n\n\t\t/* Output to all consoles once old messages replayed. */\n\t\tif (unlikely(exclusive_console &&\n\t\t\t     console_seq >= exclusive_console_stop_seq)) {\n\t\t\texclusive_console = NULL;\n\t\t}\n\n\t\t/*\n\t\t * Handle extended console text first because later\n\t\t * record_print_text() will modify the record buffer in-place.\n\t\t */\n\t\tif (nr_ext_console_drivers) {\n\t\t\text_len = info_print_ext_header(ext_text,\n\t\t\t\t\t\tsizeof(ext_text),\n\t\t\t\t\t\tr.info);\n\t\t\text_len += msg_print_ext_body(ext_text + ext_len,\n\t\t\t\t\t\tsizeof(ext_text) - ext_len,\n\t\t\t\t\t\t&r.text_buf[0],\n\t\t\t\t\t\tr.info->text_len,\n\t\t\t\t\t\t&r.info->dev_info);\n\t\t}\n\t\tlen = record_print_text(&r,\n\t\t\t\tconsole_msg_format & MSG_FORMAT_SYSLOG,\n\t\t\t\tprintk_time);\n\t\tconsole_seq++;\n\n\t\t/*\n\t\t * While actively printing out messages, if another printk()\n\t\t * were to occur on another CPU, it may wait for this one to\n\t\t * finish. This task can not be preempted if there is a\n\t\t * waiter waiting to take over.\n\t\t *\n\t\t * Interrupts are disabled because the hand over to a waiter\n\t\t * must not be interrupted until the hand over is completed\n\t\t * (@console_waiter is cleared).\n\t\t */\n\t\tprintk_safe_enter_irqsave(flags);\n\t\tconsole_lock_spinning_enable();\n\n\t\tstop_critical_timings();\t/* don't trace print latency */\n\t\tcall_console_drivers(ext_text, ext_len, text, len);\n\t\tstart_critical_timings();\n\n\t\thandover = console_lock_spinning_disable_and_check();\n\t\tprintk_safe_exit_irqrestore(flags);\n\t\tif (handover)\n\t\t\treturn;\n\n\t\tif (do_cond_resched)\n\t\t\tcond_resched();\n\t}\n\n\t/* Get consistent value of the next-to-be-used sequence number. */\n\tnext_seq = console_seq;\n\n\tconsole_locked = 0;\n\tup_console_sem();\n\n\t/*\n\t * Someone could have filled up the buffer again, so re-check if there's\n\t * something to flush. In case we cannot trylock the console_sem again,\n\t * there's a new owner and the console_unlock() from them will do the\n\t * flush, no worries.\n\t */\n\tretry = prb_read_valid(prb, next_seq, NULL);\n\tif (retry && console_trylock())\n\t\tgoto again;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define printk_time\t\tfalse",
            "#define CONSOLE_LOG_MAX\t\t0",
            "#define CONSOLE_LOG_MAX\t\t1024"
          ],
          "globals_used": [
            "static DEFINE_SEMAPHORE(console_sem);",
            "static int nr_ext_console_drivers;",
            "static int console_locked, console_suspended;",
            "static struct console *exclusive_console;",
            "static int console_may_schedule;",
            "static int console_msg_format = MSG_FORMAT_DEFAULT;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define printk_time\t\tfalse\n#define CONSOLE_LOG_MAX\t\t0\n#define CONSOLE_LOG_MAX\t\t1024\n\nstatic DEFINE_SEMAPHORE(console_sem);\nstatic int nr_ext_console_drivers;\nstatic int console_locked, console_suspended;\nstatic struct console *exclusive_console;\nstatic int console_may_schedule;\nstatic int console_msg_format = MSG_FORMAT_DEFAULT;\n\nvoid console_unlock(void)\n{\n\tstatic char ext_text[CONSOLE_EXT_LOG_MAX];\n\tstatic char text[CONSOLE_LOG_MAX];\n\tunsigned long flags;\n\tbool do_cond_resched, retry;\n\tstruct printk_info info;\n\tstruct printk_record r;\n\tu64 __maybe_unused next_seq;\n\n\tif (console_suspended) {\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tprb_rec_init_rd(&r, &info, text, sizeof(text));\n\n\t/*\n\t * Console drivers are called with interrupts disabled, so\n\t * @console_may_schedule should be cleared before; however, we may\n\t * end up dumping a lot of lines, for example, if called from\n\t * console registration path, and should invoke cond_resched()\n\t * between lines if allowable.  Not doing so can cause a very long\n\t * scheduling stall on a slow console leading to RCU stall and\n\t * softlockup warnings which exacerbate the issue with more\n\t * messages practically incapacitating the system.\n\t *\n\t * console_trylock() is not able to detect the preemptive\n\t * context reliably. Therefore the value must be stored before\n\t * and cleared after the \"again\" goto label.\n\t */\n\tdo_cond_resched = console_may_schedule;\nagain:\n\tconsole_may_schedule = 0;\n\n\t/*\n\t * We released the console_sem lock, so we need to recheck if\n\t * cpu is online and (if not) is there at least one CON_ANYTIME\n\t * console.\n\t */\n\tif (!can_use_console()) {\n\t\tconsole_locked = 0;\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tfor (;;) {\n\t\tsize_t ext_len = 0;\n\t\tint handover;\n\t\tsize_t len;\n\nskip:\n\t\tif (!prb_read_valid(prb, console_seq, &r))\n\t\t\tbreak;\n\n\t\tif (console_seq != r.info->seq) {\n\t\t\tconsole_dropped += r.info->seq - console_seq;\n\t\t\tconsole_seq = r.info->seq;\n\t\t}\n\n\t\tif (suppress_message_printing(r.info->level)) {\n\t\t\t/*\n\t\t\t * Skip record we have buffered and already printed\n\t\t\t * directly to the console when we received it, and\n\t\t\t * record that has level above the console loglevel.\n\t\t\t */\n\t\t\tconsole_seq++;\n\t\t\tgoto skip;\n\t\t}\n\n\t\t/* Output to all consoles once old messages replayed. */\n\t\tif (unlikely(exclusive_console &&\n\t\t\t     console_seq >= exclusive_console_stop_seq)) {\n\t\t\texclusive_console = NULL;\n\t\t}\n\n\t\t/*\n\t\t * Handle extended console text first because later\n\t\t * record_print_text() will modify the record buffer in-place.\n\t\t */\n\t\tif (nr_ext_console_drivers) {\n\t\t\text_len = info_print_ext_header(ext_text,\n\t\t\t\t\t\tsizeof(ext_text),\n\t\t\t\t\t\tr.info);\n\t\t\text_len += msg_print_ext_body(ext_text + ext_len,\n\t\t\t\t\t\tsizeof(ext_text) - ext_len,\n\t\t\t\t\t\t&r.text_buf[0],\n\t\t\t\t\t\tr.info->text_len,\n\t\t\t\t\t\t&r.info->dev_info);\n\t\t}\n\t\tlen = record_print_text(&r,\n\t\t\t\tconsole_msg_format & MSG_FORMAT_SYSLOG,\n\t\t\t\tprintk_time);\n\t\tconsole_seq++;\n\n\t\t/*\n\t\t * While actively printing out messages, if another printk()\n\t\t * were to occur on another CPU, it may wait for this one to\n\t\t * finish. This task can not be preempted if there is a\n\t\t * waiter waiting to take over.\n\t\t *\n\t\t * Interrupts are disabled because the hand over to a waiter\n\t\t * must not be interrupted until the hand over is completed\n\t\t * (@console_waiter is cleared).\n\t\t */\n\t\tprintk_safe_enter_irqsave(flags);\n\t\tconsole_lock_spinning_enable();\n\n\t\tstop_critical_timings();\t/* don't trace print latency */\n\t\tcall_console_drivers(ext_text, ext_len, text, len);\n\t\tstart_critical_timings();\n\n\t\thandover = console_lock_spinning_disable_and_check();\n\t\tprintk_safe_exit_irqrestore(flags);\n\t\tif (handover)\n\t\t\treturn;\n\n\t\tif (do_cond_resched)\n\t\t\tcond_resched();\n\t}\n\n\t/* Get consistent value of the next-to-be-used sequence number. */\n\tnext_seq = console_seq;\n\n\tconsole_locked = 0;\n\tup_console_sem();\n\n\t/*\n\t * Someone could have filled up the buffer again, so re-check if there's\n\t * something to flush. In case we cannot trylock the console_sem again,\n\t * there's a new owner and the console_unlock() from them will do the\n\t * flush, no worries.\n\t */\n\tretry = prb_read_valid(prb, next_seq, NULL);\n\tif (retry && console_trylock())\n\t\tgoto again;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&syslog_lock"
          ],
          "line": 3052
        },
        "resolved": true,
        "details": {
          "function_name": "__rt_mutex_unlock",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/rtmutex.c",
          "lines": "1350-1356",
          "snippet": "static __always_inline void __rt_mutex_unlock(struct rt_mutex_base *lock)\n{\n\tif (likely(rt_mutex_cmpxchg_release(lock, current, NULL)))\n\t\treturn;\n\n\trt_mutex_slowunlock(lock);\n}",
          "includes": [
            "# include \"ww_mutex.h\"",
            "#include \"rtmutex_common.h\"",
            "#include <linux/ww_mutex.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "# include \"ww_mutex.h\"\n#include \"rtmutex_common.h\"\n#include <linux/ww_mutex.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n\nstatic __always_inline struct;\n\nstatic __always_inline void __rt_mutex_unlock(struct rt_mutex_base *lock)\n{\n\tif (likely(rt_mutex_cmpxchg_release(lock, current, NULL)))\n\t\treturn;\n\n\trt_mutex_slowunlock(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&syslog_lock"
          ],
          "line": 3050
        },
        "resolved": true,
        "details": {
          "function_name": "mutex_lock_io",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/rtmutex_api.c",
          "lines": "580-586",
          "snippet": "void __sched mutex_lock_io(struct mutex *lock)\n{\n\tint token = io_schedule_prepare();\n\n\t__mutex_lock_common(lock, TASK_UNINTERRUPTIBLE, 0, NULL, _RET_IP_);\n\tio_schedule_finish(token);\n}",
          "includes": [
            "#include \"rtmutex.c\"",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex.c\"\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nvoid __sched mutex_lock_io(struct mutex *lock)\n{\n\tint token = io_schedule_prepare();\n\n\t__mutex_lock_common(lock, TASK_UNINTERRUPTIBLE, 0, NULL, _RET_IP_);\n\tio_schedule_finish(token);\n}"
        }
      },
      {
        "call_info": {
          "callee": "console_lock",
          "args": [],
          "line": 3017
        },
        "resolved": true,
        "details": {
          "function_name": "is_console_locked",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2554-2557",
          "snippet": "int is_console_locked(void)\n{\n\treturn console_locked;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nint is_console_locked(void)\n{\n\treturn console_locked;\n}"
        }
      },
      {
        "call_info": {
          "callee": "try_enable_preferred_console",
          "args": [
            "newcon",
            "false"
          ],
          "line": 2996
        },
        "resolved": true,
        "details": {
          "function_name": "try_enable_preferred_console",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2864-2909",
          "snippet": "static int try_enable_preferred_console(struct console *newcon,\n\t\t\t\t\tbool user_specified)\n{\n\tstruct console_cmdline *c;\n\tint i, err;\n\n\tfor (i = 0, c = console_cmdline;\n\t     i < MAX_CMDLINECONSOLES && c->name[0];\n\t     i++, c++) {\n\t\tif (c->user_specified != user_specified)\n\t\t\tcontinue;\n\t\tif (!newcon->match ||\n\t\t    newcon->match(newcon, c->name, c->index, c->options) != 0) {\n\t\t\t/* default matching */\n\t\t\tBUILD_BUG_ON(sizeof(c->name) != sizeof(newcon->name));\n\t\t\tif (strcmp(c->name, newcon->name) != 0)\n\t\t\t\tcontinue;\n\t\t\tif (newcon->index >= 0 &&\n\t\t\t    newcon->index != c->index)\n\t\t\t\tcontinue;\n\t\t\tif (newcon->index < 0)\n\t\t\t\tnewcon->index = c->index;\n\n\t\t\tif (_braille_register_console(newcon, c))\n\t\t\t\treturn 0;\n\n\t\t\tif (newcon->setup &&\n\t\t\t    (err = newcon->setup(newcon, c->options)) != 0)\n\t\t\t\treturn err;\n\t\t}\n\t\tnewcon->flags |= CON_ENABLED;\n\t\tif (i == preferred_console)\n\t\t\tnewcon->flags |= CON_CONSDEV;\n\t\treturn 0;\n\t}\n\n\t/*\n\t * Some consoles, such as pstore and netconsole, can be enabled even\n\t * without matching. Accept the pre-enabled consoles only when match()\n\t * and setup() had a chance to be called.\n\t */\n\tif (newcon->flags & CON_ENABLED && c->user_specified ==\tuser_specified)\n\t\treturn 0;\n\n\treturn -ENOENT;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define MAX_CMDLINECONSOLES 8"
          ],
          "globals_used": [
            "static struct console_cmdline console_cmdline[MAX_CMDLINECONSOLES];",
            "static int preferred_console = -1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define MAX_CMDLINECONSOLES 8\n\nstatic struct console_cmdline console_cmdline[MAX_CMDLINECONSOLES];\nstatic int preferred_console = -1;\n\nstatic int try_enable_preferred_console(struct console *newcon,\n\t\t\t\t\tbool user_specified)\n{\n\tstruct console_cmdline *c;\n\tint i, err;\n\n\tfor (i = 0, c = console_cmdline;\n\t     i < MAX_CMDLINECONSOLES && c->name[0];\n\t     i++, c++) {\n\t\tif (c->user_specified != user_specified)\n\t\t\tcontinue;\n\t\tif (!newcon->match ||\n\t\t    newcon->match(newcon, c->name, c->index, c->options) != 0) {\n\t\t\t/* default matching */\n\t\t\tBUILD_BUG_ON(sizeof(c->name) != sizeof(newcon->name));\n\t\t\tif (strcmp(c->name, newcon->name) != 0)\n\t\t\t\tcontinue;\n\t\t\tif (newcon->index >= 0 &&\n\t\t\t    newcon->index != c->index)\n\t\t\t\tcontinue;\n\t\t\tif (newcon->index < 0)\n\t\t\t\tnewcon->index = c->index;\n\n\t\t\tif (_braille_register_console(newcon, c))\n\t\t\t\treturn 0;\n\n\t\t\tif (newcon->setup &&\n\t\t\t    (err = newcon->setup(newcon, c->options)) != 0)\n\t\t\t\treturn err;\n\t\t}\n\t\tnewcon->flags |= CON_ENABLED;\n\t\tif (i == preferred_console)\n\t\t\tnewcon->flags |= CON_CONSDEV;\n\t\treturn 0;\n\t}\n\n\t/*\n\t * Some consoles, such as pstore and netconsole, can be enabled even\n\t * without matching. Accept the pre-enabled consoles only when match()\n\t * and setup() had a chance to be called.\n\t */\n\tif (newcon->flags & CON_ENABLED && c->user_specified ==\tuser_specified)\n\t\treturn 0;\n\n\treturn -ENOENT;\n}"
        }
      },
      {
        "call_info": {
          "callee": "try_enable_default_console",
          "args": [
            "newcon"
          ],
          "line": 2987
        },
        "resolved": true,
        "details": {
          "function_name": "try_enable_default_console",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2912-2924",
          "snippet": "static void try_enable_default_console(struct console *newcon)\n{\n\tif (newcon->index < 0)\n\t\tnewcon->index = 0;\n\n\tif (newcon->setup && newcon->setup(newcon, NULL) != 0)\n\t\treturn;\n\n\tnewcon->flags |= CON_ENABLED;\n\n\tif (newcon->device)\n\t\tnewcon->flags |= CON_CONSDEV;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic void try_enable_default_console(struct console *newcon)\n{\n\tif (newcon->index < 0)\n\t\tnewcon->index = 0;\n\n\tif (newcon->setup && newcon->setup(newcon, NULL) != 0)\n\t\treturn;\n\n\tnewcon->flags |= CON_ENABLED;\n\n\tif (newcon->device)\n\t\tnewcon->flags |= CON_CONSDEV;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"Too late to register bootconsole %s%d\\n\"",
            "newcon->name",
            "newcon->index"
          ],
          "line": 2967
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WARN",
          "args": [
            "con == newcon",
            "\"console '%s%d' already registered\\n\"",
            "con->name",
            "con->index"
          ],
          "line": 2953
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstruct console *console_drivers;\nstatic int nr_ext_console_drivers;\nstatic struct console *exclusive_console;\nstatic int preferred_console = -1;\nstatic DEFINE_MUTEX(syslog_lock);\n\nvoid register_console(struct console *newcon)\n{\n\tstruct console *con;\n\tbool bootcon_enabled = false;\n\tbool realcon_enabled = false;\n\tint err;\n\n\tfor_each_console(con) {\n\t\tif (WARN(con == newcon, \"console '%s%d' already registered\\n\",\n\t\t\t\t\t con->name, con->index))\n\t\t\treturn;\n\t}\n\n\tfor_each_console(con) {\n\t\tif (con->flags & CON_BOOT)\n\t\t\tbootcon_enabled = true;\n\t\telse\n\t\t\trealcon_enabled = true;\n\t}\n\n\t/* Do not register boot consoles when there already is a real one. */\n\tif (newcon->flags & CON_BOOT && realcon_enabled) {\n\t\tpr_info(\"Too late to register bootconsole %s%d\\n\",\n\t\t\tnewcon->name, newcon->index);\n\t\treturn;\n\t}\n\n\t/*\n\t * See if we want to enable this console driver by default.\n\t *\n\t * Nope when a console is preferred by the command line, device\n\t * tree, or SPCR.\n\t *\n\t * The first real console with tty binding (driver) wins. More\n\t * consoles might get enabled before the right one is found.\n\t *\n\t * Note that a console with tty binding will have CON_CONSDEV\n\t * flag set and will be first in the list.\n\t */\n\tif (preferred_console < 0) {\n\t\tif (!console_drivers || !console_drivers->device ||\n\t\t    console_drivers->flags & CON_BOOT) {\n\t\t\ttry_enable_default_console(newcon);\n\t\t}\n\t}\n\n\t/* See if this console matches one we selected on the command line */\n\terr = try_enable_preferred_console(newcon, true);\n\n\t/* If not, try to match against the platform default(s) */\n\tif (err == -ENOENT)\n\t\terr = try_enable_preferred_console(newcon, false);\n\n\t/* printk() messages are not printed to the Braille console. */\n\tif (err || newcon->flags & CON_BRL)\n\t\treturn;\n\n\t/*\n\t * If we have a bootconsole, and are switching to a real console,\n\t * don't print everything out again, since when the boot console, and\n\t * the real console are the same physical device, it's annoying to\n\t * see the beginning boot messages twice\n\t */\n\tif (bootcon_enabled &&\n\t    ((newcon->flags & (CON_CONSDEV | CON_BOOT)) == CON_CONSDEV)) {\n\t\tnewcon->flags &= ~CON_PRINTBUFFER;\n\t}\n\n\t/*\n\t *\tPut this console in the list - keep the\n\t *\tpreferred driver at the head of the list.\n\t */\n\tconsole_lock();\n\tif ((newcon->flags & CON_CONSDEV) || console_drivers == NULL) {\n\t\tnewcon->next = console_drivers;\n\t\tconsole_drivers = newcon;\n\t\tif (newcon->next)\n\t\t\tnewcon->next->flags &= ~CON_CONSDEV;\n\t\t/* Ensure this flag is always set for the head of the list */\n\t\tnewcon->flags |= CON_CONSDEV;\n\t} else {\n\t\tnewcon->next = console_drivers->next;\n\t\tconsole_drivers->next = newcon;\n\t}\n\n\tif (newcon->flags & CON_EXTENDED)\n\t\tnr_ext_console_drivers++;\n\n\tif (newcon->flags & CON_PRINTBUFFER) {\n\t\t/*\n\t\t * console_unlock(); will print out the buffered messages\n\t\t * for us.\n\t\t *\n\t\t * We're about to replay the log buffer.  Only do this to the\n\t\t * just-registered console to avoid excessive message spam to\n\t\t * the already-registered consoles.\n\t\t *\n\t\t * Set exclusive_console with disabled interrupts to reduce\n\t\t * race window with eventual console_flush_on_panic() that\n\t\t * ignores console_lock.\n\t\t */\n\t\texclusive_console = newcon;\n\t\texclusive_console_stop_seq = console_seq;\n\n\t\t/* Get a consistent copy of @syslog_seq. */\n\t\tmutex_lock(&syslog_lock);\n\t\tconsole_seq = syslog_seq;\n\t\tmutex_unlock(&syslog_lock);\n\t}\n\tconsole_unlock();\n\tconsole_sysfs_notify();\n\n\t/*\n\t * By unregistering the bootconsoles after we enable the real console\n\t * we get the \"console xxx enabled\" message on all the consoles -\n\t * boot consoles, real consoles, etc - this is to ensure that end\n\t * users know there might be something in the kernel's log buffer that\n\t * went to the bootconsole (that they do not see on the real console)\n\t */\n\tpr_info(\"%sconsole [%s%d] enabled\\n\",\n\t\t(newcon->flags & CON_BOOT) ? \"boot\" : \"\" ,\n\t\tnewcon->name, newcon->index);\n\tif (bootcon_enabled &&\n\t    ((newcon->flags & (CON_CONSDEV | CON_BOOT)) == CON_CONSDEV) &&\n\t    !keep_bootcon) {\n\t\t/* We need to iterate through all boot consoles, to make\n\t\t * sure we print everything out, before we unregister them.\n\t\t */\n\t\tfor_each_console(con)\n\t\t\tif (con->flags & CON_BOOT)\n\t\t\t\tunregister_console(con);\n\t}\n}"
  },
  {
    "function_name": "try_enable_default_console",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2912-2924",
    "snippet": "static void try_enable_default_console(struct console *newcon)\n{\n\tif (newcon->index < 0)\n\t\tnewcon->index = 0;\n\n\tif (newcon->setup && newcon->setup(newcon, NULL) != 0)\n\t\treturn;\n\n\tnewcon->flags |= CON_ENABLED;\n\n\tif (newcon->device)\n\t\tnewcon->flags |= CON_CONSDEV;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "newcon->setup",
          "args": [
            "newcon",
            "NULL"
          ],
          "line": 2917
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic void try_enable_default_console(struct console *newcon)\n{\n\tif (newcon->index < 0)\n\t\tnewcon->index = 0;\n\n\tif (newcon->setup && newcon->setup(newcon, NULL) != 0)\n\t\treturn;\n\n\tnewcon->flags |= CON_ENABLED;\n\n\tif (newcon->device)\n\t\tnewcon->flags |= CON_CONSDEV;\n}"
  },
  {
    "function_name": "try_enable_preferred_console",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2864-2909",
    "snippet": "static int try_enable_preferred_console(struct console *newcon,\n\t\t\t\t\tbool user_specified)\n{\n\tstruct console_cmdline *c;\n\tint i, err;\n\n\tfor (i = 0, c = console_cmdline;\n\t     i < MAX_CMDLINECONSOLES && c->name[0];\n\t     i++, c++) {\n\t\tif (c->user_specified != user_specified)\n\t\t\tcontinue;\n\t\tif (!newcon->match ||\n\t\t    newcon->match(newcon, c->name, c->index, c->options) != 0) {\n\t\t\t/* default matching */\n\t\t\tBUILD_BUG_ON(sizeof(c->name) != sizeof(newcon->name));\n\t\t\tif (strcmp(c->name, newcon->name) != 0)\n\t\t\t\tcontinue;\n\t\t\tif (newcon->index >= 0 &&\n\t\t\t    newcon->index != c->index)\n\t\t\t\tcontinue;\n\t\t\tif (newcon->index < 0)\n\t\t\t\tnewcon->index = c->index;\n\n\t\t\tif (_braille_register_console(newcon, c))\n\t\t\t\treturn 0;\n\n\t\t\tif (newcon->setup &&\n\t\t\t    (err = newcon->setup(newcon, c->options)) != 0)\n\t\t\t\treturn err;\n\t\t}\n\t\tnewcon->flags |= CON_ENABLED;\n\t\tif (i == preferred_console)\n\t\t\tnewcon->flags |= CON_CONSDEV;\n\t\treturn 0;\n\t}\n\n\t/*\n\t * Some consoles, such as pstore and netconsole, can be enabled even\n\t * without matching. Accept the pre-enabled consoles only when match()\n\t * and setup() had a chance to be called.\n\t */\n\tif (newcon->flags & CON_ENABLED && c->user_specified ==\tuser_specified)\n\t\treturn 0;\n\n\treturn -ENOENT;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define MAX_CMDLINECONSOLES 8"
    ],
    "globals_used": [
      "static struct console_cmdline console_cmdline[MAX_CMDLINECONSOLES];",
      "static int preferred_console = -1;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "newcon->setup",
          "args": [
            "newcon",
            "c->options"
          ],
          "line": 2891
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_braille_register_console",
          "args": [
            "newcon",
            "c"
          ],
          "line": 2887
        },
        "resolved": true,
        "details": {
          "function_name": "_braille_register_console",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/braille.h",
          "lines": "42-46",
          "snippet": "static inline int\n_braille_register_console(struct console *console, struct console_cmdline *c)\n{\n\treturn 0;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline int\n_braille_register_console(struct console *console, struct console_cmdline *c)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "c->name",
            "newcon->name"
          ],
          "line": 2879
        },
        "resolved": true,
        "details": {
          "function_name": "sym_strcmp",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/kcsan/report.c",
          "lines": "356-365",
          "snippet": "static int sym_strcmp(void *addr1, void *addr2)\n{\n\tchar buf1[64];\n\tchar buf2[64];\n\n\tsnprintf(buf1, sizeof(buf1), \"%pS\", addr1);\n\tsnprintf(buf2, sizeof(buf2), \"%pS\", addr2);\n\n\treturn strncmp(buf1, buf2, sizeof(buf1));\n}",
          "includes": [
            "#include \"encoding.h\"",
            "#include \"kcsan.h\"",
            "#include <linux/stacktrace.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/preempt.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/delay.h>",
            "#include <linux/debug_locks.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"encoding.h\"\n#include \"kcsan.h\"\n#include <linux/stacktrace.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/preempt.h>\n#include <linux/lockdep.h>\n#include <linux/kernel.h>\n#include <linux/kallsyms.h>\n#include <linux/jiffies.h>\n#include <linux/delay.h>\n#include <linux/debug_locks.h>\n\nstatic int sym_strcmp(void *addr1, void *addr2)\n{\n\tchar buf1[64];\n\tchar buf2[64];\n\n\tsnprintf(buf1, sizeof(buf1), \"%pS\", addr1);\n\tsnprintf(buf2, sizeof(buf2), \"%pS\", addr2);\n\n\treturn strncmp(buf1, buf2, sizeof(buf1));\n}"
        }
      },
      {
        "call_info": {
          "callee": "BUILD_BUG_ON",
          "args": [
            "sizeof(c->name) != sizeof(newcon->name)"
          ],
          "line": 2878
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "newcon->match",
          "args": [
            "newcon",
            "c->name",
            "c->index",
            "c->options"
          ],
          "line": 2876
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define MAX_CMDLINECONSOLES 8\n\nstatic struct console_cmdline console_cmdline[MAX_CMDLINECONSOLES];\nstatic int preferred_console = -1;\n\nstatic int try_enable_preferred_console(struct console *newcon,\n\t\t\t\t\tbool user_specified)\n{\n\tstruct console_cmdline *c;\n\tint i, err;\n\n\tfor (i = 0, c = console_cmdline;\n\t     i < MAX_CMDLINECONSOLES && c->name[0];\n\t     i++, c++) {\n\t\tif (c->user_specified != user_specified)\n\t\t\tcontinue;\n\t\tif (!newcon->match ||\n\t\t    newcon->match(newcon, c->name, c->index, c->options) != 0) {\n\t\t\t/* default matching */\n\t\t\tBUILD_BUG_ON(sizeof(c->name) != sizeof(newcon->name));\n\t\t\tif (strcmp(c->name, newcon->name) != 0)\n\t\t\t\tcontinue;\n\t\t\tif (newcon->index >= 0 &&\n\t\t\t    newcon->index != c->index)\n\t\t\t\tcontinue;\n\t\t\tif (newcon->index < 0)\n\t\t\t\tnewcon->index = c->index;\n\n\t\t\tif (_braille_register_console(newcon, c))\n\t\t\t\treturn 0;\n\n\t\t\tif (newcon->setup &&\n\t\t\t    (err = newcon->setup(newcon, c->options)) != 0)\n\t\t\t\treturn err;\n\t\t}\n\t\tnewcon->flags |= CON_ENABLED;\n\t\tif (i == preferred_console)\n\t\t\tnewcon->flags |= CON_CONSDEV;\n\t\treturn 0;\n\t}\n\n\t/*\n\t * Some consoles, such as pstore and netconsole, can be enabled even\n\t * without matching. Accept the pre-enabled consoles only when match()\n\t * and setup() had a chance to be called.\n\t */\n\tif (newcon->flags & CON_ENABLED && c->user_specified ==\tuser_specified)\n\t\treturn 0;\n\n\treturn -ENOENT;\n}"
  },
  {
    "function_name": "keep_bootcon_setup",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2845-2851",
    "snippet": "static int __init keep_bootcon_setup(char *str)\n{\n\tkeep_bootcon = 1;\n\tpr_info(\"debug: skip boot console de-registration.\\n\");\n\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"debug: skip boot console de-registration.\\n\""
          ],
          "line": 2848
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic int __init keep_bootcon_setup(char *str)\n{\n\tkeep_bootcon = 1;\n\tpr_info(\"debug: skip boot console de-registration.\\n\");\n\n\treturn 0;\n}"
  },
  {
    "function_name": "console_start",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2835-2840",
    "snippet": "void console_start(struct console *console)\n{\n\tconsole_lock();\n\tconsole->flags |= CON_ENABLED;\n\tconsole_unlock();\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "console_unlock",
          "args": [],
          "line": 2839
        },
        "resolved": true,
        "details": {
          "function_name": "console_unlock",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2602-2738",
          "snippet": "void console_unlock(void)\n{\n\tstatic char ext_text[CONSOLE_EXT_LOG_MAX];\n\tstatic char text[CONSOLE_LOG_MAX];\n\tunsigned long flags;\n\tbool do_cond_resched, retry;\n\tstruct printk_info info;\n\tstruct printk_record r;\n\tu64 __maybe_unused next_seq;\n\n\tif (console_suspended) {\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tprb_rec_init_rd(&r, &info, text, sizeof(text));\n\n\t/*\n\t * Console drivers are called with interrupts disabled, so\n\t * @console_may_schedule should be cleared before; however, we may\n\t * end up dumping a lot of lines, for example, if called from\n\t * console registration path, and should invoke cond_resched()\n\t * between lines if allowable.  Not doing so can cause a very long\n\t * scheduling stall on a slow console leading to RCU stall and\n\t * softlockup warnings which exacerbate the issue with more\n\t * messages practically incapacitating the system.\n\t *\n\t * console_trylock() is not able to detect the preemptive\n\t * context reliably. Therefore the value must be stored before\n\t * and cleared after the \"again\" goto label.\n\t */\n\tdo_cond_resched = console_may_schedule;\nagain:\n\tconsole_may_schedule = 0;\n\n\t/*\n\t * We released the console_sem lock, so we need to recheck if\n\t * cpu is online and (if not) is there at least one CON_ANYTIME\n\t * console.\n\t */\n\tif (!can_use_console()) {\n\t\tconsole_locked = 0;\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tfor (;;) {\n\t\tsize_t ext_len = 0;\n\t\tint handover;\n\t\tsize_t len;\n\nskip:\n\t\tif (!prb_read_valid(prb, console_seq, &r))\n\t\t\tbreak;\n\n\t\tif (console_seq != r.info->seq) {\n\t\t\tconsole_dropped += r.info->seq - console_seq;\n\t\t\tconsole_seq = r.info->seq;\n\t\t}\n\n\t\tif (suppress_message_printing(r.info->level)) {\n\t\t\t/*\n\t\t\t * Skip record we have buffered and already printed\n\t\t\t * directly to the console when we received it, and\n\t\t\t * record that has level above the console loglevel.\n\t\t\t */\n\t\t\tconsole_seq++;\n\t\t\tgoto skip;\n\t\t}\n\n\t\t/* Output to all consoles once old messages replayed. */\n\t\tif (unlikely(exclusive_console &&\n\t\t\t     console_seq >= exclusive_console_stop_seq)) {\n\t\t\texclusive_console = NULL;\n\t\t}\n\n\t\t/*\n\t\t * Handle extended console text first because later\n\t\t * record_print_text() will modify the record buffer in-place.\n\t\t */\n\t\tif (nr_ext_console_drivers) {\n\t\t\text_len = info_print_ext_header(ext_text,\n\t\t\t\t\t\tsizeof(ext_text),\n\t\t\t\t\t\tr.info);\n\t\t\text_len += msg_print_ext_body(ext_text + ext_len,\n\t\t\t\t\t\tsizeof(ext_text) - ext_len,\n\t\t\t\t\t\t&r.text_buf[0],\n\t\t\t\t\t\tr.info->text_len,\n\t\t\t\t\t\t&r.info->dev_info);\n\t\t}\n\t\tlen = record_print_text(&r,\n\t\t\t\tconsole_msg_format & MSG_FORMAT_SYSLOG,\n\t\t\t\tprintk_time);\n\t\tconsole_seq++;\n\n\t\t/*\n\t\t * While actively printing out messages, if another printk()\n\t\t * were to occur on another CPU, it may wait for this one to\n\t\t * finish. This task can not be preempted if there is a\n\t\t * waiter waiting to take over.\n\t\t *\n\t\t * Interrupts are disabled because the hand over to a waiter\n\t\t * must not be interrupted until the hand over is completed\n\t\t * (@console_waiter is cleared).\n\t\t */\n\t\tprintk_safe_enter_irqsave(flags);\n\t\tconsole_lock_spinning_enable();\n\n\t\tstop_critical_timings();\t/* don't trace print latency */\n\t\tcall_console_drivers(ext_text, ext_len, text, len);\n\t\tstart_critical_timings();\n\n\t\thandover = console_lock_spinning_disable_and_check();\n\t\tprintk_safe_exit_irqrestore(flags);\n\t\tif (handover)\n\t\t\treturn;\n\n\t\tif (do_cond_resched)\n\t\t\tcond_resched();\n\t}\n\n\t/* Get consistent value of the next-to-be-used sequence number. */\n\tnext_seq = console_seq;\n\n\tconsole_locked = 0;\n\tup_console_sem();\n\n\t/*\n\t * Someone could have filled up the buffer again, so re-check if there's\n\t * something to flush. In case we cannot trylock the console_sem again,\n\t * there's a new owner and the console_unlock() from them will do the\n\t * flush, no worries.\n\t */\n\tretry = prb_read_valid(prb, next_seq, NULL);\n\tif (retry && console_trylock())\n\t\tgoto again;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define printk_time\t\tfalse",
            "#define CONSOLE_LOG_MAX\t\t0",
            "#define CONSOLE_LOG_MAX\t\t1024"
          ],
          "globals_used": [
            "static DEFINE_SEMAPHORE(console_sem);",
            "static int nr_ext_console_drivers;",
            "static int console_locked, console_suspended;",
            "static struct console *exclusive_console;",
            "static int console_may_schedule;",
            "static int console_msg_format = MSG_FORMAT_DEFAULT;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define printk_time\t\tfalse\n#define CONSOLE_LOG_MAX\t\t0\n#define CONSOLE_LOG_MAX\t\t1024\n\nstatic DEFINE_SEMAPHORE(console_sem);\nstatic int nr_ext_console_drivers;\nstatic int console_locked, console_suspended;\nstatic struct console *exclusive_console;\nstatic int console_may_schedule;\nstatic int console_msg_format = MSG_FORMAT_DEFAULT;\n\nvoid console_unlock(void)\n{\n\tstatic char ext_text[CONSOLE_EXT_LOG_MAX];\n\tstatic char text[CONSOLE_LOG_MAX];\n\tunsigned long flags;\n\tbool do_cond_resched, retry;\n\tstruct printk_info info;\n\tstruct printk_record r;\n\tu64 __maybe_unused next_seq;\n\n\tif (console_suspended) {\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tprb_rec_init_rd(&r, &info, text, sizeof(text));\n\n\t/*\n\t * Console drivers are called with interrupts disabled, so\n\t * @console_may_schedule should be cleared before; however, we may\n\t * end up dumping a lot of lines, for example, if called from\n\t * console registration path, and should invoke cond_resched()\n\t * between lines if allowable.  Not doing so can cause a very long\n\t * scheduling stall on a slow console leading to RCU stall and\n\t * softlockup warnings which exacerbate the issue with more\n\t * messages practically incapacitating the system.\n\t *\n\t * console_trylock() is not able to detect the preemptive\n\t * context reliably. Therefore the value must be stored before\n\t * and cleared after the \"again\" goto label.\n\t */\n\tdo_cond_resched = console_may_schedule;\nagain:\n\tconsole_may_schedule = 0;\n\n\t/*\n\t * We released the console_sem lock, so we need to recheck if\n\t * cpu is online and (if not) is there at least one CON_ANYTIME\n\t * console.\n\t */\n\tif (!can_use_console()) {\n\t\tconsole_locked = 0;\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tfor (;;) {\n\t\tsize_t ext_len = 0;\n\t\tint handover;\n\t\tsize_t len;\n\nskip:\n\t\tif (!prb_read_valid(prb, console_seq, &r))\n\t\t\tbreak;\n\n\t\tif (console_seq != r.info->seq) {\n\t\t\tconsole_dropped += r.info->seq - console_seq;\n\t\t\tconsole_seq = r.info->seq;\n\t\t}\n\n\t\tif (suppress_message_printing(r.info->level)) {\n\t\t\t/*\n\t\t\t * Skip record we have buffered and already printed\n\t\t\t * directly to the console when we received it, and\n\t\t\t * record that has level above the console loglevel.\n\t\t\t */\n\t\t\tconsole_seq++;\n\t\t\tgoto skip;\n\t\t}\n\n\t\t/* Output to all consoles once old messages replayed. */\n\t\tif (unlikely(exclusive_console &&\n\t\t\t     console_seq >= exclusive_console_stop_seq)) {\n\t\t\texclusive_console = NULL;\n\t\t}\n\n\t\t/*\n\t\t * Handle extended console text first because later\n\t\t * record_print_text() will modify the record buffer in-place.\n\t\t */\n\t\tif (nr_ext_console_drivers) {\n\t\t\text_len = info_print_ext_header(ext_text,\n\t\t\t\t\t\tsizeof(ext_text),\n\t\t\t\t\t\tr.info);\n\t\t\text_len += msg_print_ext_body(ext_text + ext_len,\n\t\t\t\t\t\tsizeof(ext_text) - ext_len,\n\t\t\t\t\t\t&r.text_buf[0],\n\t\t\t\t\t\tr.info->text_len,\n\t\t\t\t\t\t&r.info->dev_info);\n\t\t}\n\t\tlen = record_print_text(&r,\n\t\t\t\tconsole_msg_format & MSG_FORMAT_SYSLOG,\n\t\t\t\tprintk_time);\n\t\tconsole_seq++;\n\n\t\t/*\n\t\t * While actively printing out messages, if another printk()\n\t\t * were to occur on another CPU, it may wait for this one to\n\t\t * finish. This task can not be preempted if there is a\n\t\t * waiter waiting to take over.\n\t\t *\n\t\t * Interrupts are disabled because the hand over to a waiter\n\t\t * must not be interrupted until the hand over is completed\n\t\t * (@console_waiter is cleared).\n\t\t */\n\t\tprintk_safe_enter_irqsave(flags);\n\t\tconsole_lock_spinning_enable();\n\n\t\tstop_critical_timings();\t/* don't trace print latency */\n\t\tcall_console_drivers(ext_text, ext_len, text, len);\n\t\tstart_critical_timings();\n\n\t\thandover = console_lock_spinning_disable_and_check();\n\t\tprintk_safe_exit_irqrestore(flags);\n\t\tif (handover)\n\t\t\treturn;\n\n\t\tif (do_cond_resched)\n\t\t\tcond_resched();\n\t}\n\n\t/* Get consistent value of the next-to-be-used sequence number. */\n\tnext_seq = console_seq;\n\n\tconsole_locked = 0;\n\tup_console_sem();\n\n\t/*\n\t * Someone could have filled up the buffer again, so re-check if there's\n\t * something to flush. In case we cannot trylock the console_sem again,\n\t * there's a new owner and the console_unlock() from them will do the\n\t * flush, no worries.\n\t */\n\tretry = prb_read_valid(prb, next_seq, NULL);\n\tif (retry && console_trylock())\n\t\tgoto again;\n}"
        }
      },
      {
        "call_info": {
          "callee": "console_lock",
          "args": [],
          "line": 2837
        },
        "resolved": true,
        "details": {
          "function_name": "is_console_locked",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2554-2557",
          "snippet": "int is_console_locked(void)\n{\n\treturn console_locked;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nint is_console_locked(void)\n{\n\treturn console_locked;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nvoid console_start(struct console *console)\n{\n\tconsole_lock();\n\tconsole->flags |= CON_ENABLED;\n\tconsole_unlock();\n}"
  },
  {
    "function_name": "console_stop",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2827-2832",
    "snippet": "void console_stop(struct console *console)\n{\n\tconsole_lock();\n\tconsole->flags &= ~CON_ENABLED;\n\tconsole_unlock();\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "console_unlock",
          "args": [],
          "line": 2831
        },
        "resolved": true,
        "details": {
          "function_name": "console_unlock",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2602-2738",
          "snippet": "void console_unlock(void)\n{\n\tstatic char ext_text[CONSOLE_EXT_LOG_MAX];\n\tstatic char text[CONSOLE_LOG_MAX];\n\tunsigned long flags;\n\tbool do_cond_resched, retry;\n\tstruct printk_info info;\n\tstruct printk_record r;\n\tu64 __maybe_unused next_seq;\n\n\tif (console_suspended) {\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tprb_rec_init_rd(&r, &info, text, sizeof(text));\n\n\t/*\n\t * Console drivers are called with interrupts disabled, so\n\t * @console_may_schedule should be cleared before; however, we may\n\t * end up dumping a lot of lines, for example, if called from\n\t * console registration path, and should invoke cond_resched()\n\t * between lines if allowable.  Not doing so can cause a very long\n\t * scheduling stall on a slow console leading to RCU stall and\n\t * softlockup warnings which exacerbate the issue with more\n\t * messages practically incapacitating the system.\n\t *\n\t * console_trylock() is not able to detect the preemptive\n\t * context reliably. Therefore the value must be stored before\n\t * and cleared after the \"again\" goto label.\n\t */\n\tdo_cond_resched = console_may_schedule;\nagain:\n\tconsole_may_schedule = 0;\n\n\t/*\n\t * We released the console_sem lock, so we need to recheck if\n\t * cpu is online and (if not) is there at least one CON_ANYTIME\n\t * console.\n\t */\n\tif (!can_use_console()) {\n\t\tconsole_locked = 0;\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tfor (;;) {\n\t\tsize_t ext_len = 0;\n\t\tint handover;\n\t\tsize_t len;\n\nskip:\n\t\tif (!prb_read_valid(prb, console_seq, &r))\n\t\t\tbreak;\n\n\t\tif (console_seq != r.info->seq) {\n\t\t\tconsole_dropped += r.info->seq - console_seq;\n\t\t\tconsole_seq = r.info->seq;\n\t\t}\n\n\t\tif (suppress_message_printing(r.info->level)) {\n\t\t\t/*\n\t\t\t * Skip record we have buffered and already printed\n\t\t\t * directly to the console when we received it, and\n\t\t\t * record that has level above the console loglevel.\n\t\t\t */\n\t\t\tconsole_seq++;\n\t\t\tgoto skip;\n\t\t}\n\n\t\t/* Output to all consoles once old messages replayed. */\n\t\tif (unlikely(exclusive_console &&\n\t\t\t     console_seq >= exclusive_console_stop_seq)) {\n\t\t\texclusive_console = NULL;\n\t\t}\n\n\t\t/*\n\t\t * Handle extended console text first because later\n\t\t * record_print_text() will modify the record buffer in-place.\n\t\t */\n\t\tif (nr_ext_console_drivers) {\n\t\t\text_len = info_print_ext_header(ext_text,\n\t\t\t\t\t\tsizeof(ext_text),\n\t\t\t\t\t\tr.info);\n\t\t\text_len += msg_print_ext_body(ext_text + ext_len,\n\t\t\t\t\t\tsizeof(ext_text) - ext_len,\n\t\t\t\t\t\t&r.text_buf[0],\n\t\t\t\t\t\tr.info->text_len,\n\t\t\t\t\t\t&r.info->dev_info);\n\t\t}\n\t\tlen = record_print_text(&r,\n\t\t\t\tconsole_msg_format & MSG_FORMAT_SYSLOG,\n\t\t\t\tprintk_time);\n\t\tconsole_seq++;\n\n\t\t/*\n\t\t * While actively printing out messages, if another printk()\n\t\t * were to occur on another CPU, it may wait for this one to\n\t\t * finish. This task can not be preempted if there is a\n\t\t * waiter waiting to take over.\n\t\t *\n\t\t * Interrupts are disabled because the hand over to a waiter\n\t\t * must not be interrupted until the hand over is completed\n\t\t * (@console_waiter is cleared).\n\t\t */\n\t\tprintk_safe_enter_irqsave(flags);\n\t\tconsole_lock_spinning_enable();\n\n\t\tstop_critical_timings();\t/* don't trace print latency */\n\t\tcall_console_drivers(ext_text, ext_len, text, len);\n\t\tstart_critical_timings();\n\n\t\thandover = console_lock_spinning_disable_and_check();\n\t\tprintk_safe_exit_irqrestore(flags);\n\t\tif (handover)\n\t\t\treturn;\n\n\t\tif (do_cond_resched)\n\t\t\tcond_resched();\n\t}\n\n\t/* Get consistent value of the next-to-be-used sequence number. */\n\tnext_seq = console_seq;\n\n\tconsole_locked = 0;\n\tup_console_sem();\n\n\t/*\n\t * Someone could have filled up the buffer again, so re-check if there's\n\t * something to flush. In case we cannot trylock the console_sem again,\n\t * there's a new owner and the console_unlock() from them will do the\n\t * flush, no worries.\n\t */\n\tretry = prb_read_valid(prb, next_seq, NULL);\n\tif (retry && console_trylock())\n\t\tgoto again;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define printk_time\t\tfalse",
            "#define CONSOLE_LOG_MAX\t\t0",
            "#define CONSOLE_LOG_MAX\t\t1024"
          ],
          "globals_used": [
            "static DEFINE_SEMAPHORE(console_sem);",
            "static int nr_ext_console_drivers;",
            "static int console_locked, console_suspended;",
            "static struct console *exclusive_console;",
            "static int console_may_schedule;",
            "static int console_msg_format = MSG_FORMAT_DEFAULT;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define printk_time\t\tfalse\n#define CONSOLE_LOG_MAX\t\t0\n#define CONSOLE_LOG_MAX\t\t1024\n\nstatic DEFINE_SEMAPHORE(console_sem);\nstatic int nr_ext_console_drivers;\nstatic int console_locked, console_suspended;\nstatic struct console *exclusive_console;\nstatic int console_may_schedule;\nstatic int console_msg_format = MSG_FORMAT_DEFAULT;\n\nvoid console_unlock(void)\n{\n\tstatic char ext_text[CONSOLE_EXT_LOG_MAX];\n\tstatic char text[CONSOLE_LOG_MAX];\n\tunsigned long flags;\n\tbool do_cond_resched, retry;\n\tstruct printk_info info;\n\tstruct printk_record r;\n\tu64 __maybe_unused next_seq;\n\n\tif (console_suspended) {\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tprb_rec_init_rd(&r, &info, text, sizeof(text));\n\n\t/*\n\t * Console drivers are called with interrupts disabled, so\n\t * @console_may_schedule should be cleared before; however, we may\n\t * end up dumping a lot of lines, for example, if called from\n\t * console registration path, and should invoke cond_resched()\n\t * between lines if allowable.  Not doing so can cause a very long\n\t * scheduling stall on a slow console leading to RCU stall and\n\t * softlockup warnings which exacerbate the issue with more\n\t * messages practically incapacitating the system.\n\t *\n\t * console_trylock() is not able to detect the preemptive\n\t * context reliably. Therefore the value must be stored before\n\t * and cleared after the \"again\" goto label.\n\t */\n\tdo_cond_resched = console_may_schedule;\nagain:\n\tconsole_may_schedule = 0;\n\n\t/*\n\t * We released the console_sem lock, so we need to recheck if\n\t * cpu is online and (if not) is there at least one CON_ANYTIME\n\t * console.\n\t */\n\tif (!can_use_console()) {\n\t\tconsole_locked = 0;\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tfor (;;) {\n\t\tsize_t ext_len = 0;\n\t\tint handover;\n\t\tsize_t len;\n\nskip:\n\t\tif (!prb_read_valid(prb, console_seq, &r))\n\t\t\tbreak;\n\n\t\tif (console_seq != r.info->seq) {\n\t\t\tconsole_dropped += r.info->seq - console_seq;\n\t\t\tconsole_seq = r.info->seq;\n\t\t}\n\n\t\tif (suppress_message_printing(r.info->level)) {\n\t\t\t/*\n\t\t\t * Skip record we have buffered and already printed\n\t\t\t * directly to the console when we received it, and\n\t\t\t * record that has level above the console loglevel.\n\t\t\t */\n\t\t\tconsole_seq++;\n\t\t\tgoto skip;\n\t\t}\n\n\t\t/* Output to all consoles once old messages replayed. */\n\t\tif (unlikely(exclusive_console &&\n\t\t\t     console_seq >= exclusive_console_stop_seq)) {\n\t\t\texclusive_console = NULL;\n\t\t}\n\n\t\t/*\n\t\t * Handle extended console text first because later\n\t\t * record_print_text() will modify the record buffer in-place.\n\t\t */\n\t\tif (nr_ext_console_drivers) {\n\t\t\text_len = info_print_ext_header(ext_text,\n\t\t\t\t\t\tsizeof(ext_text),\n\t\t\t\t\t\tr.info);\n\t\t\text_len += msg_print_ext_body(ext_text + ext_len,\n\t\t\t\t\t\tsizeof(ext_text) - ext_len,\n\t\t\t\t\t\t&r.text_buf[0],\n\t\t\t\t\t\tr.info->text_len,\n\t\t\t\t\t\t&r.info->dev_info);\n\t\t}\n\t\tlen = record_print_text(&r,\n\t\t\t\tconsole_msg_format & MSG_FORMAT_SYSLOG,\n\t\t\t\tprintk_time);\n\t\tconsole_seq++;\n\n\t\t/*\n\t\t * While actively printing out messages, if another printk()\n\t\t * were to occur on another CPU, it may wait for this one to\n\t\t * finish. This task can not be preempted if there is a\n\t\t * waiter waiting to take over.\n\t\t *\n\t\t * Interrupts are disabled because the hand over to a waiter\n\t\t * must not be interrupted until the hand over is completed\n\t\t * (@console_waiter is cleared).\n\t\t */\n\t\tprintk_safe_enter_irqsave(flags);\n\t\tconsole_lock_spinning_enable();\n\n\t\tstop_critical_timings();\t/* don't trace print latency */\n\t\tcall_console_drivers(ext_text, ext_len, text, len);\n\t\tstart_critical_timings();\n\n\t\thandover = console_lock_spinning_disable_and_check();\n\t\tprintk_safe_exit_irqrestore(flags);\n\t\tif (handover)\n\t\t\treturn;\n\n\t\tif (do_cond_resched)\n\t\t\tcond_resched();\n\t}\n\n\t/* Get consistent value of the next-to-be-used sequence number. */\n\tnext_seq = console_seq;\n\n\tconsole_locked = 0;\n\tup_console_sem();\n\n\t/*\n\t * Someone could have filled up the buffer again, so re-check if there's\n\t * something to flush. In case we cannot trylock the console_sem again,\n\t * there's a new owner and the console_unlock() from them will do the\n\t * flush, no worries.\n\t */\n\tretry = prb_read_valid(prb, next_seq, NULL);\n\tif (retry && console_trylock())\n\t\tgoto again;\n}"
        }
      },
      {
        "call_info": {
          "callee": "console_lock",
          "args": [],
          "line": 2829
        },
        "resolved": true,
        "details": {
          "function_name": "is_console_locked",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2554-2557",
          "snippet": "int is_console_locked(void)\n{\n\treturn console_locked;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nint is_console_locked(void)\n{\n\treturn console_locked;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nvoid console_stop(struct console *console)\n{\n\tconsole_lock();\n\tconsole->flags &= ~CON_ENABLED;\n\tconsole_unlock();\n}"
  },
  {
    "function_name": "console_device",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2805-2820",
    "snippet": "struct tty_driver *console_device(int *index)\n{\n\tstruct console *c;\n\tstruct tty_driver *driver = NULL;\n\n\tconsole_lock();\n\tfor_each_console(c) {\n\t\tif (!c->device)\n\t\t\tcontinue;\n\t\tdriver = c->device(c, index);\n\t\tif (driver)\n\t\t\tbreak;\n\t}\n\tconsole_unlock();\n\treturn driver;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "console_unlock",
          "args": [],
          "line": 2818
        },
        "resolved": true,
        "details": {
          "function_name": "console_unlock",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2602-2738",
          "snippet": "void console_unlock(void)\n{\n\tstatic char ext_text[CONSOLE_EXT_LOG_MAX];\n\tstatic char text[CONSOLE_LOG_MAX];\n\tunsigned long flags;\n\tbool do_cond_resched, retry;\n\tstruct printk_info info;\n\tstruct printk_record r;\n\tu64 __maybe_unused next_seq;\n\n\tif (console_suspended) {\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tprb_rec_init_rd(&r, &info, text, sizeof(text));\n\n\t/*\n\t * Console drivers are called with interrupts disabled, so\n\t * @console_may_schedule should be cleared before; however, we may\n\t * end up dumping a lot of lines, for example, if called from\n\t * console registration path, and should invoke cond_resched()\n\t * between lines if allowable.  Not doing so can cause a very long\n\t * scheduling stall on a slow console leading to RCU stall and\n\t * softlockup warnings which exacerbate the issue with more\n\t * messages practically incapacitating the system.\n\t *\n\t * console_trylock() is not able to detect the preemptive\n\t * context reliably. Therefore the value must be stored before\n\t * and cleared after the \"again\" goto label.\n\t */\n\tdo_cond_resched = console_may_schedule;\nagain:\n\tconsole_may_schedule = 0;\n\n\t/*\n\t * We released the console_sem lock, so we need to recheck if\n\t * cpu is online and (if not) is there at least one CON_ANYTIME\n\t * console.\n\t */\n\tif (!can_use_console()) {\n\t\tconsole_locked = 0;\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tfor (;;) {\n\t\tsize_t ext_len = 0;\n\t\tint handover;\n\t\tsize_t len;\n\nskip:\n\t\tif (!prb_read_valid(prb, console_seq, &r))\n\t\t\tbreak;\n\n\t\tif (console_seq != r.info->seq) {\n\t\t\tconsole_dropped += r.info->seq - console_seq;\n\t\t\tconsole_seq = r.info->seq;\n\t\t}\n\n\t\tif (suppress_message_printing(r.info->level)) {\n\t\t\t/*\n\t\t\t * Skip record we have buffered and already printed\n\t\t\t * directly to the console when we received it, and\n\t\t\t * record that has level above the console loglevel.\n\t\t\t */\n\t\t\tconsole_seq++;\n\t\t\tgoto skip;\n\t\t}\n\n\t\t/* Output to all consoles once old messages replayed. */\n\t\tif (unlikely(exclusive_console &&\n\t\t\t     console_seq >= exclusive_console_stop_seq)) {\n\t\t\texclusive_console = NULL;\n\t\t}\n\n\t\t/*\n\t\t * Handle extended console text first because later\n\t\t * record_print_text() will modify the record buffer in-place.\n\t\t */\n\t\tif (nr_ext_console_drivers) {\n\t\t\text_len = info_print_ext_header(ext_text,\n\t\t\t\t\t\tsizeof(ext_text),\n\t\t\t\t\t\tr.info);\n\t\t\text_len += msg_print_ext_body(ext_text + ext_len,\n\t\t\t\t\t\tsizeof(ext_text) - ext_len,\n\t\t\t\t\t\t&r.text_buf[0],\n\t\t\t\t\t\tr.info->text_len,\n\t\t\t\t\t\t&r.info->dev_info);\n\t\t}\n\t\tlen = record_print_text(&r,\n\t\t\t\tconsole_msg_format & MSG_FORMAT_SYSLOG,\n\t\t\t\tprintk_time);\n\t\tconsole_seq++;\n\n\t\t/*\n\t\t * While actively printing out messages, if another printk()\n\t\t * were to occur on another CPU, it may wait for this one to\n\t\t * finish. This task can not be preempted if there is a\n\t\t * waiter waiting to take over.\n\t\t *\n\t\t * Interrupts are disabled because the hand over to a waiter\n\t\t * must not be interrupted until the hand over is completed\n\t\t * (@console_waiter is cleared).\n\t\t */\n\t\tprintk_safe_enter_irqsave(flags);\n\t\tconsole_lock_spinning_enable();\n\n\t\tstop_critical_timings();\t/* don't trace print latency */\n\t\tcall_console_drivers(ext_text, ext_len, text, len);\n\t\tstart_critical_timings();\n\n\t\thandover = console_lock_spinning_disable_and_check();\n\t\tprintk_safe_exit_irqrestore(flags);\n\t\tif (handover)\n\t\t\treturn;\n\n\t\tif (do_cond_resched)\n\t\t\tcond_resched();\n\t}\n\n\t/* Get consistent value of the next-to-be-used sequence number. */\n\tnext_seq = console_seq;\n\n\tconsole_locked = 0;\n\tup_console_sem();\n\n\t/*\n\t * Someone could have filled up the buffer again, so re-check if there's\n\t * something to flush. In case we cannot trylock the console_sem again,\n\t * there's a new owner and the console_unlock() from them will do the\n\t * flush, no worries.\n\t */\n\tretry = prb_read_valid(prb, next_seq, NULL);\n\tif (retry && console_trylock())\n\t\tgoto again;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define printk_time\t\tfalse",
            "#define CONSOLE_LOG_MAX\t\t0",
            "#define CONSOLE_LOG_MAX\t\t1024"
          ],
          "globals_used": [
            "static DEFINE_SEMAPHORE(console_sem);",
            "static int nr_ext_console_drivers;",
            "static int console_locked, console_suspended;",
            "static struct console *exclusive_console;",
            "static int console_may_schedule;",
            "static int console_msg_format = MSG_FORMAT_DEFAULT;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define printk_time\t\tfalse\n#define CONSOLE_LOG_MAX\t\t0\n#define CONSOLE_LOG_MAX\t\t1024\n\nstatic DEFINE_SEMAPHORE(console_sem);\nstatic int nr_ext_console_drivers;\nstatic int console_locked, console_suspended;\nstatic struct console *exclusive_console;\nstatic int console_may_schedule;\nstatic int console_msg_format = MSG_FORMAT_DEFAULT;\n\nvoid console_unlock(void)\n{\n\tstatic char ext_text[CONSOLE_EXT_LOG_MAX];\n\tstatic char text[CONSOLE_LOG_MAX];\n\tunsigned long flags;\n\tbool do_cond_resched, retry;\n\tstruct printk_info info;\n\tstruct printk_record r;\n\tu64 __maybe_unused next_seq;\n\n\tif (console_suspended) {\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tprb_rec_init_rd(&r, &info, text, sizeof(text));\n\n\t/*\n\t * Console drivers are called with interrupts disabled, so\n\t * @console_may_schedule should be cleared before; however, we may\n\t * end up dumping a lot of lines, for example, if called from\n\t * console registration path, and should invoke cond_resched()\n\t * between lines if allowable.  Not doing so can cause a very long\n\t * scheduling stall on a slow console leading to RCU stall and\n\t * softlockup warnings which exacerbate the issue with more\n\t * messages practically incapacitating the system.\n\t *\n\t * console_trylock() is not able to detect the preemptive\n\t * context reliably. Therefore the value must be stored before\n\t * and cleared after the \"again\" goto label.\n\t */\n\tdo_cond_resched = console_may_schedule;\nagain:\n\tconsole_may_schedule = 0;\n\n\t/*\n\t * We released the console_sem lock, so we need to recheck if\n\t * cpu is online and (if not) is there at least one CON_ANYTIME\n\t * console.\n\t */\n\tif (!can_use_console()) {\n\t\tconsole_locked = 0;\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tfor (;;) {\n\t\tsize_t ext_len = 0;\n\t\tint handover;\n\t\tsize_t len;\n\nskip:\n\t\tif (!prb_read_valid(prb, console_seq, &r))\n\t\t\tbreak;\n\n\t\tif (console_seq != r.info->seq) {\n\t\t\tconsole_dropped += r.info->seq - console_seq;\n\t\t\tconsole_seq = r.info->seq;\n\t\t}\n\n\t\tif (suppress_message_printing(r.info->level)) {\n\t\t\t/*\n\t\t\t * Skip record we have buffered and already printed\n\t\t\t * directly to the console when we received it, and\n\t\t\t * record that has level above the console loglevel.\n\t\t\t */\n\t\t\tconsole_seq++;\n\t\t\tgoto skip;\n\t\t}\n\n\t\t/* Output to all consoles once old messages replayed. */\n\t\tif (unlikely(exclusive_console &&\n\t\t\t     console_seq >= exclusive_console_stop_seq)) {\n\t\t\texclusive_console = NULL;\n\t\t}\n\n\t\t/*\n\t\t * Handle extended console text first because later\n\t\t * record_print_text() will modify the record buffer in-place.\n\t\t */\n\t\tif (nr_ext_console_drivers) {\n\t\t\text_len = info_print_ext_header(ext_text,\n\t\t\t\t\t\tsizeof(ext_text),\n\t\t\t\t\t\tr.info);\n\t\t\text_len += msg_print_ext_body(ext_text + ext_len,\n\t\t\t\t\t\tsizeof(ext_text) - ext_len,\n\t\t\t\t\t\t&r.text_buf[0],\n\t\t\t\t\t\tr.info->text_len,\n\t\t\t\t\t\t&r.info->dev_info);\n\t\t}\n\t\tlen = record_print_text(&r,\n\t\t\t\tconsole_msg_format & MSG_FORMAT_SYSLOG,\n\t\t\t\tprintk_time);\n\t\tconsole_seq++;\n\n\t\t/*\n\t\t * While actively printing out messages, if another printk()\n\t\t * were to occur on another CPU, it may wait for this one to\n\t\t * finish. This task can not be preempted if there is a\n\t\t * waiter waiting to take over.\n\t\t *\n\t\t * Interrupts are disabled because the hand over to a waiter\n\t\t * must not be interrupted until the hand over is completed\n\t\t * (@console_waiter is cleared).\n\t\t */\n\t\tprintk_safe_enter_irqsave(flags);\n\t\tconsole_lock_spinning_enable();\n\n\t\tstop_critical_timings();\t/* don't trace print latency */\n\t\tcall_console_drivers(ext_text, ext_len, text, len);\n\t\tstart_critical_timings();\n\n\t\thandover = console_lock_spinning_disable_and_check();\n\t\tprintk_safe_exit_irqrestore(flags);\n\t\tif (handover)\n\t\t\treturn;\n\n\t\tif (do_cond_resched)\n\t\t\tcond_resched();\n\t}\n\n\t/* Get consistent value of the next-to-be-used sequence number. */\n\tnext_seq = console_seq;\n\n\tconsole_locked = 0;\n\tup_console_sem();\n\n\t/*\n\t * Someone could have filled up the buffer again, so re-check if there's\n\t * something to flush. In case we cannot trylock the console_sem again,\n\t * there's a new owner and the console_unlock() from them will do the\n\t * flush, no worries.\n\t */\n\tretry = prb_read_valid(prb, next_seq, NULL);\n\tif (retry && console_trylock())\n\t\tgoto again;\n}"
        }
      },
      {
        "call_info": {
          "callee": "c->device",
          "args": [
            "c",
            "index"
          ],
          "line": 2814
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "console_lock",
          "args": [],
          "line": 2810
        },
        "resolved": true,
        "details": {
          "function_name": "is_console_locked",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2554-2557",
          "snippet": "int is_console_locked(void)\n{\n\treturn console_locked;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nint is_console_locked(void)\n{\n\treturn console_locked;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstruct tty_driver *console_device(int *index)\n{\n\tstruct console *c;\n\tstruct tty_driver *driver = NULL;\n\n\tconsole_lock();\n\tfor_each_console(c) {\n\t\tif (!c->device)\n\t\t\tcontinue;\n\t\tdriver = c->device(c, index);\n\t\tif (driver)\n\t\t\tbreak;\n\t}\n\tconsole_unlock();\n\treturn driver;\n}"
  },
  {
    "function_name": "console_flush_on_panic",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2785-2800",
    "snippet": "void console_flush_on_panic(enum con_flush_mode mode)\n{\n\t/*\n\t * If someone else is holding the console lock, trylock will fail\n\t * and may_schedule may be set.  Ignore and proceed to unlock so\n\t * that messages are flushed out.  As this can be called from any\n\t * context and we don't want to get preempted while flushing,\n\t * ensure may_schedule is cleared.\n\t */\n\tconsole_trylock();\n\tconsole_may_schedule = 0;\n\n\tif (mode == CONSOLE_REPLAY_ALL)\n\t\tconsole_seq = prb_first_valid_seq(prb);\n\tconsole_unlock();\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int console_may_schedule;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "console_unlock",
          "args": [],
          "line": 2799
        },
        "resolved": true,
        "details": {
          "function_name": "console_unlock",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2602-2738",
          "snippet": "void console_unlock(void)\n{\n\tstatic char ext_text[CONSOLE_EXT_LOG_MAX];\n\tstatic char text[CONSOLE_LOG_MAX];\n\tunsigned long flags;\n\tbool do_cond_resched, retry;\n\tstruct printk_info info;\n\tstruct printk_record r;\n\tu64 __maybe_unused next_seq;\n\n\tif (console_suspended) {\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tprb_rec_init_rd(&r, &info, text, sizeof(text));\n\n\t/*\n\t * Console drivers are called with interrupts disabled, so\n\t * @console_may_schedule should be cleared before; however, we may\n\t * end up dumping a lot of lines, for example, if called from\n\t * console registration path, and should invoke cond_resched()\n\t * between lines if allowable.  Not doing so can cause a very long\n\t * scheduling stall on a slow console leading to RCU stall and\n\t * softlockup warnings which exacerbate the issue with more\n\t * messages practically incapacitating the system.\n\t *\n\t * console_trylock() is not able to detect the preemptive\n\t * context reliably. Therefore the value must be stored before\n\t * and cleared after the \"again\" goto label.\n\t */\n\tdo_cond_resched = console_may_schedule;\nagain:\n\tconsole_may_schedule = 0;\n\n\t/*\n\t * We released the console_sem lock, so we need to recheck if\n\t * cpu is online and (if not) is there at least one CON_ANYTIME\n\t * console.\n\t */\n\tif (!can_use_console()) {\n\t\tconsole_locked = 0;\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tfor (;;) {\n\t\tsize_t ext_len = 0;\n\t\tint handover;\n\t\tsize_t len;\n\nskip:\n\t\tif (!prb_read_valid(prb, console_seq, &r))\n\t\t\tbreak;\n\n\t\tif (console_seq != r.info->seq) {\n\t\t\tconsole_dropped += r.info->seq - console_seq;\n\t\t\tconsole_seq = r.info->seq;\n\t\t}\n\n\t\tif (suppress_message_printing(r.info->level)) {\n\t\t\t/*\n\t\t\t * Skip record we have buffered and already printed\n\t\t\t * directly to the console when we received it, and\n\t\t\t * record that has level above the console loglevel.\n\t\t\t */\n\t\t\tconsole_seq++;\n\t\t\tgoto skip;\n\t\t}\n\n\t\t/* Output to all consoles once old messages replayed. */\n\t\tif (unlikely(exclusive_console &&\n\t\t\t     console_seq >= exclusive_console_stop_seq)) {\n\t\t\texclusive_console = NULL;\n\t\t}\n\n\t\t/*\n\t\t * Handle extended console text first because later\n\t\t * record_print_text() will modify the record buffer in-place.\n\t\t */\n\t\tif (nr_ext_console_drivers) {\n\t\t\text_len = info_print_ext_header(ext_text,\n\t\t\t\t\t\tsizeof(ext_text),\n\t\t\t\t\t\tr.info);\n\t\t\text_len += msg_print_ext_body(ext_text + ext_len,\n\t\t\t\t\t\tsizeof(ext_text) - ext_len,\n\t\t\t\t\t\t&r.text_buf[0],\n\t\t\t\t\t\tr.info->text_len,\n\t\t\t\t\t\t&r.info->dev_info);\n\t\t}\n\t\tlen = record_print_text(&r,\n\t\t\t\tconsole_msg_format & MSG_FORMAT_SYSLOG,\n\t\t\t\tprintk_time);\n\t\tconsole_seq++;\n\n\t\t/*\n\t\t * While actively printing out messages, if another printk()\n\t\t * were to occur on another CPU, it may wait for this one to\n\t\t * finish. This task can not be preempted if there is a\n\t\t * waiter waiting to take over.\n\t\t *\n\t\t * Interrupts are disabled because the hand over to a waiter\n\t\t * must not be interrupted until the hand over is completed\n\t\t * (@console_waiter is cleared).\n\t\t */\n\t\tprintk_safe_enter_irqsave(flags);\n\t\tconsole_lock_spinning_enable();\n\n\t\tstop_critical_timings();\t/* don't trace print latency */\n\t\tcall_console_drivers(ext_text, ext_len, text, len);\n\t\tstart_critical_timings();\n\n\t\thandover = console_lock_spinning_disable_and_check();\n\t\tprintk_safe_exit_irqrestore(flags);\n\t\tif (handover)\n\t\t\treturn;\n\n\t\tif (do_cond_resched)\n\t\t\tcond_resched();\n\t}\n\n\t/* Get consistent value of the next-to-be-used sequence number. */\n\tnext_seq = console_seq;\n\n\tconsole_locked = 0;\n\tup_console_sem();\n\n\t/*\n\t * Someone could have filled up the buffer again, so re-check if there's\n\t * something to flush. In case we cannot trylock the console_sem again,\n\t * there's a new owner and the console_unlock() from them will do the\n\t * flush, no worries.\n\t */\n\tretry = prb_read_valid(prb, next_seq, NULL);\n\tif (retry && console_trylock())\n\t\tgoto again;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define printk_time\t\tfalse",
            "#define CONSOLE_LOG_MAX\t\t0",
            "#define CONSOLE_LOG_MAX\t\t1024"
          ],
          "globals_used": [
            "static DEFINE_SEMAPHORE(console_sem);",
            "static int nr_ext_console_drivers;",
            "static int console_locked, console_suspended;",
            "static struct console *exclusive_console;",
            "static int console_may_schedule;",
            "static int console_msg_format = MSG_FORMAT_DEFAULT;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define printk_time\t\tfalse\n#define CONSOLE_LOG_MAX\t\t0\n#define CONSOLE_LOG_MAX\t\t1024\n\nstatic DEFINE_SEMAPHORE(console_sem);\nstatic int nr_ext_console_drivers;\nstatic int console_locked, console_suspended;\nstatic struct console *exclusive_console;\nstatic int console_may_schedule;\nstatic int console_msg_format = MSG_FORMAT_DEFAULT;\n\nvoid console_unlock(void)\n{\n\tstatic char ext_text[CONSOLE_EXT_LOG_MAX];\n\tstatic char text[CONSOLE_LOG_MAX];\n\tunsigned long flags;\n\tbool do_cond_resched, retry;\n\tstruct printk_info info;\n\tstruct printk_record r;\n\tu64 __maybe_unused next_seq;\n\n\tif (console_suspended) {\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tprb_rec_init_rd(&r, &info, text, sizeof(text));\n\n\t/*\n\t * Console drivers are called with interrupts disabled, so\n\t * @console_may_schedule should be cleared before; however, we may\n\t * end up dumping a lot of lines, for example, if called from\n\t * console registration path, and should invoke cond_resched()\n\t * between lines if allowable.  Not doing so can cause a very long\n\t * scheduling stall on a slow console leading to RCU stall and\n\t * softlockup warnings which exacerbate the issue with more\n\t * messages practically incapacitating the system.\n\t *\n\t * console_trylock() is not able to detect the preemptive\n\t * context reliably. Therefore the value must be stored before\n\t * and cleared after the \"again\" goto label.\n\t */\n\tdo_cond_resched = console_may_schedule;\nagain:\n\tconsole_may_schedule = 0;\n\n\t/*\n\t * We released the console_sem lock, so we need to recheck if\n\t * cpu is online and (if not) is there at least one CON_ANYTIME\n\t * console.\n\t */\n\tif (!can_use_console()) {\n\t\tconsole_locked = 0;\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tfor (;;) {\n\t\tsize_t ext_len = 0;\n\t\tint handover;\n\t\tsize_t len;\n\nskip:\n\t\tif (!prb_read_valid(prb, console_seq, &r))\n\t\t\tbreak;\n\n\t\tif (console_seq != r.info->seq) {\n\t\t\tconsole_dropped += r.info->seq - console_seq;\n\t\t\tconsole_seq = r.info->seq;\n\t\t}\n\n\t\tif (suppress_message_printing(r.info->level)) {\n\t\t\t/*\n\t\t\t * Skip record we have buffered and already printed\n\t\t\t * directly to the console when we received it, and\n\t\t\t * record that has level above the console loglevel.\n\t\t\t */\n\t\t\tconsole_seq++;\n\t\t\tgoto skip;\n\t\t}\n\n\t\t/* Output to all consoles once old messages replayed. */\n\t\tif (unlikely(exclusive_console &&\n\t\t\t     console_seq >= exclusive_console_stop_seq)) {\n\t\t\texclusive_console = NULL;\n\t\t}\n\n\t\t/*\n\t\t * Handle extended console text first because later\n\t\t * record_print_text() will modify the record buffer in-place.\n\t\t */\n\t\tif (nr_ext_console_drivers) {\n\t\t\text_len = info_print_ext_header(ext_text,\n\t\t\t\t\t\tsizeof(ext_text),\n\t\t\t\t\t\tr.info);\n\t\t\text_len += msg_print_ext_body(ext_text + ext_len,\n\t\t\t\t\t\tsizeof(ext_text) - ext_len,\n\t\t\t\t\t\t&r.text_buf[0],\n\t\t\t\t\t\tr.info->text_len,\n\t\t\t\t\t\t&r.info->dev_info);\n\t\t}\n\t\tlen = record_print_text(&r,\n\t\t\t\tconsole_msg_format & MSG_FORMAT_SYSLOG,\n\t\t\t\tprintk_time);\n\t\tconsole_seq++;\n\n\t\t/*\n\t\t * While actively printing out messages, if another printk()\n\t\t * were to occur on another CPU, it may wait for this one to\n\t\t * finish. This task can not be preempted if there is a\n\t\t * waiter waiting to take over.\n\t\t *\n\t\t * Interrupts are disabled because the hand over to a waiter\n\t\t * must not be interrupted until the hand over is completed\n\t\t * (@console_waiter is cleared).\n\t\t */\n\t\tprintk_safe_enter_irqsave(flags);\n\t\tconsole_lock_spinning_enable();\n\n\t\tstop_critical_timings();\t/* don't trace print latency */\n\t\tcall_console_drivers(ext_text, ext_len, text, len);\n\t\tstart_critical_timings();\n\n\t\thandover = console_lock_spinning_disable_and_check();\n\t\tprintk_safe_exit_irqrestore(flags);\n\t\tif (handover)\n\t\t\treturn;\n\n\t\tif (do_cond_resched)\n\t\t\tcond_resched();\n\t}\n\n\t/* Get consistent value of the next-to-be-used sequence number. */\n\tnext_seq = console_seq;\n\n\tconsole_locked = 0;\n\tup_console_sem();\n\n\t/*\n\t * Someone could have filled up the buffer again, so re-check if there's\n\t * something to flush. In case we cannot trylock the console_sem again,\n\t * there's a new owner and the console_unlock() from them will do the\n\t * flush, no worries.\n\t */\n\tretry = prb_read_valid(prb, next_seq, NULL);\n\tif (retry && console_trylock())\n\t\tgoto again;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prb_first_valid_seq",
          "args": [
            "prb"
          ],
          "line": 2798
        },
        "resolved": true,
        "details": {
          "function_name": "prb_first_valid_seq",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk_ringbuffer.c",
          "lines": "1981-1989",
          "snippet": "u64 prb_first_valid_seq(struct printk_ringbuffer *rb)\n{\n\tu64 seq = 0;\n\n\tif (!_prb_read_valid(rb, &seq, NULL, NULL))\n\t\treturn 0;\n\n\treturn seq;\n}",
          "includes": [
            "#include \"printk_ringbuffer.h\"",
            "#include <linux/bug.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/irqflags.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"printk_ringbuffer.h\"\n#include <linux/bug.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/irqflags.h>\n#include <linux/kernel.h>\n\nu64 prb_first_valid_seq(struct printk_ringbuffer *rb)\n{\n\tu64 seq = 0;\n\n\tif (!_prb_read_valid(rb, &seq, NULL, NULL))\n\t\treturn 0;\n\n\treturn seq;\n}"
        }
      },
      {
        "call_info": {
          "callee": "console_trylock",
          "args": [],
          "line": 2794
        },
        "resolved": true,
        "details": {
          "function_name": "console_trylock",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2540-2551",
          "snippet": "int console_trylock(void)\n{\n\tif (down_trylock_console_sem())\n\t\treturn 0;\n\tif (console_suspended) {\n\t\tup_console_sem();\n\t\treturn 0;\n\t}\n\tconsole_locked = 1;\n\tconsole_may_schedule = 0;\n\treturn 1;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int console_locked, console_suspended;",
            "static int console_may_schedule;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic int console_locked, console_suspended;\nstatic int console_may_schedule;\n\nint console_trylock(void)\n{\n\tif (down_trylock_console_sem())\n\t\treturn 0;\n\tif (console_suspended) {\n\t\tup_console_sem();\n\t\treturn 0;\n\t}\n\tconsole_locked = 1;\n\tconsole_may_schedule = 0;\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic int console_may_schedule;\n\nvoid console_flush_on_panic(enum con_flush_mode mode)\n{\n\t/*\n\t * If someone else is holding the console lock, trylock will fail\n\t * and may_schedule may be set.  Ignore and proceed to unlock so\n\t * that messages are flushed out.  As this can be called from any\n\t * context and we don't want to get preempted while flushing,\n\t * ensure may_schedule is cleared.\n\t */\n\tconsole_trylock();\n\tconsole_may_schedule = 0;\n\n\tif (mode == CONSOLE_REPLAY_ALL)\n\t\tconsole_seq = prb_first_valid_seq(prb);\n\tconsole_unlock();\n}"
  },
  {
    "function_name": "console_unblank",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2757-2777",
    "snippet": "void console_unblank(void)\n{\n\tstruct console *c;\n\n\t/*\n\t * console_unblank can no longer be called in interrupt context unless\n\t * oops_in_progress is set to 1..\n\t */\n\tif (oops_in_progress) {\n\t\tif (down_trylock_console_sem() != 0)\n\t\t\treturn;\n\t} else\n\t\tconsole_lock();\n\n\tconsole_locked = 1;\n\tconsole_may_schedule = 0;\n\tfor_each_console(c)\n\t\tif ((c->flags & CON_ENABLED) && c->unblank)\n\t\t\tc->unblank();\n\tconsole_unlock();\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "int oops_in_progress;",
      "static int console_may_schedule;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "console_unlock",
          "args": [],
          "line": 2776
        },
        "resolved": true,
        "details": {
          "function_name": "console_unlock",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2602-2738",
          "snippet": "void console_unlock(void)\n{\n\tstatic char ext_text[CONSOLE_EXT_LOG_MAX];\n\tstatic char text[CONSOLE_LOG_MAX];\n\tunsigned long flags;\n\tbool do_cond_resched, retry;\n\tstruct printk_info info;\n\tstruct printk_record r;\n\tu64 __maybe_unused next_seq;\n\n\tif (console_suspended) {\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tprb_rec_init_rd(&r, &info, text, sizeof(text));\n\n\t/*\n\t * Console drivers are called with interrupts disabled, so\n\t * @console_may_schedule should be cleared before; however, we may\n\t * end up dumping a lot of lines, for example, if called from\n\t * console registration path, and should invoke cond_resched()\n\t * between lines if allowable.  Not doing so can cause a very long\n\t * scheduling stall on a slow console leading to RCU stall and\n\t * softlockup warnings which exacerbate the issue with more\n\t * messages practically incapacitating the system.\n\t *\n\t * console_trylock() is not able to detect the preemptive\n\t * context reliably. Therefore the value must be stored before\n\t * and cleared after the \"again\" goto label.\n\t */\n\tdo_cond_resched = console_may_schedule;\nagain:\n\tconsole_may_schedule = 0;\n\n\t/*\n\t * We released the console_sem lock, so we need to recheck if\n\t * cpu is online and (if not) is there at least one CON_ANYTIME\n\t * console.\n\t */\n\tif (!can_use_console()) {\n\t\tconsole_locked = 0;\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tfor (;;) {\n\t\tsize_t ext_len = 0;\n\t\tint handover;\n\t\tsize_t len;\n\nskip:\n\t\tif (!prb_read_valid(prb, console_seq, &r))\n\t\t\tbreak;\n\n\t\tif (console_seq != r.info->seq) {\n\t\t\tconsole_dropped += r.info->seq - console_seq;\n\t\t\tconsole_seq = r.info->seq;\n\t\t}\n\n\t\tif (suppress_message_printing(r.info->level)) {\n\t\t\t/*\n\t\t\t * Skip record we have buffered and already printed\n\t\t\t * directly to the console when we received it, and\n\t\t\t * record that has level above the console loglevel.\n\t\t\t */\n\t\t\tconsole_seq++;\n\t\t\tgoto skip;\n\t\t}\n\n\t\t/* Output to all consoles once old messages replayed. */\n\t\tif (unlikely(exclusive_console &&\n\t\t\t     console_seq >= exclusive_console_stop_seq)) {\n\t\t\texclusive_console = NULL;\n\t\t}\n\n\t\t/*\n\t\t * Handle extended console text first because later\n\t\t * record_print_text() will modify the record buffer in-place.\n\t\t */\n\t\tif (nr_ext_console_drivers) {\n\t\t\text_len = info_print_ext_header(ext_text,\n\t\t\t\t\t\tsizeof(ext_text),\n\t\t\t\t\t\tr.info);\n\t\t\text_len += msg_print_ext_body(ext_text + ext_len,\n\t\t\t\t\t\tsizeof(ext_text) - ext_len,\n\t\t\t\t\t\t&r.text_buf[0],\n\t\t\t\t\t\tr.info->text_len,\n\t\t\t\t\t\t&r.info->dev_info);\n\t\t}\n\t\tlen = record_print_text(&r,\n\t\t\t\tconsole_msg_format & MSG_FORMAT_SYSLOG,\n\t\t\t\tprintk_time);\n\t\tconsole_seq++;\n\n\t\t/*\n\t\t * While actively printing out messages, if another printk()\n\t\t * were to occur on another CPU, it may wait for this one to\n\t\t * finish. This task can not be preempted if there is a\n\t\t * waiter waiting to take over.\n\t\t *\n\t\t * Interrupts are disabled because the hand over to a waiter\n\t\t * must not be interrupted until the hand over is completed\n\t\t * (@console_waiter is cleared).\n\t\t */\n\t\tprintk_safe_enter_irqsave(flags);\n\t\tconsole_lock_spinning_enable();\n\n\t\tstop_critical_timings();\t/* don't trace print latency */\n\t\tcall_console_drivers(ext_text, ext_len, text, len);\n\t\tstart_critical_timings();\n\n\t\thandover = console_lock_spinning_disable_and_check();\n\t\tprintk_safe_exit_irqrestore(flags);\n\t\tif (handover)\n\t\t\treturn;\n\n\t\tif (do_cond_resched)\n\t\t\tcond_resched();\n\t}\n\n\t/* Get consistent value of the next-to-be-used sequence number. */\n\tnext_seq = console_seq;\n\n\tconsole_locked = 0;\n\tup_console_sem();\n\n\t/*\n\t * Someone could have filled up the buffer again, so re-check if there's\n\t * something to flush. In case we cannot trylock the console_sem again,\n\t * there's a new owner and the console_unlock() from them will do the\n\t * flush, no worries.\n\t */\n\tretry = prb_read_valid(prb, next_seq, NULL);\n\tif (retry && console_trylock())\n\t\tgoto again;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define printk_time\t\tfalse",
            "#define CONSOLE_LOG_MAX\t\t0",
            "#define CONSOLE_LOG_MAX\t\t1024"
          ],
          "globals_used": [
            "static DEFINE_SEMAPHORE(console_sem);",
            "static int nr_ext_console_drivers;",
            "static int console_locked, console_suspended;",
            "static struct console *exclusive_console;",
            "static int console_may_schedule;",
            "static int console_msg_format = MSG_FORMAT_DEFAULT;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define printk_time\t\tfalse\n#define CONSOLE_LOG_MAX\t\t0\n#define CONSOLE_LOG_MAX\t\t1024\n\nstatic DEFINE_SEMAPHORE(console_sem);\nstatic int nr_ext_console_drivers;\nstatic int console_locked, console_suspended;\nstatic struct console *exclusive_console;\nstatic int console_may_schedule;\nstatic int console_msg_format = MSG_FORMAT_DEFAULT;\n\nvoid console_unlock(void)\n{\n\tstatic char ext_text[CONSOLE_EXT_LOG_MAX];\n\tstatic char text[CONSOLE_LOG_MAX];\n\tunsigned long flags;\n\tbool do_cond_resched, retry;\n\tstruct printk_info info;\n\tstruct printk_record r;\n\tu64 __maybe_unused next_seq;\n\n\tif (console_suspended) {\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tprb_rec_init_rd(&r, &info, text, sizeof(text));\n\n\t/*\n\t * Console drivers are called with interrupts disabled, so\n\t * @console_may_schedule should be cleared before; however, we may\n\t * end up dumping a lot of lines, for example, if called from\n\t * console registration path, and should invoke cond_resched()\n\t * between lines if allowable.  Not doing so can cause a very long\n\t * scheduling stall on a slow console leading to RCU stall and\n\t * softlockup warnings which exacerbate the issue with more\n\t * messages practically incapacitating the system.\n\t *\n\t * console_trylock() is not able to detect the preemptive\n\t * context reliably. Therefore the value must be stored before\n\t * and cleared after the \"again\" goto label.\n\t */\n\tdo_cond_resched = console_may_schedule;\nagain:\n\tconsole_may_schedule = 0;\n\n\t/*\n\t * We released the console_sem lock, so we need to recheck if\n\t * cpu is online and (if not) is there at least one CON_ANYTIME\n\t * console.\n\t */\n\tif (!can_use_console()) {\n\t\tconsole_locked = 0;\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tfor (;;) {\n\t\tsize_t ext_len = 0;\n\t\tint handover;\n\t\tsize_t len;\n\nskip:\n\t\tif (!prb_read_valid(prb, console_seq, &r))\n\t\t\tbreak;\n\n\t\tif (console_seq != r.info->seq) {\n\t\t\tconsole_dropped += r.info->seq - console_seq;\n\t\t\tconsole_seq = r.info->seq;\n\t\t}\n\n\t\tif (suppress_message_printing(r.info->level)) {\n\t\t\t/*\n\t\t\t * Skip record we have buffered and already printed\n\t\t\t * directly to the console when we received it, and\n\t\t\t * record that has level above the console loglevel.\n\t\t\t */\n\t\t\tconsole_seq++;\n\t\t\tgoto skip;\n\t\t}\n\n\t\t/* Output to all consoles once old messages replayed. */\n\t\tif (unlikely(exclusive_console &&\n\t\t\t     console_seq >= exclusive_console_stop_seq)) {\n\t\t\texclusive_console = NULL;\n\t\t}\n\n\t\t/*\n\t\t * Handle extended console text first because later\n\t\t * record_print_text() will modify the record buffer in-place.\n\t\t */\n\t\tif (nr_ext_console_drivers) {\n\t\t\text_len = info_print_ext_header(ext_text,\n\t\t\t\t\t\tsizeof(ext_text),\n\t\t\t\t\t\tr.info);\n\t\t\text_len += msg_print_ext_body(ext_text + ext_len,\n\t\t\t\t\t\tsizeof(ext_text) - ext_len,\n\t\t\t\t\t\t&r.text_buf[0],\n\t\t\t\t\t\tr.info->text_len,\n\t\t\t\t\t\t&r.info->dev_info);\n\t\t}\n\t\tlen = record_print_text(&r,\n\t\t\t\tconsole_msg_format & MSG_FORMAT_SYSLOG,\n\t\t\t\tprintk_time);\n\t\tconsole_seq++;\n\n\t\t/*\n\t\t * While actively printing out messages, if another printk()\n\t\t * were to occur on another CPU, it may wait for this one to\n\t\t * finish. This task can not be preempted if there is a\n\t\t * waiter waiting to take over.\n\t\t *\n\t\t * Interrupts are disabled because the hand over to a waiter\n\t\t * must not be interrupted until the hand over is completed\n\t\t * (@console_waiter is cleared).\n\t\t */\n\t\tprintk_safe_enter_irqsave(flags);\n\t\tconsole_lock_spinning_enable();\n\n\t\tstop_critical_timings();\t/* don't trace print latency */\n\t\tcall_console_drivers(ext_text, ext_len, text, len);\n\t\tstart_critical_timings();\n\n\t\thandover = console_lock_spinning_disable_and_check();\n\t\tprintk_safe_exit_irqrestore(flags);\n\t\tif (handover)\n\t\t\treturn;\n\n\t\tif (do_cond_resched)\n\t\t\tcond_resched();\n\t}\n\n\t/* Get consistent value of the next-to-be-used sequence number. */\n\tnext_seq = console_seq;\n\n\tconsole_locked = 0;\n\tup_console_sem();\n\n\t/*\n\t * Someone could have filled up the buffer again, so re-check if there's\n\t * something to flush. In case we cannot trylock the console_sem again,\n\t * there's a new owner and the console_unlock() from them will do the\n\t * flush, no worries.\n\t */\n\tretry = prb_read_valid(prb, next_seq, NULL);\n\tif (retry && console_trylock())\n\t\tgoto again;\n}"
        }
      },
      {
        "call_info": {
          "callee": "console_lock",
          "args": [],
          "line": 2769
        },
        "resolved": true,
        "details": {
          "function_name": "is_console_locked",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2554-2557",
          "snippet": "int is_console_locked(void)\n{\n\treturn console_locked;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nint is_console_locked(void)\n{\n\treturn console_locked;\n}"
        }
      },
      {
        "call_info": {
          "callee": "down_trylock_console_sem",
          "args": [],
          "line": 2766
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nint oops_in_progress;\nstatic int console_may_schedule;\n\nvoid console_unblank(void)\n{\n\tstruct console *c;\n\n\t/*\n\t * console_unblank can no longer be called in interrupt context unless\n\t * oops_in_progress is set to 1..\n\t */\n\tif (oops_in_progress) {\n\t\tif (down_trylock_console_sem() != 0)\n\t\t\treturn;\n\t} else\n\t\tconsole_lock();\n\n\tconsole_locked = 1;\n\tconsole_may_schedule = 0;\n\tfor_each_console(c)\n\t\tif ((c->flags & CON_ENABLED) && c->unblank)\n\t\t\tc->unblank();\n\tconsole_unlock();\n}"
  },
  {
    "function_name": "console_conditional_schedule",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2750-2754",
    "snippet": "void __sched console_conditional_schedule(void)\n{\n\tif (console_may_schedule)\n\t\tcond_resched();\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int console_may_schedule;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "cond_resched",
          "args": [],
          "line": 2753
        },
        "resolved": true,
        "details": {
          "function_name": "__cond_resched",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/core.c",
          "lines": "8172-8193",
          "snippet": "int __sched __cond_resched(void)\n{\n\tif (should_resched(0)) {\n\t\tpreempt_schedule_common();\n\t\treturn 1;\n\t}\n\t/*\n\t * In preemptible kernels, ->rcu_read_lock_nesting tells the tick\n\t * whether the current CPU is in an RCU read-side critical section,\n\t * so the tick can report quiescent states even for CPUs looping\n\t * in kernel context.  In contrast, in non-preemptible kernels,\n\t * RCU readers leave no in-memory hints, which means that CPU-bound\n\t * processes executing in kernel context might never report an\n\t * RCU quiescent state.  Therefore, the following code causes\n\t * cond_resched() to report a quiescent state, but only when RCU\n\t * is in urgent need of one.\n\t */\n#ifndef CONFIG_PREEMPT_RCU\n\trcu_all_qs();\n#endif\n\treturn 0;\n}",
          "includes": [
            "#include <linux/entry-common.h>",
            "#include \"features.h\"",
            "#include \"smp.h\"",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../../fs/io-wq.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/scs.h>",
            "#include <linux/kcov.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\"",
            "#include <trace/events/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __sched",
            "static void __sched"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/entry-common.h>\n#include \"features.h\"\n#include \"smp.h\"\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../../fs/io-wq.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/scs.h>\n#include <linux/kcov.h>\n#include <linux/blkdev.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n#include <trace/events/sched.h>\n\nstatic void __sched;\nstatic void __sched;\n\nint __sched __cond_resched(void)\n{\n\tif (should_resched(0)) {\n\t\tpreempt_schedule_common();\n\t\treturn 1;\n\t}\n\t/*\n\t * In preemptible kernels, ->rcu_read_lock_nesting tells the tick\n\t * whether the current CPU is in an RCU read-side critical section,\n\t * so the tick can report quiescent states even for CPUs looping\n\t * in kernel context.  In contrast, in non-preemptible kernels,\n\t * RCU readers leave no in-memory hints, which means that CPU-bound\n\t * processes executing in kernel context might never report an\n\t * RCU quiescent state.  Therefore, the following code causes\n\t * cond_resched() to report a quiescent state, but only when RCU\n\t * is in urgent need of one.\n\t */\n#ifndef CONFIG_PREEMPT_RCU\n\trcu_all_qs();\n#endif\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic int console_may_schedule;\n\nvoid __sched console_conditional_schedule(void)\n{\n\tif (console_may_schedule)\n\t\tcond_resched();\n}"
  },
  {
    "function_name": "console_unlock",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2602-2738",
    "snippet": "void console_unlock(void)\n{\n\tstatic char ext_text[CONSOLE_EXT_LOG_MAX];\n\tstatic char text[CONSOLE_LOG_MAX];\n\tunsigned long flags;\n\tbool do_cond_resched, retry;\n\tstruct printk_info info;\n\tstruct printk_record r;\n\tu64 __maybe_unused next_seq;\n\n\tif (console_suspended) {\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tprb_rec_init_rd(&r, &info, text, sizeof(text));\n\n\t/*\n\t * Console drivers are called with interrupts disabled, so\n\t * @console_may_schedule should be cleared before; however, we may\n\t * end up dumping a lot of lines, for example, if called from\n\t * console registration path, and should invoke cond_resched()\n\t * between lines if allowable.  Not doing so can cause a very long\n\t * scheduling stall on a slow console leading to RCU stall and\n\t * softlockup warnings which exacerbate the issue with more\n\t * messages practically incapacitating the system.\n\t *\n\t * console_trylock() is not able to detect the preemptive\n\t * context reliably. Therefore the value must be stored before\n\t * and cleared after the \"again\" goto label.\n\t */\n\tdo_cond_resched = console_may_schedule;\nagain:\n\tconsole_may_schedule = 0;\n\n\t/*\n\t * We released the console_sem lock, so we need to recheck if\n\t * cpu is online and (if not) is there at least one CON_ANYTIME\n\t * console.\n\t */\n\tif (!can_use_console()) {\n\t\tconsole_locked = 0;\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tfor (;;) {\n\t\tsize_t ext_len = 0;\n\t\tint handover;\n\t\tsize_t len;\n\nskip:\n\t\tif (!prb_read_valid(prb, console_seq, &r))\n\t\t\tbreak;\n\n\t\tif (console_seq != r.info->seq) {\n\t\t\tconsole_dropped += r.info->seq - console_seq;\n\t\t\tconsole_seq = r.info->seq;\n\t\t}\n\n\t\tif (suppress_message_printing(r.info->level)) {\n\t\t\t/*\n\t\t\t * Skip record we have buffered and already printed\n\t\t\t * directly to the console when we received it, and\n\t\t\t * record that has level above the console loglevel.\n\t\t\t */\n\t\t\tconsole_seq++;\n\t\t\tgoto skip;\n\t\t}\n\n\t\t/* Output to all consoles once old messages replayed. */\n\t\tif (unlikely(exclusive_console &&\n\t\t\t     console_seq >= exclusive_console_stop_seq)) {\n\t\t\texclusive_console = NULL;\n\t\t}\n\n\t\t/*\n\t\t * Handle extended console text first because later\n\t\t * record_print_text() will modify the record buffer in-place.\n\t\t */\n\t\tif (nr_ext_console_drivers) {\n\t\t\text_len = info_print_ext_header(ext_text,\n\t\t\t\t\t\tsizeof(ext_text),\n\t\t\t\t\t\tr.info);\n\t\t\text_len += msg_print_ext_body(ext_text + ext_len,\n\t\t\t\t\t\tsizeof(ext_text) - ext_len,\n\t\t\t\t\t\t&r.text_buf[0],\n\t\t\t\t\t\tr.info->text_len,\n\t\t\t\t\t\t&r.info->dev_info);\n\t\t}\n\t\tlen = record_print_text(&r,\n\t\t\t\tconsole_msg_format & MSG_FORMAT_SYSLOG,\n\t\t\t\tprintk_time);\n\t\tconsole_seq++;\n\n\t\t/*\n\t\t * While actively printing out messages, if another printk()\n\t\t * were to occur on another CPU, it may wait for this one to\n\t\t * finish. This task can not be preempted if there is a\n\t\t * waiter waiting to take over.\n\t\t *\n\t\t * Interrupts are disabled because the hand over to a waiter\n\t\t * must not be interrupted until the hand over is completed\n\t\t * (@console_waiter is cleared).\n\t\t */\n\t\tprintk_safe_enter_irqsave(flags);\n\t\tconsole_lock_spinning_enable();\n\n\t\tstop_critical_timings();\t/* don't trace print latency */\n\t\tcall_console_drivers(ext_text, ext_len, text, len);\n\t\tstart_critical_timings();\n\n\t\thandover = console_lock_spinning_disable_and_check();\n\t\tprintk_safe_exit_irqrestore(flags);\n\t\tif (handover)\n\t\t\treturn;\n\n\t\tif (do_cond_resched)\n\t\t\tcond_resched();\n\t}\n\n\t/* Get consistent value of the next-to-be-used sequence number. */\n\tnext_seq = console_seq;\n\n\tconsole_locked = 0;\n\tup_console_sem();\n\n\t/*\n\t * Someone could have filled up the buffer again, so re-check if there's\n\t * something to flush. In case we cannot trylock the console_sem again,\n\t * there's a new owner and the console_unlock() from them will do the\n\t * flush, no worries.\n\t */\n\tretry = prb_read_valid(prb, next_seq, NULL);\n\tif (retry && console_trylock())\n\t\tgoto again;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define printk_time\t\tfalse",
      "#define CONSOLE_LOG_MAX\t\t0",
      "#define CONSOLE_LOG_MAX\t\t1024"
    ],
    "globals_used": [
      "static DEFINE_SEMAPHORE(console_sem);",
      "static int nr_ext_console_drivers;",
      "static int console_locked, console_suspended;",
      "static struct console *exclusive_console;",
      "static int console_may_schedule;",
      "static int console_msg_format = MSG_FORMAT_DEFAULT;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "console_trylock",
          "args": [],
          "line": 2736
        },
        "resolved": true,
        "details": {
          "function_name": "console_trylock",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2540-2551",
          "snippet": "int console_trylock(void)\n{\n\tif (down_trylock_console_sem())\n\t\treturn 0;\n\tif (console_suspended) {\n\t\tup_console_sem();\n\t\treturn 0;\n\t}\n\tconsole_locked = 1;\n\tconsole_may_schedule = 0;\n\treturn 1;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int console_locked, console_suspended;",
            "static int console_may_schedule;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic int console_locked, console_suspended;\nstatic int console_may_schedule;\n\nint console_trylock(void)\n{\n\tif (down_trylock_console_sem())\n\t\treturn 0;\n\tif (console_suspended) {\n\t\tup_console_sem();\n\t\treturn 0;\n\t}\n\tconsole_locked = 1;\n\tconsole_may_schedule = 0;\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prb_read_valid",
          "args": [
            "prb",
            "next_seq",
            "NULL"
          ],
          "line": 2735
        },
        "resolved": true,
        "details": {
          "function_name": "prb_read_valid",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk_ringbuffer.c",
          "lines": "1926-1930",
          "snippet": "bool prb_read_valid(struct printk_ringbuffer *rb, u64 seq,\n\t\t    struct printk_record *r)\n{\n\treturn _prb_read_valid(rb, &seq, r, NULL);\n}",
          "includes": [
            "#include \"printk_ringbuffer.h\"",
            "#include <linux/bug.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/irqflags.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"printk_ringbuffer.h\"\n#include <linux/bug.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/irqflags.h>\n#include <linux/kernel.h>\n\nbool prb_read_valid(struct printk_ringbuffer *rb, u64 seq,\n\t\t    struct printk_record *r)\n{\n\treturn _prb_read_valid(rb, &seq, r, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "up_console_sem",
          "args": [],
          "line": 2727
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cond_resched",
          "args": [],
          "line": 2720
        },
        "resolved": true,
        "details": {
          "function_name": "__cond_resched",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/core.c",
          "lines": "8172-8193",
          "snippet": "int __sched __cond_resched(void)\n{\n\tif (should_resched(0)) {\n\t\tpreempt_schedule_common();\n\t\treturn 1;\n\t}\n\t/*\n\t * In preemptible kernels, ->rcu_read_lock_nesting tells the tick\n\t * whether the current CPU is in an RCU read-side critical section,\n\t * so the tick can report quiescent states even for CPUs looping\n\t * in kernel context.  In contrast, in non-preemptible kernels,\n\t * RCU readers leave no in-memory hints, which means that CPU-bound\n\t * processes executing in kernel context might never report an\n\t * RCU quiescent state.  Therefore, the following code causes\n\t * cond_resched() to report a quiescent state, but only when RCU\n\t * is in urgent need of one.\n\t */\n#ifndef CONFIG_PREEMPT_RCU\n\trcu_all_qs();\n#endif\n\treturn 0;\n}",
          "includes": [
            "#include <linux/entry-common.h>",
            "#include \"features.h\"",
            "#include \"smp.h\"",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../../fs/io-wq.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/scs.h>",
            "#include <linux/kcov.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\"",
            "#include <trace/events/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __sched",
            "static void __sched"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/entry-common.h>\n#include \"features.h\"\n#include \"smp.h\"\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../../fs/io-wq.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/scs.h>\n#include <linux/kcov.h>\n#include <linux/blkdev.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n#include <trace/events/sched.h>\n\nstatic void __sched;\nstatic void __sched;\n\nint __sched __cond_resched(void)\n{\n\tif (should_resched(0)) {\n\t\tpreempt_schedule_common();\n\t\treturn 1;\n\t}\n\t/*\n\t * In preemptible kernels, ->rcu_read_lock_nesting tells the tick\n\t * whether the current CPU is in an RCU read-side critical section,\n\t * so the tick can report quiescent states even for CPUs looping\n\t * in kernel context.  In contrast, in non-preemptible kernels,\n\t * RCU readers leave no in-memory hints, which means that CPU-bound\n\t * processes executing in kernel context might never report an\n\t * RCU quiescent state.  Therefore, the following code causes\n\t * cond_resched() to report a quiescent state, but only when RCU\n\t * is in urgent need of one.\n\t */\n#ifndef CONFIG_PREEMPT_RCU\n\trcu_all_qs();\n#endif\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk_safe_exit_irqrestore",
          "args": [
            "flags"
          ],
          "line": 2715
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "console_lock_spinning_disable_and_check",
          "args": [],
          "line": 2714
        },
        "resolved": true,
        "details": {
          "function_name": "console_lock_spinning_disable_and_check",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2300-2300",
          "snippet": "static int console_lock_spinning_disable_and_check(void) { return 0; }",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic int console_lock_spinning_disable_and_check(void) { return 0; }"
        }
      },
      {
        "call_info": {
          "callee": "start_critical_timings",
          "args": [],
          "line": 2712
        },
        "resolved": true,
        "details": {
          "function_name": "start_critical_timings",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/trace/trace_irqsoff.c",
          "lines": "437-441",
          "snippet": "void start_critical_timings(void)\n{\n\tif (preempt_trace(preempt_count()) || irq_trace())\n\t\tstart_critical_timing(CALLER_ADDR0, CALLER_ADDR1);\n}",
          "includes": [
            "#include <trace/events/preemptirq.h>",
            "#include \"trace.h\"",
            "#include <linux/kprobes.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/module.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/kallsyms.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/preemptirq.h>\n#include \"trace.h\"\n#include <linux/kprobes.h>\n#include <linux/ftrace.h>\n#include <linux/module.h>\n#include <linux/uaccess.h>\n#include <linux/kallsyms.h>\n\nvoid start_critical_timings(void)\n{\n\tif (preempt_trace(preempt_count()) || irq_trace())\n\t\tstart_critical_timing(CALLER_ADDR0, CALLER_ADDR1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "call_console_drivers",
          "args": [
            "ext_text",
            "ext_len",
            "text",
            "len"
          ],
          "line": 2711
        },
        "resolved": true,
        "details": {
          "function_name": "call_console_drivers",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2301-2302",
          "snippet": "static void call_console_drivers(const char *ext_text, size_t ext_len,\n\t\t\t\t const char *text, size_t len) {}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic void call_console_drivers(const char *ext_text, size_t ext_len,\n\t\t\t\t const char *text, size_t len) {}"
        }
      },
      {
        "call_info": {
          "callee": "stop_critical_timings",
          "args": [],
          "line": 2710
        },
        "resolved": true,
        "details": {
          "function_name": "stop_critical_timings",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/trace/trace_irqsoff.c",
          "lines": "445-449",
          "snippet": "void stop_critical_timings(void)\n{\n\tif (preempt_trace(preempt_count()) || irq_trace())\n\t\tstop_critical_timing(CALLER_ADDR0, CALLER_ADDR1);\n}",
          "includes": [
            "#include <trace/events/preemptirq.h>",
            "#include \"trace.h\"",
            "#include <linux/kprobes.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/module.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/kallsyms.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/preemptirq.h>\n#include \"trace.h\"\n#include <linux/kprobes.h>\n#include <linux/ftrace.h>\n#include <linux/module.h>\n#include <linux/uaccess.h>\n#include <linux/kallsyms.h>\n\nvoid stop_critical_timings(void)\n{\n\tif (preempt_trace(preempt_count()) || irq_trace())\n\t\tstop_critical_timing(CALLER_ADDR0, CALLER_ADDR1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "console_lock_spinning_enable",
          "args": [],
          "line": 2708
        },
        "resolved": true,
        "details": {
          "function_name": "console_lock_spinning_enable",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2299-2299",
          "snippet": "static void console_lock_spinning_enable(void) { }",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic void console_lock_spinning_enable(void) { }"
        }
      },
      {
        "call_info": {
          "callee": "printk_safe_enter_irqsave",
          "args": [
            "flags"
          ],
          "line": 2707
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "record_print_text",
          "args": [
            "&r",
            "console_msg_format & MSG_FORMAT_SYSLOG",
            "printk_time"
          ],
          "line": 2692
        },
        "resolved": true,
        "details": {
          "function_name": "record_print_text",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2286-2290",
          "snippet": "static size_t record_print_text(const struct printk_record *r,\n\t\t\t\tbool syslog, bool time)\n{\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic size_t record_print_text(const struct printk_record *r,\n\t\t\t\tbool syslog, bool time)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "msg_print_ext_body",
          "args": [
            "ext_text + ext_len",
            "sizeof(ext_text) - ext_len",
            "&r.text_buf[0]",
            "r.info->text_len",
            "&r.info->dev_info"
          ],
          "line": 2686
        },
        "resolved": true,
        "details": {
          "function_name": "msg_print_ext_body",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2296-2298",
          "snippet": "static ssize_t msg_print_ext_body(char *buf, size_t size,\n\t\t\t\t  char *text, size_t text_len,\n\t\t\t\t  struct dev_printk_info *dev_info) { return 0; }",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic ssize_t msg_print_ext_body(char *buf, size_t size,\n\t\t\t\t  char *text, size_t text_len,\n\t\t\t\t  struct dev_printk_info *dev_info) { return 0; }"
        }
      },
      {
        "call_info": {
          "callee": "info_print_ext_header",
          "args": [
            "ext_text",
            "sizeof(ext_text)",
            "r.info"
          ],
          "line": 2683
        },
        "resolved": true,
        "details": {
          "function_name": "info_print_ext_header",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2291-2295",
          "snippet": "static ssize_t info_print_ext_header(char *buf, size_t size,\n\t\t\t\t     struct printk_info *info)\n{\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic ssize_t info_print_ext_header(char *buf, size_t size,\n\t\t\t\t     struct printk_info *info)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "exclusive_console &&\n\t\t\t     console_seq >= exclusive_console_stop_seq"
          ],
          "line": 2673
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "suppress_message_printing",
          "args": [
            "r.info->level"
          ],
          "line": 2662
        },
        "resolved": true,
        "details": {
          "function_name": "suppress_message_printing",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2303-2303",
          "snippet": "static bool suppress_message_printing(int level) { return false; }",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic bool suppress_message_printing(int level) { return false; }"
        }
      },
      {
        "call_info": {
          "callee": "up_console_sem",
          "args": [],
          "line": 2644
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "can_use_console",
          "args": [],
          "line": 2642
        },
        "resolved": true,
        "details": {
          "function_name": "can_use_console",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2583-2586",
          "snippet": "static inline int can_use_console(void)\n{\n\treturn cpu_online(raw_smp_processor_id()) || have_callable_console();\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic inline int can_use_console(void)\n{\n\treturn cpu_online(raw_smp_processor_id()) || have_callable_console();\n}"
        }
      },
      {
        "call_info": {
          "callee": "prb_rec_init_rd",
          "args": [
            "&r",
            "&info",
            "text",
            "sizeof(text)"
          ],
          "line": 2617
        },
        "resolved": true,
        "details": {
          "function_name": "prb_rec_init_rd",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk_ringbuffer.h",
          "lines": "330-337",
          "snippet": "static inline void prb_rec_init_rd(struct printk_record *r,\n\t\t\t\t   struct printk_info *info,\n\t\t\t\t   char *text_buf, unsigned int text_buf_size)\n{\n\tr->info = info;\n\tr->text_buf = text_buf;\n\tr->text_buf_size = text_buf_size;\n}",
          "includes": [
            "#include <linux/dev_printk.h>",
            "#include <linux/atomic.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/dev_printk.h>\n#include <linux/atomic.h>\n\nstatic inline void prb_rec_init_rd(struct printk_record *r,\n\t\t\t\t   struct printk_info *info,\n\t\t\t\t   char *text_buf, unsigned int text_buf_size)\n{\n\tr->info = info;\n\tr->text_buf = text_buf;\n\tr->text_buf_size = text_buf_size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "up_console_sem",
          "args": [],
          "line": 2613
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define printk_time\t\tfalse\n#define CONSOLE_LOG_MAX\t\t0\n#define CONSOLE_LOG_MAX\t\t1024\n\nstatic DEFINE_SEMAPHORE(console_sem);\nstatic int nr_ext_console_drivers;\nstatic int console_locked, console_suspended;\nstatic struct console *exclusive_console;\nstatic int console_may_schedule;\nstatic int console_msg_format = MSG_FORMAT_DEFAULT;\n\nvoid console_unlock(void)\n{\n\tstatic char ext_text[CONSOLE_EXT_LOG_MAX];\n\tstatic char text[CONSOLE_LOG_MAX];\n\tunsigned long flags;\n\tbool do_cond_resched, retry;\n\tstruct printk_info info;\n\tstruct printk_record r;\n\tu64 __maybe_unused next_seq;\n\n\tif (console_suspended) {\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tprb_rec_init_rd(&r, &info, text, sizeof(text));\n\n\t/*\n\t * Console drivers are called with interrupts disabled, so\n\t * @console_may_schedule should be cleared before; however, we may\n\t * end up dumping a lot of lines, for example, if called from\n\t * console registration path, and should invoke cond_resched()\n\t * between lines if allowable.  Not doing so can cause a very long\n\t * scheduling stall on a slow console leading to RCU stall and\n\t * softlockup warnings which exacerbate the issue with more\n\t * messages practically incapacitating the system.\n\t *\n\t * console_trylock() is not able to detect the preemptive\n\t * context reliably. Therefore the value must be stored before\n\t * and cleared after the \"again\" goto label.\n\t */\n\tdo_cond_resched = console_may_schedule;\nagain:\n\tconsole_may_schedule = 0;\n\n\t/*\n\t * We released the console_sem lock, so we need to recheck if\n\t * cpu is online and (if not) is there at least one CON_ANYTIME\n\t * console.\n\t */\n\tif (!can_use_console()) {\n\t\tconsole_locked = 0;\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tfor (;;) {\n\t\tsize_t ext_len = 0;\n\t\tint handover;\n\t\tsize_t len;\n\nskip:\n\t\tif (!prb_read_valid(prb, console_seq, &r))\n\t\t\tbreak;\n\n\t\tif (console_seq != r.info->seq) {\n\t\t\tconsole_dropped += r.info->seq - console_seq;\n\t\t\tconsole_seq = r.info->seq;\n\t\t}\n\n\t\tif (suppress_message_printing(r.info->level)) {\n\t\t\t/*\n\t\t\t * Skip record we have buffered and already printed\n\t\t\t * directly to the console when we received it, and\n\t\t\t * record that has level above the console loglevel.\n\t\t\t */\n\t\t\tconsole_seq++;\n\t\t\tgoto skip;\n\t\t}\n\n\t\t/* Output to all consoles once old messages replayed. */\n\t\tif (unlikely(exclusive_console &&\n\t\t\t     console_seq >= exclusive_console_stop_seq)) {\n\t\t\texclusive_console = NULL;\n\t\t}\n\n\t\t/*\n\t\t * Handle extended console text first because later\n\t\t * record_print_text() will modify the record buffer in-place.\n\t\t */\n\t\tif (nr_ext_console_drivers) {\n\t\t\text_len = info_print_ext_header(ext_text,\n\t\t\t\t\t\tsizeof(ext_text),\n\t\t\t\t\t\tr.info);\n\t\t\text_len += msg_print_ext_body(ext_text + ext_len,\n\t\t\t\t\t\tsizeof(ext_text) - ext_len,\n\t\t\t\t\t\t&r.text_buf[0],\n\t\t\t\t\t\tr.info->text_len,\n\t\t\t\t\t\t&r.info->dev_info);\n\t\t}\n\t\tlen = record_print_text(&r,\n\t\t\t\tconsole_msg_format & MSG_FORMAT_SYSLOG,\n\t\t\t\tprintk_time);\n\t\tconsole_seq++;\n\n\t\t/*\n\t\t * While actively printing out messages, if another printk()\n\t\t * were to occur on another CPU, it may wait for this one to\n\t\t * finish. This task can not be preempted if there is a\n\t\t * waiter waiting to take over.\n\t\t *\n\t\t * Interrupts are disabled because the hand over to a waiter\n\t\t * must not be interrupted until the hand over is completed\n\t\t * (@console_waiter is cleared).\n\t\t */\n\t\tprintk_safe_enter_irqsave(flags);\n\t\tconsole_lock_spinning_enable();\n\n\t\tstop_critical_timings();\t/* don't trace print latency */\n\t\tcall_console_drivers(ext_text, ext_len, text, len);\n\t\tstart_critical_timings();\n\n\t\thandover = console_lock_spinning_disable_and_check();\n\t\tprintk_safe_exit_irqrestore(flags);\n\t\tif (handover)\n\t\t\treturn;\n\n\t\tif (do_cond_resched)\n\t\t\tcond_resched();\n\t}\n\n\t/* Get consistent value of the next-to-be-used sequence number. */\n\tnext_seq = console_seq;\n\n\tconsole_locked = 0;\n\tup_console_sem();\n\n\t/*\n\t * Someone could have filled up the buffer again, so re-check if there's\n\t * something to flush. In case we cannot trylock the console_sem again,\n\t * there's a new owner and the console_unlock() from them will do the\n\t * flush, no worries.\n\t */\n\tretry = prb_read_valid(prb, next_seq, NULL);\n\tif (retry && console_trylock())\n\t\tgoto again;\n}"
  },
  {
    "function_name": "can_use_console",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2583-2586",
    "snippet": "static inline int can_use_console(void)\n{\n\treturn cpu_online(raw_smp_processor_id()) || have_callable_console();\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "have_callable_console",
          "args": [],
          "line": 2585
        },
        "resolved": true,
        "details": {
          "function_name": "have_callable_console",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2564-2574",
          "snippet": "static int have_callable_console(void)\n{\n\tstruct console *con;\n\n\tfor_each_console(con)\n\t\tif ((con->flags & CON_ENABLED) &&\n\t\t\t\t(con->flags & CON_ANYTIME))\n\t\t\treturn 1;\n\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic int have_callable_console(void)\n{\n\tstruct console *con;\n\n\tfor_each_console(con)\n\t\tif ((con->flags & CON_ENABLED) &&\n\t\t\t\t(con->flags & CON_ANYTIME))\n\t\t\treturn 1;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "cpu_online",
          "args": [
            "raw_smp_processor_id()"
          ],
          "line": 2585
        },
        "resolved": true,
        "details": {
          "function_name": "init_cpu_online",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cpu.c",
          "lines": "2616-2619",
          "snippet": "void init_cpu_online(const struct cpumask *src)\n{\n\tcpumask_copy(&__cpu_online_mask, src);\n}",
          "includes": [
            "#include \"smpboot.h\"",
            "#include <trace/events/cpuhp.h>",
            "#include <trace/events/power.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/percpu-rwsem.h>",
            "#include <linux/scs.h>",
            "#include <linux/slab.h>",
            "#include <linux/relay.h>",
            "#include <linux/smpboot.h>",
            "#include <linux/nmi.h>",
            "#include <linux/irq.h>",
            "#include <linux/tick.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/suspend.h>",
            "#include <linux/gfp.h>",
            "#include <linux/mutex.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/kthread.h>",
            "#include <linux/bug.h>",
            "#include <linux/export.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/oom.h>",
            "#include <linux/cpu.h>",
            "#include <linux/unistd.h>",
            "#include <linux/sched/smt.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/sched/hotplug.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/notifier.h>",
            "#include <linux/init.h>",
            "#include <linux/smp.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/sched/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct cpumask __cpu_online_mask"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"smpboot.h\"\n#include <trace/events/cpuhp.h>\n#include <trace/events/power.h>\n#include <linux/cpuset.h>\n#include <linux/percpu-rwsem.h>\n#include <linux/scs.h>\n#include <linux/slab.h>\n#include <linux/relay.h>\n#include <linux/smpboot.h>\n#include <linux/nmi.h>\n#include <linux/irq.h>\n#include <linux/tick.h>\n#include <linux/lockdep.h>\n#include <linux/suspend.h>\n#include <linux/gfp.h>\n#include <linux/mutex.h>\n#include <linux/stop_machine.h>\n#include <linux/kthread.h>\n#include <linux/bug.h>\n#include <linux/export.h>\n#include <linux/rcupdate.h>\n#include <linux/oom.h>\n#include <linux/cpu.h>\n#include <linux/unistd.h>\n#include <linux/sched/smt.h>\n#include <linux/sched/task.h>\n#include <linux/sched/isolation.h>\n#include <linux/sched/hotplug.h>\n#include <linux/sched/signal.h>\n#include <linux/notifier.h>\n#include <linux/init.h>\n#include <linux/smp.h>\n#include <linux/proc_fs.h>\n#include <linux/sched/mm.h>\n\nstruct cpumask __cpu_online_mask;\n\nvoid init_cpu_online(const struct cpumask *src)\n{\n\tcpumask_copy(&__cpu_online_mask, src);\n}"
        }
      },
      {
        "call_info": {
          "callee": "raw_smp_processor_id",
          "args": [],
          "line": 2585
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic inline int can_use_console(void)\n{\n\treturn cpu_online(raw_smp_processor_id()) || have_callable_console();\n}"
  },
  {
    "function_name": "have_callable_console",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2564-2574",
    "snippet": "static int have_callable_console(void)\n{\n\tstruct console *con;\n\n\tfor_each_console(con)\n\t\tif ((con->flags & CON_ENABLED) &&\n\t\t\t\t(con->flags & CON_ANYTIME))\n\t\t\treturn 1;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic int have_callable_console(void)\n{\n\tstruct console *con;\n\n\tfor_each_console(con)\n\t\tif ((con->flags & CON_ENABLED) &&\n\t\t\t\t(con->flags & CON_ANYTIME))\n\t\t\treturn 1;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "is_console_locked",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2554-2557",
    "snippet": "int is_console_locked(void)\n{\n\treturn console_locked;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nint is_console_locked(void)\n{\n\treturn console_locked;\n}"
  },
  {
    "function_name": "console_trylock",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2540-2551",
    "snippet": "int console_trylock(void)\n{\n\tif (down_trylock_console_sem())\n\t\treturn 0;\n\tif (console_suspended) {\n\t\tup_console_sem();\n\t\treturn 0;\n\t}\n\tconsole_locked = 1;\n\tconsole_may_schedule = 0;\n\treturn 1;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int console_locked, console_suspended;",
      "static int console_may_schedule;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "up_console_sem",
          "args": [],
          "line": 2545
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "down_trylock_console_sem",
          "args": [],
          "line": 2542
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic int console_locked, console_suspended;\nstatic int console_may_schedule;\n\nint console_trylock(void)\n{\n\tif (down_trylock_console_sem())\n\t\treturn 0;\n\tif (console_suspended) {\n\t\tup_console_sem();\n\t\treturn 0;\n\t}\n\tconsole_locked = 1;\n\tconsole_may_schedule = 0;\n\treturn 1;\n}"
  },
  {
    "function_name": "console_lock",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2520-2529",
    "snippet": "void console_lock(void)\n{\n\tmight_sleep();\n\n\tdown_console_sem();\n\tif (console_suspended)\n\t\treturn;\n\tconsole_locked = 1;\n\tconsole_may_schedule = 1;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int console_locked, console_suspended;",
      "static int console_may_schedule;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "down_console_sem",
          "args": [],
          "line": 2524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "might_sleep",
          "args": [],
          "line": 2522
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic int console_locked, console_suspended;\nstatic int console_may_schedule;\n\nvoid console_lock(void)\n{\n\tmight_sleep();\n\n\tdown_console_sem();\n\tif (console_suspended)\n\t\treturn;\n\tconsole_locked = 1;\n\tconsole_may_schedule = 1;\n}"
  },
  {
    "function_name": "console_cpu_notify",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2502-2510",
    "snippet": "static int console_cpu_notify(unsigned int cpu)\n{\n\tif (!cpuhp_tasks_frozen) {\n\t\t/* If trylock fails, someone else is doing the printing */\n\t\tif (console_trylock())\n\t\t\tconsole_unlock();\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "console_unlock",
          "args": [],
          "line": 2507
        },
        "resolved": true,
        "details": {
          "function_name": "console_unlock",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2602-2738",
          "snippet": "void console_unlock(void)\n{\n\tstatic char ext_text[CONSOLE_EXT_LOG_MAX];\n\tstatic char text[CONSOLE_LOG_MAX];\n\tunsigned long flags;\n\tbool do_cond_resched, retry;\n\tstruct printk_info info;\n\tstruct printk_record r;\n\tu64 __maybe_unused next_seq;\n\n\tif (console_suspended) {\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tprb_rec_init_rd(&r, &info, text, sizeof(text));\n\n\t/*\n\t * Console drivers are called with interrupts disabled, so\n\t * @console_may_schedule should be cleared before; however, we may\n\t * end up dumping a lot of lines, for example, if called from\n\t * console registration path, and should invoke cond_resched()\n\t * between lines if allowable.  Not doing so can cause a very long\n\t * scheduling stall on a slow console leading to RCU stall and\n\t * softlockup warnings which exacerbate the issue with more\n\t * messages practically incapacitating the system.\n\t *\n\t * console_trylock() is not able to detect the preemptive\n\t * context reliably. Therefore the value must be stored before\n\t * and cleared after the \"again\" goto label.\n\t */\n\tdo_cond_resched = console_may_schedule;\nagain:\n\tconsole_may_schedule = 0;\n\n\t/*\n\t * We released the console_sem lock, so we need to recheck if\n\t * cpu is online and (if not) is there at least one CON_ANYTIME\n\t * console.\n\t */\n\tif (!can_use_console()) {\n\t\tconsole_locked = 0;\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tfor (;;) {\n\t\tsize_t ext_len = 0;\n\t\tint handover;\n\t\tsize_t len;\n\nskip:\n\t\tif (!prb_read_valid(prb, console_seq, &r))\n\t\t\tbreak;\n\n\t\tif (console_seq != r.info->seq) {\n\t\t\tconsole_dropped += r.info->seq - console_seq;\n\t\t\tconsole_seq = r.info->seq;\n\t\t}\n\n\t\tif (suppress_message_printing(r.info->level)) {\n\t\t\t/*\n\t\t\t * Skip record we have buffered and already printed\n\t\t\t * directly to the console when we received it, and\n\t\t\t * record that has level above the console loglevel.\n\t\t\t */\n\t\t\tconsole_seq++;\n\t\t\tgoto skip;\n\t\t}\n\n\t\t/* Output to all consoles once old messages replayed. */\n\t\tif (unlikely(exclusive_console &&\n\t\t\t     console_seq >= exclusive_console_stop_seq)) {\n\t\t\texclusive_console = NULL;\n\t\t}\n\n\t\t/*\n\t\t * Handle extended console text first because later\n\t\t * record_print_text() will modify the record buffer in-place.\n\t\t */\n\t\tif (nr_ext_console_drivers) {\n\t\t\text_len = info_print_ext_header(ext_text,\n\t\t\t\t\t\tsizeof(ext_text),\n\t\t\t\t\t\tr.info);\n\t\t\text_len += msg_print_ext_body(ext_text + ext_len,\n\t\t\t\t\t\tsizeof(ext_text) - ext_len,\n\t\t\t\t\t\t&r.text_buf[0],\n\t\t\t\t\t\tr.info->text_len,\n\t\t\t\t\t\t&r.info->dev_info);\n\t\t}\n\t\tlen = record_print_text(&r,\n\t\t\t\tconsole_msg_format & MSG_FORMAT_SYSLOG,\n\t\t\t\tprintk_time);\n\t\tconsole_seq++;\n\n\t\t/*\n\t\t * While actively printing out messages, if another printk()\n\t\t * were to occur on another CPU, it may wait for this one to\n\t\t * finish. This task can not be preempted if there is a\n\t\t * waiter waiting to take over.\n\t\t *\n\t\t * Interrupts are disabled because the hand over to a waiter\n\t\t * must not be interrupted until the hand over is completed\n\t\t * (@console_waiter is cleared).\n\t\t */\n\t\tprintk_safe_enter_irqsave(flags);\n\t\tconsole_lock_spinning_enable();\n\n\t\tstop_critical_timings();\t/* don't trace print latency */\n\t\tcall_console_drivers(ext_text, ext_len, text, len);\n\t\tstart_critical_timings();\n\n\t\thandover = console_lock_spinning_disable_and_check();\n\t\tprintk_safe_exit_irqrestore(flags);\n\t\tif (handover)\n\t\t\treturn;\n\n\t\tif (do_cond_resched)\n\t\t\tcond_resched();\n\t}\n\n\t/* Get consistent value of the next-to-be-used sequence number. */\n\tnext_seq = console_seq;\n\n\tconsole_locked = 0;\n\tup_console_sem();\n\n\t/*\n\t * Someone could have filled up the buffer again, so re-check if there's\n\t * something to flush. In case we cannot trylock the console_sem again,\n\t * there's a new owner and the console_unlock() from them will do the\n\t * flush, no worries.\n\t */\n\tretry = prb_read_valid(prb, next_seq, NULL);\n\tif (retry && console_trylock())\n\t\tgoto again;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define printk_time\t\tfalse",
            "#define CONSOLE_LOG_MAX\t\t0",
            "#define CONSOLE_LOG_MAX\t\t1024"
          ],
          "globals_used": [
            "static DEFINE_SEMAPHORE(console_sem);",
            "static int nr_ext_console_drivers;",
            "static int console_locked, console_suspended;",
            "static struct console *exclusive_console;",
            "static int console_may_schedule;",
            "static int console_msg_format = MSG_FORMAT_DEFAULT;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define printk_time\t\tfalse\n#define CONSOLE_LOG_MAX\t\t0\n#define CONSOLE_LOG_MAX\t\t1024\n\nstatic DEFINE_SEMAPHORE(console_sem);\nstatic int nr_ext_console_drivers;\nstatic int console_locked, console_suspended;\nstatic struct console *exclusive_console;\nstatic int console_may_schedule;\nstatic int console_msg_format = MSG_FORMAT_DEFAULT;\n\nvoid console_unlock(void)\n{\n\tstatic char ext_text[CONSOLE_EXT_LOG_MAX];\n\tstatic char text[CONSOLE_LOG_MAX];\n\tunsigned long flags;\n\tbool do_cond_resched, retry;\n\tstruct printk_info info;\n\tstruct printk_record r;\n\tu64 __maybe_unused next_seq;\n\n\tif (console_suspended) {\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tprb_rec_init_rd(&r, &info, text, sizeof(text));\n\n\t/*\n\t * Console drivers are called with interrupts disabled, so\n\t * @console_may_schedule should be cleared before; however, we may\n\t * end up dumping a lot of lines, for example, if called from\n\t * console registration path, and should invoke cond_resched()\n\t * between lines if allowable.  Not doing so can cause a very long\n\t * scheduling stall on a slow console leading to RCU stall and\n\t * softlockup warnings which exacerbate the issue with more\n\t * messages practically incapacitating the system.\n\t *\n\t * console_trylock() is not able to detect the preemptive\n\t * context reliably. Therefore the value must be stored before\n\t * and cleared after the \"again\" goto label.\n\t */\n\tdo_cond_resched = console_may_schedule;\nagain:\n\tconsole_may_schedule = 0;\n\n\t/*\n\t * We released the console_sem lock, so we need to recheck if\n\t * cpu is online and (if not) is there at least one CON_ANYTIME\n\t * console.\n\t */\n\tif (!can_use_console()) {\n\t\tconsole_locked = 0;\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tfor (;;) {\n\t\tsize_t ext_len = 0;\n\t\tint handover;\n\t\tsize_t len;\n\nskip:\n\t\tif (!prb_read_valid(prb, console_seq, &r))\n\t\t\tbreak;\n\n\t\tif (console_seq != r.info->seq) {\n\t\t\tconsole_dropped += r.info->seq - console_seq;\n\t\t\tconsole_seq = r.info->seq;\n\t\t}\n\n\t\tif (suppress_message_printing(r.info->level)) {\n\t\t\t/*\n\t\t\t * Skip record we have buffered and already printed\n\t\t\t * directly to the console when we received it, and\n\t\t\t * record that has level above the console loglevel.\n\t\t\t */\n\t\t\tconsole_seq++;\n\t\t\tgoto skip;\n\t\t}\n\n\t\t/* Output to all consoles once old messages replayed. */\n\t\tif (unlikely(exclusive_console &&\n\t\t\t     console_seq >= exclusive_console_stop_seq)) {\n\t\t\texclusive_console = NULL;\n\t\t}\n\n\t\t/*\n\t\t * Handle extended console text first because later\n\t\t * record_print_text() will modify the record buffer in-place.\n\t\t */\n\t\tif (nr_ext_console_drivers) {\n\t\t\text_len = info_print_ext_header(ext_text,\n\t\t\t\t\t\tsizeof(ext_text),\n\t\t\t\t\t\tr.info);\n\t\t\text_len += msg_print_ext_body(ext_text + ext_len,\n\t\t\t\t\t\tsizeof(ext_text) - ext_len,\n\t\t\t\t\t\t&r.text_buf[0],\n\t\t\t\t\t\tr.info->text_len,\n\t\t\t\t\t\t&r.info->dev_info);\n\t\t}\n\t\tlen = record_print_text(&r,\n\t\t\t\tconsole_msg_format & MSG_FORMAT_SYSLOG,\n\t\t\t\tprintk_time);\n\t\tconsole_seq++;\n\n\t\t/*\n\t\t * While actively printing out messages, if another printk()\n\t\t * were to occur on another CPU, it may wait for this one to\n\t\t * finish. This task can not be preempted if there is a\n\t\t * waiter waiting to take over.\n\t\t *\n\t\t * Interrupts are disabled because the hand over to a waiter\n\t\t * must not be interrupted until the hand over is completed\n\t\t * (@console_waiter is cleared).\n\t\t */\n\t\tprintk_safe_enter_irqsave(flags);\n\t\tconsole_lock_spinning_enable();\n\n\t\tstop_critical_timings();\t/* don't trace print latency */\n\t\tcall_console_drivers(ext_text, ext_len, text, len);\n\t\tstart_critical_timings();\n\n\t\thandover = console_lock_spinning_disable_and_check();\n\t\tprintk_safe_exit_irqrestore(flags);\n\t\tif (handover)\n\t\t\treturn;\n\n\t\tif (do_cond_resched)\n\t\t\tcond_resched();\n\t}\n\n\t/* Get consistent value of the next-to-be-used sequence number. */\n\tnext_seq = console_seq;\n\n\tconsole_locked = 0;\n\tup_console_sem();\n\n\t/*\n\t * Someone could have filled up the buffer again, so re-check if there's\n\t * something to flush. In case we cannot trylock the console_sem again,\n\t * there's a new owner and the console_unlock() from them will do the\n\t * flush, no worries.\n\t */\n\tretry = prb_read_valid(prb, next_seq, NULL);\n\tif (retry && console_trylock())\n\t\tgoto again;\n}"
        }
      },
      {
        "call_info": {
          "callee": "console_trylock",
          "args": [],
          "line": 2506
        },
        "resolved": true,
        "details": {
          "function_name": "console_trylock",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2540-2551",
          "snippet": "int console_trylock(void)\n{\n\tif (down_trylock_console_sem())\n\t\treturn 0;\n\tif (console_suspended) {\n\t\tup_console_sem();\n\t\treturn 0;\n\t}\n\tconsole_locked = 1;\n\tconsole_may_schedule = 0;\n\treturn 1;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int console_locked, console_suspended;",
            "static int console_may_schedule;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic int console_locked, console_suspended;\nstatic int console_may_schedule;\n\nint console_trylock(void)\n{\n\tif (down_trylock_console_sem())\n\t\treturn 0;\n\tif (console_suspended) {\n\t\tup_console_sem();\n\t\treturn 0;\n\t}\n\tconsole_locked = 1;\n\tconsole_may_schedule = 0;\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic int console_cpu_notify(unsigned int cpu)\n{\n\tif (!cpuhp_tasks_frozen) {\n\t\t/* If trylock fails, someone else is doing the printing */\n\t\tif (console_trylock())\n\t\t\tconsole_unlock();\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "resume_console",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2484-2491",
    "snippet": "void resume_console(void)\n{\n\tif (!console_suspend_enabled)\n\t\treturn;\n\tdown_console_sem();\n\tconsole_suspended = 0;\n\tconsole_unlock();\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int console_locked, console_suspended;",
      "bool console_suspend_enabled = true;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "console_unlock",
          "args": [],
          "line": 2490
        },
        "resolved": true,
        "details": {
          "function_name": "console_unlock",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2602-2738",
          "snippet": "void console_unlock(void)\n{\n\tstatic char ext_text[CONSOLE_EXT_LOG_MAX];\n\tstatic char text[CONSOLE_LOG_MAX];\n\tunsigned long flags;\n\tbool do_cond_resched, retry;\n\tstruct printk_info info;\n\tstruct printk_record r;\n\tu64 __maybe_unused next_seq;\n\n\tif (console_suspended) {\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tprb_rec_init_rd(&r, &info, text, sizeof(text));\n\n\t/*\n\t * Console drivers are called with interrupts disabled, so\n\t * @console_may_schedule should be cleared before; however, we may\n\t * end up dumping a lot of lines, for example, if called from\n\t * console registration path, and should invoke cond_resched()\n\t * between lines if allowable.  Not doing so can cause a very long\n\t * scheduling stall on a slow console leading to RCU stall and\n\t * softlockup warnings which exacerbate the issue with more\n\t * messages practically incapacitating the system.\n\t *\n\t * console_trylock() is not able to detect the preemptive\n\t * context reliably. Therefore the value must be stored before\n\t * and cleared after the \"again\" goto label.\n\t */\n\tdo_cond_resched = console_may_schedule;\nagain:\n\tconsole_may_schedule = 0;\n\n\t/*\n\t * We released the console_sem lock, so we need to recheck if\n\t * cpu is online and (if not) is there at least one CON_ANYTIME\n\t * console.\n\t */\n\tif (!can_use_console()) {\n\t\tconsole_locked = 0;\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tfor (;;) {\n\t\tsize_t ext_len = 0;\n\t\tint handover;\n\t\tsize_t len;\n\nskip:\n\t\tif (!prb_read_valid(prb, console_seq, &r))\n\t\t\tbreak;\n\n\t\tif (console_seq != r.info->seq) {\n\t\t\tconsole_dropped += r.info->seq - console_seq;\n\t\t\tconsole_seq = r.info->seq;\n\t\t}\n\n\t\tif (suppress_message_printing(r.info->level)) {\n\t\t\t/*\n\t\t\t * Skip record we have buffered and already printed\n\t\t\t * directly to the console when we received it, and\n\t\t\t * record that has level above the console loglevel.\n\t\t\t */\n\t\t\tconsole_seq++;\n\t\t\tgoto skip;\n\t\t}\n\n\t\t/* Output to all consoles once old messages replayed. */\n\t\tif (unlikely(exclusive_console &&\n\t\t\t     console_seq >= exclusive_console_stop_seq)) {\n\t\t\texclusive_console = NULL;\n\t\t}\n\n\t\t/*\n\t\t * Handle extended console text first because later\n\t\t * record_print_text() will modify the record buffer in-place.\n\t\t */\n\t\tif (nr_ext_console_drivers) {\n\t\t\text_len = info_print_ext_header(ext_text,\n\t\t\t\t\t\tsizeof(ext_text),\n\t\t\t\t\t\tr.info);\n\t\t\text_len += msg_print_ext_body(ext_text + ext_len,\n\t\t\t\t\t\tsizeof(ext_text) - ext_len,\n\t\t\t\t\t\t&r.text_buf[0],\n\t\t\t\t\t\tr.info->text_len,\n\t\t\t\t\t\t&r.info->dev_info);\n\t\t}\n\t\tlen = record_print_text(&r,\n\t\t\t\tconsole_msg_format & MSG_FORMAT_SYSLOG,\n\t\t\t\tprintk_time);\n\t\tconsole_seq++;\n\n\t\t/*\n\t\t * While actively printing out messages, if another printk()\n\t\t * were to occur on another CPU, it may wait for this one to\n\t\t * finish. This task can not be preempted if there is a\n\t\t * waiter waiting to take over.\n\t\t *\n\t\t * Interrupts are disabled because the hand over to a waiter\n\t\t * must not be interrupted until the hand over is completed\n\t\t * (@console_waiter is cleared).\n\t\t */\n\t\tprintk_safe_enter_irqsave(flags);\n\t\tconsole_lock_spinning_enable();\n\n\t\tstop_critical_timings();\t/* don't trace print latency */\n\t\tcall_console_drivers(ext_text, ext_len, text, len);\n\t\tstart_critical_timings();\n\n\t\thandover = console_lock_spinning_disable_and_check();\n\t\tprintk_safe_exit_irqrestore(flags);\n\t\tif (handover)\n\t\t\treturn;\n\n\t\tif (do_cond_resched)\n\t\t\tcond_resched();\n\t}\n\n\t/* Get consistent value of the next-to-be-used sequence number. */\n\tnext_seq = console_seq;\n\n\tconsole_locked = 0;\n\tup_console_sem();\n\n\t/*\n\t * Someone could have filled up the buffer again, so re-check if there's\n\t * something to flush. In case we cannot trylock the console_sem again,\n\t * there's a new owner and the console_unlock() from them will do the\n\t * flush, no worries.\n\t */\n\tretry = prb_read_valid(prb, next_seq, NULL);\n\tif (retry && console_trylock())\n\t\tgoto again;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define printk_time\t\tfalse",
            "#define CONSOLE_LOG_MAX\t\t0",
            "#define CONSOLE_LOG_MAX\t\t1024"
          ],
          "globals_used": [
            "static DEFINE_SEMAPHORE(console_sem);",
            "static int nr_ext_console_drivers;",
            "static int console_locked, console_suspended;",
            "static struct console *exclusive_console;",
            "static int console_may_schedule;",
            "static int console_msg_format = MSG_FORMAT_DEFAULT;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define printk_time\t\tfalse\n#define CONSOLE_LOG_MAX\t\t0\n#define CONSOLE_LOG_MAX\t\t1024\n\nstatic DEFINE_SEMAPHORE(console_sem);\nstatic int nr_ext_console_drivers;\nstatic int console_locked, console_suspended;\nstatic struct console *exclusive_console;\nstatic int console_may_schedule;\nstatic int console_msg_format = MSG_FORMAT_DEFAULT;\n\nvoid console_unlock(void)\n{\n\tstatic char ext_text[CONSOLE_EXT_LOG_MAX];\n\tstatic char text[CONSOLE_LOG_MAX];\n\tunsigned long flags;\n\tbool do_cond_resched, retry;\n\tstruct printk_info info;\n\tstruct printk_record r;\n\tu64 __maybe_unused next_seq;\n\n\tif (console_suspended) {\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tprb_rec_init_rd(&r, &info, text, sizeof(text));\n\n\t/*\n\t * Console drivers are called with interrupts disabled, so\n\t * @console_may_schedule should be cleared before; however, we may\n\t * end up dumping a lot of lines, for example, if called from\n\t * console registration path, and should invoke cond_resched()\n\t * between lines if allowable.  Not doing so can cause a very long\n\t * scheduling stall on a slow console leading to RCU stall and\n\t * softlockup warnings which exacerbate the issue with more\n\t * messages practically incapacitating the system.\n\t *\n\t * console_trylock() is not able to detect the preemptive\n\t * context reliably. Therefore the value must be stored before\n\t * and cleared after the \"again\" goto label.\n\t */\n\tdo_cond_resched = console_may_schedule;\nagain:\n\tconsole_may_schedule = 0;\n\n\t/*\n\t * We released the console_sem lock, so we need to recheck if\n\t * cpu is online and (if not) is there at least one CON_ANYTIME\n\t * console.\n\t */\n\tif (!can_use_console()) {\n\t\tconsole_locked = 0;\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tfor (;;) {\n\t\tsize_t ext_len = 0;\n\t\tint handover;\n\t\tsize_t len;\n\nskip:\n\t\tif (!prb_read_valid(prb, console_seq, &r))\n\t\t\tbreak;\n\n\t\tif (console_seq != r.info->seq) {\n\t\t\tconsole_dropped += r.info->seq - console_seq;\n\t\t\tconsole_seq = r.info->seq;\n\t\t}\n\n\t\tif (suppress_message_printing(r.info->level)) {\n\t\t\t/*\n\t\t\t * Skip record we have buffered and already printed\n\t\t\t * directly to the console when we received it, and\n\t\t\t * record that has level above the console loglevel.\n\t\t\t */\n\t\t\tconsole_seq++;\n\t\t\tgoto skip;\n\t\t}\n\n\t\t/* Output to all consoles once old messages replayed. */\n\t\tif (unlikely(exclusive_console &&\n\t\t\t     console_seq >= exclusive_console_stop_seq)) {\n\t\t\texclusive_console = NULL;\n\t\t}\n\n\t\t/*\n\t\t * Handle extended console text first because later\n\t\t * record_print_text() will modify the record buffer in-place.\n\t\t */\n\t\tif (nr_ext_console_drivers) {\n\t\t\text_len = info_print_ext_header(ext_text,\n\t\t\t\t\t\tsizeof(ext_text),\n\t\t\t\t\t\tr.info);\n\t\t\text_len += msg_print_ext_body(ext_text + ext_len,\n\t\t\t\t\t\tsizeof(ext_text) - ext_len,\n\t\t\t\t\t\t&r.text_buf[0],\n\t\t\t\t\t\tr.info->text_len,\n\t\t\t\t\t\t&r.info->dev_info);\n\t\t}\n\t\tlen = record_print_text(&r,\n\t\t\t\tconsole_msg_format & MSG_FORMAT_SYSLOG,\n\t\t\t\tprintk_time);\n\t\tconsole_seq++;\n\n\t\t/*\n\t\t * While actively printing out messages, if another printk()\n\t\t * were to occur on another CPU, it may wait for this one to\n\t\t * finish. This task can not be preempted if there is a\n\t\t * waiter waiting to take over.\n\t\t *\n\t\t * Interrupts are disabled because the hand over to a waiter\n\t\t * must not be interrupted until the hand over is completed\n\t\t * (@console_waiter is cleared).\n\t\t */\n\t\tprintk_safe_enter_irqsave(flags);\n\t\tconsole_lock_spinning_enable();\n\n\t\tstop_critical_timings();\t/* don't trace print latency */\n\t\tcall_console_drivers(ext_text, ext_len, text, len);\n\t\tstart_critical_timings();\n\n\t\thandover = console_lock_spinning_disable_and_check();\n\t\tprintk_safe_exit_irqrestore(flags);\n\t\tif (handover)\n\t\t\treturn;\n\n\t\tif (do_cond_resched)\n\t\t\tcond_resched();\n\t}\n\n\t/* Get consistent value of the next-to-be-used sequence number. */\n\tnext_seq = console_seq;\n\n\tconsole_locked = 0;\n\tup_console_sem();\n\n\t/*\n\t * Someone could have filled up the buffer again, so re-check if there's\n\t * something to flush. In case we cannot trylock the console_sem again,\n\t * there's a new owner and the console_unlock() from them will do the\n\t * flush, no worries.\n\t */\n\tretry = prb_read_valid(prb, next_seq, NULL);\n\tif (retry && console_trylock())\n\t\tgoto again;\n}"
        }
      },
      {
        "call_info": {
          "callee": "down_console_sem",
          "args": [],
          "line": 2488
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic int console_locked, console_suspended;\nbool console_suspend_enabled = true;\n\nvoid resume_console(void)\n{\n\tif (!console_suspend_enabled)\n\t\treturn;\n\tdown_console_sem();\n\tconsole_suspended = 0;\n\tconsole_unlock();\n}"
  },
  {
    "function_name": "suspend_console",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2474-2482",
    "snippet": "void suspend_console(void)\n{\n\tif (!console_suspend_enabled)\n\t\treturn;\n\tpr_info(\"Suspending console(s) (use no_console_suspend to debug)\\n\");\n\tconsole_lock();\n\tconsole_suspended = 1;\n\tup_console_sem();\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int console_locked, console_suspended;",
      "bool console_suspend_enabled = true;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "up_console_sem",
          "args": [],
          "line": 2481
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "console_lock",
          "args": [],
          "line": 2479
        },
        "resolved": true,
        "details": {
          "function_name": "is_console_locked",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2554-2557",
          "snippet": "int is_console_locked(void)\n{\n\treturn console_locked;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nint is_console_locked(void)\n{\n\treturn console_locked;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"Suspending console(s) (use no_console_suspend to debug)\\n\""
          ],
          "line": 2478
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic int console_locked, console_suspended;\nbool console_suspend_enabled = true;\n\nvoid suspend_console(void)\n{\n\tif (!console_suspend_enabled)\n\t\treturn;\n\tpr_info(\"Suspending console(s) (use no_console_suspend to debug)\\n\");\n\tconsole_lock();\n\tconsole_suspended = 1;\n\tup_console_sem();\n}"
  },
  {
    "function_name": "console_verbose",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2459-2463",
    "snippet": "void console_verbose(void)\n{\n\tif (console_loglevel && !printk_console_no_auto_verbose)\n\t\tconsole_loglevel = CONSOLE_LOGLEVEL_MOTORMOUTH;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool printk_console_no_auto_verbose;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic bool printk_console_no_auto_verbose;\n\nvoid console_verbose(void)\n{\n\tif (console_loglevel && !printk_console_no_auto_verbose)\n\t\tconsole_loglevel = CONSOLE_LOGLEVEL_MOTORMOUTH;\n}"
  },
  {
    "function_name": "console_suspend_disable",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2446-2450",
    "snippet": "static int __init console_suspend_disable(char *str)\n{\n\tconsole_suspend_enabled = false;\n\treturn 1;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "bool console_suspend_enabled = true;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nbool console_suspend_enabled = true;\n\nstatic int __init console_suspend_disable(char *str)\n{\n\tconsole_suspend_enabled = false;\n\treturn 1;\n}"
  },
  {
    "function_name": "add_preferred_console",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2438-2441",
    "snippet": "int add_preferred_console(char *name, int idx, char *options)\n{\n\treturn __add_preferred_console(name, idx, options, NULL, false);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__add_preferred_console",
          "args": [
            "name",
            "idx",
            "options",
            "NULL",
            "false"
          ],
          "line": 2440
        },
        "resolved": true,
        "details": {
          "function_name": "__add_preferred_console",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2327-2359",
          "snippet": "static int __add_preferred_console(char *name, int idx, char *options,\n\t\t\t\t   char *brl_options, bool user_specified)\n{\n\tstruct console_cmdline *c;\n\tint i;\n\n\t/*\n\t *\tSee if this tty is not yet registered, and\n\t *\tif we have a slot free.\n\t */\n\tfor (i = 0, c = console_cmdline;\n\t     i < MAX_CMDLINECONSOLES && c->name[0];\n\t     i++, c++) {\n\t\tif (strcmp(c->name, name) == 0 && c->index == idx) {\n\t\t\tif (!brl_options)\n\t\t\t\tpreferred_console = i;\n\t\t\tif (user_specified)\n\t\t\t\tc->user_specified = true;\n\t\t\treturn 0;\n\t\t}\n\t}\n\tif (i == MAX_CMDLINECONSOLES)\n\t\treturn -E2BIG;\n\tif (!brl_options)\n\t\tpreferred_console = i;\n\tstrlcpy(c->name, name, sizeof(c->name));\n\tc->options = options;\n\tc->user_specified = user_specified;\n\tbraille_set_options(c, brl_options);\n\n\tc->index = idx;\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define MAX_CMDLINECONSOLES 8"
          ],
          "globals_used": [
            "static struct console_cmdline console_cmdline[MAX_CMDLINECONSOLES];",
            "static int preferred_console = -1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define MAX_CMDLINECONSOLES 8\n\nstatic struct console_cmdline console_cmdline[MAX_CMDLINECONSOLES];\nstatic int preferred_console = -1;\n\nstatic int __add_preferred_console(char *name, int idx, char *options,\n\t\t\t\t   char *brl_options, bool user_specified)\n{\n\tstruct console_cmdline *c;\n\tint i;\n\n\t/*\n\t *\tSee if this tty is not yet registered, and\n\t *\tif we have a slot free.\n\t */\n\tfor (i = 0, c = console_cmdline;\n\t     i < MAX_CMDLINECONSOLES && c->name[0];\n\t     i++, c++) {\n\t\tif (strcmp(c->name, name) == 0 && c->index == idx) {\n\t\t\tif (!brl_options)\n\t\t\t\tpreferred_console = i;\n\t\t\tif (user_specified)\n\t\t\t\tc->user_specified = true;\n\t\t\treturn 0;\n\t\t}\n\t}\n\tif (i == MAX_CMDLINECONSOLES)\n\t\treturn -E2BIG;\n\tif (!brl_options)\n\t\tpreferred_console = i;\n\tstrlcpy(c->name, name, sizeof(c->name));\n\tc->options = options;\n\tc->user_specified = user_specified;\n\tbraille_set_options(c, brl_options);\n\n\tc->index = idx;\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nint add_preferred_console(char *name, int idx, char *options)\n{\n\treturn __add_preferred_console(name, idx, options, NULL, false);\n}"
  },
  {
    "function_name": "console_setup",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2375-2422",
    "snippet": "static int __init console_setup(char *str)\n{\n\tchar buf[sizeof(console_cmdline[0].name) + 4]; /* 4 for \"ttyS\" */\n\tchar *s, *options, *brl_options = NULL;\n\tint idx;\n\n\t/*\n\t * console=\"\" or console=null have been suggested as a way to\n\t * disable console output. Use ttynull that has been created\n\t * for exactly this purpose.\n\t */\n\tif (str[0] == 0 || strcmp(str, \"null\") == 0) {\n\t\t__add_preferred_console(\"ttynull\", 0, NULL, NULL, true);\n\t\treturn 1;\n\t}\n\n\tif (_braille_console_setup(&str, &brl_options))\n\t\treturn 1;\n\n\t/*\n\t * Decode str into name, index, options.\n\t */\n\tif (str[0] >= '0' && str[0] <= '9') {\n\t\tstrcpy(buf, \"ttyS\");\n\t\tstrncpy(buf + 4, str, sizeof(buf) - 5);\n\t} else {\n\t\tstrncpy(buf, str, sizeof(buf) - 1);\n\t}\n\tbuf[sizeof(buf) - 1] = 0;\n\toptions = strchr(str, ',');\n\tif (options)\n\t\t*(options++) = 0;\n#ifdef __sparc__\n\tif (!strcmp(str, \"ttya\"))\n\t\tstrcpy(buf, \"ttyS0\");\n\tif (!strcmp(str, \"ttyb\"))\n\t\tstrcpy(buf, \"ttyS1\");\n#endif\n\tfor (s = buf; *s; s++)\n\t\tif (isdigit(*s) || *s == ',')\n\t\t\tbreak;\n\tidx = simple_strtoul(s, NULL, 10);\n\t*s = 0;\n\n\t__add_preferred_console(buf, idx, options, brl_options, true);\n\tconsole_set_on_cmdline = 1;\n\treturn 1;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct console_cmdline console_cmdline[MAX_CMDLINECONSOLES];",
      "int console_set_on_cmdline;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "__add_preferred_console",
          "args": [
            "buf",
            "idx",
            "options",
            "brl_options",
            "true"
          ],
          "line": 2419
        },
        "resolved": true,
        "details": {
          "function_name": "__add_preferred_console",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2327-2359",
          "snippet": "static int __add_preferred_console(char *name, int idx, char *options,\n\t\t\t\t   char *brl_options, bool user_specified)\n{\n\tstruct console_cmdline *c;\n\tint i;\n\n\t/*\n\t *\tSee if this tty is not yet registered, and\n\t *\tif we have a slot free.\n\t */\n\tfor (i = 0, c = console_cmdline;\n\t     i < MAX_CMDLINECONSOLES && c->name[0];\n\t     i++, c++) {\n\t\tif (strcmp(c->name, name) == 0 && c->index == idx) {\n\t\t\tif (!brl_options)\n\t\t\t\tpreferred_console = i;\n\t\t\tif (user_specified)\n\t\t\t\tc->user_specified = true;\n\t\t\treturn 0;\n\t\t}\n\t}\n\tif (i == MAX_CMDLINECONSOLES)\n\t\treturn -E2BIG;\n\tif (!brl_options)\n\t\tpreferred_console = i;\n\tstrlcpy(c->name, name, sizeof(c->name));\n\tc->options = options;\n\tc->user_specified = user_specified;\n\tbraille_set_options(c, brl_options);\n\n\tc->index = idx;\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define MAX_CMDLINECONSOLES 8"
          ],
          "globals_used": [
            "static struct console_cmdline console_cmdline[MAX_CMDLINECONSOLES];",
            "static int preferred_console = -1;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define MAX_CMDLINECONSOLES 8\n\nstatic struct console_cmdline console_cmdline[MAX_CMDLINECONSOLES];\nstatic int preferred_console = -1;\n\nstatic int __add_preferred_console(char *name, int idx, char *options,\n\t\t\t\t   char *brl_options, bool user_specified)\n{\n\tstruct console_cmdline *c;\n\tint i;\n\n\t/*\n\t *\tSee if this tty is not yet registered, and\n\t *\tif we have a slot free.\n\t */\n\tfor (i = 0, c = console_cmdline;\n\t     i < MAX_CMDLINECONSOLES && c->name[0];\n\t     i++, c++) {\n\t\tif (strcmp(c->name, name) == 0 && c->index == idx) {\n\t\t\tif (!brl_options)\n\t\t\t\tpreferred_console = i;\n\t\t\tif (user_specified)\n\t\t\t\tc->user_specified = true;\n\t\t\treturn 0;\n\t\t}\n\t}\n\tif (i == MAX_CMDLINECONSOLES)\n\t\treturn -E2BIG;\n\tif (!brl_options)\n\t\tpreferred_console = i;\n\tstrlcpy(c->name, name, sizeof(c->name));\n\tc->options = options;\n\tc->user_specified = user_specified;\n\tbraille_set_options(c, brl_options);\n\n\tc->index = idx;\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "simple_strtoul",
          "args": [
            "s",
            "NULL",
            "10"
          ],
          "line": 2416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isdigit",
          "args": [
            "*s"
          ],
          "line": 2414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "buf",
            "\"ttyS1\""
          ],
          "line": 2411
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "str",
            "\"ttyb\""
          ],
          "line": 2410
        },
        "resolved": true,
        "details": {
          "function_name": "sym_strcmp",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/kcsan/report.c",
          "lines": "356-365",
          "snippet": "static int sym_strcmp(void *addr1, void *addr2)\n{\n\tchar buf1[64];\n\tchar buf2[64];\n\n\tsnprintf(buf1, sizeof(buf1), \"%pS\", addr1);\n\tsnprintf(buf2, sizeof(buf2), \"%pS\", addr2);\n\n\treturn strncmp(buf1, buf2, sizeof(buf1));\n}",
          "includes": [
            "#include \"encoding.h\"",
            "#include \"kcsan.h\"",
            "#include <linux/stacktrace.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/preempt.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/delay.h>",
            "#include <linux/debug_locks.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"encoding.h\"\n#include \"kcsan.h\"\n#include <linux/stacktrace.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/preempt.h>\n#include <linux/lockdep.h>\n#include <linux/kernel.h>\n#include <linux/kallsyms.h>\n#include <linux/jiffies.h>\n#include <linux/delay.h>\n#include <linux/debug_locks.h>\n\nstatic int sym_strcmp(void *addr1, void *addr2)\n{\n\tchar buf1[64];\n\tchar buf2[64];\n\n\tsnprintf(buf1, sizeof(buf1), \"%pS\", addr1);\n\tsnprintf(buf2, sizeof(buf2), \"%pS\", addr2);\n\n\treturn strncmp(buf1, buf2, sizeof(buf1));\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "buf",
            "\"ttyS0\""
          ],
          "line": 2409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "str",
            "','"
          ],
          "line": 2404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncpy",
          "args": [
            "buf",
            "str",
            "sizeof(buf) - 1"
          ],
          "line": 2401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncpy",
          "args": [
            "buf + 4",
            "str",
            "sizeof(buf) - 5"
          ],
          "line": 2399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "buf",
            "\"ttyS\""
          ],
          "line": 2398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_braille_console_setup",
          "args": [
            "&str",
            "&brl_options"
          ],
          "line": 2391
        },
        "resolved": true,
        "details": {
          "function_name": "_braille_console_setup",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/braille.h",
          "lines": "36-40",
          "snippet": "static inline int\n_braille_console_setup(char **str, char **brl_options)\n{\n\treturn 0;\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline int\n_braille_console_setup(char **str, char **brl_options)\n{\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic struct console_cmdline console_cmdline[MAX_CMDLINECONSOLES];\nint console_set_on_cmdline;\n\nstatic int __init console_setup(char *str)\n{\n\tchar buf[sizeof(console_cmdline[0].name) + 4]; /* 4 for \"ttyS\" */\n\tchar *s, *options, *brl_options = NULL;\n\tint idx;\n\n\t/*\n\t * console=\"\" or console=null have been suggested as a way to\n\t * disable console output. Use ttynull that has been created\n\t * for exactly this purpose.\n\t */\n\tif (str[0] == 0 || strcmp(str, \"null\") == 0) {\n\t\t__add_preferred_console(\"ttynull\", 0, NULL, NULL, true);\n\t\treturn 1;\n\t}\n\n\tif (_braille_console_setup(&str, &brl_options))\n\t\treturn 1;\n\n\t/*\n\t * Decode str into name, index, options.\n\t */\n\tif (str[0] >= '0' && str[0] <= '9') {\n\t\tstrcpy(buf, \"ttyS\");\n\t\tstrncpy(buf + 4, str, sizeof(buf) - 5);\n\t} else {\n\t\tstrncpy(buf, str, sizeof(buf) - 1);\n\t}\n\tbuf[sizeof(buf) - 1] = 0;\n\toptions = strchr(str, ',');\n\tif (options)\n\t\t*(options++) = 0;\n#ifdef __sparc__\n\tif (!strcmp(str, \"ttya\"))\n\t\tstrcpy(buf, \"ttyS0\");\n\tif (!strcmp(str, \"ttyb\"))\n\t\tstrcpy(buf, \"ttyS1\");\n#endif\n\tfor (s = buf; *s; s++)\n\t\tif (isdigit(*s) || *s == ',')\n\t\t\tbreak;\n\tidx = simple_strtoul(s, NULL, 10);\n\t*s = 0;\n\n\t__add_preferred_console(buf, idx, options, brl_options, true);\n\tconsole_set_on_cmdline = 1;\n\treturn 1;\n}"
  },
  {
    "function_name": "console_msg_format_setup",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2361-2368",
    "snippet": "static int __init console_msg_format_setup(char *str)\n{\n\tif (!strcmp(str, \"syslog\"))\n\t\tconsole_msg_format = MSG_FORMAT_SYSLOG;\n\tif (!strcmp(str, \"default\"))\n\t\tconsole_msg_format = MSG_FORMAT_DEFAULT;\n\treturn 1;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int console_msg_format = MSG_FORMAT_DEFAULT;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "str",
            "\"default\""
          ],
          "line": 2365
        },
        "resolved": true,
        "details": {
          "function_name": "sym_strcmp",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/kcsan/report.c",
          "lines": "356-365",
          "snippet": "static int sym_strcmp(void *addr1, void *addr2)\n{\n\tchar buf1[64];\n\tchar buf2[64];\n\n\tsnprintf(buf1, sizeof(buf1), \"%pS\", addr1);\n\tsnprintf(buf2, sizeof(buf2), \"%pS\", addr2);\n\n\treturn strncmp(buf1, buf2, sizeof(buf1));\n}",
          "includes": [
            "#include \"encoding.h\"",
            "#include \"kcsan.h\"",
            "#include <linux/stacktrace.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/preempt.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/delay.h>",
            "#include <linux/debug_locks.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"encoding.h\"\n#include \"kcsan.h\"\n#include <linux/stacktrace.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/preempt.h>\n#include <linux/lockdep.h>\n#include <linux/kernel.h>\n#include <linux/kallsyms.h>\n#include <linux/jiffies.h>\n#include <linux/delay.h>\n#include <linux/debug_locks.h>\n\nstatic int sym_strcmp(void *addr1, void *addr2)\n{\n\tchar buf1[64];\n\tchar buf2[64];\n\n\tsnprintf(buf1, sizeof(buf1), \"%pS\", addr1);\n\tsnprintf(buf2, sizeof(buf2), \"%pS\", addr2);\n\n\treturn strncmp(buf1, buf2, sizeof(buf1));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic int console_msg_format = MSG_FORMAT_DEFAULT;\n\nstatic int __init console_msg_format_setup(char *str)\n{\n\tif (!strcmp(str, \"syslog\"))\n\t\tconsole_msg_format = MSG_FORMAT_SYSLOG;\n\tif (!strcmp(str, \"default\"))\n\t\tconsole_msg_format = MSG_FORMAT_DEFAULT;\n\treturn 1;\n}"
  },
  {
    "function_name": "__add_preferred_console",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2327-2359",
    "snippet": "static int __add_preferred_console(char *name, int idx, char *options,\n\t\t\t\t   char *brl_options, bool user_specified)\n{\n\tstruct console_cmdline *c;\n\tint i;\n\n\t/*\n\t *\tSee if this tty is not yet registered, and\n\t *\tif we have a slot free.\n\t */\n\tfor (i = 0, c = console_cmdline;\n\t     i < MAX_CMDLINECONSOLES && c->name[0];\n\t     i++, c++) {\n\t\tif (strcmp(c->name, name) == 0 && c->index == idx) {\n\t\t\tif (!brl_options)\n\t\t\t\tpreferred_console = i;\n\t\t\tif (user_specified)\n\t\t\t\tc->user_specified = true;\n\t\t\treturn 0;\n\t\t}\n\t}\n\tif (i == MAX_CMDLINECONSOLES)\n\t\treturn -E2BIG;\n\tif (!brl_options)\n\t\tpreferred_console = i;\n\tstrlcpy(c->name, name, sizeof(c->name));\n\tc->options = options;\n\tc->user_specified = user_specified;\n\tbraille_set_options(c, brl_options);\n\n\tc->index = idx;\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define MAX_CMDLINECONSOLES 8"
    ],
    "globals_used": [
      "static struct console_cmdline console_cmdline[MAX_CMDLINECONSOLES];",
      "static int preferred_console = -1;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "braille_set_options",
          "args": [
            "c",
            "brl_options"
          ],
          "line": 2355
        },
        "resolved": true,
        "details": {
          "function_name": "braille_set_options",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/braille.h",
          "lines": "31-34",
          "snippet": "static inline void\nbraille_set_options(struct console_cmdline *c, char *brl_options)\n{\n}",
          "includes": [],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "static inline void\nbraille_set_options(struct console_cmdline *c, char *brl_options)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlcpy",
          "args": [
            "c->name",
            "name",
            "sizeof(c->name)"
          ],
          "line": 2352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "c->name",
            "name"
          ],
          "line": 2340
        },
        "resolved": true,
        "details": {
          "function_name": "sym_strcmp",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/kcsan/report.c",
          "lines": "356-365",
          "snippet": "static int sym_strcmp(void *addr1, void *addr2)\n{\n\tchar buf1[64];\n\tchar buf2[64];\n\n\tsnprintf(buf1, sizeof(buf1), \"%pS\", addr1);\n\tsnprintf(buf2, sizeof(buf2), \"%pS\", addr2);\n\n\treturn strncmp(buf1, buf2, sizeof(buf1));\n}",
          "includes": [
            "#include \"encoding.h\"",
            "#include \"kcsan.h\"",
            "#include <linux/stacktrace.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/printk.h>",
            "#include <linux/preempt.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/kernel.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/delay.h>",
            "#include <linux/debug_locks.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"encoding.h\"\n#include \"kcsan.h\"\n#include <linux/stacktrace.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/printk.h>\n#include <linux/preempt.h>\n#include <linux/lockdep.h>\n#include <linux/kernel.h>\n#include <linux/kallsyms.h>\n#include <linux/jiffies.h>\n#include <linux/delay.h>\n#include <linux/debug_locks.h>\n\nstatic int sym_strcmp(void *addr1, void *addr2)\n{\n\tchar buf1[64];\n\tchar buf2[64];\n\n\tsnprintf(buf1, sizeof(buf1), \"%pS\", addr1);\n\tsnprintf(buf2, sizeof(buf2), \"%pS\", addr2);\n\n\treturn strncmp(buf1, buf2, sizeof(buf1));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define MAX_CMDLINECONSOLES 8\n\nstatic struct console_cmdline console_cmdline[MAX_CMDLINECONSOLES];\nstatic int preferred_console = -1;\n\nstatic int __add_preferred_console(char *name, int idx, char *options,\n\t\t\t\t   char *brl_options, bool user_specified)\n{\n\tstruct console_cmdline *c;\n\tint i;\n\n\t/*\n\t *\tSee if this tty is not yet registered, and\n\t *\tif we have a slot free.\n\t */\n\tfor (i = 0, c = console_cmdline;\n\t     i < MAX_CMDLINECONSOLES && c->name[0];\n\t     i++, c++) {\n\t\tif (strcmp(c->name, name) == 0 && c->index == idx) {\n\t\t\tif (!brl_options)\n\t\t\t\tpreferred_console = i;\n\t\t\tif (user_specified)\n\t\t\t\tc->user_specified = true;\n\t\t\treturn 0;\n\t\t}\n\t}\n\tif (i == MAX_CMDLINECONSOLES)\n\t\treturn -E2BIG;\n\tif (!brl_options)\n\t\tpreferred_console = i;\n\tstrlcpy(c->name, name, sizeof(c->name));\n\tc->options = options;\n\tc->user_specified = user_specified;\n\tbraille_set_options(c, brl_options);\n\n\tc->index = idx;\n\treturn 0;\n}"
  },
  {
    "function_name": "early_printk",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2310-2324",
    "snippet": "void early_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tchar buf[512];\n\tint n;\n\n\tif (!early_console)\n\t\treturn;\n\n\tva_start(ap, fmt);\n\tn = vscnprintf(buf, sizeof(buf), fmt, ap);\n\tva_end(ap);\n\n\tearly_console->write(early_console, buf, n);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "early_console->write",
          "args": [
            "early_console",
            "buf",
            "n"
          ],
          "line": 2323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 2321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vscnprintf",
          "args": [
            "buf",
            "sizeof(buf)",
            "fmt",
            "ap"
          ],
          "line": 2320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "fmt"
          ],
          "line": 2319
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nvoid early_printk(const char *fmt, ...)\n{\n\tva_list ap;\n\tchar buf[512];\n\tint n;\n\n\tif (!early_console)\n\t\treturn;\n\n\tva_start(ap, fmt);\n\tn = vscnprintf(buf, sizeof(buf), fmt, ap);\n\tva_end(ap);\n\n\tearly_console->write(early_console, buf, n);\n}"
  },
  {
    "function_name": "suppress_message_printing",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2303-2303",
    "snippet": "static bool suppress_message_printing(int level) { return false; }",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic bool suppress_message_printing(int level) { return false; }"
  },
  {
    "function_name": "call_console_drivers",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2301-2302",
    "snippet": "static void call_console_drivers(const char *ext_text, size_t ext_len,\n\t\t\t\t const char *text, size_t len) {}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic void call_console_drivers(const char *ext_text, size_t ext_len,\n\t\t\t\t const char *text, size_t len) {}"
  },
  {
    "function_name": "console_lock_spinning_disable_and_check",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2300-2300",
    "snippet": "static int console_lock_spinning_disable_and_check(void) { return 0; }",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic int console_lock_spinning_disable_and_check(void) { return 0; }"
  },
  {
    "function_name": "console_lock_spinning_enable",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2299-2299",
    "snippet": "static void console_lock_spinning_enable(void) { }",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic void console_lock_spinning_enable(void) { }"
  },
  {
    "function_name": "msg_print_ext_body",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2296-2298",
    "snippet": "static ssize_t msg_print_ext_body(char *buf, size_t size,\n\t\t\t\t  char *text, size_t text_len,\n\t\t\t\t  struct dev_printk_info *dev_info) { return 0; }",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic ssize_t msg_print_ext_body(char *buf, size_t size,\n\t\t\t\t  char *text, size_t text_len,\n\t\t\t\t  struct dev_printk_info *dev_info) { return 0; }"
  },
  {
    "function_name": "info_print_ext_header",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2291-2295",
    "snippet": "static ssize_t info_print_ext_header(char *buf, size_t size,\n\t\t\t\t     struct printk_info *info)\n{\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic ssize_t info_print_ext_header(char *buf, size_t size,\n\t\t\t\t     struct printk_info *info)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "record_print_text",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2286-2290",
    "snippet": "static size_t record_print_text(const struct printk_record *r,\n\t\t\t\tbool syslog, bool time)\n{\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic size_t record_print_text(const struct printk_record *r,\n\t\t\t\tbool syslog, bool time)\n{\n\treturn 0;\n}"
  },
  {
    "function_name": "_printk",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2260-2270",
    "snippet": "int _printk(const char *fmt, ...)\n{\n\tva_list args;\n\tint r;\n\n\tva_start(args, fmt);\n\tr = vprintk(fmt, args);\n\tva_end(args);\n\n\treturn r;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "args"
          ],
          "line": 2267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vprintk",
          "args": [
            "fmt",
            "args"
          ],
          "line": 2266
        },
        "resolved": true,
        "details": {
          "function_name": "vprintk_deferred",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "3275-3283",
          "snippet": "int vprintk_deferred(const char *fmt, va_list args)\n{\n\tint r;\n\n\tr = vprintk_emit(0, LOGLEVEL_SCHED, NULL, fmt, args);\n\tdefer_console_output();\n\n\treturn r;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nint vprintk_deferred(const char *fmt, va_list args)\n{\n\tint r;\n\n\tr = vprintk_emit(0, LOGLEVEL_SCHED, NULL, fmt, args);\n\tdefer_console_output();\n\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "args",
            "fmt"
          ],
          "line": 2265
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nint _printk(const char *fmt, ...)\n{\n\tva_list args;\n\tint r;\n\n\tva_start(args, fmt);\n\tr = vprintk(fmt, args);\n\tva_end(args);\n\n\treturn r;\n}"
  },
  {
    "function_name": "vprintk_default",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2254-2257",
    "snippet": "int vprintk_default(const char *fmt, va_list args)\n{\n\treturn vprintk_emit(0, LOGLEVEL_DEFAULT, NULL, fmt, args);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vprintk_emit",
          "args": [
            "0",
            "LOGLEVEL_DEFAULT",
            "NULL",
            "fmt",
            "args"
          ],
          "line": 2256
        },
        "resolved": true,
        "details": {
          "function_name": "vprintk_emit",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2210-2251",
          "snippet": "asmlinkage int vprintk_emit(int facility, int level,\n\t\t\t    const struct dev_printk_info *dev_info,\n\t\t\t    const char *fmt, va_list args)\n{\n\tint printed_len;\n\tbool in_sched = false;\n\n\t/* Suppress unimportant messages after panic happens */\n\tif (unlikely(suppress_printk))\n\t\treturn 0;\n\n\tif (level == LOGLEVEL_SCHED) {\n\t\tlevel = LOGLEVEL_DEFAULT;\n\t\tin_sched = true;\n\t}\n\n\tboot_delay_msec(level);\n\tprintk_delay();\n\n\tprinted_len = vprintk_store(facility, level, dev_info, fmt, args);\n\n\t/* If called from the scheduler, we can not call up(). */\n\tif (!in_sched) {\n\t\t/*\n\t\t * Disable preemption to avoid being preempted while holding\n\t\t * console_sem which would prevent anyone from printing to\n\t\t * console\n\t\t */\n\t\tpreempt_disable();\n\t\t/*\n\t\t * Try to acquire and then immediately release the console\n\t\t * semaphore.  The release will print out buffers and wake up\n\t\t * /dev/kmsg and syslog() users.\n\t\t */\n\t\tif (console_trylock_spinning())\n\t\t\tconsole_unlock();\n\t\tpreempt_enable();\n\t}\n\n\twake_up_klogd();\n\treturn printed_len;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_SEMAPHORE(console_sem);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic DEFINE_SEMAPHORE(console_sem);\n\nasmlinkage int vprintk_emit(int facility, int level,\n\t\t\t    const struct dev_printk_info *dev_info,\n\t\t\t    const char *fmt, va_list args)\n{\n\tint printed_len;\n\tbool in_sched = false;\n\n\t/* Suppress unimportant messages after panic happens */\n\tif (unlikely(suppress_printk))\n\t\treturn 0;\n\n\tif (level == LOGLEVEL_SCHED) {\n\t\tlevel = LOGLEVEL_DEFAULT;\n\t\tin_sched = true;\n\t}\n\n\tboot_delay_msec(level);\n\tprintk_delay();\n\n\tprinted_len = vprintk_store(facility, level, dev_info, fmt, args);\n\n\t/* If called from the scheduler, we can not call up(). */\n\tif (!in_sched) {\n\t\t/*\n\t\t * Disable preemption to avoid being preempted while holding\n\t\t * console_sem which would prevent anyone from printing to\n\t\t * console\n\t\t */\n\t\tpreempt_disable();\n\t\t/*\n\t\t * Try to acquire and then immediately release the console\n\t\t * semaphore.  The release will print out buffers and wake up\n\t\t * /dev/kmsg and syslog() users.\n\t\t */\n\t\tif (console_trylock_spinning())\n\t\t\tconsole_unlock();\n\t\tpreempt_enable();\n\t}\n\n\twake_up_klogd();\n\treturn printed_len;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nint vprintk_default(const char *fmt, va_list args)\n{\n\treturn vprintk_emit(0, LOGLEVEL_DEFAULT, NULL, fmt, args);\n}"
  },
  {
    "function_name": "vprintk_emit",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2210-2251",
    "snippet": "asmlinkage int vprintk_emit(int facility, int level,\n\t\t\t    const struct dev_printk_info *dev_info,\n\t\t\t    const char *fmt, va_list args)\n{\n\tint printed_len;\n\tbool in_sched = false;\n\n\t/* Suppress unimportant messages after panic happens */\n\tif (unlikely(suppress_printk))\n\t\treturn 0;\n\n\tif (level == LOGLEVEL_SCHED) {\n\t\tlevel = LOGLEVEL_DEFAULT;\n\t\tin_sched = true;\n\t}\n\n\tboot_delay_msec(level);\n\tprintk_delay();\n\n\tprinted_len = vprintk_store(facility, level, dev_info, fmt, args);\n\n\t/* If called from the scheduler, we can not call up(). */\n\tif (!in_sched) {\n\t\t/*\n\t\t * Disable preemption to avoid being preempted while holding\n\t\t * console_sem which would prevent anyone from printing to\n\t\t * console\n\t\t */\n\t\tpreempt_disable();\n\t\t/*\n\t\t * Try to acquire and then immediately release the console\n\t\t * semaphore.  The release will print out buffers and wake up\n\t\t * /dev/kmsg and syslog() users.\n\t\t */\n\t\tif (console_trylock_spinning())\n\t\t\tconsole_unlock();\n\t\tpreempt_enable();\n\t}\n\n\twake_up_klogd();\n\treturn printed_len;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SEMAPHORE(console_sem);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "wake_up_klogd",
          "args": [],
          "line": 2249
        },
        "resolved": true,
        "details": {
          "function_name": "wake_up_klogd",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "3246-3257",
          "snippet": "void wake_up_klogd(void)\n{\n\tif (!printk_percpu_data_ready())\n\t\treturn;\n\n\tpreempt_disable();\n\tif (waitqueue_active(&log_wait)) {\n\t\tthis_cpu_or(printk_pending, PRINTK_PENDING_WAKEUP);\n\t\tirq_work_queue(this_cpu_ptr(&wake_up_klogd_work));\n\t}\n\tpreempt_enable();\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define PRINTK_PENDING_WAKEUP\t0x01"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define PRINTK_PENDING_WAKEUP\t0x01\n\nvoid wake_up_klogd(void)\n{\n\tif (!printk_percpu_data_ready())\n\t\treturn;\n\n\tpreempt_disable();\n\tif (waitqueue_active(&log_wait)) {\n\t\tthis_cpu_or(printk_pending, PRINTK_PENDING_WAKEUP);\n\t\tirq_work_queue(this_cpu_ptr(&wake_up_klogd_work));\n\t}\n\tpreempt_enable();\n}"
        }
      },
      {
        "call_info": {
          "callee": "preempt_enable",
          "args": [],
          "line": 2246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "console_unlock",
          "args": [],
          "line": 2245
        },
        "resolved": true,
        "details": {
          "function_name": "console_unlock",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2602-2738",
          "snippet": "void console_unlock(void)\n{\n\tstatic char ext_text[CONSOLE_EXT_LOG_MAX];\n\tstatic char text[CONSOLE_LOG_MAX];\n\tunsigned long flags;\n\tbool do_cond_resched, retry;\n\tstruct printk_info info;\n\tstruct printk_record r;\n\tu64 __maybe_unused next_seq;\n\n\tif (console_suspended) {\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tprb_rec_init_rd(&r, &info, text, sizeof(text));\n\n\t/*\n\t * Console drivers are called with interrupts disabled, so\n\t * @console_may_schedule should be cleared before; however, we may\n\t * end up dumping a lot of lines, for example, if called from\n\t * console registration path, and should invoke cond_resched()\n\t * between lines if allowable.  Not doing so can cause a very long\n\t * scheduling stall on a slow console leading to RCU stall and\n\t * softlockup warnings which exacerbate the issue with more\n\t * messages practically incapacitating the system.\n\t *\n\t * console_trylock() is not able to detect the preemptive\n\t * context reliably. Therefore the value must be stored before\n\t * and cleared after the \"again\" goto label.\n\t */\n\tdo_cond_resched = console_may_schedule;\nagain:\n\tconsole_may_schedule = 0;\n\n\t/*\n\t * We released the console_sem lock, so we need to recheck if\n\t * cpu is online and (if not) is there at least one CON_ANYTIME\n\t * console.\n\t */\n\tif (!can_use_console()) {\n\t\tconsole_locked = 0;\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tfor (;;) {\n\t\tsize_t ext_len = 0;\n\t\tint handover;\n\t\tsize_t len;\n\nskip:\n\t\tif (!prb_read_valid(prb, console_seq, &r))\n\t\t\tbreak;\n\n\t\tif (console_seq != r.info->seq) {\n\t\t\tconsole_dropped += r.info->seq - console_seq;\n\t\t\tconsole_seq = r.info->seq;\n\t\t}\n\n\t\tif (suppress_message_printing(r.info->level)) {\n\t\t\t/*\n\t\t\t * Skip record we have buffered and already printed\n\t\t\t * directly to the console when we received it, and\n\t\t\t * record that has level above the console loglevel.\n\t\t\t */\n\t\t\tconsole_seq++;\n\t\t\tgoto skip;\n\t\t}\n\n\t\t/* Output to all consoles once old messages replayed. */\n\t\tif (unlikely(exclusive_console &&\n\t\t\t     console_seq >= exclusive_console_stop_seq)) {\n\t\t\texclusive_console = NULL;\n\t\t}\n\n\t\t/*\n\t\t * Handle extended console text first because later\n\t\t * record_print_text() will modify the record buffer in-place.\n\t\t */\n\t\tif (nr_ext_console_drivers) {\n\t\t\text_len = info_print_ext_header(ext_text,\n\t\t\t\t\t\tsizeof(ext_text),\n\t\t\t\t\t\tr.info);\n\t\t\text_len += msg_print_ext_body(ext_text + ext_len,\n\t\t\t\t\t\tsizeof(ext_text) - ext_len,\n\t\t\t\t\t\t&r.text_buf[0],\n\t\t\t\t\t\tr.info->text_len,\n\t\t\t\t\t\t&r.info->dev_info);\n\t\t}\n\t\tlen = record_print_text(&r,\n\t\t\t\tconsole_msg_format & MSG_FORMAT_SYSLOG,\n\t\t\t\tprintk_time);\n\t\tconsole_seq++;\n\n\t\t/*\n\t\t * While actively printing out messages, if another printk()\n\t\t * were to occur on another CPU, it may wait for this one to\n\t\t * finish. This task can not be preempted if there is a\n\t\t * waiter waiting to take over.\n\t\t *\n\t\t * Interrupts are disabled because the hand over to a waiter\n\t\t * must not be interrupted until the hand over is completed\n\t\t * (@console_waiter is cleared).\n\t\t */\n\t\tprintk_safe_enter_irqsave(flags);\n\t\tconsole_lock_spinning_enable();\n\n\t\tstop_critical_timings();\t/* don't trace print latency */\n\t\tcall_console_drivers(ext_text, ext_len, text, len);\n\t\tstart_critical_timings();\n\n\t\thandover = console_lock_spinning_disable_and_check();\n\t\tprintk_safe_exit_irqrestore(flags);\n\t\tif (handover)\n\t\t\treturn;\n\n\t\tif (do_cond_resched)\n\t\t\tcond_resched();\n\t}\n\n\t/* Get consistent value of the next-to-be-used sequence number. */\n\tnext_seq = console_seq;\n\n\tconsole_locked = 0;\n\tup_console_sem();\n\n\t/*\n\t * Someone could have filled up the buffer again, so re-check if there's\n\t * something to flush. In case we cannot trylock the console_sem again,\n\t * there's a new owner and the console_unlock() from them will do the\n\t * flush, no worries.\n\t */\n\tretry = prb_read_valid(prb, next_seq, NULL);\n\tif (retry && console_trylock())\n\t\tgoto again;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define printk_time\t\tfalse",
            "#define CONSOLE_LOG_MAX\t\t0",
            "#define CONSOLE_LOG_MAX\t\t1024"
          ],
          "globals_used": [
            "static DEFINE_SEMAPHORE(console_sem);",
            "static int nr_ext_console_drivers;",
            "static int console_locked, console_suspended;",
            "static struct console *exclusive_console;",
            "static int console_may_schedule;",
            "static int console_msg_format = MSG_FORMAT_DEFAULT;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define printk_time\t\tfalse\n#define CONSOLE_LOG_MAX\t\t0\n#define CONSOLE_LOG_MAX\t\t1024\n\nstatic DEFINE_SEMAPHORE(console_sem);\nstatic int nr_ext_console_drivers;\nstatic int console_locked, console_suspended;\nstatic struct console *exclusive_console;\nstatic int console_may_schedule;\nstatic int console_msg_format = MSG_FORMAT_DEFAULT;\n\nvoid console_unlock(void)\n{\n\tstatic char ext_text[CONSOLE_EXT_LOG_MAX];\n\tstatic char text[CONSOLE_LOG_MAX];\n\tunsigned long flags;\n\tbool do_cond_resched, retry;\n\tstruct printk_info info;\n\tstruct printk_record r;\n\tu64 __maybe_unused next_seq;\n\n\tif (console_suspended) {\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tprb_rec_init_rd(&r, &info, text, sizeof(text));\n\n\t/*\n\t * Console drivers are called with interrupts disabled, so\n\t * @console_may_schedule should be cleared before; however, we may\n\t * end up dumping a lot of lines, for example, if called from\n\t * console registration path, and should invoke cond_resched()\n\t * between lines if allowable.  Not doing so can cause a very long\n\t * scheduling stall on a slow console leading to RCU stall and\n\t * softlockup warnings which exacerbate the issue with more\n\t * messages practically incapacitating the system.\n\t *\n\t * console_trylock() is not able to detect the preemptive\n\t * context reliably. Therefore the value must be stored before\n\t * and cleared after the \"again\" goto label.\n\t */\n\tdo_cond_resched = console_may_schedule;\nagain:\n\tconsole_may_schedule = 0;\n\n\t/*\n\t * We released the console_sem lock, so we need to recheck if\n\t * cpu is online and (if not) is there at least one CON_ANYTIME\n\t * console.\n\t */\n\tif (!can_use_console()) {\n\t\tconsole_locked = 0;\n\t\tup_console_sem();\n\t\treturn;\n\t}\n\n\tfor (;;) {\n\t\tsize_t ext_len = 0;\n\t\tint handover;\n\t\tsize_t len;\n\nskip:\n\t\tif (!prb_read_valid(prb, console_seq, &r))\n\t\t\tbreak;\n\n\t\tif (console_seq != r.info->seq) {\n\t\t\tconsole_dropped += r.info->seq - console_seq;\n\t\t\tconsole_seq = r.info->seq;\n\t\t}\n\n\t\tif (suppress_message_printing(r.info->level)) {\n\t\t\t/*\n\t\t\t * Skip record we have buffered and already printed\n\t\t\t * directly to the console when we received it, and\n\t\t\t * record that has level above the console loglevel.\n\t\t\t */\n\t\t\tconsole_seq++;\n\t\t\tgoto skip;\n\t\t}\n\n\t\t/* Output to all consoles once old messages replayed. */\n\t\tif (unlikely(exclusive_console &&\n\t\t\t     console_seq >= exclusive_console_stop_seq)) {\n\t\t\texclusive_console = NULL;\n\t\t}\n\n\t\t/*\n\t\t * Handle extended console text first because later\n\t\t * record_print_text() will modify the record buffer in-place.\n\t\t */\n\t\tif (nr_ext_console_drivers) {\n\t\t\text_len = info_print_ext_header(ext_text,\n\t\t\t\t\t\tsizeof(ext_text),\n\t\t\t\t\t\tr.info);\n\t\t\text_len += msg_print_ext_body(ext_text + ext_len,\n\t\t\t\t\t\tsizeof(ext_text) - ext_len,\n\t\t\t\t\t\t&r.text_buf[0],\n\t\t\t\t\t\tr.info->text_len,\n\t\t\t\t\t\t&r.info->dev_info);\n\t\t}\n\t\tlen = record_print_text(&r,\n\t\t\t\tconsole_msg_format & MSG_FORMAT_SYSLOG,\n\t\t\t\tprintk_time);\n\t\tconsole_seq++;\n\n\t\t/*\n\t\t * While actively printing out messages, if another printk()\n\t\t * were to occur on another CPU, it may wait for this one to\n\t\t * finish. This task can not be preempted if there is a\n\t\t * waiter waiting to take over.\n\t\t *\n\t\t * Interrupts are disabled because the hand over to a waiter\n\t\t * must not be interrupted until the hand over is completed\n\t\t * (@console_waiter is cleared).\n\t\t */\n\t\tprintk_safe_enter_irqsave(flags);\n\t\tconsole_lock_spinning_enable();\n\n\t\tstop_critical_timings();\t/* don't trace print latency */\n\t\tcall_console_drivers(ext_text, ext_len, text, len);\n\t\tstart_critical_timings();\n\n\t\thandover = console_lock_spinning_disable_and_check();\n\t\tprintk_safe_exit_irqrestore(flags);\n\t\tif (handover)\n\t\t\treturn;\n\n\t\tif (do_cond_resched)\n\t\t\tcond_resched();\n\t}\n\n\t/* Get consistent value of the next-to-be-used sequence number. */\n\tnext_seq = console_seq;\n\n\tconsole_locked = 0;\n\tup_console_sem();\n\n\t/*\n\t * Someone could have filled up the buffer again, so re-check if there's\n\t * something to flush. In case we cannot trylock the console_sem again,\n\t * there's a new owner and the console_unlock() from them will do the\n\t * flush, no worries.\n\t */\n\tretry = prb_read_valid(prb, next_seq, NULL);\n\tif (retry && console_trylock())\n\t\tgoto again;\n}"
        }
      },
      {
        "call_info": {
          "callee": "console_trylock_spinning",
          "args": [],
          "line": 2244
        },
        "resolved": true,
        "details": {
          "function_name": "console_trylock_spinning",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "1836-1888",
          "snippet": "static int console_trylock_spinning(void)\n{\n\tstruct task_struct *owner = NULL;\n\tbool waiter;\n\tbool spin = false;\n\tunsigned long flags;\n\n\tif (console_trylock())\n\t\treturn 1;\n\n\tprintk_safe_enter_irqsave(flags);\n\n\traw_spin_lock(&console_owner_lock);\n\towner = READ_ONCE(console_owner);\n\twaiter = READ_ONCE(console_waiter);\n\tif (!waiter && owner && owner != current) {\n\t\tWRITE_ONCE(console_waiter, true);\n\t\tspin = true;\n\t}\n\traw_spin_unlock(&console_owner_lock);\n\n\t/*\n\t * If there is an active printk() writing to the\n\t * consoles, instead of having it write our data too,\n\t * see if we can offload that load from the active\n\t * printer, and do some printing ourselves.\n\t * Go into a spin only if there isn't already a waiter\n\t * spinning, and there is an active printer, and\n\t * that active printer isn't us (recursive printk?).\n\t */\n\tif (!spin) {\n\t\tprintk_safe_exit_irqrestore(flags);\n\t\treturn 0;\n\t}\n\n\t/* We spin waiting for the owner to release us */\n\tspin_acquire(&console_owner_dep_map, 0, 0, _THIS_IP_);\n\t/* Owner will clear console_waiter on hand off */\n\twhile (READ_ONCE(console_waiter))\n\t\tcpu_relax();\n\tspin_release(&console_owner_dep_map, _THIS_IP_);\n\n\tprintk_safe_exit_irqrestore(flags);\n\t/*\n\t * The owner passed the console lock to us.\n\t * Since we did not spin on console lock, annotate\n\t * this as a trylock. Otherwise lockdep will\n\t * complain.\n\t */\n\tmutex_acquire(&console_lock_dep_map, 0, 1, _THIS_IP_);\n\n\treturn 1;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic int console_trylock_spinning(void)\n{\n\tstruct task_struct *owner = NULL;\n\tbool waiter;\n\tbool spin = false;\n\tunsigned long flags;\n\n\tif (console_trylock())\n\t\treturn 1;\n\n\tprintk_safe_enter_irqsave(flags);\n\n\traw_spin_lock(&console_owner_lock);\n\towner = READ_ONCE(console_owner);\n\twaiter = READ_ONCE(console_waiter);\n\tif (!waiter && owner && owner != current) {\n\t\tWRITE_ONCE(console_waiter, true);\n\t\tspin = true;\n\t}\n\traw_spin_unlock(&console_owner_lock);\n\n\t/*\n\t * If there is an active printk() writing to the\n\t * consoles, instead of having it write our data too,\n\t * see if we can offload that load from the active\n\t * printer, and do some printing ourselves.\n\t * Go into a spin only if there isn't already a waiter\n\t * spinning, and there is an active printer, and\n\t * that active printer isn't us (recursive printk?).\n\t */\n\tif (!spin) {\n\t\tprintk_safe_exit_irqrestore(flags);\n\t\treturn 0;\n\t}\n\n\t/* We spin waiting for the owner to release us */\n\tspin_acquire(&console_owner_dep_map, 0, 0, _THIS_IP_);\n\t/* Owner will clear console_waiter on hand off */\n\twhile (READ_ONCE(console_waiter))\n\t\tcpu_relax();\n\tspin_release(&console_owner_dep_map, _THIS_IP_);\n\n\tprintk_safe_exit_irqrestore(flags);\n\t/*\n\t * The owner passed the console lock to us.\n\t * Since we did not spin on console lock, annotate\n\t * this as a trylock. Otherwise lockdep will\n\t * complain.\n\t */\n\tmutex_acquire(&console_lock_dep_map, 0, 1, _THIS_IP_);\n\n\treturn 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "preempt_disable",
          "args": [],
          "line": 2238
        },
        "resolved": true,
        "details": {
          "function_name": "schedule_preempt_disabled",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/core.c",
          "lines": "6425-6430",
          "snippet": "void __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}",
          "includes": [
            "#include <linux/entry-common.h>",
            "#include \"features.h\"",
            "#include \"smp.h\"",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../../fs/io-wq.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/scs.h>",
            "#include <linux/kcov.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\"",
            "#include <trace/events/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void __sched",
            "static void __sched"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/entry-common.h>\n#include \"features.h\"\n#include \"smp.h\"\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../../fs/io-wq.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/scs.h>\n#include <linux/kcov.h>\n#include <linux/blkdev.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n#include <trace/events/sched.h>\n\nstatic void __sched;\nstatic void __sched;\n\nvoid __sched schedule_preempt_disabled(void)\n{\n\tsched_preempt_enable_no_resched();\n\tschedule();\n\tpreempt_disable();\n}"
        }
      },
      {
        "call_info": {
          "callee": "vprintk_store",
          "args": [
            "facility",
            "level",
            "dev_info",
            "fmt",
            "args"
          ],
          "line": 2229
        },
        "resolved": true,
        "details": {
          "function_name": "vprintk_store",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2099-2208",
          "snippet": "int vprintk_store(int facility, int level,\n\t\t  const struct dev_printk_info *dev_info,\n\t\t  const char *fmt, va_list args)\n{\n\tconst u32 caller_id = printk_caller_id();\n\tstruct prb_reserved_entry e;\n\tenum printk_info_flags flags = 0;\n\tstruct printk_record r;\n\tunsigned long irqflags;\n\tu16 trunc_msg_len = 0;\n\tchar prefix_buf[8];\n\tu8 *recursion_ptr;\n\tu16 reserve_size;\n\tva_list args2;\n\tu16 text_len;\n\tint ret = 0;\n\tu64 ts_nsec;\n\n\t/*\n\t * Since the duration of printk() can vary depending on the message\n\t * and state of the ringbuffer, grab the timestamp now so that it is\n\t * close to the call of printk(). This provides a more deterministic\n\t * timestamp with respect to the caller.\n\t */\n\tts_nsec = local_clock();\n\n\tif (!printk_enter_irqsave(recursion_ptr, irqflags))\n\t\treturn 0;\n\n\t/*\n\t * The sprintf needs to come first since the syslog prefix might be\n\t * passed in as a parameter. An extra byte must be reserved so that\n\t * later the vscnprintf() into the reserved buffer has room for the\n\t * terminating '\\0', which is not counted by vsnprintf().\n\t */\n\tva_copy(args2, args);\n\treserve_size = vsnprintf(&prefix_buf[0], sizeof(prefix_buf), fmt, args2) + 1;\n\tva_end(args2);\n\n\tif (reserve_size > LOG_LINE_MAX)\n\t\treserve_size = LOG_LINE_MAX;\n\n\t/* Extract log level or control flags. */\n\tif (facility == 0)\n\t\tprintk_parse_prefix(&prefix_buf[0], &level, &flags);\n\n\tif (level == LOGLEVEL_DEFAULT)\n\t\tlevel = default_message_loglevel;\n\n\tif (dev_info)\n\t\tflags |= LOG_NEWLINE;\n\n\tif (flags & LOG_CONT) {\n\t\tprb_rec_init_wr(&r, reserve_size);\n\t\tif (prb_reserve_in_last(&e, prb, &r, caller_id, LOG_LINE_MAX)) {\n\t\t\ttext_len = printk_sprint(&r.text_buf[r.info->text_len], reserve_size,\n\t\t\t\t\t\t facility, &flags, fmt, args);\n\t\t\tr.info->text_len += text_len;\n\n\t\t\tif (flags & LOG_NEWLINE) {\n\t\t\t\tr.info->flags |= LOG_NEWLINE;\n\t\t\t\tprb_final_commit(&e);\n\t\t\t} else {\n\t\t\t\tprb_commit(&e);\n\t\t\t}\n\n\t\t\tret = text_len;\n\t\t\tgoto out;\n\t\t}\n\t}\n\n\t/*\n\t * Explicitly initialize the record before every prb_reserve() call.\n\t * prb_reserve_in_last() and prb_reserve() purposely invalidate the\n\t * structure when they fail.\n\t */\n\tprb_rec_init_wr(&r, reserve_size);\n\tif (!prb_reserve(&e, prb, &r)) {\n\t\t/* truncate the message if it is too long for empty buffer */\n\t\ttruncate_msg(&reserve_size, &trunc_msg_len);\n\n\t\tprb_rec_init_wr(&r, reserve_size + trunc_msg_len);\n\t\tif (!prb_reserve(&e, prb, &r))\n\t\t\tgoto out;\n\t}\n\n\t/* fill message */\n\ttext_len = printk_sprint(&r.text_buf[0], reserve_size, facility, &flags, fmt, args);\n\tif (trunc_msg_len)\n\t\tmemcpy(&r.text_buf[text_len], trunc_msg, trunc_msg_len);\n\tr.info->text_len = text_len + trunc_msg_len;\n\tr.info->facility = facility;\n\tr.info->level = level & 7;\n\tr.info->flags = flags & 0x1f;\n\tr.info->ts_nsec = ts_nsec;\n\tr.info->caller_id = caller_id;\n\tif (dev_info)\n\t\tmemcpy(&r.info->dev_info, dev_info, sizeof(r.info->dev_info));\n\n\t/* A message without a trailing newline can be continued. */\n\tif (!(flags & LOG_NEWLINE))\n\t\tprb_commit(&e);\n\telse\n\t\tprb_final_commit(&e);\n\n\tret = text_len + trunc_msg_len;\nout:\n\tprintk_exit_irqrestore(recursion_ptr, irqflags);\n\treturn ret;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define LOG_LINE_MAX\t\t(CONSOLE_LOG_MAX - PREFIX_MAX)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define LOG_LINE_MAX\t\t(CONSOLE_LOG_MAX - PREFIX_MAX)\n\nint vprintk_store(int facility, int level,\n\t\t  const struct dev_printk_info *dev_info,\n\t\t  const char *fmt, va_list args)\n{\n\tconst u32 caller_id = printk_caller_id();\n\tstruct prb_reserved_entry e;\n\tenum printk_info_flags flags = 0;\n\tstruct printk_record r;\n\tunsigned long irqflags;\n\tu16 trunc_msg_len = 0;\n\tchar prefix_buf[8];\n\tu8 *recursion_ptr;\n\tu16 reserve_size;\n\tva_list args2;\n\tu16 text_len;\n\tint ret = 0;\n\tu64 ts_nsec;\n\n\t/*\n\t * Since the duration of printk() can vary depending on the message\n\t * and state of the ringbuffer, grab the timestamp now so that it is\n\t * close to the call of printk(). This provides a more deterministic\n\t * timestamp with respect to the caller.\n\t */\n\tts_nsec = local_clock();\n\n\tif (!printk_enter_irqsave(recursion_ptr, irqflags))\n\t\treturn 0;\n\n\t/*\n\t * The sprintf needs to come first since the syslog prefix might be\n\t * passed in as a parameter. An extra byte must be reserved so that\n\t * later the vscnprintf() into the reserved buffer has room for the\n\t * terminating '\\0', which is not counted by vsnprintf().\n\t */\n\tva_copy(args2, args);\n\treserve_size = vsnprintf(&prefix_buf[0], sizeof(prefix_buf), fmt, args2) + 1;\n\tva_end(args2);\n\n\tif (reserve_size > LOG_LINE_MAX)\n\t\treserve_size = LOG_LINE_MAX;\n\n\t/* Extract log level or control flags. */\n\tif (facility == 0)\n\t\tprintk_parse_prefix(&prefix_buf[0], &level, &flags);\n\n\tif (level == LOGLEVEL_DEFAULT)\n\t\tlevel = default_message_loglevel;\n\n\tif (dev_info)\n\t\tflags |= LOG_NEWLINE;\n\n\tif (flags & LOG_CONT) {\n\t\tprb_rec_init_wr(&r, reserve_size);\n\t\tif (prb_reserve_in_last(&e, prb, &r, caller_id, LOG_LINE_MAX)) {\n\t\t\ttext_len = printk_sprint(&r.text_buf[r.info->text_len], reserve_size,\n\t\t\t\t\t\t facility, &flags, fmt, args);\n\t\t\tr.info->text_len += text_len;\n\n\t\t\tif (flags & LOG_NEWLINE) {\n\t\t\t\tr.info->flags |= LOG_NEWLINE;\n\t\t\t\tprb_final_commit(&e);\n\t\t\t} else {\n\t\t\t\tprb_commit(&e);\n\t\t\t}\n\n\t\t\tret = text_len;\n\t\t\tgoto out;\n\t\t}\n\t}\n\n\t/*\n\t * Explicitly initialize the record before every prb_reserve() call.\n\t * prb_reserve_in_last() and prb_reserve() purposely invalidate the\n\t * structure when they fail.\n\t */\n\tprb_rec_init_wr(&r, reserve_size);\n\tif (!prb_reserve(&e, prb, &r)) {\n\t\t/* truncate the message if it is too long for empty buffer */\n\t\ttruncate_msg(&reserve_size, &trunc_msg_len);\n\n\t\tprb_rec_init_wr(&r, reserve_size + trunc_msg_len);\n\t\tif (!prb_reserve(&e, prb, &r))\n\t\t\tgoto out;\n\t}\n\n\t/* fill message */\n\ttext_len = printk_sprint(&r.text_buf[0], reserve_size, facility, &flags, fmt, args);\n\tif (trunc_msg_len)\n\t\tmemcpy(&r.text_buf[text_len], trunc_msg, trunc_msg_len);\n\tr.info->text_len = text_len + trunc_msg_len;\n\tr.info->facility = facility;\n\tr.info->level = level & 7;\n\tr.info->flags = flags & 0x1f;\n\tr.info->ts_nsec = ts_nsec;\n\tr.info->caller_id = caller_id;\n\tif (dev_info)\n\t\tmemcpy(&r.info->dev_info, dev_info, sizeof(r.info->dev_info));\n\n\t/* A message without a trailing newline can be continued. */\n\tif (!(flags & LOG_NEWLINE))\n\t\tprb_commit(&e);\n\telse\n\t\tprb_final_commit(&e);\n\n\tret = text_len + trunc_msg_len;\nout:\n\tprintk_exit_irqrestore(recursion_ptr, irqflags);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk_delay",
          "args": [],
          "line": 2227
        },
        "resolved": true,
        "details": {
          "function_name": "printk_delay",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2006-2016",
          "snippet": "static inline void printk_delay(void)\n{\n\tif (unlikely(printk_delay_msec)) {\n\t\tint m = printk_delay_msec;\n\n\t\twhile (m--) {\n\t\t\tmdelay(1);\n\t\t\ttouch_nmi_watchdog();\n\t\t}\n\t}\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic inline void printk_delay(void)\n{\n\tif (unlikely(printk_delay_msec)) {\n\t\tint m = printk_delay_msec;\n\n\t\twhile (m--) {\n\t\t\tmdelay(1);\n\t\t\ttouch_nmi_watchdog();\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "boot_delay_msec",
          "args": [
            "level"
          ],
          "line": 2226
        },
        "resolved": true,
        "details": {
          "function_name": "boot_delay_msec",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "1244-1246",
          "snippet": "static inline void boot_delay_msec(int level)\n{\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic inline void boot_delay_msec(int level)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "suppress_printk"
          ],
          "line": 2218
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic DEFINE_SEMAPHORE(console_sem);\n\nasmlinkage int vprintk_emit(int facility, int level,\n\t\t\t    const struct dev_printk_info *dev_info,\n\t\t\t    const char *fmt, va_list args)\n{\n\tint printed_len;\n\tbool in_sched = false;\n\n\t/* Suppress unimportant messages after panic happens */\n\tif (unlikely(suppress_printk))\n\t\treturn 0;\n\n\tif (level == LOGLEVEL_SCHED) {\n\t\tlevel = LOGLEVEL_DEFAULT;\n\t\tin_sched = true;\n\t}\n\n\tboot_delay_msec(level);\n\tprintk_delay();\n\n\tprinted_len = vprintk_store(facility, level, dev_info, fmt, args);\n\n\t/* If called from the scheduler, we can not call up(). */\n\tif (!in_sched) {\n\t\t/*\n\t\t * Disable preemption to avoid being preempted while holding\n\t\t * console_sem which would prevent anyone from printing to\n\t\t * console\n\t\t */\n\t\tpreempt_disable();\n\t\t/*\n\t\t * Try to acquire and then immediately release the console\n\t\t * semaphore.  The release will print out buffers and wake up\n\t\t * /dev/kmsg and syslog() users.\n\t\t */\n\t\tif (console_trylock_spinning())\n\t\t\tconsole_unlock();\n\t\tpreempt_enable();\n\t}\n\n\twake_up_klogd();\n\treturn printed_len;\n}"
  },
  {
    "function_name": "vprintk_store",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2099-2208",
    "snippet": "int vprintk_store(int facility, int level,\n\t\t  const struct dev_printk_info *dev_info,\n\t\t  const char *fmt, va_list args)\n{\n\tconst u32 caller_id = printk_caller_id();\n\tstruct prb_reserved_entry e;\n\tenum printk_info_flags flags = 0;\n\tstruct printk_record r;\n\tunsigned long irqflags;\n\tu16 trunc_msg_len = 0;\n\tchar prefix_buf[8];\n\tu8 *recursion_ptr;\n\tu16 reserve_size;\n\tva_list args2;\n\tu16 text_len;\n\tint ret = 0;\n\tu64 ts_nsec;\n\n\t/*\n\t * Since the duration of printk() can vary depending on the message\n\t * and state of the ringbuffer, grab the timestamp now so that it is\n\t * close to the call of printk(). This provides a more deterministic\n\t * timestamp with respect to the caller.\n\t */\n\tts_nsec = local_clock();\n\n\tif (!printk_enter_irqsave(recursion_ptr, irqflags))\n\t\treturn 0;\n\n\t/*\n\t * The sprintf needs to come first since the syslog prefix might be\n\t * passed in as a parameter. An extra byte must be reserved so that\n\t * later the vscnprintf() into the reserved buffer has room for the\n\t * terminating '\\0', which is not counted by vsnprintf().\n\t */\n\tva_copy(args2, args);\n\treserve_size = vsnprintf(&prefix_buf[0], sizeof(prefix_buf), fmt, args2) + 1;\n\tva_end(args2);\n\n\tif (reserve_size > LOG_LINE_MAX)\n\t\treserve_size = LOG_LINE_MAX;\n\n\t/* Extract log level or control flags. */\n\tif (facility == 0)\n\t\tprintk_parse_prefix(&prefix_buf[0], &level, &flags);\n\n\tif (level == LOGLEVEL_DEFAULT)\n\t\tlevel = default_message_loglevel;\n\n\tif (dev_info)\n\t\tflags |= LOG_NEWLINE;\n\n\tif (flags & LOG_CONT) {\n\t\tprb_rec_init_wr(&r, reserve_size);\n\t\tif (prb_reserve_in_last(&e, prb, &r, caller_id, LOG_LINE_MAX)) {\n\t\t\ttext_len = printk_sprint(&r.text_buf[r.info->text_len], reserve_size,\n\t\t\t\t\t\t facility, &flags, fmt, args);\n\t\t\tr.info->text_len += text_len;\n\n\t\t\tif (flags & LOG_NEWLINE) {\n\t\t\t\tr.info->flags |= LOG_NEWLINE;\n\t\t\t\tprb_final_commit(&e);\n\t\t\t} else {\n\t\t\t\tprb_commit(&e);\n\t\t\t}\n\n\t\t\tret = text_len;\n\t\t\tgoto out;\n\t\t}\n\t}\n\n\t/*\n\t * Explicitly initialize the record before every prb_reserve() call.\n\t * prb_reserve_in_last() and prb_reserve() purposely invalidate the\n\t * structure when they fail.\n\t */\n\tprb_rec_init_wr(&r, reserve_size);\n\tif (!prb_reserve(&e, prb, &r)) {\n\t\t/* truncate the message if it is too long for empty buffer */\n\t\ttruncate_msg(&reserve_size, &trunc_msg_len);\n\n\t\tprb_rec_init_wr(&r, reserve_size + trunc_msg_len);\n\t\tif (!prb_reserve(&e, prb, &r))\n\t\t\tgoto out;\n\t}\n\n\t/* fill message */\n\ttext_len = printk_sprint(&r.text_buf[0], reserve_size, facility, &flags, fmt, args);\n\tif (trunc_msg_len)\n\t\tmemcpy(&r.text_buf[text_len], trunc_msg, trunc_msg_len);\n\tr.info->text_len = text_len + trunc_msg_len;\n\tr.info->facility = facility;\n\tr.info->level = level & 7;\n\tr.info->flags = flags & 0x1f;\n\tr.info->ts_nsec = ts_nsec;\n\tr.info->caller_id = caller_id;\n\tif (dev_info)\n\t\tmemcpy(&r.info->dev_info, dev_info, sizeof(r.info->dev_info));\n\n\t/* A message without a trailing newline can be continued. */\n\tif (!(flags & LOG_NEWLINE))\n\t\tprb_commit(&e);\n\telse\n\t\tprb_final_commit(&e);\n\n\tret = text_len + trunc_msg_len;\nout:\n\tprintk_exit_irqrestore(recursion_ptr, irqflags);\n\treturn ret;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define LOG_LINE_MAX\t\t(CONSOLE_LOG_MAX - PREFIX_MAX)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk_exit_irqrestore",
          "args": [
            "recursion_ptr",
            "irqflags"
          ],
          "line": 2206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prb_final_commit",
          "args": [
            "&e"
          ],
          "line": 2202
        },
        "resolved": true,
        "details": {
          "function_name": "prb_final_commit",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk_ringbuffer.c",
          "lines": "1658-1661",
          "snippet": "void prb_final_commit(struct prb_reserved_entry *e)\n{\n\t_prb_commit(e, desc_finalized);\n}",
          "includes": [
            "#include \"printk_ringbuffer.h\"",
            "#include <linux/bug.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/irqflags.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"printk_ringbuffer.h\"\n#include <linux/bug.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/irqflags.h>\n#include <linux/kernel.h>\n\nvoid prb_final_commit(struct prb_reserved_entry *e)\n{\n\t_prb_commit(e, desc_finalized);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prb_commit",
          "args": [
            "&e"
          ],
          "line": 2200
        },
        "resolved": true,
        "details": {
          "function_name": "prb_commit",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk_ringbuffer.c",
          "lines": "1626-1641",
          "snippet": "void prb_commit(struct prb_reserved_entry *e)\n{\n\tstruct prb_desc_ring *desc_ring = &e->rb->desc_ring;\n\tunsigned long head_id;\n\n\t_prb_commit(e, desc_committed);\n\n\t/*\n\t * If this descriptor is no longer the head (i.e. a new record has\n\t * been allocated), extending the data for this record is no longer\n\t * allowed and therefore it must be finalized.\n\t */\n\thead_id = atomic_long_read(&desc_ring->head_id); /* LMM(prb_commit:A) */\n\tif (head_id != e->id)\n\t\tdesc_make_final(desc_ring, e->id);\n}",
          "includes": [
            "#include \"printk_ringbuffer.h\"",
            "#include <linux/bug.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/irqflags.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"printk_ringbuffer.h\"\n#include <linux/bug.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/irqflags.h>\n#include <linux/kernel.h>\n\nvoid prb_commit(struct prb_reserved_entry *e)\n{\n\tstruct prb_desc_ring *desc_ring = &e->rb->desc_ring;\n\tunsigned long head_id;\n\n\t_prb_commit(e, desc_committed);\n\n\t/*\n\t * If this descriptor is no longer the head (i.e. a new record has\n\t * been allocated), extending the data for this record is no longer\n\t * allowed and therefore it must be finalized.\n\t */\n\thead_id = atomic_long_read(&desc_ring->head_id); /* LMM(prb_commit:A) */\n\tif (head_id != e->id)\n\t\tdesc_make_final(desc_ring, e->id);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&r.info->dev_info",
            "dev_info",
            "sizeof(r.info->dev_info)"
          ],
          "line": 2196
        },
        "resolved": true,
        "details": {
          "function_name": "memcpy_skip",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/events/internal.h",
          "lines": "180-184",
          "snippet": "static inline unsigned long\nmemcpy_skip(void *dst, const void *src, unsigned long n)\n{\n\treturn 0;\n}",
          "includes": [
            "#include <linux/refcount.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hardirq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/refcount.h>\n#include <linux/uaccess.h>\n#include <linux/hardirq.h>\n\nstatic inline unsigned long\nmemcpy_skip(void *dst, const void *src, unsigned long n)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk_sprint",
          "args": [
            "&r.text_buf[0]",
            "reserve_size",
            "facility",
            "&flags",
            "fmt",
            "args"
          ],
          "line": 2186
        },
        "resolved": true,
        "details": {
          "function_name": "printk_sprint",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2070-2096",
          "snippet": "static u16 printk_sprint(char *text, u16 size, int facility,\n\t\t\t enum printk_info_flags *flags, const char *fmt,\n\t\t\t va_list args)\n{\n\tu16 text_len;\n\n\ttext_len = vscnprintf(text, size, fmt, args);\n\n\t/* Mark and strip a trailing newline. */\n\tif (text_len && text[text_len - 1] == '\\n') {\n\t\ttext_len--;\n\t\t*flags |= LOG_NEWLINE;\n\t}\n\n\t/* Strip log level and control flags. */\n\tif (facility == 0) {\n\t\tu16 prefix_len;\n\n\t\tprefix_len = printk_parse_prefix(text, NULL, NULL);\n\t\tif (prefix_len) {\n\t\t\ttext_len -= prefix_len;\n\t\t\tmemmove(text, text + prefix_len, text_len);\n\t\t}\n\t}\n\n\treturn text_len;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic u16 printk_sprint(char *text, u16 size, int facility,\n\t\t\t enum printk_info_flags *flags, const char *fmt,\n\t\t\t va_list args)\n{\n\tu16 text_len;\n\n\ttext_len = vscnprintf(text, size, fmt, args);\n\n\t/* Mark and strip a trailing newline. */\n\tif (text_len && text[text_len - 1] == '\\n') {\n\t\ttext_len--;\n\t\t*flags |= LOG_NEWLINE;\n\t}\n\n\t/* Strip log level and control flags. */\n\tif (facility == 0) {\n\t\tu16 prefix_len;\n\n\t\tprefix_len = printk_parse_prefix(text, NULL, NULL);\n\t\tif (prefix_len) {\n\t\t\ttext_len -= prefix_len;\n\t\t\tmemmove(text, text + prefix_len, text_len);\n\t\t}\n\t}\n\n\treturn text_len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prb_reserve",
          "args": [
            "&e",
            "prb",
            "&r"
          ],
          "line": 2181
        },
        "resolved": true,
        "details": {
          "function_name": "prb_reserve",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk_ringbuffer.c",
          "lines": "1479-1567",
          "snippet": "bool prb_reserve(struct prb_reserved_entry *e, struct printk_ringbuffer *rb,\n\t\t struct printk_record *r)\n{\n\tstruct prb_desc_ring *desc_ring = &rb->desc_ring;\n\tstruct printk_info *info;\n\tstruct prb_desc *d;\n\tunsigned long id;\n\tu64 seq;\n\n\tif (!data_check_size(&rb->text_data_ring, r->text_buf_size))\n\t\tgoto fail;\n\n\t/*\n\t * Descriptors in the reserved state act as blockers to all further\n\t * reservations once the desc_ring has fully wrapped. Disable\n\t * interrupts during the reserve/commit window in order to minimize\n\t * the likelihood of this happening.\n\t */\n\tlocal_irq_save(e->irqflags);\n\n\tif (!desc_reserve(rb, &id)) {\n\t\t/* Descriptor reservation failures are tracked. */\n\t\tatomic_long_inc(&rb->fail);\n\t\tlocal_irq_restore(e->irqflags);\n\t\tgoto fail;\n\t}\n\n\td = to_desc(desc_ring, id);\n\tinfo = to_info(desc_ring, id);\n\n\t/*\n\t * All @info fields (except @seq) are cleared and must be filled in\n\t * by the writer. Save @seq before clearing because it is used to\n\t * determine the new sequence number.\n\t */\n\tseq = info->seq;\n\tmemset(info, 0, sizeof(*info));\n\n\t/*\n\t * Set the @e fields here so that prb_commit() can be used if\n\t * text data allocation fails.\n\t */\n\te->rb = rb;\n\te->id = id;\n\n\t/*\n\t * Initialize the sequence number if it has \"never been set\".\n\t * Otherwise just increment it by a full wrap.\n\t *\n\t * @seq is considered \"never been set\" if it has a value of 0,\n\t * _except_ for @infos[0], which was specially setup by the ringbuffer\n\t * initializer and therefore is always considered as set.\n\t *\n\t * See the \"Bootstrap\" comment block in printk_ringbuffer.h for\n\t * details about how the initializer bootstraps the descriptors.\n\t */\n\tif (seq == 0 && DESC_INDEX(desc_ring, id) != 0)\n\t\tinfo->seq = DESC_INDEX(desc_ring, id);\n\telse\n\t\tinfo->seq = seq + DESCS_COUNT(desc_ring);\n\n\t/*\n\t * New data is about to be reserved. Once that happens, previous\n\t * descriptors are no longer able to be extended. Finalize the\n\t * previous descriptor now so that it can be made available to\n\t * readers. (For seq==0 there is no previous descriptor.)\n\t */\n\tif (info->seq > 0)\n\t\tdesc_make_final(desc_ring, DESC_ID(id - 1));\n\n\tr->text_buf = data_alloc(rb, r->text_buf_size, &d->text_blk_lpos, id);\n\t/* If text data allocation fails, a data-less record is committed. */\n\tif (r->text_buf_size && !r->text_buf) {\n\t\tprb_commit(e);\n\t\t/* prb_commit() re-enabled interrupts. */\n\t\tgoto fail;\n\t}\n\n\tr->info = info;\n\n\t/* Record full text space used by record. */\n\te->text_space = space_used(&rb->text_data_ring, &d->text_blk_lpos);\n\n\treturn true;\nfail:\n\t/* Make it clear to the caller that the reserve failed. */\n\tmemset(r, 0, sizeof(*r));\n\treturn false;\n}",
          "includes": [
            "#include \"printk_ringbuffer.h\"",
            "#include <linux/bug.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/irqflags.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"printk_ringbuffer.h\"\n#include <linux/bug.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/irqflags.h>\n#include <linux/kernel.h>\n\nbool prb_reserve(struct prb_reserved_entry *e, struct printk_ringbuffer *rb,\n\t\t struct printk_record *r)\n{\n\tstruct prb_desc_ring *desc_ring = &rb->desc_ring;\n\tstruct printk_info *info;\n\tstruct prb_desc *d;\n\tunsigned long id;\n\tu64 seq;\n\n\tif (!data_check_size(&rb->text_data_ring, r->text_buf_size))\n\t\tgoto fail;\n\n\t/*\n\t * Descriptors in the reserved state act as blockers to all further\n\t * reservations once the desc_ring has fully wrapped. Disable\n\t * interrupts during the reserve/commit window in order to minimize\n\t * the likelihood of this happening.\n\t */\n\tlocal_irq_save(e->irqflags);\n\n\tif (!desc_reserve(rb, &id)) {\n\t\t/* Descriptor reservation failures are tracked. */\n\t\tatomic_long_inc(&rb->fail);\n\t\tlocal_irq_restore(e->irqflags);\n\t\tgoto fail;\n\t}\n\n\td = to_desc(desc_ring, id);\n\tinfo = to_info(desc_ring, id);\n\n\t/*\n\t * All @info fields (except @seq) are cleared and must be filled in\n\t * by the writer. Save @seq before clearing because it is used to\n\t * determine the new sequence number.\n\t */\n\tseq = info->seq;\n\tmemset(info, 0, sizeof(*info));\n\n\t/*\n\t * Set the @e fields here so that prb_commit() can be used if\n\t * text data allocation fails.\n\t */\n\te->rb = rb;\n\te->id = id;\n\n\t/*\n\t * Initialize the sequence number if it has \"never been set\".\n\t * Otherwise just increment it by a full wrap.\n\t *\n\t * @seq is considered \"never been set\" if it has a value of 0,\n\t * _except_ for @infos[0], which was specially setup by the ringbuffer\n\t * initializer and therefore is always considered as set.\n\t *\n\t * See the \"Bootstrap\" comment block in printk_ringbuffer.h for\n\t * details about how the initializer bootstraps the descriptors.\n\t */\n\tif (seq == 0 && DESC_INDEX(desc_ring, id) != 0)\n\t\tinfo->seq = DESC_INDEX(desc_ring, id);\n\telse\n\t\tinfo->seq = seq + DESCS_COUNT(desc_ring);\n\n\t/*\n\t * New data is about to be reserved. Once that happens, previous\n\t * descriptors are no longer able to be extended. Finalize the\n\t * previous descriptor now so that it can be made available to\n\t * readers. (For seq==0 there is no previous descriptor.)\n\t */\n\tif (info->seq > 0)\n\t\tdesc_make_final(desc_ring, DESC_ID(id - 1));\n\n\tr->text_buf = data_alloc(rb, r->text_buf_size, &d->text_blk_lpos, id);\n\t/* If text data allocation fails, a data-less record is committed. */\n\tif (r->text_buf_size && !r->text_buf) {\n\t\tprb_commit(e);\n\t\t/* prb_commit() re-enabled interrupts. */\n\t\tgoto fail;\n\t}\n\n\tr->info = info;\n\n\t/* Record full text space used by record. */\n\te->text_space = space_used(&rb->text_data_ring, &d->text_blk_lpos);\n\n\treturn true;\nfail:\n\t/* Make it clear to the caller that the reserve failed. */\n\tmemset(r, 0, sizeof(*r));\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prb_rec_init_wr",
          "args": [
            "&r",
            "reserve_size + trunc_msg_len"
          ],
          "line": 2180
        },
        "resolved": true,
        "details": {
          "function_name": "prb_rec_init_wr",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk_ringbuffer.h",
          "lines": "295-301",
          "snippet": "static inline void prb_rec_init_wr(struct printk_record *r,\n\t\t\t\t   unsigned int text_buf_size)\n{\n\tr->info = NULL;\n\tr->text_buf = NULL;\n\tr->text_buf_size = text_buf_size;\n}",
          "includes": [
            "#include <linux/dev_printk.h>",
            "#include <linux/atomic.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/dev_printk.h>\n#include <linux/atomic.h>\n\nstatic inline void prb_rec_init_wr(struct printk_record *r,\n\t\t\t\t   unsigned int text_buf_size)\n{\n\tr->info = NULL;\n\tr->text_buf = NULL;\n\tr->text_buf_size = text_buf_size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "truncate_msg",
          "args": [
            "&reserve_size",
            "&trunc_msg_len"
          ],
          "line": 2178
        },
        "resolved": true,
        "details": {
          "function_name": "truncate_msg",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "483-500",
          "snippet": "static void truncate_msg(u16 *text_len, u16 *trunc_msg_len)\n{\n\t/*\n\t * The message should not take the whole buffer. Otherwise, it might\n\t * get removed too soon.\n\t */\n\tu32 max_text_len = log_buf_len / MAX_LOG_TAKE_PART;\n\n\tif (*text_len > max_text_len)\n\t\t*text_len = max_text_len;\n\n\t/* enable the warning message (if there is room) */\n\t*trunc_msg_len = strlen(trunc_msg);\n\tif (*text_len >= *trunc_msg_len)\n\t\t*text_len -= *trunc_msg_len;\n\telse\n\t\t*trunc_msg_len = 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define MAX_LOG_TAKE_PART 4"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define MAX_LOG_TAKE_PART 4\n\nstatic void truncate_msg(u16 *text_len, u16 *trunc_msg_len)\n{\n\t/*\n\t * The message should not take the whole buffer. Otherwise, it might\n\t * get removed too soon.\n\t */\n\tu32 max_text_len = log_buf_len / MAX_LOG_TAKE_PART;\n\n\tif (*text_len > max_text_len)\n\t\t*text_len = max_text_len;\n\n\t/* enable the warning message (if there is room) */\n\t*trunc_msg_len = strlen(trunc_msg);\n\tif (*text_len >= *trunc_msg_len)\n\t\t*text_len -= *trunc_msg_len;\n\telse\n\t\t*trunc_msg_len = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prb_reserve_in_last",
          "args": [
            "&e",
            "prb",
            "&r",
            "caller_id",
            "LOG_LINE_MAX"
          ],
          "line": 2153
        },
        "resolved": true,
        "details": {
          "function_name": "prb_reserve_in_last",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk_ringbuffer.c",
          "lines": "1347-1439",
          "snippet": "bool prb_reserve_in_last(struct prb_reserved_entry *e, struct printk_ringbuffer *rb,\n\t\t\t struct printk_record *r, u32 caller_id, unsigned int max_size)\n{\n\tstruct prb_desc_ring *desc_ring = &rb->desc_ring;\n\tstruct printk_info *info;\n\tunsigned int data_size;\n\tstruct prb_desc *d;\n\tunsigned long id;\n\n\tlocal_irq_save(e->irqflags);\n\n\t/* Transition the newest descriptor back to the reserved state. */\n\td = desc_reopen_last(desc_ring, caller_id, &id);\n\tif (!d) {\n\t\tlocal_irq_restore(e->irqflags);\n\t\tgoto fail_reopen;\n\t}\n\n\t/* Now the writer has exclusive access: LMM(prb_reserve_in_last:A) */\n\n\tinfo = to_info(desc_ring, id);\n\n\t/*\n\t * Set the @e fields here so that prb_commit() can be used if\n\t * anything fails from now on.\n\t */\n\te->rb = rb;\n\te->id = id;\n\n\t/*\n\t * desc_reopen_last() checked the caller_id, but there was no\n\t * exclusive access at that point. The descriptor may have\n\t * changed since then.\n\t */\n\tif (caller_id != info->caller_id)\n\t\tgoto fail;\n\n\tif (BLK_DATALESS(&d->text_blk_lpos)) {\n\t\tif (WARN_ON_ONCE(info->text_len != 0)) {\n\t\t\tpr_warn_once(\"wrong text_len value (%hu, expecting 0)\\n\",\n\t\t\t\t     info->text_len);\n\t\t\tinfo->text_len = 0;\n\t\t}\n\n\t\tif (!data_check_size(&rb->text_data_ring, r->text_buf_size))\n\t\t\tgoto fail;\n\n\t\tif (r->text_buf_size > max_size)\n\t\t\tgoto fail;\n\n\t\tr->text_buf = data_alloc(rb, r->text_buf_size,\n\t\t\t\t\t &d->text_blk_lpos, id);\n\t} else {\n\t\tif (!get_data(&rb->text_data_ring, &d->text_blk_lpos, &data_size))\n\t\t\tgoto fail;\n\n\t\t/*\n\t\t * Increase the buffer size to include the original size. If\n\t\t * the meta data (@text_len) is not sane, use the full data\n\t\t * block size.\n\t\t */\n\t\tif (WARN_ON_ONCE(info->text_len > data_size)) {\n\t\t\tpr_warn_once(\"wrong text_len value (%hu, expecting <=%u)\\n\",\n\t\t\t\t     info->text_len, data_size);\n\t\t\tinfo->text_len = data_size;\n\t\t}\n\t\tr->text_buf_size += info->text_len;\n\n\t\tif (!data_check_size(&rb->text_data_ring, r->text_buf_size))\n\t\t\tgoto fail;\n\n\t\tif (r->text_buf_size > max_size)\n\t\t\tgoto fail;\n\n\t\tr->text_buf = data_realloc(rb, r->text_buf_size,\n\t\t\t\t\t   &d->text_blk_lpos, id);\n\t}\n\tif (r->text_buf_size && !r->text_buf)\n\t\tgoto fail;\n\n\tr->info = info;\n\n\te->text_space = space_used(&rb->text_data_ring, &d->text_blk_lpos);\n\n\treturn true;\nfail:\n\tprb_commit(e);\n\t/* prb_commit() re-enabled interrupts. */\nfail_reopen:\n\t/* Make it clear to the caller that the re-reserve failed. */\n\tmemset(r, 0, sizeof(*r));\n\treturn false;\n}",
          "includes": [
            "#include \"printk_ringbuffer.h\"",
            "#include <linux/bug.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/irqflags.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"printk_ringbuffer.h\"\n#include <linux/bug.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/irqflags.h>\n#include <linux/kernel.h>\n\nbool prb_reserve_in_last(struct prb_reserved_entry *e, struct printk_ringbuffer *rb,\n\t\t\t struct printk_record *r, u32 caller_id, unsigned int max_size)\n{\n\tstruct prb_desc_ring *desc_ring = &rb->desc_ring;\n\tstruct printk_info *info;\n\tunsigned int data_size;\n\tstruct prb_desc *d;\n\tunsigned long id;\n\n\tlocal_irq_save(e->irqflags);\n\n\t/* Transition the newest descriptor back to the reserved state. */\n\td = desc_reopen_last(desc_ring, caller_id, &id);\n\tif (!d) {\n\t\tlocal_irq_restore(e->irqflags);\n\t\tgoto fail_reopen;\n\t}\n\n\t/* Now the writer has exclusive access: LMM(prb_reserve_in_last:A) */\n\n\tinfo = to_info(desc_ring, id);\n\n\t/*\n\t * Set the @e fields here so that prb_commit() can be used if\n\t * anything fails from now on.\n\t */\n\te->rb = rb;\n\te->id = id;\n\n\t/*\n\t * desc_reopen_last() checked the caller_id, but there was no\n\t * exclusive access at that point. The descriptor may have\n\t * changed since then.\n\t */\n\tif (caller_id != info->caller_id)\n\t\tgoto fail;\n\n\tif (BLK_DATALESS(&d->text_blk_lpos)) {\n\t\tif (WARN_ON_ONCE(info->text_len != 0)) {\n\t\t\tpr_warn_once(\"wrong text_len value (%hu, expecting 0)\\n\",\n\t\t\t\t     info->text_len);\n\t\t\tinfo->text_len = 0;\n\t\t}\n\n\t\tif (!data_check_size(&rb->text_data_ring, r->text_buf_size))\n\t\t\tgoto fail;\n\n\t\tif (r->text_buf_size > max_size)\n\t\t\tgoto fail;\n\n\t\tr->text_buf = data_alloc(rb, r->text_buf_size,\n\t\t\t\t\t &d->text_blk_lpos, id);\n\t} else {\n\t\tif (!get_data(&rb->text_data_ring, &d->text_blk_lpos, &data_size))\n\t\t\tgoto fail;\n\n\t\t/*\n\t\t * Increase the buffer size to include the original size. If\n\t\t * the meta data (@text_len) is not sane, use the full data\n\t\t * block size.\n\t\t */\n\t\tif (WARN_ON_ONCE(info->text_len > data_size)) {\n\t\t\tpr_warn_once(\"wrong text_len value (%hu, expecting <=%u)\\n\",\n\t\t\t\t     info->text_len, data_size);\n\t\t\tinfo->text_len = data_size;\n\t\t}\n\t\tr->text_buf_size += info->text_len;\n\n\t\tif (!data_check_size(&rb->text_data_ring, r->text_buf_size))\n\t\t\tgoto fail;\n\n\t\tif (r->text_buf_size > max_size)\n\t\t\tgoto fail;\n\n\t\tr->text_buf = data_realloc(rb, r->text_buf_size,\n\t\t\t\t\t   &d->text_blk_lpos, id);\n\t}\n\tif (r->text_buf_size && !r->text_buf)\n\t\tgoto fail;\n\n\tr->info = info;\n\n\te->text_space = space_used(&rb->text_data_ring, &d->text_blk_lpos);\n\n\treturn true;\nfail:\n\tprb_commit(e);\n\t/* prb_commit() re-enabled interrupts. */\nfail_reopen:\n\t/* Make it clear to the caller that the re-reserve failed. */\n\tmemset(r, 0, sizeof(*r));\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk_parse_prefix",
          "args": [
            "&prefix_buf[0]",
            "&level",
            "&flags"
          ],
          "line": 2143
        },
        "resolved": true,
        "details": {
          "function_name": "printk_parse_prefix",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2041-2067",
          "snippet": "u16 printk_parse_prefix(const char *text, int *level,\n\t\t\tenum printk_info_flags *flags)\n{\n\tu16 prefix_len = 0;\n\tint kern_level;\n\n\twhile (*text) {\n\t\tkern_level = printk_get_level(text);\n\t\tif (!kern_level)\n\t\t\tbreak;\n\n\t\tswitch (kern_level) {\n\t\tcase '0' ... '7':\n\t\t\tif (level && *level == LOGLEVEL_DEFAULT)\n\t\t\t\t*level = kern_level - '0';\n\t\t\tbreak;\n\t\tcase 'c':\t/* KERN_CONT */\n\t\t\tif (flags)\n\t\t\t\t*flags |= LOG_CONT;\n\t\t}\n\n\t\tprefix_len += 2;\n\t\ttext += 2;\n\t}\n\n\treturn prefix_len;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nu16 printk_parse_prefix(const char *text, int *level,\n\t\t\tenum printk_info_flags *flags)\n{\n\tu16 prefix_len = 0;\n\tint kern_level;\n\n\twhile (*text) {\n\t\tkern_level = printk_get_level(text);\n\t\tif (!kern_level)\n\t\t\tbreak;\n\n\t\tswitch (kern_level) {\n\t\tcase '0' ... '7':\n\t\t\tif (level && *level == LOGLEVEL_DEFAULT)\n\t\t\t\t*level = kern_level - '0';\n\t\t\tbreak;\n\t\tcase 'c':\t/* KERN_CONT */\n\t\t\tif (flags)\n\t\t\t\t*flags |= LOG_CONT;\n\t\t}\n\n\t\tprefix_len += 2;\n\t\ttext += 2;\n\t}\n\n\treturn prefix_len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "args2"
          ],
          "line": 2136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vsnprintf",
          "args": [
            "&prefix_buf[0]",
            "sizeof(prefix_buf)",
            "fmt",
            "args2"
          ],
          "line": 2135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_copy",
          "args": [
            "args2",
            "args"
          ],
          "line": 2134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk_enter_irqsave",
          "args": [
            "recursion_ptr",
            "irqflags"
          ],
          "line": 2125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local_clock",
          "args": [],
          "line": 2123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk_caller_id",
          "args": [],
          "line": 2103
        },
        "resolved": true,
        "details": {
          "function_name": "printk_caller_id",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2018-2022",
          "snippet": "static inline u32 printk_caller_id(void)\n{\n\treturn in_task() ? task_pid_nr(current) :\n\t\t0x80000000 + raw_smp_processor_id();\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic inline u32 printk_caller_id(void)\n{\n\treturn in_task() ? task_pid_nr(current) :\n\t\t0x80000000 + raw_smp_processor_id();\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define LOG_LINE_MAX\t\t(CONSOLE_LOG_MAX - PREFIX_MAX)\n\nint vprintk_store(int facility, int level,\n\t\t  const struct dev_printk_info *dev_info,\n\t\t  const char *fmt, va_list args)\n{\n\tconst u32 caller_id = printk_caller_id();\n\tstruct prb_reserved_entry e;\n\tenum printk_info_flags flags = 0;\n\tstruct printk_record r;\n\tunsigned long irqflags;\n\tu16 trunc_msg_len = 0;\n\tchar prefix_buf[8];\n\tu8 *recursion_ptr;\n\tu16 reserve_size;\n\tva_list args2;\n\tu16 text_len;\n\tint ret = 0;\n\tu64 ts_nsec;\n\n\t/*\n\t * Since the duration of printk() can vary depending on the message\n\t * and state of the ringbuffer, grab the timestamp now so that it is\n\t * close to the call of printk(). This provides a more deterministic\n\t * timestamp with respect to the caller.\n\t */\n\tts_nsec = local_clock();\n\n\tif (!printk_enter_irqsave(recursion_ptr, irqflags))\n\t\treturn 0;\n\n\t/*\n\t * The sprintf needs to come first since the syslog prefix might be\n\t * passed in as a parameter. An extra byte must be reserved so that\n\t * later the vscnprintf() into the reserved buffer has room for the\n\t * terminating '\\0', which is not counted by vsnprintf().\n\t */\n\tva_copy(args2, args);\n\treserve_size = vsnprintf(&prefix_buf[0], sizeof(prefix_buf), fmt, args2) + 1;\n\tva_end(args2);\n\n\tif (reserve_size > LOG_LINE_MAX)\n\t\treserve_size = LOG_LINE_MAX;\n\n\t/* Extract log level or control flags. */\n\tif (facility == 0)\n\t\tprintk_parse_prefix(&prefix_buf[0], &level, &flags);\n\n\tif (level == LOGLEVEL_DEFAULT)\n\t\tlevel = default_message_loglevel;\n\n\tif (dev_info)\n\t\tflags |= LOG_NEWLINE;\n\n\tif (flags & LOG_CONT) {\n\t\tprb_rec_init_wr(&r, reserve_size);\n\t\tif (prb_reserve_in_last(&e, prb, &r, caller_id, LOG_LINE_MAX)) {\n\t\t\ttext_len = printk_sprint(&r.text_buf[r.info->text_len], reserve_size,\n\t\t\t\t\t\t facility, &flags, fmt, args);\n\t\t\tr.info->text_len += text_len;\n\n\t\t\tif (flags & LOG_NEWLINE) {\n\t\t\t\tr.info->flags |= LOG_NEWLINE;\n\t\t\t\tprb_final_commit(&e);\n\t\t\t} else {\n\t\t\t\tprb_commit(&e);\n\t\t\t}\n\n\t\t\tret = text_len;\n\t\t\tgoto out;\n\t\t}\n\t}\n\n\t/*\n\t * Explicitly initialize the record before every prb_reserve() call.\n\t * prb_reserve_in_last() and prb_reserve() purposely invalidate the\n\t * structure when they fail.\n\t */\n\tprb_rec_init_wr(&r, reserve_size);\n\tif (!prb_reserve(&e, prb, &r)) {\n\t\t/* truncate the message if it is too long for empty buffer */\n\t\ttruncate_msg(&reserve_size, &trunc_msg_len);\n\n\t\tprb_rec_init_wr(&r, reserve_size + trunc_msg_len);\n\t\tif (!prb_reserve(&e, prb, &r))\n\t\t\tgoto out;\n\t}\n\n\t/* fill message */\n\ttext_len = printk_sprint(&r.text_buf[0], reserve_size, facility, &flags, fmt, args);\n\tif (trunc_msg_len)\n\t\tmemcpy(&r.text_buf[text_len], trunc_msg, trunc_msg_len);\n\tr.info->text_len = text_len + trunc_msg_len;\n\tr.info->facility = facility;\n\tr.info->level = level & 7;\n\tr.info->flags = flags & 0x1f;\n\tr.info->ts_nsec = ts_nsec;\n\tr.info->caller_id = caller_id;\n\tif (dev_info)\n\t\tmemcpy(&r.info->dev_info, dev_info, sizeof(r.info->dev_info));\n\n\t/* A message without a trailing newline can be continued. */\n\tif (!(flags & LOG_NEWLINE))\n\t\tprb_commit(&e);\n\telse\n\t\tprb_final_commit(&e);\n\n\tret = text_len + trunc_msg_len;\nout:\n\tprintk_exit_irqrestore(recursion_ptr, irqflags);\n\treturn ret;\n}"
  },
  {
    "function_name": "printk_sprint",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2070-2096",
    "snippet": "static u16 printk_sprint(char *text, u16 size, int facility,\n\t\t\t enum printk_info_flags *flags, const char *fmt,\n\t\t\t va_list args)\n{\n\tu16 text_len;\n\n\ttext_len = vscnprintf(text, size, fmt, args);\n\n\t/* Mark and strip a trailing newline. */\n\tif (text_len && text[text_len - 1] == '\\n') {\n\t\ttext_len--;\n\t\t*flags |= LOG_NEWLINE;\n\t}\n\n\t/* Strip log level and control flags. */\n\tif (facility == 0) {\n\t\tu16 prefix_len;\n\n\t\tprefix_len = printk_parse_prefix(text, NULL, NULL);\n\t\tif (prefix_len) {\n\t\t\ttext_len -= prefix_len;\n\t\t\tmemmove(text, text + prefix_len, text_len);\n\t\t}\n\t}\n\n\treturn text_len;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memmove",
          "args": [
            "text",
            "text + prefix_len",
            "text_len"
          ],
          "line": 2091
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk_parse_prefix",
          "args": [
            "text",
            "NULL",
            "NULL"
          ],
          "line": 2088
        },
        "resolved": true,
        "details": {
          "function_name": "printk_parse_prefix",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2041-2067",
          "snippet": "u16 printk_parse_prefix(const char *text, int *level,\n\t\t\tenum printk_info_flags *flags)\n{\n\tu16 prefix_len = 0;\n\tint kern_level;\n\n\twhile (*text) {\n\t\tkern_level = printk_get_level(text);\n\t\tif (!kern_level)\n\t\t\tbreak;\n\n\t\tswitch (kern_level) {\n\t\tcase '0' ... '7':\n\t\t\tif (level && *level == LOGLEVEL_DEFAULT)\n\t\t\t\t*level = kern_level - '0';\n\t\t\tbreak;\n\t\tcase 'c':\t/* KERN_CONT */\n\t\t\tif (flags)\n\t\t\t\t*flags |= LOG_CONT;\n\t\t}\n\n\t\tprefix_len += 2;\n\t\ttext += 2;\n\t}\n\n\treturn prefix_len;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nu16 printk_parse_prefix(const char *text, int *level,\n\t\t\tenum printk_info_flags *flags)\n{\n\tu16 prefix_len = 0;\n\tint kern_level;\n\n\twhile (*text) {\n\t\tkern_level = printk_get_level(text);\n\t\tif (!kern_level)\n\t\t\tbreak;\n\n\t\tswitch (kern_level) {\n\t\tcase '0' ... '7':\n\t\t\tif (level && *level == LOGLEVEL_DEFAULT)\n\t\t\t\t*level = kern_level - '0';\n\t\t\tbreak;\n\t\tcase 'c':\t/* KERN_CONT */\n\t\t\tif (flags)\n\t\t\t\t*flags |= LOG_CONT;\n\t\t}\n\n\t\tprefix_len += 2;\n\t\ttext += 2;\n\t}\n\n\treturn prefix_len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "vscnprintf",
          "args": [
            "text",
            "size",
            "fmt",
            "args"
          ],
          "line": 2076
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic u16 printk_sprint(char *text, u16 size, int facility,\n\t\t\t enum printk_info_flags *flags, const char *fmt,\n\t\t\t va_list args)\n{\n\tu16 text_len;\n\n\ttext_len = vscnprintf(text, size, fmt, args);\n\n\t/* Mark and strip a trailing newline. */\n\tif (text_len && text[text_len - 1] == '\\n') {\n\t\ttext_len--;\n\t\t*flags |= LOG_NEWLINE;\n\t}\n\n\t/* Strip log level and control flags. */\n\tif (facility == 0) {\n\t\tu16 prefix_len;\n\n\t\tprefix_len = printk_parse_prefix(text, NULL, NULL);\n\t\tif (prefix_len) {\n\t\t\ttext_len -= prefix_len;\n\t\t\tmemmove(text, text + prefix_len, text_len);\n\t\t}\n\t}\n\n\treturn text_len;\n}"
  },
  {
    "function_name": "printk_parse_prefix",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2041-2067",
    "snippet": "u16 printk_parse_prefix(const char *text, int *level,\n\t\t\tenum printk_info_flags *flags)\n{\n\tu16 prefix_len = 0;\n\tint kern_level;\n\n\twhile (*text) {\n\t\tkern_level = printk_get_level(text);\n\t\tif (!kern_level)\n\t\t\tbreak;\n\n\t\tswitch (kern_level) {\n\t\tcase '0' ... '7':\n\t\t\tif (level && *level == LOGLEVEL_DEFAULT)\n\t\t\t\t*level = kern_level - '0';\n\t\t\tbreak;\n\t\tcase 'c':\t/* KERN_CONT */\n\t\t\tif (flags)\n\t\t\t\t*flags |= LOG_CONT;\n\t\t}\n\n\t\tprefix_len += 2;\n\t\ttext += 2;\n\t}\n\n\treturn prefix_len;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk_get_level",
          "args": [
            "text"
          ],
          "line": 2048
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nu16 printk_parse_prefix(const char *text, int *level,\n\t\t\tenum printk_info_flags *flags)\n{\n\tu16 prefix_len = 0;\n\tint kern_level;\n\n\twhile (*text) {\n\t\tkern_level = printk_get_level(text);\n\t\tif (!kern_level)\n\t\t\tbreak;\n\n\t\tswitch (kern_level) {\n\t\tcase '0' ... '7':\n\t\t\tif (level && *level == LOGLEVEL_DEFAULT)\n\t\t\t\t*level = kern_level - '0';\n\t\t\tbreak;\n\t\tcase 'c':\t/* KERN_CONT */\n\t\t\tif (flags)\n\t\t\t\t*flags |= LOG_CONT;\n\t\t}\n\n\t\tprefix_len += 2;\n\t\ttext += 2;\n\t}\n\n\treturn prefix_len;\n}"
  },
  {
    "function_name": "printk_caller_id",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2018-2022",
    "snippet": "static inline u32 printk_caller_id(void)\n{\n\treturn in_task() ? task_pid_nr(current) :\n\t\t0x80000000 + raw_smp_processor_id();\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "raw_smp_processor_id",
          "args": [],
          "line": 2021
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "task_pid_nr",
          "args": [
            "current"
          ],
          "line": 2020
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "in_task",
          "args": [],
          "line": 2020
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic inline u32 printk_caller_id(void)\n{\n\treturn in_task() ? task_pid_nr(current) :\n\t\t0x80000000 + raw_smp_processor_id();\n}"
  },
  {
    "function_name": "printk_delay",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "2006-2016",
    "snippet": "static inline void printk_delay(void)\n{\n\tif (unlikely(printk_delay_msec)) {\n\t\tint m = printk_delay_msec;\n\n\t\twhile (m--) {\n\t\t\tmdelay(1);\n\t\t\ttouch_nmi_watchdog();\n\t\t}\n\t}\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "touch_nmi_watchdog",
          "args": [],
          "line": 2013
        },
        "resolved": true,
        "details": {
          "function_name": "arch_touch_nmi_watchdog",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/watchdog_hld.c",
          "lines": "32-42",
          "snippet": "notrace void arch_touch_nmi_watchdog(void)\n{\n\t/*\n\t * Using __raw here because some code paths have\n\t * preemption enabled.  If preemption is enabled\n\t * then interrupts should be enabled too, in which\n\t * case we shouldn't have to worry about the watchdog\n\t * going off.\n\t */\n\traw_cpu_write(watchdog_nmi_touch, true);\n}",
          "includes": [
            "#include <linux/perf_event.h>",
            "#include <asm/irq_regs.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/module.h>",
            "#include <linux/atomic.h>",
            "#include <linux/nmi.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_PER_CPU(bool, watchdog_nmi_touch);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/perf_event.h>\n#include <asm/irq_regs.h>\n#include <linux/sched/debug.h>\n#include <linux/module.h>\n#include <linux/atomic.h>\n#include <linux/nmi.h>\n\nstatic DEFINE_PER_CPU(bool, watchdog_nmi_touch);\n\nnotrace void arch_touch_nmi_watchdog(void)\n{\n\t/*\n\t * Using __raw here because some code paths have\n\t * preemption enabled.  If preemption is enabled\n\t * then interrupts should be enabled too, in which\n\t * case we shouldn't have to worry about the watchdog\n\t * going off.\n\t */\n\traw_cpu_write(watchdog_nmi_touch, true);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mdelay",
          "args": [
            "1"
          ],
          "line": 2012
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "printk_delay_msec"
          ],
          "line": 2008
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic inline void printk_delay(void)\n{\n\tif (unlikely(printk_delay_msec)) {\n\t\tint m = printk_delay_msec;\n\n\t\twhile (m--) {\n\t\t\tmdelay(1);\n\t\t\ttouch_nmi_watchdog();\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "__printk_recursion_counter",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "1958-1970",
    "snippet": "static u8 *__printk_recursion_counter(void)\n{\n#ifdef CONFIG_HAVE_NMI\n\tif (in_nmi()) {\n\t\tif (printk_percpu_data_ready())\n\t\t\treturn this_cpu_ptr(&printk_count_nmi);\n\t\treturn &printk_count_nmi_early;\n\t}\n#endif\n\tif (printk_percpu_data_ready())\n\t\treturn this_cpu_ptr(&printk_count);\n\treturn &printk_count_early;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "this_cpu_ptr",
          "args": [
            "&printk_count"
          ],
          "line": 1968
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk_percpu_data_ready",
          "args": [],
          "line": 1967
        },
        "resolved": true,
        "details": {
          "function_name": "printk_percpu_data_ready",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "433-436",
          "snippet": "bool printk_percpu_data_ready(void)\n{\n\treturn __printk_percpu_data_ready;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nbool printk_percpu_data_ready(void)\n{\n\treturn __printk_percpu_data_ready;\n}"
        }
      },
      {
        "call_info": {
          "callee": "this_cpu_ptr",
          "args": [
            "&printk_count_nmi"
          ],
          "line": 1963
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "in_nmi",
          "args": [],
          "line": 1961
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic u8 *__printk_recursion_counter(void)\n{\n#ifdef CONFIG_HAVE_NMI\n\tif (in_nmi()) {\n\t\tif (printk_percpu_data_ready())\n\t\t\treturn this_cpu_ptr(&printk_count_nmi);\n\t\treturn &printk_count_nmi_early;\n\t}\n#endif\n\tif (printk_percpu_data_ready())\n\t\treturn this_cpu_ptr(&printk_count);\n\treturn &printk_count_early;\n}"
  },
  {
    "function_name": "call_console_drivers",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "1895-1932",
    "snippet": "static void call_console_drivers(const char *ext_text, size_t ext_len,\n\t\t\t\t const char *text, size_t len)\n{\n\tstatic char dropped_text[64];\n\tsize_t dropped_len = 0;\n\tstruct console *con;\n\n\ttrace_console_rcuidle(text, len);\n\n\tif (!console_drivers)\n\t\treturn;\n\n\tif (console_dropped) {\n\t\tdropped_len = snprintf(dropped_text, sizeof(dropped_text),\n\t\t\t\t       \"** %lu printk messages dropped **\\n\",\n\t\t\t\t       console_dropped);\n\t\tconsole_dropped = 0;\n\t}\n\n\tfor_each_console(con) {\n\t\tif (exclusive_console && con != exclusive_console)\n\t\t\tcontinue;\n\t\tif (!(con->flags & CON_ENABLED))\n\t\t\tcontinue;\n\t\tif (!con->write)\n\t\t\tcontinue;\n\t\tif (!cpu_online(smp_processor_id()) &&\n\t\t    !(con->flags & CON_ANYTIME))\n\t\t\tcontinue;\n\t\tif (con->flags & CON_EXTENDED)\n\t\t\tcon->write(con, ext_text, ext_len);\n\t\telse {\n\t\t\tif (dropped_len)\n\t\t\t\tcon->write(con, dropped_text, dropped_len);\n\t\t\tcon->write(con, text, len);\n\t\t}\n\t}\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct console *console_drivers;",
      "static struct console *exclusive_console;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "con->write",
          "args": [
            "con",
            "text",
            "len"
          ],
          "line": 1929
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "con->write",
          "args": [
            "con",
            "dropped_text",
            "dropped_len"
          ],
          "line": 1928
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "con->write",
          "args": [
            "con",
            "ext_text",
            "ext_len"
          ],
          "line": 1925
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_online",
          "args": [
            "smp_processor_id()"
          ],
          "line": 1921
        },
        "resolved": true,
        "details": {
          "function_name": "init_cpu_online",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/cpu.c",
          "lines": "2616-2619",
          "snippet": "void init_cpu_online(const struct cpumask *src)\n{\n\tcpumask_copy(&__cpu_online_mask, src);\n}",
          "includes": [
            "#include \"smpboot.h\"",
            "#include <trace/events/cpuhp.h>",
            "#include <trace/events/power.h>",
            "#include <linux/cpuset.h>",
            "#include <linux/percpu-rwsem.h>",
            "#include <linux/scs.h>",
            "#include <linux/slab.h>",
            "#include <linux/relay.h>",
            "#include <linux/smpboot.h>",
            "#include <linux/nmi.h>",
            "#include <linux/irq.h>",
            "#include <linux/tick.h>",
            "#include <linux/lockdep.h>",
            "#include <linux/suspend.h>",
            "#include <linux/gfp.h>",
            "#include <linux/mutex.h>",
            "#include <linux/stop_machine.h>",
            "#include <linux/kthread.h>",
            "#include <linux/bug.h>",
            "#include <linux/export.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/oom.h>",
            "#include <linux/cpu.h>",
            "#include <linux/unistd.h>",
            "#include <linux/sched/smt.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/sched/hotplug.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/notifier.h>",
            "#include <linux/init.h>",
            "#include <linux/smp.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/sched/mm.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct cpumask __cpu_online_mask"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"smpboot.h\"\n#include <trace/events/cpuhp.h>\n#include <trace/events/power.h>\n#include <linux/cpuset.h>\n#include <linux/percpu-rwsem.h>\n#include <linux/scs.h>\n#include <linux/slab.h>\n#include <linux/relay.h>\n#include <linux/smpboot.h>\n#include <linux/nmi.h>\n#include <linux/irq.h>\n#include <linux/tick.h>\n#include <linux/lockdep.h>\n#include <linux/suspend.h>\n#include <linux/gfp.h>\n#include <linux/mutex.h>\n#include <linux/stop_machine.h>\n#include <linux/kthread.h>\n#include <linux/bug.h>\n#include <linux/export.h>\n#include <linux/rcupdate.h>\n#include <linux/oom.h>\n#include <linux/cpu.h>\n#include <linux/unistd.h>\n#include <linux/sched/smt.h>\n#include <linux/sched/task.h>\n#include <linux/sched/isolation.h>\n#include <linux/sched/hotplug.h>\n#include <linux/sched/signal.h>\n#include <linux/notifier.h>\n#include <linux/init.h>\n#include <linux/smp.h>\n#include <linux/proc_fs.h>\n#include <linux/sched/mm.h>\n\nstruct cpumask __cpu_online_mask;\n\nvoid init_cpu_online(const struct cpumask *src)\n{\n\tcpumask_copy(&__cpu_online_mask, src);\n}"
        }
      },
      {
        "call_info": {
          "callee": "smp_processor_id",
          "args": [],
          "line": 1921
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "dropped_text",
            "sizeof(dropped_text)",
            "\"** %lu printk messages dropped **\\n\"",
            "console_dropped"
          ],
          "line": 1908
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trace_console_rcuidle",
          "args": [
            "text",
            "len"
          ],
          "line": 1902
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstruct console *console_drivers;\nstatic struct console *exclusive_console;\n\nstatic void call_console_drivers(const char *ext_text, size_t ext_len,\n\t\t\t\t const char *text, size_t len)\n{\n\tstatic char dropped_text[64];\n\tsize_t dropped_len = 0;\n\tstruct console *con;\n\n\ttrace_console_rcuidle(text, len);\n\n\tif (!console_drivers)\n\t\treturn;\n\n\tif (console_dropped) {\n\t\tdropped_len = snprintf(dropped_text, sizeof(dropped_text),\n\t\t\t\t       \"** %lu printk messages dropped **\\n\",\n\t\t\t\t       console_dropped);\n\t\tconsole_dropped = 0;\n\t}\n\n\tfor_each_console(con) {\n\t\tif (exclusive_console && con != exclusive_console)\n\t\t\tcontinue;\n\t\tif (!(con->flags & CON_ENABLED))\n\t\t\tcontinue;\n\t\tif (!con->write)\n\t\t\tcontinue;\n\t\tif (!cpu_online(smp_processor_id()) &&\n\t\t    !(con->flags & CON_ANYTIME))\n\t\t\tcontinue;\n\t\tif (con->flags & CON_EXTENDED)\n\t\t\tcon->write(con, ext_text, ext_len);\n\t\telse {\n\t\t\tif (dropped_len)\n\t\t\t\tcon->write(con, dropped_text, dropped_len);\n\t\t\tcon->write(con, text, len);\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "console_trylock_spinning",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "1836-1888",
    "snippet": "static int console_trylock_spinning(void)\n{\n\tstruct task_struct *owner = NULL;\n\tbool waiter;\n\tbool spin = false;\n\tunsigned long flags;\n\n\tif (console_trylock())\n\t\treturn 1;\n\n\tprintk_safe_enter_irqsave(flags);\n\n\traw_spin_lock(&console_owner_lock);\n\towner = READ_ONCE(console_owner);\n\twaiter = READ_ONCE(console_waiter);\n\tif (!waiter && owner && owner != current) {\n\t\tWRITE_ONCE(console_waiter, true);\n\t\tspin = true;\n\t}\n\traw_spin_unlock(&console_owner_lock);\n\n\t/*\n\t * If there is an active printk() writing to the\n\t * consoles, instead of having it write our data too,\n\t * see if we can offload that load from the active\n\t * printer, and do some printing ourselves.\n\t * Go into a spin only if there isn't already a waiter\n\t * spinning, and there is an active printer, and\n\t * that active printer isn't us (recursive printk?).\n\t */\n\tif (!spin) {\n\t\tprintk_safe_exit_irqrestore(flags);\n\t\treturn 0;\n\t}\n\n\t/* We spin waiting for the owner to release us */\n\tspin_acquire(&console_owner_dep_map, 0, 0, _THIS_IP_);\n\t/* Owner will clear console_waiter on hand off */\n\twhile (READ_ONCE(console_waiter))\n\t\tcpu_relax();\n\tspin_release(&console_owner_dep_map, _THIS_IP_);\n\n\tprintk_safe_exit_irqrestore(flags);\n\t/*\n\t * The owner passed the console lock to us.\n\t * Since we did not spin on console lock, annotate\n\t * this as a trylock. Otherwise lockdep will\n\t * complain.\n\t */\n\tmutex_acquire(&console_lock_dep_map, 0, 1, _THIS_IP_);\n\n\treturn 1;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_acquire",
          "args": [
            "&console_lock_dep_map",
            "0",
            "1",
            "_THIS_IP_"
          ],
          "line": 1885
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk_safe_exit_irqrestore",
          "args": [
            "flags"
          ],
          "line": 1878
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_release",
          "args": [
            "&console_owner_dep_map",
            "_THIS_IP_"
          ],
          "line": 1876
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_relax",
          "args": [],
          "line": 1875
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "READ_ONCE",
          "args": [
            "console_waiter"
          ],
          "line": 1874
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_acquire",
          "args": [
            "&console_owner_dep_map",
            "0",
            "0",
            "_THIS_IP_"
          ],
          "line": 1872
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk_safe_exit_irqrestore",
          "args": [
            "flags"
          ],
          "line": 1867
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raw_spin_unlock",
          "args": [
            "&console_owner_lock"
          ],
          "line": 1855
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_bh",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "208-211",
          "snippet": "void __lockfunc _raw_spin_unlock_bh(raw_spinlock_t *lock)\n{\n\t__raw_spin_unlock_bh(lock);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_bh(raw_spinlock_t *lock)\n{\n\t__raw_spin_unlock_bh(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "console_waiter",
            "true"
          ],
          "line": 1852
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "READ_ONCE",
          "args": [
            "console_waiter"
          ],
          "line": 1850
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "READ_ONCE",
          "args": [
            "console_owner"
          ],
          "line": 1849
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raw_spin_lock",
          "args": [
            "&console_owner_lock"
          ],
          "line": 1848
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_bh",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "176-179",
          "snippet": "void __lockfunc _raw_spin_lock_bh(raw_spinlock_t *lock)\n{\n\t__raw_spin_lock_bh(lock);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_lock_bh(raw_spinlock_t *lock)\n{\n\t__raw_spin_lock_bh(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk_safe_enter_irqsave",
          "args": [
            "flags"
          ],
          "line": 1846
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "console_trylock",
          "args": [],
          "line": 1843
        },
        "resolved": true,
        "details": {
          "function_name": "console_trylock",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2540-2551",
          "snippet": "int console_trylock(void)\n{\n\tif (down_trylock_console_sem())\n\t\treturn 0;\n\tif (console_suspended) {\n\t\tup_console_sem();\n\t\treturn 0;\n\t}\n\tconsole_locked = 1;\n\tconsole_may_schedule = 0;\n\treturn 1;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int console_locked, console_suspended;",
            "static int console_may_schedule;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic int console_locked, console_suspended;\nstatic int console_may_schedule;\n\nint console_trylock(void)\n{\n\tif (down_trylock_console_sem())\n\t\treturn 0;\n\tif (console_suspended) {\n\t\tup_console_sem();\n\t\treturn 0;\n\t}\n\tconsole_locked = 1;\n\tconsole_may_schedule = 0;\n\treturn 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic int console_trylock_spinning(void)\n{\n\tstruct task_struct *owner = NULL;\n\tbool waiter;\n\tbool spin = false;\n\tunsigned long flags;\n\n\tif (console_trylock())\n\t\treturn 1;\n\n\tprintk_safe_enter_irqsave(flags);\n\n\traw_spin_lock(&console_owner_lock);\n\towner = READ_ONCE(console_owner);\n\twaiter = READ_ONCE(console_waiter);\n\tif (!waiter && owner && owner != current) {\n\t\tWRITE_ONCE(console_waiter, true);\n\t\tspin = true;\n\t}\n\traw_spin_unlock(&console_owner_lock);\n\n\t/*\n\t * If there is an active printk() writing to the\n\t * consoles, instead of having it write our data too,\n\t * see if we can offload that load from the active\n\t * printer, and do some printing ourselves.\n\t * Go into a spin only if there isn't already a waiter\n\t * spinning, and there is an active printer, and\n\t * that active printer isn't us (recursive printk?).\n\t */\n\tif (!spin) {\n\t\tprintk_safe_exit_irqrestore(flags);\n\t\treturn 0;\n\t}\n\n\t/* We spin waiting for the owner to release us */\n\tspin_acquire(&console_owner_dep_map, 0, 0, _THIS_IP_);\n\t/* Owner will clear console_waiter on hand off */\n\twhile (READ_ONCE(console_waiter))\n\t\tcpu_relax();\n\tspin_release(&console_owner_dep_map, _THIS_IP_);\n\n\tprintk_safe_exit_irqrestore(flags);\n\t/*\n\t * The owner passed the console lock to us.\n\t * Since we did not spin on console lock, annotate\n\t * this as a trylock. Otherwise lockdep will\n\t * complain.\n\t */\n\tmutex_acquire(&console_lock_dep_map, 0, 1, _THIS_IP_);\n\n\treturn 1;\n}"
  },
  {
    "function_name": "console_lock_spinning_disable_and_check",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "1799-1824",
    "snippet": "static int console_lock_spinning_disable_and_check(void)\n{\n\tint waiter;\n\n\traw_spin_lock(&console_owner_lock);\n\twaiter = READ_ONCE(console_waiter);\n\tconsole_owner = NULL;\n\traw_spin_unlock(&console_owner_lock);\n\n\tif (!waiter) {\n\t\tspin_release(&console_owner_dep_map, _THIS_IP_);\n\t\treturn 0;\n\t}\n\n\t/* The waiter is now free to continue */\n\tWRITE_ONCE(console_waiter, false);\n\n\tspin_release(&console_owner_dep_map, _THIS_IP_);\n\n\t/*\n\t * Hand off console_lock to waiter. The waiter will perform\n\t * the up(). After this, the waiter is the console_lock owner.\n\t */\n\tmutex_release(&console_lock_dep_map, _THIS_IP_);\n\treturn 1;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_release",
          "args": [
            "&console_lock_dep_map",
            "_THIS_IP_"
          ],
          "line": 1822
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_release",
          "args": [
            "&console_owner_dep_map",
            "_THIS_IP_"
          ],
          "line": 1816
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "console_waiter",
            "false"
          ],
          "line": 1814
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "spin_release",
          "args": [
            "&console_owner_dep_map",
            "_THIS_IP_"
          ],
          "line": 1809
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raw_spin_unlock",
          "args": [
            "&console_owner_lock"
          ],
          "line": 1806
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_bh",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "208-211",
          "snippet": "void __lockfunc _raw_spin_unlock_bh(raw_spinlock_t *lock)\n{\n\t__raw_spin_unlock_bh(lock);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_bh(raw_spinlock_t *lock)\n{\n\t__raw_spin_unlock_bh(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "READ_ONCE",
          "args": [
            "console_waiter"
          ],
          "line": 1804
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raw_spin_lock",
          "args": [
            "&console_owner_lock"
          ],
          "line": 1803
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_bh",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "176-179",
          "snippet": "void __lockfunc _raw_spin_lock_bh(raw_spinlock_t *lock)\n{\n\t__raw_spin_lock_bh(lock);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_lock_bh(raw_spinlock_t *lock)\n{\n\t__raw_spin_lock_bh(lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic int console_lock_spinning_disable_and_check(void)\n{\n\tint waiter;\n\n\traw_spin_lock(&console_owner_lock);\n\twaiter = READ_ONCE(console_waiter);\n\tconsole_owner = NULL;\n\traw_spin_unlock(&console_owner_lock);\n\n\tif (!waiter) {\n\t\tspin_release(&console_owner_dep_map, _THIS_IP_);\n\t\treturn 0;\n\t}\n\n\t/* The waiter is now free to continue */\n\tWRITE_ONCE(console_waiter, false);\n\n\tspin_release(&console_owner_dep_map, _THIS_IP_);\n\n\t/*\n\t * Hand off console_lock to waiter. The waiter will perform\n\t * the up(). After this, the waiter is the console_lock owner.\n\t */\n\tmutex_release(&console_lock_dep_map, _THIS_IP_);\n\treturn 1;\n}"
  },
  {
    "function_name": "console_lock_spinning_enable",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "1774-1782",
    "snippet": "static void console_lock_spinning_enable(void)\n{\n\traw_spin_lock(&console_owner_lock);\n\tconsole_owner = current;\n\traw_spin_unlock(&console_owner_lock);\n\n\t/* The waiter may spin on us after setting console_owner */\n\tspin_acquire(&console_owner_dep_map, 0, 0, _THIS_IP_);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "spin_acquire",
          "args": [
            "&console_owner_dep_map",
            "0",
            "0",
            "_THIS_IP_"
          ],
          "line": 1781
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raw_spin_unlock",
          "args": [
            "&console_owner_lock"
          ],
          "line": 1778
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_unlock_bh",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "208-211",
          "snippet": "void __lockfunc _raw_spin_unlock_bh(raw_spinlock_t *lock)\n{\n\t__raw_spin_unlock_bh(lock);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_unlock_bh(raw_spinlock_t *lock)\n{\n\t__raw_spin_unlock_bh(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "raw_spin_lock",
          "args": [
            "&console_owner_lock"
          ],
          "line": 1776
        },
        "resolved": true,
        "details": {
          "function_name": "_raw_spin_lock_bh",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/spinlock.c",
          "lines": "176-179",
          "snippet": "void __lockfunc _raw_spin_lock_bh(raw_spinlock_t *lock)\n{\n\t__raw_spin_lock_bh(lock);\n}",
          "includes": [
            "#include <linux/export.h>",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/preempt.h>",
            "#include <linux/linkage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/export.h>\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/spinlock.h>\n#include <linux/preempt.h>\n#include <linux/linkage.h>\n\nvoid __lockfunc _raw_spin_lock_bh(raw_spinlock_t *lock)\n{\n\t__raw_spin_lock_bh(lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic void console_lock_spinning_enable(void)\n{\n\traw_spin_lock(&console_owner_lock);\n\tconsole_owner = current;\n\traw_spin_unlock(&console_owner_lock);\n\n\t/* The waiter may spin on us after setting console_owner */\n\tspin_acquire(&console_owner_dep_map, 0, 0, _THIS_IP_);\n}"
  },
  {
    "function_name": "do_syslog",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "1632-1743",
    "snippet": "int do_syslog(int type, char __user *buf, int len, int source)\n{\n\tstruct printk_info info;\n\tbool clear = false;\n\tstatic int saved_console_loglevel = LOGLEVEL_DEFAULT;\n\tint error;\n\n\terror = check_syslog_permissions(type, source);\n\tif (error)\n\t\treturn error;\n\n\tswitch (type) {\n\tcase SYSLOG_ACTION_CLOSE:\t/* Close log */\n\t\tbreak;\n\tcase SYSLOG_ACTION_OPEN:\t/* Open log */\n\t\tbreak;\n\tcase SYSLOG_ACTION_READ:\t/* Read from log */\n\t\tif (!buf || len < 0)\n\t\t\treturn -EINVAL;\n\t\tif (!len)\n\t\t\treturn 0;\n\t\tif (!access_ok(buf, len))\n\t\t\treturn -EFAULT;\n\t\terror = syslog_print(buf, len);\n\t\tbreak;\n\t/* Read/clear last kernel messages */\n\tcase SYSLOG_ACTION_READ_CLEAR:\n\t\tclear = true;\n\t\tfallthrough;\n\t/* Read last kernel messages */\n\tcase SYSLOG_ACTION_READ_ALL:\n\t\tif (!buf || len < 0)\n\t\t\treturn -EINVAL;\n\t\tif (!len)\n\t\t\treturn 0;\n\t\tif (!access_ok(buf, len))\n\t\t\treturn -EFAULT;\n\t\terror = syslog_print_all(buf, len, clear);\n\t\tbreak;\n\t/* Clear ring buffer */\n\tcase SYSLOG_ACTION_CLEAR:\n\t\tsyslog_clear();\n\t\tbreak;\n\t/* Disable logging to console */\n\tcase SYSLOG_ACTION_CONSOLE_OFF:\n\t\tif (saved_console_loglevel == LOGLEVEL_DEFAULT)\n\t\t\tsaved_console_loglevel = console_loglevel;\n\t\tconsole_loglevel = minimum_console_loglevel;\n\t\tbreak;\n\t/* Enable logging to console */\n\tcase SYSLOG_ACTION_CONSOLE_ON:\n\t\tif (saved_console_loglevel != LOGLEVEL_DEFAULT) {\n\t\t\tconsole_loglevel = saved_console_loglevel;\n\t\t\tsaved_console_loglevel = LOGLEVEL_DEFAULT;\n\t\t}\n\t\tbreak;\n\t/* Set level of messages printed to console */\n\tcase SYSLOG_ACTION_CONSOLE_LEVEL:\n\t\tif (len < 1 || len > 8)\n\t\t\treturn -EINVAL;\n\t\tif (len < minimum_console_loglevel)\n\t\t\tlen = minimum_console_loglevel;\n\t\tconsole_loglevel = len;\n\t\t/* Implicitly re-enable logging to console */\n\t\tsaved_console_loglevel = LOGLEVEL_DEFAULT;\n\t\tbreak;\n\t/* Number of chars in the log buffer */\n\tcase SYSLOG_ACTION_SIZE_UNREAD:\n\t\tmutex_lock(&syslog_lock);\n\t\tif (!prb_read_valid_info(prb, syslog_seq, &info, NULL)) {\n\t\t\t/* No unread messages. */\n\t\t\tmutex_unlock(&syslog_lock);\n\t\t\treturn 0;\n\t\t}\n\t\tif (info.seq != syslog_seq) {\n\t\t\t/* messages are gone, move to first one */\n\t\t\tsyslog_seq = info.seq;\n\t\t\tsyslog_partial = 0;\n\t\t}\n\t\tif (source == SYSLOG_FROM_PROC) {\n\t\t\t/*\n\t\t\t * Short-cut for poll(/\"proc/kmsg\") which simply checks\n\t\t\t * for pending data, not the size; return the count of\n\t\t\t * records, not the length.\n\t\t\t */\n\t\t\terror = prb_next_seq(prb) - syslog_seq;\n\t\t} else {\n\t\t\tbool time = syslog_partial ? syslog_time : printk_time;\n\t\t\tunsigned int line_count;\n\t\t\tu64 seq;\n\n\t\t\tprb_for_each_info(syslog_seq, prb, seq, &info,\n\t\t\t\t\t  &line_count) {\n\t\t\t\terror += get_record_print_text_size(&info, line_count,\n\t\t\t\t\t\t\t\t    true, time);\n\t\t\t\ttime = printk_time;\n\t\t\t}\n\t\t\terror -= syslog_partial;\n\t\t}\n\t\tmutex_unlock(&syslog_lock);\n\t\tbreak;\n\t/* Size of the log buffer */\n\tcase SYSLOG_ACTION_SIZE_BUFFER:\n\t\terror = log_buf_len;\n\t\tbreak;\n\tdefault:\n\t\terror = -EINVAL;\n\t\tbreak;\n\t}\n\n\treturn error;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define printk_time\t\tfalse"
    ],
    "globals_used": [
      "static DEFINE_MUTEX(syslog_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&syslog_lock"
          ],
          "line": 1731
        },
        "resolved": true,
        "details": {
          "function_name": "__rt_mutex_unlock",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/rtmutex.c",
          "lines": "1350-1356",
          "snippet": "static __always_inline void __rt_mutex_unlock(struct rt_mutex_base *lock)\n{\n\tif (likely(rt_mutex_cmpxchg_release(lock, current, NULL)))\n\t\treturn;\n\n\trt_mutex_slowunlock(lock);\n}",
          "includes": [
            "# include \"ww_mutex.h\"",
            "#include \"rtmutex_common.h\"",
            "#include <linux/ww_mutex.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "# include \"ww_mutex.h\"\n#include \"rtmutex_common.h\"\n#include <linux/ww_mutex.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n\nstatic __always_inline struct;\n\nstatic __always_inline void __rt_mutex_unlock(struct rt_mutex_base *lock)\n{\n\tif (likely(rt_mutex_cmpxchg_release(lock, current, NULL)))\n\t\treturn;\n\n\trt_mutex_slowunlock(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "get_record_print_text_size",
          "args": [
            "&info",
            "line_count",
            "true",
            "time"
          ],
          "line": 1725
        },
        "resolved": true,
        "details": {
          "function_name": "get_record_print_text_size",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "1417-1432",
          "snippet": "static size_t get_record_print_text_size(struct printk_info *info,\n\t\t\t\t\t unsigned int line_count,\n\t\t\t\t\t bool syslog, bool time)\n{\n\tchar prefix[PREFIX_MAX];\n\tsize_t prefix_len;\n\n\tprefix_len = info_print_prefix(info, syslog, time, prefix);\n\n\t/*\n\t * Each line will be preceded with a prefix. The intermediate\n\t * newlines are already within the text, but a final trailing\n\t * newline will be added.\n\t */\n\treturn ((prefix_len * line_count) + info->text_len + 1);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define PREFIX_MAX\t\t32",
            "#define PREFIX_MAX\t\t48"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define PREFIX_MAX\t\t32\n#define PREFIX_MAX\t\t48\n\nstatic size_t get_record_print_text_size(struct printk_info *info,\n\t\t\t\t\t unsigned int line_count,\n\t\t\t\t\t bool syslog, bool time)\n{\n\tchar prefix[PREFIX_MAX];\n\tsize_t prefix_len;\n\n\tprefix_len = info_print_prefix(info, syslog, time, prefix);\n\n\t/*\n\t * Each line will be preceded with a prefix. The intermediate\n\t * newlines are already within the text, but a final trailing\n\t * newline will be added.\n\t */\n\treturn ((prefix_len * line_count) + info->text_len + 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prb_for_each_info",
          "args": [
            "syslog_seq",
            "prb",
            "seq",
            "&info",
            "&line_count"
          ],
          "line": 1723
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prb_next_seq",
          "args": [
            "prb"
          ],
          "line": 1717
        },
        "resolved": true,
        "details": {
          "function_name": "prb_next_seq",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk_ringbuffer.c",
          "lines": "2006-2015",
          "snippet": "u64 prb_next_seq(struct printk_ringbuffer *rb)\n{\n\tu64 seq = 0;\n\n\t/* Search forward from the oldest descriptor. */\n\twhile (_prb_read_valid(rb, &seq, NULL, NULL))\n\t\tseq++;\n\n\treturn seq;\n}",
          "includes": [
            "#include \"printk_ringbuffer.h\"",
            "#include <linux/bug.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/irqflags.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"printk_ringbuffer.h\"\n#include <linux/bug.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/irqflags.h>\n#include <linux/kernel.h>\n\nu64 prb_next_seq(struct printk_ringbuffer *rb)\n{\n\tu64 seq = 0;\n\n\t/* Search forward from the oldest descriptor. */\n\twhile (_prb_read_valid(rb, &seq, NULL, NULL))\n\t\tseq++;\n\n\treturn seq;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prb_read_valid_info",
          "args": [
            "prb",
            "syslog_seq",
            "&info",
            "NULL"
          ],
          "line": 1701
        },
        "resolved": true,
        "details": {
          "function_name": "prb_read_valid_info",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk_ringbuffer.c",
          "lines": "1956-1964",
          "snippet": "bool prb_read_valid_info(struct printk_ringbuffer *rb, u64 seq,\n\t\t\t struct printk_info *info, unsigned int *line_count)\n{\n\tstruct printk_record r;\n\n\tprb_rec_init_rd(&r, info, NULL, 0);\n\n\treturn _prb_read_valid(rb, &seq, &r, line_count);\n}",
          "includes": [
            "#include \"printk_ringbuffer.h\"",
            "#include <linux/bug.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/irqflags.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"printk_ringbuffer.h\"\n#include <linux/bug.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/irqflags.h>\n#include <linux/kernel.h>\n\nbool prb_read_valid_info(struct printk_ringbuffer *rb, u64 seq,\n\t\t\t struct printk_info *info, unsigned int *line_count)\n{\n\tstruct printk_record r;\n\n\tprb_rec_init_rd(&r, info, NULL, 0);\n\n\treturn _prb_read_valid(rb, &seq, &r, line_count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&syslog_lock"
          ],
          "line": 1700
        },
        "resolved": true,
        "details": {
          "function_name": "mutex_lock_io",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/rtmutex_api.c",
          "lines": "580-586",
          "snippet": "void __sched mutex_lock_io(struct mutex *lock)\n{\n\tint token = io_schedule_prepare();\n\n\t__mutex_lock_common(lock, TASK_UNINTERRUPTIBLE, 0, NULL, _RET_IP_);\n\tio_schedule_finish(token);\n}",
          "includes": [
            "#include \"rtmutex.c\"",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex.c\"\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nvoid __sched mutex_lock_io(struct mutex *lock)\n{\n\tint token = io_schedule_prepare();\n\n\t__mutex_lock_common(lock, TASK_UNINTERRUPTIBLE, 0, NULL, _RET_IP_);\n\tio_schedule_finish(token);\n}"
        }
      },
      {
        "call_info": {
          "callee": "syslog_clear",
          "args": [],
          "line": 1673
        },
        "resolved": true,
        "details": {
          "function_name": "syslog_clear",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "1625-1630",
          "snippet": "static void syslog_clear(void)\n{\n\tmutex_lock(&syslog_lock);\n\tlatched_seq_write(&clear_seq, prb_next_seq(prb));\n\tmutex_unlock(&syslog_lock);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_MUTEX(syslog_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic DEFINE_MUTEX(syslog_lock);\n\nstatic void syslog_clear(void)\n{\n\tmutex_lock(&syslog_lock);\n\tlatched_seq_write(&clear_seq, prb_next_seq(prb));\n\tmutex_unlock(&syslog_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "syslog_print_all",
          "args": [
            "buf",
            "len",
            "clear"
          ],
          "line": 1669
        },
        "resolved": true,
        "details": {
          "function_name": "syslog_print_all",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "1572-1623",
          "snippet": "static int syslog_print_all(char __user *buf, int size, bool clear)\n{\n\tstruct printk_info info;\n\tstruct printk_record r;\n\tchar *text;\n\tint len = 0;\n\tu64 seq;\n\tbool time;\n\n\ttext = kmalloc(CONSOLE_LOG_MAX, GFP_KERNEL);\n\tif (!text)\n\t\treturn -ENOMEM;\n\n\ttime = printk_time;\n\t/*\n\t * Find first record that fits, including all following records,\n\t * into the user-provided buffer for this dump.\n\t */\n\tseq = find_first_fitting_seq(latched_seq_read_nolock(&clear_seq), -1,\n\t\t\t\t     size, true, time);\n\n\tprb_rec_init_rd(&r, &info, text, CONSOLE_LOG_MAX);\n\n\tlen = 0;\n\tprb_for_each_record(seq, prb, seq, &r) {\n\t\tint textlen;\n\n\t\ttextlen = record_print_text(&r, true, time);\n\n\t\tif (len + textlen > size) {\n\t\t\tseq--;\n\t\t\tbreak;\n\t\t}\n\n\t\tif (copy_to_user(buf + len, text, textlen))\n\t\t\tlen = -EFAULT;\n\t\telse\n\t\t\tlen += textlen;\n\n\t\tif (len < 0)\n\t\t\tbreak;\n\t}\n\n\tif (clear) {\n\t\tmutex_lock(&syslog_lock);\n\t\tlatched_seq_write(&clear_seq, seq);\n\t\tmutex_unlock(&syslog_lock);\n\t}\n\n\tkfree(text);\n\treturn len;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define printk_time\t\tfalse",
            "#define CONSOLE_LOG_MAX\t\t0",
            "#define CONSOLE_LOG_MAX\t\t1024"
          ],
          "globals_used": [
            "static DEFINE_MUTEX(syslog_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define printk_time\t\tfalse\n#define CONSOLE_LOG_MAX\t\t0\n#define CONSOLE_LOG_MAX\t\t1024\n\nstatic DEFINE_MUTEX(syslog_lock);\n\nstatic int syslog_print_all(char __user *buf, int size, bool clear)\n{\n\tstruct printk_info info;\n\tstruct printk_record r;\n\tchar *text;\n\tint len = 0;\n\tu64 seq;\n\tbool time;\n\n\ttext = kmalloc(CONSOLE_LOG_MAX, GFP_KERNEL);\n\tif (!text)\n\t\treturn -ENOMEM;\n\n\ttime = printk_time;\n\t/*\n\t * Find first record that fits, including all following records,\n\t * into the user-provided buffer for this dump.\n\t */\n\tseq = find_first_fitting_seq(latched_seq_read_nolock(&clear_seq), -1,\n\t\t\t\t     size, true, time);\n\n\tprb_rec_init_rd(&r, &info, text, CONSOLE_LOG_MAX);\n\n\tlen = 0;\n\tprb_for_each_record(seq, prb, seq, &r) {\n\t\tint textlen;\n\n\t\ttextlen = record_print_text(&r, true, time);\n\n\t\tif (len + textlen > size) {\n\t\t\tseq--;\n\t\t\tbreak;\n\t\t}\n\n\t\tif (copy_to_user(buf + len, text, textlen))\n\t\t\tlen = -EFAULT;\n\t\telse\n\t\t\tlen += textlen;\n\n\t\tif (len < 0)\n\t\t\tbreak;\n\t}\n\n\tif (clear) {\n\t\tmutex_lock(&syslog_lock);\n\t\tlatched_seq_write(&clear_seq, seq);\n\t\tmutex_unlock(&syslog_lock);\n\t}\n\n\tkfree(text);\n\treturn len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "access_ok",
          "args": [
            "buf",
            "len"
          ],
          "line": 1667
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "syslog_print",
          "args": [
            "buf",
            "len"
          ],
          "line": 1655
        },
        "resolved": true,
        "details": {
          "function_name": "syslog_print",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "1479-1570",
          "snippet": "static int syslog_print(char __user *buf, int size)\n{\n\tstruct printk_info info;\n\tstruct printk_record r;\n\tchar *text;\n\tint len = 0;\n\tu64 seq;\n\n\ttext = kmalloc(CONSOLE_LOG_MAX, GFP_KERNEL);\n\tif (!text)\n\t\treturn -ENOMEM;\n\n\tprb_rec_init_rd(&r, &info, text, CONSOLE_LOG_MAX);\n\n\tmutex_lock(&syslog_lock);\n\n\t/*\n\t * Wait for the @syslog_seq record to be available. @syslog_seq may\n\t * change while waiting.\n\t */\n\tdo {\n\t\tseq = syslog_seq;\n\n\t\tmutex_unlock(&syslog_lock);\n\t\tlen = wait_event_interruptible(log_wait, prb_read_valid(prb, seq, NULL));\n\t\tmutex_lock(&syslog_lock);\n\n\t\tif (len)\n\t\t\tgoto out;\n\t} while (syslog_seq != seq);\n\n\t/*\n\t * Copy records that fit into the buffer. The above cycle makes sure\n\t * that the first record is always available.\n\t */\n\tdo {\n\t\tsize_t n;\n\t\tsize_t skip;\n\t\tint err;\n\n\t\tif (!prb_read_valid(prb, syslog_seq, &r))\n\t\t\tbreak;\n\n\t\tif (r.info->seq != syslog_seq) {\n\t\t\t/* message is gone, move to next valid one */\n\t\t\tsyslog_seq = r.info->seq;\n\t\t\tsyslog_partial = 0;\n\t\t}\n\n\t\t/*\n\t\t * To keep reading/counting partial line consistent,\n\t\t * use printk_time value as of the beginning of a line.\n\t\t */\n\t\tif (!syslog_partial)\n\t\t\tsyslog_time = printk_time;\n\n\t\tskip = syslog_partial;\n\t\tn = record_print_text(&r, true, syslog_time);\n\t\tif (n - syslog_partial <= size) {\n\t\t\t/* message fits into buffer, move forward */\n\t\t\tsyslog_seq = r.info->seq + 1;\n\t\t\tn -= syslog_partial;\n\t\t\tsyslog_partial = 0;\n\t\t} else if (!len){\n\t\t\t/* partial read(), remember position */\n\t\t\tn = size;\n\t\t\tsyslog_partial += n;\n\t\t} else\n\t\t\tn = 0;\n\n\t\tif (!n)\n\t\t\tbreak;\n\n\t\tmutex_unlock(&syslog_lock);\n\t\terr = copy_to_user(buf, text + skip, n);\n\t\tmutex_lock(&syslog_lock);\n\n\t\tif (err) {\n\t\t\tif (!len)\n\t\t\t\tlen = -EFAULT;\n\t\t\tbreak;\n\t\t}\n\n\t\tlen += n;\n\t\tsize -= n;\n\t\tbuf += n;\n\t} while (size);\nout:\n\tmutex_unlock(&syslog_lock);\n\tkfree(text);\n\treturn len;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define printk_time\t\tfalse",
            "#define CONSOLE_LOG_MAX\t\t0",
            "#define CONSOLE_LOG_MAX\t\t1024"
          ],
          "globals_used": [
            "static DEFINE_MUTEX(syslog_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define printk_time\t\tfalse\n#define CONSOLE_LOG_MAX\t\t0\n#define CONSOLE_LOG_MAX\t\t1024\n\nstatic DEFINE_MUTEX(syslog_lock);\n\nstatic int syslog_print(char __user *buf, int size)\n{\n\tstruct printk_info info;\n\tstruct printk_record r;\n\tchar *text;\n\tint len = 0;\n\tu64 seq;\n\n\ttext = kmalloc(CONSOLE_LOG_MAX, GFP_KERNEL);\n\tif (!text)\n\t\treturn -ENOMEM;\n\n\tprb_rec_init_rd(&r, &info, text, CONSOLE_LOG_MAX);\n\n\tmutex_lock(&syslog_lock);\n\n\t/*\n\t * Wait for the @syslog_seq record to be available. @syslog_seq may\n\t * change while waiting.\n\t */\n\tdo {\n\t\tseq = syslog_seq;\n\n\t\tmutex_unlock(&syslog_lock);\n\t\tlen = wait_event_interruptible(log_wait, prb_read_valid(prb, seq, NULL));\n\t\tmutex_lock(&syslog_lock);\n\n\t\tif (len)\n\t\t\tgoto out;\n\t} while (syslog_seq != seq);\n\n\t/*\n\t * Copy records that fit into the buffer. The above cycle makes sure\n\t * that the first record is always available.\n\t */\n\tdo {\n\t\tsize_t n;\n\t\tsize_t skip;\n\t\tint err;\n\n\t\tif (!prb_read_valid(prb, syslog_seq, &r))\n\t\t\tbreak;\n\n\t\tif (r.info->seq != syslog_seq) {\n\t\t\t/* message is gone, move to next valid one */\n\t\t\tsyslog_seq = r.info->seq;\n\t\t\tsyslog_partial = 0;\n\t\t}\n\n\t\t/*\n\t\t * To keep reading/counting partial line consistent,\n\t\t * use printk_time value as of the beginning of a line.\n\t\t */\n\t\tif (!syslog_partial)\n\t\t\tsyslog_time = printk_time;\n\n\t\tskip = syslog_partial;\n\t\tn = record_print_text(&r, true, syslog_time);\n\t\tif (n - syslog_partial <= size) {\n\t\t\t/* message fits into buffer, move forward */\n\t\t\tsyslog_seq = r.info->seq + 1;\n\t\t\tn -= syslog_partial;\n\t\t\tsyslog_partial = 0;\n\t\t} else if (!len){\n\t\t\t/* partial read(), remember position */\n\t\t\tn = size;\n\t\t\tsyslog_partial += n;\n\t\t} else\n\t\t\tn = 0;\n\n\t\tif (!n)\n\t\t\tbreak;\n\n\t\tmutex_unlock(&syslog_lock);\n\t\terr = copy_to_user(buf, text + skip, n);\n\t\tmutex_lock(&syslog_lock);\n\n\t\tif (err) {\n\t\t\tif (!len)\n\t\t\t\tlen = -EFAULT;\n\t\t\tbreak;\n\t\t}\n\n\t\tlen += n;\n\t\tsize -= n;\n\t\tbuf += n;\n\t} while (size);\nout:\n\tmutex_unlock(&syslog_lock);\n\tkfree(text);\n\treturn len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "access_ok",
          "args": [
            "buf",
            "len"
          ],
          "line": 1653
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "check_syslog_permissions",
          "args": [
            "type",
            "source"
          ],
          "line": 1639
        },
        "resolved": true,
        "details": {
          "function_name": "check_syslog_permissions",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "516-543",
          "snippet": "static int check_syslog_permissions(int type, int source)\n{\n\t/*\n\t * If this is from /proc/kmsg and we've already opened it, then we've\n\t * already done the capabilities checks at open time.\n\t */\n\tif (source == SYSLOG_FROM_PROC && type != SYSLOG_ACTION_OPEN)\n\t\tgoto ok;\n\n\tif (syslog_action_restricted(type)) {\n\t\tif (capable(CAP_SYSLOG))\n\t\t\tgoto ok;\n\t\t/*\n\t\t * For historical reasons, accept CAP_SYS_ADMIN too, with\n\t\t * a warning.\n\t\t */\n\t\tif (capable(CAP_SYS_ADMIN)) {\n\t\t\tpr_warn_once(\"%s (%d): Attempt to access syslog with \"\n\t\t\t\t     \"CAP_SYS_ADMIN but no CAP_SYSLOG \"\n\t\t\t\t     \"(deprecated).\\n\",\n\t\t\t\t current->comm, task_pid_nr(current));\n\t\t\tgoto ok;\n\t\t}\n\t\treturn -EPERM;\n\t}\nok:\n\treturn security_syslog(type);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic int check_syslog_permissions(int type, int source)\n{\n\t/*\n\t * If this is from /proc/kmsg and we've already opened it, then we've\n\t * already done the capabilities checks at open time.\n\t */\n\tif (source == SYSLOG_FROM_PROC && type != SYSLOG_ACTION_OPEN)\n\t\tgoto ok;\n\n\tif (syslog_action_restricted(type)) {\n\t\tif (capable(CAP_SYSLOG))\n\t\t\tgoto ok;\n\t\t/*\n\t\t * For historical reasons, accept CAP_SYS_ADMIN too, with\n\t\t * a warning.\n\t\t */\n\t\tif (capable(CAP_SYS_ADMIN)) {\n\t\t\tpr_warn_once(\"%s (%d): Attempt to access syslog with \"\n\t\t\t\t     \"CAP_SYS_ADMIN but no CAP_SYSLOG \"\n\t\t\t\t     \"(deprecated).\\n\",\n\t\t\t\t current->comm, task_pid_nr(current));\n\t\t\tgoto ok;\n\t\t}\n\t\treturn -EPERM;\n\t}\nok:\n\treturn security_syslog(type);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define printk_time\t\tfalse\n\nstatic DEFINE_MUTEX(syslog_lock);\n\nint do_syslog(int type, char __user *buf, int len, int source)\n{\n\tstruct printk_info info;\n\tbool clear = false;\n\tstatic int saved_console_loglevel = LOGLEVEL_DEFAULT;\n\tint error;\n\n\terror = check_syslog_permissions(type, source);\n\tif (error)\n\t\treturn error;\n\n\tswitch (type) {\n\tcase SYSLOG_ACTION_CLOSE:\t/* Close log */\n\t\tbreak;\n\tcase SYSLOG_ACTION_OPEN:\t/* Open log */\n\t\tbreak;\n\tcase SYSLOG_ACTION_READ:\t/* Read from log */\n\t\tif (!buf || len < 0)\n\t\t\treturn -EINVAL;\n\t\tif (!len)\n\t\t\treturn 0;\n\t\tif (!access_ok(buf, len))\n\t\t\treturn -EFAULT;\n\t\terror = syslog_print(buf, len);\n\t\tbreak;\n\t/* Read/clear last kernel messages */\n\tcase SYSLOG_ACTION_READ_CLEAR:\n\t\tclear = true;\n\t\tfallthrough;\n\t/* Read last kernel messages */\n\tcase SYSLOG_ACTION_READ_ALL:\n\t\tif (!buf || len < 0)\n\t\t\treturn -EINVAL;\n\t\tif (!len)\n\t\t\treturn 0;\n\t\tif (!access_ok(buf, len))\n\t\t\treturn -EFAULT;\n\t\terror = syslog_print_all(buf, len, clear);\n\t\tbreak;\n\t/* Clear ring buffer */\n\tcase SYSLOG_ACTION_CLEAR:\n\t\tsyslog_clear();\n\t\tbreak;\n\t/* Disable logging to console */\n\tcase SYSLOG_ACTION_CONSOLE_OFF:\n\t\tif (saved_console_loglevel == LOGLEVEL_DEFAULT)\n\t\t\tsaved_console_loglevel = console_loglevel;\n\t\tconsole_loglevel = minimum_console_loglevel;\n\t\tbreak;\n\t/* Enable logging to console */\n\tcase SYSLOG_ACTION_CONSOLE_ON:\n\t\tif (saved_console_loglevel != LOGLEVEL_DEFAULT) {\n\t\t\tconsole_loglevel = saved_console_loglevel;\n\t\t\tsaved_console_loglevel = LOGLEVEL_DEFAULT;\n\t\t}\n\t\tbreak;\n\t/* Set level of messages printed to console */\n\tcase SYSLOG_ACTION_CONSOLE_LEVEL:\n\t\tif (len < 1 || len > 8)\n\t\t\treturn -EINVAL;\n\t\tif (len < minimum_console_loglevel)\n\t\t\tlen = minimum_console_loglevel;\n\t\tconsole_loglevel = len;\n\t\t/* Implicitly re-enable logging to console */\n\t\tsaved_console_loglevel = LOGLEVEL_DEFAULT;\n\t\tbreak;\n\t/* Number of chars in the log buffer */\n\tcase SYSLOG_ACTION_SIZE_UNREAD:\n\t\tmutex_lock(&syslog_lock);\n\t\tif (!prb_read_valid_info(prb, syslog_seq, &info, NULL)) {\n\t\t\t/* No unread messages. */\n\t\t\tmutex_unlock(&syslog_lock);\n\t\t\treturn 0;\n\t\t}\n\t\tif (info.seq != syslog_seq) {\n\t\t\t/* messages are gone, move to first one */\n\t\t\tsyslog_seq = info.seq;\n\t\t\tsyslog_partial = 0;\n\t\t}\n\t\tif (source == SYSLOG_FROM_PROC) {\n\t\t\t/*\n\t\t\t * Short-cut for poll(/\"proc/kmsg\") which simply checks\n\t\t\t * for pending data, not the size; return the count of\n\t\t\t * records, not the length.\n\t\t\t */\n\t\t\terror = prb_next_seq(prb) - syslog_seq;\n\t\t} else {\n\t\t\tbool time = syslog_partial ? syslog_time : printk_time;\n\t\t\tunsigned int line_count;\n\t\t\tu64 seq;\n\n\t\t\tprb_for_each_info(syslog_seq, prb, seq, &info,\n\t\t\t\t\t  &line_count) {\n\t\t\t\terror += get_record_print_text_size(&info, line_count,\n\t\t\t\t\t\t\t\t    true, time);\n\t\t\t\ttime = printk_time;\n\t\t\t}\n\t\t\terror -= syslog_partial;\n\t\t}\n\t\tmutex_unlock(&syslog_lock);\n\t\tbreak;\n\t/* Size of the log buffer */\n\tcase SYSLOG_ACTION_SIZE_BUFFER:\n\t\terror = log_buf_len;\n\t\tbreak;\n\tdefault:\n\t\terror = -EINVAL;\n\t\tbreak;\n\t}\n\n\treturn error;\n}"
  },
  {
    "function_name": "syslog_clear",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "1625-1630",
    "snippet": "static void syslog_clear(void)\n{\n\tmutex_lock(&syslog_lock);\n\tlatched_seq_write(&clear_seq, prb_next_seq(prb));\n\tmutex_unlock(&syslog_lock);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_MUTEX(syslog_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&syslog_lock"
          ],
          "line": 1629
        },
        "resolved": true,
        "details": {
          "function_name": "__rt_mutex_unlock",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/rtmutex.c",
          "lines": "1350-1356",
          "snippet": "static __always_inline void __rt_mutex_unlock(struct rt_mutex_base *lock)\n{\n\tif (likely(rt_mutex_cmpxchg_release(lock, current, NULL)))\n\t\treturn;\n\n\trt_mutex_slowunlock(lock);\n}",
          "includes": [
            "# include \"ww_mutex.h\"",
            "#include \"rtmutex_common.h\"",
            "#include <linux/ww_mutex.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "# include \"ww_mutex.h\"\n#include \"rtmutex_common.h\"\n#include <linux/ww_mutex.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n\nstatic __always_inline struct;\n\nstatic __always_inline void __rt_mutex_unlock(struct rt_mutex_base *lock)\n{\n\tif (likely(rt_mutex_cmpxchg_release(lock, current, NULL)))\n\t\treturn;\n\n\trt_mutex_slowunlock(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "latched_seq_write",
          "args": [
            "&clear_seq",
            "prb_next_seq(prb)"
          ],
          "line": 1628
        },
        "resolved": true,
        "details": {
          "function_name": "latched_seq_write",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "439-445",
          "snippet": "static void latched_seq_write(struct latched_seq *ls, u64 val)\n{\n\traw_write_seqcount_latch(&ls->latch);\n\tls->val[0] = val;\n\traw_write_seqcount_latch(&ls->latch);\n\tls->val[1] = val;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic void latched_seq_write(struct latched_seq *ls, u64 val)\n{\n\traw_write_seqcount_latch(&ls->latch);\n\tls->val[0] = val;\n\traw_write_seqcount_latch(&ls->latch);\n\tls->val[1] = val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prb_next_seq",
          "args": [
            "prb"
          ],
          "line": 1628
        },
        "resolved": true,
        "details": {
          "function_name": "prb_next_seq",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk_ringbuffer.c",
          "lines": "2006-2015",
          "snippet": "u64 prb_next_seq(struct printk_ringbuffer *rb)\n{\n\tu64 seq = 0;\n\n\t/* Search forward from the oldest descriptor. */\n\twhile (_prb_read_valid(rb, &seq, NULL, NULL))\n\t\tseq++;\n\n\treturn seq;\n}",
          "includes": [
            "#include \"printk_ringbuffer.h\"",
            "#include <linux/bug.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/irqflags.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"printk_ringbuffer.h\"\n#include <linux/bug.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/irqflags.h>\n#include <linux/kernel.h>\n\nu64 prb_next_seq(struct printk_ringbuffer *rb)\n{\n\tu64 seq = 0;\n\n\t/* Search forward from the oldest descriptor. */\n\twhile (_prb_read_valid(rb, &seq, NULL, NULL))\n\t\tseq++;\n\n\treturn seq;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&syslog_lock"
          ],
          "line": 1627
        },
        "resolved": true,
        "details": {
          "function_name": "mutex_lock_io",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/rtmutex_api.c",
          "lines": "580-586",
          "snippet": "void __sched mutex_lock_io(struct mutex *lock)\n{\n\tint token = io_schedule_prepare();\n\n\t__mutex_lock_common(lock, TASK_UNINTERRUPTIBLE, 0, NULL, _RET_IP_);\n\tio_schedule_finish(token);\n}",
          "includes": [
            "#include \"rtmutex.c\"",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex.c\"\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nvoid __sched mutex_lock_io(struct mutex *lock)\n{\n\tint token = io_schedule_prepare();\n\n\t__mutex_lock_common(lock, TASK_UNINTERRUPTIBLE, 0, NULL, _RET_IP_);\n\tio_schedule_finish(token);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic DEFINE_MUTEX(syslog_lock);\n\nstatic void syslog_clear(void)\n{\n\tmutex_lock(&syslog_lock);\n\tlatched_seq_write(&clear_seq, prb_next_seq(prb));\n\tmutex_unlock(&syslog_lock);\n}"
  },
  {
    "function_name": "syslog_print_all",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "1572-1623",
    "snippet": "static int syslog_print_all(char __user *buf, int size, bool clear)\n{\n\tstruct printk_info info;\n\tstruct printk_record r;\n\tchar *text;\n\tint len = 0;\n\tu64 seq;\n\tbool time;\n\n\ttext = kmalloc(CONSOLE_LOG_MAX, GFP_KERNEL);\n\tif (!text)\n\t\treturn -ENOMEM;\n\n\ttime = printk_time;\n\t/*\n\t * Find first record that fits, including all following records,\n\t * into the user-provided buffer for this dump.\n\t */\n\tseq = find_first_fitting_seq(latched_seq_read_nolock(&clear_seq), -1,\n\t\t\t\t     size, true, time);\n\n\tprb_rec_init_rd(&r, &info, text, CONSOLE_LOG_MAX);\n\n\tlen = 0;\n\tprb_for_each_record(seq, prb, seq, &r) {\n\t\tint textlen;\n\n\t\ttextlen = record_print_text(&r, true, time);\n\n\t\tif (len + textlen > size) {\n\t\t\tseq--;\n\t\t\tbreak;\n\t\t}\n\n\t\tif (copy_to_user(buf + len, text, textlen))\n\t\t\tlen = -EFAULT;\n\t\telse\n\t\t\tlen += textlen;\n\n\t\tif (len < 0)\n\t\t\tbreak;\n\t}\n\n\tif (clear) {\n\t\tmutex_lock(&syslog_lock);\n\t\tlatched_seq_write(&clear_seq, seq);\n\t\tmutex_unlock(&syslog_lock);\n\t}\n\n\tkfree(text);\n\treturn len;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define printk_time\t\tfalse",
      "#define CONSOLE_LOG_MAX\t\t0",
      "#define CONSOLE_LOG_MAX\t\t1024"
    ],
    "globals_used": [
      "static DEFINE_MUTEX(syslog_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "text"
          ],
          "line": 1621
        },
        "resolved": true,
        "details": {
          "function_name": "maybe_kfree_parameter",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/params.c",
          "lines": "62-75",
          "snippet": "static void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}",
          "includes": [
            "#include <linux/security.h>",
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(kmalloced_params);",
            "static DEFINE_SPINLOCK(kmalloced_params_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/security.h>\n#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(kmalloced_params);\nstatic DEFINE_SPINLOCK(kmalloced_params_lock);\n\nstatic void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&syslog_lock"
          ],
          "line": 1618
        },
        "resolved": true,
        "details": {
          "function_name": "__rt_mutex_unlock",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/rtmutex.c",
          "lines": "1350-1356",
          "snippet": "static __always_inline void __rt_mutex_unlock(struct rt_mutex_base *lock)\n{\n\tif (likely(rt_mutex_cmpxchg_release(lock, current, NULL)))\n\t\treturn;\n\n\trt_mutex_slowunlock(lock);\n}",
          "includes": [
            "# include \"ww_mutex.h\"",
            "#include \"rtmutex_common.h\"",
            "#include <linux/ww_mutex.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "# include \"ww_mutex.h\"\n#include \"rtmutex_common.h\"\n#include <linux/ww_mutex.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n\nstatic __always_inline struct;\n\nstatic __always_inline void __rt_mutex_unlock(struct rt_mutex_base *lock)\n{\n\tif (likely(rt_mutex_cmpxchg_release(lock, current, NULL)))\n\t\treturn;\n\n\trt_mutex_slowunlock(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "latched_seq_write",
          "args": [
            "&clear_seq",
            "seq"
          ],
          "line": 1617
        },
        "resolved": true,
        "details": {
          "function_name": "latched_seq_write",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "439-445",
          "snippet": "static void latched_seq_write(struct latched_seq *ls, u64 val)\n{\n\traw_write_seqcount_latch(&ls->latch);\n\tls->val[0] = val;\n\traw_write_seqcount_latch(&ls->latch);\n\tls->val[1] = val;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic void latched_seq_write(struct latched_seq *ls, u64 val)\n{\n\traw_write_seqcount_latch(&ls->latch);\n\tls->val[0] = val;\n\traw_write_seqcount_latch(&ls->latch);\n\tls->val[1] = val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&syslog_lock"
          ],
          "line": 1616
        },
        "resolved": true,
        "details": {
          "function_name": "mutex_lock_io",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/rtmutex_api.c",
          "lines": "580-586",
          "snippet": "void __sched mutex_lock_io(struct mutex *lock)\n{\n\tint token = io_schedule_prepare();\n\n\t__mutex_lock_common(lock, TASK_UNINTERRUPTIBLE, 0, NULL, _RET_IP_);\n\tio_schedule_finish(token);\n}",
          "includes": [
            "#include \"rtmutex.c\"",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex.c\"\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nvoid __sched mutex_lock_io(struct mutex *lock)\n{\n\tint token = io_schedule_prepare();\n\n\t__mutex_lock_common(lock, TASK_UNINTERRUPTIBLE, 0, NULL, _RET_IP_);\n\tio_schedule_finish(token);\n}"
        }
      },
      {
        "call_info": {
          "callee": "copy_to_user",
          "args": [
            "buf + len",
            "text",
            "textlen"
          ],
          "line": 1606
        },
        "resolved": true,
        "details": {
          "function_name": "sched_attr_copy_to_user",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/core.c",
          "lines": "7847-7876",
          "snippet": "static int\nsched_attr_copy_to_user(struct sched_attr __user *uattr,\n\t\t\tstruct sched_attr *kattr,\n\t\t\tunsigned int usize)\n{\n\tunsigned int ksize = sizeof(*kattr);\n\n\tif (!access_ok(uattr, usize))\n\t\treturn -EFAULT;\n\n\t/*\n\t * sched_getattr() ABI forwards and backwards compatibility:\n\t *\n\t * If usize == ksize then we just copy everything to user-space and all is good.\n\t *\n\t * If usize < ksize then we only copy as much as user-space has space for,\n\t * this keeps ABI compatibility as well. We skip the rest.\n\t *\n\t * If usize > ksize then user-space is using a newer version of the ABI,\n\t * which part the kernel doesn't know about. Just ignore it - tooling can\n\t * detect the kernel's knowledge of attributes from the attr->size value\n\t * which is set to ksize in this case.\n\t */\n\tkattr->size = min(usize, ksize);\n\n\tif (copy_to_user(uattr, kattr, kattr->size))\n\t\treturn -EFAULT;\n\n\treturn 0;\n}",
          "includes": [
            "#include <linux/entry-common.h>",
            "#include \"features.h\"",
            "#include \"smp.h\"",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../../fs/io-wq.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/scs.h>",
            "#include <linux/kcov.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\"",
            "#include <trace/events/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/entry-common.h>\n#include \"features.h\"\n#include \"smp.h\"\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../../fs/io-wq.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/scs.h>\n#include <linux/kcov.h>\n#include <linux/blkdev.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n#include <trace/events/sched.h>\n\nstatic __always_inline struct;\n\nstatic int\nsched_attr_copy_to_user(struct sched_attr __user *uattr,\n\t\t\tstruct sched_attr *kattr,\n\t\t\tunsigned int usize)\n{\n\tunsigned int ksize = sizeof(*kattr);\n\n\tif (!access_ok(uattr, usize))\n\t\treturn -EFAULT;\n\n\t/*\n\t * sched_getattr() ABI forwards and backwards compatibility:\n\t *\n\t * If usize == ksize then we just copy everything to user-space and all is good.\n\t *\n\t * If usize < ksize then we only copy as much as user-space has space for,\n\t * this keeps ABI compatibility as well. We skip the rest.\n\t *\n\t * If usize > ksize then user-space is using a newer version of the ABI,\n\t * which part the kernel doesn't know about. Just ignore it - tooling can\n\t * detect the kernel's knowledge of attributes from the attr->size value\n\t * which is set to ksize in this case.\n\t */\n\tkattr->size = min(usize, ksize);\n\n\tif (copy_to_user(uattr, kattr, kattr->size))\n\t\treturn -EFAULT;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "record_print_text",
          "args": [
            "&r",
            "true",
            "time"
          ],
          "line": 1599
        },
        "resolved": true,
        "details": {
          "function_name": "record_print_text",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2286-2290",
          "snippet": "static size_t record_print_text(const struct printk_record *r,\n\t\t\t\tbool syslog, bool time)\n{\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic size_t record_print_text(const struct printk_record *r,\n\t\t\t\tbool syslog, bool time)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prb_for_each_record",
          "args": [
            "seq",
            "prb",
            "seq",
            "&r"
          ],
          "line": 1596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prb_rec_init_rd",
          "args": [
            "&r",
            "&info",
            "text",
            "CONSOLE_LOG_MAX"
          ],
          "line": 1593
        },
        "resolved": true,
        "details": {
          "function_name": "prb_rec_init_rd",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk_ringbuffer.h",
          "lines": "330-337",
          "snippet": "static inline void prb_rec_init_rd(struct printk_record *r,\n\t\t\t\t   struct printk_info *info,\n\t\t\t\t   char *text_buf, unsigned int text_buf_size)\n{\n\tr->info = info;\n\tr->text_buf = text_buf;\n\tr->text_buf_size = text_buf_size;\n}",
          "includes": [
            "#include <linux/dev_printk.h>",
            "#include <linux/atomic.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/dev_printk.h>\n#include <linux/atomic.h>\n\nstatic inline void prb_rec_init_rd(struct printk_record *r,\n\t\t\t\t   struct printk_info *info,\n\t\t\t\t   char *text_buf, unsigned int text_buf_size)\n{\n\tr->info = info;\n\tr->text_buf = text_buf;\n\tr->text_buf_size = text_buf_size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "find_first_fitting_seq",
          "args": [
            "latched_seq_read_nolock(&clear_seq)",
            "-1",
            "size",
            "true",
            "time"
          ],
          "line": 1590
        },
        "resolved": true,
        "details": {
          "function_name": "find_first_fitting_seq",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "1441-1476",
          "snippet": "static u64 find_first_fitting_seq(u64 start_seq, u64 max_seq, size_t size,\n\t\t\t\t  bool syslog, bool time)\n{\n\tstruct printk_info info;\n\tunsigned int line_count;\n\tsize_t len = 0;\n\tu64 seq;\n\n\t/* Determine the size of the records up to @max_seq. */\n\tprb_for_each_info(start_seq, prb, seq, &info, &line_count) {\n\t\tif (info.seq >= max_seq)\n\t\t\tbreak;\n\t\tlen += get_record_print_text_size(&info, line_count, syslog, time);\n\t}\n\n\t/*\n\t * Adjust the upper bound for the next loop to avoid subtracting\n\t * lengths that were never added.\n\t */\n\tif (seq < max_seq)\n\t\tmax_seq = seq;\n\n\t/*\n\t * Move first record forward until length fits into the buffer. Ignore\n\t * newest messages that were not counted in the above cycle. Messages\n\t * might appear and get lost in the meantime. This is a best effort\n\t * that prevents an infinite loop that could occur with a retry.\n\t */\n\tprb_for_each_info(start_seq, prb, seq, &info, &line_count) {\n\t\tif (len <= size || info.seq >= max_seq)\n\t\t\tbreak;\n\t\tlen -= get_record_print_text_size(&info, line_count, syslog, time);\n\t}\n\n\treturn seq;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic u64 find_first_fitting_seq(u64 start_seq, u64 max_seq, size_t size,\n\t\t\t\t  bool syslog, bool time)\n{\n\tstruct printk_info info;\n\tunsigned int line_count;\n\tsize_t len = 0;\n\tu64 seq;\n\n\t/* Determine the size of the records up to @max_seq. */\n\tprb_for_each_info(start_seq, prb, seq, &info, &line_count) {\n\t\tif (info.seq >= max_seq)\n\t\t\tbreak;\n\t\tlen += get_record_print_text_size(&info, line_count, syslog, time);\n\t}\n\n\t/*\n\t * Adjust the upper bound for the next loop to avoid subtracting\n\t * lengths that were never added.\n\t */\n\tif (seq < max_seq)\n\t\tmax_seq = seq;\n\n\t/*\n\t * Move first record forward until length fits into the buffer. Ignore\n\t * newest messages that were not counted in the above cycle. Messages\n\t * might appear and get lost in the meantime. This is a best effort\n\t * that prevents an infinite loop that could occur with a retry.\n\t */\n\tprb_for_each_info(start_seq, prb, seq, &info, &line_count) {\n\t\tif (len <= size || info.seq >= max_seq)\n\t\t\tbreak;\n\t\tlen -= get_record_print_text_size(&info, line_count, syslog, time);\n\t}\n\n\treturn seq;\n}"
        }
      },
      {
        "call_info": {
          "callee": "latched_seq_read_nolock",
          "args": [
            "&clear_seq"
          ],
          "line": 1590
        },
        "resolved": true,
        "details": {
          "function_name": "latched_seq_read_nolock",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "448-461",
          "snippet": "static u64 latched_seq_read_nolock(struct latched_seq *ls)\n{\n\tunsigned int seq;\n\tunsigned int idx;\n\tu64 val;\n\n\tdo {\n\t\tseq = raw_read_seqcount_latch(&ls->latch);\n\t\tidx = seq & 0x1;\n\t\tval = ls->val[idx];\n\t} while (read_seqcount_latch_retry(&ls->latch, seq));\n\n\treturn val;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic u64 latched_seq_read_nolock(struct latched_seq *ls)\n{\n\tunsigned int seq;\n\tunsigned int idx;\n\tu64 val;\n\n\tdo {\n\t\tseq = raw_read_seqcount_latch(&ls->latch);\n\t\tidx = seq & 0x1;\n\t\tval = ls->val[idx];\n\t} while (read_seqcount_latch_retry(&ls->latch, seq));\n\n\treturn val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "CONSOLE_LOG_MAX",
            "GFP_KERNEL"
          ],
          "line": 1581
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define printk_time\t\tfalse\n#define CONSOLE_LOG_MAX\t\t0\n#define CONSOLE_LOG_MAX\t\t1024\n\nstatic DEFINE_MUTEX(syslog_lock);\n\nstatic int syslog_print_all(char __user *buf, int size, bool clear)\n{\n\tstruct printk_info info;\n\tstruct printk_record r;\n\tchar *text;\n\tint len = 0;\n\tu64 seq;\n\tbool time;\n\n\ttext = kmalloc(CONSOLE_LOG_MAX, GFP_KERNEL);\n\tif (!text)\n\t\treturn -ENOMEM;\n\n\ttime = printk_time;\n\t/*\n\t * Find first record that fits, including all following records,\n\t * into the user-provided buffer for this dump.\n\t */\n\tseq = find_first_fitting_seq(latched_seq_read_nolock(&clear_seq), -1,\n\t\t\t\t     size, true, time);\n\n\tprb_rec_init_rd(&r, &info, text, CONSOLE_LOG_MAX);\n\n\tlen = 0;\n\tprb_for_each_record(seq, prb, seq, &r) {\n\t\tint textlen;\n\n\t\ttextlen = record_print_text(&r, true, time);\n\n\t\tif (len + textlen > size) {\n\t\t\tseq--;\n\t\t\tbreak;\n\t\t}\n\n\t\tif (copy_to_user(buf + len, text, textlen))\n\t\t\tlen = -EFAULT;\n\t\telse\n\t\t\tlen += textlen;\n\n\t\tif (len < 0)\n\t\t\tbreak;\n\t}\n\n\tif (clear) {\n\t\tmutex_lock(&syslog_lock);\n\t\tlatched_seq_write(&clear_seq, seq);\n\t\tmutex_unlock(&syslog_lock);\n\t}\n\n\tkfree(text);\n\treturn len;\n}"
  },
  {
    "function_name": "syslog_print",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "1479-1570",
    "snippet": "static int syslog_print(char __user *buf, int size)\n{\n\tstruct printk_info info;\n\tstruct printk_record r;\n\tchar *text;\n\tint len = 0;\n\tu64 seq;\n\n\ttext = kmalloc(CONSOLE_LOG_MAX, GFP_KERNEL);\n\tif (!text)\n\t\treturn -ENOMEM;\n\n\tprb_rec_init_rd(&r, &info, text, CONSOLE_LOG_MAX);\n\n\tmutex_lock(&syslog_lock);\n\n\t/*\n\t * Wait for the @syslog_seq record to be available. @syslog_seq may\n\t * change while waiting.\n\t */\n\tdo {\n\t\tseq = syslog_seq;\n\n\t\tmutex_unlock(&syslog_lock);\n\t\tlen = wait_event_interruptible(log_wait, prb_read_valid(prb, seq, NULL));\n\t\tmutex_lock(&syslog_lock);\n\n\t\tif (len)\n\t\t\tgoto out;\n\t} while (syslog_seq != seq);\n\n\t/*\n\t * Copy records that fit into the buffer. The above cycle makes sure\n\t * that the first record is always available.\n\t */\n\tdo {\n\t\tsize_t n;\n\t\tsize_t skip;\n\t\tint err;\n\n\t\tif (!prb_read_valid(prb, syslog_seq, &r))\n\t\t\tbreak;\n\n\t\tif (r.info->seq != syslog_seq) {\n\t\t\t/* message is gone, move to next valid one */\n\t\t\tsyslog_seq = r.info->seq;\n\t\t\tsyslog_partial = 0;\n\t\t}\n\n\t\t/*\n\t\t * To keep reading/counting partial line consistent,\n\t\t * use printk_time value as of the beginning of a line.\n\t\t */\n\t\tif (!syslog_partial)\n\t\t\tsyslog_time = printk_time;\n\n\t\tskip = syslog_partial;\n\t\tn = record_print_text(&r, true, syslog_time);\n\t\tif (n - syslog_partial <= size) {\n\t\t\t/* message fits into buffer, move forward */\n\t\t\tsyslog_seq = r.info->seq + 1;\n\t\t\tn -= syslog_partial;\n\t\t\tsyslog_partial = 0;\n\t\t} else if (!len){\n\t\t\t/* partial read(), remember position */\n\t\t\tn = size;\n\t\t\tsyslog_partial += n;\n\t\t} else\n\t\t\tn = 0;\n\n\t\tif (!n)\n\t\t\tbreak;\n\n\t\tmutex_unlock(&syslog_lock);\n\t\terr = copy_to_user(buf, text + skip, n);\n\t\tmutex_lock(&syslog_lock);\n\n\t\tif (err) {\n\t\t\tif (!len)\n\t\t\t\tlen = -EFAULT;\n\t\t\tbreak;\n\t\t}\n\n\t\tlen += n;\n\t\tsize -= n;\n\t\tbuf += n;\n\t} while (size);\nout:\n\tmutex_unlock(&syslog_lock);\n\tkfree(text);\n\treturn len;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define printk_time\t\tfalse",
      "#define CONSOLE_LOG_MAX\t\t0",
      "#define CONSOLE_LOG_MAX\t\t1024"
    ],
    "globals_used": [
      "static DEFINE_MUTEX(syslog_lock);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "text"
          ],
          "line": 1568
        },
        "resolved": true,
        "details": {
          "function_name": "maybe_kfree_parameter",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/params.c",
          "lines": "62-75",
          "snippet": "static void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}",
          "includes": [
            "#include <linux/security.h>",
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(kmalloced_params);",
            "static DEFINE_SPINLOCK(kmalloced_params_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/security.h>\n#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(kmalloced_params);\nstatic DEFINE_SPINLOCK(kmalloced_params_lock);\n\nstatic void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&syslog_lock"
          ],
          "line": 1567
        },
        "resolved": true,
        "details": {
          "function_name": "__rt_mutex_unlock",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/rtmutex.c",
          "lines": "1350-1356",
          "snippet": "static __always_inline void __rt_mutex_unlock(struct rt_mutex_base *lock)\n{\n\tif (likely(rt_mutex_cmpxchg_release(lock, current, NULL)))\n\t\treturn;\n\n\trt_mutex_slowunlock(lock);\n}",
          "includes": [
            "# include \"ww_mutex.h\"",
            "#include \"rtmutex_common.h\"",
            "#include <linux/ww_mutex.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "# include \"ww_mutex.h\"\n#include \"rtmutex_common.h\"\n#include <linux/ww_mutex.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n\nstatic __always_inline struct;\n\nstatic __always_inline void __rt_mutex_unlock(struct rt_mutex_base *lock)\n{\n\tif (likely(rt_mutex_cmpxchg_release(lock, current, NULL)))\n\t\treturn;\n\n\trt_mutex_slowunlock(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&syslog_lock"
          ],
          "line": 1554
        },
        "resolved": true,
        "details": {
          "function_name": "mutex_lock_io",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/rtmutex_api.c",
          "lines": "580-586",
          "snippet": "void __sched mutex_lock_io(struct mutex *lock)\n{\n\tint token = io_schedule_prepare();\n\n\t__mutex_lock_common(lock, TASK_UNINTERRUPTIBLE, 0, NULL, _RET_IP_);\n\tio_schedule_finish(token);\n}",
          "includes": [
            "#include \"rtmutex.c\"",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex.c\"\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nvoid __sched mutex_lock_io(struct mutex *lock)\n{\n\tint token = io_schedule_prepare();\n\n\t__mutex_lock_common(lock, TASK_UNINTERRUPTIBLE, 0, NULL, _RET_IP_);\n\tio_schedule_finish(token);\n}"
        }
      },
      {
        "call_info": {
          "callee": "copy_to_user",
          "args": [
            "buf",
            "text + skip",
            "n"
          ],
          "line": 1553
        },
        "resolved": true,
        "details": {
          "function_name": "sched_attr_copy_to_user",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/core.c",
          "lines": "7847-7876",
          "snippet": "static int\nsched_attr_copy_to_user(struct sched_attr __user *uattr,\n\t\t\tstruct sched_attr *kattr,\n\t\t\tunsigned int usize)\n{\n\tunsigned int ksize = sizeof(*kattr);\n\n\tif (!access_ok(uattr, usize))\n\t\treturn -EFAULT;\n\n\t/*\n\t * sched_getattr() ABI forwards and backwards compatibility:\n\t *\n\t * If usize == ksize then we just copy everything to user-space and all is good.\n\t *\n\t * If usize < ksize then we only copy as much as user-space has space for,\n\t * this keeps ABI compatibility as well. We skip the rest.\n\t *\n\t * If usize > ksize then user-space is using a newer version of the ABI,\n\t * which part the kernel doesn't know about. Just ignore it - tooling can\n\t * detect the kernel's knowledge of attributes from the attr->size value\n\t * which is set to ksize in this case.\n\t */\n\tkattr->size = min(usize, ksize);\n\n\tif (copy_to_user(uattr, kattr, kattr->size))\n\t\treturn -EFAULT;\n\n\treturn 0;\n}",
          "includes": [
            "#include <linux/entry-common.h>",
            "#include \"features.h\"",
            "#include \"smp.h\"",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../../fs/io-wq.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/scs.h>",
            "#include <linux/kcov.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\"",
            "#include <trace/events/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/entry-common.h>\n#include \"features.h\"\n#include \"smp.h\"\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../../fs/io-wq.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/scs.h>\n#include <linux/kcov.h>\n#include <linux/blkdev.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n#include <trace/events/sched.h>\n\nstatic __always_inline struct;\n\nstatic int\nsched_attr_copy_to_user(struct sched_attr __user *uattr,\n\t\t\tstruct sched_attr *kattr,\n\t\t\tunsigned int usize)\n{\n\tunsigned int ksize = sizeof(*kattr);\n\n\tif (!access_ok(uattr, usize))\n\t\treturn -EFAULT;\n\n\t/*\n\t * sched_getattr() ABI forwards and backwards compatibility:\n\t *\n\t * If usize == ksize then we just copy everything to user-space and all is good.\n\t *\n\t * If usize < ksize then we only copy as much as user-space has space for,\n\t * this keeps ABI compatibility as well. We skip the rest.\n\t *\n\t * If usize > ksize then user-space is using a newer version of the ABI,\n\t * which part the kernel doesn't know about. Just ignore it - tooling can\n\t * detect the kernel's knowledge of attributes from the attr->size value\n\t * which is set to ksize in this case.\n\t */\n\tkattr->size = min(usize, ksize);\n\n\tif (copy_to_user(uattr, kattr, kattr->size))\n\t\treturn -EFAULT;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "record_print_text",
          "args": [
            "&r",
            "true",
            "syslog_time"
          ],
          "line": 1536
        },
        "resolved": true,
        "details": {
          "function_name": "record_print_text",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2286-2290",
          "snippet": "static size_t record_print_text(const struct printk_record *r,\n\t\t\t\tbool syslog, bool time)\n{\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic size_t record_print_text(const struct printk_record *r,\n\t\t\t\tbool syslog, bool time)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prb_read_valid",
          "args": [
            "prb",
            "syslog_seq",
            "&r"
          ],
          "line": 1519
        },
        "resolved": true,
        "details": {
          "function_name": "prb_read_valid",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk_ringbuffer.c",
          "lines": "1926-1930",
          "snippet": "bool prb_read_valid(struct printk_ringbuffer *rb, u64 seq,\n\t\t    struct printk_record *r)\n{\n\treturn _prb_read_valid(rb, &seq, r, NULL);\n}",
          "includes": [
            "#include \"printk_ringbuffer.h\"",
            "#include <linux/bug.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/irqflags.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"printk_ringbuffer.h\"\n#include <linux/bug.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/irqflags.h>\n#include <linux/kernel.h>\n\nbool prb_read_valid(struct printk_ringbuffer *rb, u64 seq,\n\t\t    struct printk_record *r)\n{\n\treturn _prb_read_valid(rb, &seq, r, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "wait_event_interruptible",
          "args": [
            "log_wait",
            "prb_read_valid(prb, seq, NULL)"
          ],
          "line": 1503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prb_rec_init_rd",
          "args": [
            "&r",
            "&info",
            "text",
            "CONSOLE_LOG_MAX"
          ],
          "line": 1491
        },
        "resolved": true,
        "details": {
          "function_name": "prb_rec_init_rd",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk_ringbuffer.h",
          "lines": "330-337",
          "snippet": "static inline void prb_rec_init_rd(struct printk_record *r,\n\t\t\t\t   struct printk_info *info,\n\t\t\t\t   char *text_buf, unsigned int text_buf_size)\n{\n\tr->info = info;\n\tr->text_buf = text_buf;\n\tr->text_buf_size = text_buf_size;\n}",
          "includes": [
            "#include <linux/dev_printk.h>",
            "#include <linux/atomic.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/dev_printk.h>\n#include <linux/atomic.h>\n\nstatic inline void prb_rec_init_rd(struct printk_record *r,\n\t\t\t\t   struct printk_info *info,\n\t\t\t\t   char *text_buf, unsigned int text_buf_size)\n{\n\tr->info = info;\n\tr->text_buf = text_buf;\n\tr->text_buf_size = text_buf_size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "CONSOLE_LOG_MAX",
            "GFP_KERNEL"
          ],
          "line": 1487
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define printk_time\t\tfalse\n#define CONSOLE_LOG_MAX\t\t0\n#define CONSOLE_LOG_MAX\t\t1024\n\nstatic DEFINE_MUTEX(syslog_lock);\n\nstatic int syslog_print(char __user *buf, int size)\n{\n\tstruct printk_info info;\n\tstruct printk_record r;\n\tchar *text;\n\tint len = 0;\n\tu64 seq;\n\n\ttext = kmalloc(CONSOLE_LOG_MAX, GFP_KERNEL);\n\tif (!text)\n\t\treturn -ENOMEM;\n\n\tprb_rec_init_rd(&r, &info, text, CONSOLE_LOG_MAX);\n\n\tmutex_lock(&syslog_lock);\n\n\t/*\n\t * Wait for the @syslog_seq record to be available. @syslog_seq may\n\t * change while waiting.\n\t */\n\tdo {\n\t\tseq = syslog_seq;\n\n\t\tmutex_unlock(&syslog_lock);\n\t\tlen = wait_event_interruptible(log_wait, prb_read_valid(prb, seq, NULL));\n\t\tmutex_lock(&syslog_lock);\n\n\t\tif (len)\n\t\t\tgoto out;\n\t} while (syslog_seq != seq);\n\n\t/*\n\t * Copy records that fit into the buffer. The above cycle makes sure\n\t * that the first record is always available.\n\t */\n\tdo {\n\t\tsize_t n;\n\t\tsize_t skip;\n\t\tint err;\n\n\t\tif (!prb_read_valid(prb, syslog_seq, &r))\n\t\t\tbreak;\n\n\t\tif (r.info->seq != syslog_seq) {\n\t\t\t/* message is gone, move to next valid one */\n\t\t\tsyslog_seq = r.info->seq;\n\t\t\tsyslog_partial = 0;\n\t\t}\n\n\t\t/*\n\t\t * To keep reading/counting partial line consistent,\n\t\t * use printk_time value as of the beginning of a line.\n\t\t */\n\t\tif (!syslog_partial)\n\t\t\tsyslog_time = printk_time;\n\n\t\tskip = syslog_partial;\n\t\tn = record_print_text(&r, true, syslog_time);\n\t\tif (n - syslog_partial <= size) {\n\t\t\t/* message fits into buffer, move forward */\n\t\t\tsyslog_seq = r.info->seq + 1;\n\t\t\tn -= syslog_partial;\n\t\t\tsyslog_partial = 0;\n\t\t} else if (!len){\n\t\t\t/* partial read(), remember position */\n\t\t\tn = size;\n\t\t\tsyslog_partial += n;\n\t\t} else\n\t\t\tn = 0;\n\n\t\tif (!n)\n\t\t\tbreak;\n\n\t\tmutex_unlock(&syslog_lock);\n\t\terr = copy_to_user(buf, text + skip, n);\n\t\tmutex_lock(&syslog_lock);\n\n\t\tif (err) {\n\t\t\tif (!len)\n\t\t\t\tlen = -EFAULT;\n\t\t\tbreak;\n\t\t}\n\n\t\tlen += n;\n\t\tsize -= n;\n\t\tbuf += n;\n\t} while (size);\nout:\n\tmutex_unlock(&syslog_lock);\n\tkfree(text);\n\treturn len;\n}"
  },
  {
    "function_name": "find_first_fitting_seq",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "1441-1476",
    "snippet": "static u64 find_first_fitting_seq(u64 start_seq, u64 max_seq, size_t size,\n\t\t\t\t  bool syslog, bool time)\n{\n\tstruct printk_info info;\n\tunsigned int line_count;\n\tsize_t len = 0;\n\tu64 seq;\n\n\t/* Determine the size of the records up to @max_seq. */\n\tprb_for_each_info(start_seq, prb, seq, &info, &line_count) {\n\t\tif (info.seq >= max_seq)\n\t\t\tbreak;\n\t\tlen += get_record_print_text_size(&info, line_count, syslog, time);\n\t}\n\n\t/*\n\t * Adjust the upper bound for the next loop to avoid subtracting\n\t * lengths that were never added.\n\t */\n\tif (seq < max_seq)\n\t\tmax_seq = seq;\n\n\t/*\n\t * Move first record forward until length fits into the buffer. Ignore\n\t * newest messages that were not counted in the above cycle. Messages\n\t * might appear and get lost in the meantime. This is a best effort\n\t * that prevents an infinite loop that could occur with a retry.\n\t */\n\tprb_for_each_info(start_seq, prb, seq, &info, &line_count) {\n\t\tif (len <= size || info.seq >= max_seq)\n\t\t\tbreak;\n\t\tlen -= get_record_print_text_size(&info, line_count, syslog, time);\n\t}\n\n\treturn seq;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get_record_print_text_size",
          "args": [
            "&info",
            "line_count",
            "syslog",
            "time"
          ],
          "line": 1472
        },
        "resolved": true,
        "details": {
          "function_name": "get_record_print_text_size",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "1417-1432",
          "snippet": "static size_t get_record_print_text_size(struct printk_info *info,\n\t\t\t\t\t unsigned int line_count,\n\t\t\t\t\t bool syslog, bool time)\n{\n\tchar prefix[PREFIX_MAX];\n\tsize_t prefix_len;\n\n\tprefix_len = info_print_prefix(info, syslog, time, prefix);\n\n\t/*\n\t * Each line will be preceded with a prefix. The intermediate\n\t * newlines are already within the text, but a final trailing\n\t * newline will be added.\n\t */\n\treturn ((prefix_len * line_count) + info->text_len + 1);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define PREFIX_MAX\t\t32",
            "#define PREFIX_MAX\t\t48"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define PREFIX_MAX\t\t32\n#define PREFIX_MAX\t\t48\n\nstatic size_t get_record_print_text_size(struct printk_info *info,\n\t\t\t\t\t unsigned int line_count,\n\t\t\t\t\t bool syslog, bool time)\n{\n\tchar prefix[PREFIX_MAX];\n\tsize_t prefix_len;\n\n\tprefix_len = info_print_prefix(info, syslog, time, prefix);\n\n\t/*\n\t * Each line will be preceded with a prefix. The intermediate\n\t * newlines are already within the text, but a final trailing\n\t * newline will be added.\n\t */\n\treturn ((prefix_len * line_count) + info->text_len + 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prb_for_each_info",
          "args": [
            "start_seq",
            "prb",
            "seq",
            "&info",
            "&line_count"
          ],
          "line": 1469
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prb_for_each_info",
          "args": [
            "start_seq",
            "prb",
            "seq",
            "&info",
            "&line_count"
          ],
          "line": 1450
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic u64 find_first_fitting_seq(u64 start_seq, u64 max_seq, size_t size,\n\t\t\t\t  bool syslog, bool time)\n{\n\tstruct printk_info info;\n\tunsigned int line_count;\n\tsize_t len = 0;\n\tu64 seq;\n\n\t/* Determine the size of the records up to @max_seq. */\n\tprb_for_each_info(start_seq, prb, seq, &info, &line_count) {\n\t\tif (info.seq >= max_seq)\n\t\t\tbreak;\n\t\tlen += get_record_print_text_size(&info, line_count, syslog, time);\n\t}\n\n\t/*\n\t * Adjust the upper bound for the next loop to avoid subtracting\n\t * lengths that were never added.\n\t */\n\tif (seq < max_seq)\n\t\tmax_seq = seq;\n\n\t/*\n\t * Move first record forward until length fits into the buffer. Ignore\n\t * newest messages that were not counted in the above cycle. Messages\n\t * might appear and get lost in the meantime. This is a best effort\n\t * that prevents an infinite loop that could occur with a retry.\n\t */\n\tprb_for_each_info(start_seq, prb, seq, &info, &line_count) {\n\t\tif (len <= size || info.seq >= max_seq)\n\t\t\tbreak;\n\t\tlen -= get_record_print_text_size(&info, line_count, syslog, time);\n\t}\n\n\treturn seq;\n}"
  },
  {
    "function_name": "get_record_print_text_size",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "1417-1432",
    "snippet": "static size_t get_record_print_text_size(struct printk_info *info,\n\t\t\t\t\t unsigned int line_count,\n\t\t\t\t\t bool syslog, bool time)\n{\n\tchar prefix[PREFIX_MAX];\n\tsize_t prefix_len;\n\n\tprefix_len = info_print_prefix(info, syslog, time, prefix);\n\n\t/*\n\t * Each line will be preceded with a prefix. The intermediate\n\t * newlines are already within the text, but a final trailing\n\t * newline will be added.\n\t */\n\treturn ((prefix_len * line_count) + info->text_len + 1);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define PREFIX_MAX\t\t32",
      "#define PREFIX_MAX\t\t48"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "info_print_prefix",
          "args": [
            "info",
            "syslog",
            "time",
            "prefix"
          ],
          "line": 1424
        },
        "resolved": true,
        "details": {
          "function_name": "info_print_prefix",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "1278-1297",
          "snippet": "static size_t info_print_prefix(const struct printk_info  *info, bool syslog,\n\t\t\t\tbool time, char *buf)\n{\n\tsize_t len = 0;\n\n\tif (syslog)\n\t\tlen = print_syslog((info->facility << 3) | info->level, buf);\n\n\tif (time)\n\t\tlen += print_time(info->ts_nsec, buf + len);\n\n\tlen += print_caller(info->caller_id, buf + len);\n\n\tif (IS_ENABLED(CONFIG_PRINTK_CALLER) || time) {\n\t\tbuf[len++] = ' ';\n\t\tbuf[len] = '\\0';\n\t}\n\n\treturn len;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic size_t info_print_prefix(const struct printk_info  *info, bool syslog,\n\t\t\t\tbool time, char *buf)\n{\n\tsize_t len = 0;\n\n\tif (syslog)\n\t\tlen = print_syslog((info->facility << 3) | info->level, buf);\n\n\tif (time)\n\t\tlen += print_time(info->ts_nsec, buf + len);\n\n\tlen += print_caller(info->caller_id, buf + len);\n\n\tif (IS_ENABLED(CONFIG_PRINTK_CALLER) || time) {\n\t\tbuf[len++] = ' ';\n\t\tbuf[len] = '\\0';\n\t}\n\n\treturn len;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define PREFIX_MAX\t\t32\n#define PREFIX_MAX\t\t48\n\nstatic size_t get_record_print_text_size(struct printk_info *info,\n\t\t\t\t\t unsigned int line_count,\n\t\t\t\t\t bool syslog, bool time)\n{\n\tchar prefix[PREFIX_MAX];\n\tsize_t prefix_len;\n\n\tprefix_len = info_print_prefix(info, syslog, time, prefix);\n\n\t/*\n\t * Each line will be preceded with a prefix. The intermediate\n\t * newlines are already within the text, but a final trailing\n\t * newline will be added.\n\t */\n\treturn ((prefix_len * line_count) + info->text_len + 1);\n}"
  },
  {
    "function_name": "record_print_text",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "1316-1415",
    "snippet": "static size_t record_print_text(struct printk_record *r, bool syslog,\n\t\t\t\tbool time)\n{\n\tsize_t text_len = r->info->text_len;\n\tsize_t buf_size = r->text_buf_size;\n\tchar *text = r->text_buf;\n\tchar prefix[PREFIX_MAX];\n\tbool truncated = false;\n\tsize_t prefix_len;\n\tsize_t line_len;\n\tsize_t len = 0;\n\tchar *next;\n\n\t/*\n\t * If the message was truncated because the buffer was not large\n\t * enough, treat the available text as if it were the full text.\n\t */\n\tif (text_len > buf_size)\n\t\ttext_len = buf_size;\n\n\tprefix_len = info_print_prefix(r->info, syslog, time, prefix);\n\n\t/*\n\t * @text_len: bytes of unprocessed text\n\t * @line_len: bytes of current line _without_ newline\n\t * @text:     pointer to beginning of current line\n\t * @len:      number of bytes prepared in r->text_buf\n\t */\n\tfor (;;) {\n\t\tnext = memchr(text, '\\n', text_len);\n\t\tif (next) {\n\t\t\tline_len = next - text;\n\t\t} else {\n\t\t\t/* Drop truncated line(s). */\n\t\t\tif (truncated)\n\t\t\t\tbreak;\n\t\t\tline_len = text_len;\n\t\t}\n\n\t\t/*\n\t\t * Truncate the text if there is not enough space to add the\n\t\t * prefix and a trailing newline and a terminator.\n\t\t */\n\t\tif (len + prefix_len + text_len + 1 + 1 > buf_size) {\n\t\t\t/* Drop even the current line if no space. */\n\t\t\tif (len + prefix_len + line_len + 1 + 1 > buf_size)\n\t\t\t\tbreak;\n\n\t\t\ttext_len = buf_size - len - prefix_len - 1 - 1;\n\t\t\ttruncated = true;\n\t\t}\n\n\t\tmemmove(text + prefix_len, text, text_len);\n\t\tmemcpy(text, prefix, prefix_len);\n\n\t\t/*\n\t\t * Increment the prepared length to include the text and\n\t\t * prefix that were just moved+copied. Also increment for the\n\t\t * newline at the end of this line. If this is the last line,\n\t\t * there is no newline, but it will be added immediately below.\n\t\t */\n\t\tlen += prefix_len + line_len + 1;\n\t\tif (text_len == line_len) {\n\t\t\t/*\n\t\t\t * This is the last line. Add the trailing newline\n\t\t\t * removed in vprintk_store().\n\t\t\t */\n\t\t\ttext[prefix_len + line_len] = '\\n';\n\t\t\tbreak;\n\t\t}\n\n\t\t/*\n\t\t * Advance beyond the added prefix and the related line with\n\t\t * its newline.\n\t\t */\n\t\ttext += prefix_len + line_len + 1;\n\n\t\t/*\n\t\t * The remaining text has only decreased by the line with its\n\t\t * newline.\n\t\t *\n\t\t * Note that @text_len can become zero. It happens when @text\n\t\t * ended with a newline (either due to truncation or the\n\t\t * original string ending with \"\\n\\n\"). The loop is correctly\n\t\t * repeated and (if not truncated) an empty line with a prefix\n\t\t * will be prepared.\n\t\t */\n\t\ttext_len -= line_len + 1;\n\t}\n\n\t/*\n\t * If a buffer was provided, it will be terminated. Space for the\n\t * string terminator is guaranteed to be available. The terminator is\n\t * not counted in the return value.\n\t */\n\tif (buf_size > 0)\n\t\tr->text_buf[len] = 0;\n\n\treturn len;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define PREFIX_MAX\t\t32",
      "#define PREFIX_MAX\t\t48"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "text",
            "prefix",
            "prefix_len"
          ],
          "line": 1369
        },
        "resolved": true,
        "details": {
          "function_name": "memcpy_skip",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/events/internal.h",
          "lines": "180-184",
          "snippet": "static inline unsigned long\nmemcpy_skip(void *dst, const void *src, unsigned long n)\n{\n\treturn 0;\n}",
          "includes": [
            "#include <linux/refcount.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hardirq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/refcount.h>\n#include <linux/uaccess.h>\n#include <linux/hardirq.h>\n\nstatic inline unsigned long\nmemcpy_skip(void *dst, const void *src, unsigned long n)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memmove",
          "args": [
            "text + prefix_len",
            "text",
            "text_len"
          ],
          "line": 1368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memchr",
          "args": [
            "text",
            "'\\n'",
            "text_len"
          ],
          "line": 1345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "info_print_prefix",
          "args": [
            "r->info",
            "syslog",
            "time",
            "prefix"
          ],
          "line": 1336
        },
        "resolved": true,
        "details": {
          "function_name": "info_print_prefix",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "1278-1297",
          "snippet": "static size_t info_print_prefix(const struct printk_info  *info, bool syslog,\n\t\t\t\tbool time, char *buf)\n{\n\tsize_t len = 0;\n\n\tif (syslog)\n\t\tlen = print_syslog((info->facility << 3) | info->level, buf);\n\n\tif (time)\n\t\tlen += print_time(info->ts_nsec, buf + len);\n\n\tlen += print_caller(info->caller_id, buf + len);\n\n\tif (IS_ENABLED(CONFIG_PRINTK_CALLER) || time) {\n\t\tbuf[len++] = ' ';\n\t\tbuf[len] = '\\0';\n\t}\n\n\treturn len;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic size_t info_print_prefix(const struct printk_info  *info, bool syslog,\n\t\t\t\tbool time, char *buf)\n{\n\tsize_t len = 0;\n\n\tif (syslog)\n\t\tlen = print_syslog((info->facility << 3) | info->level, buf);\n\n\tif (time)\n\t\tlen += print_time(info->ts_nsec, buf + len);\n\n\tlen += print_caller(info->caller_id, buf + len);\n\n\tif (IS_ENABLED(CONFIG_PRINTK_CALLER) || time) {\n\t\tbuf[len++] = ' ';\n\t\tbuf[len] = '\\0';\n\t}\n\n\treturn len;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define PREFIX_MAX\t\t32\n#define PREFIX_MAX\t\t48\n\nstatic size_t record_print_text(struct printk_record *r, bool syslog,\n\t\t\t\tbool time)\n{\n\tsize_t text_len = r->info->text_len;\n\tsize_t buf_size = r->text_buf_size;\n\tchar *text = r->text_buf;\n\tchar prefix[PREFIX_MAX];\n\tbool truncated = false;\n\tsize_t prefix_len;\n\tsize_t line_len;\n\tsize_t len = 0;\n\tchar *next;\n\n\t/*\n\t * If the message was truncated because the buffer was not large\n\t * enough, treat the available text as if it were the full text.\n\t */\n\tif (text_len > buf_size)\n\t\ttext_len = buf_size;\n\n\tprefix_len = info_print_prefix(r->info, syslog, time, prefix);\n\n\t/*\n\t * @text_len: bytes of unprocessed text\n\t * @line_len: bytes of current line _without_ newline\n\t * @text:     pointer to beginning of current line\n\t * @len:      number of bytes prepared in r->text_buf\n\t */\n\tfor (;;) {\n\t\tnext = memchr(text, '\\n', text_len);\n\t\tif (next) {\n\t\t\tline_len = next - text;\n\t\t} else {\n\t\t\t/* Drop truncated line(s). */\n\t\t\tif (truncated)\n\t\t\t\tbreak;\n\t\t\tline_len = text_len;\n\t\t}\n\n\t\t/*\n\t\t * Truncate the text if there is not enough space to add the\n\t\t * prefix and a trailing newline and a terminator.\n\t\t */\n\t\tif (len + prefix_len + text_len + 1 + 1 > buf_size) {\n\t\t\t/* Drop even the current line if no space. */\n\t\t\tif (len + prefix_len + line_len + 1 + 1 > buf_size)\n\t\t\t\tbreak;\n\n\t\t\ttext_len = buf_size - len - prefix_len - 1 - 1;\n\t\t\ttruncated = true;\n\t\t}\n\n\t\tmemmove(text + prefix_len, text, text_len);\n\t\tmemcpy(text, prefix, prefix_len);\n\n\t\t/*\n\t\t * Increment the prepared length to include the text and\n\t\t * prefix that were just moved+copied. Also increment for the\n\t\t * newline at the end of this line. If this is the last line,\n\t\t * there is no newline, but it will be added immediately below.\n\t\t */\n\t\tlen += prefix_len + line_len + 1;\n\t\tif (text_len == line_len) {\n\t\t\t/*\n\t\t\t * This is the last line. Add the trailing newline\n\t\t\t * removed in vprintk_store().\n\t\t\t */\n\t\t\ttext[prefix_len + line_len] = '\\n';\n\t\t\tbreak;\n\t\t}\n\n\t\t/*\n\t\t * Advance beyond the added prefix and the related line with\n\t\t * its newline.\n\t\t */\n\t\ttext += prefix_len + line_len + 1;\n\n\t\t/*\n\t\t * The remaining text has only decreased by the line with its\n\t\t * newline.\n\t\t *\n\t\t * Note that @text_len can become zero. It happens when @text\n\t\t * ended with a newline (either due to truncation or the\n\t\t * original string ending with \"\\n\\n\"). The loop is correctly\n\t\t * repeated and (if not truncated) an empty line with a prefix\n\t\t * will be prepared.\n\t\t */\n\t\ttext_len -= line_len + 1;\n\t}\n\n\t/*\n\t * If a buffer was provided, it will be terminated. Space for the\n\t * string terminator is guaranteed to be available. The terminator is\n\t * not counted in the return value.\n\t */\n\tif (buf_size > 0)\n\t\tr->text_buf[len] = 0;\n\n\treturn len;\n}"
  },
  {
    "function_name": "info_print_prefix",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "1278-1297",
    "snippet": "static size_t info_print_prefix(const struct printk_info  *info, bool syslog,\n\t\t\t\tbool time, char *buf)\n{\n\tsize_t len = 0;\n\n\tif (syslog)\n\t\tlen = print_syslog((info->facility << 3) | info->level, buf);\n\n\tif (time)\n\t\tlen += print_time(info->ts_nsec, buf + len);\n\n\tlen += print_caller(info->caller_id, buf + len);\n\n\tif (IS_ENABLED(CONFIG_PRINTK_CALLER) || time) {\n\t\tbuf[len++] = ' ';\n\t\tbuf[len] = '\\0';\n\t}\n\n\treturn len;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IS_ENABLED",
          "args": [
            "CONFIG_PRINTK_CALLER"
          ],
          "line": 1291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "print_caller",
          "args": [
            "info->caller_id",
            "buf + len"
          ],
          "line": 1289
        },
        "resolved": true,
        "details": {
          "function_name": "print_caller",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "1266-1273",
          "snippet": "static size_t print_caller(u32 id, char *buf)\n{\n\tchar caller[12];\n\n\tsnprintf(caller, sizeof(caller), \"%c%u\",\n\t\t id & 0x80000000 ? 'C' : 'T', id & ~0x80000000);\n\treturn sprintf(buf, \"[%6s]\", caller);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic size_t print_caller(u32 id, char *buf)\n{\n\tchar caller[12];\n\n\tsnprintf(caller, sizeof(caller), \"%c%u\",\n\t\t id & 0x80000000 ? 'C' : 'T', id & ~0x80000000);\n\treturn sprintf(buf, \"[%6s]\", caller);\n}"
        }
      },
      {
        "call_info": {
          "callee": "print_time",
          "args": [
            "info->ts_nsec",
            "buf + len"
          ],
          "line": 1287
        },
        "resolved": true,
        "details": {
          "function_name": "print_time",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "1257-1263",
          "snippet": "static size_t print_time(u64 ts, char *buf)\n{\n\tunsigned long rem_nsec = do_div(ts, 1000000000);\n\n\treturn sprintf(buf, \"[%5lu.%06lu]\",\n\t\t       (unsigned long)ts, rem_nsec / 1000);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic size_t print_time(u64 ts, char *buf)\n{\n\tunsigned long rem_nsec = do_div(ts, 1000000000);\n\n\treturn sprintf(buf, \"[%5lu.%06lu]\",\n\t\t       (unsigned long)ts, rem_nsec / 1000);\n}"
        }
      },
      {
        "call_info": {
          "callee": "print_syslog",
          "args": [
            "(info->facility << 3) | info->level",
            "buf"
          ],
          "line": 1284
        },
        "resolved": true,
        "details": {
          "function_name": "print_syslog",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "1252-1255",
          "snippet": "static size_t print_syslog(unsigned int level, char *buf)\n{\n\treturn sprintf(buf, \"<%u>\", level);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic size_t print_syslog(unsigned int level, char *buf)\n{\n\treturn sprintf(buf, \"<%u>\", level);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic size_t info_print_prefix(const struct printk_info  *info, bool syslog,\n\t\t\t\tbool time, char *buf)\n{\n\tsize_t len = 0;\n\n\tif (syslog)\n\t\tlen = print_syslog((info->facility << 3) | info->level, buf);\n\n\tif (time)\n\t\tlen += print_time(info->ts_nsec, buf + len);\n\n\tlen += print_caller(info->caller_id, buf + len);\n\n\tif (IS_ENABLED(CONFIG_PRINTK_CALLER) || time) {\n\t\tbuf[len++] = ' ';\n\t\tbuf[len] = '\\0';\n\t}\n\n\treturn len;\n}"
  },
  {
    "function_name": "print_caller",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "1266-1273",
    "snippet": "static size_t print_caller(u32 id, char *buf)\n{\n\tchar caller[12];\n\n\tsnprintf(caller, sizeof(caller), \"%c%u\",\n\t\t id & 0x80000000 ? 'C' : 'T', id & ~0x80000000);\n\treturn sprintf(buf, \"[%6s]\", caller);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"[%6s]\"",
            "caller"
          ],
          "line": 1272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "caller",
            "sizeof(caller)",
            "\"%c%u\"",
            "id & 0x80000000 ? 'C' : 'T'",
            "id & ~0x80000000"
          ],
          "line": 1270
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic size_t print_caller(u32 id, char *buf)\n{\n\tchar caller[12];\n\n\tsnprintf(caller, sizeof(caller), \"%c%u\",\n\t\t id & 0x80000000 ? 'C' : 'T', id & ~0x80000000);\n\treturn sprintf(buf, \"[%6s]\", caller);\n}"
  },
  {
    "function_name": "print_time",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "1257-1263",
    "snippet": "static size_t print_time(u64 ts, char *buf)\n{\n\tunsigned long rem_nsec = do_div(ts, 1000000000);\n\n\treturn sprintf(buf, \"[%5lu.%06lu]\",\n\t\t       (unsigned long)ts, rem_nsec / 1000);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"[%5lu.%06lu]\"",
            "(unsigned long)ts",
            "rem_nsec / 1000"
          ],
          "line": 1261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_div",
          "args": [
            "ts",
            "1000000000"
          ],
          "line": 1259
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic size_t print_time(u64 ts, char *buf)\n{\n\tunsigned long rem_nsec = do_div(ts, 1000000000);\n\n\treturn sprintf(buf, \"[%5lu.%06lu]\",\n\t\t       (unsigned long)ts, rem_nsec / 1000);\n}"
  },
  {
    "function_name": "print_syslog",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "1252-1255",
    "snippet": "static size_t print_syslog(unsigned int level, char *buf)\n{\n\treturn sprintf(buf, \"<%u>\", level);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buf",
            "\"<%u>\"",
            "level"
          ],
          "line": 1254
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic size_t print_syslog(unsigned int level, char *buf)\n{\n\treturn sprintf(buf, \"<%u>\", level);\n}"
  },
  {
    "function_name": "boot_delay_msec",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "1244-1246",
    "snippet": "static inline void boot_delay_msec(int level)\n{\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic inline void boot_delay_msec(int level)\n{\n}"
  },
  {
    "function_name": "boot_delay_msec",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "1217-1242",
    "snippet": "static void boot_delay_msec(int level)\n{\n\tunsigned long long k;\n\tunsigned long timeout;\n\n\tif ((boot_delay == 0 || system_state >= SYSTEM_RUNNING)\n\t\t|| suppress_message_printing(level)) {\n\t\treturn;\n\t}\n\n\tk = (unsigned long long)loops_per_msec * boot_delay;\n\n\ttimeout = jiffies + msecs_to_jiffies(boot_delay);\n\twhile (k) {\n\t\tk--;\n\t\tcpu_relax();\n\t\t/*\n\t\t * use (volatile) jiffies to prevent\n\t\t * compiler reduction; loop termination via jiffies\n\t\t * is secondary and may or may not happen.\n\t\t */\n\t\tif (time_after(jiffies, timeout))\n\t\t\tbreak;\n\t\ttouch_nmi_watchdog();\n\t}\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "touch_nmi_watchdog",
          "args": [],
          "line": 1240
        },
        "resolved": true,
        "details": {
          "function_name": "arch_touch_nmi_watchdog",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/watchdog_hld.c",
          "lines": "32-42",
          "snippet": "notrace void arch_touch_nmi_watchdog(void)\n{\n\t/*\n\t * Using __raw here because some code paths have\n\t * preemption enabled.  If preemption is enabled\n\t * then interrupts should be enabled too, in which\n\t * case we shouldn't have to worry about the watchdog\n\t * going off.\n\t */\n\traw_cpu_write(watchdog_nmi_touch, true);\n}",
          "includes": [
            "#include <linux/perf_event.h>",
            "#include <asm/irq_regs.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/module.h>",
            "#include <linux/atomic.h>",
            "#include <linux/nmi.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_PER_CPU(bool, watchdog_nmi_touch);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/perf_event.h>\n#include <asm/irq_regs.h>\n#include <linux/sched/debug.h>\n#include <linux/module.h>\n#include <linux/atomic.h>\n#include <linux/nmi.h>\n\nstatic DEFINE_PER_CPU(bool, watchdog_nmi_touch);\n\nnotrace void arch_touch_nmi_watchdog(void)\n{\n\t/*\n\t * Using __raw here because some code paths have\n\t * preemption enabled.  If preemption is enabled\n\t * then interrupts should be enabled too, in which\n\t * case we shouldn't have to worry about the watchdog\n\t * going off.\n\t */\n\traw_cpu_write(watchdog_nmi_touch, true);\n}"
        }
      },
      {
        "call_info": {
          "callee": "time_after",
          "args": [
            "jiffies",
            "timeout"
          ],
          "line": 1238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cpu_relax",
          "args": [],
          "line": 1232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "msecs_to_jiffies",
          "args": [
            "boot_delay"
          ],
          "line": 1229
        },
        "resolved": true,
        "details": {
          "function_name": "__msecs_to_jiffies",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/time/time.c",
          "lines": "552-560",
          "snippet": "unsigned long __msecs_to_jiffies(const unsigned int m)\n{\n\t/*\n\t * Negative value, means infinite timeout:\n\t */\n\tif ((int)m < 0)\n\t\treturn MAX_JIFFY_OFFSET;\n\treturn _msecs_to_jiffies(m);\n}",
          "includes": [
            "#include \"timekeeping.h\"",
            "#include <generated/timeconst.h>",
            "#include <asm/unistd.h>",
            "#include <linux/compat.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/math64.h>",
            "#include <linux/fs.h>",
            "#include <linux/security.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/errno.h>",
            "#include <linux/timekeeper_internal.h>",
            "#include <linux/capability.h>",
            "#include <linux/timex.h>",
            "#include <linux/kernel.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"timekeeping.h\"\n#include <generated/timeconst.h>\n#include <asm/unistd.h>\n#include <linux/compat.h>\n#include <linux/uaccess.h>\n#include <linux/ptrace.h>\n#include <linux/math64.h>\n#include <linux/fs.h>\n#include <linux/security.h>\n#include <linux/syscalls.h>\n#include <linux/errno.h>\n#include <linux/timekeeper_internal.h>\n#include <linux/capability.h>\n#include <linux/timex.h>\n#include <linux/kernel.h>\n#include <linux/export.h>\n\nunsigned long __msecs_to_jiffies(const unsigned int m)\n{\n\t/*\n\t * Negative value, means infinite timeout:\n\t */\n\tif ((int)m < 0)\n\t\treturn MAX_JIFFY_OFFSET;\n\treturn _msecs_to_jiffies(m);\n}"
        }
      },
      {
        "call_info": {
          "callee": "suppress_message_printing",
          "args": [
            "level"
          ],
          "line": 1223
        },
        "resolved": true,
        "details": {
          "function_name": "suppress_message_printing",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2303-2303",
          "snippet": "static bool suppress_message_printing(int level) { return false; }",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic bool suppress_message_printing(int level) { return false; }"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic void boot_delay_msec(int level)\n{\n\tunsigned long long k;\n\tunsigned long timeout;\n\n\tif ((boot_delay == 0 || system_state >= SYSTEM_RUNNING)\n\t\t|| suppress_message_printing(level)) {\n\t\treturn;\n\t}\n\n\tk = (unsigned long long)loops_per_msec * boot_delay;\n\n\ttimeout = jiffies + msecs_to_jiffies(boot_delay);\n\twhile (k) {\n\t\tk--;\n\t\tcpu_relax();\n\t\t/*\n\t\t * use (volatile) jiffies to prevent\n\t\t * compiler reduction; loop termination via jiffies\n\t\t * is secondary and may or may not happen.\n\t\t */\n\t\tif (time_after(jiffies, timeout))\n\t\t\tbreak;\n\t\ttouch_nmi_watchdog();\n\t}\n}"
  },
  {
    "function_name": "boot_delay_setup",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "1199-1214",
    "snippet": "static int __init boot_delay_setup(char *str)\n{\n\tunsigned long lpj;\n\n\tlpj = preset_lpj ? preset_lpj : 1000000;\t/* some guess */\n\tloops_per_msec = (unsigned long long)lpj / 1000 * HZ;\n\n\tget_option(&str, &boot_delay);\n\tif (boot_delay > 10 * 1000)\n\t\tboot_delay = 0;\n\n\tpr_debug(\"boot_delay: %u, preset_lpj: %ld, lpj: %lu, \"\n\t\t\"HZ: %d, loops_per_msec: %llu\\n\",\n\t\tboot_delay, preset_lpj, lpj, HZ, loops_per_msec);\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_debug",
          "args": [
            "\"boot_delay: %u, preset_lpj: %ld, lpj: %lu, \"\n\t\t\"HZ: %d, loops_per_msec: %llu\\n\"",
            "boot_delay",
            "preset_lpj",
            "lpj",
            "HZ",
            "loops_per_msec"
          ],
          "line": 1210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_option",
          "args": [
            "&str",
            "&boot_delay"
          ],
          "line": 1206
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic int __init boot_delay_setup(char *str)\n{\n\tunsigned long lpj;\n\n\tlpj = preset_lpj ? preset_lpj : 1000000;\t/* some guess */\n\tloops_per_msec = (unsigned long long)lpj / 1000 * HZ;\n\n\tget_option(&str, &boot_delay);\n\tif (boot_delay > 10 * 1000)\n\t\tboot_delay = 0;\n\n\tpr_debug(\"boot_delay: %u, preset_lpj: %ld, lpj: %lu, \"\n\t\t\"HZ: %d, loops_per_msec: %llu\\n\",\n\t\tboot_delay, preset_lpj, lpj, HZ, loops_per_msec);\n\treturn 0;\n}"
  },
  {
    "function_name": "suppress_message_printing",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "1189-1192",
    "snippet": "static bool suppress_message_printing(int level)\n{\n\treturn (level >= console_loglevel && !ignore_loglevel);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic bool suppress_message_printing(int level)\n{\n\treturn (level >= console_loglevel && !ignore_loglevel);\n}"
  },
  {
    "function_name": "ignore_loglevel_setup",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "1176-1182",
    "snippet": "static int __init ignore_loglevel_setup(char *str)\n{\n\tignore_loglevel = true;\n\tpr_info(\"debug: ignoring loglevel setting.\\n\");\n\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"debug: ignoring loglevel setting.\\n\""
          ],
          "line": 1179
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic int __init ignore_loglevel_setup(char *str)\n{\n\tignore_loglevel = true;\n\tpr_info(\"debug: ignoring loglevel setting.\\n\");\n\n\treturn 0;\n}"
  },
  {
    "function_name": "setup_log_buf",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "1058-1172",
    "snippet": "void __init setup_log_buf(int early)\n{\n\tstruct printk_info *new_infos;\n\tunsigned int new_descs_count;\n\tstruct prb_desc *new_descs;\n\tstruct printk_info info;\n\tstruct printk_record r;\n\tunsigned int text_size;\n\tsize_t new_descs_size;\n\tsize_t new_infos_size;\n\tunsigned long flags;\n\tchar *new_log_buf;\n\tunsigned int free;\n\tu64 seq;\n\n\t/*\n\t * Some archs call setup_log_buf() multiple times - first is very\n\t * early, e.g. from setup_arch(), and second - when percpu_areas\n\t * are initialised.\n\t */\n\tif (!early)\n\t\tset_percpu_data_ready();\n\n\tif (log_buf != __log_buf)\n\t\treturn;\n\n\tif (!early && !new_log_buf_len)\n\t\tlog_buf_add_cpu();\n\n\tif (!new_log_buf_len)\n\t\treturn;\n\n\tnew_descs_count = new_log_buf_len >> PRB_AVGBITS;\n\tif (new_descs_count == 0) {\n\t\tpr_err(\"new_log_buf_len: %lu too small\\n\", new_log_buf_len);\n\t\treturn;\n\t}\n\n\tnew_log_buf = memblock_alloc(new_log_buf_len, LOG_ALIGN);\n\tif (unlikely(!new_log_buf)) {\n\t\tpr_err(\"log_buf_len: %lu text bytes not available\\n\",\n\t\t       new_log_buf_len);\n\t\treturn;\n\t}\n\n\tnew_descs_size = new_descs_count * sizeof(struct prb_desc);\n\tnew_descs = memblock_alloc(new_descs_size, LOG_ALIGN);\n\tif (unlikely(!new_descs)) {\n\t\tpr_err(\"log_buf_len: %zu desc bytes not available\\n\",\n\t\t       new_descs_size);\n\t\tgoto err_free_log_buf;\n\t}\n\n\tnew_infos_size = new_descs_count * sizeof(struct printk_info);\n\tnew_infos = memblock_alloc(new_infos_size, LOG_ALIGN);\n\tif (unlikely(!new_infos)) {\n\t\tpr_err(\"log_buf_len: %zu info bytes not available\\n\",\n\t\t       new_infos_size);\n\t\tgoto err_free_descs;\n\t}\n\n\tprb_rec_init_rd(&r, &info, &setup_text_buf[0], sizeof(setup_text_buf));\n\n\tprb_init(&printk_rb_dynamic,\n\t\t new_log_buf, ilog2(new_log_buf_len),\n\t\t new_descs, ilog2(new_descs_count),\n\t\t new_infos);\n\n\tlocal_irq_save(flags);\n\n\tlog_buf_len = new_log_buf_len;\n\tlog_buf = new_log_buf;\n\tnew_log_buf_len = 0;\n\n\tfree = __LOG_BUF_LEN;\n\tprb_for_each_record(0, &printk_rb_static, seq, &r) {\n\t\ttext_size = add_to_rb(&printk_rb_dynamic, &r);\n\t\tif (text_size > free)\n\t\t\tfree = 0;\n\t\telse\n\t\t\tfree -= text_size;\n\t}\n\n\tprb = &printk_rb_dynamic;\n\n\tlocal_irq_restore(flags);\n\n\t/*\n\t * Copy any remaining messages that might have appeared from\n\t * NMI context after copying but before switching to the\n\t * dynamic buffer.\n\t */\n\tprb_for_each_record(seq, &printk_rb_static, seq, &r) {\n\t\ttext_size = add_to_rb(&printk_rb_dynamic, &r);\n\t\tif (text_size > free)\n\t\t\tfree = 0;\n\t\telse\n\t\t\tfree -= text_size;\n\t}\n\n\tif (seq != prb_next_seq(&printk_rb_static)) {\n\t\tpr_err(\"dropped %llu messages\\n\",\n\t\t       prb_next_seq(&printk_rb_static) - seq);\n\t}\n\n\tpr_info(\"log_buf_len: %u bytes\\n\", log_buf_len);\n\tpr_info(\"early log buf free: %u(%u%%)\\n\",\n\t\tfree, (free * 100) / __LOG_BUF_LEN);\n\treturn;\n\nerr_free_descs:\n\tmemblock_free(new_descs, new_descs_size);\nerr_free_log_buf:\n\tmemblock_free(new_log_buf, new_log_buf_len);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define PRB_AVGBITS 5\t/* 32 character average length */",
      "#define __LOG_BUF_LEN (1 << CONFIG_LOG_BUF_SHIFT)",
      "#define LOG_ALIGN __alignof__(unsigned long)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memblock_free",
          "args": [
            "new_log_buf",
            "new_log_buf_len"
          ],
          "line": 1171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memblock_free",
          "args": [
            "new_descs",
            "new_descs_size"
          ],
          "line": 1169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"early log buf free: %u(%u%%)\\n\"",
            "free",
            "(free * 100) / __LOG_BUF_LEN"
          ],
          "line": 1164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"log_buf_len: %u bytes\\n\"",
            "log_buf_len"
          ],
          "line": 1163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"dropped %llu messages\\n\"",
            "prb_next_seq(&printk_rb_static) - seq"
          ],
          "line": 1159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prb_next_seq",
          "args": [
            "&printk_rb_static"
          ],
          "line": 1160
        },
        "resolved": true,
        "details": {
          "function_name": "prb_next_seq",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk_ringbuffer.c",
          "lines": "2006-2015",
          "snippet": "u64 prb_next_seq(struct printk_ringbuffer *rb)\n{\n\tu64 seq = 0;\n\n\t/* Search forward from the oldest descriptor. */\n\twhile (_prb_read_valid(rb, &seq, NULL, NULL))\n\t\tseq++;\n\n\treturn seq;\n}",
          "includes": [
            "#include \"printk_ringbuffer.h\"",
            "#include <linux/bug.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/irqflags.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"printk_ringbuffer.h\"\n#include <linux/bug.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/irqflags.h>\n#include <linux/kernel.h>\n\nu64 prb_next_seq(struct printk_ringbuffer *rb)\n{\n\tu64 seq = 0;\n\n\t/* Search forward from the oldest descriptor. */\n\twhile (_prb_read_valid(rb, &seq, NULL, NULL))\n\t\tseq++;\n\n\treturn seq;\n}"
        }
      },
      {
        "call_info": {
          "callee": "add_to_rb",
          "args": [
            "&printk_rb_dynamic",
            "&r"
          ],
          "line": 1151
        },
        "resolved": true,
        "details": {
          "function_name": "add_to_rb",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "1031-1054",
          "snippet": "static unsigned int __init add_to_rb(struct printk_ringbuffer *rb,\n\t\t\t\t     struct printk_record *r)\n{\n\tstruct prb_reserved_entry e;\n\tstruct printk_record dest_r;\n\n\tprb_rec_init_wr(&dest_r, r->info->text_len);\n\n\tif (!prb_reserve(&e, rb, &dest_r))\n\t\treturn 0;\n\n\tmemcpy(&dest_r.text_buf[0], &r->text_buf[0], r->info->text_len);\n\tdest_r.info->text_len = r->info->text_len;\n\tdest_r.info->facility = r->info->facility;\n\tdest_r.info->level = r->info->level;\n\tdest_r.info->flags = r->info->flags;\n\tdest_r.info->ts_nsec = r->info->ts_nsec;\n\tdest_r.info->caller_id = r->info->caller_id;\n\tmemcpy(&dest_r.info->dev_info, &r->info->dev_info, sizeof(dest_r.info->dev_info));\n\n\tprb_final_commit(&e);\n\n\treturn prb_record_text_space(&e);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic unsigned int __init add_to_rb(struct printk_ringbuffer *rb,\n\t\t\t\t     struct printk_record *r)\n{\n\tstruct prb_reserved_entry e;\n\tstruct printk_record dest_r;\n\n\tprb_rec_init_wr(&dest_r, r->info->text_len);\n\n\tif (!prb_reserve(&e, rb, &dest_r))\n\t\treturn 0;\n\n\tmemcpy(&dest_r.text_buf[0], &r->text_buf[0], r->info->text_len);\n\tdest_r.info->text_len = r->info->text_len;\n\tdest_r.info->facility = r->info->facility;\n\tdest_r.info->level = r->info->level;\n\tdest_r.info->flags = r->info->flags;\n\tdest_r.info->ts_nsec = r->info->ts_nsec;\n\tdest_r.info->caller_id = r->info->caller_id;\n\tmemcpy(&dest_r.info->dev_info, &r->info->dev_info, sizeof(dest_r.info->dev_info));\n\n\tprb_final_commit(&e);\n\n\treturn prb_record_text_space(&e);\n}"
        }
      },
      {
        "call_info": {
          "callee": "prb_for_each_record",
          "args": [
            "seq",
            "&printk_rb_static",
            "seq",
            "&r"
          ],
          "line": 1150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local_irq_restore",
          "args": [
            "flags"
          ],
          "line": 1143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prb_for_each_record",
          "args": [
            "0",
            "&printk_rb_static",
            "seq",
            "&r"
          ],
          "line": 1133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local_irq_save",
          "args": [
            "flags"
          ],
          "line": 1126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prb_init",
          "args": [
            "&printk_rb_dynamic",
            "new_log_buf",
            "ilog2(new_log_buf_len)",
            "new_descs",
            "ilog2(new_descs_count)",
            "new_infos"
          ],
          "line": 1121
        },
        "resolved": true,
        "details": {
          "function_name": "prb_init",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk_ringbuffer.c",
          "lines": "2034-2061",
          "snippet": "void prb_init(struct printk_ringbuffer *rb,\n\t      char *text_buf, unsigned int textbits,\n\t      struct prb_desc *descs, unsigned int descbits,\n\t      struct printk_info *infos)\n{\n\tmemset(descs, 0, _DESCS_COUNT(descbits) * sizeof(descs[0]));\n\tmemset(infos, 0, _DESCS_COUNT(descbits) * sizeof(infos[0]));\n\n\trb->desc_ring.count_bits = descbits;\n\trb->desc_ring.descs = descs;\n\trb->desc_ring.infos = infos;\n\tatomic_long_set(&rb->desc_ring.head_id, DESC0_ID(descbits));\n\tatomic_long_set(&rb->desc_ring.tail_id, DESC0_ID(descbits));\n\n\trb->text_data_ring.size_bits = textbits;\n\trb->text_data_ring.data = text_buf;\n\tatomic_long_set(&rb->text_data_ring.head_lpos, BLK0_LPOS(textbits));\n\tatomic_long_set(&rb->text_data_ring.tail_lpos, BLK0_LPOS(textbits));\n\n\tatomic_long_set(&rb->fail, 0);\n\n\tatomic_long_set(&(descs[_DESCS_COUNT(descbits) - 1].state_var), DESC0_SV(descbits));\n\tdescs[_DESCS_COUNT(descbits) - 1].text_blk_lpos.begin = FAILED_LPOS;\n\tdescs[_DESCS_COUNT(descbits) - 1].text_blk_lpos.next = FAILED_LPOS;\n\n\tinfos[0].seq = -(u64)_DESCS_COUNT(descbits);\n\tinfos[_DESCS_COUNT(descbits) - 1].seq = 0;\n}",
          "includes": [
            "#include \"printk_ringbuffer.h\"",
            "#include <linux/bug.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/irqflags.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"printk_ringbuffer.h\"\n#include <linux/bug.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/irqflags.h>\n#include <linux/kernel.h>\n\nvoid prb_init(struct printk_ringbuffer *rb,\n\t      char *text_buf, unsigned int textbits,\n\t      struct prb_desc *descs, unsigned int descbits,\n\t      struct printk_info *infos)\n{\n\tmemset(descs, 0, _DESCS_COUNT(descbits) * sizeof(descs[0]));\n\tmemset(infos, 0, _DESCS_COUNT(descbits) * sizeof(infos[0]));\n\n\trb->desc_ring.count_bits = descbits;\n\trb->desc_ring.descs = descs;\n\trb->desc_ring.infos = infos;\n\tatomic_long_set(&rb->desc_ring.head_id, DESC0_ID(descbits));\n\tatomic_long_set(&rb->desc_ring.tail_id, DESC0_ID(descbits));\n\n\trb->text_data_ring.size_bits = textbits;\n\trb->text_data_ring.data = text_buf;\n\tatomic_long_set(&rb->text_data_ring.head_lpos, BLK0_LPOS(textbits));\n\tatomic_long_set(&rb->text_data_ring.tail_lpos, BLK0_LPOS(textbits));\n\n\tatomic_long_set(&rb->fail, 0);\n\n\tatomic_long_set(&(descs[_DESCS_COUNT(descbits) - 1].state_var), DESC0_SV(descbits));\n\tdescs[_DESCS_COUNT(descbits) - 1].text_blk_lpos.begin = FAILED_LPOS;\n\tdescs[_DESCS_COUNT(descbits) - 1].text_blk_lpos.next = FAILED_LPOS;\n\n\tinfos[0].seq = -(u64)_DESCS_COUNT(descbits);\n\tinfos[_DESCS_COUNT(descbits) - 1].seq = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ilog2",
          "args": [
            "new_descs_count"
          ],
          "line": 1123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ilog2",
          "args": [
            "new_log_buf_len"
          ],
          "line": 1122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prb_rec_init_rd",
          "args": [
            "&r",
            "&info",
            "&setup_text_buf[0]",
            "sizeof(setup_text_buf)"
          ],
          "line": 1119
        },
        "resolved": true,
        "details": {
          "function_name": "prb_rec_init_rd",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk_ringbuffer.h",
          "lines": "330-337",
          "snippet": "static inline void prb_rec_init_rd(struct printk_record *r,\n\t\t\t\t   struct printk_info *info,\n\t\t\t\t   char *text_buf, unsigned int text_buf_size)\n{\n\tr->info = info;\n\tr->text_buf = text_buf;\n\tr->text_buf_size = text_buf_size;\n}",
          "includes": [
            "#include <linux/dev_printk.h>",
            "#include <linux/atomic.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/dev_printk.h>\n#include <linux/atomic.h>\n\nstatic inline void prb_rec_init_rd(struct printk_record *r,\n\t\t\t\t   struct printk_info *info,\n\t\t\t\t   char *text_buf, unsigned int text_buf_size)\n{\n\tr->info = info;\n\tr->text_buf = text_buf;\n\tr->text_buf_size = text_buf_size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"log_buf_len: %zu info bytes not available\\n\"",
            "new_infos_size"
          ],
          "line": 1114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!new_infos"
          ],
          "line": 1113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memblock_alloc",
          "args": [
            "new_infos_size",
            "LOG_ALIGN"
          ],
          "line": 1112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"log_buf_len: %zu desc bytes not available\\n\"",
            "new_descs_size"
          ],
          "line": 1106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!new_descs"
          ],
          "line": 1105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memblock_alloc",
          "args": [
            "new_descs_size",
            "LOG_ALIGN"
          ],
          "line": 1104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"log_buf_len: %lu text bytes not available\\n\"",
            "new_log_buf_len"
          ],
          "line": 1098
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "!new_log_buf"
          ],
          "line": 1097
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memblock_alloc",
          "args": [
            "new_log_buf_len",
            "LOG_ALIGN"
          ],
          "line": 1096
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"new_log_buf_len: %lu too small\\n\"",
            "new_log_buf_len"
          ],
          "line": 1092
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_buf_add_cpu",
          "args": [],
          "line": 1085
        },
        "resolved": true,
        "details": {
          "function_name": "log_buf_add_cpu",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "1023-1023",
          "snippet": "static inline void log_buf_add_cpu(void) {}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic inline void log_buf_add_cpu(void) {}"
        }
      },
      {
        "call_info": {
          "callee": "set_percpu_data_ready",
          "args": [],
          "line": 1079
        },
        "resolved": true,
        "details": {
          "function_name": "set_percpu_data_ready",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "1026-1029",
          "snippet": "static void __init set_percpu_data_ready(void)\n{\n\t__printk_percpu_data_ready = true;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic void __init set_percpu_data_ready(void)\n{\n\t__printk_percpu_data_ready = true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define PRB_AVGBITS 5\t/* 32 character average length */\n#define __LOG_BUF_LEN (1 << CONFIG_LOG_BUF_SHIFT)\n#define LOG_ALIGN __alignof__(unsigned long)\n\nvoid __init setup_log_buf(int early)\n{\n\tstruct printk_info *new_infos;\n\tunsigned int new_descs_count;\n\tstruct prb_desc *new_descs;\n\tstruct printk_info info;\n\tstruct printk_record r;\n\tunsigned int text_size;\n\tsize_t new_descs_size;\n\tsize_t new_infos_size;\n\tunsigned long flags;\n\tchar *new_log_buf;\n\tunsigned int free;\n\tu64 seq;\n\n\t/*\n\t * Some archs call setup_log_buf() multiple times - first is very\n\t * early, e.g. from setup_arch(), and second - when percpu_areas\n\t * are initialised.\n\t */\n\tif (!early)\n\t\tset_percpu_data_ready();\n\n\tif (log_buf != __log_buf)\n\t\treturn;\n\n\tif (!early && !new_log_buf_len)\n\t\tlog_buf_add_cpu();\n\n\tif (!new_log_buf_len)\n\t\treturn;\n\n\tnew_descs_count = new_log_buf_len >> PRB_AVGBITS;\n\tif (new_descs_count == 0) {\n\t\tpr_err(\"new_log_buf_len: %lu too small\\n\", new_log_buf_len);\n\t\treturn;\n\t}\n\n\tnew_log_buf = memblock_alloc(new_log_buf_len, LOG_ALIGN);\n\tif (unlikely(!new_log_buf)) {\n\t\tpr_err(\"log_buf_len: %lu text bytes not available\\n\",\n\t\t       new_log_buf_len);\n\t\treturn;\n\t}\n\n\tnew_descs_size = new_descs_count * sizeof(struct prb_desc);\n\tnew_descs = memblock_alloc(new_descs_size, LOG_ALIGN);\n\tif (unlikely(!new_descs)) {\n\t\tpr_err(\"log_buf_len: %zu desc bytes not available\\n\",\n\t\t       new_descs_size);\n\t\tgoto err_free_log_buf;\n\t}\n\n\tnew_infos_size = new_descs_count * sizeof(struct printk_info);\n\tnew_infos = memblock_alloc(new_infos_size, LOG_ALIGN);\n\tif (unlikely(!new_infos)) {\n\t\tpr_err(\"log_buf_len: %zu info bytes not available\\n\",\n\t\t       new_infos_size);\n\t\tgoto err_free_descs;\n\t}\n\n\tprb_rec_init_rd(&r, &info, &setup_text_buf[0], sizeof(setup_text_buf));\n\n\tprb_init(&printk_rb_dynamic,\n\t\t new_log_buf, ilog2(new_log_buf_len),\n\t\t new_descs, ilog2(new_descs_count),\n\t\t new_infos);\n\n\tlocal_irq_save(flags);\n\n\tlog_buf_len = new_log_buf_len;\n\tlog_buf = new_log_buf;\n\tnew_log_buf_len = 0;\n\n\tfree = __LOG_BUF_LEN;\n\tprb_for_each_record(0, &printk_rb_static, seq, &r) {\n\t\ttext_size = add_to_rb(&printk_rb_dynamic, &r);\n\t\tif (text_size > free)\n\t\t\tfree = 0;\n\t\telse\n\t\t\tfree -= text_size;\n\t}\n\n\tprb = &printk_rb_dynamic;\n\n\tlocal_irq_restore(flags);\n\n\t/*\n\t * Copy any remaining messages that might have appeared from\n\t * NMI context after copying but before switching to the\n\t * dynamic buffer.\n\t */\n\tprb_for_each_record(seq, &printk_rb_static, seq, &r) {\n\t\ttext_size = add_to_rb(&printk_rb_dynamic, &r);\n\t\tif (text_size > free)\n\t\t\tfree = 0;\n\t\telse\n\t\t\tfree -= text_size;\n\t}\n\n\tif (seq != prb_next_seq(&printk_rb_static)) {\n\t\tpr_err(\"dropped %llu messages\\n\",\n\t\t       prb_next_seq(&printk_rb_static) - seq);\n\t}\n\n\tpr_info(\"log_buf_len: %u bytes\\n\", log_buf_len);\n\tpr_info(\"early log buf free: %u(%u%%)\\n\",\n\t\tfree, (free * 100) / __LOG_BUF_LEN);\n\treturn;\n\nerr_free_descs:\n\tmemblock_free(new_descs, new_descs_size);\nerr_free_log_buf:\n\tmemblock_free(new_log_buf, new_log_buf_len);\n}"
  },
  {
    "function_name": "add_to_rb",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "1031-1054",
    "snippet": "static unsigned int __init add_to_rb(struct printk_ringbuffer *rb,\n\t\t\t\t     struct printk_record *r)\n{\n\tstruct prb_reserved_entry e;\n\tstruct printk_record dest_r;\n\n\tprb_rec_init_wr(&dest_r, r->info->text_len);\n\n\tif (!prb_reserve(&e, rb, &dest_r))\n\t\treturn 0;\n\n\tmemcpy(&dest_r.text_buf[0], &r->text_buf[0], r->info->text_len);\n\tdest_r.info->text_len = r->info->text_len;\n\tdest_r.info->facility = r->info->facility;\n\tdest_r.info->level = r->info->level;\n\tdest_r.info->flags = r->info->flags;\n\tdest_r.info->ts_nsec = r->info->ts_nsec;\n\tdest_r.info->caller_id = r->info->caller_id;\n\tmemcpy(&dest_r.info->dev_info, &r->info->dev_info, sizeof(dest_r.info->dev_info));\n\n\tprb_final_commit(&e);\n\n\treturn prb_record_text_space(&e);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "prb_record_text_space",
          "args": [
            "&e"
          ],
          "line": 1053
        },
        "resolved": true,
        "details": {
          "function_name": "prb_record_text_space",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk_ringbuffer.c",
          "lines": "2079-2082",
          "snippet": "unsigned int prb_record_text_space(struct prb_reserved_entry *e)\n{\n\treturn e->text_space;\n}",
          "includes": [
            "#include \"printk_ringbuffer.h\"",
            "#include <linux/bug.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/irqflags.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"printk_ringbuffer.h\"\n#include <linux/bug.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/irqflags.h>\n#include <linux/kernel.h>\n\nunsigned int prb_record_text_space(struct prb_reserved_entry *e)\n{\n\treturn e->text_space;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prb_final_commit",
          "args": [
            "&e"
          ],
          "line": 1051
        },
        "resolved": true,
        "details": {
          "function_name": "prb_final_commit",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk_ringbuffer.c",
          "lines": "1658-1661",
          "snippet": "void prb_final_commit(struct prb_reserved_entry *e)\n{\n\t_prb_commit(e, desc_finalized);\n}",
          "includes": [
            "#include \"printk_ringbuffer.h\"",
            "#include <linux/bug.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/irqflags.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"printk_ringbuffer.h\"\n#include <linux/bug.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/irqflags.h>\n#include <linux/kernel.h>\n\nvoid prb_final_commit(struct prb_reserved_entry *e)\n{\n\t_prb_commit(e, desc_finalized);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&dest_r.info->dev_info",
            "&r->info->dev_info",
            "sizeof(dest_r.info->dev_info)"
          ],
          "line": 1049
        },
        "resolved": true,
        "details": {
          "function_name": "memcpy_skip",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/events/internal.h",
          "lines": "180-184",
          "snippet": "static inline unsigned long\nmemcpy_skip(void *dst, const void *src, unsigned long n)\n{\n\treturn 0;\n}",
          "includes": [
            "#include <linux/refcount.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hardirq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/refcount.h>\n#include <linux/uaccess.h>\n#include <linux/hardirq.h>\n\nstatic inline unsigned long\nmemcpy_skip(void *dst, const void *src, unsigned long n)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prb_reserve",
          "args": [
            "&e",
            "rb",
            "&dest_r"
          ],
          "line": 1039
        },
        "resolved": true,
        "details": {
          "function_name": "prb_reserve",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk_ringbuffer.c",
          "lines": "1479-1567",
          "snippet": "bool prb_reserve(struct prb_reserved_entry *e, struct printk_ringbuffer *rb,\n\t\t struct printk_record *r)\n{\n\tstruct prb_desc_ring *desc_ring = &rb->desc_ring;\n\tstruct printk_info *info;\n\tstruct prb_desc *d;\n\tunsigned long id;\n\tu64 seq;\n\n\tif (!data_check_size(&rb->text_data_ring, r->text_buf_size))\n\t\tgoto fail;\n\n\t/*\n\t * Descriptors in the reserved state act as blockers to all further\n\t * reservations once the desc_ring has fully wrapped. Disable\n\t * interrupts during the reserve/commit window in order to minimize\n\t * the likelihood of this happening.\n\t */\n\tlocal_irq_save(e->irqflags);\n\n\tif (!desc_reserve(rb, &id)) {\n\t\t/* Descriptor reservation failures are tracked. */\n\t\tatomic_long_inc(&rb->fail);\n\t\tlocal_irq_restore(e->irqflags);\n\t\tgoto fail;\n\t}\n\n\td = to_desc(desc_ring, id);\n\tinfo = to_info(desc_ring, id);\n\n\t/*\n\t * All @info fields (except @seq) are cleared and must be filled in\n\t * by the writer. Save @seq before clearing because it is used to\n\t * determine the new sequence number.\n\t */\n\tseq = info->seq;\n\tmemset(info, 0, sizeof(*info));\n\n\t/*\n\t * Set the @e fields here so that prb_commit() can be used if\n\t * text data allocation fails.\n\t */\n\te->rb = rb;\n\te->id = id;\n\n\t/*\n\t * Initialize the sequence number if it has \"never been set\".\n\t * Otherwise just increment it by a full wrap.\n\t *\n\t * @seq is considered \"never been set\" if it has a value of 0,\n\t * _except_ for @infos[0], which was specially setup by the ringbuffer\n\t * initializer and therefore is always considered as set.\n\t *\n\t * See the \"Bootstrap\" comment block in printk_ringbuffer.h for\n\t * details about how the initializer bootstraps the descriptors.\n\t */\n\tif (seq == 0 && DESC_INDEX(desc_ring, id) != 0)\n\t\tinfo->seq = DESC_INDEX(desc_ring, id);\n\telse\n\t\tinfo->seq = seq + DESCS_COUNT(desc_ring);\n\n\t/*\n\t * New data is about to be reserved. Once that happens, previous\n\t * descriptors are no longer able to be extended. Finalize the\n\t * previous descriptor now so that it can be made available to\n\t * readers. (For seq==0 there is no previous descriptor.)\n\t */\n\tif (info->seq > 0)\n\t\tdesc_make_final(desc_ring, DESC_ID(id - 1));\n\n\tr->text_buf = data_alloc(rb, r->text_buf_size, &d->text_blk_lpos, id);\n\t/* If text data allocation fails, a data-less record is committed. */\n\tif (r->text_buf_size && !r->text_buf) {\n\t\tprb_commit(e);\n\t\t/* prb_commit() re-enabled interrupts. */\n\t\tgoto fail;\n\t}\n\n\tr->info = info;\n\n\t/* Record full text space used by record. */\n\te->text_space = space_used(&rb->text_data_ring, &d->text_blk_lpos);\n\n\treturn true;\nfail:\n\t/* Make it clear to the caller that the reserve failed. */\n\tmemset(r, 0, sizeof(*r));\n\treturn false;\n}",
          "includes": [
            "#include \"printk_ringbuffer.h\"",
            "#include <linux/bug.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/irqflags.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"printk_ringbuffer.h\"\n#include <linux/bug.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/irqflags.h>\n#include <linux/kernel.h>\n\nbool prb_reserve(struct prb_reserved_entry *e, struct printk_ringbuffer *rb,\n\t\t struct printk_record *r)\n{\n\tstruct prb_desc_ring *desc_ring = &rb->desc_ring;\n\tstruct printk_info *info;\n\tstruct prb_desc *d;\n\tunsigned long id;\n\tu64 seq;\n\n\tif (!data_check_size(&rb->text_data_ring, r->text_buf_size))\n\t\tgoto fail;\n\n\t/*\n\t * Descriptors in the reserved state act as blockers to all further\n\t * reservations once the desc_ring has fully wrapped. Disable\n\t * interrupts during the reserve/commit window in order to minimize\n\t * the likelihood of this happening.\n\t */\n\tlocal_irq_save(e->irqflags);\n\n\tif (!desc_reserve(rb, &id)) {\n\t\t/* Descriptor reservation failures are tracked. */\n\t\tatomic_long_inc(&rb->fail);\n\t\tlocal_irq_restore(e->irqflags);\n\t\tgoto fail;\n\t}\n\n\td = to_desc(desc_ring, id);\n\tinfo = to_info(desc_ring, id);\n\n\t/*\n\t * All @info fields (except @seq) are cleared and must be filled in\n\t * by the writer. Save @seq before clearing because it is used to\n\t * determine the new sequence number.\n\t */\n\tseq = info->seq;\n\tmemset(info, 0, sizeof(*info));\n\n\t/*\n\t * Set the @e fields here so that prb_commit() can be used if\n\t * text data allocation fails.\n\t */\n\te->rb = rb;\n\te->id = id;\n\n\t/*\n\t * Initialize the sequence number if it has \"never been set\".\n\t * Otherwise just increment it by a full wrap.\n\t *\n\t * @seq is considered \"never been set\" if it has a value of 0,\n\t * _except_ for @infos[0], which was specially setup by the ringbuffer\n\t * initializer and therefore is always considered as set.\n\t *\n\t * See the \"Bootstrap\" comment block in printk_ringbuffer.h for\n\t * details about how the initializer bootstraps the descriptors.\n\t */\n\tif (seq == 0 && DESC_INDEX(desc_ring, id) != 0)\n\t\tinfo->seq = DESC_INDEX(desc_ring, id);\n\telse\n\t\tinfo->seq = seq + DESCS_COUNT(desc_ring);\n\n\t/*\n\t * New data is about to be reserved. Once that happens, previous\n\t * descriptors are no longer able to be extended. Finalize the\n\t * previous descriptor now so that it can be made available to\n\t * readers. (For seq==0 there is no previous descriptor.)\n\t */\n\tif (info->seq > 0)\n\t\tdesc_make_final(desc_ring, DESC_ID(id - 1));\n\n\tr->text_buf = data_alloc(rb, r->text_buf_size, &d->text_blk_lpos, id);\n\t/* If text data allocation fails, a data-less record is committed. */\n\tif (r->text_buf_size && !r->text_buf) {\n\t\tprb_commit(e);\n\t\t/* prb_commit() re-enabled interrupts. */\n\t\tgoto fail;\n\t}\n\n\tr->info = info;\n\n\t/* Record full text space used by record. */\n\te->text_space = space_used(&rb->text_data_ring, &d->text_blk_lpos);\n\n\treturn true;\nfail:\n\t/* Make it clear to the caller that the reserve failed. */\n\tmemset(r, 0, sizeof(*r));\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prb_rec_init_wr",
          "args": [
            "&dest_r",
            "r->info->text_len"
          ],
          "line": 1037
        },
        "resolved": true,
        "details": {
          "function_name": "prb_rec_init_wr",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk_ringbuffer.h",
          "lines": "295-301",
          "snippet": "static inline void prb_rec_init_wr(struct printk_record *r,\n\t\t\t\t   unsigned int text_buf_size)\n{\n\tr->info = NULL;\n\tr->text_buf = NULL;\n\tr->text_buf_size = text_buf_size;\n}",
          "includes": [
            "#include <linux/dev_printk.h>",
            "#include <linux/atomic.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/dev_printk.h>\n#include <linux/atomic.h>\n\nstatic inline void prb_rec_init_wr(struct printk_record *r,\n\t\t\t\t   unsigned int text_buf_size)\n{\n\tr->info = NULL;\n\tr->text_buf = NULL;\n\tr->text_buf_size = text_buf_size;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic unsigned int __init add_to_rb(struct printk_ringbuffer *rb,\n\t\t\t\t     struct printk_record *r)\n{\n\tstruct prb_reserved_entry e;\n\tstruct printk_record dest_r;\n\n\tprb_rec_init_wr(&dest_r, r->info->text_len);\n\n\tif (!prb_reserve(&e, rb, &dest_r))\n\t\treturn 0;\n\n\tmemcpy(&dest_r.text_buf[0], &r->text_buf[0], r->info->text_len);\n\tdest_r.info->text_len = r->info->text_len;\n\tdest_r.info->facility = r->info->facility;\n\tdest_r.info->level = r->info->level;\n\tdest_r.info->flags = r->info->flags;\n\tdest_r.info->ts_nsec = r->info->ts_nsec;\n\tdest_r.info->caller_id = r->info->caller_id;\n\tmemcpy(&dest_r.info->dev_info, &r->info->dev_info, sizeof(dest_r.info->dev_info));\n\n\tprb_final_commit(&e);\n\n\treturn prb_record_text_space(&e);\n}"
  },
  {
    "function_name": "set_percpu_data_ready",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "1026-1029",
    "snippet": "static void __init set_percpu_data_ready(void)\n{\n\t__printk_percpu_data_ready = true;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic void __init set_percpu_data_ready(void)\n{\n\t__printk_percpu_data_ready = true;\n}"
  },
  {
    "function_name": "log_buf_add_cpu",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "1023-1023",
    "snippet": "static inline void log_buf_add_cpu(void) {}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic inline void log_buf_add_cpu(void) {}"
  },
  {
    "function_name": "log_buf_add_cpu",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "996-1021",
    "snippet": "static void __init log_buf_add_cpu(void)\n{\n\tunsigned int cpu_extra;\n\n\t/*\n\t * archs should set up cpu_possible_bits properly with\n\t * set_cpu_possible() after setup_arch() but just in\n\t * case lets ensure this is valid.\n\t */\n\tif (num_possible_cpus() == 1)\n\t\treturn;\n\n\tcpu_extra = (num_possible_cpus() - 1) * __LOG_CPU_MAX_BUF_LEN;\n\n\t/* by default this will only continue through for large > 64 CPUs */\n\tif (cpu_extra <= __LOG_BUF_LEN / 2)\n\t\treturn;\n\n\tpr_info(\"log_buf_len individual max cpu contribution: %d bytes\\n\",\n\t\t__LOG_CPU_MAX_BUF_LEN);\n\tpr_info(\"log_buf_len total cpu_extra contributions: %d bytes\\n\",\n\t\tcpu_extra);\n\tpr_info(\"log_buf_len min size: %d bytes\\n\", __LOG_BUF_LEN);\n\n\tlog_buf_len_update(cpu_extra + __LOG_BUF_LEN);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define __LOG_CPU_MAX_BUF_LEN (1 << CONFIG_LOG_CPU_MAX_BUF_SHIFT)",
      "#define __LOG_BUF_LEN (1 << CONFIG_LOG_BUF_SHIFT)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_buf_len_update",
          "args": [
            "cpu_extra + __LOG_BUF_LEN"
          ],
          "line": 1020
        },
        "resolved": true,
        "details": {
          "function_name": "log_buf_len_update",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "964-975",
          "snippet": "static void __init log_buf_len_update(u64 size)\n{\n\tif (size > (u64)LOG_BUF_LEN_MAX) {\n\t\tsize = (u64)LOG_BUF_LEN_MAX;\n\t\tpr_err(\"log_buf over 2G is not supported.\\n\");\n\t}\n\n\tif (size)\n\t\tsize = roundup_pow_of_two(size);\n\tif (size > log_buf_len)\n\t\tnew_log_buf_len = (unsigned long)size;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define LOG_BUF_LEN_MAX (u32)(1 << 31)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define LOG_BUF_LEN_MAX (u32)(1 << 31)\n\nstatic void __init log_buf_len_update(u64 size)\n{\n\tif (size > (u64)LOG_BUF_LEN_MAX) {\n\t\tsize = (u64)LOG_BUF_LEN_MAX;\n\t\tpr_err(\"log_buf over 2G is not supported.\\n\");\n\t}\n\n\tif (size)\n\t\tsize = roundup_pow_of_two(size);\n\tif (size > log_buf_len)\n\t\tnew_log_buf_len = (unsigned long)size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"log_buf_len min size: %d bytes\\n\"",
            "__LOG_BUF_LEN"
          ],
          "line": 1018
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"log_buf_len total cpu_extra contributions: %d bytes\\n\"",
            "cpu_extra"
          ],
          "line": 1016
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_info",
          "args": [
            "\"log_buf_len individual max cpu contribution: %d bytes\\n\"",
            "__LOG_CPU_MAX_BUF_LEN"
          ],
          "line": 1014
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "num_possible_cpus",
          "args": [],
          "line": 1008
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "num_possible_cpus",
          "args": [],
          "line": 1005
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define __LOG_CPU_MAX_BUF_LEN (1 << CONFIG_LOG_CPU_MAX_BUF_SHIFT)\n#define __LOG_BUF_LEN (1 << CONFIG_LOG_BUF_SHIFT)\n\nstatic void __init log_buf_add_cpu(void)\n{\n\tunsigned int cpu_extra;\n\n\t/*\n\t * archs should set up cpu_possible_bits properly with\n\t * set_cpu_possible() after setup_arch() but just in\n\t * case lets ensure this is valid.\n\t */\n\tif (num_possible_cpus() == 1)\n\t\treturn;\n\n\tcpu_extra = (num_possible_cpus() - 1) * __LOG_CPU_MAX_BUF_LEN;\n\n\t/* by default this will only continue through for large > 64 CPUs */\n\tif (cpu_extra <= __LOG_BUF_LEN / 2)\n\t\treturn;\n\n\tpr_info(\"log_buf_len individual max cpu contribution: %d bytes\\n\",\n\t\t__LOG_CPU_MAX_BUF_LEN);\n\tpr_info(\"log_buf_len total cpu_extra contributions: %d bytes\\n\",\n\t\tcpu_extra);\n\tpr_info(\"log_buf_len min size: %d bytes\\n\", __LOG_BUF_LEN);\n\n\tlog_buf_len_update(cpu_extra + __LOG_BUF_LEN);\n}"
  },
  {
    "function_name": "log_buf_len_setup",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "978-990",
    "snippet": "static int __init log_buf_len_setup(char *str)\n{\n\tu64 size;\n\n\tif (!str)\n\t\treturn -EINVAL;\n\n\tsize = memparse(str, &str);\n\n\tlog_buf_len_update(size);\n\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_buf_len_update",
          "args": [
            "size"
          ],
          "line": 987
        },
        "resolved": true,
        "details": {
          "function_name": "log_buf_len_update",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "964-975",
          "snippet": "static void __init log_buf_len_update(u64 size)\n{\n\tif (size > (u64)LOG_BUF_LEN_MAX) {\n\t\tsize = (u64)LOG_BUF_LEN_MAX;\n\t\tpr_err(\"log_buf over 2G is not supported.\\n\");\n\t}\n\n\tif (size)\n\t\tsize = roundup_pow_of_two(size);\n\tif (size > log_buf_len)\n\t\tnew_log_buf_len = (unsigned long)size;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define LOG_BUF_LEN_MAX (u32)(1 << 31)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define LOG_BUF_LEN_MAX (u32)(1 << 31)\n\nstatic void __init log_buf_len_update(u64 size)\n{\n\tif (size > (u64)LOG_BUF_LEN_MAX) {\n\t\tsize = (u64)LOG_BUF_LEN_MAX;\n\t\tpr_err(\"log_buf over 2G is not supported.\\n\");\n\t}\n\n\tif (size)\n\t\tsize = roundup_pow_of_two(size);\n\tif (size > log_buf_len)\n\t\tnew_log_buf_len = (unsigned long)size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memparse",
          "args": [
            "str",
            "&str"
          ],
          "line": 985
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic int __init log_buf_len_setup(char *str)\n{\n\tu64 size;\n\n\tif (!str)\n\t\treturn -EINVAL;\n\n\tsize = memparse(str, &str);\n\n\tlog_buf_len_update(size);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "log_buf_len_update",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "964-975",
    "snippet": "static void __init log_buf_len_update(u64 size)\n{\n\tif (size > (u64)LOG_BUF_LEN_MAX) {\n\t\tsize = (u64)LOG_BUF_LEN_MAX;\n\t\tpr_err(\"log_buf over 2G is not supported.\\n\");\n\t}\n\n\tif (size)\n\t\tsize = roundup_pow_of_two(size);\n\tif (size > log_buf_len)\n\t\tnew_log_buf_len = (unsigned long)size;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define LOG_BUF_LEN_MAX (u32)(1 << 31)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "roundup_pow_of_two",
          "args": [
            "size"
          ],
          "line": 972
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_err",
          "args": [
            "\"log_buf over 2G is not supported.\\n\""
          ],
          "line": 968
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define LOG_BUF_LEN_MAX (u32)(1 << 31)\n\nstatic void __init log_buf_len_update(u64 size)\n{\n\tif (size > (u64)LOG_BUF_LEN_MAX) {\n\t\tsize = (u64)LOG_BUF_LEN_MAX;\n\t\tpr_err(\"log_buf over 2G is not supported.\\n\");\n\t}\n\n\tif (size)\n\t\tsize = roundup_pow_of_two(size);\n\tif (size > log_buf_len)\n\t\tnew_log_buf_len = (unsigned long)size;\n}"
  },
  {
    "function_name": "log_buf_vmcoreinfo_setup",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "900-957",
    "snippet": "void log_buf_vmcoreinfo_setup(void)\n{\n\tstruct dev_printk_info *dev_info = NULL;\n\n\tVMCOREINFO_SYMBOL(prb);\n\tVMCOREINFO_SYMBOL(printk_rb_static);\n\tVMCOREINFO_SYMBOL(clear_seq);\n\n\t/*\n\t * Export struct size and field offsets. User space tools can\n\t * parse it and detect any changes to structure down the line.\n\t */\n\n\tVMCOREINFO_STRUCT_SIZE(printk_ringbuffer);\n\tVMCOREINFO_OFFSET(printk_ringbuffer, desc_ring);\n\tVMCOREINFO_OFFSET(printk_ringbuffer, text_data_ring);\n\tVMCOREINFO_OFFSET(printk_ringbuffer, fail);\n\n\tVMCOREINFO_STRUCT_SIZE(prb_desc_ring);\n\tVMCOREINFO_OFFSET(prb_desc_ring, count_bits);\n\tVMCOREINFO_OFFSET(prb_desc_ring, descs);\n\tVMCOREINFO_OFFSET(prb_desc_ring, infos);\n\tVMCOREINFO_OFFSET(prb_desc_ring, head_id);\n\tVMCOREINFO_OFFSET(prb_desc_ring, tail_id);\n\n\tVMCOREINFO_STRUCT_SIZE(prb_desc);\n\tVMCOREINFO_OFFSET(prb_desc, state_var);\n\tVMCOREINFO_OFFSET(prb_desc, text_blk_lpos);\n\n\tVMCOREINFO_STRUCT_SIZE(prb_data_blk_lpos);\n\tVMCOREINFO_OFFSET(prb_data_blk_lpos, begin);\n\tVMCOREINFO_OFFSET(prb_data_blk_lpos, next);\n\n\tVMCOREINFO_STRUCT_SIZE(printk_info);\n\tVMCOREINFO_OFFSET(printk_info, seq);\n\tVMCOREINFO_OFFSET(printk_info, ts_nsec);\n\tVMCOREINFO_OFFSET(printk_info, text_len);\n\tVMCOREINFO_OFFSET(printk_info, caller_id);\n\tVMCOREINFO_OFFSET(printk_info, dev_info);\n\n\tVMCOREINFO_STRUCT_SIZE(dev_printk_info);\n\tVMCOREINFO_OFFSET(dev_printk_info, subsystem);\n\tVMCOREINFO_LENGTH(printk_info_subsystem, sizeof(dev_info->subsystem));\n\tVMCOREINFO_OFFSET(dev_printk_info, device);\n\tVMCOREINFO_LENGTH(printk_info_device, sizeof(dev_info->device));\n\n\tVMCOREINFO_STRUCT_SIZE(prb_data_ring);\n\tVMCOREINFO_OFFSET(prb_data_ring, size_bits);\n\tVMCOREINFO_OFFSET(prb_data_ring, data);\n\tVMCOREINFO_OFFSET(prb_data_ring, head_lpos);\n\tVMCOREINFO_OFFSET(prb_data_ring, tail_lpos);\n\n\tVMCOREINFO_SIZE(atomic_long_t);\n\tVMCOREINFO_TYPE_OFFSET(atomic_long_t, counter);\n\n\tVMCOREINFO_STRUCT_SIZE(latched_seq);\n\tVMCOREINFO_OFFSET(latched_seq, val);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VMCOREINFO_OFFSET",
          "args": [
            "latched_seq",
            "val"
          ],
          "line": 956
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VMCOREINFO_STRUCT_SIZE",
          "args": [
            "latched_seq"
          ],
          "line": 955
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VMCOREINFO_TYPE_OFFSET",
          "args": [
            "atomic_long_t",
            "counter"
          ],
          "line": 953
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VMCOREINFO_SIZE",
          "args": [
            "atomic_long_t"
          ],
          "line": 952
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VMCOREINFO_OFFSET",
          "args": [
            "prb_data_ring",
            "tail_lpos"
          ],
          "line": 950
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VMCOREINFO_OFFSET",
          "args": [
            "prb_data_ring",
            "head_lpos"
          ],
          "line": 949
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VMCOREINFO_OFFSET",
          "args": [
            "prb_data_ring",
            "data"
          ],
          "line": 948
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VMCOREINFO_OFFSET",
          "args": [
            "prb_data_ring",
            "size_bits"
          ],
          "line": 947
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VMCOREINFO_STRUCT_SIZE",
          "args": [
            "prb_data_ring"
          ],
          "line": 946
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VMCOREINFO_LENGTH",
          "args": [
            "printk_info_device",
            "sizeof(dev_info->device)"
          ],
          "line": 944
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VMCOREINFO_OFFSET",
          "args": [
            "dev_printk_info",
            "device"
          ],
          "line": 943
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VMCOREINFO_LENGTH",
          "args": [
            "printk_info_subsystem",
            "sizeof(dev_info->subsystem)"
          ],
          "line": 942
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VMCOREINFO_OFFSET",
          "args": [
            "dev_printk_info",
            "subsystem"
          ],
          "line": 941
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VMCOREINFO_STRUCT_SIZE",
          "args": [
            "dev_printk_info"
          ],
          "line": 940
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VMCOREINFO_OFFSET",
          "args": [
            "printk_info",
            "dev_info"
          ],
          "line": 938
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VMCOREINFO_OFFSET",
          "args": [
            "printk_info",
            "caller_id"
          ],
          "line": 937
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VMCOREINFO_OFFSET",
          "args": [
            "printk_info",
            "text_len"
          ],
          "line": 936
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VMCOREINFO_OFFSET",
          "args": [
            "printk_info",
            "ts_nsec"
          ],
          "line": 935
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VMCOREINFO_OFFSET",
          "args": [
            "printk_info",
            "seq"
          ],
          "line": 934
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VMCOREINFO_STRUCT_SIZE",
          "args": [
            "printk_info"
          ],
          "line": 933
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VMCOREINFO_OFFSET",
          "args": [
            "prb_data_blk_lpos",
            "next"
          ],
          "line": 931
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VMCOREINFO_OFFSET",
          "args": [
            "prb_data_blk_lpos",
            "begin"
          ],
          "line": 930
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VMCOREINFO_STRUCT_SIZE",
          "args": [
            "prb_data_blk_lpos"
          ],
          "line": 929
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VMCOREINFO_OFFSET",
          "args": [
            "prb_desc",
            "text_blk_lpos"
          ],
          "line": 927
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VMCOREINFO_OFFSET",
          "args": [
            "prb_desc",
            "state_var"
          ],
          "line": 926
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VMCOREINFO_STRUCT_SIZE",
          "args": [
            "prb_desc"
          ],
          "line": 925
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VMCOREINFO_OFFSET",
          "args": [
            "prb_desc_ring",
            "tail_id"
          ],
          "line": 923
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VMCOREINFO_OFFSET",
          "args": [
            "prb_desc_ring",
            "head_id"
          ],
          "line": 922
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VMCOREINFO_OFFSET",
          "args": [
            "prb_desc_ring",
            "infos"
          ],
          "line": 921
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VMCOREINFO_OFFSET",
          "args": [
            "prb_desc_ring",
            "descs"
          ],
          "line": 920
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VMCOREINFO_OFFSET",
          "args": [
            "prb_desc_ring",
            "count_bits"
          ],
          "line": 919
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VMCOREINFO_STRUCT_SIZE",
          "args": [
            "prb_desc_ring"
          ],
          "line": 918
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VMCOREINFO_OFFSET",
          "args": [
            "printk_ringbuffer",
            "fail"
          ],
          "line": 916
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VMCOREINFO_OFFSET",
          "args": [
            "printk_ringbuffer",
            "text_data_ring"
          ],
          "line": 915
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VMCOREINFO_OFFSET",
          "args": [
            "printk_ringbuffer",
            "desc_ring"
          ],
          "line": 914
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VMCOREINFO_STRUCT_SIZE",
          "args": [
            "printk_ringbuffer"
          ],
          "line": 913
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VMCOREINFO_SYMBOL",
          "args": [
            "clear_seq"
          ],
          "line": 906
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VMCOREINFO_SYMBOL",
          "args": [
            "printk_rb_static"
          ],
          "line": 905
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VMCOREINFO_SYMBOL",
          "args": [
            "prb"
          ],
          "line": 904
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nvoid log_buf_vmcoreinfo_setup(void)\n{\n\tstruct dev_printk_info *dev_info = NULL;\n\n\tVMCOREINFO_SYMBOL(prb);\n\tVMCOREINFO_SYMBOL(printk_rb_static);\n\tVMCOREINFO_SYMBOL(clear_seq);\n\n\t/*\n\t * Export struct size and field offsets. User space tools can\n\t * parse it and detect any changes to structure down the line.\n\t */\n\n\tVMCOREINFO_STRUCT_SIZE(printk_ringbuffer);\n\tVMCOREINFO_OFFSET(printk_ringbuffer, desc_ring);\n\tVMCOREINFO_OFFSET(printk_ringbuffer, text_data_ring);\n\tVMCOREINFO_OFFSET(printk_ringbuffer, fail);\n\n\tVMCOREINFO_STRUCT_SIZE(prb_desc_ring);\n\tVMCOREINFO_OFFSET(prb_desc_ring, count_bits);\n\tVMCOREINFO_OFFSET(prb_desc_ring, descs);\n\tVMCOREINFO_OFFSET(prb_desc_ring, infos);\n\tVMCOREINFO_OFFSET(prb_desc_ring, head_id);\n\tVMCOREINFO_OFFSET(prb_desc_ring, tail_id);\n\n\tVMCOREINFO_STRUCT_SIZE(prb_desc);\n\tVMCOREINFO_OFFSET(prb_desc, state_var);\n\tVMCOREINFO_OFFSET(prb_desc, text_blk_lpos);\n\n\tVMCOREINFO_STRUCT_SIZE(prb_data_blk_lpos);\n\tVMCOREINFO_OFFSET(prb_data_blk_lpos, begin);\n\tVMCOREINFO_OFFSET(prb_data_blk_lpos, next);\n\n\tVMCOREINFO_STRUCT_SIZE(printk_info);\n\tVMCOREINFO_OFFSET(printk_info, seq);\n\tVMCOREINFO_OFFSET(printk_info, ts_nsec);\n\tVMCOREINFO_OFFSET(printk_info, text_len);\n\tVMCOREINFO_OFFSET(printk_info, caller_id);\n\tVMCOREINFO_OFFSET(printk_info, dev_info);\n\n\tVMCOREINFO_STRUCT_SIZE(dev_printk_info);\n\tVMCOREINFO_OFFSET(dev_printk_info, subsystem);\n\tVMCOREINFO_LENGTH(printk_info_subsystem, sizeof(dev_info->subsystem));\n\tVMCOREINFO_OFFSET(dev_printk_info, device);\n\tVMCOREINFO_LENGTH(printk_info_device, sizeof(dev_info->device));\n\n\tVMCOREINFO_STRUCT_SIZE(prb_data_ring);\n\tVMCOREINFO_OFFSET(prb_data_ring, size_bits);\n\tVMCOREINFO_OFFSET(prb_data_ring, data);\n\tVMCOREINFO_OFFSET(prb_data_ring, head_lpos);\n\tVMCOREINFO_OFFSET(prb_data_ring, tail_lpos);\n\n\tVMCOREINFO_SIZE(atomic_long_t);\n\tVMCOREINFO_TYPE_OFFSET(atomic_long_t, counter);\n\n\tVMCOREINFO_STRUCT_SIZE(latched_seq);\n\tVMCOREINFO_OFFSET(latched_seq, val);\n}"
  },
  {
    "function_name": "devkmsg_release",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "868-880",
    "snippet": "static int devkmsg_release(struct inode *inode, struct file *file)\n{\n\tstruct devkmsg_user *user = file->private_data;\n\n\tif (!user)\n\t\treturn 0;\n\n\tratelimit_state_exit(&user->rs);\n\n\tmutex_destroy(&user->lock);\n\tkvfree(user);\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kvfree",
          "args": [
            "user"
          ],
          "line": 878
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_destroy",
          "args": [
            "&user->lock"
          ],
          "line": 877
        },
        "resolved": true,
        "details": {
          "function_name": "mutex_destroy",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/mutex-debug.c",
          "lines": "100-104",
          "snippet": "void mutex_destroy(struct mutex *lock)\n{\n\tDEBUG_LOCKS_WARN_ON(mutex_is_locked(lock));\n\tlock->magic = NULL;\n}",
          "includes": [
            "#include \"mutex.h\"",
            "#include <linux/debug_locks.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/kallsyms.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/sched.h>",
            "#include <linux/poison.h>",
            "#include <linux/export.h>",
            "#include <linux/delay.h>",
            "#include <linux/mutex.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"mutex.h\"\n#include <linux/debug_locks.h>\n#include <linux/interrupt.h>\n#include <linux/kallsyms.h>\n#include <linux/spinlock.h>\n#include <linux/sched.h>\n#include <linux/poison.h>\n#include <linux/export.h>\n#include <linux/delay.h>\n#include <linux/mutex.h>\n\nvoid mutex_destroy(struct mutex *lock)\n{\n\tDEBUG_LOCKS_WARN_ON(mutex_is_locked(lock));\n\tlock->magic = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ratelimit_state_exit",
          "args": [
            "&user->rs"
          ],
          "line": 875
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic int devkmsg_release(struct inode *inode, struct file *file)\n{\n\tstruct devkmsg_user *user = file->private_data;\n\n\tif (!user)\n\t\treturn 0;\n\n\tratelimit_state_exit(&user->rs);\n\n\tmutex_destroy(&user->lock);\n\tkvfree(user);\n\treturn 0;\n}"
  },
  {
    "function_name": "devkmsg_open",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "834-866",
    "snippet": "static int devkmsg_open(struct inode *inode, struct file *file)\n{\n\tstruct devkmsg_user *user;\n\tint err;\n\n\tif (devkmsg_log & DEVKMSG_LOG_MASK_OFF)\n\t\treturn -EPERM;\n\n\t/* write-only does not need any file context */\n\tif ((file->f_flags & O_ACCMODE) != O_WRONLY) {\n\t\terr = check_syslog_permissions(SYSLOG_ACTION_READ_ALL,\n\t\t\t\t\t       SYSLOG_FROM_READER);\n\t\tif (err)\n\t\t\treturn err;\n\t}\n\n\tuser = kvmalloc(sizeof(struct devkmsg_user), GFP_KERNEL);\n\tif (!user)\n\t\treturn -ENOMEM;\n\n\tratelimit_default_init(&user->rs);\n\tratelimit_set_flags(&user->rs, RATELIMIT_MSG_ON_RELEASE);\n\n\tmutex_init(&user->lock);\n\n\tprb_rec_init_rd(&user->record, &user->info,\n\t\t\t&user->text_buf[0], sizeof(user->text_buf));\n\n\tatomic64_set(&user->seq, prb_first_valid_seq(prb));\n\n\tfile->private_data = user;\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic64_set",
          "args": [
            "&user->seq",
            "prb_first_valid_seq(prb)"
          ],
          "line": 862
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prb_first_valid_seq",
          "args": [
            "prb"
          ],
          "line": 862
        },
        "resolved": true,
        "details": {
          "function_name": "prb_first_valid_seq",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk_ringbuffer.c",
          "lines": "1981-1989",
          "snippet": "u64 prb_first_valid_seq(struct printk_ringbuffer *rb)\n{\n\tu64 seq = 0;\n\n\tif (!_prb_read_valid(rb, &seq, NULL, NULL))\n\t\treturn 0;\n\n\treturn seq;\n}",
          "includes": [
            "#include \"printk_ringbuffer.h\"",
            "#include <linux/bug.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/irqflags.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"printk_ringbuffer.h\"\n#include <linux/bug.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/irqflags.h>\n#include <linux/kernel.h>\n\nu64 prb_first_valid_seq(struct printk_ringbuffer *rb)\n{\n\tu64 seq = 0;\n\n\tif (!_prb_read_valid(rb, &seq, NULL, NULL))\n\t\treturn 0;\n\n\treturn seq;\n}"
        }
      },
      {
        "call_info": {
          "callee": "prb_rec_init_rd",
          "args": [
            "&user->record",
            "&user->info",
            "&user->text_buf[0]",
            "sizeof(user->text_buf)"
          ],
          "line": 859
        },
        "resolved": true,
        "details": {
          "function_name": "prb_rec_init_rd",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk_ringbuffer.h",
          "lines": "330-337",
          "snippet": "static inline void prb_rec_init_rd(struct printk_record *r,\n\t\t\t\t   struct printk_info *info,\n\t\t\t\t   char *text_buf, unsigned int text_buf_size)\n{\n\tr->info = info;\n\tr->text_buf = text_buf;\n\tr->text_buf_size = text_buf_size;\n}",
          "includes": [
            "#include <linux/dev_printk.h>",
            "#include <linux/atomic.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/dev_printk.h>\n#include <linux/atomic.h>\n\nstatic inline void prb_rec_init_rd(struct printk_record *r,\n\t\t\t\t   struct printk_info *info,\n\t\t\t\t   char *text_buf, unsigned int text_buf_size)\n{\n\tr->info = info;\n\tr->text_buf = text_buf;\n\tr->text_buf_size = text_buf_size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mutex_init",
          "args": [
            "&user->lock"
          ],
          "line": 857
        },
        "resolved": true,
        "details": {
          "function_name": "rt_mutex_init_task",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/fork.c",
          "lines": "1700-1708",
          "snippet": "static void rt_mutex_init_task(struct task_struct *p)\n{\n\traw_spin_lock_init(&p->pi_lock);\n#ifdef CONFIG_RT_MUTEXES\n\tp->pi_waiters = RB_ROOT_CACHED;\n\tp->pi_top_task = NULL;\n\tp->pi_blocked_on = NULL;\n#endif\n}",
          "includes": [
            "#include <linux/init_task.h>",
            "#include <trace/events/task.h>",
            "#include <trace/events/sched.h>",
            "#include <asm/tlbflush.h>",
            "#include <asm/cacheflush.h>",
            "#include <asm/mmu_context.h>",
            "#include <linux/uaccess.h>",
            "#include <asm/pgalloc.h>",
            "#include <linux/bpf.h>",
            "#include <linux/io_uring.h>",
            "#include <linux/scs.h>",
            "#include <linux/kasan.h>",
            "#include <linux/stackleak.h>",
            "#include <linux/thread_info.h>",
            "#include <linux/livepatch.h>",
            "#include <linux/kcov.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/compiler.h>",
            "#include <linux/aio.h>",
            "#include <linux/uprobes.h>",
            "#include <linux/signalfd.h>",
            "#include <linux/khugepaged.h>",
            "#include <linux/oom.h>",
            "#include <linux/user-return-notifier.h>",
            "#include <linux/posix-timers.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/magic.h>",
            "#include <linux/fs_struct.h>",
            "#include <linux/tty.h>",
            "#include <linux/random.h>",
            "#include <linux/taskstats_kern.h>",
            "#include <linux/delayacct.h>",
            "#include <linux/freezer.h>",
            "#include <linux/cn_proc.h>",
            "#include <linux/tsacct_kern.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <linux/acct.h>",
            "#include <linux/ksm.h>",
            "#include <linux/rmap.h>",
            "#include <linux/profile.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/memcontrol.h>",
            "#include <linux/audit.h>",
            "#include <linux/mount.h>",
            "#include <linux/ptrace.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/task_io_accounting_ops.h>",
            "#include <linux/kthread.h>",
            "#include <linux/compat.h>",
            "#include <linux/futex.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/swap.h>",
            "#include <linux/seccomp.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/security.h>",
            "#include <linux/cgroup.h>",
            "#include <linux/cpu.h>",
            "#include <linux/capability.h>",
            "#include <linux/nsproxy.h>",
            "#include <linux/vmacache.h>",
            "#include <linux/mm_inline.h>",
            "#include <linux/mm.h>",
            "#include <linux/fs.h>",
            "#include <linux/mmu_notifier.h>",
            "#include <linux/mman.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/key.h>",
            "#include <linux/iocontext.h>",
            "#include <linux/fdtable.h>",
            "#include <linux/file.h>",
            "#include <linux/sem.h>",
            "#include <linux/mempolicy.h>",
            "#include <linux/personality.h>",
            "#include <linux/completion.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/module.h>",
            "#include <linux/unistd.h>",
            "#include <linux/init.h>",
            "#include <linux/rtmutex.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/sched/cputime.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/task.h>",
            "#include <linux/sched/stat.h>",
            "#include <linux/sched/numa_balancing.h>",
            "#include <linux/sched/user.h>",
            "#include <linux/sched/coredump.h>",
            "#include <linux/sched/mm.h>",
            "#include <linux/sched/autogroup.h>",
            "#include <linux/slab.h>",
            "#include <linux/anon_inodes.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __latent_entropy struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/init_task.h>\n#include <trace/events/task.h>\n#include <trace/events/sched.h>\n#include <asm/tlbflush.h>\n#include <asm/cacheflush.h>\n#include <asm/mmu_context.h>\n#include <linux/uaccess.h>\n#include <asm/pgalloc.h>\n#include <linux/bpf.h>\n#include <linux/io_uring.h>\n#include <linux/scs.h>\n#include <linux/kasan.h>\n#include <linux/stackleak.h>\n#include <linux/thread_info.h>\n#include <linux/livepatch.h>\n#include <linux/kcov.h>\n#include <linux/sysctl.h>\n#include <linux/compiler.h>\n#include <linux/aio.h>\n#include <linux/uprobes.h>\n#include <linux/signalfd.h>\n#include <linux/khugepaged.h>\n#include <linux/oom.h>\n#include <linux/user-return-notifier.h>\n#include <linux/posix-timers.h>\n#include <linux/perf_event.h>\n#include <linux/magic.h>\n#include <linux/fs_struct.h>\n#include <linux/tty.h>\n#include <linux/random.h>\n#include <linux/taskstats_kern.h>\n#include <linux/delayacct.h>\n#include <linux/freezer.h>\n#include <linux/cn_proc.h>\n#include <linux/tsacct_kern.h>\n#include <linux/userfaultfd_k.h>\n#include <linux/acct.h>\n#include <linux/ksm.h>\n#include <linux/rmap.h>\n#include <linux/profile.h>\n#include <linux/proc_fs.h>\n#include <linux/ftrace.h>\n#include <linux/memcontrol.h>\n#include <linux/audit.h>\n#include <linux/mount.h>\n#include <linux/ptrace.h>\n#include <linux/rcupdate.h>\n#include <linux/task_io_accounting_ops.h>\n#include <linux/kthread.h>\n#include <linux/compat.h>\n#include <linux/futex.h>\n#include <linux/jiffies.h>\n#include <linux/syscalls.h>\n#include <linux/swap.h>\n#include <linux/seccomp.h>\n#include <linux/hugetlb.h>\n#include <linux/security.h>\n#include <linux/cgroup.h>\n#include <linux/cpu.h>\n#include <linux/capability.h>\n#include <linux/nsproxy.h>\n#include <linux/vmacache.h>\n#include <linux/mm_inline.h>\n#include <linux/mm.h>\n#include <linux/fs.h>\n#include <linux/mmu_notifier.h>\n#include <linux/mman.h>\n#include <linux/binfmts.h>\n#include <linux/key.h>\n#include <linux/iocontext.h>\n#include <linux/fdtable.h>\n#include <linux/file.h>\n#include <linux/sem.h>\n#include <linux/mempolicy.h>\n#include <linux/personality.h>\n#include <linux/completion.h>\n#include <linux/vmalloc.h>\n#include <linux/module.h>\n#include <linux/unistd.h>\n#include <linux/init.h>\n#include <linux/rtmutex.h>\n#include <linux/seq_file.h>\n#include <linux/sched/cputime.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/task.h>\n#include <linux/sched/stat.h>\n#include <linux/sched/numa_balancing.h>\n#include <linux/sched/user.h>\n#include <linux/sched/coredump.h>\n#include <linux/sched/mm.h>\n#include <linux/sched/autogroup.h>\n#include <linux/slab.h>\n#include <linux/anon_inodes.h>\n\nstatic __latent_entropy struct;\n\nstatic void rt_mutex_init_task(struct task_struct *p)\n{\n\traw_spin_lock_init(&p->pi_lock);\n#ifdef CONFIG_RT_MUTEXES\n\tp->pi_waiters = RB_ROOT_CACHED;\n\tp->pi_top_task = NULL;\n\tp->pi_blocked_on = NULL;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "ratelimit_set_flags",
          "args": [
            "&user->rs",
            "RATELIMIT_MSG_ON_RELEASE"
          ],
          "line": 855
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ratelimit_default_init",
          "args": [
            "&user->rs"
          ],
          "line": 854
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kvmalloc",
          "args": [
            "sizeof(struct devkmsg_user)",
            "GFP_KERNEL"
          ],
          "line": 850
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "check_syslog_permissions",
          "args": [
            "SYSLOG_ACTION_READ_ALL",
            "SYSLOG_FROM_READER"
          ],
          "line": 844
        },
        "resolved": true,
        "details": {
          "function_name": "check_syslog_permissions",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "516-543",
          "snippet": "static int check_syslog_permissions(int type, int source)\n{\n\t/*\n\t * If this is from /proc/kmsg and we've already opened it, then we've\n\t * already done the capabilities checks at open time.\n\t */\n\tif (source == SYSLOG_FROM_PROC && type != SYSLOG_ACTION_OPEN)\n\t\tgoto ok;\n\n\tif (syslog_action_restricted(type)) {\n\t\tif (capable(CAP_SYSLOG))\n\t\t\tgoto ok;\n\t\t/*\n\t\t * For historical reasons, accept CAP_SYS_ADMIN too, with\n\t\t * a warning.\n\t\t */\n\t\tif (capable(CAP_SYS_ADMIN)) {\n\t\t\tpr_warn_once(\"%s (%d): Attempt to access syslog with \"\n\t\t\t\t     \"CAP_SYS_ADMIN but no CAP_SYSLOG \"\n\t\t\t\t     \"(deprecated).\\n\",\n\t\t\t\t current->comm, task_pid_nr(current));\n\t\t\tgoto ok;\n\t\t}\n\t\treturn -EPERM;\n\t}\nok:\n\treturn security_syslog(type);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic int check_syslog_permissions(int type, int source)\n{\n\t/*\n\t * If this is from /proc/kmsg and we've already opened it, then we've\n\t * already done the capabilities checks at open time.\n\t */\n\tif (source == SYSLOG_FROM_PROC && type != SYSLOG_ACTION_OPEN)\n\t\tgoto ok;\n\n\tif (syslog_action_restricted(type)) {\n\t\tif (capable(CAP_SYSLOG))\n\t\t\tgoto ok;\n\t\t/*\n\t\t * For historical reasons, accept CAP_SYS_ADMIN too, with\n\t\t * a warning.\n\t\t */\n\t\tif (capable(CAP_SYS_ADMIN)) {\n\t\t\tpr_warn_once(\"%s (%d): Attempt to access syslog with \"\n\t\t\t\t     \"CAP_SYS_ADMIN but no CAP_SYSLOG \"\n\t\t\t\t     \"(deprecated).\\n\",\n\t\t\t\t current->comm, task_pid_nr(current));\n\t\t\tgoto ok;\n\t\t}\n\t\treturn -EPERM;\n\t}\nok:\n\treturn security_syslog(type);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic int devkmsg_open(struct inode *inode, struct file *file)\n{\n\tstruct devkmsg_user *user;\n\tint err;\n\n\tif (devkmsg_log & DEVKMSG_LOG_MASK_OFF)\n\t\treturn -EPERM;\n\n\t/* write-only does not need any file context */\n\tif ((file->f_flags & O_ACCMODE) != O_WRONLY) {\n\t\terr = check_syslog_permissions(SYSLOG_ACTION_READ_ALL,\n\t\t\t\t\t       SYSLOG_FROM_READER);\n\t\tif (err)\n\t\t\treturn err;\n\t}\n\n\tuser = kvmalloc(sizeof(struct devkmsg_user), GFP_KERNEL);\n\tif (!user)\n\t\treturn -ENOMEM;\n\n\tratelimit_default_init(&user->rs);\n\tratelimit_set_flags(&user->rs, RATELIMIT_MSG_ON_RELEASE);\n\n\tmutex_init(&user->lock);\n\n\tprb_rec_init_rd(&user->record, &user->info,\n\t\t\t&user->text_buf[0], sizeof(user->text_buf));\n\n\tatomic64_set(&user->seq, prb_first_valid_seq(prb));\n\n\tfile->private_data = user;\n\treturn 0;\n}"
  },
  {
    "function_name": "devkmsg_poll",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "812-832",
    "snippet": "static __poll_t devkmsg_poll(struct file *file, poll_table *wait)\n{\n\tstruct devkmsg_user *user = file->private_data;\n\tstruct printk_info info;\n\t__poll_t ret = 0;\n\n\tif (!user)\n\t\treturn EPOLLERR|EPOLLNVAL;\n\n\tpoll_wait(file, &log_wait, wait);\n\n\tif (prb_read_valid_info(prb, atomic64_read(&user->seq), &info, NULL)) {\n\t\t/* return error when data has vanished underneath us */\n\t\tif (info.seq != atomic64_read(&user->seq))\n\t\t\tret = EPOLLIN|EPOLLRDNORM|EPOLLERR|EPOLLPRI;\n\t\telse\n\t\t\tret = EPOLLIN|EPOLLRDNORM;\n\t}\n\n\treturn ret;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic64_read",
          "args": [
            "&user->seq"
          ],
          "line": 825
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prb_read_valid_info",
          "args": [
            "prb",
            "atomic64_read(&user->seq)",
            "&info",
            "NULL"
          ],
          "line": 823
        },
        "resolved": true,
        "details": {
          "function_name": "prb_read_valid_info",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk_ringbuffer.c",
          "lines": "1956-1964",
          "snippet": "bool prb_read_valid_info(struct printk_ringbuffer *rb, u64 seq,\n\t\t\t struct printk_info *info, unsigned int *line_count)\n{\n\tstruct printk_record r;\n\n\tprb_rec_init_rd(&r, info, NULL, 0);\n\n\treturn _prb_read_valid(rb, &seq, &r, line_count);\n}",
          "includes": [
            "#include \"printk_ringbuffer.h\"",
            "#include <linux/bug.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/irqflags.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"printk_ringbuffer.h\"\n#include <linux/bug.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/irqflags.h>\n#include <linux/kernel.h>\n\nbool prb_read_valid_info(struct printk_ringbuffer *rb, u64 seq,\n\t\t\t struct printk_info *info, unsigned int *line_count)\n{\n\tstruct printk_record r;\n\n\tprb_rec_init_rd(&r, info, NULL, 0);\n\n\treturn _prb_read_valid(rb, &seq, &r, line_count);\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic64_read",
          "args": [
            "&user->seq"
          ],
          "line": 823
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "poll_wait",
          "args": [
            "file",
            "&log_wait",
            "wait"
          ],
          "line": 821
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic __poll_t devkmsg_poll(struct file *file, poll_table *wait)\n{\n\tstruct devkmsg_user *user = file->private_data;\n\tstruct printk_info info;\n\t__poll_t ret = 0;\n\n\tif (!user)\n\t\treturn EPOLLERR|EPOLLNVAL;\n\n\tpoll_wait(file, &log_wait, wait);\n\n\tif (prb_read_valid_info(prb, atomic64_read(&user->seq), &info, NULL)) {\n\t\t/* return error when data has vanished underneath us */\n\t\tif (info.seq != atomic64_read(&user->seq))\n\t\t\tret = EPOLLIN|EPOLLRDNORM|EPOLLERR|EPOLLPRI;\n\t\telse\n\t\t\tret = EPOLLIN|EPOLLRDNORM;\n\t}\n\n\treturn ret;\n}"
  },
  {
    "function_name": "devkmsg_llseek",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "779-810",
    "snippet": "static loff_t devkmsg_llseek(struct file *file, loff_t offset, int whence)\n{\n\tstruct devkmsg_user *user = file->private_data;\n\tloff_t ret = 0;\n\n\tif (!user)\n\t\treturn -EBADF;\n\tif (offset)\n\t\treturn -ESPIPE;\n\n\tswitch (whence) {\n\tcase SEEK_SET:\n\t\t/* the first record */\n\t\tatomic64_set(&user->seq, prb_first_valid_seq(prb));\n\t\tbreak;\n\tcase SEEK_DATA:\n\t\t/*\n\t\t * The first record after the last SYSLOG_ACTION_CLEAR,\n\t\t * like issued by 'dmesg -c'. Reading /dev/kmsg itself\n\t\t * changes no global state, and does not clear anything.\n\t\t */\n\t\tatomic64_set(&user->seq, latched_seq_read_nolock(&clear_seq));\n\t\tbreak;\n\tcase SEEK_END:\n\t\t/* after the last record */\n\t\tatomic64_set(&user->seq, prb_next_seq(prb));\n\t\tbreak;\n\tdefault:\n\t\tret = -EINVAL;\n\t}\n\treturn ret;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "atomic64_set",
          "args": [
            "&user->seq",
            "prb_next_seq(prb)"
          ],
          "line": 804
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prb_next_seq",
          "args": [
            "prb"
          ],
          "line": 804
        },
        "resolved": true,
        "details": {
          "function_name": "prb_next_seq",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk_ringbuffer.c",
          "lines": "2006-2015",
          "snippet": "u64 prb_next_seq(struct printk_ringbuffer *rb)\n{\n\tu64 seq = 0;\n\n\t/* Search forward from the oldest descriptor. */\n\twhile (_prb_read_valid(rb, &seq, NULL, NULL))\n\t\tseq++;\n\n\treturn seq;\n}",
          "includes": [
            "#include \"printk_ringbuffer.h\"",
            "#include <linux/bug.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/irqflags.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"printk_ringbuffer.h\"\n#include <linux/bug.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/irqflags.h>\n#include <linux/kernel.h>\n\nu64 prb_next_seq(struct printk_ringbuffer *rb)\n{\n\tu64 seq = 0;\n\n\t/* Search forward from the oldest descriptor. */\n\twhile (_prb_read_valid(rb, &seq, NULL, NULL))\n\t\tseq++;\n\n\treturn seq;\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic64_set",
          "args": [
            "&user->seq",
            "latched_seq_read_nolock(&clear_seq)"
          ],
          "line": 800
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "latched_seq_read_nolock",
          "args": [
            "&clear_seq"
          ],
          "line": 800
        },
        "resolved": true,
        "details": {
          "function_name": "latched_seq_read_nolock",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "448-461",
          "snippet": "static u64 latched_seq_read_nolock(struct latched_seq *ls)\n{\n\tunsigned int seq;\n\tunsigned int idx;\n\tu64 val;\n\n\tdo {\n\t\tseq = raw_read_seqcount_latch(&ls->latch);\n\t\tidx = seq & 0x1;\n\t\tval = ls->val[idx];\n\t} while (read_seqcount_latch_retry(&ls->latch, seq));\n\n\treturn val;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic u64 latched_seq_read_nolock(struct latched_seq *ls)\n{\n\tunsigned int seq;\n\tunsigned int idx;\n\tu64 val;\n\n\tdo {\n\t\tseq = raw_read_seqcount_latch(&ls->latch);\n\t\tidx = seq & 0x1;\n\t\tval = ls->val[idx];\n\t} while (read_seqcount_latch_retry(&ls->latch, seq));\n\n\treturn val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic64_set",
          "args": [
            "&user->seq",
            "prb_first_valid_seq(prb)"
          ],
          "line": 792
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prb_first_valid_seq",
          "args": [
            "prb"
          ],
          "line": 792
        },
        "resolved": true,
        "details": {
          "function_name": "prb_first_valid_seq",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk_ringbuffer.c",
          "lines": "1981-1989",
          "snippet": "u64 prb_first_valid_seq(struct printk_ringbuffer *rb)\n{\n\tu64 seq = 0;\n\n\tif (!_prb_read_valid(rb, &seq, NULL, NULL))\n\t\treturn 0;\n\n\treturn seq;\n}",
          "includes": [
            "#include \"printk_ringbuffer.h\"",
            "#include <linux/bug.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/irqflags.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"printk_ringbuffer.h\"\n#include <linux/bug.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/irqflags.h>\n#include <linux/kernel.h>\n\nu64 prb_first_valid_seq(struct printk_ringbuffer *rb)\n{\n\tu64 seq = 0;\n\n\tif (!_prb_read_valid(rb, &seq, NULL, NULL))\n\t\treturn 0;\n\n\treturn seq;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic loff_t devkmsg_llseek(struct file *file, loff_t offset, int whence)\n{\n\tstruct devkmsg_user *user = file->private_data;\n\tloff_t ret = 0;\n\n\tif (!user)\n\t\treturn -EBADF;\n\tif (offset)\n\t\treturn -ESPIPE;\n\n\tswitch (whence) {\n\tcase SEEK_SET:\n\t\t/* the first record */\n\t\tatomic64_set(&user->seq, prb_first_valid_seq(prb));\n\t\tbreak;\n\tcase SEEK_DATA:\n\t\t/*\n\t\t * The first record after the last SYSLOG_ACTION_CLEAR,\n\t\t * like issued by 'dmesg -c'. Reading /dev/kmsg itself\n\t\t * changes no global state, and does not clear anything.\n\t\t */\n\t\tatomic64_set(&user->seq, latched_seq_read_nolock(&clear_seq));\n\t\tbreak;\n\tcase SEEK_END:\n\t\t/* after the last record */\n\t\tatomic64_set(&user->seq, prb_next_seq(prb));\n\t\tbreak;\n\tdefault:\n\t\tret = -EINVAL;\n\t}\n\treturn ret;\n}"
  },
  {
    "function_name": "devkmsg_read",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "715-769",
    "snippet": "static ssize_t devkmsg_read(struct file *file, char __user *buf,\n\t\t\t    size_t count, loff_t *ppos)\n{\n\tstruct devkmsg_user *user = file->private_data;\n\tstruct printk_record *r = &user->record;\n\tsize_t len;\n\tssize_t ret;\n\n\tif (!user)\n\t\treturn -EBADF;\n\n\tret = mutex_lock_interruptible(&user->lock);\n\tif (ret)\n\t\treturn ret;\n\n\tif (!prb_read_valid(prb, atomic64_read(&user->seq), r)) {\n\t\tif (file->f_flags & O_NONBLOCK) {\n\t\t\tret = -EAGAIN;\n\t\t\tgoto out;\n\t\t}\n\n\t\tret = wait_event_interruptible(log_wait,\n\t\t\t\tprb_read_valid(prb, atomic64_read(&user->seq), r));\n\t\tif (ret)\n\t\t\tgoto out;\n\t}\n\n\tif (r->info->seq != atomic64_read(&user->seq)) {\n\t\t/* our last seen message is gone, return error and reset */\n\t\tatomic64_set(&user->seq, r->info->seq);\n\t\tret = -EPIPE;\n\t\tgoto out;\n\t}\n\n\tlen = info_print_ext_header(user->buf, sizeof(user->buf), r->info);\n\tlen += msg_print_ext_body(user->buf + len, sizeof(user->buf) - len,\n\t\t\t\t  &r->text_buf[0], r->info->text_len,\n\t\t\t\t  &r->info->dev_info);\n\n\tatomic64_set(&user->seq, r->info->seq + 1);\n\n\tif (len > count) {\n\t\tret = -EINVAL;\n\t\tgoto out;\n\t}\n\n\tif (copy_to_user(buf, user->buf, len)) {\n\t\tret = -EFAULT;\n\t\tgoto out;\n\t}\n\tret = len;\nout:\n\tmutex_unlock(&user->lock);\n\treturn ret;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&user->lock"
          ],
          "line": 767
        },
        "resolved": true,
        "details": {
          "function_name": "__rt_mutex_unlock",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/rtmutex.c",
          "lines": "1350-1356",
          "snippet": "static __always_inline void __rt_mutex_unlock(struct rt_mutex_base *lock)\n{\n\tif (likely(rt_mutex_cmpxchg_release(lock, current, NULL)))\n\t\treturn;\n\n\trt_mutex_slowunlock(lock);\n}",
          "includes": [
            "# include \"ww_mutex.h\"",
            "#include \"rtmutex_common.h\"",
            "#include <linux/ww_mutex.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "# include \"ww_mutex.h\"\n#include \"rtmutex_common.h\"\n#include <linux/ww_mutex.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n\nstatic __always_inline struct;\n\nstatic __always_inline void __rt_mutex_unlock(struct rt_mutex_base *lock)\n{\n\tif (likely(rt_mutex_cmpxchg_release(lock, current, NULL)))\n\t\treturn;\n\n\trt_mutex_slowunlock(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "copy_to_user",
          "args": [
            "buf",
            "user->buf",
            "len"
          ],
          "line": 761
        },
        "resolved": true,
        "details": {
          "function_name": "sched_attr_copy_to_user",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/core.c",
          "lines": "7847-7876",
          "snippet": "static int\nsched_attr_copy_to_user(struct sched_attr __user *uattr,\n\t\t\tstruct sched_attr *kattr,\n\t\t\tunsigned int usize)\n{\n\tunsigned int ksize = sizeof(*kattr);\n\n\tif (!access_ok(uattr, usize))\n\t\treturn -EFAULT;\n\n\t/*\n\t * sched_getattr() ABI forwards and backwards compatibility:\n\t *\n\t * If usize == ksize then we just copy everything to user-space and all is good.\n\t *\n\t * If usize < ksize then we only copy as much as user-space has space for,\n\t * this keeps ABI compatibility as well. We skip the rest.\n\t *\n\t * If usize > ksize then user-space is using a newer version of the ABI,\n\t * which part the kernel doesn't know about. Just ignore it - tooling can\n\t * detect the kernel's knowledge of attributes from the attr->size value\n\t * which is set to ksize in this case.\n\t */\n\tkattr->size = min(usize, ksize);\n\n\tif (copy_to_user(uattr, kattr, kattr->size))\n\t\treturn -EFAULT;\n\n\treturn 0;\n}",
          "includes": [
            "#include <linux/entry-common.h>",
            "#include \"features.h\"",
            "#include \"smp.h\"",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../../fs/io-wq.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/scs.h>",
            "#include <linux/kcov.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\"",
            "#include <trace/events/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/entry-common.h>\n#include \"features.h\"\n#include \"smp.h\"\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../../fs/io-wq.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/scs.h>\n#include <linux/kcov.h>\n#include <linux/blkdev.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n#include <trace/events/sched.h>\n\nstatic __always_inline struct;\n\nstatic int\nsched_attr_copy_to_user(struct sched_attr __user *uattr,\n\t\t\tstruct sched_attr *kattr,\n\t\t\tunsigned int usize)\n{\n\tunsigned int ksize = sizeof(*kattr);\n\n\tif (!access_ok(uattr, usize))\n\t\treturn -EFAULT;\n\n\t/*\n\t * sched_getattr() ABI forwards and backwards compatibility:\n\t *\n\t * If usize == ksize then we just copy everything to user-space and all is good.\n\t *\n\t * If usize < ksize then we only copy as much as user-space has space for,\n\t * this keeps ABI compatibility as well. We skip the rest.\n\t *\n\t * If usize > ksize then user-space is using a newer version of the ABI,\n\t * which part the kernel doesn't know about. Just ignore it - tooling can\n\t * detect the kernel's knowledge of attributes from the attr->size value\n\t * which is set to ksize in this case.\n\t */\n\tkattr->size = min(usize, ksize);\n\n\tif (copy_to_user(uattr, kattr, kattr->size))\n\t\treturn -EFAULT;\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic64_set",
          "args": [
            "&user->seq",
            "r->info->seq + 1"
          ],
          "line": 754
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "msg_print_ext_body",
          "args": [
            "user->buf + len",
            "sizeof(user->buf) - len",
            "&r->text_buf[0]",
            "r->info->text_len",
            "&r->info->dev_info"
          ],
          "line": 750
        },
        "resolved": true,
        "details": {
          "function_name": "msg_print_ext_body",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2296-2298",
          "snippet": "static ssize_t msg_print_ext_body(char *buf, size_t size,\n\t\t\t\t  char *text, size_t text_len,\n\t\t\t\t  struct dev_printk_info *dev_info) { return 0; }",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic ssize_t msg_print_ext_body(char *buf, size_t size,\n\t\t\t\t  char *text, size_t text_len,\n\t\t\t\t  struct dev_printk_info *dev_info) { return 0; }"
        }
      },
      {
        "call_info": {
          "callee": "info_print_ext_header",
          "args": [
            "user->buf",
            "sizeof(user->buf)",
            "r->info"
          ],
          "line": 749
        },
        "resolved": true,
        "details": {
          "function_name": "info_print_ext_header",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "2291-2295",
          "snippet": "static ssize_t info_print_ext_header(char *buf, size_t size,\n\t\t\t\t     struct printk_info *info)\n{\n\treturn 0;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic ssize_t info_print_ext_header(char *buf, size_t size,\n\t\t\t\t     struct printk_info *info)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic64_set",
          "args": [
            "&user->seq",
            "r->info->seq"
          ],
          "line": 744
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic64_read",
          "args": [
            "&user->seq"
          ],
          "line": 742
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wait_event_interruptible",
          "args": [
            "log_wait",
            "prb_read_valid(prb, atomic64_read(&user->seq), r)"
          ],
          "line": 736
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "prb_read_valid",
          "args": [
            "prb",
            "atomic64_read(&user->seq)",
            "r"
          ],
          "line": 737
        },
        "resolved": true,
        "details": {
          "function_name": "prb_read_valid",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk_ringbuffer.c",
          "lines": "1926-1930",
          "snippet": "bool prb_read_valid(struct printk_ringbuffer *rb, u64 seq,\n\t\t    struct printk_record *r)\n{\n\treturn _prb_read_valid(rb, &seq, r, NULL);\n}",
          "includes": [
            "#include \"printk_ringbuffer.h\"",
            "#include <linux/bug.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/irqflags.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"printk_ringbuffer.h\"\n#include <linux/bug.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/irqflags.h>\n#include <linux/kernel.h>\n\nbool prb_read_valid(struct printk_ringbuffer *rb, u64 seq,\n\t\t    struct printk_record *r)\n{\n\treturn _prb_read_valid(rb, &seq, r, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "atomic64_read",
          "args": [
            "&user->seq"
          ],
          "line": 737
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atomic64_read",
          "args": [
            "&user->seq"
          ],
          "line": 730
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock_interruptible",
          "args": [
            "&user->lock"
          ],
          "line": 726
        },
        "resolved": true,
        "details": {
          "function_name": "mutex_lock_interruptible",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/rtmutex_api.c",
          "lines": "568-571",
          "snippet": "int __sched mutex_lock_interruptible(struct mutex *lock)\n{\n\treturn __mutex_lock_common(lock, TASK_INTERRUPTIBLE, 0, NULL, _RET_IP_);\n}",
          "includes": [
            "#include \"rtmutex.c\"",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex.c\"\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nint __sched mutex_lock_interruptible(struct mutex *lock)\n{\n\treturn __mutex_lock_common(lock, TASK_INTERRUPTIBLE, 0, NULL, _RET_IP_);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic ssize_t devkmsg_read(struct file *file, char __user *buf,\n\t\t\t    size_t count, loff_t *ppos)\n{\n\tstruct devkmsg_user *user = file->private_data;\n\tstruct printk_record *r = &user->record;\n\tsize_t len;\n\tssize_t ret;\n\n\tif (!user)\n\t\treturn -EBADF;\n\n\tret = mutex_lock_interruptible(&user->lock);\n\tif (ret)\n\t\treturn ret;\n\n\tif (!prb_read_valid(prb, atomic64_read(&user->seq), r)) {\n\t\tif (file->f_flags & O_NONBLOCK) {\n\t\t\tret = -EAGAIN;\n\t\t\tgoto out;\n\t\t}\n\n\t\tret = wait_event_interruptible(log_wait,\n\t\t\t\tprb_read_valid(prb, atomic64_read(&user->seq), r));\n\t\tif (ret)\n\t\t\tgoto out;\n\t}\n\n\tif (r->info->seq != atomic64_read(&user->seq)) {\n\t\t/* our last seen message is gone, return error and reset */\n\t\tatomic64_set(&user->seq, r->info->seq);\n\t\tret = -EPIPE;\n\t\tgoto out;\n\t}\n\n\tlen = info_print_ext_header(user->buf, sizeof(user->buf), r->info);\n\tlen += msg_print_ext_body(user->buf + len, sizeof(user->buf) - len,\n\t\t\t\t  &r->text_buf[0], r->info->text_len,\n\t\t\t\t  &r->info->dev_info);\n\n\tatomic64_set(&user->seq, r->info->seq + 1);\n\n\tif (len > count) {\n\t\tret = -EINVAL;\n\t\tgoto out;\n\t}\n\n\tif (copy_to_user(buf, user->buf, len)) {\n\t\tret = -EFAULT;\n\t\tgoto out;\n\t}\n\tret = len;\nout:\n\tmutex_unlock(&user->lock);\n\treturn ret;\n}"
  },
  {
    "function_name": "devkmsg_write",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "653-713",
    "snippet": "static ssize_t devkmsg_write(struct kiocb *iocb, struct iov_iter *from)\n{\n\tchar *buf, *line;\n\tint level = default_message_loglevel;\n\tint facility = 1;\t/* LOG_USER */\n\tstruct file *file = iocb->ki_filp;\n\tstruct devkmsg_user *user = file->private_data;\n\tsize_t len = iov_iter_count(from);\n\tssize_t ret = len;\n\n\tif (!user || len > LOG_LINE_MAX)\n\t\treturn -EINVAL;\n\n\t/* Ignore when user logging is disabled. */\n\tif (devkmsg_log & DEVKMSG_LOG_MASK_OFF)\n\t\treturn len;\n\n\t/* Ratelimit when not explicitly enabled. */\n\tif (!(devkmsg_log & DEVKMSG_LOG_MASK_ON)) {\n\t\tif (!___ratelimit(&user->rs, current->comm))\n\t\t\treturn ret;\n\t}\n\n\tbuf = kmalloc(len+1, GFP_KERNEL);\n\tif (buf == NULL)\n\t\treturn -ENOMEM;\n\n\tbuf[len] = '\\0';\n\tif (!copy_from_iter_full(buf, len, from)) {\n\t\tkfree(buf);\n\t\treturn -EFAULT;\n\t}\n\n\t/*\n\t * Extract and skip the syslog prefix <[0-9]*>. Coming from userspace\n\t * the decimal value represents 32bit, the lower 3 bit are the log\n\t * level, the rest are the log facility.\n\t *\n\t * If no prefix or no userspace facility is specified, we\n\t * enforce LOG_USER, to be able to reliably distinguish\n\t * kernel-generated messages from userspace-injected ones.\n\t */\n\tline = buf;\n\tif (line[0] == '<') {\n\t\tchar *endp = NULL;\n\t\tunsigned int u;\n\n\t\tu = simple_strtoul(line + 1, &endp, 10);\n\t\tif (endp && endp[0] == '>') {\n\t\t\tlevel = LOG_LEVEL(u);\n\t\t\tif (LOG_FACILITY(u) != 0)\n\t\t\t\tfacility = LOG_FACILITY(u);\n\t\t\tendp++;\n\t\t\tline = endp;\n\t\t}\n\t}\n\n\tdevkmsg_emit(facility, level, \"%s\", line);\n\tkfree(buf);\n\treturn ret;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define LOG_LINE_MAX\t\t(CONSOLE_LOG_MAX - PREFIX_MAX)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "buf"
          ],
          "line": 711
        },
        "resolved": true,
        "details": {
          "function_name": "maybe_kfree_parameter",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/params.c",
          "lines": "62-75",
          "snippet": "static void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}",
          "includes": [
            "#include <linux/security.h>",
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(kmalloced_params);",
            "static DEFINE_SPINLOCK(kmalloced_params_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/security.h>\n#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(kmalloced_params);\nstatic DEFINE_SPINLOCK(kmalloced_params_lock);\n\nstatic void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "devkmsg_emit",
          "args": [
            "facility",
            "level",
            "\"%s\"",
            "line"
          ],
          "line": 710
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOG_FACILITY",
          "args": [
            "u"
          ],
          "line": 704
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOG_FACILITY",
          "args": [
            "u"
          ],
          "line": 703
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOG_LEVEL",
          "args": [
            "u"
          ],
          "line": 702
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "simple_strtoul",
          "args": [
            "line + 1",
            "&endp",
            "10"
          ],
          "line": 700
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "copy_from_iter_full",
          "args": [
            "buf",
            "len",
            "from"
          ],
          "line": 681
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmalloc",
          "args": [
            "len+1",
            "GFP_KERNEL"
          ],
          "line": 676
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "___ratelimit",
          "args": [
            "&user->rs",
            "current->comm"
          ],
          "line": 672
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iov_iter_count",
          "args": [
            "from"
          ],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define LOG_LINE_MAX\t\t(CONSOLE_LOG_MAX - PREFIX_MAX)\n\nstatic ssize_t devkmsg_write(struct kiocb *iocb, struct iov_iter *from)\n{\n\tchar *buf, *line;\n\tint level = default_message_loglevel;\n\tint facility = 1;\t/* LOG_USER */\n\tstruct file *file = iocb->ki_filp;\n\tstruct devkmsg_user *user = file->private_data;\n\tsize_t len = iov_iter_count(from);\n\tssize_t ret = len;\n\n\tif (!user || len > LOG_LINE_MAX)\n\t\treturn -EINVAL;\n\n\t/* Ignore when user logging is disabled. */\n\tif (devkmsg_log & DEVKMSG_LOG_MASK_OFF)\n\t\treturn len;\n\n\t/* Ratelimit when not explicitly enabled. */\n\tif (!(devkmsg_log & DEVKMSG_LOG_MASK_ON)) {\n\t\tif (!___ratelimit(&user->rs, current->comm))\n\t\t\treturn ret;\n\t}\n\n\tbuf = kmalloc(len+1, GFP_KERNEL);\n\tif (buf == NULL)\n\t\treturn -ENOMEM;\n\n\tbuf[len] = '\\0';\n\tif (!copy_from_iter_full(buf, len, from)) {\n\t\tkfree(buf);\n\t\treturn -EFAULT;\n\t}\n\n\t/*\n\t * Extract and skip the syslog prefix <[0-9]*>. Coming from userspace\n\t * the decimal value represents 32bit, the lower 3 bit are the log\n\t * level, the rest are the log facility.\n\t *\n\t * If no prefix or no userspace facility is specified, we\n\t * enforce LOG_USER, to be able to reliably distinguish\n\t * kernel-generated messages from userspace-injected ones.\n\t */\n\tline = buf;\n\tif (line[0] == '<') {\n\t\tchar *endp = NULL;\n\t\tunsigned int u;\n\n\t\tu = simple_strtoul(line + 1, &endp, 10);\n\t\tif (endp && endp[0] == '>') {\n\t\t\tlevel = LOG_LEVEL(u);\n\t\t\tif (LOG_FACILITY(u) != 0)\n\t\t\t\tfacility = LOG_FACILITY(u);\n\t\t\tendp++;\n\t\t\tline = endp;\n\t\t}\n\t}\n\n\tdevkmsg_emit(facility, level, \"%s\", line);\n\tkfree(buf);\n\treturn ret;\n}"
  },
  {
    "function_name": "msg_print_ext_body",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "609-626",
    "snippet": "static ssize_t msg_print_ext_body(char *buf, size_t size,\n\t\t\t\t  char *text, size_t text_len,\n\t\t\t\t  struct dev_printk_info *dev_info)\n{\n\tssize_t len;\n\n\tlen = msg_add_ext_text(buf, size, text, text_len, '\\n');\n\n\tif (!dev_info)\n\t\tgoto out;\n\n\tlen += msg_add_dict_text(buf + len, size - len, \"SUBSYSTEM\",\n\t\t\t\t dev_info->subsystem);\n\tlen += msg_add_dict_text(buf + len, size - len, \"DEVICE\",\n\t\t\t\t dev_info->device);\nout:\n\treturn len;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "msg_add_dict_text",
          "args": [
            "buf + len",
            "size - len",
            "\"DEVICE\"",
            "dev_info->device"
          ],
          "line": 622
        },
        "resolved": true,
        "details": {
          "function_name": "msg_add_dict_text",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "593-607",
          "snippet": "static ssize_t msg_add_dict_text(char *buf, size_t size,\n\t\t\t\t const char *key, const char *val)\n{\n\tsize_t val_len = strlen(val);\n\tssize_t len;\n\n\tif (!val_len)\n\t\treturn 0;\n\n\tlen = msg_add_ext_text(buf, size, \"\", 0, ' ');\t/* dict prefix */\n\tlen += msg_add_ext_text(buf + len, size - len, key, strlen(key), '=');\n\tlen += msg_add_ext_text(buf + len, size - len, val, val_len, '\\n');\n\n\treturn len;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic ssize_t msg_add_dict_text(char *buf, size_t size,\n\t\t\t\t const char *key, const char *val)\n{\n\tsize_t val_len = strlen(val);\n\tssize_t len;\n\n\tif (!val_len)\n\t\treturn 0;\n\n\tlen = msg_add_ext_text(buf, size, \"\", 0, ' ');\t/* dict prefix */\n\tlen += msg_add_ext_text(buf + len, size - len, key, strlen(key), '=');\n\tlen += msg_add_ext_text(buf + len, size - len, val, val_len, '\\n');\n\n\treturn len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "msg_add_ext_text",
          "args": [
            "buf",
            "size",
            "text",
            "text_len",
            "'\\n'"
          ],
          "line": 615
        },
        "resolved": true,
        "details": {
          "function_name": "msg_add_ext_text",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "572-591",
          "snippet": "static ssize_t msg_add_ext_text(char *buf, size_t size,\n\t\t\t\tconst char *text, size_t text_len,\n\t\t\t\tunsigned char endc)\n{\n\tchar *p = buf, *e = buf + size;\n\tsize_t i;\n\n\t/* escape non-printable characters */\n\tfor (i = 0; i < text_len; i++) {\n\t\tunsigned char c = text[i];\n\n\t\tif (c < ' ' || c >= 127 || c == '\\\\')\n\t\t\tp += scnprintf(p, e - p, \"\\\\x%02x\", c);\n\t\telse\n\t\t\tappend_char(&p, e, c);\n\t}\n\tappend_char(&p, e, endc);\n\n\treturn p - buf;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic ssize_t msg_add_ext_text(char *buf, size_t size,\n\t\t\t\tconst char *text, size_t text_len,\n\t\t\t\tunsigned char endc)\n{\n\tchar *p = buf, *e = buf + size;\n\tsize_t i;\n\n\t/* escape non-printable characters */\n\tfor (i = 0; i < text_len; i++) {\n\t\tunsigned char c = text[i];\n\n\t\tif (c < ' ' || c >= 127 || c == '\\\\')\n\t\t\tp += scnprintf(p, e - p, \"\\\\x%02x\", c);\n\t\telse\n\t\t\tappend_char(&p, e, c);\n\t}\n\tappend_char(&p, e, endc);\n\n\treturn p - buf;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic ssize_t msg_print_ext_body(char *buf, size_t size,\n\t\t\t\t  char *text, size_t text_len,\n\t\t\t\t  struct dev_printk_info *dev_info)\n{\n\tssize_t len;\n\n\tlen = msg_add_ext_text(buf, size, text, text_len, '\\n');\n\n\tif (!dev_info)\n\t\tgoto out;\n\n\tlen += msg_add_dict_text(buf + len, size - len, \"SUBSYSTEM\",\n\t\t\t\t dev_info->subsystem);\n\tlen += msg_add_dict_text(buf + len, size - len, \"DEVICE\",\n\t\t\t\t dev_info->device);\nout:\n\treturn len;\n}"
  },
  {
    "function_name": "msg_add_dict_text",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "593-607",
    "snippet": "static ssize_t msg_add_dict_text(char *buf, size_t size,\n\t\t\t\t const char *key, const char *val)\n{\n\tsize_t val_len = strlen(val);\n\tssize_t len;\n\n\tif (!val_len)\n\t\treturn 0;\n\n\tlen = msg_add_ext_text(buf, size, \"\", 0, ' ');\t/* dict prefix */\n\tlen += msg_add_ext_text(buf + len, size - len, key, strlen(key), '=');\n\tlen += msg_add_ext_text(buf + len, size - len, val, val_len, '\\n');\n\n\treturn len;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "msg_add_ext_text",
          "args": [
            "buf + len",
            "size - len",
            "val",
            "val_len",
            "'\\n'"
          ],
          "line": 604
        },
        "resolved": true,
        "details": {
          "function_name": "msg_add_ext_text",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "572-591",
          "snippet": "static ssize_t msg_add_ext_text(char *buf, size_t size,\n\t\t\t\tconst char *text, size_t text_len,\n\t\t\t\tunsigned char endc)\n{\n\tchar *p = buf, *e = buf + size;\n\tsize_t i;\n\n\t/* escape non-printable characters */\n\tfor (i = 0; i < text_len; i++) {\n\t\tunsigned char c = text[i];\n\n\t\tif (c < ' ' || c >= 127 || c == '\\\\')\n\t\t\tp += scnprintf(p, e - p, \"\\\\x%02x\", c);\n\t\telse\n\t\t\tappend_char(&p, e, c);\n\t}\n\tappend_char(&p, e, endc);\n\n\treturn p - buf;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic ssize_t msg_add_ext_text(char *buf, size_t size,\n\t\t\t\tconst char *text, size_t text_len,\n\t\t\t\tunsigned char endc)\n{\n\tchar *p = buf, *e = buf + size;\n\tsize_t i;\n\n\t/* escape non-printable characters */\n\tfor (i = 0; i < text_len; i++) {\n\t\tunsigned char c = text[i];\n\n\t\tif (c < ' ' || c >= 127 || c == '\\\\')\n\t\t\tp += scnprintf(p, e - p, \"\\\\x%02x\", c);\n\t\telse\n\t\t\tappend_char(&p, e, c);\n\t}\n\tappend_char(&p, e, endc);\n\n\treturn p - buf;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "key"
          ],
          "line": 603
        },
        "resolved": true,
        "details": {
          "function_name": "fetch_store_strlen",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/trace/trace_eprobe.c",
          "lines": "384-401",
          "snippet": "static nokprobe_inline int\nfetch_store_strlen(unsigned long addr)\n{\n\tint ret, len = 0;\n\tu8 c;\n\n#ifdef CONFIG_ARCH_HAS_NON_OVERLAPPING_ADDRESS_SPACE\n\tif (addr < TASK_SIZE)\n\t\treturn fetch_store_strlen_user(addr);\n#endif\n\n\tdo {\n\t\tret = copy_from_kernel_nofault(&c, (u8 *)addr + len, 1);\n\t\tlen++;\n\t} while (c && ret == 0 && len < MAX_STRING_SIZE);\n\n\treturn (ret < 0) ? ret : len;\n}",
          "includes": [
            "#include \"trace_probe_tmpl.h\"",
            "#include \"trace_probe.h\"",
            "#include \"trace_dynevent.h\"",
            "#include <linux/ftrace.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NOKPROBE_SYMBOL(process_fetch_insn)\n\n/* Return the length of string -- including null terminal byte */\nstatic nokprobe_inline"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_probe_tmpl.h\"\n#include \"trace_probe.h\"\n#include \"trace_dynevent.h\"\n#include <linux/ftrace.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n\nNOKPROBE_SYMBOL(process_fetch_insn)\n\n/* Return the length of string -- including null terminal byte */\nstatic nokprobe_inline;\n\nstatic nokprobe_inline int\nfetch_store_strlen(unsigned long addr)\n{\n\tint ret, len = 0;\n\tu8 c;\n\n#ifdef CONFIG_ARCH_HAS_NON_OVERLAPPING_ADDRESS_SPACE\n\tif (addr < TASK_SIZE)\n\t\treturn fetch_store_strlen_user(addr);\n#endif\n\n\tdo {\n\t\tret = copy_from_kernel_nofault(&c, (u8 *)addr + len, 1);\n\t\tlen++;\n\t} while (c && ret == 0 && len < MAX_STRING_SIZE);\n\n\treturn (ret < 0) ? ret : len;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic ssize_t msg_add_dict_text(char *buf, size_t size,\n\t\t\t\t const char *key, const char *val)\n{\n\tsize_t val_len = strlen(val);\n\tssize_t len;\n\n\tif (!val_len)\n\t\treturn 0;\n\n\tlen = msg_add_ext_text(buf, size, \"\", 0, ' ');\t/* dict prefix */\n\tlen += msg_add_ext_text(buf + len, size - len, key, strlen(key), '=');\n\tlen += msg_add_ext_text(buf + len, size - len, val, val_len, '\\n');\n\n\treturn len;\n}"
  },
  {
    "function_name": "msg_add_ext_text",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "572-591",
    "snippet": "static ssize_t msg_add_ext_text(char *buf, size_t size,\n\t\t\t\tconst char *text, size_t text_len,\n\t\t\t\tunsigned char endc)\n{\n\tchar *p = buf, *e = buf + size;\n\tsize_t i;\n\n\t/* escape non-printable characters */\n\tfor (i = 0; i < text_len; i++) {\n\t\tunsigned char c = text[i];\n\n\t\tif (c < ' ' || c >= 127 || c == '\\\\')\n\t\t\tp += scnprintf(p, e - p, \"\\\\x%02x\", c);\n\t\telse\n\t\t\tappend_char(&p, e, c);\n\t}\n\tappend_char(&p, e, endc);\n\n\treturn p - buf;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "append_char",
          "args": [
            "&p",
            "e",
            "endc"
          ],
          "line": 588
        },
        "resolved": true,
        "details": {
          "function_name": "append_char",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "545-549",
          "snippet": "static void append_char(char **pp, char *e, char c)\n{\n\tif (*pp < e)\n\t\t*(*pp)++ = c;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic void append_char(char **pp, char *e, char c)\n{\n\tif (*pp < e)\n\t\t*(*pp)++ = c;\n}"
        }
      },
      {
        "call_info": {
          "callee": "scnprintf",
          "args": [
            "p",
            "e - p",
            "\"\\\\x%02x\"",
            "c"
          ],
          "line": 584
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic ssize_t msg_add_ext_text(char *buf, size_t size,\n\t\t\t\tconst char *text, size_t text_len,\n\t\t\t\tunsigned char endc)\n{\n\tchar *p = buf, *e = buf + size;\n\tsize_t i;\n\n\t/* escape non-printable characters */\n\tfor (i = 0; i < text_len; i++) {\n\t\tunsigned char c = text[i];\n\n\t\tif (c < ' ' || c >= 127 || c == '\\\\')\n\t\t\tp += scnprintf(p, e - p, \"\\\\x%02x\", c);\n\t\telse\n\t\t\tappend_char(&p, e, c);\n\t}\n\tappend_char(&p, e, endc);\n\n\treturn p - buf;\n}"
  },
  {
    "function_name": "info_print_ext_header",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "551-570",
    "snippet": "static ssize_t info_print_ext_header(char *buf, size_t size,\n\t\t\t\t     struct printk_info *info)\n{\n\tu64 ts_usec = info->ts_nsec;\n\tchar caller[20];\n#ifdef CONFIG_PRINTK_CALLER\n\tu32 id = info->caller_id;\n\n\tsnprintf(caller, sizeof(caller), \",caller=%c%u\",\n\t\t id & 0x80000000 ? 'C' : 'T', id & ~0x80000000);\n#else\n\tcaller[0] = '\\0';\n#endif\n\n\tdo_div(ts_usec, 1000);\n\n\treturn scnprintf(buf, size, \"%u,%llu,%llu,%c%s;\",\n\t\t\t (info->facility << 3) | info->level, info->seq,\n\t\t\t ts_usec, info->flags & LOG_CONT ? 'c' : '-', caller);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "scnprintf",
          "args": [
            "buf",
            "size",
            "\"%u,%llu,%llu,%c%s;\"",
            "(info->facility << 3) | info->level",
            "info->seq",
            "ts_usec",
            "info->flags & LOG_CONT ? 'c' : '-'",
            "caller"
          ],
          "line": 567
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "do_div",
          "args": [
            "ts_usec",
            "1000"
          ],
          "line": 565
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "caller",
            "sizeof(caller)",
            "\",caller=%c%u\"",
            "id & 0x80000000 ? 'C' : 'T'",
            "id & ~0x80000000"
          ],
          "line": 559
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic ssize_t info_print_ext_header(char *buf, size_t size,\n\t\t\t\t     struct printk_info *info)\n{\n\tu64 ts_usec = info->ts_nsec;\n\tchar caller[20];\n#ifdef CONFIG_PRINTK_CALLER\n\tu32 id = info->caller_id;\n\n\tsnprintf(caller, sizeof(caller), \",caller=%c%u\",\n\t\t id & 0x80000000 ? 'C' : 'T', id & ~0x80000000);\n#else\n\tcaller[0] = '\\0';\n#endif\n\n\tdo_div(ts_usec, 1000);\n\n\treturn scnprintf(buf, size, \"%u,%llu,%llu,%c%s;\",\n\t\t\t (info->facility << 3) | info->level, info->seq,\n\t\t\t ts_usec, info->flags & LOG_CONT ? 'c' : '-', caller);\n}"
  },
  {
    "function_name": "append_char",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "545-549",
    "snippet": "static void append_char(char **pp, char *e, char c)\n{\n\tif (*pp < e)\n\t\t*(*pp)++ = c;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic void append_char(char **pp, char *e, char c)\n{\n\tif (*pp < e)\n\t\t*(*pp)++ = c;\n}"
  },
  {
    "function_name": "check_syslog_permissions",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "516-543",
    "snippet": "static int check_syslog_permissions(int type, int source)\n{\n\t/*\n\t * If this is from /proc/kmsg and we've already opened it, then we've\n\t * already done the capabilities checks at open time.\n\t */\n\tif (source == SYSLOG_FROM_PROC && type != SYSLOG_ACTION_OPEN)\n\t\tgoto ok;\n\n\tif (syslog_action_restricted(type)) {\n\t\tif (capable(CAP_SYSLOG))\n\t\t\tgoto ok;\n\t\t/*\n\t\t * For historical reasons, accept CAP_SYS_ADMIN too, with\n\t\t * a warning.\n\t\t */\n\t\tif (capable(CAP_SYS_ADMIN)) {\n\t\t\tpr_warn_once(\"%s (%d): Attempt to access syslog with \"\n\t\t\t\t     \"CAP_SYS_ADMIN but no CAP_SYSLOG \"\n\t\t\t\t     \"(deprecated).\\n\",\n\t\t\t\t current->comm, task_pid_nr(current));\n\t\t\tgoto ok;\n\t\t}\n\t\treturn -EPERM;\n\t}\nok:\n\treturn security_syslog(type);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "security_syslog",
          "args": [
            "type"
          ],
          "line": 542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pr_warn_once",
          "args": [
            "\"%s (%d): Attempt to access syslog with \"\n\t\t\t\t     \"CAP_SYS_ADMIN but no CAP_SYSLOG \"\n\t\t\t\t     \"(deprecated).\\n\"",
            "current->comm",
            "task_pid_nr(current)"
          ],
          "line": 533
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "task_pid_nr",
          "args": [
            "current"
          ],
          "line": 536
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "capable",
          "args": [
            "CAP_SYS_ADMIN"
          ],
          "line": 532
        },
        "resolved": true,
        "details": {
          "function_name": "capable",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/capability.c",
          "lines": "447-450",
          "snippet": "bool capable(int cap)\n{\n\treturn ns_capable(&init_user_ns, cap);\n}",
          "includes": [
            "#include <linux/uaccess.h>",
            "#include <linux/user_namespace.h>",
            "#include <linux/pid_namespace.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/security.h>",
            "#include <linux/export.h>",
            "#include <linux/mm.h>",
            "#include <linux/capability.h>",
            "#include <linux/audit.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/uaccess.h>\n#include <linux/user_namespace.h>\n#include <linux/pid_namespace.h>\n#include <linux/syscalls.h>\n#include <linux/security.h>\n#include <linux/export.h>\n#include <linux/mm.h>\n#include <linux/capability.h>\n#include <linux/audit.h>\n\nbool capable(int cap)\n{\n\treturn ns_capable(&init_user_ns, cap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "syslog_action_restricted",
          "args": [
            "type"
          ],
          "line": 525
        },
        "resolved": true,
        "details": {
          "function_name": "syslog_action_restricted",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "504-514",
          "snippet": "static int syslog_action_restricted(int type)\n{\n\tif (dmesg_restrict)\n\t\treturn 1;\n\t/*\n\t * Unless restricted, we allow \"read all\" and \"get buffer size\"\n\t * for everybody.\n\t */\n\treturn type != SYSLOG_ACTION_READ_ALL &&\n\t       type != SYSLOG_ACTION_SIZE_BUFFER;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic int syslog_action_restricted(int type)\n{\n\tif (dmesg_restrict)\n\t\treturn 1;\n\t/*\n\t * Unless restricted, we allow \"read all\" and \"get buffer size\"\n\t * for everybody.\n\t */\n\treturn type != SYSLOG_ACTION_READ_ALL &&\n\t       type != SYSLOG_ACTION_SIZE_BUFFER;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic int check_syslog_permissions(int type, int source)\n{\n\t/*\n\t * If this is from /proc/kmsg and we've already opened it, then we've\n\t * already done the capabilities checks at open time.\n\t */\n\tif (source == SYSLOG_FROM_PROC && type != SYSLOG_ACTION_OPEN)\n\t\tgoto ok;\n\n\tif (syslog_action_restricted(type)) {\n\t\tif (capable(CAP_SYSLOG))\n\t\t\tgoto ok;\n\t\t/*\n\t\t * For historical reasons, accept CAP_SYS_ADMIN too, with\n\t\t * a warning.\n\t\t */\n\t\tif (capable(CAP_SYS_ADMIN)) {\n\t\t\tpr_warn_once(\"%s (%d): Attempt to access syslog with \"\n\t\t\t\t     \"CAP_SYS_ADMIN but no CAP_SYSLOG \"\n\t\t\t\t     \"(deprecated).\\n\",\n\t\t\t\t current->comm, task_pid_nr(current));\n\t\t\tgoto ok;\n\t\t}\n\t\treturn -EPERM;\n\t}\nok:\n\treturn security_syslog(type);\n}"
  },
  {
    "function_name": "syslog_action_restricted",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "504-514",
    "snippet": "static int syslog_action_restricted(int type)\n{\n\tif (dmesg_restrict)\n\t\treturn 1;\n\t/*\n\t * Unless restricted, we allow \"read all\" and \"get buffer size\"\n\t * for everybody.\n\t */\n\treturn type != SYSLOG_ACTION_READ_ALL &&\n\t       type != SYSLOG_ACTION_SIZE_BUFFER;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic int syslog_action_restricted(int type)\n{\n\tif (dmesg_restrict)\n\t\treturn 1;\n\t/*\n\t * Unless restricted, we allow \"read all\" and \"get buffer size\"\n\t * for everybody.\n\t */\n\treturn type != SYSLOG_ACTION_READ_ALL &&\n\t       type != SYSLOG_ACTION_SIZE_BUFFER;\n}"
  },
  {
    "function_name": "truncate_msg",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "483-500",
    "snippet": "static void truncate_msg(u16 *text_len, u16 *trunc_msg_len)\n{\n\t/*\n\t * The message should not take the whole buffer. Otherwise, it might\n\t * get removed too soon.\n\t */\n\tu32 max_text_len = log_buf_len / MAX_LOG_TAKE_PART;\n\n\tif (*text_len > max_text_len)\n\t\t*text_len = max_text_len;\n\n\t/* enable the warning message (if there is room) */\n\t*trunc_msg_len = strlen(trunc_msg);\n\tif (*text_len >= *trunc_msg_len)\n\t\t*text_len -= *trunc_msg_len;\n\telse\n\t\t*trunc_msg_len = 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define MAX_LOG_TAKE_PART 4"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "trunc_msg"
          ],
          "line": 495
        },
        "resolved": true,
        "details": {
          "function_name": "fetch_store_strlen",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/trace/trace_eprobe.c",
          "lines": "384-401",
          "snippet": "static nokprobe_inline int\nfetch_store_strlen(unsigned long addr)\n{\n\tint ret, len = 0;\n\tu8 c;\n\n#ifdef CONFIG_ARCH_HAS_NON_OVERLAPPING_ADDRESS_SPACE\n\tif (addr < TASK_SIZE)\n\t\treturn fetch_store_strlen_user(addr);\n#endif\n\n\tdo {\n\t\tret = copy_from_kernel_nofault(&c, (u8 *)addr + len, 1);\n\t\tlen++;\n\t} while (c && ret == 0 && len < MAX_STRING_SIZE);\n\n\treturn (ret < 0) ? ret : len;\n}",
          "includes": [
            "#include \"trace_probe_tmpl.h\"",
            "#include \"trace_probe.h\"",
            "#include \"trace_dynevent.h\"",
            "#include <linux/ftrace.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "NOKPROBE_SYMBOL(process_fetch_insn)\n\n/* Return the length of string -- including null terminal byte */\nstatic nokprobe_inline"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"trace_probe_tmpl.h\"\n#include \"trace_probe.h\"\n#include \"trace_dynevent.h\"\n#include <linux/ftrace.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n\nNOKPROBE_SYMBOL(process_fetch_insn)\n\n/* Return the length of string -- including null terminal byte */\nstatic nokprobe_inline;\n\nstatic nokprobe_inline int\nfetch_store_strlen(unsigned long addr)\n{\n\tint ret, len = 0;\n\tu8 c;\n\n#ifdef CONFIG_ARCH_HAS_NON_OVERLAPPING_ADDRESS_SPACE\n\tif (addr < TASK_SIZE)\n\t\treturn fetch_store_strlen_user(addr);\n#endif\n\n\tdo {\n\t\tret = copy_from_kernel_nofault(&c, (u8 *)addr + len, 1);\n\t\tlen++;\n\t} while (c && ret == 0 && len < MAX_STRING_SIZE);\n\n\treturn (ret < 0) ? ret : len;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define MAX_LOG_TAKE_PART 4\n\nstatic void truncate_msg(u16 *text_len, u16 *trunc_msg_len)\n{\n\t/*\n\t * The message should not take the whole buffer. Otherwise, it might\n\t * get removed too soon.\n\t */\n\tu32 max_text_len = log_buf_len / MAX_LOG_TAKE_PART;\n\n\tif (*text_len > max_text_len)\n\t\t*text_len = max_text_len;\n\n\t/* enable the warning message (if there is room) */\n\t*trunc_msg_len = strlen(trunc_msg);\n\tif (*text_len >= *trunc_msg_len)\n\t\t*text_len -= *trunc_msg_len;\n\telse\n\t\t*trunc_msg_len = 0;\n}"
  },
  {
    "function_name": "log_buf_len_get",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "470-473",
    "snippet": "u32 log_buf_len_get(void)\n{\n\treturn log_buf_len;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nu32 log_buf_len_get(void)\n{\n\treturn log_buf_len;\n}"
  },
  {
    "function_name": "log_buf_addr_get",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "464-467",
    "snippet": "char *log_buf_addr_get(void)\n{\n\treturn log_buf;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nchar *log_buf_addr_get(void)\n{\n\treturn log_buf;\n}"
  },
  {
    "function_name": "latched_seq_read_nolock",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "448-461",
    "snippet": "static u64 latched_seq_read_nolock(struct latched_seq *ls)\n{\n\tunsigned int seq;\n\tunsigned int idx;\n\tu64 val;\n\n\tdo {\n\t\tseq = raw_read_seqcount_latch(&ls->latch);\n\t\tidx = seq & 0x1;\n\t\tval = ls->val[idx];\n\t} while (read_seqcount_latch_retry(&ls->latch, seq));\n\n\treturn val;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "read_seqcount_latch_retry",
          "args": [
            "&ls->latch",
            "seq"
          ],
          "line": 458
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raw_read_seqcount_latch",
          "args": [
            "&ls->latch"
          ],
          "line": 455
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic u64 latched_seq_read_nolock(struct latched_seq *ls)\n{\n\tunsigned int seq;\n\tunsigned int idx;\n\tu64 val;\n\n\tdo {\n\t\tseq = raw_read_seqcount_latch(&ls->latch);\n\t\tidx = seq & 0x1;\n\t\tval = ls->val[idx];\n\t} while (read_seqcount_latch_retry(&ls->latch, seq));\n\n\treturn val;\n}"
  },
  {
    "function_name": "latched_seq_write",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "439-445",
    "snippet": "static void latched_seq_write(struct latched_seq *ls, u64 val)\n{\n\traw_write_seqcount_latch(&ls->latch);\n\tls->val[0] = val;\n\traw_write_seqcount_latch(&ls->latch);\n\tls->val[1] = val;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "raw_write_seqcount_latch",
          "args": [
            "&ls->latch"
          ],
          "line": 443
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raw_write_seqcount_latch",
          "args": [
            "&ls->latch"
          ],
          "line": 441
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic void latched_seq_write(struct latched_seq *ls, u64 val)\n{\n\traw_write_seqcount_latch(&ls->latch);\n\tls->val[0] = val;\n\traw_write_seqcount_latch(&ls->latch);\n\tls->val[1] = val;\n}"
  },
  {
    "function_name": "printk_percpu_data_ready",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "433-436",
    "snippet": "bool printk_percpu_data_ready(void)\n{\n\treturn __printk_percpu_data_ready;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nbool printk_percpu_data_ready(void)\n{\n\treturn __printk_percpu_data_ready;\n}"
  },
  {
    "function_name": "__up_console_sem",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "248-257",
    "snippet": "static void __up_console_sem(unsigned long ip)\n{\n\tunsigned long flags;\n\n\tmutex_release(&console_lock_dep_map, ip);\n\n\tprintk_safe_enter_irqsave(flags);\n\tup(&console_sem);\n\tprintk_safe_exit_irqrestore(flags);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SEMAPHORE(console_sem);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "printk_safe_exit_irqrestore",
          "args": [
            "flags"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "up",
          "args": [
            "&console_sem"
          ],
          "line": 255
        },
        "resolved": true,
        "details": {
          "function_name": "wake_up_klogd_work_func",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "3229-3241",
          "snippet": "static void wake_up_klogd_work_func(struct irq_work *irq_work)\n{\n\tint pending = __this_cpu_xchg(printk_pending, 0);\n\n\tif (pending & PRINTK_PENDING_OUTPUT) {\n\t\t/* If trylock fails, someone else is doing the printing */\n\t\tif (console_trylock())\n\t\t\tconsole_unlock();\n\t}\n\n\tif (pending & PRINTK_PENDING_WAKEUP)\n\t\twake_up_interruptible(&log_wait);\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define PRINTK_PENDING_OUTPUT\t0x02",
            "#define PRINTK_PENDING_WAKEUP\t0x01"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define PRINTK_PENDING_OUTPUT\t0x02\n#define PRINTK_PENDING_WAKEUP\t0x01\n\nstatic void wake_up_klogd_work_func(struct irq_work *irq_work)\n{\n\tint pending = __this_cpu_xchg(printk_pending, 0);\n\n\tif (pending & PRINTK_PENDING_OUTPUT) {\n\t\t/* If trylock fails, someone else is doing the printing */\n\t\tif (console_trylock())\n\t\t\tconsole_unlock();\n\t}\n\n\tif (pending & PRINTK_PENDING_WAKEUP)\n\t\twake_up_interruptible(&log_wait);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printk_safe_enter_irqsave",
          "args": [
            "flags"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_release",
          "args": [
            "&console_lock_dep_map",
            "ip"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic DEFINE_SEMAPHORE(console_sem);\n\nstatic void __up_console_sem(unsigned long ip)\n{\n\tunsigned long flags;\n\n\tmutex_release(&console_lock_dep_map, ip);\n\n\tprintk_safe_enter_irqsave(flags);\n\tup(&console_sem);\n\tprintk_safe_exit_irqrestore(flags);\n}"
  },
  {
    "function_name": "__down_trylock_console_sem",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "227-245",
    "snippet": "static int __down_trylock_console_sem(unsigned long ip)\n{\n\tint lock_failed;\n\tunsigned long flags;\n\n\t/*\n\t * Here and in __up_console_sem() we need to be in safe mode,\n\t * because spindump/WARN/etc from under console ->lock will\n\t * deadlock in printk()->down_trylock_console_sem() otherwise.\n\t */\n\tprintk_safe_enter_irqsave(flags);\n\tlock_failed = down_trylock(&console_sem);\n\tprintk_safe_exit_irqrestore(flags);\n\n\tif (lock_failed)\n\t\treturn 1;\n\tmutex_acquire(&console_lock_dep_map, 0, 1, ip);\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static DEFINE_SEMAPHORE(console_sem);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_acquire",
          "args": [
            "&console_lock_dep_map",
            "0",
            "1",
            "ip"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printk_safe_exit_irqrestore",
          "args": [
            "flags"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "down_trylock",
          "args": [
            "&console_sem"
          ],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "__down_trylock_console_sem",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "227-245",
          "snippet": "static int __down_trylock_console_sem(unsigned long ip)\n{\n\tint lock_failed;\n\tunsigned long flags;\n\n\t/*\n\t * Here and in __up_console_sem() we need to be in safe mode,\n\t * because spindump/WARN/etc from under console ->lock will\n\t * deadlock in printk()->down_trylock_console_sem() otherwise.\n\t */\n\tprintk_safe_enter_irqsave(flags);\n\tlock_failed = down_trylock(&console_sem);\n\tprintk_safe_exit_irqrestore(flags);\n\n\tif (lock_failed)\n\t\treturn 1;\n\tmutex_acquire(&console_lock_dep_map, 0, 1, ip);\n\treturn 0;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "printk_safe_enter_irqsave",
          "args": [
            "flags"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nstatic DEFINE_SEMAPHORE(console_sem);\n\nstatic int __down_trylock_console_sem(unsigned long ip)\n{\n\tint lock_failed;\n\tunsigned long flags;\n\n\t/*\n\t * Here and in __up_console_sem() we need to be in safe mode,\n\t * because spindump/WARN/etc from under console ->lock will\n\t * deadlock in printk()->down_trylock_console_sem() otherwise.\n\t */\n\tprintk_safe_enter_irqsave(flags);\n\tlock_failed = down_trylock(&console_sem);\n\tprintk_safe_exit_irqrestore(flags);\n\n\tif (lock_failed)\n\t\treturn 1;\n\tmutex_acquire(&console_lock_dep_map, 0, 1, ip);\n\treturn 0;\n}"
  },
  {
    "function_name": "devkmsg_sysctl_set_loglvl",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "175-212",
    "snippet": "int devkmsg_sysctl_set_loglvl(struct ctl_table *table, int write,\n\t\t\t      void *buffer, size_t *lenp, loff_t *ppos)\n{\n\tchar old_str[DEVKMSG_STR_MAX_SIZE];\n\tunsigned int old;\n\tint err;\n\n\tif (write) {\n\t\tif (devkmsg_log & DEVKMSG_LOG_MASK_LOCK)\n\t\t\treturn -EINVAL;\n\n\t\told = devkmsg_log;\n\t\tstrncpy(old_str, devkmsg_log_str, DEVKMSG_STR_MAX_SIZE);\n\t}\n\n\terr = proc_dostring(table, write, buffer, lenp, ppos);\n\tif (err)\n\t\treturn err;\n\n\tif (write) {\n\t\terr = __control_devkmsg(devkmsg_log_str);\n\n\t\t/*\n\t\t * Do not accept an unknown string OR a known string with\n\t\t * trailing crap...\n\t\t */\n\t\tif (err < 0 || (err + 1 != *lenp)) {\n\n\t\t\t/* ... and restore old setting. */\n\t\t\tdevkmsg_log = old;\n\t\t\tstrncpy(devkmsg_log_str, old_str, DEVKMSG_STR_MAX_SIZE);\n\n\t\t\treturn -EINVAL;\n\t\t}\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "char devkmsg_log_str[DEVKMSG_STR_MAX_SIZE] = \"ratelimit\";"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strncpy",
          "args": [
            "devkmsg_log_str",
            "old_str",
            "DEVKMSG_STR_MAX_SIZE"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__control_devkmsg",
          "args": [
            "devkmsg_log_str"
          ],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "__control_devkmsg",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "119-145",
          "snippet": "static int __control_devkmsg(char *str)\n{\n\tsize_t len;\n\n\tif (!str)\n\t\treturn -EINVAL;\n\n\tlen = str_has_prefix(str, \"on\");\n\tif (len) {\n\t\tdevkmsg_log = DEVKMSG_LOG_MASK_ON;\n\t\treturn len;\n\t}\n\n\tlen = str_has_prefix(str, \"off\");\n\tif (len) {\n\t\tdevkmsg_log = DEVKMSG_LOG_MASK_OFF;\n\t\treturn len;\n\t}\n\n\tlen = str_has_prefix(str, \"ratelimit\");\n\tif (len) {\n\t\tdevkmsg_log = DEVKMSG_LOG_MASK_DEFAULT;\n\t\treturn len;\n\t}\n\n\treturn -EINVAL;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define DEVKMSG_LOG_MASK_DEFAULT\t0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define DEVKMSG_LOG_MASK_DEFAULT\t0\n\nstatic int __control_devkmsg(char *str)\n{\n\tsize_t len;\n\n\tif (!str)\n\t\treturn -EINVAL;\n\n\tlen = str_has_prefix(str, \"on\");\n\tif (len) {\n\t\tdevkmsg_log = DEVKMSG_LOG_MASK_ON;\n\t\treturn len;\n\t}\n\n\tlen = str_has_prefix(str, \"off\");\n\tif (len) {\n\t\tdevkmsg_log = DEVKMSG_LOG_MASK_OFF;\n\t\treturn len;\n\t}\n\n\tlen = str_has_prefix(str, \"ratelimit\");\n\tif (len) {\n\t\tdevkmsg_log = DEVKMSG_LOG_MASK_DEFAULT;\n\t\treturn len;\n\t}\n\n\treturn -EINVAL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "proc_dostring",
          "args": [
            "table",
            "write",
            "buffer",
            "lenp",
            "ppos"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "proc_dostring",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sysctl.c",
          "lines": "1543-1547",
          "snippet": "int proc_dostring(struct ctl_table *table, int write,\n\t\t  void *buffer, size_t *lenp, loff_t *ppos)\n{\n\treturn -ENOSYS;\n}",
          "includes": [
            "#include <linux/lockdep.h>",
            "#include <linux/rtmutex.h>",
            "#include <linux/acct.h>",
            "#include <asm/setup.h>",
            "#include <asm/io.h>",
            "#include <asm/stacktrace.h>",
            "#include <asm/nmi.h>",
            "#include <asm/processor.h>",
            "#include <linux/uaccess.h>",
            "#include \"../lib/kstrtox.h\"",
            "#include <linux/delayacct.h>",
            "#include <linux/pid.h>",
            "#include <linux/latencytop.h>",
            "#include <linux/userfaultfd_k.h>",
            "#include <linux/mount.h>",
            "#include <linux/bpf.h>",
            "#include <linux/kexec.h>",
            "#include <linux/sched/sysctl.h>",
            "#include <linux/binfmts.h>",
            "#include <linux/capability.h>",
            "#include <linux/kmod.h>",
            "#include <linux/oom.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/reboot.h>",
            "#include <linux/acpi.h>",
            "#include <linux/nfs_fs.h>",
            "#include <linux/vmstat.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/dcache.h>",
            "#include <linux/limits.h>",
            "#include <linux/times.h>",
            "#include <linux/key.h>",
            "#include <linux/initrd.h>",
            "#include <linux/hugetlb.h>",
            "#include <linux/compaction.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/writeback.h>",
            "#include <linux/highuid.h>",
            "#include <linux/sysrq.h>",
            "#include <linux/net.h>",
            "#include <linux/kobject.h>",
            "#include <linux/kernel.h>",
            "#include <linux/init.h>",
            "#include <linux/fs.h>",
            "#include <linux/filter.h>",
            "#include <linux/kmemleak.h>",
            "#include <linux/ctype.h>",
            "#include <linux/security.h>",
            "#include <linux/proc_fs.h>",
            "#include <linux/printk.h>",
            "#include <linux/panic.h>",
            "#include <linux/signal.h>",
            "#include <linux/bitmap.h>",
            "#include <linux/sysctl.h>",
            "#include <linux/slab.h>",
            "#include <linux/swap.h>",
            "#include <linux/mm.h>",
            "#include <linux/module.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/lockdep.h>\n#include <linux/rtmutex.h>\n#include <linux/acct.h>\n#include <asm/setup.h>\n#include <asm/io.h>\n#include <asm/stacktrace.h>\n#include <asm/nmi.h>\n#include <asm/processor.h>\n#include <linux/uaccess.h>\n#include \"../lib/kstrtox.h\"\n#include <linux/delayacct.h>\n#include <linux/pid.h>\n#include <linux/latencytop.h>\n#include <linux/userfaultfd_k.h>\n#include <linux/mount.h>\n#include <linux/bpf.h>\n#include <linux/kexec.h>\n#include <linux/sched/sysctl.h>\n#include <linux/binfmts.h>\n#include <linux/capability.h>\n#include <linux/kmod.h>\n#include <linux/oom.h>\n#include <linux/perf_event.h>\n#include <linux/ftrace.h>\n#include <linux/reboot.h>\n#include <linux/acpi.h>\n#include <linux/nfs_fs.h>\n#include <linux/vmstat.h>\n#include <linux/syscalls.h>\n#include <linux/dcache.h>\n#include <linux/limits.h>\n#include <linux/times.h>\n#include <linux/key.h>\n#include <linux/initrd.h>\n#include <linux/hugetlb.h>\n#include <linux/compaction.h>\n#include <linux/ratelimit.h>\n#include <linux/writeback.h>\n#include <linux/highuid.h>\n#include <linux/sysrq.h>\n#include <linux/net.h>\n#include <linux/kobject.h>\n#include <linux/kernel.h>\n#include <linux/init.h>\n#include <linux/fs.h>\n#include <linux/filter.h>\n#include <linux/kmemleak.h>\n#include <linux/ctype.h>\n#include <linux/security.h>\n#include <linux/proc_fs.h>\n#include <linux/printk.h>\n#include <linux/panic.h>\n#include <linux/signal.h>\n#include <linux/bitmap.h>\n#include <linux/sysctl.h>\n#include <linux/slab.h>\n#include <linux/swap.h>\n#include <linux/mm.h>\n#include <linux/module.h>\n\nint proc_dostring(struct ctl_table *table, int write,\n\t\t  void *buffer, size_t *lenp, loff_t *ppos)\n{\n\treturn -ENOSYS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strncpy",
          "args": [
            "old_str",
            "devkmsg_log_str",
            "DEVKMSG_STR_MAX_SIZE"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nchar devkmsg_log_str[DEVKMSG_STR_MAX_SIZE] = \"ratelimit\";\n\nint devkmsg_sysctl_set_loglvl(struct ctl_table *table, int write,\n\t\t\t      void *buffer, size_t *lenp, loff_t *ppos)\n{\n\tchar old_str[DEVKMSG_STR_MAX_SIZE];\n\tunsigned int old;\n\tint err;\n\n\tif (write) {\n\t\tif (devkmsg_log & DEVKMSG_LOG_MASK_LOCK)\n\t\t\treturn -EINVAL;\n\n\t\told = devkmsg_log;\n\t\tstrncpy(old_str, devkmsg_log_str, DEVKMSG_STR_MAX_SIZE);\n\t}\n\n\terr = proc_dostring(table, write, buffer, lenp, ppos);\n\tif (err)\n\t\treturn err;\n\n\tif (write) {\n\t\terr = __control_devkmsg(devkmsg_log_str);\n\n\t\t/*\n\t\t * Do not accept an unknown string OR a known string with\n\t\t * trailing crap...\n\t\t */\n\t\tif (err < 0 || (err + 1 != *lenp)) {\n\n\t\t\t/* ... and restore old setting. */\n\t\t\tdevkmsg_log = old;\n\t\t\tstrncpy(devkmsg_log_str, old_str, DEVKMSG_STR_MAX_SIZE);\n\n\t\t\treturn -EINVAL;\n\t\t}\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "control_devkmsg",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "147-170",
    "snippet": "static int __init control_devkmsg(char *str)\n{\n\tif (__control_devkmsg(str) < 0)\n\t\treturn 1;\n\n\t/*\n\t * Set sysctl string accordingly:\n\t */\n\tif (devkmsg_log == DEVKMSG_LOG_MASK_ON)\n\t\tstrcpy(devkmsg_log_str, \"on\");\n\telse if (devkmsg_log == DEVKMSG_LOG_MASK_OFF)\n\t\tstrcpy(devkmsg_log_str, \"off\");\n\t/* else \"ratelimit\" which is set by default. */\n\n\t/*\n\t * Sysctl cannot change it anymore. The kernel command line setting of\n\t * this parameter is to force the setting to be permanent throughout the\n\t * runtime of the system. This is a precation measure against userspace\n\t * trying to be a smarta** and attempting to change it up on us.\n\t */\n\tdevkmsg_log |= DEVKMSG_LOG_MASK_LOCK;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "char devkmsg_log_str[DEVKMSG_STR_MAX_SIZE] = \"ratelimit\";"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "devkmsg_log_str",
            "\"off\""
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "devkmsg_log_str",
            "\"on\""
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__control_devkmsg",
          "args": [
            "str"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "__control_devkmsg",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
          "lines": "119-145",
          "snippet": "static int __control_devkmsg(char *str)\n{\n\tsize_t len;\n\n\tif (!str)\n\t\treturn -EINVAL;\n\n\tlen = str_has_prefix(str, \"on\");\n\tif (len) {\n\t\tdevkmsg_log = DEVKMSG_LOG_MASK_ON;\n\t\treturn len;\n\t}\n\n\tlen = str_has_prefix(str, \"off\");\n\tif (len) {\n\t\tdevkmsg_log = DEVKMSG_LOG_MASK_OFF;\n\t\treturn len;\n\t}\n\n\tlen = str_has_prefix(str, \"ratelimit\");\n\tif (len) {\n\t\tdevkmsg_log = DEVKMSG_LOG_MASK_DEFAULT;\n\t\treturn len;\n\t}\n\n\treturn -EINVAL;\n}",
          "includes": [
            "#include \"internal.h\"",
            "#include \"braille.h\"",
            "#include \"console_cmdline.h\"",
            "#include \"printk_ringbuffer.h\"",
            "#include <trace/events/printk.h>",
            "#include <trace/events/initcall.h>",
            "#include <asm/sections.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/sched/task_stack.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/clock.h>",
            "#include <linux/uio.h>",
            "#include <linux/ctype.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/poll.h>",
            "#include <linux/rculist.h>",
            "#include <linux/cpu.h>",
            "#include <linux/syslog.h>",
            "#include <linux/kmsg_dump.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/crash_core.h>",
            "#include <linux/syscalls.h>",
            "#include <linux/memblock.h>",
            "#include <linux/security.h>",
            "#include <linux/smp.h>",
            "#include <linux/delay.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/nmi.h>",
            "#include <linux/jiffies.h>",
            "#include <linux/init.h>",
            "#include <linux/console.h>",
            "#include <linux/tty_driver.h>",
            "#include <linux/tty.h>",
            "#include <linux/mm.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [
            "#define DEVKMSG_LOG_MASK_DEFAULT\t0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define DEVKMSG_LOG_MASK_DEFAULT\t0\n\nstatic int __control_devkmsg(char *str)\n{\n\tsize_t len;\n\n\tif (!str)\n\t\treturn -EINVAL;\n\n\tlen = str_has_prefix(str, \"on\");\n\tif (len) {\n\t\tdevkmsg_log = DEVKMSG_LOG_MASK_ON;\n\t\treturn len;\n\t}\n\n\tlen = str_has_prefix(str, \"off\");\n\tif (len) {\n\t\tdevkmsg_log = DEVKMSG_LOG_MASK_OFF;\n\t\treturn len;\n\t}\n\n\tlen = str_has_prefix(str, \"ratelimit\");\n\tif (len) {\n\t\tdevkmsg_log = DEVKMSG_LOG_MASK_DEFAULT;\n\t\treturn len;\n\t}\n\n\treturn -EINVAL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nchar devkmsg_log_str[DEVKMSG_STR_MAX_SIZE] = \"ratelimit\";\n\nstatic int __init control_devkmsg(char *str)\n{\n\tif (__control_devkmsg(str) < 0)\n\t\treturn 1;\n\n\t/*\n\t * Set sysctl string accordingly:\n\t */\n\tif (devkmsg_log == DEVKMSG_LOG_MASK_ON)\n\t\tstrcpy(devkmsg_log_str, \"on\");\n\telse if (devkmsg_log == DEVKMSG_LOG_MASK_OFF)\n\t\tstrcpy(devkmsg_log_str, \"off\");\n\t/* else \"ratelimit\" which is set by default. */\n\n\t/*\n\t * Sysctl cannot change it anymore. The kernel command line setting of\n\t * this parameter is to force the setting to be permanent throughout the\n\t * runtime of the system. This is a precation measure against userspace\n\t * trying to be a smarta** and attempting to change it up on us.\n\t */\n\tdevkmsg_log |= DEVKMSG_LOG_MASK_LOCK;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "__control_devkmsg",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "119-145",
    "snippet": "static int __control_devkmsg(char *str)\n{\n\tsize_t len;\n\n\tif (!str)\n\t\treturn -EINVAL;\n\n\tlen = str_has_prefix(str, \"on\");\n\tif (len) {\n\t\tdevkmsg_log = DEVKMSG_LOG_MASK_ON;\n\t\treturn len;\n\t}\n\n\tlen = str_has_prefix(str, \"off\");\n\tif (len) {\n\t\tdevkmsg_log = DEVKMSG_LOG_MASK_OFF;\n\t\treturn len;\n\t}\n\n\tlen = str_has_prefix(str, \"ratelimit\");\n\tif (len) {\n\t\tdevkmsg_log = DEVKMSG_LOG_MASK_DEFAULT;\n\t\treturn len;\n\t}\n\n\treturn -EINVAL;\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [
      "#define DEVKMSG_LOG_MASK_DEFAULT\t0"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "str_has_prefix",
          "args": [
            "str",
            "\"ratelimit\""
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str_has_prefix",
          "args": [
            "str",
            "\"off\""
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "str_has_prefix",
          "args": [
            "str",
            "\"on\""
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\n#define DEVKMSG_LOG_MASK_DEFAULT\t0\n\nstatic int __control_devkmsg(char *str)\n{\n\tsize_t len;\n\n\tif (!str)\n\t\treturn -EINVAL;\n\n\tlen = str_has_prefix(str, \"on\");\n\tif (len) {\n\t\tdevkmsg_log = DEVKMSG_LOG_MASK_ON;\n\t\treturn len;\n\t}\n\n\tlen = str_has_prefix(str, \"off\");\n\tif (len) {\n\t\tdevkmsg_log = DEVKMSG_LOG_MASK_OFF;\n\t\treturn len;\n\t}\n\n\tlen = str_has_prefix(str, \"ratelimit\");\n\tif (len) {\n\t\tdevkmsg_log = DEVKMSG_LOG_MASK_DEFAULT;\n\t\treturn len;\n\t}\n\n\treturn -EINVAL;\n}"
  },
  {
    "function_name": "syslog",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/printk/printk.c",
    "lines": "1745-1748",
    "snippet": "SYSCALL_DEFINE3(syslog, int, type, char __user *, buf, int, len)\n{\n\treturn do_syslog(type, buf, len, SYSLOG_FROM_READER);\n}",
    "includes": [
      "#include \"internal.h\"",
      "#include \"braille.h\"",
      "#include \"console_cmdline.h\"",
      "#include \"printk_ringbuffer.h\"",
      "#include <trace/events/printk.h>",
      "#include <trace/events/initcall.h>",
      "#include <asm/sections.h>",
      "#include <linux/uaccess.h>",
      "#include <linux/sched/task_stack.h>",
      "#include <linux/sched/debug.h>",
      "#include <linux/sched/clock.h>",
      "#include <linux/uio.h>",
      "#include <linux/ctype.h>",
      "#include <linux/irq_work.h>",
      "#include <linux/poll.h>",
      "#include <linux/rculist.h>",
      "#include <linux/cpu.h>",
      "#include <linux/syslog.h>",
      "#include <linux/kmsg_dump.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/crash_core.h>",
      "#include <linux/syscalls.h>",
      "#include <linux/memblock.h>",
      "#include <linux/security.h>",
      "#include <linux/smp.h>",
      "#include <linux/delay.h>",
      "#include <linux/moduleparam.h>",
      "#include <linux/module.h>",
      "#include <linux/nmi.h>",
      "#include <linux/jiffies.h>",
      "#include <linux/init.h>",
      "#include <linux/console.h>",
      "#include <linux/tty_driver.h>",
      "#include <linux/tty.h>",
      "#include <linux/mm.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"internal.h\"\n#include \"braille.h\"\n#include \"console_cmdline.h\"\n#include \"printk_ringbuffer.h\"\n#include <trace/events/printk.h>\n#include <trace/events/initcall.h>\n#include <asm/sections.h>\n#include <linux/uaccess.h>\n#include <linux/sched/task_stack.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/clock.h>\n#include <linux/uio.h>\n#include <linux/ctype.h>\n#include <linux/irq_work.h>\n#include <linux/poll.h>\n#include <linux/rculist.h>\n#include <linux/cpu.h>\n#include <linux/syslog.h>\n#include <linux/kmsg_dump.h>\n#include <linux/ratelimit.h>\n#include <linux/crash_core.h>\n#include <linux/syscalls.h>\n#include <linux/memblock.h>\n#include <linux/security.h>\n#include <linux/smp.h>\n#include <linux/delay.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/nmi.h>\n#include <linux/jiffies.h>\n#include <linux/init.h>\n#include <linux/console.h>\n#include <linux/tty_driver.h>\n#include <linux/tty.h>\n#include <linux/mm.h>\n#include <linux/kernel.h>\n\nSYSCALL_DEFINE3(syslog, int, type, char __user *, buf, int, len)\n{\n\treturn do_syslog(type, buf, len, SYSLOG_FROM_READER);\n}"
  }
]