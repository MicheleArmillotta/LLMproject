[
  {
    "function_name": "tnum_const_subreg",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/tnum.c",
    "lines": "211-214",
    "snippet": "struct tnum tnum_const_subreg(struct tnum a, u32 value)\n{\n\treturn tnum_or(tnum_clear_subreg(a), tnum_const(value));\n}",
    "includes": [
      "#include <linux/tnum.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tnum_or",
          "args": [
            "tnum_clear_subreg(a)",
            "tnum_const(value)"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "tnum_or",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/tnum.c",
          "lines": "96-103",
          "snippet": "struct tnum tnum_or(struct tnum a, struct tnum b)\n{\n\tu64 v, mu;\n\n\tv = a.value | b.value;\n\tmu = a.mask | b.mask;\n\treturn TNUM(v, mu & ~v);\n}",
          "includes": [
            "#include <linux/tnum.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/tnum.h>\n#include <linux/kernel.h>\n\nstruct tnum tnum_or(struct tnum a, struct tnum b)\n{\n\tu64 v, mu;\n\n\tv = a.value | b.value;\n\tmu = a.mask | b.mask;\n\treturn TNUM(v, mu & ~v);\n}"
        }
      },
      {
        "call_info": {
          "callee": "tnum_const",
          "args": [
            "value"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "tnum_const",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/tnum.c",
          "lines": "16-19",
          "snippet": "struct tnum tnum_const(u64 value)\n{\n\treturn TNUM(value, 0);\n}",
          "includes": [
            "#include <linux/tnum.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/tnum.h>\n#include <linux/kernel.h>\n\nstruct tnum tnum_const(u64 value)\n{\n\treturn TNUM(value, 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "tnum_clear_subreg",
          "args": [
            "a"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "tnum_clear_subreg",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/tnum.c",
          "lines": "206-209",
          "snippet": "struct tnum tnum_clear_subreg(struct tnum a)\n{\n\treturn tnum_lshift(tnum_rshift(a, 32), 32);\n}",
          "includes": [
            "#include <linux/tnum.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/tnum.h>\n#include <linux/kernel.h>\n\nstruct tnum tnum_clear_subreg(struct tnum a)\n{\n\treturn tnum_lshift(tnum_rshift(a, 32), 32);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/tnum.h>\n#include <linux/kernel.h>\n\nstruct tnum tnum_const_subreg(struct tnum a, u32 value)\n{\n\treturn tnum_or(tnum_clear_subreg(a), tnum_const(value));\n}"
  },
  {
    "function_name": "tnum_clear_subreg",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/tnum.c",
    "lines": "206-209",
    "snippet": "struct tnum tnum_clear_subreg(struct tnum a)\n{\n\treturn tnum_lshift(tnum_rshift(a, 32), 32);\n}",
    "includes": [
      "#include <linux/tnum.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tnum_lshift",
          "args": [
            "tnum_rshift(a, 32)",
            "32"
          ],
          "line": 208
        },
        "resolved": true,
        "details": {
          "function_name": "tnum_lshift",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/tnum.c",
          "lines": "37-40",
          "snippet": "struct tnum tnum_lshift(struct tnum a, u8 shift)\n{\n\treturn TNUM(a.value << shift, a.mask << shift);\n}",
          "includes": [
            "#include <linux/tnum.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/tnum.h>\n#include <linux/kernel.h>\n\nstruct tnum tnum_lshift(struct tnum a, u8 shift)\n{\n\treturn TNUM(a.value << shift, a.mask << shift);\n}"
        }
      },
      {
        "call_info": {
          "callee": "tnum_rshift",
          "args": [
            "a",
            "32"
          ],
          "line": 208
        },
        "resolved": true,
        "details": {
          "function_name": "tnum_rshift",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/tnum.c",
          "lines": "42-45",
          "snippet": "struct tnum tnum_rshift(struct tnum a, u8 shift)\n{\n\treturn TNUM(a.value >> shift, a.mask >> shift);\n}",
          "includes": [
            "#include <linux/tnum.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/tnum.h>\n#include <linux/kernel.h>\n\nstruct tnum tnum_rshift(struct tnum a, u8 shift)\n{\n\treturn TNUM(a.value >> shift, a.mask >> shift);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/tnum.h>\n#include <linux/kernel.h>\n\nstruct tnum tnum_clear_subreg(struct tnum a)\n{\n\treturn tnum_lshift(tnum_rshift(a, 32), 32);\n}"
  },
  {
    "function_name": "tnum_subreg",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/tnum.c",
    "lines": "201-204",
    "snippet": "struct tnum tnum_subreg(struct tnum a)\n{\n\treturn tnum_cast(a, 4);\n}",
    "includes": [
      "#include <linux/tnum.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tnum_cast",
          "args": [
            "a",
            "4"
          ],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "tnum_cast",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/tnum.c",
          "lines": "153-158",
          "snippet": "struct tnum tnum_cast(struct tnum a, u8 size)\n{\n\ta.value &= (1ULL << (size * 8)) - 1;\n\ta.mask &= (1ULL << (size * 8)) - 1;\n\treturn a;\n}",
          "includes": [
            "#include <linux/tnum.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/tnum.h>\n#include <linux/kernel.h>\n\nstruct tnum tnum_cast(struct tnum a, u8 size)\n{\n\ta.value &= (1ULL << (size * 8)) - 1;\n\ta.mask &= (1ULL << (size * 8)) - 1;\n\treturn a;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/tnum.h>\n#include <linux/kernel.h>\n\nstruct tnum tnum_subreg(struct tnum a)\n{\n\treturn tnum_cast(a, 4);\n}"
  },
  {
    "function_name": "tnum_sbin",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/tnum.c",
    "lines": "181-199",
    "snippet": "int tnum_sbin(char *str, size_t size, struct tnum a)\n{\n\tsize_t n;\n\n\tfor (n = 64; n; n--) {\n\t\tif (n < size) {\n\t\t\tif (a.mask & 1)\n\t\t\t\tstr[n - 1] = 'x';\n\t\t\telse if (a.value & 1)\n\t\t\t\tstr[n - 1] = '1';\n\t\t\telse\n\t\t\t\tstr[n - 1] = '0';\n\t\t}\n\t\ta.mask >>= 1;\n\t\ta.value >>= 1;\n\t}\n\tstr[min(size - 1, (size_t)64)] = 0;\n\treturn 64;\n}",
    "includes": [
      "#include <linux/tnum.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "min",
          "args": [
            "size - 1",
            "(size_t)64"
          ],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "__reg_combine_min_max",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/verifier.c",
          "lines": "9059-9087",
          "snippet": "static void __reg_combine_min_max(struct bpf_reg_state *src_reg,\n\t\t\t\t  struct bpf_reg_state *dst_reg)\n{\n\tsrc_reg->umin_value = dst_reg->umin_value = max(src_reg->umin_value,\n\t\t\t\t\t\t\tdst_reg->umin_value);\n\tsrc_reg->umax_value = dst_reg->umax_value = min(src_reg->umax_value,\n\t\t\t\t\t\t\tdst_reg->umax_value);\n\tsrc_reg->smin_value = dst_reg->smin_value = max(src_reg->smin_value,\n\t\t\t\t\t\t\tdst_reg->smin_value);\n\tsrc_reg->smax_value = dst_reg->smax_value = min(src_reg->smax_value,\n\t\t\t\t\t\t\tdst_reg->smax_value);\n\tsrc_reg->var_off = dst_reg->var_off = tnum_intersect(src_reg->var_off,\n\t\t\t\t\t\t\t     dst_reg->var_off);\n\t/* We might have learned new bounds from the var_off. */\n\t__update_reg_bounds(src_reg);\n\t__update_reg_bounds(dst_reg);\n\t/* We might have learned something about the sign bit. */\n\t__reg_deduce_bounds(src_reg);\n\t__reg_deduce_bounds(dst_reg);\n\t/* We might have learned some bits from the bounds. */\n\t__reg_bound_offset(src_reg);\n\t__reg_bound_offset(dst_reg);\n\t/* Intersecting with the old var_off might have improved our bounds\n\t * slightly.  e.g. if umax was 0x7f...f and var_off was (0; 0xf...fc),\n\t * then new var_off is (0; 0x7f...fc) which improves our umax.\n\t */\n\t__update_reg_bounds(src_reg);\n\t__update_reg_bounds(dst_reg);\n}",
          "includes": [
            "#include \"disasm.h\"",
            "#include <linux/btf_ids.h>",
            "#include <linux/bpf_lsm.h>",
            "#include <linux/error-injection.h>",
            "#include <linux/ctype.h>",
            "#include <linux/perf_event.h>",
            "#include <linux/sort.h>",
            "#include <linux/bsearch.h>",
            "#include <linux/stringify.h>",
            "#include <linux/vmalloc.h>",
            "#include <linux/file.h>",
            "#include <net/netlink.h>",
            "#include <linux/filter.h>",
            "#include <linux/bpf_verifier.h>",
            "#include <linux/btf.h>",
            "#include <linux/bpf.h>",
            "#include <linux/slab.h>",
            "#include <linux/types.h>",
            "#include <linux/kernel.h>",
            "#include <linux/bpf-cgroup.h>",
            "#include <uapi/linux/btf.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"disasm.h\"\n#include <linux/btf_ids.h>\n#include <linux/bpf_lsm.h>\n#include <linux/error-injection.h>\n#include <linux/ctype.h>\n#include <linux/perf_event.h>\n#include <linux/sort.h>\n#include <linux/bsearch.h>\n#include <linux/stringify.h>\n#include <linux/vmalloc.h>\n#include <linux/file.h>\n#include <net/netlink.h>\n#include <linux/filter.h>\n#include <linux/bpf_verifier.h>\n#include <linux/btf.h>\n#include <linux/bpf.h>\n#include <linux/slab.h>\n#include <linux/types.h>\n#include <linux/kernel.h>\n#include <linux/bpf-cgroup.h>\n#include <uapi/linux/btf.h>\n\nstatic void __reg_combine_min_max(struct bpf_reg_state *src_reg,\n\t\t\t\t  struct bpf_reg_state *dst_reg)\n{\n\tsrc_reg->umin_value = dst_reg->umin_value = max(src_reg->umin_value,\n\t\t\t\t\t\t\tdst_reg->umin_value);\n\tsrc_reg->umax_value = dst_reg->umax_value = min(src_reg->umax_value,\n\t\t\t\t\t\t\tdst_reg->umax_value);\n\tsrc_reg->smin_value = dst_reg->smin_value = max(src_reg->smin_value,\n\t\t\t\t\t\t\tdst_reg->smin_value);\n\tsrc_reg->smax_value = dst_reg->smax_value = min(src_reg->smax_value,\n\t\t\t\t\t\t\tdst_reg->smax_value);\n\tsrc_reg->var_off = dst_reg->var_off = tnum_intersect(src_reg->var_off,\n\t\t\t\t\t\t\t     dst_reg->var_off);\n\t/* We might have learned new bounds from the var_off. */\n\t__update_reg_bounds(src_reg);\n\t__update_reg_bounds(dst_reg);\n\t/* We might have learned something about the sign bit. */\n\t__reg_deduce_bounds(src_reg);\n\t__reg_deduce_bounds(dst_reg);\n\t/* We might have learned some bits from the bounds. */\n\t__reg_bound_offset(src_reg);\n\t__reg_bound_offset(dst_reg);\n\t/* Intersecting with the old var_off might have improved our bounds\n\t * slightly.  e.g. if umax was 0x7f...f and var_off was (0; 0xf...fc),\n\t * then new var_off is (0; 0x7f...fc) which improves our umax.\n\t */\n\t__update_reg_bounds(src_reg);\n\t__update_reg_bounds(dst_reg);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <linux/tnum.h>\n#include <linux/kernel.h>\n\nint tnum_sbin(char *str, size_t size, struct tnum a)\n{\n\tsize_t n;\n\n\tfor (n = 64; n; n--) {\n\t\tif (n < size) {\n\t\t\tif (a.mask & 1)\n\t\t\t\tstr[n - 1] = 'x';\n\t\t\telse if (a.value & 1)\n\t\t\t\tstr[n - 1] = '1';\n\t\t\telse\n\t\t\t\tstr[n - 1] = '0';\n\t\t}\n\t\ta.mask >>= 1;\n\t\ta.value >>= 1;\n\t}\n\tstr[min(size - 1, (size_t)64)] = 0;\n\treturn 64;\n}"
  },
  {
    "function_name": "tnum_strn",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/tnum.c",
    "lines": "175-178",
    "snippet": "int tnum_strn(char *str, size_t size, struct tnum a)\n{\n\treturn snprintf(str, size, \"(%#llx; %#llx)\", a.value, a.mask);\n}",
    "includes": [
      "#include <linux/tnum.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "str",
            "size",
            "\"(%#llx; %#llx)\"",
            "a.value",
            "a.mask"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/tnum.h>\n#include <linux/kernel.h>\n\nint tnum_strn(char *str, size_t size, struct tnum a)\n{\n\treturn snprintf(str, size, \"(%#llx; %#llx)\", a.value, a.mask);\n}"
  },
  {
    "function_name": "tnum_in",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/tnum.c",
    "lines": "167-173",
    "snippet": "bool tnum_in(struct tnum a, struct tnum b)\n{\n\tif (b.mask & ~a.mask)\n\t\treturn false;\n\tb.value &= ~a.mask;\n\treturn a.value == b.value;\n}",
    "includes": [
      "#include <linux/tnum.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/tnum.h>\n#include <linux/kernel.h>\n\nbool tnum_in(struct tnum a, struct tnum b)\n{\n\tif (b.mask & ~a.mask)\n\t\treturn false;\n\tb.value &= ~a.mask;\n\treturn a.value == b.value;\n}"
  },
  {
    "function_name": "tnum_is_aligned",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/tnum.c",
    "lines": "160-165",
    "snippet": "bool tnum_is_aligned(struct tnum a, u64 size)\n{\n\tif (!size)\n\t\treturn true;\n\treturn !((a.value | a.mask) & (size - 1));\n}",
    "includes": [
      "#include <linux/tnum.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/tnum.h>\n#include <linux/kernel.h>\n\nbool tnum_is_aligned(struct tnum a, u64 size)\n{\n\tif (!size)\n\t\treturn true;\n\treturn !((a.value | a.mask) & (size - 1));\n}"
  },
  {
    "function_name": "tnum_cast",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/tnum.c",
    "lines": "153-158",
    "snippet": "struct tnum tnum_cast(struct tnum a, u8 size)\n{\n\ta.value &= (1ULL << (size * 8)) - 1;\n\ta.mask &= (1ULL << (size * 8)) - 1;\n\treturn a;\n}",
    "includes": [
      "#include <linux/tnum.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <linux/tnum.h>\n#include <linux/kernel.h>\n\nstruct tnum tnum_cast(struct tnum a, u8 size)\n{\n\ta.value &= (1ULL << (size * 8)) - 1;\n\ta.mask &= (1ULL << (size * 8)) - 1;\n\treturn a;\n}"
  },
  {
    "function_name": "tnum_intersect",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/tnum.c",
    "lines": "144-151",
    "snippet": "struct tnum tnum_intersect(struct tnum a, struct tnum b)\n{\n\tu64 v, mu;\n\n\tv = a.value | b.value;\n\tmu = a.mask & b.mask;\n\treturn TNUM(v & ~mu, mu);\n}",
    "includes": [
      "#include <linux/tnum.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "TNUM",
          "args": [
            "v & ~mu",
            "mu"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/tnum.h>\n#include <linux/kernel.h>\n\nstruct tnum tnum_intersect(struct tnum a, struct tnum b)\n{\n\tu64 v, mu;\n\n\tv = a.value | b.value;\n\tmu = a.mask & b.mask;\n\treturn TNUM(v & ~mu, mu);\n}"
  },
  {
    "function_name": "tnum_mul",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/tnum.c",
    "lines": "122-139",
    "snippet": "struct tnum tnum_mul(struct tnum a, struct tnum b)\n{\n\tu64 acc_v = a.value * b.value;\n\tstruct tnum acc_m = TNUM(0, 0);\n\n\twhile (a.value || a.mask) {\n\t\t/* LSB of tnum a is a certain 1 */\n\t\tif (a.value & 1)\n\t\t\tacc_m = tnum_add(acc_m, TNUM(0, b.mask));\n\t\t/* LSB of tnum a is uncertain */\n\t\telse if (a.mask & 1)\n\t\t\tacc_m = tnum_add(acc_m, TNUM(0, b.value | b.mask));\n\t\t/* Note: no case for LSB is certain 0 */\n\t\ta = tnum_rshift(a, 1);\n\t\tb = tnum_lshift(b, 1);\n\t}\n\treturn tnum_add(TNUM(acc_v, 0), acc_m);\n}",
    "includes": [
      "#include <linux/tnum.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tnum_add",
          "args": [
            "TNUM(acc_v, 0)",
            "acc_m"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "tnum_add",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/tnum.c",
          "lines": "62-72",
          "snippet": "struct tnum tnum_add(struct tnum a, struct tnum b)\n{\n\tu64 sm, sv, sigma, chi, mu;\n\n\tsm = a.mask + b.mask;\n\tsv = a.value + b.value;\n\tsigma = sm + sv;\n\tchi = sigma ^ sv;\n\tmu = chi | a.mask | b.mask;\n\treturn TNUM(sv & ~mu, mu);\n}",
          "includes": [
            "#include <linux/tnum.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/tnum.h>\n#include <linux/kernel.h>\n\nstruct tnum tnum_add(struct tnum a, struct tnum b)\n{\n\tu64 sm, sv, sigma, chi, mu;\n\n\tsm = a.mask + b.mask;\n\tsv = a.value + b.value;\n\tsigma = sm + sv;\n\tchi = sigma ^ sv;\n\tmu = chi | a.mask | b.mask;\n\treturn TNUM(sv & ~mu, mu);\n}"
        }
      },
      {
        "call_info": {
          "callee": "TNUM",
          "args": [
            "acc_v",
            "0"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tnum_lshift",
          "args": [
            "b",
            "1"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "tnum_lshift",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/tnum.c",
          "lines": "37-40",
          "snippet": "struct tnum tnum_lshift(struct tnum a, u8 shift)\n{\n\treturn TNUM(a.value << shift, a.mask << shift);\n}",
          "includes": [
            "#include <linux/tnum.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/tnum.h>\n#include <linux/kernel.h>\n\nstruct tnum tnum_lshift(struct tnum a, u8 shift)\n{\n\treturn TNUM(a.value << shift, a.mask << shift);\n}"
        }
      },
      {
        "call_info": {
          "callee": "tnum_rshift",
          "args": [
            "a",
            "1"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "tnum_rshift",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/tnum.c",
          "lines": "42-45",
          "snippet": "struct tnum tnum_rshift(struct tnum a, u8 shift)\n{\n\treturn TNUM(a.value >> shift, a.mask >> shift);\n}",
          "includes": [
            "#include <linux/tnum.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/tnum.h>\n#include <linux/kernel.h>\n\nstruct tnum tnum_rshift(struct tnum a, u8 shift)\n{\n\treturn TNUM(a.value >> shift, a.mask >> shift);\n}"
        }
      },
      {
        "call_info": {
          "callee": "TNUM",
          "args": [
            "0",
            "b.value | b.mask"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TNUM",
          "args": [
            "0",
            "b.mask"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TNUM",
          "args": [
            "0",
            "0"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/tnum.h>\n#include <linux/kernel.h>\n\nstruct tnum tnum_mul(struct tnum a, struct tnum b)\n{\n\tu64 acc_v = a.value * b.value;\n\tstruct tnum acc_m = TNUM(0, 0);\n\n\twhile (a.value || a.mask) {\n\t\t/* LSB of tnum a is a certain 1 */\n\t\tif (a.value & 1)\n\t\t\tacc_m = tnum_add(acc_m, TNUM(0, b.mask));\n\t\t/* LSB of tnum a is uncertain */\n\t\telse if (a.mask & 1)\n\t\t\tacc_m = tnum_add(acc_m, TNUM(0, b.value | b.mask));\n\t\t/* Note: no case for LSB is certain 0 */\n\t\ta = tnum_rshift(a, 1);\n\t\tb = tnum_lshift(b, 1);\n\t}\n\treturn tnum_add(TNUM(acc_v, 0), acc_m);\n}"
  },
  {
    "function_name": "tnum_xor",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/tnum.c",
    "lines": "105-112",
    "snippet": "struct tnum tnum_xor(struct tnum a, struct tnum b)\n{\n\tu64 v, mu;\n\n\tv = a.value ^ b.value;\n\tmu = a.mask | b.mask;\n\treturn TNUM(v & ~mu, mu);\n}",
    "includes": [
      "#include <linux/tnum.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "TNUM",
          "args": [
            "v & ~mu",
            "mu"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/tnum.h>\n#include <linux/kernel.h>\n\nstruct tnum tnum_xor(struct tnum a, struct tnum b)\n{\n\tu64 v, mu;\n\n\tv = a.value ^ b.value;\n\tmu = a.mask | b.mask;\n\treturn TNUM(v & ~mu, mu);\n}"
  },
  {
    "function_name": "tnum_or",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/tnum.c",
    "lines": "96-103",
    "snippet": "struct tnum tnum_or(struct tnum a, struct tnum b)\n{\n\tu64 v, mu;\n\n\tv = a.value | b.value;\n\tmu = a.mask | b.mask;\n\treturn TNUM(v, mu & ~v);\n}",
    "includes": [
      "#include <linux/tnum.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "TNUM",
          "args": [
            "v",
            "mu & ~v"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/tnum.h>\n#include <linux/kernel.h>\n\nstruct tnum tnum_or(struct tnum a, struct tnum b)\n{\n\tu64 v, mu;\n\n\tv = a.value | b.value;\n\tmu = a.mask | b.mask;\n\treturn TNUM(v, mu & ~v);\n}"
  },
  {
    "function_name": "tnum_and",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/tnum.c",
    "lines": "86-94",
    "snippet": "struct tnum tnum_and(struct tnum a, struct tnum b)\n{\n\tu64 alpha, beta, v;\n\n\talpha = a.value | a.mask;\n\tbeta = b.value | b.mask;\n\tv = a.value & b.value;\n\treturn TNUM(v, alpha & beta & ~v);\n}",
    "includes": [
      "#include <linux/tnum.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "TNUM",
          "args": [
            "v",
            "alpha & beta & ~v"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/tnum.h>\n#include <linux/kernel.h>\n\nstruct tnum tnum_and(struct tnum a, struct tnum b)\n{\n\tu64 alpha, beta, v;\n\n\talpha = a.value | a.mask;\n\tbeta = b.value | b.mask;\n\tv = a.value & b.value;\n\treturn TNUM(v, alpha & beta & ~v);\n}"
  },
  {
    "function_name": "tnum_sub",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/tnum.c",
    "lines": "74-84",
    "snippet": "struct tnum tnum_sub(struct tnum a, struct tnum b)\n{\n\tu64 dv, alpha, beta, chi, mu;\n\n\tdv = a.value - b.value;\n\talpha = dv + a.mask;\n\tbeta = dv - b.mask;\n\tchi = alpha ^ beta;\n\tmu = chi | a.mask | b.mask;\n\treturn TNUM(dv & ~mu, mu);\n}",
    "includes": [
      "#include <linux/tnum.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "TNUM",
          "args": [
            "dv & ~mu",
            "mu"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/tnum.h>\n#include <linux/kernel.h>\n\nstruct tnum tnum_sub(struct tnum a, struct tnum b)\n{\n\tu64 dv, alpha, beta, chi, mu;\n\n\tdv = a.value - b.value;\n\talpha = dv + a.mask;\n\tbeta = dv - b.mask;\n\tchi = alpha ^ beta;\n\tmu = chi | a.mask | b.mask;\n\treturn TNUM(dv & ~mu, mu);\n}"
  },
  {
    "function_name": "tnum_add",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/tnum.c",
    "lines": "62-72",
    "snippet": "struct tnum tnum_add(struct tnum a, struct tnum b)\n{\n\tu64 sm, sv, sigma, chi, mu;\n\n\tsm = a.mask + b.mask;\n\tsv = a.value + b.value;\n\tsigma = sm + sv;\n\tchi = sigma ^ sv;\n\tmu = chi | a.mask | b.mask;\n\treturn TNUM(sv & ~mu, mu);\n}",
    "includes": [
      "#include <linux/tnum.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "TNUM",
          "args": [
            "sv & ~mu",
            "mu"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/tnum.h>\n#include <linux/kernel.h>\n\nstruct tnum tnum_add(struct tnum a, struct tnum b)\n{\n\tu64 sm, sv, sigma, chi, mu;\n\n\tsm = a.mask + b.mask;\n\tsv = a.value + b.value;\n\tsigma = sm + sv;\n\tchi = sigma ^ sv;\n\tmu = chi | a.mask | b.mask;\n\treturn TNUM(sv & ~mu, mu);\n}"
  },
  {
    "function_name": "tnum_arshift",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/tnum.c",
    "lines": "47-60",
    "snippet": "struct tnum tnum_arshift(struct tnum a, u8 min_shift, u8 insn_bitness)\n{\n\t/* if a.value is negative, arithmetic shifting by minimum shift\n\t * will have larger negative offset compared to more shifting.\n\t * If a.value is nonnegative, arithmetic shifting by minimum shift\n\t * will have larger positive offset compare to more shifting.\n\t */\n\tif (insn_bitness == 32)\n\t\treturn TNUM((u32)(((s32)a.value) >> min_shift),\n\t\t\t    (u32)(((s32)a.mask)  >> min_shift));\n\telse\n\t\treturn TNUM((s64)a.value >> min_shift,\n\t\t\t    (s64)a.mask  >> min_shift);\n}",
    "includes": [
      "#include <linux/tnum.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "TNUM",
          "args": [
            "(s64)a.value >> min_shift",
            "(s64)a.mask  >> min_shift"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TNUM",
          "args": [
            "(u32)(((s32)a.value) >> min_shift)",
            "(u32)(((s32)a.mask)  >> min_shift)"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "((s32)a.mask)  >> min_shift"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "((s32)a.value) >> min_shift"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/tnum.h>\n#include <linux/kernel.h>\n\nstruct tnum tnum_arshift(struct tnum a, u8 min_shift, u8 insn_bitness)\n{\n\t/* if a.value is negative, arithmetic shifting by minimum shift\n\t * will have larger negative offset compared to more shifting.\n\t * If a.value is nonnegative, arithmetic shifting by minimum shift\n\t * will have larger positive offset compare to more shifting.\n\t */\n\tif (insn_bitness == 32)\n\t\treturn TNUM((u32)(((s32)a.value) >> min_shift),\n\t\t\t    (u32)(((s32)a.mask)  >> min_shift));\n\telse\n\t\treturn TNUM((s64)a.value >> min_shift,\n\t\t\t    (s64)a.mask  >> min_shift);\n}"
  },
  {
    "function_name": "tnum_rshift",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/tnum.c",
    "lines": "42-45",
    "snippet": "struct tnum tnum_rshift(struct tnum a, u8 shift)\n{\n\treturn TNUM(a.value >> shift, a.mask >> shift);\n}",
    "includes": [
      "#include <linux/tnum.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "TNUM",
          "args": [
            "a.value >> shift",
            "a.mask >> shift"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/tnum.h>\n#include <linux/kernel.h>\n\nstruct tnum tnum_rshift(struct tnum a, u8 shift)\n{\n\treturn TNUM(a.value >> shift, a.mask >> shift);\n}"
  },
  {
    "function_name": "tnum_lshift",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/tnum.c",
    "lines": "37-40",
    "snippet": "struct tnum tnum_lshift(struct tnum a, u8 shift)\n{\n\treturn TNUM(a.value << shift, a.mask << shift);\n}",
    "includes": [
      "#include <linux/tnum.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "TNUM",
          "args": [
            "a.value << shift",
            "a.mask << shift"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/tnum.h>\n#include <linux/kernel.h>\n\nstruct tnum tnum_lshift(struct tnum a, u8 shift)\n{\n\treturn TNUM(a.value << shift, a.mask << shift);\n}"
  },
  {
    "function_name": "tnum_range",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/tnum.c",
    "lines": "21-35",
    "snippet": "struct tnum tnum_range(u64 min, u64 max)\n{\n\tu64 chi = min ^ max, delta;\n\tu8 bits = fls64(chi);\n\n\t/* special case, needed because 1ULL << 64 is undefined */\n\tif (bits > 63)\n\t\treturn tnum_unknown;\n\t/* e.g. if chi = 4, bits = 3, delta = (1<<3) - 1 = 7.\n\t * if chi = 0, bits = 0, delta = (1<<0) - 1 = 0, so we return\n\t *  constant min (since min == max).\n\t */\n\tdelta = (1ULL << bits) - 1;\n\treturn TNUM(min & ~delta, delta);\n}",
    "includes": [
      "#include <linux/tnum.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "const struct tnum tnum_unknown = { .value = 0, .mask = -1 };"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "TNUM",
          "args": [
            "min & ~delta",
            "delta"
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fls64",
          "args": [
            "chi"
          ],
          "line": 24
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/tnum.h>\n#include <linux/kernel.h>\n\nconst struct tnum tnum_unknown = { .value = 0, .mask = -1 };\n\nstruct tnum tnum_range(u64 min, u64 max)\n{\n\tu64 chi = min ^ max, delta;\n\tu8 bits = fls64(chi);\n\n\t/* special case, needed because 1ULL << 64 is undefined */\n\tif (bits > 63)\n\t\treturn tnum_unknown;\n\t/* e.g. if chi = 4, bits = 3, delta = (1<<3) - 1 = 7.\n\t * if chi = 0, bits = 0, delta = (1<<0) - 1 = 0, so we return\n\t *  constant min (since min == max).\n\t */\n\tdelta = (1ULL << bits) - 1;\n\treturn TNUM(min & ~delta, delta);\n}"
  },
  {
    "function_name": "tnum_const",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/bpf/tnum.c",
    "lines": "16-19",
    "snippet": "struct tnum tnum_const(u64 value)\n{\n\treturn TNUM(value, 0);\n}",
    "includes": [
      "#include <linux/tnum.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "TNUM",
          "args": [
            "value",
            "0"
          ],
          "line": 18
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <linux/tnum.h>\n#include <linux/kernel.h>\n\nstruct tnum tnum_const(u64 value)\n{\n\treturn TNUM(value, 0);\n}"
  }
]