[
  {
    "function_name": "rcu_init",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/tiny.c",
    "lines": "220-224",
    "snippet": "void __init rcu_init(void)\n{\n\topen_softirq(RCU_SOFTIRQ, rcu_process_callbacks);\n\trcu_early_boot_tests();\n}",
    "includes": [
      "#include \"rcu.h\"",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/prefetch.h>",
      "#include <linux/cpu.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/types.h>",
      "#include <linux/sched.h>",
      "#include <linux/mutex.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/rcupdate_wait.h>",
      "#include <linux/notifier.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_early_boot_tests",
          "args": [],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_early_boot_tests",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/update.c",
          "lines": "581-581",
          "snippet": "void rcu_early_boot_tests(void) {}",
          "includes": [
            "#include \"tasks.h\"",
            "#include \"rcu.h\"",
            "#include <linux/rcupdate_trace.h>",
            "#include <linux/irq_work.h>",
            "#include <linux/slab.h>",
            "#include <linux/kprobes.h>",
            "#include <linux/sched/isolation.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/tick.h>",
            "#include <linux/kthread.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/delay.h>",
            "#include <linux/hardirq.h>",
            "#include <linux/export.h>",
            "#include <linux/mutex.h>",
            "#include <linux/cpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/percpu.h>",
            "#include <linux/bitops.h>",
            "#include <linux/atomic.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/smp.h>",
            "#include <linux/spinlock.h>",
            "#include <linux/init.h>",
            "#include <linux/kernel.h>",
            "#include <linux/types.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tasks.h\"\n#include \"rcu.h\"\n#include <linux/rcupdate_trace.h>\n#include <linux/irq_work.h>\n#include <linux/slab.h>\n#include <linux/kprobes.h>\n#include <linux/sched/isolation.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/tick.h>\n#include <linux/kthread.h>\n#include <linux/moduleparam.h>\n#include <linux/delay.h>\n#include <linux/hardirq.h>\n#include <linux/export.h>\n#include <linux/mutex.h>\n#include <linux/cpu.h>\n#include <linux/notifier.h>\n#include <linux/percpu.h>\n#include <linux/bitops.h>\n#include <linux/atomic.h>\n#include <linux/sched/debug.h>\n#include <linux/sched/signal.h>\n#include <linux/interrupt.h>\n#include <linux/smp.h>\n#include <linux/spinlock.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n#include <linux/types.h>\n\nvoid rcu_early_boot_tests(void) {}"
        }
      },
      {
        "call_info": {
          "callee": "open_softirq",
          "args": [
            "RCU_SOFTIRQ",
            "rcu_process_callbacks"
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "open_softirq",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/softirq.c",
          "lines": "703-706",
          "snippet": "void open_softirq(int nr, void (*action)(struct softirq_action *))\n{\n\tsoftirq_vec[nr].action = action;\n}",
          "includes": [
            "#include <trace/events/irq.h>",
            "#include <asm/softirq_stack.h>",
            "#include <linux/wait_bit.h>",
            "#include <linux/irq.h>",
            "#include <linux/tick.h>",
            "#include <linux/smpboot.h>",
            "#include <linux/smp.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/kthread.h>",
            "#include <linux/freezer.h>",
            "#include <linux/cpu.h>",
            "#include <linux/percpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/mm.h>",
            "#include <linux/local_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct softirq_action softirq_vec[NR_SOFTIRQS]"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/irq.h>\n#include <asm/softirq_stack.h>\n#include <linux/wait_bit.h>\n#include <linux/irq.h>\n#include <linux/tick.h>\n#include <linux/smpboot.h>\n#include <linux/smp.h>\n#include <linux/ftrace.h>\n#include <linux/rcupdate.h>\n#include <linux/kthread.h>\n#include <linux/freezer.h>\n#include <linux/cpu.h>\n#include <linux/percpu.h>\n#include <linux/notifier.h>\n#include <linux/mm.h>\n#include <linux/local_lock.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/kernel_stat.h>\n#include <linux/export.h>\n\nstatic struct softirq_action softirq_vec[NR_SOFTIRQS];\n\nvoid open_softirq(int nr, void (*action)(struct softirq_action *))\n{\n\tsoftirq_vec[nr].action = action;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu.h\"\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/prefetch.h>\n#include <linux/cpu.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/types.h>\n#include <linux/sched.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/notifier.h>\n#include <linux/interrupt.h>\n#include <linux/completion.h>\n\nvoid __init rcu_init(void)\n{\n\topen_softirq(RCU_SOFTIRQ, rcu_process_callbacks);\n\trcu_early_boot_tests();\n}"
  },
  {
    "function_name": "poll_state_synchronize_rcu",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/tiny.c",
    "lines": "214-217",
    "snippet": "bool poll_state_synchronize_rcu(unsigned long oldstate)\n{\n\treturn READ_ONCE(rcu_ctrlblk.gp_seq) != oldstate;\n}",
    "includes": [
      "#include \"rcu.h\"",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/prefetch.h>",
      "#include <linux/cpu.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/types.h>",
      "#include <linux/sched.h>",
      "#include <linux/mutex.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/rcupdate_wait.h>",
      "#include <linux/notifier.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct rcu_ctrlblk rcu_ctrlblk = {\n\t.donetail\t= &rcu_ctrlblk.rcucblist,\n\t.curtail\t= &rcu_ctrlblk.rcucblist,\n\t.gp_seq\t\t= 0 - 300UL,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "READ_ONCE",
          "args": [
            "rcu_ctrlblk.gp_seq"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rcu.h\"\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/prefetch.h>\n#include <linux/cpu.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/types.h>\n#include <linux/sched.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/notifier.h>\n#include <linux/interrupt.h>\n#include <linux/completion.h>\n\nstatic struct rcu_ctrlblk rcu_ctrlblk = {\n\t.donetail\t= &rcu_ctrlblk.rcucblist,\n\t.curtail\t= &rcu_ctrlblk.rcucblist,\n\t.gp_seq\t\t= 0 - 300UL,\n};\n\nbool poll_state_synchronize_rcu(unsigned long oldstate)\n{\n\treturn READ_ONCE(rcu_ctrlblk.gp_seq) != oldstate;\n}"
  },
  {
    "function_name": "start_poll_synchronize_rcu",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/tiny.c",
    "lines": "197-206",
    "snippet": "unsigned long start_poll_synchronize_rcu(void)\n{\n\tunsigned long gp_seq = get_state_synchronize_rcu();\n\n\tif (unlikely(is_idle_task(current))) {\n\t\t/* force scheduling for rcu_qs() */\n\t\tresched_cpu(0);\n\t}\n\treturn gp_seq;\n}",
    "includes": [
      "#include \"rcu.h\"",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/prefetch.h>",
      "#include <linux/cpu.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/types.h>",
      "#include <linux/sched.h>",
      "#include <linux/mutex.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/rcupdate_wait.h>",
      "#include <linux/notifier.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "resched_cpu",
          "args": [
            "0"
          ],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "resched_cpu",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/core.c",
          "lines": "1000-1009",
          "snippet": "void resched_cpu(int cpu)\n{\n\tstruct rq *rq = cpu_rq(cpu);\n\tunsigned long flags;\n\n\traw_spin_rq_lock_irqsave(rq, flags);\n\tif (cpu_online(cpu) || cpu == smp_processor_id())\n\t\tresched_curr(rq);\n\traw_spin_rq_unlock_irqrestore(rq, flags);\n}",
          "includes": [
            "#include <linux/entry-common.h>",
            "#include \"features.h\"",
            "#include \"smp.h\"",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../../fs/io-wq.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/scs.h>",
            "#include <linux/kcov.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\"",
            "#include <trace/events/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/entry-common.h>\n#include \"features.h\"\n#include \"smp.h\"\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../../fs/io-wq.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/scs.h>\n#include <linux/kcov.h>\n#include <linux/blkdev.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n#include <trace/events/sched.h>\n\nstatic __always_inline struct;\n\nvoid resched_cpu(int cpu)\n{\n\tstruct rq *rq = cpu_rq(cpu);\n\tunsigned long flags;\n\n\traw_spin_rq_lock_irqsave(rq, flags);\n\tif (cpu_online(cpu) || cpu == smp_processor_id())\n\t\tresched_curr(rq);\n\traw_spin_rq_unlock_irqrestore(rq, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "is_idle_task(current)"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_idle_task",
          "args": [
            "current"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get_state_synchronize_rcu",
          "args": [],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "get_state_synchronize_rcu",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/tiny.c",
          "lines": "187-190",
          "snippet": "unsigned long get_state_synchronize_rcu(void)\n{\n\treturn READ_ONCE(rcu_ctrlblk.gp_seq);\n}",
          "includes": [
            "#include \"rcu.h\"",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/cpu.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/types.h>",
            "#include <linux/sched.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/notifier.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct rcu_ctrlblk rcu_ctrlblk = {\n\t.donetail\t= &rcu_ctrlblk.rcucblist,\n\t.curtail\t= &rcu_ctrlblk.rcucblist,\n\t.gp_seq\t\t= 0 - 300UL,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu.h\"\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/prefetch.h>\n#include <linux/cpu.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/types.h>\n#include <linux/sched.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/notifier.h>\n#include <linux/interrupt.h>\n#include <linux/completion.h>\n\nstatic struct rcu_ctrlblk rcu_ctrlblk = {\n\t.donetail\t= &rcu_ctrlblk.rcucblist,\n\t.curtail\t= &rcu_ctrlblk.rcucblist,\n\t.gp_seq\t\t= 0 - 300UL,\n};\n\nunsigned long get_state_synchronize_rcu(void)\n{\n\treturn READ_ONCE(rcu_ctrlblk.gp_seq);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu.h\"\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/prefetch.h>\n#include <linux/cpu.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/types.h>\n#include <linux/sched.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/notifier.h>\n#include <linux/interrupt.h>\n#include <linux/completion.h>\n\nunsigned long start_poll_synchronize_rcu(void)\n{\n\tunsigned long gp_seq = get_state_synchronize_rcu();\n\n\tif (unlikely(is_idle_task(current))) {\n\t\t/* force scheduling for rcu_qs() */\n\t\tresched_cpu(0);\n\t}\n\treturn gp_seq;\n}"
  },
  {
    "function_name": "get_state_synchronize_rcu",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/tiny.c",
    "lines": "187-190",
    "snippet": "unsigned long get_state_synchronize_rcu(void)\n{\n\treturn READ_ONCE(rcu_ctrlblk.gp_seq);\n}",
    "includes": [
      "#include \"rcu.h\"",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/prefetch.h>",
      "#include <linux/cpu.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/types.h>",
      "#include <linux/sched.h>",
      "#include <linux/mutex.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/rcupdate_wait.h>",
      "#include <linux/notifier.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct rcu_ctrlblk rcu_ctrlblk = {\n\t.donetail\t= &rcu_ctrlblk.rcucblist,\n\t.curtail\t= &rcu_ctrlblk.rcucblist,\n\t.gp_seq\t\t= 0 - 300UL,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "READ_ONCE",
          "args": [
            "rcu_ctrlblk.gp_seq"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rcu.h\"\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/prefetch.h>\n#include <linux/cpu.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/types.h>\n#include <linux/sched.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/notifier.h>\n#include <linux/interrupt.h>\n#include <linux/completion.h>\n\nstatic struct rcu_ctrlblk rcu_ctrlblk = {\n\t.donetail\t= &rcu_ctrlblk.rcucblist,\n\t.curtail\t= &rcu_ctrlblk.rcucblist,\n\t.gp_seq\t\t= 0 - 300UL,\n};\n\nunsigned long get_state_synchronize_rcu(void)\n{\n\treturn READ_ONCE(rcu_ctrlblk.gp_seq);\n}"
  },
  {
    "function_name": "call_rcu",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/tiny.c",
    "lines": "163-180",
    "snippet": "void call_rcu(struct rcu_head *head, rcu_callback_t func)\n{\n\tunsigned long flags;\n\n\tdebug_rcu_head_queue(head);\n\thead->func = func;\n\thead->next = NULL;\n\n\tlocal_irq_save(flags);\n\t*rcu_ctrlblk.curtail = head;\n\trcu_ctrlblk.curtail = &head->next;\n\tlocal_irq_restore(flags);\n\n\tif (unlikely(is_idle_task(current))) {\n\t\t/* force scheduling for rcu_qs() */\n\t\tresched_cpu(0);\n\t}\n}",
    "includes": [
      "#include \"rcu.h\"",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/prefetch.h>",
      "#include <linux/cpu.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/types.h>",
      "#include <linux/sched.h>",
      "#include <linux/mutex.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/rcupdate_wait.h>",
      "#include <linux/notifier.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct rcu_ctrlblk rcu_ctrlblk = {\n\t.donetail\t= &rcu_ctrlblk.rcucblist,\n\t.curtail\t= &rcu_ctrlblk.rcucblist,\n\t.gp_seq\t\t= 0 - 300UL,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "resched_cpu",
          "args": [
            "0"
          ],
          "line": 178
        },
        "resolved": true,
        "details": {
          "function_name": "resched_cpu",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/core.c",
          "lines": "1000-1009",
          "snippet": "void resched_cpu(int cpu)\n{\n\tstruct rq *rq = cpu_rq(cpu);\n\tunsigned long flags;\n\n\traw_spin_rq_lock_irqsave(rq, flags);\n\tif (cpu_online(cpu) || cpu == smp_processor_id())\n\t\tresched_curr(rq);\n\traw_spin_rq_unlock_irqrestore(rq, flags);\n}",
          "includes": [
            "#include <linux/entry-common.h>",
            "#include \"features.h\"",
            "#include \"smp.h\"",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../../fs/io-wq.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/scs.h>",
            "#include <linux/kcov.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\"",
            "#include <trace/events/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/entry-common.h>\n#include \"features.h\"\n#include \"smp.h\"\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../../fs/io-wq.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/scs.h>\n#include <linux/kcov.h>\n#include <linux/blkdev.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n#include <trace/events/sched.h>\n\nstatic __always_inline struct;\n\nvoid resched_cpu(int cpu)\n{\n\tstruct rq *rq = cpu_rq(cpu);\n\tunsigned long flags;\n\n\traw_spin_rq_lock_irqsave(rq, flags);\n\tif (cpu_online(cpu) || cpu == smp_processor_id())\n\t\tresched_curr(rq);\n\traw_spin_rq_unlock_irqrestore(rq, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlikely",
          "args": [
            "is_idle_task(current)"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "is_idle_task",
          "args": [
            "current"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local_irq_restore",
          "args": [
            "flags"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local_irq_save",
          "args": [
            "flags"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug_rcu_head_queue",
          "args": [
            "head"
          ],
          "line": 167
        },
        "resolved": true,
        "details": {
          "function_name": "debug_rcu_head_queue",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu.h",
          "lines": "191-194",
          "snippet": "static inline int debug_rcu_head_queue(struct rcu_head *head)\n{\n\treturn 0;\n}",
          "includes": [
            "#include <linux/rcu_node_tree.h>",
            "#include <trace/events/rcu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_node_tree.h>\n#include <trace/events/rcu.h>\n\nstatic inline int debug_rcu_head_queue(struct rcu_head *head)\n{\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu.h\"\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/prefetch.h>\n#include <linux/cpu.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/types.h>\n#include <linux/sched.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/notifier.h>\n#include <linux/interrupt.h>\n#include <linux/completion.h>\n\nstatic struct rcu_ctrlblk rcu_ctrlblk = {\n\t.donetail\t= &rcu_ctrlblk.rcucblist,\n\t.curtail\t= &rcu_ctrlblk.rcucblist,\n\t.gp_seq\t\t= 0 - 300UL,\n};\n\nvoid call_rcu(struct rcu_head *head, rcu_callback_t func)\n{\n\tunsigned long flags;\n\n\tdebug_rcu_head_queue(head);\n\thead->func = func;\n\thead->next = NULL;\n\n\tlocal_irq_save(flags);\n\t*rcu_ctrlblk.curtail = head;\n\trcu_ctrlblk.curtail = &head->next;\n\tlocal_irq_restore(flags);\n\n\tif (unlikely(is_idle_task(current))) {\n\t\t/* force scheduling for rcu_qs() */\n\t\tresched_cpu(0);\n\t}\n}"
  },
  {
    "function_name": "synchronize_rcu",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/tiny.c",
    "lines": "149-155",
    "snippet": "void synchronize_rcu(void)\n{\n\tRCU_LOCKDEP_WARN(lock_is_held(&rcu_bh_lock_map) ||\n\t\t\t lock_is_held(&rcu_lock_map) ||\n\t\t\t lock_is_held(&rcu_sched_lock_map),\n\t\t\t \"Illegal synchronize_rcu() in RCU read-side critical section\");\n}",
    "includes": [
      "#include \"rcu.h\"",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/prefetch.h>",
      "#include <linux/cpu.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/types.h>",
      "#include <linux/sched.h>",
      "#include <linux/mutex.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/rcupdate_wait.h>",
      "#include <linux/notifier.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "RCU_LOCKDEP_WARN",
          "args": [
            "lock_is_held(&rcu_bh_lock_map) ||\n\t\t\t lock_is_held(&rcu_lock_map) ||\n\t\t\t lock_is_held(&rcu_sched_lock_map)",
            "\"Illegal synchronize_rcu() in RCU read-side critical section\""
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lock_is_held",
          "args": [
            "&rcu_sched_lock_map"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lock_is_held",
          "args": [
            "&rcu_lock_map"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lock_is_held",
          "args": [
            "&rcu_bh_lock_map"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rcu.h\"\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/prefetch.h>\n#include <linux/cpu.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/types.h>\n#include <linux/sched.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/notifier.h>\n#include <linux/interrupt.h>\n#include <linux/completion.h>\n\nvoid synchronize_rcu(void)\n{\n\tRCU_LOCKDEP_WARN(lock_is_held(&rcu_bh_lock_map) ||\n\t\t\t lock_is_held(&rcu_lock_map) ||\n\t\t\t lock_is_held(&rcu_sched_lock_map),\n\t\t\t \"Illegal synchronize_rcu() in RCU read-side critical section\");\n}"
  },
  {
    "function_name": "rcu_process_callbacks",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/tiny.c",
    "lines": "107-137",
    "snippet": "static __latent_entropy void rcu_process_callbacks(struct softirq_action *unused)\n{\n\tstruct rcu_head *next, *list;\n\tunsigned long flags;\n\n\t/* Move the ready-to-invoke callbacks to a local list. */\n\tlocal_irq_save(flags);\n\tif (rcu_ctrlblk.donetail == &rcu_ctrlblk.rcucblist) {\n\t\t/* No callbacks ready, so just leave. */\n\t\tlocal_irq_restore(flags);\n\t\treturn;\n\t}\n\tlist = rcu_ctrlblk.rcucblist;\n\trcu_ctrlblk.rcucblist = *rcu_ctrlblk.donetail;\n\t*rcu_ctrlblk.donetail = NULL;\n\tif (rcu_ctrlblk.curtail == rcu_ctrlblk.donetail)\n\t\trcu_ctrlblk.curtail = &rcu_ctrlblk.rcucblist;\n\trcu_ctrlblk.donetail = &rcu_ctrlblk.rcucblist;\n\tlocal_irq_restore(flags);\n\n\t/* Invoke the callbacks on the local list. */\n\twhile (list) {\n\t\tnext = list->next;\n\t\tprefetch(next);\n\t\tdebug_rcu_head_unqueue(list);\n\t\tlocal_bh_disable();\n\t\trcu_reclaim_tiny(list);\n\t\tlocal_bh_enable();\n\t\tlist = next;\n\t}\n}",
    "includes": [
      "#include \"rcu.h\"",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/prefetch.h>",
      "#include <linux/cpu.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/types.h>",
      "#include <linux/sched.h>",
      "#include <linux/mutex.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/rcupdate_wait.h>",
      "#include <linux/notifier.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct rcu_ctrlblk rcu_ctrlblk = {\n\t.donetail\t= &rcu_ctrlblk.rcucblist,\n\t.curtail\t= &rcu_ctrlblk.rcucblist,\n\t.gp_seq\t\t= 0 - 300UL,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "local_bh_enable",
          "args": [],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "_local_bh_enable",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/softirq.c",
          "lines": "353-357",
          "snippet": "void _local_bh_enable(void)\n{\n\tWARN_ON_ONCE(in_irq());\n\t__local_bh_enable(SOFTIRQ_DISABLE_OFFSET);\n}",
          "includes": [
            "#include <trace/events/irq.h>",
            "#include <asm/softirq_stack.h>",
            "#include <linux/wait_bit.h>",
            "#include <linux/irq.h>",
            "#include <linux/tick.h>",
            "#include <linux/smpboot.h>",
            "#include <linux/smp.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/kthread.h>",
            "#include <linux/freezer.h>",
            "#include <linux/cpu.h>",
            "#include <linux/percpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/mm.h>",
            "#include <linux/local_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/irq.h>\n#include <asm/softirq_stack.h>\n#include <linux/wait_bit.h>\n#include <linux/irq.h>\n#include <linux/tick.h>\n#include <linux/smpboot.h>\n#include <linux/smp.h>\n#include <linux/ftrace.h>\n#include <linux/rcupdate.h>\n#include <linux/kthread.h>\n#include <linux/freezer.h>\n#include <linux/cpu.h>\n#include <linux/percpu.h>\n#include <linux/notifier.h>\n#include <linux/mm.h>\n#include <linux/local_lock.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/kernel_stat.h>\n#include <linux/export.h>\n\nvoid _local_bh_enable(void)\n{\n\tWARN_ON_ONCE(in_irq());\n\t__local_bh_enable(SOFTIRQ_DISABLE_OFFSET);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rcu_reclaim_tiny",
          "args": [
            "list"
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_reclaim_tiny",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/tiny.c",
          "lines": "85-104",
          "snippet": "static inline bool rcu_reclaim_tiny(struct rcu_head *head)\n{\n\trcu_callback_t f;\n\tunsigned long offset = (unsigned long)head->func;\n\n\trcu_lock_acquire(&rcu_callback_map);\n\tif (__is_kvfree_rcu_offset(offset)) {\n\t\ttrace_rcu_invoke_kvfree_callback(\"\", head, offset);\n\t\tkvfree((void *)head - offset);\n\t\trcu_lock_release(&rcu_callback_map);\n\t\treturn true;\n\t}\n\n\ttrace_rcu_invoke_callback(\"\", head);\n\tf = head->func;\n\tWRITE_ONCE(head->func, (rcu_callback_t)0L);\n\tf(head);\n\trcu_lock_release(&rcu_callback_map);\n\treturn false;\n}",
          "includes": [
            "#include \"rcu.h\"",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/cpu.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/types.h>",
            "#include <linux/sched.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/notifier.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu.h\"\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/prefetch.h>\n#include <linux/cpu.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/types.h>\n#include <linux/sched.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/notifier.h>\n#include <linux/interrupt.h>\n#include <linux/completion.h>\n\nstatic inline bool rcu_reclaim_tiny(struct rcu_head *head)\n{\n\trcu_callback_t f;\n\tunsigned long offset = (unsigned long)head->func;\n\n\trcu_lock_acquire(&rcu_callback_map);\n\tif (__is_kvfree_rcu_offset(offset)) {\n\t\ttrace_rcu_invoke_kvfree_callback(\"\", head, offset);\n\t\tkvfree((void *)head - offset);\n\t\trcu_lock_release(&rcu_callback_map);\n\t\treturn true;\n\t}\n\n\ttrace_rcu_invoke_callback(\"\", head);\n\tf = head->func;\n\tWRITE_ONCE(head->func, (rcu_callback_t)0L);\n\tf(head);\n\trcu_lock_release(&rcu_callback_map);\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "local_bh_disable",
          "args": [],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "debug_rcu_head_unqueue",
          "args": [
            "list"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "debug_rcu_head_unqueue",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/rcu.h",
          "lines": "196-198",
          "snippet": "static inline void debug_rcu_head_unqueue(struct rcu_head *head)\n{\n}",
          "includes": [
            "#include <linux/rcu_node_tree.h>",
            "#include <trace/events/rcu.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/rcu_node_tree.h>\n#include <trace/events/rcu.h>\n\nstatic inline void debug_rcu_head_unqueue(struct rcu_head *head)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "prefetch",
          "args": [
            "next"
          ],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "prefetch_curr_exec_start",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/core.c",
          "lines": "5132-5141",
          "snippet": "static inline void prefetch_curr_exec_start(struct task_struct *p)\n{\n#ifdef CONFIG_FAIR_GROUP_SCHED\n\tstruct sched_entity *curr = (&p->se)->cfs_rq->curr;\n#else\n\tstruct sched_entity *curr = (&task_rq(p)->cfs)->curr;\n#endif\n\tprefetch(curr);\n\tprefetch(&curr->exec_start);\n}",
          "includes": [
            "#include <linux/entry-common.h>",
            "#include \"features.h\"",
            "#include \"smp.h\"",
            "#include \"pelt.h\"",
            "#include \"../smpboot.h\"",
            "#include \"../../fs/io-wq.h\"",
            "#include \"../workqueue_internal.h\"",
            "#include <asm/tlb.h>",
            "#include <asm/switch_to.h>",
            "#include <linux/scs.h>",
            "#include <linux/kcov.h>",
            "#include <linux/blkdev.h>",
            "#include <linux/nospec.h>",
            "#include \"sched.h\"",
            "#include <trace/events/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/entry-common.h>\n#include \"features.h\"\n#include \"smp.h\"\n#include \"pelt.h\"\n#include \"../smpboot.h\"\n#include \"../../fs/io-wq.h\"\n#include \"../workqueue_internal.h\"\n#include <asm/tlb.h>\n#include <asm/switch_to.h>\n#include <linux/scs.h>\n#include <linux/kcov.h>\n#include <linux/blkdev.h>\n#include <linux/nospec.h>\n#include \"sched.h\"\n#include <trace/events/sched.h>\n\nstatic __always_inline struct;\n\nstatic inline void prefetch_curr_exec_start(struct task_struct *p)\n{\n#ifdef CONFIG_FAIR_GROUP_SCHED\n\tstruct sched_entity *curr = (&p->se)->cfs_rq->curr;\n#else\n\tstruct sched_entity *curr = (&task_rq(p)->cfs)->curr;\n#endif\n\tprefetch(curr);\n\tprefetch(&curr->exec_start);\n}"
        }
      },
      {
        "call_info": {
          "callee": "local_irq_restore",
          "args": [
            "flags"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local_irq_restore",
          "args": [
            "flags"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "local_irq_save",
          "args": [
            "flags"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rcu.h\"\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/prefetch.h>\n#include <linux/cpu.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/types.h>\n#include <linux/sched.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/notifier.h>\n#include <linux/interrupt.h>\n#include <linux/completion.h>\n\nstatic struct rcu_ctrlblk rcu_ctrlblk = {\n\t.donetail\t= &rcu_ctrlblk.rcucblist,\n\t.curtail\t= &rcu_ctrlblk.rcucblist,\n\t.gp_seq\t\t= 0 - 300UL,\n};\n\nstatic __latent_entropy void rcu_process_callbacks(struct softirq_action *unused)\n{\n\tstruct rcu_head *next, *list;\n\tunsigned long flags;\n\n\t/* Move the ready-to-invoke callbacks to a local list. */\n\tlocal_irq_save(flags);\n\tif (rcu_ctrlblk.donetail == &rcu_ctrlblk.rcucblist) {\n\t\t/* No callbacks ready, so just leave. */\n\t\tlocal_irq_restore(flags);\n\t\treturn;\n\t}\n\tlist = rcu_ctrlblk.rcucblist;\n\trcu_ctrlblk.rcucblist = *rcu_ctrlblk.donetail;\n\t*rcu_ctrlblk.donetail = NULL;\n\tif (rcu_ctrlblk.curtail == rcu_ctrlblk.donetail)\n\t\trcu_ctrlblk.curtail = &rcu_ctrlblk.rcucblist;\n\trcu_ctrlblk.donetail = &rcu_ctrlblk.rcucblist;\n\tlocal_irq_restore(flags);\n\n\t/* Invoke the callbacks on the local list. */\n\twhile (list) {\n\t\tnext = list->next;\n\t\tprefetch(next);\n\t\tdebug_rcu_head_unqueue(list);\n\t\tlocal_bh_disable();\n\t\trcu_reclaim_tiny(list);\n\t\tlocal_bh_enable();\n\t\tlist = next;\n\t}\n}"
  },
  {
    "function_name": "rcu_reclaim_tiny",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/tiny.c",
    "lines": "85-104",
    "snippet": "static inline bool rcu_reclaim_tiny(struct rcu_head *head)\n{\n\trcu_callback_t f;\n\tunsigned long offset = (unsigned long)head->func;\n\n\trcu_lock_acquire(&rcu_callback_map);\n\tif (__is_kvfree_rcu_offset(offset)) {\n\t\ttrace_rcu_invoke_kvfree_callback(\"\", head, offset);\n\t\tkvfree((void *)head - offset);\n\t\trcu_lock_release(&rcu_callback_map);\n\t\treturn true;\n\t}\n\n\ttrace_rcu_invoke_callback(\"\", head);\n\tf = head->func;\n\tWRITE_ONCE(head->func, (rcu_callback_t)0L);\n\tf(head);\n\trcu_lock_release(&rcu_callback_map);\n\treturn false;\n}",
    "includes": [
      "#include \"rcu.h\"",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/prefetch.h>",
      "#include <linux/cpu.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/types.h>",
      "#include <linux/sched.h>",
      "#include <linux/mutex.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/rcupdate_wait.h>",
      "#include <linux/notifier.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcu_lock_release",
          "args": [
            "&rcu_callback_map"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "f",
          "args": [
            "head"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "srcu_flip",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/srcutree.c",
          "lines": "711-733",
          "snippet": "static void srcu_flip(struct srcu_struct *ssp)\n{\n\t/*\n\t * Ensure that if this updater saw a given reader's increment\n\t * from __srcu_read_lock(), that reader was using an old value\n\t * of ->srcu_idx.  Also ensure that if a given reader sees the\n\t * new value of ->srcu_idx, this updater's earlier scans cannot\n\t * have seen that reader's increments (which is OK, because this\n\t * grace period need not wait on that reader).\n\t */\n\tsmp_mb(); /* E */  /* Pairs with B and C. */\n\n\tWRITE_ONCE(ssp->srcu_idx, ssp->srcu_idx + 1);\n\n\t/*\n\t * Ensure that if the updater misses an __srcu_read_unlock()\n\t * increment, that task's next __srcu_read_lock() will see the\n\t * above counter update.  Note that both this memory barrier\n\t * and the one in srcu_readers_active_idx_check() provide the\n\t * guarantee for __srcu_read_lock().\n\t */\n\tsmp_mb(); /* D */  /* Pairs with C. */\n}",
          "includes": [
            "#include \"rcu_segcblist.h\"",
            "#include \"rcu.h\"",
            "#include <linux/srcu.h>",
            "#include <linux/module.h>",
            "#include <linux/delay.h>",
            "#include <linux/smp.h>",
            "#include <linux/sched.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/preempt.h>",
            "#include <linux/percpu.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu_segcblist.h\"\n#include \"rcu.h\"\n#include <linux/srcu.h>\n#include <linux/module.h>\n#include <linux/delay.h>\n#include <linux/smp.h>\n#include <linux/sched.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/preempt.h>\n#include <linux/percpu.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n\nstatic void srcu_flip(struct srcu_struct *ssp)\n{\n\t/*\n\t * Ensure that if this updater saw a given reader's increment\n\t * from __srcu_read_lock(), that reader was using an old value\n\t * of ->srcu_idx.  Also ensure that if a given reader sees the\n\t * new value of ->srcu_idx, this updater's earlier scans cannot\n\t * have seen that reader's increments (which is OK, because this\n\t * grace period need not wait on that reader).\n\t */\n\tsmp_mb(); /* E */  /* Pairs with B and C. */\n\n\tWRITE_ONCE(ssp->srcu_idx, ssp->srcu_idx + 1);\n\n\t/*\n\t * Ensure that if the updater misses an __srcu_read_unlock()\n\t * increment, that task's next __srcu_read_lock() will see the\n\t * above counter update.  Note that both this memory barrier\n\t * and the one in srcu_readers_active_idx_check() provide the\n\t * guarantee for __srcu_read_lock().\n\t */\n\tsmp_mb(); /* D */  /* Pairs with C. */\n}"
        }
      },
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "head->func",
            "(rcu_callback_t)0L"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trace_rcu_invoke_callback",
          "args": [
            "\"\"",
            "head"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_lock_release",
          "args": [
            "&rcu_callback_map"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kvfree",
          "args": [
            "(void *)head - offset"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trace_rcu_invoke_kvfree_callback",
          "args": [
            "\"\"",
            "head",
            "offset"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "__is_kvfree_rcu_offset",
          "args": [
            "offset"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_lock_acquire",
          "args": [
            "&rcu_callback_map"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rcu.h\"\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/prefetch.h>\n#include <linux/cpu.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/types.h>\n#include <linux/sched.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/notifier.h>\n#include <linux/interrupt.h>\n#include <linux/completion.h>\n\nstatic inline bool rcu_reclaim_tiny(struct rcu_head *head)\n{\n\trcu_callback_t f;\n\tunsigned long offset = (unsigned long)head->func;\n\n\trcu_lock_acquire(&rcu_callback_map);\n\tif (__is_kvfree_rcu_offset(offset)) {\n\t\ttrace_rcu_invoke_kvfree_callback(\"\", head, offset);\n\t\tkvfree((void *)head - offset);\n\t\trcu_lock_release(&rcu_callback_map);\n\t\treturn true;\n\t}\n\n\ttrace_rcu_invoke_callback(\"\", head);\n\tf = head->func;\n\tWRITE_ONCE(head->func, (rcu_callback_t)0L);\n\tf(head);\n\trcu_lock_release(&rcu_callback_map);\n\treturn false;\n}"
  },
  {
    "function_name": "rcu_sched_clock_irq",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/tiny.c",
    "lines": "71-79",
    "snippet": "void rcu_sched_clock_irq(int user)\n{\n\tif (user) {\n\t\trcu_qs();\n\t} else if (rcu_ctrlblk.donetail != rcu_ctrlblk.curtail) {\n\t\tset_tsk_need_resched(current);\n\t\tset_preempt_need_resched();\n\t}\n}",
    "includes": [
      "#include \"rcu.h\"",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/prefetch.h>",
      "#include <linux/cpu.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/types.h>",
      "#include <linux/sched.h>",
      "#include <linux/mutex.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/rcupdate_wait.h>",
      "#include <linux/notifier.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct rcu_ctrlblk rcu_ctrlblk = {\n\t.donetail\t= &rcu_ctrlblk.rcucblist,\n\t.curtail\t= &rcu_ctrlblk.rcucblist,\n\t.gp_seq\t\t= 0 - 300UL,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "set_preempt_need_resched",
          "args": [],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "set_tsk_need_resched",
          "args": [
            "current"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcu_qs",
          "args": [],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "rcu_qs",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/tiny.c",
          "lines": "52-63",
          "snippet": "void rcu_qs(void)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tif (rcu_ctrlblk.donetail != rcu_ctrlblk.curtail) {\n\t\trcu_ctrlblk.donetail = rcu_ctrlblk.curtail;\n\t\traise_softirq_irqoff(RCU_SOFTIRQ);\n\t}\n\tWRITE_ONCE(rcu_ctrlblk.gp_seq, rcu_ctrlblk.gp_seq + 1);\n\tlocal_irq_restore(flags);\n}",
          "includes": [
            "#include \"rcu.h\"",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/prefetch.h>",
            "#include <linux/cpu.h>",
            "#include <linux/time.h>",
            "#include <linux/init.h>",
            "#include <linux/types.h>",
            "#include <linux/sched.h>",
            "#include <linux/mutex.h>",
            "#include <linux/export.h>",
            "#include <linux/kernel.h>",
            "#include <linux/rcupdate_wait.h>",
            "#include <linux/notifier.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/completion.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static struct rcu_ctrlblk rcu_ctrlblk = {\n\t.donetail\t= &rcu_ctrlblk.rcucblist,\n\t.curtail\t= &rcu_ctrlblk.rcucblist,\n\t.gp_seq\t\t= 0 - 300UL,\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rcu.h\"\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/prefetch.h>\n#include <linux/cpu.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/types.h>\n#include <linux/sched.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/notifier.h>\n#include <linux/interrupt.h>\n#include <linux/completion.h>\n\nstatic struct rcu_ctrlblk rcu_ctrlblk = {\n\t.donetail\t= &rcu_ctrlblk.rcucblist,\n\t.curtail\t= &rcu_ctrlblk.rcucblist,\n\t.gp_seq\t\t= 0 - 300UL,\n};\n\nvoid rcu_qs(void)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tif (rcu_ctrlblk.donetail != rcu_ctrlblk.curtail) {\n\t\trcu_ctrlblk.donetail = rcu_ctrlblk.curtail;\n\t\traise_softirq_irqoff(RCU_SOFTIRQ);\n\t}\n\tWRITE_ONCE(rcu_ctrlblk.gp_seq, rcu_ctrlblk.gp_seq + 1);\n\tlocal_irq_restore(flags);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rcu.h\"\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/prefetch.h>\n#include <linux/cpu.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/types.h>\n#include <linux/sched.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/notifier.h>\n#include <linux/interrupt.h>\n#include <linux/completion.h>\n\nstatic struct rcu_ctrlblk rcu_ctrlblk = {\n\t.donetail\t= &rcu_ctrlblk.rcucblist,\n\t.curtail\t= &rcu_ctrlblk.rcucblist,\n\t.gp_seq\t\t= 0 - 300UL,\n};\n\nvoid rcu_sched_clock_irq(int user)\n{\n\tif (user) {\n\t\trcu_qs();\n\t} else if (rcu_ctrlblk.donetail != rcu_ctrlblk.curtail) {\n\t\tset_tsk_need_resched(current);\n\t\tset_preempt_need_resched();\n\t}\n}"
  },
  {
    "function_name": "rcu_qs",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/tiny.c",
    "lines": "52-63",
    "snippet": "void rcu_qs(void)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tif (rcu_ctrlblk.donetail != rcu_ctrlblk.curtail) {\n\t\trcu_ctrlblk.donetail = rcu_ctrlblk.curtail;\n\t\traise_softirq_irqoff(RCU_SOFTIRQ);\n\t}\n\tWRITE_ONCE(rcu_ctrlblk.gp_seq, rcu_ctrlblk.gp_seq + 1);\n\tlocal_irq_restore(flags);\n}",
    "includes": [
      "#include \"rcu.h\"",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/prefetch.h>",
      "#include <linux/cpu.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/types.h>",
      "#include <linux/sched.h>",
      "#include <linux/mutex.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/rcupdate_wait.h>",
      "#include <linux/notifier.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct rcu_ctrlblk rcu_ctrlblk = {\n\t.donetail\t= &rcu_ctrlblk.rcucblist,\n\t.curtail\t= &rcu_ctrlblk.rcucblist,\n\t.gp_seq\t\t= 0 - 300UL,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "local_irq_restore",
          "args": [
            "flags"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WRITE_ONCE",
          "args": [
            "rcu_ctrlblk.gp_seq",
            "rcu_ctrlblk.gp_seq + 1"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "raise_softirq_irqoff",
          "args": [
            "RCU_SOFTIRQ"
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "__raise_softirq_irqoff",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/softirq.c",
          "lines": "696-701",
          "snippet": "void __raise_softirq_irqoff(unsigned int nr)\n{\n\tlockdep_assert_irqs_disabled();\n\ttrace_softirq_raise(nr);\n\tor_softirq_pending(1UL << nr);\n}",
          "includes": [
            "#include <trace/events/irq.h>",
            "#include <asm/softirq_stack.h>",
            "#include <linux/wait_bit.h>",
            "#include <linux/irq.h>",
            "#include <linux/tick.h>",
            "#include <linux/smpboot.h>",
            "#include <linux/smp.h>",
            "#include <linux/ftrace.h>",
            "#include <linux/rcupdate.h>",
            "#include <linux/kthread.h>",
            "#include <linux/freezer.h>",
            "#include <linux/cpu.h>",
            "#include <linux/percpu.h>",
            "#include <linux/notifier.h>",
            "#include <linux/mm.h>",
            "#include <linux/local_lock.h>",
            "#include <linux/init.h>",
            "#include <linux/interrupt.h>",
            "#include <linux/kernel_stat.h>",
            "#include <linux/export.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <trace/events/irq.h>\n#include <asm/softirq_stack.h>\n#include <linux/wait_bit.h>\n#include <linux/irq.h>\n#include <linux/tick.h>\n#include <linux/smpboot.h>\n#include <linux/smp.h>\n#include <linux/ftrace.h>\n#include <linux/rcupdate.h>\n#include <linux/kthread.h>\n#include <linux/freezer.h>\n#include <linux/cpu.h>\n#include <linux/percpu.h>\n#include <linux/notifier.h>\n#include <linux/mm.h>\n#include <linux/local_lock.h>\n#include <linux/init.h>\n#include <linux/interrupt.h>\n#include <linux/kernel_stat.h>\n#include <linux/export.h>\n\nvoid __raise_softirq_irqoff(unsigned int nr)\n{\n\tlockdep_assert_irqs_disabled();\n\ttrace_softirq_raise(nr);\n\tor_softirq_pending(1UL << nr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "local_irq_save",
          "args": [
            "flags"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rcu.h\"\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/prefetch.h>\n#include <linux/cpu.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/types.h>\n#include <linux/sched.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/notifier.h>\n#include <linux/interrupt.h>\n#include <linux/completion.h>\n\nstatic struct rcu_ctrlblk rcu_ctrlblk = {\n\t.donetail\t= &rcu_ctrlblk.rcucblist,\n\t.curtail\t= &rcu_ctrlblk.rcucblist,\n\t.gp_seq\t\t= 0 - 300UL,\n};\n\nvoid rcu_qs(void)\n{\n\tunsigned long flags;\n\n\tlocal_irq_save(flags);\n\tif (rcu_ctrlblk.donetail != rcu_ctrlblk.curtail) {\n\t\trcu_ctrlblk.donetail = rcu_ctrlblk.curtail;\n\t\traise_softirq_irqoff(RCU_SOFTIRQ);\n\t}\n\tWRITE_ONCE(rcu_ctrlblk.gp_seq, rcu_ctrlblk.gp_seq + 1);\n\tlocal_irq_restore(flags);\n}"
  },
  {
    "function_name": "rcu_barrier",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/rcu/tiny.c",
    "lines": "45-48",
    "snippet": "void rcu_barrier(void)\n{\n\twait_rcu_gp(call_rcu);\n}",
    "includes": [
      "#include \"rcu.h\"",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/prefetch.h>",
      "#include <linux/cpu.h>",
      "#include <linux/time.h>",
      "#include <linux/init.h>",
      "#include <linux/types.h>",
      "#include <linux/sched.h>",
      "#include <linux/mutex.h>",
      "#include <linux/export.h>",
      "#include <linux/kernel.h>",
      "#include <linux/rcupdate_wait.h>",
      "#include <linux/notifier.h>",
      "#include <linux/interrupt.h>",
      "#include <linux/completion.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wait_rcu_gp",
          "args": [
            "call_rcu"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rcu.h\"\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/prefetch.h>\n#include <linux/cpu.h>\n#include <linux/time.h>\n#include <linux/init.h>\n#include <linux/types.h>\n#include <linux/sched.h>\n#include <linux/mutex.h>\n#include <linux/export.h>\n#include <linux/kernel.h>\n#include <linux/rcupdate_wait.h>\n#include <linux/notifier.h>\n#include <linux/interrupt.h>\n#include <linux/completion.h>\n\nvoid rcu_barrier(void)\n{\n\twait_rcu_gp(call_rcu);\n}"
  }
]