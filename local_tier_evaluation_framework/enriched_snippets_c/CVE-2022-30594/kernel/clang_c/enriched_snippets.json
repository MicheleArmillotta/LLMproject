[
  {
    "function_name": "convert_to_gcda",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/gcov/clang.c",
    "lines": "366-391",
    "snippet": "size_t convert_to_gcda(char *buffer, struct gcov_info *info)\n{\n\tstruct gcov_fn_info *fi_ptr;\n\tsize_t pos = 0;\n\n\t/* File header. */\n\tpos += store_gcov_u32(buffer, pos, GCOV_DATA_MAGIC);\n\tpos += store_gcov_u32(buffer, pos, info->version);\n\tpos += store_gcov_u32(buffer, pos, info->checksum);\n\n\tlist_for_each_entry(fi_ptr, &info->functions, head) {\n\t\tu32 i;\n\n\t\tpos += store_gcov_u32(buffer, pos, GCOV_TAG_FUNCTION);\n\t\tpos += store_gcov_u32(buffer, pos, 3);\n\t\tpos += store_gcov_u32(buffer, pos, fi_ptr->ident);\n\t\tpos += store_gcov_u32(buffer, pos, fi_ptr->checksum);\n\t\tpos += store_gcov_u32(buffer, pos, fi_ptr->cfg_checksum);\n\t\tpos += store_gcov_u32(buffer, pos, GCOV_TAG_COUNTER_BASE);\n\t\tpos += store_gcov_u32(buffer, pos, fi_ptr->num_counters * 2);\n\t\tfor (i = 0; i < fi_ptr->num_counters; i++)\n\t\t\tpos += store_gcov_u64(buffer, pos, fi_ptr->counters[i]);\n\t}\n\n\treturn pos;\n}",
    "includes": [
      "#include \"gcov.h\"",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/printk.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "store_gcov_u64",
          "args": [
            "buffer",
            "pos",
            "fi_ptr->counters[i]"
          ],
          "line": 387
        },
        "resolved": true,
        "details": {
          "function_name": "store_gcov_u64",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/gcov/base.c",
          "lines": "87-99",
          "snippet": "size_t store_gcov_u64(void *buffer, size_t off, u64 v)\n{\n\tu32 *data;\n\n\tif (buffer) {\n\t\tdata = buffer + off;\n\n\t\tdata[0] = (v & 0xffffffffUL);\n\t\tdata[1] = (v >> 32);\n\t}\n\n\treturn sizeof(*data) * 2;\n}",
          "includes": [
            "#include \"gcov.h\"",
            "#include <linux/sched.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"gcov.h\"\n#include <linux/sched.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/init.h>\n\nsize_t store_gcov_u64(void *buffer, size_t off, u64 v)\n{\n\tu32 *data;\n\n\tif (buffer) {\n\t\tdata = buffer + off;\n\n\t\tdata[0] = (v & 0xffffffffUL);\n\t\tdata[1] = (v >> 32);\n\t}\n\n\treturn sizeof(*data) * 2;\n}"
        }
      },
      {
        "call_info": {
          "callee": "store_gcov_u32",
          "args": [
            "buffer",
            "pos",
            "fi_ptr->num_counters * 2"
          ],
          "line": 385
        },
        "resolved": true,
        "details": {
          "function_name": "store_gcov_u32",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/gcov/base.c",
          "lines": "63-73",
          "snippet": "size_t store_gcov_u32(void *buffer, size_t off, u32 v)\n{\n\tu32 *data;\n\n\tif (buffer) {\n\t\tdata = buffer + off;\n\t\t*data = v;\n\t}\n\n\treturn sizeof(*data);\n}",
          "includes": [
            "#include \"gcov.h\"",
            "#include <linux/sched.h>",
            "#include <linux/mutex.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"gcov.h\"\n#include <linux/sched.h>\n#include <linux/mutex.h>\n#include <linux/module.h>\n#include <linux/init.h>\n\nsize_t store_gcov_u32(void *buffer, size_t off, u32 v)\n{\n\tu32 *data;\n\n\tif (buffer) {\n\t\tdata = buffer + off;\n\t\t*data = v;\n\t}\n\n\treturn sizeof(*data);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "fi_ptr",
            "&info->functions",
            "head"
          ],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"gcov.h\"\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/ratelimit.h>\n#include <linux/printk.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n\nsize_t convert_to_gcda(char *buffer, struct gcov_info *info)\n{\n\tstruct gcov_fn_info *fi_ptr;\n\tsize_t pos = 0;\n\n\t/* File header. */\n\tpos += store_gcov_u32(buffer, pos, GCOV_DATA_MAGIC);\n\tpos += store_gcov_u32(buffer, pos, info->version);\n\tpos += store_gcov_u32(buffer, pos, info->checksum);\n\n\tlist_for_each_entry(fi_ptr, &info->functions, head) {\n\t\tu32 i;\n\n\t\tpos += store_gcov_u32(buffer, pos, GCOV_TAG_FUNCTION);\n\t\tpos += store_gcov_u32(buffer, pos, 3);\n\t\tpos += store_gcov_u32(buffer, pos, fi_ptr->ident);\n\t\tpos += store_gcov_u32(buffer, pos, fi_ptr->checksum);\n\t\tpos += store_gcov_u32(buffer, pos, fi_ptr->cfg_checksum);\n\t\tpos += store_gcov_u32(buffer, pos, GCOV_TAG_COUNTER_BASE);\n\t\tpos += store_gcov_u32(buffer, pos, fi_ptr->num_counters * 2);\n\t\tfor (i = 0; i < fi_ptr->num_counters; i++)\n\t\t\tpos += store_gcov_u64(buffer, pos, fi_ptr->counters[i]);\n\t}\n\n\treturn pos;\n}"
  },
  {
    "function_name": "gcov_info_free",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/gcov/clang.c",
    "lines": "346-357",
    "snippet": "void gcov_info_free(struct gcov_info *info)\n{\n\tstruct gcov_fn_info *fn, *tmp;\n\n\tlist_for_each_entry_safe(fn, tmp, &info->functions, head) {\n\t\tkvfree(fn->counters);\n\t\tlist_del(&fn->head);\n\t\tkfree(fn);\n\t}\n\tkfree(info->filename);\n\tkfree(info);\n}",
    "includes": [
      "#include \"gcov.h\"",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/printk.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "info"
          ],
          "line": 356
        },
        "resolved": true,
        "details": {
          "function_name": "maybe_kfree_parameter",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/params.c",
          "lines": "62-75",
          "snippet": "static void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}",
          "includes": [
            "#include <linux/security.h>",
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(kmalloced_params);",
            "static DEFINE_SPINLOCK(kmalloced_params_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/security.h>\n#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(kmalloced_params);\nstatic DEFINE_SPINLOCK(kmalloced_params_lock);\n\nstatic void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_del",
          "args": [
            "&fn->head"
          ],
          "line": 352
        },
        "resolved": true,
        "details": {
          "function_name": "list_del_leaf_cfs_rq",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/sched/fair.c",
          "lines": "475-477",
          "snippet": "static inline void list_del_leaf_cfs_rq(struct cfs_rq *cfs_rq)\n{\n}",
          "includes": [
            "#include \"pelt.h\"",
            "#include \"sched.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static bool sched_idle_cfs_rq(struct cfs_rq *cfs_rq);",
            "static void check_enqueue_throttle(struct cfs_rq *cfs_rq);",
            "static __always_inline void return_cfs_rq_runtime(struct cfs_rq *cfs_rq);",
            "static bool check_cfs_rq_runtime(struct cfs_rq *cfs_rq);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"pelt.h\"\n#include \"sched.h\"\n\nstatic bool sched_idle_cfs_rq(struct cfs_rq *cfs_rq);\nstatic void check_enqueue_throttle(struct cfs_rq *cfs_rq);\nstatic __always_inline void return_cfs_rq_runtime(struct cfs_rq *cfs_rq);\nstatic bool check_cfs_rq_runtime(struct cfs_rq *cfs_rq);\n\nstatic inline void list_del_leaf_cfs_rq(struct cfs_rq *cfs_rq)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "kvfree",
          "args": [
            "fn->counters"
          ],
          "line": 351
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry_safe",
          "args": [
            "fn",
            "tmp",
            "&info->functions",
            "head"
          ],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"gcov.h\"\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/ratelimit.h>\n#include <linux/printk.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n\nvoid gcov_info_free(struct gcov_info *info)\n{\n\tstruct gcov_fn_info *fn, *tmp;\n\n\tlist_for_each_entry_safe(fn, tmp, &info->functions, head) {\n\t\tkvfree(fn->counters);\n\t\tlist_del(&fn->head);\n\t\tkfree(fn);\n\t}\n\tkfree(info->filename);\n\tkfree(info);\n}"
  },
  {
    "function_name": "gcov_info_dup",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/gcov/clang.c",
    "lines": "313-340",
    "snippet": "struct gcov_info *gcov_info_dup(struct gcov_info *info)\n{\n\tstruct gcov_info *dup;\n\tstruct gcov_fn_info *fn;\n\n\tdup = kmemdup(info, sizeof(*dup), GFP_KERNEL);\n\tif (!dup)\n\t\treturn NULL;\n\tINIT_LIST_HEAD(&dup->head);\n\tINIT_LIST_HEAD(&dup->functions);\n\tdup->filename = kstrdup(info->filename, GFP_KERNEL);\n\tif (!dup->filename)\n\t\tgoto err;\n\n\tlist_for_each_entry(fn, &info->functions, head) {\n\t\tstruct gcov_fn_info *fn_dup = gcov_fn_info_dup(fn);\n\n\t\tif (!fn_dup)\n\t\t\tgoto err;\n\t\tlist_add_tail(&fn_dup->head, &dup->functions);\n\t}\n\n\treturn dup;\n\nerr:\n\tgcov_info_free(dup);\n\treturn NULL;\n}",
    "includes": [
      "#include \"gcov.h\"",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/printk.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gcov_info_free",
          "args": [
            "dup"
          ],
          "line": 338
        },
        "resolved": true,
        "details": {
          "function_name": "gcov_info_free",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/gcov/clang.c",
          "lines": "346-357",
          "snippet": "void gcov_info_free(struct gcov_info *info)\n{\n\tstruct gcov_fn_info *fn, *tmp;\n\n\tlist_for_each_entry_safe(fn, tmp, &info->functions, head) {\n\t\tkvfree(fn->counters);\n\t\tlist_del(&fn->head);\n\t\tkfree(fn);\n\t}\n\tkfree(info->filename);\n\tkfree(info);\n}",
          "includes": [
            "#include \"gcov.h\"",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/printk.h>",
            "#include <linux/list.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"gcov.h\"\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/ratelimit.h>\n#include <linux/printk.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n\nvoid gcov_info_free(struct gcov_info *info)\n{\n\tstruct gcov_fn_info *fn, *tmp;\n\n\tlist_for_each_entry_safe(fn, tmp, &info->functions, head) {\n\t\tkvfree(fn->counters);\n\t\tlist_del(&fn->head);\n\t\tkfree(fn);\n\t}\n\tkfree(info->filename);\n\tkfree(info);\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&fn_dup->head",
            "&dup->functions"
          ],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gcov_fn_info_dup",
          "args": [
            "fn"
          ],
          "line": 328
        },
        "resolved": true,
        "details": {
          "function_name": "gcov_fn_info_dup",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/gcov/clang.c",
          "lines": "286-305",
          "snippet": "static struct gcov_fn_info *gcov_fn_info_dup(struct gcov_fn_info *fn)\n{\n\tsize_t cv_size; /* counter values size */\n\tstruct gcov_fn_info *fn_dup = kmemdup(fn, sizeof(*fn),\n\t\t\tGFP_KERNEL);\n\tif (!fn_dup)\n\t\treturn NULL;\n\tINIT_LIST_HEAD(&fn_dup->head);\n\n\tcv_size = fn->num_counters * sizeof(fn->counters[0]);\n\tfn_dup->counters = kvmalloc(cv_size, GFP_KERNEL);\n\tif (!fn_dup->counters) {\n\t\tkfree(fn_dup);\n\t\treturn NULL;\n\t}\n\n\tmemcpy(fn_dup->counters, fn->counters, cv_size);\n\n\treturn fn_dup;\n}",
          "includes": [
            "#include \"gcov.h\"",
            "#include <linux/mm.h>",
            "#include <linux/slab.h>",
            "#include <linux/ratelimit.h>",
            "#include <linux/printk.h>",
            "#include <linux/list.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"gcov.h\"\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/ratelimit.h>\n#include <linux/printk.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n\nstatic struct gcov_fn_info *gcov_fn_info_dup(struct gcov_fn_info *fn)\n{\n\tsize_t cv_size; /* counter values size */\n\tstruct gcov_fn_info *fn_dup = kmemdup(fn, sizeof(*fn),\n\t\t\tGFP_KERNEL);\n\tif (!fn_dup)\n\t\treturn NULL;\n\tINIT_LIST_HEAD(&fn_dup->head);\n\n\tcv_size = fn->num_counters * sizeof(fn->counters[0]);\n\tfn_dup->counters = kvmalloc(cv_size, GFP_KERNEL);\n\tif (!fn_dup->counters) {\n\t\tkfree(fn_dup);\n\t\treturn NULL;\n\t}\n\n\tmemcpy(fn_dup->counters, fn->counters, cv_size);\n\n\treturn fn_dup;\n}"
        }
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "fn",
            "&info->functions",
            "head"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kstrdup",
          "args": [
            "info->filename",
            "GFP_KERNEL"
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&dup->functions"
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&dup->head"
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmemdup",
          "args": [
            "info",
            "sizeof(*dup)",
            "GFP_KERNEL"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"gcov.h\"\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/ratelimit.h>\n#include <linux/printk.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n\nstruct gcov_info *gcov_info_dup(struct gcov_info *info)\n{\n\tstruct gcov_info *dup;\n\tstruct gcov_fn_info *fn;\n\n\tdup = kmemdup(info, sizeof(*dup), GFP_KERNEL);\n\tif (!dup)\n\t\treturn NULL;\n\tINIT_LIST_HEAD(&dup->head);\n\tINIT_LIST_HEAD(&dup->functions);\n\tdup->filename = kstrdup(info->filename, GFP_KERNEL);\n\tif (!dup->filename)\n\t\tgoto err;\n\n\tlist_for_each_entry(fn, &info->functions, head) {\n\t\tstruct gcov_fn_info *fn_dup = gcov_fn_info_dup(fn);\n\n\t\tif (!fn_dup)\n\t\t\tgoto err;\n\t\tlist_add_tail(&fn_dup->head, &dup->functions);\n\t}\n\n\treturn dup;\n\nerr:\n\tgcov_info_free(dup);\n\treturn NULL;\n}"
  },
  {
    "function_name": "gcov_fn_info_dup",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/gcov/clang.c",
    "lines": "286-305",
    "snippet": "static struct gcov_fn_info *gcov_fn_info_dup(struct gcov_fn_info *fn)\n{\n\tsize_t cv_size; /* counter values size */\n\tstruct gcov_fn_info *fn_dup = kmemdup(fn, sizeof(*fn),\n\t\t\tGFP_KERNEL);\n\tif (!fn_dup)\n\t\treturn NULL;\n\tINIT_LIST_HEAD(&fn_dup->head);\n\n\tcv_size = fn->num_counters * sizeof(fn->counters[0]);\n\tfn_dup->counters = kvmalloc(cv_size, GFP_KERNEL);\n\tif (!fn_dup->counters) {\n\t\tkfree(fn_dup);\n\t\treturn NULL;\n\t}\n\n\tmemcpy(fn_dup->counters, fn->counters, cv_size);\n\n\treturn fn_dup;\n}",
    "includes": [
      "#include \"gcov.h\"",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/printk.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "fn_dup->counters",
            "fn->counters",
            "cv_size"
          ],
          "line": 302
        },
        "resolved": true,
        "details": {
          "function_name": "memcpy_skip",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/events/internal.h",
          "lines": "180-184",
          "snippet": "static inline unsigned long\nmemcpy_skip(void *dst, const void *src, unsigned long n)\n{\n\treturn 0;\n}",
          "includes": [
            "#include <linux/refcount.h>",
            "#include <linux/uaccess.h>",
            "#include <linux/hardirq.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <linux/refcount.h>\n#include <linux/uaccess.h>\n#include <linux/hardirq.h>\n\nstatic inline unsigned long\nmemcpy_skip(void *dst, const void *src, unsigned long n)\n{\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kfree",
          "args": [
            "fn_dup"
          ],
          "line": 298
        },
        "resolved": true,
        "details": {
          "function_name": "maybe_kfree_parameter",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/params.c",
          "lines": "62-75",
          "snippet": "static void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}",
          "includes": [
            "#include <linux/security.h>",
            "#include <linux/ctype.h>",
            "#include <linux/slab.h>",
            "#include <linux/err.h>",
            "#include <linux/device.h>",
            "#include <linux/moduleparam.h>",
            "#include <linux/module.h>",
            "#include <linux/errno.h>",
            "#include <linux/string.h>",
            "#include <linux/kernel.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static LIST_HEAD(kmalloced_params);",
            "static DEFINE_SPINLOCK(kmalloced_params_lock);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <linux/security.h>\n#include <linux/ctype.h>\n#include <linux/slab.h>\n#include <linux/err.h>\n#include <linux/device.h>\n#include <linux/moduleparam.h>\n#include <linux/module.h>\n#include <linux/errno.h>\n#include <linux/string.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(kmalloced_params);\nstatic DEFINE_SPINLOCK(kmalloced_params_lock);\n\nstatic void maybe_kfree_parameter(void *param)\n{\n\tstruct kmalloced_param *p;\n\n\tspin_lock(&kmalloced_params_lock);\n\tlist_for_each_entry(p, &kmalloced_params, list) {\n\t\tif (p->val == param) {\n\t\t\tlist_del(&p->list);\n\t\t\tkfree(p);\n\t\t\tbreak;\n\t\t}\n\t}\n\tspin_unlock(&kmalloced_params_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "kvmalloc",
          "args": [
            "cv_size",
            "GFP_KERNEL"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&fn_dup->head"
          ],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kmemdup",
          "args": [
            "fn",
            "sizeof(*fn)",
            "GFP_KERNEL"
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"gcov.h\"\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/ratelimit.h>\n#include <linux/printk.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n\nstatic struct gcov_fn_info *gcov_fn_info_dup(struct gcov_fn_info *fn)\n{\n\tsize_t cv_size; /* counter values size */\n\tstruct gcov_fn_info *fn_dup = kmemdup(fn, sizeof(*fn),\n\t\t\tGFP_KERNEL);\n\tif (!fn_dup)\n\t\treturn NULL;\n\tINIT_LIST_HEAD(&fn_dup->head);\n\n\tcv_size = fn->num_counters * sizeof(fn->counters[0]);\n\tfn_dup->counters = kvmalloc(cv_size, GFP_KERNEL);\n\tif (!fn_dup->counters) {\n\t\tkfree(fn_dup);\n\t\treturn NULL;\n\t}\n\n\tmemcpy(fn_dup->counters, fn->counters, cv_size);\n\n\treturn fn_dup;\n}"
  },
  {
    "function_name": "gcov_info_add",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/gcov/clang.c",
    "lines": "272-284",
    "snippet": "void gcov_info_add(struct gcov_info *dst, struct gcov_info *src)\n{\n\tstruct gcov_fn_info *dfn_ptr;\n\tstruct gcov_fn_info *sfn_ptr = list_first_entry_or_null(&src->functions,\n\t\t\tstruct gcov_fn_info, head);\n\n\tlist_for_each_entry(dfn_ptr, &dst->functions, head) {\n\t\tu32 i;\n\n\t\tfor (i = 0; i < sfn_ptr->num_counters; i++)\n\t\t\tdfn_ptr->counters[i] += sfn_ptr->counters[i];\n\t}\n}",
    "includes": [
      "#include \"gcov.h\"",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/printk.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "dfn_ptr",
            "&dst->functions",
            "head"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_first_entry_or_null",
          "args": [
            "&src->functions",
            "structgcov_fn_info",
            "head"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"gcov.h\"\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/ratelimit.h>\n#include <linux/printk.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n\nvoid gcov_info_add(struct gcov_info *dst, struct gcov_info *src)\n{\n\tstruct gcov_fn_info *dfn_ptr;\n\tstruct gcov_fn_info *sfn_ptr = list_first_entry_or_null(&src->functions,\n\t\t\tstruct gcov_fn_info, head);\n\n\tlist_for_each_entry(dfn_ptr, &dst->functions, head) {\n\t\tu32 i;\n\n\t\tfor (i = 0; i < sfn_ptr->num_counters; i++)\n\t\t\tdfn_ptr->counters[i] += sfn_ptr->counters[i];\n\t}\n}"
  },
  {
    "function_name": "gcov_info_is_compatible",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/gcov/clang.c",
    "lines": "241-263",
    "snippet": "int gcov_info_is_compatible(struct gcov_info *info1, struct gcov_info *info2)\n{\n\tstruct gcov_fn_info *fn_ptr1 = list_first_entry_or_null(\n\t\t\t&info1->functions, struct gcov_fn_info, head);\n\tstruct gcov_fn_info *fn_ptr2 = list_first_entry_or_null(\n\t\t\t&info2->functions, struct gcov_fn_info, head);\n\n\tif (info1->checksum != info2->checksum)\n\t\treturn false;\n\tif (!fn_ptr1)\n\t\treturn fn_ptr1 == fn_ptr2;\n\twhile (!list_is_last(&fn_ptr1->head, &info1->functions) &&\n\t\t!list_is_last(&fn_ptr2->head, &info2->functions)) {\n\t\tif (fn_ptr1->checksum != fn_ptr2->checksum)\n\t\t\treturn false;\n\t\tif (fn_ptr1->cfg_checksum != fn_ptr2->cfg_checksum)\n\t\t\treturn false;\n\t\tfn_ptr1 = list_next_entry(fn_ptr1, head);\n\t\tfn_ptr2 = list_next_entry(fn_ptr2, head);\n\t}\n\treturn list_is_last(&fn_ptr1->head, &info1->functions) &&\n\t\tlist_is_last(&fn_ptr2->head, &info2->functions);\n}",
    "includes": [
      "#include \"gcov.h\"",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/printk.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_is_last",
          "args": [
            "&fn_ptr2->head",
            "&info2->functions"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_is_last",
          "args": [
            "&fn_ptr1->head",
            "&info1->functions"
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_next_entry",
          "args": [
            "fn_ptr2",
            "head"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_next_entry",
          "args": [
            "fn_ptr1",
            "head"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_is_last",
          "args": [
            "&fn_ptr2->head",
            "&info2->functions"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_is_last",
          "args": [
            "&fn_ptr1->head",
            "&info1->functions"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_first_entry_or_null",
          "args": [
            "&info2->functions",
            "structgcov_fn_info",
            "head"
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_first_entry_or_null",
          "args": [
            "&info1->functions",
            "structgcov_fn_info",
            "head"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"gcov.h\"\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/ratelimit.h>\n#include <linux/printk.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n\nint gcov_info_is_compatible(struct gcov_info *info1, struct gcov_info *info2)\n{\n\tstruct gcov_fn_info *fn_ptr1 = list_first_entry_or_null(\n\t\t\t&info1->functions, struct gcov_fn_info, head);\n\tstruct gcov_fn_info *fn_ptr2 = list_first_entry_or_null(\n\t\t\t&info2->functions, struct gcov_fn_info, head);\n\n\tif (info1->checksum != info2->checksum)\n\t\treturn false;\n\tif (!fn_ptr1)\n\t\treturn fn_ptr1 == fn_ptr2;\n\twhile (!list_is_last(&fn_ptr1->head, &info1->functions) &&\n\t\t!list_is_last(&fn_ptr2->head, &info2->functions)) {\n\t\tif (fn_ptr1->checksum != fn_ptr2->checksum)\n\t\t\treturn false;\n\t\tif (fn_ptr1->cfg_checksum != fn_ptr2->cfg_checksum)\n\t\t\treturn false;\n\t\tfn_ptr1 = list_next_entry(fn_ptr1, head);\n\t\tfn_ptr2 = list_next_entry(fn_ptr2, head);\n\t}\n\treturn list_is_last(&fn_ptr1->head, &info1->functions) &&\n\t\tlist_is_last(&fn_ptr2->head, &info2->functions);\n}"
  },
  {
    "function_name": "gcov_info_reset",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/gcov/clang.c",
    "lines": "225-232",
    "snippet": "void gcov_info_reset(struct gcov_info *info)\n{\n\tstruct gcov_fn_info *fn;\n\n\tlist_for_each_entry(fn, &info->functions, head)\n\t\tmemset(fn->counters, 0,\n\t\t\t\tsizeof(fn->counters[0]) * fn->num_counters);\n}",
    "includes": [
      "#include \"gcov.h\"",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/printk.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "fn->counters",
            "0",
            "sizeof(fn->counters[0]) * fn->num_counters"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_for_each_entry",
          "args": [
            "fn",
            "&info->functions",
            "head"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"gcov.h\"\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/ratelimit.h>\n#include <linux/printk.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n\nvoid gcov_info_reset(struct gcov_info *info)\n{\n\tstruct gcov_fn_info *fn;\n\n\tlist_for_each_entry(fn, &info->functions, head)\n\t\tmemset(fn->counters, 0,\n\t\t\t\tsizeof(fn->counters[0]) * fn->num_counters);\n}"
  },
  {
    "function_name": "gcov_info_within_module",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/gcov/clang.c",
    "lines": "210-213",
    "snippet": "bool gcov_info_within_module(struct gcov_info *info, struct module *mod)\n{\n\treturn within_module((unsigned long)info->filename, mod);\n}",
    "includes": [
      "#include \"gcov.h\"",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/printk.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "within_module",
          "args": [
            "(unsigned long)info->filename",
            "mod"
          ],
          "line": 212
        },
        "resolved": true,
        "details": {
          "function_name": "gcov_info_within_module",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/gcov/clang.c",
          "lines": "210-213",
          "snippet": "bool gcov_info_within_module(struct gcov_info *info, struct module *mod)\n{\n\treturn within_module((unsigned long)info->filename, mod);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"gcov.h\"\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/ratelimit.h>\n#include <linux/printk.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n\nbool gcov_info_within_module(struct gcov_info *info, struct module *mod)\n{\n\treturn within_module((unsigned long)info->filename, mod);\n}"
  },
  {
    "function_name": "gcov_info_unlink",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/gcov/clang.c",
    "lines": "197-201",
    "snippet": "void gcov_info_unlink(struct gcov_info *prev, struct gcov_info *info)\n{\n\t/* Generic code unlinks while iterating. */\n\t__list_del_entry(&info->head);\n}",
    "includes": [
      "#include \"gcov.h\"",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/printk.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "__list_del_entry",
          "args": [
            "&info->head"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"gcov.h\"\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/ratelimit.h>\n#include <linux/printk.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n\nvoid gcov_info_unlink(struct gcov_info *prev, struct gcov_info *info)\n{\n\t/* Generic code unlinks while iterating. */\n\t__list_del_entry(&info->head);\n}"
  },
  {
    "function_name": "gcov_info_link",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/gcov/clang.c",
    "lines": "187-190",
    "snippet": "void gcov_info_link(struct gcov_info *info)\n{\n\tlist_add_tail(&info->head, &clang_gcov_list);\n}",
    "includes": [
      "#include \"gcov.h\"",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/printk.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(clang_gcov_list);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&info->head",
            "&clang_gcov_list"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"gcov.h\"\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/ratelimit.h>\n#include <linux/printk.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(clang_gcov_list);\n\nvoid gcov_info_link(struct gcov_info *info)\n{\n\tlist_add_tail(&info->head, &clang_gcov_list);\n}"
  },
  {
    "function_name": "gcov_info_next",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/gcov/clang.c",
    "lines": "173-181",
    "snippet": "struct gcov_info *gcov_info_next(struct gcov_info *info)\n{\n\tif (!info)\n\t\treturn list_first_entry_or_null(&clang_gcov_list,\n\t\t\t\tstruct gcov_info, head);\n\tif (list_is_last(&info->head, &clang_gcov_list))\n\t\treturn NULL;\n\treturn list_next_entry(info, head);\n}",
    "includes": [
      "#include \"gcov.h\"",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/printk.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static LIST_HEAD(clang_gcov_list);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_next_entry",
          "args": [
            "info",
            "head"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_is_last",
          "args": [
            "&info->head",
            "&clang_gcov_list"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_first_entry_or_null",
          "args": [
            "&clang_gcov_list",
            "structgcov_info",
            "head"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"gcov.h\"\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/ratelimit.h>\n#include <linux/printk.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n\nstatic LIST_HEAD(clang_gcov_list);\n\nstruct gcov_info *gcov_info_next(struct gcov_info *info)\n{\n\tif (!info)\n\t\treturn list_first_entry_or_null(&clang_gcov_list,\n\t\t\t\tstruct gcov_info, head);\n\tif (list_is_last(&info->head, &clang_gcov_list))\n\t\treturn NULL;\n\treturn list_next_entry(info, head);\n}"
  },
  {
    "function_name": "gcov_info_version",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/gcov/clang.c",
    "lines": "161-164",
    "snippet": "unsigned int gcov_info_version(struct gcov_info *info)\n{\n\treturn info->version;\n}",
    "includes": [
      "#include \"gcov.h\"",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/printk.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"gcov.h\"\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/ratelimit.h>\n#include <linux/printk.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n\nunsigned int gcov_info_version(struct gcov_info *info)\n{\n\treturn info->version;\n}"
  },
  {
    "function_name": "gcov_info_filename",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/gcov/clang.c",
    "lines": "152-155",
    "snippet": "const char *gcov_info_filename(struct gcov_info *info)\n{\n\treturn info->filename;\n}",
    "includes": [
      "#include \"gcov.h\"",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/printk.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"gcov.h\"\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/ratelimit.h>\n#include <linux/printk.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n\nconst char *gcov_info_filename(struct gcov_info *info)\n{\n\treturn info->filename;\n}"
  },
  {
    "function_name": "llvm_gcda_end_file",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/gcov/clang.c",
    "lines": "143-145",
    "snippet": "void llvm_gcda_end_file(void)\n{\n}",
    "includes": [
      "#include \"gcov.h\"",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/printk.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"gcov.h\"\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/ratelimit.h>\n#include <linux/printk.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n\nvoid llvm_gcda_end_file(void)\n{\n}"
  },
  {
    "function_name": "llvm_gcda_summary_info",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/gcov/clang.c",
    "lines": "138-140",
    "snippet": "void llvm_gcda_summary_info(void)\n{\n}",
    "includes": [
      "#include \"gcov.h\"",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/printk.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"gcov.h\"\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/ratelimit.h>\n#include <linux/printk.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n\nvoid llvm_gcda_summary_info(void)\n{\n}"
  },
  {
    "function_name": "llvm_gcda_emit_arcs",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/gcov/clang.c",
    "lines": "128-135",
    "snippet": "void llvm_gcda_emit_arcs(u32 num_counters, u64 *counters)\n{\n\tstruct gcov_fn_info *info = list_last_entry(&current_info->functions,\n\t\t\tstruct gcov_fn_info, head);\n\n\tinfo->num_counters = num_counters;\n\tinfo->counters = counters;\n}",
    "includes": [
      "#include \"gcov.h\"",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/printk.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct gcov_info *current_info;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_last_entry",
          "args": [
            "&current_info->functions",
            "structgcov_fn_info",
            "head"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"gcov.h\"\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/ratelimit.h>\n#include <linux/printk.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n\nstatic struct gcov_info *current_info;\n\nvoid llvm_gcda_emit_arcs(u32 num_counters, u64 *counters)\n{\n\tstruct gcov_fn_info *info = list_last_entry(&current_info->functions,\n\t\t\tstruct gcov_fn_info, head);\n\n\tinfo->num_counters = num_counters;\n\tinfo->counters = counters;\n}"
  },
  {
    "function_name": "llvm_gcda_emit_function",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/gcov/clang.c",
    "lines": "113-125",
    "snippet": "void llvm_gcda_emit_function(u32 ident, u32 func_checksum, u32 cfg_checksum)\n{\n\tstruct gcov_fn_info *info = kzalloc(sizeof(*info), GFP_KERNEL);\n\n\tif (!info)\n\t\treturn;\n\n\tINIT_LIST_HEAD(&info->head);\n\tinfo->ident = ident;\n\tinfo->checksum = func_checksum;\n\tinfo->cfg_checksum = cfg_checksum;\n\tlist_add_tail(&info->head, &current_info->functions);\n}",
    "includes": [
      "#include \"gcov.h\"",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/printk.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct gcov_info *current_info;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&info->head",
            "&current_info->functions"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&info->head"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(*info)",
            "GFP_KERNEL"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"gcov.h\"\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/ratelimit.h>\n#include <linux/printk.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n\nstatic struct gcov_info *current_info;\n\nvoid llvm_gcda_emit_function(u32 ident, u32 func_checksum, u32 cfg_checksum)\n{\n\tstruct gcov_fn_info *info = kzalloc(sizeof(*info), GFP_KERNEL);\n\n\tif (!info)\n\t\treturn;\n\n\tINIT_LIST_HEAD(&info->head);\n\tinfo->ident = ident;\n\tinfo->checksum = func_checksum;\n\tinfo->cfg_checksum = cfg_checksum;\n\tlist_add_tail(&info->head, &current_info->functions);\n}"
  },
  {
    "function_name": "llvm_gcda_start_file",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/gcov/clang.c",
    "lines": "105-110",
    "snippet": "void llvm_gcda_start_file(const char *orig_filename, u32 version, u32 checksum)\n{\n\tcurrent_info->filename = orig_filename;\n\tcurrent_info->version = version;\n\tcurrent_info->checksum = checksum;\n}",
    "includes": [
      "#include \"gcov.h\"",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/printk.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct gcov_info *current_info;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"gcov.h\"\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/ratelimit.h>\n#include <linux/printk.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n\nstatic struct gcov_info *current_info;\n\nvoid llvm_gcda_start_file(const char *orig_filename, u32 version, u32 checksum)\n{\n\tcurrent_info->filename = orig_filename;\n\tcurrent_info->version = version;\n\tcurrent_info->checksum = checksum;\n}"
  },
  {
    "function_name": "llvm_gcov_init",
    "container": null,
    "file": "output_repos_c/CVE-2022-30594/repo/kernel/gcov/clang.c",
    "lines": "82-102",
    "snippet": "void llvm_gcov_init(llvm_gcov_callback writeout, llvm_gcov_callback flush)\n{\n\tstruct gcov_info *info = kzalloc(sizeof(*info), GFP_KERNEL);\n\n\tif (!info)\n\t\treturn;\n\n\tINIT_LIST_HEAD(&info->head);\n\tINIT_LIST_HEAD(&info->functions);\n\n\tmutex_lock(&gcov_lock);\n\n\tlist_add_tail(&info->head, &clang_gcov_list);\n\tcurrent_info = info;\n\twriteout();\n\tcurrent_info = NULL;\n\tif (gcov_events_enabled)\n\t\tgcov_event(GCOV_ADD, info);\n\n\tmutex_unlock(&gcov_lock);\n}",
    "includes": [
      "#include \"gcov.h\"",
      "#include <linux/mm.h>",
      "#include <linux/slab.h>",
      "#include <linux/ratelimit.h>",
      "#include <linux/printk.h>",
      "#include <linux/list.h>",
      "#include <linux/kernel.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static struct gcov_info *current_info;",
      "static LIST_HEAD(clang_gcov_list);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "mutex_unlock",
          "args": [
            "&gcov_lock"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "__rt_mutex_unlock",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/rtmutex.c",
          "lines": "1350-1356",
          "snippet": "static __always_inline void __rt_mutex_unlock(struct rt_mutex_base *lock)\n{\n\tif (likely(rt_mutex_cmpxchg_release(lock, current, NULL)))\n\t\treturn;\n\n\trt_mutex_slowunlock(lock);\n}",
          "includes": [
            "# include \"ww_mutex.h\"",
            "#include \"rtmutex_common.h\"",
            "#include <linux/ww_mutex.h>",
            "#include <linux/sched/wake_q.h>",
            "#include <linux/sched/rt.h>",
            "#include <linux/sched/signal.h>",
            "#include <linux/sched/deadline.h>",
            "#include <linux/sched/debug.h>",
            "#include <linux/sched.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static __always_inline struct"
          ],
          "called_functions": [],
          "contextual_snippet": "# include \"ww_mutex.h\"\n#include \"rtmutex_common.h\"\n#include <linux/ww_mutex.h>\n#include <linux/sched/wake_q.h>\n#include <linux/sched/rt.h>\n#include <linux/sched/signal.h>\n#include <linux/sched/deadline.h>\n#include <linux/sched/debug.h>\n#include <linux/sched.h>\n\nstatic __always_inline struct;\n\nstatic __always_inline void __rt_mutex_unlock(struct rt_mutex_base *lock)\n{\n\tif (likely(rt_mutex_cmpxchg_release(lock, current, NULL)))\n\t\treturn;\n\n\trt_mutex_slowunlock(lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "gcov_event",
          "args": [
            "GCOV_ADD",
            "info"
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "gcov_event",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/gcov/fs.c",
          "lines": "838-861",
          "snippet": "void gcov_event(enum gcov_action action, struct gcov_info *info)\n{\n\tstruct gcov_node *node;\n\n\tmutex_lock(&node_lock);\n\tnode = get_node_by_name(gcov_info_filename(info));\n\tswitch (action) {\n\tcase GCOV_ADD:\n\t\tif (node)\n\t\t\tadd_info(node, info);\n\t\telse\n\t\t\tadd_node(info);\n\t\tbreak;\n\tcase GCOV_REMOVE:\n\t\tif (node)\n\t\t\tremove_info(node, info);\n\t\telse {\n\t\t\tpr_warn(\"could not remove '%s' (not found)\\n\",\n\t\t\t\tgcov_info_filename(info));\n\t\t}\n\t\tbreak;\n\t}\n\tmutex_unlock(&node_lock);\n}",
          "includes": [
            "#include \"gcov.h\"",
            "#include <linux/mm.h>",
            "#include <linux/seq_file.h>",
            "#include <linux/mutex.h>",
            "#include <linux/slab.h>",
            "#include <linux/string.h>",
            "#include <linux/list.h>",
            "#include <linux/fs.h>",
            "#include <linux/debugfs.h>",
            "#include <linux/module.h>",
            "#include <linux/init.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static DEFINE_MUTEX(node_lock);",
            "static void remove_node(struct gcov_node *node);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"gcov.h\"\n#include <linux/mm.h>\n#include <linux/seq_file.h>\n#include <linux/mutex.h>\n#include <linux/slab.h>\n#include <linux/string.h>\n#include <linux/list.h>\n#include <linux/fs.h>\n#include <linux/debugfs.h>\n#include <linux/module.h>\n#include <linux/init.h>\n\nstatic DEFINE_MUTEX(node_lock);\nstatic void remove_node(struct gcov_node *node);\n\nvoid gcov_event(enum gcov_action action, struct gcov_info *info)\n{\n\tstruct gcov_node *node;\n\n\tmutex_lock(&node_lock);\n\tnode = get_node_by_name(gcov_info_filename(info));\n\tswitch (action) {\n\tcase GCOV_ADD:\n\t\tif (node)\n\t\t\tadd_info(node, info);\n\t\telse\n\t\t\tadd_node(info);\n\t\tbreak;\n\tcase GCOV_REMOVE:\n\t\tif (node)\n\t\t\tremove_info(node, info);\n\t\telse {\n\t\t\tpr_warn(\"could not remove '%s' (not found)\\n\",\n\t\t\t\tgcov_info_filename(info));\n\t\t}\n\t\tbreak;\n\t}\n\tmutex_unlock(&node_lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "writeout",
          "args": [],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "list_add_tail",
          "args": [
            "&info->head",
            "&clang_gcov_list"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mutex_lock",
          "args": [
            "&gcov_lock"
          ],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "mutex_lock_io",
          "container": null,
          "file": "output_repos_c/CVE-2022-30594/repo/kernel/locking/rtmutex_api.c",
          "lines": "580-586",
          "snippet": "void __sched mutex_lock_io(struct mutex *lock)\n{\n\tint token = io_schedule_prepare();\n\n\t__mutex_lock_common(lock, TASK_UNINTERRUPTIBLE, 0, NULL, _RET_IP_);\n\tio_schedule_finish(token);\n}",
          "includes": [
            "#include \"rtmutex.c\"",
            "#include <linux/export.h>",
            "#include <linux/spinlock.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rtmutex.c\"\n#include <linux/export.h>\n#include <linux/spinlock.h>\n\nvoid __sched mutex_lock_io(struct mutex *lock)\n{\n\tint token = io_schedule_prepare();\n\n\t__mutex_lock_common(lock, TASK_UNINTERRUPTIBLE, 0, NULL, _RET_IP_);\n\tio_schedule_finish(token);\n}"
        }
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&info->functions"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "INIT_LIST_HEAD",
          "args": [
            "&info->head"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "kzalloc",
          "args": [
            "sizeof(*info)",
            "GFP_KERNEL"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"gcov.h\"\n#include <linux/mm.h>\n#include <linux/slab.h>\n#include <linux/ratelimit.h>\n#include <linux/printk.h>\n#include <linux/list.h>\n#include <linux/kernel.h>\n\nstatic struct gcov_info *current_info;\nstatic LIST_HEAD(clang_gcov_list);\n\nvoid llvm_gcov_init(llvm_gcov_callback writeout, llvm_gcov_callback flush)\n{\n\tstruct gcov_info *info = kzalloc(sizeof(*info), GFP_KERNEL);\n\n\tif (!info)\n\t\treturn;\n\n\tINIT_LIST_HEAD(&info->head);\n\tINIT_LIST_HEAD(&info->functions);\n\n\tmutex_lock(&gcov_lock);\n\n\tlist_add_tail(&info->head, &clang_gcov_list);\n\tcurrent_info = info;\n\twriteout();\n\tcurrent_info = NULL;\n\tif (gcov_events_enabled)\n\t\tgcov_event(GCOV_ADD, info);\n\n\tmutex_unlock(&gcov_lock);\n}"
  }
]